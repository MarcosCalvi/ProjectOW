var b4w="object"===typeof b4w?b4w:function(a){var g={};a.module=g;var l={};a.ua=function(a,b){var y=g[a];y&&(y.Kn=null);l[b||"__b4w_default"]=null};a.register=function(a,b){g[a]||(g[a]=b)};a.require=function(a,b){if(!g[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";l[b]||(l[b]=function(a){return function(b){var d=g[b];if(!d)throw Error('Module "'+b+'" not found');d.Kn||(d.Kn={});d.Kn[a]||(d.Kn[a]={},d(d.Kn[a],l[a]));return d.Kn[a]}}(b));return l[b](a)};a.module_check=function(a){return g[a]?
!0:!1};a.get_namespace=function(a){for(var b in l)if(l[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.particles=function(a,g){var l=g("__particles"),d=g("__print");a.wM=function(a,y,r){l.Ho(a)?l.wM(a,y,r):d.error('"',a.name,'" has no particle systems')};a.tM=function(a,y,r){l.Ho(a)?l.tM(a,y,r):d.error('"',a.name,'" has no particle systems')};a.jM=function(a,y,r){l.Ho(a)?(r=Math.min(r,1),r=Math.max(r,0),l.jM(a,y,r)):d.error('"',a.name,'" has no particle systems')}};b4w.module.__particles=function(a,g){function l(){q.q("_rand() undefined")}function d(a,b,d,f,l,q){var h=a.jv,k=a.$g,p=a.time;a=a.xL;for(var t=0;t<h.length;t+=4){var e=h[t];if(p>a&&p>=e&&e>a||p<a&&(e>a||p>=e))for(e=0;8>e;e++)k[8*t+e]=f[e],z[e]=f[e];else for(e=0;8>e;e++)z[e]=k[8*t+e];e=L;e[0]=b[3*t];e[1]=b[3*t+1];e[2]=b[3*t+2];m.Gc(e,z,e);l[3*t]=e[0];l[3*t+1]=e[1];l[3*t+2]=e[2];var w=c;w[0]=d[4*t];w[1]=d[4*t+1];w[2]=d[4*t+2];w[3]=d[4*t+3];m.R_(w,z,w);q[4*t]=w[0];q[4*t+1]=w[1];q[4*t+2]=w[2];q[4*t+3]=
w[3];for(e=1;4>e;e++)l[3*(t+e)]=l[3*t],l[3*(t+e)+1]=l[3*t+1],l[3*(t+e)+2]=l[3*t+2],q[4*(t+e)]=w[0],q[4*(t+e)+1]=w[1],q[4*(t+e)+2]=w[2],q[4*(t+e)+3]=w[3]}}function b(a){a?(q.r_(a),l=function(){return q.EY()}):l=function(){return Math.random()}}var y=g("__config"),r=g("__batch"),A=g("__geometry"),h=g("__textures"),u=g("__time"),m=g("__tsr"),q=g("__util"),f=g("__vec3"),t=y.B,c=new Float32Array(4),z=new Float32Array(8),L=new Float32Array(3),D=[];a.update=function(){for(var a=0;a<D.length;a++)for(var b=
D[a],c=b.I,f=0;f<c.length;f++)for(var l=b,q=c[f].X,h=0;h<q.length;h++){var k=q[h],p=k.gb;p&&p.iy&&!k.kg&&(d(p,p.positions,p.wN,l.k.n,p.kD,p.sE),p.YK=!0)}};a.Ho=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].X,c=0;c<d.length;c++)if(d[c].gb)return!0;return!1};a.fL=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].X,c=0;c<d.length;c++){var f=d[c].gb;if(f&&"EMITTER"==f.Xw)return!0}return!1};a.VR=function(a){return 0<a.particle_systems.length};a.UR=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.pW=function(a){for(var b=0;b<a.particle_systems.length;b++){var d=a.particle_systems[b].settings;if("HAIR"==d.type&&d.b4w_dynamic_grass)return!0}return!1};a.FW=function(a,b,d){var c=a.gb={name:b.name,Xw:b.settings.type,time:0,xL:-1,iy:!1,va:0,$a:0,CN:0,vC:0,HK:0,Ee:0,fi:0,UC:0,XJ:0,hm:0,Kf:0,uO:0,size:0,rG:0,qG:0,GH:0,FH:new Float32Array(16),YK:!1,positions:null,kD:null,wN:null,sE:null,jv:null,iB:null,$g:null,kL:null,AN:0,BN:0};c.va=b.settings.frame_start;
c.$a=b.settings.frame_end;c.CN=(c.$a-c.va)/u.sd();c.vC=b.settings.lifetime;c.HK=c.vC/u.sd();c.Ee=b.settings.b4w_cyclic?1:0;c.fi=b.settings.mass;c.UC=b.settings.normal_factor;c.XJ=9.81*b.settings.effector_weights.gravity;c.hm=b.settings.b4w_fade_in/u.sd();c.Kf=b.settings.b4w_fade_out/u.sd();c.uO=b.settings.effector_weights.wind;c.iy="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,l,m;a.Wr?(f=d.halo.size,l=d.halo.hardness,30>l?(l=.5,m=.9):40>l?(l=.1,m=1):50>l?(l=0,m=.8):(l=0,m=.5)):(f=b.settings.particle_size,
m=l=1);c.size=f;c.rG=l;c.qG=m;d.use_nodes&&"BILLBOARD"==b.settings.render_type&&(r.qf(a,"NODES",1),r.qf(a,"PARTICLE_BATCH",1),a.ok=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&t.vu&&(b=b[0].texture,f=[],h.aS(b.color_ramp,h.MF,f),f=new Uint8Array(f.map(function(a){return q.V(255*a,0,255)})),f=h.NH(f,h.MF),r.Rj(a,f,"u_color_ramp_tex",b.name),r.qf(a,"USE_COLOR_RAMP",1));d=d.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(d[0]&&"STRAND"==d[0].texture_coords&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){d=d[0].texture.color_ramp.elements;b=Math.min(4*d.length,a.length);for(f=0;f<b;f+=4)l=d[f/4],a[f]=l.position,a[f+1]=l.color[0],a[f+2]=l.color[1],a[f+3]=l.color[2];c.GH=d.length}c.FH.set(a)};a.uV=function(a,c,h,t){var r=a.gb,m=t.n;t=h.settings.count;var z=h.settings.frame_start/u.sd(),k=h.settings.frame_end/u.sd(),p=h.settings.lifetime/u.sd(),x=h.settings.lifetime_random,e=h.settings.emit_from,
w=h.settings.factor_random;if(h.settings.use_rotations)var n=h.settings.angular_velocity_mode,y=h.settings.angular_velocity_factor;else n="NONE",y=0;var I=h.settings.b4w_randomize_emission,F=h.settings.b4w_cyclic;r.AN=h.settings.billboard_tilt;r.BN=h.settings.billboard_tilt_random;b(h.seed);var T;c=A.yI(c,["a_position","a_tbn_quat"],null);switch(e){case "VERT":var M=c.aa[0].a_position;T=c.aa[0].a_tbn_quat;h=M.length/3;c=[];for(e=0;e<t;e++){var D=Math.round((h-1)*l());c.push(D);c.push(D);c.push(D);
c.push(D)}h=[];for(e=0;e<c.length;e++)h.push(M[3*c[e]]),h.push(M[3*c[e]+1]),h.push(M[3*c[e]+2]);M=new Float32Array(h);h=[];for(e=0;e<c.length;e++)h.push(T[4*c[e]]),h.push(T[4*c[e]+1]),h.push(T[4*c[e]+2]),h.push(T[4*c[e]+3]);T=new Float32Array(h);break;case "FACE":M=[];T=[];e=[];q.jw(0,e);h=A.EB(c,t,!1,e);q.jw(0,e);c=A.EB(c,t,!0,e);for(e=0;e<h.length;e++)M.push(h[e][0],h[e][1],h[e][2]),M.push(h[e][0],h[e][1],h[e][2]),M.push(h[e][0],h[e][1],h[e][2]),M.push(h[e][0],h[e][1],h[e][2]),T.push(c[e][0],c[e][1],
c[e][2],c[e][3]),T.push(c[e][0],c[e][1],c[e][2],c[e][3]),T.push(c[e][0],c[e][1],c[e][2],c[e][3]),T.push(c[e][0],c[e][1],c[e][2],c[e][3]);M=new Float32Array(M);T=new Float32Array(T);break;case "VOLUME":q.q("Particle emission from volume is not supported");break;default:q.q("Wrong emit from option")}T=[M,T];M=T[0];T=T[1];r.positions=new Float32Array(M);r.wN=new Float32Array(T);r.kD=new Float32Array(M.length);r.sE=new Float32Array(T.length);c=[];k=(k-z)/t;for(h=0;h<t;h++)e=I?k*h+10*k*(.5-l()):k*h,F||
(e+=z),c.push(e),c.push(e),c.push(e),c.push(e);z=new Float32Array(c);r.jv=new Float32Array(z);r.iB=new Float32Array(z);if(r.iy){r.$g=new Float32Array(8*z.length);for(I=0;I<8*z.length;I++)for(F=0;8>F;F++)r.$g[8*I+F]=m[F];d(r,M,T,m,M,T)}m=A.Pf("EMITTER_PARTICLES");I=q.Vg();I.a_position=M;I.a_tbn_quat=T;m.aa[0]=I;a.Uh=A.Mt;a=[];for(I=0;I<t;I++)a.push(4*I,4*I+2,4*I+1,4*I,4*I+3,4*I+2);a=new Uint16Array(a);m.na=a;m.qa.a_p_bb_vertex=A.KI(t);m.Ja=M.length/3;a=[];x*=p;for(I=0;I<t;I++)F=x*l(),a.push(p-F),a.push(p-
F),a.push(p-F),a.push(p-F);p=m.qa;x=[];for(I=0;I<t;I++)F=Math.random(),x.push(a[4*I],z[4*I],F),x.push(a[4*I+1],z[4*I+1],F),x.push(a[4*I+2],z[4*I+2],F),x.push(a[4*I+3],z[4*I+3],F);x=new Float32Array(x);p.a_p_data=x;p=m.qa;x=[];for(a=0;a<t;a++){z=[l()-.5,l()-.5,l()-.5];f.normalize(z,z);x.push(w*z[0]);x.push(w*z[1]);x.push(w*z[2]);switch(n){case "NONE":x.push(0);break;case "SPIN":case "VELOCITY":x.push(y);break;case "RAND":x.push(2*y*(l()-.5));break;default:q.q("Undefined velocity factor")}z=x.slice(-4);
for(I=0;12>I;I++)x.push(z[I%4])}t=new Float32Array(x);p.a_p_vels=t;r.kL=new Float32Array(m.qa.a_p_data);return m};a.LZ=function(a,b,c){a=a.I;for(var d=0;d<a.length;d++)for(var f=a[d].X,h=0;h<f.length;h++){var l=f[h].gb;l&&l.name==b&&!f[h].kg&&(l.xL=l.time,l.time=c)}};a.yY=function(a){for(var b=a.Ja,c=a.aa[0].a_position,d=[],f=[],h=0;h<b;h++)f.push(c[3*h]),d.push(c[3*h+1]),f.push(c[3*h+2]);d=new Float32Array(d);f=new Float32Array(f);a.qa.a_lf_dist=d;a.qa.a_lf_bb_vertex=f;return a};a.wM=function(a,
b,c){a=a.I;for(var d=0;d<a.length;d++)for(var f=a[d].X,h=0;h<f.length;h++){var l=f[h].gb;l&&l.name==b&&(l.size=c)}};a.tM=function(a,b,c){a=a.I;for(var d=0;d<a.length;d++)for(var f=a[d].X,h=0;h<f.length;h++){var l=f[h].gb;l&&l.name==b&&(l.UC=c)}};a.jM=function(a,b,c){a=a.I;for(var d=0;d<a.length;d++)for(var f=a[d].X,h=0;h<f.length;h++){var l=f[h],k=l.gb;if(k&&k.name==b){var p=k.jv;if(1==c)var q=p;else if(0==c)for(var q=k.iB,e=0;e<q.length;e+=4)q[e]=1E4,q[e+1]=q[e],q[e+2]=q[e],q[e+3]=q[e];else for(var w=
4/c,q=k.iB,n=0,e=0;e<q.length;e+=4)e>=n?(q[e]=p[e],n+=w):q[e]=1E4,q[e+1]=q[e],q[e+2]=q[e],q[e+3]=q[e];l=l.Ca;if(l.ld.a_p_data){k=k.kL;for(e=0;e<k.length;e+=3)k[e+1]=q[Math.round(e/3)];A.g0(l,k)}}}};a.C0=function(a,b,c){a=a.I;for(var d=0;d<a.length;d++)for(var f=a[d].X,h=0;h<f.length;h++){var l=f[h].gb;if(l&&l.iy)for(var k=0;k<8*l.jv.length;k++)l.$g[8*k]=b[0],l.$g[8*k+1]=b[1],l.$g[8*k+2]=b[2],l.$g[8*k+3]=b[3],l.$g[8*k+4]=c[0],l.$g[8*k+5]=c[1],l.$g[8*k+6]=c[2],l.$g[8*k+7]=c[3]}};a.v0=function(a,b,c){for(var d=
[],f=0;f<c;f++)d.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.qa.a_tbn_quat=new Float32Array(d);if(b.Es){d=[];for(f=0;f<c;f++)d.push(f,f,f,f);a.qa[b.Es.name]=new Float32Array(d)}};a.u0=function(a){-1==D.indexOf(a)&&D.push(a)};a.JY=function(a){a=D.indexOf(a);-1!=a&&D.splice(a,1)};a.ua=function(){D.length=0}};b4w.module.__config=function(a,g){function l(){return b4w.module_check(a.Je.Ju)}function d(){for(var d=a.Je,l=null,h=document.getElementsByTagName("script"),u=0;u<h.length;u++){for(var m=h[u].src,q=0;q<d.xK.length;q++)if(0<=m.indexOf(d.xK[q])){l=m;break}if(null!==l)break}l||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),l=document.location.href);d=l.indexOf("?");0<=d&&(l=l.substring(0,d));return l.substring(0,l.lastIndexOf("/"))}var b=g("__print"),
y=g("__util");a.gq=1;a.xl=2;a.Fn=3;a.NF=4;a.fq=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.LH=y.T(a.context);a.B={alpha_sort:!0,alpha_sort_threshold:.1,Mm:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,DI:1,gV:5,background_color:[0,0,0,0],canvas_resolution_factor:1,vp:3,allow_cors:!1,CI:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,F4:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,tO:!1,Cr:!0,Yw:!0,jd:!0,water_dynamic:!0,Xk:!0,Jx:!0,YN:!0,precision:"highp",quality:a.xl,vu:!0,aY:!1,XD:!1,lB:!1,mO:!1,is_mobile_device:!1,gC:!1,AA:!1,k$:!1,Ys:!1,allow_hidpi:!1,OM:!1,KC:!1,enable_selectable:!0,enable_outlining:!0,aj:!0,po:!1,AI:!1,zC:[0,0],yr:!1,DL:!0,Lx:!1,url_params:null,fc:!0,Fc:4,br:!1,VL:!1,WL:!1,BD:!1,xH:!1,iK:!1,media_auto_activation:!0,RK:4,Bw:!1,gl_debug:!1,rH:!1,pG:!1,Uz:!1,cr:"dds",f$:"16x",srgb_type:"SRGB_SIMPLE",Wz:!1};a.lI=y.T(a.B);
a.Gl={yv:-1,GI:!1,jm:1};a.controls={WX:1/120};a.Td={path:"",kY:"B4W_ASSETS_PATH=__JS__/../../../deploy/assets\/",CY:"B4W_PROJ_ASSETS_PATH=__JS__/../assets\/",OX:15,prevent_caching:!0,JC:!1,gB:!1,hx:!1};a.DG=y.T(a.Td);a.Je={shaders_path:"",WZ:"../shaders/",MM:"include/",e$:"postprocessing/",Ju:"built_in_data",xK:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js project_ow.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.tW={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{bj:.064,Sj:.035,Rk:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],yn:.11,pk:.062,Tj:.004}};a.C={enabled:!0,max_fps:60,rt:"",G0:"B4W_URANIUM_PATH=uranium.js",pA:!1,ping:!1,At:!0};a.pL=y.T(a.C);a.Xo={Vr:1024,dv:256,cI:32,iU:128,hU:256,rL:.25,sY:.5,rY:1};a.ZL=y.T(a.Xo);a.Y={XE:!0,Iw:!1,HG:!1,yH:!1,pI:!1};a.KM=y.T(a.Y);a.Wc={outlining_overview_mode:!1,pj:[1,.4,.05],Gk:.2,Hk:3.8,Ik:1};
a.or={enabled:!1,B_:0,A_:0,$Z:"COLOR"};a.jI=y.T(a.or);a.Oi={MX:8,Dw:64,GC:8,Ew:8,HC:15,SK:0,us:128,fj:1024,DC:4096,Ec:4096,IC:[4096,4096]};a.KH=y.T(a.Oi);a.Nn=function(){var b=a.B,d=a.C,l=a.Xo;switch(b.quality){case a.Fn:b.shadows=!0;b.Xk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Cr=!0;b.Yw=!0;b.jd=!0;l.Vr=2048;l.dv=512;b.vp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Jx=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.aj=!0;b.Fc=16;b.srgb_type="SRGB_PROPER";d.max_fps=120;break;case a.xl:b.shadows=!0;b.Xk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Cr=!0;b.Yw=!0;b.jd=!0;l.Vr=1024;l.dv=256;b.vp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Jx=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.aj=!0;b.srgb_type="SRGB_SIMPLE";
b.Fc=4;d.max_fps=60;break;case a.gq:b.shadows=!1;b.Xk=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.Cr=!1;b.Yw=!1;b.jd=!1;l.Vr=512;l.dv=256;b.vp=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.Jx=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.aj=!1;b.srgb_type="SRGB_SIMPLE";b.Fc=1;d.max_fps=60;break;case a.fq:y.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(d,l){switch(d){case "allow_cors":a.B.allow_cors=l;break;case "allow_hidpi":a.B.allow_hidpi=l;break;case "alpha":a.context.alpha=l;break;case "alpha_sort":a.B.alpha_sort=l;break;case "alpha_sort_threshold":a.B.alpha_sort_threshold=l;break;case "anaglyph_use":b.KU();a.B.stereo=l?"ANAGLYPH":a.B.stereo;break;case "animation_framerate":a.Gl.yv=l;break;case "anisotropic_filtering":a.B.anisotropic_filtering=l;break;case "antialiasing":a.B.antialiasing=l;break;case "assets_dir":case "assets_path":a.Td.path=
l;break;case "assets_dds_available":a.Td.gB=l;break;case "assets_pvr_available":a.Td.hx=l;break;case "assets_min50_available":a.Td.JC=l;break;case "audio":a.Y.XE=l;break;case "background_color":a.B.background_color=l;break;case "bloom":a.B.bloom=l;break;case "built_in_module_name":a.Je.Ju=l;break;case "canvas_resolution_factor":a.B.canvas_resolution_factor=l;break;case "console_verbose":a.B.console_verbose=l;break;case "compositing":a.B.compositing=l;break;case "dof":a.B.dof=l;break;case "do_not_load_resources":a.B.do_not_load_resources=
l;break;case "god_rays":a.B.god_rays=l;break;case "stereo":a.B.stereo=l;break;case "max_fps":a.B.max_fps=l;break;case "max_fps_physics":a.C.max_fps=l;break;case "media_auto_activation":a.B.media_auto_activation=l;break;case "motion_blur":a.B.motion_blur=l;break;case "physics_enabled":a.C.enabled=l;break;case "physics_uranium_path":a.C.rt=l;break;case "physics_calc_fps":a.C.pA=l;break;case "physics_use_workers":a.C.At=l;break;case "precision":a.B.precision=l;break;case "prevent_caching":a.Td.prevent_caching=
l;break;case "quality":a.B.quality=l;break;case "reflections":a.B.reflections=l;break;case "refractions":a.B.refractions=l;break;case "sfx_mix_mode":a.Y.Iw=l;break;case "shaders_dir":case "shaders_path":a.Je.shaders_path=l;break;case "shadows":a.B.shadows=l;break;case "show_hud_debug_info":a.B.show_hud_debug_info=l;break;case "smaa":a.B.smaa=l;break;case "smaa_search_texture_path":a.Je.smaa_search_texture_path=l;break;case "smaa_area_texture_path":a.Je.smaa_area_texture_path=l;break;case "ssao":a.B.ssao=
l;break;case "debug_view":a.B.debug_view=l;break;case "enable_selectable":a.B.enable_selectable=l;break;case "enable_outlining":a.B.enable_outlining=l;break;case "outlining_overview_mode":a.Wc.outlining_overview_mode=l;break;case "glow_materials":a.B.aj=l;break;case "url_params":a.B.url_params=l;break;case "use_min50":a.B.use_min50=l;break;case "gl_debug":a.B.gl_debug=l;break;case "srgb_type":a.B.srgb_type=l;break;default:b.error("Unknown config property: "+d)}};a.get=function(d){switch(d){case "allow_cors":return a.B.allow_cors;
case "allow_hidpi":return a.B.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.B.alpha_sort;case "alpha_sort_threshold":return a.B.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.B.stereo;case "animation_framerate":return a.Gl.yv;case "anisotropic_filtering":return a.B.anisotropic_filtering;case "antialiasing":return a.B.antialiasing;case "assets_dir":case "assets_path":return a.Td.path;case "assets_dds_available":return a.Td.gB;case "assets_pvr_available":return a.Td.hx;
case "assets_min50_available":return a.Td.JC;case "audio":return a.Y.XE;case "background_color":return a.B.background_color;case "bloom":return a.B.bloom;case "built_in_module_name":return a.Je.Ju;case "canvas_resolution_factor":return a.B.canvas_resolution_factor;case "console_verbose":return a.B.console_verbose;case "compositing":return a.B.compositing;case "dof":return a.B.dof;case "do_not_load_resources":return a.B.do_not_load_resources;case "is_mobile_device":return a.B.is_mobile_device;case "god_rays":return a.B.god_rays;
case "stereo":return a.B.stereo;case "max_fps":return a.B.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.B.media_auto_activation;case "motion_blur":return a.B.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.rt;case "physics_calc_fps":return a.C.pA;case "physics_use_workers":return a.C.At;case "precision":return a.B.precision;case "prevent_caching":return a.Td.prevent_caching;case "quality":return a.B.quality;case "reflections":return a.B.reflections;
case "refractions":return a.B.refractions;case "sfx_mix_mode":return a.Y.Iw;case "shaders_dir":case "shaders_path":return a.Je.shaders_path;case "shadows":return a.B.shadows;case "show_hud_debug_info":return a.B.show_hud_debug_info;case "smaa":return a.B.smaa;case "smaa_search_texture_path":return a.Je.smaa_search_texture_path;case "smaa_area_texture_path":return a.Je.smaa_area_texture_path;case "ssao":return a.B.ssao;case "debug_view":return a.B.debug_view;case "enable_selectable":return a.B.enable_selectable;
case "enable_outlining":return a.B.enable_outlining;case "outlining_overview_mode":return a.Wc.outlining_overview_mode;case "glow_materials":return a.B.aj;case "url_params":return a.B.url_params;case "use_min50":return a.B.use_min50;case "gl_debug":return a.B.gl_debug;case "srgb_type":return a.B.srgb_type;default:b.error("Unknown config property: "+d)}};a.reset=function(){for(var b in a.LH)a.context[b]=a.LH[b];for(b in a.lI)a.B[b]=a.lI[b];for(b in a.DG)a.Td[b]=a.DG[b];for(b in a.pL)a.C[b]=a.pL[b];
for(b in a.ZL)a.Xo[b]=a.ZL[b];for(b in a.KM)a.Y[b]=a.KM[b];for(b in a.jI)a.or[b]=a.jI[b]};a.zD=function(){for(var b in a.KH)a.Oi[b]=a.KH[b]};a.nK=l;a.FZ=function(){var b=a.Je,y=a.C;l()||""!=b.shaders_path||(b.shaders_path=d()+"/"+b.WZ);y.enabled&&""==y.rt&&(y.rt=d()+"/"+y.G0.replace("B4W_URANIUM_PATH=",""))};a.Dv=function(b){var l=a.Td;if(l.path)return l.path;var h=l.kY,u="B4W_ASSETS_PATH=";b&&(h=l.CY,u="B4W_PROJ_ASSETS_PATH=",h=h.replace("__NAME__",b));h=h.replace(u,"");return h=h.replace("__JS__",
d())}};b4w.module.__print=function(a){function g(a,b){var d=[];-1<a[0].indexOf("%c")?d.push(a[0].replace("%c","%c"+b+": ")):d.push(b+": "+a[0]);for(var l=1;l<a.length;l++)d.push(a[l]);return d}function l(){r++;var a=g(arguments,"B4W ERROR");console.error.apply(console,a)}function d(a){a in h||(h[a]=a,l([a]))}function b(a,b){d(a+"() is deprecated, use "+b+"() instead.")}var y=!1,r=0,A=0,h={};a.NZ=function(a){y=a};a.ee=function(){console.log.apply(console,arguments)};a.log=function(){if(y){var a=g(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=l;a.R=d;a.Qb=b;a.Wh=function(a,l){switch(1<l.length){case !0:d(a+"() is deprecated, use "+l.slice(0,-1).join("(), ")+"() or "+l[l.length-1]+"() instead.");break;case !1:b(a,l[0])}};a.KU=function(){d('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){A++;var a=g(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=g(arguments,"B4W INFO");console.info.apply(console,a)};a.NU=function(){r++;
var a=g(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.OU=function(){A++;var a=g(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){y&&console.time.apply(console,arguments)};a.timeEnd=function(){y&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.jW=function(){return A};a.MV=function(){return r};a.CH=function(){r=A=0}};b4w.module.print=b4w.module.__print;b4w.module.__util=function(a,g){function l(a){return 0<a?1:0>a?-1:0}function d(a,b,e){var d=a[0],c=a[1];a=a[2];var S=Math.cos(d/2),da=Math.cos(c/2),ka=Math.cos(a/2),k=Math.sin(d/2),c=Math.sin(c/2),n=Math.sin(a/2);if(-1<T.indexOf(b))var J=Math.cos((d+a)/2),v=Math.sin((d+a)/2),l=Math.cos((d-a)/2),p=Math.sin((d-a)/2),w=Math.cos((a-d)/2),H=Math.sin((a-d)/2);switch(b){case pa:e[0]=da*v;e[1]=c*l;e[2]=c*p;e[3]=da*J;break;case ja:e[0]=c*p;e[1]=da*v;e[2]=c*l;e[3]=da*J;break;case qa:e[0]=c*l;e[1]=c*p;e[2]=
da*v;e[3]=da*J;break;case 3:e[0]=da*v;e[1]=c*H;e[2]=c*w;e[3]=da*J;break;case ta:e[0]=c*w;e[1]=da*v;e[2]=c*H;e[3]=da*J;break;case Ia:e[0]=c*H;e[1]=c*w;e[2]=da*v;e[3]=da*J;break;case 6:e[0]=k*da*ka+S*c*n;e[1]=S*c*ka-k*da*n;e[2]=S*da*n+k*c*ka;e[3]=S*da*ka-k*c*n;break;case 7:e[0]=S*da*n+k*c*ka;e[1]=k*da*ka+S*c*n;e[2]=S*c*ka-k*da*n;e[3]=S*da*ka-k*c*n;break;case 8:e[0]=S*c*ka-k*da*n;e[1]=S*da*n+k*c*ka;e[2]=k*da*ka+S*c*n;e[3]=S*da*ka-k*c*n;break;case 9:e[0]=k*da*ka-S*c*n;e[1]=S*da*n-k*c*ka;e[2]=S*c*ka+k*
da*n;e[3]=S*da*ka+k*c*n;break;case 10:e[0]=S*c*ka+k*da*n;e[1]=k*da*ka-S*c*n;e[2]=S*da*n-k*c*ka;e[3]=S*da*ka+k*c*n;break;case 11:e[0]=S*da*n-k*c*ka,e[1]=S*c*ka+k*da*n,e[2]=k*da*ka-S*c*n,e[3]=S*da*ka+k*c*n}return e}function b(a,b,e){var c=a[0],d=a[1],S=a[2];a=a[3];switch(b){case pa:e[0]=Math.atan2(c*d+S*a,d*a-c*S);e[1]=Math.acos(1-2*(d*d+S*S));e[2]=Math.atan2(c*d-S*a,c*S+d*a);break;case ja:e[0]=Math.atan2(c*a+d*S,S*a-c*d);e[1]=Math.acos(1-2*(c*c+S*S));e[2]=Math.atan2(d*S-c*a,c*d+S*a);break;case qa:e[0]=
Math.atan2(c*S+d*a,c*a-d*S);e[1]=Math.acos(1-2*(c*c+d*d));e[2]=Math.atan2(c*S-d*a,c*a+d*S);break;case 3:e[0]=Math.atan2(c*S-d*a,c*d+S*a);e[1]=Math.acos(1-2*(d*d+S*S));e[2]=Math.atan2(c*S+d*a,S*a-c*d);break;case ta:e[0]=Math.atan2(c*d-S*a,c*a+d*S);e[1]=Math.acos(1-2*(c*c+S*S));e[2]=Math.atan2(c*d+S*a,c*a-d*S);break;case Ia:e[0]=Math.atan2(d*S-c*a,c*S+d*a);e[1]=Math.acos(1-2*(c*c+d*d));e[2]=Math.atan2(c*a+d*S,d*a-c*S);break;case 6:e[0]=Math.atan2(2*(c*a-d*S),1-2*(c*c+d*d));e[1]=Math.asin(2*(c*S+d*a));
e[2]=Math.atan2(2*(S*a-c*d),1-2*(d*d+S*S));break;case 7:b=c*d+S*a;.499999<b?(e[0]=0,e[1]=Math.PI/2,e[2]=2*Math.atan2(c,a)):-.499999>b?(e[0]=0,e[1]=-Math.PI/2,e[2]=-2*Math.atan2(c,a)):(e[0]=Math.atan2(2*(d*a-c*S),1-2*(d*d+S*S)),e[1]=Math.asin(2*(c*d+S*a)),e[2]=Math.atan2(2*(c*a-d*S),1-2*(c*c+S*S)));break;case 8:e[0]=Math.atan2(2*(S*a-c*d),1-2*(c*c+S*S));e[1]=Math.asin(2*(c*a+d*S));e[2]=Math.atan2(2*(d*a-c*S),1-2*(c*c+d*d));break;case 9:e[0]=Math.atan2(2*(c*a+d*S),1-2*(c*c+S*S));e[1]=Math.asin(2*(S*
a-c*d));e[2]=Math.atan2(2*(c*S+d*a),1-2*(d*d+S*S));break;case 10:e[0]=Math.atan2(2*(c*S+d*a),1-2*(c*c+d*d));e[1]=Math.asin(2*(c*a-d*S));e[2]=Math.atan2(2*(c*d+S*a),1-2*(c*c+S*S));break;case 11:b=d*a-c*S,.499999<b?(e[0]=0,e[1]=Math.PI/2,e[2]=-2*Math.atan2(S,a)):-.499999>b?(e[0]=0,e[1]=-Math.PI/2,e[2]=2*Math.atan2(S,a)):(e[0]=Math.atan2(2*(c*d+S*a),1-2*(d*d+S*S)),e[1]=Math.asin(2*(d*a-c*S)),e[2]=Math.atan2(2*(c*a+d*S),1-2*(c*c+d*d)))}return e}function y(a,b,e){var c=b.length,d=M;d[0]=a[0];d[1]=a[1];
d[2]=a[2];n.normalize(d,d);c?(a=aa,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],b=n.cross(a,d,fa),n.normalize(b,b),n.cross(d,b,a),c=Z,c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=b[0],c[7]=b[1],c[8]=b[2],w.fromMat3(c,e),e[3]=0<e[3]?e[3]+3.1E-5:e[3]-3.1E-5,(0<e[3]&&0>a[3]||0>e[3]&&0<a[3])&&w.scale(e,-1,e),w.normalize(e,e)):w.rotationTo(sa,d,e);return e}function r(a,b){b||(b=new Float32Array(4));Q.fromMat4(a,Z);var e=Z[0],c=Z[3],d=Z[6],S=Z[1],da=Z[4],ka=Z[7],k=Z[2],n=Z[5],J=Z[8],e=Math.sqrt(e*
e+c*c+d*d)||1,S=Math.sqrt(S*S+da*da+ka*ka)||1,k=Math.sqrt(k*k+n*n+J*J)||1;Z[0]/=e;Z[3]/=e;Z[6]/=e;Z[1]/=S;Z[4]/=S;Z[7]/=S;Z[2]/=k;Z[5]/=k;Z[8]/=k;w.fromMat3(Z,b);w.normalize(b,b);return b}function A(a){var b=a[0],e=a[1],c=a[2],d=a[3],S=Math.sqrt(b*b+e*e+c*c),S=1/S;a[0]=b*S;a[1]=e*S;a[2]=c*S;a[3]=d*S}function h(a,b){var e=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var c in a)e=h(a[c],e);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(c=
0;c<a.length;c++)e=u(a[c],e);break;case Array:for(c=0;c<a.length;c++)e=h(a[c],e);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:e=u(0,e);break;default:D("Wrong object constructor")}else e=u(0,e);return e;case "number":return u(a,e);case "boolean":return u(a|0,e);case "string":return m(a,e);case "function":case "undefined":return u(0,e)}}function u(a,b){var e=b;R[0]=a;e=(e<<5)-e+ca[0];e&=e;e=(e<<5)-e+ca[1];return e&e}function m(a,
b){for(var e=b,c=0;c<a.length;c++)e=(e<<5)-e+a.charCodeAt(c),e&=e;return e}function q(a){return(34*a+1)*a%289}function f(a){return a-Math.floor(a)}function t(a){return c((34*a+5)*a)}function c(a){return a-289*Math.floor(a/289)}function z(a){return a-7*Math.floor(a/7)}function L(a,b,e){a<b&&(a=b);a>e&&(a=e);return a}function D(a){a&&x.error.apply(x,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function G(a,b,e){a-=b;e-=b;return b+(a-Math.floor(a/e)*e)}function B(a){return G(a,0,2*Math.PI)}function O(a,b){if(a&&b){var e=a instanceof Array;if(e!=b instanceof Array)return!1;var c=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(c!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(e){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(!K(a[e],b[e]))return!1}else if(c){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(a[e]!=b[e])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var d in a)if(!K(a[d],b[d]))return!1;for(d in b)if(!(d in a))return!1}return!0}return!(a||b)}function K(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return O(a,b);default:return!0}}function E(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var e=[],c=0;c<a.length;c++){var d=a[c];""!=d&&"."!=d&&(".."!=d||!b&&!e.length||e.length&&".."==e[e.length-1]?
e.push(d):e.length&&e.pop())}a=e.join("/");for(c=0;c<b;c++)a="/"+a;return a||"."}function C(){var a=[{}];a.length=0;return a}var Q=g("__mat3"),k=g("__mat4"),p=g("__math"),x=g("__print"),e=g("__tsr"),w=g("__quat"),n=g("__vec3"),ea=g("__vec4"),I=0,F={},T=[pa,ja,qa,ta,Ia],M=new Float32Array(3),X=new Float32Array(3),H=new Float32Array(3),fa=new Float32Array(3),V=new Float32Array(3),P=new Float32Array(3),W=new Float32Array(3),ha=new Float32Array(3),v=new Float32Array(4),aa=new Float32Array(4),Z=new Float32Array(9),
ba=new Float32Array(16),ya=new Float32Array(16),na=w.create(),R=new Float64Array(1),ca=new Uint32Array(R.buffer),ra=new Float32Array([0,0,0]),xa=new Float32Array([0,0,0,1]),oa=new Float32Array([0,0,0,1,0,0,0,1]),Y=new Float32Array([1,1,1]),ua=new Float32Array([1,0,0]),sa=new Float32Array([0,1,0]),N=new Float32Array([0,0,1]),ia=new Float32Array([-1,0,0]),J=new Float32Array([0,-1,0]),ma=new Float32Array([0,0,-1]),pa=0,ja=1,qa=2,ta=4,Ia=5,Ca=Math.floor(44488.07041494893),Aa=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.VF=ra;a.Gn=xa;a.W2=oa;a.Oz=Y;a.Gg=ua;a.Bi=sa;a.nc=N;a.Hy=ia;a.Te=J;a.Nc=ma;a.WF=pa;a.cG=ja;a.dG=qa;a.YF=3;a.$F=ta;a.fG=Ia;a.XF=6;a.bG=7;a.Pz=8;a.ZF=9;a.aG=10;a.eG=11;a.NO=Aa;a.Iy=1;a.hq=2;a.Kj=4;a.lF=4;
a.ci=function(a){return"undefined"!=typeof a};a.CK=function(a,b,e){for(var c=[],d=e.length,S=0;S<d;S++){var da=e[S];da[a]==b&&c.push(da)}return c};a.Jf=function(a){return new Float32Array(a)};a.eV=function(a,b){var e=a.length,c=new Float32Array(e+b.length);c.set(a);c.set(b,e);return c};a.U_=function(a,b){var e=a.length,c=new Uint32Array(e+b.length);c.set(a);c.set(b,e);return c};a.CS=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.xR=function(a,b){var e=
[],c={},d=b.length,S,da;for(S=0;S<d;S++)c[b[S]]=!0;d=a.length;for(S=0;S<d;S++)da=a[S],da in c&&e.push(da);return e};a.sign=l;a.e8=function(a,b,e){for(var c=e.length,d=0;d<c;d++)if(e[d][a]==b)return!0;return!1};a.Gd=function(a,b,e){for(var c=0;c<e.length;c++){var d=e[c];if(d[a]===b)return d}return null};a.c8=function(a,b,e,c,d){for(var S=0;S<d.length;S++){var da=d[S];if(da[a]==b&&da[e]==c)return da}return null};a.YV=function(a,b){for(var e=0;e<a.length;e++)if(a[e].uuid==b)return e;return-1};a.rR=function(a,
b){for(var e=0;e<a.length;e++)if(a[e]==b)return;a.push(b)};a.c4=function(a){for(var b=0;b<a.length-1;b++)for(var e=a[b],c=b+1;c<a.length;c++)if(e==a[c])return!1;return!0};a.N_=function(a,b,e,c){c||(c=new Float32Array(16));k.identity(c);c[12]=a;c[13]=b;c[14]=e};var la=1;a.EY=function(){la=(69069*la+5)%Math.pow(2,32);return Math.round(la/65536)%32768/32767};a.r_=function(a){la=a};a.yg=function(a){var b=a[0]%Ca*48271-3399*Math.floor(a[0]/Ca);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.jw=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.gk=function(a,b){var e=M;e[0]=a[2];e[1]=a[1];e[2]=a[0];d(e,11,b);return b};a.XC=d;a.GL=b;a.LU=function(a){var b=Q.create(),e=Math.cos(a[0]),c=Math.cos(a[1]),d=Math.cos(a[2]),S=Math.sin(a[0]),da=Math.sin(a[1]);a=Math.sin(a[2]);var ka=e*d,k=e*a,n=S*d,J=S*a;b[0]=c*d;b[1]=c*a;b[2]=-da;b[3]=da*n-k;b[4]=da*J+ka;b[5]=c*S;b[6]=da*ka+J;b[7]=da*k-n;b[8]=c*e;return b};a.kx=function(a,e){var c=b(a,11,M);e[0]=c[2];e[1]=c[1];e[2]=c[0];return e};a.mc=function(a,b,
e){e||(e=new Float32Array(3));n.transformQuat(b,a,e);return e};a.kB=function(a,b,e){e||(e=new Float32Array(4));a=n.normalize(a,M);var c=n.dot(b,a);a=n.cross(b,a,H);c=Math.acos(c);e[0]=a[0]*Math.sin(c/2);e[1]=a[1]*Math.sin(c/2);e[2]=a[2]*Math.sin(c/2);e[3]=Math.cos(c/2);return e};a.O_=function(a,b,e,c){c||(c=new Float32Array(4));n.transformQuat(e,b,c);c[3]=-n.dot(a,c)};a.tU=function(a){var b=e.P(a.k.n),c=M;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;n.transformQuat(c,b,c);H[0]=0;H[1]=0;H[2]=
-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;n.transformQuat(c,b,c);H[0]=0;H[1]=0;H[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,n.transformQuat(c,b,c),H[0]=0,H[1]=1,H[2]=0}c[1]=0;n.normalize(c,c);a=n.dot(c,H);return Math.acos(a)*(0<-c[0]*H[2]?-1:1)};a.UG=function(a,b,e,c){if(0!=e){c=c||[];for(var d=0;d<a.length;d++)c[d]=(1-e)*a[d]+e*b[d]}};a.V_=function(){I++;return I.toString(10)};a.ot=function(a){F[a]||(F[a]=0);var b=a+F[a];F[a]++;return b};a.Vg=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.Mr=function(a,b,e){b=b||C();var c=b.length,d=a.length/3;e=e||new Float32Array(4*d);for(var S=0;S<d;++S){var da=M;da[0]=a[3*S];da[1]=a[3*S+1];da[2]=a[3*S+2];var ka;c?(ka=aa,ka[0]=b[4*S],ka[1]=b[4*S+1],ka[2]=b[4*S+2],ka[3]=b[4*S+3]):ka=b;y(da,ka,e.subarray(4*S,4*(S+1)))}return e};a.MJ=y;a.Qh=function(a){return JSON.parse(JSON.stringify(a))};a.T=function(b){if(!(b instanceof Object))return b;var e;e=b.constructor;switch(e){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:e=
new e(b);break;case Array:e=new e(b.length);for(var c=0;c<b.length;c++)e[c]=a.T(b[c]);break;default:for(c in e=new e,b)e[c]=a.T(b[c])}return e};a.Vq=function(a){var b=a instanceof Array?[]:{},e;for(e in a)if(a[e]instanceof Object){var c=a[e].constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[e]=new c(a[e]);break;case Array:b[e]=a[e].slice(0);break;default:b[e]=a[e]}}else b[e]=a[e];return b};a.CC=
r;a.QK=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.PK=function(a){v[0]=.577350269189626;v[1]=.577350269189626;v[2]=.577350269189626;v[3]=0;ea.transformMat4(v,a,v);return ea.length(v)};a.fo=function(a,b){var e=b.left,c=b.right,d=b.top,S=b.bottom,da=b.near,ka=b.far;e[0]=a[3]+a[0];e[1]=a[7]+a[4];e[2]=a[11]+a[8];e[3]=a[15]+a[12];c[0]=a[3]-a[0];c[1]=a[7]-a[4];c[2]=a[11]-a[8];c[3]=a[15]-a[12];d[0]=a[3]-a[1];d[1]=a[7]-a[5];d[2]=a[11]-a[9];d[3]=a[15]-a[13];S[0]=a[3]+
a[1];S[1]=a[7]+a[5];S[2]=a[11]+a[9];S[3]=a[15]+a[13];da[0]=a[3]+a[2];da[1]=a[7]+a[6];da[2]=a[11]+a[10];da[3]=a[15]+a[14];ka[0]=a[3]-a[2];ka[1]=a[7]-a[6];ka[2]=a[11]-a[10];ka[3]=a[15]-a[14];A(e);A(c);A(d);A(S);A(da);A(ka)};a.m_=function(a,b,e){return e<-p.pf(a,b.near)||e<-p.pf(a,b.left)||e<-p.pf(a,b.right)||e<-p.pf(a,b.top)||e<-p.pf(a,b.bottom)||e<-p.pf(a,b.far)?!0:!1};a.DU=function(a,b,e,c,d){var S=n.dot(e,b.far),da=n.dot(c,b.far),ka=n.dot(d,b.far),S=Math.sqrt(S*S+da*da+ka*ka);if(S<-p.pf(a,b.near)||
S<-p.pf(a,b.far))return!0;S=n.dot(e,b.left);da=n.dot(c,b.left);ka=n.dot(d,b.left);if(Math.sqrt(S*S+da*da+ka*ka)<-p.pf(a,b.left))return!0;S=n.dot(e,b.right);da=n.dot(c,b.right);ka=n.dot(d,b.right);if(Math.sqrt(S*S+da*da+ka*ka)<-p.pf(a,b.right))return!0;S=n.dot(e,b.top);da=n.dot(c,b.top);ka=n.dot(d,b.top);if(Math.sqrt(S*S+da*da+ka*ka)<-p.pf(a,b.top))return!0;S=n.dot(e,b.bottom);da=n.dot(c,b.bottom);ka=n.dot(d,b.bottom);return Math.sqrt(S*S+da*da+ka*ka)<-p.pf(a,b.bottom)?!0:!1};a.Po=function(a,b,e,c){c||
(c=0);for(var d=a.length,S=0;S<d;S+=3){var da=a[S],ka=a[S+1],k=a[S+2];e[c+S]=b[0]*da+b[4]*ka+b[8]*k+b[12];e[c+S+1]=b[1]*da+b[5]*ka+b[9]*k+b[13];e[c+S+2]=b[2]*da+b[6]*ka+b[10]*k+b[14]}};a.aaa=function(a,b,e,c){c||(c=0);for(var d=a.length,S=0;S<d;S+=3){var da=a[S],ka=a[S+1],k=a[S+2];e[c+S]=b[0]*da+b[4]*ka+b[8]*k;e[c+S+1]=b[1]*da+b[5]*ka+b[9]*k;e[c+S+2]=b[2]*da+b[6]*ka+b[10]*k}return e};a.HL=function(a,b,e,c){c=c||0;for(var d=a.length,S=0;S<d;S+=4){na[0]=a[S];na[1]=a[S+1];na[2]=a[S+2];na[3]=a[S+3];var da=
0<na[3];w.multiply(b,na,na);(da&&0>na[3]||!da&&0<na[3])&&ea.scale(na,-1,na);e[c+S]=na[0];e[c+S+1]=na[1];e[c+S+2]=na[2];e[c+S+3]=na[3]}};a.P0=function(a,b,e){e||(e=new Float32Array(3));v[0]=a[0];v[1]=a[1];v[2]=a[2];v[3]=0;ea.transformMat4(v,b,v);e[0]=v[0];e[1]=v[1];e[2]=v[2]};a.s5=function(a,b){var e=a.length;e||D("flatten(): Wrong or empty array");var c=a[0].length;c||D("flatten(): Wrong or empty subarray");b||(b=new Float32Array(e*c));for(var d=0;d<e;d++)for(var S=0;S<c;S++)b[d*c+S]=a[d][S];return b};
a.Q0=function(a){for(var b=[],e=0;e<a.length;e+=3){var c=new Float32Array([a[e],a[e+1],a[e+2]]);b[e/3]=c}return b};a.Fu=function(b,e,c,d){if(d<c)return c;var k=c+Math.floor((d-c)/2);return b[k]>e?a.Fu(b,e,c,k-1):b[k]<e?a.Fu(b,e,k+1,d):k};a.Xj=function(a,b){for(var e=0;e<a.length;e++)if(a[e]!=b[e])return!1;return!0};a.m4=function(a,b,e){for(var c=0;c<a.length;c++)if(Math.abs(a[c]-b[c])>e)return!1;return!0};a.i9=function(a,b,e){e||(e=new Float32Array(16));for(var c=0;12>c;c++)e[c]=a[c]*b;e[12]=a[12];
e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.Q_=function(a,b,e,c,d){d||(d=new Float32Array(16));b=k.fromRotationTranslation(e,c,ba);k.multiply(b,a,d);return d};a.Gc=function(a,b,e,c,d){d||(d=new Float32Array(3));e=k.fromRotationTranslation(e,c,ba);1!==b&&(c=k.identity(ya),b=n.set(b,b,b,M),k.scale(c,b,c),k.multiply(e,c,e));n.transformMat4(a,e,d);return d};a.L$=function(a,b,e,c,d){d||(d=new Float32Array(4));b=k.fromRotationTranslation(e,c,ba);ea.transformMat4(a,b,d);return d};a.Q7=function(a,b,e,
c,d){d||(d=new Float32Array(3));b=k.fromRotationTranslation(e,c,ba);k.invert(b,b);n.transformMat4(a,b,d);return d};a.K$=function(a,b,e){e||(e=new Float32Array(16));k.fromRotationTranslation(b,a,e);a=a[3];for(b=0;12>b;b++)e[b]*=a;return e};a.p8=function(b,e,c){a.QK(b,e);e[3]=a.PK(b);r(b,c)};a.x3=function(a){for(var b=[],e=0;e<a.length;e++)b.push(a[e]);return JSON.stringify(b)};a.aZ=function(a,b,e,c){c||(c=new Float32Array(3));var d=M;n.subtract(b,a,d);n.transformQuat(d,e,d);n.subtract(b,d,c)};a.tV=
function(){var a=M;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),S=new Float32Array(16),da=new Float32Array(16);k.lookAt(a,[-1,0,0],[0,-1,0],b);k.scale(b,[-1,1,1],b);k.scale(b,[-1,1,-1],e);k.lookAt(a,[0,-1,0],[0,0,-1],c);k.scale(c,[1,1,-1],c);k.scale(c,[1,-1,-1],d);k.lookAt(a,[0,0,-1],[0,-1,0],S);k.scale(S,[-1,1,1],S);k.scale(S,[-1,1,-1],da);return[b,e,c,d,S,da]};a.xV=function(){var a=M;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),
e=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),S=new Float32Array(16),da=new Float32Array(16);k.lookAt(a,[1,0,0],[0,-1,0],b);k.scale(b,[-1,1,-1],e);k.lookAt(a,[0,1,0],[0,0,1],c);k.scale(c,[1,-1,-1],d);k.lookAt(a,[0,0,1],[0,-1,0],S);k.scale(S,[-1,1,-1],da);return[b,e,c,d,S,da]};a.iS=function(a){return h(a,0)};a.bK=h;a.D7=m;a.JX=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=
a[0];return b};a.FL=function(a,b){b||(b=a);var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<e?(b[3]=2*Math.acos(a[3]),e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Cb=function(a){return a*Math.PI/180};a.se=function(a){return 180*a/Math.PI};a.dE=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],e=Math.floor(a[0]+b),c=Math.floor(a[1]+b),d=.211324865405187*e+.211324865405187*c,b=a[0]-
e+d;a=a[1]-c+d;var S=b>a?1:0,da=1-S,d=b+.211324865405187-S,ka=a+.211324865405187-da,k=b+-.577350269189626,n=a+-.577350269189626,e=e%289,c=c%289,J=q(q(c)+e),da=q(q(c+da)+e+S),v=q(q(c+1)+e+1),e=Math.max(.5-(b*b+a*a),0),c=Math.max(.5-(d*d+ka*ka),0),S=Math.max(.5-(k*k+n*n),0),l=2*f(.024390243902439*J)-1,p=2*f(.024390243902439*da)-1,w=2*f(.024390243902439*v)-1,J=Math.abs(l)-.5,da=Math.abs(p)-.5,v=Math.abs(w)-.5,l=l-Math.floor(l+.5),p=p-Math.floor(p+.5),w=w-Math.floor(w+.5),e=e*e*e*e*(1.79284291400159-
.85373472095314*(l*l+J*J)),c=c*c*c*c*(1.79284291400159-.85373472095314*(p*p+da*da)),S=S*S*S*S*(1.79284291400159-.85373472095314*(w*w+v*v));return 130*(e*(l*b+J*a)+c*(p*d+da*ka)+S*(w*k+v*n))};a.kH=function(a){var b=1/7,e=b/2,d=c(Math.floor(a[0])),k=c(Math.floor(a[1])),S=f(a[0]);a=f(a[1]);var da=S-.5,ka=S-1.5,S=a-.5;a-=1.5;var n=t(d),J=t(d+1),v=n,d=J,n=t(n+k),J=t(J+k),v=t(v+k+1),d=t(d+k+1),k=da+.7*(z(n)*b+e),l=ka+.7*(z(J)*b+e),da=da+.7*(z(v)*b+e),ka=ka+.7*(z(d)*b+e),n=S+.7*(z(Math.floor(n*b))*b+e),
S=S+.7*(z(Math.floor(J*b))*b+e),v=a+.7*(z(Math.floor(v*b))*b+e),b=a+.7*(z(Math.floor(d*b))*b+e);return Math.min(k*k+n*n,l*l+S*S,da*da+v*v,ka*ka+b*b)};a.jx=function(a,b,e,c,d){d||(d=new Float32Array(4));a=n.transformQuat(b,a,M);b=e[0];var S=e[1];e=e[2];var da=Z;da[0]=S*S+e*e;da[1]=-S*b;da[2]=-e*b;da[3]=-b*S;da[4]=b*b+e*e;da[5]=-e*S;da[6]=-b*e;da[7]=-S*e;da[8]=b*b+S*S;n.transformMat3(a,da,a);n.normalize(a,a);w.rotationTo(c,a,d);return d};a.tA=function(a,b){b||(b=new Float32Array(4));var e=v,c=aa,e=
w.setAxisAngle([0,0,1],Math.PI,w.create()),c=w.setAxisAngle([1,0,0],Math.PI/2,w.create());w.multiply(e,c,e);w.multiply(a,e,b);return b};a.ua=function(){I=0;F={}};a.V=L;a.Zb=function(a,b,e,c){e=Math.exp(-e/c);return(1-e)*a+e*b};a.Sx=function(a,b,e,c,d){d||(d=new Float32Array(a.length));e=Math.exp(-e/c);for(c=0;c<d.length;c++)d[c]=(1-e)*a[c]+e*b[c];return d};a.YM=function(a,b,e,c,d){d||(d=new Float32Array(a.length));w.slerp(a,b,Math.exp(-e/c),d)};a.lC=function(a){return"object"===typeof a&&a.buffer&&
a.buffer instanceof ArrayBuffer?!0:!1};a.xk=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.KA=function(a,b){var e=Q.fromQuat(a,Z),c=M;c[0]=e[6];c[1]=e[7];c[2]=e[8];c=n.cross(N,c,c);n.normalize(c,c);var d=e[4];!b&&0<d&&(c[0]*=-1,c[1]*=-1,c[2]*=-1);H[0]=e[0];H[1]=e[1];H[2]=e[2];n.normalize(H,H);e=aa;w.rotationTo(H,c,e);w.multiply(e,a,a)};a.YI=function(a,b,e,c){e=e*b-.5;var d=c*b-.5;c=e-Math.floor(e);var S=d-Math.floor(d);e=Math.floor(e);
var d=Math.floor(d),da=b-1,ka=a[d*b+e],k=a[d*b+Math.min(e+1,da)],n=a[Math.min(d+1,da)*b+e];a=a[Math.min(d+1,da)*b+Math.min(e+1,da)];return(ka*(1-c)+k*c)*(1-S)+(n*(1-c)+a*c)*S};a.$m=function(a){for(var b=0,e=0;3>e;e++)0<(a&1<<e)&&b++;return b};a.SL=function(a){for(var b=[0,0,0],e=0;3>e;e++)0<(a&1<<e)&&(b[2-e]=1);return b};a.Vo=function(a,b){var e=0;(1==b||2==b)&&0<(a&4)&&e++;2==b&&0<(a&2)&&e++;return e};a.DB=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=
16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.Pr=function(a){var b=0,e;for(e in a)a.hasOwnProperty(e)&&b++;return b};a.Ro=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.cC=function(a,b,e){e||(e=new Float32Array(3));e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=0;n.normalize(e,e)};a.P_=function(a,b,e){var c=a[0],d=a[1];a=a[2];var S=b[0],da=b[1],ka=b[2];b=b[3];var k=da*a-ka*d,n=ka*c-S*a,J=S*d-da*c,v=da*J-ka*n,ka=ka*k-S*J,S=S*n-da*k;e[0]=c+2*k*b+2*v;e[1]=
d+2*n*b+2*ka;e[2]=a+2*J*b+2*S};a.assert=function(a){a||D("Assertion failed")};a.q=D;a.Ng=G;a.Hi=B;a.LB=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.w_=function(a,b){for(var e in a){var c=!0,d=a[e],S=b[e];switch(typeof d){case "number":case "string":case "boolean":c=d==S;break;case "object":c=O(d,S)}if(!c)return!1}return!0};a.oD=function(a,b){var e=a[0],c=a[2],d=a[3];b[0]=a[1];b[1]=c;b[2]=d;b[3]=e};a.LI=function(a){a+=1;132651<a&&x.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;
var e=Math.floor(a/51);return new Float32Array([b/51,e/51,a%51/51])};a.rs=function(a,b,e,c){v.set(a);v[3]=b;a=aa;M[0]=e[3];M[1]=e[4];M[2]=e[5];a.set(M);a[3]=0;a=ea.dot(v,a);if(0==a)return null;b=aa;n.copy(e,M);b.set(M);b[3]=1;a=-ea.dot(v,b)/a;c[0]=e[0]+a*e[3];c[1]=e[1]+a*e[4];c[2]=e[2]+a*e[5];return c};a.cW=function(a,b,e,c){var d=b[0]-a[0],S=e[0]-a[0],da=b[1]-a[1],ka=e[1]-a[1];b=b[2]-a[2];a=e[2]-a[2];c[0]=da*a-b*ka;c[1]=S*b-d*a;c[2]=d*ka-da*S;return c};a.p4=function(a,b){for(var e=0;e<a.length;e++)b[e]=
a[e];return b};a.GD=function(a,b,e){var c=M,d=n.dot(a,b);-.9999999>d?(n.cross(ua,a,c),1E-6>n.length(c)&&n.cross(sa,a,c),n.normalize(c,c),w.setAxisAngle(c,Math.PI,e)):(n.cross(a,b,c),e.set(c),e[3]=1+d,w.normalize(e,e));return e};a.Pl=function(a,b,e){if(b==e)return e-a;a=B(a);b=B(b);e=B(e);b=2*Math.PI-b;e=B(e+b);a=B(a+b);return a>e?(e-=a,a=2*Math.PI-a,-e>a?a:e):0};a.hn=function(a,b,e){isFinite(b)&&isFinite(e)&&(a=L(a,b,e));return a*a*(3-2*a)};a.lerp=function(a,b,e){return b+a*(e-b)};a.yR=function(a,
b){for(var e=0;e<a.length;e++)for(var c=0;c<b.length;c++)if(b[c]==a[e])return!0;return!1};a.C4=function(a){for(var b=Array(a),e=0;e<a;e++)b[e]=0;return b};a.lO=function(a,b){for(var e=Math.max(a.length,b.length),c=0;c<e;c++){var d=l((c>=a.length?0:a[c])-(c>=b.length?0:b[c]));if(d)return d}return 0};a.rl=function(a){return a.join(".")};a.iN=function(a){return a.split(".").map(function(a){return a|0})};a.q$=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};
a.g8=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.oj=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=E(b[1]),b.join("://")):E(a)};a.Qq=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.CU=function(a,b,e,c){c[0]=a[0];c[1]=b[0];c[2]=e[0];c[3]=a[1];c[4]=b[1];c[5]=e[1];c[6]=a[2];c[7]=b[2];c[8]=e[2];return c};a.bk=C;a.Br=function(a){a=Math.round(32767.5*(a+1)-32768);return L(a?a:0,-32768,32767)};a.g$=function(a){return L((a+
32768)/32767.5-1,-1,1)};a.T_=function(a){return L(Math.round(255*a),0,255)};a.O$=function(a){return L(a/255,0,1)};a.wU=function(a,b,e,c){var d=n.subtract(e,b,M),S=n.subtract(c,e,X),da=n.subtract(b,c,H);b=n.subtract(a,b,fa);e=n.subtract(a,e,V);a=n.subtract(a,c,P);c=n.cross(d,S,W);if(0<=n.dot(n.cross(c,d,ha),b)&&0<=n.dot(n.cross(c,S,ha),e)&&0<=n.dot(n.cross(c,da,ha),a))return da=n.length(c),S=n.dot(c,b),Math.abs(S/da);d=n.scale(d,L(n.dot(d,b)/n.length(d),0,1),ha);b=n.length(n.subtract(b,d,ha));S=n.scale(S,
L(n.dot(S,e)/n.length(S),0,1),ha);S=n.length(n.subtract(e,S,ha));da=n.scale(da,L(n.dot(da,a)/n.length(da),0,1),ha);da=n.length(n.subtract(a,da,ha));return Math.min(Math.min(b,S),da)}};b4w.module.__vec3=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array,l=Math.random;a.create=function(){var a=new g(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new g(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,l){var r=new g(3);r[0]=a;r[1]=b;r[2]=l;return r};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,l,r){r[0]=a;r[1]=b;r[2]=l;return r};a.add=function(a,b,l){l[0]=a[0]+b[0];l[1]=a[1]+b[1];l[2]=a[2]+b[2];
return l};a.subtract=function(a,b,l){l[0]=a[0]-b[0];l[1]=a[1]-b[1];l[2]=a[2]-b[2];return l};a.sub=a.subtract;a.multiply=function(a,b,l){l[0]=a[0]*b[0];l[1]=a[1]*b[1];l[2]=a[2]*b[2];return l};a.mul=a.multiply;a.divide=function(a,b,l){l[0]=a[0]/b[0];l[1]=a[1]/b[1];l[2]=a[2]/b[2];return l};a.div=a.divide;a.min=function(a,b,l){l[0]=Math.min(a[0],b[0]);l[1]=Math.min(a[1],b[1]);l[2]=Math.min(a[2],b[2]);return l};a.max=function(a,b,l){l[0]=Math.max(a[0],b[0]);l[1]=Math.max(a[1],b[1]);l[2]=Math.max(a[2],
b[2]);return l};a.scale=function(a,b,l){l[0]=a[0]*b;l[1]=a[1]*b;l[2]=a[2]*b;return l};a.scaleAndAdd=function(a,b,l,r){r[0]=a[0]+b[0]*l;r[1]=a[1]+b[1]*l;r[2]=a[2]+b[2]*l;return r};a.distance=function(a,b){var l=b[0]-a[0],r=b[1]-a[1],g=b[2]-a[2];return Math.sqrt(l*l+r*r+g*g)};a.dist=a.distance;a.squaredDistance=function(a,b){var l=b[0]-a[0],r=b[1]-a[1],g=b[2]-a[2];return l*l+r*r+g*g};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],l=a[1];a=a[2];return Math.sqrt(b*b+l*l+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],l=a[1];a=a[2];return b*b+l*l+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var l=a[0],r=a[1],g=a[2],l=l*l+r*r+g*g;0<l&&(l=1/Math.sqrt(l),b[0]=a[0]*l,b[1]=a[1]*l,b[2]=a[2]*l);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,l){var r=a[0],g=a[1];a=a[2];var h=b[0],u=b[1];b=b[2];
l[0]=g*b-a*u;l[1]=a*h-r*b;l[2]=r*u-g*h;return l};a.lerp=function(a,b,l,r){var g=a[0],h=a[1];a=a[2];r[0]=g+l*(b[0]-g);r[1]=h+l*(b[1]-h);r[2]=a+l*(b[2]-a);return r};a.E7=function(a,b,l,r,g,h){var u=g*g,m=u*(2*g-3)+1,q=u*(g-2)+g,f=u*(g-1);g=u*(3-2*g);h[0]=a[0]*m+b[0]*q+l[0]*f+r[0]*g;h[1]=a[1]*m+b[1]*q+l[1]*f+r[1]*g;h[2]=a[2]*m+b[2]*q+l[2]*f+r[2]*g;return h};a.QG=function(a,b,l,r,g,h){var u=1-g,m=u*u,q=g*g,f=m*u,m=3*g*m,u=3*q*u;g*=q;h[0]=a[0]*f+b[0]*m+l[0]*u+r[0]*g;h[1]=a[1]*f+b[1]*m+l[1]*u+r[1]*g;h[2]=
a[2]*f+b[2]*m+l[2]*u+r[2]*g;return h};a.random=function(a,b){a=a||1;var y=2*l()*Math.PI,r=2*l()-1,g=Math.sqrt(1-r*r)*a;b[0]=Math.cos(y)*g;b[1]=Math.sin(y)*g;b[2]=r*a;return b};a.transformMat4=function(a,b,l){var r=a[0],g=a[1];a=a[2];var h=b[3]*r+b[7]*g+b[11]*a+b[15],h=h||1;l[0]=(b[0]*r+b[4]*g+b[8]*a+b[12])/h;l[1]=(b[1]*r+b[5]*g+b[9]*a+b[13])/h;l[2]=(b[2]*r+b[6]*g+b[10]*a+b[14])/h;return l};a.transformMat3=function(a,b,l){var r=a[0],g=a[1];a=a[2];l[0]=r*b[0]+g*b[3]+a*b[6];l[1]=r*b[1]+g*b[4]+a*b[7];
l[2]=r*b[2]+g*b[5]+a*b[8];return l};a.transformQuat=function(a,b,l){var r=a[0],g=a[1],h=a[2];a=b[0];var u=b[1],m=b[2];b=b[3];var q=b*r+u*h-m*g,f=b*g+m*r-a*h,t=b*h+a*g-u*r,r=-a*r-u*g-m*h;l[0]=q*b+r*-a+f*-m-t*-u;l[1]=f*b+r*-u+t*-a-q*-m;l[2]=t*b+r*-m+q*-u-f*-a;return l};a.rotateX=function(a,b,l,r){var g=[],h=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];h[0]=g[0];h[1]=g[1]*Math.cos(l)-g[2]*Math.sin(l);h[2]=g[1]*Math.sin(l)+g[2]*Math.cos(l);r[0]=h[0]+b[0];r[1]=h[1]+b[1];r[2]=h[2]+b[2];return r};a.rotateY=
function(a,b,l,r){var g=[],h=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];h[0]=g[2]*Math.sin(l)+g[0]*Math.cos(l);h[1]=g[1];h[2]=g[2]*Math.cos(l)-g[0]*Math.sin(l);r[0]=h[0]+b[0];r[1]=h[1]+b[1];r[2]=h[2]+b[2];return r};a.rotateZ=function(a,b,l,r){var g=[],h=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];h[0]=g[0]*Math.cos(l)-g[1]*Math.sin(l);h[1]=g[0]*Math.sin(l)+g[1]*Math.cos(l);h[2]=g[2];r[0]=h[0]+b[0];r[1]=h[1]+b[1];r[2]=h[2]+b[2];return r};a.forEach=function(){var d=a.create();return function(a,
l,r,g,h,u){l||(l=3);r||(r=0);for(g=g?Math.min(g*l+r,a.length):a.length;r<g;r+=l)d[0]=a[r],d[1]=a[r+1],d[2]=a[r+2],h(d,u,d),a[r]=d[0],a[r+1]=d[1],a[r+2]=d[2];return a}}();a.f3=function(d,b){var l=a.fromValues(d[0],d[1],d[2]),r=a.fromValues(b[0],b[1],b[2]);a.normalize(l,l);a.normalize(r,r);l=a.dot(l,r);return 1<l?0:Math.acos(l)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array,l=Math.random;a.create=function(){var a=new g(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new g(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,l,r){var A=new g(4);A[0]=a;A[1]=b;A[2]=l;A[3]=r;return A};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,l,r,g){g[0]=a;g[1]=b;g[2]=l;g[3]=r;return g};a.add=function(a,b,l){l[0]=
a[0]+b[0];l[1]=a[1]+b[1];l[2]=a[2]+b[2];l[3]=a[3]+b[3];return l};a.subtract=function(a,b,l){l[0]=a[0]-b[0];l[1]=a[1]-b[1];l[2]=a[2]-b[2];l[3]=a[3]-b[3];return l};a.sub=a.subtract;a.multiply=function(a,b,l){l[0]=a[0]*b[0];l[1]=a[1]*b[1];l[2]=a[2]*b[2];l[3]=a[3]*b[3];return l};a.mul=a.multiply;a.divide=function(a,b,l){l[0]=a[0]/b[0];l[1]=a[1]/b[1];l[2]=a[2]/b[2];l[3]=a[3]/b[3];return l};a.div=a.divide;a.min=function(a,b,l){l[0]=Math.min(a[0],b[0]);l[1]=Math.min(a[1],b[1]);l[2]=Math.min(a[2],b[2]);l[3]=
Math.min(a[3],b[3]);return l};a.max=function(a,b,l){l[0]=Math.max(a[0],b[0]);l[1]=Math.max(a[1],b[1]);l[2]=Math.max(a[2],b[2]);l[3]=Math.max(a[3],b[3]);return l};a.scale=function(a,b,l){l[0]=a[0]*b;l[1]=a[1]*b;l[2]=a[2]*b;l[3]=a[3]*b;return l};a.scaleAndAdd=function(a,b,l,r){r[0]=a[0]+b[0]*l;r[1]=a[1]+b[1]*l;r[2]=a[2]+b[2]*l;r[3]=a[3]+b[3]*l;return r};a.distance=function(a,b){var l=b[0]-a[0],r=b[1]-a[1],g=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(l*l+r*r+g*g+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,b){var l=b[0]-a[0],r=b[1]-a[1],g=b[2]-a[2],h=b[3]-a[3];return l*l+r*r+g*g+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],l=a[1],r=a[2];a=a[3];return Math.sqrt(b*b+l*l+r*r+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],l=a[1],r=a[2];a=a[3];return b*b+l*l+r*r+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var l=a[0],r=a[1],g=a[2],h=a[3],u=l*l+r*r+g*g+h*h;0<u&&(u=1/Math.sqrt(u),b[0]=l*u,b[1]=r*u,b[2]=g*u,b[3]=h*u);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,l,r){var g=a[0],h=a[1],u=a[2];a=a[3];r[0]=g+l*(b[0]-g);r[1]=h+l*(b[1]-h);r[2]=u+l*(b[2]-u);r[3]=a+l*(b[3]-a);return r};a.random=function(d,b){d=d||1;b[0]=l();b[1]=l();b[2]=l();b[3]=l();a.normalize(b,b);a.scale(b,d,b);return b};a.transformMat4=function(a,b,l){var r=a[0],g=a[1],h=
a[2];a=a[3];l[0]=b[0]*r+b[4]*g+b[8]*h+b[12]*a;l[1]=b[1]*r+b[5]*g+b[9]*h+b[13]*a;l[2]=b[2]*r+b[6]*g+b[10]*h+b[14]*a;l[3]=b[3]*r+b[7]*g+b[11]*h+b[15]*a;return l};a.transformQuat=function(a,b,l){var r=a[0],g=a[1],h=a[2],u=b[0],m=b[1],q=b[2];b=b[3];var f=b*r+m*h-q*g,t=b*g+q*r-u*h,c=b*h+u*g-m*r,r=-u*r-m*g-q*h;l[0]=f*b+r*-u+t*-q-c*-m;l[1]=t*b+r*-m+c*-u-f*-q;l[2]=c*b+r*-q+f*-m-t*-u;l[3]=a[3];return l};a.forEach=function(){var l=a.create();return function(a,g,r,A,h,u){g||(g=4);r||(r=0);for(A=A?Math.min(A*
g+r,a.length):a.length;r<A;r+=g)l[0]=a[r],l[1]=a[r+1],l[2]=a[r+2],l[3]=a[r+3],h(l,u,l),a[r]=l[0],a[r+1]=l[1],a[r+2]=l[2],a[r+3]=l[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,g){var l=g("__vec3"),d=g("__vec4"),b=g("__mat3"),y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=l.create(),d=l.fromValues(1,0,0),h=l.fromValues(0,1,0);return function(u,m,q){var f=l.dot(u,m);if(-.9999999>f)return l.cross(d,u,b),1E-6>l.length(b)&&l.cross(h,u,b),l.normalize(b,b),a.setAxisAngle(b,Math.PI,q),q;if(.9999999<f)return q[0]=0,q[1]=0,q[2]=0,q[3]=1,q;l.cross(u,
m,b);q[0]=b[0];q[1]=b[1];q[2]=b[2];q[3]=1+f;return a.normalize(q,q)}}();a.setAxes=function(){var l=b.create();return function(b,d,u,m){l[0]=d[0];l[3]=d[1];l[6]=d[2];l[1]=u[0];l[4]=u[1];l[7]=u[2];l[2]=-b[0];l[5]=-b[1];l[8]=-b[2];return a.normalize(a.fromMat3(l,m),m)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,l){b*=.5;var d=Math.sin(b);l[0]=d*a[0];l[1]=d*a[1];l[2]=d*a[2];l[3]=Math.cos(b);
return l};a.add=d.add;a.multiply=function(a,b,l){var d=a[0],m=a[1],q=a[2];a=a[3];var f=b[0],t=b[1],c=b[2];b=b[3];l[0]=d*b+a*f+m*c-q*t;l[1]=m*b+a*t+q*f-d*c;l[2]=q*b+a*c+d*t-m*f;l[3]=a*b-d*f-m*t-q*c;return l};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,l){b*=.5;var d=a[0],m=a[1],q=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);l[0]=d*b+a*f;l[1]=m*b+q*f;l[2]=q*b-m*f;l[3]=a*b-d*f;return l};a.rotateY=function(a,b,l){b*=.5;var d=a[0],m=a[1],q=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);l[0]=d*
b-q*f;l[1]=m*b+a*f;l[2]=q*b+d*f;l[3]=a*b-m*f;return l};a.rotateZ=function(a,b,l){b*=.5;var d=a[0],m=a[1],q=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);l[0]=d*b+m*f;l[1]=m*b-d*f;l[2]=q*b+a*f;l[3]=a*b-q*f;return l};a.calculateW=function(a,b){var l=a[0],d=a[1],m=a[2];b[0]=l;b[1]=d;b[2]=m;b[3]=Math.sqrt(Math.abs(1-l*l-d*d-m*m));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,l,d){var m=a[0],q=a[1],f=a[2];a=a[3];var t=b[0],c=b[1],z=b[2];b=b[3];var g,D,G;D=m*t+q*c+f*z+a*b;0>D&&(D=-D,t=-t,c=-c,
z=-z,b=-b);1E-6<1-D?(g=Math.acos(D),G=Math.sin(g),D=Math.sin((1-l)*g)/G,l=Math.sin(l*g)/G):D=1-l;d[0]=D*m+l*t;d[1]=D*q+l*c;d[2]=D*f+l*z;d[3]=D*a+l*b;return d};a.p$=function(){var b=a.create(),l=a.create();return function(d,u,m,q,f,t){a.slerp(d,q,f,b);a.slerp(u,m,f,l);a.slerp(b,l,2*f*(1-f),t);return t}}();a.invert=function(a,b){var l=a[0],d=a[1],m=a[2],q=a[3],f=l*l+d*d+m*m+q*q,f=f?1/f:0;b[0]=-l*f;b[1]=-d*f;b[2]=-m*f;b[3]=q*f;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,b){var l=a[0]+a[4]+a[8];if(0<l)l=Math.sqrt(l+1),b[3]=.5*l,l=.5/l,b[0]=(a[5]-a[7])*l,b[1]=(a[6]-a[2])*l,b[2]=(a[1]-a[3])*l;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var m=(d+1)%3,q=(d+2)%3,l=Math.sqrt(a[3*d+d]-a[3*m+m]-a[3*q+q]+1);b[d]=.5*l;l=.5/l;b[3]=(a[3*m+q]-a[3*q+m])*l;b[m]=(a[3*m+d]+a[3*d+m])*l;b[q]=(a[3*q+d]+a[3*d+q])*l}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new g(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],g=a[2],r=a[5];d[1]=a[3];d[2]=a[6];d[3]=b;d[5]=a[7];d[6]=g;d[7]=r}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=a[4],u=a[5],m=a[6],q=a[7],f=a[8],t=f*h-u*q,c=-f*A+u*m,z=
q*A-h*m,L=b*t+g*c+r*z;if(!L)return null;L=1/L;d[0]=t*L;d[1]=(-f*g+r*q)*L;d[2]=(u*g-r*h)*L;d[3]=c*L;d[4]=(f*b-r*m)*L;d[5]=(-u*b+r*A)*L;d[6]=z*L;d[7]=(-q*b+g*m)*L;d[8]=(h*b-g*A)*L;return d};a.adjoint=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=a[4],u=a[5],m=a[6],q=a[7],f=a[8];d[0]=h*f-u*q;d[1]=r*q-g*f;d[2]=g*u-r*h;d[3]=u*m-A*f;d[4]=b*f-r*m;d[5]=r*A-b*u;d[6]=A*q-h*m;d[7]=g*m-b*q;d[8]=b*h-g*A;return d};a.determinant=function(a){var d=a[3],b=a[4],g=a[5],r=a[6],A=a[7],h=a[8];return a[0]*(h*b-g*A)+a[1]*
(-h*d+g*r)+a[2]*(A*d-b*r)};a.multiply=function(a,d,b){var g=a[0],r=a[1],A=a[2],h=a[3],u=a[4],m=a[5],q=a[6],f=a[7];a=a[8];var t=d[0],c=d[1],z=d[2],L=d[3],D=d[4],G=d[5],B=d[6],O=d[7];d=d[8];b[0]=t*g+c*h+z*q;b[1]=t*r+c*u+z*f;b[2]=t*A+c*m+z*a;b[3]=L*g+D*h+G*q;b[4]=L*r+D*u+G*f;b[5]=L*A+D*m+G*a;b[6]=B*g+O*h+d*q;b[7]=B*r+O*u+d*f;b[8]=B*A+O*m+d*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var g=a[0],r=a[1],A=a[2],h=a[3],u=a[4],m=a[5],q=a[6],f=a[7];a=a[8];var t=d[0];d=d[1];b[0]=g;b[1]=r;b[2]=A;
b[3]=h;b[4]=u;b[5]=m;b[6]=t*g+d*h+q;b[7]=t*r+d*u+f;b[8]=t*A+d*m+a;return b};a.rotate=function(a,d,b){var g=a[0],r=a[1],A=a[2],h=a[3],u=a[4],m=a[5],q=a[6],f=a[7];a=a[8];var t=Math.sin(d);d=Math.cos(d);b[0]=d*g+t*h;b[1]=d*r+t*u;b[2]=d*A+t*m;b[3]=d*h-t*g;b[4]=d*u-t*r;b[5]=d*m-t*A;b[6]=q;b[7]=f;b[8]=a;return b};a.scale=function(a,d,b){var g=d[0];d=d[1];b[0]=g*a[0];b[1]=g*a[1];b[2]=g*a[2];b[3]=d*a[3];b[4]=d*a[4];b[5]=d*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.nV=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.lV=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=g;d[1]=b;d[2]=0;d[3]=-b;d[4]=g;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.mV=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=b+b,u=g+g,m=r+r,b=b*h,q=g*h,g=g*u,f=r*h,t=
r*u,r=r*m,h=A*h,u=A*u,A=A*m;d[0]=1-g-r;d[3]=q-A;d[6]=f+u;d[1]=q+A;d[4]=1-b-r;d[7]=t-h;d[2]=f-u;d[5]=t+h;d[8]=1-b-g;return d};a.normalFromMat4=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=a[4],u=a[5],m=a[6],q=a[7],f=a[8],t=a[9],c=a[10],z=a[11],L=a[12],D=a[13],G=a[14],B=a[15],O=b*u-g*h,K=b*m-r*h,E=b*q-A*h,C=g*m-r*u,Q=g*q-A*u,k=r*q-A*m,p=f*D-t*L,x=f*G-c*L,f=f*B-z*L,e=t*G-c*D,t=t*B-z*D,c=c*B-z*G,z=O*c-K*t+E*e+C*f-Q*x+k*p;if(!z)return null;z=1/z;d[0]=(u*c-m*t+q*e)*z;d[1]=(m*f-h*c-q*x)*z;d[2]=(h*t-u*
f+q*p)*z;d[3]=(r*t-g*c-A*e)*z;d[4]=(b*c-r*f+A*x)*z;d[5]=(g*f-b*t-A*p)*z;d[6]=(D*k-G*Q+B*C)*z;d[7]=(G*E-L*k-B*K)*z;d[8]=(L*Q-D*E+B*O)*z;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.kV=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new g(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];
d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],g=a[2],r=a[3],A=a[6],h=a[7],u=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=b;d[6]=a[9];d[7]=a[13];d[8]=g;d[9]=A;d[11]=a[14];d[12]=r;d[13]=
h;d[14]=u}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=a[4],u=a[5],m=a[6],q=a[7],f=a[8],t=a[9],c=a[10],z=a[11],L=a[12],D=a[13],G=a[14],B=a[15],O=b*u-g*h,K=b*m-r*h,E=b*q-A*h,C=g*m-r*u,Q=g*q-A*u,k=r*q-A*m,p=f*D-t*L,x=f*G-c*L,e=f*B-z*L,w=t*G-c*D,n=t*B-z*D,ea=c*B-z*G,I=O*ea-K*n+E*w+C*e-Q*x+k*p;if(!I)return null;
I=1/I;d[0]=(u*ea-m*n+q*w)*I;d[1]=(r*n-g*ea-A*w)*I;d[2]=(D*k-G*Q+B*C)*I;d[3]=(c*Q-t*k-z*C)*I;d[4]=(m*e-h*ea-q*x)*I;d[5]=(b*ea-r*e+A*x)*I;d[6]=(G*E-L*k-B*K)*I;d[7]=(f*k-c*E+z*K)*I;d[8]=(h*n-u*e+q*p)*I;d[9]=(g*e-b*n-A*p)*I;d[10]=(L*Q-D*E+B*O)*I;d[11]=(t*E-f*Q-z*O)*I;d[12]=(u*x-h*w-m*p)*I;d[13]=(b*w-g*x+r*p)*I;d[14]=(D*K-L*C-G*O)*I;d[15]=(f*C-t*K+c*O)*I;return d};a.adjoint=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=a[4],u=a[5],m=a[6],q=a[7],f=a[8],t=a[9],c=a[10],z=a[11],L=a[12],D=a[13],G=a[14],B=
a[15];d[0]=u*(c*B-z*G)-t*(m*B-q*G)+D*(m*z-q*c);d[1]=-(g*(c*B-z*G)-t*(r*B-A*G)+D*(r*z-A*c));d[2]=g*(m*B-q*G)-u*(r*B-A*G)+D*(r*q-A*m);d[3]=-(g*(m*z-q*c)-u*(r*z-A*c)+t*(r*q-A*m));d[4]=-(h*(c*B-z*G)-f*(m*B-q*G)+L*(m*z-q*c));d[5]=b*(c*B-z*G)-f*(r*B-A*G)+L*(r*z-A*c);d[6]=-(b*(m*B-q*G)-h*(r*B-A*G)+L*(r*q-A*m));d[7]=b*(m*z-q*c)-h*(r*z-A*c)+f*(r*q-A*m);d[8]=h*(t*B-z*D)-f*(u*B-q*D)+L*(u*z-q*t);d[9]=-(b*(t*B-z*D)-f*(g*B-A*D)+L*(g*z-A*t));d[10]=b*(u*B-q*D)-h*(g*B-A*D)+L*(g*q-A*u);d[11]=-(b*(u*z-q*t)-h*(g*z-A*
t)+f*(g*q-A*u));d[12]=-(h*(t*G-c*D)-f*(u*G-m*D)+L*(u*c-m*t));d[13]=b*(t*G-c*D)-f*(g*G-r*D)+L*(g*c-r*t);d[14]=-(b*(u*G-m*D)-h*(g*G-r*D)+L*(g*m-r*u));d[15]=b*(u*c-m*t)-h*(g*c-r*t)+f*(g*m-r*u);return d};a.determinant=function(a){var d=a[0],b=a[1],g=a[2],r=a[3],A=a[4],h=a[5],u=a[6],m=a[7],q=a[8],f=a[9],t=a[10],c=a[11],z=a[12],L=a[13],D=a[14];a=a[15];return(d*h-b*A)*(t*a-c*D)-(d*u-g*A)*(f*a-c*L)+(d*m-r*A)*(f*D-t*L)+(b*u-g*h)*(q*a-c*z)-(b*m-r*h)*(q*D-t*z)+(g*m-r*u)*(q*L-f*z)};a.multiply=function(a,d,b){var g=
a[0],r=a[1],A=a[2],h=a[3],u=a[4],m=a[5],q=a[6],f=a[7],t=a[8],c=a[9],z=a[10],L=a[11],D=a[12],G=a[13],B=a[14];a=a[15];var O=d[0],K=d[1],E=d[2],C=d[3];b[0]=O*g+K*u+E*t+C*D;b[1]=O*r+K*m+E*c+C*G;b[2]=O*A+K*q+E*z+C*B;b[3]=O*h+K*f+E*L+C*a;O=d[4];K=d[5];E=d[6];C=d[7];b[4]=O*g+K*u+E*t+C*D;b[5]=O*r+K*m+E*c+C*G;b[6]=O*A+K*q+E*z+C*B;b[7]=O*h+K*f+E*L+C*a;O=d[8];K=d[9];E=d[10];C=d[11];b[8]=O*g+K*u+E*t+C*D;b[9]=O*r+K*m+E*c+C*G;b[10]=O*A+K*q+E*z+C*B;b[11]=O*h+K*f+E*L+C*a;O=d[12];K=d[13];E=d[14];C=d[15];b[12]=O*g+
K*u+E*t+C*D;b[13]=O*r+K*m+E*c+C*G;b[14]=O*A+K*q+E*z+C*B;b[15]=O*h+K*f+E*L+C*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var g=d[0],r=d[1];d=d[2];var A,h,u,m,q,f,t,c,z,L,D,G;a===b?(b[12]=a[0]*g+a[4]*r+a[8]*d+a[12],b[13]=a[1]*g+a[5]*r+a[9]*d+a[13],b[14]=a[2]*g+a[6]*r+a[10]*d+a[14],b[15]=a[3]*g+a[7]*r+a[11]*d+a[15]):(A=a[0],h=a[1],u=a[2],m=a[3],q=a[4],f=a[5],t=a[6],c=a[7],z=a[8],L=a[9],D=a[10],G=a[11],b[0]=A,b[1]=h,b[2]=u,b[3]=m,b[4]=q,b[5]=f,b[6]=t,b[7]=c,b[8]=z,b[9]=L,b[10]=D,b[11]=G,
b[12]=A*g+q*r+z*d+a[12],b[13]=h*g+f*r+L*d+a[13],b[14]=u*g+t*r+D*d+a[14],b[15]=m*g+c*r+G*d+a[15]);return b};a.scale=function(a,d,b){var g=d[0],r=d[1];d=d[2];b[0]=a[0]*g;b[1]=a[1]*g;b[2]=a[2]*g;b[3]=a[3]*g;b[4]=a[4]*r;b[5]=a[5]*r;b[6]=a[6]*r;b[7]=a[7]*r;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*d;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,d,b,g){var r=b[0],A=b[1];b=b[2];var h=Math.sqrt(r*r+A*A+b*b),u,m,q,f,t,c,z,L,D,G,B,O,K,E,C,Q,k,p,x,e;if(1E-7>Math.abs(h))return null;
h=1/h;r*=h;A*=h;b*=h;u=Math.sin(d);m=Math.cos(d);q=1-m;d=a[0];h=a[1];f=a[2];t=a[3];c=a[4];z=a[5];L=a[6];D=a[7];G=a[8];B=a[9];O=a[10];K=a[11];E=r*r*q+m;C=A*r*q+b*u;Q=b*r*q-A*u;k=r*A*q-b*u;p=A*A*q+m;x=b*A*q+r*u;e=r*b*q+A*u;r=A*b*q-r*u;A=b*b*q+m;g[0]=d*E+c*C+G*Q;g[1]=h*E+z*C+B*Q;g[2]=f*E+L*C+O*Q;g[3]=t*E+D*C+K*Q;g[4]=d*k+c*p+G*x;g[5]=h*k+z*p+B*x;g[6]=f*k+L*p+O*x;g[7]=t*k+D*p+K*x;g[8]=d*e+c*r+G*A;g[9]=h*e+z*r+B*A;g[10]=f*e+L*r+O*A;g[11]=t*e+D*r+K*A;a!==g&&(g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]);
return g};a.rotateX=function(a,d,b){var g=Math.sin(d);d=Math.cos(d);var r=a[4],A=a[5],h=a[6],u=a[7],m=a[8],q=a[9],f=a[10],t=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=r*d+m*g;b[5]=A*d+q*g;b[6]=h*d+f*g;b[7]=u*d+t*g;b[8]=m*d-r*g;b[9]=q*d-A*g;b[10]=f*d-h*g;b[11]=t*d-u*g;return b};a.rotateY=function(a,d,b){var g=Math.sin(d);d=Math.cos(d);var r=a[0],A=a[1],h=a[2],u=a[3],m=a[8],q=a[9],f=a[10],t=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=r*d-m*g;b[1]=A*d-q*g;b[2]=h*d-f*g;b[3]=u*d-t*g;b[8]=r*g+m*d;b[9]=A*g+q*d;b[10]=h*g+f*d;b[11]=u*g+t*d;return b};a.rotateZ=function(a,d,b){var g=Math.sin(d);d=Math.cos(d);var r=a[0],A=a[1],h=a[2],u=a[3],m=a[4],q=a[5],f=a[6],t=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=r*d+m*g;b[1]=A*d+q*g;b[2]=h*d+f*g;b[3]=u*d+t*g;b[4]=m*d-r*g;b[5]=q*d-A*g;b[6]=f*d-h*g;b[7]=t*d-u*g;return b};
a.nV=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.mV=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.lV=function(a,d,b){var g=d[0],r=d[1];d=d[2];var A=Math.sqrt(g*g+r*r+d*d),h;if(1E-7>Math.abs(A))return null;A=1/A;g*=A;r*=A;d*=A;A=Math.sin(a);a=Math.cos(a);h=1-a;b[0]=g*g*h+a;b[1]=r*g*h+d*
A;b[2]=d*g*h-r*A;b[3]=0;b[4]=g*r*h-d*A;b[5]=r*r*h+a;b[6]=d*r*h+g*A;b[7]=0;b[8]=g*d*h+r*A;b[9]=r*d*h-g*A;b[10]=d*d*h+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.v5=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=g;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=g;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.w5=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=g;d[1]=0;d[2]=-b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=b;d[9]=0;d[10]=g;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.x5=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=g;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=g;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,b){var g=a[0],r=a[1],A=a[2],h=a[3],u=g+g,m=r+r,q=A+A;a=g*u;var f=g*m,g=g*q,t=r*m,r=r*q,A=A*q,u=h*u,m=h*m,h=h*q;b[0]=1-(t+A);b[1]=f+h;b[2]=g-m;b[3]=0;b[4]=f-h;b[5]=1-(a+A);b[6]=r+u;b[7]=0;b[8]=g+m;b[9]=r-u;b[10]=1-(a+t);b[11]=0;b[12]=d[0];b[13]=d[1];b[14]=d[2];
b[15]=1;return b};a.t5=function(a,d,b,g){var r=a[0],A=a[1],h=a[2],u=a[3],m=r+r,q=A+A,f=h+h;a=r*m;var t=r*q,r=r*f,c=A*q,A=A*f,h=h*f,m=u*m,q=u*q,u=u*f,f=b[0],z=b[1];b=b[2];g[0]=(1-(c+h))*f;g[1]=(t+u)*f;g[2]=(r-q)*f;g[3]=0;g[4]=(t-u)*z;g[5]=(1-(a+h))*z;g[6]=(A+m)*z;g[7]=0;g[8]=(r+q)*b;g[9]=(A-m)*b;g[10]=(1-(a+c))*b;g[11]=0;g[12]=d[0];g[13]=d[1];g[14]=d[2];g[15]=1;return g};a.u5=function(a,d,b,g,r){var A=a[0],h=a[1],u=a[2],m=a[3],q=A+A,f=h+h,t=u+u;a=A*q;var c=A*f,A=A*t,z=h*f,h=h*t,u=u*t,q=m*q,f=m*f,m=
m*t,t=b[0],L=b[1];b=b[2];var D=g[0],G=g[1];g=g[2];r[0]=(1-(z+u))*t;r[1]=(c+m)*t;r[2]=(A-f)*t;r[3]=0;r[4]=(c-m)*L;r[5]=(1-(a+u))*L;r[6]=(h+q)*L;r[7]=0;r[8]=(A+f)*b;r[9]=(h-q)*b;r[10]=(1-(a+z))*b;r[11]=0;r[12]=d[0]+D-(r[0]*D+r[4]*G+r[8]*g);r[13]=d[1]+G-(r[1]*D+r[5]*G+r[9]*g);r[14]=d[2]+g-(r[2]*D+r[6]*G+r[10]*g);r[15]=1;return r};a.fromQuat=function(a,d){var b=a[0],g=a[1],r=a[2],A=a[3],h=b+b,u=g+g,m=r+r,b=b*h,q=g*h,g=g*u,f=r*h,t=r*u,r=r*m,h=A*h,u=A*u,A=A*m;d[0]=1-g-r;d[1]=q+A;d[2]=f-u;d[3]=0;d[4]=q-
A;d[5]=1-b-r;d[6]=t+h;d[7]=0;d[8]=f+u;d[9]=t-h;d[10]=1-b-g;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,b,g,r,A,h){var u=1/(d-a),m=1/(g-b),q=1/(r-A);h[0]=2*r*u;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*r*m;h[6]=0;h[7]=0;h[8]=(d+a)*u;h[9]=(g+b)*m;h[10]=(A+r)*q;h[11]=-1;h[12]=0;h[13]=0;h[14]=A*r*2*q;h[15]=0;return h};a.perspective=function(a,d,b,g,r){a=1/Math.tan(a/2);var A=1/(b-g);r[0]=a/d;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=a;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=(g+b)*A;r[11]=-1;r[12]=
0;r[13]=0;r[14]=2*g*b*A;r[15]=0;return r};a.I8=function(a,d,b,g){var r=Math.tan(a.upDegrees*Math.PI/180),A=Math.tan(a.downDegrees*Math.PI/180),h=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var u=2/(h+a),m=2/(r+A);g[0]=u;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=m;g[6]=0;g[7]=0;g[8]=-((h-a)*u*.5);g[9]=(r-A)*m*.5;g[10]=b/(d-b);g[11]=-1;g[12]=0;g[13]=0;g[14]=b*d/(d-b);g[15]=0;return g};a.ortho=function(a,d,b,g,r,A,h){var u=1/(a-d),m=1/(b-g),q=1/(r-A);h[0]=-2*u;h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=-2*m;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*q;h[11]=0;h[12]=(a+d)*u;h[13]=(g+b)*m;h[14]=(A+r)*q;h[15]=1;return h};a.lookAt=function(g,d,b,y){var r,A,h,u,m,q,f,t,c=g[0],z=g[1];g=g[2];h=b[0];u=b[1];A=b[2];f=d[0];b=d[1];r=d[2];if(1E-7>Math.abs(c-f)&&1E-7>Math.abs(z-b)&&1E-7>Math.abs(g-r))return a.identity(y);d=c-f;b=z-b;f=g-r;t=1/Math.sqrt(d*d+b*b+f*f);d*=t;b*=t;f*=t;r=u*f-A*b;A=A*d-h*f;h=h*b-u*d;(t=Math.sqrt(r*r+A*A+h*h))?(t=1/t,r*=t,A*=t,h*=t):h=A=r=0;u=b*h-f*A;m=f*r-d*h;q=d*A-b*r;(t=Math.sqrt(u*
u+m*m+q*q))?(t=1/t,u*=t,m*=t,q*=t):q=m=u=0;y[0]=r;y[1]=u;y[2]=d;y[3]=0;y[4]=A;y[5]=m;y[6]=b;y[7]=0;y[8]=h;y[9]=q;y[10]=f;y[11]=0;y[12]=-(r*c+A*z+h*g);y[13]=-(u*c+m*z+q*g);y[14]=-(d*c+b*z+f*g);y[15]=1;return y};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.kV=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__math=function(a,g){function l(a,b){for(var d=a[1],f=1,q=2;q<a.length;q++)4!=q&&8!=q&&Math.abs(a[q])>Math.abs(d)&&(d=a[q],f=q);for(var h=Math.floor(f/3),f=f%3,d=.5*Math.atan(2*d/(a[3*h+h]-a[3*f+f])),q=0;q<b.length;q++)b[q]=0==q||4==q||8==q?1:0;b[f+3*h]=-Math.sin(d);b[h+3*f]=Math.sin(d);b[h+3*h]=Math.cos(d);b[f+3*f]=Math.cos(d);return b}function d(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var d=a.content[b];0<b;){var f=(b+1>>1)-1,q=a.content[f];if(a.an(d)<a.an(q))a.content[f]=
d,a.content[b]=q,b=f;else break}}function y(a,b){for(var d=a.content.length,f=a.content[b],q=a.an(f);;){var h=b+1<<1,m=h-1,g=null;if(m<d){var l=a.an(a.content[m]);l<q&&(g=m)}h<d&&a.an(a.content[h])<(null===g?q:l)&&(g=h);if(null!==g)a.content[b]=a.content[g],a.content[g]=f,b=g;else break}}var r=g("__mat3"),A=g("__vec3"),h=new Float32Array(3),u=new Float32Array(9),m=new Float32Array(9),q=new Float32Array(9),f=new Float32Array(9);a.QB=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.xJ=function(a,b){b=b||new Float32Array(3);return A.copy(a,b)};a.Zo=function(a,b){A.copy(b,a)};a.en=function(a,b){A.normalize(b,h);a[3]=h[0];a[4]=h[1];a[5]=h[2]};a.bH=function(a,b,d){d=d||new Float32Array(3);d[0]=a[0]+a[3]*b;d[1]=a[1]+a[4]*b;d[2]=a[2]+a[5]*b};a.jS=function(a,b){b[0]=0;b[1]=0;for(var d=b[2]=0;d<a.length;d+=3)b[0]+=a[d],b[1]+=a[d+1],b[2]+=a[d+2];return A.scale(b,3/a.length,b)};a.bS=function(a,b,d){for(var f=0;f<d.length;f++)d[f]=0;for(f=0;f<a.length;f+=3){var q=a[f]-b[0],
h=a[f+1]-b[1],m=a[f+2]-b[2];d[0]+=q*q;d[1]+=q*h;d[2]+=q*m;d[4]+=h*h;d[5]+=h*m;d[8]+=m*m}d[3]=d[1];d[6]=d[2];d[7]=d[5];for(f=0;f<d.length;f++)d[f]*=3/a.length;return d};a.aV=function(a,b){var h=r.copy(a,u);if(5E-4>d(h))return r.identity(b);var g=l(h,m),D=r.transpose(g,q);r.multiply(h,D,f);r.multiply(g,f,h);for(var G=r.copy(g,b),B=1;5E-4<=d(h)&&100>B;)g=l(h,m),D=r.transpose(g,q),r.multiply(h,D,f),r.multiply(g,f,h),r.multiply(g,G,G),B++;return G};a.pf=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.NR=function(a){return{content:[],an:a}};a.SG=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.OR=function(a){var b=a.content[0],d=a.content.pop();0<a.content.length&&(a.content[0]=d,y(a,0));return b};a.G3=function(a,c){var d=a.content.indexOf(c),f=a.content.pop();d!==a.content.length-1&&(a.content[d]=f,a.an(f)<a.an(c)?b(d):y(d))};a.PR=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__tsr=function(a,g){function l(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function d(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function y(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function r(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function A(a,b,c){var d=b[0],f=b[1],q=b[2],h=b[3],m=b[4],k=b[5],p=b[6];
b=b[7];var g=a[0]*h,e=a[1]*h,w=a[2]*h;a=b*g+k*w-p*e;var h=b*e+p*g-m*w,n=b*w+m*e-k*g,g=-m*g-k*e-p*w;c[0]=a*b+g*-m+h*-p-n*-k;c[1]=h*b+g*-k+n*-m-a*-p;c[2]=n*b+g*-p+a*-k-h*-m;c[0]+=d;c[1]+=f;c[2]+=q;return c}var h=g("__mat4"),u=g("__quat"),m=g("__util"),q=g("__vec3"),f=Math.sin(-Math.PI/4),t=-f,c=new Float32Array(3),z=new Float32Array(4);new Float32Array(4);var L=new Float32Array(16);a.create=l;a.clone=function(a){var c=l();b(a,c);return c};a.HI=function(a,b,c,d,f,q,h,m){var k=l();k[0]=a;k[1]=b;k[2]=
c;k[3]=d;k[4]=f;k[5]=q;k[6]=h;k[7]=m;return k};a.Wl=d;a.l4=function(a){var c=d();b(a,c);return c};a.y5=function(a,b,c,f,q,h,m,g){var k=d();k[0]=a;k[1]=b;k[2]=c;k[3]=f;k[4]=q;k[5]=h;k[6]=m;k[7]=g;return k};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.Ag=y;a.ue=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Le=function(a,b){b[3]=a;return b};a.UD=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.oi=function(a,b){b[4]=a[0];
b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.F=function(a){return a.subarray(0,3)};a.ic=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.td=function(a){return a[3]};a.hW=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.P=function(a){return a.subarray(4,8)};a.ae=r;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],f=a[1],q=a[2];z[0]=a[4];z[1]=a[5];z[2]=a[6];z[3]=a[7];u.invert(z,z);var h=z[0],m=z[1],k=z[2],p=z[3],d=d*c,f=f*c,g=q*c,q=p*d+m*g-k*f,e=p*f+k*d-h*g,w=p*g+h*f-m*d,
d=-h*d-m*f-k*g;b[0]=-(q*p+d*-h+e*-k-w*-m);b[1]=-(e*p+d*-m+w*-h-q*-k);b[2]=-(w*p+d*-k+q*-m-e*-h);b[3]=c;b[4]=h;b[5]=m;b[6]=k;b[7]=p;return b};a.ay=function(a,b){var c=a[3];h.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.fh=function(a,b){var d=m.QK(a,c),f=m.PK(a),q=m.CC(a,z);y(d,f,q,b);return b};a.multiply=function(a,b,c){A(b,a,c);c[3]=a[3]*b[3];var d=a[4],f=a[5],q=a[6];a=a[7];var h=b[4],m=b[5],k=b[6];b=b[7];c[4]=d*b+a*h+f*k-q*m;c[5]=f*b+a*m+q*h-
d*k;c[6]=q*b+a*k+d*m-f*h;c[7]=a*b-d*h-f*m-q*k;return c};a.Q_=function(a,b,c){var d=b[3];b=h.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),L);for(var f=0;12>f;f++)b[f]*=d;h.multiply(b,a,c);return c};a.Gc=A;a.JN=function(a,b,c){var d=b[3],f=a[0]-b[0],q=a[1]-b[1],h=a[2]-b[2];a=b[4];var m=b[5],k=b[6];b=b[7];var p=a*a+m*m+k*k+b*b,p=p?1/p:0;a=-a*p;m=-m*p;k=-k*p;b*=p;var p=b*f+m*h-k*q,g=b*q+k*f-a*h,e=b*h+a*q-m*f,f=-a*f-m*q-k*h;c[0]=p*b+f*-a+g*-k-e*-m;c[1]=g*b+f*-m+e*-a-p*-k;c[2]=e*b+f*-k+p*-m-
g*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.fl=function(a,b,c,d){d||(d=0);var f=a.length,q=b[0],h=b[1],m=b[2],k=b[3],p=b[4],g=b[5],e=b[6];b=b[7];for(var w=0;w<f;w+=3){var n=a[w]*k,t=a[w+1]*k,I=a[w+2]*k,F=b*n+g*I-e*t,l=b*t+e*n-p*I,M=b*I+p*t-g*n,n=-p*n-g*t-e*I;c[d+w]=F*b+n*-p+l*-e-M*-g;c[d+w+1]=l*b+n*-g+M*-p-F*-e;c[d+w+2]=M*b+n*-e+F*-g-l*-p;c[d+w]+=q;c[d+w+1]+=h;c[d+w+2]+=m}return c};a.GE=function(a,b,c,d){d||(d=0);var f=a.length,q=b[3],h=b[4],m=b[5],k=b[6];b=b[7];for(var p=0;p<f;p+=3){var g=a[p]*q,e=
a[p+1]*q,w=a[p+2]*q,n=b*g+m*w-k*e,t=b*e+k*g-h*w,I=b*w+h*e-m*g,g=-h*g-m*e-k*w;c[d+p]=n*b+g*-h+t*-k-I*-m;c[d+p+1]=t*b+g*-m+I*-h-n*-k;c[d+p+2]=I*b+g*-k+n*-m-t*-h}return c};a.Yc=function(a,b,c){var d=b[3],f=b[4],q=b[5],h=b[6];b=b[7];var m=a[0]*d,k=a[1]*d,p=a[2]*d;a=b*m+q*p-h*k;var d=b*k+h*m-f*p,g=b*p+f*k-q*m,m=-f*m-q*k-h*p;c[0]=a*b+m*-f+d*-h-g*-q;c[1]=d*b+m*-q+g*-f-a*-h;c[2]=g*b+m*-h+a*-q-d*-f;return c};a.HE=function(a,b,c,d){d||(d=0);var f=a.length,q=b[3],h=b[4],m=b[5],k=b[6];b=b[7];for(var p=0;p<f;p+=
4){var g=a[p]*q,e=a[p+1]*q,w=a[p+2]*q,n=b*g+m*w-k*e,t=b*e+k*g-h*w,I=b*w+h*e-m*g,g=-h*g-m*e-k*w;c[d+p]=n*b+g*-h+t*-k-I*-m;c[d+p+1]=t*b+g*-m+I*-h-n*-k;c[d+p+2]=I*b+g*-k+n*-m-t*-h;c[d+p+3]=a[p+3]}return c};a.R_=function(a,b,c){b=r(b,z);u.multiply(b,a,c)};a.IN=function(a,b,c,d){d=d||0;b=r(b,z);m.HL(a,b,c,d)};a.translate=function(a,b,c){var d=a[3],f=a[4],q=a[5],h=a[6],m=a[7],k=b[0]*d,p=b[1]*d,g=b[2]*d;b=m*k+q*g-h*p;var d=m*p+h*k-f*g,e=m*g+f*p-q*k,k=-f*k-q*p-h*g;c[0]=a[0]+b*m+k*-f+d*-h-e*-q;c[1]=a[1]+d*
m+k*-q+e*-f-b*-h;c[2]=a[2]+e*m+k*-h+b*-q-d*-f;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.as=function(a,b,c,d){q.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var f=a[3];d[3]=f+c*(b[3]-f);u.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.l5=function(a,b,c,d){var f=a.subarray(0,3),q=b.subarray(0,3),h=d.subarray(0,3);h[0]=q[0]*(c+1)-f[0]*c;h[1]=q[1]*(c+1)-f[1]*c;h[2]=q[2]*(c+1)-f[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);f=d.subarray(4,
8);f[0]=b[0]*(c+1)-a[0]*c;f[1]=b[1]*(c+1)-a[1]*c;f[2]=b[2]*(c+1)-a[2]*c;f[3]=b[3]*(c+1)-a[3]*c;u.normalize(f,f);return d};a.JW=function(a,b,c,d,f){f[0]=a[0]+b*c[0];f[1]=a[1]+b*c[1];f[2]=a[2]+b*c[2];f[3]=a[3];c=d[0];var q=d[1];d=d[2];var h=a[4],m=a[5],k=a[6],p=a[7];f[4]=.5*(c*p+q*k-d*m);f[5]=.5*(q*p+d*h-c*k);f[6]=.5*(d*p+c*m-q*h);f[7]=.5*(-c*h-q*m-d*k);f[4]=a[4]+f[4]*b;f[5]=a[5]+f[5]*b;f[6]=a[6]+f[6]*b;f[7]=a[7]+f[7]*b;a=f[4];b=f[5];c=f[6];q=f[7];a=a*a+b*b+c*c+q*q;0<a&&(a=1/Math.sqrt(a),f[4]*=a,f[5]*=
a,f[6]*=a,f[7]*=a)};a.I$=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var c=a[4],d=a[5],q=a[6],h=a[7];b[4]=c*t+h*f;b[5]=d*t+q*f;b[6]=q*t-d*f;b[7]=h*t-c*f};a.H$=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__batch=function(a,g){function l(a){a={type:a,vb:"",id:0,Wq:-1,Ek:"",fv:-1,Yn:-1,mr:0,Hf:0,am:[],ya:[],Od:[],Qg:[],wd:[],Zj:[],Gj:null,ad:{},zb:null,hb:{Eg:null,df:null,Ui:[],ug:[],status:Y.Nz,hV:0,R0:0,GG:0,yN:0},Ck:"",xq:[],Ca:null,Re:J.bk(),Qe:!1,Ti:!1,gv:!1,zs:0,Qm:0,tw:0,uw:0,jd:!1,Rv:0,Ur:0,ne:new Float32Array(3),De:new Float32Array(16),Mg:!1,Lb:!1,Ua:!1,Fh:!1,$b:!1,Pe:!1,gg:!1,Me:!1,ve:!1,je:!1,he:!1,Kd:!1,Jd:!1,lv:!1,Uh:ia.Cn,yf:!1,kg:!1,dk:!1,Sg:!1,lf:ya.bq,mh:0,nh:0,Vd:-1,Hd:-1,
Wv:!1,$v:0,Xv:0,aw:0,bw:0,Zv:new Float32Array(3),Yv:new Float32Array(3),Wr:!1,Oj:0,fk:0,cm:1,So:0,ip:0,ht:1,Ko:0,bm:0,Dl:1,Qw:0,vs:0,vg:0,nx:0,Xd:new Float32Array(2),$k:new Float32Array(3),ti:new Float32Array(3),jn:new Float32Array(3),fg:new Float32Array(4),Xi:new Float32Array(4),Jm:null,zo:null,ms:null,ls:null,ok:!1,wireframe_edge_color:ma.create(),Ij:!1,water_dynamic:!1,Et:!1,vy:!1,wy:0,xy:0,uy:0,Ip:.1,ap:0,cp:0,jo:0,xv:new Float32Array(2),wv:new Float32Array(2),Dr:new Float32Array(2),$o:new Float32Array(3),
bp:new Float32Array(3),nj:null,Ok:!1,gb:null,ww:0,El:null,Es:null,mj:[],lj:[],Ie:[],kj:[],S:null,Ta:null,wa:null,kb:null,pb:null,ba:null,Zf:!1,eg:!0,kK:0,Io:new Float32Array(3)};a.fg[3]=1;a.Ua=!0;a.ww=1;return a}function d(a){var b=l(a.type);b.vb=a.vb;b.id=a.id;b.Wq=a.Wq;b.Ek=a.Ek;b.fv=a.fv;b.Yn=a.Yn;b.mr=a.mr;b.Hf=a.Hf;b.am=[];b.ya=a.ya.slice();b.Od=a.Od.slice();b.Qg=a.Qg.slice();b.wd=a.wd.slice();b.Zj=a.Zj.slice();b.Gj=J.T(a.Gj);b.ad=J.T(a.ad);b.zb=a.zb;b.hb=J.T(a.hb);b.Ck=a.Ck;b.xq=xa.US(a.xq);
b.Ca=a.Ca;b.Qe=a.Qe;b.Ti=a.Ti;b.gv=a.gv;b.zs=a.zs;b.Qm=a.Qm;b.tw=a.tw;b.uw=a.uw;b.Rv=a.Rv;b.Ur=a.Ur;b.ne=a.ne;b.De=a.De;b.Mg=a.Mg;b.Lb=a.Lb;b.Ua=a.Ua;b.Fh=a.Fh;b.$b=a.$b;b.Pe=a.Pe;b.gg=a.gg;b.Me=a.Me;b.ve=a.ve;b.je=a.je;b.he=a.he;b.Kd=a.Kd;b.Jd=a.Jd;b.jd=a.jd;b.lv=a.lv;b.Uh=a.Uh;b.yf=a.yf;b.kg=a.kg;b.dk=a.dk;b.Sg=a.Sg;b.lf=a.lf;b.mh=a.mh;b.nh=a.nh;b.Vd=a.Vd;b.Hd=a.Hd;b.Wv=a.Wv;b.$v=a.$v;b.Xv=a.Xv;b.aw=a.aw;b.bw=a.bw;ma.copy(a.Zv,b.Zv);ma.copy(a.Yv,b.Yv);b.Wr=a.Wr;b.Oj=a.Oj;b.fk=a.fk;b.cm=a.cm;b.So=
a.So;b.ip=a.ip;b.ht=a.ht;b.Ko=a.Ko;b.bm=a.bm;b.Dl=a.Dl;b.Qw=a.Qw;b.vs=a.vs;b.vg=a.vg;b.nx=a.nx;b.Xd[0]=a.Xd[0];b.Xd[1]=a.Xd[1];ma.copy(a.$k,b.$k);ma.copy(a.ti,b.ti);ma.copy(a.jn,b.jn);pa.copy(a.fg,b.fg);pa.copy(a.Xi,b.Xi);b.Jm=J.T(a.Jm);a.zo&&(b.zo=new Float32Array(a.zo),b.ms=new Float32Array(a.ms),b.ls=new Float32Array(a.ls));b.ok=a.ok;ma.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.Ij=a.Ij;b.water_dynamic=a.water_dynamic;b.Et=a.Et;b.vy=a.vy;b.wy=a.wy;b.xy=a.xy;b.uy=a.uy;b.Ip=a.Ip;b.ap=
a.ap;b.cp=a.cp;b.jo=a.jo;b.xv.set(a.xv);b.wv.set(a.wv);b.Dr.set(a.Dr);ma.copy(a.$o,b.$o);ma.copy(a.bp,b.bp);b.nj=J.T(a.nj);b.Ok=a.Ok;b.gb=J.T(a.gb);b.ww=a.ww;a.El&&(b.El=new Float32Array(a.El));b.Es=J.T(a.Es);b.mj=J.T(a.mj);b.lj=J.T(a.lj);b.Ie=J.T(a.Ie);b.kj=J.T(a.kj);b.S=P.Rl(a.S);b.Ta=P.Rl(a.Ta);b.ba=P.Uq(a.ba);b.pb=P.Uq(a.pb);b.wa=P.Sl(a.wa);b.kb=P.Sl(a.kb);b.Zf=a.Zf;b.eg=a.eg;b.Io=a.Io;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.vb=a.Lb?a.Fh?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.vb=a.ve?"CAST":"RECEIVE";break;case "COLOR_ID":a.vb=a.Fh?"COLOR_ID_XRAY":"COLOR_ID"}}function y(a,b,e){var c=[],d=h(e,b,!b.ao,!1),k=a.data,f=k.materials,v=Array(f.length),q=Array(f.length),H=[],F=oa.hc(e,ua.Pb),m=!1;F&&(m=F.qs.length?!0:!1);for(var g=0;g<d.length;g++)for(var I=d[g],P=0;P<f.length;P++){var t=f[P];if(!ia.aK(k,P))if("PHYSICS"==I&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)H.push(ia.yB(k,P,[],b.Li,{},null));else if(!t.b4w_lens_flares||m){var R=l(I);
"MAIN"==I?v[P]=R:"DEBUG_VIEW"==I&&(q[P]=R);R.Wq=a.b4w_cluster_data.cluster_id;if(n(R,t)){"SHADOW"==I&&v[P]&&(R.Pe=v[P].Pe);R.Uh=b.Qe||b.gg?ia.Mt:ia.Cn;C(R,b);for(var V=R,ba=a.particle_systems,M=0;M<ba.length;M++){var T=ba[M].settings.b4w_vcol_from_name,aa=ba[M].settings.b4w_vcol_to_name;""!==T&&""!==aa&&(V.ad[T]={pm:!1,src:[{name:T,pg:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==R.type)R.Ek=a.uuid;R.dk=a.b4w_do_not_cull;"MAIN"==R.type&&(R.Sg=a.b4w_caustics);x(R,"DISABLE_FOG",("COLOR_ID"!=I&&"SHADOW"!=
I&&a.b4w_disable_fogging)|0);var ca=ia.yB(k,P,R.Zj,b.Li,R.ad,R.Gj);!t.use_tangent_shading||"a_shade_tangs"in ca.aa[0]||(x(R,"CALC_TBN",1),p(R,"a_tbn_quat"));t.b4w_lens_flares&&(ca=na.yY(ca));ea(R);c.push({za:R,mf:b,Eu:b,Vf:ca,qg:[t.name],Ld:[a]})}}}if(H.length){R=l("PHYSICS");R.vb="NAVMESH";R.Ek=a.uuid;for(var ca=ia.lN(H),fa=[],g=0;g<f.length;g++)fa.push(f[g].name);ea(R);c.push({za:R,mf:b,Eu:b,Vf:ca,qg:fa,Ld:[a]})}for(g=0;g<q.length;g++)q[g]&&(q[g].Yn=v[g].id,ea(q[g]));var z=a.particle_systems;if(0<
z.length&&c.length){for(var r=!1,W=!1,g=0;g<z.length;g++){var X=z[g],Q=X.settings;Q.use_render_emitter&&(r=!0);"HAIR"!=Q.type||"OBJECT"!=Q.render_type&&"GROUP"!=Q.render_type&&X.transforms.length||(W=!0);if(r&&W)break}var Z=c[0].za.ad,B;if(W){var E;if(1<f.length){for(var sa={},D=0;D<z.length;D++){var L=z[D].settings;if("HAIR"==L.type&&("OBJECT"==L.render_type||"GROUP"==L.render_type)){var xa=L.b4w_vcol_from_name,Ia=L.b4w_vcol_to_name;""!==xa&&""!==Ia&&(sa[xa]=J.T(Z[xa]))}}"a_bending_col_main"in Z&&
(sa.a_bending_col_main=J.T(Z.a_bending_col_main));"a_bending_col_detail"in Z&&(sa.a_bending_col_detail=J.T(Z.a_bending_col_detail));E=ia.yI(k,[],sa)}else E=c[0].Vf;B=E}else B=null;for(var Aa=B,G=a.nb,Ca=[],y=a.particle_systems,O=a.data,la=0;la<y.length;la++){var kb=y[la],Va=kb.settings;if(Va.count)if("EMITTER"==Va.type){if("DYNAMIC"==b.type){var pb=l("PARTICLES");pb.wa=b.wa;pb.S=b.S;pb.ba=b.ba;pb.kb=b.kb;pb.Ta=b.Ta;pb.pb=b.pb;var pa,K=O.materials,A=kb.settings.material-1;A>=K.length&&(ha.warn('Wrong material used for rendering particle system "'+
kb.name+'"'),A=0);pa=K[A];"HALO"===kb.settings.render_type&&"HALO"===pa.type&&(pb.Wr=!0);u(pb,pa);var qa=pb,Da=a,ta=kb.settings;switch(ta.b4w_billboard_align){case "VIEW":x(qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":x(qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":x(qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":x(qa,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:J.q("Wrong billboard align value")}x(qa,"BILLBOARD",0);var za=ta.b4w_enable_soft_particles&&
ya.tH(Da,ta);x(qa,"SOFT_PARTICLES",0<ta.b4w_particles_softness&&za&&ja.kv?1:0);x(qa,"SOFT_STRENGTH",Y.O(ta.b4w_particles_softness));Y.ha(qa.hb,"WORLD_SPACE","WORLD"==ta.b4w_coordinate_system?1:0);pb.gg=!0;pb.dk=a.b4w_do_not_cull;pb.Ek=G.name+"_"+Va.uuid;na.FW(pb,kb,pa);var Sa=na.uV(pb,O,kb,G.k);na.v0(Sa,pb,Va.count);na.u0(G);C(pb,G.k);ea(pb);Ca.push({za:pb,mf:b,Eu:b,Vf:Sa,qg:[pa.name],Ld:[a]})}}else if("HAIR"==Va.type){var Fa=J.jw(kb.seed),Na=ra.uH(ja.zC)&&!Va.b4w_initial_rand_rotation&&!Va.b4w_hair_billboard,
Eb=4;Na&&(Eb=8);if(kb.transforms.length)var qb=kb.transforms;else for(var lb=ia.EB(Aa,Va.count,!1,Fa),qb=new Float32Array(lb.length*Eb),mb=0;mb<lb.length;mb++){var Yc=.75+.5*J.yg(Fa);qb[mb*Eb]=lb[mb][0];qb[mb*Eb+1]=lb[mb][1];qb[mb*Eb+2]=lb[mb][2];qb[mb*Eb+3]=Yc;Na&&(qb[mb*Eb+4]=1,qb[mb*Eb+5]=0,qb[mb*Eb+6]=0,qb[mb*Eb+7]=0)}var wc=oa.hc(e,ua.Di)?!0:!1;if("OBJECT"==Va.render_type){var gc=[h(e,Va.dupli_object.nb.k,!b.ao,!0)],Fb=w(a,b,Z,Aa,[Va.dupli_object],gc,[qb],Va,kb,wc,Fa,!1);Ca.push.apply(Ca,Fb)}else if("GROUP"==
Va.render_type){for(var $b=Va.dupli_group.objects,gc=[],mb=0;mb<$b.length;mb++){var xc=h(e,$b[mb].nb.k,!b.ao,!0);gc.push(xc)}for(var Rb=!1,hc=[],mb=0;mb<$b.length;mb++)hc.push($b[mb].nb);if(Va.use_whole_group){for(var yc,tb=qb,$a=hc,Ic=Na,dd=Eb,Gb={},Yb=new Float32Array([0,0,0,1]),gb=0;gb<tb.length;gb+=dd)for(var ub=0;ub<$a.length;ub++){var zb=ma.create(),Zc=N.td($a[ub].k.n),Rc=N.F($a[ub].k.n);ma.scale(Rc,Zc,zb);var ic=ma.clone([tb[gb],tb[gb+1],tb[gb+2]]);Gb[ub]||(Gb[ub]=new Float32Array(tb.length));
Ic&&(Gb[ub][gb+4]=Yb[0]=tb[gb+4],Gb[ub][gb+5]=Yb[1]=tb[gb+5],Gb[ub][gb+6]=Yb[2]=tb[gb+6],Gb[ub][gb+7]=Yb[3]=tb[gb+7],J.oD(Yb,Yb),J.P_(zb,Yb,zb));ma.add(ic,zb,ic);Gb[ub][gb]=ic[0];Gb[ub][gb+1]=ic[1];Gb[ub][gb+2]=ic[2];Gb[ub][gb+3]=tb[gb+3]}yc=Gb;Rb=!0}else{var mc;if(Va.use_group_count){for(var Kb=qb,nc=hc,oc=Va.dupli_weights,Sc=Fa,zc=Na,pc=Eb,Lb={},Ya=[],Pa=0;Pa<nc.length;Pa++)for(var Sb=nc[Pa],jc=Sb.Rm||Sb.name,Wa=0;Wa<oc.length;Wa++){var Ab=oc[Wa];jc==Ab.name&&Ya.push(Ab)}oc.length!=Ya.length&&ha.error("dupli weights match failed");
for(Pa=0;Pa<Kb.length;Pa+=pc){for(var Mb,Tb=Ya,ac=[0],Hb=0;Hb<Tb.length;Hb++)ac[Hb+1]=ac[Hb]+Tb[Hb].count;for(var Bb=ac[ac.length-1]*J.yg(Sc),ab=0,Hb=0;Hb<ac.length;Hb++)if(Bb>=ac[Hb]&&Bb<ac[Hb+1]){ab=Hb;break}Mb=ab;Lb[Mb]=Lb[Mb]||[];Lb[Mb].push(Kb[Pa],Kb[Pa+1],Kb[Pa+2],Kb[Pa+3]);zc&&Lb[Mb].push(Kb[Pa+4],Kb[Pa+5],Kb[Pa+6],Kb[Pa+7])}for(Mb in Lb)Lb[Mb]=new Float32Array(Lb[Mb]);mc=Lb}else{for(var Cb=qb,Ka=Fa,bc=Na,Ma=Eb,cc=hc.length,Ha={},wb=0;wb<Cb.length;wb+=Ma){var Pb=Math.floor(cc*J.yg(Ka));Ha[Pb]=
Ha[Pb]||[];Ha[Pb].push(Cb[wb],Cb[wb+1],Cb[wb+2],Cb[wb+3]);bc&&Ha[Pb].push(Cb[wb+4],Cb[wb+5],Cb[wb+6],Cb[wb+7])}for(Pb in Ha)Ha[Pb]=new Float32Array(Ha[Pb]);mc=Ha}yc=mc}Fb=w(a,b,Z,Aa,$b,gc,yc,Va,kb,wc,Fa,Rb);Ca.push.apply(Ca,Fb)}"INSTANCE"==Va.b4w_wind_bend_inheritance&&G.k.xf&&ha.warn('Emitter object "'+G.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else J.q("Unknown particle settings type")}r?
c.push.apply(c,Ca):c=Ca}return c}function r(a){for(var b=[],e=[],c={},d=0;d<a.length;d++){var k=a[d].za,n=null;if(k.id in c){var f=c[k.id],v=e[f].za;I(k,function(a){I(v,function(b){J.w_(a,b)&&1!=a.kK&&(n=e[f])})});if(!n){do k.id++;while(c[k.id])}}n||(n={za:k,iL:[],KG:[],nN:[],Ld:[],LL:[],qg:[]},c[k.id]=e.length,e.push(n));if(a[d].Vf&&a[d].Vf.Ja){n.iL.push(a[d].mf);n.KG.push(a[d].Eu);n.nN.push(a[d].Vf);for(var p=0;p<a[d].Ld.length;p++)k=a[d].Ld[p],-1==n.LL.indexOf(k.uuid)&&(n.Ld.push(k),n.LL.push(k.uuid));
for(p=0;p<a[d].qg.length;p++)k=a[d].qg[p],-1==n.qg.indexOf(k)&&n.qg.push(k)}n.qg.sort()}for(d=0;d<e.length;d++){var k=e[d].za,q=e[d].iL,w=e[d].KG,H=e[d].nN;a=ya.BA(w[0]);if("STATIC"==a.type)for(p=0;p<q.length;p++){var h=q[p],F=w[p],c=H[p],m=N.identity(za);h.Og&&!h.Cq?(h=N.ic(h.n,Ca),N.ue(h,m)):N.copy(h.n,m);F.Em?c.Qf||(F.Og?ia.y_(c,m):ia.Xx(c,m)):ia.Xx(c,m);if(F.Em)x(k,"AU_QUALIFIER","GLSL_IN");else if(1<e[d].Ld.length){h={};if(F.xf||F.Og)h.au_center_pos=[m[0],m[1],m[2]];F.xf&&(h.au_wind_bending_amp=
[F.Dh],h.au_wind_bending_freq=[F.Eh],h.au_detail_bending_amp=[F.Xg],h.au_detail_bending_freq=[F.Yg],h.au_branch_bending_amp=[F.Rg]);ia.x_(c,h);x(k,"AU_QUALIFIER","GLSL_IN")}else a.Mq.set(m.subarray(0,3)),F.Mq.set(m.subarray(0,3)),x(k,"AU_QUALIFIER","uniform")}if(0==H.length)c=ia.Pf(J.ot("%empty"));else if(1==H.length)c=H[0];else{c=[];for(p=0;p<H.length;p++)ia.UW(H[p])||c.push(p);if(c.length<H.length)for(p=0;p<c.length;p++)ia.Yx(H[c[p]]);c=ia.lN(H)}if(1<e[d].Ld.length){H=[];for(p=0;p<e[d].Ld.length;p++)P.xB(e[d].Ld[p].nb.k.MG,
H);P.LG(H,a.Ta);P.Tn(a.Ta,a.S);a.pb=P.Wu(J.Jf(H),!0);P.HA(a.pb,a.ba);a.kb=P.fr(a.pb);P.JA(a.kb,a.wa)}a.Zf=P.mC(a.ba,a.wa);"STATIC"==a.type&&a.wo&&(p=e[d].Ld[0].b4w_cluster_data,p.cluster_center&&p.cluster_radius?(a.ss.set(p.cluster_center),a.ts=p.cluster_radius):(a.ss.set(a.kb.G),a.ts=a.kb.Xa));"PARTICLES"!=k.type&&(p=c.Wf,k.S=P.Rl(p.S),k.ba=P.Uq(p.ba),k.wa=a.wa.Xa<p.wa.Xa?"STATIC"==a.type?P.Sl(a.kb):P.Sl(a.wa):P.Sl(p.wa),"STATIC"==a.type?(k.pb=k.ba,k.Ta=k.S,k.kb=k.wa):(p=a.n,k.pb=P.Fq(k.ba,p),k.kb=
P.Gq(k.wa,p),k.Ta=P.Ol(k.S,p)),k.Zf=P.mC(k.ba,k.wa));b.push({za:k,k:a,Vf:c,qg:e[d].qg,Ld:e[d].Ld})}return b}function A(a,b,e,c){a.Aq=P.PG(b,c);a.yq=P.NG(e,c);a.zq=P.OG(b,c)}function h(a,b,e,c){var d=[];c||(b.Sk&&oa.hc(a,ua.zf)||b.Wc&&oa.hc(a,ua.Kg))&&d.push("COLOR_ID");e&&(d.push("MAIN"),d.push("NODES_GLOW"),oa.hc(a,ua.Bf)&&d.push("DEBUG_VIEW"),oa.hc(a,ua.Df)&&d.push("SHADOW"),oa.hc(a,ua.Di)&&d.push("GRASS_MAP"));d.push("PHYSICS");if(b.ve||b.Kd)for(a=null,b.ve&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),b.Kd&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?J.xR(a,b):b),b=a,a=0;a<b.length;a++)e=d.indexOf(b[a]),-1!==e&&d.splice(e,1);return d}function u(a,b){var e;switch(a.type){case "MAIN":if(b.b4w_do_not_render)e=!1;else{if(b.use_nodes&&"HALO"!=b.type)D(a,b,"MAIN");else{f(a,b);e=b.game_settings.alpha_blend;a.Fh=b.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;a.vg=b.offset_z;a.ti.set([1,1,1]);var d=b.texture_slots;pa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.fg);if(b.b4w_lens_flares){T(a,"lens_flares.glslv","lens_flares.glslf");p(a,"a_position");p(a,"a_texcoord");var k=sa.le(d[0]),n=d[0].texture;M(a,k,"u_sampler",n.name)}else{T(a,"main.glslv","main_stack.glslf");b.use_shadeless||(e=ba.QA(b.uuid,b.name,{Pe:b.use_shadeless,qr:b.diffuse_shader,it:b.specular_shader,tn:b.use_tangent_shading}),a.hb.ug=ba.Su(e));var H=t("use_map_color_diffuse",d),w=t("use_map_color_spec",d),h=t("use_map_normal",d),F=t("use_map_mirror",d),g=t("use_stencil",d);e=H[0];
w=w[0];h=h[0];F=F[0];H=H[1];d=g[0]&&t("use_rgb_to_intensity",d)[0];if(e){n=e.texture;switch(e.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}k=sa.le(e);M(a,k,"u_colormap0",n.name);a.bm=e.diffuse_color_factor;a.Dl=e.use_map_alpha?e.alpha_factor:0;a.ti.set(e.scale)}g=e&&e==w;w&&(g||(n=w.texture,k=sa.le(w),M(a,k,"u_specmap0",n.name)),a.ip=w.specular_color_factor);if(h&&(n=h.texture,p(a,"a_tbn_quat"),
k=sa.le(h),M(a,k,"u_normalmap0",n.name),a.Qw=h.normal_factor,n.b4w_use_map_parallax&&ja.Yw)){var k=Y.O(n.b4w_parallax_steps),I=Y.O(n.b4w_parallax_lod_dist);x(a,"PARALLAX",1);x(a,"PARALLAX_STEPS",k);x(a,"PARALLAX_LOD_DIST",I);a.Ko=n.b4w_parallax_scale}F&&(n=F.texture,k=sa.le(F),M(a,k,"u_mirrormap",n.name),a.vs=F.mirror_factor);if(F=e&&H&&d?1:0)k=sa.le(H),n=H.texture,M(a,k,"u_colormap1",n.name),k=sa.le(d),n=d.texture,M(a,k,"u_stencil0",n.name);(n=e||w||h)&&a.ti.set(n.scale);x(a,"TEXTURE_SPEC",void 0==
w?0:1);x(a,"ALPHA_AS_SPEC",g?1:0);x(a,"TEXTURE_STENCIL_ALPHA_MASK",F);p(a,"a_position");p(a,"a_tbn_quat");(e||w||h)&&p(a,"a_texcoord");if(b.b4w_water){a.Ij=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Lb?(ha.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.Et=!1):a.Et="REFLECT"!=a.vb?b.b4w_water_shore_smoothing:!1;T(a,"water.glslv","water.glslf");F=ba.QA(b.uuid,b.name,{Pe:!1,qr:b.diffuse_shader,it:b.specular_shader,tn:b.use_tangent_shading});
a.hb.ug=ba.Su(F);p(a,"a_position");ja.tO?(p(a,"a_polyindex"),a.Ua=!0,ma.set(0,0,0,a.wireframe_edge_color),v.UB()?x(a,"DEBUG_WIREFRAME",1):x(a,"DEBUG_WIREFRAME",2)):x(a,"DEBUG_WIREFRAME",0);g=b.texture_slots;F=t("use_map_normal",g);k=t("use_map_mirror",g)[0];F.length&&(I=sa.le(F[0]),n=F[0].texture,M(a,I,"u_normalmap0",n.name),a.Ip=b.b4w_water_norm_uv_velocity);x(a,"NUM_NORMALMAPS",F.length);a.nj=Array(F.length);for(n=0;n<F.length;n++)a.nj[n]=new Float32Array(2),a.nj[n].set([F[n].scale[0],F[n].scale[1]]);
k&&(I=sa.le(k),n=k.texture,M(a,I,"u_mirrormap",n.name),a.vs=k.mirror_factor);k=null;if(ja.Cr)for(n=0;n<g.length;n++){var P=g[n];if(!0===P.texture.b4w_water_foam){k=P;break}}k&&(x(a,"FOAM",1),I=sa.le(k),n=k.texture,M(a,I,"u_foam",n.name),a.jo=b.b4w_foam_factor,a.xv.set(n.b4w_foam_uv_freq),a.wv.set(n.b4w_foam_uv_magnitude),a.Dr[0]=k.scale[0],a.Dr[1]=k.scale[1]);for(n=0;n<g.length;n++)if(P=g[n],!0===P.texture.b4w_shore_dist_map){var R=P;break}R&&ja.vu&&(g=sa.le(R),n=R.texture,M(a,g,"u_shore_dist_map",
n.name),x(a,"SHORE_PARAMS",1),R=P.texture.b4w_shore_boundings,x(a,"MAX_SHORE_DIST",Y.O(P.texture.b4w_max_shore_dist)),x(a,"SHORE_MAP_SIZE_X",Y.O(R[0]-R[1])),x(a,"SHORE_MAP_SIZE_Y",Y.O(R[2]-R[3])),x(a,"SHORE_MAP_CENTER_X",Y.O((R[0]+R[1])/2)),x(a,"SHORE_MAP_CENTER_Y",Y.O((R[2]+R[3])/2)));b.b4w_generated_mesh?(x(a,"GENERATED_MESH",1),a.vy=!0,a.wy=b.b4w_water_num_cascads,a.xy=b.b4w_water_subdivs,a.uy=b.b4w_water_detailed_dist):(p(a,"a_tbn_quat"),(k||F.length)&&p(a,"a_texcoord"),x(a,"GENERATED_MESH",0));
if(b.b4w_water_dynamic){var P=Y.O(b.b4w_water_dst_noise_scale0),R=Y.O(b.b4w_water_dst_noise_scale1),F=Y.O(b.b4w_water_dst_noise_freq0),g=Y.O(b.b4w_water_dst_noise_freq1),n=Y.O(b.b4w_water_dir_min_shore_fac),k=Y.O(b.b4w_water_dir_freq),I=Y.O(b.b4w_water_dir_noise_scale),V=Y.O(b.b4w_water_dir_noise_freq),l=Y.O(b.b4w_water_dir_min_noise_fac),aa=Y.O(b.b4w_water_dst_min_fac),ca=Y.O(b.b4w_water_waves_hor_fac);x(a,"DST_NOISE_SCALE_0",P);x(a,"DST_NOISE_SCALE_1",R);x(a,"DST_NOISE_FREQ_0",F);x(a,"DST_NOISE_FREQ_1",
g);x(a,"DIR_MIN_SHR_FAC",n);x(a,"DIR_FREQ",k);x(a,"DIR_NOISE_SCALE",I);x(a,"DIR_NOISE_FREQ",V);x(a,"DIR_MIN_NOISE_FAC",l);x(a,"DST_MIN_FAC",aa);x(a,"WAVES_HOR_FAC",ca)}z(a,b);L(a,b);a.$o.set(b.b4w_shallow_water_col);a.bp.set(b.b4w_shore_water_col);a.ap=b.b4w_shallow_water_col_fac;a.cp=b.b4w_shore_water_col_fac;x(a,"ABSORB",Y.O(b.b4w_water_absorb_factor));x(a,"SSS_STRENGTH",Y.O(b.b4w_water_sss_strength));x(a,"SSS_WIDTH",Y.O(b.b4w_water_sss_width))}"HALO"===b.type&&(T(a,"halo.glslv","halo.glslf"),m(a,
b),a.Zj=["a_position"]);b.use_tangent_shading&&(x(a,"USE_TBN_SHADING",1),p(a,"a_shade_tangs"));x(a,"TEXCOORD",0);x(a,"NORMAL_TEXCOORD",0);e&&q(a,e,"TEXTURE_COLOR0_CO");H&&q(a,H,"TEXTURE_COLOR1_CO");d&&q(a,d,"TEXTURE_STENCIL_ALPHA_MASK_CO");w&&q(a,w,"TEXTURE_SPEC_CO");h&&q(a,h,"TEXTURE_NORM_CO");x(a,"SHADELESS",b.use_shadeless?1:0);a.Pe=b.use_shadeless}e=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===e?0:1);x(a,"ALPHA_CLIP","CLIP"===e?1:0);x(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);b.use_vertex_color_paint?(x(a,"VERTEX_COLOR",1),p(a,"a_color")):x(a,"VERTEX_COLOR",0);a.Oj=b.ambient;a.cm=b.diffuse_intensity;a.fk=b.emit;a.jn.set(b.specular_color);a.ht=b.specular_alpha;z(a,b);L(a,b);b.b4w_wettable?x(a,"WETTABLE",1):x(a,"WETTABLE",0);c(a,b);b.b4w_refractive&&!a.Lb?(ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.Ok=!1):a.Ok=b.b4w_refractive;a.nx=b.b4w_refr_bump}e=!0}break;case "NODES_GLOW":e=D(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||
b.b4w_do_not_render||"HALO"===b.type)e=!1;else if(f(a,b),a.Lb)e=!1;else{w=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==w?D(a,b,"SHADOW"):T(a,"shadow.glslv","shadow.glslf");pa.set(0,0,0,b.alpha,a.fg);p(a,"a_position");p(a,"a_tbn_quat");x(a,"ALPHA","OPAQUE"===w?0:1);a.ti.set([1,1,1]);if((e=t("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===w){switch(e.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ti.set(e.scale);
x(a,"TEXTURE_COLOR",1);p(a,"a_texcoord");w=sa.le(e);e=e.texture;"IMAGE"!=w.source&&"ENVIRONMENT_MAP"!=w.source&&"CANVAS"!=w.source&&"NONE"!=w.source||M(a,w,"u_colormap0",e.name)}else x(a,"TEXTURE_COLOR",0);e=!0}break;case "PHYSICS":b.b4w_collision?(a.wt=b.b4w_use_ghost,a.cc=b.b4w_collision_id,a.Zq=b.b4w_collision_margin,a.Xq=b.b4w_collision_group,a.$q=b.b4w_collision_mask,a.lm=b.physics.friction,a.fm=b.physics.elasticity,e=!0):b.b4w_water?(a.Ij=!0,a.$0=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,e=!0):e=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)e=!1;else{f(a,b);a.yf=!1;a.Ua=!0;a.Lb=!1;w=b.game_settings.alpha_blend;a.Fh=b.b4w_render_above_all&&"OPAQUE"!=w&&"CLIP"!=w;b.use_nodes&&"CLIP"==w?D(a,b,"COLOR_ID"):T(a,"color_id.glslv","color_id.glslf");pa.set(0,0,0,b.alpha,a.fg);p(a,"a_position");x(a,"ALPHA","OPAQUE"===w?0:1);a.ti.set([1,1,1]);e=t("use_map_color_diffuse",b.texture_slots)[0];w="CLIP"===w?1:0;x(a,"ALPHA_CLIP",w);if(e&&w){switch(e.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ti.set(e.scale);x(a,"TEXTURE_COLOR",1);p(a,"a_texcoord");w=sa.le(e);e=e.texture;"IMAGE"!=w.source&&"ENVIRONMENT_MAP"!=w.source&&"CANVAS"!=w.source&&"NONE"!=w.source||M(a,w,"u_colormap0",e.name)}else x(a,"TEXTURE_COLOR",0);e=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?e=!1:(f(a,b),a.Lb=!1,a.yf=!1,a.Ua=!0,T(a,"grass_map.glslv","grass_map.glslf"),p(a,"a_position"),e=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,w=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.ad.a_grass_size={pm:!0,src:[]},e?(a.ad.a_grass_size.src.push({name:e,pg:4}),x(a,"DYNAMIC_GRASS_SIZE",1)):x(a,"DYNAMIC_GRASS_SIZE",0),a.ad.a_grass_color={pm:!0,src:[]},w?(a.ad.a_grass_color.src.push({name:w,pg:7}),x(a,"DYNAMIC_GRASS_COLOR",1)):x(a,"DYNAMIC_GRASS_COLOR",0),x(a,"GRASS_TEXTURE_SIZE",Y.O(ta.Vr)),e=!0);break;case "DEBUG_VIEW":e=E(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)e=!1;else{e=b.texture_slots;if(a.Wr)T(a,"particle_system.glslv","particle_system_stack.glslf"),
x(a,"HALO_PARTICLES",1),m(a,b);else{w={Pe:!1,qr:b.diffuse_shader,it:b.specular_shader,tn:b.use_tangent_shading};if(b.use_nodes){T(a,"particle_system.glslv","particle_system.glslf");D(a,b,"PARTICLES");e=!0;break a}T(a,"particle_system.glslv","particle_system_stack.glslf");w=ba.QA(b.uuid,b.name,w);a.hb.ug=ba.Su(w);if(e=t("use_map_color_diffuse",e)[0]){x(a,"TEXTURE_COLOR",1);switch(e.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.bm=e.diffuse_color_factor;a.Dl=e.use_map_alpha?e.alpha_factor:0;w=sa.le(e);M(a,w,"default"+String(a.ya.length),e.texture.name)}}pa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.fg);a.Oj=b.ambient;a.cm=b.diffuse_intensity;a.fk=b.emit;a.jn.set(b.specular_color);a.ht=b.specular_alpha;p(a,"a_position");p(a,"a_tbn_quat");e=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===e?0:1);x(a,"ALPHA_CLIP","CLIP"===e?1:0);x(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);z(a,b);L(a,b);f(a,b);e=b.game_settings.alpha_blend;a.Fh=b.b4w_render_above_all&&"OPAQUE"!=e&&"CLIP"!=e;a.vg=b.offset_z;e=!0}break;default:J.q("Wrong batch type: "+a.type)}return e}function m(a,b){var e=b.halo;x(a,"NUM_RINGS",e.ring_count);x(a,"NUM_LINES",e.line_count);x(a,"NUM_STARS",e.star_tip_count);x(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.$v=e.size;a.Xv=e.hardness/20;a.Zv.set(e.b4w_halo_rings_color);a.Yv.set(e.b4w_halo_lines_color);a.aw=1/b.b4w_halo_stars_blend_height;a.bw=b.b4w_halo_stars_min_height;
a.Wv=!0}function q(a,b,e){switch(b.texture_coords){case "UV":case "ORCO":x(a,e,"TEXTURE_COORDS_UV_ORCO");x(a,"TEXCOORD",1);break;case "NORMAL":x(a,e,"TEXTURE_COORDS_NORMAL");x(a,"NORMAL_TEXCOORD",1);break;default:x(a,e,"TEXTURE_COORDS_NONE")}}function f(a,b){var e=b.game_settings,c=e.alpha_blend;switch(c){case "ALPHA_SORT":a.Lb=!0;a.yf=!0;a.Ua=!0;a.Mg=!1;break;case "ALPHA":a.Lb=!0;a.yf=!1;a.Ua=!0;a.Mg=!1;break;case "CLIP":a.Lb=!1;a.yf=!1;a.Ua=!0;a.Mg=!0;break;case "ADD":a.Lb=!0;a.yf=!1;a.Ua=!1;a.Mg=
!1;break;case "OPAQUE":a.Lb=!1;a.yf=!1;a.Ua=!0;a.Mg=!1;break;default:J.q("Unknown alpha blend mode: "+c)}a.$b=e.use_backface_culling}function t(a,b){for(var e=[],c=b.length,d=0;d<c;d++){var k=b[d];1==k[a]&&k.texture&&k.texture.s&&e.push(k)}return e}function c(a,b){var e=b.raytrace_transparency;a.Xi[0]=e.fresnel;a.Xi[1]=1-e.fresnel_factor/5;e=b.raytrace_mirror;a.So=e.reflect_factor;a.Xi[2]=e.fresnel;a.Xi[3]=1-e.fresnel_factor/5}function z(a,b){var e,c=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":e=
b.specular_hardness;break;case "WARDISO":e=b.specular_slope;break;case "TOON":e=b.specular_toon_size;c=b.specular_toon_smooth;break;case "BLINN":e=b.specular_ior;c=b.specular_hardness;break;default:ha.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),e=b.specular_hardness}a.$k[0]=b.specular_intensity;a.$k[1]=e;a.$k[2]=c}function L(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Xd[0]=0;a.Xd[1]=0;break;case "OREN_NAYAR":a.Xd[0]=b.roughness;a.Xd[1]=0;break;case "FRESNEL":a.Xd[0]=
b.diffuse_fresnel;a.Xd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Xd[0]=b.darkness;a.Xd[1]=0;break;case "TOON":a.Xd[0]=b.diffuse_toon_size;a.Xd[1]=b.diffuse_toon_smooth;break;default:ha.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Xd[0]=0,a.Xd[1]=0}}function D(a,b,e){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d;switch(e){case "MAIN":T(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":T(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":T(a,
"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf"),d=!1}var k=b.node_tree;e=ba.YS(k,b.uuid,!1,b.name,e);if(!e.Wa)return ha.error('Failed to create node graph for material "'+b.name+'", disable nodes'),K(a,b),!0;a.Ck=e.id;a.ok=!0;x(a,"NODES",1);x(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);p(a,"a_position");b.use_orco_tex_coord&&p(a,"a_orco_tex_coord");f(a,b);a.vg=b.offset_z;var n=b.game_settings.alpha_blend;d?(x(a,"ALPHA",1),x(a,"ALPHA_CLIP",
0)):(x(a,"ALPHA","OPAQUE"===n?0:1),x(a,"ALPHA_CLIP","CLIP"===n?1:0));a.Fh=b.b4w_render_above_all&&"OPAQUE"!=n&&"CLIP"!=n;a.fk=b.emit;a.Oj=b.ambient;c(a,b);b.b4w_wettable?x(a,"WETTABLE",1):x(a,"WETTABLE",0);var J=null,w=!1;aa.pa(e.Wa,function(e,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=c.data.name,k=c.data.value;a.Gj||(a.Gj={});a.Gj[k]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=c.data.name;a.ad[d]={pm:!0,
src:[{name:c.data.value}]};k=0;if("GEOMETRY_VC"==c.type)k=7;else for(var n=0;n<c.fb.length;n++){var f="RGB".indexOf(c.fb[n].identifier);-1<f&&(k|=1<<2-f)}a.ad[d].src[0].pg=k;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":p(a,"a_tbn_quat");break;case "TEX_COORD_OB":x(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":x(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":c.data.value.tn&&(x(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&p(a,"a_shade_tangs"));
p(a,"a_tbn_quat");w=!0;break;case "BSDF_BEGIN":w=!0;p(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=c.data.name;k=c.data.lA;n=c.data.value;M(a,n,d,k);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":x(a,"CALC_TBN_SPACE",1);p(a,"a_tbn_quat");c.data&&(d=c.data.name,k=c.data.lA,n=c.data.value,M(a,n,d,k));break;case "NORMAL_MAP":p(a,"a_tbn_quat");switch(Number(c.Sb[0][1])){case ba.vP:x(a,"CALC_TBN_SPACE",1);break;case ba.uP:case ba.tP:x(a,"USE_MODEL_TSR",1)}break;case "LAMP":c.data&&
(a.Jm=c.data);break;case "B4W_REFRACTION":a.Lb?a.Ok=!0:(a.Ok=!1,ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));x(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":J||(J=c.data.jb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&c.data&&(a.Es=c.data);break;case "VECT_TRANSFORM":switch(Number(c.Sb[1][1])){case ba.MQ:x(a,"USE_MODEL_TSR_INVERSE",1);break;case ba.LQ:x(a,"USE_VIEW_TSR",1);break;case ba.KQ:x(a,"USE_MODEL_TSR",1);break;case ba.JQ:x(a,
"USE_MODEL_TSR",1);x(a,"USE_VIEW_TSR",1);break;case ba.IQ:x(a,"USE_VIEW_TSR_INVERSE",1);break;case ba.HQ:x(a,"USE_MODEL_TSR_INVERSE",1),x(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":x(a,"USE_MODEL_TSR",1);a.Io[1]=b.pass_index;a.Io[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":x(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":x(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":p(a,"a_tbn_quat"),v.UB()?x(a,"USE_DERIVATIVES_EXT",1):ha.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});J&&M(a,J,"u_nodes_texture");w||(a.Pe=!0);d=a.hb.ug=ba.Su(e.Wa);G(k,a);k=a.lj;e=a.kj;for(n=0;n<d.length;n++){var H=d[n];switch(H.id){case "VALUE":var q=H.Zw[0];if(q)for(var h=0;h<k.length;h+=2)if(k[h]==q){H.Sb.push(["VALUE_IND",k[h+1]]);break}break;case "RGB":if(q=H.Zw[0])for(h=0;h<e.length;h+=2)if(e[h]==q){H.Sb.push(["RGB_IND",e[h+1]]);break}}}x(a,"NUM_VALUES",a.mj.length);x(a,"NUM_RGBS",a.Ie.length);return!0}function G(a,b){var e=[],c=[],d=[],k=[];B(a,"",e,c,d,k);b.mj=e;
b.lj=c;b.Ie=d;b.kj=k}function B(a,b,e,c,d,k){for(var n=0;n<a.nodes.length;n++){var f=a.nodes[n];if("VALUE"==f.type){var J=O(b,f.name);e.push(f.outputs[0].default_value);c.push(J,c.length/2)}else"RGB"==f.type?(J=O(b,f.name),f=f.outputs[0].default_value.slice(0,3),d.push(f[0],f[1],f[2]),k.push(J,k.length/2)):"GROUP"==f.type&&B(f.node_group.node_tree,O(b,f.name),e,c,d,k)}}function O(a,b){var e;return e=(a?a+"%join%":"")+b}function K(a,b){switch(a.type){case "SHADOW":T(a,"shadow.glslv","shadow.glslf");
break;case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf");break;default:T(a,"main.glslv","main_stack.glslf")}x(a,"SHADELESS",1);p(a,"a_position");p(a,"a_tbn_quat");pa.set(1,0,1,1,a.fg);if(b){var e=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===e?0:1);x(a,"ALPHA_CLIP","CLIP"===e?1:0);x(a,"VERTEX_COLOR",0);a.vg=b.offset_z;f(a,b)}return!0}function E(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;T(a,"debug_view.glslv","debug_view.glslf");p(a,"a_position");p(a,"a_tbn_quat");p(a,"a_polyindex");
a.Ua=!0;ma.set(0,0,0,a.wireframe_edge_color);return!0}function C(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.Em?x(a,"AU_QUALIFIER","GLSL_IN"):x(a,"AU_QUALIFIER","uniform"),x(a,"STATIC_BATCH",0)):(x(a,"AU_QUALIFIER","GLSL_IN"),x(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(v.UB()?x(a,"WIREFRAME_QUALITY",1):x(a,"WIREFRAME_QUALITY",0),a.Ti?(x(a,"DEBUG_SPHERE",1),a.gv?x(a,"DEBUG_SPHERE_DYNAMIC",1):x(a,"DEBUG_SPHERE_DYNAMIC",0)):x(a,"DEBUG_SPHERE",0),x(a,"ALPHA",1));b.Qe&&(a.Qe=b.Qe);b.xf?(""!==b.ej?
(a.ad.a_bending_col_main={pm:!0,src:[{name:b.ej,pg:4}]},p(a,"a_bending_col_main"),""!==b.Fe.tC&&""!==b.Fe.sC&&""!==b.Fe.bD?(a.ad.a_bending_col_detail={pm:!0,src:[{name:b.Fe.tC,pg:4},{name:b.Fe.sC,pg:2},{name:b.Fe.bD,pg:1}]},p(a,"a_bending_col_detail"),p(a,"a_tbn_quat"),x(a,"DETAIL_BEND",1)):x(a,"DETAIL_BEND",0),x(a,"MAIN_BEND_COL",1)):x(a,"MAIN_BEND_COL",0),b.Kl?x(a,"BEND_CENTER_ONLY",1):x(a,"BEND_CENTER_ONLY",0),x(a,"WIND_BEND",1)):x(a,"WIND_BEND",0);x(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.Cq|0);
b.Og?x(a,"BILLBOARD",1):x(a,"BILLBOARD",0);b.Og&&b.Em?x(a,"HAIR_BILLBOARD",1):x(a,"HAIR_BILLBOARD",0);b.Dq?x(a,"BILLBOARD_SPHERICAL",1):x(a,"BILLBOARD_SPHERICAL",0);switch(b.Eq){case "RANDOM":x(a,"BILLBOARD_RANDOM",1);x(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":x(a,"BILLBOARD_RANDOM",0);x(a,"BILLBOARD_JITTERED",1);break;default:x(a,"BILLBOARD_RANDOM",0),x(a,"BILLBOARD_JITTERED",0)}b.jd&&ja.vu?x(a,"DYNAMIC_GRASS",1):x(a,"DYNAMIC_GRASS",0);a.jd=b.jd;"PARTICLES"!=a.type&&(a.gg=b.gg);a.Me=b.Me;
a.ve=b.ve;a.je=b.je&&!a.Pe&&!(a.Lb&&ja.lB);a.he=b.he;a.Kd=b.Kd;a.Jd=b.Jd;a.Io[0]=b.bx;a.lf=b.lf;a.mh=b.mh;a.nh=b.nh;a.Vd=b.Vd;a.Hd=b.Hd;b.vk?(p(a,"a_influence"),x(a,"SKINNED",1),ja.Lx?(x(a,"DISABLE_TANGENT_SKINNING",1),x(a,"FRAMES_BLENDING",0)):(x(a,"DISABLE_TANGENT_SKINNING",0),b.km?x(a,"FRAMES_BLENDING",1):x(a,"FRAMES_BLENDING",0)),x(a,"MAX_BONES",b.oh)):(x(a,"SKINNED",0),x(a,"FRAMES_BLENDING",0),x(a,"DISABLE_TANGENT_SKINNING",0));b.$c?(x(a,"VERTEX_ANIM",1),ja.mO?x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):x(a,"VERTEX_ANIM",0);b.vk&&b.$c&&J.q("Skinning and vertex animation are mutually exlusive")}}function Q(a,b,e){if(b.length){for(var c=ya.Lv(b,ja.ssao&&e.b4w_enable_ssao),d=a.hb,n=a.Jm,f=0,J=0;J<a.hb.ug.length;J++){var v=a.hb.ug[J];if("LIGHTING_LAMP"==v.id){var p=b[f++%b.length],w=p.tb,H=ya.ja(p,e);if("SPOT"==w.type||"POINT"==w.type)var q=Math.cos(w.ln/2);if("SPOT"==w.type)var h=w.kt*(1-q);p=c.indexOf(p);v.Sb=[["LAMP_TYPE",w.type],["LAMP_IND",
H.Km],["LAMP_SPOT_SIZE",Y.O(q||.01)],["LAMP_SPOT_BLEND",Y.O(h||.01)],["LAMP_LIGHT_DIST",Y.O(w.distance)],["LAMP_USE_SPHERE",w.PE?1:0],["LAMP_SHADOW_MAP_IND",p]]}else if("LAMP"==v.id&&n)for(var H=v.Sb[0][1],F=0;F<b.length;F++)if(p=b[F],n[p.Fj]==H){w=p.tb;if("SPOT"==w.type||"POINT"==w.type)q=Math.cos(w.ln/2);"SPOT"==w.type&&(h=w.kt*(1-q));v.Sb.push(["LAMP_TYPE",w.type],["LAMP_SPOT_SIZE",Y.O(q||.01)],["LAMP_SPOT_BLEND",Y.O(h||.01)],["LAMP_LIGHT_DIST",Y.O(w.distance)],["LAMP_USE_SPHERE",w.PE?1:0])}}if(n){e=
0;for(var m in n)e++;a.zo=new Float32Array(3*e);a.ms=new Float32Array(3*e);a.ls=new Float32Array(3*e);Y.ha(d,"NUM_LAMP_LIGHTS",e);for(J=0;J<b.length;J++)k(a,b[J])}}}function k(a,b){if(b.Fj in a.Jm){var e=a.Jm[b.Fj],c=N.F(b.k.n);a.zo.set(c,3*e);a.ms.set(b.tb.direction,3*e);a.ls.set(b.tb.ar,3*e)}}function p(a,b){var e=a.Zj;-1==e.indexOf(b)&&e.push(b);a.Zj=e.sort()}function x(a,b,e){Y.ha(a.hb,b,e)}function e(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.vb?a.Ca=ia.mN(b,ia.Cn,[]):(0<b.ib.length&&ia.z_(b,b.aa[0]),
a.Vf=b);else{var e=a.Uh;a.Wv&&"PARTICLES"!=a.type&&(b=ia.RU(b));a.vy&&(b=R.rV(a.wy,a.xy,a.uy));e=ia.mN(b,e,a.ad);a.Ca=e;a.gg||a.yf||a.Qe||(e.pe=null,e.tc.length=0);e=b.aa.length;a.zs=b.Ja*e;var c;a:switch(a.Uh){case ia.Cn:case ia.Pp:case ia.Mt:c=!0;break a;default:c=!1}c?ia.TW(b)?a.Qm=b.na.length/3*e:a.Qm=b.Ja/3*e:a.Qm=0}}function w(a,b,e,c,d,k,f,v,w,p,H,q){var h=a.nb,F=[],m=v.b4w_dynamic_grass;if(!p&&m)return F;for(var g="INSTANCE"==v.b4w_wind_bend_inheritance,I="INSTANCE"==v.b4w_shadow_inheritance,
P="INSTANCE"==v.b4w_reflection_inheritance,t=[],R=[],V=0;V<d.length;V++){var ba=d[V].nb.k,M=ya.BA(b);M.Og=v.b4w_hair_billboard;M.Eq=v.b4w_hair_billboard_type;M.Dq="SPHERICAL"==v.b4w_hair_billboard_geometry;M.jd=m;M.Em=!0;g?(M.xf=ba.xf,M.zn=ba.zn,M.Eh=ba.Eh,M.Yg=ba.Yg,M.ej=ba.ej,M.Xg=ba.Xg,M.Rg=ba.Rg,M.Dh=ba.Dh,M.Fe=ba.Fe,M.Kl=!1):(M.xf=h.k.xf,M.zn=h.k.zn,M.Eh=h.k.Eh,M.Yg=h.k.Yg,M.ej=h.k.ej,M.Xg=h.k.Xg,M.Rg=h.k.Rg,M.Dh=h.k.Dh,M.Fe=h.k.Fe,M.Kl=!0);I?(M.Me=ba.Me,M.ve=ba.ve,M.je=ba.je):(M.Me=h.k.Me,M.ve=
h.k.ve,M.je=h.k.je);P?(M.he=ba.he,M.Kd=ba.Kd,M.Jd=ba.Jd,M.Vd=ba.Vd,M.Hd=ba.Hd,M.vh=ba.vh):(M.he=h.k.he,M.Kd=h.k.Kd,M.Jd=h.k.Jd,M.Vd=h.k.Vd,M.Hd=h.k.Hd,M.vh=h.k.vh);t.push(M);var T=f[V];T||(T=new Float32Array);q&&J.jw(w.seed,H);var aa=new Float32Array(3),Y=new Float32Array([0,0,0,1]),fa=[],z=ra.uH(ja.zC)&&!v.b4w_initial_rand_rotation&&!v.b4w_hair_billboard,u=4;z&&(u=8);for(var r=0;r<T.length;r+=u){aa[0]=T[r];aa[1]=T[r+1];aa[2]=T[r+2];var W=T[r+3]*N.td(ba.n);if(v.b4w_initial_rand_rotation){switch(v.b4w_rotation_type){case "XYZ":var ua=
new Float32Array([J.yg(H),J.yg(H),J.yg(H)]);ma.normalize(ua,ua);break;case "Z":ua=new Float32Array([0,0,1]);break;default:J.q("Unsupported random rotation type: "+v.b4w_rotation_type)}ca.setAxisAngle(ua,v.b4w_rand_rotation_strength*(2*Math.PI*J.yg(H)-Math.PI),Y)}else if(z&&(Y.set(T.subarray(r+4,r+8)),J.oD(Y,Y),!v.use_whole_group))if(v.use_rotation_dupli){var X=N.P(ba.n);ca.multiply(Y,X,Y)}else ca.multiply(Y,Ia,Y);var Q=N.Ag(aa,W,Y,N.create());fa.push(Q)}R.push(fa)}for(var Z={},B=0,V=0;V<d.length;V++)for(var E=
d[V].data.materials,r=0;r<E.length;r++)E[r].name in Z?Z[E[r].name]++:(Z[E[r].name]=1,B++);for(var B=B?B:1,sa={},V=0;V<d.length;V++){var L=d[V],D=k[V],M=t[V],xa={};M.xf&&(xa.au_wind_bending_amp=[M.Dh],xa.au_wind_bending_freq=[M.Eh],xa.au_detail_bending_freq=[M.Yg],xa.au_detail_bending_amp=[M.Xg],xa.au_branch_bending_amp=[M.Rg],M.Dh=0,M.Eh=0,M.Yg=0,M.Xg=0,M.Rg=0);fa=R[V];if(fa.length){for(var na=L.data,E=na.materials,oa=Array(E.length),kb=Array(E.length),r=0;r<E.length;r++)if(!ia.aK(na,r))for(var Va=
0;Va<D.length;Va++){var Aa=D[Va],G=l(Aa),Ca=E[r];"MAIN"==Aa?oa[r]=G:"DEBUG_VIEW"==Aa&&(kb[r]=G);G.Wq=a.b4w_cluster_data.cluster_id;if(n(G,Ca)){"SHADOW"==Aa&&oa[r]&&(G.Pe=oa[r].Pe);G.Uh=ia.Cn;C(G,M);G.Ek=v.uuid;G.dk=a.b4w_do_not_cull||v.b4w_dynamic_grass;"MAIN"==G.type&&(G.Sg=a.b4w_caustics);x(G,"DISABLE_FOG",("COLOR_ID"!=Aa&&"SHADOW"!=Aa&&a.b4w_disable_fogging)|0);"JITTERED"==v.b4w_hair_billboard_type&&(G.tw=v.b4w_hair_billboard_jitter_amp,G.uw=v.b4w_hair_billboard_jitter_freq);m&&(G.Rv=v.b4w_dynamic_grass_scale_threshold);
g||(delete G.ad.a_bending_col_main,delete G.ad.a_bending_col_detail);var y=ia.yB(na,r,G.Zj,b.Li,G.ad,G.Gj),O=h.k.n,pa=!0;if(1<Z[Ca.name]){var la=0,K;for(K in y.aa)la++;pa=y.na.length*fa.length*la*Z[Ca.name]>2E5*B}var A=ja.pG&&pa&&"PHYSICS"!=G.type;if(A){G.kK=v.use_whole_group?2:1;var qa=J.T(y);ia.cH(y,qa,fa);qa.Qf={xp:fa,Vx:O,eN:"STATIC"==b.type,mt:xa,Wm:{},nv:m};if(M.xf&&M.Kl){var Da=ma.fromValues(0,0,0);N.Gc(Da,h.k.n,Da);for(var ta=[],za=0;za<fa.length;za++)ta.push(Da[0],Da[1],Da[2]);qa.Qf.Wm.a_emitter_center=
{Jc:3,data:ta}}ia.cH(y,y,fa);"STATIC"==b.type&&ia.TR(qa.Wf,O)}else{var Fa=qa=ia.GX(y,xa,fa),Sa=fa;Fa.qa.au_center_pos=new Float32Array(3*Fa.Ja);for(var Na=Sa.length,wc=Fa.Ja/Na,gc=0;gc<Na;gc++)for(var Fb=Sa[gc],$b=3*wc*gc,xc=0;xc<wc;xc++)Fa.qa.au_center_pos[$b+3*xc]=Fb[0],Fa.qa.au_center_pos[$b+3*xc+1]=Fb[1],Fa.qa.au_center_pos[$b+3*xc+2]=Fb[2];qa=Fa;if(M.xf&&M.Kl){var Rb=qa,hc=h.k.n;Rb.qa.a_emitter_center=new Float32Array(3*Rb.Ja);var yc=ma.fromValues(0,0,0);N.Gc(yc,hc,yc);for(var tb=0;tb<Rb.Ja;tb++)Rb.qa.a_emitter_center[3*
tb]=yc[0],Rb.qa.a_emitter_center[3*tb+1]=yc[1],Rb.qa.a_emitter_center[3*tb+2]=yc[2];qa=Rb}}var $a=v.b4w_vcol_from_name,Ic=v.b4w_vcol_to_name,dd=G,Gb=e,Yb=!g,gb=na,ub=[];if(""!==$a&&""!==Ic){var zb,Zc=Ic,Rc=dd.ad,ic=[],mc=void 0;for(mc in Rc)for(var Kb=Rc[mc].src,nc=0,oc=0;oc<Kb.length;oc++){var Sc=Kb[oc].pg;Zc==Kb[oc].name&&ic.push(mc,Sc,nc);nc+=J.$m(Sc)}zb=ic;if(0<zb.length)for(var zc=0;zc<zb.length;zc+=3)ub.push({zr:$a,pv:7,$w:zb[zc],ax:zb[zc+1],mv:zb[zc+2]});else ia.nW(dd.Zj,"a_color")&&Ic==gb.active_vcol_name&&
ub.push({zr:$a,pv:7,$w:"a_color",ax:7,mv:0})}Yb&&("a_bending_col_main"in Gb&&ub.push({zr:"a_bending_col_main",pv:4,$w:"a_bending_col_main",ax:4,mv:0}),"a_bending_col_detail"in Gb&&ub.push({zr:"a_bending_col_detail",pv:7,$w:"a_bending_col_detail",ax:7,mv:0}));for(var pc=qa,Lb=fa,Ya=c,Pa=ub,Sb=G.ad,jc=A,Wa=!1,Ab=0;Ab<Pa.length;Ab++){var Mb=Pa[Ab].zr,Tb=Ya.qa[Mb];if(Tb&&0<Tb.length){Wa=!0;break}}if(jc)var ac=pc.Qf.Wm;if(Wa){var Hb,Bb=h.k.S,ab=Ya.aa[0].a_position,Cb=Lb,Ka=sa,bc=new Float32Array(3),Ma=
new Float32Array(3),cc=new Uint32Array(Cb.length);if(!("verts_indices"in Ka)){Ka.Mi=new Float32Array(3);Ka.Ki=new Float32Array(3);Ka.TE=new Uint32Array(ab.length/3);Ka.As=new Uint32Array(ab.length/3);Ka.Mi[0]=(Bb.max_x-Bb.min_x)/20;Ka.Mi[1]=(Bb.max_y-Bb.min_y)/20;Ka.Mi[2]=(Bb.max_z-Bb.min_z)/20;Ka.Ki[0]=Bb.min_x;Ka.Ki[1]=Bb.min_y;Ka.Ki[2]=Bb.min_z;for(var Ha=0;Ha<ab.length/3;Ha++){var wb=J.trunc((ab[3*Ha]-Ka.Ki[0])/Ka.Mi[0]),Pb=J.trunc((ab[3*Ha+1]-Ka.Ki[1])/Ka.Mi[1]),Ub=J.trunc((ab[3*Ha+2]-Ka.Ki[2])/
Ka.Mi[2]),wb=J.V(wb,0,19),Pb=J.V(Pb,0,19),Ub=J.V(Ub,0,19);Ka.TE[Ha]=Ha;Ka.As[Ha]=Ub*Math.pow(20,2)+20*Pb+wb}ia.h_(Ka.As,Ka.TE,ia.Lz,!0);Ka.un=new Uint32Array(Math.pow(20,3));for(Ha=0;Ha<Ka.As.length;Ha++)Ka.un[Ka.As[Ha]]++;delete Ka.As;for(Ha=1;Ha<Ka.un.length;Ha++)Ka.un[Ha]+=Ka.un[Ha-1]}for(var qc=0;qc<Cb.length;qc++){bc[0]=Cb[qc][0];bc[1]=Cb[qc][1];bc[2]=Cb[qc][2];for(var Jc=1E10,kc=-1,ld=J.trunc((bc[0]-Ka.Ki[0])/Ka.Mi[0]),ed=J.trunc((bc[1]-Ka.Ki[1])/Ka.Mi[1]),Kc=J.trunc((bc[2]-Ka.Ki[2])/Ka.Mi[2]),
ld=J.V(ld,0,19),ed=J.V(ed,0,19),Kc=J.V(Kc,0,19),Fc=Kc*Math.pow(20,2)+20*ed+ld,rc=Ka.un[Fc],db=0==Fc?0:Ka.un[Fc-1];db<rc;db++){var Lc=Ka.TE[db];Ma[0]=ab[3*Lc];Ma[1]=ab[3*Lc+1];Ma[2]=ab[3*Lc+2];ma.sub(Ma,bc,Ma);var Tc=ma.sqrLen(Ma);Tc<=Jc&&(Jc=Tc,kc=Lc)}if(-1==kc)for(db=0;db<ab.length/3;db++)Ma[0]=ab[3*db],Ma[1]=ab[3*db+1],Ma[2]=ab[3*db+2],ma.sub(Ma,bc,Ma),Tc=ma.sqrLen(Ma),Tc<=Jc&&(Jc=Tc,kc=db);cc[qc]=kc}Hb=cc;for(var Gc=pc.Ja/Lb.length,Ab=0;Ab<Pa.length;Ab++){var Db=Pa[Ab].$w,Vb=Pa[Ab].ax,Mb=Pa[Ab].zr,
Ac=Pa[Ab].pv,Tb=Ya.qa[Mb];switch(Db){case "a_bending_col_main":var Qb=1;break;case "a_bending_col_detail":Qb=3;break;case "a_color":Qb=3;break;default:for(var vb=Qb=0;vb<Sb[Db].src.length;vb++)Qb+=J.$m(Sb[Db].src[vb].pg)}if(Tb&&0<Tb.length){var Uc=J.$m(Ac),Vc=J.$m(Vb),fb=Ac&Vb,Za=J.SL(fb);fb!=Vb&&ha.error("Wrong color extraction from "+Mb+" to "+Db+".");if(jc)for(ac[Db]={Jc:Qb,data:[]},vb=0;vb<Lb.length;vb++)for(Hc=Hb[vb],Mc=Hc*Uc,Wb=0;Wb<Za.length;Wb++)Za[Wb]&&(Nc=J.Vo(Ac,Wb),ac[Db].data.push(Tb[Mc+
Nc]));else{if("a_bending_col_main"==Db||"a_bending_col_detail"==Db)pc.qa[Db]=new Float32Array(pc.Ja*Vc);for(vb=0;vb<Lb.length;vb++){var Hc=Hb[vb],Mc=Hc*Uc,Bc=vb*Gc*Qb;if(-1!=Hc)for(var dc=0;dc<Gc;dc++)for(var $c=dc*Qb,Wb=0;Wb<Za.length;Wb++)if(Za[Wb]){var Nc=J.Vo(Ac,Wb);pc.qa[Db][Bc+$c+(Pa[Ab].mv+J.Vo(Vb,Wb))]=Tb[Mc+Nc]}}}}else pc.qa[Db]=new Float32Array(0)}}qa=pc;x(G,"USE_INSTANCED_PARTCLS",qa.Qf?1:0);ea(G);F.push({za:G,mf:b,Eu:M,Vf:qa,qg:[Ca.name],Ld:[a]})}}for(r=0;r<kb.length;r++)kb[r]&&(kb[r].Yn=
oa[r].id,ea(kb[r]))}}return F}function n(a,b){var e=!0;"NODES_GLOW"==a.type&&(e=ba.sH(b));return e=e&&u(a,b)}function ea(a){I(a,function(a){a.id=0;a.id=J.iS(a)})}function I(a,b){for(var e=null,c=null,d=[],k=0;k<a.ya.length;k++){var n=a.ya[k],f=n.dg;f&&(e||(e={}),e[k]=f,n.dg=null);if(f=n.Sa)c||(c={}),c[k]=f,n.Sa=null;d.push(n.Dk);n.Dk=0}var n=a.S,f=a.ba,v=a.wa,J=a.Ta,w=a.pb,p=a.kb;a.S=null;a.ba=null;a.wa=null;a.Ta=null;a.pb=null;a.kb=null;var H=a.Re;a.Re=null;b(a);a.Re=H;a.S=n;a.ba=f;a.wa=v;a.Ta=J;
a.pb=w;a.kb=p;if(e)for(k in e)a.ya[k].dg=e[k];if(c)for(k in c)a.ya[k].Sa=c[k];for(k=0;k<a.ya.length;k++)a.ya[k].Dk=d[k]}function F(a,b,c,d){var k=l("DEBUG_VIEW");T(k,"debug_view.glslv","debug_view.glslf");k.Ti=!0;k.Ua=!0;k.Ek=b;k.gv=c;C(k,a);ea(k);if(d.Zf){c?(c=d.ba,N.ue(d.ba.G,za)):(c=d.pb,N.ue(c.G,za));var n=ma.create();a=R.Bv(1,n);b=ma.fromValues(ma.length(c.Ga),ma.length(c.Ha),ma.length(c.Ia));ia.XL(a,b,n);var n=ma.normalize(c.Ga,Ca),f=ma.normalize(c.Ha,Aa);c=ma.normalize(c.Ia,la);!b[0]&&b[1]&&
b[2]?ma.cross(f,c,n):!b[1]&&b[0]&&b[2]?ma.cross(c,n,f):!b[2]&&b[0]&&b[1]&&ma.cross(n,f,c);b=J.CU(n,f,c,Sa);Z.invert(b,b);b=ca.fromMat3(b,Da);N.oi(b,za);N.Le(1,za);ia.Xx(a,za)}else c?(b=d.wa,a=R.Bv(b.Xa,b.G)):(b=d.kb,a=R.Bv(b.Xa,ma.create()),N.identity(za),N.ue(b.G,za),ia.Xx(a,za));k.S=P.Rl(d.S);k.ba=P.Uq(d.ba);k.wa=P.Sl(d.wa);k.Ta=P.Rl(d.Ta);k.pb=P.Uq(d.pb);k.kb=P.Sl(d.kb);ia.Yx(a,1,!0);a.qa.a_polyindex=ia.sv(a);e(k,a);return k}function T(a,b,e){a.hb.Eg=b;a.hb.df=e;Y.pZ(a.hb)}function M(a,b,e,c){c=
c||"";-1==a.Od.indexOf(e)&&(a.ya.push(b),a.Od.push(e),a.Qg.push(c),sa.hw(b));a.zb&&xa.FG(a)}function X(a){a.hb||J.q("No shaders info for batch "+a.name);a.zb=Y.GV(a.hb);var b=a.hb;if(b.status===Y.Nz){var e=a.zb.attributes,c=a.Ca.ld,d;for(d in e)c[d]||J.q('missing data for "'+d+'" attribute')}b.status&Y.JO&&ha.error("Texture limit exceeded for shader - "+b.df+', materials: "'+a.wd.join(", ")+'". Maximum texture count: '+qa.GC+", actual texture count: "+b.yN);b.status&Y.IO&&ha.error("Fragment uniform limit exceeded for shader - "+
b.df+', materials: "'+a.wd.join(", ")+'". Maximum fragment uniform count: '+qa.Dw+", actual fragment uniform count: "+b.hV);b.status&Y.MO&&ha.error("Vertex uniform limit exceeded for shader - "+b.Eg+', materials: "'+a.wd.join(", ")+'". Maximum vertex uniform count: '+qa.us+", actual vertex uniform count: "+b.R0);b.status&Y.LO&&ha.error("Vertex attribute limit exceeded for shader - "+b.Eg+', materials: "'+a.wd.join(", ")+'". Maximum attribute count: '+qa.HC+", actual attribute count: "+b.GG);b.status&
Y.KO&&("MAIN"!=a.type||a.ok||ha.error("Varying limit exceeded for shader - "+a.hb.df+', materials: "'+a.wd.join(", ")+'"'),"MAIN"==a.type&&a.ok||"NODES_GLOW"==a.type)&&(c=e=0,a.Gj&&(e=J.Pr(a.Gj)),a.ad&&(c=J.Pr(a.ad)),ha.error("Varying limit exceeded for node shader - "+a.hb.df+", uv: "+e+", vc: "+c+', materials: "'+a.wd.join(", ")+'"'));b.status&Y.DO&&ha.error("Shader compilation/linking error: "+b.Eg+", "+b.df+', materials: "'+a.wd.join(", ")+'"');return a.hb.status===Y.Nz?(xa.DR(a.zb),xa.zR(a),
xa.FG(a),!0):!1}function H(a,b,e){a=a.I[0].X;for(var c=0;c<a.length;c++)if(a[c].type==e&&!a[c].kg&&-1!=a[c].wd.indexOf(b))return a[c];return null}function fa(a,b,e){a=a.I[0].X;for(var c=0;c<a.length;c++)if(a[c].type==e&&a[c].kg&&-1!=a[c].wd.indexOf(b))return a[c];return null}function V(a,b){a.fg.set(b.fg);a.cm=b.cm;a.jn.set(b.jn);a.ip=b.ip;a.$k.set(b.$k);a.fk=b.fk;a.Oj=b.Oj;a.bm=b.bm;a.Dl=b.Dl;a.So=b.So;a.Xi.set(b.Xi);a.Ko=b.Ko;a.$o.set(b.$o);a.ap=b.ap;a.bp.set(b.bp);a.cp=b.cp;a.jo=b.jo;a.Ip=b.Ip}
var P=g("__boundings"),W=g("__config"),ha=g("__print"),v=g("__extensions"),aa=g("__graph"),Z=g("__mat3"),ba=g("__nodemat"),ya=g("__obj_util"),na=g("__particles"),R=g("__primitives"),ca=g("__quat"),ra=g("__reformer"),xa=g("__renderer"),oa=g("__scenegraph"),Y=g("__shaders"),ua=g("__subscene"),sa=g("__textures"),N=g("__tsr"),ia=g("__geometry"),J=g("__util"),ma=g("__vec3"),pa=g("__vec4"),ja=W.B,qa=W.Oi,ta=W.Xo,Ia=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),Ca=new Float32Array(3),Aa=new Float32Array(3),
la=new Float32Array(3),Da=new Float32Array(4),za=N.create(),Sa=Z.create();a.i1=Fa;var Fa="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Na={};a.IR=function(a){return Na[a]||null};a.JR=function(a,b){Na[a]=b};a.AV=function(a,c,d,k){var n;n=a.s.Wa;for(var f=[],v=0;v<c.length;v++){var w=c[v],p=w.nb,H=p.k;if(!p.ds){var h=ya.Ra(p),p=p.k,q=w.data.b4w_boundings,m=q.bs_rad,g=q.bs_cen,I=q.bc_rad,t=q.caxis_x,R=q.caxis_y,M=q.caxis_z,V=q.be_ax,ba=q.be_cen,l=q.rbb.rbb_c,T=q.rbb.rbb_s,
q=P.Rl(p.Jl);p.Og&&(m=Math.max(Math.abs(q.max_x),Math.abs(q.min_x)),g=Math.max(Math.abs(q.max_y),Math.abs(q.min_y)),T=Math.max(Math.abs(q.max_z),Math.abs(q.min_z)),T=Math.sqrt(m*m+g*g+T*T),I=Math.sqrt(m*m+g*g),q.max_x=q.max_y=q.max_z=T,q.min_x=q.min_y=q.min_z=-T,m=T,g=[0,0,0],t=[1,0,0],R=[0,1,0],M=[0,0,1],V=[T,T,T],ba=[0,0,0],l=[0,0,0],T=[T,T,T]);P.Tn(q,p.S);P.Ol(p.S,p.n,p.Ta);p.wa=P.nA(m,J.Jf(g));P.Gq(p.wa,p.n,p.kb);p.ba=h?P.Bq(t,R,M,ba):P.Bq([1,0,0],[0,1,0],[0,0,1],ba);ma.scale(p.ba.Ga,V[0],p.ba.Ga);
ma.scale(p.ba.Ha,V[1],p.ba.Ha);ma.scale(p.ba.Ia,V[2],p.ba.Ia);P.Fq(p.ba,p.n,p.pb);h?A(p,I,I,p.S):(p.Bd=P.$Y(l,t,R,M,T),P.kA(p.Bd,p.n,p.MG));f.push.apply(f,y(w,H,n))}}n=r(f);for(f=0;f<n.length;f++)if(v=n[f].za,v.wd=n[f].qg,e(v,n[f].Vf),Q(v,d,a),"STATIC"==n[f].k.type&&"COLOR_ID"!=v.type){if(w=J.ot("%meta%"+v.type+"%"+v.wd.join("%")+"%"),h=ya.hr(w,"MESH"),ya.TX(h,n[f].k),ya.sq(h,a),ya.wu(h,a,v),k.push(h),"MAIN"==v.type)for(H=0;H<n[f].Ld.length;H++)w=n[f].Ld[H].nb,w.Gw.push(h)}else w=n[f].Ld[0].nb,ya.wu(w,
a,v);if(ja.debug_view){for(f=0;f<n.length;f++)if(d=n[f].k,"DYNAMIC"==d.type&&(w=n[f].Ld[0].nb,v=n[f].za,"MAIN"==v.type)){H=ya.ja(w,a);h=H.X;p=!1;for(H=0;H<h.length;H++)h[H].Ti&&(p=!0);p||(d=F(d,w.name,!0,v),ya.wu(w,a,d))}for(f=0;f<k.length;f++)w=k[f],d=w.k,H=ya.ja(w,a),v=H.X[0],"MAIN"==v.type&&(d=F(d,w.name,!1,v),ya.wu(w,a,d));for(f=0;f<n.length;f++)v=n[f].za,"DEBUG_VIEW"==v.type&&(v.fv=f)}for(f=0;f<c.length;f++)for(H=ya.ja(c[f].nb,a),h=H.X,H=0;H<h.length;H++)b(h[H]);for(f=0;f<k.length;f++)for(H=
ya.ja(k[f],a),h=H.X,H=0;H<h.length;H++)b(h[H])};a.jR=function(a,c,k){var n=a.s.Kp,f=l("MAIN");T(f,"sky.glslv","sky.glslf");if(c.procedural_skydome)x(f,"PROCEDURAL_SKYDOME",1),f.lv=!0;else{var v=n.hp,J=oa.hc(a.s.Wa,ua.Lg).p.wc;M(f,J,"u_sky");v&&(x(f,"WO_SKYTEX",1),v.invert&&x(f,"MTEX_NEGATIVE",1),v.dO&&x(f,"MTEX_RGBTOINT",1),x(f,"BLENDTYPE",v.WG),v.ZN&&x(f,"WOMAP_BLEND",1),v.$N&&x(f,"WOMAP_HORIZ",1),v.bO&&x(f,"WOMAP_ZENUP",1),v.aO&&x(f,"WOMAP_ZENDOWN",1));n.xt&&x(f,"WO_SKYBLEND",1);n.yt&&x(f,"WO_SKYPAPER",
1);n.zt&&x(f,"WO_SKYREAL",1)}c.he&&(f.he=!0,c.Kd&&(f.Kd=!0));f.vg=99999;p(f,"a_position");c=R.wV();e(f,c);b(f);k=ya.ja(k,a);f.dk=!0;f.ba=P.Tg();f.pb=P.Tg();f.S=P.Ud();f.Ta=P.Ud();f.wa=P.Sh();f.kb=P.Sh();ea(f);k.X.push(f);oa.hc(a.s.Wa,ua.Bf)&&(a=d(f),a.type="DEBUG_VIEW",a.vb="",E(a),x(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.qa.a_polyindex=ia.sv(c),e(a,c),a.Yn=f.id,ea(a),k.X.push(a))};a.NA=function(a,b,e){e=ya.ja(a,e).X;var c=[];oa.hc(b,ua.dd);var k=oa.hc(b,ua.Rd),n=oa.hc(b,ua.nd),f=oa.hc(b,ua.Kg);b=oa.hc(b,
ua.zf);for(var v=0;v<e.length;v++){var p=e[v],J=null;"SHADOW"==p.type&&"RECEIVE"==p.vb&&p.Me&&(J=d(p),J.vb="CAST");"MAIN"!=p.type&&"PARTICLES"!=p.type||!k&&!n||!p.he||(J=d(p),J.vb="REFLECT",J.Ok=!1,J.yf&&(J.yf=!1,J.Ua=!1),J.gb=p.gb);"COLOR_ID"==p.type&&f&&a.k.Wc&&(b&&a.k.Sk?(J=d(p),J.vb="OUTLINE"):p.vb="OUTLINE");J&&(J.kg=!0,ea(J),c.push(J))}e.push.apply(e,c)};a.BZ=A;a.b1=function(a,b,e){b?b=e*(b.max_z-b.min_z):(b=1,J.q("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(J.Cb(a));return.5*
(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.KR=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.a0=K;a.$_=Q;a.xZ=k;a.EG=function(a,b){x(a,"CSM_SECTION1",0);x(a,"CSM_SECTION2",0);x(a,"CSM_SECTION3",0);x(a,"NUM_CAST_LAMPS",0);if(b){x(a,"NUM_CAST_LAMPS",b.lh.length);ja.Bw&&x(a,"MAC_OS_SHADOW_HACK",1);for(var e=1;e<b.csm_num;e++)x(a,"CSM_SECTION"+String(e),1);x(a,"SHADOW_TEX_RES",Y.O(b.csm_resolution));x(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?
1:0);x(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else x(a,"SHADOW_TEX_RES",0),x(a,"CSM_FADE_LAST_CASCADE",0),x(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.qf=x;a.HB=function(a,b){return Y.LV(a.hb,b)};a.Y_=e;a.Z_=ea;a.zu=T;a.Rj=M;a.RY=function(a,b,e){e=a.Od.indexOf(e);-1<e&&(a.ya[e]=b)};a.AT=function(a,b){var c=l("MAIN");c.Lb=!0;pa.set(b[0],b[1],b[2],.5,c.fg);c.Uh=ia.Pp;e(c,a);T(c,"main.glslv","main_stack.glslf");x(c,"SHADELESS",1);X(c);return c};a.Zc=X;a.zV=function(a,c){for(var d=0;d<
c.length;d++){var k=c[d].nb,n=l("LINE");T(n,"line.glslv","line.glslf");n.Lb=!0;n.dk=!0;var f=R.yV();e(n,f);b(n);n.S=P.Ud();n.Ta=P.Ud();n.ba=P.Tg();n.pb=P.Tg();n.kb=P.Sh();n.wa=P.Sh();ya.sq(k,a);ya.ja(k,a).X.push(n);X(n)}};a.uS=function(a){return a.zb.Fs.length?a.zb.gD.u_cube_fog?!0:!1:!1};a.jT=function(){var a=l("DEPTH_PACK");a.$b=!0;a.Ua=!1;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");X(a);return a};a.UA=function(a){var b=l("POSTPROCESSING");T(b,
"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":x(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":x(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":x(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":x(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":x(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":x(b,"POST_EFFECT",
"POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":x(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":x(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:J.q("Wrong postprocessing effect: "+a)}b.$b=!0;b.Ua=!1;a=R.Tc();e(b,a);X(b);return b};a.DT=function(a){var b=l("SSAO");b.Ua=!1;b.$b=!0;var c=R.Tc();e(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");x(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.dN);x(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:
0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=sa.Zl(sa.Ih,!1);c.source="NODE_TEX";sa.qt(c,a,0);M(b,c,"u_ssao_special_tex");X(b);return b};a.ET=function(a){var b=l("SSAO_BLUR");b.Ua=!1;b.$b=!0;var c=R.Tc();e(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");x(b,"SSAO_BLUR_DEPTH",
a.ssao_blur_depth?1:0);X(b);return b};a.gT=function(a){var b=l("COC");b.Ua=!1;b.$b=!0;var c=R.Tc();e(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");x(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":x(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":x(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":x(b,"COC_TYPE","COC_COMBINE")}X(b);return b};a.kT=function(a){var b=l("DOF");b.Ua=!1;b.$b=!0;var c=R.Tc();e(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.p.dof_bokeh?x(b,"DOF_TYPE","DOF_BOKEH"):(x(b,"DOF_TYPE","DOF_SIMPLE"),x(b,"DEPTH_RGBA",1));X(b);return b};a.tT=function(){var a=l("OUTLINE");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");X(a);return a};a.mT=function(){var a=l("GLOW_COMBINE");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");X(a);return a};a.nT=function(a,b,c){var d=l("GOD_RAYS");d.Ua=!1;d.$b=!0;var k=R.qV();e(d,
k);T(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");x(d,"DEPTH_RGBA",a?1:0);x(d,"WATER_EFFECTS",b?1:0);x(d,"STEPS_PER_PASS",Y.O(c,1));X(d);return d};a.oT=function(){var a=l("GOD_RAYS_COM");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");x(a,"SAFARI_CANVAS_ALPHA_HACK",ja.VL?1:0);X(a);return a};a.iT=function(a,b){var c=l("SKY");c.Ua=!1;c.$b=!0;var d=R.sV();e(c,d);if(b.procedural_skydome)T(c,"skybox.glslv","proc_skybox.glslf"),
x(c,"WATER_EFFECTS",1);else{T(c,"skybox.glslv","tex_skybox.glslf");if(a){d=a.s.Kp;if(d.Rx){var k=d.Rx.texture,n=sa.le(d.Rx);M(c,n,"u_sky_texture",k.name)}d.hp&&x(c,"WO_SKYTEX",1)}b.SM&&x(c,"MTEX_NEGATIVE",1);b.XM&&x(c,"MTEX_RGBTOINT",1);x(c,"BLENDTYPE",b.RM);b.TM&&x(c,"WOMAP_BLEND",1);b.UM&&x(c,"WOMAP_HORIZ",1);b.WM&&x(c,"WOMAP_ZENUP",1);b.VM&&x(c,"WOMAP_ZENDOWN",1);b.xt&&x(c,"WO_SKYBLEND",1);b.yt&&x(c,"WO_SKYPAPER",1);b.zt&&x(c,"WO_SKYREAL",1)}c.ba=P.Tg();c.pb=P.Tg();c.S=P.Ud();c.Ta=P.Ud();c.wa=
P.Sh();c.kb=P.Sh();X(c);return c};a.aR=function(a,b){var e=oa.hc(a.s.Wa,ua.Lg);e&&(e=e.Qa[0].sa[0].za,ya.ja(b,a).X.push(e))};a.bT=function(a){var b=l("ANTIALIASING");b.Ua=!1;b.$b=!0;var c=R.Tc();e(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ja.DL?(x(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),x(b,"AA_QUALITY",a.II)):x(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");X(b);return b};a.BT=function(a){var b=l("SMAA"),c=R.Tc();e(b,c);T(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");
x(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");x(b,"SMAA_PASS",a);x(b,"SMAA_PREDICATION",0);x(b,"SMAA_REPROJECTION",0);X(b);b.Ua=!1;b.$b=!0;return b};a.hT=function(){var a=l("COMPOSITING");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");X(a);return a};a.sT=function(){var a=l("MOTION_BLUR");a.$b=!0;a.Ua=!1;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");X(a);return a};a.FT=function(a){var b=
l("STEREO");b.$b=!0;b.Ua=!1;var c=R.Tc();e(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");x(b,"ANAGLYPH","ANAGLYPH"===a?1:0);X(b);return b};a.pT=function(){var a=l("LUMINANCE");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");X(a);return a};a.cT=function(){var a=l("LUMINANCE");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");X(a);return a};
a.qT=function(){var a=l("LUMINANCE_X_BLUR");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");X(a);return a};a.eT=function(){var a=l("POSTPROCESSING");a.$b=!0;a.Ua=!1;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");X(a);return a};a.fT=function(){var a=l("BLOOM");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
X(a);return a};a.cU=function(){var a=l("VELOCITY");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");X(a);return a};a.aT=function(){var a=l("ANCHOR_VISIBILITY");a.Ua=!0;a.$b=!0;a.Uh=ia.Pp;T(a,"anchors.glslv","anchors.glslf");var b=R.OI(1);e(a,b);x(a,"ANCHOR_NUM",1);X(a);a.El=new Float32Array(3);return a};a.uT=function(){var a=l("PERFORMANCE");a.Ua=!1;a.$b=!0;var b=R.Tc();e(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
X(a);return a};a.X_=function(a,b){var c=b.length/3;if(c!=a.El.length/3){var d=R.OI(c);e(a,d);x(a,"ANCHOR_NUM",c);X(a)}a.El=b};a.e6=function(a){if(!a.I.length)return null;a=a.I[0];return a.X.length?a.X[0]:null};a.$U=H;a.r5=fa;a.E9=V;a.P3=function(a,b){for(var e=a.I[0].X,c=0;c<e.length;c++)if(e[c].type==b)return!0;return!1};a.AH=function(a){for(var b=a.ya,e=0;e<b.length;e++)sa.tD(b[e]);a.Ca.eg&&ia.PS(a.Ca);a.eg&&a.Re.length&&xa.SS(a);a.zb.eg&&Y.RS(a.zb);a.Ck&&(b=ba.tJ(a.Ck))&&b.zH&&ba.QS(a.Ck)};a.yW=
function(a,b,e,c){for(var d=["MAIN","SHADOW","COLOR_ID"],k=!1,n=0;n<d.length;n++){var f=d[n],v=H(a,b,f),J=H(e,c,f);if(v&&J){var k=!0,p=fa(e,c,f);"MAIN"==f&&(V(J,v),p&&V(p,v));for(f=0;f<J.Od.length;f++){var w=J.Od[f];if(-1!==Fa.indexOf(w)){var h=v.Od.indexOf(w);-1!==h&&(h=v.ya[h],sa.tD(J.ya[f]),J.ya[f]=h,sa.hw(h),p&&(w=p.Od.indexOf(w),-1!==w&&(sa.tD(p.ya[w]),p.ya[w]=h,sa.hw(h))))}}}}k||ha.error("Wrong objects for inheriting material!")};a.EZ=function(a,b,e,c){for(var d=0;d<a.I.length;d++)for(var k=
a.I[d].X,n=0;n<k.length;n++){var f=k[n];-1!=f.wd.indexOf(b)&&f.mj&&(f.mj[e]=c)}};a.DZ=function(a,b,e,c,d,k){for(var n=0;n<a.I.length;n++)for(var f=a.I[n].X,v=0;v<f.length;v++){var J=f[v];-1!=J.wd.indexOf(b)&&J.Ie&&(J.Ie[3*e]=c,J.Ie[3*e+1]=d,J.Ie[3*e+2]=k)}};a.y6=function(a,b){return a.mj[b]};a.x6=function(a,b,e){e[0]=a.Ie[3*b];e[1]=a.Ie[3*b+1];e[2]=a.Ie[3*b+2];return e};a.uJ=function(a,b){var e;e=b[1];for(var c=2;c<b.length;c++)e+="%join%"+b[c];for(c=0;c<a.length;c+=2)if(a[c]==e)return a[c+1];return null};
a.ua=function(){Na={}}};b4w.module.__boundings=function(a,g){function l(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function d(){return{G:new Float32Array(3),Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function y(a,b){for(var c=a[0],d=a[1],k=a[2],f=a[0],p=a[1],h=a[2],q=3;q<a.length;q+=3)var H=a[q],m=a[q+1],g=a[q+2],c=Math.max(c,H),d=Math.max(d,m),k=Math.max(k,g),
f=Math.min(f,H),p=Math.min(p,m),h=Math.min(h,g);b.max_x=c;b.max_y=d;b.max_z=k;b.min_x=f;b.min_y=p;b.min_z=h;return b}function r(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,k=a.max_z,f=a.min_x,p=a.min_y,h=a.min_z;b[0]=f;b[1]=p;b[2]=h;b[3]=c;b[4]=p;b[5]=h;b[6]=c;b[7]=d;b[8]=h;b[9]=f;b[10]=d;b[11]=h;b[12]=f;b[13]=p;b[14]=k;b[15]=c;b[16]=p;b[17]=k;b[18]=c;b[19]=d;b[20]=k;b[21]=f;b[22]=d;b[23]=k;return b}function A(){return{G:new Float32Array(3),Xa:0}}function h(a,b){b.G[0]=a.G[0];b.G[1]=
a.G[1];b.G[2]=a.G[2];b.Xa=a.Xa}function u(){return{Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),G:new Float32Array(3)}}function m(a,b){D.copy(a.Ga,b.Ga);D.copy(a.Ha,b.Ha);D.copy(a.Ia,b.Ia);D.copy(a.G,b.G);return b}function q(a){var b=u();m(a,b);return b}function f(a,b,c,d){return{Ga:new Float32Array(a),Ha:new Float32Array(b),Ia:new Float32Array(c),G:new Float32Array([d[0],d[1],d[2]])}}function t(a,b){var c=G.jS(a,Q),c=b?G.bS(a,c,p):B.identity(p),c=G.aV(c,k);D.copy(a,K);D.transformMat3(K,
c,K);for(var d=K[0],h=d,q=K[1],m=q,g=K[2],t=g,H=0,l=0,V=0,P=0,z=0,u=0,v=3;v<a.length;v+=3)K[0]=a[v],K[1]=a[v+1],K[2]=a[v+2],D.transformMat3(K,c,K),H=K[0],l=K[1],V=K[2],H>d&&(d=H),H<h&&(h=H),l>q&&(q=l),l<m&&(m=l),V>g&&(g=V),V<t&&(t=V);q-=m;g-=t;d=Math.max(d-h,1E-9);q=Math.max(q,1E-9);g=Math.max(g,1E-9);h=B.identity(p);h[0]=0!=d?1/d:1E8;h[4]=0!=q?1/q:1E8;h[8]=0!=g?1/g:1E8;B.transpose(c,x);K[0]=a[0];K[1]=a[1];K[2]=a[2];D.transformMat3(K,c,K);D.transformMat3(K,h,K);D.transformMat3(K,x,K);H=K[0];l=K[0];
V=K[1];P=K[1];z=K[2];u=K[2];for(v=3;v<a.length;v+=3)K[0]=a[v],K[1]=a[v+1],K[2]=a[v+2],D.transformMat3(K,c,K),D.transformMat3(K,h,K),D.transformMat3(K,x,K),H=Math.max(H,K[0]),l=Math.min(l,K[0]),V=Math.max(V,K[1]),P=Math.min(P,K[1]),z=Math.max(z,K[2]),u=Math.min(u,K[2]);v=Math.sqrt((H-l)*(H-l)+(V-P)*(V-P)+(z-u)*(z-u))/2;v=Math.min(v,1);C[0]=(H+l)/2;C[1]=(V+P)/2;C[2]=(z+u)/2;H=C;h=B.identity(p);h[0]=d;h[4]=q;h[8]=g;D.transformMat3(H,c,H);D.transformMat3(H,h,H);D.transformMat3(H,x,H);h=[c[0],c[3],c[6]];
l=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];D.scale(h,d*v,h);D.scale(l,q*v,l);D.scale(c,g*v,c);return f(h,l,c,H)}function c(a,b,c){D.add(b,c,a.G);D.scale(a.G,.5,a.G);a.Xa=D.distance(a.G,b);return a}var z=g("__tsr"),L=g("__util"),D=g("__vec3"),G=g("__math"),B=g("__mat3"),O=new Float32Array(24),K=new Float32Array(3),E=new Float32Array(3),C=new Float32Array(3),Q=new Float32Array(3),k=new Float32Array(9),p=new Float32Array(9),x=new Float32Array(9);new Float32Array(9);a.Ud=l;a.Zu=d;a.Tn=b;a.F3=function(){return{max_x:1E12,
min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.e1=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Rl=function(a){var c=l();b(a,c);return c};a.cS=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.tB=function(a,b){var c=a.max_y,d=a.max_z,k=a.min_x,f=a.min_y,p=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,k);a.min_y=Math.min(b.min_y,
f);a.min_z=Math.min(b.min_z,p)};a.LG=y;a.Ol=function(a,b,c){c||(c=l());a=r(a,O);z.fl(a,b,a);return y(a,c)};a.xI=r;a.i$=function(a,b,c){c||(c=l());var d=b.min_x,k=b.max_x,f=b.min_y,p=b.max_y,h=b.min_z;b=b.max_z;if(d>=a.max_x||k<=a.min_x||f>=a.max_y||p<=a.min_y||h>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,k);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,p);c.min_z=Math.max(a.min_z,h);
c.max_z=Math.min(a.max_z,b);return c};a.w$=function(a,b,c){c||(c=l());var d=a.max_x-a.min_x,k=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*k;c.max_y=a.max_y+.5*(b-1)*k;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.Gq=function(a,b,c){c||(c=A());z.Gc(a.G,b,c.G);b=z.td(b);c.Xa=a.Xa*(0>b?-b:b);return c};a.Fq=function(a,b,c){c||(c=u());z.Gc(a.G,b,c.G);D.copy(a.Ga,c.Ga);D.copy(a.Ha,c.Ha);D.copy(a.Ia,c.Ia);z.Yc(c.Ga,
b,c.Ga);z.Yc(c.Ha,b,c.Ha);z.Yc(c.Ia,b,c.Ia);return c};a.kA=function(a,b,c){c||(c=d());z.Gc(a.G,b,c.G);D.copy(a.Ga,c.Ga);D.copy(a.Ha,c.Ha);D.copy(a.Ia,c.Ia);z.Yc(c.Ga,b,c.Ga);z.Yc(c.Ha,b,c.Ha);z.Yc(c.Ia,b,c.Ia);return c};a.nA=function(a,b){var c=A();D.copy(b,c.G);c.Xa=a;return c};a.$Y=function(a,b,c,k,f){var p=d();D.copy(a,p.G);D.copy(b,p.Ga);D.copy(c,p.Ha);D.copy(k,p.Ia);D.scale(p.Ga,f[0],p.Ga);D.scale(p.Ha,f[1],p.Ha);D.scale(p.Ia,f[2],p.Ia);return p};a.Sh=A;a.JA=h;a.Tg=u;a.HA=m;a.Uq=q;a.Sl=function(a){var b=
A();h(a,b);return b};a.Bq=f;a.MR=function(){var a;a||(a=A());D.set(0,0,0,a.G);a.Xa=1E12;return a};a.MU=function(a,b){var c=D.subtract(b.G,a.G,D.create());0==D.length(c)&&D.set(1,0,0,c);var d=D.normalize(c,D.create()),c=D.scale(d,a.Xa,D.create());D.add(c,a.G,c);var k=D.scale(d,-a.Xa,D.create());D.add(k,a.G,k);var f=D.scale(d,b.Xa,D.create());D.add(f,b.G,f);var p=D.scale(d,-b.Xa,D.create());D.add(p,b.G,p);c=[c,k,f,p];d=D.normalize(d,D.create());k=c[0];f=c[0];for(p=1;p<c.length;p++){var h=D.dot(c[p],
d);h<D.dot(k,d)&&(k=c[p]);h>D.dot(f,d)&&(f=c[p])}d=[k,f];c=d[0];d=d[1];a.G=D.scale(D.add(c,d,D.create()),.5,D.create());a.Xa=D.length(D.subtract(d,c,D.create()))/2};a.xB=function(a,b){D.add(a.G,a.Ha,K);D.add(K,a.Ga,K);D.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.add(a.G,a.Ha,K);D.add(K,a.Ga,K);D.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.add(a.G,a.Ha,K);D.subtract(K,a.Ga,K);D.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.add(a.G,a.Ha,K);D.subtract(K,a.Ga,K);D.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.subtract(a.G,
a.Ha,K);D.add(K,a.Ga,K);D.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.subtract(a.G,a.Ha,K);D.add(K,a.Ga,K);D.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.subtract(a.G,a.Ha,K);D.subtract(K,a.Ga,K);D.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);D.subtract(a.G,a.Ha,K);D.subtract(K,a.Ga,K);D.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2])};a.Wu=t;a.dT=function(a){var b=d();D.copy(a.Ga,b.Ga);D.copy(a.Ha,b.Ha);D.copy(a.Ia,b.Ia);D.copy(a.G,b.G);return b};a.fr=function(a){var b=A(),c=0,c=D.length(a.Ga),d=D.length(a.Ha),k=D.length(a.Ia),
c=c>d?c:d;b.G=a.G;b.Xa=k>c?k:c;return b};a.$R=function(a,b){var c=q(a),d=z.ic(b,Q);D.subtract(c.G,d,c.G);return c};a.mC=function(a,b){var c=D.length(a.Ga),d=D.length(a.Ha),k=D.length(a.Ia);return.75*b.Xa*b.Xa*b.Xa>c*d*k};a.NG=function(a,b){var c=b.max_z,d=b.min_z,k=Math.max(0,c-d-2*a);return{Xa:a,height:k,G:new Float32Array([0,0,(c+d)/2])}};a.PG=function(a,b){var c=b.max_z,d=b.min_z,k=Math.max(0,c-d);return{Xa:a,height:k,G:new Float32Array([0,0,(c+d)/2])}};a.OG=function(a,b){var c=b.max_z,d=b.min_z,
k=Math.max(0,c-d);return{Xa:a,height:k,G:new Float32Array([0,0,(c+d)/2])}};a.Q3=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.FY=function(a){for(var b=0,c=0,d=0,k=0,f=0,p=0,h=0,q=0,H=0,m=0,g=0,P=0,l=0,x=0,v=0;v<a.submeshes.length;v++){var aa=a.submeshes[v];if(aa.position.length){b=k=aa.position[0];c=f=aa.position[1];d=p=aa.position[2];break}}for(v=0;v<a.submeshes.length;v++){for(var aa=a.submeshes[v],z=aa.position,
h=m=aa.position[0],q=g=aa.position[1],H=P=aa.position[2],ba=0;ba<z.length/3;ba++)var u=z[3*ba],r=z[3*ba+1],R=z[3*ba+2],b=Math.max(u,b),c=Math.max(r,c),d=Math.max(R,d),k=Math.min(u,k),f=Math.min(r,f),p=Math.min(R,p),h=Math.max(u,h),q=Math.max(r,q),H=Math.max(R,H),m=Math.min(u,m),g=Math.min(r,g),P=Math.min(R,P),l=Math.max(Math.sqrt(u*u+r*r+R*R),l),x=Math.max(Math.sqrt(u*u+r*r),x);z=aa.boundings.bb;z.max_x=h;z.min_x=m;z.max_y=q;z.min_y=g;z.max_z=H;z.min_z=P;z=O;z[0]=m;z[1]=g;z[2]=P;z[3]=h;z[4]=g;z[5]=
P;z[6]=h;z[7]=q;z[8]=P;z[9]=m;z[10]=q;z[11]=P;z[12]=m;z[13]=g;z[14]=H;z[15]=h;z[16]=g;z[17]=H;z[18]=h;z[19]=q;z[20]=H;z[21]=m;z[22]=q;z[23]=H;h=t(z,!1);aa.boundings.be_cen=h.G;aa.boundings.be_ax=[h.Ga[0],h.Ha[1],h.Ia[2]]}v=a.b4w_boundings.bb;v.max_x=b;v.min_x=k;v.max_y=c;v.min_y=f;v.max_z=d;v.min_z=p;v=a.b4w_boundings.bb_src;v.max_x=b;v.min_x=k;v.max_y=c;v.min_y=f;v.max_z=d;v.min_z=p;a.b4w_boundings.bs_rad=l;a.b4w_boundings.bc_rad=x;z=O;z[0]=k;z[1]=f;z[2]=p;z[3]=b;z[4]=f;z[5]=p;z[6]=b;z[7]=c;z[8]=
p;z[9]=k;z[10]=c;z[11]=p;z[12]=k;z[13]=f;z[14]=d;z[15]=b;z[16]=f;z[17]=d;z[18]=b;z[19]=c;z[20]=d;z[21]=k;z[22]=c;z[23]=d;h=t(z,!1);a.b4w_boundings.be_cen=h.G;a.b4w_boundings.be_ax=[h.Ga[0],h.Ha[1],h.Ia[2]]};a.UV=function(a){var b=a.subarray(0,3),d=a.subarray(6,9),k=a.subarray(12,15),f=a.subarray(18,21);a=D.subtract(d,b,K);D.normalize(a,a);var p=L.cW(b,d,k,E),p=D.cross(p,a,p);D.normalize(p,p);var h=D.create(),q=D.create();D.subtract(d,b,C);q[0]=D.dot(C,a);q[1]=D.dot(C,p);d=D.create();D.subtract(k,
b,C);d[0]=D.dot(C,a);d[1]=D.dot(C,p);k=D.create();D.subtract(f,b,C);k[0]=D.dot(C,a);k[1]=D.dot(C,p);f=A();k=[h,q,d,k];h=c(f,k[0],k[1]);for(f=2;f<k.length;f++)if(D.distance(h.G,k[f])>h.Xa){for(var m=h,h=k,q=k[f],d=f-1,m=c(m,q,h[0]),H=1;H<=d;H++)if(D.distance(m.G,h[H])>m.Xa){for(var g=m,m=h,t=q,P=h[H],l=H-1,g=c(g,t,P),x=0;x<=l;x++)if(D.distance(g.G,m[x])>g.Xa){var v=t,aa=P,z=m[x],ba=D.subtract(aa,z,C),ba=D.squaredLength(ba),u=D.subtract(v,z,C),r=D.squaredLength(u),u=D.subtract(v,aa,C),R=D.squaredLength(u),
u=ba*(r+R-ba),ca=r*(R+ba-r),ba=R*(ba+r-R),r=u+ca+ba;D.copy(v,g.G);D.scale(g.G,u/r,g.G);D.scaleAndAdd(g.G,aa,ca/r,g.G);D.scaleAndAdd(g.G,z,ba/r,g.G);g.Xa=D.distance(g.G,v)}m=g}h=m}f=h;a=D.scale(a,f.G[0],C);D.scaleAndAdd(a,p,f.G[1],a);D.add(a,b,f.G);return f}};b4w.module.__extensions=function(a,g){function l(a){if(a in h)return h[a];var b=A.getExtension(a)||null;h[a]=b;y.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function d(a){if(a in h)return h[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=A;break;case "EXT_disjoint_timer_query":(b=A.getExtension("EXT_disjoint_timer_query")||null)||(b=A.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}h[a]=b;y.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=g("__config"),y=g("__print"),r=b.B,A=null,h={};a.Uf=function(a){A=a};a.DJ=function(){return l("WEBGL_compressed_texture_s3tc")||l("WEBKIT_WEBGL_compressed_texture_s3tc")||l("MOZ_WEBGL_compressed_texture_s3tc")};a.zJ=function(){return l("WEBKIT_WEBGL_compressed_texture_pvrtc")||l("WEBGL_compressed_texture_pvrtc")};a.KV=function(){return r.fc?d("WEBGL_depth_texture"):l("WEBGL_depth_texture")||l("WEBKIT_WEBGL_depth_texture")||
l("MOZ_WEBGL_depth_texture")};a.XI=function(){return l("EXT_texture_filter_anisotropic")||l("WEBKIT_EXT_texture_filter_anisotropic")||l("MOZ_EXT_texture_filter_anisotropic")};a.JV=function(){return l("WEBGL_debug_shaders")};a.Kv=function(){return l("WEBGL_debug_renderer_info")};a.hJ=function(){return r.fc?d("OES_element_index_uint"):l("OES_element_index_uint")};a.UB=function(){return r.fc?d("OES_standard_derivatives"):l("OES_standard_derivatives")};a.KB=function(){var a=r.fc?d("EXT_disjoint_timer_query"):
l("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},SI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},TI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},RI:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return A.createQuery()},beginQuery:function(b){A.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){A.endQuery(a.TIME_ELAPSED_EXT)},SI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT_AVAILABLE)},TI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT)},RI:function(){return a.GPU_DISJOINT_EXT}}};a.$V=function(){if(r.fc)return d("ANGLE_instanced_arrays");var a=l("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,d,f,h,c){a.drawElementsInstancedANGLE(b,d,f,h,c)},vertexAttribDivisor:function(b,d){a.vertexAttribDivisorANGLE(b,d)},drawArraysInstanced:function(b,
d,f,h){a.drawArraysInstancedANGLE(b,d,f,h)}}};a.VB=function(){if(r.fc)return d("OES_vertex_array_object");var a=l("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.ua=function(){h={}};a.reset=function(){A=null}};b4w.module.__graph=function(a,g){function l(a,b,c){c||(c=null);d(a,b)?w.q("Graph already has node with given ID"):a.N.push(b,c)}function d(a,b){for(var c=a.N,e=0;e<c.length;e+=2)if(c[e]==b)return!0;return!1}function b(a,b,c,e){e||(e=null);d(a,b)&&d(a,c)?a.Pa.push(b,c,e):w.q("Wrong node IDs")}function y(a,b){d(a,b)||w.q("Node not found");for(var c=a.N,e=0;e<c.length;e+=2)c[e]==b&&(c.splice(e,2),e-=2)}function r(a,b,c,e){k(a,b,c)||w.q("Edge not found");a=a.Pa;for(var d=0,f=0;f<a.length;f+=3)if(a[f]==
b&&a[f+1]==c){if(-1==e)a.splice(f,3);else{if(e==d){a.splice(f,3);break}d++}f-=3}}function A(a){a=a.N;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function h(a,b){for(var c=a.N,e=0;e<c.length;e+=2)if(c[e+1]==b)return c[e];return-1}function u(a){var b=[],c={};m(a,c);for(var e=a.N,d=0;d<e.length;d+=2)0==E(a,e[d])&&q(a,e[d],c,b);return{N:b,Pa:a.Pa.slice(0)}}function m(a,b){for(var c=a.N,e=0;e<c.length;e+=2)b[c[e]]=!1}function q(a,b,c,e){if(!c[b]){c[b]=!0;for(var d=0;d<K(a,b);d++)q(a,
C(a,b,d),c,e);e.unshift(b,O(a,b))}}function f(a,b,c,e){if(!c[b]){c[b]=!0;if(10==e||30==e)for(var d=0;d<K(a,b);d++){var k=C(a,b,d);f(a,k,c,e)}if(20==e||30==e)for(d=0;d<E(a,b);d++)k=Q(a,b,d),f(a,k,c,e)}}function t(a){for(var b=a.Pa,c=0;c<b.length;c+=3){var e=b[c+1];d(a,b[c])&&d(a,e)||(b.splice(c,3),c-=3)}}function c(a){for(var b=[],c=a.N,e=0;e<c.length;e+=2){var d=c[e];K(a,d)||b.push(d)}return b}function z(a){var b=a.N;a=a.Pa;for(var c=[],e=[],d=[],k=0;k<b.length;k++)d[b[2*k]]=k,c.push(k,b[2*k+1]);
for(k=0;k<a.length;k+=3)e.push(d[a[k]],d[a[k+1]],a[k+2]);return{N:c,Pa:e}}function L(a,b,c){if(c.Rh==c.Bk){for(var e=0,d=0;e<c.Bk;e++)-1!=c.Pi[e]&&(a[d]=e,b[d]=c.Pi[e],d++);return!0}if(c.Bk>c.Fo||c.bl>c.cl||c.rp>c.tp||c.qp>c.sp)return!1;for(var d=e=-1,k=!1;!k&&D(c,n,e,d);)if(e=n[0],d=n[1],G(c,e,d)){var f;f=c;k={};k.Kr=f.Kr;k.Lr=f.Lr;k.VC=f.VC;k.ov=f.ov;k.Bk=f.Bk;k.Fo=f.Fo;k.Fk=f.Fk;k.Rh=k.Tw=f.Rh;k.qp=f.qp;k.rp=f.rp;k.bl=f.bl;k.sp=f.sp;k.tp=f.tp;k.cl=f.cl;k.nq=-1;k.Pi=f.Pi;k.Vl=f.Vl;k.ym=f.ym;k.zm=
f.zm;k.Sm=f.Sm;k.Tm=f.Tm;k.Ix=f.Ix;f.Ix[0]+=1;var k=f=k,p=e,h=d,q=k.Kr,g=k.Lr,w=k.Bk,v=k.Fo,m=k.Pi,t=k.Vl,l=k.ym,x=k.zm,z=k.Sm,R=k.Tm;B(p<w);B(h<v);B(k.Rh<w);B(k.Rh<v);w=++k.Rh;k.nq=p;l[p]||(l[p]=w,k.qp++,z[p]&&k.bl++);z[p]||(z[p]=w,k.rp++,l[p]&&k.bl++);x[h]||(x[h]=w,k.sp++,R[h]&&k.cl++);R[h]||(R[h]=w,k.tp++,x[h]&&k.cl++);m[p]=h;t[h]=p;for(m=0;m<E(q,p);m++)t=Q(q,p,m),l[t]||(l[t]=w,k.qp++,z[t]&&k.bl++);for(m=0;m<K(q,p);m++)t=C(q,p,m),z[t]||(z[t]=w,k.rp++,l[t]&&k.bl++);for(m=0;m<E(g,h);m++)t=Q(g,h,
m),x[t]||(x[t]=w,k.sp++,R[t]&&k.cl++);for(m=0;m<K(g,h);m++)t=C(g,h,m),R[t]||(R[t]=w,k.tp++,x[t]&&k.cl++);k=L(a,b,f);B(1>=f.Rh-f.Tw);B(-1!=f.nq);t=f.Kr;p=f.Lr;h=f.Rh;q=f.nq;g=f.Pi;l=f.Vl;w=f.ym;x=f.zm;v=f.Sm;z=f.Tm;if(f.Tw<h){w[q]==h&&(w[q]=0);for(R=0;R<E(t,q);R++)m=Q(t,q,R),w[m]==h&&(w[m]=0);v[q]==h&&(v[q]=0);for(R=0;R<K(t,q);R++)m=C(t,q,R),v[m]==h&&(v[m]=0);t=g[q];x[t]==h&&(x[t]=0);for(R=0;R<E(p,t);R++)m=Q(p,t,R),x[m]==h&&(x[m]=0);z[t]==h&&(z[t]=0);for(R=0;R<K(p,t);R++)m=C(p,t,R),z[m]==h&&(z[m]=
0);g[q]=-1;l[t]=-1;f.Rh=f.Tw;f.nq=-1}}return k}function D(a,b,c,e){-1==c&&(c=0);-1==e?e=0:e++;var d=a.bl,k=a.cl,f=a.rp,p=a.tp,h=a.qp,n=a.sp,q=a.Rh,g=a.Bk,v=a.Fo,m=a.Pi,w=a.Vl,t=a.ym,l=a.zm,x=a.Sm,R=a.Tm;if(d>q&&k>q)for(;c<g&&(-1!=m[c]||0==x[c]||0==t[c]);)c++,e=0;else if(f>q&&p>q)for(;c<g&&(-1!=m[c]||0==x[c]);)c++,e=0;else if(h>q&&n>q)for(;c<g&&(-1!=m[c]||0==t[c]);)c++,e=0;else if(0==c&&0!=a.Fk){for(t=0;t<g&&-1!=m[c=a.Fk[t]];)t++;t==g&&(c=g)}else for(;c<g&&-1!=m[c];)c++,e=0;if(d>q&&k>q)for(;e<v&&(-1!=
w[e]||0==R[e]||0==l[e]);)e++;else if(f>q&&p>q)for(;e<v&&(-1!=w[e]||0==R[e]);)e++;else if(h>q&&n>q)for(;e<v&&(-1!=w[e]||0==l[e]);)e++;else for(;e<v&&-1!=w[e];)e++;return c<g&&e<v?(b[0]=c,b[1]=e,!0):!1}function G(a,b,c){var e=a.Kr,d=a.Lr,f=a.Fo,h=a.Pi,n=a.Vl,q=a.ym,g=a.zm,m=a.Sm,w=a.Tm;B(b<a.Bk);B(c<f);B(-1==h[b]);B(-1==n[c]);if(!(0,a.VC)(O(e,b),O(d,c)))return!1;for(var v=f=0,t=0,l=0,x=0,z=0,r=0;r<K(e,b);r++){var R=C(e,b,r);if(-1!=h[R]){var ca=h[R];if(!k(d,c,ca)||!p(a.ov,e,b,R,d,c,ca))return!1}else q[R]&&
t++,m[R]&&f++,q[R]||m[R]||x++}for(r=0;r<E(e,b);r++)if(R=Q(e,b,r),-1!=h[R]){if(ca=h[R],!k(d,ca,c)||!p(a.ov,e,R,b,d,ca,c))return!1}else q[R]&&t++,m[R]&&f++,q[R]||m[R]||x++;for(r=0;r<K(d,c);r++)if(ca=C(d,c,r),-1!=n[ca]){if(R=n[ca],!k(e,b,R))return!1}else g[ca]&&l++,w[ca]&&v++,g[ca]||w[ca]||z++;for(r=0;r<E(d,c);r++)if(ca=Q(d,c,r),-1!=n[ca]){if(R=n[ca],!k(e,R,b))return!1}else g[ca]&&l++,w[ca]&&v++,g[ca]||w[ca]||z++;return t<=l&&f<=v&&x<=z}function B(a){a||w.q("Assertion failed")}function O(a,b){for(var c=
a.N,e=0;e<c.length;e+=2)if(c[e]==b)return c[e+1];return null}function K(a,b){for(var c=a.Pa,e=0,d=0;d<c.length;d+=3)c[d]==b&&e++;return e}function E(a,b){for(var c=a.Pa,e=0,d=0;d<c.length;d+=3)c[d+1]==b&&e++;return e}function C(a,b,c){a=a.Pa;for(var e=0,d=0;d<a.length;d+=3)if(a[d]==b){if(e==c)return a[d+1];e++}return-1}function Q(a,b,c){a=a.Pa;for(var e=0,d=0;d<a.length;d+=3)if(a[d+1]==b){if(e==c)return a[d];e++}return-1}function k(a,b,c){a=a.Pa;for(var e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c)return!0;
return!1}function p(a,b,c,d,k,f,p){for(var h=x(b,c,d),n=x(k,f,p),q=0;q<h;q++){for(var g=!1,m=0;m<n;m++)if(a(e(b,c,d,q),e(k,f,p,m))){g=!0;break}if(!g)return!1}return!0}function x(a,b,c){var e=0;a=a.Pa;for(var d=0;d<a.length;d+=3)a[d]==b&&a[d+1]==c&&e++;return e}function e(a,b,c,e){a=a.Pa;for(var d=0,k=0;k<a.length;k+=3)if(a[k]==b&&a[k+1]==c){if(d==e)return a[k+2];d++}return null}g("__print");var w=g("__util"),n=[-1,-1];a.Gz=-1;a.F1=10;a.Kt=20;a.X2=30;a.create=function(){for(var a=arguments,b=[],c=
[],e=0;e<a.length;e++){var d=a[e];switch(d.length){case 2:b.push(d[0],d[1]);break;case 3:c.push(d[0],d[1],d[2]);break;default:w.q("Wrong graph constructor params")}}return{N:b,Pa:c}};a.clone=function(a,b,c){if(b)for(var e=Array(a.N.length),d=0;d<a.N.length;d+=2)e[d]=a.N[d],e[d+1]=b(a.N[d+1]);else e=w.T(a.N);if(c)for(b=Array(a.Pa.length),d=0;d<a.Pa.length;d+=3)b[d]=a.Pa[d],b[d+1]=a.Pa[d+1],b[d+2]=c(a.Pa[d+2]);else b=w.T(a.Pa);return a={N:e,Pa:b}};a.t4=function(a,b){for(var c=[],e=[],d=0;d<a.length;d++)c.push(a[d][0],
a[d][1]);for(d=0;d<b.length;d++)e.push(b[d][0],b[d][1],b[d][2]);return{N:c,Pa:e}};a.Qj=l;a.y7=d;a.fd=b;a.zg=y;a.Pk=r;a.To=function(a,b,c,e){k(a,b,c)||w.q("Edge not found");a=a.Pa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c&&a[d+2][0]==e[0]&&a[d+2][1]==e[1]){a.splice(d,3);break}};a.J=function(a,b){if(-1==h(a,b)){var c=A(a);l(a,c,b);return c}w.q("Non-unique attribute")};a.QY=function(a,b,c,e,d){a=a.Pa;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&a[k+2]==e&&(a[k+2]=d)};a.oR=function(a,c,e){var d;
e=e||[];d=d||[];for(var k={},f=0;f<a.N.length;f+=2){var p=a.N[f],h=a.N[f+1],n=A(c);l(c,n,h);k[p]=n}for(f=0;f<a.Pa.length;f+=3)h=k[a.Pa[f]],n=k[a.Pa[f+1]],p=a.Pa[f+2],b(c,h,n,p);for(f=0;f<e.length;f+=3)h=k[e[f]],a=e[f+1],p=e[f+2],b(c,h,a,p);for(f=0;f<d.length;f+=3)e=d[f],n=k[d[f+1]],p=d[f+2],b(c,e,n,p)};a.om=A;a.qh=h;a.r=function(a,c,e,d){c=h(a,c);e=h(a,e);-1!=c&&-1!=e?b(a,c,e,d):w.q("Attributes not found")};a.pa=function(a,b){for(var c=a.N,e=0;e<c.length&&!b(c[e],c[e+1]);e+=2);};a.Dg=function(a,b){for(var c=
a.Pa,e=0;e<c.length&&!b(c[e],c[e+1],c[e+2]);e+=3);};a.vi=function(a,b,c){for(var e=a.Pa,d=0;d<e.length;d+=3)if(e[d+1]==b){var k=e[d];if(c(k,O(a,k),e[d+2]))break}};a.hl=function(a,b,c){for(var e=a.Pa,d=0;d<e.length;d+=3)if(e[d]==b){var k=e[d+1];if(c(k,O(a,k),e[d+2]))break}};a.xE=u;a.M_=function(a){a=u(a).N;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.S7=function(){};a.Wx=function(a,b,c){d(a,b)||w.q("No such node");var e={};m(a,e);f(a,b,e,c);b=[];for(var k in e)e[k]&&(k=Number(k),b.push(k,
O(a,k)));a={N:b,Pa:a.Pa.slice(0)};t(a);return a};a.yA=t;a.dW=function(a){for(var b=[],c=a.N,e=0;e<c.length;e+=2){var d=c[e];E(a,d)||b.push(d)}return b};a.Qr=c;a.match=function(a,b,c,e){var d={};d.Kr=z(a);d.Lr=z(b);d.VC=c||function(a,b){return a==b};d.ov=e||function(a,b){return a==b};e=a.N.length/2;var k=b.N.length/2;d.Bk=e;d.Fo=k;d.Fk=0;d.Rh=d.Tw=0;d.bl=d.qp=d.rp=0;d.cl=d.sp=d.tp=0;d.nq=-1;d.Pi=Array(e);d.Vl=Array(k);d.ym=Array(e);d.zm=Array(k);d.Sm=Array(e);d.Tm=Array(k);d.Ix=[1];for(c=0;c<e;c++)d.Pi[c]=
-1,d.ym[c]=0,d.Sm[c]=0;for(c=0;c<k;c++)d.Vl[c]=-1,d.zm[c]=0,d.Tm[c]=0;k=Array(e);e=Array(e);if(L(k,e,d)){for(c=0;c<k.length;c++)k[c]=a.N[2*k[c]],e[c]=b.N[2*e[c]];return[k,e]}return null};a.aW=function(a,b){for(var c=a.N,e=1;e<c.length;e+=2)if(c[e]==b)return c[e-1];return null};a.Va=O;a.xg=K;a.so=E;a.gh=C;a.Zi=Q;a.W5=x;a.$d=e;a.replace=function(a,b,c){for(var e=a.Pa,d=A(a),k=0;k<b.length;k++){var f=b[k];y(a,f);for(var p=0;p<e.length;p+=3)e[p]==f&&(e[p]=d),e[p+1]==f&&(e[p+1]=d),e[p]==e[p+1]&&(e.splice(p,
3),p-=3)}l(a,d,c)};a.GY=function(a,b,c,e,d){k(a,b,c)||w.q("Edge not found");a=a.Pa;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==c&&(a[f]=e,a[f+1]=d)};a.JU=function(a,b){function e(a,b){if(-1!=h.indexOf(a)){var c=h.slice(h.indexOf(a));if(-1!=k[c[c.length-1]].indexOf(c[0])){n.push([a,c[c.length-1]]);return}}h.push(a);for(c=0;c<b.length;c++)b[c]in k&&e(b[c],k[b[c]])}b||(b=c(a)[0]);var d=a.Pa;if(d.length&&-1!=d.indexOf(b)){for(var k={},f=0,p=0;p<d.length;p+=3)d[p+1]in k?k[d[p+1]].push(d[p]):k[d[p+1]]=
[d[p]],f++;var h=[],n=[];e(b,k[b]);for(p=0;p<n.length;p++)for(var q=f=0;q<d.length;q+=3)n[p][1]==d[q+1]&&n[p][0]==d[q]&&r(a,d[q],d[q+1],f),f++}};a.lU=function(a,b,c){var e=a.N;a=a.Pa;var d;d="digraph debug {\n    node [shape=box];\n";for(var k=0;k<e.length;k+=2){var f=e[k],p=e[k+1],p=b?b(f,p):String(f);d+="    ";d+=String(f)+' [label="'+p.replace(/\"/g,'\\"')+'"];\n'}for(k=0;k<a.length;k+=3)b=a[k],e=a[k+1],p=a[k+2],d+="    ",d+=String(b)+" -> "+String(e),c&&(d+=' [label="'+c(b,e,p)+'"]'),d+=";\n";
return d+="}"}};b4w.module.__nodemat=function(a,g){function l(a,b,e,k,f){var v=Ia.A(),v=h(b,f,v.uuid);if(v in za)return za[v];var n={Wa:null,id:v,zH:!0};e||(Fa={},Na=0);if("SHADOW"!=f&&"COLOR_ID"!=f){b=J.create();for(var H=a.nodes,g=0;g<H.length;g++)if(null==ea(b,H[g],0,k,f))return za[v]=null,n;if(e&&-1==w(a,b,"GROUP_OUTPUT","group"))return n;g=R(b);H=e?a.links:a.links.slice();if(!ca(b,H,g))return n;if(e)return n.Wa=b,n;for(g=0;g<H.length;g++){e=H[g];for(var P=z(e.from_node,b),x=z(e.to_node,b),ba=0;ba<P.length;ba++)for(var V=
0;V<x.length;V++){var Y=P[ba],aa=x[V],F=J.Va(b,Y),I=J.Va(b,aa);if(!ya(b,Y,aa,F,I,e))return za[v]=null,n}}c(b);"GLOW"==f?g=w(a,b,"B4W_GLOW_OUTPUT","material",!0):(g=w(a,b,"OUTPUT","material",!1,!0),-1==g&&(g=w(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==g&&(b=m(),g=0);L(b);a=J.Wx(b,g,J.Kt);d(a,k);r(a,k);q(a);G(a);p(a);t(a,k,f);sa(a)}else k=l(a,b,e,k,"MAIN"),k=J.clone(k.Wa,function(a){var b=Ca.Vq(a);b.M=Ca.T(a.M);b.fb=Ca.T(a.fb);return b}),g=w(a,k,"OUTPUT","material",!1,!0),-1==g&&(g=w(a,k,"OUTPUT_MATERIAL",
"material",!1,!0)),u(k,g),a=J.Wx(k,g,J.Kt),q(a);n.Wa=a;return za[v]=n}function d(a,c){var e=[];J.pa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||e.push({ys:a,node:b})});for(var d=0;d<e.length;++d){var k=e[d].ys,f=e[d].node,p=J.om(a);J.Qj(a,p,f.data.KX);var h=J.om(a);J.Qj(a,h,f.data.LX);J.fd(a,p,h,[4,2]);for(var v={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},n=J.so(a,k),q=[],g=[],H=[],m={},w=0;w<n;w++){var t=J.Zi(a,k,
w);t in m||(m[t]=0);var P=J.$d(a,t,k,m[t]++);q.push([t,k,P]);var R=v[P[1]];if(R)switch(R[0]){case "MATERIAL_END":g.push([t,h,[P[0],R[1]]]);break;case "LIGHTING_APPLY":H.push([t,[P[0],R[1]]])}else g.push([t,p,P])}b(a,f.data.value,p,h,H,c);for(w=0;w<q.length;w++)J.To(a,q[w][0],q[w][1],q[w][2]);for(w=0;w<g.length;w++)J.fd(a,g[w][0],g[w][1],g[w][2]);f=J.xg(a,k);p=[];v=[];n={};for(w=0;w<f;w++)q=J.gh(a,k,w),q in n||(n[q]=0),P=J.$d(a,k,q,n[q]++),p.push([k,q,P]),v.push([h,q,P]);for(w=0;w<p.length;w++)J.To(a,
p[w][0],p[w][1],p[w][2]);for(w=0;w<v.length;w++)J.fd(a,v[w][0],v[w][1],v[w][2]);J.zg(a,k)}}function b(a,b,c,e,d,k){var f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},p=ea(a,f,0,k,null),h=p;y(a,c,p,"E");y(a,c,p,"A");y(a,c,p,"D");p=Ia.A();p=ja.Ub(p,"LAMP",ja.oc);if(!b.Pe)for(var v,n,q,g=0;g<p.length;g++){q=p[g].tb;f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};v=ea(a,f,0,k,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=ea(a,f,0,k,null);y(a,h,n,"color");y(a,h,n,"specular");y(a,v,n,"ldir");
y(a,c,n,"normal");y(a,c,n,"D");y(a,c,n,"S");y(a,v,n,"lcolorint");y(a,c,v,"shadow_factor");h="SPECULAR_"+b.it;f={name:h,type:h,use_tangent_shading:b.tn};h=ea(a,f,0,k,null);y(a,v,h,"ldir");y(a,v,h,"lfac");y(a,c,h,"normal");y(a,h,n,"sfactor");y(a,v,h,"norm_fac");y(a,c,h,"sp_params");h="HEMI"==q.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.qr;f={name:h,type:h,use_tangent_shading:b.tn};q=ea(a,f,0,k,null);y(a,v,q,"ldir");y(a,v,q,"lfac");y(a,c,q,"normal");y(a,v,q,"norm_fac");y(a,q,n,"lfactor");"DIFFUSE_LAMBERT"!=
h&&y(a,c,q,"dif_params");for(v=0;v<d.length;v++)J.fd(a,d[v][0],n,d[v][1]);h=n}y(a,h,e,"color");y(a,h,e,"specular")}function y(a,b,c,e){for(var d=J.Va(a,b),k=J.Va(a,c),f,p=0;p<k.M.length;p++)if(e==k.M[p].identifier){f=p;break}if(void 0!==f){for(var h,p=0;p<d.fb.length;p++)if(e==d.fb[p].identifier){h=p;break}void 0!==h&&J.fd(a,b,c,[h,f])}}function r(a,b){var c=[];J.pa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({ys:a,node:b})});for(var e=0;e<c.length;++e){var d=c[e].ys,k=c[e].node,f=J.om(a);J.Qj(a,
f,k.data.WR);var p=J.om(a);J.Qj(a,p,k.data.XR);J.fd(a,f,p,[4,2]);for(var h=J.so(a,d),v=[],n=[],q={},g=0;g<h;g++){var H=J.Zi(a,d,g),w=J.Va(a,H);H in q||(q[H]=0);var m=J.$d(a,H,d,q[H]++);v.push([H,d,m]);n.push([H,f,m]);if("BSDF_GLOSSY"==w.type||"BSDF_DIFFUSE"==w.type||"MIX_SHADER"==w.type||"EMISSION"==w.type){n.push([H,f,[1,1]]);n.push([H,f,[2,2]]);n.push([H,f,[3,3]]);n.push([H,f,[4,4]]);n.push([H,f,[5,5]]);n.push([H,f,[6,6]]);n.push([H,f,[7,7]]);n.push([H,f,[8,8]]);var t=[];J.pa(a,function(a,b){"MIX_SHADER"==
b.type&&t.push({ys:a,node:b})});for(m=0;m<t.length;++m)for(var H=t[m].ys,w=J.so(a,H),P=0;P<w;P++){var R=J.Zi(a,H,P),l=J.Va(a,R),x=J.$d(a,R,H,0);0==x[1]||"BSDF_GLOSSY"!=l.type&&"BSDF_DIFFUSE"!=l.type&&"MIX_SHADER"!=l.type&&"EMISSION"!=l.type||(l=1==x[1]?3:11,n.push([R,H,[1,l]]),n.push([R,H,[2,l+1]]),n.push([R,H,[3,l+2]]),n.push([R,H,[4,l+3]]),n.push([R,H,[5,l+4]]),n.push([R,H,[6,l+5]]),n.push([R,H,[7,l+6]]),n.push([R,H,[8,l+7]]))}}}A(a,k.data.value,f,p,b);for(g=0;g<v.length;g++)J.To(a,v[g][0],v[g][1],
v[g][2]);for(g=0;g<n.length;g++)J.fd(a,n[g][0],n[g][1],n[g][2]);k=J.xg(a,d);f=[];h=[];v={};for(g=0;g<k;g++)n=J.gh(a,d,g),n in v||(v[n]=0),m=J.$d(a,d,n,v[n]++),f.push([d,n,m]),h.push([p,n,m]);for(g=0;g<f.length;g++)J.To(a,f[g][0],f[g][1],f[g][2]);for(g=0;g<h.length;g++)J.fd(a,h[g][0],h[g][1],h[g][2]);J.zg(a,d)}}function A(a,b,c,e,d){var k=[],f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},p=ea(a,f,0,d,null),h=p;y(a,c,p,"E");y(a,c,p,"A");y(a,c,p,"D");for(var p=Ia.A(),p=ja.Ub(p,"LAMP",ja.oc),v,n,
q=0;q<p.length;q++){f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};v=ea(a,f,0,d,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=ea(a,f,0,d,null);y(a,h,n,"color");y(a,h,n,"specular");y(a,v,n,"ldir");y(a,c,n,"normal");y(a,c,n,"D");y(a,c,n,"S");y(a,v,n,"lcolorint");y(a,c,v,"shadow_factor");h=b.YR;f={name:h,type:h};h=ea(a,f,0,d,null);y(a,v,h,"ldir");y(a,v,h,"lfac");y(a,c,h,"normal");y(a,v,h,"norm_fac");y(a,c,h,"bsdf_params");y(a,h,n,"lfactor");y(a,h,n,"sfactor");for(h=0;h<k.length;h++)J.fd(a,k[h][0],
n,k[h][1]);h=n}y(a,c,e,"s_color");y(a,c,e,"metalness");y(a,c,e,"e_color");y(a,c,e,"emission");y(a,h,e,"color");y(a,h,e,"specular")}function h(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function u(a,b){J.Dg(a,function(c,e,d){var k=J.Va(a,e);e==b&&"Color"==k.M[d[1]].identifier&&J.To(a,c,e,d)})}function m(){var a=J.create(),b={data:null,Sb:[],qb:[],M:[{Ea:new Float32Array([0,0,0]),identifier:"Color",ab:!1,name:"Color"},{Ea:1,identifier:"Alpha",
ab:!1,name:"Alpha"}],fb:[],type:"OUTPUT",yi:[]};J.Qj(a,0,b);return a}function q(a){J.pa(a,function(b,c){for(var e=c.M,d=c.fb,k=0;k<e.length;k++)f(a,e[k],b,k,1);for(k=0;k<d.length;k++)f(a,d[k],b,k,0)})}function f(a,b,c,e,d){if(b.ab){var k=!0;J.Dg(a,function(a,b,f){if(!d&&a==c&&f[0]==e||d&&b==c&&f[1]==e)k=!1});k&&(b.ab=!1)}}function t(a,b,c){var e=[];J.Dg(a,function(d,k,f){var p=J.Va(a,d),h=J.Va(a,k),p=Ca.xk(p.fb[f[0]].Ea),h=Ca.xk(h.M[f[1]].Ea);if(p!=h){var v,q={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},g={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};p&&!h?v=n("vector_to_scalar","B4W_VECTOSCAL",[q],[g]):!p&&h&&(v=n("scalar_to_vector","B4W_SCALTOVEC",[g],[q]));ea(a,v,0,b,c);e.push([d,k,a.N[a.N.length-2],f])}});for(var d=0;d<e.length;++d)J.To(a,e[d][0],e[d][1],e[d][3]),J.fd(a,e[d][0],e[d][2],[e[d][3][0],0]),J.fd(a,e[d][2],e[d][1],[0,e[d][3][1]])}function c(a){var b=[];J.pa(a,function(c,e){switch(e.type){case "B4W_TRANSLUCENCY":J.Dg(a,function(d,k,f){var p=
J.Va(a,k);d==c&&"MATERIAL_EXT"==p.type&&"Translucency"==e.fb[f[0]].name&&b.push(d,k,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)J.fd(a,b[c],b[c+1],b[c+2])}function z(a,b){var c=[];J.pa(b,function(b,e){e.name==a.name&&c.push(b)});if(c.length)return c;Ca.q("Node not found")}function L(a){var b=[];J.pa(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var e=b[c],d=b[c+1];if("B4W_PARALLAX"==d.type)D(a,e,d);else if("REROUTE"==d.type){for(var k=
J.Zi(a,e,0),f=J.xg(a,e),p=[],h=[],v=[],n=0;n<f;n++){var q=J.gh(a,e,n),g=h.indexOf(q),H=0<=g?v[H]:0,w=J.$d(a,e,q,H);if(w){var w=w[1],m=d.M[0].Ea,w=J.Va(a,q).M[w];switch(typeof m){case "number":if("object"==typeof w.Ea)for(var t=w.Ea,w=0;w<t.length;w++)t[w]=m;else"number"==typeof w.Ea&&(w.Ea=m);break;case "object":if("object"==typeof w.Ea)for(t=w.Ea,w=0;w<t.length;w++)t[w]=m[w];else"number"==typeof w.Ea&&(w.Ea=.35*m[0]+.45*m[1]+.2*m[2])}}m=d.fb;for(w=0;w<m.length;w++)m[w].Ea=d.M[0].Ea;-1!=g?v[g]+=1:
(h.push(q),v.push(1),p.push(e,q))}if(-1!=k)for(d=J.$d(a,k,e,0)[0],n=0;n<h.length;n++)for(w=0;w<v[n];w++)f=J.$d(a,e,h[n],w)[1],J.fd(a,k,h[n],[d,f]);for(n=0;n<p.length;n+=2)J.Pk(a,p[n],p[n+1],-1)}}}function D(a,b,c){var e;a:{e=a.Pa;for(var d=0;d<e.length;d+=3)if(e[d+1]==b&&1==e[d+2][1]){e=e[d];break a}e=-1}-1!=e&&(d=J.Va(a,e),c.data=d.data,J.Pk(a,e,b,-1),0==J.xg(a,e)&&(b=J.Zi(a,e,0),-1!=b&&J.Pk(a,b,e,-1),J.zg(a,e)));c.M.splice(1,1)}function G(a){O(a);C(a);B(a)}function B(a){var b=[],c="",e="",d={};
J.pa(a,function(a,k){if("GEOMETRY_UV"==k.type||"UVMAP"==k.type||"TEX_COORD_UV"==k.type){b.push(a,k);var f=k.data.value;c?c==f||e||(e=f,d[e]=0):(c=f,d[c]=0);d[f]++}});for(var f in d)if(2>d[f]){for(var p=0;p<b.length;p+=2)b[p+1].data.value==f&&b.splice(p,2);delete d[f];c==f&&(c=e,e="");e==f&&(e="")}if(!(3>b.length)){var p={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},h={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=n("merged_uv","UV_MERGED",
[],[p,h]);f.uv_layer=c;ea(a,f,0,"",void 0);var v=a.N[a.N.length-2];f=a.N[a.N.length-1];if(e){h=n("merged_uv","UV_MERGED",[],[p,h]);h.uv_layer=e;ea(a,h,0,"",void 0);var q=a.N[a.N.length-2],h=a.N[a.N.length-1]}else h=null;for(var g=-1,H=null,p=0;p<b.length;p+=2){var w=b[p],m=b[p+1];k(m,b[1])?(g=v,H=f):h&&(g=q,H=h);for(var t=[],P=J.xg(a,w),R={},l=0;l<P;l++){var x=J.gh(a,w,l);x in R||(R[x]=0);var z=J.$d(a,w,x,R[x]++);t.push(w,x,z);z=z.splice(0,z.length);switch(m.type){case "GEOMETRY_UV":z[0]=0;H.fb[0].ab=
!0;break;case "UVMAP":case "TEX_COORD_UV":z[0]=1,H.fb[1].ab=!0}J.fd(a,g,x,z)}for(var l=0;l<t.length;l+=3)J.Pk(a,t[l],t[l+1],0);J.zg(a,w)}}}function O(a){var b=[];J.pa(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],e=0;e<b.length;e+=2){for(var d=b[e],k=b[e+1],f=!0,p=0;p<c.length;p++){var h=c[p];if(Q(k,
h.Ff)){f=[];p=J.xg(a,d);for(q=0;q<p;q++){var v=J.gh(a,d,q),n=J.$d(a,d,v,0);f.push(d,v,n);J.fd(a,h.id,v,n)}for(var q=0;q<f.length;q+=3)J.Pk(a,f[q],f[q+1],0);J.zg(a,d);f=!1;break}}f&&(h={id:d,Ff:k},c.push(h))}}function K(a){for(var b={},c=0;c<a.N.length;c+=2){var e=a.N[c];b[e]={vq:{},pK:!1}}for(c=0;c<a.Pa.length;c+=3)b[a.Pa[c+1]].vq[a.Pa[c]]=!0;for(e in b)E(e,b);for(e in b)b[e]=Object.keys(b[e].vq).map(function(a){return parseInt(a)});return b}function E(a,b){var c=b[a];if(!c.pK){var e=Ca.T(c),d;for(d in c.vq){E(d,
b);var c=b[d],k;for(k in c.vq)e.vq[k]=!0}e.pK=!0;b[a]=e}}function C(a){var b=[];J.pa(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=K(a),e=[],d=0;d<b.length;d+=2){for(var k=b[d],f=b[d+1],p=!0,h=0;h<e.length;h++){var v=e[h];if(!(3<=v.Do.length||!Q(f,v.Ff)||-1<c[k].indexOf(v.id)||-1<c[v.id].indexOf(k))){for(var n=!1,q=0;q<v.Do.length;q++){var g=v.Do[q].id;if(-1<c[k].indexOf(g)||-1<c[g].indexOf(k)){n=!0;break}}if(!n){for(var h=[],g=J.so(a,k),H=
{},q=0;q<g;q++)n=J.Zi(a,k,q),n in H||(H[n]=0),p=J.$d(a,n,k,H[n]++),h.push(n,k,p);for(var g=[],H=J.xg(a,k),w={},q=0;q<H;q++)n=J.gh(a,k,q),n in w||(w[n]=0),p=J.$d(a,k,n,w[n]++),g.push(k,n,p);p=h.concat(g);for(q=0;q<p.length;q+=3)J.Pk(a,p[q],p[q+1],0);J.zg(a,k);q={id:k,Ff:f,AU:h,BU:g};v.Do.push(q);p=!1;break}}}p&&(v={id:k,Ff:f,Do:[]},e.push(v))}for(d=0;d<e.length;d++){v=e[d];c=v.Do.length;for(h=0;h<c;h++){f=v.Do[h];q=f.Ff;k=f.AU;f=f.BU;v.Ff.M[h+1].ab=q.M[0].ab;v.Ff.M[h+1].Ea=q.M[0].Ea;v.Ff.fb[2*(h+1)].ab=
q.fb[0].ab;v.Ff.fb[2*(h+1)].Ea=q.fb[0].Ea;v.Ff.fb[2*(h+1)+1].ab=q.fb[1].ab;v.Ff.fb[2*(h+1)+1].Ea=q.fb[1].Ea;for(q=0;q<k.length;q+=3)n=k[q],p=k[q+2],p[1]+=h+1,J.fd(a,n,v.id,p);for(q=0;q<f.length;q+=3)n=f[q+1],p=f[q+2],p[0]+=2*(h+1),J.fd(a,v.id,n,p);v.Ff.Sb.push(["USE_uv"+(h+2),1])}J.zg(a,v.id);J.Qj(a,v.id,v.Ff)}}}function Q(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.mA==b.data.value.mA&&a.data.value.ro==b.data.value.ro;default:return!1}}function k(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function p(a){var b=[],c=[];J.pa(a,function(a,e){"GEOMETRY_VC"==e.type&&b.push(a,e);"GEOMETRY_VW"==e.type&&c.push(a,e)});x(a,b);e(a,c)}function x(a,b){for(var c=0;c<b.length;c+=2){for(var e=b[c],d=b[c+1],k=!1,f=[],p=[],h=[[],
[],[]],v=J.xg(a,e),n=0;n<v;n++){var q=J.gh(a,e,n);if("SEPRGB"!=J.Va(a,q).type){k=!1;break}f.push(e,q);for(var g={},H=J.xg(a,q),k=0;k<H;k++){var w=J.gh(a,q,k);w in g||(g[w]=0);var m=J.$d(a,q,w,g[w]++);f.push(q,w);h[m[0]].push(e,w,m)}p.push(q);k=!0}if(k){for(n=e=v=0;n<h.length;n++)h[n].length&&(v++,e|=1<<2-n);if(v){d.type+=v;d.fb=[];for(n=0;n<h.length;n++)if(h[n].length)for(d.fb.push({Ea:0,identifier:"RGB"[n],ab:!0,name:"RGB"[n]}),k=0;k<h[n].length;k+=3)h[n][k+2][0]=Ca.Vo(e,n);for(n=0;n<f.length;n+=
2)J.Pk(a,f[n],f[n+1],0);for(n=0;n<p.length;n++)J.zg(a,p[n]);for(n=0;n<h.length;n++)for(k=0;k<h[n].length;k+=3)J.fd(a,h[n][k],h[n][k+1],h[n][k+2])}}}}function e(a,b){for(var c=0;c<b.length;c+=2){for(var e=b[c],d=!0,k=[],f=J.xg(a,e),p=0;p<f;p++){var h=J.gh(a,e,p);if("B4W_REFLECT"==J.Va(a,h).type){var n=J.$d(a,e,h,0),v=J.$d(a,e,h,1);n&&1==n[1]||v&&1==v[1]?d=!1:k.push(e,h)}else d=!1}for(p=0;p<k.length;p+=2)f=a,n=k[p],h=k[p+1],v=J.Va(f,h),v.type+="_WORLD",J.Pk(f,n,h,0),v.M.splice(0,1),n=J.Zi(f,h,0),n!=
J.Gz&&(J.$d(f,n,h,0)[1]=0);d&&J.zg(a,e)}}function w(a,b,c,e,d,k){a=a.nodes;for(var f=null,p=0;p<a.length;p++){var h=a[p];d?"GROUP"==h.type&&h.node_tree_name==c&&(f=h):h.type==c&&(f=h)}return f?z(f,b)[0]:(k||qa.error('No "'+c+'" node in node '+e),-1)}function n(a,b,c,e){return{name:a,type:b,inputs:c,outputs:e}}function ea(a,b,c,e,d){var k=b.name,f=b.type,p=[],h=[],n=[],q=[],g=null,w=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":h=
aa(b);n=Z(b);qa.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":h=aa(b);n=Z(b);break;case "MIX_SHADER":h.push(P(b,"Fac"));var m=P(b,"Shader"),n=m.ab;h.push(m);(m=P(b,"Shader_001"))||(m=P(b,"Shader.001"));var t=m.ab;h.push(m);h.push(v("d_color1","d_color1",[0,0,0],n));h.push(v("d_roughness1","d_roughness1",0,n));h.push(v("s_color1","s_color1",[0,0,0],n));h.push(v("s_roughness1","s_roughness1",0,n));h.push(v("metalness1","metalness1",0,n));h.push(v("normal1","normal1",
[0,0,0],n));h.push(v("e_color1","e_color1",[0,0,0],n));h.push(v("emission1","emission1",0,n));h.push(v("d_color2","d_color2",[0,0,0],t));h.push(v("d_roughness2","d_roughness2",0,t));h.push(v("s_color2","s_color2",[0,0,0],t));h.push(v("s_roughness2","s_roughness2",0,t));h.push(v("metalness2","metalness2",0,t));h.push(v("normal2","normal2",[0,0,0],t));h.push(v("e_color2","e_color2",[0,0,0],t));h.push(v("emission2","emission2",0,t));n=W(b,"Shader");m=n.ab;n=[n,v("d_color","d_color",[0,0,0],m),v("d_roughness",
"d_roughness",0,m),v("s_color","s_color",[0,0,0],m),v("s_roughness","s_roughness",0,m),v("metalness","metalness",0,m),v("normal","normal",[0,0,0],m),v("e_color","e_color",[0,0,0],m),v("emission","emission",0,m)];break;case "OBJECT_INFO":var h=aa(b),n=[],m=W(b,"Location"),t=W(b,"Object Index"),R=W(b,"Material Index"),l=W(b,"Random");n.push(m);n.push(t);n.push(R);n.push(l);w.push(["USE_LOCATION_OUT",m.ab|0]);w.push(["USE_OBJ_IND_OUT",t.ab|0]);w.push(["USE_MAT_IND_OUT",R.ab|0]);w.push(["USE_RANDOM_OUT",
l.ab|0]);break;case "UVMAP":(m=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(g=M("param_"+f+"_a"),t=M("param_"+f+"_v"),p.push(ba(g)),p.push(ba(t)),q.push(ba(t)),g={name:g,value:m});n=Z(b);break;case "UV_MERGED":g=M("param_UV_MERGED_a");t=M("param_UV_MERGED_v");p.push(ba(g));p.push(ba(t));n.push(W(b,"UV_geom"));n.push(W(b,"UV_cycles"));q.push(ba(t));g={name:g,value:b.uv_layer};break;case "CAMERA":h=[];n=Z(b);break;case "COMBRGB":case "COMBHSV":h=aa(b);n=Z(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
f?(N(b,0,0)&&w.push(["READ_R",1]),N(b,1,0)&&w.push(["READ_G",1]),N(b,2,0)&&w.push(["READ_B",1]),N(b,3,0)&&w.push(["READ_A",1])):(N(b,0,-1)&&w.push(["READ_R",1]),N(b,1,-1)&&w.push(["READ_G",1]),N(b,2,-1)&&w.push(["READ_B",1]));h=aa(b);n=Z(b);g={value:b};break;case "PARTICLE_INFO":h=aa(b);n=Z(b);for(m=0;m<b.outputs.length;m++){t=b.outputs[m];R=t.identifier;l=ba("v_param_PART_INFO_"+R.replace(" ",""));if(t.is_linked)switch(R){case "Size":w.push(["PART_INFO_SIZE",ta.O(1)]);break;case "Age":w.push(["PART_INFO_AGE",
ta.O(1)]);break;case "Lifetime":w.push(["PART_INFO_LT",ta.O(1)]);break;case "Location":w.push(["PART_INFO_LOC",ta.O(1)]);break;case "Index":var x=ba("a_param_PART_INFO_"+t.identifier.replace(" ","")),g=x;w.push(["PART_INFO_IND",ta.O(1)]);break;case "Velocity":w.push(["PART_INFO_VEL",ta.O(1)]);break;case "Angular Velocity":w.push(["PART_INFO_A_VEL",ta.O(1)])}"Age"!=R&&"Lifetime"!=R&&"Size"!=R&&(p.push(l),q.push(l))}x&&p.push(x);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!X(b))return!0;f=H(b,c);if(!f)return qa.error("Geometry output is not supported"),
null;switch(f){case "GEOMETRY_UV":(m=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(g=M("param_GEOMETRY_UV_a"),t=M("param_GEOMETRY_UV_v"),p.push(ba(g)),p.push(ba(t)),q.push(ba(t)),g={name:g,value:m});n.push(W(b,"UV"));break;case "GEOMETRY_VC":(m=b.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(g=M("param_GEOMETRY_VC_a"),t=M("param_GEOMETRY_VC_v"),p.push(ba(g)),p.push(ba(t)),q.push(ba(t)),g={name:g,value:m});n.push(W(b,"Vertex Color"));break;case "GEOMETRY_NO":n.push(W(b,"Normal"));break;case "GEOMETRY_TRN":f=
"GEOMETRY_NO";n.push(W(b,"True Normal"));qa.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":n.push(W(b,"Front/Back"));break;case "GEOMETRY_VW":n.push(W(b,"View"));break;case "GEOMETRY_GL":n.push(W(b,"Global")||W(b,"Position"));break;case "GEOMETRY_LO":n.push(W(b,"Local"));break;case "GEOMETRY_OR":m=M("param_GEOMETRY_OR_v");p.push(ba(m));n.push(W(b,"Orco"));q.push(ba(m));break;case "GEOMETRY_IN":n.push(W(b,"Incoming"));break;case "GEOMETRY_BF":n.push(W(b,"Backfacing"))}break;
case "TEX_COORD":if(!X(b))return!0;f=fa(b,c);switch(f){case "TEX_COORD_UV":(m=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(g=M("param_TEX_COORD_UV_a"),t=M("param_TEX_COORD_UV_v"),p.push(ba(g)),p.push(ba(t)),q.push(ba(t)),g={name:g,value:b.uv_layer});n.push(W(b,"UV"));break;case "TEX_COORD_NO":n.push(W(b,"Normal"));break;case "TEX_COORD_GE":m=M("param_TEX_COORD_GE_v");p.push(ba(m));n.push(W(b,"Generated"));q.push(ba(m));break;case "TEX_COORD_OB":n.push(W(b,"Object"));break;case "TEX_COORD_CA":n.push(W(b,
"Camera"));break;case "TEX_COORD_WI":n.push(W(b,"Window"));break;case "TEX_COORD_RE":n.push(W(b,"Reflection"))}break;case "GROUP":m=b.node_tree_name;switch(m){case "B4W_LINEAR_TO_SRGB":if(!I(b,[1],[1])){g=F(b,e,d);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!I(b,[1],[1])){g=F(b,e,d);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!I(b,[1],[1])){g=F(b,e,d);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!I(b,[1,1],[1])){g=F(b,e,d);break}f=
"B4W_REFLECT";break;case "B4W_REFRACTION":if(!I(b,[1,0],[1])){g=F(b,e,d);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!I(b,[1,1,0,0,0],[1])){g=F(b,e,d);break}t=M("param_B4W_PARALLAX_texture");q.push(ba(t));f="B4W_PARALLAX";break;case "B4W_CLAMP":if(!I(b,[1],[1])){g=F(b,e,d);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!I(b,[0,0,0,0,0],[0])){g=F(b,e,d);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!I(b,[],[0])){g=F(b,e,d);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!I(b,
[0,0,0],[0])){g=F(b,e,d);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:g=F(b,e,d)}h=aa(b);n=Z(b);"B4W_TRANSLUCENCY"==m&&(m=v("TranslucencyParams","TranslucencyParams",[0,0,0,0]),m.ab=n[0].ab,n.push(m));break;case "LAMP":g=b.lamp;if(!g)return qa.error("There is no lamp in node: "+b.name),null;n.push(W(b,"Color"));n.push(W(b,"Light Vector"));n.push(W(b,"Distance"));n.push(W(b,"Visibility Factor"));g.uuid in Fa?w.push(["LAMP_INDEX",String(Fa[g.uuid])]):(Fa[g.uuid]=
Na,w.push(["LAMP_INDEX",String(Na++)]));g=Fa;break;case "LIGHTING_AMBIENT":h=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0)];n=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":n=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("dif_params","dif_params",[0,0],!0),v("sp_params","sp_params",[0,0],!0),v("shadow_factor","shadow_factor",0,!0),v("translucency_color",
"translucency_color",0,!0),v("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":h=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":h=[v("shadow_factor","shadow_factor",0,!0)];n=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("lcolorint","lcolorint",[0,0,0],!0),v("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":h=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac",
"norm_fac",0,!0)];n=[v("lfactor","lfactor",0,!0)];w.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":h=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("dif_params","dif_params",[0,0],!0)];n=[v("lfactor","lfactor",0,!0)];w.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":h=
[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("sp_params","sp_params",[0,0],!0)];n=[v("sfactor","sfactor",0,!0)];w.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":h=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("sp_params","sp_params",[0,0],!0)];n=[v("sfactor","sfactor",0,!0)];w.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":h=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("bsdf_params","bsdf_params",[0,0,0,0],!0)];n=[v("lfactor","lfactor",0,!0),v("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":h=[v("color","color",[0,0,0,0],!0),v("specular","specular",[0,0,0],!0),v("lfactor","lfactor",0,!0),v("sfactor","sfactor",0,!0),v("ldir","ldir",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("translucency_params",
"translucency_params",[0,0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("lcolorint","lcolorint",[0,0,0],!0),v("translucency_color","translucency_color",0,!0)];n=[v("color","color",[0,0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "NORMAL":h=aa(b);n=Z(b);m=W(b,"Normal");q.push(ba(M("param_NORMAL_Normal"),m.Ea,3));break;case "MAPPING":m=b.vector_type;f="MAPPING";h.push(P(b,"Vector"));n.push(W(b,"Vector"));var t=Ca.Jf(b.rotation),R=Ca.Jf(b.scale),l=Ca.Jf(b.translation),x=ma.create(),
z=Ca.LU(t);"TEXTURE"==m&&(R[0]=R[0]||1,R[1]=R[1]||1,R[2]=R[2]||1);var Y=new Float32Array([R[0],0,0,0,R[1],0,0,0,R[2]]);ma.multiply(z,Y,x);x=Ca.JX(x,pa.create());switch(m){case "POINT":x[12]=l[0];x[13]=l[1];x[14]=l[2];break;case "TEXTURE":x[12]=l[0];x[13]=l[1];x[14]=l[2];x=pa.invert(x,x);break;case "NORMAL":pa.invert(x,x),pa.transpose(x,x)}switch(m){case "NORMAL":w.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":w.push(["MAPPING_TRS_MATRIX_DEF",1]);w.push(["MAPPING_TRS_MATRIX",ta.O(x,16)]);break;case "POINT":0!==
Aa.length(t)?(w.push(["MAPPING_TRS_MATRIX_DEF",1]),w.push(["MAPPING_TRS_MATRIX",ta.O(x,16)])):(0!==Aa.length(R)&&(w.push(["MAPPING_SCALE_DEF",1]),w.push(["MAPPING_SCALE",ta.O(R,3)])),0!==Aa.length(l)&&(w.push(["MAPPING_TRANS_DEF",1]),w.push(["MAPPING_TRANS",ta.O(l,3)])));break;case "VECTOR":0!==Aa.length(t)?(w.push(["MAPPING_TRS_MATRIX_DEF",1]),w.push(["MAPPING_TRS_MATRIX",ta.O(x,16)])):0!==Aa.length(R)&&(w.push(["MAPPING_SCALE_DEF",1]),w.push(["MAPPING_SCALE",ta.O(R,3)]))}b.use_min&&(w.push(["MAPPING_MIN_CLIP_DEF",
1]),w.push(["MAPPING_MIN_CLIP",ta.O(b.min,3)]));b.use_max&&(w.push(["MAPPING_MAX_CLIP_DEF",1]),w.push(["MAPPING_MAX_CLIP",ta.O(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":g=[];m=[];t=[];R=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("dif_params","dif_params",[0,0],!0),v("sp_params","sp_params",[0,0],!0),v("shadow_factor","shadow_factor",0,!0)];l=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0),
v("normal","normal",[0,0,0],!0)];x=[W(b,"Color"),W(b,"Alpha"),W(b,"Normal")];z=[];Y=P(b,"Color");Y.Ea.splice(3);t.push(Y);h.push(Y);Y=P(b,"Spec");Y.Ea.splice(3);t.push(Y);h.push(Y);(Y=P(b,"DiffuseIntensity"))||(Y=P(b,"Refl"));Y.Ea=b.diffuse_intensity;t.push(Y);h.push(Y);var ca=P(b,"Normal");ca.Ea.splice(3);t.push(ca);h.push(ca);"MATERIAL_EXT"==f?((Y=P(b,"Emit"))||(Y=v("Emit","Emit",0)),t.push(Y),h.push(Y),(Y=P(b,"Translucency"))?(Y.Ea=0,Y.name="Translucency",Y.identifier="Translucency"):Y=v("Translucency",
"Translucency",0),h.push(Y),(Y=P(b,"Translucency"))?(Y.Ea=[0,0,0,0],Y.name="TranslucencyParams",Y.identifier="TranslucencyParams"):Y=v("TranslucencyParams","TranslucencyParams",[0,0,0,0]),h.push(Y),n=P(b,"Reflectivity"),Y=P(b,"Ray Mirror"),n?(Y=n,n="Reflectivity"):Y?n="Ray Mirror":(Y=n,n="Reflectivity"),Y||(Y=v(n,n,0)),h.push(Y),l.push(Y),(Y=P(b,"SpecTra"))||(Y=v("SpecTra","SpecTra",0)),h.push(Y),l.push(Y),(Y=P(b,"Alpha"))||(Y=v("Alpha","Alpha",b.alpha)),h.push(Y),l.push(Y),x.push(W(b,"Diffuse")),
x.push(W(b,"Spec")),g.push(["MATERIAL_EXT",1]),m.push(["MATERIAL_EXT",1])):(t.push(v("emit_intensity","emit_intensity",0)),l.push(v("reflect_factor","reflect_factor",0)),l.push(v("specular_alpha","specular_alpha",0)),l.push(v("alpha_in","alpha_in",0)),x.push(v("diffuse_out","diffuse_out",0)),x.push(v("spec_out","spec_out",0)),g.push(["MATERIAL_EXT",0]),m.push(["MATERIAL_EXT",0]));z.push(ba(M("param_MATERIAL_alpha"),b.alpha));z.push(ba(M("param_MATERIAL_spec_alpha"),b.specular_alpha));n=x;g.push(["USE_MATERIAL_NORMAL",
ca.ab|0]);b.use_diffuse&&(g.push(["USE_MATERIAL_DIFFUSE",1]),m.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&m.push(["USE_MATERIAL_SPECULAR",1]);var Y=[],r=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":ca=b.specular_hardness;break;case "WARDISO":ca=b.specular_slope;break;case "TOON":ca=b.specular_toon_size;r=b.specular_toon_smooth;break;case "BLINN":ca=b.specular_ior;r=b.specular_hardness;break;default:qa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),ca=b.specular_hardness}var u,ra;switch(b.diffuse_shader){case "LAMBERT":ra=u=0;break;case "OREN_NAYAR":u=b.roughness;ra=0;break;case "FRESNEL":u=b.diffuse_fresnel;ra=b.diffuse_fresnel_factor;break;case "MINNAERT":u=b.darkness;ra=0;break;case "TOON":u=b.diffuse_toon_size;ra=b.diffuse_toon_smooth;break;default:qa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),ra=u=0}Y.push(ba(M("param_MATERIAL_diffuse"),[u,ra],2));Y.push(ba(M("param_MATERIAL_spec"),
[b.specular_intensity,ca,r],3));g.push(["SHADELESS_MAT",b.use_shadeless?1:0]);ca={name:b.name,value:{it:b.specular_shader,qr:b.diffuse_shader,Pe:b.use_shadeless,tn:b.use_tangent_shading}};g={name:b.name,value:{it:b.specular_shader,qr:b.diffuse_shader,Pe:b.use_shadeless,tn:b.use_tangent_shading},KX:{name:"material_begin",type:"MATERIAL_BEGIN",M:t,fb:R,qb:Y,data:ca,Sb:g,yi:[]},LX:{name:"material_end",type:"MATERIAL_END",M:l,fb:x,qb:z,data:ca,Sb:m,yi:[]}};break;case "BSDF_DIFFUSE":h=aa(b);w.push(["USE_NORMAL_IN",
h[2].ab|0]);n=W(b,"BSDF");m=n.ab;n=[n,v("d_color","d_color",[0,0,0],m),v("d_roughness","d_roughness",0,m),v("s_color","s_color",[0,0,0],m),v("s_roughness","s_roughness",0,m),v("metalness","metalness",0,m),v("normal","normal",[0,0,0],m),v("e_color","e_color",[0,0,0],m),v("emisson","emisson",0,m)];break;case "BSDF_GLOSSY":h=aa(b);w.push(["USE_NORMAL_IN",h[2].ab|0]);n=W(b,"BSDF");m=n.ab;n=[n,v("d_color","d_color",[0,0,0],m),v("d_roughness","d_roughness",0,m),v("s_color","s_color",[0,0,0],m),v("s_roughness",
"s_roughness",0,m),v("metalness","metalness",1,m),v("normal","normal",[0,0,0],m),v("e_color","e_color",[0,0,0],m),v("emisson","emisson",0,m)];break;case "EMISSION":h=aa(b);n=W(b,"Emission");m=n.ab;n=[n,v("d_color","d_color",[0,0,0],m),v("d_roughness","d_roughness",0,m),v("s_color","s_color",[0,0,0],m),v("s_roughness","s_roughness",0,m),v("metalness","metalness",1,m),v("normal","normal",[0,0,0],m),v("e_color","e_color",[0,0,0],m),v("emisson","emisson",1,m)];break;case "MATH":switch(b.operation){case "ADD":f=
"MATH_ADD";break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";break;case "ARCCOSINE":f="MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";
break;case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return qa.error("Unsupported MATH operation: "+b.operation),null}w.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);h=aa(b);n=Z(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f=
"MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;case "DODGE":f="MIX_RGB_DODGE";break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return qa.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}w.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);h=aa(b);n=Z(b);break;case "OUTPUT":h=aa(b);n=[];break;case "OUTPUT_MATERIAL":aa(b);h=P(b,"Surface");n=h.ab;g=[h,v("d_color","d_color",[0,0,0],n),v("d_roughness","d_roughness",0,n),v("s_color","s_color",[0,0,0],n),v("s_roughness","s_roughness",0,n),v("metalness","metalness",0,n),v("normal","normal",
[0,0,0],n),v("e_color","e_color",[0,0,0],n),v("emission","emission",0,n)];m=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("bsdf_params","bsdf_params",[0,0,0,0],!0),v("shadow_factor","shadow_factor",0,!0),v("s_color","s_color",[0,0,0],!0),v("metalness","metalness",0,!0),v("e_color","e_color",[0,0,0],!0),v("emission","emission",0,!0)];t=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0),v("normal","normal",
[0,0,0],!0),v("s_color","s_color",[0,0,0],!0),v("metalness","metalness",0,!0),v("e_color","e_color",[0,0,0],!0),v("emission","emission",0,!0)];R=[];h=g;n=R;g={name:b.name,value:{YR:"BSDF_COMPUTE"},WR:{name:"bsdf_begin",type:"BSDF_BEGIN",M:g,fb:m,qb:[],data:null,Sb:[],yi:[]},XR:{name:"bsdf_end",type:"BSDF_END",M:t,fb:R,qb:[],data:null,Sb:[],yi:[]}};break;case "RGB":m=b.name;m={name:"-1",value:m};q.push(m);n.push(W(b,"Color"));break;case "SEPRGB":case "SEPHSV":h=aa(b);n=Z(b);break;case "TEX_ENVIRONMENT":(m=
b.image)?(f="TEXTURE_ENVIRONMENT","NONE"==b.color_space?w.push(["NON_COLOR",1]):w.push(["NON_COLOR",0]),h.push(P(b,"Vector")),n.push(W(b,"Color")),t=M("param_TEXTURE_texture"),q.push(ba(t)),g=la.OH(128),g.source="ENVIRONMENT_MAP",la.tG(g,m),g={name:t,value:g}):f="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(m=b.image){f="TEXTURE_COLOR";"NONE"==b.color_space?w.push(["NON_COLOR",1]):w.push(["NON_COLOR",0]);w.push(["CONVERT_UV",0]);for(t=0;4>t;++t)t?(Y=v("Vector"+t,"Vector"+t,[0,0,0],!1),R=v("Color"+t,"Color"+
t,[0,0,0],!1),l=v("Alpha"+t,"Alpha"+t,0,!1)):(Y=P(b,"Vector"),R=W(b,"Color"),l=W(b,"Alpha")),h.push(Y),n.push(R),n.push(l);t=M("param_TEXTURE_texture");q.push(ba(t));g=la.Zl(la.Ih,!1);g.repeat="REPEAT"==b.extension;g.source="IMAGE";la.tG(g,m);g={lA:b.name,name:t,value:g}}else f="TEXTURE_EMPTY";break;case "TEXTURE":f=V(b);if("TEXTURE_EMPTY"==f)n.push(W(b,"Color")),n.push(W(b,"Normal")),n.push(W(b,"Value"));else if("TEXTURE_ENVIRONMENT"==f)h.push(P(b,"Vector")),n.push(W(b,"Color")),n.push(W(b,"Value"));
else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==b.texture.type)return qa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==f&&(m=!1,(t=b.texture.image)&&"Non-Color"==t.colorspace_settings_name&&(m=!0),w.push(["NON_COLOR",Number(m)]),w.push(["CONVERT_UV",1]));for(t=0;4>t;++t)m="TEXTURE_COLOR"==f?"Color":"Normal",t?(Y=v("Vector"+t,"Vector"+t,[0,0,0],!1),R=v(m+t,m+t,[0,0,0],!1),l=v("Value"+t,"Value"+t,0,!1)):(Y=P(b,"Vector"),R=W(b,m),l=W(b,"Value")),h.push(Y),n.push(R),
n.push(l)}"TEXTURE_EMPTY"!=f&&(t=M("param_TEXTURE_texture"),q.push(ba(t)),g=b.texture.s,g={lA:b.texture.name,name:t,value:g});break;case "VALTORGB":h=aa(b);n=Z(b);g={value:b};m=b.color_ramp.interpolation;"CONSTANT"!=m&&"LINEAR"!=m&&qa.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";m=b.name;m={name:"-1",value:m};q.push(m);n.push(W(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";break;case "AVERAGE":f=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return qa.error("Unsupported VECT_MATH operation: "+b.operation),null}h=aa(b);n=Z(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":w.push(["VECTOR_TYPE",ta.O(0)]);break;case "VECTOR":w.push(["VECTOR_TYPE",ta.O(1)]);break;case "NORMAL":w.push(["VECTOR_TYPE",ta.O(2)]);break;default:return qa.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}h=b.convert_from;n=b.convert_to;m=0;if("WORLD"==h)if("WORLD"==n)m=0;else if("OBJECT"==n)m=1;else if("CAMERA"==n)m=2;else return qa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==h)if("WORLD"==n)m=3;else if("OBJECT"==n)m=4;else if("CAMERA"==n)m=5;else return qa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==h)if("WORLD"==n)m=6;else if("OBJECT"==n)m=7;else if("CAMERA"==n)m=8;else return qa.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return qa.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;w.push(["CONVERT_TYPE",ta.O(m)]);h=aa(b);n=Z(b);break;case "NORMAL_MAP":m=0;switch(b.space){case "TANGENT":m=0;break;case "OBJECT":m=1;break;case "WORLD":m=2;break;case "BLENDER_OBJECT":m=3;break;case "BLENDER_WORLD":m=4;break;default:return qa.error("Unsupported NORMAL_MAP space: "+b.space),null}w.push(["SPACE",ta.O(m)]);h.push(P(b,"Strength"));h.push(P(b,"Color"));n.push(W(b,"Normal"));break;
case "FRESNEL":ca=P(b,"Normal");h.push(P(b,"IOR"));h.push(ca);n.push(W(b,"Fac"));w.push(["USE_FRESNEL_NORMAL",ca.ab|0]);break;case "LAYER_WEIGHT":ca=P(b,"Normal");h.push(P(b,"Blend"));h.push(ca);n=Z(b);w.push(["USE_NORMAL_IN",ca.ab|0]);break;case "BUMP":ca=P(b,"Normal"),w.push(["INVERT",b.invert?1:0]),w.push(["USE_NORMAL_IN",ca.ab|0]),aa(b),Z(b);default:h=aa(b),n=Z(b)}f={name:k,type:f,yi:p,M:h,fb:n,qb:q,data:g,Sb:w};k=J.om(a);J.Qj(a,J.om(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{f=b.outputs;for(q=p=0;q<f.length;q++)if(f[q].is_linked&&p++>c){f=!0;break a}f=!1}f=!f}return f||null!=ea(a,b,++c,e,d)?k:null}function I(a,b,c){for(var e=a.inputs,d=a.outputs,k=a.node_tree_name,f=0;f<b.length;f++){var n=e[f],h=b[f];if(!n||n.default_value instanceof Array!=h)return qa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',k,'".Processing as general node group.'),!1}for(f=0;f<c.length;f++)if(b=d[f],e=c[f],!b||b.default_value instanceof Array!=e)return qa.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',k,'".Processing as general node group.'),!1;return!0}function F(a,b,c){var e=a.node_group.node_tree,d={},k;for(k in e)if("links"==k||"nodes"==k){d[k]=[];for(var f=0;f<e[k].length;f++){d[k][f]={};for(var h in e[k][f])if("links"==k){d[k][f][h]={};for(var p in e[k][f][h])d[k][f][h][p]=T(e[k][f][h][p])}else d[k][f][h]=T(e[k][f][h])}}else d[k]=T(e[k]);e=a.node_tree_name;if("B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e)k=n("Group input","GROUP_INPUT",[],a.inputs),f=n("Group output",
"GROUP_OUTPUT",a.outputs,[]),h=null,h="B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e&&(S.quality==ia.gq||S.CI)?{from_node:k,from_socket:k.outputs[1],to_node:f,to_socket:f.inputs[0]}:{from_node:k,from_socket:k.outputs[0],to_node:f,to_socket:f.inputs[0]},d.nodes=[k,f],d.links=[h];e=a.name;k=d.nodes;f=d.links;for(h=0;h<k.length;h++)k[h].name=na(k[h].type,e,k[h].name);for(h=0;h<f.length;h++)f[h].from_node.name=na(f[h].from_node.type,e,f[h].from_node.name),f[h].to_node.name=na(f[h].to_node.type,e,f[h].to_node.name);
return{bY:l(d,a.node_group.uuid,!0,b,c).Wa,cY:d.links}}function T(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ca.Vq(a):a}function M(a){Da[a]||(Da[a]=0);var b=a+"_"+Da[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Da[a]++;return b}function X(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function H(a,b){for(var c=a.outputs,e=0,d=0;d<c.length;d++){var k=c[d];if(k.is_linked&&!(e++<b))switch(k.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function fa(a,b){for(var c=a.outputs,e=0,d=0;d<c.length;d++){var k=c[d];if(k.is_linked&&!(e++<b))switch(k.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function V(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,e=!1,d=!1,k=0;k<b.length;k++){var f=b[k];if(f.is_linked)switch(f.identifier){case "Color":c=!0;break;case "Normal":e=!0;break;case "Value":d=!0;break;default:Ca.q("Unknown texture output")}}if(c)return e&&
qa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(e)return"TEXTURE_NORMAL";if(d)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function P(a,b){for(var c=a.inputs,e=0;e<c.length;e++){var d=c[e];if(d.identifier==b)return ha(d)}return null}function W(a,b){for(var c=a.outputs,e=0;e<c.length;e++){var d=c[e];if(d.identifier==b)return ha(d)}return null}function ha(a){var b=
a.name,c=a.identifier,e=a.is_linked;a=a.default_value;a=Ca.xk(a)?a.slice(0):a;return{name:b,identifier:c,ab:e,Ea:a}}function v(a,b,c,e){return{name:a,identifier:b,ab:e,Ea:c}}function aa(a){for(var b=[],c=0;c<a.inputs.length;c++){var e=ha(a.inputs[c]);e.Ea.length&&e.Ea.splice(3);b.push(e)}return b}function Z(a){for(var b=[],c=0;c<a.outputs.length;c++){var e=ha(a.outputs[c]);b.push(e)}return b}function ba(a,b,c){b=null===b||void 0===b?null:ta.O(b,c);return{name:a,value:b}}function ya(a,b,c,e,d,k){var f=
[],h=k.from_socket.identifier;k=k.to_socket.identifier;var n=e.fb;for(e=0;e<n.length;e++)if(n[e].identifier==h){f.push(e);break}d=d.M;for(e=0;e<d.length;e++)if(d[e].identifier==k){f.push(e);break}2==f.length&&J.fd(a,b,c,f);return!0}function na(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function R(a){var b=[];J.pa(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function ca(a,b,c){for(var e=0;e<c.length;e++){var d=c[e].data.bY,k=c[e].data.cY;if(!d)return!1;
J.pa(d,function(b,c){J.Qj(a,J.om(a),c)});for(d=0;d<k.length;d++)b.push(k[d]);ua(c[e],b,a)}return!0}function ra(a,b,c,e,d,k){switch(a.type){case "GROUP":a.name==b&&e.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||d.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||k.push(c)}}function xa(a,b,c){for(var e=[],d=0;d<c.length;d++){for(var k=c[d],f=null,h=0;h<b.length;h++)if(k.from_socket.identifier==b[h].to_socket.identifier){f=b[h];break}f?(k.from_node=f.from_node,k.from_socket=f.from_socket):
e.push(k)}for(d=0;d<b.length;d++)a.splice(a.indexOf(b[d]),1);return e}function oa(a,b){if(b.length)for(var c=b[0].from_node.name,e=0;e<a.length;e++)a[e].from_node.name==c&&b.push(a[e])}function Y(a,b,c,e){for(var d=0;d<e.length;d++){for(var k=e[d],f,h=0;h<c.M.length;h++)if(k.from_socket.identifier==c.M[h].identifier){f=c.M[h].Ea;break}for(var h=k,n=b,p=f,v=z(h.to_node,n),q=0;q<v.length;q++)for(var g=J.Va(n,v[q]),m=0;m<g.M.length;m++){var w=g.M[m];if(w.identifier==h.to_socket.identifier){g=w.Ea instanceof
Object?0:1;if((p instanceof Object?0:1)==g)w.Ea=p;else switch(g){case 0:w=w.Ea;w[0]=w[1]=w[2]=p;break;case 1:w.Ea=(p[0]+p[1]+p[2])/3}break}}k=a.indexOf(k);-1!=k&&a.splice(k,1)}}function ua(a,b,c){for(var e=a.name,d=[],k=[],f=[],h=[],n=0;n<b.length;n++){var p=b[n];ra(p.from_node,e,p,d,f,h);ra(p.to_node,e,p,k,f,h)}k=xa(b,k,f);d=xa(b,h,d);oa(b,k);Y(b,c,a,k);if(d.length){var v;J.pa(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(e+"*GO*")||(v=b)});Y(b,c,v,d)}}function sa(a){var b=[],c=[];J.pa(a,
function(a,e){switch(e.type){case "VALTORGB":b.push(e);break;case "CURVE_VEC":case "CURVE_RGB":c.push(e)}});var e=0,d=a=null,k=b.length+c.length;if(b.length){a=la.PU(b,la.CO);for(var f=0;f<b.length;f++)b[f].Sb.push(["NODE_TEX_ROW",ta.O((e+.5)/k)]),e++}if(c.length)for(d=la.TU(c,la.hF),f=0;f<c.length;f++)c[f].Sb.push(["NODE_TEX_ROW",ta.O((e+.5)/k)]),e++;f=null;a&&d?(f=new Uint8Array(a.length+d.length),f.set(a),f.set(d,a.length)):f=a?a:d;a=f?la.NH(f,la.hF):null;for(f=0;f<b.length;f++)b[f].data.jb=a;
for(f=0;f<c.length;f++)c[f].data.jb=a}function N(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ia=g("__config");g("__debug");var J=g("__graph"),ma=g("__mat3"),pa=g("__mat4"),ja=g("__objects"),qa=g("__print"),ta=g("__shaders"),Ia=g("__scenes"),Ca=g("__util"),Aa=g("__vec3"),la=g("__textures"),Da={},za={},Sa={},Fa={},Na=0;new Float32Array(4);var S=ia.B;a.c3=0;a.MQ=1;a.LQ=2;a.KQ=3;a.b3=4;a.JQ=5;a.IQ=6;a.HQ=7;a.a3=8;a.vP=0;
a.uP=1;a.P2=2;a.tP=3;a.O2=4;a.tJ=function(a){return za[a]};a.QS=function(a){delete za[a]};a.YS=l;a.QA=function(a,c,e){var d=Ia.A();a=h(a,"MAIN",d.uuid);if(a in Sa)return Sa[a];var d=J.create(),k={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},f=ea(d,k,0,c,null),k={name:"LIGHTING_END",type:"LIGHTING_END"},k=ea(d,k,0,c,null);b(d,e,f,k,[[f,[8,10]],[f,[9,6]]],c);q(d);return Sa[a]=d};a.Su=function(a){var b=[],c={};Da={};var e=J.xE(a);J.pa(e,function(a,e){var d;d=[];for(var k=[],f=[],h=[],n=[],p=[],v=0;v<
e.M.length;v++){var q=e.M[v];if(q.ab)d.push(null),k.push(null);else{d.push(M("in_"+e.type+"_"+q.identifier.replace(/\./g,"")));var J=ta.O(q.Ea,0);S.XD&&(0<=e.type.indexOf("MIX_RGB_")&&("Color1"==q.identifier||"Color2"==q.identifier||"Fac"==q.identifier)||0<=e.type.indexOf("MATH_")&&("Value"==q.identifier||"Value_001"==q.identifier||"Value.001"==q.identifier)||0<=e.type.indexOf("VECT_MATH_")&&("Vector_001"==q.identifier||"Vector.001"==q.identifier)||0<=e.type.indexOf("LIGHTING_APPLY")||0<=e.type.indexOf("MATERIAL_END")||
0<=e.type.indexOf("MATERIAL_BEGIN"))&&(q=J,q=q.replace(/(,)/g,"$1 "),q=q.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),q=q.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),J=q=q.replace(/\s+/g,""));k.push(J)}}for(v=0;v<e.fb.length;v++)q=e.fb[v],q.ab?f.push(null):f.push(M("out_"+e.type+"_"+q.identifier.replace(/\./g,"")));for(v=0;v<e.qb.length;v++)q=e.qb[v],h.push(q.name),n.push(q.value);for(v=0;v<e.yi.length;v++)p.push(e.yi[v].name);d={id:e.type,M:d,hC:k,fb:f,qb:h,Zw:n,yi:p,Sb:JSON.parse(JSON.stringify(e.Sb))};
b.push(d);c[a]=d});J.Dg(e,function(a,b,d){var k=J.Va(e,a);J.Va(e,b);var f=k.fb[d[0]];a=c[a].fb;b=c[b].M;k=a[d[0]]||M("out_"+k.type+"_"+f.identifier.replace(/\./g,""));a[d[0]]=k;b[d[1]]=k});return b};a.sH=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.ua=function(){for(var a in za)delete za[a];for(a in Sa)delete Sa[a];for(var b in Fa)delete Fa[b];Na=0}};b4w.module.__debug=function(a,g){function l(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(){var a=q.KB();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=x;return b&&b.debug_view_mode==a.Rp}function y(a,b,c){var e=q.KB(),d=0;if(e)for(c&&e.endQuery(),c=0;c<a.length;c++){var k=a[c],f=e.SI(k),h=E.getParameter(e.RI());f&&!h&&(d=e.TI(k)/1E6,b&&(d=B.Zb(d,b,1,10)),a.splice(c,1),c--)}else d=performance.now()-
a.pop(),b&&(d=B.Zb(d,b,1,10));return d}function r(a,b){A(a)||B.q("Structure assertion failed: invalid first object value");A(b)||B.q("Structure assertion failed: invalid second object value");h(a,b)||B.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||B.lC(a)||a instanceof Array)){for(var c in a)A(a[c])||B.q("Structure assertion failed: invalid value for key in the first object: "+c),c in b||B.q("Structure assertion failed: missing key in the first object: "+
c);for(c in b)A(b[c])||B.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||B.q("Structure assertion failed: missing key in the second object: "+c),h(a[c],b[c])||B.q("Structure assertion failed: incompatible types for key "+c)}}function A(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function h(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var c=a instanceof Array,e=b instanceof Array;if(c&&!e||!c&&e)return!1;
c=B.lC(a);e=B.lC(b);if(c&&!e||!c&&e)return!1}return!0}var u=g("__compat"),m=g("__config"),q=g("__extensions"),f=g("__graph"),t=g("__objects"),c=g("__print"),z=g("__scenes"),L=g("__subscene"),D=g("__textures"),G=g("__time"),B=g("__util"),O=m.B,K={},E=null,C={},Q=[],k=-1,p=-1,x=null,e=null,w=!1,n={};a.Ot=0;a.Xy=1;a.Pt=2;a.Wy=3;a.Nt=4;a.Vy=5;a.Uy=6;a.Rp=7;a.Uf=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;
for(c in b){var e=b[c];e in a&&(K[a[e]]=e)}E=a};a.oZ=function(a){x=a};a.U5=function(){return x};a.ZU=function(a,b,c,e,d){n[a]||(n[a]={VZ:b,Xe:{}});c in n[a].Xe||(n[a].Xe[c]=e);d&&(n[a].Xe[c]=0)};a.dH=function(){var a=0,b;for(b in n)for(var c in n[b].Xe)a+=n[b].Xe[c];return a};a.PM=function(){var a={},b;for(b in n)for(var e in n[b].Xe){var d=n[b].Xe[e];if(d){var k=n[b].VZ;k in a||(a[k]={yE:0,Xe:{}});e in a[k].Xe||(a[k].Xe[e]=0);a[k].Xe[e]+=d;a[k].yE+=d}}for(k in a){c.groupCollapsed(k,a[k].yE);for(e in a[k].Xe)c.ee(e,
a[k].Xe[e]);c.groupEnd()}};a.yL=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),e=0,d=0,k=t.Ub(z.Zh(),"MESH",t.oc),f=0;f<k.length;f++)for(var h=0;h<k[f].I.length;h++)for(var n=0;n<k[f].I[h].X.length;n++){var p=B.Qh(k[f].I[h].X[n]),q=p.hb.Eg+"/"+p.hb.df;p["shaders_info.directives"]=p.hb.Ui;p["shaders_info.node_elements"]=p.hb.ug;delete p.hb;for(var g=0;g<b.length;g++)delete p[b[g]];
if(k[f].Ra)d++;else{e++;p.type in a||(a[p.type]={});q in a[p.type]||(a[p.type][q]={});for(var v in p)v in a[p.type][q]||(a[p.type][q][v]=[]),g=JSON.stringify(p[v]),-1==a[p.type][q][v].indexOf(g)&&a[p.type][q][v].push(g)}}c.group("Batches statistics:");c.ee("STATIC/DYNAMIC count:",e+"/"+d);c.group("STATIC batches diversity:");for(var m in a)for(q in a[m]){b=[];for(v in a[m][q])1<a[m][q][v].length&&b.push([v,a[m][q][v]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){c.groupCollapsed(m+" "+q);for(f=0;f<b.length;f++)c.ee(b[f][1].length,b[f][0],b[f][1]);c.groupEnd()}}c.groupEnd();c.groupEnd()};a.wA=function(a){if(O.gl_debug){var b=E.getError();b!=E.NO_ERROR&&(b in K?B.q("GL Error: "+b+", gl."+K[b]+" ("+a+")"):B.q("Unknown GL error: "+b+" ("+a+")"))}};a.wS=function(){if(O.gl_debug||O.rH)switch(E.checkFramebufferStatus(E.FRAMEBUFFER)){case E.FRAMEBUFFER_COMPLETE:break;case E.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case E.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case E.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case E.FRAMEBUFFER_UNSUPPORTED:c.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case E.G1:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:c.error("FRAMEBUFFER CHECK FAILED")}};a.BS=function(){if(-1!=
k)return k;E.bindFramebuffer(E.FRAMEBUFFER,E.createFramebuffer());var a=D.Zl(D.Bl,!1);D.resize(a,1,1);E.framebufferTexture2D(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,a.mb,a.rb,0);E.checkFramebufferStatus(E.FRAMEBUFFER)!=E.FRAMEBUFFER_COMPLETE?(k=!0,c.warn("depth-only issue was found")):k=!1;E.bindFramebuffer(E.FRAMEBUFFER,null);return k};a.GS=function(){if(1==O.Fc)return!1;if(-1!=p)return p;E.bindRenderbuffer(E.RENDERBUFFER,E.createRenderbuffer());E.renderbufferStorageMultisample(E.RENDERBUFFER,O.Fc,E.RGBA8,
1,1);var a=E.getRenderbufferParameter(E.RENDERBUFFER,E.RENDERBUFFER_SAMPLES);a!=O.Fc?(p=!0,c.warn("multisample issue was found: requested "+O.Fc+", got "+a),E.getError()==E.INVALID_OPERATION&&c.warn("the error from multisample issue detected, ignoring")):p=!1;E.bindRenderbuffer(E.RENDERBUFFER,null);return p};a.DS=function(){return u.xA("Firefox")&&E.getError()==E.OUT_OF_MEMORY?(c.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.OL=function(a,b,e){O.gl_debug&&(e=l(e),c.error("shader compilation failed:\n"+
e+"\n"+E.getShaderInfoLog(a)+" ("+b+")"))};a.SY=function(a,b,e,d){O.gl_debug&&(e=l(e),d=l(d),c.error("shader linking failed:\n"+e+"\n\n\n"+d+"\n"+E.getProgramInfoLog(a)+" ("+b+")"))};a.xD=function(a){if(O.show_hud_debug_info||a.type==L.eq)a.oB||a.am.push(d())};a.NY=function(a){"MAIN"==a.type&&b()&&a.am.push(d())};a.yD=function(a){if((O.show_hud_debug_info||a.type==L.eq)&&!a.oB){var b=y(a.am,a.Hf,!0);b&&(a.Hf=b)}};a.OY=function(a){if("MAIN"==a.type&&b()){var c=y(a.am,a.Hf,!0);c&&(a.Hf=c)}};a.rK=b;
a.BY=function(a){var b=y(a.am,a.Hf,!1);b&&(a.Hf=b)};a.g5=function(a){C[a]=a in C?C[a]+1:1};a.update=function(){for(var a in C)c.log(a,C[a]),C[a]=0};a.tv=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(B.xk(c))for(var e=0;e<c.length;e++)a.push(c[e]);else a.push(arguments[b])}Q.push(a)};a.UK=function(){for(var a=1,b=0;b<Q.length;b++){var c=Q[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],B.xk(a))for(var e=0;e<a.length;e++)c.push(a[e]);
else c.push(arguments[b]);Q.push(c)};var ea=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.zL=function(a){a||(a=1);for(var b=0,e={},d=Math.max(0,performance.now()-1E3*a),k=0;k<Q.length;k++){var f=Q[k];a=f[0];if(!(a<d)){var h=String(f[1]);e[h]||(e[h]=ea[b++%ea.length]);a=["%c"+(a/1E3).toFixed(6),e[h],h];for(h=2;h<f.length;h++)a.push(f[h]);c.log.apply(this,a)}}Q.splice(0)};a.iD=function(a){a||(a=1);for(var b={},e=Math.max(0,performance.now()-1E3*a),d=0;d<Q.length;d++){var k=
Q[d];a=k[0];if(!(a<e))for(var f=2;f<k.length;f++){var h=String(k[1]);3<k.length&&(h+="_"+String(f-2));b[h]||(b[h]=h+"\n");b[h]+=String(a)+" "+k[f]+"\n"}}a="";for(h in b)a+=b[h]+"\n\n";c.log(a);Q.splice(0)};a.S3=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.qH=function(a){if(B.xk(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.y3=function(a,b){a.constructor!=b&&B.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.A3=r;a.B3=function(a){w?r(a,e):w=!0;e=null!=a&&"object"==typeof a?B.Vq(a):a};a.zI=function(a,
b,c,e,d){(a=a||null)||B.q("Stage load callback is undefined");b=b||5E3;c=c||0;e=e||100;100<e&&B.q("Max percentage must be less than 100");0>c&&B.q("Min percentage must be greater than 0");c>e&&B.q("Max percentage must be greater than min percentage");var k=G.Pj(c,e,b,function(b){b=b.toFixed();a(b);100==b&&(G.Rn(k),d&&d())})};a.u8=function(a){return f.lU(a,function(a,b){var c=b.type+"("+b.name+")",e=b.M,c=c+"\n\nINPUTS:";if(e.length)for(var d=0;d<e.length;d++)c+="\n"+e[d].identifier+": ",c=e[d].ab?
c+"linked":c+e[d].Ea;else c+="\n---";e=b.fb;c+="\n\nOUTPUTS:";if(e.length)for(d=0;d<e.length;d++)c+="\n"+e[d].identifier+": ",c=e[d].ab?c+("linked(default "+e[d].Ea+")"):c+"not used";else c+="\n---";d="";switch(b.type){case "GEOMETRY_UV":d="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":d="\ntexture: "+b.data.value.name+"\n("+b.data.value.qo+")"}""==d&&(d="\n---");return c=c+"\n\nDATA:"+d},function(b,c,e){b=f.Va(a,b);c=f.Va(a,c);return b.fb[e[0]].identifier+"\n==>\n"+
c.M[e[1]].identifier})};a.Gv=function(){return E};a.ua=function(){x=null;n={}};a.reset=function(){E=null}};b4w.module.__compat=function(a,g){function l(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var y=g("__config"),r=g("__debug"),A=g("__extensions"),
h=g("__print"),u=g("__renderer"),m="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.DF=256;var q=y.Gl,f=y.B,t=y.or,c=y.context,z=y.Oi,L=y.Y,D=y.C,G=y.Td;a.rU=function(a){a.getError()==a.INVALID_ENUM&&h.warn("Possible Tegra invalid enum issue detected, ignoring")};a.rM=function(g,O){function K(a){O&&h.warn(a)}z.MX=g.getParameter(g.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
z.Dw=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS);z.GC=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);z.Ew=g.getParameter(g.MAX_VARYING_VECTORS);z.HC=g.getParameter(g.MAX_VERTEX_ATTRIBS);z.SK=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS);z.us=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS);z.fj=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE);z.DC=g.getParameter(g.MAX_RENDERBUFFER_SIZE);z.Ec=g.getParameter(g.MAX_TEXTURE_SIZE);z.IC=g.getParameter(g.MAX_VIEWPORT_DIMS);f.fc&&!t.enabled&&(f.br=!0);f.fc?(f.Fc=
Math.min(f.Fc,g.getParameter(g.MAX_SAMPLES)),l("Firefox")&&(K("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),f.rH=!0),l("Windows")&&l("Chrome")&&(K("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),f.Fc=1)):f.Fc=1;l("Firefox")&&"NONE"!==f.stereo&&(K("Firefox and Stereo rendering detected, disable texture reusage"),f.AI=!0);if(f.fc&&r.GS()||l("Firefox"))K("Firefox detected, disabling multisample"),f.Fc=1;u.rZ();var E=Boolean(A.KV());
l("Firefox/28.0")&&(l("Linux")||l("Macintosh"))&&(K("Firefox 28 detected, applying depth hack"),E=!1);l("Windows Phone")||(l("iPad")||l("iPhone")?(K("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),c.alpha||(f.background_color[3]=1),f.WL=!0,f.mO=!0,f.smaa=!1,f.ssao=!1,f.precision="highp",f.gC=!0,Boolean(A.zJ())&&G.hx&&(f.cr="pvr")):l("Mac OS X")&&l("Safari")&&
!l("Chrome")&&(K("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),f.VL=!0,L.HG=!0,L.yH=!0));l("Windows")&&(l("Chrome/40")||l("Firefox/33")||l("Firefox/34")||l("Firefox/35")||l("Firefox/36"))&&(K("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.AA=!0);l("Chrome")&&!d()&&y.nK()&&(K('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
f.xH=!0);l("Mac OS X")&&(f.Bw=!0,K("OS X detected, applying shadows hack."));d()&&(K("Mobile detected, applying various hacks for video textures."),f.is_mobile_device=!0,l("iPad")||l("iPhone")||l("Windows Phone")||(K("Mobile (not iOS) detected, disable playback rate for video textures."),L.pI=!0));(l("Firefox/35.0")||l("Firefox/36.0"))&&l("Windows")&&(K("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.OM=!0);if(l("iPhone")||b()||l("Edge"))K("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
f.Ys=!0;10>z.Ew&&(K("Not enough varyings, disable shadows on blend objects"),f.lB=!0);l("Windows Phone")&&(K("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),f.debug_view=!1,f.precision="highp",f.aj=!1,f.ssao=!1,f.smaa=!1,f.shadows=!1,f.reflections=!1,f.refractions=!1,f.DL=!1);if(l("UCBrowser")||l("Chrome")&&l("Nexus")&&f.is_mobile_device)K("Mobile Nexus Chrome or UCBrowser detected, disable workers."),D.At=!1;var C=A.Kv();if(C){var Q=
g.getParameter(C.UNMASKED_VENDOR_WEBGL),C=g.getParameter(C.UNMASKED_RENDERER_WEBGL),k=/\b4\d{2}\b/;-1<Q.indexOf("ARM")&&k.test(C)&&(K("ARM Mali-400 series detected, applying depth and frames blending hacks"),E=!1,q.GI=!0);-1<Q.indexOf("ARM")&&-1<C.indexOf("Mali-T604")&&(K('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),f.precision="highp",f.shadows=!1);-1<Q.indexOf("ARM")&&-1<C.indexOf("Mali-T760")&&(K('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),f.precision=
"highp",f.ssao=!1,f.Lx=!0,f.fc&&(f.Fc=1,K("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<Q.indexOf("Qualcomm")&&-1<C.indexOf("Adreno")&&(K("Qualcomm Adreno detected, applying shader constants hack."),f.XD=!0,-1<C.indexOf("305")&&(K('Qualcomm Adreno305 detected, set "highp" precision.'),f.precision="highp"),-1<C.indexOf("330")&&(K('Qualcomm Adreno330 detected, set "highp" precision.'),f.precision="highp"),-1<C.indexOf("420")&&(K("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
z.Ec=4096,z.fj=4096));-1<Q.indexOf("NVIDIA")&&-1<C.indexOf("Tegra 3")&&(K("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.CI=!0);l("Windows")&&l("Chrome")&&!l("Edge")&&(C.match(/NVIDIA GeForce 8..0/)||C.match(/NVIDIA GeForce 9..0/)||C.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(K("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),z.fj=a.DF,f.BD=!0);-1<C.indexOf("AMD")&&l("Windows")&&l("Chrome")&&
(f.Wz=!0);-1<C.indexOf("PowerVR")&&(K("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),f.BD=!0,f.Lx=!0,f.shadows=!1);Q="";for(k=0;k<m.length;k++)if(-1<C.indexOf(m[k])){Q=m[k];break}Q&&(K("Architecture "+Q+" detected. Blending between frames and shadows on blend objects will be disabled."),f.Lx=!0,f.lB=!0)}0==z.SK&&(K("Vertex textures are not allowed. Disabling vertex textures"),f.vu=!1);E||(f.Cr=!1,f.jd=!1,f.water_dynamic=
!1,f.Xk=!1,f.Jx=!1,f.smaa=!1);f.YN=Boolean(A.DJ())||"pvr"==f.cr;f.kv=E;if(g.getShaderPrecisionFormat)var p=g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT);g.getShaderPrecisionFormat&&0!==p.precision||(f.precision="mediump");if(b()&&l("Touch")||l("Edge"))K("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),f.po=!0;if(b()||l("Edge"))f.iK=!0;d()&&l("Firefox")&&(h.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
f.KC=!0,z.Ec=4096,z.fj=4096);l("Edge")&&(K("Microsoft Edge detected, set up new minimal texture size."),f.yr=!0)};a.xA=l;a.bf=d;a.tR=function(){l("Firefox/35.0")&&l("Windows")&&(h.warn("Windows/Firefox 35 detected, forcing context's alpha"),y.context.alpha=!0)};a.es=b};b4w.module.__renderer=function(a,g){function l(a){for(var e=a.p,d=a.Qa,h=null,p=L.ic(e.n,ea),q=0;q<d.length;q++){var g=d[q];if(g.dc){var w=g.zb,g=g.sa;if(w.ki!=h){k.useProgram(w.ki);for(var h=a,v=e,t=w,l=t.KN,x=l.length;x--;){var z=l[x];z.lo(k,z.kf,h,v)}if(t.xs&&!t.Ow)for(t.fD.length||r(t),t=t.fD,x=t.length;x--;)z=t[x],z.lo(k,z.kf,h,v);h=w.ki}for(v=0;v<g.length;v++)if(l=g[v],l.dc){t=l.mf;x=l.za;m.NY(x);m.rK()&&"DEBUG_VIEW"==x.type&&(x.mr=D.Zb(A.IR(x.Yn),x.mr,1,15));if(T.alpha_sort&&x.yf){var z=t,
l=l.iw,u=p,R=x.Ca,ca=B.dist(u,l.zO),ra=T.alpha_sort_threshold*Math.min(l.LR,1);if(ca>ra||z.Gr)f.f0(R,l,z.n,u),B.copy(u,l.zO),z.Gr=!1}z=a;l=x;u=w;ra=u.LN;for(R=ra.length;R--;)ca=ra[R],ca.lo(k,ca.kf,t,l);if(u.xs&&!u.Ow){u.Fs.length||r(u);ra=u.Fs;for(R=ra.length;R--;)ca=ra[R],ca.lo(k,ca.kf,t,l);u.xs=!1}k.depthMask(l.Ua);l.$b?k.enable(k.CULL_FACE):k.disable(k.CULL_FACE);R=l.ya;ca=k;for(ra=0;ra<R.length;ra++){var C=R[ra];ca.activeTexture(ca.TEXTURE0+ra);ca.bindTexture(C.mb,C.rb)}if(z.type==c.Lg){t=z;u=
u.on;R=t.p.wc.rb;ca=t.$l;for(ra=0;6>ra;ra++)if(C=b(ra),T.AA?(k.bindTexture(k.TEXTURE_CUBE_MAP,R),k.texImage2D(C,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,Q)):(k.uniformMatrix4fv(u.u_cube_view_matrix,!1,ca[ra]),k.uniform4fv(u.u_sky_tex_fac,t.Qx),k.uniform3fv(u.u_sky_tex_color,t.Ox),k.uniform1f(u.u_sky_tex_dvar,t.Px),k.uniform3fv(u.u_horizon_color,t.oe),k.uniform3fv(u.u_zenith_color,t.ye),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,C,R,0),n(l,0)),t.Mw&&3!=ra){var C=t,I=ra,Y=F;T.AA?Y.set(Q):
(k.readPixels(191,191,1,1,k.RGBA,k.UNSIGNED_BYTE,Y),255!=Y[0]&&255!=Y[1]&&255!=Y[2]||k.readPixels(191,220,1,1,k.RGBA,k.UNSIGNED_BYTE,Y));var ua=Y[0],E=Y[1],Y=Y[2],ua=ua/255,E=E/255,Y=Y/255;2===I?(C.De[3]=ua,C.De[7]=E,C.De[11]=Y):2>I?(C.De[4*I]=ua,C.De[4*I+1]=E,C.De[4*I+2]=Y):(C.De[4*(I-2)]=ua,C.De[4*(I-2)+1]=E,C.De[4*(I-2)+2]=Y)}z.nr+=6}else n(l,t.ly),z.nr++;m.OY(x);m.rK()&&"MAIN"==x.type&&A.JR(x.id,x.Hf)}}}}function d(a){if(a){var b=(a.wb?k.COLOR_BUFFER_BIT:0)|(a.Bb?k.DEPTH_BUFFER_BIT:0);if(!b)return;
switch(a.type){case c.ke:a=C;break;case c.dd:a=O;break;case c.Df:a=K;break;case c.zf:case c.Ci:case c.An:a=E;break;case c.Kg:case c.iq:case c.ku:a=C;break;default:a=T.background_color}}else b=k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT,a=T.background_color;k.colorMask(!0,!0,!0,!0);k.depthMask(!0);k.clearColor(a[0],a[1],a[2],a[3]);k.clear(b)}function b(a){switch(a){case 0:return k.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return k.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return k.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return k.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return k.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return k.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function y(a){var b=q.VB(),c=a.xq,e=a.Ca,d=e.ld;a.Re.length=0;var f=1,h;for(h in d)f=Math.max(f,d[h].frames);for(d=0;d<f;d++){h=b.createVertexArray();w(h);e.ng&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,e.ng);for(var n=0;n<e.Pd.length;n++){k.bindBuffer(k.ARRAY_BUFFER,e.Pd[n].nl);for(var p=0;p<c.length;p++){var g=c[p];g.iO==e.Pd[n].type&&(k.enableVertexAttribArray(g.kf),k.vertexAttribPointer(g.kf,g.Jc,g.Pv,g.Pv==k.FLOAT?
!1:!0,g.mn,g.JG+g.EI*d),x(g.kf,g.vr))}}w(null);a.Re.push(h)}}function r(a){var b=a.on,c=a.LN,e=a.Fs,d=a.KN,k=a.fD;c.length=0;e.length=0;d.length=0;k.length=0;for(var f in b){var h=!1,n=null,p=null;switch(f){case "u_proj_matrix":n=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.xb)};h=!0;break;case "u_view_refl_matrix":n=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.qy)};h=!0;break;case "u_view_tsr":case "u_view_tsr_frag":n=function(a,b,c,e){e.rc?a.uniformMatrix3fv(b,!1,e.Ps):a.uniformMatrix3fv(b,!1,e.wf)};
h=!0;break;case "u_view_tsr_inverse":n=function(a,b,c,e){e.rc?a.uniformMatrix3fv(b,!1,e.mx):a.uniformMatrix3fv(b,!1,e.ry)};h=!0;break;case "u_shadow_cast_billboard_view_tsr":n=function(a,b,c,e){a.uniformMatrix3fv(b,!1,e.dt)};h=!0;break;case "u_view_proj_prev":n=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.lD)};h=!0;break;case "u_view_proj_matrix":n=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.md)};h=!0;break;case "u_view_proj_inverse":n=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.py)};h=!0;break;case "u_sky_vp_inverse":n=
function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.Bg)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":n=function(a,b,c,e){a.uniform3fv(b,L.ic(e.n,ea))};h=!0;break;case "u_camera_quat":n=function(a,b,c,e){a.uniform4fv(b,L.ae(e.n,I))};h=!0;break;case "u_view_max_depth":n=function(a,b,c,e){a.uniform1f(b,e.far)};h=!0;break;case "u_camera_range":n=function(a,b,c,e){a.uniform2f(b,e.near,e.far)};break;case "u_csm_center_dists":n=function(a,b,c,e){a.uniform4fv(b,e.cv)};break;case "u_height":n=function(a,
b,c,e){a.uniform1f(b,e.height)};h=!0;break;case "u_pcf_blur_radii":n=function(a,b,c,e){a.uniform4fv(b,e.Mo)};break;case "u_dof_dist":n=function(a,b,c,e){e.dof_on?a.uniform1f(b,e.dof_distance):a.uniform1f(b,0)};h=!0;break;case "u_dof_front_start":n=function(a,b,c,e){a.uniform1f(b,e.dof_front_start)};h=!0;break;case "u_dof_front_end":n=function(a,b,c,e){a.uniform1f(b,e.dof_front_end)};h=!0;break;case "u_dof_rear_start":n=function(a,b,c,e){a.uniform1f(b,e.dof_rear_start)};h=!0;break;case "u_dof_rear_end":n=
function(a,b,c,e){a.uniform1f(b,e.dof_rear_end)};h=!0;break;case "u_dof_bokeh_intensity":n=function(a,b,c,e){a.uniform1f(b,e.dof_bokeh_intensity)};h=!0;break;case "u_camera_direction":n=function(a,b,c,e){a.uniform3fv(b,e.direction)};h=!0;break;case "u_cam_water_depth":n=function(a,b,c){a.uniform1f(b,c.uA)};h=!0;break;case "u_waves_height":n=function(a,b,c){a.uniform1f(b,c.VE)};break;case "u_waves_length":n=function(a,b,c){a.uniform1f(b,c.WE)};break;case "u_fog_color_density":n=function(a,b,c){a.uniform4fv(b,
c.Ge)};break;case "u_fog_params":n=function(a,b,c){a.uniform4fv(b,c.jg)};break;case "u_underwater_fog_color_density":n=function(a,b,c){a.uniform4fv(b,c.zi)};break;case "u_bloom_key":n=function(a,b,c){a.uniform1f(b,c.Hu)};break;case "u_bloom_edge_lum":n=function(a,b,c){a.uniform1f(b,c.Gu)};break;case "u_time":n=function(a,b,c){a.uniform1f(b,c.time)};h=!0;break;case "u_wind":n=function(a,b,c){a.uniform3fv(b,c.Jj)};h=!0;break;case "u_sky_tex_dvar":n=function(a,b,c){a.uniform1f(b,c.Px)};break;case "u_sky_tex_fac":n=
function(a,b,c){a.uniform4fv(b,c.Qx)};break;case "u_sky_tex_color":n=function(a,b,c){a.uniform3fv(b,c.Ox)};break;case "u_horizon_color":n=function(a,b,c){a.uniform3fv(b,c.oe)};break;case "u_zenith_color":n=function(a,b,c){a.uniform3fv(b,c.ye)};break;case "u_environment_energy":n=function(a,b,c){a.uniform1f(b,c.ah)};break;case "u_sky_color":n=function(a,b,c){a.uniform3fv(b,c.gp)};break;case "u_rayleigh_brightness":n=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":n=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":n=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":n=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":n=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":n=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":n=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":n=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":n=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":n=function(a,b,c){a.uniform4fv(b,c.qs)};break;case "u_light_directions":n=function(a,b,c){a.uniform3fv(b,c.wC)};break;case "u_light_color_intensities":n=function(a,b,c){a.uniform4fv(b,c.ps)};break;case "u_sun_quaternion":n=function(a,b,c){a.uniform4fv(b,c.pN)};break;case "u_sun_intensity":n=function(a,b,c){a.uniform3fv(b,c.oN)};
break;case "u_sun_direction":n=function(a,b,c){a.uniform3fv(b,c.kE)};break;case "u_debug_view_mode":n=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":n=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":n=function(a,b,c){a.uniform1f(b,c.iI)};break;case "u_subpixel_jitter":n=function(a,b,c){a.uniform2fv(b,c.YW)};h=!0;break;case "u_subsample_indices":n=function(a,b,c){a.uniform4fv(b,c.ZW)};h=!0;break;case "u_radial_blur_step":n=
function(a,b,c){a.uniform1f(b,c.lx)};break;case "u_god_rays_intensity":n=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":n=function(a,b,c){a.uniform1f(b,c.lp)};break;case "u_ssao_blur_discard_value":n=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};h=!0;break;case "u_ssao_influence":n=function(a,b,c){a.uniform1f(b,c.kp)};break;case "u_ssao_dist_factor":n=function(a,b,c){a.uniform1f(b,c.jp)};break;case "u_texel_size":n=function(a,b,c){a.uniform2fv(b,
c.uE)};h=!0;break;case "u_normal_offset":n=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":n=function(a,b,c){a.uniform4fv(b,c.ky)};h=!0;break;case "u_v_light_r":n=function(a,b,c){a.uniform4fv(b,c.jy)};h=!0;break;case "u_v_light_tsr":n=function(a,b,c){a.uniformMatrix3fv(b,!1,c.QE)};h=!0;break;case "u_p_light_matrix0":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Um[0])};h=!0;break;case "u_p_light_matrix1":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Um[1])};h=!0;
break;case "u_p_light_matrix2":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Um[2])};h=!0;break;case "u_p_light_matrix3":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Um[3])};h=!0;break;case "u_outline_color":n=function(a,b,c){a.uniform3fv(b,c.pj)};break;case "u_draw_outline":n=function(a,b,c){a.uniform1f(b,c.qB)};h=!0;break;case "u_glow_mask_small_coeff":n=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":n=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
h=!0;break;case "u_brightness":n=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":n=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":n=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":n=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":n=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":n=function(a,b,c){a.uniform4fv(b,c.dm)};break;case "u_chromatic_aberration_coefs":n=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":n=function(a,b,c){a.uniform1f(b,c.TK)};h=!0;break;case "u_motion_blur_decay_threshold":n=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};h=!0;break;case "u_model_tsr":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};h=!0;break;case "u_model_tsr_inverse":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.zy)};h=!0;break;case "u_transb":p=function(a,b,c){a.uniform4fv(b,c.xe)};h=!0;break;case "u_transa":p=function(a,b,c){a.uniform4fv(b,
c.Oe)};h=!0;break;case "u_arm_rel_trans":p=function(a,b,c){a.uniform4fv(b,c.uq)};h=!0;break;case "u_arm_rel_quat":p=function(a,b,c){a.uniform4fv(b,c.tq)};h=!0;break;case "u_quat":p=function(a,b,c){a.uniform4fv(b,L.ae(c.n,I))};h=!0;break;case "u_quatsb":p=function(a,b,c){a.uniform4fv(b,c.re)};h=!0;break;case "u_quatsa":p=function(a,b,c){a.uniform4fv(b,c.Ke)};h=!0;break;case "u_frame_factor":p=function(a,b,c){a.uniform1f(b,c.ef)};h=!0;break;case "au_center_pos":p=function(a,b,c){a.uniform3fv(b,c.Mq)};
h=!0;break;case "au_wind_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Dh)};h=!0;break;case "au_wind_bending_freq":p=function(a,b,c){a.uniform1f(b,c.Eh)};h=!0;break;case "au_detail_bending_freq":p=function(a,b,c){a.uniform1f(b,c.Yg)};h=!0;break;case "au_detail_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Xg)};h=!0;break;case "au_branch_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Rg)};h=!0;break;case "u_node_values":p=function(a,b,c,e){a.uniform1fv(b,e.mj)};h=!0;break;case "u_node_rgbs":p=function(a,
b,c,e){a.uniform3fv(b,e.Ie)};h=!0;break;case "u_diffuse_color":p=function(a,b,c,e){a.uniform4fv(b,e.fg)};h=!0;break;case "u_diffuse_intensity":p=function(a,b,c,e){a.uniform1f(b,e.cm)};h=!0;break;case "u_diffuse_params":p=function(a,b,c,e){a.uniform2fv(b,e.Xd)};h=!0;break;case "u_emit":p=function(a,b,c,e){a.uniform1f(b,e.fk)};h=!0;break;case "u_ambient":p=function(a,b,c,e){a.uniform1f(b,e.Oj)};h=!0;break;case "u_specular_color":p=function(a,b,c,e){a.uniform3fv(b,e.jn)};h=!0;break;case "u_specular_alpha":p=
function(a,b,c,e){a.uniform1f(b,e.ht)};h=!0;break;case "u_specular_params":p=function(a,b,c,e){a.uniform3fv(b,e.$k)};h=!0;break;case "u_reflect_factor":p=function(a,b,c,e){a.uniform1f(b,e.So)};h=!0;break;case "u_mirror_factor":p=function(a,b,c,e){a.uniform1f(b,e.vs)};h=!0;break;case "u_grass_map_dim":p=function(a,b,c,e){a.uniform3fv(b,e.ne)};h=!0;break;case "u_grass_size":p=function(a,b,c,e){a.uniform1f(b,e.Ur)};h=!0;break;case "u_scale_threshold":p=function(a,b,c,e){a.uniform1f(b,e.Rv)};h=!0;break;
case "u_cube_fog":p=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.De)};break;case "u_jitter_amp":p=function(a,b,c,e){a.uniform1f(b,e.tw)};h=!0;break;case "u_jitter_freq":p=function(a,b,c,e){a.uniform1f(b,e.uw)};h=!0;break;case "u_wireframe_edge_color":p=function(a,b,c,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_cluster_id":p=function(a,b,c,e){a.uniform1f(b,e.Wq)};h=!0;break;case "u_batch_debug_id_color":p=function(a,b,c,e){a.uniform1f(b,e.fv)};h=!0;break;case "u_batch_debug_main_render_time":p=
function(a,b,c,e){a.uniform1f(b,e.mr)};h=!0;break;case "u_refr_bump":p=function(a,b,c,e){a.uniform1f(b,e.nx)};h=!0;break;case "u_line_width":p=function(a,b,c,e){a.uniform1f(b,e.ww)};h=!0;break;case "u_lamp_light_positions":p=function(a,b,c,e){a.uniform3fv(b,e.zo)};break;case "u_lamp_light_directions":p=function(a,b,c,e){a.uniform3fv(b,e.ms)};break;case "u_lamp_light_color_intensities":p=function(a,b,c,e){a.uniform3fv(b,e.ls)};break;case "u_halo_size":p=function(a,b,c,e){a.uniform1f(b,e.$v)};h=!0;
break;case "u_halo_hardness":p=function(a,b,c,e){a.uniform1f(b,e.Xv)};h=!0;break;case "u_halo_rings_color":p=function(a,b,c,e){a.uniform3fv(b,e.Zv)};h=!0;break;case "u_halo_lines_color":p=function(a,b,c,e){a.uniform3fv(b,e.Yv)};h=!0;break;case "u_halo_stars_blend":p=function(a,b,c,e){a.uniform1f(b,e.aw)};h=!0;break;case "u_halo_stars_height":p=function(a,b,c,e){a.uniform1f(b,e.bw)};h=!0;break;case "u_fresnel_params":p=function(a,b,c,e){a.uniform4fv(b,e.Xi)};h=!0;break;case "u_texture_scale":p=function(a,
b,c,e){a.uniform3fv(b,e.ti)};h=!0;break;case "u_parallax_scale":p=function(a,b,c,e){a.uniform1f(b,e.Ko)};h=!0;break;case "u_color_id":p=function(a,b,c){a.uniform3fv(b,c.Yj)};h=!0;break;case "u_line_points":p=function(a,b,c,e){a.uniform3fv(b,e.h8)};h=!0;break;case "u_diffuse_color_factor":p=function(a,b,c,e){a.uniform1f(b,e.bm)};h=!0;break;case "u_alpha_factor":p=function(a,b,c,e){a.uniform1f(b,e.Dl)};h=!0;break;case "u_specular_color_factor":p=function(a,b,c,e){a.uniform1f(b,e.ip)};h=!0;break;case "u_normal_factor":p=
function(a,b,c,e){a.uniform1f(b,e.Qw)};h=!0;break;case "u_normalmap0_scale":p=function(a,b,c,e){a.uniform2fv(b,e.nj[0])};h=!0;break;case "u_normalmap1_scale":p=function(a,b,c,e){a.uniform2fv(b,e.nj[1])};h=!0;break;case "u_normalmap2_scale":p=function(a,b,c,e){a.uniform2fv(b,e.nj[2])};h=!0;break;case "u_normalmap3_scale":p=function(a,b,c,e){a.uniform2fv(b,e.nj[3])};h=!0;break;case "u_foam_factor":p=function(a,b,c,e){a.uniform1f(b,e.jo)};h=!0;break;case "u_foam_uv_freq":p=function(a,b,c,e){a.uniform2fv(b,
e.xv)};h=!0;break;case "u_foam_mag":p=function(a,b,c,e){a.uniform2fv(b,e.wv)};h=!0;break;case "u_foam_scale":p=function(a,b,c,e){a.uniform2fv(b,e.Dr)};h=!0;break;case "u_water_norm_uv_velocity":p=function(a,b,c,e){a.uniform1f(b,e.Ip)};h=!0;break;case "u_shallow_water_col":p=function(a,b,c,e){a.uniform3fv(b,e.$o)};h=!0;break;case "u_shore_water_col":p=function(a,b,c,e){a.uniform3fv(b,e.bp)};h=!0;break;case "u_water_shallow_col_fac":p=function(a,b,c,e){a.uniform1f(b,e.ap)};h=!0;break;case "u_water_shore_col_fac":p=
function(a,b,c,e){a.uniform1f(b,e.cp)};h=!0;break;case "u_p_length":p=function(a,b,c,e){a.uniform1f(b,e.gb.CN)};h=!0;break;case "u_p_cyclic":p=function(a,b,c,e){a.uniform1i(b,e.gb.Ee)};h=!0;break;case "u_p_max_lifetime":p=function(a,b,c,e){a.uniform1f(b,e.gb.HK)};h=!0;break;case "u_p_fade_in":p=function(a,b,c,e){a.uniform1f(b,e.gb.hm)};h=!0;break;case "u_p_fade_out":p=function(a,b,c,e){a.uniform1f(b,e.gb.Kf)};h=!0;break;case "u_p_size":p=function(a,b,c,e){a.uniform1f(b,e.gb.size)};h=!0;break;case "u_p_alpha_start":p=
function(a,b,c,e){a.uniform1f(b,e.gb.rG)};h=!0;break;case "u_p_alpha_end":p=function(a,b,c,e){a.uniform1f(b,e.gb.qG)};h=!0;break;case "u_p_nfactor":p=function(a,b,c,e){a.uniform1f(b,e.gb.UC)};h=!0;break;case "u_p_gravity":p=function(a,b,c,e){a.uniform1f(b,e.gb.XJ)};h=!0;break;case "u_p_mass":p=function(a,b,c,e){a.uniform1f(b,e.gb.fi)};h=!0;break;case "u_p_color_ramp":p=function(a,b,c,e){a.uniform4fv(b,e.gb.FH)};h=!0;break;case "u_p_wind_fac":p=function(a,b,c,e){a.uniform1f(b,e.gb.uO)};h=!0;break;
case "u_p_time":p=function(a,b,c,e){a.uniform1f(b,e.gb.time)};h=!0;break;case "u_p_tilt":p=function(a,b,c,e){a.uniform1f(b,e.gb.AN)};h=!0;break;case "u_p_tilt_rand":p=function(a,b,c,e){a.uniform1f(b,e.gb.BN)};h=!0;break;case "u_position":p=function(a,b,c,e){a.uniform3fv(b,e.El)};h=!0;break;case "u_va_frame_factor":p=function(a,b,c){a.uniform1f(b,c.my)};h=!0;break;case "u_refl_plane":p=function(a,b,c){a.uniform4fv(b,c.rc)};h=!0;break;case "u_outline_intensity":p=function(a,b,c){a.uniform1f(b,c.sh)};
h=!0;break;case "u_obj_info":p=function(a,b,c,e){a.uniform3fv(b,e.Io)},h=!0}p&&(p={name:f,lo:p,kf:b[f]},h?c.push(p):e.push(p));n&&(p={name:f,lo:n,kf:b[f]},h?d.push(p):k.push(p))}if(e.length||k.length){a=a.gD;for(var q in a)delete a[q];for(q=0;q<e.length;q++)p=e[q],a[p.name]=p;for(q=0;q<k.length;q++)p=k[q],a[p.name]=p}else a.Ow=!0}var A=g("__batch"),h=g("__camera"),u=g("__config"),m=g("__debug"),q=g("__extensions"),f=g("__geometry"),t=g("__quat"),c=g("__subscene"),z=g("__textures"),L=g("__tsr"),D=
g("__util"),G=g("__version"),f=g("__geometry"),B=g("__vec3"),O=[1,1,1,1],K=[1,1,1,1],E=[0,0,0,1],C=[0,0,0,0],Q=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var k=null,p=null,x=null,e=null,w=null,n=null,ea=new Float32Array(3),I=t.create(),F=new Uint8Array(4),T=u.B;a.Uf=function(a){var b=T.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);k=a};a.co=function(a){if(a.dc)if(a.type==c.Hn){m.xD(a);var e=a.p;k.bindFramebuffer(k.READ_FRAMEBUFFER,e.Ir);k.bindFramebuffer(k.DRAW_FRAMEBUFFER,e.ff);var f=0;e.wc&&(f|=k.COLOR_BUFFER_BIT);e.af&&(f|=k.DEPTH_BUFFER_BIT);k.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,f,k.NEAREST);m.yD(a);m.wA("draw resolve")}else if(a.type==c.Ny)m.xD(a),e=a.p,k.bindFramebuffer(k.FRAMEBUFFER,
e.Ir),k.bindTexture(k.TEXTURE_2D,e.wc.rb),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,e.width,e.height,0),m.yD(a),m.wA("draw copy");else{m.xD(a);e=a.p;k.bindFramebuffer(k.FRAMEBUFFER,e.ff);a.bA&&(f=e.wc,k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,f.mb,f.rb,0));k.viewport(0,0,e.width,e.height);a.type!=c.nd&&a.type!=c.Ue&&d(a);a.Lb?k.enable(k.BLEND):k.disable(k.BLEND);a.Wd?k.enable(k.DEPTH_TEST):k.disable(k.DEPTH_TEST);switch(a.type){case c.dd:k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);k.cullFace(k.BACK);break;case c.Rd:case c.Cf:k.disable(k.POLYGON_OFFSET_FILL);k.cullFace(k.FRONT);break;case c.Bf:k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(-4,-4);k.cullFace(k.BACK);break;case c.ke:if(1<T.Fc||T.WL){k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(-2,-2);break}default:k.disable(k.POLYGON_OFFSET_FILL),k.cullFace(k.BACK)}if(a.type==c.nd||a.type==c.Ue)for(var e=a.p,f=e.wc.rb,p=0;6>p;p++){var n=b(p);e.Ob=a.$l[p];L.fh(e.Ob,e.wf);h.qA(e);k.framebufferTexture2D(k.FRAMEBUFFER,
k.COLOR_ATTACHMENT0,n,f,0);d(a);for(var n=a.Qa,q=0;q<n.length;q++)for(var g=0;g<n[q].sa.length;g++){var w=n[q].sa[g];w.dc=w.pB[p]}l(a)}else l(a);m.yD(a);m.wA("draw subscene: "+c.jE(a))}};a.clear=function(a){k.bindFramebuffer(k.FRAMEBUFFER,a.p.ff);d(a)};a.zR=function(a){var b=a.xq;b.length=0;var c=a.Ca,e=c.ld,d=a.zb.attributes,k;for(k in d){var h=e[k],p=f.Tr(k),n=f.XV(k),q=f.OJ(k);b.push({iO:p,Pv:n,kf:d[k],JG:h.offset*q,EI:1<h.frames?h.length*q:0,Jc:h.Jc,mn:h.mn*q,vr:h.vr})}if("DEBUG"==G.type())for(k in e)p=
f.Tr(k),b=f.fZ(c.Pd,p),b=c.Pd[b],h=a.hb.Eg+" | "+a.hb.df,p=e[k].length*e[k].frames*f.OJ(k),m.ZU(b.mU,h,k,p,k in d);T.Uz&&y(a)};a.ER=y;a.SS=function(a){for(var b=q.VB(),c=0;c<a.Re.length;c++)b.deleteVertexArray(a.Re[c]);a.Re.length=0};a.US=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.DR=r;a.FG=function(a){var b=a.zb,c=a.ya;a=a.Od;k.useProgram(b.ki);for(var e=0;e<c.length;e++)k.uniform1i(b.on[a[e]],e)};a.sD=function(a,b,c,e,d,f){e||(e=1);d||(d=1);f||(f=new Uint8Array(4*e*d));
f.length!=4*e*d&&D.q("read_pixels(): Wrong storage");k.bindFramebuffer(k.FRAMEBUFFER,a);k.readPixels(b,c,e,d,k.RGBA,k.UNSIGNED_BYTE,f);k.bindFramebuffer(k.FRAMEBUFFER,null);return f};a.b0=function(a){var b=a.zb;b.Ow||(k.useProgram(b.ki),b.Fs.length||r(b),b=b.gD.u_cube_fog,b.lo(k,b.kf,null,a))};a.MY=function(a,b){var c=k.createFramebuffer();k.bindFramebuffer(k.FRAMEBUFFER,c);if(z.xo(a)){var e=a.Se;k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.RENDERBUFFER,e)}else if(z.yo(a)){var d=
a,e=d.rb,d=d.mb==k.TEXTURE_CUBE_MAP?k.TEXTURE_CUBE_MAP_NEGATIVE_Z:d.mb;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,d,e,0)}z.xo(b)?(e=b.Se,k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,e)):z.yo(b)&&(d=b,e=d.rb,d=d.mb,k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,d,e,0));m.wS();k.bindFramebuffer(k.FRAMEBUFFER,null);return c};a.LY=function(a,b,c,e,d){null==a?(k.bindFramebuffer(k.FRAMEBUFFER,a),k.viewport(0,0,e,d),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)):
(z.xo(b)?k.deleteRenderbuffer(b.Se):z.yo(b)&&k.deleteTexture(b.rb),z.xo(c)?k.deleteRenderbuffer(c.Se):z.yo(c)&&k.deleteTexture(c.rb),k.deleteFramebuffer(a))};a.N7=function(){};a.yU=function(a,b,c,e,d,f){a=a.rb;k.viewport(0,0,c,c);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,b,a,0);b=A.UA("FLIP_CUBEMAP_COORDS");a=b.zb;k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,d);var h=d=0;c!=e&&(d=1/(6*e),h=1/(4*e));k.uniform1i(a.on.u_tex_number,f);k.uniform2fv(a.on.u_delta,[d,h]);k.useProgram(a.ki);
n(b,0);k.bindTexture(k.TEXTURE_2D,null)};a.zU=function(a,b,c,e,d){k.bindFramebuffer(k.FRAMEBUFFER,e);e=a.rb;a=a.mb;k.bindTexture(a,e);k.viewport(0,0,b,c);k.texImage2D(a,0,k.RGBA,b,c,0,k.RGBA,k.UNSIGNED_BYTE,null);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,a,e,0);b=A.UA("NONE");c=b.zb;k.activeTexture(k.TEXTURE0);k.bindTexture(a,d);k.useProgram(c.ki);n(b,0);k.bindFramebuffer(k.FRAMEBUFFER,null);k.bindTexture(a,null)};a.ua=function(){};a.rZ=function(){var a=q.$V(),b=q.VB();T.pG=a?!0:!1;
T.Uz=b?!0:!1;a?(p=function(b,c,e,d){a.drawElementsInstanced(k.TRIANGLES,b,c,e,d)},x=function(b,c){a.vertexAttribDivisor(b,c)},e=function(b,c,e){a.drawArraysInstanced(k.TRIANGLES,b,c,e)}):(p=function(a,b,c){k.drawElements(k.TRIANGLES,a,b,c)},x=function(){},e=function(a,b){k.drawArrays(k.TRIANGLES,a,b)});b?(w=function(a){b.bindVertexArray(a)},n=function(a,b){var c=a.Ca;w(a.Re[b]);c.ng?p(c.count,c.wm,0,c.Am):e(0,c.count,c.Am);w(null)}):n=function(a,b){for(var c=a.Ca,d=a.xq,f=0;f<c.Pd.length;f++){k.bindBuffer(k.ARRAY_BUFFER,
c.Pd[f].nl);for(var h=0;h<d.length;h++){var n=d[h];n.iO==c.Pd[f].type&&(k.enableVertexAttribArray(n.kf),k.vertexAttribPointer(n.kf,n.Jc,n.Pv,n.Pv==k.FLOAT?!1:!0,n.mn,n.JG+n.EI*b),x(n.kf,n.vr))}}c.ng?(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,c.ng),p(c.count,c.wm,0,c.Am)):e(0,c.count,c.Am);for(f=0;f<d.length;f++)n=d[f],k.disableVertexAttribArray(n.kf)}};a.reset=function(){w=e=x=p=k=null}};b4w.module.__camera=function(a,g){function l(a,b,c,e,d){N.Xc(a,b);c&&B(a,b,c);C(a,e);Q(a,d)}function d(a,b,c,d,k,f,h,p){var n=a.k;N.Xc(a,b);n.pivot.set(c);B(a,b,c);C(a,d);Q(a,k);e(a,f);w(a,h);n.use_panning=p}function b(a,b,c,e,d,f,h,p){var q=a.k;N.Xc(a,b);q.Vb.set(c);B(a,b,c);x(a,e);k(a,d);n(a,f);ea(a,h);q.Vh=p}function y(a,b,c){var e=a.k,d=ia.F(e.n),k=ia.P(e.n),e=za;e.set(J.nc);e[3]=0;a=t(a,qa)[1];k=J.mc(k,J.Nc,Ia);ra.Zo(S,d);ra.en(S,k);if(!J.rs(e,-b,S,c)||Math.abs(a)<ja)oa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
c[0]=d[0],c[1]=0,c[2]=d[2];return c}function r(b){for(var c=b.k,e=0;e<b.I.length;e++){var d=b.I[e].da[0];if(d.type==a.Be)switch(c.ub){case a.Kb:var k=ia.F(c.n);c.qk=ma.dist(k,c.pivot);c.rk=d.top;break;case a.cd:k=ia.F(c.n),c.qk=ma.dist(k,c.Vb),c.rk=d.top}}}function A(a){a={type:a,name:"",QM:1,width:0,height:0,ff:null,Ir:null,wc:null,af:null,Ab:0,Zd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,kd:pa.create(),n:new Float32Array(9),Ob:new Float32Array(16),qy:new Float32Array(16),xb:new Float32Array(16),
md:new Float32Array(16),py:new Float32Array(16),lD:new Float32Array(16),Bg:new Float32Array(16),direction:new Float32Array(3),wf:ia.Wl(),ry:ia.Wl(),Ps:ia.Wl(),mx:ia.Wl(),dt:ia.Wl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,qI:!1,Ed:!1,dof_on:!1,zw:new Float32Array(3),Xh:u(),al:0,sf:0,rc:null,Th:null,kr:null,cv:new Float32Array(4),Mo:new Float32Array(4)};a.kd[0]=a.kd[2]=45;a.kd[1]=a.kd[3]=55;return a}function h(a,
b){var c=A(a.type);c.name=a.name;c.QM=a.QM;c.width=a.width;c.height=a.height;b||(c.ff=a.ff,c.Ir=a.Ir,c.wc=a.wc,c.af=a.af);c.Ab=a.Ab;c.Zd=a.Zd;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;pa.copy(a.kd,c.kd);ia.copy(a.n,c.n);ca.copy(a.Ob,c.Ob);ca.copy(a.xb,c.xb);ca.copy(a.md,c.md);ca.copy(a.py,c.py);ca.copy(a.lD,c.lD);ca.copy(a.Bg,c.Bg);ia.copy(a.wf,c.wf);ia.copy(a.ry,c.ry);ia.copy(a.Ps,c.Ps);ia.copy(a.mx,c.mx);ia.copy(a.dt,c.dt);c.dof_distance=a.dof_distance;
c.dof_front_start=a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.qI=a.qI;c.Ed=a.Ed;c.dof_on=a.dof_on;ma.copy(a.zw,c.zw);var e=a.Xh,d=c.Xh;pa.copy(e.left,d.left);pa.copy(e.right,d.right);pa.copy(e.top,d.top);pa.copy(e.bottom,d.bottom);pa.copy(e.near,d.near);pa.copy(e.far,d.far);c.al=a.al;c.sf=a.sf;a.rc&&(c.rc=pa.clone(a.rc));if(a.Th){e=a.Th.length;
c.Th=Array(e);for(d=0;d<e;d++)c.Th[d]=ma.clone(a.Th[d]);c.kr=new Float32Array(a.kr)}pa.copy(a.cv,c.cv);pa.copy(a.Mo,c.Mo);return c}function u(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function m(b){switch(b){case "STATIC":return a.Jg;case "TARGET":return a.Kb;case "EYE":return a.od;case "HOVER":return a.cd;default:J.q("Unknown move style")}}
function q(b){var c=A(b);if(b==a.qd)return c;switch(b){case a.Sd:z(c,40,.1,1E3);break;case a.Be:z(c,2.5,.1,1E3);break;case a.Kh:break;case a.Jh:break;case a.Gi:break;case a.Qc:case a.ed:case a.Ve:case a.We:J.q("Stereo camera may only be created from perspective one");break;default:J.q("Unknown camera type")}return c}function f(b,c,e){b.type!=a.Qc&&b.type!=a.ed&&b.type!=a.Ve&&b.type!=a.We&&J.q("set_stereo_params(): wrong camera type");if(b.type==a.Qc||b.type==a.ed)b.al=c;b.sf=e;V(b,b.Ab);if(ua.Da()&&
(c=ua.A(),b=c.s.yd))for(c=xa.ja(ua.rm(c),c).da,e=0;e<c.length;e++)v(c[e],b)}function t(a,b){var e=ia.P(a.k.n);return c(e,b)}function c(a,b){var c=J.mc(a,J.nc,Ia),e=J.mc(a,J.Te,Ca),d=-Math.asin(c[2]/ma.length(c)),c=Math.abs(d)>Math.PI/4?ma.scale(e,-J.sign(d),Aa):ma.scale(c,-J.sign(e[2]),Aa),k=Math.atan(Math.abs(c[0]/c[1]));0<e[2]&&(d=J.sign(d)*Math.PI-d);e=k;0<c[1]&&(e=Math.PI-e);0>c[0]&&(e=2*Math.PI-e);b[0]=e;b[1]=d;return b}function z(b,c,e,d,k){switch(b.type){case a.Sd:case a.Qc:case a.ed:b.Zd=
c;b.Ab=1;break;case a.Be:b.top=c;b.Ab=1;break;case a.Kh:b.Zd=c;b.Ab=k/c;break;case a.Jh:b.top=c;b.Ab=k/c;break;case a.Ve:case a.We:break;default:oa.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=e;b.far=d}function L(b,c){var e=ia.ic(c.k.n,Ia),d=ia.ae(c.k.n,la),k=ca.fromRotationTranslation(d,e,Fa);ca.invert(k,b.Ob);if(ua.Da())var k=ua.A(),f=ua.La(k,sa.Fi);if(b.type==a.Qc||f&&f.enable_hmd_stereo&&b.type==a.Ve)b.Ob[12]+=b.sf/2;else if(b.type==a.ed||f&&f.enable_hmd_stereo&&b.type==a.We)b.Ob[12]-=
b.sf/2;if(b.rc){ia.fh(b.Ob,b.Ps);ia.invert(b.Ps,b.mx);var k=b.rc[0],f=b.rc[1],h=b.rc[2],p=b.rc[3],n=b.qy;n[0]=1-2*k*k;n[1]=-2*k*f;n[2]=-2*k*h;n[3]=0;n[4]=-2*k*f;n[5]=1-2*f*f;n[6]=-2*f*h;n[7]=0;n[8]=-2*k*h;n[9]=-2*f*h;n[10]=1-2*h*h;n[11]=0;n[12]=-2*k*p;n[13]=-2*f*p;n[14]=-2*h*p;n[15]=1;ca.multiply(b.Ob,b.qy,b.Ob);V(b,b.Ab,!0);k=za;f=Fa;ca.invert(b.Ob,f);ca.transpose(f,f);pa.transformMat4(b.rc,f,k);f=Sa;f[0]=(J.sign(k[0])+b.xb[8])/b.xb[0];f[1]=(J.sign(k[1])+b.xb[9])/b.xb[5];f[2]=-1;f[3]=(1+b.xb[10])/
b.xb[14];pa.scale(k,2/(k[0]*f[0]+k[1]*f[1]+k[2]*f[2]+k[3]*f[3]),k);b.xb[2]=k[0];b.xb[6]=k[1];b.xb[10]=k[2]+1;b.xb[14]=k[3];ma.transformMat4(e,b.qy,e)}ia.fh(b.Ob,b.wf);ia.invert(b.wf,b.ry);W(b);P(b);ia.Ag(e,1,d,b.n)}function D(b,c,e,d){ca.lookAt(c,e,d,b.Ob);e=ua.A();e=ua.La(e,sa.Fi);ua.Da()&&(e=ua.A(),e=ua.La(e,sa.Fi));if(b.type==a.Qc||e&&e.enable_hmd_stereo&&b.type==a.Ve)b.Ob[12]+=b.sf/2;else if(b.type==a.ed||e&&e.enable_hmd_stereo&&b.type==a.We)b.Ob[12]-=b.sf/2;ia.fh(b.Ob,b.wf);W(b);P(b);ia.ue(c,
b.n)}function G(a,b,c){c=ma.subtract(c,b,Ia);ma.length(c)&&(ma.normalize(c,c),c=J.GD(J.Nc,c,la),N.pi(a,c));N.Xc(a,b)}function B(a,b,c){var e=a.k,d=E(a);G(a,b,c);d?(b=ma.copy(e.vf,Ia),ma.negate(b,b),na.ak(a,b,!0)):na.ak(a,e.vf,!0)}function O(a,b){for(var c=a.k,e=b.da,d=ia.ae(c.n,la),d=J.mc(d,J.Nc,Ia),k=ia.ic(c.n,Ca),f=b.NM,h=0;h<f.length;h++){var n=f[h];ma.copy(d,n.direction);ia.ic(c.n,n.zw)}for(h=0;h<e.length;h++)n=e[h],L(n,a),ma.copy(d,n.direction),J.fo(n.md,n.Xh),n.dof_object&&n.dof_on&&(c=N.Uc(n.dof_object,
Aa),c=ma.dist(k,c),n.dof_distance=c)}function K(b){var c=b.k;c.ub==a.Kb&&(c.el=E(b))}function E(a){a=ia.P(a.k.n);return 0>J.mc(a,J.Bi,Ia)[2]}function C(b,c){var e=b.k;if(c){e.lb=e.lb||{};e.lb.left=c.left;e.lb.right=c.right;e.lb.Ao=c.left;e.lb.Wo=c.right;e.lb.camera_space=Boolean(c.camera_space);var d=b.k;!(e=d.lb)||d.ub!=a.od&&d.ub!=a.Kb||(d=t(b,qa),e.camera_space?(e.left+=d[0],e.right+=d[0]):(e.Ao-=d[0],e.Wo-=d[0]),e.left=J.Hi(e.left),e.right=J.Hi(e.right),e.Ao=J.Hi(e.Ao),e.Wo=J.Hi(e.Wo))}else e.lb=
null}function Q(a,b){var c=a.k;b?(c.ka=c.ka||{},c.ka.down=b.down,c.ka.up=b.up,c.ka.bo=b.down,c.ka.zp=b.up,c.ka.camera_space=Boolean(b.camera_space),p(a)):c.ka=null}function k(a,b){var c=a.k;if(!b){var e=t(a,qa);b={down:e[1],up:e[1]}}c.ka=c.ka||{};c.ka.down=b.down;c.ka.up=b.up;p(a);c.sb&&c.ka&&fa(a)}function p(b){var c=b.k,e=c.ka;if(e)switch(c.ub){case a.od:case a.Kb:b=t(b,qa);e.camera_space?(e.up+=b[1],e.down+=b[1]):(e.zp-=b[1],e.bo-=b[1]);e.up=J.Ng(e.up,-Math.PI,Math.PI);e.down=J.Ng(e.down,-Math.PI,
Math.PI);e.zp=J.Ng(e.zp,-Math.PI,Math.PI);e.bo=J.Ng(e.bo,-Math.PI,Math.PI);break;case a.cd:e.up=J.Ng(e.up,-Math.PI,Math.PI),e.down=J.Ng(e.down,-Math.PI,Math.PI),e.up=J.V(e.up,-Math.PI/2,0),e.down=J.V(e.down,-Math.PI/2,0)}}function x(a,b){var c=a.k;if(!b){var e=N.Jo(a,c.Vb);b={min:e,max:e}}c.sb=c.sb||{};c.sb.min=b.min;c.sb.max=b.max;c.sb&&c.ka&&fa(a)}function e(a,b){var c=a.k;b?(c.sb=c.sb||{},c.sb.min=b.min,c.sb.max=b.max):c.sb=null}function w(a,b){var c=a.k;b?(c.ge=c.ge||{},c.ge.min_z=b.min_z,c.ge.max_z=
b.max_z):c.ge=null}function n(a,b){var c=a.k;b?(c.Cc=c.Cc||{},c.Cc.min=b.min,c.Cc.max=b.max):c.Cc=null}function ea(a,b){var c=a.k;b?(c.Dc=c.Dc||{},c.Dc.min=b.min,c.Dc.max=b.max):c.Dc=null}function I(b){var c=b.k;if(xa.xa(b))for(var e=b.I,d=0;d<e.length;d++){var k=e[d].da;if(k[0].type===a.Be){switch(c.ub){case a.Kb:var f=ia.F(c.n),f=ma.dist(f,c.pivot),f=f/c.qk*c.rk;break;case a.cd:f=ia.F(c.n);f=ma.distance(f,c.Vb);f=f/c.qk*c.rk;break;default:f=k[0].top}for(var h=0;h<k.length;h++){var n=k[h];n.top=
f;V(n,n.Ab)}O(b,e[d])}}}function F(b){var c=b.k,e=c.ub;if(e===a.Kb||e===a.od){if(c.lb){var d=c.lb.left,k=c.lb.right,f=t(b,qa);(f=e==a.Kb?J.Pl(f[0],d,k):J.Pl(f[0],k,d))&&(e==a.Kb?M(b,f,0):T(b,f,0))}c.ka&&(d=c.ka.down,k=c.ka.up,f=t(b,qa),(f=e==a.Kb?J.Pl(f[1],k,d):J.Pl(f[1],d,k))&&(e==a.Kb?M(b,0,f):T(b,0,f)));if(e===a.Kb&&c.sb){var f=b.k,d=ia.F(f.n),k=ma.subtract(d,f.pivot,Ia),h=ma.length(k);h>f.sb.max?(ma.scale(k,f.sb.max/h,k),ma.add(f.pivot,k,d)):h<f.sb.min&&(h=ia.P(f.n),h=J.mc(h,J.Nc,Ca),ma.scale(h,
100*f.sb.min,h),ma.add(k,h,k),ma.scale(k,-f.sb.min/ma.length(k),k),ma.add(f.pivot,k,d))}}e===a.Kb&&c.ge&&(c=b.k,f=c.pivot[2],d=J.V(c.pivot[2],c.ge.min_z,c.ge.max_z),d!=f&&(f=ma.set(0,0,d-f,Ia),ma.add(c.pivot,f,c.pivot),c=ia.F(c.n),ma.add(c,f,c)));e===a.cd&&(e=b.k,e.Cc&&(f=J.V(e.Vb[0],e.Cc.min,e.Cc.max)-e.Vb[0],e.Vb[0]+=f,c=ia.F(e.n),c[0]+=f),e.Dc&&(f=J.V(e.Vb[1],e.Dc.min,e.Dc.max)-e.Vb[1],e.Vb[1]+=f,c=ia.F(e.n),c[1]+=f),e=b.k,c=t(b,qa)[1],(e=J.Pl(c,e.ka.up,e.ka.down))&&X(b,0,e))}function T(a,b,c,
e,d){var f=a.k,k=b,h=c;if(e||d)a=t(a,ta),e&&(k=b-a[0]),d&&(h=c-a[1]);if(k||h)b=Y.identity(la),k&&(k=Y.setAxisAngle(f.vf,k,Da),Y.multiply(b,k,b)),f=ia.P(f.n),h&&(k=J.mc(f,J.Gg,Ia),h=Y.setAxisAngle(k,h,Da),Y.normalize(h,h),Y.multiply(b,h,b)),Y.multiply(b,f,f)}function M(a,b,c,e,d){var f=a.k,k=b,h=c;if(e||d){var n=t(a,ta);e&&(k=b-n[0]);d&&(h=c-n[1])}H(a,a.k.pivot,k,h);a=t(a,ta);a=J.Ng(a[1],-Math.PI,Math.PI);f.el=Math.abs(a)>Math.PI/2}function X(a,b,c,e,d){var f=a.k,k=b,h=c;if(e||d){var n=t(a,ta);e&&
(k=b-n[0]);d&&(h=c-n[1])}f.Vh||(k=0);H(a,f.Vb,k,h);h&&fa(a)}function H(a,b,c,e){var d=a.k;if(c||e){a=Y.identity(la);c&&(c=Y.setAxisAngle(J.nc,c,Da),Y.multiply(a,c,a));c=ia.P(d.n);if(e){var f=J.mc(c,J.Gg,Ia);e=Y.setAxisAngle(f,e,Da);Y.normalize(e,e);Y.multiply(a,e,a)}e=ia.F(d.n);J.aZ(e,b,a,e);Y.multiply(a,c,c)}}function fa(a){var b=a.k,c=t(a,qa)[1],e=a.k;a=e.ka;e=e.sb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(e.max-e.min)+e.min;a=ia.F(b.n);e=ia.P(b.n);e=J.mc(e,J.Nc,Ia);ma.normalize(e,
e);ma.scale(e,c,e);ma.subtract(b.Vb,e,a)}function V(b,c,e){switch(b.type){case a.Sd:c||J.q("No aspect ratio"),b.Ab=c;case a.Kh:ca.perspective(J.Cb(b.Zd),b.Ab,b.near,b.far,b.xb);break;case a.Be:c||J.q("No aspect ratio"),b.Ab=c;case a.Jh:c=b.top*b.Ab;ca.ortho(-c,c,-b.top,b.top,b.near,b.far,b.xb);break;case a.Gi:ca.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb);break;case a.Qc:case a.ed:c||J.q("No aspect ratio");b.Ab=c;var d=Math.tan(b.Zd*Math.PI/360);c=b.near*d;var f=b.Ab*b.al*d;b.type==a.Qc?
(d=f-b.sf/2,f+=b.sf/2):(d=f+b.sf/2,f-=b.sf/2);d=-(b.near/b.al*d);f*=b.near/b.al;ca.frustum(d,f,-c,c,b.near,b.far,b.xb);b.left=d;b.right=f;break;case a.Ve:case a.We:if(ua.Da())if(d=ua.A(),(d=ua.La(d,sa.Fi))&&d.enable_hmd_stereo){c=Math.tan(J.Cb(b.kd[0]));var d=Math.tan(J.Cb(b.kd[1])),f=Math.tan(J.Cb(b.kd[2])),k=Math.tan(J.Cb(b.kd[3]));b.top=b.near*c;b.right=b.near*d;b.bottom=-b.near*f;b.left=-b.near*k;ca.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb)}else c||(c=b.Ab),ca.perspective(J.Cb(b.Zd),
c,b.near,b.far,b.xb);break;case a.qd:return;default:J.q("Wrong camera type: "+b.type)}e||(W(b),P(b))}function P(a){ca.copy(a.Ob,a.Bg);a.Bg[12]=0;a.Bg[13]=0;a.Bg[14]=0;a.Bg[15]=1;ca.multiply(a.xb,a.Bg,a.Bg);ca.invert(a.Bg,a.Bg)}function W(a){ca.copy(a.Ob,a.md);ca.multiply(a.xb,a.md,a.md);ca.invert(a.md,a.py)}function ha(b,c,e,d,f){d||(d=new Float32Array(24));c||(c=b.near);e||(e=b.far);var k,h,n,p,q,g,v,m;switch(b.type){case a.qd:J.q("Extraction from NONE camera is not possible");break;case a.Sd:case a.Kh:k=
c*Math.tan(b.Zd*Math.PI/360);p=-k;h=k*b.Ab;n=-h;q=e/c*k;m=-q;g=q*b.Ab;v=-g;break;case a.Be:case a.Jh:n=b.top*b.Ab;k=q=b.top;h=g=n;p=m=-b.top;n=v=-n;break;case a.Gi:k=q=b.top;h=g=b.right;p=m=b.bottom;n=v=b.left;break;case a.Qc:case a.ed:q=c/b.near;k=c*Math.tan(b.Zd*Math.PI/360);p=-k;h=b.right*q;n=b.left*q;v=e/c;q=k*v;m=-q;g=h*v;v*=n;break;case a.Ve:case a.We:q=c/b.near;k=b.top*q;p=b.bottom*q;h=b.right*q;n=b.left*q;v=e/c;q=k*v;m=p*v;g=h*v;v*=n;break;default:J.q("Wrong camera type: "+b.type)}d[0]=n;
d[1]=p;d[2]=-c;d[3]=h;d[4]=p;d[5]=-c;d[6]=h;d[7]=k;d[8]=-c;d[9]=n;d[10]=k;d[11]=-c;d[12]=v;d[13]=m;d[14]=-e;d[15]=v;d[16]=q;d[17]=-e;d[18]=g;d[19]=q;d[20]=-e;d[21]=g;d[22]=m;d[23]=-e;f&&(c=Fa,ca.invert(b.Ob,c),J.Po(d,c,d,0));return d}function v(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Th){var e=b.csm_num;a.Th=Array(e);for(var d=0;d<e;d++)a.Th[d]=new Float32Array(3);a.kr=new Float32Array(e)}for(e=0;e<c;e++){var d=0==e?a.near:aa(b,a,e-1),f=aa(b,a,e),d=ha(a,d,f,Na),d=ya.UV(d);a.Th[e].set(d.G);a.kr[e]=
d.Xa;a.cv[e]=ma.length(d.G);a.Mo[e]=Z(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,e)}}else a.Mo[0]=b.first_cascade_blur_radius}function aa(a,b,c){var e=a.csm_num,d=J.V(a.csm_first_cascade_border,b.near,b.far);a=J.V(a.csm_last_cascade_border,b.near,b.far);return J.V(Z(d,a,e,c),b.near,b.far)}function Z(a,b,c,e){switch(e){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,e/(c-1))}return a}function ba(a,b){b||(b=new Float32Array(3));var c=ia.F(a.k.n);ma.copy(c,b);return b}var ya=
g("__boundings");g("__config");var na=g("__constraints"),R=g("__container"),ca=g("__mat4"),ra=g("__math"),xa=g("__obj_util"),oa=g("__print"),Y=g("__quat"),ua=g("__scenes"),sa=g("__subscene"),N=g("__transform"),ia=g("__tsr"),J=g("__util"),ma=g("__vec3"),pa=g("__vec4");a.qd=10;a.Sd=20;a.Be=30;a.Kh=40;a.Jh=50;a.Gi=60;a.Qc=70;a.ed=80;a.Ve=90;a.We=100;a.Jg=0;a.Kb=2;a.od=3;a.cd=4;var ja=J.Cb(.5),qa=new Float32Array(2),ta=new Float32Array(2),Ia=new Float32Array(3),Ca=new Float32Array(3),Aa=new Float32Array(3),
la=new Float32Array(4),Da=new Float32Array(4),za=new Float32Array(4),Sa=new Float32Array(4),Fa=new Float32Array(16),Na=new Float32Array(24),S=new Float32Array(6);a.nS=function(c,e){var f=e.k,k=c.data;switch(k.type){case "PERSP":var n=q(a.Sd);if(k.angle_y)var p=J.se(k.angle_y);z(n,p,k.clip_start,k.clip_end);break;case "ORTHO":n=q(a.Be),z(n,k.ortho_scale/2,k.clip_start,k.clip_end)}n.name=e.name;p=e.I;p[0].da.push(n);for(var g=1;g<p.length;g++){var v=h(n,!1);p[g].da.push(v)}f.ub=m(k.b4w_move_style);
f.dof_distance=k.dof_distance;n=k.dof_object;f.dof_object=n?n.nb:null;f.dof_front_start=k.b4w_dof_front_start;f.dof_front_end=k.b4w_dof_front_end;f.dof_rear_start=k.b4w_dof_rear_start;f.dof_rear_end=k.b4w_dof_rear_end;f.dof_power=k.b4w_dof_power;f.dof_bokeh=k.b4w_dof_bokeh;f.dof_bokeh_intensity=k.b4w_dof_bokeh_intensity;f.Ed=k.b4w_dof_foreground_blur;f.pl=k.b4w_trans_velocity;f.ol=k.b4w_rot_velocity;f.ql=k.b4w_zoom_velocity;n=e.k.ub;p=c.data;g=null;n!=a.Kb&&n!=a.od||!p.b4w_use_horizontal_clamping||
(g={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},n==a.od&&(g.left*=-1,g.right*=-1));n=g;p=e.k.ub;g=c.data;v=null;p!=a.Kb&&p!=a.od||!g.b4w_use_vertical_clamping?p==a.cd&&g.b4w_use_zooming&&(g.b4w_hover_angle_min<=g.b4w_hover_angle_max?(v={down:g.b4w_hover_angle_min,up:g.b4w_hover_angle_max},v.down*=-1,v.up*=-1):oa.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(v={down:g.b4w_rotation_down_limit,up:g.b4w_rotation_up_limit,
camera_space:"LOCAL"==g.b4w_vertical_clamping_type},p==a.Kb&&(v.down*=-1,v.up*=-1));var p=v,g=e.k.ub,v=c.data,w=null;g==a.Kb&&v.b4w_use_target_distance_limits&&v.b4w_distance_min<=v.b4w_distance_max?w={min:v.b4w_distance_min,max:v.b4w_distance_max}:g===a.cd&&v.b4w_use_zooming&&(v.b4w_distance_min<=v.b4w_distance_max?w={min:v.b4w_distance_min,max:v.b4w_distance_max}:oa.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));g=w;v=c.data;w=null;e.k.ub==a.cd&&v.b4w_use_horizontal_clamping&&
v.b4w_horizontal_translation_min<=v.b4w_horizontal_translation_max&&(w={min:v.b4w_horizontal_translation_min,max:v.b4w_horizontal_translation_max});var v=w,w=c.data,t=null;e.k.ub==a.cd&&w.b4w_use_vertical_clamping&&w.b4w_vertical_translation_min<=w.b4w_vertical_translation_max&&(t={min:w.b4w_vertical_translation_min,max:w.b4w_vertical_translation_max});var w=t,t=c.data,H=null;e.k.ub==a.Kb&&t.b4w_use_pivot_limits&&(H={min_z:t.b4w_pivot_z_min,max_z:t.b4w_pivot_z_max});t=H;switch(f.ub){case a.od:f=ia.F(e.k.n);
l(e,f,null,n,p);break;case a.Kb:f=ia.F(e.k.n);d(e,f,k.b4w_target,n,p,g,t,k.b4w_use_panning);break;case a.cd:f=ia.F(e.k.n),n=y(e,c.data.b4w_hover_zero_level,Ca),b(e,f,n,g,p,v,w,k.b4w_enable_hover_hor_rotation)}F(e);r(e)};a.TZ=l;a.JM=d;a.IM=b;a.uo=r;a.Ic=h;a.lT=u;a.r8=m;a.hd=q;a.O3=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.wc);case "DEPTH":return Boolean(a.af);case "SCREEN":return!Boolean(a.wc)&&!Boolean(a.af);default:J.q("Wrong attachment type: "+b)}};a.vx=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.wc=
c;break;case "DEPTH":a.af=c;break;case "SCREEN":a.wc=null;a.af=null;break;default:J.q("Wrong attachment type: "+b)}};a.E5=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.wc;case "DEPTH":return a.af;case "SCREEN":return null;default:J.q("Wrong attachment type: "+b)}};a.Cw=function(b,c){(b.type!=a.Sd||c!=a.Qc&&c!=a.ed&&c!=a.Ve&&c!=a.We)&&J.q("make_stereo(): wrong camera type");b.type=c;f(b,6,.065)};a.JZ=f;a.sm=t;a.IB=c;a.lk=function(a,b){t(a,b);b[0]=J.Hi(b[0]+Math.PI);b[1]*=-1;return b};
a.xx=z;a.vZ=function(b,c,e,d,f,k,h){switch(b.type){case a.Gi:b.left=c;b.right=e;b.bottom=d;b.top=f;b.near=k;b.far=h;break;default:oa.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.um=function(a){return a.k.ub};a.PZ=L;a.c$=D;a.WD=function(a,b,c){var e=Ia;e[0]=0;e[1]=0;e[2]=-1;ma.transformQuat(e,c,e);e[0]+=b[0];e[1]+=b[1];e[2]+=b[2];var d=Ca;d[0]=0;d[1]=1;d[2]=0;ma.transformQuat(d,c,d);D(a,b,e,d)};a.PD=G;a.CZ=B;a.j0=O;a.i0=function(b){var c=b.k;F(b);I(b);switch(c.ub){case a.Kb:var e=
ia.F(c.n),d=ia.P(c.n);na.bZ(e,d,c.pivot);for(d=0;d<b.I.length;d++)for(var k=b.I[d].da,h=0;h<k.length;h++){var n=k[h];n.type!=a.Qc&&n.type!=a.ed||f(n,ma.dist(e,c.pivot),n.sf)}na.ak(b,c.vf);break;case a.od:b.pc||na.ak(b,c.vf)}K(b)};a.LE=K;a.sM=C;a.EM=Q;a.ew=k;a.dw=x;a.qZ=e;a.GZ=w;a.wZ=n;a.OZ=ea;a.t0=I;a.Ts=T;a.px=M;a.Us=X;a.U7=function(b){switch(b.type){case a.Sd:case a.Be:case a.Qc:case a.ed:return!0;default:return!1}};a.UI=function(b){switch(b.type){case a.Sd:case a.Kh:case a.Qc:case a.ed:return J.Cb(b.Zd);
default:return oa.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.Wk=V;a.kZ=function(b,c,e,d,k){var f=1/Math.max(k,d);switch(b.type){case a.Sd:case a.Kh:k/=2;d/=2;e=-(e-k)/k*Math.tan(J.Cb(b.Zd)/2);c=(c-d)/d*Math.tan(J.Cb(b.Zd)/2)*b.Ab;d=b.near*(e+f);k=b.near*(c+f);e=b.near*(e-f);c=b.near*(c-f);ca.frustum(c,k,e,d,b.near,b.far,b.xb);break;case a.Be:case a.Jh:b.right=b.top*b.Ab;e=-e/k;c/=d;d=b.top+(e+f)*(b.top+b.top);k=-b.right+(c+f)*(b.right+b.right);e=b.top+(e-f)*(b.top+b.top);
c=-b.right+(c-f)*(b.right+b.right);ca.ortho(c,k,e,d,b.near,b.far,b.xb);break;case a.Gi:e=-e/k,c/=d,d=b.top+(e+f)*(b.top-b.bottom),k=b.left+(c+f)*(b.right-b.left),e=b.top+(e-f)*(b.top-b.bottom),c=b.left+(c-f)*(b.right-b.left),ca.ortho(c,k,e,d,b.near,b.far,b.xb)}ca.copy(b.Ob,b.md);ca.multiply(b.xb,b.md,b.md);J.fo(b.md,b.Xh)};a.qA=P;a.eH=W;a.QU=ha;a.AR=function(a){a=a.k;var b=ya.Ud();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.S=b;var c=ya.nA(1,J.Jf([0,0,0]));a.wa=c;a.yq=ya.NG(1,
b);a.Aq=ya.PG(1,b);a.zq=ya.OG(1,b)};a.Gm=function(b){return xa.xa(b)&&b.k&&b.k.ub==a.Jg};a.Aa=function(b){return xa.xa(b)&&b.k&&b.k.ub==a.Kb};a.jc=function(b){return xa.xa(b)&&b.k&&b.k.ub==a.od};a.Za=function(b){return xa.xa(b)&&b.k&&b.k.ub==a.cd};a.qw=function(b){return xa.xa(b)&&b.k&&b.I[0].da[0].type==a.Be};a.KE=v;a.fU=aa;a.mD=function(b,c,e){b=b.I[0].da[0];switch(b.type){case a.Sd:case a.Kh:case a.Be:case a.Jh:case a.Qc:case a.ed:case a.Ve:case a.We:var d=za;d.set(c);d[3]=1;pa.transformMat4(d,
b.md,d);c=-d[1]/d[3];e[0]=(d[0]/d[3]+1)/2*b.width;e[1]=(c+1)/2*b.height;R.U0(e[0],e[1],e,b);2<e.length&&(e[2]=(d[2]/Math.abs(d[3])+1)/2);return e;default:return oa.error("Non-compatible camera"),e}};a.NV=function(a){return a.I[0].da[0]};a.no=function(b,c){switch(b.type){case a.Sd:case a.Kh:case a.Qc:case a.ed:var e=Math.tan(J.Cb(b.Zd)/2);switch(c){case "LEFT":return-e*b.Ab;case "RIGHT":return e*b.Ab;case "TOP":return e;case "BOTTOM":return-e}break;case a.Be:case a.Jh:switch(c){case "LEFT":return-b.top*
b.Ab;case "RIGHT":return b.top*b.Ab;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.Gi:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Ve:case a.We:switch(c){case "LEFT":return-Math.tan(J.Cb(Math.min(b.kd[1],b.kd[3])));case "RIGHT":return Math.tan(J.Cb(Math.min(b.kd[1],b.kd[3])));case "TOP":return Math.tan(J.Cb(Math.min(b.kd[0],b.kd[2])));case "BOTTOM":return-Math.tan(J.Cb(Math.min(b.kd[0],b.kd[2])))}break;
default:J.q("Unknown camera type")}};a.VW=function(b){switch(b.type){case a.Be:case a.Jh:case a.Gi:return!0;default:return!1}};a.SV=function(b,c){switch(b.type){case a.Sd:case a.Kh:case a.Qc:case a.ed:var e=J.Cb(b.Zd);return c?e*b.Ab:e;default:return 0}};a.at=function(a,b,c){a=a.k;ia.ue(b,a.n);ma.copy(c,a.pivot)};a.zx=function(a,b){var c=a.k,e=ma.subtract(b,c.Vb,Ia),d=ia.F(c.n),e=ma.add(e,d,e);N.Xc(a,e);ma.copy(b,c.Vb)};a.KZ=function(a,b){var c=a.k,e=ma.subtract(b,c.pivot,Ia),d=ia.F(c.n),e=ma.add(e,
d,e);N.Xc(a,e);ma.copy(b,c.pivot)};a.jJ=ba;a.QD=function(c,e){c.k.ub=e;c.k.lb=null;c.k.ka=null;c.k.sb=null;c.k.Cc=null;c.k.Dc=null;r(c);switch(e){case a.cd:var d=ia.F(c.k.n),k=y(c,0,Ca);b(c,d,k,null,null,null,null,c.k.Vh);break;case a.Kb:d=ba(c,Ia),k=ia.P(c.k.n),k=J.mc(k,J.Nc,Ca),k=ma.scaleAndAdd(d,k,10,k),ma.copy(k,c.k.pivot)}};a.Ft=function(a){a=a.k;a.ub=0;ma.set(0,0,0,a.pivot);ma.set(0,0,0,a.Vb);a.el=!1;a.use_panning=!1;a.lb=null;a.ka=null;a.sb=null;a.Cc=null;a.Dc=null;a.ge=null;a.Vh=!0};a.KD=
function(a,b){for(var c=0;c<a.length;c++){var e=a[c];70!=e.type&&80!=e.type&&90!=e.type&&100!=e.type||f(e,e.al,b)}};a.OD=function(a,b,c){var e=ua.A();a=xa.ja(a,e).da;for(e=0;e<a.length;e++){var d=a[e];if(90==d.type||100==d.type)90==d.type&&pa.copy(b,d.kd),100==d.type&&pa.copy(c,d.kd),d.rc||V(d),W(d),P(d)}}};b4w.module.__constraints=function(a,g){function l(a){var b={};b.type=a;return b}function d(a,c){a.pc&&a.pc.Fa&&b(a.pc.Fa,a);if(c.Fa){var d=c.Fa;-1==d.Ze.indexOf(a)?d.Ze.push(a):z.q("Descendant object override is forbidden")}a.pc=c}function b(a,b){var c=a.Ze.indexOf(b);-1!=c?a.Ze.splice(c,1):z.q("No descendant object")}function y(a,b,d){switch(b.type){case 1:var f=c.P(a.k.n),g=b.Fa.k.n;d=c.P(b.Fa.k.n);b.te?(t.copy(b.te,f),t.multiply(d,f,f)):t.copy(d,f);var l=c.Gc(b.offset,g,B);c.ue(l,a.k.n);l=c.td(b.Fa.k.n);
c.Le(b.Vs*l,a.k.n);break;case 9:l=c.F(a.k.n);f=c.P(a.k.n);g=b.Fa.k.n;d=c.P(b.Fa.k.n);t.multiply(t.invert(b.Vm,b.Vm),f,f);t.multiply(d,f,f);c.Gc(b.offset,g,l);t.copy(d,b.Vm);break;case 10:l=c.F(a.k.n);f=c.P(a.k.n);g=b.Fa.k.n;d=c.P(b.Fa.k.n);t.multiply(t.invert(b.Vm,b.Vm),f,f);t.multiply(d,f,f);c.Gc(b.offset,g,l);t.copy(d,b.Vm);l=c.P(a.k.n);f=c.P(b.Fa.k.n);f=t.multiply(f,b.te,C);f=m.IB(f,D);l=m.IB(l,G);m.Ts(a,z.Pl(l[0],f[0]+b.NS,f[0]+b.MS),z.Pl(l[1],f[1]+b.LS,f[1]+b.OS));break;case 13:var l=c.F(a.k.n),
f=c.P(a.k.n),g=b.Fa.k.n,r=c.F(g),E=b.d_,y=B,H=C;c.Gc(b.offset,g,y);z.Sx(y,l,d,E,l);g=B;L.sub(r,l,g);L.normalize(g,g);var fa=f,l=Q,r=l.subarray(0,3),y=l.subarray(3,6),V=l.subarray(6,9);L.copy(g,V);L.negate(V,V);L.normalize(V,V);Boolean(.999999<Math.abs(L.dot(g,z.nc)))?(g=q.fromQuat(t.normalize(fa,H),k),L.copy(g.subarray(0,3),r)):L.cross(z.nc,V,r);L.normalize(r,r);L.cross(V,r,y);L.normalize(y,y);t.fromMat3(l,H);t.normalize(H,H);z.YM(H,f,d,.16*E,f);break;case 2:f=c.P(a.k.n);d=p;u.Ev(b.Fa,b.Nl,!0,d);
c.multiply(b.Fa.k.n,d,d);f[0]=d[4];f[1]=d[5];f[2]=d[6];f[3]=d[7];b.te&&(t.copy(b.te,f),t.multiply(f,b.te,f));c.Le(b.Vs*d[3],a.k.n);l=c.F(a.k.n);c.Gc(b.offset,d,l);break;case 3:l=c.F(a.k.n);f=c.P(a.k.n);d=c.F(b.Fa.k.n);A(l,f,d);break;case 4:l=c.F(a.k.n);f=c.P(a.k.n);d=b.target;A(l,f,d);break;case 5:l=c.F(a.k.n);f=c.P(a.k.n);d=c.F(b.Fa.k.n);A(l,f,d);f=L.dist(l,d);if(f=f>b.Zg?f-b.Zg:f<b.rr?f-b.rr:0)L.sub(d,l,B),L.normalize(B,B),L.scale(B,f,B),L.add(l,B,l);break;case 6:l=c.F(a.k.n);f=c.P(a.k.n);d=b.target;
A(l,f,d);f=L.dist(l,d);if(f=f>b.Zg?f-b.Zg:f<b.rr?f-b.rr:0)L.sub(d,l,B),L.normalize(B,B),L.scale(B,f,B),L.add(l,B,l);break;case 7:g=b.Fa.k.n;l=c.F(a.k.n);c.Gc(b.offset,g,l);break;case 8:r=c.F(b.Fa.k.n);l=c.F(a.k.n);L.add(r,b.offset,l);break;case 14:f=c.P(a.k.n);g=b.Fa.k.n;d=c.P(b.Fa.k.n);b.te?(t.copy(b.te,f),t.multiply(d,f,f)):t.copy(d,f);l=c.F(a.k.n);c.Gc(b.offset,g,l);break;case 11:c.multiply(b.Fa.k.n,b.fy,a.k.n);break;case 12:l=b.fy;d=p;u.Ev(b.Fa,b.Nl,!0,d);c.multiply(b.Fa.k.n,d,d);c.multiply(d,
l,a.k.n);break;case 15:f=b.Fa,d=m.NV(f),l=c.F(a.k.n),g=m.no(d,"LEFT"),r=m.no(d,"RIGHT"),E=m.no(d,"TOP"),H=m.no(d,"BOTTOM"),y="heights"==b.hor_units?E-H:r-g,b.GK?(g=m.no(d,"LEFT"),l[0]=g+y*b.uC):(r=m.no(d,"RIGHT"),l[0]=r-y*b.uC),g="heights"==b.vert_units?E-H:r-g,l[1]=b.EN?E-g*b.wE:H+g*b.wE,m.VW(d)?l[2]=-b.distance:(l[2]=-1,L.normalize(l,l),L.scale(l,b.distance/Math.abs(l[2]),l)),c.Yc(l,f.k.n,l),d=c.F(f.k.n),L.add(d,l,l),l=c.P(a.k.n),f=c.P(f.k.n),b.te?(t.copy(b.te,l),t.multiply(f,l,l)):t.copy(f,l)}"CAMERA"==
a.k.type&&(l=a.k.vf,10==b.type&&(d=c.P(b.Fa.k.n),l=L.transformQuat(l,d,x)),m.LE(a),h(a,l))}function r(a,b){switch(b.type){case 1:var d=b.target.k.n,f=p;c.invert(a.k.n,f);c.multiply(f,d,f);u.jZ(a,b.Nl,f)}a.TC=!0}function A(a,b,c){var d=B;z.mc(b,z.Nc,d);L.normalize(d,d);var f=O;L.subtract(c,a,f);L.normalize(f,f);a=z.GD(d,f,E);t.multiply(a,b,b);t.normalize(b,b)}function h(a,b,d){var f=a.k,k=c.P(f.n),h=z.mc(k,z.nc,B);L.normalize(h,h);if(.999999<Math.abs(L.dot(b,h)))h=t.identity(C);else{var p=L.cross(b,
h,O);L.normalize(p,p);f.ub==m.Kb?f.el&&L.negate(p,p):(f=z.mc(k,z.Te,K),0<L.dot(f,b)&&L.negate(p,p));f=z.mc(k,z.Gg,K);L.normalize(f,f);var q=z.V(L.dot(f,p),-1,1),h=-.999999>=q?t.setAxisAngle(h,Math.acos(q),C):t.rotationTo(f,p,C);t.normalize(h,h)}t.multiply(h,k,k);d&&(d=z.mc(k,z.Bi,B),0>L.dot(b,d)&&t.rotateZ(k,Math.PI,k));m.LE(a)}var u=g("__armature"),m=g("__camera"),q=g("__mat3"),f=g("__print"),t=g("__quat"),c=g("__tsr"),z=g("__util"),L=g("__vec3");a.t1=1;a.s1=2;a.y1=3;a.z1=4;a.n1=5;a.o1=6;a.u1=7;
a.m1=8;a.r1=9;a.q1=10;a.k1=11;a.l1=12;a.p1=13;a.w1=14;a.x1=15;a.j1=1;var D=new Float32Array(2),G=new Float32Array(2),B=new Float32Array(3),O=new Float32Array(3),K=new Float32Array(3),E=new Float32Array(4),C=new Float32Array(4),Q=new Float32Array(9),k=new Float32Array(9),p=c.create(),x=new Float32Array(3);a.vG=function(a,b,c,f,k){var h=l(1);h.Fa=b;h.offset=new Float32Array(c);h.te=f?new Float32Array(f):null;h.Vs=k;d(a,h);y(a,h,0)};a.kR=function(a,b,c,f,k){var h=l(2);h.Fa=b;h.Nl=c;h.offset=new Float32Array(f);
h.te=null;h.Vs=k;d(a,h);y(a,h,0)};a.iR=function(a,b,f,k){var h=l(9),p=c.P(a.k.n),q=c.P(b.k.n);h.Fa=b;h.offset=new Float32Array(f);h.Vm=new Float32Array(q);k&&(t.copy(k,p),t.multiply(q,p,p));d(a,h);y(a,h,0)};a.hR=function(a,b,f,k,h,p,q,g){var m=l(10),H=c.P(a.k.n),x=c.P(b.k.n);m.Fa=b;m.offset=new Float32Array(f);m.Vm=new Float32Array(x);m.MS=z.Hi(h);m.NS=z.Hi(p);m.OS=z.Ng(q,-Math.PI,Math.PI);m.LS=z.Ng(g,-Math.PI,Math.PI);k?(m.te=new Float32Array(k),t.copy(k,H),t.multiply(x,H,H)):m.te=t.create();d(a,
m);y(a,m,0)};a.gR=function(a,b,c,f){var k=l(13);k.Fa=b;k.offset=new Float32Array(c);k.d_=f;d(a,k);y(a,k,0)};a.nR=function(a,b,c,f){var k=l(14);k.Fa=b;k.offset=new Float32Array(c);k.Vs=1;k.te=f?new Float32Array(f):null;d(a,k);y(a,k,0)};a.X8=b;a.pR=function(a,b){var c=l(3);c.Fa=b;d(a,c);y(a,c,0)};a.qR=function(a,b){var c=l(4);c.target=new Float32Array(b);d(a,c);y(a,c,0)};a.bR=function(a,b,c,f){var k=l(5);k.Fa=b;k.rr=c;k.Zg=f;d(a,k);y(a,k,0)};a.cR=function(a,b,c,f){var k=l(6);k.target=new Float32Array(b);
k.rr=c;k.Zg=f;d(a,k);y(a,k,0)};a.mR=function(a,b,c){var f=l(7);f.Fa=b;f.offset=new Float32Array(c);d(a,f);y(a,f,0)};a.$Q=function(a,b){var c=l(8);c.Fa=b;c.offset=new Float32Array([0,0,0]);d(a,c);y(a,c,0)};a.YQ=function(a,b,c){var f=l(11);f.Fa=b;f.fy=new Float32Array(c);d(a,f);y(a,f,0)};a.ZQ=function(a,b,c,f){var k=l(12);k.Fa=b;k.Nl=c;k.fy=new Float32Array(f);d(a,k);y(a,k,0)};a.Zz=function(a,b,c){var k=l(15);k.Fa=b;if(z.ci(c.left))k.GK=!0,k.uC=c.left;else if(z.ci(c.right))k.GK=!1,k.uC=c.right;else{f.error("append_stiff_viewport: Wrong positioning params");
return}if(z.ci(c.top))k.EN=!0,k.wE=c.top;else if(z.ci(c.bottom))k.EN=!1,k.wE=c.bottom;else{f.error("append_stiff_viewport: Wrong positioning params");return}z.ci(c.distance)?(k.distance=c.distance,k.te=z.ci(c.rotation)?new Float32Array(c.rotation):null,k.hor_units=z.ci(c.hor_units)?c.hor_units:"widths",k.vert_units=z.ci(c.vert_units)?c.vert_units:"heights",d(a,k),y(a,k,0)):f.error("append_stiff_viewport: Wrong positioning params")};a.k0=function(a,b){a.pc&&y(a,a.pc,b)};a.lR=function(a,b,c,d,f){var k=
l(1);k.Nl=c;k.target=b;k.offset=new Float32Array(d);k.te=f?new Float32Array(f):null;k.Vs=1;b=k.target;c=k.Nl;d=a.k.Pg[c];f=b.GA;for(var h=0;h<f;h++){var p=f[h];if(p[0]==a&&p[1]==c){f.splice(h,1);break}}b.GA.push([a,c]);d.pc=k;r(a,k)};a.c0=function(a,b){var c=a.k.Pg[b];c.pc&&r(a,c.pc)};a.bZ=A;a.ak=h;a.AS=function(a){return a.pc?!0:!1};a.remove=function(a){a.pc.Fa&&b(a.pc.Fa,a);a.pc=null};a.a7=function(a){return a.pc?a.pc.type:null};a.mg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?!1:!0};a.Fv=
function(a){if((a=a.pc)&&11==a.type)return a.Fa.k.n;if(a&&12==a.type){var b=p;u.Ev(a.Fa,a.Nl,!0,b);c.multiply(a.Fa.k.n,b,b);return b}return null};a.lg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?null:a.fy}};b4w.module.__armature=function(a,g){function l(a){a=a.k;for(var b=a.fp,d=a.Fw,f=0;f<b.length;f++){for(var h=b[f],q=d[f],g=0;g<q.length;g+=2)for(var m=q[g],t=q[g+1],l=0;4>l;l++)h.re[m+l]=a.re[t+l],h.Ke[m+l]=a.Ke[t+l],h.xe[m+l]=a.xe[t+l],h.Oe[m+l]=a.Oe[t+l];h.ef=a.ef}}function d(a,b,f,h){var q=a.MN,g=a.il,t=a.ey,l=a.oL;l?(l=l.ey,b?y.multiply(l,q,t):(b=m,y.invert(l,b),y.multiply(b,t,q))):b?y.copy(q,t):y.copy(t,q);q=u;y.invert(g,q);y.multiply(t,q,q);g=a.Uj;f[4*g]=q[0];f[4*g+1]=q[1];f[4*g+2]=q[2];f[4*
g+3]=q[3];h[4*g]=q[4];h[4*g+1]=q[5];h[4*g+2]=q[6];h[4*g+3]=q[7];a=a.nI;for(g=0;g<a.length;g++)t=a[g],t.pc||d(t,!0,f,h)}var b=g("__util"),y=g("__tsr"),r=g("__quat"),A=g("__mat4"),h=g("__vec3"),u=y.create(),m=y.create(),q=new Float32Array(4),f=new Float32Array(4),t=new Float32Array(4);a.ll=function(a,d){for(var f=a.data.bones,q=a.pose.bones,g={},m=0;m<q.length;m++){var t=q[m],l=t.bone,r=l.name,C=g[r]={Uj:0,nO:-1,oL:null,nI:[],Ou:[],pc:null,IE:y.create(),MN:y.create(),il:y.create(),ey:y.create(),cy:y.create(),
JE:y.create(),dy:!1,tN:new Float32Array(3)},r=new Float32Array(l.matrix_local),Q=new Float32Array(16);A.invert(r,Q);var t=new Float32Array(t.matrix_basis),k=C.tN;h.subtract(b.Jf(l.tail_local),b.Jf(l.head_local),k);b.P0(k,Q,k);y.fh(r,C.il);y.fh(t,C.cy);y.copy(C.il,C.ey)}for(m=0;m<f.length;m++){r=f[m].name;t=b.Gd("name",r,q);C=g[r];l=t.parent_recursive;C.Ou.push(C);for(Q=0;Q<l.length;Q++)t=l[Q],t=t.name,t=g[t],C.Ou.push(t);l.length?(t=l[0],t=t.name,t=g[t],C.oL=t,y.invert(t.il,u),y.multiply(u,C.il,C.IE),
t.nI.push(C)):y.copy(C.il,C.IE);C.Uj=m;C.name=r;y.multiply(C.IE,C.cy,C.MN)}d.k.Pg=g};a.Ev=function(a,b,d,h){var g=a.k,l=g.ef;b=g.Pg[b];var O=b.Uj;a=b.il;var K=g.xe,E=g.Oe,C=g.re,g=g.Ke,Q=K[4*O+1],k=K[4*O+2],p=K[4*O+3],x=E[4*O+1],e=E[4*O+2],w=E[4*O+3];q[0]=(1-l)*K[4*O]+l*E[4*O];q[1]=(1-l)*Q+l*x;q[2]=(1-l)*k+l*e;q[3]=(1-l)*p+l*w;f[0]=C[4*O];f[1]=C[4*O+1];f[2]=C[4*O+2];f[3]=C[4*O+3];t[0]=g[4*O];t[1]=g[4*O+1];t[2]=g[4*O+2];t[3]=g[4*O+3];r.slerp(f,t,l,f);l=u;y.UD(q,l);y.oi(f,l);d?(d=m,y.translate(a,b.tN,
d),y.multiply(l,d,l)):y.multiply(l,a,l);y.copy(l,h)};a.jZ=function(a,b,f){var h=a.k;b=h.Pg[b];var q=h.xe,g=h.re;y.copy(f,b.ey);d(b,!1,q,g);h.ef=0;l(a)};a.z0=l;a.d0=d;a.vS=function(a,b){return b in a.k.Pg}};b4w.module.__container=function(a,g){var l,d,b,y,r;function A(a,b){l=a;d=b}function h(){var a=Q.getBoundingClientRect();A(a.left,a.top)}function u(){return K.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function m(b,d,f){if(!b||!d){b=a.Qy;d=a.Py;var h=p;h.style.width=a.Qy+"px";h.style.height=a.Py+"px"}var h=Q,g=k;!1!==f&&(h.style.width=b+"px",h.style.height=d+"px",g&&(g.style.width=b+"px",g.style.height=d+"px"));g&&(g.width=b,g.height=d,c.pt());f=Math.floor(b*K.canvas_resolution_factor);d=Math.floor(d*
K.canvas_resolution_factor);u()&&(f*=window.devicePixelRatio,d*=window.devicePixelRatio);if(g=D.Zh())g=g.s,f=Math.floor(f*g.Uo),d=Math.floor(d*g.Uo);h.width=f;h.height=d;var g=Math.min(C.drawingBufferWidth,E.DC,E.IC[0]),m=Math.min(C.drawingBufferHeight,E.DC,E.IC[1]);if(f>g||d>m)L.warn("Canvas size exceeds platform limits, downscaling"),g=Math.min(g/f,m/d),f*=g,d*=g,h.width=f,h.height=d;D.HM(f,d,f/b);D.Da()&&B.D(D.A().Mj);t.p0(h.width,h.height);t.kh()&&(q.update(),D.update(G.mk(),0),q.XN())}var q=
g("__anchors"),f=g("__config"),t=g("__data"),c=g("__hud"),z=g("__input"),L=g("__print"),D=g("__scenes"),G=g("__time"),B=g("__transform"),O=g("__util"),K=f.B,E=f.Oi,C=null,Q=null,k=null,p=null,x=!1;y=b=0;r=1;l=d=0;a.Qy=320;a.Py=240;a.Uf=function(a){C=a};a.Yh=function(){return Q};a.cJ=function(){return k};a.me=function(){return p};a.hh=function(a,b){a&&a.parentNode?(Q=a,k=b,p=a.parentNode):O.q("canvas container is not available")};a.kw=function(a,b){b=b||"LAST";switch(b){case "FIRST":p.insertBefore(a,
p.firstElementChild);break;case "JUST_BEFORE_CANVAS":p.insertBefore(a,Q);break;case "JUST_AFTER_CANVAS":Q.nextElementSibling?p.insertBefore(a,Q.nextElementSibling):p.appendChild(a,Q);break;case "LAST":p.appendChild(a,Q);break;default:L.error(b+" invalid stack order")}};a.RJ=function(){return b};a.QJ=function(){return y};a.bM=A;a.ON=h;a.UZ=function(a,c,d){b=a;y=c;r=d;h()};a.BB=function(){x=!0};a.Rq=function(a,b,c){c||(c=new Float32Array(2));var f=c;x&&(h(),x=!1);f[0]=a-l;a=c;x&&(h(),x=!1);a[1]=b-d;
return c};a.Nu=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*r;d[1]=c*r;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.U0=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/r;d[1]=c/r;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.oK=function(b){return b&&b.parentNode?b.parentNode==p?!0:a.oK(b.parentNode):!1};a.SW=u;a.dV=function(a){var b=document.getElementsByTagName("script");a=O.oj(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=m;a.Qk=function(a){var b=p,c=Q,d=b.clientWidth,
b=b.clientHeight;if(a||d!=c.clientWidth||b!=c.clientHeight)(a="HMD"===K.stereo&&z.UJ())&&a.isPresenting||m(d,b,!0)};a.reset=function(){p=k=Q=C=null}};b4w.module.__anchors=function(a,g){function l(){n=!0;z.me().addEventListener("mouseup",function(){function a(){return"visible"==c.style.visibility&&!q&&!g}if(!ea&&!e){var b=w;if(b)if("visible"==b.lastElementChild.style.visibility)d(),w=null;else if(1==b.style.opacity){var c=b.lastElementChild,b=b.firstElementChild,f=c.firstElementChild,k=f.innerHTML;c.style.visibility="visible";var p=Math.min(parseInt(c.style.width)||200,A(k)-24),n=h(k,p),q=!0,g=!0;b.style.display="none";ea=!0;E.Pj(0,p,200,function(b){b==
p&&(q=!1,g||(ea=!1),a&&(f.style.visibility="visible"));c.style.width=b+"px"});E.Pj(0,n,200,function(b){b==n&&(g=!1,q||(ea=!1),a&&(f.style.visibility="visible"));c.style.height=b+"px"})}}})}function d(){var a=w.lastElementChild;w.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function y(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function r(a,c,f){var k=document.createElement("div"),h=document.createElement("span");f&&(k.style.width=f+"px");y(k);b(h);h.innerHTML=a;k.style.visibility="hidden";h.style.visibility="hidden";k.appendChild(h);c.appendChild(k);c.addEventListener("mousedown",function(){ea||c==w||1!=c.style.opacity||e||(w&&"visible"==w.lastElementChild.style.visibility&&d(),w=c)})}function A(a){var c=document.createElement("div"),e=document.createElement("span");e.innerHTML=a;b(e);y(c);c.appendChild(e);document.body.appendChild(c);
a=c.offsetWidth+1;document.body.removeChild(c);return a}function h(a,c){var e=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);y(e);e.style.width=c+"px";e.style.display="inline-block";e.appendChild(d);document.body.appendChild(e);d=e.offsetHeight-16;document.body.removeChild(e);return d}function u(){for(var a=0,b=0;b<x.length;b++)x[b].$n&&a++;I=new Float32Array(3*a)}function m(a,b){return b.depth-a.depth}function q(a,b,c){a=a.element;p.iK&&(b=Math.floor(b),c=Math.floor(c));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}var f=g("__batch"),t=g("__camera"),c=g("__config"),z=g("__container"),L=g("__objects"),D=g("__obj_util"),G=g("__print"),B=g("__renderer"),O=g("__scenes"),K=g("__subscene"),E=g("__time"),C=g("__transform"),Q=g("__tsr"),k=g("__vec3"),p=c.B,x=[],e=!1,w=null,n=!1,ea=!1,I=new Float32Array(0),F=new Uint8Array(16),
T=new Float32Array(2),M=new Float32Array(3),X=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<x.length;c++)if(x[c].obj==a){c=!0;break a}c=!1}if(!c){c=a.anchor.$n&&Boolean(O.La(O.Zh(),K.An));c={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Hl:"out",$n:c,element:null,Eo:null,WQ:a.anchor.PX,ek:a.anchor.ek};switch(c.type){case "ANNOTATION":var e=c.obj;a=z.me();var d=L.Hv(e),e=e.name,f=document.createElement("div"),k=f.cloneNode(),h=document.createElement("span"),p="";f.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
k.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";f.style.visibility="hidden";d&&(p=d.description||p,e=d.title||e);h.innerHTML=e;h.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(h);h.style.whiteSpace="nowrap";k.appendChild(h);f.appendChild(k);p&&r(p,f,c.WQ);a.appendChild(f);c.element=f;break;case "ELEMENT":if(c.element=document.getElementById(a.anchor.ek),c.element)for(d=0;d<x.length;d++)"ELEMENT"==x[d].type&&x[d].ek==a.anchor.ek&&(G.warn("Anchor with the id '"+a.anchor.ek+"' already exists, making the new anchor generic."),c.type="GENERIC");else G.warn("Anchor HTML element with the id '"+a.anchor.ek+"' was not found, making it generic."),c.type="GENERIC"}x.push(c);u();
n||l()}};a.remove=function(a){for(var b=0;b<x.length;b++){var c=x[b];if(c.obj==a){"ANNOTATION"==c.type&&(a=c,z.me().removeChild(a.element));x.splice(b,1);u();break}}};a.update=function(a){for(var b=0,c=x.length;c--;){var e=x[c];if(e.$n){var d=Q.F(e.obj.k.n);I.set(d,3*b++)}var k;k=e;var d=M,h=O.rm(O.Zh());k=Q.F(k.obj.k.n);k=d=t.mD(h,k,d);d=k[0];h=k[1];k=k[2];if(a||d!=e.x||h!=e.y||k!=e.depth){switch(e.type){case "ANNOTATION":var p=d,n=h;q(e,p,n);break;case "ELEMENT":n=e.element.getBoundingClientRect(),
p=d-n.width/2,n=h-n.height/2,q(e,p,n)}e.x=d;e.y=h;e.depth=k;e.Eo&&e.Eo(d,h,e.Hl,e.obj,e.element)}}x.sort(m);for(c=0;c<x.length;c++)e=x[c],"GENERIC"!=e.type&&(e.element.style.zIndex=w==e.element?x.length:c);0<b&&(a=O.La(O.Zh(),K.An),b=a.Qa[0].sa[0],f.X_(b.za,I),K.Sc(a,b))};a.XN=function(){for(var a=z.me(),b=x.length;b--;){var c=x[b],e=c.obj,f=e.k,h=c.x,p=c.y,n=c.depth,q=O.rm(O.Zh()),g=C.Uc(e,M),q=C.Uc(q,X),g=k.dist(g,q);(n=0>h||0>p||0>n||1<n||O.nC(e)||h>=a.clientWidth||p>=a.clientHeight)||(n=f.lf,
n=!(g<f.mh?0:n==D.bq||g<n));f=n?"out":"visible";c.$n&&"out"!=f&&(f=c,n=O.La(O.Zh(),K.An).p,g=z.Nu(f.x,f.y,T,n),B.sD(n.ff,g[0],n.height-g[1],2,2,F),f=1020==F[5]+F[6]+F[9]+F[10]?"visible":"out"==f.Hl||0==F[5]+F[6]+F[9]+F[10]?"covered":f.Hl);if(f!=c.Hl){switch(c.type){case "ANNOTATION":case "ELEMENT":var m=c.element;if(!m)break;"out"==f?(m.style.visibility="hidden",m.children.length&&(m.children[0].style.visibility="hidden")):"visible"==f?(m.style.visibility="visible",m.children.length&&(m.children[0].style.visibility=
"visible"),m.style.opacity=1):(m.style.visibility="visible",m.style.opacity=.1,m.children.length&&(m.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<m.children.length&&"visible"==m.lastElementChild.style.visibility&&(d(),m==w&&(w=null)))}c.Hl=f;c.Eo&&c.Eo(h,p,c.Hl,e,m)}}};a.C3=function(a,b){for(var c=0;c<x.length;c++)x[c].obj==a&&(x[c].Eo=b)};a.G4=function(a){for(var b=0;b<x.length;b++)x[b].obj==a&&(x[b].Eo=null)};a.ua=function(){for(var a=0;a<x.length;a++){var b=x[a];"ANNOTATION"==
b.type&&z.me().removeChild(b.element)}x.length=0};a.KW=function(a){for(var b=0;b<x.length;b++)if(x[b].obj==a)return!0;return!1};a.X5=function(a){for(var b=0;b<x.length;b++)if(x[b].obj==a)return x[b].ek;return!1};a.pause=function(){e=!0};a.rj=function(){e=!1};a.lY=function(a,b){for(var c=-1,e=0;e<x.length;e++){var d;if(d="visible"==x[e].Hl){var f=x[e];if(f.element){d=Math.round(f.element.offsetWidth)||0;var k=Math.round(f.element.offsetHeight)||0}else k=d=0;var h=f.x,f=f.y;d=a>=h&&a<=h+d&&b<f&&b>=
f-k?!0:!1}if(d)if(0>c)var p=x[e].depth,c=e;else x[e].depth<p&&(c=e,p=x[e].depth)}return 0>c?null:x[c].obj}};b4w.module.__objects=function(a,g){function l(a){var b=a.I;a=a.k;for(var c=0;c<b.length;c++){var e=b[c].yb;e.s.outline&&a.sh&&w.UY(e)}}function d(a){a.k.sh=0;a=ba.indexOf(a);-1!=a&&ba.splice(a,1)}function b(a){if(a.ho)for(var b=a.I,c=0;c<b.length;c++)w.QN(b[c].yb,a)}function y(a,b){for(var c=a.I,e=b.I,d=0;d<c.length;d++){for(var f=!1,k=0;k<e.length;k++)if(c[d].yb==e[k].yb){f=!0;break}f||r(b,c[d].yb)&&C.sq(b,c[d].yb)}}function r(a,b){return!b.hG&&"SPEAKER"==a.type||!b.PQ&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function A(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.Rz||a.parent&&a.parent.Rz)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,e=a.b4w_collision,d=a.b4w_vehicle,f=a.b4w_floating,k=a.b4w_character,p=Q.pW(a),n=K.$G(a),q=0<a.data.b4w_shape_keys.length,g=a.b4w_dynamic_geometry;if(!(c=t.aH(a,b)||c||e||d||q||f||p||k||n||g))a:{c=a.data;for(e=0;e<c.materials.length;e++)if(d=c.materials[e],d.b4w_water||d.b4w_lens_flares||h(d.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
K.$G(a),e=a.b4w_do_not_batch,d=Boolean(a.b4w_anchor),t.aH(a,b)||c||e||d;default:return!0}}function h(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var e=c.convert_from,d=c.convert_to,f=c.outputs[0];if(!(!f.is_linked||"WORLD"==e&&"CAMERA"==d||"CAMERA"==e&&"WORLD"==d||"OBJECT"==e&&"OBJECT"==d))return!0}if("NORMAL_MAP"==c.type&&(e=c.space,f=c.outputs[0],f.is_linked&&("OBJECT"==e||"BLENDER_OBJECT"==e))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(f=c.outputs[1],e=c.outputs[3],c.outputs[0].is_linked||f.is_linked||e.is_linked))return!0}return!1}function u(a,b){var c=a.animation_data,e=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.s.type==t.Iz||c.s.type==t.Hz&&"ARMATURE"==b.type||c.s.type==t.IP&&"LAMP"==b.type||c.s.type==t.HP&&"WORLD"==b.type)&&b.Wg.push(t.jK(null,c)));e&&e.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Wg.push(t.jK(null,e.action));"MESH"==b.type&&b.Wg.push.apply(b.Wg,t.FV(a))}function m(a,b,c){b=W[b]||
[];for(var e=[],d=0;d<b.length;d++){var f=b[d];if(f.k.$e==c||-1==c)for(var k=f.I,h=0;h<k.length;h++)k[h].yb==a&&e.push(f)}return e}function q(a,b,c,e,d){for(var f=null,k=0;k<b.length;k++){var h=b[k];if(!((c?h.Rm:h.name)!=a||h.k.$e!=e&&-1!=e||d&&!h.Vj||(f=h,C.Yi(f))))break}return f}function f(a){W.ALL.push(a);W[a.type]||(W[a.type]=[]);W[a.type].push(a);var b=a.k.Hd;if(null!=b)for(var c=0;c<Z.length;c++){var e=Z[c];e.k.Hd==b&&e.Rs.push(a)}}var t=g("__animation"),c=g("__batch"),z=g("__boundings"),L=
g("__camera"),D=g("__config"),G=g("__constraints"),B=g("__geometry"),O=g("__lights"),K=g("__nla"),E=g("__nodemat"),C=g("__obj_util"),Q=g("__particles"),k=g("__physics"),p=g("__print"),x=g("__primitives"),e=g("__quat"),w=g("__scenes"),n=g("__sfx"),ea=g("__transform"),I=g("__textures"),F=g("__tsr"),T=g("__util"),M=g("__vec3"),X=g("__armature"),H=g("__anchors"),fa=g("__renderer"),V=D.B,P=D.Wc,W={ALL:[]},ha=new Float32Array(24),v=0,aa=0,Z=[],ba=[],ya=new Float32Array(3),na=new Float32Array(4);a.Zy=0;
a.Yy=1;a.Oc=2;a.oc=-1;a.update=function(a){for(var b=0;b<ba.length;b++){var c=ba[b],e=c,f=a,k=0,h=e.jL;0==h.Zx&&(h.Zx=f);f-=h.Zx;if(h.uD&&f/h.Tf>=h.uD)d(e);else{f%=h.Tf;if(f<h.$C)switch(h=f/(h.$C/5),f=Math.floor(h),f){case 0:k=(h-f)/2;break;case 1:k=(h-f)/2+.5;break;case 2:k=1;break;case 3:k=1-(h-f)/2;break;case 4:k=.5-(h-f)/2}e.k.sh=k}c.k.sh&&l(c)}if(a=W.ARMATURE)for(b=0;b<a.length;b++)c=a[b],c.TC&&(ea.D(c),c.TC=!1)};a.Yo=function(a,b){a.k.sh=b;l(a)};a.Mn=function(a,b,c,e){var d=a.jL;d.Zx=0;d.$C=
b;d.Tf=c;d.uD=e;-1==ba.indexOf(a)&&ba.push(a)};a.Qu=d;a.ll=function(a,b){b.Fj=a.uuid;b.Vj=!0;u(a,b);a.Rz=b.Ra=A(a,b);a.QQ=!0;b.gf=a.b4w_vehicle;b.og=a.b4w_character;b.Dm=a.b4w_floating;b.rn=a.b4w_collision;b.cc=a.b4w_collision_id;b.Vu=a.b4w_correct_bounding_offset;var e=a.game;b.th={Gs:e.physics_type,wt:e.use_ghost,eO:e.use_sleep,fi:e.mass,kO:e.velocity_min,jO:e.velocity_max,gI:e.damping,TL:e.rotation_damping,xX:e.lock_location_x,yX:e.lock_location_y,zX:e.lock_location_z,AX:e.lock_rotation_x,BX:e.lock_rotation_y,
CX:e.lock_rotation_z,Zq:e.collision_margin,Xq:e.collision_group,$q:e.collision_mask,OE:e.use_collision_bounds,Ru:e.collision_bounds_type,st:e.use_collision_compound};if(e=a.b4w_vehicle_settings)b.uf={name:e.name,nf:e.part,C_:e.suspension_rest_length,lE:e.suspension_compression,nE:e.suspension_stiffness,mE:e.suspension_damping,ZE:e.wheel_friction,DD:e.roll_influence,FC:e.max_suspension_travel_cm,Fr:e.force_max,Iq:e.brake_max,np:e.steering_max,Co:e.max_speed_angle,pr:e.delta_tach_angle,jt:e.speed_ratio,
lt:e.steering_ratio,bs:e.inverse_control,im:e.floating_factor,wn:e.water_lin_damp,xn:e.water_rot_damp,qN:e.synchronize_position};if(e=a.b4w_floating_settings)b.io={name:e.name,nf:e.part,im:e.floating_factor,wn:e.water_lin_damp,xn:e.water_rot_damp,qN:e.synchronize_position};if(e=a.b4w_character_settings)b.oH={Z0:e.walk_speed,cZ:e.run_speed,v_:e.step_height,aX:e.jump_strength,a1:e.waterline};for(e=0;e<a.constraints.length;e++){var d=a.constraints[e];"RIGID_BODY_JOINT"==d.type&&b.hD.push({target:d.target.nb,
nY:d.pivot_type,oY:d.pivot_x,pY:d.pivot_y,qY:d.pivot_z,Ga:d.axis_x,Ha:d.axis_y,Ia:d.axis_z,L0:d.use_limit_x,M0:d.use_limit_y,N0:d.use_limit_z,H0:d.use_angular_limit_x,I0:d.use_angular_limit_y,J0:d.use_angular_limit_z,nX:d.limit_max_x,oX:d.limit_max_y,pX:d.limit_max_z,qX:d.limit_min_x,rX:d.limit_min_y,sX:d.limit_min_z,hX:d.limit_angle_max_x,iX:d.limit_angle_max_y,jX:d.limit_angle_max_z,kX:d.limit_angle_min_x,lX:d.limit_angle_min_y,mX:d.limit_angle_min_z})}e=b.k=C.ir("MESH"===b.type?b.Ra?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.nb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Ds=a.parent_bone),a.pinverse_tsr&&(b.cx=F.create(),F.copy(a.pinverse_tsr,b.cx))):a.dg_parent&&(b.parent=a.dg_parent.nb,b.Lk=!0);var d=a.location,k=a.scale[0];T.oD(a.rotation_quaternion,na);ea.Xc(b,d);ea.pi(b,na);ea.Le(b,k);b.ut=a.b4w_use_default_animation;b.Fl=t.Xz(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Hw={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,J3:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.sy={TQ:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":X.ll(a,b);d=e.Pg;k=t.eS(d);a.b4w_animation_mixing?(e.re=new Float32Array(k.Eb),e.Ke=new Float32Array(k.Eb),e.xe=new Float32Array(k.trans),e.Oe=new Float32Array(k.trans)):(e.re=k.Eb,e.Ke=k.Eb,e.xe=k.trans,e.Oe=k.trans);for(var h in d){var p=d[h];1==p.Ou.length&&X.d0(p,!0,k.trans,k.Eb)}e.Ks=k;e.ef=0;e.Ii=a.b4w_animation_mixing;break;case "MESH":e.ao=a.b4w_do_not_render;
e.Jl=c.KR(a.data.b4w_boundings.bb);e.Sk=P.outlining_overview_mode||a.b4w_selectable;e.Vw=a.b4w_selectable;e.Wc=P.outlining_overview_mode||a.b4w_outlining;e.Uw=a.b4w_outlining;e.Ww=P.outlining_overview_mode||a.b4w_outline_on_select;e.Og=a.b4w_billboard;e.Cq=a.b4w_pres_glob_orientation;e.Eq="BASIC";e.Dq="SPHERICAL"==a.b4w_billboard_geometry;h=e.hi;h.Gk=a.b4w_outline_settings.outline_duration;h.Hk=a.b4w_outline_settings.outline_period;h.Ik=a.b4w_outline_settings.outline_relapses;e.Sk&&(e.Yj=T.LI(v),
v++);for(h=0;h<a.data.b4w_vertex_anim.length;h++)d=a.data.b4w_vertex_anim[h],b.$c.push({name:d.name,va:d.frame_start,$a:d.frame_end,D3:d.averaging,E3:d.averaging_interval,UQ:d.allow_nla});b.k.$c=b.$c.length?!0:!1;"MESH"!=a.type&&T.q("Wrong object type: "+a.name);h=b.k;if(a.data.b4w_shape_keys.length)for(h.Qe=!0,d=0;d<a.data.b4w_shape_keys.length;d++)k={},k.value=a.data.b4w_shape_keys[d].value,k.name=a.data.b4w_shape_keys[d].name,h.qi.push(k);else h.Qe=!1;e.Me=a.b4w_shadow_cast;e.je=a.b4w_shadow_receive;
e.ve=a.b4w_shadow_cast_only&&e.Me;e.he=a.b4w_reflexible;e.Kd=a.b4w_reflexible_only&&e.he;e.Jd=a.b4w_reflective;e.vh=a.b4w_reflection_type;if(!e.Jd)for(h=a.data.materials,d=0;d<h.length;d++)k=h[d],k.use_nodes&&-1!=k.node_tree.Qz.indexOf("BSDF_GLOSSY")&&(e.Jd=!0,e.vh="CUBE");e.Sg=a.b4w_caustics;if(e.xf=a.b4w_wind_bending)e.zn=a.b4w_wind_bending_angle,h=c.b1(a.b4w_wind_bending_angle,e.Jl,a.scale[0]),e.Dh=h,e.Eh=a.b4w_wind_bending_freq,e.Yg=a.b4w_detail_bending_freq,e.Xg=a.b4w_detail_bending_amp,e.Rg=
a.b4w_branch_bending_amp,e.ej=a.b4w_main_bend_stiffness_col,h=a.b4w_detail_bend_colors,e.Fe.tC=h.leaves_stiffness_col,e.Fe.sC=h.leaves_phase_col,e.Fe.bD=h.overall_stiffness_col;e.ai=a.b4w_hidden_on_load;e.gg=a.b4w_dynamic_geometry;"MESH"!==a.type&&T.q("Wrong object");h=a.data.materials[0];e.lm=h.physics.friction;e.fm=h.physics.elasticity;e.mh=0;e.lf=C.bq;e.nh=a.b4w_lod_transition;e.bx=a.pass_index;break;case "LINE":e.S=z.Ud();e.ba=z.Tg();e.Ta=z.Ud();e.pb=z.Tg();break;case "CAMERA":L.nS(a,b);L.AR(b);
break;case "LAMP":O.bX(a,b);break;case "SPEAKER":b.Y=n.zT();e=!1;for(h=0;h<b.I.length;h++)if(b.I[h].yb.Rc){e=!0;break}e&&n.ll(a,b);break;case "EMPTY":h=z.Ud(),e.S=h,h=z.Sh(),e.wa=h,a.field&&(b.ho={type:a.field.type,jN:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,$n:a.b4w_anchor.detect_visibility,ek:a.b4w_anchor.element_id,PX:a.b4w_anchor.max_width})}f(b)};a.D0=function(a,b){b.Fj=a.uuid;b.Vj=!0;u(a,b);a.Rz=b.Ra=A(a,b);a.QQ=!0;b.k=C.ir(b.type);b.ut=a.b4w_use_default_animation;
b.Fl=t.Xz(a.b4w_anim_behavior);f(b)};a.r0=function(a,b){var c=b.k;if(b.parent){!b.Lk&&b.th.st&&b.parent.th.st&&(b.rn=!1);for(var d=!1,h=0;h<b.I.length;h++)if(b.I[h].yb.Ac){d=!0;break}if(h=d)h=b.th,h=b.gf||b.Dm||k.og(b)||b.rn&&!h.wt&&0<h.fi&&("DYNAMIC"==h.Gs||"RIGID_BODY"==h.Gs);if(h)h=b.Lk?F.copy(c.n,F.create()):c.n,F.multiply(b.parent.k.n,h,c.n),ea.Xc(b,F.F(c.n)),ea.Le(b,F.td(c.n)),ea.pi(b,F.P(c.n));else if(b.Lk||!b.Ds)if(h=F.copy(c.n,F.create()),b.sy&&"CAMERA"==b.parent.type){h={distance:b.sy.distance,
rotation:F.P(h)};switch(b.sy.TQ){case "TOP_LEFT":h.top=0;h.left=0;break;case "TOP":h.top=0;h.left=.5;break;case "TOP_RIGHT":h.top=0;h.right=0;break;case "LEFT":h.top=.5;h.left=0;break;case "CENTER":h.top=.5;h.left=.5;break;case "RIGHT":h.top=.5;h.right=0;break;case "BOTTOM_LEFT":h.bottom=0;h.left=0;break;case "BOTTOM":h.bottom=0;h.left=.5;break;case "BOTTOM_RIGHT":h.bottom=0,h.right=0}G.Zz(b,b.parent,h)}else G.YQ(b,b.parent,h);else h=F.copy(c.n,F.create()),G.ZQ(b,b.parent,b.Ds,h)}if("ARMATURE"==b.type)for(d=
a.pose.bones,h=0;h<d.length;h++){var n=d[h],q=n.constraints;if(q)for(var g=0;g<q.length;g++){var v=q[g];"COPY_TRANSFORMS"!=v.type||v.subtarget||v.mute||G.lR(b,v.target.nb,n.name,T.VF,T.Gn)}}if("MESH"==b.type)var m=t.aJ(a);if(m){q=m.nb;h=q.k.Ks;d=b.k;n=a.data;b.Au=q;n=n.vertex_groups;if(n.length){var q=q.k.Pg,g=0,v={},J;for(J in q){var l=T.Gd("name",J,n);l&&(v[J]={nO:l.index,Uj:q[J].Uj,hB:g++})}d.Li=v;J=g;n=t.qJ();d.oh=J;J>2*n?(d.vk=!1,p.error('too many bones for "'+a.name+'" / '+d.oh+" bones (max "+
n+" with blending, "+2*n+" without blending). Skinning will be disabled.")):d.vk=!0}J=t.SU(h.trans,h.Eb,c.Li);m.b4w_animation_mixing?(c.re=new Float32Array(J.Eb),c.Ke=new Float32Array(J.Eb),c.xe=new Float32Array(J.trans),c.Oe=new Float32Array(J.trans)):(c.re=J.Eb,c.Ke=J.Eb,c.xe=J.trans,c.Oe=J.trans);c.uq=new Float32Array(4);c.tq=e.create();c.Ks=J;c.ef=0}if(c.Jd)if(c=b.k,"CUBE"==c.vh)c.Vd=aa++;else if("PLANE"==c.vh){a:{m=a.constraints;for(J=0;J<m.length;J++)if(h=m[J],"LOCKED_TRACK"==h.type&&"REFLECTION PLANE"==
h.name){if(h.target.nb){m=h.target.nb;break a}p.warn('Reflection plane target "'+h.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}m=null}m||(m=T.ot("%reflection%"),m=C.hr(m,"EMPTY"),J=C.ir("EMPTY"),m.k=J,y(b,m),G.vG(m,b,[0,0,0],null,1),f(m));J=null;for(h=0;h<Z.length;h++)if(Z[h]==m){J=h;break}null==J&&(J=Z.length,Z.push(m));m.k.Hd=J;c.Hd=J;m.Rs.push(b)}};a.l0=b;a.r4=y;a.yS=r;a.s0=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=c.k.type&&
"CAMERA"!=c.k.type||ea.D(c);c.ut&&t.hL(c)&&(t.yu(c),c.ia.length&&t.play(c,null,t.yl))}};a.Hv=function(a){return T.T(a.Hw)};a.ua=function(){aa=v=0;Z.length=0;ba.length=0;W={ALL:[]}};a.copy=function(a,b,e){var d=b,k=C.Yi(a);b=k?C.MI(k.name,b):b;if(q(b,W.ALL,!1,-1)){for(var k=1,h;;){h="."+(3>String(k).length?("000"+String(k)).slice(-3):String(k));if(!q(b+h,W.ALL,!1,-1))break;k++}p.error('Object "'+b+'" already exists. Name was replaced by "'+b+h+'".');d+=h;b+=h}d=C.hr(b,a.type,d);d.Vj=a.Vj;d.Ra=a.Ra;
d.ds=a.ds;d.ut=a.ut;d.Wg=a.Wg;d.k=C.BA(a.k);d.Hw=C.Uu(a.Hw);y(a,d);d.tu=C.IA(a.tu);d.parent=C.IA(a.parent);d.Lk=a.Lk;d.Ds=a.Ds;d.$c=C.IA(a.$c);d.Fl=a.Fl;!a.C||a.gf||a.og||a.Dm||(d.rn=a.rn,d.C=null);d.cc=a.cc;d.Vu=a.Vu;d.th=C.Uu(a.th);b=[];for(k=0;k<a.I.length;k++){h=d.I[k];var n=a.I[k].X;if(e){for(var g=h.X,m=0;m<n.length;m++)if(!n[m].kg){var t=C.Uu(n[m]);t.Ca=B.VS(n[m].Ca);g.push(t);b.push(n[m].Ca)}for(m=0;m<n.length;m++)if(n[m].kg){t=C.Uu(n[m]);g.push(t);for(var J=0;J<b.length;J++)b[J]==n[m].Ca&&
(t.Ca=g[J].Ca)}for(m=0;m<g.length;m++)g[m].Ca&&B.RN(g[m].Ca),V.Uz&&fa.ER(g[m]),g[m].Ek=d.Fj,c.Z_(g[m]);I.XZ(g)}else h.X=n;for(m=0;m<h.X.length;m++)for(n=h.X[m].ya,g=0;g<n.length;g++)I.hw(n[g])}e||(d.k.Bp=!1);C.HD(d,!1);f(d);d.k.mw=!0;d.k.nw=e;d.k.Yj=T.LI(v);v++;return d};a.e0=function(a){for(var b=a.k,e=a.I[0].X,d,f,k,h,p,n,q,g,m,v,t,l,w=[],H=0;H<e.length;H++){var P=e[H];if("MAIN"==P.type){var r=B.Tr("a_position"),r=B.Nv(P.Ca.tc,r),u=P.Ca.ld.a_position.offset;d=h=r[u];f=p=r[u+1];k=n=r[u+2]}}for(H=
0;H<e.length;H++)if(P=e[H],P.Ca&&P.pb&&P.Ta){var r=B.Tr("a_position"),r=B.Nv(P.Ca.tc,r),u=P.Ca.ld.a_position.offset,C=P.Ca.ld.a_position.length+u;q=v=r[u];g=t=r[u+1];m=l=r[u+2];for(var aa=u;aa<C;aa+=3){var u=r[aa],Q=r[aa+1],E=r[aa+2];q=Math.max(u,q);g=Math.max(Q,g);m=Math.max(E,m);v=Math.min(u,v);t=Math.min(Q,t);l=Math.min(E,l)}P.S.max_x=q.toFixed(3);P.S.max_y=g.toFixed(3);P.S.max_z=m.toFixed(3);P.S.min_x=v.toFixed(3);P.S.min_y=t.toFixed(3);P.S.min_z=l.toFixed(3);z.Ol(P.S,b.n,P.Ta);z.xI(P.Ta,ha);
for(r=w.length=0;r<ha.length;r++)w.push(ha[r]);P.pb=z.Wu(w,!0);P.ba=z.$R(P.pb,b.n);P.wa=z.fr(P.ba);P.kb=z.fr(P.pb);P.Zf=z.mC(P.ba,P.wa);"MAIN"==P.type&&(d=Math.max(q,d),f=Math.max(g,f),k=Math.max(m,k),h=Math.min(v,h),p=Math.min(t,p),n=Math.min(l,n))}w={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(f.toFixed(3)),max_z:parseFloat(k.toFixed(3)),min_x:parseFloat(h.toFixed(3)),min_y:parseFloat(p.toFixed(3)),min_z:parseFloat(n.toFixed(3))};v=d-h;g=f-p;q=k-n;h=.5*(d+h);m=.5*(f+p);t=.5*(k+n);var F=h,W=
t;p=Math.max(v,Math.max(g,q))/2;n=Math.max(v,q)/2;var fa=[h/(v?v:1),m/(g?g:1),t/(q?q:1)];l=.5;if(b.Og)u=Math.max(Math.abs(w.max_x),Math.abs(w.min_x)),Q=Math.max(Math.abs(w.max_y),Math.abs(w.min_y)),E=Math.max(Math.abs(w.max_z),Math.abs(w.min_z)),k=Math.sqrt(u*u+Q*Q+E*E),H=Math.sqrt(u*u+Q*Q),w.max_x=w.max_y=w.max_z=k,w.min_x=w.min_y=w.min_z=-k,n=H,p=k,u=new Float32Array([0,0,0]),d=new Float32Array([p,p,p]),k=new Float32Array([0,0,0]);else{for(H=0;H<e.length;H++)if(P=e[H],"MAIN"==P.type)for(r=B.Tr("a_position"),
r=B.Nv(P.Ca.tc,r),C=e[H].Ca.ld,u=C.a_position.offset,C=C.a_position.length+u,aa=u;aa<C;aa+=3){var u=r[aa],Q=r[aa+1],E=r[aa+2],L=Math.sqrt((h-u)*(h-u)+(m-Q)*(m-Q)+(t-E)*(t-E));if(L>p){var P=h-p*(u-h)/L,D=m-p*(Q-m)/L,L=t-p*(E-t)/L;h=(P+u)/2;m=(D+Q)/2;t=(L+E)/2;p=Math.sqrt((h-u)*(h-u)+(m-Q)*(m-Q)+(t-E)*(t-E))}D=Math.sqrt((F-u)*(F-u)+(W-E)*(W-E));D>n&&(P=F-n*(u-F)/D,L=W-n*(E-W)/D,F=(P+u)/2,W=(L+E)/2,n=Math.sqrt((F-u)*(F-u)+(W-E)*(W-E)));u/=v?v:1;Q/=g?g:1;E/=q?q:1;L=Math.sqrt((fa[0]-u)*(fa[0]-u)+(fa[1]-
Q)*(fa[1]-Q)+(fa[2]-E)*(fa[2]-E));L>l&&(P=fa[0]-l*(u-fa[0])/L,D=fa[1]-l*(Q-fa[1])/L,L=fa[2]-l*(E-fa[2])/L,fa[0]=(P+u)/2,fa[1]=(D+Q)/2,fa[2]=(L+E)/2,l=Math.sqrt((fa[0]-u)*(fa[0]-u)+(fa[1]-Q)*(fa[1]-Q)+(fa[2]-E)*(fa[2]-E)))}H=v?v*fa[0]:d;f=g?g*fa[1]:f;k=q?q*fa[2]:k;d=l*v;r=l*g;C=l*q;u=new Float32Array([h,m,t]);d=new Float32Array([d,r,C]);k=new Float32Array([H,f,k]);n=parseFloat(n.toFixed(3))}b.S=w;c.BZ(b,n,n,w);w=z.nA(p,u);b.wa=w;w=z.Bq([d[0],0,0],[0,d[1],0],[0,0,d[2]],k);b.ba=w;ea.D(a);if(V.debug_view)for(H=
0;H<e.length;H++)if("DEBUG_VIEW"===e[H].type&&e[H].Ti){a=x.Bv(1,w.G);B.XL(a,[w.Ga[0],w.Ha[1],w.Ia[2]],w.G);B.Yx(a,1,!0);a.qa.a_polyindex=B.sv(a);c.Y_(e[H],a);break}};a.Ub=m;a.FJ=function(a,b,c){b=W[b]||[];for(var e=[],d=0;d<b.length;d++){var f=b[d];if((f.k.$e==c||-1==c)&&f.Vj)for(var k=f.I,h=0;h<k.length;h++)k[h].yb==a&&e.push(f)}return e};a.qm=function(a){var b=W.ALL;if(-1==a)return b;for(var c=[],e=0;e<b.length;e++){var d=b[e];d.k.$e==a&&c.push(d)}return c};a.tm=function(a){var b=W.MESH;if(b)for(var c=
0;c<b.length;c++){var e=b[c];if(k.og(e))for(var d=e.I,f=0;f<d.length;f++)if(d[f].yb==a)return e}return null};a.g_=function(a){var b=m(a,"LAMP",-1);if(b.length==a.s.x8){for(var c=[],e=0;e<b.length;e++){var d=b[e],d=C.ja(d,a);c[d.Km]=e}for(e=0;e<c.length-1;e++)for(d=e+1;d<c.length;d++){var f=b[c[e]].tb,k=b[c[d]].tb;if(k.qn&&k.sn&&(!f.qn||!f.sn)||!f.qn&&(k.qn||!f.sn&&k.sn))f=c[e],c[e]=c[d],c[d]=f}for(e=0;e<c.length;e++)d=b[c[e]],C.ja(d,a).Km=e,w.Ap(b[c[e]],a)}};a.Sw=function(a,b,c,e){for(var d=0;d<a.I.length;d++)for(var f=
a.I[d].X,k=0;k<f.length;k++){var h=f[k];h.Ca.eg=b;h.eg=b;h.zb.eg=c;""!==h.Ck&&(h=E.tJ(h.Ck))&&(h.zH=e)}};a.GJ=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var e=b[c];e.k.Sk&&e.Vj&&a.push(e)}return a};a.I6=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var e=b[c];e.k.Wc&&e.Vj&&a.push(e)}return a};a.xc=function(b,c,e,d){var f=null,k=W.ALL;switch(b){case a.Zy:f=q(c,k,!0,e,d);break;case a.Yy:a:{for(b=0;b<k.length;b++)if(f=k[b],f.Rm==e&&(f.k.$e==d||-1==d)){var h=C.Yi(f);
if(h&&h.Rm==c)break a}f=null}break;case a.Oc:a:{for(d=0;d<k.length;d++){b=k[d];for(var f=c.length-1,h=b,p=!0;0<=f&&p;)p=h&&h.Rm==c[f]&&(h.k.$e==e||-1==e),h&&(h=C.Yi(h)),f--;if(p&&!h){f=b;break a}}f=null}}return f};a.Ov=function(a,b){return q("%meta_world%"+a,W.WORLD,!0,b)};a.No=function(b,c){var e=w.Zh();if(!e)return p.error("No active scene"),null;var d=H.lY(b,c);if(d)return d;d=w.mY(e,b,c);if(!d)return null;for(var e=m(e,"MESH",-1),f=0;f<e.length;f++){var k=e[f].k,h=k.Yj;if(h&&3>Math.abs(255*h[0]-
d[0])&&3>Math.abs(255*h[1]-d[1])&&3>Math.abs(255*h[2]-d[2]))return k.Wc&&k.Ww&&(P.outlining_overview_mode?a.Mn(e[f],P.Gk,P.Hk,P.Ik):(d=k.hi,a.Mn(e[f],d.Gk,d.Hk,d.Ik))),e[f]}return null};a.GM=function(a,c){for(var e=m(a,"EMPTY",-1),d=0;d<e.length;d++){var f=e[d];if(f.ho&&"WIND"===f.ho.type){var k=f;break}}if(!k)return p.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(e=T.Cb(c.wind_dir),M.set(Math.sin(e),-Math.cos(e),0,ya),T.kB(ya,T.nc,na),ea.pi(k,na));"number"==typeof c.wind_strength&&
(k.ho.jN=c.wind_strength);b(k)};a.Ss=function(a){G.AS(a)&&G.remove(a);var b=W.ALL,c=W[a.type],e=b.indexOf(a);a=c.indexOf(a);-1!=e&&b.splice(e,1);-1!=a&&c.splice(a,1)};a.dY=f;a.eY=function(a){return W[a.type]&&-1<W[a.type].indexOf(a)}};b4w.module.__animation=function(a,g){function l(a,b){var c=a.ia[b];c&&c.AB&&c.Ar&&(c.Ar=!1,c.AB(a,b))}function d(a,b,c){c=a.ia[c];c.type=30;var e=b.va,d=b.$a-e+1;c.start=e;c.length=d;c.Gf=e;c.Ji=b.name;for(d=e=0;d<a.$c.length;d++){var f=a.$c[d];if(f==b)break;else e+=f.$a-f.va+1}c.fO=e}function b(a,b){a.type=50;a.Ji=b.name;a.start=b.va;a.length=b.$a-a.start;b.Ee||(a.length+=b.vC)}function y(a){return a.replace(/_B4W_BAKED$/,"")}function r(a,b){return{Go:a,action:b}}function A(a,b,c){if(a.animation_data){var e=
a.animation_data.action;e&&60==e.s.type&&b.push(r(c,e))}a=a.nodes;for(e=0;e<a.length;e++){var d=a[e];if(d.node_group){var f=d.node_group.node_tree;if(f){var k=c.slice();k.push(d.name);A(f,b,k)}}}}function h(a){return P.ce(a)&&a.k.$c?!0:!1}function u(a,b,c){var e=a.ia;if(-1==c)for(c=0;8>c;c++){var d=e[c];d&&(d.Gf=b,q(a,0,c,!0))}else if(d=e[c])d.Gf=b,q(a,0,c,!0)}function m(a,b,c){if(-1==b)for(b=0;8>b;b++){var e=a[b];e&&c(e)}else(e=a[b])&&c(e)}function q(a,b,c,e){B(a,b,c,e);l(a,c);a.k.Ii&&(E(a,b),K(a,
b))}function f(a,b,e,d){var f=e.frame_range;if(f[0]>f[1])return v.warn('Incompatible action "'+e.name+'" has been applied to object "'+a.name+'"'),!1;var k=e.s,h=a.ia[d];h.Ji=e.name;h.Sz=f;h.mG=k.qL;h.kG=k.RG;h.Ni.set(k.Ni);h.start=f[0];h.length=f[1]-f[0];h.Gf=f[0];switch(k.type){case 10:if(P.Bm(a)){h.type=10;var p=t(a,b,e);if(!p){for(var p=a.k.Pg,f=[],n=[],q=e.s.WC,g=0;g<q;g++){for(var m in p){var J=p[m],l=J.cy,w=e.s.jA[m];w?ra.copy(w.subarray(8*g,8*g+8),l):ra.identity(l);J.dy=!1}J=C(p);f.push(J.trans);
n.push(J.Eb)}p={trans:f,Eb:n};c(a,b,e,p)}h.trans=p.trans;h.Eb=p.Eb;b=p;h=a.k;p=h.fp;f=a.ia[d];m=f.bE;a:{n=h.Kx;for(q=0;q<n.length;q+=2)if(e==n[q]){n=n[q+1];break a}n=null}if(n)f.bE=n;else{for(f=0;f<p.length;f++){n=p[f].Li;q=[];g=[];J=b.trans;l=b.Eb;for(w=0;w<J.length;w++){var H=Q(J[w],l[w],n);q.push(H.trans);g.push(H.Eb)}m.push({trans:q,Eb:g})}h.Kx.push(e,m)}h.Ii&&(e=h.yp,d>e[1]?(b=e[1],e[1]=d,e[0]=b):d>e[0]&&d<e[1]&&(e[0]=d),z(a))}break;case 40:P.gs(a)&&(h.volume=k.qb.volume||null,h.pitch=k.qb.pitch||
null,h.type=40);break;case 70:P.jh(a)&&(h.color=k.qb.color||null,h.If=k.qb.energy||null,h.type=70);break;case 60:if("MESH"==a.type){h.type=60;m=t(a,b,e);if(!m){m=[];f=[];n=[];q=[];g=[];J=e.s;l=b?b[0]:null;for(p in J.qb){w=b;H=p.match(/"(.*?)"/)[1];if(w&&1<w.length){for(var x=w[1],r=2;r<w.length;r++)x=x+"%join%"+w[r];x+="%join%"+H}else x=H;w=x;for(H=0;H<a.I.length;H++)for(x=a.I[H].X,r=0;r<x.length;r++){var u=x[r];if(!l||-1!=u.wd.indexOf(l)){var Y=u.kj,V=D(p,w,J,f,m,u.lj),Y=D(p,w,J,q,n,Y);(V||Y)&&g.push(u)}}}m=
{O0:m,values:f,YY:n,ZY:q,Pw:g};c(a,b,e,m)}h.lj=m.O0;h.bL=m.values;h.kj=m.YY;h.aL=m.ZY;h.Pw=m.Pw}break;case 20:if(p=k.qb.tsr){h.type=20;m=t(a,b,e);if(!m){m=e.s.WC;f=[];n=[];for(q=0;q<m;q++)f.push(p.subarray(8*q,8*q+4)),n.push(p.subarray(8*q+4,8*q+8));m={trans:f,Eb:n};c(a,b,e,m)}h.trans=m.trans;h.Eb=m.Eb;W.Ho(a)&&W.C0(a,h.trans[0],h.Eb[0])}else return v.warn('Incompatible action "'+e.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:P.pC(a)&&(h.If=k.qb["light_settings.environment_energy"]||
null,h.oe=k.qb.horizon_color||null,h.ye=k.qb.zenith_color||null,h.Er=k.qb["mist_settings.intensity"]||null,h.fog_depth=k.qb["mist_settings.depth"]||null,h.fog_start=k.qb["mist_settings.start"]||null,h.fog_height=k.qb["mist_settings.height"]||null,h.BI=k.qb.b4w_fog_color||null,h.type=80)}P.Bm(a)&&10!=k.type&&L(a,d);return!0}function t(a,b,c){a=a.tu;b=b?b.join("%join%"):null;for(var e=0;e<a.length;e+=3)if(c==a[e]&&b==a[e+1])return a[e+2];return null}function c(a,b,c,e){a.tu.push(c,b?b.join("%join%"):
null,e)}function z(a){var b=a.k.yp;if(-1!=b[0]&&-1!=b[1]){var c=a.ia;a=c[b[1]].Gf;var e=Math.floor(a),d=a-e,b=c[b[0]];a=b.Gf;e=Math.floor(a);b.Gf=e+d}}function L(a,b){var c=a.k.yp,e=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var d=a.ia;0<=e;e--){var f=d[e];if(f&&10==f.type)if(e>c[1])c[1]=e;else{e>c[0]&&(c[1]=e);break}}}function D(a,b,c,e,d,f){if(!f)return!1;for(var k=!1,h=0;h<f.length;h+=2)b==f[h]&&(d.push(f[h+1]),e.push(new Float32Array(c.qb[a])),k=!0);return k}function G(a){a=a.s;for(var b in a.qb)if(-1!=
b.indexOf("nodes"))return!0;return!1}function B(a,b,c,e){if((c=a.ia[c])&&null!=c.type&&(c.play||e)){var d=a.k,f=c.Gf,k=c.start,h=c.length,f=f+c.speed*b*R.sd(),p=c.type,n=c.speed;if(0<=n&&f>=k+h||0>n&&f<k)switch(e||(c.Ar=!0),c.behavior){case 10:f=0<=n?(f-k)%h+k:k+h-1E-6;break;case 20:f=0<=n?k:k+h-1E-6;c.play=!1;break;case 30:f=0<=n?k+h-1E-6:k,c.play=!1}c.Gf=f;switch(p){case 10:if(!d.Ii){e=O(c);b=e[0];var q=e[1];e=e[2];d.re=c.Eb[b];d.Ke=c.Eb[q];d.xe=c.trans[b];d.Oe=c.trans[q];d.ef=e;e=d.fp;c=c.bE;for(var g=
0;g<e.length;g++){var m=e[g],v=c[g];m.re=v.Eb[b];m.Ke=v.Eb[q];m.xe=v.trans[b];m.Oe=v.trans[q];m.ef=d.ef}ca.D(a)}break;case 20:e=O(c);var d=N,q=e[0],g=e[1],m=e[2],v=c.trans,t=v[q][1],f=v[q][2],k=v[g][1],h=v[g][2];d[0]=(1-m)*v[q][0]+m*v[g][0];d[1]=(1-m)*t+m*k;d[2]=(1-m)*f+m*h;q=J;f=e[0];g=e[1];m=e[2];v=c.Eb;t=ma;t[0]=v[f][0];t[1]=v[f][1];t[2]=v[f][2];t[3]=v[f][3];f=pa;f[0]=v[g][0];f[1]=v[g][1];f[2]=v[g][2];f[3]=v[g][3];aa.slerp(t,f,m,q);g=e[2];m=c.trans;e=(1-g)*m[e[0]][3]+g*m[e[1]][3];a.parent&&a.cx&&
(g=ja,ra.Ag(d,e,q,g),ra.multiply(a.cx,g,g),ra.ic(g,d),ra.ae(g,q),e=ra.td(g));c.FE&&(g=ia,ca.Uc(a,g),xa.Sx(d,g,b,c.FE,d));c.pD&&(g=ma,ca.Nf(a,g),xa.YM(q,g,b,c.pD,q));f=c.Ni;f[0]&&ca.Gx(a,d);f[1]&&ca.Dx(a,q);f[2]&&ca.TD(a,e);ca.D(a);ha.H(a);break;case 30:e=c.Gf-c.start;0>e&&(e=0);e>=c.length&&(e=c.length);a=Math.floor(e);b=a+1;e-=a;10!=c.behavior&&b==c.length&&(b=--a,e=1);c=c.fO;sa[0]=a+c;sa[1]=b+c;sa[2]=e;e=sa;d.ly=e[0];d.my=e[2];break;case 40:e=O(c);b=e[0];d=e[1];e=e[2];c.volume&&ya.QZ(a,(1-e)*c.volume[b]+
e*c.volume[d]);c.pitch&&ya.uY(a,(1-e)*c.pitch[b]+e*c.pitch[d]);break;case 50:b=10==c.behavior?(f-k)/R.sd():f/R.sd();W.LZ(a,c.Ji,b);break;case 60:e=O(c);b=e[0];d=e[1];e=e[2];v=c.bL;t=c.lj;a=c.aL;q=c.kj;g=c.Pw;for(c=0;c<t.length;c++)for(f=v[c],m=t[c],k=(1-e)*f[b]+e*f[d],f=0;f<g.length;f++)g[f].mj[m]=k;for(c=0;c<q.length;c++)for(v=a[c],m=q[c],v=oa.lerp(v.subarray(3*b,3*b+3),v.subarray(3*d,3*d+3),e,N),f=0;f<g.length;f++)g[f].Ie[3*m]=v[0],g[f].Ie[3*m+1]=v[1],g[f].Ie[3*m+2]=v[2];break;case 70:e=O(c);b=
e[0];d=e[1];e=e[2];f=c.Ni;(h=c.If)&&f[0]&&V.$s(a.tb,(1-e)*h[b]+e*h[d]);(c=c.color)&&f[1]&&(N[0]=(1-e)*c[3*b]+e*c[3*d],N[1]=(1-e)*c[3*b+1]+e*c[3*d+1],N[2]=(1-e)*c[3*b+2]+e*c[3*d+2],V.Ax(a.tb,N));k=a.I;for(c=0;c<k.length;c++)ba.n0(a,k[c].yb);break;case 80:e=O(c);b=e[0];d=e[1];e=e[2];f=c.Ni;k=a.I;n=ba.La(k[0].yb,na.Pb);h=c.If;h=f[0]?(1-e)*h[b]+e*h[d]:n.If;p=c.oe;f[1]?(N[0]=(1-e)*p[3*b]+e*p[3*d],N[1]=(1-e)*p[3*b+1]+e*p[3*d+1],N[2]=(1-e)*p[3*b+2]+e*p[3*d+2],p=N):p=n.oe;var l=c.ye;f[2]?(ia[0]=(1-e)*l[3*
b]+e*l[3*d],ia[1]=(1-e)*l[3*b+1]+e*l[3*d+1],ia[2]=(1-e)*l[3*b+2]+e*l[3*d+2],n=ia):n=n.ye;l=c.Er;f[3]&&(q=(1-e)*l[b]+e*l[d]);l=c.fog_depth;f[4]&&(g=(1-e)*l[b]+e*l[d]);l=c.fog_start;f[5]&&(m=(1-e)*l[b]+e*l[d]);l=c.fog_height;f[6]&&(v=(1-e)*l[b]+e*l[d]);c=c.BI;f[7]&&(J[0]=(1-e)*c[3*b]+e*c[3*d],J[1]=(1-e)*c[3*b+1]+e*c[3*d+1],J[2]=(1-e)*c[3*b+2]+e*c[3*d+2],t=J);for(c=0;c<k.length;c++)b=a.I[c].yb,(f[0]||f[1]||f[2])&&ba.wx(b,h,p,n),f[3]&&ba.mM(b,q),f[4]&&ba.kM(b,g),f[5]&&ba.nM(b,m),f[6]&&ba.lM(b,v),f[7]&&
ba.ND(b,t);break;default:xa.q("Unknown animation type:"+p)}}}function O(a){var b=a.Sz[0],c=a.Sz[1]-b,b=a.Gf-b;0>b&&(b=0);b>=c&&(b=c);b/=a.mG;c=Math.floor(b);a=a.kG[c]?b-c:0;b=Math.ceil(c+a);sa[0]=c;sa[1]=b;sa[2]=a;return sa}function K(a,b){var c=a.k,e=c.Nh,d=c.yp,f=d[0],d=d[1];if(-1!=d){if(-1!=f){var k=a.ia[f];if(k.play||0==b){var h=O(k),p=h[0],n=h[1];c.ef=h[2];var h=k.Eb[p],q=k.Eb[n],p=k.trans[p],n=k.trans[n]}else e=1}else e=1;d=a.ia[d];if(d.play||0==b){var f=O(d),g=f[0],m=f[1];c.ef=f[2]}else if(-1!=
f&&k.play)e=0;else return;f=d.Eb[g];k=d.Eb[m];g=d.trans[g];m=d.trans[m];if(1==e)c.re.set(f),c.Ke.set(k),c.xe.set(g),c.Oe.set(m);else if(0==e)c.re.set(h),c.Ke.set(q),c.xe.set(p),c.Oe.set(n);else{for(d=0;d<h.length;d+=4){for(var v=J,t=ma,l=0;4>l;l++)v[l]=h[d+l],t[l]=f[d+l];aa.slerp(v,t,e,v);for(l=0;4>l;l++)c.re[d+l]=v[l];for(l=0;4>l;l++)v[l]=q[d+l],t[l]=k[d+l];aa.slerp(v,t,e,v);for(l=0;4>l;l++)c.Ke[d+l]=v[l]}xa.UG(p,g,e,c.xe);xa.UG(n,m,e,c.Oe)}ca.D(a);H.z0(a)}}function E(a,b){var c=a.k,e=c.Nh,d=c.pq;
if(0!=d){var e=c.oq-e,f=d*b;xa.sign(e)==xa.sign(d)&&Math.abs(f)<Math.abs(e)?c.Nh+=f:(c.Nh=c.oq,c.pq=0)}}function C(a){var b=[],c=[],e=new Float32Array(4),d=new Float32Array(4),f;for(f in a){var k=a[f],h=e,p=d,n=k.Ou,q=n[n.length-1],g=q.JE;q.dy||ra.identity(g);for(q=n.length-1;0<=q;q--){var m=n[q],v=m.JE;if(m.dy)g=v;else{var J=m.il,t=m.cy;ra.invert(J,ja);ra.multiply(t,ja,ja);ra.multiply(J,ja,ja);ra.multiply(g,ja,v);g=v;m.dy=!0}}n=m.JE;h[0]=n[0];h[1]=n[1];h[2]=n[2];h[3]=n[3];p[0]=n[4];p[1]=n[5];p[2]=
n[6];p[3]=n[7];aa.normalize(p,p);k=k.Uj;for(h=0;4>h;h++)p=4*k+h,b[p]=e[h],c[p]=d[h]}return{trans:b,Eb:c}}function Q(a,b,c){var e=[],d=[];new Float32Array(4);new Float32Array(4);for(var f in c)for(var k=c[f],h=k.Uj,k=k.hB,p=0;4>p;p++){var n=4*k+p,q=4*h+p;e[n]=a[q];d[n]=b[q]}e=new Float32Array(e);d=new Float32Array(d);return{trans:e,Eb:d}}function k(a){var b=a.s,c;if(b.jA)c=10;else if(b.qb)if("volume"in b.qb||"pitch"in b.qb)c=40;else if(G(a))c=60;else{var e;a:{if(a.s.qb){e=a.fcurves;for(var d in e)if("color"==
d&&!e[d][3]){e=!0;break a}if("energy"==d){e=!0;break a}}e=!1}if(e)c=70;else if(e=a.s.qb,"light_settings.environment_energy"in e||"horizon_color"in e||"zenith_color"in e||"mist_settings.intensity"in e||"mist_settings.depth"in e||"mist_settings.start"in e||"mist_settings.height"in e||"b4w_fog_color"in e)c=80;else{a:{if(a.s.qb)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function G(a){if(a=a.s.qb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;
return!1}function p(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function x(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function e(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==
c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function w(a,b,c,e,d,f,k){var h=a+(b-a)/2,p=n(h,e,d,f,k)-c;return.02>Math.abs(p)?h:0<p?w(a,h,c,e,d,f,k):w(h,b,c,e,d,f,k)}function n(a,b,c,e,d){var f=1-a;return b*f*f*f+3*c*f*f*a+3*e*f*a*a+d*a*a*a}function ea(a,b){var c={type:null,Ji:null,Sz:null,mG:0,kG:null,Ni:new Int8Array(8),Eb:null,trans:null,bE:[],play:!1,behavior:20,Gf:0,start:0,length:0,FE:0,pD:0,Ar:!1,fO:null,speed:1,volume:null,pitch:null,color:null,If:null,ye:null,oe:null,Er:null,fog_depth:null,fog_start:null,
fog_height:null,BI:null,bL:[],lj:[],aL:[],kj:[],Pw:null};if(!a.ia.length)for(var e=0;8>e;e++)a.ia.push(null);a.ia[b]=c;-1==qa.indexOf(a)&&qa.push(a)}function I(a,b){ca.D(a);ha.H(a);q(a,0,b,!0)}function F(a,c,e,k){k=k||0;if(P.ce(a)){var h=T(a,e);if(h)return ea(a,k),d(a,h,k),I(a,k),!0;if((h=M(a,e))&&"EMITTER"==h.Xw){ea(a,k);c=h.name;e=k;for(var h=a.I,p=0;p<h.length;p++)for(var n=h[p].X,q=0;q<n.length;q++){var g=n[q].gb;g&&g.name==c&&b(a.ia[e],g)}I(a,k);return!0}}if(h=xa.Gd("name",e,ta)||xa.Gd("name",
e+"_B4W_BAKED",ta)){ea(a,k);if(f(a,c,h,k))return I(a,k),!0;a.ia[k]=null}v.error('Unsupported object: "'+a.name+'" or animation name: "'+e+'"');return!1}function T(a,b){for(var c=0;c<a.$c.length;c++){var e=a.$c[c];if(e.name===b)return e}return null}function M(a,b){for(var c=a.I,e=0;e<c.length;e++)for(var d=c[e].X,f=0;f<d.length;f++){var k=d[f].gb;if(k&&k.name===b)return k}return null}function X(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}
var H=g("__armature"),fa=g("__config"),V=g("__lights"),P=g("__obj_util"),W=g("__particles"),ha=g("__physics"),v=g("__print"),aa=g("__quat"),Z=g("__reformer"),ba=g("__scenes"),ya=g("__sfx"),na=g("__subscene"),R=g("__time"),ca=g("__transform"),ra=g("__tsr"),xa=g("__util"),oa=g("__vec3"),Y=fa.Gl,ua=fa.Oi;a.mP=1E-6;a.FF=0;a.Hz=10;a.Iz=20;a.IF=30;a.HF=40;a.GF=50;a.EF=60;a.IP=70;a.HP=80;a.pd=0;a.OF=1;a.PF=2;a.QF=3;a.RF=4;a.SF=5;a.TF=6;a.ju=7;a.yl=-1;a.Ay=10;a.By=20;a.Cy=30;var sa=Array(3),N=new Float32Array(3),
ia=new Float32Array(3),J=new Float32Array(4),ma=new Float32Array(4),pa=new Float32Array(4),ja=ra.create();new Float32Array(16);var qa=[],ta=[];a.qJ=function(){return xa.trunc((ua.us-50)/4)};a.FI=function(a){return a/R.sd()};a.update=function(a){for(var b=0;b<qa.length;b++){for(var c=qa[b],e=0;8>e;e++)B(c,a,e);c.k.Ii&&(E(c,a),K(c,a))}for(b=0;b<qa.length;b++)for(c=qa[b],e=0;8>e&&c.ia.length;e++)l(c,e)};a.CV=function(){return ta};a.VI=function(a){var b=[];if(h(a))for(var c=0;c<a.$c.length;c++)b.push(a.$c[c].name);
for(var e=[],c=0;c<ta.length;c++){var d=ta[c],f=d.s;20==f.type?e.push(d):60==d.s.type&&"MESH"==a.type?e.push(d):10==f.type&&"ARMATURE"==a.type?e.push(d):40==f.type&&"SPEAKER"==a.type?e.push(d):80==f.type&&"WORLD"==a.type&&e.push(d)}for(c=0;c<e.length;c++)b.push(y(e[c].name));if(W.Ho(a)&&W.fL(a))for(a=a.I,c=0;c<a.length;c++)for(e=a[c].X,d=0;d<e.length;d++)(f=e[d].gb)&&b.push(f.name);return b};a.kN=y;a.WI=function(a,b){var c=a.ia[b];return c?c.type:0};a.yu=function(a){for(var c=0,e=a.I,k=0;k<e.length;k++)for(var p=
e[k].X,n=0;n<p.length;n++){var q=p[n].gb;q&&"EMITTER"==q.Xw&&!p[n].kg&&(ea(a,c),b(a.ia[c],q),I(a,c),a.ia[c].behavior=q.Ee?10:a.Fl,c++)}e=a.Wg.slice();for(k=0;k<e.length;k++)n=e[k],p=n.Go,n=n.action,ea(a,c),f(a,p,n,c)?(I(a,c),a.ia[c].behavior=a.Fl,c++):a.ia[c]=null;h(a)&&(ea(a,c),d(a,a.$c[0],c),I(a,c),a.ia[c].behavior=a.Fl)};a.Xz=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:xa.q("Wrong animation behavior")}};a.FV=function(a){var b=
[];a=a.data.materials;for(var c=0;c<a.length;c++){var e=a[c],d=e.node_tree;d&&A(d,b,[e.name])}return b};a.jK=r;a.play=function(a,b,c){m(a.ia,c,function(a){a.play=!0;a.AB=b?b:null;a.Ar=!1});a.k.Ii&&z(a)};a.stop=function(a,b){m(a.ia,b,function(a){a.play=!1;a.AB=null;a.Ar=!1})};a.Rf=function(a,b){var c=a.ia;if(-1==b)for(var e=0;8>e;e++){if(c[e]&&c[e].play)return!0}else if(c=c[b])return c.play;return!1};a.dn=u;a.MD=function(a,b){b=b||0;m(a.ia,b,function(c){u(a,c.start,b)})};a.fJ=function(a,b){var c=a.ia[b];
return c&&c.Gf?c.Gf:0};a.OW=function(a,b){var c=a.ia[b];return c&&10==c.behavior};a.cn=function(a,b,c){m(a.ia,c,function(a){a.behavior=b})};a.ZI=function(a,b){var c=a.ia[b];return c&&c.behavior};a.yG=function(a,b,c,e){m(a.ia,e,function(a){a.FE=b||0;a.pD=c||0})};a.ML=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.ia[c]=null;else a.ia[b]=null;a.k.Ii&&L(a,b)};a.q0=q;a.hL=function(a){if("ARMATURE"==a.type||a.Au||"WORLD"==a.type)return!0;for(var b=0;b<a.Wg.length;b++){var c=a.Wg[b].action.s.type;if(20==
c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return W.Ho(a)&&W.fL(a)||"MESH"==a.type&&a.$c.length?!0:!1};a.aH=function(a,b){if("ARMATURE"==b.type||X(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.Wg.length;c++){var e=b.Wg[c].action.s.type;if(20==e||10==e||40==e&&"SPEAKER"==b.type||60==e&&"MESH"==b.type)return!0}return W.VR(a)&&W.UR(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.yc=function(a){return Boolean(a.ia.length)};a.eS=C;a.SU=Q;a.XQ=function(a){function b(a,
c){for(var e=0;e<c;e++){var d=a.subarray(8*e+4,8*e+8);aa.normalize(d,d)}}function c(a,b){if(-1<a.indexOf("location"))var e=0,d=b;else-1<a.indexOf("rotation_quaternion")?(e=4,d=0==b?3:b-1):-1<a.indexOf("scale")?(e=3,d=0):(e=0,d=b);return e+d}function d(a,b,c,e,k){if(-1<c.search(f)){a=b;c=c.split('"')[1];var p=h}else 8==k?(c="tsr",p=h):p=1<k?new Float32Array(k):0;if(!a[c]){k=a;b=c;if("object"==typeof p&&p.length)for(var n=p.length,q=new Float32Array(e*n),g=0;g<e;g++)for(var m=0;m<n;m++)q[g*n+m]=p[m];
else if("number"==typeof p)for(q=new Float32Array(e),g=0;g<e;g++)q[g]=p;else xa.q("Wrong storage default value");k[b]=q}return a[c]}var f=new RegExp(/pose.bones\[\".+\"\]/g),h=ra.create(),n=a.s={type:0,WC:0,qL:0,qb:null,jA:null,RG:null,Ni:new Int8Array(8)};n.qL=1/Y.jm;var q=a.fcurves,g={},m={},v=0,J;for(J in q){var t=q[J],l;for(l in t){var w=t[l],H=w.Ef;Z.tS(w,a);w=w.num_channels;v||(v=H.length);for(var w=d(g,m,J,v,w),z=w.length/v,P=c(J,l|0),r=0;r<v;r++)w[r*z+P]=H[r]}}if(xa.Pr(g)){for(var u in g)"tsr"==
u&&b(g[u],v);n.qb=g}if(xa.Pr(m)){for(var V in m)b(m[V],v);n.jA=m}n.WC=v;n.RG=a.NQ;"tsr"in g&&p(q,n.Ni);("color"in g||"energy"in g)&&x(q,n.Ni);("light_settings.environment_energy"in g||"horizon_color"in g||"zenith_color"in g||"mist_settings.intensity"in g||"mist_settings.depth"in g||"mist_settings.start"in g||"mist_settings.height"in g||"b4w_fog_color"in g)&&e(q,n.Ni);k(a);ta.push(a)};a.EV=function(a,b){return(b-a)*Y.jm+1};a.wR=function(a,b,c,e,d,f){var k=new Float32Array(2),h=new Float32Array(2),
p=new Float32Array(2),q=new Float32Array(2),g=b[1],m=b[2],v=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var J=0,t=0,l=null;d<=f;d++)if(d<g)for(var H=0;H<Y.jm;H++)c[J++]=m;else if(d>v)for(H=0;H<Y.jm;H++)c[J++]=a;else{var x=b[t],z=3;0===x&&(z+=2);0===l&&(z+=2);var P=2===x?0:1;if(b[t+1]==b[t+z+1])l=x,t+=z;else{H=0;d==b[t+1]&&(P&&(e[J]=1),c[J]=b[t+2],J++,H++);if(d==v)for(;H<Y.jm;H++)c[J++]=a;else for(k[0]=b[t+1],k[1]=b[t+2],0!==x?(h[0]=0,h[1]=0):0===l?(h[0]=b[t+5],h[1]=b[t+6]):(h[0]=b[t+3],
h[1]=b[t+4]),0!==x?(p[0]=0,p[1]=0):(p[0]=b[t+z+3],p[1]=b[t+z+4]),q[0]=b[t+z+1],q[1]=b[t+z+2];H<Y.jm;H++){var r=d+H/Y.jm;switch(x){case 0:var u=k,V=h,C=p,aa=q,ca=[],Q=[],E=void 0,F=void 0,ua=void 0,E=void 0;ca[0]=u[0]-V[0];ca[1]=u[1]-V[1];Q[0]=aa[0]-C[0];Q[1]=aa[1]-C[1];ua=aa[0]-u[0];E=Math.abs(ca[0]);F=Math.abs(Q[0]);0!=E+F&&E+F>ua&&(E=ua/(E+F),V[0]=u[0]-E*ca[0],V[1]=u[1]-E*ca[1],C[0]=aa[0]-E*Q[0],C[1]=aa[1]-E*Q[1]);P&&(e[J]=1);c[J]=n(w(0,1,r,k[0],h[0],p[0],q[0]),k[1],h[1],p[1],q[1]);J++;break;case 1:P&&
(e[J]=1);u=k[0];V=k[1];C=(q[1]-V)/(q[0]-u);c[J]=C*r+(V-C*u);J++;break;case 2:P&&(e[J]=1);c[J]=b[t+2];J++;break;default:xa.q("Unknown keyframe interpolation mode: "+x)}}d+1==b[t+z+1]&&(l=x,t+=z)}}};a.apply=F;a.sR=function(a,b,c,e){e=e||0;var d=xa.Gd("uuid",c,ta);if(d){ea(a,e);if(f(a,b,d,e)){I(a,e);return}a.ia[e]=null}v.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.gO=function(a,b){var c=xa.Gd("name",b,ta)||xa.Gd("name",b+"_B4W_BAKED",ta);if(c){if(0==c.s.type)return!1}else if(!(M(a,
b)||P.ce(a)&&T(a,b)))return!1;return!0};a.Mv=function(a,b){for(var c=a.ia,e=0;e<c.length;e++){var d=c[e];if(d&&y(d.Ji)==y(b))return e}return-1};a.DV=function(a,b){var c=a.ia[b];return c&&c.Ji?y(c.Ji):null};a.remove=function(a){a.ia.length=0;a=qa.indexOf(a);-1!=a&&qa.splice(a,1)};a.HY=function(a){for(var b=ta.length-1;0<=b;b--)ta[b].OQ==a&&ta.splice(b,1)};a.zG=function(a,b){if(!a.ia.length)return F(a,b,0)?0:-1;for(var c=0;c<a.ia.length;c++)if(!a.ia[c])return F(a,b,c)?c:-1};a.xM=function(a,b,c){a.k.pq=
(b-a.k.Nh)/c;a.k.oq=b};a.zM=function(a,b,c){m(a.ia,c,function(a){a.speed=b})};a.JJ=function(a,b){return a.ia[b].speed};a.GB=function(a,b){return a.ia[b].start};a.Cv=function(a,b){return a.ia[b].length};a.ua=function(){qa.length=0;ta.length=0};a.YU=function(a){var b=(a[0]||a[1]||a[2]).Ef.length,c=J,e=N,d=Boolean(a[0]);d||(a[0]={Ef:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={Ef:new Float32Array(b),num_channels:8});var k=Boolean(a[2]);k||(a[2]={Ef:new Float32Array(b),num_channels:8});
a[3]={Ef:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)e[0]=d?a[0].Ef[h]:0,e[1]=f?a[1].Ef[h]:0,e[2]=k?a[2].Ef[h]:0,xa.gk(e,c),a[0].Ef[h]=c[3],a[1].Ef[h]=c[0],a[2].Ef[h]=c[1],a[3].Ef[h]=c[2]};a.aJ=X;a.a_=function(a,b){for(var c=7,e=0,d=0;d<ta.length;d++){var f=ta[d];if(f.name==b){e=f.s.type;break}}0==e&&(T(a,b)?e=30:(d=M(a,b))&&"EMITTER"==d.Xw&&(e=50));for(d=0;8>d;d++)if(f=a.ia[d]){if(f.type==e)return d}else d<c&&(c=d);return c}};b4w.module.__lights=function(a,g){function l(a){y.scale(a.color,a.If,a.ar)}g("__print");var d=g("__tsr"),b=g("__util"),y=g("__vec3"),r=new Float32Array(3);new Float32Array(3);a.bX=function(a,h){var g=a.data,m=h.tb={name:"",type:g.type,wL:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),ar:new Float32Array(3),kI:0,PE:!1,ln:0,kt:0,Tq:.1,Sq:30,QI:!1,$K:!1,sI:!1,qn:!0,sn:!0,If:1,distance:25,p5:"INVERSE_SQUARE"};m.name=h.name;m.qn=g.use_diffuse;m.sn=g.use_specular;var q=d.P(h.k.n),
q=b.mc(q,b.nc,r);y.normalize(q,q);m.direction.set(q);m.color[0]=g.color[0];m.color[1]=g.color[1];m.color[2]=g.color[2];m.If=m.kI=g.energy;l(m);m.distance=g.distance;m.PE=g.use_sphere;m.Tq=g.clip_start;m.Sq=g.clip_end;if("POINT"===m.type||"SPOT"===m.type)m.distance=g.distance;"SPOT"===m.type?(m.kt=g.spot_blend,m.ln=g.spot_size):"POINT"===m.type&&(m.ln=Math.PI/2);m.QI=g.b4w_generate_shadows;m.sI=g.b4w_dynamic_intensity};a.Ax=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];l(a)};a.zZ=function(a,
b){a.kt=b};a.yZ=function(a,b){a.distance=b};a.AZ=function(a,b){a.ln=b};a.$s=function(a,b){a.If=b;l(a)};a.o0=function(a){var h=a.tb;if(h){a=d.P(a.k.n);b.mc(a,b.nc,h.direction);y.normalize(h.direction,h.direction);if("SUN"==h.type){a=Math.acos(y.dot(h.wL,b.Oz));var g=Math.acos(y.dot(h.direction,b.Oz));h.$K=Math.floor(a/.025)!=Math.floor(g/.025)?!0:!1}y.copy(h.direction,h.wL)}}};b4w.module.__obj_util=function(a,g){function l(a){a={type:a,$e:0,n:h.Wl(),zy:h.Wl(),pivot:new Float32Array(3),Vb:new Float32Array(3),qk:0,rk:0,mw:!1,nw:!1,Yj:null,sh:0,el:!1,vf:m.create(),use_panning:!1,ub:0,pl:1,ol:1,ql:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Ed:!1,dof_object:null,lb:null,ka:null,sb:null,Dc:null,Cc:null,ge:null,Vh:!0,hi:{Gk:1,Hk:1,Ik:0},Vd:-1,Hd:-1,rc:new Float32Array(4),lm:0,fm:0,wo:!1,ss:new Float32Array(3),
ts:0,lf:-1,mh:0,nh:0,ao:!1,Me:!1,je:!1,ve:!1,he:!1,Kd:!1,Jd:!1,vh:"",xf:!1,gg:!1,jd:!1,ai:!1,Sk:!1,Vw:!1,Wc:!1,Uw:!1,Ww:!1,Em:!1,Im:!1,Gr:!1,zn:0,Dh:0,Eh:0,Yg:0,Xg:0,Rg:0,ej:"",Fe:{tC:"",sC:"",bD:""},Kl:!1,Mq:new Float32Array(3),Og:!1,Cq:!1,Eq:"",Dq:!1,ef:0,ly:0,my:0,oh:0,km:!1,$c:!1,Qe:!1,qi:[],vk:!1,Ii:!1,Nh:1,pq:0,oq:1,yp:new Int8Array([-1,-1]),fp:[],Fw:[],Kx:[],re:null,Ke:null,xe:null,Oe:null,Pg:null,Li:null,Ks:null,uq:null,tq:null,Jl:null,S:r.Ud(),Ta:r.Ud(),wa:r.Sh(),kb:r.Sh(),ba:r.Tg(),pb:r.Tg(),
Bd:r.Zu(),MG:r.Zu(),Aq:null,yq:null,zq:null,Bp:!0,Zf:!1,bx:0};m.copy(u.nc,a.vf);return a}function d(a){if(!(a instanceof Object))return a;var b=null,f=null,h=null,g=null,q=null,m=null;a.ya&&(b=a.ya,a.ya=null);a.Od&&(f=a.Od,a.Od=null);a.Qg&&(h=a.Qg,a.Qg=null);a.ib&&(g=a.ib,a.ib=null);a.zb&&(q=a.zb,a.zb=null);a.Re&&(m=a.Re,a.Re=null);var l;l=a.constructor;switch(l){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:l=
new l(a);break;case Array:l=new l(a.length);for(var r=0;r<a.length;r++)l[r]=d(a[r]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:l=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:l=null;break;case Function:l=a;break;default:for(r in l=new l,a)l[r]=d(a[r])}b&&(l.ya=b,a.ya=b);f&&(l.Od=f,a.Od=f);h&&(l.Qg=h,a.Qg=h);g&&(l.ib=g,a.ib=g);q&&(l.zb=q,a.zb=q);m&&(l.Re=u.bk(),a.Re=m);return l}function b(a,b){for(var d=a.I,f=0;f<d.length;f++){var h=d[f];if(h.yb==b)return h}return null}
function y(a){return a.Lk?a.parent:a.parent?y(a.parent):null}var r=g("__boundings"),A=g("__config"),h=g("__tsr"),u=g("__util"),m=g("__vec3"),q=g("__vec4"),f=A.B;new Float32Array(4);new Float32Array(4);new Float32Array(4);h.create();h.create();a.bq=-1;a.ir=l;a.BA=function(a){var b=l(a.type);b.$e=a.$e;h.copy(a.n,b.n);h.copy(a.zy,b.zy);m.copy(a.pivot,b.pivot);m.copy(a.Vb,b.Vb);b.qk=a.qk;b.rk=a.rk;b.mw=a.mw;b.nw=a.nw;a.Yj&&(b.Yj=m.clone(a.Yj));b.sh=a.sh;b.el=a.el;m.copy(a.vf,b.vf);b.use_panning=a.use_panning;
b.ub=a.ub;b.pl=a.pl;b.ol=a.ol;b.ql=a.ql;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Ed=a.Ed;b.dof_object=a.dof_object;b.lb=u.T(a.lb);b.ka=u.T(a.ka);b.sb=u.T(a.sb);b.Dc=u.T(a.Dc);b.Cc=u.T(a.Cc);b.ge=a.ge;b.Vh=a.Vh;b.hi.Gk=a.hi.Gk;b.hi.Hk=a.hi.Hk;b.hi.Ik=a.hi.Ik;b.Vd=a.Vd;b.Hd=a.Hd;b.rc=a.rc;
b.lm=a.lm;b.fm=a.fm;b.wo=a.wo;m.copy(a.ss,b.ss);b.ts=a.ts;b.lf=a.lf;b.mh=a.mh;b.nh=a.nh;b.ao=a.ao;b.Me=a.Me;b.je=a.je;b.ve=a.ve;b.he=a.he;b.Kd=a.Kd;b.Jd=a.Jd;b.vh=a.vh;b.xf=a.xf;b.gg=a.gg;b.jd=a.jd;b.ai=a.ai;b.Sk=a.Sk;b.Vw=a.Vw;b.Wc=a.Wc;b.Uw=a.Uw;b.Ww=a.Ww;b.Em=a.Em;b.Im=a.Im;b.Gr=a.Gr;b.zn=a.zn;b.Dh=a.Dh;b.Eh=a.Eh;b.Yg=a.Yg;b.Xg=a.Xg;b.Rg=a.Rg;b.ej=a.ej;b.Fe=a.Fe;b.Kl=a.Kl;m.copy(a.Mq,b.Mq);b.Og=a.Og;b.Cq=a.Cq;b.Eq=a.Eq;b.Dq=a.Dq;b.ef=a.ef;b.ly=a.ly;b.my=a.my;b.oh=a.oh;b.km=a.km;b.$c=a.$c;b.Qe=
a.Qe;b.qi=u.T(a.qi);b.vk=a.vk;b.Ii=a.Ii;b.Nh=a.Nh;b.pq=a.pq;b.oq=a.oq;b.yp.set(a.yp);b.fp=u.T(a.fp);b.Fw=u.T(a.Fw);b.Kx=u.T(a.Kx);b.re=u.T(a.re);b.Ke=u.T(a.Ke);b.xe=u.T(a.xe);b.Oe=u.T(a.Oe);b.Pg=u.T(a.Pg);b.Li=u.T(a.Li);b.Ks=u.T(a.Ks);b.uq=u.T(a.uq);b.tq=u.T(a.tq);b.Jl=u.T(a.Jl);r.Tn(a.S,b.S);r.Tn(a.Ta,b.Ta);r.JA(a.wa,b.wa);r.JA(a.kb,b.kb);r.HA(a.ba,b.ba);r.HA(a.pb,b.pb);b.Aq=u.T(a.Aq);b.yq=u.T(a.yq);b.zq=u.T(a.zq);b.Bp=a.Bp;b.Zf=a.Zf;b.bx=a.bx;return b};a.hr=function(a,b,d){d||(d=a);return{name:a,
Fj:u.DB(),Rm:d,type:b,Vj:!1,Ra:!1,ds:!1,ut:!1,k:null,pc:null,Y:null,tb:null,Au:null,anchor:null,ho:null,Hw:null,I:[],$c:[],Ze:u.bk(),GA:u.bk(),ia:[],Rs:[],tg:[],tu:[],yh:null,bn:[],parent:null,Lk:!1,Ds:"",sy:null,cx:null,rn:!1,cc:"",Vu:"AUTO",gf:!1,og:!1,Dm:!1,ZG:!1,C:null,v:null,ig:null,uf:null,io:null,oH:null,hD:[],th:{Gs:"NO_COLLISION",wt:!1,eO:!1,fi:0,kO:0,jO:0,gI:0,TL:0,xX:!1,yX:!1,zX:!1,AX:!1,BX:!1,CX:!1,Zq:0,Xq:0,$q:0,OE:!1,Ru:"BOX",st:!1},jL:{Zx:0,$C:0,Tf:0,uD:0},Fl:0,Wg:[],TC:!1,ZK:!1,Gw:[]}};
a.IA=function(a){return a instanceof Array?a.slice():a};a.q4=function(a){for(var b=[],f=0;f<a.length;f++){var h=a[f],g={},q;for(q in h)h[q]==h.Ta?g.Ta=d(h.Ta):h[q]==h.pb?g.pb=d(h.pb):g[q]=h[q];b.push(g)}return b};a.Uu=d;a.Ra=function(a){return a.Ra};a.PW=function(a){return"MESH"==a.type&&a.Ra};a.sq=function(a,b){a.I.push({yb:b,lw:!1,X:[],ii:[],Ri:null,ZD:[],Km:0,gL:!1,da:[],NM:[]})};a.wu=function(a,c,d){b(a,c).X.push(d)};a.Y8=function(a,b){for(var d=a.I,f=0;f<d.length;f++)if(d[f].yb==b){d.splice(f,
1);break}};a.ja=b;a.TN=function(a,b){for(var d=0;d<a.length;d++)q.copy(b,a[d].k.rc)};a.HD=function(a,b,d){for(var f=0;f<a.I.length;f++){var h=a.I[f];d&&h.yb!=d||(h.lw=b)}};a.Lv=function(a,b){for(var d=[],h=b?f.RK-1:f.RK,g=0;g<a.length;g++){var q=a[g];q.tb.QI&&d.length<h&&d.push(q)}return d.length?d:a[0]?[a[0]]:[]};a.TX=function(a,b){h.identity(b.n);b.Yj=null;a.k=b};a.tH=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var d=b.material-1,f=a.data.materials;if(0<=d&&d<f.length&&
("ADD"==f[d].game_settings.alpha_blend||"ALPHA"==f[d].game_settings.alpha_blend||"ALPHA_SORT"==f[d].game_settings.alpha_blend))return!0}return!1};a.FS=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].X,f=0;f<d.length;f++)for(var h=d[f].hb.Ui,g=0;g<h.length;g++){var q=h[g];if("USE_MODEL_TSR_INVERSE"==q[0]&&"1"==q[1])return!0}return!1};a.MI=function(a,b){return a+"*"+b};a.wJ=function(a){return a.Lk?null:a.parent};a.Yi=y;a.JB=function(a,b){for(var d=[],f=0;f<b.length;f++){var h=b[f];y(h)==
a&&d.push(h)}return d};a.PB=function(a){return a.k.$e};a.ce=function(a){return"MESH"===a.type};a.Bm=function(a){return"ARMATURE"===a.type};a.gs=function(a){return"SPEAKER"===a.type};a.xa=function(a){return"CAMERA"===a.type};a.jh=function(a){return"LAMP"===a.type};a.vo=function(a){return"EMPTY"===a.type};a.X7=function(a){return"LINE"===a.type};a.pC=function(a){return"WORLD"===a.type}};b4w.module.__physics=function(a,g){function l(a,b){for(var c=a.Ze,e=0;e<c.length;e++)c[e].th.st&&b.push(c[e]),l(c[e],b)}function d(a,b,c){for(var e=a.Ac.sa,d=0;d<e.length;d++)for(var f=e[d].C,k=0;k<f.Ye.length;k++){var h=f.Ye[k];"ANY"!=h.cc&&c!=h.cc||O(h,a,b)}}function b(a,b,c){if(F.lw(a))switch(b){case F.WO:var e=y(a);e.Ac.vO=!0;F.ga(a,F.hQ,Date.now()-performance.now(),Z.max_fps,Z.pA?ba.DI:0);break;case F.XO:M.ee("URANIUM:",c.slice(1));break;case F.SO:M.error(c);break;case F.TO:I.tv.apply(this,c.slice(1));
break;case F.bP:var d=r(c.ea);if(d){a=c.trans;e=c.quat;b=c.di;var f=c.Mh,d=d.C;d.ev=c.time;P.Ag(a,1,e,d.cB);ha.copy(b,d.di);ha.copy(f,d.Mh)}break;case F.ZO:(a=r(c.vA))&&P.Ag(c.trans,1,c.quat,a.v.Ls[c.nD]);break;case F.UO:if(e=r(c[1]))a=c[4],e=e.ig.Iu[c[2]],V.Xc(e,c[3]),V.pi(e,a),V.D(e);break;case F.cP:if(d=r(c[1]))d.v.speed=c[2];break;case F.OO:e=y(a);A(e,c.Ll,c.Ml,c.result,null,null,0);break;case F.QO:e=y(a);A(e,c.Ll,c.Ml,c.result,c.Ul,c.coll_norm,c.coll_dist);break;case F.PO:if(d=r(c[1]))a=d.C,
a.Tl&&a.Tl(c[2]);break;case F.mF:case F.$O:e=y(a);if(a=e.Ac.Mk[c.id])if(e=r(c.Pn),b==F.mF)b=a.callback,b(a.id,c.hit_fract,e,c.hit_time);else{b=c.hit_fract;var f=c.hit_time,d=c.hit_pos,k=a.callback;d?k(a.id,b,e,f,d,c.hit_norm):k(a.id,b,e,f)}break;case F.aP:C(id);break;case F.YO:a=R.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case F.VO:na=c[1];break;case F.RO:a=R.indexOf(a);
console.log("Worker: #"+String(a));console.log(c[1]);break;default:M.error("Wrong message: "+b)}}function y(a){for(var b=0;b<R.length;b++)if(R[b]==a)return ca[b]}function r(a){return ra[a]||null}function A(a,b,c,e,d,f,k){a=a.Ac.sa;for(var p=0;p<a.length;p++)for(var n=a[p].C,g=0;g<n.Ye.length;g++){for(var q=n.Ye[g],m=q.Kk,v=!1,l=0;l<m.length;l++){var w=m[l];if(w[0]===b&&w[1]===c){q.Cs[l]=e;v=!0;break}}v&&(m=h(q),d&&q.iA!=b&&(v=d,l=f,w=k,v[0]+=l[0]*w,v[1]+=l[1]*w,v[2]+=l[2]*w,l[0]*=-1,l[1]*=-1,l[2]*=
-1),q.callback(m,m?q.iA==b?r(c):r(b):null,d,f,k))}}function h(a){a=a.Cs;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function u(){Y.body++;return Y.body}function m(a){var b=oa.indexOf(a);return-1==b?(oa.push(a),oa.length-1):b}function q(a,b){return{ea:a,type:b,fi:0,ow:!1,Zk:!0,gf:!1,og:!1,QW:!1,Tu:null,cc:"",Yq:0,n4:{},Ye:[],Tl:null,ev:0,cB:new Float32Array([0,0,0,1,0,0,0,1]),di:new Float32Array(3),Mh:new Float32Array(3),Ku:new Float32Array(3),Jq:new Float32Array(4),ws:null}}function f(a,b){switch(a){case "BOX":var c=
b.S;break;case "CYLINDER":c=b.Aq;break;case "CONE":c=b.zq;break;case "SPHERE":c=b.wa;break;case "CAPSULE":c=b.yq}return c}function t(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.G&&(b.center=a.G);"number"===typeof a.Xa&&(b.radius=
a.Xa);"number"===typeof a.height&&(b.height=a.height);return b}function c(a,b,c,e,d){var f=P.F(a.k.n),k=P.invert(b.k.n,N),h=new Float32Array(3);P.Gc(f,k,h);switch(b.v.type){case 10:b=b.uf;a=a.k.S;F.ga(d,F.LP,c,h,b.C_,b.DD,(a.max_z-a.min_z)/2,e);break;case 20:F.ga(d,F.KP,c,h,a.x$)}}function z(a){return a.C&&a.C.Tu}function L(a,b,c,e,d,f,k,h,p,n){var g;Y.pc++;g=Y.pc.toString(16);var q=b.C.ea;F.ga(D(q),F.SP,g,a,h,q,c,e,d.C.ea,f,k,p,n);b.C.Tu=g}function D(a){for(var b=0;b<ca.length;b++)for(var c=ca[b].Ac.sa,
e=0;e<c.length;e++)if(c[e].C.ea==a)return R[b];return null}function G(a){var b=a.C;if(b=b?0===b.fi?!0:!0===b.ow?!0:!1===b.Zk?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=P.ic(a.k.n,ua),c=P.ae(a.k.n,sa),b=b[0]!=a.C.Ku[0]||b[1]!=a.C.Ku[1]||b[2]!=a.C.Ku[2]||c[0]!=a.C.Jq[0]||c[1]!=a.C.Jq[1]||c[2]!=a.C.Jq[2]||c[3]!=a.C.Jq[3];if(b){var b=a.C,e=a.k,c=F.sJ(F.fu);c.ea=b.ea;var d=P.ic(e.n,c.trans),e=P.ae(e.n,c.quat);ha.copy(d,b.Ku);X.copy(e,b.Jq);"DYNAMIC"==b.type&&X.identity(c.quat);F.ga(D(b.ea),
F.fu)}a=a.Ze;for(b=0;b<a.length;b++)G(a[b])}function B(a,b,c,e,d){d=d||new Float32Array(3);a=P.P(a.k.n);d[0]=b;d[1]=c;d[2]=e;ha.transformQuat(d,a,d)}function O(a,b,c){var e=a.Kk,d=a.Cs,f=a.iA,k=[],h=a.cc;k||W.q("At least one destination required");for(var p=0;p<b.Ac.sa.length;p++){var n=b.Ac.sa[p];if("ANY"==h||n.C.cc==h&&"NAVMESH"!=n.C.type)n=n.C.ea,k&&-1==k.indexOf(n)&&k.push(n)}for(b=0;b<k.length;b++)h=k[b],f<h&&!K(e,f,h)?(e.push([f,h]),d.push(!1)):f>h&&!K(e,h,f)&&(e.push([h,f]),d.push(!1));F.ga(c,
F.JP,f);F.ga(c,F.RP,e,a.Ph)}function K(a,b,c){for(var e=0;e<a.length;e++)if(a[e][0]==b&&a[e][1]==c)return!0;return!1}function E(a){a.C&&a.C.Tl&&(a=a.C,F.ga(D(a.ea),F.dQ,a.ea),a.Tl=null)}function C(a){var b=k(a),c=Q(a).Ac;c.Mk[a]&&(delete c.Mk[a],c.rD.splice(c.rD.indexOf,1),F.ga(b,F.mQ,a))}function Q(a){for(var b=0;b<ca.length;b++){var c=ca[b];if(c.Ac.Mk[a])return c}return null}function k(a){for(var b=0;b<ca.length;b++)if(ca[b].Ac.Mk[a])return R[b];return null}function p(a,b,c){if(b.op){a=a.C.ea;var e=
b.eo*b.Fr,d=b.Hq*b.Iq,f=-b.mp*b.np*2*Math.PI/b.lt;b.bs&&(f*=-1);switch(b.type){case 10:F.ga(c,F.zQ,a,e,d,f);break;case 20:F.ga(c,F.yQ,a,e,d,f)}}}function x(a){return a.gf&&"CHASSIS"==a.uf.nf}function e(a){return a.gf&&"HULL"==a.uf.nf}function w(a){return"NAVMESH"==a.th.Gs}function n(a){return a.Dm&&"MAIN_BODY"==a.io.nf}var ea=g("__config"),I=g("__debug"),F=g("__ipc"),T=g("__obj_util"),M=g("__print"),X=g("__quat"),H=g("__scenes"),fa=g("__subscene"),V=g("__transform"),P=g("__tsr"),W=g("__util"),ha=
g("__vec3"),v=g("__version"),aa=g("__navmesh"),Z=ea.C,ba=ea.B,ya=ea.Td,na=0,R=[],ca=[],ra={},xa=[],oa=["ANY"],Y={body:0,pc:0,IL:0},ua=new Float32Array(3);new Float32Array(4);var sa=new Float32Array(4);new Float32Array(16);var N=P.create(),ia=P.create();a.GW=function(a){a.Ac={vO:!1,sa:[],Mk:{},rD:[]};var c=Z.rt;ya.prevent_caching&&(c+=v.timestamp());M.log("%cLOAD PHYSICS","color: #0a0",Z.At?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+Z.max_fps);M.log("%cPHYSICS PATH","color: #0a0",
c);var e=F.dU(c,!Z.At);F.FR(e,b);R.push(e);ca.push(a);Z.ping&&setInterval(function(){F.ga(e,F.jQ,performance.now())},1E3)};a.KS=function(a){return a.Ac?a.Ac.vO:!0};a.ua=function(){for(var a=0;a<R.length;a++)F.terminate(R[a]);R.length=0;ca.length=0;ra={};xa.length=0;oa.length=0;for(var b in Y)Y[b]=0};a.Ln=function(a,b){a.k||W.q("No object render: "+a.name);var k;a:{for(var h=0;h<ca.length;h++)if(ca[h]==b){k=R[h];break a}k=void 0}var g=[];a.th.st&&l(a,g);var v=b.Ac.sa;if(x(a)||e(a)||a.og||n(a)||a.rn){var H=
w(a),r;if(H){var Y=a,V=u(),C=q(V,"NAVMESH"),Q=T.ja(Y,b).X;C.ws=null;for(var E=0;E<Q.length;E++){var ua=Q[E];if("PHYSICS"==ua.type){C.ws=aa.ZX(ua.Ca);break}}r=C}else{var fa=a,D=k,ba=fa.k,B=fa.th,I=B.Gs,ha=u();if("CAMERA"==fa.type)var Z=B.OE?B.Ru:"BOX",G=f(Z,ba),y=ba.lm,K=ba.fm,y=.5,K=0;else if("EMPTY"==fa.type)Z="EMPTY",G=null,K=y=0;else{var Z=B.OE?B.Ru:"BOX",G=f(Z,ba),O=P.td(ba.n);if(1!=O){var A=G;switch(Z){case "BOX":A.min_x*=O;A.max_x*=O;A.min_y*=O;A.max_y*=O;A.min_z*=O;A.max_z*=O;break;case "CYLINDER":case "CONE":case "CAPSULE":A.height*=
O;A.Xa*=O;break;case "SPHERE":A.Xa*=O}}y=ba.lm;K=ba.fm}var oa=P.F(ba.n),ea=P.P(ba.n),ya=B.wt,na=B.eO,rb=B.fi,Ta=B.kO,Ba=B.jO,bb=B.gI,Xa=B.TL,Ja=fa.cc,hb=m(Ja),eb=B.Zq,cb=B.Xq,nb=B.$q,ib=ba.wa.Xa,ob=t(G),yb=fa.Vu,Ua;var Nb=Z;if(g.length){var lc=[],Xb={};Xb.quat=new Float32Array([0,0,0,1]);Xb.trans=new Float32Array(3);Xb.worker_bounding=ob;Xb.bounding_type=Nb;lc.push(Xb);var sb=P.invert(ba.n,N),pd=sa,Jb=P.P(ba.n);X.invert(Jb,pd);for(var jb=0;jb<g.length;jb++){var ec={},Ec=g[jb],ad=Ec.th.Ru,tc=new Float32Array(4),
Oc=new Float32Array(3),fc=P.F(Ec.k.n),Xc=P.P(Ec.k.n);P.Gc(fc,sb,Oc);X.multiply(pd,Xc,tc);ec.trans=Oc;ec.quat=tc;ec.bounding_type=ad;ec.worker_bounding=t(f(ad,Ec.k));lc.push(ec)}Ua=lc}else Ua=[];F.ga(D,F.OP,ha,oa,ea,I,ya,na,rb,Ta,Ba,bb,Xa,hb,eb,cb,nb,Z,ob,ib,y,K,Ua,yb);ra[ha]=fa;xa.push(fa);var kb=q(ha,"BOUNDING");kb.type=I;kb.fi=rb;kb.ow=ya;kb.cc=Ja;kb.Yq=hb;r=kb}var Va=r;a.C=Va;var pb={za:null,C:Va};H||(v.push(pb),d(b,k,Va.cc))}else for(var Pc=T.ja(a,b).X,Qc=0;Qc<Pc.length;Qc++){var Ob=Pc[Qc],uc;
if(uc="PHYSICS"==Ob.type){var jd;a:{for(var vc=b.Ac.sa,kd=0;kd<vc.length;kd++){var bd=vc[kd].za;if(bd&&bd.id==Ob.id){jd=!0;break a}}jd=!1}uc=!jd}if(uc)if(Ob.Vf.Ja)if(Ob.Ij&&b.s.Mc){var Zb=Ob,cd=b,Eb=k,qb=cd.s.Mc;F.ga(Eb,F.XP,qb.tl);if(Zb.$0){var lb={};lb.dst_noise_scale0=Zb.dst_noise_scale0;lb.dst_noise_scale1=Zb.dst_noise_scale1;lb.dst_noise_freq0=Zb.dst_noise_freq0;lb.dst_noise_freq1=Zb.dst_noise_freq1;lb.dir_min_shore_fac=Zb.dir_min_shore_fac;lb.dir_freq=Zb.dir_freq;lb.dir_noise_scale=Zb.dir_noise_scale;
lb.dir_noise_freq=Zb.dir_noise_freq;lb.dir_min_noise_fac=Zb.dir_min_noise_fac;lb.dst_min_fac=Zb.dst_min_fac;lb.waves_hor_fac=Zb.waves_hor_fac;var mb=qb.waves_height,Yc=qb.waves_length;qb.Yk?F.ga(Eb,F.JF,lb,qb.ep[0],qb.ep[1],qb.dp[0],qb.dp[1],qb.EC,mb,Yc,qb.aE,cd.s.$D):F.ga(Eb,F.JF,lb,0,0,0,0,0,mb,Yc,0,null)}}else{var wc;if(Ob.wt){var gc=a,Fb=Ob,$b=k,xc=u(),Rb=Fb.Vf,hc=Rb.aa[0].a_position,yc=Rb.na||null,tb=Fb.cc,$a=m(tb),Ic=Fb.Zq,dd=Fb.Xq,Gb=Fb.$q,Yb=P.F(gc.k.n);F.ga($b,F.UP,xc,hc,yc,Yb,$a,Ic,dd,Gb);
var gb=q(xc,"STATIC_MESH");gb.ow=!0;gb.cc=tb;gb.Yq=$a;wc=gb}else{var ub=a,zb=Ob,Zc=k,Rc=u(),ic=zb.Vf,mc=ic.aa[0].a_position,Kb=ic.na||null,nc=P.F(ub.k.n),oc=zb.lm,Sc=zb.fm,zc=zb.cc,pc=m(zc);F.ga(Zc,F.WP,Rc,mc,Kb,nc,oc,Sc,pc,zb.Zq,zb.Xq,zb.$q);var Lb=q(Rc,"STATIC_MESH");Lb.cc=zc;Lb.Yq=pc;wc=Lb}Va=wc;a.C=Va;pb={za:Ob,C:Va};v.push(pb);d(b,k,Va.cc)}else M.error("Object "+a.name+" has collision material with no assigned vertices")}if(x(a)||e(a)){var Ya=a,Pa=k,Sb=Ya.C.ea;x(Ya)?(Ya.v.type=10,F.ga(Pa,F.PP,
Sb,Ya.v.lE,Ya.v.nE,Ya.v.mE,Ya.v.ZE,Ya.v.FC)):e(Ya)&&(Ya.v.type=20,F.ga(Pa,F.NP,Sb,Ya.v.im,Ya.v.wn,Ya.v.xn));if(Ya.v.Ym){var jc=Ya.v.Ym;switch(Ya.v.type){case 10:c(jc[0],Ya,Sb,!0,Pa);c(jc[1],Ya,Sb,!0,Pa);c(jc[2],Ya,Sb,!1,Pa);c(jc[3],Ya,Sb,!1,Pa);break;case 20:for(var Wa=0;Wa<jc.length;Wa++)c(jc[Wa],Ya,Sb,!1,Pa)}}p(a,a.v,k)}else if(a.og){var Ab=k,Mb=a.k,Tb=a.C,ac=Mb.S.max_z-Mb.S.min_z,Hb=Tb.ea,Bb=a.oH,ab=Bb.Z0,Cb=Bb.cZ,Ka=Bb.v_,bc=Bb.aX,Ma=Bb.a1,cc=W.tU(a);F.ga(Ab,F.QP,Hb,cc,ac,ab,Cb,Ka,bc,Ma);Tb.og=
!0}else if(n(a)){var Ha=a,wb=k,Pb=Ha.C.ea;F.ga(wb,F.TP,Pb,Ha.ig.im,Ha.ig.wn,Ha.ig.xn);if(Ha.ig.Iu)for(var Ub=Ha.ig.Iu,qc=0;qc<Ub.length;qc++){var Jc=Ub[qc],kc=P.F(Jc.k.n),ld=P.invert(Ha.k.n,N),ed=new Float32Array(3);P.Gc(kc,ld,ed);F.ga(wb,F.MP,Pb,ed,Jc.ZG)}Ha.C.QW=!0}for(Qc=0;Qc<xa.length;Qc++)if(a=xa[Qc],a.C){var Kc=a;if(!z(Kc))for(var Fc=0;Fc<Kc.hD.length;Fc++){var rc=Kc.hD[Fc],db=rc.target,Lc=rc.nY;if(db.C){var Tc=new Float32Array([rc.oY,rc.pY,rc.qY]),Gc,Db=new Float32Array([rc.Ga,rc.Ha,rc.Ia]);
Gc=W.gk(Db,new Float32Array(4));var Vb=P.identity(N),Vb=P.ue(Tc,Vb),Vb=P.oi(Gc,Vb),Ac=P.multiply(Kc.k.n,Vb,N),Qb=P.invert(db.k.n,ia),vb=P.multiply(Qb,Ac,Qb),Uc=P.F(vb),Vc=P.P(vb),fb=rc,Za={};Za.use_limit_x=fb.L0;Za.use_limit_y=fb.M0;Za.use_limit_z=fb.N0;Za.use_angular_limit_x=fb.H0;Za.use_angular_limit_y=fb.I0;Za.use_angular_limit_z=fb.J0;Za.limit_max_x=fb.nX;Za.limit_min_x=fb.qX;Za.limit_max_y=fb.oX;Za.limit_min_y=fb.rX;Za.limit_max_z=fb.pX;Za.limit_min_z=fb.sX;Za.limit_angle_max_x=fb.hX;Za.limit_angle_min_x=
fb.kX;Za.limit_angle_max_y=fb.iX;Za.limit_angle_min_y=fb.lX;Za.limit_angle_max_z=fb.jX;Za.limit_angle_min_z=fb.mX;L(Lc,Kc,Tc,Gc,db,Uc,Vc,Za,null,null)}}}};a.bV=r;a.update=function(a,b){for(var c=0;c<R.length;c++){var e=R[c],d=a;e&&F.sK(e)&&F.ga(e,F.AQ,d,b);for(var f=0;f<xa.length;f++){var k=xa[f],h=k.C;if(h.Zk&&h.ev){var p=F.sK(e)?d-h.ev:performance.now()/1E3-h.ev,p=Math.min(p,10/Z.max_fps),p=p-1/Z.max_fps;ba.aY&&(p=0);var n=N;P.JW(h.cB,p,h.di,h.Mh,N);V.vj(k,n);V.D(k);G(k);if(k.v)for(var h=k,p=h.v.Ym,
n=h.k.n,g=N,q=0;q<p.length;q++){var m=p[q];P.multiply(n,h.v.Ls[q],g);V.vj(m,g);V.D(m)}k.v&&k.v.op&&(g=k,p=g.v,h=p.op)&&(q=g.v.fN,P.multiply(g.k.n,g.v.gN,h.k.n),n=ua,P.Yc(q,g.k.n,n),g=sa,X.setAxisAngle(n,-p.mp*p.np*2*Math.PI,g),p=P.P(h.k.n),X.multiply(g,p,p),V.D(h));k.v&&k.v.eE&&(g=k,p=g.v,h=p.eE)&&(q=g.v.aN,P.multiply(g.k.n,g.v.bN,h.k.n),n=ua,P.Yc(q,g.k.n,n),g=sa,q=Math.abs(p.speed)*p.jt,q>p.Co&&(q=p.Co),X.setAxisAngle(n,-q,g),p=P.P(h.k.n),X.multiply(g,p,p),X.normalize(p,p),V.D(h));k.v&&k.v.pE&&(n=
k,h=n.v,k=h.pE)&&(g=n.v.rN,P.multiply(n.k.n,n.v.sN,k.k.n),p=ua,P.Yc(g,n.k.n,p),n=sa,X.setAxisAngle(p,-Math.abs(h.eo)*h.pr,n),h=P.P(k.k.n),X.multiply(n,h,h),X.normalize(h,h),V.D(k))}}F.xY(e);e=ca[c];(d=e.s.Mc)&&0<d.waves_height&&(e=H.La(e,fa.Pb),d=ha.length(e.Jj)||1,F.ga(R[c],F.xQ,e.time*d))}};a.BV=function(){return ca[0]};a.pause=function(){for(var a=0;a<R.length;a++)F.ga(R[a],F.iQ)};a.rj=function(){for(var a=0;a<R.length;a++)F.ga(R[a],F.nQ)};a.tI=function(a){(a=a.C)||W.q("No object physics");if(!a.Zk){var b=
a.ea,c=D(b);a.Zk=!0;F.ga(c,F.gQ,b)}};a.nB=function(a){(a=a.C)||W.q("No object physics");if(a.Zk){var b=a.ea,c=D(b);a.Zk=!1;F.ga(c,F.fQ,b)}};a.qx=function(a){return Boolean(a.Ac)};a.oa=function(a){return Boolean(a.C)};a.$J=function(a){return(a=a.C)&&a.Zk&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.fi&&0==a.ow?!0:!1};a.aC=function(a){return(a=a.C)&&a.Zk?!0:!1};a.qM=function(a,b){var c=a.C.ea;F.ga(D(c),F.wQ,c,b)};a.oW=z;a.xG=L;a.BH=function(a){a=a.C;F.ga(D(body_a),F.lQ,a.Tu);a.Tu=null};a.CL=function(b,
c,e,d,f,k){c=P.Ag(c,1,e,N);f=P.Ag(f,1,k,ia);P.invert(c,c);P.multiply(f,c,c);V.Rr(d,f);P.multiply(f,c,c);V.vj(b,c);V.D(b);d=P.F(b.k.n);f=P.P(b.k.n);a.bt(b,d,f)};a.bt=function(a,b,c){var e=a.C,d=F.sJ(F.fu),f=P.ic(a.k.n,d.trans);a=P.ae(a.k.n,d.quat);P.Ag(f,1,a,e.cB);d.ea=e.ea;ha.copy(b,d.trans);X.copy(c,d.quat);F.ga(D(e.ea),F.fu)};a.H=G;a.BG=function(a,b,c,e){var d=ua;B(a,b,c,e,d);a=a.C.ea;b=Math.abs(0);c=Math.abs(0);e=Math.abs(0);var f=Math.abs(d[0]),k=Math.abs(d[1]),h=Math.abs(d[2]);d[0]=f?d[0]/f*
Math.max(f,b):0;d[1]=k?d[1]/k*Math.max(k,c):0;d[2]=h?d[2]/h*Math.max(h,e):0;F.ga(D(a),F.LF,a,d[0],d[1],d[2])};a.CG=function(a,b,c,e){a=a.C.ea;F.ga(D(a),F.LF,a,b,c,e)};a.aA=function(a,b,c,e,d){var f=ua;d?(f[0]=b,f[1]=c,f[2]=e):B(a,b,c,e,f);a=a.C.ea;F.ga(D(a),F.YP,a,f[0],f[1],f[2])};a.AG=function(a,b,c,e){var d=ua;B(a,b,c,e,d);a=a.C.ea;F.ga(D(a),F.$P,a,d[0],d[1],d[2])};a.Vk=function(a,b,c){a=a.C.ea;F.ga(D(a),F.qQ,a,b,c)};a.ni=function(a,b){var c=a.C.ea;F.ga(D(c),F.rQ,c,b)};a.gM=function(a,b){var c=
a.C.ea;F.ga(D(c),F.vQ,c,b)};a.fM=function(a,b){var c=a.C.ea;F.ga(D(c),F.tQ,c,b)};a.cM=function(a,b){var c=a.C.ea;F.ga(D(c),F.oQ,c,b)};a.Pu=function(a){a=a.C.ea;F.ga(D(a),F.bQ,a)};a.nH=function(a,b,c){a=a.C.ea;F.ga(D(a),F.cQ,a,b,c)};a.uj=function(a,b,c){a=a.C.ea;F.ga(D(a),F.sQ,a,b,c)};a.dM=function(a,b){var c=a.C.ea;F.ga(D(c),F.pQ,c,b)};a.eM=function(a,b){var c=a.C.ea;F.ga(D(c),F.uQ,c,b)};a.Yz=function(a,b,c,e){var d=a.C;if(!d.ws){for(var f=d.ea,k=0;k<d.Ye.length;k++)if(a=d.Ye[k],a.cc==b&&a.callback==
c)return;a={iA:f,Ph:e||!1,cc:b,callback:c,Kk:[],Cs:[]};d.Ye.push(a);b=D(f);O(a,y(b),b)}};a.vD=function(a,b,c){a=a.C;for(var e=D(a.ea),d=y(e),f=0;f<a.Ye.length;f++){var k=a.Ye[f];if(k.cc==b&&k.callback==c){if(h(k)){var p=ha.set(0,0,0,ua);k.callback(!1,null,p,p,0)}a.Ye.splice(f,1);f--;for(var p=e,k=k.Kk,n=d.Ac.sa,g=0;g<n.length;g++)for(var q=n[g].C,m=0;m<q.Ye.length;m++)for(var v=q.Ye[m],l=0;l<v.Kk.length;l++)for(var w=v.Kk[l],H=0;H<k.length;H++){var t=k[H];w[0]==t[0]&&w[1]==t[1]&&(k.splice(H,1),H--)}k.length&&
F.ga(p,F.KF,k)}}};a.$z=function(a,b){a.C&&a.C.Tl&&E(a);var c=a.C;F.ga(D(c.ea),F.ZP,c.ea);c.Tl=b};a.zA=E;a.xu=function(a,b,c,e,d,f,k,h,p){var n;Y.IL++;n=Y.IL;a={id:n,ea:a?a.C.ea:0,from:new Float32Array(b),to:new Float32Array(c),cc:e,Yq:m(e),IG:f,ZR:k,Ph:h,fw:p,callback:d};b=D(a.ea)||R[0];c=y(b).Ac;n=a.id;c.Mk[n]=a;c.rD.push(a);F.ga(b,F.VP,a.id,a.ea,a.from,a.to,a.Yq,a.IG,a.ZR,a.Ph,a.fw);return n};a.wD=C;a.lH=function(a,b,c){var e=k(a),d=Q(a).Ac.Mk[a];d&&!d.IG&&(d.from.set(b),d.to.set(c),F.ga(e,F.aQ,
a,b,c))};a.tK=function(a){return Q(a).Ac.Mk[a]?!0:!1};a.Ep=function(a,b){var c=a.v;c.eo=b;p(a,c,D(a.C.ea))};a.Dp=function(a,b){var c=a.v;c.mp=b;p(a,c,D(a.C.ea))};a.RE=function(a,b){var c=a.v;c.Hq=b;p(a,c,D(a.C.ea))};a.hf=x;a.jf=e;a.b8=w;a.NW=function(a){if(!a.gf)return!1;a=a.uf.nf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.MW=function(a){return a.gf?"BOB"==a.uf.nf?!0:!1:!1};a.RW=function(a){return a.Dm?"BOB"==a.io.nf?!0:!1:!1};a.vK=function(a){return a.gf&&
"STEERING_WHEEL"==a.uf.nf?!0:!1};a.uK=function(a){return a.gf&&"SPEEDOMETER"==a.uf.nf?!0:!1};a.wK=function(a){return a.gf&&"TACHOMETER"==a.uf.nf?!0:!1};a.PJ=function(a){return a.v.speed};a.d1=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.og=function(a){return a.og};a.V7=n;a.TV=function(){return na};a.nU=function(){for(var a=0;a<R.length;a++)F.ga(R[a],F.eQ)};a.Ss=function(a){if("BOUNDING"==
a.C.type){var b=xa.indexOf(a);-1==b&&M.error("Object "+a.name+" doesn't have bounding physics");delete ra[c];xa.splice(b,1)}for(var c=a.C.ea,b=D(c),e=y(b),d=c,f=e.Ac.sa,k=[],p=0;p<f.length;p++)for(var n=f[p].C,g=0;g<n.Ye.length;g++)for(var q=n.Ye[g],m=0;m<q.Kk.length;m++){var v=q.Kk[m],l=q.Cs[m];if(v[0]==d||v[1]==d)q.Kk.splice(m,1),q.Cs.splice(m,1),m--,l&&!h(q)&&(l=ha.set(0,0,0,ua),q.callback(!1,null,l,l,0)),k.push(v)}k.length&&F.ga(b,F.KF,k);a.C&&a.C.Tl&&E(a);a=e.Ac.sa;for(e=0;e<a.length;e++)a[e].C.ea==
c&&(a.splice(e,1),e--);F.ga(b,F.kQ,c)}};b4w.module.__ipc=function(a,g){function l(a,b,c){for(var d=0;d<t.length;d+=2)t[d+1]==a&&(f[d+Number(!b)]=c)}function d(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var h=c[f];switch(h.constructor){case Float32Array:d+=h.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.WO=0;var y=a.OO=1,r=a.QO=2;a.PO=3;a.SO=4;a.TO=5;a.UO=6;a.XO=7;var A=a.ZO=8,h=a.mF=9,u=a.$O=10;a.aP=11;var m=a.bP=12;a.cP=13;a.YO=14;a.VO=15;a.RO=16;a.hQ=100;a.JP=101;a.KP=102;a.LP=103;a.MP=104;a.OP=105;a.NP=106;
a.PP=107;a.QP=108;a.RP=109;a.SP=110;a.TP=111;a.UP=112;a.WP=113;a.XP=114;a.kQ=115;a.YP=116;a.ZP=117;a.$P=118;a.bQ=119;a.cQ=120;a.dQ=121;a.fQ=122;a.gQ=123;a.iQ=124;a.VP=125;a.mQ=126;a.aQ=127;a.KF=128;a.lQ=129;a.nQ=130;a.oQ=131;a.pQ=132;a.qQ=133;a.rQ=134;a.sQ=135;a.tQ=136;a.uQ=137;a.vQ=138;a.wQ=139;a.LF=140;var q=a.fu=141;a.xQ=142;a.JF=143;a.yQ=144;a.zQ=145;a.jQ=146;a.eQ=147;a.AQ=148;var f=b4w.worker_listeners,t=b4w.worker_namespaces,c={Sf:m,ea:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
di:new Float32Array(3),Mh:new Float32Array(3),len:0},z={Sf:A,vA:0,nD:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},L={Sf:h,id:0,Pn:0,hit_fract:0,hit_time:0,len:0},D={Sf:u,id:0,Pn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},G={Sf:y,Ll:0,Ml:0,result:0,len:0},B={Sf:r,Ll:0,Ml:0,result:0,Ul:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},O={Sf:q,ea:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},K=[c,z,L,D,G,B,
O];a.dU=function(a,c){var d={pw:a?!0:!1,ul:null,Oh:[],hg:""};if(c)if(d.ul={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");l(d.hg,d.pw,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");l(d.hg,d.pw,null)},postMessage:function(a){var b;a:{for(b=0;b<t.length;b+=2)if(t[b+1]==d.hg){b=f[b+Number(!!d.pw)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<t.length;a+=2)if(t[a+1]==d.hg){f.splice(a,2);t.splice(a,2);break}}},d.pw){var k=
g("__util"),h=g("__container"),q=b4w.get_namespace(g),k=k.ot(q+"_worker");t.push(q);t.push(k);f.push(null);f.push(null);d.hg=k;(h=h.dV(a))?b?h.addEventListener("load",function(){b4w.require("__bindings",d.hg)},!1):(b4w.ua("__bindings",d.hg),b4w.ua("__ipc",d.hg),b4w.require("__bindings",d.hg)):(h=document.createElement("script"),h.src=a,h.defer="defer",h.async="async",h.addEventListener("load",function(){b=!1;b4w.require("__bindings",d.hg)},!1),document.head.appendChild(h))}else d.hg=b4w.get_namespace(g);
else d.ul=a?new Worker(a):self;return d};a.FR=function(a,b){function f(d){if(d.constructor==ArrayBuffer)d=new Float32Array(d);else if(d[0].constructor==ArrayBuffer){for(var p=0;p<d.length;p++)f(d[p]);return}p=d[0]|0;switch(p){case m:var g=c;g.ea=d[1]|0;g.time=d[2];g.trans[0]=d[3];g.trans[1]=d[4];g.trans[2]=d[5];g.quat[0]=d[6];g.quat[1]=d[7];g.quat[2]=d[8];g.quat[3]=d[9];g.di[0]=d[10];g.di[1]=d[11];g.di[2]=d[12];g.Mh[0]=d[13];g.Mh[1]=d[14];g.Mh[2]=d[15];break;case A:g=z;g.vA=d[1]|0;g.nD=d[2]|0;g.trans[0]=
d[3];g.trans[1]=d[4];g.trans[2]=d[5];g.quat[0]=d[6];g.quat[1]=d[7];g.quat[2]=d[8];g.quat[3]=d[9];break;case h:g=L;g.id=d[1]|0;g.Pn=d[2]|0;g.hit_fract=d[3];g.hit_time=d[4];break;case u:g=D;g.id=d[1]|0;g.Pn=d[2]|0;g.hit_fract=d[3];g.hit_time=d[4];g.hit_pos[0]=d[5];g.hit_pos[1]=d[6];g.hit_pos[2]=d[7];g.hit_norm[0]=d[8];g.hit_norm[1]=d[9];g.hit_norm[2]=d[10];break;case y:g=G;g.Ll=d[1]|0;g.Ml=d[2]|0;g.result=!!d[3];break;case r:g=B;g.Ll=d[1]|0;g.Ml=d[2]|0;g.result=!!d[3];g.Ul[0]=d[4];g.Ul[1]=d[5];g.Ul[2]=
d[6];g.coll_norm[0]=d[7];g.coll_norm[1]=d[8];g.coll_norm[2]=d[9];g.coll_dist=d[10];break;case q:g=O;g.ea=d[1]|0;g.trans[0]=d[2];g.trans[1]=d[3];g.trans[2]=d[4];g.quat[0]=d[5];g.quat[1]=d[6];g.quat[2]=d[7];g.quat[3]=d[8];break;default:g=d}b(a,p,g)}d(K);a.ul.addEventListener("message",function(a){f(a.data)},!1)};a.ua=function(){};a.ga=function(a,b){if(a)switch(b){case m:var d=c,f=new Float32Array(d.len);f[0]=d.Sf;f[1]=d.ea;f[2]=d.time;f[3]=d.trans[0];f[4]=d.trans[1];f[5]=d.trans[2];f[6]=d.quat[0];f[7]=
d.quat[1];f[8]=d.quat[2];f[9]=d.quat[3];f[10]=d.di[0];f[11]=d.di[1];f[12]=d.di[2];f[13]=d.Mh[0];f[14]=d.Mh[1];f[15]=d.Mh[2];a.Oh.push(f.buffer);break;case A:d=z;f=new Float32Array(d.len);f[0]=d.Sf;f[1]=d.vA;f[2]=d.nD;f[3]=d.trans[0];f[4]=d.trans[1];f[5]=d.trans[2];f[6]=d.quat[0];f[7]=d.quat[1];f[8]=d.quat[2];f[9]=d.quat[3];a.Oh.push(f.buffer);break;case h:d=L;f=new Float32Array(d.len);f[0]=d.Sf;f[1]=d.id;f[2]=d.Pn;f[3]=d.hit_fract;f[4]=d.hit_time;a.Oh.push(f.buffer);break;case u:d=D;f=new Float32Array(d.len);
f[0]=d.Sf;f[1]=d.id;f[2]=d.Pn;f[3]=d.hit_fract;f[4]=d.hit_time;f[5]=d.hit_pos[0];f[6]=d.hit_pos[1];f[7]=d.hit_pos[2];f[8]=d.hit_norm[0];f[9]=d.hit_norm[1];f[10]=d.hit_norm[2];a.Oh.push(f.buffer);break;case y:d=G;f=new Float32Array(d.len);f[0]=d.Sf;f[1]=d.Ll;f[2]=d.Ml;f[3]=d.result;a.Oh.push(f.buffer);break;case r:d=B;f=new Float32Array(d.len);f[0]=d.Sf;f[1]=d.Ll;f[2]=d.Ml;f[3]=d.result;f[4]=d.Ul[0];f[5]=d.Ul[1];f[6]=d.Ul[2];f[7]=d.coll_norm[0];f[8]=d.coll_norm[1];f[9]=d.coll_norm[2];f[10]=d.coll_dist;
a.Oh.push(f.buffer);break;case q:d=O;f=new Float32Array(d.len);f[0]=d.Sf;f[1]=d.ea;f[2]=d.trans[0];f[3]=d.trans[1];f[4]=d.trans[2];f[5]=d.quat[0];f[6]=d.quat[1];f[7]=d.quat[2];f[8]=d.quat[3];a.Oh.push(f.buffer);break;default:f=[];for(d=1;d<arguments.length;d++)f.push(arguments[d]);a.ul.postMessage(f)}};a.xY=function(a){a&&a.Oh.length&&(a.ul.postMessage(a.Oh),a.Oh.length=0)};a.sJ=function(a){switch(a){case m:return c;case A:return z;case h:return L;case u:return D;case y:return G;case r:return B;case q:return O;
default:return null}};a.terminate=function(a){a.ul.terminate();a.ul=null};a.lw=function(a){return!!a.ul};a.sK=function(a){return!!a.hg}};b4w.module.__scenes=function(a,g){function l(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.bg||!c.bg.length)return c}return null}function d(){yb||La.q("No active scene available");return yb}function b(a,b,c){if(!Ba.kv||!y(a,b,c))return null;c=a.b4w_shadow_settings;var e={};c.csm_resolution>bb.Ec?(e.csm_resolution=bb.Ec,Ga.error("Shadow map texture has unsupported size. Changed to "+bb.Ec+".")):e.csm_resolution=c.csm_resolution;Ba.SR=c.blur_samples;e.c_=c.soft_shadows;a=S.Lv(b,Ba.ssao&&a.b4w_enable_ssao);
e.self_shadow_polygon_offset=c.self_shadow_polygon_offset;e.self_shadow_normal_offset=c.self_shadow_normal_offset;e.enable_csm=c.b4w_enable_csm&&1==a.length;e.lh=[];e.cN=[];e.Tq=[];e.Sq=[];for(b=0;b<a.length;b++)e.lh.push(a[b].tb.type),e.cN.push(a[b].tb.ln),e.Tq.push(a[b].tb.Tq),e.Sq.push(a[b].tb.Sq),"SPOT"!=e.lh[b]&&"POINT"!=e.lh[b]||!e.enable_csm||(Ga.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),e.enable_csm=!1);e.enable_csm?(e.csm_num=c.csm_num,e.csm_first_cascade_border=
c.csm_first_cascade_border,e.first_cascade_blur_radius=c.first_cascade_blur_radius,e.csm_last_cascade_border=c.csm_last_cascade_border,e.last_cascade_blur_radius=c.last_cascade_blur_radius,e.fade_last_cascade=c.fade_last_cascade,e.blend_between_cascades=c.blend_between_cascades):(e.csm_num=1,e.csm_first_cascade_border=c.csm_first_cascade_border,e.first_cascade_blur_radius=c.first_cascade_blur_radius,e.csm_last_cascade_border=c.csm_last_cascade_border,e.last_cascade_blur_radius=c.last_cascade_blur_radius,
e.fade_last_cascade=!1,e.blend_between_cascades=!1);return e}function y(a,b,c){if(0!=b.length&&Ba.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var e=!1,d=!1;a=Ba.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(e=!0);f.b4w_shadow_receive&&(d=!0);if((a||e)&&d)return!0}return!1}function r(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].tb.type)return!0;return!1}function A(a){if(!Ba.Xk)return!1;a=ya(a);
for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function h(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,e=0;e<c.length;e++)if(S.tH(a[b],c[e].settings))return!0;return!1}function u(a){for(var b=ya(a),c=[],e=0;e<b.length;e++){var d=b[e];if(d.b4w_water){for(var f={},k=0;k<a.length;k++)for(var h=a[k],p=h.data.materials,n=0;n<p.length;n++)p[n]==d&&(f.tl=h.location[2]);f.Ge=d.b4w_water_fog_color.slice(0);f.Ge.push(d.b4w_water_fog_density);
d.b4w_water_dynamic?(f.xr=!0,f.waves_height=d.b4w_waves_height,f.waves_length=d.b4w_waves_length,f.dst_noise_scale0=d.b4w_water_dst_noise_scale0,f.dst_noise_scale1=d.b4w_water_dst_noise_scale1,f.dst_noise_freq0=d.b4w_water_dst_noise_freq0,f.dst_noise_freq1=d.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=d.b4w_water_dir_min_shore_fac,f.dir_freq=d.b4w_water_dir_freq,f.dir_noise_scale=d.b4w_water_dir_noise_scale,f.dir_noise_freq=d.b4w_water_dir_noise_freq,f.dir_min_noise_fac=d.b4w_water_dir_min_noise_fac,
f.dst_min_fac=d.b4w_water_dst_min_fac,f.waves_hor_fac=d.b4w_water_waves_hor_fac):(f.xr=!1,f.waves_height=0,f.waves_length=0);f.Sg=d.b4w_water_enable_caust;f.qS=d.b4w_water_caust_scale;f.pS=d.b4w_water_caust_brightness;f.rS=new Float32Array([.3,.7]);f.Yk=null;d=d.texture_slots;for(k=0;k<d.length;k++)h=d[k].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(f.Yk=h.image,f.aE=h.image.size[0],f.EC=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,f.dp=[(h[0]+h[1])/2,(h[2]+h[3])/2],f.ep=[h[0]-h[1],
h[2]-h[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.xr)for(e=0;e<c.length;e++)c[e].xr&&(f=c[e]);return f}return null}function m(a){function b(a){if(a){a=a.nodes;for(var e=0;e<a.length;e++){var d=a[e];"GROUP"==d.type&&d.node_group&&b(d.node_group.node_tree);"GROUP"==d.type&&"B4W_REFRACTION"==d.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=ya(a);for(var e=0;e<a.length;e++){var d=a[e];d.b4w_refractive&&(c.refractions=!0);d.node_tree&&b(d.node_tree)}return c}function q(a,b,c){if(Ba.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var e=0,d=!1,f=0;f<b.length;f++){var h=b[f];h.k.Jd&&"CUBE"==h.k.vh&&e++;if(h.Rs.length){for(var k=null,p=0;p<a.length;p++)if(a[p]==h){k=p;break}null==k&&a.push(h)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(h=0;h<b.length;h++)if(k=b[h].game_settings.alpha_blend,"OPAQUE"!=k&&"CLIP"!=k){b=!0;break a}b=!1}else b=void 0;b&&(d=!0)}return{KL:a,dL:e,Ri:[],aB:[],ii:[],dx:[],ZJ:d}}function f(a,b){var c=a.b4w_sky_settings,e={};e.NL=c.render_sky||c.procedural_skydome;
e.procedural_skydome=c.procedural_skydome;e.use_as_environment_lighting=c.use_as_environment_lighting;e.gp=c.color;e.rayleigh_brightness=c.rayleigh_brightness;e.mie_brightness=c.mie_brightness;e.spot_brightness=c.spot_brightness;e.scatter_strength=c.scatter_strength;e.rayleigh_strength=c.rayleigh_strength;e.mie_strength=c.mie_strength;e.rayleigh_collection_power=c.rayleigh_collection_power;e.mie_collection_power=c.mie_collection_power;e.mie_distribution=c.mie_distribution;e.he=c.reflexible;e.Kd=c.reflexible_only;
!b&&c.procedural_skydome&&Ga.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return e}function t(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.sW=a.hemisphere;b.RR=a.blur_depth;b.YG=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.dZ=a.samples;return b}function c(a){if(!(Ba.bloom&&a.b4w_enable_bloom&&a.s.Aj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function z(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function L(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function D(a){var b={};a=a.b4w_god_rays_settings;b.iC=a.intensity;b.Bo=a.max_ray_length;b.pp=a.steps_per_pass;return b}function G(a){var b={};b.pj=a.b4w_outline_color;b.Bs=a.b4w_outline_factor;return b}
function B(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function O(a,b){var c=a.light_settings,e={};e.ah=c.environment_energy;e.vt=c.use_environment_light;e.sB=c.environment_color;e.oe=a.horizon_color.slice(0);e.ye=a.zenith_color.slice(0);e.yt=a.use_sky_paper;e.xt=a.use_sky_blend;e.zt=a.use_sky_real;e.Rx=null;
e.hp=null;e.rv=null;c=!0;if(e.vt&&"SKY_TEXTURE"==e.sB&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var d=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&!a.texture_slots[f].texture.b4w_use_as_skydome){d=a.texture_slots[f];break}d?e.rv=d:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;d=a.texture_slots[f];e.Rx=d;f=Math.min(bb.fj,Oa.fS(d.texture.image.size[0]/3));e.hp={J_:f,VG:d.blend_factor,
dK:d.horizon_factor,yO:d.zenith_up_factor,xO:d.zenith_down_factor,color:d.color,Ea:d.default_value,invert:d.invert,dO:d.use_rgb_to_intensity,WG:d.blend_type,ZN:d.use_map_blend,$N:d.use_map_horizon,bO:d.use_map_zenith_up,aO:d.use_map_zenith_down};break}e.vt=e.vt?c:!1;return e}function K(a){var b=a.fog_settings,c={};c.K0=b.use_fog;c.iC=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.XU=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Ge=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.jg=new Float32Array([c.iC,c.depth,c.start,c.height]);return c}function E(a,b){if(!Ba.jd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,e=!1,d=0;d<b.length;d++){for(var f=b[d],h=f.data.materials,k=0;k<h.length;k++)h[k].b4w_terrain&&(c=!0);f=f.particle_systems;for(k=0;k<f.length;k++)h=f[k].settings,"HAIR"==h.type&&h.b4w_dynamic_grass&&(e=!0);if(c&&e)return!0}return!1}function C(a,b){if(Xa.outlining_overview_mode)return!0;if(Ba.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.Sk)return!0;return!1}else return!1}function Q(a,b){if(Xa.outlining_overview_mode)return!0;if(Ba.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.Wc)return!0;return!1}else return!1}function k(a,b){if(Ba.aj)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var e=b[c].data.materials,
d=0;d<e.length;d++)if(Fa.sH(e[d]))return!0;return!1}else return!1}function p(a,b){if(Ba.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function x(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,e=0;e<c.length;e++){var d=c[e],f=d.game_settings.alpha_blend;if(d.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function e(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var e=b[c].nb;if(e.anchor&&e.anchor.$n)return!0}return!1}}function w(a,b,c){var e=la.qh(a,b);la.vi(a,e,function(a,b,e){if(e.Hc){switch(e.from){case "COLOR":case "CUBEMAP":var d=b.p.wc;break;case "DEPTH":d=b.p.af;break;case "SCREEN":d=null;break;case U.nd:return;default:La.q("Wrong slink")}switch(e.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:d||La.q("Connection of SCREEN is forbidden"),d.Se&&La.q("Batch texture can't use renderbuffer"),va.wH(c.zb,e.to)&&ja.Rj(c,d,e.to)}}});for(a=0;a<b.Ya.length;a++){var e=b.Ya[a],d=b.ui[a];switch(e.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:d.Se&&La.q("Batch texture can't use renderbuffer"),va.wH(c.zb,e.to)&&ja.Rj(c,d,e.to)}}}function n(a){if(a&&a.s&&a.s.Wa){var b=ga.hc(a.s.Wa,U.Lg);b&&ba(a,b)}}function ea(a,
b,c,e,d,f){for(var h=b.k,k=S.ja(b,d).X,p=0;p<k.length;p++){var n=k[p];if(!(n.ve||n.Kd||"MAIN"!=n.type&&"NODES_GLOW"!=n.type&&"PARTICLES"!=n.type&&"LINE"!=n.type)&&("OPAQUE"==n.vb&&"OPAQUE"==e||"BLEND"==n.vb&&"BLEND"==e||"XRAY"==n.vb&&"XRAY"==e||"NODES_GLOW"==n.type&&"GLOW"==e)){if(!f&&(I(n,a,b,c,e,d),!ja.Zc(n)))if("DEBUG"===Ta.type())ja.zu(n,"error.glslv","error.glslf"),ja.Zc(n);else continue;var g=U.bi(n,h);U.Sc(a,g);w(c,a,n);F(n)}}}function I(a,b,c,e,d,f){var h=c.k,k=f.s,p=S.ja(c,f),n="NO_SHADOWS";
c=R(f,[U.dd]);if(c.length&&a.je){switch(d){case "OPAQUE":n="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":n="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":n="NO_SHADOWS";break;case "SHADOW":n="SHADOW_MASK_GENERATION";break;default:La.q("Wrong subscene type")}for(var g=0;g<c.length;g++)ja.EG(a,f.s.yd)}g="NO_SOFT_SHADOWS";if(k.yd&&k.yd.c_)switch(Ba.SR){case "16x":g="POISSON_X_16";break;case "8x":g="POISSON_X_8";break;case "4x":g="POISSON_X_4"}c=a.hb;va.ha(c,"SHADOW_USAGE",
n);va.ha(c,"POISSON_DISK_NUM",g);a.jd&&(g=ga.hc(e,U.Di))&&T(a,g,h);g=b.p;g.type==ta.Be||g.type==ta.Jh||g.type==ta.Gi?va.ha(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):va.ha(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=d||a.ok){d=b.Rw;va.ha(c,"NUM_LIGHTS",d);va.ha(c,"NUM_LFACTORS",0==d%2?d/2:Math.floor(d/2)+1);va.ha(c,"REFLECTION_PASS","REFL_PASS_NONE");va.ha(c,"SSAO_ONLY",0);if(d=k.Mc)va.ha(c,"WATER_EFFECTS",1),va.ha(c,"WAVES_HEIGHT",va.O(d.waves_height)),va.ha(c,"WAVES_LENGTH",va.O(d.waves_length)),
va.ha(c,"WATER_LEVEL",va.O(d.tl));if(b.Sg&&a.Sg){va.ha(c,"CAUSTICS",1);if(g=k.yd){h=g.lh;for(g=n=0;g<h.length;g++)"SUN"==h[g]&&(n=g);va.ha(c,"SUN_NUM",n)}va.ha(c,"CAUST_SCALE",va.O(b.iH));va.ha(c,"CAUST_SPEED",va.O(b.jH,2));va.ha(c,"CAUST_BRIGHT",va.O(b.hH))}b=p.Ri;p=p.ii;if(-1!==a.Od.indexOf("u_mirrormap"))va.ha(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Jd&&b)b=b.p.wc,ja.Rj(a,b,"u_cube_reflection"),va.ha(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Jd&&p)for(g=0;g<p.length;g++)b=p[g].p.wc,ja.Rj(a,
b,"u_plane_reflection"),va.ha(c,"REFLECTION_TYPE","REFL_PLANE");else va.ha(c,"REFLECTION_TYPE","REFL_NONE");(p=ga.hc(e,U.Lg))?a.lv?(b=p.p.wc,ja.Rj(a,b,"u_sky")):p.procedural_skydome&&(a.De=p.De,va.ha(c,"PROCEDURAL_FOG",1)):va.ha(c,"PROCEDURAL_FOG",0);b=k.Kp;b.vt&&(va.ha(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.sB?(b.rv?(p=b.rv.texture,b=Oa.le(b.rv),ja.Rj(a,b,"u_sky_texture",p.name)):p&&(b=p.p.wc,ja.Rj(a,b,"u_sky_texture")),va.ha(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.sB&&va.ha(c,"SKY_COLOR",1));
b=k.wO;b.K0&&(va.ha(c,"USE_FOG",1),va.ha(c,"FOG_TYPE",b.XU));a.Ok&&a.Lb?(Ba.kv&&va.ha(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.ok||"NODES_GLOW"==a.type?(va.ha(c,"REFRACTIVE",1),k.refractions?va.ha(c,"USE_REFRACTION",1):va.ha(c,"USE_REFRACTION",0)):k.refractions?va.ha(c,"REFRACTIVE",1):va.ha(c,"REFRACTIVE",0),(k.OK.refractions||k.refractions)&&va.ha(c,"HAS_REFRACT_TEXTURE",1)):(va.ha(c,"REFRACTIVE",0),va.ha(c,"USE_REFRACTION",0),va.ha(c,"USE_REFRACTION_CORRECTION",0));a.Ij&&(Ba.Xk&&a.Et&&
ga.hc(e,U.iF)?va.ha(c,"SHORE_SMOOTHING",1):va.ha(c,"SHORE_SMOOTHING",0),a.water_dynamic&&d&&d.waves_height?va.ha(c,"DYNAMIC",1):va.ha(c,"DYNAMIC",0));"PARTICLES"==a.type&&(va.ha(c,"SIZE_RAMP_LENGTH",a.gb.j$),va.ha(c,"COLOR_RAMP_LENGTH",a.gb.GH));if(!a.kg)for(a=a.ya,e=0;e<a.length;e++)if(b=a[e],"SCENE"==b.source)for(k=0;k<Ua.length;k++)for(c=Ua[k],p=Ua[k].bg,d=0;d<p.length;d++)p[d]==b&&la.r(Nb,c,f,null)}}function F(a){8<a.ya.length&&Ga.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.wd.join(", ")+'"')}function T(a,b,c){a.ne=b.ne;var e=b.ne[0],d=b.ne[1],f=b.ne[2];c=c.S;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.ne[2]=f;b=b.p;ta.xx(b,f/2,-d,-e,f/2);ta.Wk(b);e=a.Ur||0;e=0==e?c:Math.max(e,c);a.Ur=e}function M(a,b,c,e,d,f){for(var k=b.k,h=S.ja(b,d).X,p=0;p<h.length;p++){var n=h[p];if(("MAIN"==n.type||"PARTICLES"==n.type||"LINE"==n.type)&&"REFLECT"==n.vb&&n.Lb==e){if(a.type==U.Rd||a.type==U.Cf){var g;a:{var q=d.s.li.ii;for(g=0;g<q.length;g++)for(var m=0;m<
q[g].length;m++)if(q[g][m]==a)break a;q=d.s.li.dx;for(g=0;g<q.length;g++)for(m=0;m<q[g].length;m++)if(q[g][m]==a)break a;g=null}if(g==k.Hd)continue}else if(g=pa(d,a),g==k.Vd)continue;if(!f&&(I(n,a,b,c,"REFLECT",d),g=n.hb,va.ha(g,"WATER_EFFECTS",0),a.type==U.Rd||a.type==U.Cf?va.ha(g,"REFLECTION_PASS","REFL_PASS_PLANE"):va.ha(g,"REFLECTION_PASS","REFL_PASS_CUBE"),va.ha(g,"TEXTURE_NORM",0),!ja.Zc(n)))if("DEBUG"===Ta.type())ja.zu(n,"error.glslv","error.glslf"),ja.Zc(n);else continue;n=U.bi(n,k);U.Sc(a,
n)}}}function X(a){Z(a);var b=ca(a,U.Pb),c=!0,e=a.s.yd;la.pa(a.s.Wa,function(d,f){f.type===U.dd&&(fa(f,a,b.p,e,c),c=!1)})}function H(a){la.pa(a.s.Wa,function(a,b){b.type===U.En&&(b.qB=1)})}function fa(a,b,c,e,d){if(0!=a.Qa.length){var f=a.p,k=wa.ic(c.n,sb);wa.ue(k,f.n);wa.copy(c.wf,f.dt);if("SUN"===e.lh[a.zh]||"HEMI"===e.lh[a.zh]){k=tc;qa.e1(k);for(var h=0;h<a.Qa.length;h++)for(var p=a.Qa[h].sa,n=0;n<p.length;n++){var g=p[n].mf;0==h&&0==n?qa.Tn(g.Ta,k):qa.tB(k,g.Ta)}k=qa.xI(k,Ec);La.Po(k,f.Ob,k);
if(e.enable_csm){b=Ra.copy(c.Th[a.$A],sb);e=Sa.invert(c.Ob,ec);La.Po(b,e,b);La.Po(b,f.Ob,b);a=c.kr[a.$A];if(d)for(fc=0,Xc=-Infinity,d=2;d<k.length;d+=3)fc=Math.min(fc,k[d]),Xc=Math.max(Xc,k[d]);d=tc;d.max_x=b[0]+a;d.max_y=b[1]+a;d.max_z=Xc;d.min_x=b[0]-a;d.min_y=b[1]-a;d.min_z=fc}else{c=d=tc;e=ad;e.set(k);k=lc/9;h=Sa.identity(ec);Sa.rotate(h,k,La.Nc,h);n=p=-1;for(g=0;10>g;g++){var q=qa.LG(e,Oc),m=(q.max_x-q.min_x)*(q.max_y-q.min_y);if(-1==p||m<p)p=m,n=g,qa.Tn(q,c);La.Po(e,h,e)}c=n*k;0<c&&(k=Sa.identity(ec),
Sa.rotate(k,c,La.Nc,k),Sa.multiply(k,f.Ob,f.Ob),wa.fh(f.Ob,f.wf));c=d.max_x-d.min_x;k=d.max_y-d.min_y;c&&k&&(e=Math.abs(c-k)/2,2<c/k?(d.max_y+=e,d.min_y-=e):2<k/c&&(d.max_x+=e,d.min_x-=e));d.max_x+=.005;d.max_y+=.005;d.max_z+=.005;d.min_x-=.005;d.min_y-=.005;d.min_z-=.005;V(a,b.s.Wa)}ta.vZ(f,d.min_x,d.max_x,d.min_y,d.max_y,-d.max_z,-d.min_z);ta.Wk(f);La.fo(f.md,f.Xh)}else"SPOT"!==e.lh[a.zh]&&"POINT"!==e.lh[a.zh]||ta.Wk(f,f.Ab)}}function V(a,b){for(var c=a.p,e=ga.bW(b,a),d=0;d<e.length;d++){var f=
e[d];if(f.type==U.Pb||f.type==U.Df||f.type==U.Pc||f.type==U.ag)if(Ba.Bw)f.QE.set(c.wf,9*a.zh);else{var k=wa.F(c.wf),h=wa.td(c.wf),p=wa.P(c.wf);rb.set(k[0],k[1],k[2],h,jb);f.ky.set(jb,4*a.zh);f.jy.set(p,4*a.zh)}}}function P(a,b,c,e,d){for(var f=b.k,k=S.ja(b,e).X,h=0;h<k.length;h++){var p=k[h];if("COLOR_ID"==p.type&&(a.type==U.zf&&"COLOR_ID"==p.vb||a.type==U.Ci&&"COLOR_ID_XRAY"==p.vb)){if(!d&&(I(p,a,b,c,"COLOR_ID",e),ja.qf(p,"USE_OUTLINE",0),!ja.Zc(p)))continue;p=U.bi(p,f);U.Sc(a,p)}}}function W(a,
b,c,e,d){if(!e&&(d.jd&&(e=ga.hc(c,U.Di))&&T(d,e,b),!ja.Zc(d)))if("DEBUG"===Ta.type())ja.zu(d,"error.glslv","error.glslf"),ja.Zc(d);else return;b=U.bi(d,b);U.Sc(a,b);w(c,a,d);F(d)}function ha(a,b){v(a,b);for(var c=0;c<a.Ze.length;c++)a.Ze[c].parent==a&&ha(a.Ze[c],b)}function v(a,b){a.k.ai=b;if(S.jh(a))for(var c=0;c<a.I.length;c++)for(var e=a.I[c],d=R(e.yb,eb),f=0;f<d.length;f++){var k=d[f],h=a.k,p=a.tb,n=e.Km,g=p.qn&&!h.ai?1:0;k.qs[4*n+3]=g;g=p.sn&&!h.ai?1:0;k.ps[4*n+3]=g;k.Ba=!0}}function aa(a,b){for(var c=
R(b,eb),e=a.tb,d=a.k,f=S.ja(a,b),k=wa.F(d.n),d=wa.P(d.n),h=0;h<c.length;h++){var p=c[h],n=p,g=a.k,q=a.tb,m=f.Km,v=wa.F(a.k.n),l=q.ar;n.wC.set(q.direction,3*m);jb[0]=v[0];jb[1]=v[1];jb[2]=v[2];jb[3]=q.qn&&!g.ai?1:0;n.qs.set(jb,4*m);jb[0]=l[0];jb[1]=l[1];jb[2]=l[2];jb[3]=q.sn&&!g.ai?1:0;n.ps.set(jb,4*m);n.Ba=!0;switch(e.type){case "SUN":p.pN.set(d);p.oN=e.ar;p.type===U.Lg?(p.Mw=e.$K,Ra.copy(e.direction,p.kE),ba(b,p)):Ra.copy(e.direction,p.kE);break;case "HEMI":case "POINT":case "SPOT":break;default:Ga.error("Unknown light type: "+
e.type+'".')}p=p.Qa;for(n=0;n<p.length;n++)for(g=p[n].sa,q=0;q<g.length;q++)m=g[q].za,m.Jm&&ja.xZ(m,a)}c=ca(b,U.Pb).p;f=f.ZD;e=b.s.yd;for(h=0;h<f.length;h++)p=f[h],ta.WD(p.p,k,d),fa(p,b,c,e,!0),V(p,b.s.Wa)}function Z(a){var b=Na.Ub(a,"LAMP",Na.oc),b=S.Lv(b,Ba.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var e=b[c],d=e.k,f=wa.ic(d.n,sb),d=wa.ae(d.n,Jb),k=0;k<e.I.length;k++){var h=e.I[k],p=h.ZD;if(h.yb==a)for(h=0;h<p.length;h++)ta.WD(p[h].p,f,d)}}function ba(a,b){ka.fx(b);Qa.co(b);
if(b.Mw)for(var c=R(a,cb),e=0;e<c.length;e++)for(var d=c[e].Qa,f=0;f<d.length;f++)for(var k=d[f].sa,h=0;h<k.length;h++){var p=k[h];p.dc&&(p=p.za,ja.uS(p)&&Qa.b0(p))}}function ya(a){for(var b=[],c=0;c<a.length;c++)for(var e=a[c].data,d=0;d<e.materials.length;d++){var f=e.materials[d];-1==b.indexOf(f)&&b.push(f)}return b}function na(a,b,c){for(var e=a.s,d=S.ja(a.Mj,a).da,f=0;f<d.length;f++){var k=d[f];ta.Wk(k,b/c);e.yd&&ta.KE(k,e.yd)}e.yd&&(e.Nw=!0,ca(a,U.Df).Ba=!0,ca(a,U.Pc).Ba=!0);var h=e.Wa;ga.S_(h,
function(e,d,f){if(e.pt){var k=e.fn*b,p=e.gn*c;if(d)for(d=0;d<f.Ya.length;d++)f.Ya[d]==e&&Oa.resize(e.jb,k,p);else switch(Oa.yo(e.jb)&&Oa.resize(e.jb,k,p),e=f.p,e.width=k,e.height=p,f.type){case U.Qp:ra(a,{dof_power:f.p.dof_power});break;case U.Sp:oa(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case U.Lp:xa(a,{bloom_blur:f.On});break;case U.En:f=ga.Db(h,f,U.gc);k=ga.Db(h,f,U.gc);p=ga.Db(h,k,U.gc);e=ga.Db(h,p,U.gc);ga.Md(f,1/b,1/c);ga.Md(k,
1/b,1/c);ga.Md(p,1/b,1/c);ga.Md(e,1/b,1/c);break;default:ga.Md(f,1/b,1/c)}}})}function R(a,b){for(var c=[],e=0;e<b.length;e++){var d=b[e];la.pa(a.s.Wa,function(a,b){b.type==d&&c.push(b)})}return c}function ca(a,b){return ga.hc(a.s.Wa,b)}function ra(a,b){var c=ca(a,U.Qp);if(!c)return Ga.error("DOF is not enabled on the scene. Check camera settings"),0;var e=c.p.dof_bokeh,d=e?R(a,[U.Ly]):[],f=a.s.Wa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,e))for(var k=0;k<d.length;k++)d[k].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,e))for(k=0;k<d.length;k++)d[k].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,e))for(k=0;k<d.length;k++)d[k].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,e))for(k=0;k<d.length;k++)d[k].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,e))for(k=0;k<d.length;k++)d[k].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,e))for(k=0;k<d.length;k++)d[k].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(c.p.dof_bokeh_intensity=b.dof_bokeh_intensity,e&&(d=ga.NB(f,c,U.gc),d[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,d[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,d[0]=ga.Db(f,d[0],U.gc),d[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(e){e=b.dof_power;c.p.dof_power=e;var e=
e/2,k=c.p.width,h=c.p.height,p=[1/k,0],n=[1/k*.5,1/h*.866],g=[-1/k*.5,1/h*.866],d=ga.NB(f,c,U.gc);ga.Lc(d[0],e);ga.Md(d[0],g[0],g[1]);ga.Lc(d[1],e);ga.Md(d[1],n[0],n[1]);d[0]=ga.Db(f,d[0],U.gc);ga.Lc(d[0],e);ga.Md(d[0],p[0],p[1]);c.p.Ed&&(d[0]=ga.Db(f,d[0],U.Ly),d[0]=ga.Db(f,d[0],U.gc),ga.Md(d[0],1/k,1/h),d[0]=ga.Db(f,d[0],U.gc),ga.Md(d[0],1/k,1/h))}else c.p.dof_power=b.dof_power,d=ga.Db(f,c,U.gc),f=ga.Db(f,d,U.gc),ga.Lc(d,c.p.dof_power),ga.Md(d,1/c.p.width,1/c.p.height),ga.Lc(f,c.p.dof_power),ga.Md(f,
1/c.p.width,1/c.p.height)}function xa(a,b){var c=ca(a,U.eu),e=ca(a,U.Lp);if(!c||!e)return Ga.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.Hu=b.key,c.Ba=!0);"number"==typeof b.edge_lum&&(c.Gu=b.edge_lum,c.Ba=!0);if("number"==typeof b.blur){var d=a.s.Wa,c=ga.Db(d,e,U.Mp),d=ga.Db(d,c,U.Mp);e.On=b.blur;ga.Lc(c,b.blur);ga.Md(c,1/e.p.width,1/e.p.height);ga.Lc(d,b.blur);ga.Md(d,1/e.p.width,1/e.p.height)}}function oa(a,b){var c=ca(a,U.Sp);if(!c)return Ga.error("Glow is not enabled on the scene"),
null;for(var e=a.s.Wa,d=ga.ZV(e,c),f=0;f<d.length;++f){var k=d[f];if(k.type==U.gc&&"GLOW_MASK_LARGE"==k.vb)var h=k;if(k.type==U.gc&&"GLOW_MASK_SMALL"==k.vb)var p=k}d=ga.Db(e,h,U.gc);e=ga.Db(e,p,U.gc);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.Ba=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.Ba=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ga.Lc(p,b.small_glow_mask_width),
ga.Md(p,1/c.p.width,1/c.p.height),p.Ba=!0,ga.Lc(e,b.small_glow_mask_width),ga.Md(e,1/c.p.width,1/c.p.height),e.Ba=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ga.Lc(h,b.large_glow_mask_width),ga.Md(h,1/c.p.width,1/c.p.height),h.Ba=!0,ga.Lc(d,b.large_glow_mask_width),ga.Md(d,1/c.p.width,1/c.p.height),d.Ba=!0)}function Y(a,b,c){var e=a.s,d=e.Mc;if(!d.xr)return d.tl;var f=d.waves_height,k=d.waves_length,h=d.tl,p=Ra.length(e.Jj)||1;a=ca(a,U.Pb).time;a*=
p;var n=Xb;n[0]=20/k*(b-.25*a);n[1]=20/k*(c-.25*a);p=La.kH(n);n[0]=17/k*(c+.1*a);n[1]=17/k*(b+.1*a);var n=La.kH(n),p=p+n-1,g=d.dst_noise_scale0,n=d.dst_noise_scale1,q=d.dst_noise_freq0,m=d.dst_noise_freq1,v=Xb;v[0]=g*(b+q*a);v[1]=g*(c+q*a);g=La.dE(v);v[0]=n*(c-m*a);v[1]=n*(b-m*a);n=La.dE(v);n*=f*g;if(d.Yk)if(m=(b-d.dp[0])/d.ep[0],v=(d.dp[1]+c)/d.ep[1],m+=.5,v+=.5,1<m||0>m||1<v||0>v)d=n;else{var e=La.YI(e.$D,d.aE,m,v),v=d.dir_freq,l=d.dir_noise_scale,w=d.dir_noise_freq,g=d.dir_min_noise_fac,m=d.dst_min_fac,
q=k/d.EC/Math.PI;c=[l/k*(b+w*a),l/k*(c+w*a)];b=Math.sqrt(e);d=f*Math.max(e,d.dir_min_shore_fac)*Math.sin(b/q+v*a)*Math.max(La.dE(c),g);f=Math.max(b,m);d=d*(1-f)+n*f;p*=e}else d=n;return h+(d+.05*p)}function ua(a,b){a.cs&&a.type==U.gc&&b.dc!=a.dc&&(a.dc=b.dc);b.dc||a.type!=U.En||(a.qB=0)}function sa(a,b,c,e){var d=la.Va(a,b);ta.vx(d.p,c,e);d.bA=!0;la.hl(a,b,function(b,d,f){f.Hc&&f.from==c&&ga.JS(f)&&N(a,b,f.to,e)});la.vi(a,b,function(b,d,f){f.Hc&&f.from==c&&f.from==f.to&&sa(a,b,c,e)})}function N(a,
b,c,e){a=la.Va(a,b).Qa;for(b=0;b<a.length;b++)for(var d=a[b].sa,f=0;f<d.length;f++)ja.RY(d[f].za,e,c)}function ia(a){var b=ca(a,U.Di);if(b){var c=b.p,e=a.Mj.k;a=wa.ic(e.n,sb);var d=pd;d[0]=0;d[1]=0;d[2]=-b.ne[2]/2;b=wa.ae(e.n,Jb);Ra.transformQuat(d,b,d);d[0]+=a[0];d[1]+=a[1];d[2]=0;Dc.identity(b);ta.WD(c,d,b)}}function J(a,b){la.pa(a,function(c,e){if(e.type==U.Hh){e.Ya[0]&&e.ui[0]||La.q("Wrong MOTION_BLUR subscene");var d=e.Ya[0],f=e.ui[0];e.ui[0]=e.p.wc;la.hl(a,c,function(b,c,e){e.Hc&&N(a,b,e.to,
f)});sa(a,c,d.from,f);N(a,c,d.to,e.ui[0]);e.TK=Math.exp(-b/e.mb_factor)}})}function ma(a){return a.s.Jj}function pa(a,b){if(!a.s.li)return null;for(var c=a.s.li.Ri,e=0;e<c.length;e++)if(c[e]==b)return e;c=a.s.li.aB;for(e=0;e<c.length;e++)if(c[e]==b)return e;return null}var ja=g("__batch"),qa=g("__boundings"),ta=g("__camera"),Ia=g("__config"),Ca=g("__container"),Aa=g("__debug"),la=g("__graph"),Da=g("__hud"),za=g("__input"),Sa=g("__mat4"),Fa=g("__nodemat"),Na=g("__objects"),S=g("__obj_util"),da=g("__physics"),
ka=g("__prerender"),xb=g("__primitives"),Ga=g("__print"),Dc=g("__quat"),Qa=g("__renderer"),ga=g("__scenegraph"),Ea=g("__sfx"),va=g("__shaders"),U=g("__subscene"),Oa=g("__textures"),wa=g("__tsr"),La=g("__util"),Ra=g("__vec3"),rb=g("__vec4"),Ta=g("__version"),Ba=Ia.B,bb=Ia.Oi,Xa=Ia.Wc,Ja=Ia.Xo,hb=[U.Di,U.dd,U.Pb,U.Pc,U.ag,U.ke,U.Rd,U.nd,U.Cf,U.Ue,U.zf,U.Ci,U.Df,U.Kg,U.Bf];a.T2=hb;var eb=[U.Pb,U.Pc,U.ag,U.ke,U.Rd,U.nd,U.Lj,U.Xt,U.Lg,U.Cf,U.Ue,U.eu,U.Df,U.dd,U.zf,U.Ci,U.Kg],cb=[U.Pb,U.mu,U.Pc,U.ag,U.ke,
U.Rd,U.nd,U.Cf,U.Ue],nb=[U.dd,U.Pb,U.Pc,U.ag,U.ke,U.Rd,U.nd,U.Cf,U.Ue,U.zf,U.Ci,U.Df,U.Lj,U.Kg,U.Bf],ib=[U.Pb,U.Pc,U.ag,U.ke,U.Rd,U.nd,U.Cf,U.Ue],ob=null,yb=null,Ua=[],Nb=null,lc=Math.PI/2,Xb=new Float32Array(2),sb=new Float32Array(3),pd=new Float32Array(3),Jb=new Float32Array(4),jb=new Float32Array(4),ec=new Float32Array(16),Ec=new Float32Array(24),ad=new Float32Array(24),tc=qa.Ud(),Oc=qa.Ud(),fc=0,Xc=-Infinity;a.y4=function(){return{}};a.ux=function(a){yb=a;Ea.iZ(a)};a.AY=function(a,b){var c=a.s,
e=ga.yT(c.Wa);if(a==b){na(a,Ca.RJ(),Ca.QJ());for(var d=0;d<e.length;d++)a.s.Zm.push(e[d])}else for(d=a.bg[0],na(a,d.wj,d.wj),d=0;d<e.length;d++)b.s.Zm.push(e[d]);e=R(a,nb);for(d=0;d<e.length;d++)e[d].Jj.set(c.Jj);for(d=0;d<c.Zm.length;d++)c.Zm[d].type==U.dd&&Qa.co(c.Zm[d])};a.Zh=function(){ob||(ob=l(Ua));return ob};a.uv=l;a.A=d;a.Da=function(){return yb?!0:!1};a.rm=function(a){return a.Mj};a.Nr=function(){return Ua};a.RB=function(){if(1==Ua.length)return Ua;for(var a=0;a<Ua.length;a++){var b=Ua[a].s.Wa;
la.pa(b,function(b,c){for(var e=c.Qa,d=0;d<e.length;d++)for(var f=e[d].sa,k=0;k<f.length;k++){for(var h=f[k],p=h.za.ya,n=null,g=0;g<p.length;g++)if("SCENE"==p[g].source&&p[g].gt==Ua[a].name&&c.type!=U.Ny){Ga.error('Texture-scene loop detected. A scene is rendered to texture "'+p[g].name+'" yet this texture belongs to the same scene.');la.qh(Nb,Ua[a]);n=h.za;break}n&&(n.ya=[],n.Od=[],ja.a0(n,null),ja.Zc(n),U.Sc(c,h))}})}for(var c=[],a=0;a<Ua.length;a++)if(b=Ua[a],!b.bg.length){b=la.qh(Nb,b);la.JU(Nb,
b);b=la.Wx(Nb,b,la.Kt);b=la.xE(b);la.pa(b,function(a,b){c.push(b)});break}return c};a.eR=function(a,d,n,g,v){a.bg=a.bg||[];a.ra=null;var l=a.s,w=S.ja(a.Mj,a),H=a.Mj.k;l.Hp=[];var P=a.world;l.cX=n.length;l.Aj=r(n);l.Nx=f(P,l.Aj);l.Kp=O(P,l.Nx);l.wO=K(P);if(P=!a.bg.length)a:{if("HMD"==Ba.stereo){if(w.da[0].type!=ta.Sd){Ga.warn("Head-mounted display stereo is disabled for the non-perspective camera");Ba.stereo="NONE";P=!1;break a}if(!za.Mu(za.zd)){Ga.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Ba.stereo="NONE";P=!1;break a}}P="HMD"==Ba.stereo}l.cw=P;if(P=!a.bg.length)w.da[0].type!=ta.Sd&&"ANAGLYPH"==Ba.stereo?(Ga.warn("Anaglyph stereo is disabled for the non-perspective camera"),Ba.stereo="NONE",P=!1):P="ANAGLYPH"==Ba.stereo;l.anaglyph_use=P;l.VQ=!l.cw&&!l.anaglyph_use&&e(a,v);l.li=q(a,d,g);l.QR=c(a);l.QX=z(a);l.sS=L(a);l.kW=D(a);l.gY=G(a);l.nk=B(a);l.dof=Ba.dof&&(0<H.dof_distance||H.dof_object);l.motion_blur=Ba.motion_blur&&a.b4w_enable_motion_blur;l.compositing=Ba.compositing&&a.b4w_enable_color_correction;
l.antialiasing=Ba.antialiasing&&1==Ba.Fc&&"NONE"!=a.b4w_antialiasing_quality;l.ssao=Ba.ssao&&a.b4w_enable_ssao;l.god_rays=Ba.god_rays&&a.b4w_enable_god_rays&&l.Aj;l.pU=Ba.kv;l.Qv=a.b4w_glow_settings.render_glow_over_blend;l.s_=t(a);v=m(g);l.OK=v;l.refractions=p(a,v);l.yd=b(a,n,g);l.Mc=u(g);l.Fh=x(g);l.b_=h(g);l.Xk=A(g);l.jd=E(a,g);l.XS=C(a,g);l.outline=Q(a,g);l.aj=k(a,g);switch(a.b4w_reflection_quality){case "LOW":l.Si=Ja.cI;l.uh=Ja.rL;break;case "MEDIUM":l.Si=Ja.iU;l.uh=Ja.sY;break;case "HIGH":l.Si=
Ja.hU;l.uh=Ja.rY;break;default:l.Si=Ja.cI,l.uh=Ja.rL}Ca.SW()?(Ga.log("%cENABLE HIDPI MODE","color: #00a"),l.iG="AA_QUALITY_LOW",l.Uo=1,Ba.Fc=1):1<Ba.Fc?(Ga.log("%cENABLE MSAA RENDERING: "+Ba.Fc+"x","color: #00a"),l.Uo=1):(l.iG="AA_QUALITY_"+a.b4w_antialiasing_quality,l.Uo="MEDIUM"===a.b4w_antialiasing_quality&&Ba.quality===Ia.Fn||"HIGH"===a.b4w_antialiasing_quality&&Ba.quality===Ia.xl?1.33:"HIGH"===a.b4w_antialiasing_quality&&Ba.quality===Ia.Fn||"NONE"===a.b4w_antialiasing_quality&&Ba.quality===Ia.Fn?
2:1);n=a.bg.sort(function(a,b){return b.wj-a.wj});l.Wa=ga.xT(l,w,H,n);l.Zm=[];l.Nw=!1;l.RC=!1;l.SC=!1;l.Jj=new Float32Array(3);Ua.push(a);Nb||(Nb=la.create());la.J(Nb,a);for(l=0;l<d.length;l++)S.HD(d[l],!0,a);a=Ca.me();Ca.resize(a.clientWidth,a.clientHeight,!0)};a.fR=function(a,b,c){for(var e=0;e<b.length;e++){var d=b[e].s;d&&d.Fm&&(d.Dt=c,a.s.Hp.push(b[e]))}};a.MB=function(a){return a.s.Wa};a.NI=function(a,b){la.pa(b,function(c,e){var d=null;switch(e.type){case U.gc:d=ja.UA(e.ex);break;case U.mu:d=
ja.DT(e);break;case U.Mz:d=ja.ET(e);break;case U.iF:d=ja.jT();break;case U.Lj:ga.Db(b,e,U.Hn)||ga.Db(b,e,U.Bf)||ga.Db(b,e,U.Pc)||ga.Db(b,e,U.Lj);d=ja.nT(e.lL,e.Ij,e.pp);break;case U.Xt:ga.Db(b,e,U.Hn)||ga.Db(b,e,U.Bf)||ga.Db(b,e,U.Pc);ga.Db(b,e,U.Lj);d=ja.oT();break;case U.Hh:d=ja.sT();break;case U.Ly:d=ja.gT(e.DH);break;case U.Qp:var d=ja.kT(e),f=e.p.dof_power;if(e.p.dof_bokeh){var f=f/2,k=ga.NB(b,e,U.gc);ga.Lc(k[0],f);ga.Lc(k[1],f);k[0]=ga.Db(b,k[0],U.gc);ga.Lc(k[0],f)}else{var k=ga.Db(b,e,U.gc),
h=ga.Db(b,k,U.gc);ga.Lc(k,f);ga.Lc(h,f)}break;case U.En:var d=ja.tT(),f=ga.Db(b,e,U.gc),k=ga.Db(b,f,U.gc),h=ga.Db(b,k,U.gc),p=ga.Db(b,h,U.gc);ga.Lc(k,e.hA);ga.Lc(f,e.hA);ga.Lc(p,e.wB*e.Bs);ga.Lc(h,e.wB*e.Bs);break;case U.Sp:d=ja.mT();break;case U.My:d=ja.hT();break;case U.$E:d=ja.bT(e);break;case U.Kz:case U.ku:case U.iq:case U.lu:d=ja.BT(e.type);break;case U.Fi:d=ja.FT(e.vb);break;case U.Lg:d=ja.iT(a,e);break;case U.LUMINANCE:d=ja.pT();break;case U.AO:d=ja.cT();break;case U.eu:d=ja.qT();break;case U.Mp:d=
ja.eT();break;case U.Lp:d=ga.Db(b,e,U.Mp);f=ga.Db(b,d,U.Mp);ga.Lc(d,e.On);ga.Lc(f,e.On);d=ja.fT();break;case U.GQ:d=ja.cU();break;case U.An:d=ja.aT();break;case U.eq:d=ja.uT()}d&&(f=U.bi(d,S.ir("NONE")),U.Sc(e,f),w(b,e,d),F(d))})};a.Ln=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var e=a.s.Wa,d=b.k;!ga.hc(e,U.dd)&&d.je&&(d.je=!1);d=R(a,hb);c&&b.rn&&da.Ln(b,a);for(var f=0;f<d.length;f++){var k=d[f],h=b,p=e,n=a,g=c;switch(k.type){case U.Pb:ea(k,h,p,"OPAQUE",n,g);break;case U.Pc:ea(k,
h,p,"BLEND",n,g);break;case U.ag:ea(k,h,p,"XRAY",n,g);break;case U.ke:ea(k,h,p,"GLOW",n,g);break;case U.Rd:case U.nd:M(k,h,p,!1,n,g);break;case U.Cf:case U.Ue:M(k,h,p,!0,n,g);break;case U.Df:for(var q=S.ja(h,n).X,m=0;m<q.length;m++){var v=q[m];if("SHADOW"==v.type&&"RECEIVE"==v.vb&&v.je){if(!g&&(I(v,k,h,p,"SHADOW",n),!ja.Zc(v)))continue;var l=U.bi(v,h.k);U.Sc(k,l);w(p,k,v);F(v)}}break;case U.dd:q=!1;m=h.k;h=S.ja(h,n).X;v=ga.hc(p,U.Di);for(l=0;l<h.length;l++){var H=h[l];if("SHADOW"==H.type&&"CAST"==
H.vb){q=!0;if(!g){var t=k.Rw;ja.qf(H,"NUM_LIGHTS",t);ja.qf(H,"NUM_LFACTORS",0==t%2?t/2:Math.floor(t/2)+1);va.ha(H.hb,"SHADOW_USAGE","SHADOW_CASTING");H.jd&&v&&T(H,v,m);ja.qf(H,"SHADOW_TEX_RES",va.O(n.s.yd.csm_resolution));if(!ja.Zc(H))continue}H=U.bi(H,m);U.Sc(k,H)}}q&&(h=n.s.yd,g=ga.hc(p,U.Pb),fa(k,n,g.p,h,!0));break;case U.zf:P(k,h,p,n,g);break;case U.Ci:P(k,h,p,n,g);break;case U.Kg:q=h.k;m=S.ja(h,n).X;for(v=0;v<m.length;v++)if(l=m[v],"COLOR_ID"==l.type&&"OUTLINE"==l.vb){if(!g&&(I(l,k,h,p,"COLOR_ID",
n),ja.qf(l,"USE_OUTLINE",1),!ja.Zc(l)))continue;l=U.bi(l,q);U.Sc(k,l)}break;case U.Di:p=h.k;h=S.ja(h,n).X;for(n=0;n<h.length;n++)if(q=h[n],"GRASS_MAP"==q.type){if(!g&&!ja.Zc(q))if("DEBUG"===Ta.type())ja.zu(q,"error.glslv","error.glslf"),ja.Zc(q);else continue;q=U.bi(q,p);U.Sc(k,q);q=k.p;H=p.Ta;m=k.ne[0];v=k.ne[1];l=k.ne[2];0==m&&0==v?(m=H.min_z,v=H.max_z):(m=Math.min(m,H.min_z),v=Math.max(v,H.max_z));H=1E-4*(v-m);m-=H;v+=H;k.ne[0]=m;k.ne[1]=v;ta.xx(q,l/2,-v,-m,l/2);ta.Wk(q)}break;case U.Bf:for(q=
h.k,h=S.ja(h,n).X,n=0;n<h.length;n++)m=h[n],"DEBUG_VIEW"==m.type&&W(k,q,p,g,m)}}break;case "LAMP":aa(b,a),Na.g_(a)}S.HD(b,!0,a)};a.ME=n;a.ID=function(a){a.s.Nw=!0};a.y0=function(a,b){la.pa(b,function(b,c){if(c.type===U.dd){var e=wa.ic(a.n,sb);wa.ue(e,c.p.n);wa.copy(a.wf,c.p.dt)}})};a.$$=V;a.IV=function(a,b){for(var c=a.s.yd,e=new Float32Array(c.csm_num),d=0;d<c.csm_num;d++)e[d]=ta.fU(c,b,d);return e};a.i3=W;a.mH=ha;a.Nq=v;a.nC=function(a){return a.k.ai};a.KY=function(a){for(var b=0;b<a.I.length;b++)for(var c=
R(a.I[b].yb,hb),b=0;b<c.length;b++)for(var e=c[b].Qa,d=0;d<e.length;d++)for(var f=e[d].sa,k=f.length-1;0<=k;k--){var h=f[k];h.mf==a.k&&(h.za&&ja.AH(h.za),f.splice(k,1))}};a.n0=function(a,b){for(var c=a.tb,e=S.ja(a,b).Km,d=R(b,eb),f=0;f<d.length;f++){var k=d[f];k.ps.set(c.ar,4*e);k.Ba=!0}};a.Ap=aa;a.A0=function(a){a=a.I;for(var b=0;b<a.length;b++)n(a[b].yb)};a.ua=function(){for(var a=0;a<Ua.length;a++){var b=Ua[a];la.pa(b.s.Wa,function(a,b){if(b.type!=U.In){var c=b.p;Qa.LY(c.ff,c.wc,c.af,c.width,c.height);
for(var c=b.Qa,e=0;e<c.length;e++)for(var d=c[e].sa,f=0;f<d.length;f++){var k=d[f].za;k&&ja.AH(k)}}});b.s.Wa=[];b.s.Zm=[]}yb=ob=null;Ua.length=0;Nb=null};a.MK=function(a,b,c){a=ta.QU(a,a.near,a.far,null,!0);var e=xb.vV(a);a=S.ir("DYNAMIC");a.Ta=a.S={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.kb=a.wa=qa.MR();var d=a.kb.Xa;a.pb=a.ba=qa.Bq([d,0,0],[0,d,0],[0,0,d],a.kb.G);a.Bp=!1;c=ja.AT(e,c);c=U.bi(c,a);U.Sc(b,c)};a.O6=function(a){return[a.frame_start,a.frame_end]};a.HM=
function(a,b,c){Ca.UZ(a,b,c);yb&&na(yb,a,b)};a.d$=na;a.iE=R;a.La=ca;a.iJ=function(a){a=ca(a,U.Pb);var b=a.oe,c=a.ye,e=[],d=[];e[0]=b[0];e[1]=b[1];e[2]=b[2];d[0]=c[0];d[1]=c[1];d[2]=c[2];return[a.ah,e,d]};a.wx=function(a,b,c,e){a=R(a,eb);for(var d=0;d<a.length;d++){var f=a[d];f.oe.set(c);f.ye.set(e);f.ah=b;f.Ba=!0}};a.IJ=function(a){if(a=ca(a,U.Lg)){var b={};b.color=Array(3);Ra.copy(a.gp,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.yM=function(a,b){var c=ca(a,U.Lg);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.gp.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.Ba=!0,c.Mw=!0,ba(a,c))};a.QV=function(a){return R(a,cb)[0].jg[0]};a.OV=function(a){return R(a,cb)[0].jg[1]};a.RV=function(a){return R(a,cb)[0].jg[2]};
a.PV=function(a){return R(a,cb)[0].jg[3]};a.mM=function(a,b){for(var c=R(a,cb),e=0;e<c.length;e++){var d=c[e];d.jg[0]=b;d.Ba=!0}};a.kM=function(a,b){for(var c=R(a,cb),e=0;e<c.length;e++){var d=c[e];d.jg[1]=b;d.Ba=!0}};a.nM=function(a,b){for(var c=R(a,cb),e=0;e<c.length;e++){var d=c[e];d.jg[2]=b;d.Ba=!0}};a.lM=function(a,b){for(var c=R(a,cb),e=0;e<c.length;e++){var d=c[e];d.jg[3]=b;d.Ba=!0}};a.lJ=function(a,b){var c=b||[],e=R(a,cb)[0].Ge;c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];return c};a.ND=function(a,
b){for(var c=R(a,cb),e=0;e<c.length;e++){var d=c[e];d.Ge.set(b);d.Ba=!0}};a.KJ=function(a){var b=ca(a,U.mu);a=ca(a,U.Mz);if(!b)return null;var c=b.Qa[0].sa[0].za,e={};e.ssao_quality=ja.HB(c,"SSAO_QUALITY")[1];e.ssao_hemisphere=b.ssao_hemisphere;e.ssao_blur_depth=a.ssao_blur_depth;e.YG=a.ssao_blur_discard_value;e.radius_increase=b.lp;e.influence=b.kp;e.dist_factor=b.jp;e.ssao_only=b.ssao_only;e.ssao_white=ja.HB(c,"SSAO_WHITE")[1];return e};a.AM=function(a,b){var c=ca(a,U.mu),e=ca(a,U.Mz);if(!c)return Ga.error("SSAO is not enabled on the scene"),
0;var d=c.Qa[0].sa[0],f=d.za;"string"==typeof b.ssao_quality&&(ja.qf(f,"SSAO_QUALITY",b.ssao_quality),ja.Zc(f),U.Sc(c,d));"number"==typeof b.ssao_hemisphere&&(ja.qf(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),ja.Zc(f),U.Sc(c,d));"number"==typeof b.ssao_blur_depth&&(ja.qf(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ja.Zc(f),U.Sc(c,d));"number"==typeof b.ssao_white&&(ja.qf(f,"SSAO_WHITE",b.ssao_white),ja.Zc(f),U.Sc(c,d));"number"==typeof b.ssao_blur_discard_value&&(e.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.lp&&(c.lp=b.lp);"number"==typeof b.kp&&(c.kp=b.kp);"number"==typeof b.jp&&(c.jp=b.jp);if("number"==typeof b.ssao_only){c=ca(a,U.Pb);c.ssao_only=b.ssao_only;for(var d=c.Qa,k=0;k<d.length;k++)for(var h=d[k].sa,p=0;p<h.length;p++)f=h[p].za,ja.qf(f,"SSAO_ONLY",b.ssao_only),ja.Zc(f),U.Sc(c,h[p])}c.Ba=!0;e.Ba=!0};a.gJ=function(a){a=ca(a,U.Qp);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;
b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.iM=ra;a.oJ=function(a){var b=R(a,[U.Lj]);a=ca(a,U.Xt);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Bo;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ja.HB(b[0].Qa[0].sa[0].za,"STEPS_PER_PASS")[1];return c};a.pM=function(a,b){var c=R(a,[U.Lj]),e=ca(a,U.Xt);if(!c||!e)return Ga.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(e.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var d=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].Bo=d,c[f].lx=d/c[f].pp/(f+1),c[f].Ba=!0;if("number"==typeof b.god_rays_steps)for(var k=va.O(b.god_rays_steps,1),d=c[0].Bo,f=0;f<c.length;f++){c[f].pp=k;c[f].lx=d/k/(f+1);c[f].Ba=!0;var h=c[f].Qa[0].sa[0],p=h.za;ja.qf(p,"STEPS_PER_PASS",k);ja.Zc(p);U.Sc(c[f],h)}e.Ba=!0};a.$I=function(a){var b=ca(a,U.eu);a=ca(a,
U.Lp);if(!b||!a)return null;var c={};c.key=b.Hu;c.edge_lum=b.Gu;c.blur=a.On;return c};a.aM=xa;a.nJ=function(a){a=ca(a,U.Sp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.oM=oa;a.WJ=function(a){var b=ma(a);a=Ra.length(b);if(0==a)return null;var b=La.se(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};
a.eZ=function(a){a.s.RC=!0};a.TJ=Y;a.SJ=function(a,b){var c=a.s.Mc,e=ca(a,U.Pb);e&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,e.zi&&(b.water_fog_density=e.zi[3],c=b.water_fog_color=[],c[0]=e.zi[0],c[1]=e.zi[1],c[2]=e.zi[2]))};a.FM=function(a,b){var c=a.s.Mc;if(!c)return Ga.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);
"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);
"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.xr=b.water_dynamic);for(var e=R(a,ib),d=0;d<e.length;d++){var f=e[d];"number"==typeof b.water_fog_density&&c.Ge&&(f.zi[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Ge&&f.zi.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.VE=b.waves_height);"number"==typeof b.waves_length&&(f.WE=b.waves_length);f.Ba=!0}};a.HJ=
function(a,b,c){var e=a.s.Mc;if(!e.Yk)return 100;var d=e.EC;a=e.tl;var f=(b[0]-e.dp[0])/e.ep[0],k=(e.dp[1]+b[1])/e.ep[1],f=f+.5,k=k+.5;if(1<f||0>f||1<k||0>k)b=1;else return e=d*La.YI(yb.s.$D,e.aE,f,k),b=(a-b[2])*c,b=Math.sqrt(e*e+b*b)};a.update=function(a,b){for(var c=d().Mj.k,e=0;e<Ua.length;e++){var f=Ua[e],k=f.s.Wa,h=f.s;if(h.Mc)var p=wa.F(c.n),n=p[2]-Y(f,p[0],p[1]);for(p=0;p<h.Hp.length;p++){var g=h.Hp[p].s,q=g.Sa,m=g.xd;if(!(f.b4w_use_nla&&g.ml||!q&&!m)&&Oa.rO(g)){var v=Oa.oO(g),l=Oa.qO(g);q&&
Ba.is_mobile_device&&(l-=5);var w=Oa.T0(g);v>=w&&g.Ej||v<l?(Oa.RL(g),m&&(g.Uk=Oa.tx(g,a))):v>=w&&!g.Ej?Oa.eD(g):Oa.sO(g)&&(q?Oa.WN(g):(q=Oa.tx(g,a),q!=g.Uk&&(Oa.VN(g),g.tj++),g.Uk=q))}}la.pa(k,function(b,c){-1<nb.indexOf(c.type)&&(c.time=a);h.Mc&&(c.uA=n)})}for(e=0;e<Ua.length;e++)if(f=Ua[e],h=f.s,k=h.Wa,c=h.Zm,c.length)for(h.Nw&&(X(f),h.Nw=!1),h.RC&&(ia(f),h.RC=!1),h.SC&&(H(f),h.SC=!1),h.motion_blur&&J(k,b),f=ga.hc(k,U.Kg),p=0;p<c.length;p++)k=c[p],ka.fx(k),f&&ua(k,f),Qa.co(k);Ba.show_hud_debug_info&&
Da.ZZ(Ua,b)};a.UY=function(a){a.s.SC=!0};a.FB=function(a){var b=[];la.pa(a.s.Wa,function(a,c){b.push(c)});return b};a.bJ=function(){var a=ca(yb,U.Pc),b=yb;return a||b.s.Mc?a.uA:null};a.UN=function(a){la.pa(a.s.Wa,function(a,b){b.Ba=!0})};a.nZ=function(a,b){a.debug_view_mode=b;a.dc=b!=Aa.Ot;a.Lb=b==Aa.Pt;a.Ba=!0;for(var c=d(),e=0;e<ib.length;e++){var f=ca(c,ib[e]);f&&(f.oB=b==Aa.Rp)}};a.mZ=function(a,b){a.debug_colors_seed=b;a.Ba=!0};a.IZ=function(a,b){a.iI=b;a.Ba=!0};a.RZ=function(a,b){for(var c=
a.Qa,e=0;e<c.length;e++)for(var d=c[e].sa,f=0;f<d.length;f++){var k=d[f].za;Ra.copy(b,k.wireframe_edge_color);k.Ba=!0}};a.QN=function(a,b){var c=b.ho,e=a.s.Jj;if(c&&"WIND"==c.type&&e){var d=wa.P(b.k.n);Ra.transformQuat(La.nc,d,e);Ra.normalize(e,e);Ra.scale(e,c.jN,e);c=R(a,nb);for(d=0;d<c.length;d++)c[d].Jj.set(e);return!0}return!1};a.mY=function(a,b,c){var e=ca(a,U.zf);if(e){var d=Ca.Yh();ta.kZ(e.p,b,c,d.clientWidth,d.clientHeight);ka.fx(e);e.dc&&Qa.co(e);if(a=ca(a,U.Ci))Sa.copy(e.p.xb,a.p.xb),Sa.copy(e.p.md,
a.p.md),La.fo(a.p.md,a.p.Xh),ka.fx(a),a.dc&&Qa.co(a);if(e.dc||a&&a.dc)return Qa.sD(a?a.p.ff:e.p.ff,0,0)}else Ga.error("Object Selection is not available on the scene");return null};a.vM=function(a){var b=d();if(b=ca(b,U.En))b.pj.set(a),b.Ba=!0};a.p7=ma;a.Hv=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.PN=function(a,b){var c=sb;Ra.negate(b,c);for(var e=0;6>e;e++){var d=a.$l[e],f=a.lr[e],k=a.p;Sa.translate(La.NO[e],
c,d);Sa.multiply(k.xb,d,k.md);La.fo(k.md,f)}};a.SN=function(a,b,c){La.O_(b,c,La.nc,a.p.rc)};a.CR=function(a,b,c){var e=a.s.yd,d=a.s.li;c=S.Lv(c,Ba.ssao&&a.b4w_enable_ssao);if(d)for(var f=0;f<b.length;f++){var k=b[f],h=S.ja(k,a);if(-1!=k.k.Hd){var p=d.ii,n=d.dx,k=k.k.Hd;n.length?h.ii=n[k]:p.length&&(h.ii=p[k])}else-1!=k.k.Vd&&(p=d.Ri,n=d.aB,k=k.k.Vd,n.length?h.Ri=n[k]:p.length&&(h.Ri=p[k]))}for(f=0;f<c.length;f++)if(h=S.ja(c[f],a),e)for(b=R(a,[U.dd]),d=0;d<b.length;d++)f==b[d].zh&&h.ZD.push(b[d])};
a.NK=function(a,b){return a.timeline_markers[b]};a.yx=function(a){var b=d();if(b=ca(b,U.Fi))a.distortion_coefs&&(b.dm[0]=a.distortion_coefs[0],b.dm[1]=a.distortion_coefs[1],b.Ba=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Ba=!0),a.base_line_factor&&(b.dm[2]=
a.base_line_factor,b.Ba=!0),a.inter_lens_factor&&(b.dm[3]=a.inter_lens_factor,b.Ba=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Ba=!0)};a.VK=function(b,c){for(var e=Ua,d=0;d<e.length;d++)ga.YX(a.MB(e[d]),b,c)};a.W_=function(a){for(var b=Na.Ub(a,"LAMP",Na.oc),c=R(a,hb),e=0;e<c.length;e++)for(var d=c[e],f=d.Qa,k=0;k<f.length;k++)for(var h=f[k].sa,p=0;p<h.length;p++){var n=h[p],g=n.za;"MAIN"==g.type&&(ja.$_(g,b,a),ja.Zc(g),U.Sc(d,n))}};a.O8=function(a){for(var b=0;b<Ua.length;b++)la.pa(Ua[b].s.Wa,
function(b,c){for(var e=c.Qa,d=0;d<e.length;d++)for(var f=e[d].sa,k=0;k<f.length;k++){var h=f[k];h.za==a&&U.Sc(c,h)}})}};b4w.module.__hud=function(a,g){function l(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var c=0,d=0,f=0;h.pa(a.s.Wa,function(a,h){if(h.type!=u.In){for(var g=Math.round(h.p.width)+"x"+Math.round(h.p.height),q=0,m=0;m<h.Qa.length;m++)q+=h.Qa[m].sa.length;m=h.nr;if(h.type==u.nd||h.type==u.Ue)q*=6;var l=h.dc,t=l?h.Hf:0;h.Yd||(h.Hf=0);var r=
l?" (\u2713)":" (\u2715)",k=u.jE(h);b(r,k,h.Rw,g,m,"of",q,"  ",t.toFixed(3));h.nr=0;l&&(c+=q,d+=m,f+=t)}});return[c,d,f]}b("No INFO")}function b(){for(var a=80+20*f[0],b=arguments[0],d=1;d<arguments.length;d++){for(var h="",g=0;g<m[d]-String(arguments[d]).length;g++)h+=" ";b+=h+arguments[d]}f[0]++;q.fillText(b,30,a)}function y(a,b,d){b*=a.uc;d.x=a.x+b;d.y=a.y;d.uc=a.uc-2*b;d.Ib=a.Ib}function r(a){return a.x+a.uc/2}function A(a){var b=q,d={x:0,y:0,uc:0,Ib:0},f=b.canvas.width,b=b.canvas.height;d.x=
0;d.y=0;d.uc=f;d.Ib=b;y(d,.01,d);f=.02*d.Ib;d.x=d.x;d.y+=f;d.uc=d.uc;d.Ib-=2*f;f=d.uc/8;d.x+=f*a;d.y=d.y;d.uc=f;d.Ib=d.Ib;y(d,.02,d);return d}var h=g("__graph");g("__print");var u=g("__subscene"),m=[5,30,4,10,5,3,5],q=null,f=[0,0];a.hh=function(a){a=a.getContext("2d");l(a);return q=a};a.pt=function(){q&&l(q)};a.reset=function(){var a=q;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),f[0]=0,f[1]=0)};a.ZZ=function(a,c){var h=
q;if(h){h.textAlign="left";h.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/c).toFixed(2));f[0]++;for(var g=h=0,m=0,l=0;l<a.length;l++){var r=d(a[l]),h=h+r[0],g=g+r[1],m=m+r[2];f[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",g,"of",h,"  ",m.toFixed(3))}};a.print=function(){var a=q;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.N8=function(a,b,d,f,h,g,m){var l=q;if(l){b=A(b);var u=b.Ib/5;b.x=b.x;b.y+=4*u;b.uc=
b.uc;b.Ib=u;l.textAlign="center";l.fillStyle="#00FF00";q.fillText(a,r(b),b.y-10);l.strokeStyle="#00FF00";l.lineWidth=.5;l.beginPath();l.moveTo(b.x,b.y);l.lineTo(b.x+b.uc,b.y);l.lineTo(b.x+b.uc,b.y+b.Ib);l.lineTo(b.x,b.y+b.Ib);l.closePath();l.stroke();if(!g&&!m)for(g=1E6,m=-1E6,a=0;a<d.length;a++)g=Math.min(g,d[a]),m=Math.max(m,d[a]);l.textAlign="right";q.fillText(String(g),b.x-10,b.y+b.Ib);q.fillText(String(m),b.x-10,b.y);l.textAlign="center";q.fillText(String(f),b.x,b.y+b.Ib+15);q.fillText(String(h),
b.x+b.uc,b.y+b.Ib+15);l.strokeStyle="#FF0000";l.lineWidth=1.5;l.beginPath();f=b.uc/(d.length-1);m=b.Ib/(m-g);for(a=0;a<d.length;a++)h=b.x+f*a,u=b.y+b.Ib-(d[a]-g)*m,0==a?l.moveTo(h,u):l.lineTo(h,u);l.stroke()}};a.S4=function(a,b,d,f,h,g,m){var l=q;if(l)for(l.textAlign="center",l.fillStyle="#00FF00",l.font="bold 12px Courier",d=A(d),q.fillText(b?"["+a+"]":a,r(d),d.y),0<=g&&q.fillText(g?"[M]":"[ ]",r(d)-15,d.y+30),0<=m&&q.fillText(m?"[S]":"[ ]",r(d)+15,d.y+30),a={x:0,y:0,uc:0,Ib:0},b=0;b<f.length;b++){g=
f[b];var u="VOLUME"==g[0];if(u){m=d.y+350;var E=d.uc,C=a;C.x=d.x;C.y=m;C.uc=E;C.Ib=250}else{m=d.y+50+50*b;var E=d.uc,C=d.Ib,Q=a;Q.x=d.x;Q.y=m;Q.uc=E;Q.Ib=C}m=l;var E=a,Q=b==h,k=g[0],C=g[1],p=g[2],x=g[3],e=(x-p)/g[4],e=1>e?Math.floor(1/e-1E-5).toFixed(0).length:0;g=g[5]?Math.log(C/p)/Math.log(x/p):(C-p)/(x-p);m.textAlign="center";Q?m.fillText("["+k+"]",r(E),E.y):m.fillText(k,r(E),E.y);m.strokeStyle="#00FF00";m.lineWidth=u?3:1;u?(m.textAlign="right",m.fillText(x.toFixed(e),r(E)-10,E.y+15),m.textAlign=
"right",m.fillText(p.toFixed(e),r(E)-10,E.y+E.Ib-15)):(m.textAlign="right",m.fillText(p.toFixed(e),E.x+28,E.y+15),m.textAlign="left",m.fillText(x.toFixed(e),E.x+E.uc-28,E.y+15));m.beginPath();if(u){var w=E.y+15+(E.Ib-30)*(1-g);m.moveTo(r(E),E.y+15);m.lineTo(r(E),E.y+E.Ib-15);m.moveTo(r(E)-5,E.y+15);m.lineTo(r(E)+5,E.y+15);m.moveTo(r(E)-5,E.y+E.Ib-15);m.lineTo(r(E)+5,E.y+E.Ib-15);m.moveTo(r(E)-5,w);m.lineTo(r(E)+5,w)}else{var n=E.x+30+(E.uc-60)*g;m.moveTo(E.x+30,E.y+15);m.lineTo(E.x+E.uc-30,E.y+15);
m.moveTo(E.x+30,E.y+15-5);m.lineTo(E.x+30,E.y+15+5);m.moveTo(E.x+E.uc-30,E.y+15-5);m.lineTo(E.x+E.uc-30,E.y+15+5);m.moveTo(n,E.y+15-5);m.lineTo(n,E.y+15+5)}m.stroke();"EQ_Q"==k?(g=Math.log(1+1/(2*C*C)+Math.sqrt((2+1/(C*C))*(2+1/(C*C))/4-1))/Math.log(2),u?(m.textAlign="left",m.fillText(C.toFixed(e),r(E)+10,w),m.textAlign="left",m.fillText("("+g.toFixed(e+1)+")",r(E)+10,w+10)):(m.textAlign="right",m.fillText(C.toFixed(e),n,E.y+30),m.textAlign="left",m.fillText("("+g.toFixed(e+1)+")",n,E.y+30))):u?(m.textAlign=
"left",m.fillText(C.toFixed(e),r(E)+10,w)):(m.textAlign="center",m.fillText(C.toFixed(e),n,E.y+30))}}};b4w.module.__subscene=function(a,g){function l(a,b){a.Rw=b;a.wC=new Float32Array(3*b);a.qs=new Float32Array(4*b);a.ps=new Float32Array(4*b)}function d(a){a={type:a,vb:"",Lb:!1,lL:!1,bA:!1,Mw:!1,nr:0,Hf:0,am:[],debug_view_mode:0,debug_colors_seed:0,iI:1,oB:!1,time:0,p:null,$l:null,lr:[],Qa:[],Ya:[],ui:[],Jj:new Float32Array(3),ne:new Float32Array(3),Ge:new Float32Array(4),jg:new Float32Array(4),De:new Float32Array(16),Px:0,ah:0,Rw:0,wC:null,qs:null,ps:null,f8:null,oe:new Float32Array(3),ye:new Float32Array(3),
Qx:new Float32Array(4),oN:new Float32Array(3),kE:new Float32Array([0,0,1]),pN:new Float32Array(4),Ox:new Float32Array(3),Bs:0,qB:0,cs:!1,pj:new Float32Array(3),Ij:!1,uA:0,zi:null,VE:0,WE:0,tl:0,Mc:null,Sg:!1,iH:0,jH:new Float32Array(2),hH:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,gp:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,lp:0,kp:0,jp:0,dN:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Bo:0,lx:0,pp:0,$A:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,ky:null,jy:null,QE:null,Um:null,zc:!1,II:"",Hu:0,On:0,Gu:0,hA:0,wB:0,mb_decay_threshold:0,mb_factor:0,TK:0,ex:"",DH:"",YW:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,uE:new Float32Array(2),Fb:new Float32Array(2),
dm:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,zh:0,QC:!0,SM:!1,XM:!1,TM:!1,UM:!1,WM:!1,VM:!1,RM:"",xt:!1,yt:!1,zt:!1,dc:!0,Yd:!0,wb:!0,Bb:!0,Wd:!0,Ba:!0,Cg:1};a.Fb[0]=1;a.Fb[1]=1;a.dm[2]=.5;a.dm[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function y(a,d){return-b(a.Mg,d.Mg)||b(a.vg,d.vg)||b(a.zb.YD,d.zb.YD)}var r=g("__camera"),A=g("__config"),h=g("__util"),u=g("__boundings"),m=A.Wc;a.Pb=0;a.Pc=1;a.ag=2;a.Rd=3;a.nd=4;a.Cf=5;a.Ue=6;a.ke=7;a.dd=
8;a.Df=9;a.Di=10;a.gc=11;a.Mp=12;a.Sp=13;a.Hn=14;a.zf=15;a.Ci=16;a.Bf=17;a.An=18;a.iF=19;a.mu=20;a.Mz=21;a.$E=22;a.iq=23;a.ku=24;a.Kz=25;a.lu=26;a.My=27;a.Hh=28;a.Ly=29;a.Qp=30;a.Kg=31;a.En=32;a.Lj=33;a.Xt=34;a.Lg=35;a.Ny=36;a.Fi=37;a.LUMINANCE=38;a.AO=39;a.eu=40;a.Lp=41;a.GQ=42;a.In=43;a.eq=44;a.WT=function(a,b,g,c){var m=d(8);m.$A=a;m.self_shadow_polygon_offset=g.self_shadow_polygon_offset;m.zh=b;switch(g.lh[b]){case "SPOT":case "POINT":m.p=r.hd(r.Sd);a=h.se(g.cN[b]);r.xx(m.p,a,g.Tq[b],g.Sq[b]);
break;default:m.p=r.hd(r.Gi)}l(m,c);return m};a.WS=function(a){var b=a.p;a.p=null;var d=h.T(a);a.p=b;d.p=r.Ic(b,!0);return d};a.PT=function(){var a=d(10);a.p=r.hd(r.Jh);return a};a.Cd=function(a){var b=d(11);b.wb=!1;b.Bb=!1;b.Wd=!1;b.zc=!0;b.p=r.hd(r.qd);b.ex=a;switch(a){case "NONE":b.Fb[0]=1;b.Fb[1]=1;break;case "GRAYSCALE":b.Fb[0]=1;b.Fb[1]=1;break;case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=0;b.Fb[1]=1;break;case "X_GLOW_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_GLOW_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;case "X_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "Y_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "X_ALPHA_BLUR":b.Fb[0]=1;b.Fb[1]=0;b.Cg=3;break;case "Y_ALPHA_BLUR":b.Fb[0]=0;b.Fb[1]=1;b.Cg=3;break;case "X_EXTEND":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_EXTEND":b.Fb[0]=0;b.Fb[1]=1;break;default:h.q("Wrong postprocessing effect: "+a)}return b};a.UH=function(a){var b=d(12);b.wb=!1;b.Bb=!1;b.Wd=!1;b.p=r.hd(r.qd);b.ex=a;b.zc=!0;switch(a){case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;default:h.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.NT=function(a,b){var h=d(13);h.wb=!1;h.Bb=!1;h.Wd=!1;h.small_glow_mask_coeff=b.nk.small_glow_mask_coeff;h.large_glow_mask_coeff=b.nk.large_glow_mask_coeff;h.small_glow_mask_width=b.nk.small_glow_mask_width;h.large_glow_mask_width=b.nk.large_glow_mask_width;h.p=a;h.zc=!0;return h};a.Yl=function(a,b,g,c,m,r,u,y,B){var A=d(a);0==a?(A.wb=!0,A.Bb=g,A.Lb=!1):1==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):2==a?(A.wb=!1,A.Bb=!0,A.Lb=
!0):3==a||4==a?(A.wb=!0,A.Bb=!0,A.Lb=!1):5==a||6==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):7==a?(A.wb=!0,A.Bb=!1,A.Lb=!0):h.q("wrong main subscene type");A.Lb&&y&&(A.self_shadow_normal_offset=y.self_shadow_normal_offset);A.p=b;if(a=u.hp)A.Qx.set([a.VG,a.dK,a.yO,a.xO]),A.Ox.set(a.color),A.Px=a.Ea;A.oe.set(u.oe);A.ye.set(u.ye);A.ah=u.ah;A.Ge=r.Ge;A.jg=r.jg;c&&(A.Mc=c,c.Ge&&(A.zi=new Float32Array(c.Ge)),A.VE=c.waves_height,A.WE=c.waves_length,A.tl=c.tl,c.Sg&&B&&(A.Sg=!0,A.iH=c.qS,A.hH=c.pS,A.jH.set(c.rS)));l(A,m);
return A};a.av=function(){var a=d(14);a.zc=!0;a.p=r.hd(r.qd);return a};a.VH=function(a,b,h){var c=d(15);b&&(c.type=16,c.wb=!1,c.Bb=!0);c.Yd=!1;c.p=a;l(c,h);return c};a.LT=function(a){var b=d(17);b.dc=!1;b.wb=!1;b.Bb=!1;b.p=a;return b};a.HT=function(a){var b=d(18);b.wb=!0;b.Bb=!1;b.p=a;return b};a.XT=function(a,b){var h=d(9);h.p=a;l(h,b);return h};a.MT=function(a){var b=d(19);b.wb=!1;b.Bb=!1;b.p=a;b.zc=!0;return b};a.ZT=function(a,b,h){var c=d(20);c.wb=!1;c.Bb=!1;c.Wd=!1;c.p=a;c.Ge=b.Ge;c.zi=new Float32Array(b.Ge);
c.lp=h.radius_increase;c.ssao_hemisphere=h.sW;c.kp=h.influence;c.jp=h.dist_factor;c.dN=h.dZ;c.zc=!0;return c};a.$T=function(a,b){var h=d(21);h.wb=!1;h.Bb=!1;h.Wd=!1;h.p=a;h.ssao_blur_depth=b.RR;h.ssao_blur_discard_value=b.YG;h.zc=!0;return h};a.GT=function(a){var b=d(22);b.wb=!1;b.Bb=!1;b.Wd=!1;b.Cg=1/a.Uo;b.II=a.iG;b.p=r.hd(r.qd);b.zc=!0;return b};a.YA=function(a,b){var h=d(a);h.wb=23==a||24==a?!0:!1;h.Bb=!1;h.Wd=!1;h.Cg=1/b.Uo;h.p=r.hd(r.qd);23==a&&(h.ZW=new Float32Array(4));h.zc=!0;return h};a.KT=
function(a,b,h,c){var g=d(27);g.wb=!1;g.Bb=!1;g.Wd=!1;g.p=r.hd(r.qd);g.brightness=a;g.contrast=b;g.exposure=h;g.saturation=c;g.zc=!0;return g};a.ST=function(a,b){var h=d(28);h.wb=!1;h.Bb=!1;h.Wd=!1;h.p=r.hd(r.qd);h.bA=!0;h.mb_decay_threshold=a;h.mb_factor=b;h.zc=!0;return h};a.VA=function(a,b){var h=d(29);h.wb=!1;h.Bb=!1;h.Wd=!1;h.p=a;h.Cg=h.p.dof_power;h.DH=b;h.zc=!0;return h};a.WH=function(a){var b=d(30);b.wb=!1;b.Bb=!1;b.Wd=!1;b.p=a;b.Cg=b.p.dof_power;b.zc=!0;return b};a.UT=function(a,b){var h=
d(31);h.Wd=!1;h.p=a;l(h,b);return h};a.TT=function(a){var b=d(32);m.outlining_overview_mode?b.pj.set(m.pj):b.pj.set(a.pj);b.Bs=a.Bs;b.wB=5;b.hA=3;b.Wd=!1;b.p=r.hd(r.qd);b.zc=!0;return b};a.XA=function(a,b,h,c,g,m,r){var u=d(33);u.wb=!1;u.Bb=!1;u.Wd=!1;u.oe=new Float32Array([1,1,1]);u.ye=new Float32Array([1,1,1]);u.ah=1;u.lL=c;u.Ij=b;u.lx=g;u.Bo=h;u.pp=r;u.p=a;l(u,m);return u};a.OT=function(a,b){var h=d(34);h.wb=!1;h.Bb=!1;h.Wd=!1;h.p=r.hd(r.qd);h.god_rays_intensity=a;l(h,b);h.zc=!0;return h};a.YT=
function(a,b,g,c){var m=d(35);m.Yd=!1;m.wb=!1;m.Bb=!1;m.Wd=!1;var u=r.hd(r.qd);u.width=c;u.height=c;m.p=u;m.$l=h.tV();l(m,b);m.oe=new Float32Array([1,1,1]);m.ye=new Float32Array([1,1,1]);m.ah=1;m.gp.set(g.gp);m.procedural_skydome=g.procedural_skydome;m.use_as_environment_lighting=g.use_as_environment_lighting;m.rayleigh_brightness=g.rayleigh_brightness;m.mie_brightness=g.mie_brightness;m.spot_brightness=g.spot_brightness;m.scatter_strength=g.scatter_strength;m.rayleigh_strength=g.rayleigh_strength;
m.mie_strength=g.mie_strength;m.rayleigh_collection_power=g.rayleigh_collection_power;m.mie_collection_power=g.mie_collection_power;m.mie_distribution=g.mie_distribution;if(a){m.oe.set(a.oe);m.ye.set(a.ye);m.ah=a.ah;if(b=a.hp)m.Qx.set([b.VG,b.dK,b.yO,b.xO]),m.Ox.set(b.color),m.Px=b.Ea,m.SM=b.invert,m.XM=b.dO,m.TM=b.ZN,m.UM=b.$N,m.WM=b.bO,m.VM=b.aO,m.RM=b.WG;m.xt=a.xt;m.yt=a.yt;m.zt=a.zt}return m};a.WA=function(){var a=d(36);a.wb=!1;a.Bb=!1;a.p=r.hd(r.qd);a.zc=!0;return a};a.aU=function(a){var b=d(37);
b.wb=!1;b.Bb=!1;b.vb=a?"HMD":"ANAGLYPH";b.p=r.hd(r.qd);b.zc=!0;return b};a.QT=function(){var a=d(38);a.wb=!1;a.Bb=!1;a.p=r.hd(r.qd);a.zc=!0;return a};a.IT=function(){var a=d(39);a.wb=!1;a.Bb=!1;a.p=r.hd(r.qd);a.zc=!0;return a};a.RT=function(a,b,h,c){var g=d(40);g.wb=!1;g.Bb=!1;g.Hu=a;g.Gu=b;g.p=c;l(g,h);g.zc=!0;return g};a.JT=function(a){var b=d(41);b.wb=!1;b.Bb=!1;b.p=r.hd(r.qd);b.On=a;b.zc=!0;return b};a.B4=function(a){var b=d(42);b.wb=!1;b.Bb=!1;b.p=a;b.zc=!0;return b};a.XH=function(){var a=d(43);
a.Yd=!1;return a};a.VT=function(){var a=d(44);a.zc=!0;return a};a.jE=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.ex.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Sc=function(a,b){for(var d=b.za,c=d.zb,h=0;h<a.Qa.length;h++){var g=a.Qa[h].sa,m=g.indexOf(b);
-1!=m&&(g.splice(m,1),g.length||a.Qa.splice(h,1))}h=a.Lb?d.vg:0;a:{g=a.Qa;for(m=0;m<g.length;m++){var l=g[m];if(l.zb==c&&h==l.vg){g=l;break a}}g=null}g?g.sa.push(b):(a.Qa.push({zb:c,sa:[b],Mg:d.Mg,vg:h,dc:!0}),a.QC=!0)};a.bi=function(a,b){var d={dc:!0,pB:[!0,!0,!0,!0,!0,!0],mf:b,za:a,iw:null};if(a.yf&&a.Ca.pe){var c=a.Ca.pe;d.iw={RX:new Float32Array(c.length),SX:new Float32Array(c.length),vU:new Float32Array(c.length/3),zO:new Float32Array(3),LR:u.cS(a.S)}}return d};a.f_=function(a){a.Qa.sort(y);
a.QC=!1}};b4w.module.__input=function(a,g){function l(a){var b=T.bf();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function d(a,b){if(!l(a))return null;var c={type:a,wh:!1,wg:[],rh:[],gj:[],fe:[],hj:[],ij:[],ks:[],zK:[],cj:[],Dj:[],Cj:[],Bj:[],element:b,ji:!0,Xb:[],Lw:new Float32Array(2),XX:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Jp:null,Ai:null,$f:null,orientation:fa.create(),position:P.create(),
Vi:new Float32Array(4),Wi:new Float32Array(4),bj:0,Sj:0,Rk:0,yn:0,pk:0,Tj:0,mm:[],kk:[0,0,0,0,0,0,0,0,0,0,0,0],JI:[0,0,0,0,0,0,0,0,0,0,0,0],Av:[]};c.Vi[0]=c.Vi[1]=c.Vi[2]=c.Vi[3]=45;c.Wi[0]=c.Wi[1]=c.Wi[2]=c.Wi[3]=45;30==a||40==a||50==a?(c.wh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.ji=!1)):10==a?c.wh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ha.is_mobile_device?r(c,v.webvr):(y(c),c.wh=!0));return c}function b(b,c){10==b||20==b?c=window:c||
(c=40==b?document:M.me());for(var e=0;e<oa.length;e++)if(oa[e].type==b&&oa[e].element==c)return oa[e];e=d(b,c);60!=b&&70!=b&&80!=b&&90!=b||e.Av.push(a.hz,a.Qt,a.mz,a.tz,a.uz,a.vz,a.Wt,a.Yp,a.wz,a.xz,a.iz,a.jz,a.Rt,a.St,a.Tt,a.Xp,a.Ut,a.Vt,a.kz,a.lz,a.nz,a.oz,a.pz,a.qz,a.rz,a.sz,a.Tp,a.Up,a.Vp,a.Wp,a.bz,a.cz,a.dz,a.ez,a.fz,a.gz,a.$y,a.az);e&&oa.push(e);return e}function y(a){var b=v.nonwebvr;a.yn=b.yn;a.pk=b.pk;a.Tj=b.Tj;r(a,b);a.bj=b.bj;a.Sj=b.Sj;a.Rk=b.Rk;h(a)}function r(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function A(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function h(a){var b=a.Sj-a.Tj,c=a.pk-b,e=a.bj/2,d=(a.yn-a.bj)/2,b=V.se(Math.atan(b/a.Rk)),c=V.se(Math.atan(c/a.Rk)),e=V.se(Math.atan(e/
a.Rk)),d=V.se(Math.atan(d/a.Rk));c&&(a.Vi[0]=a.Wi[0]=Math.min(c,60));e&&(a.Vi[1]=a.Wi[3]=Math.min(e,60));b&&(a.Vi[2]=a.Wi[2]=Math.min(b,60));d&&(a.Vi[3]=a.Wi[1]=Math.min(d,60))}function u(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),e=null;c.length&&(e=c[0]);c=null;e&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==e.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Jp=e;a.Ai=c}function m(a,b,c){switch(a.type){case 20:var e=
a.$f||a.Jp;e?(b=e.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,e=A(a,Math.tan(V.Cb(b.downDegrees))),V.se(Math.atan(e)),e=A(a,Math.tan(V.Cb(b.upDegrees))),V.se(Math.atan(e)),e=A(a,Math.tan(V.Cb(b.leftDegrees))),V.se(Math.atan(e)),a=A(a,Math.tan(V.Cb(b.rightDegrees))),V.se(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Vi:a.Wi,W.copy(b,c));break;default:H.error("fov is undefined for device: ",a.type)}return c}
function q(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ha.is_mobile_device?1:0:2;case 23:var c=a.$f||a.Jp;if(c){var e=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.$f?c.offset[0]-e.offset[0]:c.eyeTranslation.x-e.eyeTranslation.x}return a.bj}}function f(a,b){if(a.$f){var c=a.$f,e=c.capabilities,c=c.getPose();e.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],a.orientation[3]=
c.orientation[3]);e.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-ya&&(ya=b,navigator.getVRDisplays?a.$f||navigator.getVRDisplays().then(function(b){0<b.length&&(a.$f=b[0],a.wh=!0)},function(){H.R("WebVR displays are not found.");a.wh=!1}):navigator.getVRDevices?a.Jp||na||navigator.getVRDevices().then(function(b){u(a,b);b.length&&(a.wh=!0);na=!0},function(){H.R("WebVR devices are not found.");a.wh=!1;na=!0}):ha.is_mobile_device||
H.R("HMD isn't supported."))}function t(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.mm[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.kk[c]=a.axes[c]}}function c(a){for(var b=0;b<a.mm;b++)a.mm[b]=0;for(b=0;b<a.kk.length;b++)a.JI[b]=a.kk[b],a.kk[b]=0}function z(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function L(a){return null===a}function D(a,b,c,d){switch(b){case 120:c&&z(a.wg,c);if(d||a.rh.every(L)&&a.wg.every(L))a.wg.length=0,a.rh.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("deviceorientation",B,!1));break;case 130:c&&z(a.rh,c);if(d||a.rh.every(L)&&a.wg.every(L))a.wg.length=0,a.rh.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("deviceorientation",B,!1));break;case 40:c&&z(a.gj,c);if(d||a.gj.every(L))a.gj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousedown",C,!1));break;case 30:c&&z(a.fe,c);if(d||a.fe.every(L))a.fe.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("mousemove",K,!1));break;case 31:c&&z(a.fe,c);if(d||a.fe.every(L))a.fe.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousemove",E,!1));break;case 50:c&&z(a.hj,c);if(d||a.hj.every(L)){a.hj.length=0;b=a.Xb.indexOf(b);0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mouseout",Q,!1),a.element.removeEventListener("mouseup",k,!1));break}break;case 60:c&&z(a.ij,c);if(d||a.ij.every(L))a.ij.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("wheel",p,!1));break;case 80:c&&z(a.ks,c);if(d||a.ks.every(L))a.ks.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keydown",x,!1));break;case 70:c&&z(a.cj,c);if(d||a.cj.every(L))a.cj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keyup",e,!1));break;case 90:c&&z(a.Dj,c);if(d||a.Dj.every(L))a.Dj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchstart",w,!1));break;
case 100:c&&z(a.Cj,c);if(d||a.Cj.every(L))a.Cj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchmove",n,!1));break;case 110:if(c&&z(a.Bj,c),d||a.Bj.every(L))a.Bj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchend",ea,!1))}}function G(a,b){V.XC(a,V.Pz,b);var c="orientation"in window?V.Cb(window.orientation):"orientation"in window.screen?V.Cb(window.screen.orientation.angle):0,c=fa.setAxisAngle(V.Nc,c,Z);fa.multiply(b,c,b);
return b}function B(a){var c=ba;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=V.Cb(a.alpha),c[1]=V.Cb(a.beta),c[2]=V.Cb(a.gamma));a=b(10,a.currentTarget);for(var e=0;e<a.rh.length;e++){var d=a.rh[e];d&&(P.copy(c,ca),d(ca))}if(a.wg.length)for(c=G(c,aa),e=0;e<a.wg.length;e++)if(d=a.wg[e])fa.copy(c,ra),d(ra);for(e=0;e<a.wg.length;e++)a.wg[e]||a.wg.splice(e,1);for(e=0;e<a.rh.length;e++)a.rh[e]||a.rh.splice(e,1)}function O(a,b){switch(a.type){case 30:a.Lw[0]=b.clientX,a.Lw[1]=b.clientY,
a.XX=b.which}}function K(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var e=0;e<c.fe.length;e++){var d=c.fe[e];d&&(R[0]=a.clientX,R[1]=a.clientY,d(R))}c.ji&&a.preventDefault();for(e=0;e<c.fe.length;e++)c.fe[e]||c.fe.splice(e,1)}}function E(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var e=0;e<c.fe.length;e++){var d=c.fe[e];
if(d){if("number"==typeof a.movementX)var f=a.movementX,h=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,h=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,h=a.mozMovementY):h=f=0;R[0]=f;R[1]=h;d(R)}}c.ji&&a.preventDefault();for(e=0;e<c.fe.length;e++)c.fe[e]||c.fe.splice(e,1)}}function C(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var e=0;e<c.gj.length;e++){var d=
c.gj[e];d&&d(a.which)}c.ji&&a.preventDefault();for(e=0;e<c.gj.length;e++)c.gj[e]||c.gj.splice(e,1)}}function Q(a){!M.oK(a.relatedTarget)&&a.which&&k(a)}function k(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var e=0;e<c.hj.length;e++){var d=c.hj[e];d&&d(a.which)}c.ji&&a.preventDefault();for(e=0;e<c.hj.length;e++)c.hj[e]||c.hj.splice(e,1)}}function p(a){for(var c=b(30,a.currentTarget),e=0;e<c.ij.length;e++){var d=
c.ij[e];d&&d(-a.deltaY)}c.ji&&a.preventDefault();for(e=0;e<c.ij.length;e++)c.ij[e]||c.ij.splice(e,1)}function x(a){for(var c=b(40,a.currentTarget),e=a.ctrlKey||a.altKey||a.metaKey?c.zK:c.ks,d=0;d<e.length;d++){var f=e[d];f?f(a.keyCode):e.splice(d--,1)}c.ji&&a.preventDefault()}function e(a){for(var c=b(40,a.currentTarget),e=0;e<c.cj.length;e++){var d=c.cj[e];d&&d(a.keyCode)}c.ji&&a.preventDefault();for(e=0;e<c.cj.length;e++)c.cj[e]||c.cj.splice(e,1)}function w(a){for(var c=b(50,a.currentTarget),e=
0;e<c.Dj.length;e++){var d=c.Dj[e];d&&d(a.targetTouches)}for(e=0;e<c.Dj.length;e++)c.Dj[e]||c.Dj.splice(e,1)}function n(a){for(var c=b(50,a.currentTarget),e=0;e<c.Cj.length;e++){var d=c.Cj[e];d&&d(a.targetTouches)}c.ji&&a.preventDefault();for(e=0;e<c.Cj.length;e++)c.Cj[e]||c.Cj.splice(e,1)}function ea(a){for(var c=b(50,a.currentTarget),e=0;e<c.Bj.length;e++){var d=c.Bj[e];d&&d(a.targetTouches)}for(e=0;e<c.Bj.length;e++)c.Bj[e]||c.Bj.splice(e,1)}function I(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function F(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var e=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof e&&e.apply(c)}var T=g("__compat"),M=g("__container"),X=g("__config"),H=g("__print"),fa=g("__quat"),V=g("__util"),P=g("__vec3"),W=g("__vec4"),ha=X.B,v=X.tW;a.Gh=10;a.zd=20;a.bd=30;a.Op=40;a.Ig=50;a.Lt=60;a.Ry=70;a.Sy=80;a.Ty=90;a.Fz=0;a.kF=1;a.jF=2;a.Zp=3;a.vl=0;a.Zt=10;a.$t=20;a.GO=21;a.HO=22;a.Bz=23;a.Az=24;a.yz=25;a.Dz=26;a.Ez=27;a.Cz=28;
a.zz=29;a.Ei=30;a.wF=31;a.wl=40;a.cq=50;a.dq=60;a.aq=70;a.$p=80;a.nF=81;a.Al=90;a.jq=100;a.zl=110;a.Yt=120;a.Dn=130;a.hz=300;a.Qt=301;a.mz=302;a.tz=303;a.uz=304;a.vz=305;a.Wt=306;a.Yp=307;a.wz=308;a.xz=309;a.iz=310;a.jz=311;a.Rt=312;a.St=313;a.Tt=314;a.Xp=315;a.Ut=316;a.Vt=317;a.kz=318;a.lz=319;a.nz=320;a.oz=321;a.pz=322;a.qz=323;a.rz=324;a.sz=325;a.Tp=326;a.Up=327;a.Vp=328;a.Wp=329;a.bz=330;a.cz=331;a.dz=332;a.ez=333;a.fz=334;a.gz=335;a.$y=336;a.az=337;var aa=fa.create(),Z=fa.create(),ba=P.create(),
ya=-Infinity,na=!1,R=new Float32Array(2);P.create();var ca=P.create(),ra=fa.create(),xa="ontouchstart"in document.documentElement,oa=[];a.Mu=l;a.fa=b;a.oE=function(a,b){a.ji=b};a.ox=function(a){switch(a.type){case 20:if(a.wh)if(a.$f)a.$f.resetPose();else if(a.Ai)for(var b=0;b<a.Ai.length;b++)a.Ai[b].resetSensor();break;default:H.error("reset_device() is undefined for device: ",a.type)}};a.$i=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:P.copy(V.Gn,c);if(a.$f)c[0]=a.orientation[0],c[1]=
a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.Ai)for(b=0;b<a.Ai.length;b++){var e=a.Ai[b],e=e.getState&&e.getState()||e.getImmediateState&&e.getImmediateState();e.orientation&&(c[0]=e.orientation.x,c[1]=e.orientation.y,c[2]=e.orientation.z,c[3]=e.orientation.w)}fa.normalize(c,c);a=fa.setAxisAngle(V.Gg,Math.PI/2,Z);fa.multiply(a,c,c);break a;default:H.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:P.copy(V.Oz,c);if(a.$f)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.Ai)for(b=0;b<a.Ai.length;b++)e=a.Ai[b],e=e.getState&&e.getState()||e.getImmediateState&&e.getImmediateState(),e.position&&(c[0]=e.position.x,c[1]=-e.position.z,c[2]=e.position.y);break a;default:H.error("position is undefined for device: ",a.type)}return c;case 21:return m(a,"left",c);case 22:return m(a,"right",c);case 30:case 31:return c[0]=a.Lw[0],c[1]=a.Lw[1],c}};a.vm=q;a.JD=function(a,b,c){switch(a.type){case 20:if(3===q(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.bj=c;h(a);break;case 25:a.Sj=c;h(a);break;case 26:a.Rk=c;h(a);break;case 27:a.yn=c;h(a);break;case 28:a.pk=c;h(a);break;case 29:a.Tj=c,h(a)}break;case 60:case 70:case 80:case 90:a.Av[b]=c}};a.WV=function(a,b){var c=b-300;return c<a.mm.length?a.mm[a.Av[c]-300]:!1};a.VV=function(a,b){return b-326<a.kk.length?a.kk[a.Av[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],e=0;e<oa.length;e++){var d=oa[e];switch(d.type){case 60:c(d);t(b[0],d);break;case 70:c(d);t(b[1],d);break;case 80:c(d);t(b[2],d);break;case 90:c(d);t(b[3],d);break;case 20:f(d,a)}}};a.Ad=function(a,b,c){switch(b){case 120:a.wg.push(c);b=131;break;case 130:a.rh.push(c);b=131;break;case 40:a.gj.push(c);break;case 30:case 31:a.fe.push(c);break;case 50:a.hj.push(c);break;case 60:a.ij.push(c);break;case 80:a.ks.push(c);break;case 81:a.zK.push(c);b=80;break;case 70:a.cj.push(c);
break;case 90:a.Dj.push(c);break;case 100:a.Cj.push(c);break;case 110:a.Bj.push(c)}if(-1==a.Xb.indexOf(b)&&(a.Xb.push(b),a.wh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",C,!1);break;case 30:a.element.addEventListener("mousemove",K,!1);break;case 31:a.element.addEventListener("mousemove",E,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",Q,!1),a.element.addEventListener("mouseup",
k,!1));break;case 60:a.element.addEventListener("wheel",p,!1);break;case 80:a.element.addEventListener("keydown",x,!1);break;case 70:a.element.addEventListener("keyup",e,!1);break;case 90:a.element.addEventListener("touchstart",w,!1);break;case 100:a.element.addEventListener("touchmove",n,!1);break;case 110:a.element.addEventListener("touchend",ea,!1);break;case 131:a.element.addEventListener("deviceorientation",B,!1)}};a.Dd=function(a,b,c){D(a,b,c,!1)};a.mW=G;a.ua=function(){for(var a=0;a<oa.length;a++)for(var b=
oa[a],c=0;c<b.Xb.length;c++)D(b,b.Xb[c],null,!0);oa.length=0};a.yJ=function(a){a=b(I(a));for(var c=0;c<a.mm.length;c++)if(a.mm[c])return c+300;return-1};a.rJ=function(a){a=b(I(a));for(var c=0;c<a.kk.length;c++)if(a.JI[c]-a.kk[c])return c+326;return-1};a.kJ=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.UJ=function(){var a=b(20);return a&&a.$f};a.SQ=function(a){a.element.addEventListener("mousedown",
function(){a.value||F(a)},!1)}};b4w.module.__prerender=function(a,g){function l(a,d){var f=a.mf;f.Im=!1;if(f.ai)return!1;var g=d.p,l=d.type==h.dd?g.zw:u.ic(g.n,t);if("STATIC"==f.type&&f.wo)var B=f.ss,y=f.ts;else B=f.kb.G,y=f.kb.Xa;var A=f.mh,E=f.lf,l=q.dist(B,l);if(!(l<A?0:E==r.bq||l<E+f.nh*y))return!1;f.Im=!0;E=a.za;if(d.type==h.Bf)return d.debug_view_mode==b.Nt?E.Ti:!E.Ti;if(d.type==h.Kg&&0==f.sh)return!1;f.Bp?(y=E.kb,A=E.pb,f=E.Zf):(y=f.kb,A=f.pb,f=f.Zf);if(E=!E.dk)g=g.Xh,E=y.G,m.m_(E,g,y.Xa)?E=!0:f?(E=A.G,E=m.DU(E,g,A.Ga,A.Ha,
A.Ia)):E=!1;return E?!1:!0}function d(a){var b=a.gb;if(b&&b.YK){a=a.Ca;y.HX(a);var d=a.ld,f=d.a_position.offset;y.hO(a.tc,"a_position",b.kD,f);f=d.a_tbn_quat.offset;y.hO(a.tc,"a_tbn_quat",b.sE,f);y.RN(a)}}g("__config");var b=g("__debug"),y=g("__geometry"),r=g("__obj_util"),A=g("__renderer"),h=g("__subscene"),u=g("__tsr"),m=g("__util"),q=g("__vec3"),f=[h.Pb,h.Pc,h.Rd,h.nd,h.Cf,h.Ue,h.ke,h.ag,h.dd,h.Df,h.Kg,h.Bf,h.zf,h.Ci],t=new Float32Array(3);a.fx=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,
g=a.type==h.nd||a.type==h.Ue,m=a.Qa,q=0;q<m.length;q++){for(var r=m[q],u=r.sa,t=!1,E=0;E<u.length;E++){var C=u[E],Q=C.za;if(g)for(var k=0;6>k;k++)a.p.Xh=a.lr[k],C.pB[k]=l(C,a),C.pB[k]&&(t=b=!0,d(Q));else C.dc=l(C,a),C.dc&&(t=b=!0,d(Q));a.Ba&&(Q.zb.xs=!0)}r.dc=t}a.Ba=!1;switch(a.type){case h.Bf:break;default:a.type==h.Pb||a.type==h.Df||a.type==h.ke||a.type==h.Rd||a.type==h.nd||b?a.dc=!0:(a.dc&&A.clear(a),a.dc=!1)}}else if(a.Ba){m=a.Qa;for(q=0;q<m.length;q++)for(u=m[q].sa,E=0;E<u.length;E++)C=u[E],
Q=C.za,Q.zb.xs=!0;a.Ba=!1}a.QC&&h.f_(a)}};b4w.module.__geometry=function(a,g){function l(){return{length:0,frames:1,Jc:0,mn:0,offset:0,vr:0}}function d(a,b){for(var c=b.a_tbn_quat,e=b.a_position,d=c.length,f=e.length,h=1;h<a.ib.length;h++)for(var k=a.ib[h].Lf,p=a.ib[h].Zr,k=k.a_position,g=0;g<f;g++)e[g]+=p*k[g];e=ba;for(h=0;h<d;h+=4){f=c.subarray(h,h+4);e.set(W.Gn);for(g=1;g<a.ib.length;g++)k=a.ib[g].Lf,p=a.ib[g].Zr,p=V.slerp(W.Gn,k.a_tbn_quat,p,ya),V.normalize(p,p),V.multiply(p,e,e);V.multiply(e,f,f)}}function b(a){return 65536<a.Ja?H.hJ()?
!1:!0:!1}function y(a){return 0<a.na.length?!0:!1}function r(a,b,c){if(!y(a))return a;c||fa.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ja*(b||1)+", will use drawArrays","color: #aa0");b=a.na;c=a.Ja;var e=a.qa,d=a.aa,f;for(f in e){var h=e[f],k=O(h,c);e[f]=A(b,h,k)}for(e=0;e<d.length;e++){var p=d[e];for(f in p)h=p[f],k=O(h,c),p[f]=A(b,h,k)}for(e=0;e<a.ib.length;e++){f=a.ib[e].Lf;for(var g in f)h=f[g],k=O(h,c),f[g]=A(b,h,k)}a.Ja=b.length;a.na=new Uint16Array(0);return a}
function A(a,b,c){if(0==b.length)return new Float32Array(0);for(var e=new Float32Array(a.length*c),d=0;d<a.length;d++)for(var f=a[d],h=0;h<c;h++)e[c*d+h]=b[c*f+h];return e}function h(){return{pe:null,tc:e(),wm:0,count:0,ld:{},pn:0,Xn:0,Zn:0,Pd:[],ng:null,ib:null,Am:1,eg:!0}}function u(a,b){var c=a.ld[b];if(c){var e=T(b);return I(a.tc,e).subarray(c.offset,c.offset+c.length)}W.q("extract_array() failed; invalid name: "+b)}function m(b,c){var e;switch(c){case a.Cn:case a.Pp:e=R.STATIC_DRAW;break;case a.Mt:e=
R.DYNAMIC_DRAW;break;default:W.q("Wrong draw_mode")}b.pn=e}function q(a,b,c){function e(a,b){d[a]||(d[a]=0);d[a]+=b}var d={},f;for(f in a[0]){var h=a[0][f],k=T(f);e(k,h.length*a.length)}for(f in b)h=b[f],k=T(f),e(k,h.length);if(c){a=c.xp.length;k=T("a_part_ts");e(k,4*a);k=T("a_part_r");e(k,4*a);b=c.Wm;for(f in b)k=T(f),e(k,b[f].Jc*a);c=c.mt;for(f in c)k=T(f),e(k,a)}return d}function f(a){a.pe?(a.ng||(a.ng=R.createBuffer()),R.bindBuffer(R.ELEMENT_ARRAY_BUFFER,a.ng),R.bufferData(R.ELEMENT_ARRAY_BUFFER,
a.pe,a.pn),a.Xn=a.pe.byteLength):a.Xn=0;for(var b=a.Zn=0;b<a.tc.length;b++){var c=a.tc[b].type,e=n(a.Pd,c);-1==e&&(a.Pd.push({nl:null,type:c,mU:W.V_()}),e=a.Pd.length-1);c=a.Pd[e];c.nl||(c.nl=R.createBuffer());R.bindBuffer(R.ARRAY_BUFFER,c.nl);R.bufferData(R.ARRAY_BUFFER,a.tc[b].xi,a.pn);a.Zn+=a.tc[b].xi.byteLength}}function t(a,b){a.S=X.Ol(a.S,b);a.ba=X.Fq(a.ba,b);a.wa=X.Gq(a.wa,b);a.Bd=X.kA(a.Bd,b)}function c(a){for(var b=a[0],c=a[0],e=x("JOIN_"+a.length+"_SUBMESHES"),d=0,f=0;f<a.length;f++)d+=
a[f].na.length;e.na=new Uint32Array(d);var h=d=0;if(0<a[0].ib.length)for(var k=0;k<a[0].ib.length;k++){for(f=0;f<a.length;f++)d+=a[f].ib[k].Lf.a_position.length,h+=a[f].ib[k].Lf.a_tbn_quat.length;f={a_position:new Float32Array(d),a_tbn_quat:new Float32Array(h)};e.ib.push({Zr:a[0].ib[k].Zr,Lf:f})}for(f=d=0;f<a.length;f++)d+=a[f].Ja;e.Ja=d;for(var p in c.qa){for(f=d=0;f<a.length;f++)d+=a[f].qa[p].length;e.qa[p]=new Float32Array(d)}for(p in c.aa[0]){for(f=d=0;f<a.length;f++)d+=a[f].aa[0][p].length;for(f=
0;f<c.aa.length;f++)e.aa[f]=e.aa[f]||{},e.aa[f][p]=new Float32Array(d)}f=e.Wf;f.S=X.Rl(b.Wf.S);h=d=0;k=[];for(c=0;c<a.length;c++){var g=a[c],n=g.na,m=g.Ja,q=g.qa;p=g.Wf.wa;X.tB(f.S,g.Wf.S);X.MU(f.wa,p);X.xB(g.Wf.Bd,k);for(p=0;p<n.length;p++)e.na[d+p]=n[p]+h;var d=d+n.length,v;for(v in q){var n=q[v],l=h*O(n,m);e.qa[v].set(n,l)}for(p=0;p<g.aa.length;p++){var q=g.aa[p],w=e.aa[p];for(v in q)n=q[v],l=h*O(n,m),w[v].set(n,l)}h+=m}f.ba=X.Wu(W.Jf(k),!0);if(0<e.ib.length)for(c=0;c<e.ib.length;c++)for(v=e.ib[c].Lf,
p=d=f=0;p<a.length;p++)h=a[p].ib[c].Lf,v.a_position.set(h.a_position,f),v.a_tbn_quat.set(h.a_tbn_quat,d),f+=h.a_position.length,d+=h.a_tbn_quat.length;a[0].Qf&&(e.Qf={xp:b.Qf.xp,Vx:b.Qf.Vx,eN:!0,mt:b.Qf.mt,Wm:b.Qf.Wm,nv:b.Qf.nv});return e}function z(a,b,c){b=b.Wf;for(var e=X.Ud(),d=X.Zu(),f=[],h=0;h<c.length;h++)X.Ol(a.Wf.S,c[h],e),X.tB(b.S,e),X.kA(a.Wf.Bd,c[h],d),X.xB(d,f);b.ba=X.Wu(W.Jf(f),!0);b.Bd=X.dT(b.ba);b.wa=X.fr(b.ba)}function L(a,b,c,e,d,f){var h=a.submeshes[b],k=h.base_length,p=x("SUBMESH_"+
a.name+"_"+a.materials[b].name);p.Ja=k;var g=!1;if(G(c,"a_texcoord")){var n=null,m=a.materials[b];b=a.submeshes[b];if(m.texture_slots.length)switch(m=m.texture_slots[0],m.texture_coords){case "UV":m=a.uv_textures.indexOf(m.uv_layer);0==m?n=new Float32Array(b.texcoord):1==m&&(n=new Float32Array(b.texcoord2));break;case "ORCO":for(var q=a.b4w_boundings.bb_src,n=new Float32Array(2*b.base_length),m=(q.max_x+q.min_x)/2,v=(q.max_y+q.min_y)/2,l=q.max_x-q.min_x,q=q.max_y-q.min_y,w=0,H=0;H<b.position.length;H+=
3)n[w++]=(b.position[H]-m)/l+.5,n[w++]=(b.position[H+1]-v)/q+.5}null===n&&(n=new Float32Array(2*b.base_length));b=n}else b=new Float32Array(0);if(G(c,"a_orco_tex_coord")){n=a.b4w_boundings.bb_src;m=new Float32Array(3*h.base_length);v=n.max_x-n.min_x;l=n.max_y-n.min_y;q=n.max_z-n.min_z;for(H=w=0;H<h.position.length;H+=3)0==v?m[w++]=.5:m[w++]=W.V(parseFloat(((h.position[H]-n.min_x)/v).toFixed(5)),0,1),0==l?m[w++]=.5:m[w++]=W.V(parseFloat(((h.position[H+1]-n.min_y)/l).toFixed(5)),0,1),0==q?m[w++]=.5:
m[w++]=W.V(parseFloat(((h.position[H+2]-n.min_z)/q).toFixed(5)),0,1);n=m}else n=new Float32Array(0);m=h.group;if(G(c,"a_influence")&&e){v=new Float32Array(4*k);l=m.length/k;q=new Float32Array(l);for(w=0;w<l;w++){q[w]=-1;for(var P in e)if(H=e[P],H.nO===w){q[w]=H.hB;break}}var u=3<l?l:4;e=new Float32Array(u);P=new Uint32Array(u);for(var w=new Float32Array(4),H=new Float32Array(u),u=new Uint32Array(u),t=new Float32Array(4),V=0;V<k;V++)e.set(H),P.set(u),w.set(t),v.set(B(m,l,V,k,q,e,P,w),4*V)}else v=new Float32Array(0);
e=v;d=d?W.T(d):{};d.a_color={pm:!0};d.a_color.src=G(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,pg:7}]:[];p.qa.a_texcoord=b;p.qa.a_influence=e;p.qa.a_orco_tex_coord=n;e=p.qa;P=h.vertex_colors;b=h.color;n=a.name;m=[];for(v=0;v<P.length;v++)m.push(P[v].name);for(var z in d)if(v=d[z].src,v.length){for(q=l=0;q<v.length;q++)l+=W.$m(v[q].pg);e[z]=new Float32Array(l*k);for(q=w=0;q<v.length;q++){var aa=v[q].name,H=v[q].pg,u=W.SL(H),C=m.indexOf(aa);-1==C&&W.q('vertex color "'+aa+'" for mesh "'+
n+'" not found.');t=P[C].mask;V=W.$m(t);(H&t)!==H&&fa.error("Wrong color extraction from "+aa+" to "+z+".");for(var E=aa=0;E<C;E++)aa+=W.$m(P[E].mask);C=aa*k;for(aa=0;aa<k;aa++)for(E=0;3>E;E++)u[E]&&(e[z][aa*l+(w+W.Vo(H,E))]=b[C+aa*V+W.Vo(t,E)]);w+=V}}else e[z]=new Float32Array(0);z=a.uv_textures;d=h.texcoord;e=h.texcoord2;P=p.qa;if(f)for(var F in f){b=z.indexOf(F);if(0==b)var R=new Float32Array(d);else 1==b&&(R=new Float32Array(e));P[f[F]]=R}p.na=new Uint32Array(h.indices);F=h.position.length/k/
3;R=G(c,"a_tbn_quat")&&h.tbn_quat.length?!0:!1;z=G(c,"a_shade_tangs")&&h.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(g=!0);for(d=0;d<F;d++){f=D(h,k,R,z,d);if(g)if(e={},e.name=a.b4w_shape_keys[d].name,p.ib.push(e),0!=d){e.Lf=f;e.Zr=a.b4w_shape_keys[d].value;continue}else e.Lf=D(h,k,R,z,d),e.Zr=1;p.aa.push(f)}if(1<F&&!g){a=p.aa[0];f={};for(var ba in a)f[ba]=new Float32Array(a[ba]);p.aa.push(f)}G(c,"a_polyindex")&&(r(p,1,!0),p.qa.a_polyindex=Q(p));h=h.boundings;c=p.Wf;c.S=X.Ud();c.S.max_x=h.bb.max_x;
c.S.max_y=h.bb.max_y;c.S.max_z=h.bb.max_z;c.S.min_x=h.bb.min_x;c.S.min_y=h.bb.min_y;c.S.min_z=h.bb.min_z;ba=h.rbb;a=h.caxis_x;k=h.caxis_y;g=h.caxis_z;f=h.be_ax;c.ba=X.Bq(a,k,g,h.be_cen);ha.scale(c.ba.Ga,f[0],c.ba.Ga);ha.scale(c.ba.Ha,f[1],c.ba.Ha);ha.scale(c.ba.Ia,f[2],c.ba.Ia);c.wa=X.fr(c.ba);ha.copy(ba.rbb_c,c.Bd.G);ha.copy(a,c.Bd.Ga);ha.copy(k,c.Bd.Ha);ha.copy(g,c.Bd.Ia);h=ba.rbb_s;ha.scale(c.Bd.Ga,h[0],c.Bd.Ga);ha.scale(c.Bd.Ha,h[1],c.Bd.Ha);ha.scale(c.Bd.Ia,h[2],c.Bd.Ia);return p}function D(a,
b,c,e,d){var f={},h=new Float32Array(3*b),k=new Float32Array(c?4*b:0),p=d*b*3;h.set(a.position.subarray(p,p+3*b),0);c&&(p=d*b*4,k.set(a.tbn_quat.subarray(p,p+4*b),0));e&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),f.a_shade_tangs=c);f.a_position=h;f.a_tbn_quat=k;return f}function G(a,b){return-1<a.indexOf(b)?!0:!1}function B(b,c,e,d,f,h,k,p){for(var g=!0,n=0;n<c;n++){var m=b[n*d+e];if(-1!==m){var q=f[n];-1!==q&&(h[n]=m,k[n]=q,g=!1)}}if(g)return p;K(h,k,a.Lz,!1);for(n=b=0;4>n;n++)b+=
h[n];if(.01>b)return p;for(n=0;4>n;n++)h[n]/=b;if(.01>Math.abs(h[0]-1))p[0]=k[0]+1;else for(n=0;4>n;n++)p[n]=k[n]+h[n];return p}function O(a,b){if(0==b)return 0;var c=a.length,e=c/b;e!=Math.floor(e)&&W.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return e}function K(b,c,e,d){for(var f=b.length,h=f,k=!1,p=d?-1:1;1<h||k;){1<h&&(h=Math.floor(h/1.247330950103979));for(var k=!1,g=0;h+g<f;g++)if(e==a.Lz?0>p*(b[g]-b[g+h]):b[g]<b[g+h]&&d)k=b[g],b[g]=b[g+h],b[g+
h]=k,k=c[g],c[g]=c[g+h],c[g+h]=k,k=!0}}function E(a,b,c){var e=[],d=[];ha.subtract(b,a,e);ha.subtract(c,a,d);ha.normalize(e,e);ha.normalize(d,d);a=W.V(ha.dot(e,d),-1,1);return Math.acos(a)}function C(a,b,c){if(y(b)){b=b.na;for(var e=b.length/3,d=0;d<e;d++){var f=new Float32Array(9),h=b[3*d];f[0]=a[3*h];f[1]=a[3*h+1];f[2]=a[3*h+2];h=b[3*d+1];f[3]=a[3*h];f[4]=a[3*h+1];f[5]=a[3*h+2];h=b[3*d+2];f[6]=a[3*h];f[7]=a[3*h+1];f[8]=a[3*h+2];c[d]=f}}else for(d=0;d<a.length;d++)f=new Float32Array(9),f[0]=a[9*
d],f[1]=a[9*d+1],f[2]=a[9*d+2],f[3]=a[9*d+3],f[4]=a[9*d+4],f[5]=a[9*d+5],f[6]=a[9*d+6],f[7]=a[9*d+7],f[8]=a[9*d+8],c[d]=f;return c}function Q(a){for(var b=new Float32Array(a.Ja),c=0;c<a.Ja;c++)b[c]=c%3/2;return b}function k(a,b,c){var e=ha.dist(a,b);a=ha.dist(a,c);b=ha.dist(b,c);c=(e+a+b)/2;return c*(c-e)*(c-a)*(c-b)}function p(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),e=0;e<a;e++)c.set(b,8*e);return c}function x(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ja:0,na:null,aa:[],qa:b,ib:[],Wf:{S:X.Ud(),ba:X.Tg(),wa:X.Sh(),Bd:X.Zu()},Qf:null}}function e(a){var b=[],c;for(c in a)b.push(w(c,a[c]));return b}function w(a,b){return{xi:new (F(a))(b),type:a}}function n(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function ea(a,b){var c=n(a,b);return-1==c?null:a[c].nl}function I(a,b){var c=n(a,b);return-1==c?null:a[c].xi}function F(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function T(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function M(a,
b,c,e){var d=T(b);b=n(a,d);switch(d){case "float":a[b].xi.set(c,e);break;case "short":for(d=0;d<c.length;d++)a[b].xi[e+d]=W.Br(c[d]);break;case "unsigned_byte":for(d=0;d<c.length;d++)a[b].xi[e+d]=W.T_(c[d])}}var X=g("__boundings"),H=g("__extensions"),fa=g("__print"),V=g("__quat"),P=g("__tsr"),W=g("__util"),ha=g("__vec3");new Float32Array(2);var v=new Float32Array(3),aa=new Float32Array(3),Z=new Float32Array(3),ba=new Float32Array(4),ya=new Float32Array(4),na=new Float32Array(8);a.Pp=10;a.Mt=20;a.Lz=
0;a.U2=1;a.Cn=a.Pp;var R=null;a.FQ="float";a.Y2="short";a.Z2="unsigned_byte";a.Uf=function(a){R=a};a.mN=function(a,c,k){b(a)&&r(a);var p=a.na,g=a.Ja,n=a.aa,v={},w;for(w in a.qa)w in k&&!k[w].pm||(v[w]=a.qa[w]);k=h();0<a.ib.length&&d(a,n[0]);w=a.Qf;if(p.length){var H=p.length;if(65536>=g)var p=new Uint16Array(p),x=R.UNSIGNED_SHORT;else p=new Uint32Array(p),x=R.UNSIGNED_INT}else H=g,p=null;for(var u=q(n,v,w),u=e(u),t={},V=0;V<u.length;V++)t[u[V].type]=0;var z={},aa;for(aa in v){var C=v[aa],E=C.length;
if(E){var F=T(aa),V=z[aa]=l();V.length=E;V.Jc=O(C,g);V.offset=t[F];M(u,aa,C,t[F]);t[F]+=E}}v=n.length;for(aa in n[0])if(C=n[0][aa],F=T(aa),E=C.length,C=O(C,g),E)for(V=z[aa]=l(),V.length=E,V.frames=v,V.Jc=C,V.offset=t[F],1<v&&(V=z[aa+"_next"]=l(),V.length=E,V.frames=v,V.Jc=C,V.offset=t[F]+E),V=0;V<v;V++)C=n[V][aa],F=T(aa),M(u,aa,C,t[F]),t[F]+=E;if(w){n=w.xp;aa=w.Vx;v=w.Wm;E=w.mt;n=w.xp;aa=w.Vx;var v=w.Wm,E=w.mt,F=w.eN,g={a_part_ts:{data:[],Jc:4},a_part_r:{data:[],Jc:4}},fa;for(fa in v)g[fa]={data:[],
Jc:v[fa].Jc};for(fa in E)g[fa]={data:[],Jc:1};for(C=0;C<n.length;C++){V=n[C];F&&aa&&!w.nv&&(V=P.multiply(aa,n[C],na));!F&&w.nv&&ha.subtract(n[C],aa,n[C]);g.a_part_ts.data.push(V[0],V[1],V[2],V[3]);g.a_part_r.data.push(V[4],V[5],V[6],V[7]);for(fa in v)for(var V=v[fa].Jc,W=0;W<V;W++)g[fa].data.push(v[fa].data[C*V+W]);for(fa in E)g[fa].data.push(E[fa][0])}for(fa in g)n=T(fa),M(u,fa,g[fa].data,t[n]),aa=l(),aa.Jc=g[fa].Jc,aa.offset=t[n],aa.vr=1,aa.length=g[fa].data.length,z[fa]=aa,t[n]+=aa.length;k.Am=
w.xp.length}k.count=H;k.pe=p;k.tc=u;k.wm=x;k.ld=z;m(k,c);f(k);k.ib=a.ib;return k};a.z_=d;a.UW=b;a.TW=y;a.Yx=r;a.h0=function(a,b,c){m(a,b);a.count=c.length;a.pe=c;a.wm=c instanceof Uint16Array?R.UNSIGNED_SHORT:R.UNSIGNED_INT};a.g0=function(a,b){var c=a.ld,e=c.a_p_data,d=T("a_p_data");if(e)3!=e.Jc&&W.q('invalid num_comp for "a_p_data"'),M(a.tc,"a_p_data",b,e.offset);else{e=n(a.tc,d);-1==e&&(a.tc.push(w(d,0)),e=a.tc.length-1);var d=a.tc[e].xi,h=new d.constructor(d.length+b.length);h.set(d);a.tc[e].xi=
h;M(a.tc,"a_p_data",b,d.length);c=c.a_p_data=l();c.Jc=3;c.offset=d.length;c.length=b.length}f(a)};a.k5=u;a.o8=function(a){a.pn=R.STATIC_DRAW};a.HX=function(a){a.pn=R.DYNAMIC_DRAW};a.RN=f;a.PS=function(a){a.ng&&R.deleteBuffer(a.ng);for(var b=0;b<a.Pd.length;b++)a.Pd[b].nl&&R.deleteBuffer(a.Pd[b].nl);a.Pd.length=0};a.aK=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Xx=function(a,b){for(var c=0;c<a.aa.length;c++){var e=a.aa[c].a_position;P.fl(e,b,e,0);e=a.aa[c].a_tbn_quat;0<e.length&&P.IN(e,
b,e,0);(e=a.aa[c].a_shade_tangs)&&0<e.length&&P.GE(e,b,e,0)}(c=a.qa.au_center_pos)&&c.length&&P.fl(c,b,c,0);t(a.Wf,b)};a.y_=function(a,b){var c=a.qa.au_center_pos;if(c&&c.length){var e=new Float32Array(c);P.fl(e,b,e,0);for(var d=0;d<a.aa.length;d++)for(var f=0;f<e.length;f++)a.aa[d].a_position[f]+=e[f]-c[f];c.set(e)}else W.q('Attribute "au_center_pos" is missing in particle submesh');t(a.Wf,b)};a.TR=t;a.x_=function(a,b){var c=a.Ja,e;for(e in b){var d=b[e].length;a.qa[e]=new Float32Array(d*c);for(var f=
0;f<c;f++)for(var h=0;h<d;h++)a.qa[e][f*d+h]=b[e][h]}};a.lN=c;a.GX=function(a,b,c){if(!a.Ja)return x("EMPTY");var e=c.length;65536<a.Ja*e&&!H.hJ()&&r(a,e);var d=a.na,f=a.Ja,h=a.qa,k=a.aa,p;for(p in b){var g=b[p].length,n=g*f;h[p]=new Float32Array(n);for(var m=0;m<f;m++)for(n=0;n<g;n++)h[p][m*g+n]=b[p][n]}b=x("CLONE_"+e+"_SUBMESHES");b.Ja=f*e;b.na=new Uint32Array(d.length*e);for(m=0;m<e;m++)for(g=d.length*m,p=f*m,n=0;n<d.length;n++)b.na[g+n]=d[n]+p;for(var q in h)for(d=h[q],n=d.length*e,g=O(d,f),b.qa[q]=
new Float32Array(n),m=0;m<e;m++)p=f*g*m,b.qa[q].set(d,p);for(q in k[0])for(m=0;m<k.length;m++)for(d=k[m][q],n=d.length*e,g=O(d,f),b.aa[m]=b.aa[m]||{},b.aa[m][q]=new Float32Array(n),n=0;n<e;n++)switch(h=c[n],p=f*g*n,q){case "a_position":P.fl(d,h,b.aa[m][q],p);break;case "a_tbn_quat":P.IN(d,h,b.aa[m][q],p);break;case "a_shade_tangs":P.HE(d,h,b.aa[m][q],p);break;default:W.q("Wrong attribute name: "+q)}z(a,b,c);return b};a.cH=z;a.yB=L;a.RU=function(a){var b=a.Ja,c=a.aa[0].a_position,e=new Float32Array(12*
b);a=new Uint32Array(4*a.na.length);for(var d=new Float32Array(4*b),f=0;f<b;f++){e[12*f]=c[3*f];e[12*f+1]=c[3*f+1];e[12*f+2]=c[3*f+2];e[12*f+3]=c[3*f];e[12*f+4]=c[3*f+1];e[12*f+5]=c[3*f+2];e[12*f+6]=c[3*f];e[12*f+7]=c[3*f+1];e[12*f+8]=c[3*f+2];e[12*f+9]=c[3*f];e[12*f+10]=c[3*f+1];e[12*f+11]=c[3*f+2];a[6*f]=4*f+2;a[6*f+1]=4*f+1;a[6*f+2]=4*f;a[6*f+3]=4*f+2;a[6*f+4]=4*f;a[6*f+5]=4*f+3;var h=Math.random();d[4*f]=h;d[4*f+1]=h;d[4*f+2]=h;d[4*f+3]=h}c=x("HALO");c.aa[0]={};c.Ja=4*b;c.aa[0].a_position=e;c.qa.a_halo_bb_vertex=
p(b);c.qa.a_random_vals=d;c.na=a;return c};a.nW=G;a.yI=function(a,b,e){for(var d=[],f=0;f<a.submeshes.length;f++){var h=L(a,f,b,null,e,null);h.Ja&&d.push(h)}return 0==d.length?x("EMPTY"):1==d.length?d[0]:c(d)};a.f0=function(a,b,c,e){var d=a.pe,f=u(a,"a_position"),h=b.RX,k=b.SX;b=b.vU;for(var p=d,g=p.length/3,n=0;n<g;n++){var m=p[3*n],q=p[3*n+1],v=p[3*n+2],l=f[3*m+1],w=f[3*m+2],H=f[3*q+1],x=f[3*q+2],r=f[3*v+1],t=f[3*v+2];h[3*n]=(f[3*m]+f[3*q]+f[3*v])/3;h[3*n+1]=(l+H+r)/3;h[3*n+2]=(w+x+t)/3}P.fl(h,
c,k);c=k.length/3;for(f=0;f<c;f++)h=k[3*f]-e[0],p=k[3*f+1]-e[1],g=k[3*f+2]-e[2],b[f]=h*h+p*p+g*g;e=d;d=b.length;if(!(2>d))for(k=d,f=!1;1<k||f;)for(1<k&&(k=Math.floor(k/1.247330950103979)),f=!1,c=0;k+c<d;c++)0>b[c]-b[c+k]&&(f=b[c],b[c]=b[c+k],b[c+k]=f,f=e,h=c,p=c+k,g=f[3*h],n=f[3*h+1],m=f[3*h+2],f[3*h]=f[3*p],f[3*h+1]=f[3*p+1],f[3*h+2]=f[3*p+2],f[3*p]=g,f[3*p+1]=n,f[3*p+2]=m,f=!0);d=e;R.bindBuffer(R.ELEMENT_ARRAY_BUFFER,a.ng);R.bufferData(R.ELEMENT_ARRAY_BUFFER,d,R.DYNAMIC_DRAW)};a.h_=K;a.dS=function(a,
b,c){for(var e=b.length/3,d=a.length/3,f=[],h=Array(3),k=Array(3),p=Array(3),g=0;g<d;g++){for(var n=a[3*g],m=a[3*g+1],q=a[3*g+2],v=0;3>v;v++)h[v]=b[3*n+v],k[v]=b[3*m+v],p[v]=b[3*q+v];if(c)var v=E(h,k,p),l=E(k,p,h),w=Math.PI-v-l;else w=l=v=1;var H=f,P;P=h;var x=p,r=[],u=[],t=[];ha.subtract(k,P,r);ha.subtract(x,P,u);ha.cross(r,u,t);ha.normalize(t,t);P=t;for(x=0;3>x;x++)r=3*m+x,u=3*q+x,H[3*n+x]=v*P[x],H[r]=l*P[x],H[u]=w*P[x]}if(c)for(var V in c)for(g=c[V],a=0;3>a;a++){b=3*g[0]+a;for(d=1;d<g.length;d++)h=
3*g[d]+a,f[b]+=f[h];for(d=1;d<g.length;d++)h=3*g[d]+a,f[h]=f[b]}for(g=0;g<e;g++){c=g;V=f;a=new Float32Array(3);for(b=0;3>b;b++)d=3*c+b,a[b]=V[d];ha.normalize(a,a);for(b=0;3>b;b++)d=3*c+b,V[d]=a[b]}return f};a.hS=function(a,b,c){for(var e={},d=b.length/3,f=0;f<d;f++){var h=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);e[h]=[]}d=a.length;for(f=0;f<d;f++)b=a[f],h=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),h in e&&e[h].push(b);return e};a.EB=function(a,b,c,e){var d;d=null;d=[];d=C(a.aa[0].a_position,
a,d);if(c){var f;f=null;f=[];for(var h=a.aa[0].a_tbn_quat,p=h.length/4,g=new Float32Array(3*p),n=0;n<p;n++){var m=ba;m[0]=h[4*n];m[1]=h[4*n+1];m[2]=h[4*n+2];m[3]=h[4*n+3];m=ha.transformQuat(W.Bi,m,v);g[3*n]=m[0];g[3*n+1]=m[1];g[3*n+2]=m[2]}f=C(g,a,f)}p=d.length;g=new Float32Array(p);for(a=0;a<p;a++)n=d[a],v.set(n.subarray(0,3)),aa.set(n.subarray(3,6)),Z.set(n.subarray(6)),g[a]=Math.sqrt(k(v,aa,Z));h=new Float32Array(p);h[0]=g[0];for(a=1;a<p;a++)h[a]=h[a-1]+g[a];p=h[g.length-1];g=[];for(a=0;a<b;a++){var n=
p*W.yg(e),n=W.Fu(h,n,0,h.length-1),q=n=c?f[n]:d[n],l=e;(n=v)||(n=new Float32Array(3));var m=q[0],w=q[1],H=q[2],P=q[3],x=q[4],r=q[5],u=q[6],t=q[7],z=q[8],q=W.yg(l),l=W.yg(l);1<q+l&&(q=1-q,l=1-l);var E=1-q-l,w=E*w+q*x+l*t,H=E*H+q*r+l*z;n[0]=E*m+q*P+l*u;n[1]=w;n[2]=H;c?(g[a]=new Float32Array(4),ha.normalize(n,n),n=V.rotationTo(W.Bi,n,ba),g[a][0]=n[0],g[a][1]=n[1],g[a][2]=n[2],g[a][3]=n[3]):(g[a]=new Float32Array(3),g[a][0]=n[0],g[a][1]=n[1],g[a][2]=n[2])}return g};a.sv=Q;a.N$=k;a.KI=p;a.XL=function(a,
b,c){a=a.aa[0].a_position;for(var e=0;e<a.length;e+=3)a[e]=(a[e]-c[0])*b[0]+c[0],a[e+1]=(a[e+1]-c[1])*b[1]+c[1],a[e+2]=(a[e+2]-c[2])*b[2]+c[2]};a.vR=function(a,b,c){var e=a.I[0].X;a=a.k.qi;for(var d=1;d<a.length;d++)a[d].name==b&&(a[d].value=c);for(d=0;d<e.length;d++)if(!e[d].kg&&e[d].Qe&&!e[d].Ti){b=e[d].Ca;var f=T("a_position");c=ea(b.Pd,f);f=I(b.tc,f);R.bindBuffer(R.ARRAY_BUFFER,c);var h=b.ld.a_position;c=e[d];var k=a;if(h){for(var p=h.offset,h=h.length+p,g=c.Ca.ib[0].Lf.a_position,n=p;n<h;n++)f[n]=
g[n-p];for(n=1;n<c.Ca.ib.length;n++){var g=c.Ca.ib[n].Lf.a_position,m=k[n].value;if(m)for(var q=p;q<h;q++)f[q]+=m*g[q-p]}R.bufferSubData(R.ARRAY_BUFFER,W.Kj*p,f.subarray(p))}f=T("a_tbn_quat");c=ea(b.Pd,f);f=I(b.tc,f);R.bindBuffer(R.ARRAY_BUFFER,c);p=b.ld.a_tbn_quat;b=e[d];c=f;f=a;if(p){k=p.offset;p=p.length+k;h=b.Ca.ib[0].Lf.a_tbn_quat;n=ba;for(g=k;g<p;g+=4){n[0]=0;n[1]=0;n[2]=0;for(m=n[3]=1;m<b.Ca.ib.length;m++){var q=b.Ca.ib[m].Lf.a_tbn_quat,v=f[m].value;if(v){var l=ya;l[0]=q[g-k];l[1]=q[g+1-k];
l[2]=q[g+2-k];l[3]=q[g+3-k];q=V.slerp(W.Gn,l,v,ya);V.multiply(q,n,n)}}m=ya;m[0]=h[g-k];m[1]=h[g-k+1];m[2]=h[g-k+2];m[3]=h[g-k+3];q=0<m[3];V.multiply(n,m,m);(0<m[3]&&!q||0>m[3]&&q)&&V.scale(m,-1,m);c[g]=W.Br(m[0]);c[g+1]=W.Br(m[1]);c[g+2]=W.Br(m[2]);c[g+3]=W.Br(m[3])}R.bufferSubData(R.ARRAY_BUFFER,W.Kj*k,c.subarray(k))}}};a.IS=function(a){return a.k.Qe};a.T6=function(a){var b=[];if(a.k)for(var c=1;c<a.k.qi.length;c++)b.push(a.k.qi[c].name);return b};a.S6=function(a,b){if(a.k)for(var c=1;c<a.k.qi.length;c++)if(b==
a.k.qi[c].name)return a.k.qi[c].value;return 0};a.rW=function(a,b){var c=a.k.qi;if(c)for(var e=1;e<c.length;e++)if(c[e].name==b)return!0;return!1};a.t7=function(a){return a&&a.k&&a.k.gg?!0:!1};a.Q4=function(b,c,d){var h=b.Ca;if(h){for(var k=d?c.length/3/2:c.length/3-1,p=new Float32Array(12*k),g=new Float32Array(12*k),n=new Uint16Array(6*k),m=0;m<k;m++){if(d)var q=6*m,v=6*m+3;else q=3*m,v=3*(m+1);var l=c[q],w=c[q+1],q=c[q+2],H=c[v],P=c[v+1],v=c[v+2],x=H-l,r=P-w,u=v-q;p[12*m]=l;p[12*m+1]=w;p[12*m+2]=
q;g[12*m]=x;g[12*m+1]=r;g[12*m+2]=u;p[12*m+3]=H;p[12*m+4]=P;p[12*m+5]=v;g[12*m+3]=-x;g[12*m+4]=-r;g[12*m+5]=-u;p[12*m+6]=l;p[12*m+7]=w;p[12*m+8]=q;g[12*m+6]=-x;g[12*m+7]=-r;g[12*m+8]=-u;p[12*m+9]=H;p[12*m+10]=P;p[12*m+11]=v;g[12*m+9]=x;g[12*m+10]=r;g[12*m+11]=u;n[6*m]=4*m;n[6*m+1]=4*m+1;n[6*m+2]=4*m+2;n[6*m+3]=4*m;n[6*m+4]=4*m+3;n[6*m+5]=4*m+1}d=0;for(var t in h.ld)c=h.ld[t],d+=p.length/3*c.Jc;c={};c["float"]=d;d=h.tc=e(c);a.h0(h,b.Uh,n);b=0;for(t in h.ld)switch(c=h.ld[t],t){case "a_position":M(d,
t,p,b);c.offset=b;c.length=p.length;b+=c.length;break;case "a_direction":M(d,t,g,b);c.offset=b;c.length=g.length;b+=c.length;break;default:c.offset=b,c.length=p.length/3*c.Jc,n=new Float32Array(c.length),M(d,t,n,b),b+=c.length}f(h)}};a.VS=function(a){var b=h();if(a.pe)switch(a.wm){case R.UNSIGNED_SHORT:b.pe=new Uint16Array(a.pe);break;case R.UNSIGNED_INT:b.pe=new Uint32Array(a.pe)}else b.pe=null;for(var c=a.tc,e=[],d=0;d<c.length;d++){var f=c[d].xi,k=c[d].type;e.push({xi:new f.constructor(f),type:k})}b.tc=
e;b.wm=a.wm;b.count=a.count;b.ld=W.T(a.ld);b.pn=a.pn;b.Xn=a.Xn;b.Zn=a.Zn;b.ng=null;b.iw=W.T(a.iw);b.ib=W.T(a.ib);b.Am=a.Am;b.eg=a.eg;return b};a.Pf=x;a.reset=function(){R=null};a.O7=e;a.fZ=n;a.d7=ea;a.Nv=I;a.P5=F;a.Tr=T;a.OJ=function(a){switch(T(a)){case "float":return W.Kj;case "short":return W.hq;case "unsigned_byte":return W.Iy;default:return W.Kj}};a.XV=function(a){switch(T(a)){case "float":return R.FLOAT;case "short":return R.SHORT;case "unsigned_byte":return R.UNSIGNED_BYTE;default:return R.FLOAT}};
a.hO=M};b4w.module.__primitives=function(a,g){function l(a,b,d,g){for(var c=[],l=[],r=[],u=[],y=2*d/(a-1),B=2*g/(b-1),O=0;O<a;O++)for(var K=-d+O*y,E=0;E<b;E++)if(l.push(K,-g+E*B,0),u.push(0,0,0,1),r.push(O/(a-1),E/(b-1)),O&&E){var C=O*b+E,Q=C-1,k=(O-1)*b+E,p=k-1;c.push(C,Q,k);c.push(Q,p,k)}a=h.Vg();a.a_position=new Float32Array(l);a.a_tbn_quat=new Float32Array(u);u=A.Pf("GRID_PLANE");u.aa[0]=a;u.qa.a_texcoord=new Float32Array(r);u.na=new Uint32Array(c);u.Ja=l.length/3;return u}function d(a){var b=a.length;
b%4&&h.q("Wrong array");for(var d=[],g=[],c=0;c<b;c+=4){var l=a[c+1],u=a[c+2],r=a[c+3];y(a[c],g);y(l,g);y(u,g);y(r,g);d.push(c,c+1,c+2);d.push(c,c+2,c+3)}a=h.Vg();a.a_position=new Float32Array(g);b=A.Pf("FROM_QUADS");b.aa[0]=a;b.na=new Uint32Array(d);b.Ja=g.length/3;return b}function b(a,b){var d=3*b;return[a[d],a[d+1],a[d+2]]}function y(a,b){b.push(a[0],a[1],a[2])}var r=g("__config"),A=g("__geometry");g("__print");var h=g("__util"),u=r.B;a.yV=function(){var a=A.Pf("LINE"),b=h.Vg();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.na=new Uint32Array(1);a.Ja=1;return a};a.C5=function(a,b){var d=l(2,2,a,b);d.name="PLANE";return d};a.B5=l;a.rV=function(a,b,d){function g(a,b){return 1==a%2&&(0==b||b==D-1)||1==b%2&&(0==a||a==r-1)?!0:!1}var c=d/=Math.pow(2,a-1),l=d,r=b+1,D=b+1;b=[];d=[];for(var y=[],B=0,O=0,K=-1,E=[],C=0;C<a;C++){for(var Q=2*c/(r-1),k=2*l/(D-1),p=[],x=[],e=0,w=0;w<r;w++){for(var n=-c+w*Q,ea=[],I=0;I<D;I++){var F=-l+I*k;if(n>-B&&n<B&&F>-O&&F<O)ea.push(-1),e++;else{for(var T=
null,M=0;M<E.length;M+=3)if(n==E[M]&&F==E[M+1]){T=E[M+2];break}M=null!==T?T:K+1;g(w,I)?(ea.push(-2),e++):(null==T&&(0==I||I==D-1||0==w||w==r-1?(T=C==a-1?Q:2*Q,p.push(n,F,M)):T=Q,d.push(n,F,T),y.push(.707,0,0,.707),K++),ea.push(M));if(w&&I)if(1==w)if(g(w-1,I)){if(1<I){var F=M-1,T=x[w-1][I+1],X=T-1;b.push(X,F,M)}else T=x[w-1][I+1],X=T-1;b.push(T,X,M)}else g(w,I)||(F=M-1,T=x[w-1][I],b.push(T,F,M));else if(w==r-1){if(!g(w,I))if(I==D-1)F=M-1,T=x[w-1][I-1],X=x[w-2][I],b.push(T,F,M),b.push(X,T,M);else{var F=
M-1,T=x[w-1][I],X=T-1,H=T+1;b.push(X,F,M);b.push(T,X,M);b.push(H,T,M);2==I&&(H=x[w-2][I-2],b.push(X,H,F))}}else 1==I?g(w,I-1)?(F=x[w-1][I],T=x[w-1][I-1],b.push(F,T,M)):(F=ea[I-1],T=x[w-1][I],X=x[w-2][I-1],b.push(T,F,M),b.push(T,X,F)):I==D-1?g(w,I)||(F=ea[I-1],T=x[w-1][I-1],X=x[w-2][I],b.push(T,F,M),b.push(X,T,M)):-1!=x[w-1][I]&&-1!=x[w-1][I-1]&&-1!=ea[I-1]?(F=ea[I-1],T=x[w-1][I],X=x[w-1][I-1],b.push(T,F,M),b.push(T,X,F),I==D-2&&g(w,I+1)&&(H=x[w-1][I+1],b.push(H,T,M))):I==D-2&&g(w,I+1)&&(T=x[w-1][I],
H=x[w-1][I+1],b.push(H,T,M))}}x.push(ea)}E=p;B=c;O=l;c*=2;l*=2}if(2E4>B)for(a=-(2*B)/(r-1),d.push(-2E4,-2E4,a),d.push(-2E4,2E4,a),d.push(-B,-O,a),d.push(-B,O,a),d.push(2E4,-2E4,a),d.push(2E4,2E4,a),d.push(B,-O,a),d.push(B,O,a),M=K+1,b.push(M+1,M+2,M+3,M+1,M+0,M+2,M+2,M+4,M+6,M+2,M+0,M+4,M+1,M+7,M+5,M+1,M+3,M+7,M+7,M+4,M+5,M+6,M+4,M+7),w=0;8>w;w++)y.push(.707,0,0,.707);a=h.Vg();a.a_position=new Float32Array(d);a.a_tbn_quat=new Float32Array(y);c=A.Pf("MULTIGRID_PLANE");c.aa[0]=a;c.na=new Uint32Array(b);
c.Ja=d.length/3;u.tO&&(A.Yx(c,1,!0),a.a_polyindex=A.sv(c));return c};a.A5=function(a){var b=a.length;b%3&&h.q("Wrong array");for(var d=[],g=[],c=0;c<b;c+=3){var l=a[c+1],r=a[c+2];y(a[c],g);y(l,g);y(r,g);d.push(c,c+1,c+2)}a=h.Vg();a.a_position=new Float32Array(g);b=A.Pf("FROM_TRIANGLES");b.aa[0]=a;b.na=new Uint32Array(d);b.Ja=g.length/3;return b};a.z5=d;a.vV=function(a){a=h.Q0(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.Tc=function(){var a=A.Pf("FULLSCREEN_TRI"),b=h.Vg();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.na=new Uint32Array([0,1,2]);a.Ja=3;return a};a.wV=function(){var a=A.Pf("FULLSCREEN_QUAD"),b=h.Vg();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,1,2,3]);a.Ja=4;return a};a.qV=function(){var a=A.Pf("BILLBOARD"),b=h.Vg();b.a_bb_vertex=A.KI(1);a.aa[0]=b;a.na=
new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.sV=function(){var a=A.Pf("CUBEMAP_BOARD"),b=h.Vg();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.Bv=function(a,d){var f=A.Pf("UV_SPHERE"),g,c,l=[],r=[],u=[];for(c=0;8>=c;c++)for(g=0;16>=g;g++){var G=g/16,B=c/8;r.push(-a*Math.cos(2*G*Math.PI)*Math.sin(B*Math.PI)+d[0],a*Math.cos(B*Math.PI)+d[1],a*Math.sin(2*G*Math.PI)*Math.sin(B*Math.PI)+d[2])}for(c=G=0;8>c;c++)for(g=0;16>g;g++){var B=
b(r,17*c+g+1),O=b(r,17*c+g),K=b(r,17*(c+1)+g),E=b(r,17*(c+1)+g+1);Math.abs(B[1])==a+d[1]?(y(B,l),y(K,l),y(E,l),u.push(G,G+1,G+2),G+=3):Math.abs(K[1])==a+d[1]?(y(B,l),y(O,l),y(K,l),u.push(G,G+1,G+2),G+=3):(y(B,l),y(O,l),y(K,l),y(E,l),u.push(G,G+1,G+2),u.push(G,G+2,G+3),G+=4)}g={};g.a_position=l;r=A.hS(u,r,l);r=A.dS(u,l,r);g.a_tbn_quat=h.Mr(r);f.aa[0]=g;f.na=u;f.Ja=l.length/3;return f};a.OI=function(a){var b=A.Pf("INDEX"),d=h.Vg();d.a_index=new Float32Array(3*a);for(var g=new Uint16Array(3*a),c=0;c<
3*a;c++)d.a_index[c]=c,g[c]=c;b.aa[0]=d;b.na=g;b.Ja=3*a;return b}};b4w.module.__scenegraph=function(a,g){function l(a,b){var c=[];n.Dg(a,function(b,e,d){-1<c.indexOf(d)?n.QY(a,b,e,d,O(d)):c.push(d)});n.pa(a,function(a,e){for(var d=0;d<e.Ya.length;d++){var f=e.Ya[d];b||e.type!=I.Rd&&e.type!=I.nd&&e.type!=I.ag||(f.tf=!0);-1<c.indexOf(f)?e.Ya[d]=O(f):c.push(f)}})}function d(a,c){n.pa(a,function(b,e){e.type==I.$E&&n.vi(a,b,function(a,b){if(b.type==I.Hh)for(var c=0;c<b.Ya.length;c++){var e=b.Ya[c];e.Na=F.L;e.Ma=F.L}});c||n.vi(a,b,function(a,b,c){"DEPTH"==c.from&&(c.tf=
!0)})});n.pa(a,function(c){var e={};b(a,c,e);for(var d in e){c=e[d];for(var f=c[0],h=0;h<c.length;h++)if(c[h].Na==F.L){f=c[h];break}for(var k=c[0],h=0;h<c.length;h++)if(c[h].Ma==F.L){k=c[h];break}for(var p=c[0],h=0;h<c.length;h++)if(!c[h].tf){p=c[h];break}for(h=0;h<c.length;h++)c[h].Na=f.Na,c[h].Ma=k.Ma,c[h].tf=p.tf}})}function b(a,c,e){n.vi(a,c,function(c,d,f){f.Hc&&f.from==f.to&&(e[f.from]=e[f.from]||[],-1==e[f.from].indexOf(f)&&e[f.from].push(f),b(a,c,e))});n.hl(a,c,function(a,b,c){c.Hc&&(e[c.from]=
e[c.from]||[],-1==e[c.from].indexOf(c)&&e[c.from].push(c))});c=n.Va(a,c);if(c.type==I.Hh)for(var d=0;d<c.Ya.length;d++){var f=c.Ya[d];e[f.from].push(f)}}function y(a){var b=[I.Hh,I.Kz,I.lu,I.Rd,I.nd,I.eq],c=n.xE(a),e=[];n.pa(c,function(a,d){for(var f=0;f<d.Ya.length;f++){var k=d.Ya[f];-1<b.indexOf(d.type)&&(k.gy=!0);var p=m(e,k,r(k));k.jb=p;d.ui[f]=p}for(f=0;f<d.ui.length;f++)p=d.ui[f],u(e,p);n.hl(c,a,function(f,k,p){-1<b.indexOf(d.type)&&(p.gy=!0);p.jb||((f=A(c,a,p.from))&&p.Hc&&!p.jb?h(e,f):f=m(e,
p,r(p)),p.jb=f)});n.vi(c,a,function(a,b,c){u(e,c.jb)});n.hl(c,a,function(a,b,c){c.jb&&"NONE"==c.to&&u(e,c.jb)})})}function r(a){a=T.Qh(a);delete a.to;delete a.Hc;delete a.jb;return JSON.stringify(a)}function A(a,b,c){var e=null;n.vi(a,b,function(a,b,d){if(d.Hc&&d.from==d.to&&d.from==c&&d.jb)return e=d.jb,!0});n.hl(a,b,function(a,b,d){if(d.Hc&&d.from==c&&d.jb)return e=d.jb,!0});return e}function h(a,b){for(var c=0;c<a.length;c++){var e=a[c];e.tE===b&&e.Qs++}}function u(a,b){for(var c=0;c<a.length;c++){var e=
a[c];e.tE===b&&e.Qs&&e.Qs--}}function m(a,b,c){if(b.Lo)return h(a,b.Lo.jb),b.Lo.jb;if(b.gy)return q(b);for(var e=null,d=0;d<a.length;d++){var f=a[d];if(f.id==c&&0===f.Qs){e=f;break}}if(e&&!X.AI)return e.Qs++,e.tE;b=q(b);a.push({id:c,Qs:1,tE:b});return b}function q(a){var b=a.fn*a.size,c=a.gn*a.size;switch(a.from){case "COLOR":if(a.tf){var e=F.Zl(a.Ak?F.qu:F.pu,a.tt);F.resize(e,b,c)}else e=F.Zl(F.Ih,a.tt),F.resize(e,b,c),F.LD(e,a.Na,a.Ma);return e;case "DEPTH":return a.tf?(e=F.Zl(a.Ak?F.ou:F.nu,a.tt),
F.resize(e,b,c)):(e=F.Zl(F.Bl,a.tt),F.resize(e,b,c),F.LD(e,a.Na,a.Ma)),e;case "CUBEMAP":return e=F.OH(b);case "SCREEN":case "NONE":return null;default:T.q("Wrong slink param: "+a.from)}}function f(a,b){var c=!1;n.Dg(a,function(e,d,f){if(f&&(e=n.Va(a,e),d=n.Va(a,d),b(f,!1,e,d)))return c=!0});c||n.pa(a,function(a,c){for(var e=0;e<c.Ya.length;e++)if(b(c.Ya[e],!0,c,null))return!0})}function t(a){n.pa(a,function(b,c){if(c.type!=I.In){var e=c.p;n.hl(a,b,function(a,b,c){c.Hc&&c.jb&&(x.vx(e,c.from,c.jb),
c.from==c.to&&b.p&&x.vx(b.p,c.from,c.jb))});for(var d=0;d<c.Ya.length;d++){var f=c.Ya[d];f.Hc&&f.from==f.to&&x.vx(e,f.from,c.ui[d])}!e.wc&&!e.af||e.ff||(e.ff=ea.MY(e.wc,e.af))}});n.pa(a,function(b,c){if(c.type==I.Hn||c.type==I.Ny){var e=C(a,c);c.p.Ir=e[0].p.ff}})}function c(a){var b=null,c=0;n.pa(a,function(a,e){if(e.type==M.B_){if(c==M.A_)return b=e,!0;c++}});return b}function z(a,b){var c=n.qh(a,b),e=I.Cd("NONE"),d=n.J(a,e),f=n.Qr(a)[0];n.Dg(a,function(b,c){c==f&&n.GY(a,b,f,b,d)});var h=L(b,a);
n.Dg(a,function(d,f,k){if(d==c){if(h){d=I.av();n.J(a,d);f=B("COLOR","RESOLVE",1,1,1,!0);f.Ak=!0;f.tf=!0;var p=B("DEPTH","RESOLVE",1,1,1,!0);p.Ak=!0;p.tf=!0;n.r(a,b,d,f);n.r(a,b,d,p);b=d}n.r(a,b,e,B(M.$Z,"u_color",k.size,k.fn,k.gn,k.pt));return!0}});n.fd(a,d,f,B("SCREEN","NONE",.5,.5,.5,!0))}function L(a,b){var c=!1,e=n.qh(b,a);n.xg(b,e)&&(c=n.gh(b,e,0),e=n.$d(b,e,c,0),"COLOR"==e.from&&"COLOR"==e.to||"DEPTH"==e.from&&"DEPTH"==e.to?(e=n.Va(b,c),c=L(e,b)):c="RESOLVE"==e.to);return c}function D(a,b,c,
e){var d=c.da,f=b.cw,h=b.li.ii,k=b.li.dx,p=n.Wx(a,n.aW(a,e),n.Kt),g=[],m=[],q=[],p=n.clone(p,function(b){var e;if(-1<fa.indexOf(b.type))m.push(b),e=b;else{e=I.WS(b);if(e.type==I.Rd)for(var p=0;p<h.length;p++)if(h[p][0]==b){h[p]=[b,e];e.p.rc=b.p.rc;c.da.push(e.p);break}if(b.type==I.Cf)for(p=0;p<h.length;p++){if(k[p][0]==b){k[p]=[b,e];e.p=h[p][1].p;break}}else-1<d.indexOf(b.p)&&(f?(x.Cw(b.p,x.Ve),x.Cw(e.p,x.We)):(x.Cw(b.p,x.Qc),x.Cw(e.p,x.ed)),d.push(e.p));var l=n.qh(a,b);n.vi(a,l,function(a,b,c){-1<
fa.indexOf(b.type)&&g.push([b,e,c])});if(b.type!==I.Hh)for(p=0;p<b.Ya.length;p++)e.Ya[p].Lo=b.Ya[p];b=!0;for(p=0;p<n.so(a,l);p++){var w=n.Zi(a,l,p),w=n.Va(a,w);-1==fa.indexOf(w.type)&&(b=!1)}b&&q.push(e)}return e},function(a){var b=O(a,!0);b.Lo=a;return b});n.Dg(p,function(a,b,c){n.Va(p,a).type===I.Hh&&(c.Lo=null)});for(var l=0;l<m.length;l++)n.zg(p,n.qh(p,m[l]));n.yA(p);b=I.aU(f);var l=n.J(a,b),w=I.WA();n.J(a,w);var H=B("COLOR","COPY",1,1,1,!0);n.r(a,e,w,H);var r=B("COLOR","u_sampler_left",1,1,1,
!0);r.gy=!0;r.Na=F.L;r.Ma=F.L;n.r(a,w,b,r);e.zc||(e=I.WA(),n.J(p,e),r=B("COLOR","COPY",1,1,1,!0),r.Lo=H,H=n.Qr(p)[0],H=n.Va(p,H),n.r(p,H,e,r));e=B("COLOR","u_sampler_right",1,1,1,!0);e.Na=F.L;e.Ma=F.L;n.oR(p,a,[n.Qr(p)[0],l,e]);for(l=0;l<g.length;l++)n.r(a,g[l][0],g[l][1],g[l][2]);e=B("SCREEN","NONE",0,0,0,!1);for(l=0;l<q.length;l++)n.r(a,w,q[l],e);f&&G(a,.5,1);return b}function G(a,b,c){var e=[];n.pa(a,function(b,c){if(-1==fa.indexOf(c.type)&&c.Ya.length&&K(a,c,I.Fi))for(var d=0;d<c.Ya.length;d++){var f=
c.Ya[d];-1==e.indexOf(f)&&e.push(f)}});n.Dg(a,function(b,c,d){b=n.Va(a,b);c=n.Va(a,c);-1==fa.indexOf(b.type)&&K(a,c,I.Fi)&&-1==e.indexOf(d)&&e.push(d)});for(var d=0;d<e.length;d++)e[d].fn*=b,e[d].gn*=c}function B(a,b,c,e,d,f){return{from:a,to:b,size:c,fn:e,gn:d,pt:f,Hc:!0,jb:null,Ak:!1,tf:!1,Na:F.Ae,Ma:F.Ae,gy:!1,tt:!1}}function O(a,b){if(b){var c=a.jb;a.jb=null}a.jb&&T.q("Failed to clone slink with attached texture");var e=T.Qh(a);b&&(a.jb=c,e.jb=c);return e}function K(a,b,c){if(b.type==c)return!0;
b=Q(a,b);for(var e=0;e<b.length;e++)if(K(a,b[e],c))return!0;return!1}function E(a,b,c){if(b.type==c)return!0;b=C(a,b);for(var e=0;e<b.length;e++)if(E(a,b[e],c))return!0;return!1}function C(a,b){var c=n.qh(a,b);c==n.Gz&&T.q("Subscene not in graph");for(var e=[],d=n.so(a,c),f=0;f<d;f++){var h=n.Zi(a,c,f);h!=c&&e.push(n.Va(a,h))}return e}function Q(a,b){var c=n.qh(a,b);c==n.Gz&&T.q("Subscene not in graph");for(var e=[],d=n.xg(a,c),f=0;f<d;f++){var h=n.gh(a,c,f);h!=c&&e.push(n.Va(a,h))}return e}function k(a){var b=
[],c=[];f(a,function(a){a.jb&&-1==b.indexOf(a.jb)&&(b.push(a.jb),c.push(a.jb,b.length-1))});return c}function p(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.pt){var e=a.fn,d=a.gn;Math.round(e)!=e&&(e=e.toFixed(2));Math.round(d)!=d&&(d=d.toFixed(2));c+=(1==e?"":e)+"Sx"+((1==d?"":d)+"S")}else e=a.fn,d=a.gn,c+=a.size*e+"x"+a.size*d;if("SCREEN"!=a.from){c+=" ";if(a.tf)c+="RR";else{var e=a.Na,d=a.Ma,f="";e==F.L?f+="L":e==F.Ae&&(f+="N");d==F.L?f+="L":d==F.Ae&&(f+="N");c+=f}for(e=
0;e<b.length;e+=2)b[e]==a.jb&&(c+=" "+b[e+1])}return c+")\\n"}var x=g("__camera"),e=g("__config"),w=g("__debug"),n=g("__graph"),ea=g("__renderer"),I=g("__subscene"),F=g("__textures"),T=g("__util"),M=e.or,X=e.B,H=e.Xo,fa=[I.Di,I.dd,I.nd,I.Ue];a.JS=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.S_=f;a.xT=function(a,b,e,f){function h(c){var e=x.Ic(Qa,!0);b.da.push(e);e=I.Yl(c,e,!1,A,
L,Ca,Ia,Aa,a.Aj);n.J(k,e);c==I.ag?(n.r(k,p[0],e,B("COLOR","COLOR",1,1,1,!0)),e.Ya.push(B("DEPTH","DEPTH",1,1,1,!0))):(c=ka&&p[0].type==I.Hn?Jb:p[0],n.r(k,c,e,Ga),n.r(k,c,e,xb));Ja&&(n.r(k,Ja,e,hb),n.r(k,Ja,e,eb));for(c=0;c<m.length;c++)n.r(k,m[c],e,q[c]);Va&&n.r(k,Va,e,pb);if(r.length){var d=r.length;for(c=0;c<d;c++)n.r(k,r[c],e,u[c])}if(E.length)for(c=0;c<E.length;c++)n.r(k,E[c],e,fa[c]);fc&&n.r(k,fc,e,Xc);return e}var k=n.create(),p=[],g=[],m=[],q=[],r=[],u=[],E=[],fa=[],L=a.cX,A=a.Mc,G=a.Xk,K=
a.b_,ea=a.ssao,ia=a.god_rays,J=a.li,ma=a.OK,pa=a.QR,ja=a.motion_blur,qa=a.compositing,ta=a.antialiasing,Ia=a.Kp,Ca=a.wO,Aa=a.yd,la=a.QX,Da=a.sS,za=a.kW,Sa=a.gY,Fa=a.dof,Na=a.pU,S=a.refractions,da=Boolean(f.length),ka=1<X.Fc,xb=B("COLOR","COLOR",1,1,1,!0),Ga=B("DEPTH","DEPTH",1,1,1,!0);if(ka){O(Ga);var Dc=O(Ga);xb.Ak=!0;xb.tf=!0;Ga.Ak=!0;Ga.tf=!0}var Qa=b.da[0];if(Aa){x.KE(Qa,Aa);for(var ga=0;ga<Aa.lh.length;ga++)for(var Ea=Aa.csm_num,va=0;va<Ea;va++){var U=I.WT(va,ga,Aa,L);n.J(k,U);m.push(U);var Oa=
Aa.csm_resolution,wa=U.p;b.NM.push(wa);wa.width=Oa;wa.height=Oa;U.wb=!1;var La=B("DEPTH","u_shadow_map"+(0<ga?ga:va),Oa,1,1,!1);X.br&&(La.Na=F.L,La.Ma=F.L,La.tt=!0);q.push(La);(w.BS()||X.OM)&&U.Ya.push(B("COLOR","COLOR",Oa,1,1,!1))}}if(J&&J.dL&&!da)for(va=0;va<J.dL;va++){wa=x.hd(x.Sd);wa.width=a.Si;wa.height=a.Si;x.xx(wa,90,.1,100);x.Wk(wa,wa.Ab);var Ra=I.Yl(I.nd,wa,!1,A,L,Ca,Ia,null,a.Aj);Ra.$l=T.xV();for(ga=0;6>ga;ga++)Ra.lr.push(x.lT());n.J(k,Ra);var rb=B("CUBEMAP","u_cube_reflection",a.Si,1,1,
!1);rb.Na=F.L;rb.Ma=F.L;fa.push(rb);if(J.ZJ){var Ta=I.Yl(I.Ue,wa,!1,A,L,Ca,Ia,null,a.Aj);Ta.$l=Ra.$l;Ta.lr=Ra.lr;n.J(k,Ta);var Ba=B("DEPTH","DEPTH",a.Si,1,1,!1),bb=B("COLOR","COLOR",a.Si,1,1,!1);n.r(k,Ra,Ta,Ba);n.r(k,Ra,Ta,bb);E.push(Ta);J.aB.push(Ta)}else{var Xa=B("DEPTH","DEPTH",a.Si,1,1,!1);Ra.Ya.push(Xa);E.push(Ra)}J.Ri.push(Ra)}if(J&&0<J.KL.length&&!da)for(ga=0;ga<J.KL.length;ga++)wa=x.Ic(Qa,!0),wa.rc=new Float32Array(4),b.da.push(wa),Ra=I.Yl(I.Rd,wa,!1,A,L,Ca,Ia,null,a.Aj),n.J(k,Ra),rb=B("COLOR",
"u_plane_reflection",1,a.uh,a.uh,!0),rb.Na=F.L,rb.Ma=F.L,u.push(rb),J.ZJ?(Ta=I.Yl(I.Cf,wa,!1,A,L,Ca,Ia,null,a.Aj),n.J(k,Ta),Ba=B("DEPTH","DEPTH",1,a.uh,a.uh,!0),bb=B("COLOR","COLOR",1,a.uh,a.uh,!0),bb.Na=F.Ae,bb.Ma=F.Ae,n.r(k,Ra,Ta,Ba),n.r(k,Ra,Ta,bb),J.dx.push([Ta]),r.push(Ta)):(Xa=B("DEPTH","DEPTH",1,a.uh,a.uh,!0),Ra.Ya.push(Xa),r.push(Ra)),J.ii.push([Ra]);if(a.jd){var Ja=I.PT();n.J(k,Ja);Oa=H.Vr;Ja.p.width=Oa;Ja.p.height=Oa;var hb=B("DEPTH","u_grass_map_depth",Oa,1,1,!1);X.fc||(hb.Na=F.L,hb.Ma=
F.L);var eb=B("COLOR","u_grass_map_color",Oa,1,1,!1);eb.Na=F.L;eb.Ma=F.L}else eb=hb=Ja=null;if(Na&&Aa){var cb=x.Ic(Qa,!0);b.da.push(cb);var nb=I.XT(cb,L);n.J(k,nb);nb.self_shadow_normal_offset=Aa.self_shadow_normal_offset;for(va=0;va<m.length;va++)U=m[va],n.r(k,U,nb,q[va]);var ib=B("COLOR","u_color",1,1,1,!0),ob=B("DEPTH","u_depth",1,1,1,!0);if(ea){var yb=x.Ic(Qa,!0);b.da.push(yb);var Ua=a.s_,Nb=I.ZT(yb,Ca,Ua);n.J(k,Nb);var lc=B("COLOR","u_ssao_mask",1,1,1,!0);n.r(k,nb,Nb,ib);n.r(k,nb,Nb,ob);var Xb=
x.Ic(Qa,!0);b.da.push(Xb);var sb=I.$T(Xb,Ua);n.J(k,sb);var pd=B("COLOR","u_shadow_mask",1,1,1,!0);n.r(k,Nb,sb,lc);n.r(k,nb,sb,ob)}ka?nb.Ya.push(B("DEPTH","DEPTH",1,1,1,!0)):nb.Ya.push(Ga);Ja&&(n.r(k,Ja,nb,hb),n.r(k,Ja,nb,eb))}else nb=null;var Jb=I.Yl(I.Pb,Qa,!0,A,L,Ca,Ia,null,a.Aj);n.J(k,Jb);if(ka){var jb=I.av();n.J(k,jb);g.push(jb);var ec=B("COLOR","RESOLVE",1,1,1,!0);ec.Ak=!0;ec.tf=!0;var Ec=B("DEPTH","RESOLVE",1,1,1,!0);Ec.Ak=!0;Ec.tf=!0;n.r(k,Jb,jb,ec);n.r(k,Jb,jb,Ec)}else g.push(Jb);nb&&(lc?
n.r(k,sb,Jb,pd):Aa?n.r(k,nb,Jb,B("COLOR","u_shadow_mask",1,1,1,!0)):T.q("Internal error"));Ja&&(n.r(k,Ja,Jb,hb),n.r(k,Ja,Jb,eb));if(r.length)for(var ad=r.length,ga=0;ga<ad;ga++)n.r(k,r[ga],Jb,u[ga]);if(E.length)for(ga=0;ga<E.length;ga++)n.r(k,E[ga],Jb,fa[ga]);p=g;g=[];if(!da&&a.XS){wa=x.Ic(Qa,!0);wa.width=1;wa.height=1;b.da.push(wa);var tc=I.VH(wa,!1,L);n.J(k,tc);if(a.Fh){wa=x.Ic(Qa,!0);wa.width=1;wa.height=1;b.da.push(wa);var Oc=I.VH(wa,!0,L);n.J(k,Oc);n.r(k,tc,Oc,B("COLOR","COLOR",1,1,1,!1));n.r(k,
tc,Oc,B("DEPTH","DEPTH",1,1,1,!1))}}else tc=null;if(!ma.refractions&&!S||da)fc=null;else{if(ka)fc=jb;else{var fc=I.WA();n.J(k,fc);n.r(k,p[0],fc,B("COLOR","COPY",1,1,1,!0))}var Xc=B("COLOR","u_refractmap",1,1,1,!0)}if(Na&&(S||G||K)){var kb=x.Ic(Qa,!0);b.da.push(kb);var Va=I.MT(kb);n.J(k,Va);n.r(k,ka?jb:Jb,Va,B("DEPTH","u_depth",1,1,1,!0));var pb=B("COLOR","u_scene_depth",1,1,1,!0);pb.Na=F.Ae;pb.Ma=F.Ae}else Va=null;if(a.Qv){var Pc=h(I.Pc);g.push(Pc);p=g;g=[]}if(a.aj){var Qc=x.Ic(Qa,!0);b.da.push(Qc);
var Ob=I.Yl(I.ke,Qc,!1,A,L,Ca,Ia);n.J(k,Ob);Va&&n.r(k,Va,Ob,pb);fc&&n.r(k,fc,Ob,Xc);Ja&&(n.r(k,Ja,Ob,hb),n.r(k,Ja,Ob,eb));if(r.length)for(ad=r.length,ga=0;ga<ad;ga++)n.r(k,r[ga],Ob,u[ga]);if(E.length)for(ga=0;ga<E.length;ga++)n.r(k,E[ga],Ob,fa[ga]);n.r(k,ka?jb:Jb,Ob,ka?Dc:Ga);var uc=I.Cd("X_GLOW_BLUR");uc.vb="GLOW_MASK_SMALL";uc.Cg=a.nk.small_glow_mask_width;var jd=B("COLOR","u_color",1,1,1,!0);jd.Na=F.L;jd.Ma=F.L;n.J(k,uc);n.r(k,Ob,uc,jd);var vc=I.Cd("Y_GLOW_BLUR");vc.vb="GLOW_MASK_SMALL";vc.Cg=
a.nk.small_glow_mask_width;var kd=B("COLOR","u_color",1,.5,.5,!0);kd.Na=F.L;kd.Ma=F.L;n.J(k,vc);n.r(k,uc,vc,kd);var bd=I.Cd("X_GLOW_BLUR");bd.vb="GLOW_MASK_LARGE";bd.Cg=a.nk.large_glow_mask_width;var Zb=B("COLOR","u_color",1,.5,.5,!0);Zb.Na=F.L;Zb.Ma=F.L;n.J(k,bd);n.r(k,vc,bd,Zb);var cd=I.Cd("Y_GLOW_BLUR");cd.vb="GLOW_MASK_LARGE";cd.Cg=a.nk.large_glow_mask_width;var Eb=B("COLOR","u_color",1,.25,.25,!0);Eb.Na=F.L;Eb.Ma=F.L;n.J(k,cd);n.r(k,bd,cd,Eb);var qb=x.Ic(Qa,!0);b.da.push(qb);var lb=I.NT(qb,a);
n.J(k,lb);var mb=B("COLOR","u_src_color",1,1,1,!0);if(a.Qv)if(ka){var Yc=I.av();n.J(k,Yc);n.r(k,Pc,Yc,ec);n.r(k,Pc,Yc,Ec);n.r(k,Yc,lb,mb)}else n.r(k,Pc,lb,mb);else n.r(k,ka?jb:Jb,lb,mb);n.r(k,a.Qv?Pc:Jb,lb,Ga);var wc=B("COLOR","u_glow_mask_small",1,.5,.5,!0);wc.Na=F.L;wc.Ma=F.L;n.r(k,vc,lb,wc);var gc=B("COLOR","u_glow_mask_large",1,.25,.25,!0);gc.Na=F.L;gc.Ma=F.L;n.r(k,cd,lb,gc);p=[lb];g=[]}a.Qv||(Pc=h(I.Pc),g.push(Pc),p=g,g=[]);if(X.debug_view){wa=x.Ic(Qa,!0);b.da.push(wa);var Fb=I.LT(wa);g.push(Fb);
n.J(k,Fb);n.r(k,p[0],Fb,xb);n.r(k,p[0],Fb,Ga);Ja&&(n.r(k,Ja,Fb,hb),n.r(k,Ja,Fb,eb));w.oZ(Fb);p=g;g=[]}if(ka){var $b=I.av();n.J(k,$b);g.push($b);n.r(k,p[0],$b,ec);n.r(k,p[0],$b,Ec);p=g;g=[]}var xc=p.slice(0);if(!da&&a.VQ){wa=x.Ic(Qa,!0);b.da.push(wa);var Rb=I.HT(wa);n.J(k,Rb);n.r(k,p[0],Rb,ka?Dc:Ga)}if(ia&&Na&&!da){var hc=za.Bo,yc=za.iC,tb=za.pp,$a=p[0],Ic=A?!0:!1,dd=B("DEPTH","u_input",1,1,1,!0),Gb=B("COLOR","u_input",1,.25,.25,!0);Gb.Na=F.L;Gb.Ma=F.L;var Yb=hc/tb,gb=x.Ic(Qa,!0);b.da.push(gb);var ub=
I.XA(gb,Ic,hc,!0,Yb,L,tb);n.J(k,ub);n.r(k,$a,ub,dd);var Yb=hc/tb*.5,zb=x.Ic(Qa,!0);b.da.push(zb);var Zc=I.XA(zb,Ic,hc,!1,Yb,L,tb);n.J(k,Zc);n.r(k,ub,Zc,Gb);var Yb=hc/tb*.25,Rc=x.Ic(Qa,!0);b.da.push(Rc);var ic=I.XA(Rc,Ic,hc,!1,Yb,L,tb);n.J(k,ic);n.r(k,Zc,ic,Gb);var mc=I.OT(yc,L);g.push(mc);n.J(k,mc);n.r(k,$a,mc,B("COLOR","u_main",1,1,1,!0));n.r(k,ic,mc,B("COLOR","u_god_rays",1,1,1,!0));p=g;g=[]}if(pa&&!da){var $a=p[0],Kb=I.QT();n.J(k,Kb);n.r(k,$a,Kb,B("COLOR","u_input",1,1,1,!0));var nc=I.IT();n.J(k,
nc);nc.p.width=X.yr?2:1;nc.p.height=X.yr?2:1;var oc=B("COLOR","u_input",1,.25,.25,!0);oc.Na=F.L;oc.Ma=F.L;var Sc=B("COLOR","u_luminance",1,.25,.25,!0);Sc.Na=F.L;Sc.Ma=F.L;n.r(k,Kb,nc,oc);var zc=pa.key,pc=pa.edge_lum,Lb=x.Ic(Qa,!0);b.da.push(Lb);var Ya=I.RT(zc,pc,L,Lb);n.J(k,Ya);n.r(k,$a,Ya,B("COLOR","u_main",1,1,1,!0));n.r(k,Kb,Ya,Sc);n.r(k,nc,Ya,B("COLOR","u_average_lum",1,1,1,!1));var Pa=B("COLOR","u_color",1,.25,.25,!0);Pa.Na=F.L;Pa.Ma=F.L;uc=I.UH("X_BLUR");n.J(k,uc);n.r(k,Ya,uc,Pa);vc=I.UH("Y_BLUR");
n.J(k,vc);n.r(k,uc,vc,Pa);var Sb=I.JT(pa.blur);n.J(k,Sb);var jc=B("COLOR","u_bloom",1,.25,.25,!0);jc.Na=F.L;jc.Ma=F.L;n.r(k,vc,Sb,jc);n.r(k,$a,Sb,B("COLOR","u_main",1,1,1,!0));g.push(Sb);p=g;g=[]}if(Fa&&Na&&!da){var $a=p[0],Wa=x.Ic(Qa,!0);b.da.push(Wa);if(e.dof_bokeh){var Ab=B("COLOR","u_color",1,1,1,!0);Ab.Na=F.L;Ab.Ma=F.L;var Mb=B("DEPTH","u_depth",1,1,1,!0),Tb=B("COLOR","u_color",1,.5,.5,!0);Tb.Na=F.Ae;Tb.Ma=F.Ae;Pa=B("COLOR","u_color",1,.5,.5,!0);Pa.Na=F.Ae;Pa.Ma=F.Ae;var ac=B("COLOR","u_blurred1",
1,.5,.5,!0);ac.Na=F.L;ac.Ma=F.L;var Hb=B("COLOR","u_blurred2",1,.5,.5,!0);Hb.Na=F.L;Hb.Ma=F.L;var Bb=xc[0];if(e.Ed){var ab=x.Ic(Qa,!0);b.da.push(ab);var Cb=I.VA(ab,"COC_FOREGROUND");ab.dof_distance=e.dof_distance;ab.dof_object=e.dof_object;ab.dof_front_start=e.dof_front_start;ab.dof_front_end=e.dof_front_end;ab.dof_rear_start=e.dof_rear_start;ab.dof_rear_end=e.dof_rear_end;ab.dof_power=e.dof_power;ab.dof_bokeh=e.dof_bokeh;ab.dof_bokeh_intensity=e.dof_bokeh_intensity;ab.Ed=e.Ed;ab.dof_on=!0;n.J(k,
Cb);n.r(k,$a,Cb,Ab);n.r(k,Bb,Cb,Mb);var Ka=I.Cd("X_ALPHA_BLUR");n.J(k,Ka);n.r(k,Cb,Ka,Tb);var bc=I.Cd("Y_ALPHA_BLUR");n.J(k,bc);n.r(k,Ka,bc,Pa);var Ma=x.Ic(Qa,!0),cc=I.VA(Ma,"COC_COMBINE");b.da.push(Ma);Ma.dof_distance=e.dof_distance;Ma.dof_object=e.dof_object;Ma.dof_front_start=e.dof_front_start;Ma.dof_front_end=e.dof_front_end;Ma.dof_rear_start=e.dof_rear_start;Ma.dof_rear_end=e.dof_rear_end;Ma.dof_power=e.dof_power;Ma.dof_bokeh=e.dof_bokeh;Ma.dof_bokeh_intensity=e.dof_bokeh_intensity;Ma.Ed=e.Ed;
Ma.dof_on=!0;n.J(k,cc);n.r(k,$a,cc,Ab);n.r(k,Bb,cc,Mb);n.r(k,bc,cc,B("COLOR","u_coc_fg",1,.5,.5,!0))}else Ma=x.Ic(Qa,!0),b.da.push(Ma),cc=I.VA(Ma,"COC_ALL"),Ma.dof_distance=e.dof_distance,Ma.dof_object=e.dof_object,Ma.dof_front_start=e.dof_front_start,Ma.dof_front_end=e.dof_front_end,Ma.dof_rear_start=e.dof_rear_start,Ma.dof_rear_end=e.dof_rear_end,Ma.dof_power=e.dof_power,Ma.dof_bokeh=e.dof_bokeh,Ma.dof_bokeh_intensity=e.dof_bokeh_intensity,Ma.Ed=e.Ed,Ma.dof_on=!0,n.J(k,cc),n.r(k,$a,cc,Ab),n.r(k,
Bb,cc,Mb);var Ha=I.Cd("X_DOF_BLUR");Ha.p.dof_bokeh_intensity=e.dof_bokeh_intensity;n.J(k,Ha);n.r(k,cc,Ha,Tb);var wb=I.Cd("Y_DOF_BLUR");wb.p.dof_bokeh_intensity=e.dof_bokeh_intensity;n.J(k,wb);n.r(k,Ha,wb,Pa);var Pb=I.Cd("Y_DOF_BLUR");Pb.p.dof_bokeh_intensity=e.dof_bokeh_intensity;n.J(k,Pb);n.r(k,Ha,Pb,Pa);var Ub=I.WH(Wa);Wa.dof_distance=e.dof_distance;Wa.dof_object=e.dof_object;Wa.dof_front_start=e.dof_front_start;Wa.dof_front_end=e.dof_front_end;Wa.dof_rear_start=e.dof_rear_start;Wa.dof_rear_end=
e.dof_rear_end;Wa.dof_power=e.dof_power;Wa.dof_bokeh=e.dof_bokeh;Wa.dof_bokeh_intensity=e.dof_bokeh_intensity;Wa.Ed=e.Ed;Wa.dof_on=!0;g.push(Ub);n.J(k,Ub);n.r(k,$a,Ub,B("COLOR","u_sharp",1,1,1,!0));n.r(k,wb,Ub,ac);n.r(k,Pb,Ub,Hb)}else{var qc=B("COLOR","u_color",1,1,1,!0);qc.Na=F.L;qc.Ma=F.L;var Jc=B("COLOR","u_color",1,1,1,!0);Jc.Na=F.L;Jc.Ma=F.L;Ha=I.Cd("X_BLUR");n.J(k,Ha);n.r(k,$a,Ha,qc);var kc=I.Cd("Y_BLUR");n.J(k,kc);n.r(k,Ha,kc,Jc);var ld=xc[0],Ub=I.WH(Wa);Wa.dof_distance=e.dof_distance;Wa.dof_object=
e.dof_object;Wa.dof_front_start=e.dof_front_start;Wa.dof_front_end=e.dof_front_end;Wa.dof_rear_start=e.dof_rear_start;Wa.dof_rear_end=e.dof_rear_end;Wa.dof_power=e.dof_power;Wa.dof_bokeh=e.dof_bokeh;Wa.dof_bokeh_intensity=e.dof_bokeh_intensity;Wa.Ed=e.Ed;Wa.dof_on=!0;g.push(Ub);n.J(k,Ub);n.r(k,$a,Ub,B("COLOR","u_sharp",1,1,1,!0));n.r(k,kc,Ub,B("COLOR","u_blurred",1,1,1,!0));n.r(k,ld,Ub,B("DEPTH","u_depth",1,1,1,!0))}p=g;g=[]}if(a.Fh){var ed=h(I.ag);g.push(ed);p=g;g=[]}if(ja&&!da){var Kc=p[0],Fc=I.ST(la.mb_decay_threshold,
la.mb_factor);g.push(Fc);n.J(k,Fc);n.r(k,Kc,Fc,B("COLOR","u_mb_tex_curr",1,1,1,!0));Fc.Ya.push(B("COLOR","u_mb_tex_accum",1,1,1,!0));p=g;g=[]}if(!da&&a.outline){var $a=p[0],rc=x.Ic(Qa,!0);b.da.push(rc);var db=I.UT(rc,L);n.J(k,db);var Lc=I.Cd("X_EXTEND"),Tc=B("COLOR","u_color",1,1,1,!0),Gc=B("COLOR","u_outline_mask",1,1,1,!0);Lc.cs=!0;n.J(k,Lc);n.r(k,db,Lc,Tc);var Db=B("COLOR","u_color",1,.5,.5,!0);Db.Na=F.L;Db.Ma=F.L;var Vb=I.Cd("Y_EXTEND");Vb.cs=!0;n.J(k,Vb);n.r(k,Lc,Vb,Db);Ha=I.Cd("X_BLUR");Ha.cs=
!0;n.J(k,Ha);n.r(k,Vb,Ha,Db);var Ac=B("COLOR","u_color",1,.25,.25,!0);Ac.Na=F.L;Ac.Ma=F.L;var Qb=B("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Qb.Na=F.L;Qb.Ma=F.L;kc=I.Cd("Y_BLUR");kc.cs=!0;n.J(k,kc);n.r(k,Ha,kc,Ac);var vb=I.TT(Sa);n.J(k,vb);n.r(k,$a,vb,B("COLOR","u_outline_src",1,1,1,!0));n.r(k,db,vb,Gc);n.r(k,kc,vb,Qb);g.push(vb);p=g;g=[]}l(k,Na);if((a.anaglyph_use||a.cw)&&!da){var Uc=D(k,a,b,p[0]);g.push(Uc);p=g;g=[]}if(qa&&!da){var $a=p[0],Vc=I.KT(Da.brightness,Da.contrast,Da.exposure,Da.saturation);
n.J(k,Vc);n.r(k,$a,Vc,B("COLOR","u_color",1,1,1,!0));g.push(Vc);p=g;g=[]}if(ta){$a=p[0];if(X.smaa){var fb=B("COLOR","u_color",1,1,1,!0);fb.Na=F.L;fb.Ma=F.L;var Za=I.YA(I.ku,a);n.J(k,Za);n.r(k,$a,Za,fb);var Hc=I.YA(I.iq,a);n.J(k,Hc);n.r(k,Za,Hc,fb);var Mc=B("COLOR","u_search_tex",1,1,1,!1),Bc=B("COLOR","u_area_tex",1,1,1,!1);Mc.Na=F.L;Mc.Ma=F.L;Bc.Na=F.L;Bc.Ma=F.L;Hc.Ya.push(Mc);Hc.Ya.push(Bc);var dc=I.YA(I.lu,a);n.J(k,dc);n.r(k,$a,dc,fb);var $c=B("COLOR","u_blend",1,1,1,!0);$c.Na=F.L;$c.Ma=F.L;n.r(k,
Hc,dc,$c);g.push(dc)}else{var Wb=I.GT(a);n.J(k,Wb);var Nc=B("COLOR","u_color",1,1,1,!0);Nc.Na=F.L;Nc.Ma=F.L;n.r(k,$a,Wb,Nc);g.push(Wb)}p=g;g=[]}var Cc=n.qh(k,p[0]);if(p[0].type==I.Hh||p[0].type==I.Hn)var qd=!0;else qd=!1,n.vi(k,Cc,function(a,b,c){if(c.from==c.to)return qd=!0});if(qd){var md=I.Cd("NONE");n.J(k,md);n.r(k,p[0],md,B("COLOR","u_color",1,1,1,!0));g.push(md);p=g;g=[]}g.push(p[0]);tc&&(Oc?g.push(Oc):g.push(tc));Rb&&g.push(Rb);Oa=H.dv;if(a.Nx.NL){var nd=a.Nx,wd=a.Kp,rd=wd.hp,Oa=rd?rd.J_:Oa,
fd=I.YT(wd,L,nd,Oa);n.J(k,fd);g.push(fd)}var sc=I.XH();n.J(k,sc);for(va=0;va<g.length;va++){var gd=g[va];switch(gd.type){case I.zf:case I.Ci:n.r(k,gd,sc,B("COLOR","NONE",1,1,1,!1));n.r(k,gd,sc,B("DEPTH","NONE",1,1,1,!1));break;case I.Lg:n.r(k,gd,sc,B("CUBEMAP","u_sky",Oa,1,1,!1));break;case I.An:n.r(k,gd,sc,B("COLOR","NONE",1,1,1,!0));break;default:if(da){var sd=f[0],hd=B("COLOR","OFFSCREEN",1,1,1,!0);hd.jb=sd;n.r(k,g[va],sc,hd);for(ga=1;ga<f.length;ga++){var td=f[ga],Ib=I.Cd("NONE");n.J(k,Ib);n.r(k,
g[va],Ib,B("COLOR","SCALE",1,1,1,!0));var xd=td.wj/sd.wj,hd=B("COLOR","OFFSCREEN",1,xd,xd,!0);hd.jb=td;n.r(k,Ib,sc,hd)}}else n.r(k,g[va],sc,B("SCREEN","NONE",1,1,1,!0))}}jb&&!Q(k,jb).length&&(n.zg(k,n.qh(k,jb)),n.yA(k));l(k,Na);d(k,Na);if(M.enabled){var Wc=c(k);Wc&&z(k,Wc)}y(k);t(k);Aa&&n.pa(k,function(a,b){if(b.type==I.Df||b.type==I.Pc||b.type==I.ag){for(var c=0,e=C(k,b),d=0,f=0;f<e.length;f++){var h=e[f];h.type==I.dd&&(d++,b.Um=b.Um||[],b.Um[0<h.zh?h.zh:c]=h.p.xb,c++)}b.ky&&b.jy||(X.Bw?b.QE=new Float32Array(9*
d):(b.ky=new Float32Array(4*d),b.jy=new Float32Array(4*d)))}});return k};a.YX=G;a.Md=function(a,b,c){var e=a.Cg;a.uE[0]=b*a.Fb[0]*e;a.uE[1]=c*a.Fb[1]*e};a.Lc=function(a,b){a.Cg=b};a.vT=function(){var a=n.create(),b=I.VT(),c=x.hd(x.qd);c.width=512;c.height=512;b.p=c;n.J(a,b);b.Ya.push(B("COLOR","u_color",512,1,1,!1));c=I.XH();n.J(a,c);n.r(a,b,c,B("COLOR","NONE",512,1,1,!1));y(a);t(a);return a};a.cV=function(a){var b=null;n.pa(a,function(a,c){return c.p&&null===c.p.ff?(b=c,!0):!1});return b};a.Db=function(a,
b,c){a=C(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.NB=function(a,b,c){a=C(a,b);b=[];for(var e=0;e<a.length;e++)a[e].type==c&&b.push(a[e]);return b};a.x7=K;a.z7=E;a.ZV=C;a.bW=Q;a.hc=function(a,b){var c=null;n.pa(a,function(a,e){return e.type==b?(c=e,!0):!1});return c};a.kU=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=k(a);n.pa(a,function(a,e){var d=
b+="    ",f=I.jE(e);if(e.p){for(var f=f+"\\n",k=0;k<c.length;k+=2){var h=e.p.wc;c[k]==h&&(f=F.xo(h)?f+("CR"+c[k+1]+" "):f+("C"+c[k+1]+" "))}for(k=0;k<c.length;k+=2)h=e.p.af,c[k]==h&&(f=F.xo(h)?f+("DR"+c[k+1]):f+("D"+c[k+1]))}e.Ya.length&&(f+="\\n-----\\n");for(k=0;k<e.Ya.length;k++)f+=p(e.Ya[k],c);k=e.type==I.In?"dotted":e.Yd?"solid":"dashed";b=d+(String(a)+' [label="'+f+'" color="black" style="'+(k+",bold")+'"];\n')});n.Dg(a,function(a,e,d){b+="    ";b+=String(a)+" -> "+String(e)+' [label="'+p(d,
c)+'" style="'+(d.Hc?"solid":"dotted")+'"];\n'});return b+="}"};a.yT=function(a){a=n.M_(a);for(var b=[],c=0;c<a.length;c++){var e=a[c];e.Yd&&b.push(e)}return b}};b4w.module.__textures=function(a,g){function l(){return{type:0,source:"",gt:"",width:0,height:0,dr:1,anisotropic_filtering:"",wj:1024,gm:!1,dg:null,mb:0,rb:null,Se:null,Fm:!1,Dt:-1,Sa:null,oy:"",zk:0,eh:0,va:0,Tb:0,jk:0,rg:!1,xh:1,xd:null,Xs:0,Ws:0,tj:-1,Zs:!1,Uk:-1,Bt:!1,NE:!1,Ej:!1,ml:!1,repeat:!0,Yr:"",qo:"",ro:"",eC:"",dC:"",gw:!1,xm:"",mA:"",Dk:0}}function d(a,b,c){a.ro=b.uuid;a.qo=b.filepath;a.eC=b.source;a.dC=b.name;a.Yr=ha.oj(c+b.filepath);if(a.gw=b.Lh)a.xm=b.mq;Y.push(a)}function b(a,b,c){var e=
-1<b.indexOf(".dds"),d=-1<b.indexOf(".pvr");a.gw=e||d;a.xm=e?"dds":d?"pvr":"";a.qo=b;a.Yr=c}function y(b,c){var e=l();e.type=b;e.source="NONE";if(b==a.pu||b==a.nu||b==a.qu||b==a.ou)e.Se=N.createRenderbuffer();else{var d=N.TEXTURE_2D,f=N.createTexture();N.bindTexture(d,f);N.texParameteri(d,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(d,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(d,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(d,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);var k=L(e),h=D(e),p=G(e),g=
b==a.Bl?null:new Uint8Array([204,204,204,255]);N.texImage2D(d,0,h,1,1,0,k,p,g);na.br&&c&&N.texParameterf(d,N.TEXTURE_COMPARE_MODE,N.COMPARE_REF_TO_TEXTURE);N.bindTexture(d,null);e.mb=d;e.rb=f}return e}function r(a){"CANVAS"!=a.source&&ha.q("Wrong texture");var b=a.mb;N.bindTexture(b,a.rb);var c=L(a),e=D(a),d=G(a),f=a.dg.canvas;N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);N.texImage2D(b,0,e,c,d,f);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);a.gm&&N.generateMipmap(b);N.bindTexture(b,null);a.width=f.width;a.height=
f.height}function A(a){var b=a.mb;N.bindTexture(b,a.rb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Sa.length?a.rg?m(a,a.Sa,a.width*a.xh,a.height*a.xh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.Sa):N.texImage2D(b,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,a.Sa);N.bindTexture(b,null)}function h(a){var b=a.mb;N.bindTexture(b,a.rb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.rg?m(a,a.xd[a.tj],a.width*a.xh,a.height*a.xh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.xd[a.tj]);N.bindTexture(b,
null)}function u(){ra||(ra=document.createElement("canvas"));return ra}function m(a,b,c,e,d){d||(f(N.TEXTURE_2D),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b));N.bindTexture(N.TEXTURE_2D,null);v.zU(a,c,e,oa,xa)}function q(a,b,c,e){for(var d=0;6>d;d++){var f=e[d],k=u();k.width=c;k.height=c;var h=k.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(h.translate(0,c),h.scale(1,-1)):(h.translate(c,0),h.scale(-1,1));h.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,c,c);N.texImage2D(N["TEXTURE_CUBE_MAP_"+
f[0]],0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,k)}}function f(a){oa||(oa=N.createFramebuffer());N.bindTexture(a,null);xa||(xa=N.createTexture());N.bindTexture(a,xa);N.texParameteri(a,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(a,N.TEXTURE_MIN_FILTER,N.LINEAR)}function t(a,b,e){var d=a.source,k=a.rb,h=a.mb,p=a.xm,g=a.qo,n=1,l=1;N.bindTexture(h,k);a.repeat?(N.texParameteri(h,N.TEXTURE_WRAP_S,N.REPEAT),
N.texParameteri(h,N.TEXTURE_WRAP_T,N.REPEAT)):(N.texParameteri(h,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(h,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE));if(4==b.length){var w=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==d)if(w)N.texImage2D(h,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(p){l=H.VJ(b,p);w=ha.Qq(l.width)||ha.Qq(l.height);if(l.width>R.Ec||l.height>R.Ec){P.error('Image "'+g+'" has unsupported size: '+l.width+"x"+l.height+". Max available: "+
R.Ec+"x"+R.Ec+".");return}n=l.width;l=l.height;if(w||"pvr"==p)a.rg=!0,f(h),n=z(n*a.xh),l=z(l*a.xh);"dds"==p?H.E0(N,V.DJ(),b,!0):"pvr"==p&&H.F0(N,V.zJ(),b);a.rg&&(m(a,null,n,l,!0),N.bindTexture(h,k),N.generateMipmap(h));a.width=n;a.height=l;a.dr=H.HV(b,p)}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.Fm?na.Ys?(n=b[0].width,l=b[0].height):(n=b.videoWidth,l=b.videoHeight):(n=b.width,l=b.height);a.width=n;a.height=l;if(n>R.Ec||n>R.Ec)P.warn('Image "'+g+'" has unsupported size: '+n+"x"+l+". Max available: "+
R.Ec+"x"+R.Ec+". Reduced image size will be used."),a.xh=Math.min(R.Ec/n,R.Ec/l),a.rg=!0;a.Fm&&(e in sa||(sa[e]={}),sa[e][a.oy]=a,na.Ys?(a.xd=b,a.Xs=b.length,a.eh=a.Ws*a.zk/b.length,b=b[0]):(a.Sa=b,a.Sa.loop=a.Ej,a.eh=b.duration?a.zk/b.duration:W.sd(),ca.pI||(b.playbackRate=W.sd()/a.eh,ca.yH&&2<b.playbackRate&&(b.playbackRate=2)),c(a)));n=z(a.width*a.xh);l=z(a.height*a.xh);a.rg?(g=u(),k=g.getContext("2d"),g.width=n,g.height=l,k.drawImage(b,0,0,a.width,a.height,0,0,n,l),N.texImage2D(h,0,N.RGBA,N.RGBA,
N.UNSIGNED_BYTE,g)):na.fc||!ha.Qq(a.width)&&!ha.Qq(a.height)?N.texImage2D(h,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b):(m(a,b,n,l,!1),a.rg=!0);k=a.rb;a.Fm||(N.bindTexture(h,k),N.generateMipmap(h),N.bindTexture(h,null));a.width=n;a.height=l}else if("ENVIRONMENT_MAP"==d)if(n=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],w){for(g=0;6>g;g++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+n[g][0]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b);a.width=3;a.height=
2}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){P.error('Cubemap Image "'+g+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}l=b.width/3;l>R.fj?(P.warn('Cubemap Image "'+g+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*R.fj+"x"+2*R.fj+". Reduced image size will be used."),g=z(R.fj/l*l),a.rg=!0):(g=z(l),!na.fc&&(3*g>R.Ec||2*g>R.Ec)&&(a.rg=!0));if(a.rg||na.BD)q(b,l,g,n);else{p=
b;k=g;f(N.TEXTURE_2D);N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,p);N.bindTexture(N.TEXTURE_2D,null);for(p=0;6>p;p++)N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,N.RGBA,k,k,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(a.mb,null);N.bindFramebuffer(N.FRAMEBUFFER,oa);for(p=0;6>p;p++)v.yU(a,N.TEXTURE_CUBE_MAP_POSITIVE_X+p,k,l,xa,p);N.bindFramebuffer(N.FRAMEBUFFER,null);N.bindTexture(a.mb,a.rb);N.texParameteri(a.mb,N.TEXTURE_MIN_FILTER,ia[na.vp]);N.texParameteri(a.mb,N.TEXTURE_MAG_FILTER,
N.LINEAR)}fa.DS()&&(P.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),q(b,l,M.DF,n));a.width=3*g;a.height=2*g;N.generateMipmap(h)}else"NODE_TEX"==d&&(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),N.texImage2D(h,0,N.RGBA,b.width,b.height,0,N.RGBA,N.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);N.bindTexture(h,null)}function c(a){a.Sa.G8=function(){A(a)}}function z(a){return ha.Qq(a)?ha.V(Math.pow(2,parseInt(a).toString(2).length),2,R.Ec):a}function L(b){var c;
switch(b.type){case a.Ih:c=N.RGBA;break;case a.ru:c=N.RGB;break;case a.kq:c=N.RGBA;break;case a.lq:c=N.RGB;break;case a.Bl:c=N.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}function D(b){var c;switch(b.type){case a.Ih:c=na.fc?N.RGBA8:N.RGBA;break;case a.ru:c=na.fc?N.RGB8:N.RGB;break;case a.kq:c=na.fc?N.RGBA8:N.RGBA;break;case a.lq:c=na.fc?N.RGB8:N.RGB;break;case a.Bl:c=na.fc?na.Wz?N.DEPTH_COMPONENT16:N.DEPTH_COMPONENT24:N.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}
function G(b){var c;switch(b.type){case a.Ih:c=N.UNSIGNED_BYTE;break;case a.ru:c=N.UNSIGNED_BYTE;break;case a.kq:c=N.FLOAT;break;case a.lq:c=N.FLOAT;break;case a.Bl:c=na.Wz?N.UNSIGNED_SHORT:N.UNSIGNED_INT;break;default:ha.q("Wrong texture type")}return c}function B(a){return a&&a.Se?!0:!1}function O(a){a.Sa?a.Sa.play():a.xd&&(a.Zs=!0);a.Bt=!1}function K(a){a.Sa?a.Sa.pause():a.xd&&(a.Zs=!1);a.Bt=!0}function E(a){a.Sa?a.Sa.currentTime=a.Tb/a.eh:a.xd&&(a.tj=Q(a,a.Tb),h(a))}function C(a){return a.Sa?
!a.Sa.paused:a.xd?a.Zs:!1}function Q(a,b){return Math.round(b*a.Xs/a.zk)}function k(a,b){if(aa.Ra(a))return p(a,b);for(var c=a.Gw,e=0;e<c.length;e++){var d=p(c[e],b);if(d)return d}return null}function p(a,b){var c=a.I;if(c.length)for(var c=c[0].X,e=0;e<c.length;e++){var d=c[e];if("MAIN"==d.type||"SKY"==d.type)for(var f=0;f<d.ya.length;f++)if(d.Qg[f]==b)return d.ya[f]}return null}function x(a,b,c){a=a.I;if(a.length){a=a[0].X;for(var e=0;e<a.length;e++){var d=a[e];if("MAIN"==d.type)for(var f=0;f<d.ya.length;f++)d.Qg[f]==
b&&(I(d.ya[f]),d.ya[f]=c,F(c))}}}function e(a,b){var c=a.I;if(c.length)for(var c=c[0].X,e=0;e<c.length;e++){var d=c[e];if("MAIN"==d.type)for(var f=0;f<d.ya.length;f++){var k=d.ya[f],h=d.Qg[f];-1==b.indexOf(h)&&"NODE_TEX"!=k.source&&b.push(h)}}}function w(a,b,c){var e=a.elements;a=a.interpolation;for(var d=0;d<b;d++){var f=d/(b-1),k=n(e,f,!0),h=ea(e,f,!0);if(k&&h)if("CONSTANT"==a)c.push.apply(c,k.color);else{var p=c,g=k,m=h;g==m?p.push.apply(p,g.color):(p.push(Z.xw(m.color[0],m.position,g.color[0],
g.position,f)),p.push(Z.xw(m.color[1],m.position,g.color[1],g.position,f)),p.push(Z.xw(m.color[2],m.position,g.color[2],g.position,f)),p.push(Z.xw(m.color[3],m.position,g.color[3],g.position,f)))}h&&!k&&c.push.apply(c,h.color);k&&!h&&c.push.apply(c,k.color)}}function n(a,b,c){for(var e=null,d=0;d<a.length;d++){var f=c?b-a[d].position:b-a[d][1][0];0<=f&&(e?f<=(c?b-e.position:b-a[d][1][0])&&(e=a[d]):e=a[d])}return e}function ea(a,b,c){for(var e=null,d=0;d<a.length;d++){var f=c?a[d].position-b:a[d][1][0]-
b;0<=f&&(e?f<=(c?e.position-b:e[1][0]-b)&&(e=a[d]):e=a[d])}return e}function I(a){0<a.Dk&&--a.Dk;0>=a.Dk&&(a.rb&&N.deleteTexture(a.rb),a=Y.indexOf(a),-1!=a&&Y.splice(a,1))}function F(a){a.Dk+=1}function T(a,b){for(var c=0;c<Y.length;c++){var e=Y[c];if(e.Yr==a&&e.type==b.type&&e.repeat==b.repeat&&e.anisotropic_filtering==b.anisotropic_filtering&&e.ml==b.ml)return e}return null}var M=g("__compat"),X=g("__config"),H=g("__texcomp"),fa=g("__debug"),V=g("__extensions"),P=g("__print"),W=g("__time"),ha=g("__util"),
v=g("__renderer"),aa=g("__obj_util"),Z=g("__curve"),ba=g("__vec3"),ya=g("__scenes"),na=X.B,R=X.Oi,ca=X.Y,ra=null,xa=null,oa=null;a.Ae=0;a.L=0;a.EQ=0;a.CQ=0;a.DQ=0;a.BQ=0;a.Ih=10;a.ru=20;a.kq=30;a.lq=40;a.Bl=50;a.pu=60;a.nu=70;a.qu=80;a.ou=90;a.hF=128;a.CO=128;a.MF=128;var Y=[],ua={},sa={},N=null,ia;a.Uf=function(b){ia=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Ae=b.NEAREST;a.L=b.LINEAR;a.EQ=b.NEAREST_MIPMAP_NEAREST;a.CQ=b.LINEAR_MIPMAP_NEAREST;
a.DQ=b.NEAREST_MIPMAP_LINEAR;a.BQ=b.LINEAR_MIPMAP_LINEAR;N=b};a.J5=function(a,b){return b in ua&&a in ua[b]?ua[b][a].dg:null};a.W$=function(a,b){return b in ua&&a in ua[b]?(r(ua[b][a]),!0):!1};a.tG=d;a.Zl=y;a.OH=function(b){var c=N.createTexture(),e=N.TEXTURE_CUBE_MAP;N.bindTexture(e,c);N.texParameteri(e,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(e,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(e,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(e,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);for(var d="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
f=0;6>f;f++)N.texImage2D(N[d[f]],0,N.RGBA,b,b,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(e,null);e=l();e.type=a.Ih;e.source="NONE";e.width=3*b;e.height=2*b;e.dr=1;e.rb=c;e.mb=N.TEXTURE_CUBE_MAP;return e};a.LD=function(a,b,c){if(!B(a)){var e=a.mb;N.bindTexture(e,a.rb);b&&N.texParameteri(e,N.TEXTURE_MIN_FILTER,b);c&&N.texParameteri(e,N.TEXTURE_MAG_FILTER,c);N.bindTexture(e,null)}};a.c6=function(b){if(B(b))return{min:a.Ae,EX:a.Ae};var c=b.mb;N.bindTexture(c,b.rb);b=N.getTexParameter(c,N.TEXTURE_MIN_FILTER);
var e=N.getTexParameter(c,N.TEXTURE_MAG_FILTER);N.bindTexture(c,null);return{min:b,EX:e}};a.resize=function(b,c,e){c=Math.max(c,na.yr?2:1);e=Math.max(e,na.yr?2:1);if(b.width!=c||b.height!=e){switch(b.type){case a.pu:N.bindRenderbuffer(N.RENDERBUFFER,b.Se);N.renderbufferStorage(N.RENDERBUFFER,N.RGB565,c,e);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.nu:N.bindRenderbuffer(N.RENDERBUFFER,b.Se);N.renderbufferStorage(N.RENDERBUFFER,N.DEPTH_COMPONENT16,c,e);N.bindRenderbuffer(N.RENDERBUFFER,null);
break;case a.qu:N.bindRenderbuffer(N.RENDERBUFFER,b.Se);N.renderbufferStorageMultisample(N.RENDERBUFFER,na.Fc,N.RGBA8,c,e);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.ou:N.bindRenderbuffer(N.RENDERBUFFER,b.Se);N.renderbufferStorageMultisample(N.RENDERBUFFER,na.Fc,N.DEPTH_COMPONENT24,c,e);N.bindRenderbuffer(N.RENDERBUFFER,null);break;default:var d=b.mb;N.bindTexture(d,b.rb);var f=L(b),k=D(b),h=G(b);N.texImage2D(d,0,k,c,e,0,f,h,null);N.bindTexture(d,null)}c>R.Ec||e>R.Ec?ha.q('Slink texture "'+
b.type+'" has unsupported size: '+c+"x"+e+". Max available: "+R.Ec+"x"+R.Ec+"."):(b.width=c,b.height=e)}};a.bU=function(b,c,e,f,k){var h=b.type,p=b.image,g=l();g.mA=b.uuid;g.type=a.Ih;g.width=1;g.height=1;var n=b.b4w_anisotropic_filtering;"DEFAULT"===n&&(n=c);"OFF"!==n&&na.anisotropic_filtering&&V.XI()&&(n=parseFloat(n.split("x")[0]),g.anisotropic_filtering=n);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)g.repeat=!1;if(p&&("IMAGE"==h&&"MOVIE"==p.source&&(g.Fm=!0,g.oy=b.name,g.va=b.frame_start,g.Tb=
b.frame_offset,g.jk=b.frame_duration,g.NE=b.use_auto_refresh,g.Ej=b.use_cyclic,g.zk=b.movie_length,g.ml=b.b4w_nla_video,0!=g.Tb&&P.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),c=ha.oj(k+p.filepath),c=T(c,g))){b.s=c;return}c=new Uint8Array([204,204,204,255]);switch(h){case "IMAGE":var n=N.createTexture(),m=N.TEXTURE_2D;N.bindTexture(m,n);N.texImage2D(m,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,c);break;case "NONE":n=N.createTexture();
m=N.TEXTURE_2D;N.bindTexture(m,n);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(e=ha.Gd("name",b.b4w_source_id,e)))g.wj=b.b4w_source_size,e.bg=e.bg||[],e.bg.push(g),F(g),N.texImage2D(m,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,c);else return;break;case "ENVIRONMENT_MAP":n=N.createTexture();m=N.TEXTURE_CUBE_MAP;N.bindTexture(m,n);e="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var q=0;6>q;q++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+
e[q]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,c);break;case "BLEND":return;default:P.error('texture "'+b.name+'" has unsupported type "'+h+'"');return}g.rb=n;g.mb=m;g.anisotropic_filtering&&N.texParameterf(g.mb,V.XI().TEXTURE_MAX_ANISOTROPY_EXT,g.anisotropic_filtering);"NONE"==h&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==h&&"MOVIE"==p.source?N.texParameteri(m,N.TEXTURE_MIN_FILTER,N.LINEAR):N.texParameteri(m,N.TEXTURE_MIN_FILTER,ia[na.vp]);N.texParameteri(m,N.TEXTURE_MAG_FILTER,
N.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==h?(h=b.b4w_source_id,e=b.b4w_source_size,g.gm=b.b4w_enable_canvas_mipmapping,g.gt=h,g.source="CANVAS",c=document.createElement("canvas"),c.width=e,c.height=e,g.dg=c.getContext("2d"),f in ua||(ua[f]={}),ua[f][h]=g,r(g)):"SCENE"==b.b4w_source_type&&"NONE"==h?(g.gt=b.b4w_source_id,g.source="SCENE"):(g.source=h,N.generateMipmap(m),N.bindTexture(m,null));p&&d(g,p,k);b.s=g};a.WN=A;a.VN=h;a.qt=t;a.fS=z;a.yo=function(a){return a&&(a.rb||a.Se)?!0:!1};a.xo=B;a.T7=
function(b){return b.type==a.kq||b.type==a.lq?!0:!1};a.gW=function(b){var c=0;switch(b.type){case a.Ih:case a.ru:c=4;break;case a.kq:case a.lq:c=16;break;case a.Bl:c=3;break;case a.pu:case a.nu:c=2;break;case a.qu:c=4*na.Fc;break;case a.ou:c=3*na.Fc}return c};a.ua=function(){if(!na.Ys)for(var a in sa)for(var b in sa[a])sa[a][b].Sa.pause(),sa[a][b].Sa.src="",sa[a][b].Sa.load();Y.length=0;ua={};sa={}};a.pause=function(){for(var a in sa)for(var b in sa[a]){var c=sa[a][b];C(c)&&K(c)}};a.reset=function(){for(var a in sa)for(var b in sa[a])E(sa[a][b])};
a.play=function(a){for(var b in sa)for(var c in sa[b]){var e=sa[b][c];a&&!e.Bt||O(e)}};a.k7=function(a,b){return b in sa&&a in sa[b]?sa[b][a]:null};a.eaa=function(a){return a.ml};a.uL=O;a.eD=K;a.RL=E;a.tZ=function(a,b){if(void 0 in sa&&a in sa[void 0]){var c=sa[void 0][a];c.Sa?c.Sa.currentTime=b/c.eh:c.xd&&(c.tj=b,h(c))}};a.rO=C;a.sO=function(a){return a.Sa||a.xd?a.Sa?2<=a.Sa.readyState:!0:0};a.oO=function(a){return a.Sa||a.xd?a.Sa?Math.round(a.Sa.currentTime*a.eh):a.tj:0};a.qO=function(a){return a.Sa||
a.xd?a.Sa?a.Tb:Q(a,a.Tb):0};a.T0=function(a){if(!a.Sa&&!a.xd)return 0;var b=Math.min(a.jk,a.zk-a.Tb);return a.Sa?a.Tb+b:Q(a,a.Tb+b)};a.tx=function(a,b){return Math.round(b*a.Ws*(W.sd()/a.eh))};a.pO=function(a){return Math.min(a.jk,a.zk-a.Tb)};a.S0=Q;a.K5=function(a,b){var c=k(a,b);return c&&"CANVAS"==c.source?c.dg:null};a.X$=function(a,b){var c=k(a,b);return c&&"CANVAS"==c.source?(r(c),!0):!1};a.Y6=k;a.Z6=function(a){var b=[];if(aa.Ra(a))e(a,b);else{a=a.Gw;for(var c=0;c<a.length;c++)e(a[c],b)}return b};
a.XZ=function(a){for(var b={},c=0;c<a.length;c++){for(var e=a[c].ya,d=a[c].Od,f=[],k=[],h=0;h<e.length;h++){var p=e[h],g=d[h];if("CANVAS"==p.source)if(g in b)p=b[g];else{var n=e[h],p=l();p.source="CANVAS";p.width=n.width;p.height=n.height;p.gm=n.gm;p.type=n.type;n=document.createElement("canvas");n.width=p.width;n.height=p.height;p.dg=n.getContext("2d");p.mb=N.TEXTURE_2D;p.rb=N.createTexture();N.bindTexture(N.TEXTURE_2D,p.rb);p.gm?N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,ia[na.vp]):N.texParameteri(N.TEXTURE_2D,
N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR);N.bindTexture(N.TEXTURE_2D,null);n=p;n.dg.drawImage(e[h].dg.canvas,0,0);r(n);b[g]=p}f.push(p);k.push(g)}a[c].ya=f}};a.PU=function(a,b){for(var c=[],e=0;e<a.length;e++)w(a[e].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ha.V(255*a,0,255)}))};a.aS=w;a.TU=function(a,b){for(var c=new Float32Array(3),e=new Float32Array(3),d=[],f=0;f<a.length;f++){for(var k=a[f].data.value,h=[],p=k.curve_mapping.curves_data,
g=k.curve_mapping.curve_extend,m=k.curve_mapping.curves_handle_types,k=0;k<p.length;k++){for(var q=g[k],l=p[k],v=[],w=m[k],H=0;H<l.length;H++)v.push([new Float32Array(3),new Float32Array(l[H].concat(0)),new Float32Array(3)]);Z.rA(v[0],null,v[1],w[0],w[0]);for(H=1;H<v.length-1;H++)Z.rA(v[H],v[H-1],v[H+1],w[H],w[H]);Z.rA(v[v.length-1],v[v.length-2],null,w[v.length-1],w[v.length-1]);if(2<v.length){if("AUTO"==w[0]){ba.subtract(v[0][2],v[0][1],c);H=ba.length(c);ba.copy(v[1][0],e);e[0]<v[0][1][0]&&(e[0]=
v[0][1][0]);ba.subtract(e,v[0][1],e);var r=ba.length(e);1E-8<r&&(ba.scale(e,H/r,e),ba.add(v[0][1],e,v[0][2]),ba.subtract(v[0][1],e,v[0][0]))}l=v.length-1;"AUTO"==w[0]&&(ba.subtract(v[l][0],v[l][1],c),H=ba.length(c),ba.copy(v[l-1][2],e),e[0]>v[l][1][0]&&(e[0]=v[l][1][0]),ba.subtract(e,v[l][1],e),r=ba.length(e),1E-8<r&&(ba.scale(e,H/r,e),ba.add(v[l][1],e,v[l][0]),ba.subtract(v[l][1],e,v[l][2])))}for(l=0;l<v.length-1;l++)Z.ZS(v[l][1],v[l][2],v[l+1][0],v[l+1][1]);l=[];3>=p.length?(H=Math.round(-b/2),
w=Math.round(b/2)):(H=0,w=b);for(;H<w;H++){var r=H/(w-1),x=n(v,r,!1),u=ea(v,r,!1);x&&u?l.push(Z.QG(r,x[1],x[2],u[0],u[1],.001)):u&&!x?"EXTRAPOLATED"==q?(r=u[1][0]==u[2][0]?u[1][1]:Z.IK(r,u[1],u[2]),l.push(r)):l.push(u[1][1]):x&&!u&&("EXTRAPOLATED"==q?(r=x[0][0]==x[1][0]?x[1][1]:Z.IK(r,x[0],x[1]),l.push(r)):l.push(x[1][1]))}h.push(l)}d.push(h)}c=[];for(H=0;H<d.length;H++)for(h=d[H],k=0;k<h[0].length;k++)3>=h.length?(e=ha.V(127.5*(h[0][k]+1),0,255),f=ha.V(127.5*(h[1][k]+1),0,255),p=ha.V(127.5*(h[2][k]+
1),0,255),l=255):(e=ha.V(255*h[0][k],0,255),f=ha.V(255*h[1][k],0,255),p=ha.V(255*h[2][k],0,255),l=ha.V(255*h[3][k],0,255)),c.push(e,f,p,l);return new Uint8Array(c)};a.NH=function(b,c){var e=y(a.Ih,!1);e.source="NODE_TEX";e.repeat=!1;t(e,{width:c,height:b.length/(4*c),data:b});return e};a.K3=function(a,c,e,d,f){var k=ha.oj(f);if("WORLD"!=a.type){var h=T(k,c);if(!h){h=l();h.type=c.type;h.source=c.source;h.gt=c.gt;h.width=c.width;h.height=c.height;h.dr=c.dr;h.wj=c.wj;h.gm=c.gm;h.dg=c.dg;h.mb=c.mb;h.rb=
c.rb;h.Se=c.Se;h.Fm=c.Fm;h.Dt=c.Dt;h.Sa=c.Sa;h.oy=c.oy;h.zk=c.zk;h.eh=c.eh;h.va=c.va;h.Tb=c.Tb;h.jk=c.jk;h.rg=c.rg;h.xh=c.xh;h.xd=c.xd;h.Xs=c.Xs;h.Ws=c.Ws;h.tj=c.tj;h.Zs=c.Zs;h.Uk=c.Uk;h.Bt=c.Bt;h.NE=c.NE;h.Ej=c.Ej;h.ml=c.ml;h.repeat=c.repeat;h.qo=c.qo;h.Yr=c.Yr;h.ro=c.ro;h.eC=c.eC;h.dC=c.dC;h.gw=c.gw;h.xm=c.xm;var p=h;N.bindTexture(c.mb,c.rb);var g=N.getTexParameter(c.mb,N.TEXTURE_MAG_FILTER),n=N.getTexParameter(c.mb,N.TEXTURE_MIN_FILTER),m=N.getTexParameter(c.mb,N.TEXTURE_WRAP_S);c=N.getTexParameter(c.mb,
N.TEXTURE_WRAP_T);p.rb=N.createTexture();N.bindTexture(p.mb,p.rb);N.texParameteri(p.mb,N.TEXTURE_MAG_FILTER,g);N.texParameteri(p.mb,N.TEXTURE_MIN_FILTER,n);N.texParameteri(p.mb,N.TEXTURE_WRAP_S,m);N.texParameteri(p.mb,N.TEXTURE_WRAP_T,c);N.bindTexture(p.mb,null);b(h,f,k);Y.push(h);t(h,d,0)}d=h;if(aa.Ra(a))x(a,e,d);else for(a=a.Gw,f=0;f<a.length;f++)x(a[f],e,d)}else h=c,b(h,f),t(h,d,0),ya.A0(a)};a.tD=I;a.hw=F;a.le=function(a){return a.texture.s};a.WY=function(){N=null};a.pJ=function(){return Y}};b4w.module.__texcomp=function(a,g){function l(a,b,d,c){var g=new Int32Array(d,0,31),l,D,A,B,O,K;if(542327876!=g[0])return r.error("Invalid magic number in DDS header"),0;if(!g[20]&4)return r.error("Unsupported format, must contain a FourCC code"),0;l=g[21];switch(l){case h:D=8;A=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case u:D=16;A=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case m:D=16;A=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return r.error("Unsupported FourCC code:",y(l)),null}K=
1;g[2]&131072&&!1!==c&&(K=Math.max(1,g[7]));B=g[4];O=g[3];g=g[1]+4;if(b)for(l=0;l<K;++l)c=Math.max(4,B)/4*Math.max(4,O)/4*D,b=new Uint8Array(d,g,c),a.compressedTexImage2D(a.TEXTURE_2D,l,A,B,O,0,b),g+=c,B=Math.max(.5*B,1),O=Math.max(.5*O,1);else if(l==h){Math.max(4,B);Math.max(4,O);d=b=new Uint16Array(d);D=g/2;A=B;var E=O,g=new Uint16Array(4);b=new Uint16Array(A*E);for(var C=0,Q=0,k=Q=C=l=0,p=0,x=0,e=0,w=A/4,E=E/4,n=0;n<E;n++)for(var ea=0;ea<w;ea++)l=D+4*(n*w+ea),g[0]=d[l],g[1]=d[l+1],C=g[0]&31,Q=
g[0]&2016,k=g[0]&63488,p=g[1]&31,x=g[1]&2016,e=g[1]&63488,g[2]=5*C+3*p>>3|5*Q+3*x>>3&2016|5*k+3*e>>3&63488,g[3]=5*p+3*C>>3|5*x+3*Q>>3&2016|5*e+3*k>>3&63488,C=d[l+2],Q=4*n*A+4*ea,b[Q]=g[C&3],b[Q+1]=g[C>>2&3],b[Q+2]=g[C>>4&3],b[Q+3]=g[C>>6&3],Q+=A,b[Q]=g[C>>8&3],b[Q+1]=g[C>>10&3],b[Q+2]=g[C>>12&3],b[Q+3]=g[C>>14],C=d[l+3],Q+=A,b[Q]=g[C&3],b[Q+1]=g[C>>2&3],b[Q+2]=g[C>>4&3],b[Q+3]=g[C>>6&3],Q+=A,b[Q]=g[C>>8&3],b[Q+1]=g[C>>10&3],b[Q+2]=g[C>>12&3],b[Q+3]=g[C>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,B,O,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);c&&a.generateMipmap(a.TEXTURE_2D)}else return r.error("No manual decoder for",y(l),"and no native support"),0;return K}function d(a,b,d,c,h){var g=new XMLHttpRequest;g.open("GET",d,!0);g.responseType="arraybuffer";g.onload=function(){if(200==g.status){a.bindTexture(a.TEXTURE_2D,c);var d=l(a,b,g.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<d?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}h&&h(c)};g.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function y(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var r=g("__print"),A=g("__util"),h=b("DXT1"),u=b("DXT3"),m=b("DXT5");a.E0=l;a.F0=function(a,b,d){var c=new Uint32Array(d,0,13);if(55727696==c[0]){var h=c[7],g=c[6],m=c[11],l=52+c[12];switch(c[2]){case 0:var r=2,u=1;break;case 1:r=2;u=3;break;case 2:r=4;u=0;break;case 3:r=4;u=2;break;default:A.q("Unsupported PVR V3 format.")}}else if(559044176==
c[11]){h=c[2];g=c[1];m=c[3];l=c[0];m++;var y=c[4]&255,c=0<c[10];25==y?(r=4,u=c?2:0):24==y?(r=2,u=c?3:1):A.q("Unsupported PVR V2 format.")}else A.q("Unsupported PVR version.");y=2==r?8:4;c=4;switch(u){case 0:var E=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:E=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:E=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:E=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=y*c*r/8;for(r=0;r<m;r++){var u=Math.max(h>>r,1),C=Math.max(g>>r,1),Q=u/y,k=C/c;2>Q&&(Q=2);2>k&&(k=2);Q=
Q*k*b;k=new Uint8Array(d,l,Q);a.compressedTexImage2D(a.TEXTURE_2D,r,E,u,C,0,k);l+=Q}};a.VJ=function(a,b){switch(b){case "dds":var d=new Int32Array(a,0,31);return{width:d[4],height:d[3]};case "pvr":d=new Uint32Array(a,0,13);if(55727696==d[0])var c=d[7],d=d[6];else c=d[2],d=d[1];return{width:c,height:d}}};a.HV=function(a,b){var d=1;if("dds"==b){var c=new Int32Array(a,0,31),g=c[21];switch(g){case h:d=6;break;case u:case m:d=4;break;default:r.error("Unsupported FourCC code:",y(g))}}else if("pvr"==b)if(c=
new Uint32Array(a,0,13),55727696==c[0])switch(c[2]){case 0:d=12;break;case 1:d=16;break;case 2:d=6;break;case 3:d=8}else g=c[4]&255,c=0<c[10],25==g?d=c?8:6:24==g&&(d=c?16:12);return d};a.j8=function(a,b,h,c){var g=a.createTexture();d(a,b,h,g,c);return g}};b4w.module.__time=function(a,g){function l(){return-1!==d.Gl.yv?d.Gl.yv:m}var d=g("__config");g("__print");var b=0,y=0,r=[],A=0,h=0,u=[],m=-1;a.CM=function(a){b=a;y=performance.now();for(a=0;a<r.length;a++){var d=r[a];b>d.uB&&(r.splice(a,1),a--,d.callback())}for(a=0;a<u.length;a++){var d=u[a],h=1-(d.uB-b)/d.duration,h=Math.min(h,1);d.callback(d.from+h*(d.to-d.from));1==h&&(u.splice(a,1),a--)}};a.mk=function(){return b};a.Fx=function(a,d){var h;A++;h=A;r.push({id:h,callback:a,uB:b+(performance.now()-
y+d)/1E3});return h};a.Sn=function(a){for(var b=0;b<r.length;b++)if(r[b].id==a){r.splice(b,1);break}};a.Rn=function(a){for(var b=u.length;b--;)if(u[b].id==a){u.splice(b,1);break}};a.Pj=function(a,d,g,c){g/=1E3;var m;h++;m=h;u.push({id:m,callback:c,from:a,to:d,uB:b+g,duration:g});c(a);return m};a.reset=function(){y=b=0;r.length=0;h=A=u.length=0};a.sd=l;a.uZ=function(a){m=a};a.oo=function(a){return a*l()}};b4w.module.__curve=function(a,g){function l(a,b,d,f,h){var c=f.length;h||(h=new Float32Array(c));for(var g=c+a,l=new Float32Array(g),r=1;r<=g-1;r++)l[r-1]=b>=d[r-1]&&b<d[r+1-1]?1:0;for(var y=2;y<=a;y++)for(r=1;r<=g-y;r++)l[r-1]=(0!=l[r-1]?(b-d[r-1])*l[r-1]/(d[r+y-1-1]-d[r-1]):0)+(0!=l[r+1-1]?(d[r+y-1]-b)*l[r+1-1]/(d[r+y-1]-d[r+1-1]):0);b==d[g-1]&&(l[c-1]=1);a=0;for(r=1;r<=c;r++)a+=l[r-1]*f[r-1];for(r=1;r<=c;r++)h[r-1]=0!=a?l[r-1]*f[r-1]/a:0;return h}function d(a){a=a.vw;return a[a.length-1]}function b(a){a=
a.dI;return a[a.length-1]}function y(a,b,d,f,h,c,g,l){var D=a+(b-a)/2,A=r(D,f,h,c,g)-d;l=l?l:.01;return Math.abs(A)<l?D:0<A?y(a,D,d,f,h,c,g,l):y(D,b,d,f,h,c,g,l)}function r(a,b,d,f,h){var c=1-a;return b*c*c*c+3*d*c*c*a+3*f*c*a*a+h*a*a*a}g("__print");var A=g("__util"),h=g("__vec3");a.CT=function(a){var b={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var f=a.order_u;b.Fk=f;a=a.points;var h=a.length/5,c=[],g=h+f,h=h+2;c[0]=0;for(var r=2;r<=g;r++)c[r-1]=r>f&&r<h?c[r-
2]+1:c[r-2];b.vw=c;"2D"==d.dimensions?b.tk=!1:"3D"==d.dimensions?b.tk=!0:A.q("Wrong curve dimensions");f=[];c=[];for(d=0;d<a.length;d+=5)f.push(a[d]),f.push(a[d+1]),f.push(a[d+2]),b.tk&&f.push(a[d+3]),c.push(a[d+4]);b.LA=f;b.YE=c;a=[];for(var d=b.LA,f=b.tk?4:3,c=b.YE,g=b.vw,h=b.Fk,r=d.length/f,y=r+h,G=0,B=g[y-1]/999,O=0;1E3>O;O++){5E-6>g[y-1]-G&&(G=g[y-1]);for(var K=l(h,G,g,c),E=0;E<f;E++)for(var C=a[f*O+E]=0;C<r;C++)a[f*O+E]+=K[C]*d[f*C+E];G+=B}f=b.tk?4:3;c=new Float32Array(1E3);c[0]=0;for(d=1;1E3>
d;d+=1)g=a[(d-1)*f],h=a[(d-1)*f+1],r=a[(d-1)*f+2],y=a[d*f],G=a[d*f+1],B=a[d*f+2],c[d]=c[d-1]+Math.sqrt((y-g)*(y-g)+(G-h)*(G-h)+(B-r)*(B-r));b.dI=c;return b};a.q_=function(a,b,h){h||(h=[]);var f=b,g=Math.max(f,0);b=g=Math.min(f,d(a));var f=a.LA,g=a.tk?4:3,c=a.YE,r=a.vw,y=a.Fk;a=f.length/g;var D=a+y;5E-6>r[D-1]-b&&(b=r[D-1]);D=new Float32Array(a);l(y,b,r,c,D);for(b=0;b<g;b++)for(c=h[b]=0;c<a;c++)h[b]+=D[c]*f[g*c+b]};a.n_=function(a,b,d){d||(d=[]);var f=a.LA,h=a.tk?4:3,c=a.YE,g=a.vw,l=a.Fk;a=f.length/
h;var r=a+l;5E-6>g[r-1]-b&&(b=g[r-1]);var r=new Float32Array(a),y=b;b=r;var B=c.length;b||(b=new Float32Array(B));var A=new Float32Array(B),K=new Float32Array(B),E=A,C=K;E||(E=new Float32Array(B));C||(C=new Float32Array(B));for(var Q=B+l,k=new Float32Array(Q),p=new Float32Array(Q),x=1;x<=Q-1;x++)k[x-1]=y>=g[x-1]&&y<g[x+1-1]?1:0;y==g[Q-1]&&(k[B-1]=1);for(var e=2;e<=l;e++)for(x=1;x<=Q-e;x++){var w=0!=k[x-1]?k[x-1]/(g[x+e-1-1]-g[x-1]):0,n=0!=k[x+1-1]?-k[x+1-1]/(g[x+e-1]-g[x+1-1]):0,ea=0!=p[x-1]?(y-g[x-
1])*p[x-1]/(g[x+e-1-1]-g[x-1]):0,I=0!=p[x+1-1]?(g[x+e-1]-y)*p[x+1-1]/(g[x+e-1]-g[x+1-1]):0;k[x-1]=(0!=k[x-1]?(y-g[x-1])*k[x-1]/(g[x+e-1-1]-g[x-1]):0)+(0!=k[x+1-1]?(g[x+e-1]-y)*k[x+1-1]/(g[x+e-1]-g[x+1-1]):0);p[x-1]=w+n+ea+I}for(x=1;x<=B;x++)E[x-1]=k[x-1],C[x-1]=p[x-1];g=0;for(l=1;l<=B;l++)g+=A[l-1]*c[l-1];y=0;for(l=1;l<=B;l++)y+=K[l-1]*c[l-1];for(l=1;l<=B;l++)b[l-1]=0!=g?K[l-1]*c[l-1]/g+A[l-1]*c[l-1]*y/(g*g):0;for(c=0;c<h;c++)for(g=d[c]=0;g<a;g++)d[c]+=r[g]*f[h*g+c]};a.o$=d;a.p_=b;a.o_=function(a,
h){if(0>=h)return 0;var g=d(a);if(h>=b(a))return g;var f=a.dI,l=A.Fu(f,h,0,f.length-1);return g*(l+(h-f[l])/(f[l+1]-f[l]))/1E3};a.xw=function(a,b,d,f,h){return d+(h-f)*(a-d)/(b-f)};a.IK=function(a,b,d){var f=b[0];b=b[1];d=(d[1]-b)/(d[0]-f);return d*a+(b-d*f)};a.QG=function(a,b,d,f,h,c){return r(y(0,1,a,b[0],d[0],f[0],h[0],c),b[1],d[1],f[1],h[1])};a.rA=function(a,b,d,f,g){var c=new Float32Array(3),l=new Float32Array(3),r=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(3),B=new Float32Array(3);
h.copy(a[1],l);null==b?(h.copy(d[1],r),c[0]=2*l[0]-r[0],c[1]=2*l[1]-r[1]):h.copy(b[1],c);null==d?(h.copy(b[1],c),r[0]=2*l[0]-c[0],r[1]=2*l[1]-c[1]):h.copy(d[1],r);h.subtract(l,c,y);h.subtract(r,l,A);b=h.length(y);d=h.length(A);0==b&&(b=1);0==d&&(d=1);if("AUTO"==f||"AUTO"==g)B[0]=A[0]/d+y[0]/b,B[1]=A[1]/d+y[1]/b,c=2.5614*h.length(B),0!=c&&("AUTO"==f&&h.scaleAndAdd(l,B,-(b/c),a[0]),"AUTO"==g&&h.scaleAndAdd(l,B,d/c,a[2]));"VECTOR"==f&&h.scaleAndAdd(l,y,-1/3,a[0]);"VECTOR"==g&&h.scaleAndAdd(l,A,1/3,a[2])};
a.ZS=function(a,b,d,f){var h=[],c=[],g,l,r;h[0]=a[0]-b[0];h[1]=a[1]-b[1];c[0]=f[0]-d[0];c[1]=f[1]-d[1];r=f[0]-a[0];g=Math.abs(h[0]);l=Math.abs(c[0]);0!=g+l&&g+l>r&&(g=r/(g+l),b[0]=a[0]-g*h[0],b[1]=a[1]-g*h[1],d[0]=f[0]-g*c[0],d[1]=f[1]-g*c[1])}};b4w.module.__sfx=function(a,g){function l(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return B.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;B.warn("deprecated WebAudio implementation");return null}B.warn("WebAudio is not supported");return null}function d(a,c,e){var d=a.Y;if("NONE"!=d.behavior){var f=d.loop,k=d.pitch;if(d.src&&(f||0<=e)){d.dA=Math.floor(5E4*Math.random());var g=I.currentTime+c,g=
Math.max(0,g);d.rf=g;d.state=20;var p=F.Rc;"POSITIONAL"==d.behavior&&"none"==p.ur&&(d.behavior="BACKGROUND_SOUND");b(a,F.Rc);if("POSITIONAL"==d.behavior||"BACKGROUND_SOUND"==d.behavior){c=I.createBufferSource();c.buffer=d.src;c.playbackRate.value=k;if(f){d.ec&&d.ec.disconnect();d.Nd&&d.Nd.disconnect();c.loop=!0;c.loopStart=d.LK;if(c.loopEnd=d.Aw)e=I.createBufferSource(),e.buffer=d.src,e.playbackRate.value=k,d.Nd=e,e.connect(d.Id);c.start(g);d.duration=0}else f=c.buffer?c.buffer.duration:0,e>f?(f=
g+e+d.Kf,c.loop=!0,c.start(g),c.stop(f),d.duration=e):(c.loop=!1,c.start(g),d.duration=f);c.connect(d.Id);d.ec=c;r(d);A(d);h(d)}else"BACKGROUND_MUSIC"==d.behavior&&(K.Sn(d.eA),K.Sn(d.fA),e=function(){var b=a.Y,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.ec=b.ec||I.createMediaElementSource(c),b.ec.connect(b.Id),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?e():d.eA=K.Fx(e,1E3*c),d.duration=f?0:D(a));u(d,g)}}}function b(a,b){var c=a.Y;if(!c.Id){var e=E.F(a.k.n),d=E.P(a.k.n);if(p.Iw){var f=
I.createBiquadFilter();f.type="peaking"}else f=null;var h=I.createGain();switch(c.behavior){case "POSITIONAL":var k=I.createPanner();"string"!=typeof k.panningModel?(k.panningModel=k.EQUALPOWER,k.distanceModel=k.INVERSE_DISTANCE):(k.panningModel="equalpower",k.distanceModel=b.ur);k.setPosition(e[0],e[1],e[2]);Q.copy(e,c.rC);e=x;C.mc(d,C.Nc,e);k.setOrientation(e[0],e[1],e[2]);k.refDistance=c.sr;k.maxDistance=c.Zg;k.rolloffFactor=c.wq;k.coneInnerAngle=c.HH;k.coneOuterAngle=c.IH;k.coneOuterGain=c.JH;
var g=I.createGain();g.gain.value=L(c);f?(k.connect(f),f.connect(g)):k.connect(g);g.connect(h);c.Id=k;if(c.vn){var n=I.createGain();h.connect(n);n.connect(b.Id)}else n=null,h.connect(b.Id);break;case "BACKGROUND_SOUND":k=null;g=I.createGain();g.gain.value=L(c);f?(c.Id=f,f.connect(g)):c.Id=g;g.connect(h);c.vn?(n=I.createGain(),h.connect(n),n.connect(b.Id)):(n=null,h.connect(b.Id));break;case "BACKGROUND_MUSIC":n=k=null,g=I.createGain(),g.gain.value=L(c),f?(c.Id=f,f.connect(g)):c.Id=g,g.connect(h),
h.connect(b.Id)}c.cD=k;c.dh=f;c.mo=g;c.ik=h;c.qD=n}}function y(a){var b=a.Y,c=b.duration,b=b.delay+b.mI*Math.random();d(a,b,c)}function r(a){var b=a.Nd||a.ec;C.ci(b.onended)&&(b.onended=function(){a.state=50})}function A(a){a.vn&&a.qD.gain.cancelScheduledValues(a.rf);a.Oo&&(a.ec.playbackRate.cancelScheduledValues(a.rf),a.Nd&&a.Nd.playbackRate.cancelScheduledValues(a.rf));a.Ct=a.rf}function h(a){if(a.vn||a.Oo){var b=a.qD,c=a.ec,e=c.buffer?c.buffer.duration:0;if(e){var d=a.rf;M[0]=a.dA;for(var f=0;5>
f;){var h=a.pitch+a.Oo*C.yg(M);if(d>=a.Ct){if(a.vn){var k=1-C.V(a.vn,0,1)*Math.random();b.gain.setValueAtTime(k,d)}a.Oo&&(c.playbackRate.setValueAtTime(h,d),a.Nd&&a.Nd.playbackRate.setValueAtTime(h,d));f++}d+=e/h}a.Ct=d-.001}}}function u(a,b){if(a.hm||a.Kf){var c=a.ik;c.gain.cancelScheduledValues(b);a.hm?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.hm)):c.gain.setValueAtTime(1,b);a.Kf&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+
a.Kf))}}function m(a){"SPEAKER"!=a.type&&C.q("Wrong object type");var b=a.Y;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.ik,e=I.currentTime;b.Kf&&(c.gain.setValueAtTime(c.gain.value,e),c.gain.linearRampToValueAtTime(0,e+b.Kf));"BACKGROUND_MUSIC"==b.behavior?b.src&&(K.Sn(b.eA),K.Sn(b.fA),b.fA=K.Fx(function(){var b=a.Y.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Kf)):(c=b.ec,b.duration<c.buffer.duration?b.Kf&&20==b.state?c.stop(e+b.Kf):20==b.state&&(c.stop(0),c.disconnect()):
c.disconnect(),b.rf=0,b.dD=0,b.oA=0);b.state=30}}function q(a){a=a.Y;if(20==a.state){var b=I.currentTime;a.dD=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.oA=b>a.rf?f(a,b):0,a.ec.onended=function(){},a.ec.stop(0),a.ec.disconnect(),A(a));a.state=40}}function f(a,b){M[0]=a.dA;for(var c=a.ec.buffer.duration,e=a.rf,d;e<b;)d=a.pitch+a.Oo*C.yg(M),e+=c/d;return(c/d-(e-b))*d}function t(a){var b=a.Y;if(40==b.state){var c=I.currentTime;b.rf+=c-b.dD;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();
else{a=a.Y;var e=I.createBufferSource();e.loop=a.ec.loop;e.loopStart=a.ec.loopStart;e.loopEnd=a.ec.loopEnd;e.buffer=a.ec.buffer;e.playbackRate.value=a.ec.playbackRate.value;e.connect(a.Id);a.ec=e;a.Nd&&(e=I.createBufferSource(),e.loop=a.Nd.loop,e.buffer=a.Nd.buffer,e.playbackRate.value=a.Nd.playbackRate.value,e.connect(a.Id),a.Nd=e);b.Ct=c;c=b.ec;r(b);c.start(b.rf,b.oA);h(b)}u(b,b.rf);b.state=20}}function c(a,b,c){var e=1,e=b.xU;if(0<e){var d=b.l_;if(0!=Q.dot(a.ny,a.ny)||0!=Q.dot(b.Lm,b.Lm)){var f=
Q.subtract(a.rC,b.ei,x),h=Q.length(f);b=Q.dot(f,b.Lm)/h;f=Q.dot(f,a.ny)/h;f=-f;h=d/e;b=Math.min(-b,h);f=Math.min(f,h);e=(d-e*b)/(d-e*f);isFinite(e)||(e=0);e=Math.min(e,16);e=Math.max(e,.125);e=C.Zb(e,a.EK,c,.3);a.ec.playbackRate.value=e;a.EK=e}}}function z(a){a=a.Y;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function L(a){return a.muted?0:a.volume}function D(a){a=a.Y;return(a=a.src)?a.duration:0}var G=g("__config"),B=g("__print"),O=g("__quat"),K=g("__time"),E=g("__tsr"),C=g("__util"),
Q=g("__vec3"),k=G.B,p=G.Y,x=new Float32Array(3),e=new Float32Array(3);new Float32Array(3);var w=O.create(),n=[],ea=[],I=null,F=null,T=[],M=[1],X=null;a.dF=10;a.Dy=20;a.cF=30;a.zT=function(){return{Fj:-1,bh:"",behavior:"NONE",muted:!1,volume:1,pitch:1,wq:1,sr:1,Zg:1E4,HH:360,IH:360,JH:1,autoplay:!1,Ee:!1,loop:!1,LK:0,Aw:0,delay:0,mI:0,vn:0,Oo:0,hm:0,Kf:0,rf:0,dD:0,oA:0,duration:0,Ct:0,dA:1,src:null,state:10,rC:new Float32Array(3),ny:new Float32Array(3),qv:!1,EK:1,eA:-1,fA:-1,em:0,Id:null,ec:null,Nd:null,
cD:null,dh:null,mo:null,ik:null,qD:null,kl:0}};a.hh=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(n.push("ogg"),n.push("ogv"),n.push("oga")),""!=a.canPlayType("audio/mpeg")&&n.push("mp3"),""!=a.canPlayType("audio/mp4")&&(n.push("mp4"),n.push("m4v"),n.push("m4a")),""!=a.canPlayType("audio/webm")&&n.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(ea.push("ogv"),ea.push("ogg"),ea.push("oga")),""!=b.canPlayType("video/mp4")&&
(ea.push("m4v"),ea.push("mp4")),""!=b.canPlayType("video/webm")&&ea.push("webm"),""!=b.canPlayType("video/mpeg")&&ea.push("mp3"))};a.GR=function(a){p.XE&&!I&&(I=l())&&B.log("%cINIT WEBAUDIO: "+I.sampleRate+"Hz","color: #00a");if(I){var b={ei:new Float32Array(3),Lm:new Float32Array(3),kl:0},c=I.createGain(),e=I.createGain();b.mo=c;b.ik=e;c.connect(e);e.connect(I.destination);if(a.b4w_enable_dynamic_compressor){var e=I.createDynamicsCompressor(),d=a.b4w_dynamic_compressor_settings;e.threshold.value=
d.threshold;e.knee.value=d.knee;e.ratio.value=d.ratio;e.attack.value=d.attack;e.release.value=d.release;e.connect(c);b.er=e;b.Id=e}else b.er=null,b.Id=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.ur="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.ur="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.ur="exponential";break;case "NONE":b.ur="none";break;default:C.q("Wrong audio distance model")}b.xU=a.audio_doppler_factor;b.l_=a.audio_doppler_speed;b.muted=!1;
b.volume=a.audio_volume;c.gain.value=L(b);b.em=0}else b=null;a.Rc=b};a.iZ=function(a){F=a};a.qU=function(a){a||(a="ogg");return-1<n.indexOf(a)?a:-1<n.indexOf("m4a")?"m4a":-1<n.indexOf("oga")?"oga":""};a.sU=function(a){a||(a="webm");return-1<ea.indexOf(a)?a:-1<ea.indexOf("m4v")?"m4v":-1<ea.indexOf("webm")?"webm":""};a.ll=function(a,b){var c=a.data,e=b.Y;e.Fj=a.data.sound.uuid;e.bh=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":e.behavior=I?c.b4w_behavior:"NONE";
break;case "BACKGROUND_MUSIC":var d;I?(window.MediaElementAudioSourceNode?d=!0:(B.warn("MediaElementAudioSourceNode not found"),d=!1),d=d&&!k.xH?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):d="NONE";e.behavior=d;break;default:C.q("Wrong speaker behavior")}c.sound||(e.behavior="NONE");e.qv=c.b4w_enable_doppler;e.muted=c.muted;e.volume=c.volume;e.pitch=c.pitch;e.wq=c.attenuation;e.sr=c.distance_reference;e.Zg=c.distance_max||1E4;e.HH=c.cone_angle_inner;e.IH=c.cone_angle_outer;e.JH=c.cone_volume_outer;e.autoplay=
c.b4w_auto_play;e.Ee=c.b4w_cyclic_play;e.loop=c.b4w_loop;e.LK=c.b4w_loop_start;e.Aw=c.b4w_loop_end;e.delay=c.b4w_delay;e.mI=c.b4w_delay_random;e.vn=c.b4w_volume_random;e.Oo=c.b4w_pitch_random;e.hm=c.b4w_fade_in;e.Kf=c.b4w_fade_out;T.push(b)};a.ZM=function(b){"SPEAKER"!=b.type&&C.q("Wrong object type");switch(b.Y.behavior){case "POSITIONAL":return a.Dy;case "BACKGROUND_SOUND":return a.Dy;case "BACKGROUND_MUSIC":return a.cF;case "NONE":return a.dF;default:C.q("Wrong speaker behavior")}};a.B0=function(a,
b){var c=a.Y;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:C.q("Wrong speaker behavior")}};a.tL=function(){var a=I.createBufferSource();a.buffer=I.createBuffer(1,22050,22050);a.connect(I.destination);a.start(0)};a.oU=function(a,b,c){I?I.decodeAudioData(a,b,c):c()};a.i_=function(a){m(a);a.Y=null;T.splice(T.indexOf(a),1)};a.ua=function(){for(var a=0;a<T.length;a++){var b=T[a].Y;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():
(b.ec&&b.ec.disconnect(),b.Nd&&b.Nd.disconnect())}F&&F.Rc&&(a=F.Rc,a.ei[0]=0,a.ei[1]=0,a.ei[2]=0,a.Lm[0]=0,a.Lm[1]=0,a.Lm[2]=0);F=null;T.splice(0);X=null};a.update=function(a){if(I&&0!=T.length){for(var b=0;b<T.length;b++){var c=T[b],e=c.Y,d=e.ec,f=I.currentTime;!e.loop&&20==e.state&&e.duration&&e.rf+e.duration<f&&("BACKGROUND_MUSIC"==e.behavior||d&&!C.ci(d.onended))&&(e.state=50);e.Ee&&50==e.state&&y(c);20==e.state&&3>e.Ct-f&&h(e)}X&&X.xj.length&&(-1==X.Hc||a>X.oG+X.rI[X.Hc])&&(b=X,-1<b.Hc&&m(b.xj[b.Hc]),
-1==b.Hc&&b.random?c=Math.round(Math.random()*(b.xj.length-1)):b.random?(c=1+Math.round(Math.random()*(b.xj.length-2)),c=(b.Hc+c)%b.xj.length):c=(b.Hc+1)%b.xj.length,y(b.xj[c]),b.Hc=c,b.oG=a)}};a.play=d;a.sL=y;a.stop=m;a.WW=function(a){return 20==a.Y.state};a.l$=q;a.m$=t;a.m8=function(a,b){var c=a.Y,e=c.Nd;if(z(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&e){var d=I.currentTime+b;c.ec.stop(d);e.start(d,c.Aw)}};a.uY=function(a,b){var c=a.Y;c.pitch=b;!z(a)||"POSITIONAL"!=c.behavior&&
"BACKGROUND_SOUND"!=c.behavior||(c.ec.playbackRate.value=b,c.Nd&&(c.Nd.playbackRate.value=b),A(c),h(c))};a.K6=function(a){return a.Y.pitch};a.Ee=function(a,b){a.Y.Ee=Boolean(b)};a.LW=function(a){return a.Y.autoplay};a.OW=function(a){return a.Y.Ee};a.uX=function(a,b,d,f,h){if(a=a.Rc){var k=x;k[0]=0;k[1]=0;k[2]=-1;Q.transformQuat(k,d,k);e[0]=0;e[1]=1;e[2]=0;Q.transformQuat(e,d,e);d=I.listener;d.setPosition(b[0],b[1],b[2]);d.setOrientation(k[0],k[1],k[2],e[0],e[1],e[2]);if(f&&a.kl!=h){if(a.xC)a.xC=!1,
Q.copy(b,a.ei);else for(d=a.Lm,d[0]=(b[0]-a.ei[0])/f,d[1]=(b[1]-a.ei[1])/f,d[2]=(b[2]-a.ei[2])/f,Q.copy(b,a.ei),b=0;b<T.length;b++)d=T[b],k=d.Y,z(d)&&"POSITIONAL"==k.behavior&&k.qv&&c(k,a,f);a.kl=h}else Q.copy(b,a.ei)}};a.xC=function(){var a=F.Rc;a&&(a.xC=!0)};a.j_=function(a,b,d){var f=a.Y;if(z(a)&&"POSITIONAL"==f.behavior){var h=E.ic(a.k.n,x);a=E.ae(a.k.n,w);var k=f.cD;k.setPosition(h[0],h[1],h[2]);C.mc(a,C.Nc,e);k.setOrientation(e[0],e[1],e[2]);f.qv&&(a=f.rC,b&&f.kl!=d?(f.mn?(Q.copy(h,a),f.mn=
!1):(k=f.ny,k[0]=(h[0]-a[0])/b,k[1]=(h[1]-a[1])/b,k[2]=(h[2]-a[2])/b,Q.copy(h,a),c(f,F.Rc,b)),f.kl=d):Q.copy(h,a))}};a.n$=function(a){var b=a.Y;z(a)&&"POSITIONAL"==b.behavior&&b.qv&&(b.mn=!0)};a.TB=function(a){return a.Y.behavior};a.N3=function(){for(var a=0;a<T.length;a++)if(z(T[a]))return!0;return!1};a.D9=function(a){var b=F.Rc;b&&(b.volume=a,I&&(b.mo.gain.value=L(b)))};a.t6=function(){var a=F.Rc;return a?a.volume:0};a.QZ=function(a,b){var c=a.Y;c.volume=b;z(a)&&(c.mo.gain.value=L(c))};a.n7=function(a){return a.Y.volume};
a.qc=function(a,b){a.Y.muted=Boolean(b);z(a)&&(a.Y.mo.gain.value=L(a.Y))};a.a8=function(a){return a.Y.muted};a.s8=function(a){var b=F.Rc;b&&(b.muted=Boolean(a),I&&(b.mo.gain.value=L(b)))};a.Z7=function(){var a=F.Rc;return a?a.muted:!1};a.eW=function(){return T};a.pause=function(){for(var a=0;a<T.length;a++)q(T[a])};a.rj=function(){for(var a=0;a<T.length;a++)t(T[a])};a.r9=function(a,b){if(a.Rc&&a.Rc.er){var c=a.Rc.er;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=
b.attack;c.release.value=b.release}};a.O5=function(a){if(!a.Rc||!a.Rc.er)return null;a=a.Rc.er;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.T4=function(a,b,c){if(z(a)){a=a.Y;var e=a.ik,d=I.currentTime;e.gain.setValueAtTime(e.gain.value,d);e.gain.linearRampToValueAtTime(b,d+c);a.em=c}};a.P$=function(a){if(z(a)){a=a.Y;var b=a.ik,c=I.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.em);
a.em=0}};a.U4=function(a,b){if(I){var c=F.Rc,e=c.ik,d=I.currentTime;e.gain.setValueAtTime(e.gain.value,d);e.gain.linearRampToValueAtTime(a,d+b);c.em=b}};a.Q$=function(){if(I){var a=F.Rc,b=a.ik,c=I.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.em);a.em=0}};a.v3=function(a,b,c){X={Hc:-1,oG:0,random:c,xj:[],rI:[]};for(c=0;c<a.length;c++){var e=a[c],d=D(e);0==d?B.warn("Ignoring speaker with zero duration: "+e.name):(m(e),e.Y.Ee=!1,X.xj.push(e),X.rI.push(d+b))}};
a.V5=D;a.i4=function(){if(X)for(var a=X.xj,b=0;b<a.length;b++)m(a[b]);X=null};a.M6=function(a){return(a=a.Y)&&"POSITIONAL"==a.behavior?{dist_ref:a.sr,dist_max:a.Zg,attenuation:a.wq}:null};a.Q9=function(a,b){var c=a.Y;if(c&&"POSITIONAL"==c.behavior){c.sr=b.dist_ref;c.Zg=b.dist_max;c.wq=b.attenuation;var e=c.cD;e&&(e.refDistance=c.sr,e.maxDistance=c.Zg,e.rolloffFactor=c.wq)}};a.w9=function(a,b){var c=a.Y;c&&c.dh&&(c.dh.frequency.value=b.freq,c.dh.Q.value=b.Q,c.dh.gain.value=b.gain)};a.b6=function(a){return(a=
a.Y)&&a.dh?{freq:a.dh.frequency.value,Q:a.dh.Q.value,gain:a.dh.gain.value}:null};a.a6=function(a,b,c,e){a=a.Y;if(!a||!a.dh)return null;a.dh.getFrequencyResponse(b,c,e)};a.reset=function(){n.length=0;ea.length=0;I=null}};b4w.module.__shaders=function(a,g){function l(a,b,c){var e=a.Ui;"string"==typeof c?(a=d(a,c))&&(c=a[1]):c=String(c);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=c;break}}function d(a,b){for(var c=a.Ui,e=0;e<c.length;e++)if(c[e][0]==b)return c[e];return!1}function b(a,b){var e=a+b;if(!(e in T)){var d=c(n.shaders_path,a),f=c(n.shaders_path,b),d=L(d),f=L(f),h;for(h in f)d[h]=f[h];f=[];for(h in d)f.push([h,d[h]]);T[e]=f}return T[e]}function y(a,b){return a+b}function r(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(y,0)}function A(a,b){var c=t(a.type),e=t(b.type),d=a.Il,f=b.Il;return c>e?-1:c<e?1:d>f?-1:d<f?1:0}function h(a){if(e.fc){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=fa}else b=V;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],Il:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return m(a,W,w.Ew)}function u(a,b,c){a=a.split(";").map(function(a){return(a=a.match(H))&&{type:a[2],Il:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return m(a,b,c)}function m(a,b,c){function e(){for(var c=0;n<a.length;){var d=a[n];if(3!=t(d.type))break;c+=f(d.type)*d.Il;n++}g=p+c;if(g>Z)return!1;q(b,p,c,0,3);return!0}function d(){for(var c=Z-g,e=c,h=c;n<a.length;){var k=a[n];if(2!=t(k.type))break;k=f(k.type)*k.Il;if(k<=e)e-=k;else if(k<=h)h-=k;else return!1;n++}h=c-h;q(b,g,c-e,0,2);q(b,Z-h,h,2,2);return!0}function h(){for(;n<a.length;){for(var e=a[n],e=f(e.type)*e.Il,d=-1,k=c+1,g=-1,p=0;4>p;p++){var m=P;m[0]=
0;m[1]=1;var l;l=b;for(var v=p,w=e,r=m;aa<l.length&&15===l[aa];)aa++;for(;0<Z&&15===l[Z];)Z--;if(Z-aa<w)l=!1;else{for(var v=1<<v,x=0,u=-1,H=l.length+1,t=!1,C=aa;C<=Z;C++)C<Z&&!(l[C]&v)?t||(x=C,t=!0):(t&&(t=C-x,t>=w&&t<H&&(H=t,u=x)),t=!1);0>u?l=!1:(r[0]=u,r[1]=H,l=!0)}l&&m[1]<k&&(g=m[0],k=m[1],d=p)}if(0>d)return!1;q(b,g,e,d,1);n++}return!0}if(!a.length)return!0;for(var k=0;k<c;k++)b[k]=0;Z=c;a.sort(A);var g=0,p=0,n=0;return function(){for(;n<a.length;){var c=a[n];if(4!=t(c.type))break;p+=f(c.type)*
c.Il;n++}if(p>Z)return!1;aa=p;q(b,0,p,0,4);return!0}()&&e()&&d()&&h()}function q(a,b,c,e,d){for(var f=0,h=0;h<d;h++)f|=1<<e+h;for(h=0;h<c;h++)a[b+h]|=f}function f(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function t(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}
function c(a,b){var c=a+b;if(I[c])return I[c];if(F){var e=F[b];if(!e)return null;e=g("__gpp_parser").H8.parse(e)}else if(e=g("shader_texts")[b],!e)return null;return I[c]=e}function z(a,b){for(var c={},d=b.Ui||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.ug.length;f++)c["USE_NODE_"+b.ug[f].id]=["1"];e.fc?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=e.br?["sampler2DShadow"]:["sampler2D"];for(var h in c)c[h][0].constructor!=String&&p.warn("Warning! The value of a directive '"+h+"' is not of type string.");return c}
function L(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=c(n.shaders_path,n.MM+a.o),e(a,b))}function e(a,b,c){if(a instanceof Array)for(var d=0;d<a.length;d++)e(a[d],b,c);else if(a instanceof Object&&a){b&&b(a);for(d in a)e(a[d],b,c);c&&c(a)}}var d={};e(a,b);return d}function D(a,b,d){function f(b){b=b.d;for(var e=0;e<b.length;e++){var d=b[e];switch(d.a){case "cond":a:for(var d=d.d,v=0;v<d.length;v++){var t=d[v];switch(t.a){case "if":case "elif":if(h(t.g)){f(t.h);break a}break;
case "else":f(t.h);break a;case "ifdef":t.c in r&&f(t.h);break;case "ifndef":t.c in r||f(t.h)}}break;case "include":d=d.o;v=c(n.shaders_path,n.MM+d);H.push("include/"+d);f(v);H.pop();break;case "var":break;case "define":r[d.c]=d.b;break;case "error":x.q("Shader error: #error "+d.b.join(" "));break;case "line":break;case "pragma":w.push("#pragma "+d.c+" "+d.b.join(" "));break;case "undef":delete r[d.c];break;case "warning":p.warn("Shader warning: #warning "+d.b.join(" "));break;case "extension":d=
l(d.b,r,u,!1);w.push("#extension "+d.join(" "));break;case "version":d=l(d.b,r,u,!1),w.push("#version "+d.join(" "));case "#":break;case "node":C[d.c]=d;break;case "nodes_global":d=q;for(v=0;v<d.length;v++){var t=d[v],P=C[t.id];if(P)for(var z=0,Q=0;Q<P.l.length;Q++){var I=P.l[Q];if("node_param"==I.a){var B;if("PARTICLE_INFO"==t.id&&I.e)if(1==r.PARTICLE_BATCH)switch(B=!1,z){case 0:B=E(t.Sb,"PART_INFO_IND")||E(t.Sb,"PART_INFO_AGE")||E(t.Sb,"PART_INFO_LT")||E(t.Sb,"PART_INFO_SIZE");break;case 1:B=E(t.Sb,
"PART_INFO_LOC");break;case 2:B=E(t.Sb,"PART_INFO_VEL");break;case 3:B=E(t.Sb,"PART_INFO_A_VEL");break;case 4:B=E(t.Sb,"PART_INFO_IND")}else B=!1;else B=!0;B&&(I=I.f.join(" ")+" ","vert"==a?I+=t.yi[z]:"frag"==a&&(I+=t.qb[z],null!==t.Zw[z]&&(I+="="+t.Zw[z])),I+=";",m(g(I)));z++}}}break;case "nodes_main":d=q;for(v=0;v<d.length;v++)if(t=d[v],P=C[t.id]){z={};M=y=T=0;Q=P;I=t;B=Q;for(var aa={},A=0;A<B.m.length;A++){var D=B.m[A];aa[D.c]=[D.b.join("")]}B=aa;for(aa=0;aa<I.Sb.length;aa++)A=I.Sb[aa][0],A in
B&&(B[A]=[I.Sb[aa][1]]);for(aa=A=0;aa<Q.l.length;aa++)D=Q.l[aa],"node_out"==D.a&&(B["USE_OUT_"+D.c]=[-1<F.indexOf(I.fb[A])|0],A++);Q=B;I=t;B=P.l;aa=z;A=Q;for(D=0;D<B.length;D++){var ba=B[D];switch(ba.a){case "node_in":var fa=I.M[T];if(null!==I.hC[T]){if(("MATERIAL_BEGIN"==I.id&&3===T||!A.MATERIAL_EXT&&("MATERIAL_BEGIN"==I.id&&4===T||"MATERIAL_END"==I.id&&3===T||"MATERIAL_END"==I.id&&4===T||"MATERIAL_END"==I.id&&5===T)||"TEXTURE_COLOR"==I.id||"TEXTURE_NORMAL"==I.id)&&ba.e){aa[ba.c]=I.hC[T];T++;continue}var V=
ba.f.join(" ")+" ",V=V+(fa+"="+I.hC[T]+";");m(g(V))}aa[ba.c]=fa;T++;break;case "node_out":fa=I.fb[y];if(!ba.e||-1<F.indexOf(fa))V=ba.f.join(" ")+" ",V+=fa+";",m(g(V)),aa[ba.c]=fa;y++;break;case "node_param":"vert"==a?fa=I.yi[M]:"frag"==a&&(fa=I.qb[M]),aa[ba.c]=fa,M++}}w.push("{");k(t,P.j,z,Q);w.push("}")}break;case "txt":m(d.b);break;default:x.q("Unknown element type: "+d.a)}}}function h(a,b){var c;c=l(a,r,u,!0,b);for(var e=[],d=0;d<c.length;d++)if(c[d]instanceof Object)switch(c[d].a){case "conditional_expr":var f=
e.pop(),k=e.pop();e.pop()?e.push(k):e.push(f);break;case "logical_or_expr":for(var k=e.pop(),g=0;g<c[d].i-1;g++)f=e.pop(),k=k||f;e.push(k);break;case "logical_and_expr":k=e.pop();for(g=0;g<c[d].i-1;g++)f=e.pop(),k=k&&f;e.push(k);break;case "logical_bitor_expr":k=e.pop();for(g=0;g<c[d].i-1;g++)k|=e.pop();e.push(k);break;case "logical_bitxor_expr":k=e.pop();for(g=0;g<c[d].i-1;g++)k^=e.pop();e.push(k);break;case "logical_bitand_expr":k=e.pop();for(g=0;g<c[d].i-1;g++)k&=e.pop();e.push(k);break;case "equal_expr":f=
e.pop();k=e.pop();e.push(k==f);break;case "non_equal_expr":f=e.pop();k=e.pop();e.push(k!=f);break;case "le_expr":f=e.pop();k=e.pop();e.push(k<=f);break;case "ge_expr":f=e.pop();k=e.pop();e.push(k>=f);break;case "l_expr":f=e.pop();k=e.pop();e.push(k<f);break;case "g_expr":f=e.pop();k=e.pop();e.push(k>f);break;case "left_shift_expr":k=e.pop();f=e.pop();e.push(k<<f);break;case "right_shift_expr":k=e.pop();f=e.pop();e.push(k>>f);break;case "add_expr":k=e.pop();f=e.pop();e.push(k+f);break;case "sub_expr":k=
e.pop();f=e.pop();e.push(k-f);break;case "mul_expr":k=e.pop();f=e.pop();e.push(k*f);break;case "div_expr":k=e.pop();f=e.pop();e.push(k/f);break;case "mod_expr":k=e.pop();f=e.pop();e.push(k%f);break;case "pre_inc_expr":case "post_inc_expr":f=e.pop();e.push(++f);break;case "pre_dec_expr":case "post_dec_expr":f=e.pop();e.push(--f);break;case "positive_expr":f=e.pop();e.push(+f);break;case "negative_expr":f=e.pop();e.push(-f);break;case "one_compl_expr":f=e.pop();e.push(~f);break;case "logic_negative_expr":f=
e.pop();e.push(!f);break;default:x.q("Unknown operation type: "+c[d].a)}else f=c[d],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(f)?(e.push(0),0!=f.indexOf("USE_NODE_")&&(k=H[H.length-1],k in t||(t[k]=[]),-1==t[k].indexOf(f)&&(t[k].push(f),p.error("Undefined directive '"+f+"' in shader '"+k+"'. Should it be defined with #var/#node_var or #define?")))):e.push(parseFloat(c[d]));1==e.length?c=e[0]:(x.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function k(a,b,c,e){for(var d=0;d<b.length;d++){var f=
b[d];switch(f.a){case "node_cond":a:for(var g=a,f=f.d,p=c,n=e,l=0;l<f.length;l++){var v=f[l];switch(v.a){case "node_if":case "node_elif":if(h(v.g,n)){k(g,v.j,p,n);break a}break;case "node_else":k(g,v.j,p,n);break a;case "node_ifdef":(v.c in r||v.c in n)&&k(g,v.j,p,n);break;case "node_ifndef":v.c in r||v.c in n||k(g,v.j,p,n)}}break;case "txt":g=[];for(p=0;p<f.b.length;p++)n=f.b[p],n in c?g.push(c[n]):g.push(n);m(g,e)}}}function g(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function m(b,c){var d=
b;e.fc||"frag"!=a||(d=d.join(" "),I&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),I=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),I=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=l(b,r,u,!1,c),w.push(d.join(" ")))}function l(a,b,c,e,d){var f=[];v(a,b,c,e,f,d);return f}function v(a,b,c,e,d,f){for(var h=0;h<a.length;h++){var k=a[h];if(f&&k in f)k=f[k];else if(k in b)k=b[k];else{d.push(k);continue}0==
k.length&&e?d.push(0):v(k,b,c,e,d,f)}}var q=d.ug,w=[],r=z(a,d),u={},H=[d[a]],t={},C={},F=[],P;for(P in q)for(var Q in q[P].M)F.push(q[P].M[Q]);var I=!1;f(b);var T=0,y=0,M=0;return w.join("\n")}function G(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function B(a){ya.deleteProgram(a.ki);ya.deleteShader(a.ty);ya.deleteShader(a.zv);delete ea[a.YD]}function O(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return K(a);case 2:return"vec2("+K(a[0])+","+K(a[1])+")";case 3:return"vec3("+
K(a[0])+","+K(a[1])+","+K(a[2])+")";case 4:return"vec4("+K(a[0])+","+K(a[1])+","+K(a[2])+","+K(a[3])+")";case 9:return"mat3("+K(a[0])+","+K(a[1])+","+K(a[2])+","+K(a[3])+","+K(a[4])+","+K(a[5])+","+K(a[6])+","+K(a[7])+","+K(a[8])+")";case 16:return"mat4("+K(a[0])+","+K(a[1])+","+K(a[2])+","+K(a[3])+","+K(a[4])+","+K(a[5])+","+K(a[6])+","+K(a[7])+","+K(a[8])+","+K(a[9])+","+K(a[10])+","+K(a[11])+","+K(a[12])+","+K(a[13])+","+K(a[14])+","+K(a[15])+")";default:x.q("Wrong glsl value dimension")}}function K(a){return a%
1?String(a):String(a)+".0"}function E(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var C=g("__assets"),Q=g("__config"),k=g("__debug"),p=g("__print"),x=g("__util"),e=Q.B,w=Q.Oi,n=Q.Je,ea={},I={},F=null,T={},M="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.Nz=0;a.JO=1;a.IO=2;a.MO=4;a.LO=8;a.KO=16;a.DO=32;var X=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,H=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,fa=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,V=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
P=new Int16Array(2),W=null,ha=null,v=null,aa=0,Z=0,ba=[],ya=null,na=!1;a.Uf=function(a){ya=a};a.ha=l;a.LV=d;a.pZ=function(a){a.Ui=x.Qh(b(a.Eg,a.df));l(a,"PRECISION",Q.B.precision);"highp"==Q.B.precision?l(a,"EPSILON",O(1E-6)):l(a,"EPSILON",O(1E-4));l(a,"CONSTANTS_HACK",e.XD|0);l(a,"SRGB",e.srgb_type);l(a,"COMPARED_MODE",e.br|0)};a.m7=function(a){return a.Eg};a.f6=function(a){return a.df};a.GV=function(a){var b=JSON.stringify(a.Eg)+JSON.stringify(a.df)+JSON.stringify(a.Ui)+JSON.stringify(a.ug),d=ea[b];
if(d)return d;var f=a.df,g=c(n.shaders_path,a.Eg),f=c(n.shaders_path,f);if(!g||!f)return null;var g=D("vert",g,a),f=D("frag",f,a),d=0,p=r(f,X);a.yN=p;p>w.GC&&(d|=1);W||(W=new Uint32Array(w.Ew));ha||(ha=new Uint32Array(w.Dw));v||(v=new Uint32Array(w.us));u(f,ha,w.Dw)||(d|=2);u(g,v,w.us)||(d|=4);p=e.fc?(g.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(g.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.GG=p;p>w.HC&&(d|=8);h(f)||(d|=16);a.status=d;if(0===
a.status){var d=ya,m=G(d,g,d.VERTEX_SHADER),l=G(d,f,d.FRAGMENT_SHADER),p=d.createProgram();d.attachShader(p,m);d.attachShader(p,l);d.linkProgram(p);for(var m={ty:m,zv:l,ki:p,attributes:{},on:{},Fs:x.bk(),fD:x.bk(),gD:{},xs:!0,Ow:!1,LN:x.bk(),KN:x.bk(),hb:x.Qh(a),YD:b,eg:!0},q=d.getProgramParameter(p,d.ACTIVE_ATTRIBUTES),l=0;l<q;l++){var H=d.getActiveAttrib(p,l).name;m.attributes[H]=d.getAttribLocation(p,H)}q=d.getProgramParameter(p,d.ACTIVE_UNIFORMS);for(l=0;l<q;l++)H=d.getActiveUniform(p,l).name.split("[0]").join(""),
m.on[H]=d.getUniformLocation(p,H);ea[b]=d=m;p=!ya.getShaderParameter(d.zv,ya.COMPILE_STATUS);m=!ya.getShaderParameter(d.ty,ya.COMPILE_STATUS);l=!ya.getProgramParameter(d.ki,ya.LINK_STATUS);p?k.OL(d.zv,b,f):m?k.OL(d.ty,b,g):l&&k.SY(d.ki,b,g,f);if(p||m||l)a.status|=32,d=null}else d=null;return d};a.vX=function(){na=!1;if(b4w.module_check("shader_texts"))na=!0;else{for(var a=[],b=C.Gy,c=0;c<M.length;c++){var e=x.oj(n.shaders_path+M[c]);a.push({id:M[c],type:b,url:e})}b=function(a,b){F||(F={});F[b]=a};
a.length?C.Yd(a,b,function(){na=!0}):p.error("Shaders have not been found.")}};a.vH=function(){return na};a.D4=function(){return ba};a.eJ=function(){return ea};a.ua=function(){for(var a in ea)B(ea[a]);for(var b in I)delete I[b];for(var c in ba)delete ba[c];v=ha=W=null;T={}};a.RS=B;a.E4=function(a){var b=a.Ui;p.log("Shader: "+a.Eg+" "+a.df+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)p.log("  "+b[a][0],b[a][1])};a.O=O;a.wH=function(a,b){return b in a.on?!0:!1};a.reset=function(){ya=
null}};b4w.module.__assets=function(a,g){function l(){return z.nK()?g(z.Je.Ju).data:null}function d(){var a={su:null,RQ:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,e=new Int8Array(c),d=0;d<c;d++)e[d]=b.charCodeAt(d);return e.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.su=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=l();b&&a.su in b&&(a.status=200,b[a.su]&&(a.response=a.RQ(b[a.su])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,e=0;e<b.length;e++){var d=b[e];20===d.state&&c++;if(c>=E.OX)break;if(10===d.state)switch(d.state=20,c++,d.type){case a.Gt:y(d,"arraybuffer");break;case a.Bn:y(d,"json");break;case a.Gy:y(d,"text");break;case a.Ey:r(d);break;case a.Ht:A(d);break;case a.Fy:h(d);break;case a.Jt:u(d);break;
case a.It:m(d);break;default:B.q("Wrong asset type: "+d.type)}}}function y(b,c){var e=b.url.split("?t=")[0];if(e in p)"json"==c?b.ac(B.T(p[e]),b.id,b.type,b.url,b.Jb):b.ac(p[e],b.id,b.type,b.url,b.Jb);else{var f=l(),h=f&&b.url in f?new d:new XMLHttpRequest,f=null;if("GET"==b.mi)h.open("GET",b.url,!0);else if("POST"==b.mi)switch(h.open("POST",b.url,!0),b.Qo){case a.bF:f="text/plain";break;case a.aF:f="application/json"}if(b.Jk)for(var k in b.Jk)"Content-Type"==k?f=b.Jk[k]:h.setRequestHeader(k,b.Jk[k]);
f&&h.setRequestHeader("Content-Type",f);"text"==c?(h.overrideMimeType("text/plain"),h.responseType="text"):"json"==c?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=c;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==c&&"string"==typeof a)try{a=JSON.parse(a,b.$W)}catch(d){D.error(d+" (parsing JSON "+b.url+")");b.ac(null,b.id,b.type,b.url,b.Jb);return}b.ih&&(p[e]="json"==c?B.T(a):a);b.ac(a,
b.id,b.type,b.url,b.Jb)}else D.error("empty responce when trying to get "+b.url),b.ac(null,b.id,b.type,b.url,b.Jb)}else D.error(h.status+" when trying to get "+b.url),b.ac(null,b.id,b.type,b.url,b.Jb);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.BL(a.loaded/a.total)},!1);h.send(b.Xm)}}function r(a){var b=a.url.split("?t=")[0];if(b in w)a.ac(w[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.mi&&B.q("Unsupported request type for audio buffer");var c=(b=l())&&a.url in
b?new d:new XMLHttpRequest;c.open("GET",a.url,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(40!=a.state&&4==c.readyState)if(200==c.status||0==c.status){var b=c.response;b?G.oU(b,function(b){a.ac(b,a.id,a.type,a.url,a.Jb);a.state=30;a.ih&&(w[a.url.split("?t=")[0]]=b)},function(){a.ac(null,a.id,a.type,a.url,a.Jb);D.error("failed to decode "+a.url);a.state=30}):(a.ac(null,a.id,a.type,a.url,a.Jb),D.error("empty responce when trying to get "+a.url),a.state=30)}else a.ac(null,a.id,
a.type,a.url,a.Jb),D.error(c.status+" when trying to get "+a.url),a.state=30};c.send(a.Xm)}}function A(a){var b=a.url.split("?t=")[0];if(b in x)a.ac(x[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.mi&&B.q("Unsupported request type for image element");var c=document.createElement("img");K.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30,a.ih&&(x[a.url.split("?t=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(a.ac(null,
a.id,a.type,a.url,a.Jb),D.error("could not load image: "+a.url),a.state=30)},!1);if((b=l())&&a.url in b)if(b[a.url]){var e=f(a.url);c.src="data:"+e+";base64,"+b[a.url]}else L.es()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function h(a){var b=a.url.split("?t=")[0];if(b in e)a.ac(e[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.mi&&B.q("Unsupported request type for audio element");var c=document.createElement("audio");
K.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30,a.ih&&(e[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.ac(null,a.id,a.type,a.url,a.Jb),D.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.ac(null,a.id,a.type,a.url,a.Jb),D.error("could not load sound: "+a.url),a.state=30)},!1);if((b=l())&&a.url in b)if(b[a.url]){var d=
t(a.url);c.src="data:"+d+";base64,"+b[a.url];40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30)}else L.es()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,K.is_mobile_device&&c.load();K.KC&&(c.autoplay=!0,c.pause());setTimeout(function(){c.e_=1},5E3)}}function u(a){function b(){40!=a.state&&(a.ac(null,a.id,a.type,a.url),D.error("could not load video: "+a.url,a.Jb),a.state=30)}var e=a.url.split("?t=")[0];
if(e in x)a.ac(x[e],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.mi&&B.q("Unsupported request type for video element");var d=document.createElement("video");d.muted=!0;K.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.ac(d,a.id,a.type,a.url,a.Jb),a.state=30,a.ih&&(x[a.url.split("?t=")[0]]=d))},!1);d.addEventListener("error",b,!1);if((e=l())&&a.url in e)if(e[a.url]){var f=c(a.url);d.src="data:"+f+";base64,"+
e[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.ac(d,a.id,a.type,a.url,a.Jb);a.state=30},!1)}else L.es()?(e=document.createEvent("CustomEvent"),e.initCustomEvent("error",!1,!1,null)):e=new CustomEvent("error"),d.dispatchEvent(e);else d.src=a.url,K.is_mobile_device&&d.load();K.KC&&(d.autoplay=!0,d.pause());setTimeout(function(){d.e_=1},1E4)}}function m(b){function c(a){b.ac(a,b.id,b.type,b.url,b.Jb);b.state=30;b.ih&&(x[b.url.split("?t=")[0]]=a)}var e=b.url.split("?t=")[0];if(e in
x)b.ac(x[e],b.id,b.type,b.url,b.Jb),b.state=30;else{"GET"!=b.mi&&B.q("Unsupported request type for seq video element");var f=(e=l())&&b.url in e?new d:new XMLHttpRequest;if(null==b.Qo&&null==b.Xm)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.Qo){case a.bF:f.setRequestHeader("Content-type","text/plain");break;case a.aF:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?q(a,c):(b.ac(null,b.id,b.type,b.url,b.Jb),D.error("empty responce when trying to get "+b.url),b.state=30)}else b.ac(null,b.id,b.type,b.url,b.Jb),D.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.BL(a.loaded/a.total)},!1);f.send(b.Xm)}}function q(a,b){for(var c=new Int32Array(a),e=new Int8Array(a),d=c[3],f={images:[],XG:[],eh:c[4]},h=20,k=0;k<d;k++){var g=c[h/4],p=new Blob([e.subarray(h+4,h+4+g)],
{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(p);f.images.push(m);f.XG.push(p);h+=g+8-g%4}m.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.XG;b(f)}}function f(a){var b="image";switch(B.LB(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function t(a){var b="audio";switch(B.LB(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function c(a){var b="video";switch(B.LB(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var z=g("__config"),L=g("__compat"),D=g("__print"),G=g("__sfx"),B=g("__util"),O=g("__version"),K=z.B,E=z.Td;a.Gt=10;a.Bn=20;a.Gy=30;a.Ey=40;a.Ht=50;a.Fy=60;a.Jt=70;a.It=80;a.aF=a.Bn;a.bF=a.Gy;var C=[],Q=0,k={},p={},x={},e={},w={};a.kn=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.X6=function(a){if(k[a])return k[a];var b=E.prevent_caching?a+O.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return k[a]=b;B.q("Error XHR: responce is empty, GET "+a)}else B.q("Error XHR: "+c.status+", GET "+a)};a.ua=function(){for(var a=0;a<C.length;a++)C[a].state=40;C=[];Q=0;k={}};a.Yd=function(a,c,e,d,f){for(var h=0;h<a.length;h++){var k=a[h],k={id:k.id,type:k.type,url:k.url,
ih:k.ih,mi:k.mi?k.mi:"GET",Qo:k.Qo?k.Qo:null,Jk:k.Jk?k.Jk:null,Xm:k.Xm?k.Xm:null,Jb:k.Jb?k.Jb:null,state:10,ac:c||function(){},mL:e||function(){},BL:d||function(){},$W:f||null,nL:Q};if(E.prevent_caching){var g=l();g&&k.url in g||(k.url+=O.timestamp())}C.push(k)}b(C);Q++};a.update=function(){b(C);for(var a=C,c=0,e=!0,d=0;d<a.length;d++){var f=a[d];f.nL===a[c].nL?30!==f.state&&(e=!1):(e&&(a[d-1].mL(),e=d-c,a.splice(c,e),d-=e),c=d,e=30===a[d].state?!0:!1);d===a.length-1&&e&&(a[d].mL(),a.splice(c))}};
a.ES=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.TS=function(){p={};x={};e={};w={}}};"object"==typeof module&&module.vB&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function g(){var a=l,d=a.getDate(),d=10>d?"0"+String(d):String(d),g=a.getMonth()+1,g=10>g?"0"+String(g):String(g),A=String(a.getFullYear()),h=a.getHours(),h=10>h?"0"+String(h):String(h),u=a.getMinutes(),u=10>u?"0"+String(u):String(u),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+g+"."+A+" "+h+":"+u+":"+a}var l=new Date(2017,6,7,19,6,29),d=[16,12,1];a.version=function(){return d};a.SE=function(){for(var a="",g=0;g<d.length;g++)a=1==g?a+(10>d[g]?"0"+d[g]:
d[g]):a+d[g],g!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.hI=function(){return l};a.fB=g;a.timestamp=function(){var a=g(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.vB&&b4w.module.__version(exports);b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__transform=function(a,g){function l(a,b){f.mg(a)?G.ue(b,f.lg(a)):G.ue(b,a.k.n)}function d(a,b){var c=a.k;if(f.mg(a)){G.oi(b,c.n);var d=f.Fv(a),d=G.invert(d,Q);G.multiply(d,c.n,f.lg(a))}else G.oi(b,c.n)}function b(a,b){f.mg(a)?G.oi(b,f.lg(a)):G.oi(b,a.k.n)}function y(a,b){G.ae(a.k.n,b);return b}function r(a,b){f.mg(a)?G.ae(f.lg(a),b):G.ae(a.k.n,b);return b}function A(a,b){f.mg(a)?G.copy(b,f.lg(a)):G.copy(b,a.k.n)}function h(a,b){f.mg(a)?G.copy(f.lg(a),b):G.copy(a.k.n,b);return b}function u(a){var b=
a.k,d=a.I,h=a.type;"CAMERA"==h&&q.LE(a);f.k0(a,p);"CAMERA"==h&&q.i0(a);var k=G.ic(b.n,K),g=G.ae(b.n,C);m.Ol(b.S,b.n,b.Ta);m.Gq(b.wa,b.n,b.kb);if(b.Bp)for(var l=0;l<d.length;l++)for(var r=d[l].X,E=0;E<r.length;E++){var H=r[E];m.Ol(H.S,b.n,H.Ta);m.Gq(H.wa,b.n,H.kb);H.Zf&&m.Fq(H.ba,b.n,H.pb)}else b.Zf&&m.Fq(b.ba,b.n,b.pb);switch(h){case "MESH":a.ZK&&G.invert(a.k.n,a.k.zy);if(r=a.Au)G.invert(r.k.n,Q),G.multiply(Q,b.n,Q),G.hW(Q,b.uq),G.ae(Q,b.tq);b.Gr=!0;break;case "CAMERA":for(l=0;l<d.length;l++)q.j0(a,
d[l]);break;case "SPEAKER":D.j_(a,p,x);break;case "LAMP":t.o0(a)}for(l=0;l<d.length;l++)if(E=d[l],E.lw){r=E.yb;H=r.s;switch(h){case "MESH":b.Me&&L.ID(r);H=E.Ri;null!=b.Vd&&H&&L.PN(H,k);break;case "EMPTY":c.l0(a);break;case "CAMERA":L.eZ(r);if(H.yd){H.yd.enable_csm&&L.ID(r);var y=z.ja(a,r).da[0];L.y0(y,H.Wa)}L.A()==r&&L.rm(r)==a&&D.uX(r,k,g,p,x);break;case "LAMP":L.Ap(a,r)}H=E.ii;y=a.Rs;if(y.length)for(E=0;E<H.length;E++){var A=H[E].p;L.SN(H[E],k,g);z.TN(y,A.rc);q.PZ(A,L.rm(r));B.fo(A.md,A.Xh)}}b=
a.Ze;for(l=0;l<b.length;l++)u(b[l]);a=a.GA;for(l=0;l<a.length;l++)b=a[l],r=b[0],f.c0(r,b[1])}var m=g("__boundings"),q=g("__camera"),f=g("__constraints"),t=g("__lights"),c=g("__objects"),z=g("__obj_util"),L=g("__scenes"),D=g("__sfx"),G=g("__tsr"),B=g("__util"),O=g("__vec3"),K=new Float32Array(3),E=new Float32Array(3),C=new Float32Array(4);new Float32Array(9);var Q=G.create(),k=G.create(),p=0,x=0;a.UF=0;a.Jn=1;a.update=function(a){p=a;x++};a.Xc=function(a,b){var c=a.k;if(f.mg(a)){G.ue(b,c.n);var d=
f.Fv(a),d=G.invert(d,Q);G.multiply(d,c.n,f.lg(a))}else G.ue(b,c.n)};a.Gx=l;a.Uc=function(a,b){G.ic(a.k.n,b);return b};a.NJ=function(a,b){f.mg(a)?G.ic(f.lg(a),b):G.ic(a.k.n,b);return b};a.pi=d;a.Dx=b;a.Nf=y;a.CJ=r;a.Cx=function(a,b){var c=B.gk(b,C);d(a,c)};a.SD=function(a,c){var d=B.gk(c,C);b(a,d)};a.AJ=function(a,b){y(a,C);return b=B.kx(euler,b)};a.BJ=function(a,b){r(a,C);return b=B.kx(euler,b)};a.Le=function(a,b){var c=a.k;if(f.mg(a)){var c=f.lg(a),d=G.td(f.Fv(a));G.Le(b/d,c)}else G.Le(b,c.n)};a.TD=
function(a,b){var c=a.k;f.mg(a)?G.Le(b,f.lg(a)):G.Le(b,c.n)};a.td=function(a){return G.td(a.k.n)};a.EJ=function(a){return f.mg(a)?G.td(f.lg(a)):G.td(a.k.n)};a.vj=function(a,b){G.copy(b,a.k.n);if(f.mg(a)){var c=f.Fv(a),c=G.invert(c,Q);G.multiply(c,a.k.n,f.lg(a))}};a.Hx=A;a.Rr=function(a,b){return G.copy(a.k.n,b)};a.Sr=h;a.Jv=function(a){var b=a.k;a=b.Jl;var c=G.td(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.Iv=function(a,b,c){b?(a=a.k,O.copy(a.kb.G,
c)):(a=a.k,b=a.Jl,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,G.Gc(c,a.n,c));return c};a.ph=function(a,b,c,d){var f=h(a,Q),k=K;k[0]=b;k[1]=c;k[2]=d;G.Gc(k,f,k);l(a,k)};a.ED=function(a,b){var c=h(a,Q),d=G.oi(b,G.identity(k));G.multiply(c,d,d);A(a,d)};a.D=u;a.distance=function(a,b){var c=G.ic(a.k.n,K),d=G.ic(b.k.n,E);return O.dist(c,d)};a.Jo=function(a,b){var c=G.ic(a.k.n,K);return O.dist(c,b)};a.vJ=function(a){return{max_x:a.k.Ta.max_x,min_x:a.k.Ta.min_x,max_y:a.k.Ta.max_y,
min_y:a.k.Ta.min_y,max_z:a.k.Ta.max_z,min_z:a.k.Ta.min_z}}};b4w.module.__navmesh=function(a,g){function l(a,c){function e(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var d=a.sl,f=c.sl,h=[],k=0;k<d.length;k++)0<=b(f,d[k])&&h.push(d[k]);if(2>h.length)return[];0<=b(h,d[0])&&0<=b(h,d[d.length-1])&&e(d);0<=b(h,f[0])&&0<=b(h,f[f.length-1])&&e(f);h=[];for(k=0;k<d.length;k++)0<=b(f,d[k])&&h.push(d[k]);return h}function d(a){function b(a){for(var c=a.sg,e=0;e<c.length;e++){var d=c[e];void 0==d.island&&(d.island=a.island,b(d))}}a=a.vY;for(var c=[],e=0,d=0;d<a.length;d++){var f=
a[d];void 0==f.island&&(f.island=e++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[d])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function y(a){function b(a,c){for(var e=0;e<a.length;e++)if(c===a[e])return e}for(var c={},e=a.Gp,f=0;f<e.length;f++)e[f][0]=parseFloat(e[f][0].toFixed(2)),e[f][1]=parseFloat(e[f][1].toFixed(2)),e[f][2]=parseFloat(e[f][2].toFixed(2));c.Gp=a.Gp;a=d(a);c.qC=[];for(f=0;f<a.length;f++){for(var e=
[],h=a[f],k=0;k<h.length;k++){for(var g=[],p=h[k],n=0;n<p.sg.length;n++)g.push(b(h,p.sg[n]));for(var m=[],n=0;n<p.sg.length;n++)m.push(l(p,p.sg[n]));p.gd[0]=parseFloat(p.gd[0].toFixed(2));p.gd[1]=parseFloat(p.gd[1].toFixed(2));p.gd[2]=parseFloat(p.gd[2].toFixed(2));e.push({id:b(h,p),sg:g,sl:p.sl,gd:p.gd,Vc:p.Vc,wY:m,zB:0,Jr:0,Ib:0,$S:1,UE:!1,closed:!1,parent:null})}c.qC.push(e)}return c}function r(a,b,c,e,d){function f(a,b){B.subtract(a,b,K);return B.dot(K,K)}function h(a,b){for(var c=[],e=0;e<b.sg.length;e++)c.push(a[b.sg[e]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.zB=0;c.Jr=0;c.Ib=0;c.$S=1;c.UE=!1;c.closed=!1;c.parent=null}})(a);var k=L.NR(function(a){return a.zB});for(L.SG(k,b);0<k.content.length;){var g=L.OR(k);if(g===c){a=g;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}g.closed=!0;for(var p=h(a,g),n=0,m=p.length;n<m;n++){var l=p[n];if(!l.closed){var q=g.Jr+B.dist(l.gd,g.gd),w=l.UE;if(!w||q<l.Jr)l.UE=!0,l.parent=g,l.Ib=l.Ib||f(l.gd,d)+f(l.gd,e),l.Jr=q,l.zB=l.Jr+l.Ib,w?L.PR(k,
l):L.SG(k,l)}}}return[]}function A(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function h(a,b,c,e){b=B.subtract(b,a,K);a=B.subtract(c,a,E);a=B.cross(b,a,K);return G.sign(B.dot(e,a))}function u(a,b){B.subtract(a,b,K);return 1E-5>B.dot(K,K)}function m(a,b,c){var d=B.subtract(b.right,b.left,K),f=c.Vc,h=b.Vc;c=Math.acos(B.dot(f,h));f=G.sign(B.dot(d,B.cross(f,h,E)));c*=-f;f=D.identity(e);D.translate(f,b.left,f);D.rotate(f,c,d,f);D.translate(f,B.scale(b.left,-1,E),f);D.multiply(a,f,a)}function q(a,b,c,
e,d,f,h,g,n){for(var l=D.identity(p),q=d;q<c;q++)if(a[q].qK&&(q>d||!q)){var w,r=b,x=e;w=a[q].left;var u=a[q].right,t=f,E=l,z=B.create(),F=B.transformMat4(w,E,C);F[3]=1;E=B.transformMat4(u,E,K);E=B.subtract(E,F,Q);r=B.subtract(x,r,K);t=B.cross(t,r,k);.01>Math.abs(B.dot(t,E))?x=.5:(B.normalize(t,t),t[3]=-B.dot(t,x),x=-O.dot(t,F)/O.dot(t,E));u=B.subtract(u,w,K);w=B.scaleAndAdd(w,u,x,z);A(h,w);g&&A(n,a[q].Vc);q&&m(l,a[q],a[q-1])}}function f(a,b){function c(b,e){E=C=t=e;g=k=f=b;B.copy(b,p);B.copy(b,l);
B.copy(a[t].Vc,r)}var e=[],d=[],f,k,g,p,l,r,t=0,C=0,E=0;f=a[0].right;k=a[0].left;g=a[0].right;p=B.copy(k,w);l=B.copy(g,n);r=B.copy(a[0].Vc,F);A(e,f);b&&A(d,a[0].Vc);for(var z=D.identity(x),Q=1;Q<a.length;Q++){var y=a[Q].left,L=a[Q].right,K=B.transformMat4(y,z,ea),G=B.transformMat4(L,z,I);a[Q].qK&&m(z,a[Q],a[Q-1]);if(0>=h(f,l,G,r)){var O=u(f,g);if(O||0<h(f,p,G,r))g=L,B.copy(G,l),E=Q;else{(y=u(p,f))||q(a,p,C,f,t,r,e,b,d);z=D.identity(z);c(k,C);Q=t;y||(A(e,f),b&&A(d,a[Q].Vc));continue}}0<=h(f,p,K,r)&&
((O=u(f,k))||0>h(f,l,K,r)?(k=y,B.copy(K,p),C=Q):((y=u(l,f))||q(a,l,E,f,t,r,e,b,d),z=D.identity(z),c(g,E),Q=t,y||(A(e,f),b&&A(d,a[Q].Vc))))}z=a.length-1;Q=a[z].left;(y=u(f,Q))||q(a,p,z,f,t,r,e,b,d);y&&t||A(e,Q);return b?(A(d,a[z].Vc),{positions:new Float32Array(e),normals:new Float32Array(d)}):{positions:new Float32Array(e),normals:null}}function t(a,b,c,e,d){for(var f=null,h=Number.MAX_VALUE,k=0;k<a.length;k++){var g=a[k],p=d(c,g.gd,g.sl,b,h);p<h&&(f=g,h=p)}return 0<e&&h>e?null:f}function c(a,b,c,
e,d){a.push({left:b,right:c,qK:e,Vc:d})}var z=g("__geometry"),L=g("__math"),D=g("__mat4"),G=g("__util"),B=g("__vec3"),O=g("__vec4"),K=B.create(),E=B.create(),C=O.create(),Q=O.create(),k=O.create(),p=D.create(),x=D.create(),e=D.create(),w=B.create(),n=B.create(),ea=B.create(),I=B.create(),F=B.create();a.ZX=function(a){var b=z.Nv(a.tc,z.FQ),c=a.pe;a=[];for(var e=0;e<c.length;e+=3)a.push({na:new Uint32Array([c[e],c[e+1],c[e+2]]),gd:new Float32Array(3),Vc:new Float32Array(3)});c=[];for(e=0;e<b.length;e+=
3){var d=new Float32Array(3);d[0]=b[e];d[1]=b[e+1];d[2]=b[e+2];c.push(d)}for(b=0;b<a.length;b++)e=a[b],B.add(c[e.na[0]],c[e.na[1]],K),B.add(K,c[e.na[2]],K),B.scale(K,1/3,e.gd);for(b=0;b<a.length;b++){var e=a[b],d=B.subtract(c[e.na[1]],c[e.na[0]],K),f=B.subtract(c[e.na[2]],c[e.na[0]],E),d=B.cross(d,f,K);B.normalize(d,d);B.copy(d,e.Vc)}for(var h={},b=[],e=[],k,g,p=Math.pow(10,4),d=0,f=c.length;d<f;d++)k=c[d],g=Math.round(k[0]*p)+"_"+Math.round(k[1]*p)+"_"+Math.round(k[2]*p),void 0===h[g]?(h[g]=d,b.push(k),
e[d]=b.length-1):e[d]=e[h[g]];h=[];d=0;for(f=a.length;d<f;d++)for(k=a[d],k.na[0]=e[k.na[0]],k.na[1]=e[k.na[1]],k.na[2]=e[k.na[2]],k=[k.na[0],k.na[1],k.na[2]],g=0;3>g;g++)if(k[g]==k[(g+1)%3]){h.push(d);break}for(d=h.length-1;0<=d;d--)a.splice(h[d],1);c.length=0;for(d in b)c.push(b[d]);e=[];for(b=d=0;b<a.length;b++)f=a[b],e.push({id:d++,sl:f.na,gd:f.gd,Vc:f.Vc,sg:[]});a={vY:e,Gp:c};c={};for(b=0;b<e.length;b++)for(d=0;3>d;d++)f=e[b].sl[d],h=e[b].sl[(d+1)%3],f=f>h?h+"-"+f:f+"-"+h,f in c||(c[f]=[]),c[f].push(e[b]);
e=Object.keys(c);b=0;for(h=e.length;b<h;b++)for(f=e[b],d=0;d<c[f].length;d++)for(k=d+1;k<c[f].length;k++)c[f][d].sg.push(c[f][k]),c[f][k].sg.push(c[f][d]);return y(a)};a.XK=function(a,b,c){for(var e=null,d=Number.MAX_VALUE,f=a.qC,k=0;k<f.length;k++)for(var h=0;h<f[k].length;h++){var g=f[k][h];B.subtract(g.gd,b,K);g=c(b,g.gd,g.sl,a.Gp,d);g<d&&(e=k,d=g)}return e};a.XW=function(a,b,c){for(var e=[],d=0;d<b.length;d++)e.push(c[b[d]]);b=!1;c=-1;for(var d=e.length,f=d-1;++c<d;f=c)(e[c][1]<=a[1]&&a[1]<e[f][1]||
e[f][1]<=a[1]&&a[1]<e[c][1])&&a[0]<(e[f][0]-e[c][0])*(a[1]-e[c][1])/(e[f][1]-e[c][1])+e[c][0]&&(b=!b);return b?!0:!1};a.WK=function(a,b,e,d){var k;k=a.qC[d.island];var h=a.Gp,g=t(k,h,b,d.allowed_distance,d.distance_to_closest);k=g?(h=t(k,h,e,d.allowed_distance,d.distance_to_farthest))?r(k,g,h,b,e):null:null;if(k&&k.length)if(d.do_not_pull_string)if(e=k,d.return_normals){b=new Float32Array(3*e.length);for(k=0;k<e.length;k++)b.set(e[k].gd,3*k);e={positions:b,normals:null}}else{b=new Float32Array(3*
e.length);a=new Float32Array(3*e.length);for(k=0;k<e.length;k++)b.set(e[k].gd,3*k),a.set(e[k].Vc,3*k);e={positions:b,normals:a}}else{a=a.Gp;d=d.return_normals;g=[];c(g,b,b,!1,k[0]&&k[0].Vc||G.nc);for(b=0;b<k.length;b++){var p=k[b];if(h=k[b+1]){var n=.999>Math.abs(B.dot(p.Vc,h.Vc));a:{for(var l=0;l<p.sg.length;l++)if(p.sg[l]===h.id){p=p.wY[l];break a}p=void 0}c(g,a[p[0]],a[p[1]],n,h.Vc)}}c(g,e,e,!1,g[g.length-1].Vc);e=f(g,d)}else e=null;return e}};b4w.module.__reformer=function(a,g){function l(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function d(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],f=0;f<d.strips.length;f++){var h=d.strips[f];"action"in h||(h.action=null,b("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,b("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,b("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,b("strip",h,"repeat"));
"use_reverse"in h||(h.use_reverse=!1,b("strip",h,"use_reverse"));"scale"in h||(h.scale=1,b("strip",h,"scale"))}}function b(a,b,c){c=c+">>"+a;c in B||(B[c]={hE:[],PL:"undefined",type:a});B[c].hE.push(b.name)}function y(a,b,c){c=c+">>"+a;c in B||(B[c]={hE:[],PL:"deprecated",type:a});B[c].hE.push(b.name)}function r(a){q.warn(a)}function A(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var f=t.Qh(a);a.materials=c;a.submeshes=d;f.name=b;f.materials=a.materials.slice(0);
f.submeshes=[];for(c=0;c<d.length;c++){var h=t.Vq(d[c]);f.submeshes.push(h)}return f}var h=g("__boundings"),u=g("__curve"),m=g("__mat4"),q=g("__print"),f=g("__quat"),t=g("__util"),c=g("__vec3"),z=g("__mat3"),L=g("__logic_nodes"),D=g("__animation"),G=[5,4],B={},O=z.create(),K=f.create();a.uH=function(a){return-1!=t.lO(a,G)};a.xS=function(a){B={};var c=a.worlds;if(0==c.length){q.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};c.push(f)}for(var c=a.worlds,h=0;h<c.length;h++){f=c[h];"use_sky_blend"in f||(b("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(b("world",f,"use_sky_paper"),
f.use_sky_paper=!1);"use_sky_real"in f||(b("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in f.b4w_sky_settings||(b("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
f||(b("world",f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(b("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var g=f.texture_slots,m=0;m<g.length;m++){var e=g[m];"blend_type"in
e||(e.blend_type="MIX",b("world_texture_slot",e,"blend_type"));"use_map_blend"in e||(e.use_map_blend=!1,b("world_texture_slot",e,"use_map_blend"));"use_map_horizon"in e||(e.use_map_horizon=!0,b("world_texture_slot",e,"use_map_horizon"));"use_map_zenith_up"in e||(e.use_map_zenith_up=!1,b("world_texture_slot",e,"use_map_zenith_up"));"use_rgb_to_intensity"in e||(e.use_rgb_to_intensity=!1,b("world_texture_slot",e,"use_rgb_to_intensity"));"invert"in e||(e.invert=!1,b("world_texture_slot",e,"invert"));
"color"in e||(e.color=[1,0,1],b("world_texture_slot",e,"color"));"blend_factor"in e||(e.blend_factor=0,b("world_texture_slot",e,"blend_factor"));"horizon_factor"in e||(e.horizon_factor=1,b("world_texture_slot",e,"horizon_factor"));"zenith_up_factor"in e||(e.zenith_up_factor=0,b("world_texture_slot",e,"zenith_up_factor"));"zenith_down_factor"in e||(e.zenith_down_factor=0,b("world_texture_slot",e,"zenith_down_factor"));"default_value"in e||(e.default_value=1,b("world_texture_slot",e,"default_value"))}"b4w_use_default_animation"in
f||(b("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(b("world",f,"b4w_anim_behavior"),f.b4w_anim_behavior="CYCLIC")}m=a.scenes;for(h=0;h<m.length;h++)g=m[h],e=g.world,"timeline_markers"in g||(g.timeline_markers=null,b("scene",g,"timeline_markers")),"b4w_reflection_quality"in g||(g.b4w_reflection_quality="MEDIUM",b("scene",g,"b4w_reflection_quality")),"b4w_use_nla"in g||(g.b4w_use_nla=!1,b("scene",g,"b4w_use_nla")),"fps"in g||(g.fps=24,b("scene",g,
"fps")),"b4w_nla_cyclic"in g||(g.b4w_nla_cyclic=!1,b("scene",g,"b4w_nla_cyclic")),"b4w_logic_nodes"in g||(g.b4w_logic_nodes=[],b("scene",g,"b4w_logic_nodes")),"b4w_detect_collisions"in g&&(y("scene",g,"b4w_detect_collisions"),delete g.b4w_detect_collisions),"audio_doppler_speed"in g||(g.audio_doppler_speed=343.3),"audio_doppler_factor"in g||(g.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in g||(g.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",g,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in g||(g.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in g||(g.b4w_enable_bloom=!1,b("scene",g,"b4w_enable_bloom")),"b4w_enable_motion_blur"in g||(g.b4w_enable_motion_blur=!1,b("scene",g,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in g||(g.b4w_enable_color_correction=!1,b("scene",g,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in g||(g.b4w_antialiasing_quality="MEDIUM",b("scene",g,"b4w_antialiasing_quality")),
"b4w_tags"in g||(g.b4w_tags={title:"",description:""},b("scene",g,"b4w_tags")),"b4w_enable_object_selection"in g||(g.b4w_enable_object_selection="AUTO",b("scene",g,"b4w_enable_object_selection")),"b4w_enable_outlining"in g||(g.b4w_enable_outlining="AUTO",b("scene",g,"b4w_enable_outlining")),"b4w_enable_glow_materials"in g||(g.b4w_enable_glow_materials="AUTO",b("scene",g,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in g||(g.b4w_enable_anchors_visibility="AUTO",b("scene",g,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in g||(g.b4w_outline_color=[1,1,1],b("scene",g,"b4w_outline_color")),"b4w_outline_factor"in g||(g.b4w_outline_factor="b4w_glow_factor"in g?g.b4w_glow_factor:1,b("scene",g,"b4w_outline_factor")),"b4w_shadow_settings"in g||(b("scene",g,"b4w_shadow_settings"),c=e.b4w_shadow_settings,g.b4w_shadow_settings=c?c:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),c=g.b4w_shadow_settings,"csm_resolution"in c||(b("scene",g,"b4w_shadow_settings.csm_resolution"),c.csm_resolution=2048),"blur_samples"in c||(b("scene",g,"b4w_shadow_settings.blur_samples"),c.blur_samples="16x"),"soft_shadows"in c||(b("scene",g,"b4w_shadow_settings.soft_shadows"),c.soft_shadows=!0),"self_shadow_polygon_offset"in c||(b("scene",g,"b4w_shadow_settings.self_shadow_polygon_offset"),c.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in c||(b("scene",g,"b4w_shadow_settings.self_shadow_normal_offset"),c.self_shadow_normal_offset=.01),"b4w_enable_csm"in c||(b("scene",g,"b4w_shadow_settings.b4w_enable_csm"),c.b4w_enable_csm=!1),"csm_num"in c||(b("scene",g,"b4w_shadow_settings.csm_num"),c.csm_num=1),"csm_first_cascade_border"in c||(b("scene",g,"b4w_shadow_settings.csm_first_cascade_border"),c.csm_first_cascade_border=10),"first_cascade_blur_radius"in c||(b("scene",g,"b4w_shadow_settings.first_cascade_blur_radius"),
c.first_cascade_blur_radius=3),"csm_last_cascade_border"in c||(b("scene",g,"b4w_shadow_settings.csm_last_cascade_border"),c.csm_last_cascade_border=100),"last_cascade_blur_radius"in c||(b("scene",g,"b4w_shadow_settings.last_cascade_blur_radius"),c.last_cascade_blur_radius=1.5),"fade_last_cascade"in c||(b("scene",g,"b4w_shadow_settings.fade_last_cascade"),c.fade_last_cascade=!0),"blend_between_cascades"in c||(b("scene",g,"b4w_shadow_settings.blend_between_cascades"),c.blend_between_cascades=!0),"b4w_ssao_settings"in
g||(b("scene",g,"b4w_ssao_settings"),c=e.b4w_ssao_settings,g.b4w_ssao_settings=c?c:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),c=g.b4w_ssao_settings,"dist_factor"in c||(b("scene",g,"b4w_ssao_settings.dist_factor"),c.dist_factor=0),"samples"in c||(b("scene",g,"b4w_ssao_settings.samples"),c.samples=16),"hemisphere"in c||(b("scene",g,"b4w_ssao_settings.hemisphere"),c.hemisphere=!1),"blur_depth"in c||(b("scene",g,"b4w_ssao_settings.blur_depth"),c.blur_depth=!1),"blur_discard_value"in
c||(b("scene",g,"b4w_ssao_settings.blur_discard_value"),c.blur_discard_value=1),"b4w_bloom_settings"in g||(b("scene",g,"b4w_bloom_settings"),c=e.b4w_bloom_settings,g.b4w_bloom_settings=c?c:{key:.2,blur:4,edge_lum:1}),"key"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.key"),g.b4w_bloom_settings.key=.2),"blur"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.blur"),g.b4w_bloom_settings.blur=4),"edge_lum"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.edge_lum"),g.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in g||(b("scene",g,"b4w_motion_blur_settings"),c=e.b4w_motion_blur_settings,g.b4w_motion_blur_settings=c?c:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in g.b4w_motion_blur_settings||(b("scene",g,"b4w_motion_blur_settings.motion_blur_factor"),g.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in g.b4w_motion_blur_settings||(b("scene",g,"b4w_motion_blur_settings.motion_blur_decay_threshold"),g.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in g||(b("scene",g,"b4w_color_correction_settings"),c=e.b4w_color_correction_settings,g.b4w_color_correction_settings=c?c:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in g||(b("scene",g,"b4w_god_rays_settings"),c=e.b4w_god_rays_settings,g.b4w_god_rays_settings=c?c:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in g.b4w_god_rays_settings||(b("scene",g,"b4w_god_rays_settings.steps_per_pass"),g.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in g||(b("scene",g,"b4w_glow_settings"),g.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},c=g.b4w_glow_settings,"b4w_render_glow_over_blend"in e&&(c.render_glow_over_blend=e.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in e&&(c.small_glow_mask_coeff=e.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in e&&(c.large_glow_mask_coeff=e.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
e&&(c.small_glow_mask_width=e.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in e&&(c.large_glow_mask_width=e.b4w_large_glow_mask_width)),e=g.b4w_render_shadows,"AUTO"!=e&&"OFF"!=e&&"ON"!=e&&(g.b4w_render_shadows=e?"ON":"OFF"),e=g.b4w_render_reflections,"OFF"!=e&&"ON"!=e&&(g.b4w_render_reflections=e?"ON":"OFF"),e=g.b4w_render_refractions,"AUTO"!=e&&"OFF"!=e&&"ON"!=e&&(g.b4w_render_refractions=e?"ON":"OFF"),"b4w_render_dynamic_grass"in g||(b("scene",g,"b4w_render_dynamic_grass"),g.b4w_render_dynamic_grass=
"AUTO"),g.b4w_nla_script&&y("scene",g,"b4w_nla_script"),"audio_distance_model"in g||(b("scene",g,"audio_distance_model"),g.audio_distance_model="INVERSE_CLAMPED");g=a.meshes;for(h=0;h<g.length;h++){e=g[h];e.b4w_boundings||(b("mesh",e,"b4w_boundings"),e.b4w_boundings={},c=e.b4w_boundings,c.bb=e.b4w_bounding_box?e.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},c.bb_src=e.b4w_bounding_box_source?e.b4w_bounding_box_source:e.b4w_bounding_box,c.bs_cen=e.b4w_bounding_sphere_center?e.b4w_bounding_sphere_center:
[0,0,0],c.bc_cen=e.b4w_bounding_cylinder_center?e.b4w_bounding_cylinder_center:[0,0,0],c.be_cen=e.b4w_bounding_ellipsoid_center?e.b4w_bounding_ellipsoid_center:[0,0,0],e.b4w_bounding_ellipsoid_axes?c.be_ax=e.b4w_bounding_ellipsoid_axes:(m=c.bb,c.be_ax=[(m.max_x-m.min_x)/2,(m.max_y-m.min_y)/2,(m.max_z-m.min_z)/2]),e.b4w_rotated_bounding_box?c.rbb=e.b4w_rotated_bounding_box:(m=c.bb,c.rbb={rbb_c:[(m.max_x+m.min_x)/2,(m.max_y+m.min_y)/2,(m.max_z+m.min_z)/2],rbb_s:[1,1,1]}),c.caxis_x=e.b4w_cov_axis_x?
e.b4w_cov_axis_x:[1,0,0],c.caxis_y=e.b4w_cov_axis_y?e.b4w_cov_axis_y:[0,1,0],c.caxis_z=e.b4w_cov_axis_z?e.b4w_cov_axis_z:[0,0,1]);e.uv_textures||(b("mesh",e,"uv_textures"),e.uv_textures=[]);"b4w_shape_keys"in e||(e.b4w_shape_keys=[],b("mesh",e,"b4w_shape_keys"));c=!0;for(f=0;f<e.submeshes.length;f++){var w=e.submeshes[f];"boundings"in w||(c=!1,w.boundings={be_ax:e.b4w_bounding_ellipsoid_axes,be_cen:e.b4w_bounding_ellipsoid_center,bb:{max_x:e.b4w_bounding_box.max_x,max_y:e.b4w_bounding_box.max_y,max_z:e.b4w_bounding_box.max_z,
min_x:e.b4w_bounding_box.min_x,min_y:e.b4w_bounding_box.min_y,min_z:e.b4w_bounding_box.min_z}});"be_ax"in w.boundings||(w.boundings.be_ax=e.b4w_bounding_ellipsoid_axes);"be_cen"in w.boundings||(w.boundings.be_cen=e.b4w_bounding_ellipsoid_center);"bb"in w.boundings||(w.boundings.bb=e.b4w_bounding_box);"rbb"in w.boundings||(m=e.b4w_bounding_box,w.boundings.rbb={rbb_c:[(m.max_x+m.min_x)/2,(m.max_y+m.min_y)/2,(m.max_z+m.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in w.boundings||(w.boundings.caxis_x=[1,0,0]);
"caxis_y"in w.boundings||(w.boundings.caxis_y=[0,1,0]);"caxis_z"in w.boundings||(w.boundings.caxis_z=[0,0,1])}c||b("mesh",e,"submesh_bd");m=e;c=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];f=null;for(w=0;w<c.length;w++)m[c[w]]&&(f?(m[c[w]]=!1,q.warn('WARNING property "'+c[w]+'" of object "'+m.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=c[w]);for(m=0;m<e.b4w_vertex_anim.length;m++)c=e.b4w_vertex_anim[m],
"allow_nla"in c||(b('mesh["b4w_vertex_anim"]',e,"allow_nla"),c.allow_nla=!0)}m=a.cameras;for(h=0;h<m.length;h++)g=m[h],g.type||(g.type="PERSP",b("camera",g,"type")),"b4w_eye_target_dist"in g&&(delete g.b4w_eye_target_dist,y("camera",g,"b4w_eye_target_dist")),"b4w_hover_zero_level"in g||(g.b4w_hover_zero_level=0,b("camera",g,"b4w_hover_zero_level")),"b4w_trans_velocity"in g||(g.b4w_trans_velocity=1,b("camera",g,"b4w_trans_velocity")),"b4w_rot_velocity"in g||(g.b4w_rot_velocity=1,b("camera",g,"b4w_rot_velocity")),
"b4w_zoom_velocity"in g||(g.b4w_zoom_velocity=.1,b("camera",g,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in g||(g.b4w_use_target_distance_limits=g.b4w_use_distance_limits||!1,b("camera",g,"b4w_use_target_distance_limits")),"b4w_use_zooming"in g||(g.b4w_use_zooming=g.b4w_use_distance_limits||!1,b("camera",g,"b4w_use_zooming")),"b4w_distance_min"in g||(g.b4w_distance_min=1,b("camera",g,"b4w_distance_min")),"b4w_distance_max"in g||(g.b4w_distance_max=100,b("camera",g,"b4w_distance_max")),
"b4w_horizontal_translation_min"in g||(g.b4w_horizontal_translation_min=-100,b("camera",g,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in g||(g.b4w_horizontal_translation_max=100,b("camera",g,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in g||(g.b4w_vertical_translation_min=-100,b("camera",g,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in g||(g.b4w_vertical_translation_max=100,b("camera",g,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
g||(g.b4w_use_horizontal_clamping=!1,b("camera",g,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in g||(g.b4w_rotation_left_limit=-Math.PI,b("camera",g,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in g||(g.b4w_rotation_right_limit=Math.PI,b("camera",g,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in g||(g.b4w_horizontal_clamping_type="LOCAL",b("camera",g,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in g||(g.b4w_use_vertical_clamping=!1,b("camera",g,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in g||(g.b4w_rotation_down_limit=-Math.PI/2,b("camera",g,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in g||(g.b4w_rotation_up_limit=Math.PI/2,b("camera",g,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in g||(g.b4w_vertical_clamping_type="LOCAL",b("camera",g,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in g||(g.b4w_hover_angle_min=Math.PI/6,b("camera",g,"b4w_hover_angle_min")),"b4w_hover_angle_max"in g||(g.b4w_hover_angle_max=Math.PI/6,b("camera",g,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in g||(g.b4w_enable_hover_hor_rotation=!0,b("camera",g,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in g||(g.b4w_use_panning=!0,b("camera",g,"b4w_use_panning")),"b4w_use_pivot_limits"in g||(g.b4w_use_pivot_limits=!1,g.b4w_pivot_z_min=0,g.b4w_pivot_z_max=10,b("camera",g,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in g||(g.b4w_dof_bokeh=!1,b("camera",g,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in g||(g.b4w_dof_bokeh_intensity=.3,b("camera",g,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in g||(g.b4w_dof_foreground_blur=!1,b("camera",g,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in g||(g.b4w_dof_front_start=0,b("camera",g,"b4w_dof_front_start")),"b4w_dof_front_end"in g||(g.b4w_dof_front_end=g.b4w_dof_front,b("camera",g,"b4w_dof_front_end")),"b4w_dof_rear_start"in g||(g.b4w_dof_rear_start=0,b("camera",g,"b4w_dof_rear_start")),"b4w_dof_rear_end"in g||(g.b4w_dof_rear_end=g.b4w_dof_rear,b("camera",g,"b4w_dof_rear_end"));m=a.lamps;for(h=0;h<m.length;h++)g=
m[h],"b4w_generate_shadows"in g||(g.b4w_generate_shadows=!1,b("lamp",g,"b4w_generate_shadows")),"b4w_dynamic_intensity"in g||(g.b4w_dynamic_intensity=!1,b("lamp",g,"b4w_dynamic_intensity")),"use_diffuse"in g||(g.use_diffuse=!0,b("lamp",g,"use_diffuse")),"use_specular"in g||(g.use_specular=!0,b("lamp",g,"use_specular")),"clip_start"in g||(g.clip_start=.1,b("lamp",g,"clip_start")),"clip_end"in g||(g.clip_end=30,b("lamp",g,"clip_end")),"POINT"!=g.type&&"SPOT"!=g.type||"use_sphere"in g||(g.use_sphere=
!1,b("lamp",g,"use_sphere"));m=a.speakers;for(h=0;h<m.length;h++)g=m[h],"b4w_behavior"in g||(g.b4w_behavior=g.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in g||(g.b4w_auto_play=!1,b("speaker",g,"b4w_auto_play")),"b4w_enable_doppler"in g||(g.b4w_enable_doppler=!1,b("speaker",g,"b4w_enable_doppler")),"b4w_delay"in g||(g.b4w_delay=0),"b4w_delay_random"in g||(g.b4w_delay_random=0),"b4w_volume_random"in g||(g.b4w_volume_random=0),"b4w_pitch_random"in g||(g.b4w_pitch_random=0),
"b4w_fade_in"in g||(g.b4w_fade_in=0),"b4w_fade_out"in g||(g.b4w_fade_out=0),"b4w_loop"in g||(g.b4w_loop=!1),"b4w_loop_start"in g||(g.b4w_loop_start=0,b("speaker",g,"b4w_loop_start")),"b4w_loop_end"in g||(g.b4w_loop_end=0,b("speaker",g,"b4w_loop_end")),g.animation_data&&d(g.animation_data);m=a.textures;for(h=0;h<m.length;h++)g=m[h],"b4w_anisotropic_filtering"in g||(g.b4w_anisotropic_filtering="OFF",b("texture",g,"b4w_anisotropic_filtering")),"b4w_water_foam"in g||(g.b4w_water_foam=!1,b("texture",g,
"b4w_water_foam")),"b4w_foam_uv_freq"in g||(g.b4w_foam_uv_freq=[1,1],b("texture",g,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in g||(g.b4w_foam_uv_magnitude=[1,1],b("texture",g,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in g||(g.b4w_parallax_steps=5,b("material",g,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in g||(g.b4w_parallax_lod_dist=10,b("material",g,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in g||(g.b4w_shore_dist_map=!1,b("texture",g,"b4w_shore_dist_map")),"b4w_shore_boundings"in
g||(g.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",g,"b4w_shore_boundings")),"b4w_max_shore_dist"in g||(g.b4w_max_shore_dist=100,b("texture",g,"b4w_max_shore_dist")),"b4w_disable_compression"in g||(g.b4w_disable_compression=!1,b("texture",g,"b4w_disable_compression")),"b4w_source_type"in g||(g.b4w_source_type="",b("texture",g,"b4w_source_type")),"b4w_source_id"in g||(g.b4w_source_id="",b("texture",g,"b4w_source_id")),"b4w_source_size"in g||(g.b4w_source_size=1024,b("texture",g,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in g||(g.b4w_enable_canvas_mipmapping=!0,b("texture",g,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in g||(g.b4w_nla_video=!1,b("texture",g,"b4w_nla_video"));m=a.images;for(h=0;h<m.length;h++)g=m[h],"colorspace_settings_name"in g||(g.colorspace_settings_name="sRGB",b("image",g,"colorspace_settings_name"));c=a.materials;for(h=0;h<c.length;h++){f=c[h];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"use_tangent_shading"in f||(f.use_tangent_shading=
!1,b("material",f,"use_tangent_shading"));"b4w_node_mat_type"in f&&y("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&y("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&y("material",f,"b4w_procedural_skydome");"b4w_lens_flares"in f||(f.b4w_lens_flares=!1,b("material",f,"b4w_lens_flares"));"LENS_FLARES"===f.name&&(f.b4w_lens_flares||q.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),f.b4w_lens_flares=!0);f.b4w_water&&("b4w_water_shore_smoothing"in
f||(f.b4w_water_shore_smoothing=!1,b("material",f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in f||(f.b4w_water_dynamic=!1,b("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=1,b("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,b("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,b("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=
.03,b("material",f,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=1.3,b("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=1,b("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,b("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,b("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
f||(f.b4w_water_dir_noise_scale=.05,b("material",f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in f||(f.b4w_water_dir_noise_freq=.07,b("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in f||(f.b4w_water_dir_min_noise_fac=.5,b("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,b("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,b("material",f,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=6,b("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in f||(f.b4w_water_fog_color=[.5,.7,.7],b("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in f||(f.b4w_foam_factor=5,b("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,b("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,b("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=
64,b("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in f||(f.b4w_water_detailed_dist=1E3,b("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,b("material",f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,b("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,b("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color="");"diffuse_intensity"in f||(f.diffuse_intensity=1,b("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in f||(f.b4w_collision_margin=.04,b("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,b("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,b("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=
!1,b("material",f,"b4w_do_not_render"));"HALO"!=f.type||"b4w_halo_sky_stars"in f||(f.b4w_halo_sky_stars=!1,b("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=10,b("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,b("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",b("material",f,"specular_shader"));"diffuse_shader"in
f||(f.diffuse_shader="LAMBERT",b("material",f,"diffuse_shader"));"roughness"in f||(f.roughness=.5,b("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,b("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in f||(f.diffuse_fresnel_factor=.5,b("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,b("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,b("material",f,"specular_toon_size"));"specular_toon_smooth"in f||
(f.specular_toon_smooth=.1,b("material",f,"specular_toon_smooth"));"specular_alpha"in f||(f.specular_alpha=1,b("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,b("material",f,"b4w_wettable"));"b4w_refractive"in f||(f.b4w_refractive=!1,b("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,b("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],b("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=
[0,.9,.2],b("material",f,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in f||(f.b4w_shallow_water_col_fac=1,b("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,b("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,b("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,b("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=
!1,b("material",f,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in f||(f.b4w_water_norm_uv_velocity=.05,b("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,b("material",f,"specular_ior"));"darkness"in f||(f.darkness=0,b("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,b("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,b("material",f,"diffuse_toon_smooth"));"pass_index"in f||(f.pass_index=0,b("material",
f,"pass_index"));g=f.texture_slots;for(m=0;m<g.length;m++)e=g[m],"blend_type"in e||(e.blend_type="MIX",b("texture_slot",e,"blend_type"));if(f.node_tree){g=f.node_tree.nodes;for(m=0;m<g.length;m++)l(g[m]);f.node_tree.animation_data&&d(f.node_tree.animation_data)}}e=a.node_groups;for(h=0;h<e.length;h++)for(g=e[h].node_tree.nodes,m=0;m<g.length;m++)l(g[m]);g=a.objects;for(h=0;h<g.length;h++){e=g[h];switch(e.type){case "MESH":"b4w_dynamic_geometry"in e||(e.b4w_dynamic_geometry=!1);"b4w_reflexible"in e||
(e.b4w_reflexible=!1);"b4w_reflexible_only"in e||(e.b4w_reflexible_only=!1);"b4w_reflective"in e||(e.b4w_reflective=!1);"b4w_reflection_type"in e||(e.b4w_reflection_type="PLANE",b("object",e,"b4w_reflection_type"));"b4w_wind_bending"in e||(e.b4w_wind_bending=!1,b("object",e,"b4w_wind_bending"));"b4w_wind_bending_angle"in e||(e.b4w_wind_bending_angle=10,e.b4w_wind_bending_freq=.25,b("object",e,"wind bending params"));"b4w_detail_bending_amp"in e||(e.b4w_detail_bending_amp=.1,e.b4w_branch_bending_amp=
.3,b("object",e,"detail bending params"));"b4w_detail_bending_freq"in e||(e.b4w_detail_bending_freq=1,b("object",e,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in e||(e.b4w_main_bend_stiffness_col="",b("object",e,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in e||(e.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",e,"b4w_detail_bend_colors"));"b4w_caustics"in e||(e.b4w_caustics=!1);"vertex_groups"in e&&e.vertex_groups.length&&
e.data&&0==e.data.vertex_groups.length&&(e.data.vertex_groups=e.vertex_groups,delete e.vertex_groups,b("object",e,"vertex_groups"));"b4w_vertex_anim"in e&&e.b4w_vertex_anim.length&&e.data&&0==e.data.b4w_vertex_anim.length&&(e.data.b4w_vertex_anim=e.b4w_vertex_anim,delete e.b4w_vertex_anim,b("object",e,"b4w_vertex_anim"));"b4w_do_not_render"in e||(e.b4w_do_not_render=!1);"b4w_hidden_on_load"in e||(e.b4w_hidden_on_load=!1);"use_ghost"in e.game||(e.game.use_ghost=!1);"use_sleep"in e.game||(e.game.use_sleep=
!1);"velocity_min"in e.game||(e.game.velocity_min=0);"velocity_max"in e.game||(e.game.velocity_max=0);"collision_group"in e.game||(e.game.collision_group=1);"collision_mask"in e.game||(e.game.collision_mask=255);m=e;c=m.game;f=c.collision_bounds_type;c.use_collision_bounds&&"BOX"!=f&&"CYLINDER"!=f&&"CONE"!=f&&"SPHERE"!=f&&"CAPSULE"!=f&&"EMPTY"!=f&&(q.error("Wrong collision bounds type "+f+". Disable physics for object "+m.name),m.b4w_collision=!1,m.b4w_floating=!1,m.b4w_vehicle=!1,m.b4w_character=
!1);"b4w_vehicle_settings"in e?e.b4w_vehicle_settings&&("steering_ratio"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.steering_ratio=10),"steering_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.steering_max=1),"inverse_control"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.inverse_control=!1),"force_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.force_max=1500),"brake_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.brake_max=100),"speed_ratio"in e.b4w_vehicle_settings||
(e.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.floating_factor=3),"floating_factor"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in e.b4w_vehicle_settings||
(e.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.water_rot_damp=.9)):(e.b4w_vehicle_settings=null,b("object",e,"b4w_vehicle_settings"));"b4w_floating_settings"in e?e.b4w_floating_settings&&("floating_factor"in e.b4w_floating_settings||(e.b4w_floating_settings.floating_factor=3),"water_lin_damp"in e.b4w_floating_settings||(e.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in e.b4w_floating_settings||(e.b4w_floating_settings.water_rot_damp=
.8)):(e.b4w_floating_settings=null,b("object",e,"b4w_floating_settings"));"b4w_character_settings"in e?e.b4w_character_settings&&("walk_speed"in e.b4w_character_settings||(e.b4w_character_settings.walk_speed=4),"run_speed"in e.b4w_character_settings||(e.b4w_character_settings.run_speed=8),"step_height"in e.b4w_character_settings||(e.b4w_character_settings.step_height=.25),"jump_strength"in e.b4w_character_settings||(e.b4w_character_settings.jump_strength=5),"waterline"in e.b4w_character_settings||
(e.b4w_character_settings.waterline=0)):(e.b4w_character_settings=null,b("object",e,"b4w_character_settings"));"b4w_selectable"in e||(e.b4w_selectable=!1,b("object",e,"b4w_selectable"));"b4w_outlining"in e||(e.b4w_outlining=!1,b("object",e,"b4w_outlining"));"b4w_outline_on_select"in e||(e.b4w_outline_on_select=!1,b("object",e,"b4w_outline_on_select"));"b4w_billboard"in e||(e.b4w_billboard=!1,b("object",e,"b4w_billboard"));"b4w_billboard_geometry"in e||(e.b4w_billboard_geometry="SPHERICAL",b("object",
e,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in e||(e.b4w_pres_glob_orientation=!1,b("object",e,"b4w_pres_glob_orientation"));"b4w_outline_settings"in e||("b4w_glow_settings"in e?e.b4w_outline_settings=e.b4w_glow_settings:(e.b4w_outline_settings={},e.b4w_outline_settings.outline_duration=1,e.b4w_outline_settings.outline_period=1,e.b4w_outline_settings.outline_relapses=0),b("object",e,"b4w_outline_settings"));"b4w_lod_transition"in e||(e.b4w_lod_transition=.01,b("object",e,"b4w_lod_transition"));
"lod_levels"in e||(e.lod_levels=[],b("object",e,"lod_levels"));"b4w_animation_mixing"in e||(e.b4w_animation_mixing=!1,b("object",e,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in e||(e.b4w_anchor=null,b("object",e,"b4w_anchor")),!e.b4w_anchor||"max_width"in e.b4w_anchor||(e.b4w_anchor.max_width=250)}"collision_margin"in e.game||(e.game.collision_margin=.04,b("object",e,"collision_margin"));"b4w_anim_behavior"in e||(e.b4w_anim_behavior=e.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
e,"b4w_anim_behavior"));if(!("rotation_quaternion"in e)){m=[0,0,0,1];t.gk(e.rotation_euler,m);var c=m,f=m[0],w=m[1],n=m[2];c[0]=m[3];c[1]=f;c[2]=w;c[3]=n;e.rotation_quaternion=m;b("object",e,"rotation_quaternion")}"webgl_do_not_batch"in e&&(e.b4w_do_not_batch=e.webgl_do_not_batch)&&y("object",e,"webgl_do_not_batch");"b4w_shadow_cast_only"in e||(e.b4w_shadow_cast_only=!1,b("object",e,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in e||(e.b4w_correct_bounding_offset="AUTO",b("object",e,"b4w_correct_bounding_offset"));
c=e.particle_systems;for(m=0;m<c.length;m++)f=c[m],w=f.settings,"use_rotation_dupli"in w||(w.use_rotation_dupli=!1,b("particle_settings",w,"use_rotation_dupli")),"use_whole_group"in w||(w.use_whole_group=!1,b("particle_settings",w,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,b("particle_system",f,"transforms")),"b4w_billboard_align"in w||(w.b4w_billboard_align="VIEW",b("particle_settings",w,"b4w_billboard_align")),"b4w_dynamic_grass"in w||(w.b4w_dynamic_grass=!1,b("object",w,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in w||(w.b4w_dynamic_grass_scale_threshold=.01,b("object",w,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in w||(w.b4w_initial_rand_rotation=!1,b("particle_settings",w,"b4w_initial_rand_rotation")),"b4w_rotation_type"in w||(w.b4w_rotation_type="Z",b("particle_settings",w,"b4w_rotation_type")),"b4w_rand_rotation_strength"in w||(w.b4w_rand_rotation_strength=1,b("particle_settings",w,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in w||(w.b4w_hair_billboard=
!1,b("particle_settings",w,"b4w_hair_billboard")),"b4w_hair_billboard_type"in w||(w.b4w_hair_billboard_type="BASIC",b("particle_settings",w,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in w||(w.b4w_hair_billboard_jitter_amp=0,b("particle_settings",w,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in w||(w.b4w_hair_billboard_jitter_freq=0,b("particle_settings",w,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in w||(w.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",w,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in w||(w.b4w_wind_bend_inheritance="PARENT",b("particle_settings",w,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in w||(w.b4w_shadow_inheritance="PARENT",b("particle_settings",w,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in w||(w.b4w_reflection_inheritance="PARENT",b("particle_settings",w,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in w||(w.b4w_vcol_from_name="",b("particle_settings",w,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in w||(w.b4w_vcol_to_name="",b("particle_settings",w,"b4w_vcol_to_name")),"b4w_coordinate_system"in w||(w.b4w_coordinate_system="LOCAL",b("particle_settings",w,"b4w_coordinate_system")),"b4w_allow_nla"in w||(w.b4w_allow_nla=!0,b("particle_settings",w,"b4w_allow_nla")),"b4w_enable_soft_particles"in w||(w.b4w_enable_soft_particles=!1,b("particle_settings",w,"b4w_enable_soft_particles")),"b4w_particles_softness"in w||(w.b4w_particles_softness=1,b("particle_settings",w,"b4w_particles_softness")),
"billboard_tilt"in w||(w.billboard_tilt=0,b("particle_settings",w,"billboard_tilt")),"billboard_tilt_random"in w||(w.billboard_tilt_random=0,b("particle_settings",w,"billboard_tilt_random")),"use_rotations"in w||(w.use_rotations=!1,b("particle_settings",w,"use_rotations"));"constraints"in e||(e.constraints=[],b("object",e,"constraints"));c=e.modifiers;for(m=0;m<c.length;m++){a:{f=c[m];switch(f.type){case "ARRAY":if(!("fit_type"in f)){q.error("WARNING Incomplete modifier "+String(f.type)+' for "'+
e.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=!0}f||(c.splice(m,1),m--)}"animation_data"in e||(e.animation_data={action:null,nla_tracks:[]},b("object",e,"animation_data"));e.animation_data&&("action"in e.animation_data||(e.animation_data.action=null,r("no action in animation data "+e.name)),"nla_tracks"in e.animation_data||(e.animation_data.nla_tracks=[],r("no NLA in animation data "+e.name)),d(e.animation_data));"b4w_collision_id"in e||(e.b4w_collision_id="",b("object",e,
"b4w_collision_id"));"b4w_viewport_alignment"in e||(e.b4w_viewport_alignment=null,b("object",e,"b4w_viewport_alignment"));"pinverse_tsr"in e||(e.pinverse_tsr=null,b("object",e,"pinverse_tsr"));"b4w_cluster_data"in e||(e.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",e,"b4w_cluster_data"));"pass_index"in e||(e.pass_index=0,b("object",e,"pass_index"));(0>e.scale[0]||0>e.scale[1]||0>e.scale[2])&&r('negative scale for object "'+e.name+'", can lead to some errors');m=
e.scale;0==m[0]&&0==m[1]&&0==m[2]?m=!0:(c=Math.abs((m[1]-m[2])/m[1]),m=.005>Math.abs((m[0]-m[1])/m[0])&&.005>c);m||r("non-uniform scale for object "+e.name)}for(var u in B)h=B[u],m=u.match(/.*?(?=>>|$)/i)[0],q.warn('Property "'+String(m)+'" is '+h.PL+' for "'+h.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.tS=function(a,b){"num_channels"in a||(a.num_channels=1,r('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.uR=function(a){var b;a:{b=
a.modifiers;for(var d=0;d<b.length;d++){var k=b[d].type;if("ARRAY"==k||"CURVE"==k){b=!0;break a}}b=!1}if(!b)return null;b=A(a.data,a.data.name+"_MOD");a=a.modifiers;for(d=0;d<a.length;d++){var g=a[d];switch(g.type){case "ARRAY":for(var k=b,l=g,e=0,q=0,n=0,r=new Float32Array(16),g=[],y=1;y<l.count;y++){l.use_constant_offset&&(e+=l.constant_offset_displace[0],q+=l.constant_offset_displace[1],n+=l.constant_offset_displace[2]);if(l.use_relative_offset)var F=k.b4w_bounding_box,e=e+(F.max_x-F.min_x)*l.relative_offset_displace[0],
q=q+(F.max_y-F.min_y)*l.relative_offset_displace[1],n=n+(F.max_z-F.min_z)*l.relative_offset_displace[2];t.N_(e,q,n,r);for(var B=F=A(k),D=r,L=z.fromMat4(D,O),L=f.fromMat3(L,K),H=0;H<B.submeshes.length;H++){var G=B.submeshes[H];t.Po(G.position,D,G.position,0);t.HL(G.tbn_quat,L,G.tbn_quat,0)}g.push(F)}for(y=0;y<g.length;y++)for(l=k,e=g[y],q=0;q<l.submeshes.length;q++){n=l.submeshes[q];r=e.submeshes[q];F=n.base_length;B=n.indices.length;n.base_length+=r.base_length;for(var V in n)if("base_length"!=V&&
"boundings"!=V)if("indices"==V)for(n[V]=t.U_(n[V],r[V]),D=B;D<n.indices.length;D++)n.indices[D]+=F;else"vertex_colors"!=V&&(n[V]=t.eV(n[V],r[V]))}break;case "CURVE":for(k=b,y=u.CT(g.object),l=new Float32Array(16),q=y.tk?4:3,e=new Float32Array(q),q=new Float32Array(q),n=new Float32Array(3),r=new Float32Array(4),F=new Float32Array(4),B=new Float32Array(3),D=new Float32Array(3),L=new Float32Array(3),new Float32Array(4),new Float32Array(4),H=0;H<k.submeshes.length;H++){var P=k.submeshes[H],G=P.position,
P=P.tbn_quat,W;a:{W=g.deform_axis;switch(W){case "POS_X":case "NEG_X":W=0;break a;case "POS_Y":case "NEG_Y":W=1;break a;case "POS_Z":case "NEG_Z":W=2;break a;default:t.q("Wrong deform axis value "+W)}W=void 0}B[0]=0;B[1]=0;B[2]=0;B[W]=1;for(var ha=u.p_(y),v=0;v<G.length/3;v++){L[0]=G[3*v];L[1]=G[3*v+1];L[2]=G[3*v+2];var aa=L[W],Z=u.o_(y,aa);u.q_(y,Z,e);n[0]=e[0];n[1]=e[1];n[2]=e[2];u.n_(y,Z,q);D[0]=q[0];D[1]=0;D[2]=q[2];c.normalize(D,D);f.rotationTo(B,D,r);0>aa?(e[0]=D[0],e[1]=D[1],e[2]=D[2],c.scale(e,
aa,e),c.add(n,e,n)):aa>ha&&(e[0]=D[0],e[1]=D[1],e[2]=D[2],c.scale(e,aa-ha,e),c.add(n,e,n));m.fromRotationTranslation(r,n,l);y.tk&&(f.setAxisAngle(B,e[3],F),c.transformQuat(L,F,L));L[W]=0;c.transformMat4(L,l,L);G[3*v]=L[0];G[3*v+1]=L[1];G[3*v+2]=L[2];P.length&&(K[0]=P[4*v],K[1]=P[4*v+1],K[2]=P[4*v+2],K[3]=P[4*v+3],f.multiply(K,r,K),P[4*v]=K[0],P[4*v+1]=K[1],P[4*v+2]=K[2],P[4*v+3]=K[3])}}}h.FY(b)}return b};a.rT=function(){return{name:"DEFAULT",uuid:t.DB(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,
.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],
b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.BR=function(a,b){function c(b,e){for(var d in b){var f=b[d],h=f[0];if(1<f.length)for(var k=1;k<f.length;k++)h+="*"+f[k];for(k=0;k<a.length;k++)if(f=a[k],f.name==h)for(var g in e)f[g]=e[g]}}for(var d=b.b4w_logic_nodes,f=0;f<d.length;f++)for(var h=d[f],e=0;e<h.length;e++){var g=h[e],n={register1:"variable1",register2:"variable2",registerd:"variabled"},m;for(m in n)m in g&&(g[n[m]]=g[m]);for(var l in g.variables)"boolean"!=
typeof g.variables[l][0]&&(g.variables[l]=[!1,g.variables[l]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(g.type)&&("variable1"in g&&(g.variables.v1=[!1,g.variable1]),"variable2"in g&&(g.variables.v2=[!1,g.variable2]),"variabled"in g&&(g.variables.vd=[!1,g.variabled]));switch(g.type){case "SELECT":for(var q=0;q<a.length;q++)n=a[q],n.name==g.object&&(n.b4w_selectable=!0);g.bools||(g.bools={});g.bools.not_wait||(g.bools.not_wait=!1);r('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(g.objects_paths,
{b4w_selectable:!0});if(g.links instanceof Array){r('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var n={},u=0;for(q in g.objects_paths)n[q]=g.links[u],u++;g.links=n}break;case "SELECT_PLAY":r('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');g.mute=!0;break;case "SELECT_PLAY_ANIM":r('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(g.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(g.objects_paths,{b4w_do_not_batch:!0});switch(g.common_usage_names.space_type){case "WORLD":g.common_usage_names.space_type=L.DP;break;case "PARENT":g.common_usage_names.space_type=L.CP;break;case "LOCAL":g.common_usage_names.space_type=L.BP}break;case "OUTLINE":c(g.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":g.condition&&(g.common_usage_names.condition=
g.condition);if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=L.yF;break;case "LEQUAL":g.common_usage_names.condition=L.AF;break;case "GREATER":g.common_usage_names.condition=L.zF;break;case "LESS":g.common_usage_names.condition=L.BF;break;case "NOTEQUAL":g.common_usage_names.condition=L.CF;break;case "EQUAL":g.common_usage_names.condition=L.xF}void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&
(g.input2=g.number2);g.bools||(g.bools={});void 0===g.bools.str&&(g.bools.str=!1,g.floats.inp1=g.input1,g.floats.inp2=g.input2);break;case "SEND_REQ":g.bools||(g.bools={});g.strings||(g.strings={});void 0===g.bools.ct&&(g.bools.ct=!1);void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "MATH":void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&(g.input2=g.number2);void 0!=g.input1&&(g.floats.inp1=g.input1);void 0!=g.input2&&(g.floats.inp2=g.input2);break;case "REGSTORE":g.floats||
(g.floats={});g.strings||(g.strings={});void 0!=g.number1&&(g.input1=g.number1);if(void 0!=g.input1)switch(typeof g.input1){case "number":g.floats.inp1=g.input1;g.common_usage_names.variable_type="NUMBER";break;default:g.strings.inp1=g.input1,g.common_usage_names.variable_type="STRING"}switch(g.common_usage_names.variable_type){case "NUMBER":g.common_usage_names.variable_type=L.EP;break;case "STRING":g.common_usage_names.variable_type=L.FP}break;case "PAGEPARAM":g.bools||(g.bools={});void 0===g.bools.hsh&&
(g.bools.hsh=!1);g.floats||(g.floats={});void 0===g.floats.ptp&&(g.floats.ptp=0);break;case "PLAY_ANIM":c(g.objects_paths,{b4w_do_not_batch:!0});g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);(n=g.common_usage_names.param_anim_behavior)||(n="FINISH_STOP");g.common_usage_names.param_anim_behavior=D.Xz(n);break;case "STOP_ANIM":g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);break;case "STRING":switch(g.common_usage_names.string_operation){case "JOIN":g.common_usage_names.string_operation=
L.yP;break;case "FIND":g.common_usage_names.string_operation=L.xP;break;case "REPLACE":g.common_usage_names.string_operation=L.zP;break;case "SPLIT":g.common_usage_names.string_operation=L.AP;break;case "COMPARE":g.common_usage_names.string_operation=L.wP}if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=L.yF;break;case "LEQUAL":g.common_usage_names.condition=L.AF;break;case "GREATER":g.common_usage_names.condition=
L.zF;break;case "LESS":g.common_usage_names.condition=L.BF;break;case "NOTEQUAL":g.common_usage_names.condition=L.CF;break;case "EQUAL":g.common_usage_names.condition=L.xF}break;case "REDIRECT":void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "SET_CAMERA_MOVE_STYLE":switch(g.common_usage_names.camera_move_style){case "STATIC":g.common_usage_names.camera_move_style=L.pP;break;case "TARGET":g.common_usage_names.camera_move_style=L.qP;break;case "EYE":g.common_usage_names.camera_move_style=
L.nP;break;case "HOVER":g.common_usage_names.camera_move_style=L.oP}break;case "ENTRYPOINT":g.bools||(g.bools={});void 0===g.bools.js&&(g.bools.js=!1);g.bools.js&&(g.mute=!0);break;case "JS_CALLBACK":for(m in g=g.common_usage_names.js_cb_params,g)switch(g[m]){case "OBJECT":g[m]=L.rP;break;case "VARIABLE":g[m]=L.sP}}}}};b4w.module.__logic_nodes=function(a,g){function l(){return function(a,b,c,e){c=e[0];var d=e[1];e=e[2];if(-2==c.state){for(var f=0;f<c.sx;f++)if(K.ud(a,b,f))for(var h=0;h<c.rx.length;h++)if(c.rx[h]==f){d.Pm==c.zN?(L.Rf(d.ra)&&(c.state=-1),e.Xf.Of||(c.state=1,c.et=c.yw[h])):(c.state=1,c.et=c.yw[h]);return}c.state=0}}}function d(){return function(a,b,c,e){c=e[0];var d=e[1];e=e[2];for(var f=0;f<c.sx;f++)if(K.ud(a,b,f)&&f==c.$L){if(L.Rf(d.ra)&&d.Pm==c.zN)c.state=-1;else if(!e.Xf.Of||c.U.no_wait)c.state=
1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Oa:a.slot_idx_order,et:a.slot_idx_jump,va:a.frame_range[0],$a:a.frame_range[1],jV:a.frame_range_mask?a.frame_range_mask[0]:!0,iV:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,sx:-1,$L:-1,hY:a.param_name,fY:a.operation,qc:a.mute,wr:a.object,obj:null,kc:null,vc:null,eb:{},cg:a.anim_name,Bc:t.yl,jY:a.parse_json_vars,iY:a.parse_json_paths,Kc:a.objects_paths,cL:a.nodes_paths,Hb:a.floats,U:a.bools,W:a.variables,zj:a.strings,
BC:a.materials_names,LM:a.shader_nd_type,Ce:a.common_usage_names,IU:a.encode_json_vars,HU:a.encode_json_paths,zN:b,AL:P[a.type]?P[a.type]:h,gx:!1,$x:0,rx:null,tX:a.links,yw:[]}}function y(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function r(a,b,c,e){a[0]?b[a[1]]=e:c[a[1]]=e}function A(a,b,c){switch(b.state){case 2:c.ma=a.Oa}}function h(a,b,c){switch(b.state){case 1:G.error("Unknown node type: "+a.type);break;case 2:c.ma=a.Oa}}function u(a){return D.xc(D.Oc,a.wr||[],0)}function m(a,c){var e=a.b4w_logic_nodes,
d=c.qe;c.state=1;for(var f=0;f<e.length;f++){var h={N:[],Xf:{yb:a,ma:0,Of:!1,vE:f,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};d.push(h);for(var k=d[d.length-1],g=e[f],p=0;p<g.length;p++){var n=b(g[p],k);k.N.push(n)}for(g=0;g<k.N.length;g++)n=k.N[g],n.qc||n.AL(n,c,h.Xf,0,0)}var e=a.timeline_markers,m;for(m in e)c.ft.push(e[m]);c.ft.sort(function(a,b){return a-b});c.state=2;W.push(c)}function q(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function f(a){switch(typeof a){case "string":return q(a,1);case "number":return q(a,0);default:return q(a,1)}}var t=g("__animation"),c=g("__assets"),z=g("__camera"),L=g("__nla"),D=g("__objects"),G=g("__print"),B=g("__scenes"),O=g("__config"),K=g("__controls"),E=g("__batch"),C=g("__geometry"),Q=g("__mat3"),k=g("__mat4"),p=g("__physics"),x=g("__quat"),e=g("__sfx"),w=g("__time"),n=g("__transform"),ea=g("__tsr"),I=g("__util"),F=g("__vec3"),T=new Float32Array(4);new Float32Array(4);var M=new Float32Array(3),
X=new Float32Array(3),H=new Float32Array(2),fa=new Float32Array(9),V=new Float32Array(16);a.EP=0;a.FP=1;a.yP=0;a.xP=1;a.zP=2;a.AP=3;a.wP=4;a.yF=0;a.AF=1;a.zF=2;a.BF=3;a.CF=4;a.xF=5;a.DP=0;a.CP=1;a.BP=2;a.pP=0;a.qP=1;a.nP=2;a.oP=3;a.rP=0;a.sP=1;var P={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.ma=a.Oa}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=u(a);a.obj||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:B.Nq(a.obj,!0),c.ma=a.Oa}},SHOW:function(a,
b,c){switch(b.state){case 1:a.obj=u(a);a.obj||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:B.Nq(a.obj,!1),c.ma=a.Oa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var e=a.W.vd;b=b.u;var d=c.u,f;a:{f=a.hY;var h=a.Hb.ptp,k=a.U.hsh,g=O.get("url_params");if(g&&f in g)f=Number(g[f]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),g=0;g<k.length;g++){var p=k[g].split("=");if(1<p.length&&p[0]==f){f=q(p[1],h);break a}}f=0}}r(e,b,d,f);c.ma=
a.Oa}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.qe[c.vE];var e=D.GJ();a.rx=[];a.yw=[];for(var d in a.Kc){var f=D.xc(D.Oc,a.Kc[d],0),h=e.indexOf(f);if(-1==h){G.error("logic script error: non-selectable object:",a.Kc[d][a.Kc[d].length-1]);break a}a.rx.push(h);a.yw.push(a.tX[d])}a.state=-1;a.sx=e.length;d=[];for(h=0;h<e.length;h++)d.push(K.$u(e[h],!1));K.K(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,K.Qd,d,K.iv,l(),[a,b,c])}break;case 2:if(-1==a.state){b=b.qe[c.vE].N;for(f=0;f<b.length;f++)e=
b[f],"SWITCH_SELECT"==e.type&&(e.state=-1);a.state=-2}if(0==a.state||1==a.state)c.ma=a.state?a.et:a.Oa,a.state=-1}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.qe[c.vE];var e=u(a),f=D.GJ(),h=f.indexOf(e);if(-1==h)G.error("logic script error: non-selectable object:",a.wr[a.wr.length-1]);else{a.state=-1;a.sx=f.length;a.$L=h;for(var h=[],k=0;k<f.length;k++)h.push(K.$u(f[k],!1));K.K(e,"LOGIC_NODES_SELECT_"+a.label,K.Qd,h,K.iv,d(),[a,b,c])}break;case 2:if(0==a.state||1==a.state){c.ma=a.state?a.et:
a.Oa;a.state=-1;break}a.U.not_wait&&(c.ma=a.Oa)}},PLAY:function(a,b,c,e){switch(b.state){case 1:L.hN();a.state=-1;a.U.not_wait||(a.U.not_wait=!1);break;case 2:switch(a.state){case -1:if(L.Rf(b.ra))if(b.bB==b.Pm&&c.Of)break;else{var d=b.Pm;if(d){d.Xf.ma=d.N[d.Xf.ma].Oa;d.N[d.Xf.ma].state=-1;for(var d=b.Pm.N,f=0;f<d.length;f++){var h=d[f];"PLAY"==h.type&&(h.state=-1)}}}c.Of=!a.U.not_wait;b.Pm=b.bB;a.state=0;a.jV&&(L.HZ(a.va),L.uM(e));if(a.iV)L.RD(a.$a);else{e=L.oo(e);var d=-1,k;for(k in b.ft)if(e<b.ft[k]){d=
k;break}0<=d?L.RD(b.ft[d]):L.RD(L.mJ())}L.tY();a.U.not_wait&&(c.ma=a.Oa,a.state=-1,c.Of=!1);break;case 0:L.Rf()||(c.ma=a.Oa,a.state=-1,c.Of=!1);break;case 1:c.ma=a.Oa;a.state=-1;b.Pm=null;c.Of=!1;break;default:I.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.U.url?q(y(a.W.url,b.u,c.u),1):a.zj.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var e=-1==a.W.v1[1]?a.Hb.inp1:q(y(a.W.v1,b.u,c.u),0),d=-1==a.W.v2[1]?a.Hb.inp2:
q(y(a.W.v2,b.u,c.u),0),f=0;switch(a.fY){case "ADD":f=e+d;break;case "MUL":f=e*d;break;case "SUB":f=e-d;break;case "DIV":0==d&&I.q("Division by zero in Logic script");f=e/d;break;case "RAND":f=Math.random()*(d-e)+e}r(a.W.vd,b.u,c.u,f);c.ma=a.Oa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var e=a.U.str?1:0,d=a.U.str?a.zj:a.Hb,f=-1==a.W.v1[1]?d.inp1:q(y(a.W.v1,b.u,c.u),e);b=-1==a.W.v2[1]?d.inp2:q(y(a.W.v2,b.u,c.u),e);e=!1;switch(a.Ce.condition){case 5:f==b&&(e=!0);break;case 4:f!=b&&(e=!0);break;
case 3:f<b&&(e=!0);break;case 2:f>b&&(e=!0);break;case 1:f<=b&&(e=!0);break;case 0:f>=b&&(e=!0)}c.ma=e?a.et:a.Oa}},REGSTORE:function(a,b,c){switch(b.state){case 2:r([a.U.gl||a.W.vd[0],a.W.vd[1]],b.u,c.u,(1==a.Ce.variable_type?a.zj:a.Hb).inp1),c.ma=a.Oa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.U.env?D.Ov(a.wr[0],0):u(a);a.obj||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:switch(0!=a.state||t.Rf(a.obj,a.Bc)||(a.state=1),a.state){case -1:for(var e in b.qe){var d=
b.qe[e].Xf.ma;-1!=d&&(d=b.qe[e].N[d],"PLAY_ANIM"==d.type&&d!=a&&0==d.state&&d.obj==a.obj&&(d.state=1))}b=a.Ce.param_anim_behavior;if(""==a.cg)t.yu(a.obj),t.cn(a.obj,b,t.yl);else{a:{e=a.obj;for(var d=a.cg,f=-1,h=0;8>h;h++){var k=e.ia[h];if(k&&k.Ji&&t.kN(k.Ji)==t.kN(d))if(-1!=f)f=h;else{e=-1;break a}}e=f}-1==e?(a.Bc=t.a_(a.obj,a.cg),t.apply(a.obj,null,a.cg,a.Bc)):a.Bc=e;t.cn(a.obj,b,a.Bc)}a.U.not_wait||(c.Of=!0);t.play(a.obj,null,a.Bc);a.state=0;a.U.not_wait&&(c.ma=a.Oa,a.state=-1);break;case 0:break;
case 1:a.U.not_wait||(c.Of=!1);c.ma=a.Oa;a.state=-1;break;default:I.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:A,SEND_REQ:function(a,b,e){function d(a,c,f,h,k){a=JSON.stringify(a);r(k[0].W.dst,b.u,e.u,a);k[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var f=a.U.url?q(y(a.W.url,b.u,e.u),1):a.zj.url,h={};a.U.ct&&(h["Content-Type"]=a.zj.ct);"GET"==a.Ce.request_type?c.Yd([{id:f,type:c.Bn,url:f,Jk:h,Jb:[a,e.u]}],d,null,null,null):"POST"==a.Ce.request_type&&c.Yd([{id:f,
type:c.Bn,url:f,Jk:h,mi:"POST",Qo:c.Bn,Xm:q(y(a.W.dst1,b.u,e.u),1),Jb:[a,e.u]}],d,null,null,null);break;case 1:a.state=-1,e.ma=a.Oa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.eb["id"+b]=D.xc(D.Oc,a.Kc["id"+b],0),a.eb["id"+b]||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:E.yW(a.eb.id0,a.BC.id0,a.eb.id1,a.BC.id1),c.ma=a.Oa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Kc.id0&&(a.eb.id0=D.xc(D.Oc,a.Kc.id0,0),a.Kc.id0||
(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0),a.cL.id0.unshift(a.BC.id0));break;case 2:var e=a.eb.id0,d=a.cL.id0,f=d[0],h=E.$U(e,f,"MAIN");c.ma=a.Oa;if(null===h){G.error('Material "'+f+'" was not found in the object "'+e.name+'".');break}if("ShaderNodeRGB"==a.LM){var k=E.uJ(h.kj,d);E.DZ(e,f,k,a.U.id0?q(y(a.W.id0,b.u,c.u),0):a.Hb.id0,a.U.id1?q(y(a.W.id1,b.u,c.u),0):a.Hb.id1,a.U.id2?q(y(a.W.id2,b.u,c.u),0):a.Hb.id2)}"ShaderNodeValue"==a.LM&&(k=E.uJ(h.lj,d),E.EZ(e,f,k,a.U.id0?
q(y(a.W.id0,b.u,c.u),0):a.Hb.id0))}},DELAY:function(a,b,c,e,d){switch(b.state){case 2:-1==a.state?(a.state=0,a.$x=0,c.Of=!0):0==a.state&&(a.$x+=d,(a.U.dl?q(y(a.W.dl,b.u,c.u),0):a.Hb.dl)<a.$x&&(a.state=-1,c.ma=a.Oa,c.Of=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.eb.id0=D.xc(D.Oc,a.Kc.id0,0);b||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);c=a.Ce.sk;C.IS(b)?C.rW(b,c)||(G.error("Wrong key name:",c),a.qc=!0):(G.error("No shape keys in object:",b.name),
a.qc=!0);break;case 2:C.vR(a.eb.id0,a.Ce.sk,a.U.skv?q(y(a.W.skv,b.u,c.u),0):a.Hb.skv),c.ma=a.Oa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var e=a.eb.id0=D.xc(D.Oc,a.Kc.id0,0);e||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);e&&e.k&&e.k.Wc||(G.error("Can't evaluate 'Outline' logic node: wrong object"),a.qc=!0);break;case 2:e=a.eb.id0;switch(a.Ce.outline_operation){case "PLAY":b=e.k.hi;D.Mn(e,b.Gk,b.Hk,b.Ik);break;case "STOP":D.Qu(e);break;case "INTENSITY":e.k.sh=a.U["in"]?
q(y(a.W["in"],b.u,c.u),0):a.Hb["in"]}c.ma=a.Oa}},MOVE_CAMERA:function(a,b,c){function e(a,b,c,d){switch(z.um(a)){case z.Kb:z.at(a,b,c);break;case z.od:case z.Jg:n.vj(a,d);break;case z.cd:F.sub(c,b,M),F.normalize(M,M),z.zx(a,c),c=b=0,X[0]=M[0],X[1]=0,X[2]=M[2],b=F.dot(X,M),c=Math.acos(b/(F.length(X)*F.length(M))),b=M[2]?Math.atan(M[0]/M[2]):0<M[0]?0:Math.PI,0<M[2]&&0<M[0]?H[1]=-(Math.PI+H[1]):0<M[2]&&0>M[0]?H[1]=-(Math.PI+H[1]):0>M[2]&&0>M[0]?(H[0]+=Math.PI,b=-(Math.PI-b)):0>M[2]&&0<M[0]&&(H[0]+=Math.PI,
b-=Math.PI),z.Us(a,b+Math.PI,-c,!0,!0)}n.D(a);p.H(a)}function d(a,b,c,e){k.lookAt(b,c,I.nc,V);k.invert(V,V);Q.fromMat4(V,fa);x.fromMat3(fa,T);x.normalize(T,T);a=ea.td(a.k.n);ea.Ag(b,a,T,e)}switch(b.state){case 1:var f=null,f=a.eb.ca=D.xc(D.Oc,a.Kc.id0,0);f||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.eb.tr=D.xc(D.Oc,a.Kc.id1,0);a.eb.tr||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.eb.ta=D.xc(D.Oc,a.Kc.id2,0);a.eb.ta||(G.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0);a.state=-1;a.vc={HN:new Float32Array(3),GN:new Float32Array(3),kC:new Float32Array(3),rE:new Float32Array(3),uN:new Float32Array(3),jC:new Float32Array(3),jl:new Float32Array(8),wi:new Float32Array(8),$r:new Float32Array(8)};break;case 2:var h=a.eb.ca,f=ea.F(a.eb.tr.k.n),g=ea.F(a.eb.ta.k.n);switch(a.state){case -1:b=a.U.dur?q(y(a.W.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(h,f,g,a.vc.wi);e(h,f,g,a.vc.wi);c.ma=a.Oa;break}c=ea.F(h.k.n);F.copy(c,a.vc.HN);var m=z.um(h);m==z.cd?F.copy(h.k.Vb,
a.vc.rE):m==z.Jg||m==z.od?(ea.copy(h.k.n,a.vc.jl),d(h,f,g,a.vc.wi)):F.copy(h.k.pivot,a.vc.rE);F.copy(f,a.vc.GN);F.copy(g,a.vc.uN);a.state=0;var l=w.Pj(0,1,1E3*b,function(b){B.Da()&&(m==z.Jg||m==z.od?ea.as(a.vc.jl,a.vc.wi,I.hn(b),a.vc.$r):(a.vc.jC=F.lerp(a.vc.rE,a.vc.uN,I.hn(b),a.vc.jC),a.vc.kC=F.lerp(a.vc.HN,a.vc.GN,I.hn(b),a.vc.kC)),e(h,a.vc.kC,a.vc.jC,a.vc.$r),1==b&&(a.state=1))});break;case 1:w.Rn(l),a.state=-1,c.ma=a.Oa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var e=null,
e=a.eb.ca=D.xc(D.Oc,a.Kc.id0,0);e||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);b=e.k;a.mS={el:b.el,use_panning:b.use_panning,lb:b.lb,ka:b.ka,sb:b.sb,Cc:b.Cc,Dc:b.Dc,ge:b.ge,Vh:b.Vh};break;case 2:var e=a.eb.ca,d=e.k,f=a.mS;z.Ft(e);switch(a.Ce.camera_move_style){case 0:d.ub=z.Jg;break;case 2:d.ub=z.od;var h=ea.F(d.n);z.TZ(e,h,null,f.lb,f.ka);break;case 3:d.ub=z.cd;var h=ea.F(d.n),k=M;a.U.pvo?(k=D.xc(D.Oc,a.Kc.id1,0),k=ea.F(k.k.n)):(k[0]=a.U.pvx?q(y(a.W.pvx,b.u,c.u),0):a.Hb.pvx,
k[1]=a.U.pvy?q(y(a.W.pvy,b.u,c.u),0):a.Hb.pvy,k[2]=a.U.pvz?q(y(a.W.pvz,b.u,c.u),0):a.Hb.pvz);z.IM(e,h,k,f.sb,f.ka,f.Cc,f.Dc,f.Vh);break;case 1:d.ub=z.Kb,h=ea.F(d.n),k=M,a.U.pvo?(k=D.xc(D.Oc,a.Kc.id1,0),k=ea.F(k.k.n)):(k[0]=a.U.pvx?q(y(a.W.pvx,b.u,c.u),0):a.Hb.pvx,k[1]=a.U.pvy?q(y(a.W.pvy,b.u,c.u),0):a.Hb.pvy,k[2]=a.U.pvz?q(y(a.W.pvz,b.u,c.u),0):a.Hb.pvz),z.JM(e,h,k,f.lb,f.ka,f.P4,f.ge,f.use_panning)}X[0]=a.U.vtr?q(y(a.W.vtr,b.u,c.u),0):a.Hb.vtr;X[1]=a.U.vro?q(y(a.W.vro,b.u,c.u),0):a.Hb.vro;X[2]=a.U.vzo?
q(y(a.W.vzo,b.u,c.u),0):a.Hb.vzo;X[0]=I.V(X[0],0,Infinity);X[1]=I.V(X[1],0,Infinity);X[2]=I.V(X[2],0,.99);d.pl=X[0];d.ol=X[1];d.ql=X[2];n.D(e);p.H(e);z.uo(e);c.ma=a.Oa}},MOVE_TO:function(a,b,c){function e(a,b){n.vj(a,b);n.D(a);p.H(a)}switch(b.state){case 1:a.eb.ob=D.xc(D.Oc,a.Kc.id0,0);a.eb.ob||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.eb.de=D.xc(D.Oc,a.Kc.id1,0);a.eb.de||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.kc={oI:new Float32Array(8),
jB:new Float32Array(8),lK:new Float32Array(8)};break;case 2:var d=a.eb.ob;ea.copy(a.eb.ob.k.n,a.kc.oI);ea.copy(a.eb.de.k.n,a.kc.jB);switch(a.state){case -1:b=a.U.dur?q(y(a.W.dur,b.u,c.u),0):a.Hb.dur;if(0==b){e(d,a.kc.jB);c.ma=a.Oa;break}a.state=0;var f=w.Pj(0,1,1E3*b,function(b){B.Da()&&(a.kc.P7=ea.as(a.kc.oI,a.kc.jB,I.hn(b),a.kc.lK),e(d,a.kc.lK),1==b&&(a.state=1))});break;case 1:w.Rn(f),a.state=-1,c.ma=a.Oa}}},TRANSFORM_OBJECT:function(a,b,c){function e(a,b,c){0==c?n.vj(a,b):n.Hx(a,b);n.D(a);p.H(a)}
switch(b.state){case 1:a.eb.ob=D.xc(D.Oc,a.Kc.id0,0);a.eb.ob||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.kc={Tx:0,jl:new Float32Array(8),wi:new Float32Array(8),$r:new Float32Array(8)};break;case 2:var d=a.eb.ob;switch(a.state){case -1:X[0]=a.U.trx?q(y(a.W.trx,b.u,c.u),0):a.Hb.trx;X[1]=a.U["try"]?q(y(a.W["try"],b.u,c.u),0):a.Hb["try"];X[2]=a.U.trz?q(y(a.W.trz,b.u,c.u),0):a.Hb.trz;M[0]=a.U.rox?q(y(a.W.rox,b.u,c.u),0)*Math.PI/180:a.Hb.rox;M[1]=a.U.roy?q(y(a.W.roy,
b.u,c.u),0)*Math.PI/180:a.Hb.roy;M[2]=a.U.roz?q(y(a.W.roz,b.u,c.u),0)*Math.PI/180:a.Hb.roz;var f=a.U.sc?y(a.W.sc,b.u,c.u):a.Hb.sc;I.gk(M,T);ea.Ag(X,f,T,a.kc.wi);a.kc.Tx=a.Ce.space_type;switch(a.kc.Tx){case 0:n.Rr(d,a.kc.jl);break;case 1:n.Sr(d,a.kc.jl);break;case 2:n.Sr(d,a.kc.jl),ea.multiply(a.kc.jl,a.kc.wi,a.kc.wi)}b=a.U.dur?q(y(a.W.dur,b.u,c.u),0):a.Hb.dur;if(0==b){e(d,a.kc.wi,a.kc.Tx);c.ma=a.Oa;break}a.state=0;f=w.Pj(0,1,1E3*b,function(b){B.Da()&&(ea.as(a.kc.jl,a.kc.wi,I.hn(b),a.kc.$r),e(d,a.kc.$r,
a.kc.Tx),1==b&&(a.state=1))});break;case 1:w.Rn(f),a.state=-1,c.ma=a.Oa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=D.xc(D.Oc,a.Kc.id0,0);a.obj||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);void 0==a.U.not_wait&&(a.U.not_wait=!0);break;case 2:switch(e.WW(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.qe){var f=b.qe[d].Xf.ma;-1!=f&&(f=b.qe[d].N[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.obj==a.obj&&(f.state=1))}a.U.not_wait||(c.Of=!0);
e.sL(a.obj);a.state=0;break;case 0:a.U.not_wait&&(c.ma=a.Oa,a.state=-1);break;case 1:a.U.not_wait||(c.Of=!1);c.ma=a.Oa;a.state=-1;break;default:I.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=D.xc(D.Oc,a.Kc.id0,0);a.obj||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:e.stop(a.obj),c.ma=a.Oa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.U.env?D.Ov(a.wr[0],0):u(a);a.obj||(G.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0);break;case 2:t.stop(a.obj,t.yl),a.U.rst&&t.MD(a.obj,t.yl),c.ma=a.Oa}},STOP_TIMELINE:function(a,b,c,e){switch(b.state){case 2:a.U.rst&&L.uM(e),L.hN(),c.ma=a.Oa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var e={},d;for(d in a.W)e[a.W[d][1]]=y(a.W[d],b.u,c.u);G.log(a.Ce.msg,JSON.stringify(e));c.ma=a.Oa}},STRING:function(a,b,c){switch(b.state){case 2:var e=a.U.id0?q(y(a.W.id0,b.u,c.u),1):a.zj.id0,d=a.U.id1?q(y(a.W.id1,b.u,c.u),1):a.zj.id1,f=0;switch(a.Ce.string_operation){case 0:f=
e+d;break;case 1:f=e.indexOf(d);break;case 2:f=e.replace(d,a.U.id2?q(y(a.W.id2,b.u,c.u),1):a.zj.id2);break;case 3:var h=a.W,f=e.substring(0,e.indexOf(d));r(h.dst1,b.u,c.u,e.substring(e.indexOf(d)+1,e.length));""==y(h.dst,b.u,c.u)&&(f=y(h.dst1,b.u,c.u),r(h.dst1,b.u,c.u,""));break;case 4:switch(a.Ce.condition){case 5:f=e==d?1:0;break;case 4:f=e!=d?1:0;break;case 3:f=e<d?1:0;break;case 2:f=e>d?1:0;break;case 1:f=e<=d?1:0;break;case 0:f=e>=d?1:0}}r(a.W.dst,b.u,c.u,f);c.ma=a.Oa}},GET_TIMELINE:function(a,
b,c,e){switch(b.state){case 2:e=a.U.nla?q(L.oo(e),0):q(w.oo(e),0),r(a.W.vd,b.u,c.u,e),c.ma=a.Oa}},JSON:function(a,b,c){function e(a,b,c,d){for(var h=0;h<b.length;h++){for(var k=b[h].split("."),g=a,p=c[h],n=0;n<k.length&&(g=g[k[n]],void 0!==g&&null!==g);n++);g=f(g);d[p]=g}}function d(a,b,c,e){e||(e={});for(var h=0;h<b.length;h++){var k=b[h].split("."),g=e,p=c[h];if(!(!p in a)){for(var n=0;n<k.length-1;n++)void 0===g[k[n]]&&(g[k[n]]=isNaN(k[n+1])?{}:[]),g=g[k[n]];g[k[k.length-1]]=f(a[p])}}}switch(b.state){case 2:switch(a.Ce.json_operation){case "PARSE":try{var h=
JSON.parse(q(y(a.W.jsn,b.u,c.u),1));e(h,a.iY,a.jY,c.u)}catch(k){G.error("logic script error: non valid JSON string")}break;case "ENCODE":h={},d(c.u,a.HU,a.IU,h),h=q(JSON.stringify(h),1),r(a.W.jsn,b.u,c.u,h)}c.ma=a.Oa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var e=a.U.cb?q(y(a.W.cb,b.u,c.u),1):a.zj.cb,d=[],h=0,k="id"+h,g=a.Ce.js_cb_params;k in g;)k=0==g[k]?D.xc(D.Oc,a.Kc[k],0):y(a.W[k],b.u,c.u),d.push(k),h++,k="id"+h;g=[];h=0;for(k="out"+h;k in a.W;)k=y(a.W[k],b.u,c.u),g.push(k),h++,
k="out"+h;h=1;if(e in ha){if(h=!ha[e](d,g))for(e=0;e<g.length;e++)k="out"+e,k in a.W&&r(a.W[k],b.u,c.u,f(g[e]))}else G.error("logic script error: no custom callback with id "+e);h&&(c.ma=a.Oa)}},EMPTY:A},W=[],ha={};a.BW=function(a,b){var c={$e:b,YL:a.name,state:0,Pm:null,yb:a,bB:null,qe:[],ft:[],u:{}};a.d3=c;m(a,c)};a.update=function(a,b){var c=L.fW();if(!(0>=c))for(var e=0;e<W.length;e++)for(var d=e,f=a,h=b,k=c,g=W[d],p=0;p<W[d].qe.length;p++){g.bB=W[d].qe[p];var n=W[d].qe[p],m=g,l=f,q=h,r=k,w=n.N;
if(w.length){for(var u=0;u<w.length;u++)w[u].gx=!1;for(u=0;u<w.length;u++){if(0<=n.Xf.ma)var x=w[n.Xf.ma];else break;if(x.gx)break;if(x.qc)if("ENTRYPOINT"==x.type)break;else n.Xf.ma=x.Oa,x.gx=!0;else x.AL(x,m,n.Xf,l,q,r),x.gx=!0}}}};a.h3=function(a,b){ha[a]=b};a.W8=function(a){delete ha[a]};a.h9=function(a,b){for(var c=0;c<W.length;c++)if(W[c].YL==a){for(var c=W[c],e=0;e<c.qe.length;e++){var d=c.qe[e].N[0];if(d.name==b){d.U.js&&(d.qc=!1);c.qe[e].Xf.ma=0;break}}break}};a.ua=function(){W.length=0;ha=
{}}};b4w.module.__nla=function(a,g){function l(){return{type:"CLIP",va:0,$a:0,sj:!1,paused:!1,cg:"",qq:"",Bc:0,Go:null,Nj:0,Cl:0,wI:0,vI:0,cO:!1,scale:1,repeat:1,lG:0}}function d(a,b,c){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var h=0;h<f.length;h++)f[h].Go=c,b.push(f[h])}a=a.nodes;for(h=0;h<a.length;h++)if(f=a[h],f.node_group){var g=f.node_group.node_tree;if(g){var e=c.slice();e.push(f.name);d(g,b,e)}}}function b(a,b){var c=Math.round(a)-b.va;b.Ej&&(c%=b.jk,0>c&&(c+=b.jk));return b.Tb+
c}function y(a,b){var c=(b-K)*G.sd()+a.Tb;c>a.va?(c-=a.va,a.Ee&&(c%=a.$a-a.va+1),c+=a.va):c=a.va;return c}function r(a,b){a=B.V(a,b.va,b.$a);var c=a==b.$a?b.lG:b.Nj+(a-b.va)/b.scale%(b.Cl-b.Nj);b.cO&&(c=b.Cl-c+b.Nj);return c}function A(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],h=f.strips;if(h)for(var e=0;e<h.length;e++){var g=h[e],n=l();n.type=g.type;n.va=g.frame_start;n.$a=g.frame_end;n.Bc=b;n.Nj=g.action_frame_start;n.Cl=g.action_frame_end;n.cO=g.use_reverse;n.scale=g.scale;n.repeat=g.repeat;
g.action&&(n.cg=g.action.name,n.qq=g.action.uuid,n.Go=f.Go);c.push(n)}}return c}function h(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function u(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function m(a,b){var c=z.A();if(c.ra){var d=y(c.ra,b);c.ra.Tb-=d-a;c.ra.ko=!0}}var q=g("__animation");g("__config");var f=g("__objects"),t=g("__obj_util"),c=g("__print"),z=g("__scenes"),L=g("__sfx"),D=g("__textures"),G=g("__time"),B=g("__util"),O=[],K=-1;a.ll=function(a,b){var c,f=null;for(c=b.I.length-1;0<=c;c--){var g=b.I[c];if(g.yb.b4w_use_nla&&(f=g,g.yb.hG))break}if(c=f){c.gL=!0;var m=0;if((f=a.animation_data)&&f.nla_tracks.length){var e=f.nla_tracks;if(t.Bm(b)||t.xa(b)||t.ce(b)||t.vo(b)||t.jh(b)||
t.gs(b)||t.pC(b))e=A(e,m),e.length&&(b.tg=b.tg.concat(e),m++)}h(a)&&(e=a.data.animation_data.nla_tracks,e=A(e,m),e.length&&(b.tg=b.tg.concat(e),m++));if(t.ce(b))for(g=a.data.materials,f=0;f<g.length;f++){var r=g[f];if(r.use_nodes&&r.node_tree&&(e=[],d(r.node_tree,e,[r.name]),e=A(e,m),e.length)){for(var r=m,n=e,u=q.CV(),z=[],F=0,y=0;y<n.length;y++){var D=n[y];""!=D.qq?D=B.Gd("uuid",D.qq,u):(D=D.cg,D=B.Gd("name",D,u)||B.Gd("name",D+"_B4W_BAKED",u));if(D){var D=D.fcurves,L=[],H;for(H in D)L.push(H);
z.push(L)}}for(y=0;y<z.length;y++){u=!1;for(D=0;D<y;D++)if(B.yR(z[y],z[D])){n[y].Bc=n[D].Bc;u=!0;break}u||(n[y].Bc=m+F++)}m=r+F;b.tg=b.tg.concat(e)}}if(!t.pC(b)){for(f=0;f<a.particle_systems.length;f++)g=a.particle_systems[f],H=g.settings,"EMITTER"==H.type&&H.b4w_allow_nla&&(H=l(),H.type="CLIP",H.va=c.yb.frame_start,H.$a=c.yb.frame_end+1,H.cg=g.name,H.Bc=m,H.Nj=H.va,H.Cl=H.$a,b.tg.push(H),m++);c=m+1;for(f=0;f<b.$c.length;f++)g=b.$c[f],g.UQ&&(m=c,H=l(),H.type="CLIP",H.va=g.va,H.$a=g.$a,H.cg=g.name,
H.Bc=m,H.Nj=H.va,H.Cl=H.$a,b.tg.push(H))}}};a.w0=function(a,b,d){a.ra||(a.ra={va:a.frame_start,$a:a.frame_end,Tb:0,ns:-1,Ms:a.frame_end,Ns:a.frame_start,Cp:null,Ee:b,eb:[],ya:[],YL:a.name,wk:!1,ko:!1,CD:!0},O.push(a.ra));b=a.ra;for(var h=f.FJ(a,"ALL",d),g=0;g<h.length;g++){var m=h[g];if(m.tg.length){b.eb[d]||(b.eb[d]=[]);for(var e=0;e<m.I.length;e++){var q=m.I[e];q.yb==a&&q.gL&&b.eb[d].push(m)}for(var e=m.tg,q=b,n=m.name,r=0;r<e.length;r++){var u=e[r];q.va>u.$a||q.$a<u.va?(c.warn("NLA: Strip is out of scene range: "+
(n+" ["+u.va+":"+u.$a+"]")),e.splice(r,1),r--):u.cg||"CLIP"!=u.type||(c.warn('NLA: no action in strip for object "'+n+'".'),e.splice(r,1),r--)}m=m.tg;e=b;for(q=0;q<m.length;q++){for(var n=m[q],r=e.va,u=e.$a+1,t=0;t<m.length;t++){var z=m[t];n.Bc==z.Bc&&(z.$a<=n.va&&(r=n.va),z.va>=n.$a&&(u=Math.min(u,z.va)))}n.wI=r;n.vI=u;n.lG=0===n.repeat%1?n.Cl:n.Nj+n.repeat%1*(n.Cl-n.Nj)}}}a=a.s.Hp;for(g=0;g<a.length;g++)h=a[g].s,h.ml&&(h.Sa||h.xd)&&h.Dt==d&&(m=l(),m.type="VIDEO",h.Ej?(m.va=0,m.$a=b.$a):(m.va=B.V(h.va,
0,b.$a),m.$a=B.V(h.va+h.jk,0,b.$a)),m.cg=a[g].name,b.ya.push(h))};a.start=function(){K=0};a.fW=function(){return K};a.h6=function(a){return a.ra?a.ra.Tb:null};a.z9=function(a,b){return a.ra?(a.ra.Tb=b,!0):!1};a.update=function(a,c){if(!(0>K)){0==K&&(K=a);for(var d=0;d<O.length;d++){var f=O[d];f.wk&&(f.Tb-=G.sd()*c);var h=y(f,a);if((!f.wk||f.ko)&&h>=f.Ms)if(f.Ee){var h=f,g=a;h.Cp&&h.Cp();m(h.Ns,g);h.CD=!0;h=y(h,g)}else{var g=f,e=h;g.wk=!0;g.Tb-=e-g.Ms;g.Cp&&g.Cp()}if(!f.wk||f.ko){for(var g=f,e=h,l=
0;l<g.eb.length;l++){var n=g.eb[l];if(n)for(var u=0;u<n.length;u++){for(var t=n[u],z=t.tg,A=0;A<z.length;A++){var M=z[A];"SOUND"==M.type&&e<g.ns-1E-6&&(M.sj=!1)}for(A=0;A<z.length;A++)switch(M=z[A],M.type){case "CLIP":if(M.wI<=e&&e<M.vI&&!M.sj){var l=t,X=M,H=X.Go;""!=X.qq?q.sR(l,H,X.qq,X.Bc):q.apply(l,H,X.cg,X.Bc);q.cn(l,q.Cy,X.Bc);H=r(X.va,X);q.dn(l,H,X.Bc);for(l=0;l<z.length;l++)z[l]!=M&&z[l].Bc==M.Bc&&(z[l].sj=!1);M.sj=!0}M.sj&&(X=t,H=r(e,M),1E-6<Math.abs(H-q.fJ(X,M.Bc))&&q.dn(X,H,M.Bc));break;
case "SOUND":if((e<g.ns-1E-6||g.ns<M.va)&&M.va<=e&&e<M.$a&&!M.sj){var X=t,fa=M,H=(fa.va-e)/G.sd(),fa=(fa.$a-fa.va)/G.sd();L.play(X,H,fa);M.sj=!0}g.ns<M.$a&&M.$a<=e&&M.sj&&(M.sj=!1)}}}g=a;e=f;n=h;for(u=0;u<e.ya.length;u++)if(t=e.ya[u],t.Sa||t.xd){z=D.oO(t);A=t;M=B.V(b(n,A),A.Tb,A.Tb+D.pO(A)-1);A.xd&&(M=D.S0(A,M),M==A.Xs&&M--);A=M;M=D.qO(t);X=l=!1;if(e.ko||e.CD)X=!0;e.wk||(H=b(n,t),H=t.Tb<=H&&H<=t.Tb+D.pO(t),fa=D.rO(t),t.Ej&&A==M&&(X=!0),fa||z==A||(X=!0),H&&!fa?D.uL(t):H&&fa?l=!0:!H&&fa&&(t.Sa&&z<A?
l=!0:D.eD(t)));X?(D.tZ(t,A),t.xd&&(t.Uk=D.tx(t,g))):l&&D.sO(t)&&(t.Sa?D.WN(t):(z=D.tx(t,g),z!=t.Uk&&(t.tj=A,D.VN(t)),t.Uk=z))}f.ns=h}f.ko=!1;f.CD=!1}}};a.ua=function(a){if(0==a)O.length=0,K=-1;else for(var b=0;b<O.length;b++)O[b].eb[a]=null};a.$G=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||h(a)||u(a)?!0:!1};a.dn=m;a.oo=function(a){var b=z.A();return b.ra?y(b.ra,a):-1};a.hN=function(){var a=z.A();if(a.ra){a.ra.wk=!0;for(var a=a.ra.ya,b=0;b<a.length;b++)D.eD(a[b])}};a.tY=function(){var a=
z.A();a.ra&&(a.ra.wk=!1,a.ra.Cp=null)};a.i6=function(){var a=z.A();return a.ra?a.ra.va:-1};a.mJ=function(){var a=z.A();return a.ra?a.ra.$a:-1};a.Rf=function(){var a=z.A();return a.ra?!a.ra.wk:!1};a.W3=function(){var a=z.A();return a.ra?a.b4w_use_nla:!1};a.V3=function(){var a=z.A();return a.ra?0<a.b4w_logic_nodes.length:!1};a.R9=function(a,b){var c=z.A();if(c.ra)c.ra.Ns=a,c.ra.Ms=b;else return!1};a.RD=function(a){var b=z.A();b.ra&&(b.ra.Ms=a)};a.HZ=function(a){var b=z.A();b.ra&&(b.ra.Ns=a)};a.c9=function(){var a=
z.A();if(a.ra)a=a.ra,a.Ns=a.va,a.Ms=a.$a;else return!1};a.t9=function(a){var b=z.A();if(b.ra)b.ra.Ee=a;else return!1};a.d4=function(){var a=z.A();a.ra&&(a.ra.Cp=null)};a.uM=function(a){var b=z.A().ra;b&&(b.Tb=-(a-K)*G.sd()+b.Ns,b.ko=!0)};a.mJ=function(){var a=z.A().ra;return a?a.$a:null}};b4w.module.__controls=function(a,g){function l(a,b){b||(b=t.me());return{type:a,value:0,Z:null,element:b,Ka:!1,key:0,cc:"",Ph:!1,EA:null,DA:function(){},CA:null,EH:function(){},ri:null,from:new Float32Array(3),to:new Float32Array(3),mK:!1,fw:!1,Os:0,JL:function(){},axis:"",Yf:0,wp:new Float32Array(3),ix:new Float32Array(4),threshold:0,EL:new Float32Array(4),Cu:0,Bu:0,UL:0,Du:0,Tf:0,repeat:!1,uI:!1,nm:0,callback:function(){}}}function d(a){function b(){return{$j:new Float32Array(2),Hm:!0,obj:null,
identifier:-1,rw:!0}}a||(a=t.me());for(var e=0;e<w.length;e++){var d=w[e];if(a==d.element)return d}d={element:a,hs:!0,He:0,sw:!0,Jw:0,Kw:0,Nm:0,Om:0,Is:0,Js:0,Bh:new Float32Array(2),we:new Float32Array(2),Ch:new Float32Array(2),Ne:new Float32Array(2),by:0,EE:0,FN:0,cf:new Uint8Array(256),yy:0,WB:null,gi:b(),nn:Array(10),oC:!1,YJ:G.create(),Vv:0,Uv:0,Tv:0,ZB:0,YB:0,Sv:Infinity,ZC:null,YC:null,PC:null,LC:null,NC:null,CE:null,BE:null,OC:null,MC:null,jD:null,d8:null,DE:null,AE:null,zE:null,qj:{}};for(e=
0;10>e;++e)d.nn[e]=b();d.ZC=function(a){d.oC||(c.mW(a,d.YJ),d.oC=!0)};d.YC=function(a){a=E.copy(a,I);d.Tv=a[0];d.Uv=a[1];d.Vv=a[2];Infinity==d.Sv&&(d.Sv=a[0],d.YB=a[1],d.ZB=a[2])};d.PC=function(a){d.yy+=a*C.WX};d.LC=function(a){var b=c.fa(c.bd,d.element),b=c.$i(b,c.Ei,n);d.Jw=b[0];d.Kw=b[1];d.Nm=b[0];d.Om=b[1];if(3==d.He||0==d.He)d.He=1;d.which=a};d.NC=function(){var a=c.fa(c.bd,d.element),a=c.$i(a,c.Ei,n),a=t.Rq(a[0],a[1],n);d.gi.Hm=!1;d.gi.$j[0]=a[0];d.gi.$j[1]=a[1]};d.CE=function(a){for(var b=
0;b<a.length;++b){for(var c=a[b],e=null,f=null,h=0;h<d.nn.length;h++){var g=d.nn[h];if(g.identifier==c.identifier){g.rw&&(f=g);break}else!e&&g.rw&&(e=g,e.identifier=c.identifier)}if(c=f||e)e=t.Rq(a[b].clientX,a[b].clientY,n),c.Hm=!1,c.rw=!1,c.$j[0]=e[0],c.$j[1]=e[1]}};d.BE=function(a){for(var b=0;b<d.nn.length;++b){for(var c=d.nn[b],e=!1,f=0;f<a.length;++f)if(a[f].identifier==c.identifier){e=!0;break}e||(c.Hm=!0,c.rw=!0,c.obj=null)}};d.OC=function(a){var b=c.fa(c.bd,d.element),b=c.$i(b,c.Ei,n);d.Jw=
b[0];d.Kw=b[1];d.Nm=b[0];d.Om=b[1];0<d.He&&(d.He=3);d.which=a};d.MC=function(a){if(!Q.po||d.He)d.Nm=a[0],d.Om=a[1]};d.jD=function(a){if(!Q.po||d.He)d.Is+=a[0],d.Js+=a[1]};d.yK=function(a){2!=d.cf[a]&&(d.cf[a]=1,d.hs=!1)};d.AK=function(){for(var a=0;a<d.cf.length;a++)0!=d.cf[a]&&(d.cf[a]=3,d.hs=!1)};d.BK=function(a){d.hs=!1;d.cf[a]=3};d.DE=function(a){d.sw=!1;if(1==a.length)d.Bh[0]=a[0].clientX,d.Bh[1]=-1,d.Ch[0]=a[0].clientY,d.Ch[1]=-1;else if(1<a.length){d.by=d.EE=m(a);d.Bh[0]=a[0].clientX;d.Bh[1]=
a[1].clientX;d.Ch[0]=a[0].clientY;d.Ch[1]=a[1].clientY;var b=a[0];a=a[1];d.FN=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}d.we.set(d.Bh);d.Ne.set(d.Ch)};d.AE=function(a){1===a.length?(d.we[0]=a[0].clientX,d.we[1]=-1,d.Ne[0]=a[0].clientY,d.Ne[1]=-1):1<a.length&&(d.we[0]=a[0].clientX,d.we[1]=a[1].clientX,d.Ne[0]=a[0].clientY,d.Ne[1]=a[1].clientY,d.by=m(a))};d.zE=function(a){0==a.length&&(d.sw=!0)};w.push(d);return d}function b(a,b){if(b in a.qj&&0<a.qj[b])a.qj[b]+=1;else switch(a.qj[b]=1,b){case "orientation_quat":var e=
c.fa(c.Gh);e&&c.Ad(e,c.Dn,a.ZC);break;case "orientation_angles":(e=c.fa(c.Gh))&&c.Ad(e,c.Dn,a.YC);break;case "mouse_wheel":(e=c.fa(c.bd,a.element))&&c.Ad(e,c.dq,a.PC);break;case "mouse_down_which":(e=c.fa(c.bd,a.element))&&c.Ad(e,c.wl,a.LC);break;case "mouse_select":(e=c.fa(c.bd,a.element))&&c.Ad(e,c.wl,a.NC);break;case "touch_select":if(e=c.fa(c.Ig,a.element))c.Ad(e,c.Al,a.CE),c.Ad(e,c.zl,a.BE);break;case "mouse_up_which":(e=c.fa(c.bd,a.element))&&c.Ad(e,c.cq,a.OC);break;case "mouse_location":(e=
c.fa(c.bd,a.element))&&c.Ad(e,c.Ei,a.MC);break;case "mouse_pointerlock":(e=c.fa(c.bd,a.element))&&c.Ad(e,c.wF,a.jD);break;case "keyboard_downed_keys":if(e=c.fa(c.Op,a.element))c.Ad(e,c.$p,a.yK),c.Ad(e,c.nF,a.AK),c.Ad(e,c.aq,a.BK);break;case "touch_start":(e=c.fa(c.Ig,a.element))&&c.Ad(e,c.Al,a.DE);break;case "touch_move":(e=c.fa(c.Ig,a.element))&&c.Ad(e,c.jq,a.AE);break;case "touch_end":(e=c.fa(c.Ig,a.element))&&c.Ad(e,c.zl,a.zE)}}function y(a,b){if(!(!b in a.qj)&&0<a.qj[b]&&(--a.qj[b],!a.qj[b]))switch(b){case "orientation_quat":var e=
c.fa(c.Gh);e&&c.Dd(e,c.Yt,a.ZC);break;case "orientation_angles":(e=c.fa(c.Gh))&&c.Dd(e,c.Dn,a.YC);break;case "mouse_wheel":(e=c.fa(c.bd,a.element))&&c.Dd(e,c.dq,a.PC);break;case "mouse_down_which":(e=c.fa(c.bd,a.element))&&c.Dd(e,c.wl,a.LC);break;case "mouse_select":(e=c.fa(c.bd,a.element))&&c.Dd(e,c.wl,a.NC);break;case "touch_select":if(e=c.fa(c.Ig,a.element))c.Dd(e,c.Al,a.CE),c.Dd(e,c.zl,a.BE);break;case "mouse_up_which":(e=c.fa(c.bd,a.element))&&c.Dd(e,c.cq,a.OC);break;case "mouse_location":(e=
c.fa(c.bd,a.element))&&c.Dd(e,c.Ei,a.MC);break;case "mouse_pointerlock":(e=c.fa(c.bd,a.element))&&c.Dd(e,c.wF,a.jD);break;case "keyboard_downed_keys":if(e=c.fa(c.Op,a.element))c.Dd(e,c.$p,a.yK),c.Dd(e,c.nF,a.AK),c.Dd(e,c.aq,a.BK);break;case "touch_start":(e=c.fa(c.Ig,a.element))&&c.Dd(e,c.Al,a.DE);break;case "touch_move":(e=c.fa(c.Ig,a.element))&&c.Dd(e,c.jq,a.AE);break;case "touch_end":(e=c.fa(c.Ig,a.element))&&c.Dd(e,c.zl,a.zE)}}function r(a,b){a.value=Number(b)}function A(a){for(var b=a.Tk,c=a.hZ,
e=0;e<b.length;e++)c[e]=b[e].value;return a.DX(c)}function h(a,b){a=a||p;var c=a.yh;if(c){var d=a.bn;if(b){var f=c[b];if(f){for(var g=f.Tk,n=0;n<g.length;n++){var m=g[n],l;l=x.indexOf(m);l=-1<l?e[l]:[];1==l.length?(u(m),m=x.indexOf(m),-1<m?(x.splice(m,1),e.splice(m,1)):K.q("Sensors cache is corrupted")):1<l.length&&l.splice(l.indexOf(f),1)}delete c[b];n=d.indexOf(f);-1<n?d.splice(n,1):K.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=k.indexOf(a),-1<c?k.splice(c,1):L.error("Wrong object"))}}else{d=
[];for(b in c)d.push(b);for(n=0;n<d.length;n++)h(a,d[n])}T=!0}}function u(a){switch(a.type){case 90:D.vD(a.EA,a.cc,a.DA);a.Ka=!0;break;case 100:D.zA(a.CA);a.Ka=!0;break;case 110:D.wD(a.Os);a.Ka=!0;break;case 140:a.Ka=!0;break;case 20:var b=d(a.element);y(b,"keyboard_downed_keys");a.Ka=!0;break;case 30:b=d(a.element);y(b,"mouse_wheel");a.Ka=!0;break;case 40:b=d(a.element);y(b,"mouse_down_which");y(b,"mouse_up_which");y(b,"mouse_location");a.Ka=!0;break;case 260:b=d(a.element);y(b,"mouse_pointerlock");
a.Ka=!0;break;case 50:b=d(a.element);y(b,"mouse_down_which");y(b,"mouse_up_which");a.Ka=!0;break;case 60:b=d(a.element);y(b,"touch_start");y(b,"touch_move");y(b,"touch_end");a.Ka=!0;break;case 70:b=d(a.element);y(b,"touch_start");y(b,"touch_move");a.Ka=!0;break;case 75:b=d(a.element);y(b,"touch_start");y(b,"touch_move");a.Ka=!0;break;case 80:b=d(a.element);y(b,"touch_start");y(b,"touch_end");a.Ka=!0;break;case 170:b=d(a.element);y(b,"mouse_select");y(b,"touch_select");y(b,"touch_start");y(b,"touch_end");
y(b,"mouse_down_which");y(b,"mouse_up_which");a.Ka=!0;break;case 180:case 190:b=d(a.element);y(b,"orientation_angles");a.Ka=!0;break;case 200:b=d(a.element);y(b,"orientation_quat");a.Ka=!0;break;case 210:case 220:a.Ka=!0}}function m(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function q(a){return 0==a?c.fa(c.Lt):1==a?c.fa(c.Ry):2==a?c.fa(c.Sy):c.fa(c.Ty)}var f=g("__config"),t=g("__container"),c=g("__input"),z=g("__objects"),L=g("__print"),D=g("__physics"),
G=g("__quat"),B=g("__time"),O=g("__tsr"),K=g("__util"),E=g("__vec3"),C=f.controls,Q=f.B,k=[],p={},x=[],e=[],w=[],n=new Float32Array(2),ea=new Float32Array(2),I=E.create(),F=G.create(),T=!1,M=0;a.Af=10;a.la=20;a.Hg=30;a.Qd=40;a.Np=50;a.Oy=60;a.iu=0;a.hu=1;a.gu=2;a.Jz=3;var X=1;a.update=function(b,e){for(var f=0;f<w.length;f++){var h=w[f];h.gi.Hm||(h.gi.obj=z.No(h.gi.$j[0],h.gi.$j[1]),h.gi.Hm=!0,h.WB=h.gi.obj);for(var g=0;10>g;++g){var m=h.nn[g];m.Hm||(m.obj=z.No(m.$j[0],m.$j[1]),m.Hm=!0,h.WB=m.obj)}}for(f=
0;f<x.length;f++)if(h=x[f],m=b,g=e)switch(h.type){case 120:var l=h.ri,u=O.ic(l.k.n,I),l=O.ae(l.k.n,F),t=E.dist(h.wp,u),y=h.EL;G.invert(h.ix,y);G.multiply(l,y,y);G.normalize(y,y);y=Math.abs(2*Math.acos(y[3]));t/=g;h.Cu=K.Zb(t,h.Cu,g,.3);h.Z[0]=t;t=y/g;h.Bu=K.Zb(t,h.Bu,g,.3);h.Z[1]=t;h.Cu>=h.threshold||h.Bu>=h.UL?r(h,1):r(h,0);E.copy(u,h.wp);G.copy(l,h.ix);h.Yf=m;break;case 130:l=h.ri;u=O.ic(l.k.n,I);l=Math.abs(u[1]-h.wp[1])/g;h.Du=K.Zb(l,h.Du,g,.3);h.Z=l;h.Du>=h.threshold?r(h,1):r(h,0);E.copy(u,h.wp);
h.Yf=m;break;case 140:!h.Ka&&0<=h.Tf&&m-h.Yf>=h.Tf&&(r(h,1),h.repeat?h.Yf=m:h.Tf=-h.Tf);break;case 150:h.Yf||(h.Yf=m);r(h,m-h.Yf);h.Yf=m;break;case 160:r(h,m);break;case 180:m=d(h.element);h.Z[0]=m.Vv-m.ZB;h.Z[1]=m.Uv-m.YB;h.Z[2]=m.Tv-m.Sv;break;case 190:m=d(h.element);h.Z[0]=m.Vv;h.Z[1]=m.Uv;h.Z[2]=m.Tv;break;case 200:m=d(h.element);G.copy(m.YJ,h.Z);break;case 210:g=c.fa(c.zd);c.$i(g,c.Zt,h.Z);break;case 220:g=c.fa(c.zd);c.$i(g,c.$t,h.Z);break;case 240:g=q(h.nm);h.value=c.WV(g,h.key);break;case 250:g=
q(h.nm);h.value=c.VV(g,h.key);break;case 230:r(h,h.callback());break;case 30:m=d(h.element);r(h,m.yy);break;case 40:m=d(h.element);if(!Q.po||1==m.He||2==m.He)switch(u=m.Nm-m.Jw,l=m.Om-m.Kw,h.Z.coords[0]=m.Nm,h.Z.coords[1]=m.Om,h.axis){case "X":r(h,u);break;case "Y":r(h,l);break;case "XY":g=Math.sqrt(u*u+l*l),r(h,g)}break;case 260:m=d(h.element);Q.po||(u=m.Is,l=m.Js,t=K.Zb(u,0,g,.1*X),g=K.Zb(l,0,g,.1*X),.01<Math.abs(u)||.01<Math.abs(l)?(m.Is-=t,m.Js-=g,h.Z.coords[0]=t,h.Z.coords[1]=g):(h.Z.coords[0]=
0,h.Z.coords[1]=0),r(h,Math.sqrt(u*u+l*l)));break;case 50:m=d(h.element);r(h,0<m.He|0);h.Z.which=m.which;h.Z.coords[0]=m.Nm;h.Z.coords[1]=m.Om;break;case 170:m=d(h.element);r(h,0);if(h.uI)m.WB==h.ri&&r(h,1);else if(m.He&&m.gi.obj==h.ri)r(h,1);else if(!m.sw)for(g=0;10>g;++g)if(m.nn[g].obj==h.ri){r(h,1);break}break;case 20:m=d(h.element);h.Z=m.cf[h.key];1==h.Z||m.cf[0]&&16==h.key?r(h,1):h.Z||r(h,0);break;case 60:m=d(h.element);if(-1==m.we[1]&&-1==m.Ne[1]){u=m.we[0]-m.Bh[0];l=m.Ne[0]-m.Ch[0];g=Math.sqrt(u*
u+l*l);if(-1!=m.Bh[1]&&-1!=m.Ch[1]){var t=m.we[0]-m.Bh[1],y=m.Ne[0]-m.Ch[1],C=Math.sqrt(t*t+y*y);C<g&&(u=t,l=y,g=C)}h.Z.gesture=a.iu}else g=n,g[0]=(m.we[0]+m.we[1])/2,g[1]=(m.Ne[0]+m.Ne[1])/2,l=ea,l[0]=(m.Bh[0]+m.Bh[1])/2,l[1]=(m.Ch[0]+m.Ch[1])/2,u=g[0]-l[0],l=g[1]-l[1],g=Math.sqrt(u*u+l*l),h.Z.gesture=a.gu;h.Z.coords[0]=m.we[0];h.Z.coords[1]=m.Ne[0];switch(h.axis){case "X":r(h,u);break;case "Y":r(h,l);break;case "XY":r(h,g)}break;case 70:m=d(h.element);g=m.by-m.EE;h.Z=a.hu;r(h,g);break;case 75:m=
d(h.element);-1!=m.we[1]&&(g=Math.atan2(m.Ne[0]-m.Ne[1],m.we[0]-m.we[1]),h.Z=a.Jz,r(h,g-m.FN));break;case 80:m=d(h.element),h.Z.coords[0]=m.we[0],h.Z.coords[1]=m.Ne[0],m.sw?r(h,0):r(h,1)}for(f=0;f<k.length;f++)for(m=k[f],h=m.bn,g=0;g<h.length;g++)if(u=h[g],u.kl!=M){u.kl=M;y=u;l=0;switch(y.type){case a.Af:l=(t=A(y))?1:0;break;case a.la:l=y.dj;(t=A(y))?(l=1,y.dj=1):1==l?(l=-1,y.dj=-1):l=0;break;case a.Hg:l=y.dj;(t=A(y))&&-1==l?(l=1,y.dj=1):t||1!=l?l=0:(l=-1,y.dj=-1);break;case a.Qd:l=y.dj;(t=A(y))&&
-1==l?(l=1,y.dj=1):t||1!=l?l=0:(l=0,y.dj=-1);break;case a.Np:t=A(y);y.FK!=t?(l=1,y.FK=t):l=0;break;case a.Oy:t=y.Tk;y=y.dX;for(C=0;C<t.length;C++){var B=t[C].value;l||B==y[C]||(l=1);y[C]=B}break;default:K.q("Wrong sensor manifold type: "+y.type)}if(l&&(t=m==p?null:m,T=!1,u.callback(t,u.id,l,u.kS),T)){f=-1;break}}for(f=0;f<k.length;f++)for(m=k[f],h=m.bn,g=0;g<h.length;g++)for(u=h[g],m=u.Tk,u=0;u<m.length;u++)switch(l=m[u],l.type){case 30:r(l,0);break;case 40:r(l,0);break;case 60:r(l,0);break;case 70:r(l,
0);break;case 75:r(l,0);break;case 80:r(l,0);break;case 140:r(l,0)}for(f=0;f<w.length;f++){h=w[f];if(!h.hs){for(g=0;g<h.cf.length;g++)1==h.cf[g]?h.cf[g]=2:3==h.cf[g]&&(h.cf[g]=0);h.hs=!0}1==h.He?h.He=2:3==h.He&&(h.He=0);h.yy=0;h.Jw=h.Nm;h.Kw=h.Om;h.cf[0]=0;h.Bh.set(h.we);h.Ch.set(h.Ne);h.EE=h.by;h.ZB=h.Vv;h.YB=h.Uv;h.Sv=h.Tv;h.oC=!1}M++};a.MA=function(a){var b=l(10);r(b,a);return b};a.Gb=function(a){var b=l(20,document);b.key=a;b.Ka=!0;return b};a.gr=function(a,b){var e=l(240,document);b=b||c.kJ();
e.nm=b;e.key=a;e.Ka=!0;return e};a.Qi=function(a,b){var e=l(250,document);b=void 0==b?c.kJ():b;e.nm=b;e.key=a;e.Ka=!0;return e};a.Yu=function(a,b,c){if(!a||!D.oa(a))return L.error("Wrong collision object"),null;var e=l(90);e.EA=a;e.cc=b;e.Ph=c;e.Z={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};e.DA=function(a,b,c,d,f){r(e,a);a=e.Z;a.coll_obj=b;e.Ph&&(a.coll_pos.set(c),a.coll_norm.set(d),a.coll_dist=f)};e.Ka=!0;return e};a.MH=function(a){if(!a||
!a.C)return L.error("Wrong collision impulse object"),null;var b=l(100);b.CA=a;b.EH=function(a){r(b,a)};b.Ka=!0;return b};a.ck=function(a,b,c,e,d,f,h){var g=l(110);g.ri=a;g.from=b;g.to=c;g.cc=e;g.mK=d;g.Ph=f;g.fw=h;g.Z={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Os:0};g.JL=function(a,b,c,e,d,f){g.mK?r(g,-1==b?0:1):r(g,b);g.Z.hit_fract=b;g.Z.obj_hit=c;g.Z.hit_time=e;g.Ph&&(g.Z.hit_pos.set(d),g.Z.hit_norm.set(f))};g.Ka=!0;return g};a.Vn=function(a){a=
l(50,a);a.Ka=!0;a.Z={coords:new Float32Array(2),which:null};return a};a.RA=function(a){a=l(30,a);a.Ka=!0;return a};a.Xl=function(a,b){var c=l(40,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2)};c.Ka=!0;return c};a.jr=function(a,b){var c=l(60,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2),gesture:0};c.Ka=!0;return c};a.ZA=function(a){a=l(70,a);a.Z=0;a.Ka=!0;return a};a.aI=function(a){a=l(75,a);a.Z=0;a.Ka=!0;return a};a.bv=function(a){a=l(80,a);a.Z={coords:new Float32Array(2)};a.Ka=!0;return a};
a.SH=function(a,b,c){if(!a)return L.error("Wrong collision object"),null;var e=l(120);e.ri=a;var d=O.F(a.k.n);a=O.P(a.k.n);e.EL=new Float32Array(4);e.wp=new Float32Array(d);e.ix=new Float32Array(a);e.Cu=0;e.Bu=0;e.threshold=b||.1;e.UL=c||.1;e.Yf=0;e.Z=new Float32Array([0,0]);return e};a.bI=function(a,b){if(!a)return L.error("Wrong collision object"),null;var c=l(130);c.ri=a;var e=O.F(a.k.n),d=O.P(a.k.n);c.wp=new Float32Array(e);c.ix=new Float32Array(d);c.Du=0;c.threshold=b||1;c.Yf=0;c.Z=0;return c};
a.$H=function(a,b){var c=l(140);c.Tf=a;c.repeat=b;c.Ka=!0;return c};a.QL=function(a,b,c,e){a=a||p;a=a.yh;if(!a||!a[b])return L.error("reset_timer_sensor(): wrong object"),null;b=a[b].Tk[c];if(!b)return L.error("reset_timer_sensor(): sensor not found"),null;b.Yf=B.mk();b.Tf=e};a.Ug=function(){var a=l(150);a.Yf=0;return a};a.QH=function(){var a=l(180,window);a.Z=new Float32Array(3);c.fa(c.Gh)?r(a,1):r(a,0);a.Ka=!0;return a};a.PH=function(){var a=l(190,window);a.Z=new Float32Array(3);c.fa(c.Gh)?r(a,
1):r(a,0);a.Ka=!0;return a};a.OA=function(){var a=l(200,window);a.Z=G.create();c.fa(c.Gh)?r(a,1):r(a,0);a.Ka=!0;return a};a.PA=function(){var a=l(210,window);a.Z=G.create();c.fa(c.zd)?r(a,1):r(a,0);a.Ka=!0;return a};a.RH=function(){var a=l(220,window);a.Z=E.create();c.fa(c.zd)?r(a,1):r(a,0);a.Ka=!0;return a};a.ZH=function(){return l(160)};a.$u=function(a,b){var c=l(170);c.ri=a;c.uI=b;c.Ka=!0;return c};a.Xu=function(a,b){var c=l(230);c.callback=a;r(c,b);return c};a.SA=function(a){a=l(260,a);a.Z={coords:new Float32Array(2)};
a.Ka=!0;return a};a.TA=function(a){a=l(270,a);a.Ka=!0;return a};a.gZ=r;a.ud=function(a,b,c){a=a||p;a=a.yh;if(!a||!a[b])return L.error("get_sensor_value(): wrong object"),null;b=a[b].Tk[c];return b?b.value:(L.error("get_sensor_value(): sensor not found"),null)};a.be=function(a,b,c){a=a||p;a=a.yh;if(!a||!a[b])return L.error("get_sensor_payload(): wrong object"),null;b=a[b].Tk[c];return b?b.Z:(L.error("get_sensor_payload(): sensor not found"),null)};a.ua=function(){k=[];p={};for(var a=0;a<x.length;a++)u(x[a]);
x.length=0;e.length=0};a.Ql=function(a,b){a=a||p;if(!a.yh)return!1;if(b&&a.yh[b])return!0;if(!b)for(var c in a.yh)return!0;return!1};a.K=function(a,f,g,m,n,l,q){a=a||p;a.bn=a.bn||[];a.yh=a.yh||{};var r=a.yh,u=a.bn;r[f]&&h(a,f);g={id:f,type:g,Tk:m.slice(0),DX:n,hZ:Array(m.length),callback:l,kS:q,dj:-1,FK:0,dX:Array(m.length),kl:-1};r[f]=g;u.push(g);-1==k.indexOf(a)&&k.push(a);m=g.Tk;for(a=0;a<m.length;a++){r=f=m[a];if(r.Ka){switch(r.type){case 90:D.Yz(r.EA,r.cc,r.DA,r.Ph);break;case 100:D.$z(r.CA,
r.EH);break;case 110:r.Os=D.xu(r.ri,r.from,r.to,r.cc,r.JL,!1,!1,r.Ph,r.fw);r.Z.Os=r.Os;break;case 140:r.Yf=B.mk();0>r.Tf&&(r.Tf=-r.Tf);break;case 20:u=d(r.element);b(u,"keyboard_downed_keys");break;case 30:u=d(r.element);b(u,"mouse_wheel");break;case 40:u=d(r.element);b(u,"mouse_down_which");b(u,"mouse_up_which");b(u,"mouse_location");break;case 260:u=d(r.element);b(u,"mouse_pointerlock");break;case 270:c.SQ(r);break;case 50:u=d(r.element);b(u,"mouse_down_which");b(u,"mouse_up_which");break;case 60:u=
d(r.element);b(u,"touch_start");b(u,"touch_move");b(u,"touch_end");break;case 70:u=d(r.element);b(u,"touch_start");b(u,"touch_move");break;case 75:u=d(r.element);b(u,"touch_start");b(u,"touch_move");break;case 80:u=d(r.element);b(u,"touch_start");b(u,"touch_end");break;case 170:u=d(r.element);b(u,"mouse_select");b(u,"touch_select");b(u,"touch_start");b(u,"touch_end");b(u,"mouse_down_which");b(u,"mouse_up_which");break;case 180:case 190:u=d(r.element);b(u,"orientation_angles");break;case 200:u=d(r.element);
b(u,"orientation_quat");break;case 240:0==r.nm?c.fa(c.Lt):1==r.nm?c.fa(c.Ry):2==r.nm?c.fa(c.Sy):c.fa(c.Ty)}r.Ka=!1}r=x.indexOf(f);-1==r?(x.push(f),e.push([g])):e[r].push(g)}T=!0};a.hv=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.iv=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.ie=h;a.reset=function(){for(var a=0;a<k.length;a++){var b=k[a],c=b.yh,b=b.bn,d;for(d in c)delete c[d];b.length=0}for(a=0;a<x.length;a++)u(x[a]);k.length=
0;x.length=0;e.length=0};a.debug=function(){L.log(String(k.length)+" objects with manifolds",k);L.log(String(x.length)+" sensors",x);for(var a=[],b=[],c=0;c<x.length;c++){var e=x[c];90==e.type&&a.push(e);110==e.type&&b.push(e)}L.log(String(a.length)+" collision sensors",a);L.log(String(b.length)+" ray sensors",b)};a.Bx=function(a){X=a}};b4w.module.__data=function(a,g){function l(a,b){Ta[b.id]=null;Ba[b.id]=null}function d(a,b,c,e){a instanceof ArrayBuffer&&(a=N.VJ(a,e));e=a.width;a=a.height;za.log("%cLOAD IMAGE "+e+"x"+a,"color: #"+(2048<e||2048<a?"a00":1024<e||1024<a?"aa0":"0a0"),b);-1==b.indexOf(bb)&&c&&za.warn("image",b,"is not from app root.")}function b(a,b,c,e,d,f){(e=b.bh)||Ea.q("Nothing requested");oa.Yd([{id:e,type:oa.Bn,url:e,ih:b.uk}],function(e,f,h,g){if(e){za.log("%cLOAD METADATA","color: #616",g);f=Ea.iN(e.b4w_format_version);
switch(Ea.lO(f,wa.Mm)){case -1:f[0]<wa.Mm[0]?Ea.q("JSON version is too old relative to B4W engine: "+Ea.rl(f)+", required: "+Ea.rl(wa.Mm)+". Reexport scene with the latest B4W addon to fix it."):za.warn("JSON version is a bit old relative to B4W engine: "+Ea.rl(f)+", required: "+Ea.rl(wa.Mm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>wa.Mm[0]?Ea.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
za.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}wa.zC=f;for(var k in e)a[k]=e[k];b.Mb&&(Xa=S.uv(a.scenes));(e=a.binaries[0].binfile)?b.TG=e:(pa.Mx(b,"load_binaries"),pa.Mx(b,"prepare_bindata"));wa.is_mobile_device||pa.Mx(b,"mobile_media_start");wa.antialiasing&&wa.smaa||pa.Mx(b,"load_smaa_textures");if(a.b4w_export_errors)for(e=0;e<a.b4w_export_errors.length;e++)k=a.b4w_export_errors[e],(b.Mb&&"PRIMARY"==k.type||
"ALL"==k.type)&&za.NU(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(e=0;e<a.b4w_export_warnings.length;e++)k=a.b4w_export_warnings[e],(b.Mb&&"PRIMARY"==k.type||"ALL"==k.type)&&za.OU(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.uk&&B(a);d(b,c)}else pa.jG(b)},null,function(a){f(b,c,a)})}function y(a,b,c,e,d,f){(e=na(b.bh)+b.TG)||Ea.q("Binary data is missing");oa.Yd([{id:e,
type:oa.Gt,url:e,ih:b.uk}],function(e,f,g,k){e?(za.log("%cLOAD BINARY","color: #616",k),a.bin_data=e,e=h(e),f=Ea.iN(a.b4w_format_version),e[0]!=f[0]&&Ea.q("BIN version does not match to JSON version: "+Ea.rl(e)+", required: "+Ea.rl(wa.Mm)+". Couldn't load the scene. Reexport scene to fix it."),e[1]!=f[1]&&za.warn("BIN version does not match to JSON version: "+ +Ea.rl(e)+", required: "+Ea.rl(wa.Mm)+". Some compatibility issues can occur. Reexport scene to fix it."),d(b,c)):pa.jG(b)},null,function(a){f(b,
c,a)})}function r(a,b,c,e,d){ka.vH()&&d(b,c)}function A(a,b,c,e,d){e=a.bin_data;var f=a.binaries[0],g=a.objects,k=a.meshes;a=a.actions;var p=Ea.CS();h(e);for(var m=["indices"],n=["position","texcoord","texcoord2","shade_tangs"],l=["normal","tangent"],q=["group"],r=["color"],w=0;w<k.length;w++)for(var t=k[w].submeshes,v=0;v<t.length;v++){for(var x in t[v]){var z=t[v][x][1];if(-1!=m.indexOf(x)){var y=t[v][x][0]*Ea.lF+f["int"]+12,F=t[v],C=x,B=e;if(p)var A=new Uint32Array(B,y,z);else for(var A=new Uint32Array(z),
B=new DataView(B),D=0;D<z;D++)A[D]=B.getUint32(y+D*Ea.lF,!0);F[C]=A}else if(-1!=n.indexOf(x))y=t[v][x][0]*Ea.Kj+f["float"]+12,t[v][x]=u(e,y,z,p);else if(-1!=l.indexOf(x)){y=t[v][x][0]*Ea.hq+f["short"]+12;F=t[v];C=x;B=e;A=new Float32Array(z);B=new DataView(B);for(D=0;D<z;D++)A[D]=B.getInt16(y+D*Ea.hq,!0)/32767;F[C]=A}else if(-1!=q.indexOf(x)){y=t[v][x][0]*Ea.hq+f.ushort+12;F=t[v];C=x;B=e;A=new Float32Array(z);B=new DataView(B);for(D=0;D<z;D++)A[D]=B.getUint16(y+D*Ea.hq,!0)/65535;F[C]=A}else if(-1!=
r.indexOf(x)){y=t[v][x][0]*Ea.Iy+f.uchar+12;F=t[v];C=x;B=e;A=new Float32Array(z);B=new DataView(B);for(D=0;D<z;D++)A[D]=B.getUint8(y+D*Ea.Iy,!0)/255;F[C]=A}}z=t[v];if(k[w].b4w_shape_keys.length)for(y=z.base_length,F=z.normal.length/y/3,z.tbn_quat=Ea.Mr(z.normal.subarray(0,3*y),z.tangent.subarray(0,4*y),new Float32Array(z.normal.length/3*4)),C=1;C<F;C++)for(B=C*y,A=0;A<y;A++){var H=z.normal.subarray(3*A,3*(A+1)),D=va.add(z.normal.subarray(3*(B+A),3*(B+A+1)),H,hb);if(z.tangent.length){var E=z.tangent.subarray(4*
A,4*(A+1)),I=U.add(z.tangent.subarray(4*(B+A),4*(B+A+1)),E,eb),H=Ea.MJ(H,E,cb),D=Ea.MJ(D,I,nb);Sa.invert(H,cb);D=Sa.multiply(D,H,cb)}else D=Sa.rotationTo(H,D,cb);z.tbn_quat.set(D,4*(B+A))}else z.tbn_quat=Ea.Mr(z.normal,z.tangent)}for(x=0;x<g.length;x++)for(k=g[x].particle_systems,m=0;m<k.length;m++)n=k[m],n.transforms=u(e,n.transforms[0]*Ea.Kj+f["float"]+12,n.transforms[1],p);for(g=0;g<a.length;g++){x=a[g];k=x.fcurves;m=x.frame_range;l=m[0];q=m[1];r=xa.EV(l,q);m=null;0>r&&(r=0);var t=w=!1,L;for(L in k)w|=
-1<L.indexOf("rotation_euler"),t|=-1<L.indexOf("rotation_quaternion");n=[];for(L in k)if(w&&t&&-1<L.indexOf("rotation_euler"))delete k[L];else{var v=k[L],K;for(K in v)z=v[K],y=u(e,f["float"]+z.bin_data_pos[0]*Ea.Kj+12,z.bin_data_pos[1],p),F=new Float32Array(r),null===m&&(m=new Int8Array(r)),xa.wR(z,y,F,m,l,q),z.Ef=F;-1<L.indexOf("rotation_euler")&&(xa.YU(k[L]),n.push(L))}for(l=0;l<n.length;l++)q=n[l],r=q.replace("euler","quaternion"),k[r]=k[q],delete k[q];x.NQ=m}d(b,c)}function h(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function u(a,b,c,e){if(e)e=new Float32Array(a,b,c);else{e=new Float32Array(c);a=new DataView(a);for(var d=0;d<c;d++)e[d]=a.getFloat32(b+d*Ea.Kj,!0)}return e}function m(a,b,c,e,d){var h=a.cameras,g=a.groups,p=a.materials,m=a.meshes,n=a.node_groups,l=a.objects,q=a.particles,r=a.scenes,u=a.speakers,w=a.lamps,x=a.textures,v=a.worlds;n||(za.warn('"node_groups" datablock undefined. reexport main scene.'),n=a.node_groups=[]);
for(var y="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),F={},C=0;C<y.length;C++)for(var A=a[y[C]],D=0;D<A.length;D++){var H=A[D];F[H.uuid]=H}for(var E=0;E<r.length;E++){for(var I=r[E],K=I.objects,G=0;G<K.length;G++)k(K,G,F);I.camera&&k(I,"camera",F);I.world&&k(I,"world",F)}for(E=0;E<g.length;E++)for(var J=g[E].objects,G=0;G<J.length;G++)k(J,G,F);for(E=0;E<l.length;E++){var T=l[E];T.dupli_group&&
k(T,"dupli_group",F);T.parent&&k(T,"parent",F);T.dg_parent&&k(T,"dg_parent",F);if(T.animation_data){var O=T.animation_data;O.action&&k(O,"action",F);if(O.nla_tracks)for(G=0;G<O.nla_tracks.length;G++)for(var R=O.nla_tracks[G],N=0;N<R.strips.length;N++)R.strips[N].action&&k(R.strips[N],"action",F)}switch(T.type){case "MESH":T.data||Ea.q("mesh not found for object "+T.name);k(T,"data",F);for(var P=!1,ba=T.modifiers,G=0;G<ba.length;G++){var X=ba[G];"ARMATURE"==X.type?(P&&za.warn('Object "'+T.name+'" has more than one armature modifiers. Only the first one will be used.'),
P=!0,k(X,"object",F)):"CURVE"==X.type&&k(X,"object",F)}var ea=T.particle_systems;if(ea)for(G=0;G<ea.length;G++)k(ea[G],"settings",F);break;case "ARMATURE":k(T,"data",F);for(var aa=T.pose.bones,V=T.data.bones,G=0;G<aa.length;G++){var Y=aa[G];Y.bone=V[Y.bone];var ca=Y.constraints;if(ca)for(N=0;N<ca.length;N++){var W=ca[N];W.target&&k(W,"target",F)}for(var fa=Y.parent_recursive,N=0;N<fa.length;N++)fa[N]=aa[fa[N]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":k(T,"data",F)}if(ca=T.constraints)for(G=
0;G<ca.length;G++)W=ca[G],W.target&&k(W,"target",F);var ha=T.lod_levels;if(ha)for(G=0;G<ha.length;G++){var U=ha[G];U.object&&k(U,"object",F)}}for(E=0;E<m.length;E++)for(var ya=m[E].materials,G=0;G<ya.length;G++)k(ya,G,F);for(E=0;E<p.length;E++){for(var Z=p[E],ia=Z.texture_slots,G=0;G<ia.length;G++)k(ia[G],"texture",F);var sa=Z.node_tree;sa&&Q(sa,F)}for(E=0;E<n.length;E++)(sa=n[E].node_tree)&&Q(sa,F);for(E=0;E<x.length;E++){var oa=x[E],ga=oa.type;"IMAGE"!=ga&&"ENVIRONMENT_MAP"!=ga||k(oa,"image",F)}for(E=
0;E<h.length;E++){var ra=h[E];ra.dof_object&&k(ra,"dof_object",F)}for(E=0;E<u.length;E++){var ja=u[E];ja.sound&&k(ja,"sound",F);if(ja.animation_data&&(O=ja.animation_data,O.action&&k(O,"action",F),O.nla_tracks))for(G=0;G<O.nla_tracks.length;G++)for(R=O.nla_tracks[G],N=0;N<R.strips.length;N++)R.strips[N].action&&k(R.strips[N],"action",F)}for(E=0;E<q.length;E++){for(var nb=q[E],ia=nb.texture_slots,G=0;G<ia.length;G++)k(ia[G],"texture",F);nb.dupli_group&&k(nb,"dupli_group",F);nb.dupli_object&&k(nb,"dupli_object",
F)}for(E=0;E<w.length;E++){var ua=w[E];if(ua.animation_data&&(O=ua.animation_data,O.action&&k(O,"action",F),O.nla_tracks))for(G=0;G<O.nla_tracks.length;G++)for(R=O.nla_tracks[G],N=0;N<R.strips.length;N++)R.strips[N].action&&k(R.strips[N],"action",F)}for(E=0;E<v.length;E++){var qa=v[E];if(ia=qa.texture_slots)for(G=0;G<ia.length;G++)k(ia[G],"texture",F);if(qa.animation_data&&(O=qa.animation_data,O.action&&k(O,"action",F),O.nla_tracks))for(G=0;G<O.nla_tracks.length;G++)for(R=O.nla_tracks[G],N=0;N<R.strips.length;N++)R.strips[N].action&&
k(R.strips[N],"action",F)}Fa.xS(a);B(a);for(var ma=na(b.bh),ka=a.textures,pa=b.Mb?a.scenes[0].b4w_anisotropic_filtering:Xa.b4w_anisotropic_filtering,la=0;la<ka.length;la++)b.Mb||"SCENE"!=ka[la].b4w_source_type||(ka[la].b4w_source_id=""),Ga.bU(ka[la],pa,a.scenes,b.id,ma);for(var ta={},ob=a.objects,va=0;va<ob.length;va++){var wa=ob[va];if("MESH"===wa.type&&!wa.particle_systems.length)for(var Ca=wa.data,Ia=Ca.name,ib=Ca.submeshes,Ua=Ca.materials,Ja=0;Ja<ib.length;Ja++)0!==ib[Ja].base_length||ta[Ia]||
(Ua[Ja]&&za.warn('material "'+Ua[Ja].name+'" is not assigned to any face (object "'+wa.name+'").'),ta[Ia]=!0)}for(var yb=a.meshes,Ka=0;Ka<yb.length;Ka++){var La=yb[Ka];La.materials.length||La.uv_textures.length&&za.warn('mesh "'+La.name+'" has a UV map but has no exported material.')}a.materials.push(Fa.rT());for(var Ma=a.meshes,Oa=Ea.Gd("name","DEFAULT",a.materials),Ha=0;Ha<Ma.length;Ha++){var Sa=Ma[Ha];0==Sa.materials.length&&Sa.materials.push(Oa)}for(var Na=a.actions,Qa=b.id,Ta=0;Ta<Na.length;Ta++){var cb=
Na[Ta];cb.OQ=Qa;xa.XQ(cb)}for(var sb=a.scenes,bb=0;bb<sb.length;bb++){for(var hb=sb[bb],eb=[],rb=[],Xb=sb[bb].objects,db=0;db<Xb.length;db++){var xb=Xb[db];M(Xb,xb,null,eb,rb);var lc=xb.dupli_group;if(lc)for(var Gc=lc.objects,Db=0;Db<Gc.length;Db++)M(Gc,Gc[Db],xb,eb,rb)}for(db=0;db<rb.length;db++)for(var Vb=rb[db],Ac=[hb],Qb=0;Qb<Ac.length;Qb++){for(var vb=Ac[Qb].objects,Uc=0;Uc<vb.length;Uc++){var Vc=vb[Uc].dupli_group;if(Vc){var fb=Vc.objects,Za=fb.indexOf(Vb);-1<Za&&fb.splice(Za,1)}}var Za=vb.indexOf(Vb);
-1<Za&&vb.splice(Za,1)}for(db=0;db<eb.length;db++)Ea.rR(eb[db][0],eb[db][1])}!b.Mb&&1<a.scenes.length&&(a.scenes=[S.uv(a.scenes)],za.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Hc=b.Mb?Xa:S.uv(a.scenes);Dc.uZ(Xa.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Xa),1),a.scenes.unshift(Xa));for(var Mc=0;Mc<a.scenes.length;Mc++){var Bc=a.scenes[Mc];Bc.s={};Bc.hG=Bc==Hc;Bc.PQ=b.Mb;Ra.enabled&&Bc.b4w_enable_physics&&(b.Mb||!Da.qx(Xa)&&Bc==S.uv(a))&&
Da.GW(Bc)}for(var dc=0;dc<a.scenes.length;dc++){for(var $c=a.scenes[dc],Wb=t($c),Nc=0;Nc<Wb.length;Nc++){var Cc=Wb[Nc];Aa.yS(Cc,$c,a)&&(Cc.rd||(Cc.rd=[]),Cc.rd.push(b.Mb?$c:Xa))}for(var qd=Wb,md=0;md<qd.length;md++){var nd=qd[md];if(nd.rd&&"WORLD"!=nd.type)for(var wd=nd.particle_systems,rd=0;rd<wd.length;rd++){var fd=wd[rd].settings;if("HAIR"==fd.type)if("OBJECT"==fd.render_type){var sc=fd.dupli_object;sc.rd||(sc.rd=nd.rd.slice())}else if("GROUP"==fd.render_type)for(var gd=fd.dupli_group,sd=0;sd<
gd.objects.length;sd++)sc=gd.objects[sd],sc.rd||(sc.rd=nd.rd.slice())}}}for(var hd=a.scenes,td=[],Ib=0;Ib<hd.length;Ib++)z(hd[Ib].objects,0,b.Mb,td);Ba[b.id]=[];for(Ib=0;Ib<td.length;Ib++)for(var xd=td[Ib],Wc=0;Wc<xd.length;Wc++)for(var Jd=xd[Wc],zd=0;zd<Jd.length;zd++)Ba[b.id].push(Jd[zd]);for(var Ad=a.particles,Ib=0;Ib<Ad.length;Ib++){var ud=Ad[Ib].dupli_object;ud&&(ud.gG=!0,Ba[b.id].push(ud));var Kd=Ad[Ib].dupli_group;if(Kd)for(var Ld=Kd.objects,Wc=0;Wc<Ld.length;Wc++)ud=Ld[Wc],ud.gG=!0,Ba[b.id].push(ud)}for(var Bd=
Ba[b.id],Ib=Bd.length-1;0<=Ib;Ib--)Bd[Ib].rd||Bd.splice(Ib,1);for(var Md=Ba[b.id],dc=0;dc<Md.length;dc++)if(Cc=Md[dc],!b.Mb&&Cc.parent&&-1<Nb.indexOf(Cc.parent.type)&&(Cc.parent=""),"MESH"==Cc.type){var Cd=Fa.uR(Cc);Cd&&(a.meshes.push(Cd),Cc.data=Cd)}for(var Dd=0;Dd<a.scenes.length;Dd++){var Nd=a.scenes[Dd],Ed=Nd.world;Ed.rd||(Ed.rd=[]);Ed.rd.push(b.Mb?Nd:Xa)}for(var Od=a.node_groups,Pd=a.materials,od=0;od<Od.length;od++){var vd=Od[od].node_tree;if(vd){var yd=[];f(vd,yd,!0);vd.Qz=yd}}for(od=0;od<
Pd.length;od++)if(vd=Pd[od].node_tree)yd=[],f(vd,yd,!1),vd.Qz=yd;for(var Fd=0;Fd<a.scenes.length;Fd++){var Gd=a.scenes[Fd];if(Gd.b4w_use_logic_editor){var Qd=t(Gd);Fa.BR(Qd,Gd)}}for(var Hd=0;Hd<a.scenes.length;Hd++){var Rd=a.scenes[Hd],Id=b.Mb?Rd:Xa;Boolean(L(b.id,Id,"SPEAKER").length)&&!Id.Rc&&da.GR(Id)}d(b,c)}function q(a,b){for(var c=na(b.bh),e=[],d=[],f=0;f<a.speakers.length;f++){var h=a.speakers[f],g=h.sound.uuid;if(-1==d.indexOf(g)){d.push(g);switch(h.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var k=
oa.Ey;break;case "BACKGROUND_MUSIC":k=oa.Fy}h=Ea.oj(c+h.sound.filepath);oa.kn(h);ea(e,g,k,h,b.uk)}}e.length&&oa.Yd(e,function(){},function(){})}function f(a,b,c){a=a.nodes;for(var e=0;e<a.length;e++){var d=a[e],h=d.type;if("GROUP"==h&&d.node_group){if(d=d.node_group.node_tree)if(c)f(d,b,!0);else for(d=d.Qz,h=0;h<d.length;h++){var g=d[h];-1==b.indexOf(g)&&b.push(g)}}else-1!=Xb.indexOf(h)&&-1==b.indexOf(h)&&b.push(h)}}function t(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);
c(a.objects,"ALL",b);return b}function c(a,b,e){for(var d=0;d<a.length;d++){var f=a[d];"ALL"!=b&&b!=f.type||e.push(f);(f=f.dupli_group)&&c(f.objects,b,e)}}function z(a,b,c,e){e[b]=e[b]||[];for(var d=e[b],f=0;f<a.length;f++){var h=a[f],g=ca(h);d[g]=d[g]||[];(c||-1==Nb.indexOf(h.type))&&-1==d[g].indexOf(h)&&d[g].push(h);(h=h.dupli_group)&&z(h.objects,b+1,c,e)}}function L(a,b,c){var e=[];a=Ba[a];for(var d=0;d<a.length;d++){var f=a[d];if(f.type==c||"ALL"==c)for(var h=0;h<f.rd.length;h++)b==f.rd[h]&&e.push(f)}return e}
function D(a,b,c,e,d){var f=Ba[b.id],h=a.worlds;e=b.id;for(var g=0;g<f.length;g++){for(var k=f[g],p=la.hr(k.name,k.type,k.origin_name),m=0;m<k.rd.length;m++)la.sq(p,k.rd[m]);k.nb=p;Aa.ll(k,p);p.k.$e=e;p.ds=k.gG||!1}for(e=0;e<h.length;e++){g=h[e];k="%meta_world%"+g.name;k=la.hr(k,"WORLD",k);for(p=0;p<g.rd.length;p++)la.sq(k,g.rd[p]);g.nb=k;Aa.D0(g,k)}e=Aa.qm(b.id);for(g=0;g<f.length;g++)k=f[g],p=k.nb,qa.ll(k,p);for(g=0;g<h.length;g++)k=h[g],qa.ll(k,k.nb);if(b.Mb)for(h=b.id,g=0;g<a.scenes.length;g++)for(var k=
a.scenes[g],p=0,m=Aa.Ub(k,"LAMP",h),n=0;n<m.length;n++)la.ja(m[n],k).Km=p++;for(g=0;g<f.length;g++)k=f[g],p=k.nb,p.ds||(Aa.r0(k,p),Qa.D(p));for(a=0;a<f.length;a++)if(h=f[a],g=h.nb,la.ce(g)||la.vo(g))if(k=h.lod_levels.length)for(p=g,g.k.wo=!0,m=0;m<k;m++)if(n=h.lod_levels[m].object){n=n.nb;n.k.wo=!0;n.k.nh=g.k.nh;p.k.lf=h.lod_levels[m].distance;n.k.mh=h.lod_levels[m].distance;if(h.lod_levels[m+1])n.k.lf=h.lod_levels[m+1].distance;else{n.k.lf=la.bq;break}p=n}else{p.k.lf=h.lod_levels[m].distance;break}for(f=
0;f<e.length;f++)if(a=e[f],"MESH"==a.type&&(h=a.Au)){var h=h.k,g=a.k.Li,k=[],l;for(l in g)p=g[l],k.push(4*p.hB,4*p.Uj);h.Fw.push(k);h.fp.push(a.k)}f=l=-1;a=xa.qJ();for(h=0;h<e.length;h++)g=e[h],k=g.k,la.ce(g)&&k.vk&&(g=k.oh,g>l&&(l=g),a>=g&&g>f&&(f=g));for(h=0;h<e.length;h++)g=e[h],k=g.k,la.ce(g)&&k.vk&&(k.km=!0,l<a?k.oh=l:k.oh<=a?k.oh=f:(za.warn('too many bones for "'+g.name+'" / '+k.oh+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.oh=
l,k.km=!1),k.km=k.km&&!Oa.GI);for(l=0;l<e.length;l++)if(f=e[l],f.gf)if(a=f.uf,"CHASSIS"==a.nf){f.v={};f.v.Fr=a.Fr;f.v.Iq=a.Iq;f.v.lE=a.lE;f.v.nE=a.nE;f.v.mE=a.mE;f.v.ZE=a.ZE;f.v.DD=a.DD;f.v.FC=a.FC;f.v.eo=0;f.v.Hq=1;f.v.mp=0;f.v.speed=0;f.v.Ym=[];f.v.Ls=[];f.v.op=null;g=(h=la.Yi(f))?la.JB(h,e):e;for(h=0;h<g.length;h++)k=g[h],k.gf&&(p=k.uf,Da.NW(k)&&a.name==p.name?(p=Da.d1(k.uf.nf),f.v.Ym[p]=k,f.v.Ls[p]=new Float32Array(8)):Da.vK(k)&&a.name==p.name?(f.v.op=k,f.v.np=p.np,f.v.lt=p.lt,f.v.bs=p.bs,p=ga.invert(f.k.n,
ga.create()),k=ga.multiply(p,k.k.n,p),f.v.gN=k,p=new Float32Array([1,0,0]),ga.Yc(p,k,p),f.v.fN=p):Da.uK(k)&&a.name==p.name?(f.v.eE=k,f.v.jt=p.jt,f.v.Co=p.Co,p=ga.invert(f.k.n,ga.create()),k=ga.multiply(p,k.k.n,p),f.v.bN=k,p=new Float32Array([1,0,0]),ga.Yc(p,k,p),f.v.aN=p):Da.wK(k)&&a.name==p.name&&(f.v.pE=k,f.v.pr=p.pr,p=ga.invert(f.k.n,ga.create()),k=ga.multiply(p,k.k.n,p),f.v.sN=k,p=new Float32Array([1,0,0]),ga.Yc(p,k,p),f.v.rN=p));4!=f.v.Ym.length&&Ea.q("Not enough wheels for chassis "+f.name)}else if("HULL"==
a.nf)for(f.v={},f.v.Ym=[],f.v.Ls=[],f.v.Fr=a.Fr,f.v.Iq=a.Iq,f.v.im=a.im,f.v.wn=a.wn,f.v.xn=a.xn,f.v.eo=0,f.v.Hq=1,f.v.mp=0,f.v.speed=0,f.v.op=null,g=(h=la.Yi(f))?la.JB(h,e):e,h=0;h<g.length;h++)k=g[h],k.gf&&(p=k.uf,Da.MW(k)&&a.name==p.name?(f.v.Ym.push(k),f.v.Ls.push(new Float32Array(8))):Da.vK(k)&&a.name==p.name?(f.v.op=k,f.v.np=p.np,f.v.lt=p.lt,f.v.bs=p.bs,p=ga.invert(f.k.n,ga.create()),k=ga.multiply(p,k.k.n,p),f.v.gN=k,p=new Float32Array([1,0,0]),ga.Yc(p,k,p),f.v.fN=p):Da.uK(k)&&a.name==p.name?
(f.v.eE=k,f.v.jt=p.jt,f.v.Co=p.Co,p=ga.invert(f.k.n,ga.create()),k=ga.multiply(p,k.k.n,p),f.v.bN=k,p=new Float32Array([1,0,0]),ga.Yc(p,k,p),f.v.aN=p):Da.wK(k)&&a.name==p.name&&(f.v.pE=k,f.v.pr=p.pr,p=ga.invert(f.k.n,ga.create()),k=ga.multiply(p,k.k.n,p),f.v.sN=k,p=new Float32Array([1,0,0]),ga.Yc(p,k,p),f.v.rN=p));for(l=0;l<e.length;l++)if(f=e[l],f.Dm&&(a=f.io,"MAIN_BODY"==a.nf))for(f.ig={},f.ig.im=a.im,f.ig.wn=a.wn,f.ig.xn=a.xn,f.ig.Iu=[],h=(h=la.Yi(f))?la.JB(h,e):e,g=0;g<h.length;g++)k=h[g],k.Dm&&
(p=k.io,Da.RW(k)&&a.name==p.name&&(f.ig.Iu.push(k),k.ZG=k.io.qN));d(b,c)}function G(a,b,c,e,d){for(e=0;e<a.scenes.length;e++){var f=a.scenes[e];f.Mj=f.camera.nb}for(e=0;e<a.scenes.length;e++){var f=b.Mb?a.scenes[e]:Xa,h=b.Mb?Aa.Ub(f,"LAMP",b.id):Aa.Ub(f,"LAMP",0),g=Aa.Ub(f,"ALL",b.id),k=L(b.id,f,"MESH"),p=L(b.id,f,"EMPTY");L(b.id,f,"WORLD");b.Mb&&S.eR(f,g,h,k,p);for(var g=!1,m=0;m<p.length;m++)for(var n=p[m].nb,l=n.I,q=0;q<l.length;q++){var r=l[q].yb,u=S.QN(r,n);f.name==r.name&&(g=g||u)}b.Mb&&f.s.Mc&&
!g&&za.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');p=[];S.ux(f);Y.AV(f,k,h,p);m=L(b.id,f,"LINE");Y.zV(f,m);n=S.MB(f);if(b.Mb){g=f.s.Nx;m=f.world;if(g.NL||g.procedural_skydome)l=m.nb,Y.jR(f,g,l),Y.NA(l,n,f);S.NI(f,n);(g=f.s.Kp)&&g.vt&&Y.aR(f,m.nb)}for(m=0;m<k.length;m++)Y.NA(k[m].nb,n,f);for(m=0;m<p.length;m++)Y.NA(p[m],n,f),Aa.dY(p[m]);g=Aa.Ub(f,"ALL",b.id);S.CR(f,g,h);for(m=0;m<g.length;m++)n=g[m],n.k.Qe&&Aa.e0(n),la.FS(n)&&(n.ZK=!0)}S.fR(Xa,a.textures,b.id);b.Mb&&
Xa.s.Hp.length&&(b.bC=!0);d(b,c)}function B(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var e=a[c],d=Boolean("FILE"==e.source&&-1<e.filepath.indexOf(".dds")&&"dds"==wa.cr);e.Lh=d;e.mq=d?"dds":""}if((La.gB||La.hx)&&wa.YN)for(a=0;a<b.length;a++){for(var e=b[a],f=e.texture_slots,c=0;c<f.length;c++){var d=f[c],h=d.texture;if("IMAGE"==h.type||"ENVIRONMENT_MAP"==h.type){var g=h.image;g&&!g.Lh&&(d=!h.b4w_disable_compression&&!d.use_map_normal&&"ENVIRONMENT_MAP"!=h.type&&!h.b4w_shore_dist_map&&
"MOVIE"!=g.source,O(g,d))}}if(c=e.node_tree)for(e=c.nodes,c=0;c<e.length;c++){f=e[c];d=!1;if("TEXTURE"==f.type){if((h=f.texture)&&(g=h.image)&&!g.Lh&&(d=!h.b4w_disable_compression&&"MOVIE"!=h.image.source&&"ENVIRONMENT_MAP"!=h.type)){a:{d=f.outputs;for(f=0;f<d.length;f++)if(h=d[f],h.is_linked&&"Normal"==h.identifier){d=!0;break a}d=!1}d=!d}}else"TEX_IMAGE"==f.type?(g=f.image)&&!g.Lh&&(d="MOVIE"!=g.source):"TEX_ENVIRONMENT"==f.type&&(d=!1);g&&!g.Lh&&O(g,d)}}}function O(a,b){-1<a.filepath.indexOf(".dds")?
(a.Lh=!0,a.mq="dds"):(a.Lh=b)?(a.mq=wa.cr,a.filepath="dds"==wa.cr?a.filepath+".dds":oa.kn(a.filepath)[0]+".pvr"):a.mq=""}function K(a,b,c,e,d){e=a.groups;for(var f=a.objects,h={},g={},k={},p={},m=0;m<e.length;m++){var n=e[m];h[n.uuid]=n;k[n.uuid]=n}for(m=0;m<f.length;m++)n=f[m],g[n.uuid]=n,p[n.uuid]=n;a=a.scenes;for(m=0;m<a.length;m++)E(a[m].objects,null,p,k,null);for(var l in k)l in h||e.push(k[l]);for(l in p)l in g||f.push(p[l]);d(b,c)}function E(a,b,c,e,d){for(var f=[],h=0;h<a.length;h++){var g=
a[h],k=c[g.uuid];if(g=k.proxy){b&&-1==f.indexOf(g.uuid)&&f.push(g.uuid);for(var p=c[g.uuid],m=p.constraints,g=0;g<m.length;g++){var n=Ea.Qh(m[g]);n.name+="_CLONE";k.constraints.push(n)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(p.animation_data=Ea.Qh(k.animation_data)),p.b4w_use_default_animation=k.b4w_use_default_animation,p.b4w_auto_skel_anim=k.b4w_auto_skel_anim,p.b4w_anim_behavior=k.b4w_anim_behavior,p.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(h=0;h<f.length;h++)k=
Ea.YV(a,f[h]),-1<k&&a.splice(k,1);f={};if(b)for(h=0;h<a.length;h++)g=a[h],k=c[g.uuid],m=Ea.Qh(k),p="origin_name"in k?k.origin_name:k.name,m.name=la.MI(b.name,p),m.origin_name=p,m.dg_parent={uuid:b.uuid},C(m),c[m.uuid]=m,f[g.uuid]=m.uuid,g.uuid=m.uuid,d&&d[k.uuid]&&(m.b4w_cluster_data=d[k.uuid]);for(h=0;h<a.length;h++)g=a[h],k=c[g.uuid],k.dupli_group&&(g=k.dupli_group,d=e[g.uuid],m=Ea.Qh(d),m.name=Ea.ot(d.name+"_CLONE"),m.uuid=ja.cK("Group"+m.name),e[m.uuid]=m,g.uuid=m.uuid,E(m.objects,k,c,e,k.b4w_cluster_data));
if(b)for(h=0;h<a.length;h++){g=a[h];k=c[g.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(za.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);m=k.constraints;for(g=0;g<m.length;g++)b=m[g],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(e=b.bones,g=0;g<e.length;g++)if(d=e[g].constraints)for(m=0;m<d.length;m++)b=d[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=k.modifiers;
for(g=0;g<b.length;g++)e=b[g],e.object&&e.object.uuid in f&&(e.object.uuid=f[e.object.uuid]);if((k=k.lod_levels)&&k.length)for(g=0;g<k.length;g++)b=k[g],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var l in f)Ja[l]=f[l]}function C(a){a.uuid=ja.cK("Object"+a.name)}function Q(a,b){for(var c=a.nodes,e=0;e<c.length;e++){var d=c[e];"TEXTURE"==d.type&&d.texture&&k(d,"texture",b);"LAMP"==d.type&&d.lamp&&(d.lamp.uuid in Ja&&(d.lamp.uuid=Ja[d.lamp.uuid]),b[d.lamp.uuid]||(d.lamp=null));
"GROUP"==d.type&&d.node_group&&k(d,"node_group",b);"TEX_IMAGE"!=d.type&&"TEX_ENVIRONMENT"!=d.type||!d.image||k(d,"image",b)}d=a.links;for(e=0;e<d.length;e++){var f=d[e];p(f,"from_node",c);p(f,"to_node",c);x(f,"from_socket",f.from_node.outputs);x(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&k(c,"action",b),c.nla_tracks)for(e=0;e<c.nla_tracks.length;e++)for(d=c.nla_tracks[e],f=0;f<d.strips.length;f++)d.strips[f].action&&k(d.strips[f],"action",b)}function k(a,b,c){(c=c[a[b].uuid])||
za.error("Dangling link found:",b,a);a[b]=c}function p(a,b,c){c=Ea.Gd("name",a[b].name,c);a[b]=c}function x(a,b,c){c=Ea.Gd("identifier",a[b].identifier,c);a[b]=c}function e(a,b,c,e,f,h){var g=[],k={};e=a.images;for(var p=Ga.pJ(),m=na(b.bh),n=0;n<e.length;n++){var l=e[n],q=l.uuid;if(q){var r=Ea.oj(m+l.filepath),u=l.source;if("FILE"===u){var u=l.Lh?oa.Gt:oa.Ht,w=oa.kn(r),t=w[1].toLowerCase();if(!oa.ES(t)){za.error("image ",l," has unsupported format.");continue}La.JC&&wa.use_min50&&("dds"==w[1]?(r=
oa.kn(w[0]),r=r[0]+".min50."+r[1]+".dds"):r=w[0]+".min50."+w[1])}else if("MOVIE"===u)if(wa.Ys)w=oa.kn(r),r=w[0]+".altconv.seq",u=oa.It;else{w=oa.kn(r);t=w[1].toLowerCase();u=da.sU(t);if(""==u){za.error("failed to load video file (unsupported format)",r);continue}r=u!=t?w[0]+".altconv."+u:w[0]+"."+w[1];u=oa.Jt}else{za.error('Image "'+l.name+'" has unsupported format "'+u+'".');continue}if(!b.uk)for((q in k)||(k[q]=[]),w=0;w<p.length;w++)t=p[w],t.ro==q&&t.xm==l.mq&&k[q].push(t);k[q].length&&g.push({id:q,
type:u,url:r,ih:b.uk})}}if(g.length){var x=0;oa.Yd(g,function(e,f,p,m){if(e){var n=p;if(!b.uk){f=k[f];for(n=0;n<f.length;n++){var l=f[n];if(p==oa.It)l.Ws=e.eh,Ga.qt(l,e.images,b.id);else if(Ga.qt(l,e,b.id),"ENVIRONMENT_MAP"==l.source)for(l=0;l<a.scenes.length;l++)S.ME(a.scenes[l])}n=f[0].xm}p==oa.Jt||p==oa.It?(p==oa.Jt?(p=e.videoWidth,e=e.videoHeight):(p=e.images[0].width,e=e.images[0].height),za.log("%cLOAD VIDEO "+p+"x"+e,"color: #"+(2048<p||2048<e?"a00":1024<p||1024<e?"aa0":"0a0"),m),-1==m.indexOf(bb)&&
za.warn("video",m,"is not from app root.")):d(e,m,!0,n)}m=++x/g.length;h(b,c,m)},function(){za.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})}else f(b,c)}function w(a,b,c,e,d){a=S.RB();for(e=0;e<a.length;e++){var f=a[e];if(f.b4w_use_nla){var h=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(h=!1);qa.w0(f,h,b.id)}}d(b,c)}function n(a,b,c,e,d,f){a=na(b.bh);var h=[],g={};e=Aa.qm(b.id);for(var k=0;k<e.length;k++){var p=e[k];if(la.gs(p)&&da.ZM(p)!=da.dF){var m=p.Y.Fj;"BACKGROUND_MUSIC"==da.TB(p)?(m=Ea.DB(),
b.$B=!0):"NONE"!=da.TB(p)&&wa.gC&&(b.fC=!0);if(!(m in g)){g[m]=[];var n=Ea.oj(a+p.Y.bh);switch(da.ZM(p)){case da.Dy:var l=oa.Ey;break;case da.cF:l=oa.Fy}ea(h,m,l,n,b.uk)}g[m].push(p)}}if(h.length){var q=0;oa.Yd(h,function(a,e,d,k){if(a)for(za.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(bb)&&za.warn("sound",k,"is not from app root."),e=g[e],d=0;d<e.length;d++)da.B0(e[d],a);a=++q/h.length;f(b,c,a)},function(){za.log("%cLOADED ALL SOUNDS","color: #0aa");d(b,c)})}else d(b,c)}function ea(a,b,c,e,
d){var f=oa.kn(e),h=f[1].toLowerCase(),g=da.qU(h);""!=g?(e=g!=h?f[0]+".altconv."+g:f[0]+"."+f[1],a.push({id:b,type:c,url:e,ih:d})):za.error("failed to load audio file (unsupported format)",e)}function I(a,b,c){a=Aa.Ub(a,"SPEAKER",b);for(b=0;b<a.length;b++){var e=a[b];la.gs(e)&&(da.LW(e)||c)&&da.sL(e)}}function F(a,b){for(var c=a.s.Hp,e=0;e<c.length;e++){var d=c[e].s;a.b4w_use_nla&&c[e].b4w_nla_video||!c[e].use_auto_refresh||b!=d.Dt||(Ga.RL(d),Ga.uL(d))}}function T(a,b,c,e,d){qa.start();za.log("%cSTART NLA",
"color: #0a0");d(b,c)}function M(a,b,c,e,d){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,h=0;h<f;h++){var g=b.lod_levels[h],k=g.object;if(k){var p=Ea.Vq(k);p.name=b.name+"_LOD_"+String(h+1);p.b4w_cluster_data=b.b4w_cluster_data;C(p);p.lod_levels=[];c&&(p.dg_parent=c);e.push([a,p]);d.push(k);g.object=p}}}function X(a,b,c,e,d){e=!0;for(var f=0;f<a.scenes.length;f++)if(!Da.KS(a.scenes[f])){e=!1;break}e&&(d(b,c),za.log("%cPHYSICS READY","color: #0a0"))}function H(a,b,c,e,d){for(e=
0;e<a.scenes.length;e++){var f=a.scenes[e];if(b.Mb)var h=Da.qx(f);else h=Da.qx(Xa)||Da.qx(f),f=Xa;if(Ra.enabled&&h)for(h=0;h<lc.length;h++)for(var g=Aa.Ub(f,lc[h],b.id),k=0;k<g.length;k++){var p=g[k];p.k.$e==b.id&&(Da.Ln(p,f),b.JK&&Da.oa(p)&&Da.nB(p))}}d(b,c)}function fa(a,b,c,e,f){var h={};e=[];for(var g=a.scenes,k=0;k<a.scenes.length;k++){var p=g[k];if(p.s.Mc){var m=p.s.Mc.Yk;if(m&&"FILE"===m.source){var p=m.uuid,n=Ea.oj(na(b.bh)+m.filepath);e.push({id:p,type:m.Lh?oa.Gt:oa.Ht,url:n});h[p]=m}}}e.length?
oa.Yd(e,function(a,c,e,f){if(a){d(a,f,!0);e=[];f=Ga.pJ();for(var k=0;k<f.length;k++){var p=f[k];p.uri===c&&e.push(p)}for(c=0;c<e.length;c++)Ga.qt(e[c],a,b.id);for(c=0;c<g.length;c++)if(e=g[c],e.s.Mc&&(f=e.s.Mc.Yk,f===m)){var p=a,n=document.createElement("canvas");f=m.size[0];k=m.size[1];n.width=f;n.height=k;n=n.getContext("2d");n.drawImage(p,0,0);p=n.getImageData(0,0,f,k).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=k;for(var k=new Float32Array(f),l=0;l<f;l++)k[l]=
n[1]*p[4*l+2]+n[2]*p[4*l+3];e.s.$D=k}}else for(a=h[c],c=0;c<g.length;c++)e=g[c],f=e.s.Mc.Yk,f===a&&(e.s.Mc.Yk=null,za.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,c)}):f(b,c)}function V(a,b,c,e,f){e=a.scenes[0];a=[];for(var h=[xb.ku,xb.iq,xb.lu,xb.Kz],g=0;g<h.length;g++){var k=S.La(e,h[g]);k&&a.push(k)}if(a.length){e=[];g=oa.Ht;e.push({id:"SEARCH_TEXTURE",type:g,bh:ua.Je.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:g,url:ua.Je.smaa_area_texture_path});
for(g=0;g<a.length;g++)if(h=a[g],h.type==xb.iq){a=h.Ya;for(g=0;g<a.length;g++)if(h=a[g],"u_search_tex"==h.to)var p=h.jb;else if("u_area_tex"==h.to)var m=h.jb;break}e.length?oa.Yd(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?p:m,c.source="IMAGE",Ga.qt(c,a,b.id),Ga.LD(c,Ga.L,Ga.L))},function(){f(b,c)}):f(b,c)}else f(b,c)}function P(a,b,c,e){for(c=0;c<a.scenes.length;c++){var d=a.scenes[c];b.Mb||(d=Xa);for(var f=Aa.Ub(d,"LAMP",b.id),h=0;h<f.length;h++){var g=f[h];g.k.$e==b.id&&e.Tz.push({yb:d,
obj:g})}f=Aa.Ub(d,"ALL",b.id);for(h=0;h<f.length;h++)g=f[h],"LAMP"!=g.type&&g.k.$e==b.id&&(b.JK&&la.ce(g)&&S.Nq(g,!0),e.Tz.push({yb:d,obj:g}))}}function W(a,b,c,e,d,f){var h=e.Tz;d=e.eL;if(h.length){a=h[d].obj;var g=h[d].yb;d=la.ja(a,g);S.Ln(g,a,!1);!a.anchor||g.s.cw||g.s.anaglyph_use||ra.append(a);e=++e.eL/h.length;h=d.Ri;if(-1!=a.k.Vd&&h){var k=va.copy(a.k.kb.G,hb);S.PN(h,k)}h=a.Rs;if(h.length&&g.s.li)for(g=ga.F(a.k.n),a=ga.P(a.k.n),d=d.ii,k=0;k<d.length;k++)S.SN(d[k],g,a),la.TN(h,d[k].p.rc)}else e=
1;f(b,c,e)}function ha(a,b,c,e,d){if(b.Mb){e=S.Zh();S.ME(e);var f=S.RB();for(a=0;a<f.length;a++){var h=f[a];S.ME(h);S.AY(h,e)}S.ux(e)}else S.UN(Xa);e=Aa.qm(b.id);Aa.s0(e);for(f=0;f<e.length;f++)for(h=e[f],a=0;a<h.I.length;a++)for(var g=h.I[a].X,k=0;k<g.length;k++)null==g[k].zb&&g.splice(k--,1);d(b,c)}function v(a,b,c,e,d){if(b.Mb)for(a=S.RB(),e=0;e<a.length;e++){var f=a[e];f.b4w_use_logic_editor&&ta.BW(f,b.id)}d(b,c)}function aa(a,b,c,e,d){if(b.Mb)for(e=0;e<a.scenes.length;e++)F(a.scenes[e],b.id),
I(a.scenes[e],b.id,!1);else F(Xa,b.id),I(Xa,b.id,!1);d(b,c)}function Z(a,b,c,e,d){for(e=0;e<a.scenes.length;e++)a.scenes[e].camera=null;wa.media_auto_activation&&(b.bC||b.$B||b.fC)?ib||ba(a,d,b,c):d(b,c)}function ba(a,b,c,e){var d=sb.parentElement;yb=d.style.zIndex;d.style.zIndex="999";ib=document.createElement("div");ib.style.position="relative";ib.style.height="88px";ib.style.width="88px";var f=Math.round(sb.offsetWidth/2-44);ib.style.top=Math.round(sb.offsetHeight/2-44).toString()+"px";ib.style.left=
f.toString()+"px";ib.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
ib.style.backgroundSize="88px";ob=document.createElement("div");ob.style.position="relative";ob.style.height=sb.offsetHeight.toString()+"px";ob.style.width=sb.offsetWidth.toString()+"px";ob.style.background="rgba(0, 0, 0, 0.5)";ob.style.zIndex="999";d.appendChild(ob);ob.appendChild(ib);ib.addEventListener("click",function(){c.bC&&(Ga.play(),Ga.pause(),Ga.reset());if(c.$B){if(c.Mb)for(var d=0;d<a.scenes.length;d++)I(a.scenes[d],c.id,!0);else I(Xa,c.id,!0);da.pause()}c.fC&&da.tL();ya();b(c,e)},!1)}
function ya(){if(ib){var a=sb.parentElement;a.style.zIndex=yb;ob.removeChild(ib);a.removeChild(ob);ib=ob=null;yb=0}}function na(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function R(a){xa.yc(a)&&xa.remove(a);Ia.JY(a);Aa.Qu(a);sa.Ql(a)&&sa.ie(a);Da.oa(a)&&Da.Ss(a);S.KY(a);la.gs(a)&&da.i_(a);ra.KW(a)&&ra.remove(a)}function ca(a){var b=xa.aJ(a);return(a=b&&b.parent==a?null:a.parent||b)?1+ca(a):0}var ra=g("__anchors"),xa=g("__animation"),oa=g("__assets"),Y=g("__batch"),ua=g("__config"),
sa=g("__controls"),N=g("__texcomp"),ia=g("__debug"),J=g("__extensions"),ma=g("__input"),pa=g("__loader"),ja=g("__md5"),qa=g("__nla"),ta=g("__logic_nodes"),Ia=g("__particles"),Ca=g("__nodemat"),Aa=g("__objects"),la=g("__obj_util"),Da=g("__physics"),za=g("__print"),Sa=g("__quat"),Fa=g("__reformer"),Na=g("__renderer"),S=g("__scenes"),da=g("__sfx"),ka=g("__shaders"),xb=g("__subscene"),Ga=g("__textures"),Dc=g("__time"),Qa=g("__transform"),ga=g("__tsr"),Ea=g("__util"),va=g("__vec3"),U=g("__vec4"),Oa=ua.Gl,
wa=ua.B,La=ua.Td,Ra=ua.C,rb=ua.Y,Ta=null,Ba=null,bb="",Xa=null,Ja={},hb=new Float32Array(3),eb=new Float32Array(4),cb=new Float32Array(4),nb=new Float32Array(4),ib=null,ob=null,yb=0,Ua=!1,Nb=["LAMP","CAMERA"],lc=["MESH","CAMERA","EMPTY"],Xb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],sb=null;a.kh=function(a){return pa.kh(a)};a.update=function(){pa.x0(Ta)};a.SZ=function(a){sb=a};a.p0=function(a,b){if(ib){ob.style.height=b.toString()+"px";ob.style.width=a.toString()+"px";var c=Math.round(a/2-44);ib.style.top=
Math.round(b/2-44).toString()+"px";ib.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,h){var g={load_main:{Nb:pa.Fg,Rb:!1,M:[],Wb:!1,Yb:500,lc:!1,bc:b},duplicate_objects:{Nb:pa.ze,Rb:!1,M:["load_main"],Wb:!1,Yb:50,lc:!1,bc:K},load_binaries:{Nb:pa.Fg,Rb:!1,M:["load_main"],Wb:!1,Yb:500,lc:!1,bc:y},wait_for_shaders:{Nb:pa.ze,Rb:!1,M:[],Wb:!1,Yb:50,lc:!0,Wj:r},prepare_bindata:{Nb:pa.ze,Rb:!1,M:["duplicate_objects","load_binaries"],Wb:!1,Yb:100,lc:!1,bc:A},prepare_bpy_data:{Nb:pa.ze,Rb:!1,M:["duplicate_objects",
"prepare_bindata"],Wb:!1,Yb:100,lc:!1,bc:m},process_objects:{Nb:pa.ze,Rb:!1,M:["prepare_bpy_data"],Wb:!1,Yb:150,lc:!1,bc:D},process_scenes:{Nb:pa.ze,Rb:!1,M:["process_objects","wait_for_shaders"],Wb:!1,Yb:300,lc:!1,bc:G},load_smaa_textures:{Nb:pa.Fg,Rb:!1,M:["process_scenes"],Wb:!1,Yb:30,lc:!0,bc:V},load_shoremap:{Nb:pa.Fg,Rb:!1,M:["process_scenes"],Wb:!1,Yb:30,lc:!0,bc:fa},load_images:{Nb:pa.Fg,Rb:!0,M:["process_scenes"],Wb:!0,Yb:500,lc:!1,bc:e},update_scenes_nla:{Nb:pa.ze,Rb:!1,M:["process_scenes",
"load_images"],Wb:!1,Yb:50,lc:!1,bc:w},wait_physics_workers:{Nb:pa.ze,Rb:!1,M:["load_shoremap"],Wb:!1,Yb:20,lc:!1,Wj:X},add_physics_objects:{Nb:pa.ze,Rb:!1,M:["wait_physics_workers"],Wb:!1,Yb:50,lc:!1,bc:H},add_objects:{Nb:pa.ze,Rb:!1,M:["add_physics_objects"],Wb:!1,Yb:600,lc:!1,bc:P,Wj:W,Kq:ha,Lq:{Tz:[],eL:0}},init_logic_nodes:{Nb:pa.ze,Rb:!1,M:["update_scenes_nla","add_objects"],Wb:!1,Yb:50,lc:!1,bc:v},load_speakers:{Nb:pa.Fg,Rb:!0,M:["add_objects"],Wb:!0,Yb:100,lc:!1,bc:n},mobile_media_start:{Nb:pa.ze,
Rb:!1,M:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Wb:!0,Yb:5,lc:!1,bc:Z,Wj:Z},synchronize_media:{Nb:pa.ze,Rb:!0,M:["mobile_media_start"],Wb:!0,Yb:50,lc:!1,bc:aa},start_nla:{Nb:pa.ze,Rb:!0,M:["mobile_media_start"],Wb:!1,Yb:5,lc:!0,bc:T}},k=pa.SB();k||(k=pa.TH(),Ta={},Ba={},Ja={});Ta[k.Ah.length]={};return pa.YH(g,a,c,d,l,f||rb.HG,wa.do_not_load_resources,h,!1)};a.hy=function(a){var b=pa.SB();if(!b||!b.Ah.length||a&&!pa.K_(b.Ah[a]))za.error("Unable to unload data!");else{if(0==
a)za.log("%cUNLOAD ALL","color: #00a"),ra.ua(),xa.ua(),da.ua(),Y.ua(),S.ua(),pa.ua(),sa.ua(),Da.ua(),Aa.ua(),Ea.ua(),Na.ua(),Ca.ua(),ka.ua(),J.ua(),oa.ua(),Ga.ua(),ta.ua(),Ia.ua(),ma.ua(),ia.ua(),Ba=null,Ja={},Ta=Xa=null,Ua=!1;else{za.log("%cUNLOAD DATA "+a,"color: #00a");xa.HY(a);for(var b=Aa.qm(Aa.oc),c=0;c<b.length;c++){var e=b[c];la.PB(e)!=a&&Aa.Sw(e,!1,!1,!1)}b=Aa.qm(a);for(c=b.length-1;0<=c;c--)e=b[c],R(e),Aa.Ss(e);b=Aa.qm(Aa.oc);for(c=0;c<b.length;c++)Aa.Sw(b[c],!0,!0,!0)}qa.ua(a);ya()}};a.zY=
R;a.hM=function(a){bb=a};a.nG=function(){Ua||wa.media_auto_activation||(Ga.play(),Ga.pause(),Ga.reset(),I(Xa,Aa.oc,!0),da.pause(),wa.gC&&da.tL(),Ua=!0)};a.reset=function(){sb=null};a.vL=function(a,c,d){var f={load_main:{Nb:pa.Fg,Rb:!1,M:[],Wb:!1,Yb:500,lc:!1,bc:b},load_binaries:{Nb:pa.Fg,Rb:!1,M:["load_main"],Wb:!1,Yb:500,lc:!1,bc:y},load_images:{Nb:pa.Fg,Rb:!1,M:["load_main"],Wb:!1,Yb:500,lc:!1,bc:e},preload_sounds:{Nb:pa.Fg,Rb:!1,M:["load_main"],Wb:!1,Yb:500,lc:!1,bc:q}},h=pa.SB();h||(h=pa.TH(),
Ta={},Ba={},Ja={});Ta[h.Ah.length]={};return pa.YH(f,a,c,d,l,!1,wa.do_not_load_resources,!1,!0)};a.NN=function(){oa.TS()}};b4w.module.__loader=function(a,g){function l(b,c,h,g){var m=B,k=L.create(),p;for(p in c){var l=d(c[p]);(g&&l.Wb||!b&&l.lc)&&f(l);L.J(k,l)}for(p in c)for(l=c[p],l.name=p,b=0;b<l.M.length;b++)L.r(k,c[l.M[b]],l,null);c=d({name:"out",Nb:a.EO,bc:function(a,b,c,e,d){b.Mb&&(m.gE=!0);z(b)||(b.status=2);b.KK(b.id,!0);d(b,c);D.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Yb:5});if(h)h=L.Qr(k);else{p=L.clone(k);do{h=L.Qr(p);l=[];for(b=0;b<h.length;b++){g=h[b];var e=L.Va(p,g);e.Rb&&l.push(g)}for(b=
0;b<l.length;b++)L.zg(p,l[b]);l.length&&L.yA(p)}while(l.length)}L.J(k,c);for(b=0;b<h.length;b++)g=h[b],e=L.Va(k,g),c.M.push(e.name),L.r(k,e,c,null);return k}function d(a){a.Rb=a.Rb||!1;a.Nb||0===a.Nb||(a.Nb=a.ze);a.M=a.M||[];a.Cm=a.Cm||!1;a.cE=a.cE||!1;a.Yb=a.Yb||0;a.Wb=a.Wb||!1;a.lc=a.lc||!1;a.status=0;a.l8=0;a.yC=0;a.Lq=a.Lq||null;return a}function b(a,b){for(var c=[],d=[],f=0;f<b.length;f++){var h=b[f];L.Va(a.si,h).Cm&&(L.hl(a.si,h,function(d){var f=!0;L.vi(a.si,d,function(a,b){if(!b.Cm)return f=
!1,1});f&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(f))}for(f=d.length-1;0<=f;f--)b.splice(d[f],1);return c}function y(a){function c(b,d){var e=L.Va(a.si,b),f=L.Va(a.si,d),h=f.Nb-e.Nb;0==h&&(h=e.Rb-f.Rb);return h}var d=[],f=a.yj,h=!1;do{var g=b(a,f);d.push.apply(d,f);0<g.length&&(h=!0);f=g}while(0<g.length);h&&d.sort(c);a.yj=d;return a.yj.length}function r(a,b,c){if(b.cE)return b.Cm=!0,h(a,b),!1;if(!b.bc&&!b.Wj&&!b.Kq)return h(a,b),!1;if(0==b.status&&(b.status++,b.bc))return b.bc(c,a,
b,b.Lq,h,u),!0;if(1==b.status){if(b.Wj)return b.Wj(c,a,b,b.Lq,h,u),!0;b.status++}return 2==b.status&&(b.status++,b.Kq)?(b.Kq(c,a,b,b.Lq,h,u),!0):!1}function A(a){if(0==a.Ux)return 100;var b=0;L.pa(a.si,function(c,d){a.do_not_load_resources&&d.Wb||(b+=d.yC*d.Yb)});return G.trunc(100*b/a.Ux)}function h(a,b){b.Cm=!0;b.status=3;m(a,b,1)}function u(a,b,c){1>c?m(a,b,c):b.status++}function m(a,b,c){var d=B;if(b.bc||b.Wj||b.Kq)if(b.yC=c,b=A(a),a.fI!=b||1==c)a.fE(b,performance.now()-a.DN),a.fI=b,d.AC=!0}function q(a,
b){var c=null;L.pa(a.si,function(a,d){if(d.name==b)return c=d,1});return c}function f(a){a.cE=!0;a.yC=1}function t(a){a.fE=null;a.FA=null;a.si=null;a.yj=null}function c(){return 0==B.uu}function z(a){return a&&(3==a.status||4==a.status)}var L=g("__graph"),D=g("__print"),G=g("__util");a.ze=0;a.Fg=1;a.EO=2;var B=null;a.SB=function(){return B};a.TH=function(){var a={Ah:[],eB:0,uu:0,gE:!1,AC:!1};return B=a};a.YH=function(a,b,c,d,f,h,g,m,e){var q=B,n=q.Ah.length,r={id:n,Mb:0==n,status:0,bh:b,TG:"",KK:c||
function(){},JK:m||!1,gaa:h,DN:0,fI:0,Ux:0,AD:!1,fE:d||function(){},FA:f||function(){},si:null,yj:null,bC:!1,$B:!1,fC:!1,uk:e};a=l(r.Mb,a,h,g);r.si=a;b=[];c=L.dW(a);for(d=0;d<c.length;d++)b.push(c[d]);r.yj=b;L.pa(a,function(a,b){!(b.bc||b.Wj||b.Kq)||r.do_not_load_resources&&b.Wb||(r.Ux+=b.Yb)});q.Ah.push(r);q.uu++;return r.id};a.x0=function(b){var d=B;if(d&&!c())if(d.AC)d.AC=!1;else{var f=performance.now();do{var h=d.Ah[d.eB],g=b[h.id];if(!z(h))if(0==h.status&&(h.status=1,h.DN=performance.now(),h.fE(0,
0)),y(h)){var k=h,p=k.yj.length;do{var m=L.Va(k.si,k.yj[0]),e=r(k,m,g);m.Nb==a.Fg&&(k.AD=!0);m=k.yj.shift();k.yj.push(m);p--}while(!e&&0!=p)}else k=d,p=h,p.FA(g,p),p.status=3,k.uu--,t(p);d.gE&&(d.eB=(d.eB+1)%d.Ah.length);if(h.AD){h.AD=!1;break}}while(16>performance.now()-f)}};a.jG=function(a){var b=B;a.FA(null,a);a.status=3;b.uu--;t(a);a.status=4;a.Mb&&(b.gE=!0);a.KK(a.id,!1)};a.r$=u;a.Mx=function(a,b){var c=q(a,b);null!==c&&f(c)};a.Cm=c;a.K_=z;a.kh=function(a){var b=B;if(!b)return!1;a|=0;return b.Ah[a]&&
(3==b.Ah[a].status||2==b.Ah[a].status)};a.lW=function(){D.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ua=function(){B=null}};b4w.module.__md5=function(a){function g(a,h){var g=a[0],m=a[1],q=a[2],f=a[3],g=d(g,m,q,f,h[0],7,-680876936),f=d(f,g,m,q,h[1],12,-389564586),q=d(q,f,g,m,h[2],17,606105819),m=d(m,q,f,g,h[3],22,-1044525330),g=d(g,m,q,f,h[4],7,-176418897),f=d(f,g,m,q,h[5],12,1200080426),q=d(q,f,g,m,h[6],17,-1473231341),m=d(m,q,f,g,h[7],22,-45705983),g=d(g,m,q,f,h[8],7,1770035416),f=d(f,g,m,q,h[9],12,-1958414417),q=d(q,f,g,m,h[10],17,-42063),m=d(m,q,f,g,h[11],22,-1990404162),g=d(g,m,q,f,h[12],7,1804603682),f=d(f,g,m,q,
h[13],12,-40341101),q=d(q,f,g,m,h[14],17,-1502002290),m=d(m,q,f,g,h[15],22,1236535329),g=b(g,m,q,f,h[1],5,-165796510),f=b(f,g,m,q,h[6],9,-1069501632),q=b(q,f,g,m,h[11],14,643717713),m=b(m,q,f,g,h[0],20,-373897302),g=b(g,m,q,f,h[5],5,-701558691),f=b(f,g,m,q,h[10],9,38016083),q=b(q,f,g,m,h[15],14,-660478335),m=b(m,q,f,g,h[4],20,-405537848),g=b(g,m,q,f,h[9],5,568446438),f=b(f,g,m,q,h[14],9,-1019803690),q=b(q,f,g,m,h[3],14,-187363961),m=b(m,q,f,g,h[8],20,1163531501),g=b(g,m,q,f,h[13],5,-1444681467),f=
b(f,g,m,q,h[2],9,-51403784),q=b(q,f,g,m,h[7],14,1735328473),m=b(m,q,f,g,h[12],20,-1926607734),g=l(m^q^f,g,m,h[5],4,-378558),f=l(g^m^q,f,g,h[8],11,-2022574463),q=l(f^g^m,q,f,h[11],16,1839030562),m=l(q^f^g,m,q,h[14],23,-35309556),g=l(m^q^f,g,m,h[1],4,-1530992060),f=l(g^m^q,f,g,h[4],11,1272893353),q=l(f^g^m,q,f,h[7],16,-155497632),m=l(q^f^g,m,q,h[10],23,-1094730640),g=l(m^q^f,g,m,h[13],4,681279174),f=l(g^m^q,f,g,h[0],11,-358537222),q=l(f^g^m,q,f,h[3],16,-722521979),m=l(q^f^g,m,q,h[6],23,76029189),g=
l(m^q^f,g,m,h[9],4,-640364487),f=l(g^m^q,f,g,h[12],11,-421815835),q=l(f^g^m,q,f,h[15],16,530742520),m=l(q^f^g,m,q,h[2],23,-995338651),g=y(g,m,q,f,h[0],6,-198630844),f=y(f,g,m,q,h[7],10,1126891415),q=y(q,f,g,m,h[14],15,-1416354905),m=y(m,q,f,g,h[5],21,-57434055),g=y(g,m,q,f,h[12],6,1700485571),f=y(f,g,m,q,h[3],10,-1894986606),q=y(q,f,g,m,h[10],15,-1051523),m=y(m,q,f,g,h[1],21,-2054922799),g=y(g,m,q,f,h[8],6,1873313359),f=y(f,g,m,q,h[15],10,-30611744),q=y(q,f,g,m,h[6],15,-1560198380),m=y(m,q,f,g,h[13],
21,1309151649),g=y(g,m,q,f,h[4],6,-145523070),f=y(f,g,m,q,h[11],10,-1120210379),q=y(q,f,g,m,h[2],15,718787259),m=y(m,q,f,g,h[9],21,-343485551);a[0]=g+a[0]&4294967295;a[1]=m+a[1]&4294967295;a[2]=q+a[2]&4294967295;a[3]=f+a[3]&4294967295}function l(a,b,d,g,l,f){b=(b+a&4294967295)+(g+f&4294967295)&4294967295;return(b<<l|b>>>32-l)+d&4294967295}function d(a,b,d,g,q,f,r){return l(b&d|~b&g,a,b,q,f,r)}function b(a,b,d,g,q,f,r){return l(b&g|d&~g,a,b,q,f,r)}function y(a,b,d,g,q,f,r){return l(d^(b|~g),a,b,q,
f,r)}var r="0123456789abcdef".split("");a.cK=function(a){var b=a,d=b.length;a=[1732584193,-271733879,-1732584194,271733878];var m;for(m=64;m<=b.length;m+=64){for(var l=b.substring(m-64,m),f=[],t=void 0,t=0;64>t;t+=4)f[t>>2]=l.charCodeAt(t)+(l.charCodeAt(t+1)<<8)+(l.charCodeAt(t+2)<<16)+(l.charCodeAt(t+3)<<24);g(a,f)}b=b.substring(m-64);l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(m=0;m<b.length;m++)l[m>>2]|=b.charCodeAt(m)<<(m%4<<3);l[m>>2]|=128<<(m%4<<3);if(55<m)for(g(a,l),m=0;16>m;m++)l[m]=0;l[14]=8*
d;g(a,l);for(b=0;b<a.length;b++){d=a[b];m="";for(l=0;4>l;l++)m+=r[d>>8*l+4&15]+r[d>>8*l&15];a[b]=m}return a.join("")}};b4w.module.scenes=function(a,g){function l(){var a=y.Yh();return h.No(a.clientWidth/2,a.clientHeight/2)}var d=g("__batch"),b=g("__camera"),y=g("__container"),r=g("__data"),A=g("__graph"),h=g("__objects"),u=g("__obj_util"),m=g("__print"),q=g("__scenes"),f=g("__subscene"),t=g("__util");a.oc=h.oc;a.ux=function(a){var b=q.Nr();q.ux(t.Gd("name",a,b))};a.A=function(){return q.Da()?q.A().name:""};a.P6=function(){for(var a=q.Nr(),b=[],d=0;d<a.length;d++)b.push(a[d].name);return b};a.Fd=function(){if(q.Da())return q.rm(q.A());
m.error("No active scene");return!1};a.OB=function(a){var b=h.xc(h.Zy,a,0,!0);if(b)return b;m.error("get object "+a+": not found")};a.Mf=function(a,b){var d=h.xc(h.Yy,a,b,0);if(d)return d;m.error("get object "+b+": not found")};a.z6=function(a,b){var d=h.xc(h.Oc,a,b|0);if(d)return d;m.error("get object "+a+": not found")};a.Ov=function(a,b){var d=h.Ov(a,b|0);if(d)return d;m.error("get object "+a+": not found")};a.PB=function(a){return u.PB(a)};a.No=function(a,b){var d=q.Zh();return d?(d=q.La(d,f.Fi))&&
d.enable_hmd_stereo?(m.R("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),l()):h.No(a,b):(m.error("No active scene"),null)};a.L8=l;a.aD=function(a){return a&&a.k&&a.k.Wc};a.Yo=function(a,b){a&&a.k&&a.k.Wc?h.Yo(a,b):m.error("set_outline_intensity(): wrong object")};a.H6=function(a){if(a&&a.k&&a.k.Wc)return a.k.sh;m.error("get_outline_intensity(): wrong object")};a.Mn=function(a,b,d,f){a&&a.k&&a.k.Wc?h.Mn(a,b,d,f):m.error("apply_outline_anim(): wrong object")};
a.u3=function(a){if(a&&a.k&&a.k.Wc){var b=a.k.hi;h.Mn(a,b.Gk,b.Hk,b.Ik)}else m.error("apply_outline_anim_def(): wrong object")};a.Qu=function(a){a&&a.k&&a.k.Wc?h.Qu(a):m.error("clear_outline_anim(): wrong object")};a.vM=q.vM;a.G6=function(a){var b=q.A();if(b=q.La(b,f.En))return a=a||new Float32Array(3),a.set(b.pj),a};a.yx=function(a){q.Da()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),q.yx(a)):m.error("No active scene")};a.Q6=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A(),b=q.La(a,f.dd);if(!b)return null;var d=a.s.yd,h=q.La(a,f.Pb),g=q.La(a,f.Df),l={};l.csm_resolution=d.csm_resolution;l.self_shadow_polygon_offset=b.self_shadow_polygon_offset;
g&&(l.self_shadow_normal_offset=g.self_shadow_normal_offset);l.enable_csm=d.enable_csm;l.csm_num=d.csm_num;l.csm_first_cascade_border=d.csm_first_cascade_border;l.first_cascade_blur_radius=d.first_cascade_blur_radius;l.csm_last_cascade_border=d.csm_last_cascade_border;l.last_cascade_blur_radius=d.last_cascade_blur_radius;l.fade_last_cascade=d.fade_last_cascade;l.blend_between_cascades=d.blend_between_cascades;d.enable_csm?(l.csm_borders=q.IV(a,h.p),l.blur_radii=new Float32Array(d.csm_num),l.blur_radii.set(h.p.Mo.subarray(0,
d.csm_num))):(l.csm_borders=null,l.blur_radii=null);return l};a.X9=function(a){if(q.Da()){var h=q.A();"number"==typeof a.self_shadow_polygon_offset&&A.pa(h.s.Wa,function(b,d){d.type==f.dd&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var g=q.La(h,f.Df);g&&("number"==typeof a.self_shadow_normal_offset&&(g.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius));var l=q.La(h,f.Pc);l&&("number"==typeof a.self_shadow_normal_offset&&
(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius),l.Ba=!0);l=h.s.yd;"number"==typeof a.csm_first_cascade_border&&(l.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(l.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(l.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(l.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(g){for(var r=g.Qa,t=0;t<r.length;t++)for(var y=r[t].sa,K=0;K<y.length;K++){var E=y[K];if(E.mf.je){var C=E.za;d.EG(C,l);d.Zc(C);f.Sc(g,E)}}g.Ba=!0}g=u.ja(h.Mj,h).da;for(t=0;t<g.length;t++)b.KE(g[t],l);q.ID(h)}else m.error("No active scene")};a.iJ=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.iJ(a)};a.wx=function(a,b,d){if(q.Da()){var h=q.A(),g=q.La(h,f.Pb);q.wx(h,a||0==a?parseFloat(a):g.ah,b||0==b?b:g.oe,d||0==d?d:g.ye)}else m.error("No active scene")};
a.lJ=function(a){if(!q.Da())return m.error("No active scene"),!1;var b=q.A();return q.lJ(b,a)};a.ND=function(a){if(q.Da()){var b=q.A();q.ND(b,a)}else m.error("No active scene")};a.g6=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A(),b={};b.Er=q.QV(a);b.fog_depth=q.OV(a);b.fog_start=q.RV(a);b.fog_height=q.PV(a);return b};a.x9=function(a){if(q.Da()){var b=q.A();"number"==typeof a.Er&&q.mM(b,a.Er);"number"==typeof a.fog_depth&&q.kM(b,a.fog_depth);"number"==typeof a.fog_start&&q.nM(b,
a.fog_start);"number"==typeof a.fog_height&&q.lM(b,a.fog_height)}else m.error("No active scene")};a.KJ=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.KJ(a)};a.AM=function(a){if(q.Da()){var b=q.A();q.AM(b,a)}else m.error("No active scene")};a.N5=function(){if(!q.Da())return m.error("No active scene"),null;var a=q.A(),a=q.La(a,f.My);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.q9=
function(a){if(q.Da()){var b=q.A();if(b=q.La(b,f.My))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Ba=!0}else m.error("No active scene")};a.IJ=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.IJ(a)};a.yM=function(a){if(q.Da()){var b=q.A();q.yM(b,a)}else m.error("No active scene")};a.gJ=function(){if(!q.Da())return m.error("No active scene"),
!1;var a=q.A();return q.La(a,f.Qp)?q.gJ(a):null};a.iM=function(a){if(q.Da()){var b=q.A();q.iM(b,a)}else m.error("No active scene")};a.oJ=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.La(a,f.Lj)?q.oJ(a):null};a.pM=function(a){if(q.Da()){var b=q.A();q.pM(b,a)}else m.error("No active scene")};a.$I=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.La(a,f.Lp)?q.$I(a):null};a.aM=function(a){if(q.Da()){var b=q.A();q.aM(b,a)}else m.error("No active scene")};
a.nJ=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.La(a,f.Sp)?q.nJ(a):null};a.oM=function(a){if(q.Da()){var b=q.A();q.oM(b,a)}else m.error("No active scene")};a.WJ=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.WJ(a)};a.GM=function(a){if(q.Da()){var b=q.A();h.GM(b,a)}else m.error("No active scene")};a.TJ=function(a,b){if(!q.Da())return m.error("No active scene"),0;var d=q.A();return d.s.Mc?q.TJ(d,a,b):(m.error("No water parameters on the active scene"),
0)};a.FM=function(a){if(q.Da()){var b=q.A();q.FM(b,a)}else m.error("No active scene")};a.SJ=function(a){if(q.Da()){var b=q.A();q.SJ(b,a)}else m.error("No active scene")};a.Z$=function(){if(q.Da()){var a=q.A();q.UN(a)}else m.error("No active scene")};a.F7=function(a,b){b=b||!1;!u.ce(a)&&!u.vo(a)||u.Ra(a)?b?q.Nq(a,!0):q.mH(a,!0):m.error("show/hide is only supported for dynamic objects.")};a.h$=function(a,b){b=b||!1;!u.ce(a)&&!u.vo(a)||u.Ra(a)?b?q.Nq(a,!1):q.mH(a,!1):m.error("show/hide is only supported for dynamic objects.")};
a.nC=function(a){if(u.PW(a)||u.vo(a)||u.jh(a))return q.nC(a);m.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.Im=function(a){return a.k.Im};a.X3=function(a){m.Qb("scenes.check_object","scenes.check_object_by_name");return q.Da()?h.eY(a,q.A()):(m.error("No active scene"),!1)};a.a4=function(a,b){return h.xc(h.Zy,a,b|0,!0)?!0:!1};a.Y3=function(a,b,d){return h.xc(h.Yy,a,b,d|0)?!0:!1};a.Z3=function(a,b){return h.xc(h.Oc,a,b|0)?!0:!1};a.qm=function(a,b){var d=q.A();
a||(a="ALL");b||0===b||(b=h.oc);return h.FJ(d,a,b)};a.C6=function(a){return a?a.Rm:(m.error("Wrong object name"),"")};a.D6=function(a){if(!a)return m.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Rm),a=u.Yi(a);return b.reverse()};a.E6=function(a){return a&&a.type?a.type:(m.error("Wrong object"),"UNDEFINED")};a.B6=function(a){m.Qb("scenes.get_object_dg_parent","objects.get_dg_parent");return u.Yi(a)};a.A6=function(a){return a.Ze.slice(0)};a.tm=function(){return h.tm(q.A())};a.HJ=function(a,
b){b||0===b||(b=1);if(!q.Da())return m.error("No active scene"),!1;var d=q.A();return q.HJ(d,a,b)};a.bJ=function(){return q.bJ()};a.b7=function(a){return u.ce(a)?a.k.type:null};a.Hv=function(){if(!q.Da())return m.error("No active scene"),!1;var a=q.A();return q.Hv(a)};a.Ln=function(a,b){if(a.k.mw){if(b)var d=q.Nr(),d=t.Gd("name",b,d);else d=q.A();q.Ln(d,a,!0)}else m.error('object "'+a.name+'" has been created not by coping.')};a.Ss=function(a){(u.ce(a)||u.vo(a))&&u.Ra(a)?(h.Sw(a,a.k.nw,!1,!1),r.zY(a),
h.Sw(a,!0,!0,!0),h.Ss(a)):m.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.NK=function(a){var b=q.A();if(b.timeline_markers&&a in b.timeline_markers)return q.NK(b,a);m.error('"'+a+'" marker not found.');return 0};a.w6=function(){var a=q.A();return(a=q.La(a,f.Hh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.I9=function(a){var b=q.A();(b=q.La(b,f.Hh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),
"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):m.error("The motion blur subscene doesn't exist.")};a.I3=function(){var a=q.A();return Boolean(q.La(a,f.zf))}};b4w.module.container=function(a,g){var l=g("__container"),d=g("__print");a.Yh=l.Yh;a.cJ=l.cJ;a.me=l.me;a.kw=function(a,g){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&g&&l.kw(a,g)};a.bM=l.bM;a.ON=l.ON;a.Rq=l.Rq;a.BB=l.BB;a.resize=function(a,g,r){a&&g||d.warn("Wrong canvas container dimensions: "+a+"x"+g+". Zero dimensions aren't allowed. Resized to: "+l.Qy+"x"+l.Py+".");l.resize(a,g,r)};a.Qk=function(a){l.Qk(a||!1)}};b4w.module.lights=function(a,g){function l(a){for(var c=h.A(),d=y.Ub(c,"LAMP",y.oc),g=0;g<d.length;g++){var l=d[g];if("SUN"==l.tb.type){var r=l;break}}if(!r)A.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){d=q.Cb(180-a.hor_position);a=q.Cb(90-a.vert_position);g=r.k;u.Cx(r,[a,0,d]);d=new Float32Array(3);l=m.P(g.n);q.mc(l,q.nc,d);g=m.F(g.n);g=f.length(g);f.copy(d,t);f.scale(t,g,t);u.Xc(r,t);u.D(r);d=r.tb;if(d.sI){var z=c.world.light_settings.environment_energy,
g=c.world.horizon_color,l=c.world.zenith_color,C=Math.cos(Math.abs(a));a=Math.max(Math.min(3*C,1),0)*d.kI;z*=Math.max(C,.1);b.$s(d,a);h.wx(c,z,g,l)}h.Ap(r,c)}}function d(a){if(r.jh(a))return a.tb.type;A.error("get_light_type(): Wrong object");return!1}var b=g("__lights"),y=g("__objects"),r=g("__obj_util"),A=g("__print"),h=g("__scenes"),u=g("__transform"),m=g("__tsr"),q=g("__util"),f=g("__vec3"),t=new Float32Array(3),c,z=60;a.o6=function(a){var b=h.A(),b=y.Ub(b,"LAMP",y.oc);if(!a)return b;for(var c=
[],d=0;d<b.length;d++){var f=b[d];f.tb.type===a&&c.push(f)}return c};a.W6=function(){for(var a=h.A(),a=y.Ub(a,"LAMP",y.oc),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.tb.type){b=d;break}}return b?(b=b.tb.direction,a=q.se(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=q.se(Math.atan2(b[2],Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.Y9=l;a.lZ=function(){for(var a=h.A(),a=y.Ub(a,"LAMP",y.oc),b=0;b<a.length;b++){var c=a[b];if("SUN"==c.tb.type){var d=c;break}}d?
(d={hor_position:135},d.vert_position=-Math.cos(.75*Math.PI)*z,l(d)):A.error("There is no sun on the scene")};a.u9=function(a){(c=a.getDate())?1582==c&&10==a.n8&&4<a.jU&&15>a.jU&&A.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):A.error("There is no year 0 in the Julian system!")};a.H9=function(a){z=Math.min(Math.max(a,0),90)};a.r6=function(a){if(r.jh(a))var b=a.tb;else return A.error("get_light_params(): Wrong object"),null;if(a=d(a))switch(a){case "SPOT":var c=
{light_type:a,light_color:new Float32Array(3),light_energy:b.If,light_spot_blend:b.kt,light_spot_size:b.ln,light_distance:b.distance};c.light_color.set(b.color);break;case "POINT":c={light_type:a,light_color:new Float32Array(3),light_energy:b.If,light_distance:b.distance};c.light_color.set(b.color);break;default:c={light_type:a,light_color:new Float32Array(3),light_energy:b.If},c.light_color.set(b.color)}return c?c:null};a.s6=d;a.C9=function(a,c){if(r.jh(a)){var d=a.tb,f=h.A(),g=!1;"number"==typeof c.light_energy&&
b.$s(d,c.light_energy);"object"==typeof c.light_color&&b.Ax(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.zZ(d,c.light_spot_blend),g=!0);"number"==typeof c.light_spot_size&&(b.AZ(d,c.light_spot_size),g=!0);"number"==typeof c.light_distance&&(b.yZ(d,c.light_distance),g=!0);h.Ap(a,f);g&&h.W_(f)}else A.error("set_light_params(): Wrong object")};a.q6=function(a){return r.jh(a)?a.tb.If:(A.error("get_light_energy(): Wrong object"),0)};a.$s=function(a,c){if(r.jh(a)){var d=h.A();b.$s(a.tb,c);h.Ap(a,
d)}else A.error("set_light_energy(): Wrong object")};a.p6=function(a,b){if(!r.jh(a))return A.error("get_light_color(): Wrong object"),null;b=b||new Float32Array(3);b.set(a.tb.color);return b};a.Ax=function(a,c){if(r.jh(a)){var d=h.A();b.Ax(a.tb,c);h.Ap(a,d)}else A.error("set_light_color(): Wrong object")}};b4w.module.fps=function(a,g){function l(a,b,c){var e=O.Fd();D.hk(e,b,c);a&&(b=D.lk(e,V),B.uj(a,b[0],b[1]))}function d(a,b,c,e){if(.01<Math.abs(I[0])||.01<Math.abs(I[1]))c=G.ud(a,b,0),b=K.Zb(I[0],0,c,.2*F),c=K.Zb(I[1],0,c,.2*F),I[0]-=b,I[1]-=c,e(a,-b*T,-c*T)}function b(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function y(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function r(a,b){if(y(a)&&!E.bf()){var c=G.SA(a),e=H?H:G.TA(a);H=e;G.K(b,"FPS_PLOCK",G.la,[c,e],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=G.be(a,b,0),l(a,-b.coords[0]*T,-b.coords[1]*T))});G.K(null,"FPS_ACTIVATE_PLOCK",G.Hg,[e],function(a){return a[0]},function(b,c,e){0<e?fa.rB&&fa.rB(a):fa.mB&&fa.mB(a)})}else{if(E.bf())var c=
G.jr("XY",a),e=G.bv(a),f=4;else{var c=G.Xl("XY",a),e=G.Vn(a),f=2,h=O.Fd(),g=G.Ug(),k=G.Qi(Q.Vp),p=G.Qi(Q.Wp);G.K(b,"FPS_CAM_ROT",G.la,[g,k,p],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var e=G.ud(a,b,0);c=G.ud(a,b,1);var d=G.ud(a,b,2);b=2.5*e;d=.05>Math.abs(d)?0:d;e=D.sm(h,V);d=e[1]-d*b;c=-(.05>Math.abs(c)?0:c)*b;d=K.V(d,n,ea);D.hk(h,c,d,!1,!0);B.uj(a,e[0]+c+Math.PI,0)}})}var m=0,q=0;G.K(null,"FPS_DRAG_PRESS",G.Qd,[e],function(a){return a[0]},function(a,b,c){1==
c&&(a=G.be(a,b,0).coords,m=a[0],q=a[1])});G.K(null,"FPS_DRAG_MOVE",G.la,[c,e],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=G.be(a,b,0).coords,I[0]+=(a[0]-m)*f,I[1]+=(a[1]-q)*f,m=a[0],q=a[1])});c=G.Ug();G.K(b,"FPS_SMOOTH_DRAG",G.la,[c],null,d,l)}}function A(a){e.FU(e.FO);a.addEventListener("mousedown",function(){Q.TY()},!1)}function h(a){var b=G.Ug(),c=O.Fd();G.K(a,"FPS_CHARECTER_VR_ROT",G.la,[b],null,function(a){var b=D.lk(c,V)[0];B.uj(a,b,0)})}function u(){var a=e.zS()&&!E.bf(),b=Q.fa(Q.zd);
b&&(a=a&&Q.vm(b,Q.vl)==Q.Zp);return a}function m(a,e,d){function f(a){a=0<a?1:a;m=-(0>a?-1:a);a=l+n;var b=p+m;B.Vk(e,a,b);d&&d(a,b);g(a,b)}function h(a){a=0<a?1:a;n=-(0>a?-1:a);a=l+n;var b=p+m;B.Vk(e,a,b);d&&d(a,b);g(a,b)}function g(a,b){var e=k.Wn.id;a||b?0==e&&c(k,1):c(k,0)}E.bf()&&b(a.parentElement?a.parentElement:a);var k=z(e),p=0,m=0,l=0,n=0;a=[G.du,Q.Rt];var q=[G.cu,Q.St];E.bf()&&(a.push("B4W_DEFAULT_BTN_1"),q.push("B4W_DEFAULT_BTN_2"));L(1,a,function(a){l=a;a=l+n;var b=p+m;B.Vk(e,a,b);d&&d(a,
b);g(a,b)});L(1,q,h);L(1,[G.bu,Q.Xp],f);L(1,[G.au,Q.Tt],function(a){p=a;a=l+n;var b=p+m;B.Vk(e,a,b);d&&d(a,b);g(a,b)});L(1,[G.uF,Q.Qt],function(a){0<a&&B.Pu(e)});L(3,[Q.Tp],f);L(3,[Q.Up],h);L(1,[G.tF,Q.Yp],function(a){l+n+p+m?0<a?c(k,2):c(k,1):c(k,0)});L(1,[G.oF],function(a){0<a&&(a=X.Wn.id,1==a||0==a?c(k,3):c(k,1))})}function q(a,b,c,e){a.N.push({id:b,Vz:c,gH:e,fH:null,sA:null})}function f(a){for(var b=[],c=0;c<a.N;c++){var e=a.N[c].id;if(0<=b.indexOf(e))return;b.push(e)}for(c=0;c<a.N;c++)for(var e=
a.N[c],d=0;d<e.Vz.length;d++)if(0>b.indexOf(e.Vz[d]))return}function t(a,b){for(var c=null,e=0;e<a.N.length;e++)if(a.N[e].id==b){c=a.N[e];break}return c}function c(a,b){if(!a.wX){var c=a.Wn,e=c.id;if(0<=c.Vz.indexOf(b)){var d=!0;c.fH&&(d=c.fH(e,b));d&&(a.Wn=t(a,b),c.gH&&c.gH(e,b),c.sA&&c.sA(e,b))}}}function z(a){function b(c,e){switch(e){case 0:case 1:B.ni(a,B.Ky);break;case 2:B.ni(a,B.gF);break;case 3:B.ni(a,B.Jy);break;case 4:B.ni(a,B.BO)}}var c=X={N:[],Wn:null,wX:!1};q(c,0,[1,3,4],b);q(c,1,[2,
3,4,0],b);q(c,2,[1,3,4,0],b);q(c,3,[1],b);q(c,4,[1,2,0],b);f(c);c.Wn=t(c,0);return X}function L(a,b,c){function e(){}function d(){return!1}for(var f=[],h=Q.pH(),g=0;g<b.length;g++)if("number"==typeof b[g])if(300>b[g])f.push(G.Gb(b[g]));else if(326>b[g])for(var k=0;k<h.length;k++)f.push(G.gr(b[g],h[k]));else f.push(G.Qi(b[g]));else"string"==typeof b[g]&&((k=document.getElementById(b[g]))?f.push(G.bv(k)):w.error("Couldn't find element with "+b[g]+" ID."));b=G.Qd;switch(a){case 1:b=G.Hg;d=function(a){for(var b=
0;b<a.length;b++)if(a[b])return!0;return!1};e=function(a,b,e){0<e?c(1):c(0)};break;case 2:b=G.Hg;d=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};e=function(a,b,e){0>e?c(1):c(0)};break;case 3:b=G.la,d=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},e=function(a,b,e,d){if(0<e)for(e=0;e<d;e++){var f=G.ud(a,b,e);if(.05<Math.abs(f)){c(f);break}}else c(0)}}G.K(null,"FPS_USER_CONTROL_ACTION_"+M.toString(),b,f,d,e,f.length);M++}var D=g("camera"),G=g("controls"),
B=g("physics"),O=g("scenes"),K=g("util"),E=g("main"),C=g("container"),Q=g("input"),k=g("transform"),p=g("constraints"),x=g("vec3"),e=g("hmd"),w=g("__print"),n=(-Math.PI+.1)/2,ea=(Math.PI-.1)/2,I=new Float32Array(2),F=1,T=4E-4,M=0,X=null,H=null,fa={rB:null,mB:null},V=new Float32Array(2),P=new Float32Array(3),W=new Float32Array(3);new Float32Array(3);a.D1=0;a.E1=1;a.C1=2;a.B1=3;a.A1=4;a.g1=1;a.h1=2;a.f1=3;a.H3=L;a.Z4=function(a,b,c){a=a||O.tm();b=b||C.Yh();if(a){c=c||null;var e=a,d=O.Fd(),f=k.Uc(d,
P),g=k.Uc(e,W);x.subtract(f,g,f);p.wG(d,e,f);d=D.lk(d,V);B.uj(e,d[0],d[1]);e=b;d=a;u()?(A(e),h(d)):r(e,d);m(b,a,c)}};a.L4=function(a,b){a=a||O.tm();b=b||C.me();if(a){for(var c=0;c<M;c++)G.ie(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;y(b)&&!E.bf()&&(G.ie(c,"FPS_PLOCK"),G.ie(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!y(b)||E.bf())G.ie(c,"FPS_CAM_ROT"),G.ie(c,"FPS_DRAG_PRESS"),G.ie(c,"FPS_DRAG_MOVE"),G.ie(c,"FPS_SMOOTH_DRAG");c=a;u()&&G.ie(c,"FPS_CHARECTER_VR_ROT");c=b;if(E.bf()){var e=document.getElementById("B4W_DEFAULT_BTN_1"),
d=document.getElementById("B4W_DEFAULT_BTN_2");e&&c.removeChild(e);d&&c.removeChild(d)}}};a.p9=function(a,b){t(X,a).sA=b};a.m9=function(a){G.Bx(a);F=a};a.l9=function(a){T=a/2E5};a.P9=function(a){fa.rB=a};a.O9=function(a){fa.mB=a};a.M5=function(){return X.Wn.id}};b4w.module.camera=function(a,g){function l(a,b){m.Qb("camera.set_pivot","camera.target_set_trans_pivot");d.Aa(a)?(z.copy(b,a.k.pivot),f.D(a),u.H(a)):m.error("set_pivot(): Wrong object or camera move style")}var d=g("__camera");g("__config");var b=g("__constraints"),y=g("__container"),r=g("__mat4"),A=g("__math"),h=g("__obj_util"),u=g("__physics"),m=g("__print"),q=g("__scenes"),f=g("__transform"),t=g("__tsr"),c=g("__util"),z=g("__vec3"),L=g("__vec4"),D=g("__quat"),G=new Float32Array(2),B=new Float32Array(3),
O=new Float32Array(3),K=new Float32Array(4),E=D.create();new Float32Array(9);var C={},Q={};a.Jg=d.Jg;a.Kb=d.Kb;a.od=d.od;a.cd=d.cd;a.u_=function(a){h.xa(a)?(d.Ft(a),a.k.ub=d.Jg,f.D(a),u.H(a),d.uo(a)):m.error("static_setup(): Wrong camera object")};a.u$=function(a,b,c){d.Gm(a)?(b=b||t.F(a.k.n),c?d.PD(a,b,c):f.Xc(a,b),f.D(a),u.H(a)):m.error("static_set_look_at(): Wrong camera object or camera move style")};a.v$=function(a,b){d.Gm(a)?(f.pi(a,b),f.D(a),u.H(a)):m.error("static_set_rotation(): Wrong camera object or camera move style")};
a.t$=function(a,b){if(!d.Gm(a))return m.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return f.Nf(a,b)};a.WU=function(a){h.xa(a)?(d.Ft(a),a.k.ub=d.od,f.D(a),u.H(a),d.uo(a)):m.error("eye_setup(): Wrong camera object")};a.o5=function(a,c,h){d.jc(a)?(c=c||t.F(a.k.n),h?d.CZ(a,c,h):f.Xc(a,c),b.ak(a,a.k.vf,!0),f.D(a),u.H(a)):m.error("eye_set_look_at(): Wrong camera object or camera move style")};a.hk=function(a,b,c,e,h){d.jc(a)?(d.Ts(a,b,c,e||!1,
h||!1),f.D(a),u.H(a)):m.error("eye_rotate(): Wrong camera object or camera move style")};a.VU=function(a,b){d.jc(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.EM(a,b),f.D(a),u.H(a)):m.error("eye_set_vertical_limits(): Incorrect limits object."):m.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.n5=function(a,b,c){if(!d.jc(a))return m.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.ka?(b=b||{},c?(b.down=a.ka.bo,
b.up=a.ka.zp):(b.down=a.ka.down,b.up=a.ka.up),b.camera_space=c||!1,b):null};a.UU=function(a,b){d.jc(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.sM(a,b),f.D(a),u.H(a)):m.error("eye_set_horizontal_limits(): Incorrect limits object."):m.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.m5=function(a,b,c){if(!d.jc(a))return m.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.lb?(b=b||{},c?(b.left=a.lb.Ao,
b.right=a.lb.Wo):(b.left=a.lb.left,b.right=a.lb.right),b.camera_space=c||!1,b):null};a.I_=function(a){if(h.xa(a))if(!(void 0).horiz_rot_lim||"number"==typeof(void 0).horiz_rot_lim.left&&"number"==typeof(void 0).horiz_rot_lim.right)if(!(void 0).vert_rot_lim||"number"==typeof(void 0).vert_rot_lim.down&&"number"==typeof(void 0).vert_rot_lim.up){if((void 0).dist_lim){if("number"!=typeof(void 0).dist_lim.min||"number"!=typeof(void 0).dist_lim.max||(void 0).dist_lim.min>(void 0).dist_lim.max){m.error("target_setup(): Wrong distance limits object");
return}(void 0).dist_lim.min=Math.max((void 0).dist_lim.min,0);(void 0).dist_lim.max=Math.max((void 0).dist_lim.max,0)}if((void 0).Hs&&("number"!=typeof(void 0).Hs.min_y||"number"!=typeof(void 0).Hs.max_y||(void 0).Hs.min_y>(void 0).Hs.max_y))m.error("target_setup(): Wrong pivot limits object");else{d.Ft(a);a.k.ub=d.Kb;var b=(void 0).pos||t.F(a.k.n);d.JM(a,b,(void 0).pivot,(void 0).horiz_rot_lim,(void 0).vert_rot_lim,(void 0).dist_lim,(void 0).Hs,(void 0).use_panning||!1);f.D(a);u.H(a);d.uo(a)}}else m.error("target_setup(): Wrong vertical limits object");
else m.error("target_setup(): Wrong horizontal limits object");else m.error("target_setup(): Wrong camera object")};a.nt=function(a,b,c){var e,h;d.Aa(a)?(d.px(a,b,c,e||!1,h||!1),f.D(a),u.H(a)):m.error("target_rotate(): Wrong camera object or camera move style")};a.E$=function(a,b,c){d.Aa(a)?(b=b||t.F(a.k.n),c=c||a.k.pivot,d.at(a,b,c),f.D(a),u.H(a)):m.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.D$=function(a,b){d.Aa(a)?(d.KZ(a,b),f.D(a),u.H(a)):m.error("target_set_pivot_translation(): Wrong camera object or camera move style")};
a.F_=function(a,b){if(d.Aa(a)){var c=f.Jo(a,a.k.pivot),e=Math.max(0,b);f.ph(a,0,0,e-c);f.D(a);u.H(a)}else m.error("target_set_distance(): Wrong camera object or camera move style")};a.qE=function(a){return d.Aa(a)?f.Jo(a,a.k.pivot):(m.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.G$=function(a,b){if(d.Aa(a)){var c=f.Iv(b,!1,B),e=f.Jv(b),g=q.A(),g=h.ja(a,g).da[0],g=d.UI(g)/2,e=e/Math.sin(g),g=f.Jo(a,c);d.at(a,t.F(a.k.n),c);f.D(a);f.ph(a,0,0,e-g);f.D(a);u.H(a)}else m.error("target_zoom_object(): Wrong camera object or camera move style")};
a.D_=function(a,b){if(!d.Aa(a))return m.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);z.copy(a.k.pivot,b);return b};a.vN=function(a,b){if(d.Aa(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){m.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}d.qZ(a,b);f.D(a);u.H(a)}else m.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.y$=
function(a,b){if(!d.Aa(a))return m.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.sb?(b=b||{},b.min=c.sb.min,b.max=c.sb.max,b):null};a.H_=function(a,b){d.Aa(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.EM(a,b),f.D(a),u.H(a)):m.error("target_set_vertical_limits(): Wrong limits object"):m.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.B$=function(a,b,c){if(!d.Aa(a))return m.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.ka?(b=b||{},c?(b.down=a.ka.bo,b.up=a.ka.zp):(b.down=a.ka.down,b.up=a.ka.up),b.camera_space=c||!1,b):null};a.G_=function(a,b){d.Aa(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.sM(a,b),f.D(a),u.H(a)):m.error("target_set_horizontal_limits(): Wrong limits object"):m.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.z$=function(a,b,c){if(!d.Aa(a))return m.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.lb?(b=b||{},c?(b.left=a.lb.Ao,b.right=a.lb.Wo):(b.left=a.lb.left,b.right=a.lb.right),b.camera_space=c||!1,b):null};a.C$=function(a,b){d.Aa(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?m.error("target_set_pivot_limits(): Wrong limits object"):(d.GZ(a,b),f.D(a),u.H(a)):m.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.A$=function(a,b){if(!d.Aa(a))return m.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.ge?(b=b||{},b.min_z=c.ge.min_z,b.max_z=c.ge.max_z,b):null};a.E_=function(a,b,c){if(d.Aa(a)){var e=a.k;e.use_panning&&(B[0]=b,B[1]=-c,B[2]=0,t.Yc(B,e.n,B),z.add(e.pivot,B,e.pivot),b=t.F(e.n),z.add(b,B,b),f.D(a),u.H(a))}else m.error("target_pan_pivot(): wrong object")};a.F$=function(a,b){if(!d.Aa(a))return m.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.L7=function(b,h){a.hK(b,{pos:h.pos,pivot:h.pivot});var g="undefined"==
typeof h.dist_interval?0:Math.max(h.dist_interval,0),e="undefined"==typeof h.angle_interval?0:Math.max(h.angle_interval,0),m="undefined"==typeof h.t?.5:c.V(h.t,0,1),l=a.eK(b,C);l.min=Math.max(l.min-m*g,0);l.max+=(1-m)*g;g=a.fK(b,Q);g.down=c.V(g.down+m*e,-Math.PI/2,0);g.up=c.V(g.up-(1-m)*e,-Math.PI/2,0);d.dw(b,l);d.ew(b,g);f.D(b);u.H(b);d.uo(b)};a.hK=function(a,b){if(h.xa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){m.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up))m.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))m.error("hover_setup(): Wrong horizontal translation limits object");
else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))m.error("hover_setup(): Wrong vertical translation limits object");else{d.Ft(a);a.k.ub=d.cd;var c=b.pos||t.F(a.k.n);d.IM(a,c,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);f.D(a);u.H(a);d.uo(a)}}else m.error("hover_setup(): Wrong camera object")};a.gK=function(a,b,c){var e,h;d.Za(a)?(d.Us(a,b,c,e||!1,h||
!1),f.D(a),u.H(a)):m.error("hover_rotate(): Wrong camera object or camera move style")};a.K7=function(a,b){d.Za(a)?(d.zx(a,b),f.D(a),u.H(a)):m.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.I7=function(a,b){if(!d.Za(a))return m.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);z.copy(a.k.Vb,b);return b};a.uW=function(a){return d.Za(a)?f.Jo(a,a.k.Vb):(m.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};a.ew=function(a,b){d.Za(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?m.error("hover_set_vertical_limits(): Wrong limits object"):(d.ew(a,b),f.D(a),u.H(a)):m.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.fK=function(a,b){if(!d.Za(a))return m.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var c=a.k;b=b||{};b.down=c.ka.down;b.up=c.ka.up;return b};a.dw=function(a,b){d.Za(a)?"number"!=typeof b.min||"number"!=
typeof b.max||b.min>b.max?m.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),d.dw(a,b),f.D(a),u.H(a)):m.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.eK=function(a,b){if(!d.Za(a))return m.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var c=a.k;b=b||{};b.min=c.sb.min;b.max=c.sb.max;return b};a.wW=function(a,b){d.Za(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max)?m.error("hover_set_vert_trans_limits(): Wrong limits object"):(d.OZ(a,b),f.D(a),u.H(a)):m.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.J7=function(a,b){if(!d.Za(a))return m.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.Dc?(b=b||{},b.min=c.Dc.min,b.max=c.Dc.max,b):null};a.vW=function(a,b){d.Za(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?m.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(d.wZ(a,b),f.D(a),u.H(a)):m.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.H7=function(a,b){if(!d.Za(a))return m.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.Cc?(b=b||{},b.min=c.Cc.min,b.max=c.Cc.max,b):null};a.M7=function(a,b){if(!d.Za(a))return m.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Vh=b};a.Gm=d.Gm;a.Aa=d.Aa;a.jc=d.jc;a.Za=d.Za;a.QD=function(a,b){if(!h.xa(a))return m.error("set_move_style(): Wrong camera object"),
!1;if(b!=d.Jg&&b!=d.od&&b!=d.Kb&&b!=d.cd)return m.error("set_move_style(): Wrong move style"),!1;d.QD(a,b);f.D(a);u.H(a);return!0};a.um=function(a){return h.xa(a)?d.um(a):(m.error("get_move_style(): Wrong camera object"),null)};a.Xc=function(a,b){if(h.xa(a)){var c=a.k;if(d.Aa(a)){var e=t.F(c.n),e=z.subtract(b,e,B);z.add(e,c.pivot,c.pivot)}else d.Za(a)&&(e=t.F(c.n),e=z.subtract(b,e,B),z.add(e,c.Vb,c.Vb));f.Xc(a,b);f.D(a);u.H(a)}else m.error("set_translation(): Wrong camera object")};a.Uc=function(a,
b){if(!h.xa(a))return m.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return f.Uc(a,b)};a.d9=function(a,b,c,e,g){h.xa(a)?(e=e||!1,g=g||!1,d.Aa(a)?d.px(a,b,c,e,g):d.jc(a)?d.Ts(a,b,c,e,g):d.Za(a)?d.Us(a,b,c,e,g):d.Gm(a)?m.warn("rotate_camera(): not supported for STATIC cameras"):m.error("rotate_camera(): Wrong camera move style"),f.D(a),u.H(a)):m.error("rotate_camera(): Wrong camera object")};a.MZ=function(a,b){if(h.xa(a)){var d=a.k;"number"==typeof b.trans&&(d.pl=c.V(b.trans,
0,Infinity));"number"==typeof b.rot&&(d.ol=c.V(b.rot,0,Infinity));"number"==typeof b.zoom&&(d.ql=c.V(b.zoom,0,.99))}else m.error("set_velocities(): Wrong camera object")};a.$h=function(a,b){if(!h.xa(a))return m.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.pl;b.rot=c.ol;b.zoom=c.ql;return b};a.Y7=function(a){if(!h.xa(a))return m.error("is_look_up(): Wrong camera object"),!1;a=t.P(a.k.n);return 0<=c.mc(a,c.Nc,B)[1]};a.sm=function(a,b){if(!h.xa(a))return m.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);d.sm(a,b);return b};a.lk=function(a,b){if(!h.xa(a))return m.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);d.lk(a,b);return b};a.H5=function(a,b){b=b||new Float32Array(2);var f=z.normalize(a,B),f=c.GD(c.Nc,f,E);c.KA(f,!0);d.IB(f,b);return b};a.BM=function(a,b){if(h.xa(a))for(var c=q.A(),c=h.ja(a,c).da,e=0;e<c.length;e++){var f=c[e];f.type!=d.Qc&&f.type!=d.ed&&f.type!=d.Ve&&f.type!=d.We||d.JZ(f,b,f.sf)}else m.error("set_stereo_distance(): Wrong camera object")};
a.LJ=function(a){if(!h.xa(a))return m.error("get_stereo_distance(): Wrong camera object"),0;var b=q.A();a=h.ja(a,b).da;for(b=0;b<a.length;b++){var c=a[b];if(c.type==d.Qc||c.type==d.ed)return c.al}return 0};a.KD=function(a,b){if(h.xa(a)){var c=q.A(),c=h.ja(a,c).da;d.KD(c,b)}else m.error("set_eye_distance(): Wrong camera object")};a.Z5=function(a){if(!h.xa(a))return m.error("get_eye_distance(): Wrong camera object"),0;var b=q.A();a=h.ja(a,b).da;for(b=0;b<a.length;b++){var c=a[b];if(c.type==d.Qc||c.type==
d.ed||c.type==d.Ve||c.type==d.We)return c.sf}return 0};a.VD=function(a,b){h.xa(a)?(z.copy(b,a.k.vf),f.D(a),u.H(a)):m.error("set_vertical_axis(): Wrong camera object")};a.iW=function(a,b){if(h.xa(a))return b||(b=z.create()),z.copy(a.k.vf,b),b;m.error("get_vertical_axis(): Wrong camera object")};a.M$=function(a,b,c,e){if(h.xa(a)){var f=q.A();a=h.ja(a,f).da;for(f=0;f<a.length;f++){var g=a[f];g.rc||d.Wk(g,g.Ab);var l=B;l[0]=-b;l[1]=-c;l[2]=0;r.translate(g.xb,l,g.xb);r.rotateZ(g.xb,e,g.xb);d.eH(g);d.qA(g)}}else m.error("translate_view(): Wrong camera object")};
a.l7=function(a,b){if(!h.xa(a))return m.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var d=t.P(a.k.n);c.mc(d,c.Nc,b);return b};a.SV=function(a){if(!h.xa(a))return m.error("get_fov(): Wrong camera object"),0;var b=q.A();a=h.ja(a,b).da;return c.Cb(a[0].Zd)};a.y9=function(a,b){if(h.xa(a))for(var f=q.A(),f=h.ja(a,f).da,e=0;e<f.length;e++){var g=f[e];g.Zd=c.se(b);g.rc||d.Wk(g,g.Ab);d.eH(g);d.qA(g)}else m.error("set_fov(): Wrong camera object")};a.OD=function(a,b,c){var e;
if(!(e=h.xa(a)))a:{if(h.xa(a)){e=q.A();e=h.ja(a,e).da;for(var f=0;f<e.length;f++){var g=e[f];if(g.type==d.Ve||g.type==d.We){e=!0;break a}}}else m.error("is_hmd_camera(): Wrong camera object");e=!1}e?b&&c&&d.OD(a,b,c):m.error("set_hmd_fov(): Wrong camera object")};a.ak=function(a,c,d){h.xa(a)?(c=c||a.k.vf,b.ak(a,c,d||!1),f.D(a),u.H(a)):m.error("correct_up(): Wrong camera object")};a.M9=function(a,b){if(h.xa(a)&&d.qw(a)){var c=a.k;if(d.Aa(a)){var e=t.F(c.n),e=z.dist(e,c.pivot);c.rk=b/2*c.qk/e}else d.Za(a)?
(e=t.F(c.n),e=z.distance(e,c.Vb),c.rk=b/2*c.qk/e):(c=q.A(),h.ja(a,c).da[0].top=b/2);d.t0(a)}else m.error("set_ortho_scale(): Wrong camera object")};a.F6=function(a){if(!h.xa(a)||!d.qw(a))return m.error("get_ortho_scale(): Wrong camera object"),0;var b=q.A();return 2*h.ja(a,b).da[0].top};a.qw=function(a){return h.xa(a)?d.qw(a):(m.error("is_ortho_camera(): Wrong camera object"),!1)};a.gS=function(a,b,g,e){if(h.xa(a)){var l=q.A(),n=h.ja(a,l).da[0];e&&3==e.length?m.R('dest parameter in the function "calc_ray" should be type of parametric line.'):
e=e||new Float32Array(6);switch(n.type){case d.Sd:case d.Kh:case d.Qc:case d.ed:var r=Math.tan(n.Zd*Math.PI/360),u=r*n.Ab,l=B;b=y.Nu(b,g,G,n);l[0]=(2*b[0]/n.width-1)*u;l[1]=(1-2*b[1]/n.height)*r;l[2]=-1;t.Yc(l,a.k.n,l);z.normalize(l,l);3==e.length?z.copy(l,e):(a=f.Uc(a,O),A.Zo(e,a),A.en(e,l));break;case d.Be:l=B;b=y.Nu(b,g,G,n);l[0]=(2*b[0]/n.width-1)*n.top*n.Ab;l[1]=(1-2*b[1]/n.height)*n.top;l[2]=0;t.Gc(l,a.k.n,l);z.copy(l,e);a=t.P(a.k.n,K);z.transformQuat(c.Nc,a,l);A.en(e,l);break;default:m.error("calc_ray(): Non-compatible camera")}}else m.error("calc_ray(): Wrong camera object")};
a.mD=function(a,b,c){if(!h.xa(a))return m.error("project_point(): Wrong camera object"),null;c=c||new Float32Array(2);return d.mD(a,b,c)};a.s7=function(a){return(d.Aa(a)||d.Za(a))&&null!==a.k.sb};a.B7=function(a){return(d.jc(a)||d.Aa(a)||d.Za(a))&&null!==a.k.ka};a.A7=function(a){m.Qb("has_vertical_limits","has_vertical_rot_limits");return d.Aa(a)||d.jc(a)?null!==a.k.ka:(m.error("has_vertical_limits(): Wrong camera object"),!1)};a.v7=function(a){return(d.Aa(a)||d.jc(a))&&null!==a.k.lb};a.u7=function(a){m.Qb("has_horizontal_limits",
"has_horizontal_rot_limits");return d.Aa(a)||d.jc(a)?null!==a.k.lb:(m.error("has_horizontal_limits(): Wrong camera object"),!1)};a.C7=function(a){return d.Za(a)&&null!==a.k.Dc};a.w7=function(a){return d.Za(a)&&null!==a.k.Cc};a.q8=function(a,b,c){m.Qb("move_pivot","target_pan_pivot");if(d.Aa(a)){var e=a.k;if(e.use_panning){var h=t.F(e.n),g=z.subtract(h,e.pivot,O);B[0]=b;B[1]=0;B[2]=c;z.scale(B,z.len(g),B);t.Yc(B,e.n,B);z.add(e.pivot,B,e.pivot);z.add(h,B,h);f.D(a);u.H(a)}}else m.error("move_pivot(): wrong object")};
a.b$=function(a,b){m.Qb("set_velocity_params","set_velocities");if(h.xa(a)){var d=a.k;d.pl=c.V(b[0],0,Infinity);d.ol=c.V(b[1],0,Infinity);d.ql=c.V(b[2],0,.99)}else m.error("set_velocity_params(): Wrong camera object")};a.i7=function(a,b){m.Qb("get_velocity_params","get_velocities");if(!h.xa(a))return m.error("get_velocity_params(): Wrong camera object"),null;b=b||new Float32Array(3);var c=a.k;b[0]=c.pl;b[1]=c.ol;b[2]=c.ql;return b};a.g4=function(a){m.R('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');
h.xa(a)?d.Aa(a)||d.jc(a)?a.k.lb=null:d.Za(a)&&(a.k.Cc=null):m.error("clear_horizontal_limits(): Wrong camera object")};a.k4=function(a){m.R('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');h.xa(a)?d.Aa(a)||d.jc(a)?a.k.ka=null:d.Za(a)&&(a.k.Dc=null):m.error("clear_vertical_limits(): Wrong camera object")};a.h4=function(){m.R("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};
a.PD=function(a,c,h,e){m.Wh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);e=e||a.k.vf;d.PD(a,c,h);b.ak(a,e,!0);f.D(a);u.H(a)};a.Ts=function(a,b,c,e,h){m.Wh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);d.jc(a)?(d.Ts(a,b,c,e,h),f.D(a),u.H(a)):m.error("rotate_eye_camera(): wrong object")};a.px=function(a,b,c,e,h){m.Wh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);d.Aa(a)?(d.px(a,b,c,e,h),f.D(a),u.H(a)):m.error("rotate_target_camera(): wrong object")};
a.at=function(a,b,c){m.Qb("camera.set_trans_pivot","camera.target_set_trans_pivot");d.Aa(a)?(d.at(a,b,c),f.D(a),u.H(a)):m.error("set_trans_pivot(): Wrong object or camera move style")};a.haa=function(a,b){m.Qb("camera.zoom_object","camera.target_zoom_object");if(d.Aa(a)){f.Iv(b,!1,B);l(a,B);f.D(a);var c=f.Jv(b),e=q.A(),e=h.ja(a,e).da[0],e=d.UI(e)/2,c=c/Math.sin(e),e=f.Jo(a,B);f.ph(a,0,0,c-e);f.D(a);u.H(a)}else m.error("zoom_object(): wrong object")};a.N9=l;a.Us=function(a,b,c,e,h){m.Qb("camera.rotate_hover_camera",
"camera.hover_rotate");d.Za(a)?(d.Us(a,b,c,e,h),f.D(a),u.H(a)):m.error("rotate_hover_camera(): wrong object")};a.n6=function(a,b){m.Qb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!d.Za(a))return m.error("get_hover_cam_pivot(): wrong object"),null;b||(b=new Float32Array(3));z.copy(a.k.Vb,b);return b};a.jJ=function(a,b){m.Qb("camera.get_eye","camera.get_translation");return h.xa(a)?d.jJ(a,b):(m.error("get_eye(): Wrong object"),null)};a.J6=function(a,b){m.Qb("camera.get_pivot","camera.target_get_pivot");
if(!d.Aa(a))return m.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));z.copy(a.k.pivot,b);return b};a.G7=function(a,b){m.Qb("camera.hover_cam_set_translation","camera.set_translation");if(d.Za(a)){var c=a.k,e=t.F(c.n),e=z.subtract(b,e,B);z.add(e,c.Vb,c.Vb);f.Xc(a,b);f.D(a);u.H(a)}else m.error("hover_cam_set_translation(): wrong object")};a.zx=function(a,b){m.Qb("camera.set_hover_pivot","camera.hover_set_pivot_translation");d.Za(a)?(d.zx(a,b),f.D(a),u.H(a)):m.error("set_hover_pivot(): Wrong object or camera move style")};
a.m6=function(a,b){m.Qb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!d.Za(a))return m.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);b[0]=a.k.ka.down;b[1]=a.k.ka.up;return b};a.G5=function(a,b){m.Wh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!d.Za(a)&&!d.Aa(a))return m.error("get_cam_dist_limits(): wrong object"),null;if(a.k.sb)b=b||new Float32Array(2),b[0]=a.k.sb.max,b[1]=a.k.sb.min;
else return null;return b};a.w3=function(b,c,h,e){m.Wh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(d.Aa(b)){var g=C;g.down=c;g.up=h;g.camera_space=e==f.Jn;a.H_(b,g)}else d.jc(b)?(g=C,g.down=c,g.up=h,g.camera_space=e==f.Jn,a.VU(b,g)):d.Za(b)?(g=C,g.min=c,g.max=h,a.wW(b,g)):m.error("apply_vertical_limits(): wrong object")};a.t3=function(b,c,d){m.Qb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");
C.down=c;C.up=d;a.ew(b,C)};a.p3=function(b,c,f){m.Wh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(d.Aa(b)){var e=C;e.min=c;e.max=f;a.vN(b,e)}else d.Za(b)?(e=C,e.min=c,e.max=f,a.dw(b,e)):m.error("apply_distance_limits(): wrong object")};a.e4=function(b){m.Qb("camera.clear_distance_limits","camera.target_set_distance_limits");a.vN(b,null)};a.j7=function(a,b){m.Wh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits",
"camera.hover_get_vert_trans_limits"]);if(!d.Aa(a)&&!d.jc(a)&&!d.Za(a))return m.error("get_vertical_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);if(d.jc(a)||d.Aa(a)){if(c.ka)return b[0]=c.ka.down,b[1]=c.ka.up,b}else if(d.Za(a)&&c.Dc)return b[0]=c.Dc.min,b[1]=c.Dc.max,b;return null};a.s3=function(b,c,h,e){m.Wh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(d.Aa(b)){var g=C;g.left=
c;g.right=h;g.camera_space=e==f.Jn;a.G_(b,g)}else d.jc(b)?(g=C,g.left=c,g.right=h,g.camera_space=e==f.Jn,a.UU(b,g)):d.Za(b)?(g=C,g.min=c,g.max=h,a.vW(b,g)):m.error("apply_horizontal_limits(): wrong object")};a.l6=function(a,b){m.Wh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!d.Aa(a)&&!d.jc(a)&&!d.Za(a))return m.error("get_horizontal_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);
if(d.jc(a)||d.Aa(a)){if(c.lb)return b[0]=c.lb.left,b[1]=c.lb.right,b}else if(d.Za(a)&&c.Cc)return b[0]=c.Cc.min,b[1]=c.Cc.max,b;return null};a.j6=function(a,b){if(!h.xa(a))return m.error("get_frustum_planes(): Wrong camera object"),null;var c=q.A(),c=h.ja(a,c).da[0].Xh;L.copy(c.left,b.left);L.copy(c.right,b.right);L.copy(c.top,b.top);L.copy(c.bottom,b.bottom);L.copy(c.near,b.near);L.copy(c.far,b.far);return b}};b4w.module.controls=function(a,g){var l=g("__controls"),d=g("__print");a.Af=l.Af;a.la=l.la;a.Hg=l.Hg;a.Qd=l.Qd;a.Np=l.Np;a.Oy=l.Oy;a.dP=8;a.J2=9;a.f2=13;a.tF=16;a.a2=17;a.V1=18;a.D2=19;a.Y1=20;a.h2=27;a.uF=32;a.qF=37;a.vF=38;a.sF=39;a.pF=40;a.K1=49;a.L1=50;a.M1=51;a.N1=52;a.O1=53;a.P1=54;a.Q1=55;a.S1=56;a.T1=57;a.au=65;a.W1=66;a.oF=67;a.bu=68;a.e2=69;a.eP=70;a.j2=71;a.l2=72;a.m2=73;a.n2=74;a.fP=75;a.gP=76;a.o2=77;a.q2=78;a.C2=79;a.rF=80;a.F2=81;a.iP=82;a.cu=83;a.kP=84;a.K2=85;a.lP=86;a.du=87;a.L2=
88;a.M2=89;a.N2=90;a.r2=96;a.s2=97;a.t2=98;a.u2=99;a.w2=100;a.x2=101;a.y2=102;a.z2=103;a.A2=104;a.B2=105;a.p2=106;a.U1=107;a.I2=109;a.c2=110;a.d2=111;a.G2=186;a.g2=187;a.Z1=188;a.b2=189;a.E2=190;a.i2=191;a.k2=192;a.hP=219;a.X1=220;a.jP=221;a.H2=222;a.iu=l.iu;a.hu=l.hu;a.gu=l.gu;a.Jz=l.Jz;a.hv=l.hv;a.iv=l.iv;a.gr=l.gr;a.Qi=l.Qi;a.MA=l.MA;a.Gb=l.Gb;a.Yu=function(a,d,g){return l.Yu(a,d||"ANY",g||!1)};a.MH=l.MH;a.ck=function(a,d,g,A,h,u,m){return l.ck(a,d,g,A||"ANY",h||!1,u||!1,m||!1)};a.Vn=l.Vn;a.RA=
l.RA;a.Xl=l.Xl;a.SA=l.SA;a.TA=l.TA;a.jr=l.jr;a.ZA=l.ZA;a.aI=l.aI;a.bv=l.bv;a.SH=l.SH;a.bI=l.bI;a.PH=l.PH;a.OA=l.OA;a.QH=l.QH;a.PA=l.PA;a.RH=l.RH;a.$H=function(a,d){return l.$H(a,d||!1)};a.QL=l.QL;a.Ug=l.Ug;a.ZH=l.ZH;a.$u=function(a,d){return l.$u(a,d||!1)};a.Xu=function(a,d){return l.Xu(a,d||0)};a.s9=function(a,d){l.gZ(a,d)};a.T5=function(a){return a.value};a.ud=l.ud;a.be=l.be;a.K=function(a,d,g,A,h,u,m){h=h||l.hv;l.K(a,d,g,A,h,u,void 0===m?null:m)};a.Un=function(a,d,g,A,h){var u;A=l.Gb(A);l.K(a,
d,g,[A],l.hv,h,void 0===u?null:u)};a.HS=function(a){return l.Ql(a,null)};a.Ql=l.Ql;a.ie=l.ie;a.reset=l.reset;a.S8=function(){d.R("controls.register_keyboard_events() deprecated")};a.T8=function(){d.R("controls.register_mouse_events() deprecated")};a.V8=function(){d.R("controls.register_wheel_events() deprecated")};a.U8=function(){d.R("controls.register_touch_events() deprecated")};a.Q8=function(){d.R("controls.register_device_orientation() deprecated")};a.S$=function(){d.R("controls.unregister_keyboard_events() deprecated")};
a.T$=function(){d.R("controls.unregister_mouse_events() deprecated")};a.V$=function(){d.R("controls.unregister_wheel_events() deprecated")};a.U$=function(){d.R("controls.unregister_touch_events() deprecated")};a.R$=function(){d.R("controls.unregister_device_orientation() deprecated")};a.Bx=l.Bx};b4w.module.physics=function(a,g){function l(a,b,d,g){return r.wU(a,g[d[0]],g[d[1]],g[d[2]])}function d(a,b,d,g,f){b=Math.abs(a[2]-b[2]);return b<f&&A.XW(a,d,g)?b:Number.MAX_VALUE}g("__config");var b=g("__physics"),y=g("__print"),r=g("__util"),A=g("__navmesh");g("__vec3");new Float32Array(3);a.Ky=0;a.gF=1;a.BO=2;a.Jy=3;a.tI=function(a){b.oa(a)?b.tI(a):y.R("No physics for object "+a.name)};a.nB=function(a){b.oa(a)?b.nB(a):y.R("No physics for object "+a.name)};a.qW=function(a){return b.oa(a)};a.aC=function(a){return b.aC(a)};
a.$J=function(a){return b.$J(a)};a.qM=function(a,d){b.oa(a)?b.qM(a,d):y.R("No physics for object "+a.name)};a.bt=function(a,d,g){b.oa(a)?b.bt(a,d,g):y.R("No physics for object "+a.name)};a.H=function(a){b.oa(a)?b.H(a):y.R("No physics for object "+a.name)};a.BG=function(a,d,g,l){b.oa(a)?b.BG(a,d,g,l):y.R("No physics for object "+a.name)};a.CG=function(a,d,g,l){b.oa(a)?b.CG(a,d,g,l):y.R("No physics for object "+a.name)};a.aA=function(a,d,g,l){b.oa(a)?b.aA(a,d,g,l,!1):y.R("No physics for object "+a.name)};
a.r3=function(a,d,g,l){b.oa(a)?b.aA(a,d,g,l,!0):y.R("No physics for object "+a.name)};a.AG=function(a,d,g,l){b.oa(a)?b.AG(a,d,g,l):y.R("No physics for object "+a.name)};a.Ep=function(a,d){b.oa(a)?(b.hf(a)||b.jf(a)||y.error("Wrong object"),b.Ep(a,r.V(d,-1,1))):y.R("No physics for object "+a.name)};a.daa=function(a,d,g){if(b.oa(a)){b.hf(a)||b.jf(a)||y.error("Wrong object");d=r.V(d,0,1);var l=a.v.eo;-1==g||1==g?l=Math.max(-1,Math.min(l+g*d,1)):0==g&&0<=l?(l-=d,l=Math.max(0,l)):0==g&&0>l?(l+=d,l=Math.min(0,
l)):y.error("Wrong steering direction");b.Ep(a,r.V(l,-1,1))}else y.R("No physics for object "+a.name)};a.Dp=function(a,d){b.oa(a)?(b.hf(a)||b.jf(a)||y.error("Wrong object"),b.Dp(a,r.V(d,-1,1))):y.R("No physics for object "+a.name)};a.caa=function(a,d,g){if(b.oa(a)){b.hf(a)||b.jf(a)||y.error("Wrong object");d=r.V(d,0,1);var l=a.v.mp;-1==g||1==g?l=Math.max(-1,Math.min(l+g*d,1)):0==g&&0<=l?(l-=d,l=Math.max(0,l)):0==g&&0>l?(l+=d,l=Math.min(0,l)):y.error("Wrong steering direction");b.Dp(a,r.V(l,-1,1))}else y.R("No physics for object "+
a.name)};a.RE=function(a,d){b.oa(a)?(b.hf(a)||b.jf(a)||y.error("Wrong object"),b.RE(a,r.V(d,0,1))):y.R("No physics for object "+a.name)};a.baa=function(a,d){if(b.oa(a)){b.hf(a)||b.jf(a)||y.error("Wrong object");d=r.V(d,-1,1);var g=a.v.Hq;b.RE(a,r.V(g+g*d,0,1))}else y.R("No physics for object "+a.name)};a.hf=function(a){return b.hf(a)};a.jf=function(a){return b.jf(a)};a.f7=function(a){if(!b.oa(a))return y.R("No physics for object "+a.name),null;if(b.hf(a)||b.jf(a))return a.uf.name;y.error("Wrong object");
return null};a.h7=function(a){if(!b.oa(a))return y.R("No physics for object "+a.name),null;if(b.hf(a)||b.jf(a))return a.v.eo;y.error("Wrong object");return null};a.g7=function(a){if(!b.oa(a))return y.R("No physics for object "+a.name),null;if(b.hf(a)||b.jf(a))return a.v.mp;y.error("Wrong object")};a.e7=function(a){if(!b.oa(a))return y.R("No physics for object "+a.name),null;if(b.hf(a)||b.jf(a))return a.v.Hq;y.error("Wrong object")};a.PJ=function(a){if(!b.oa(a))return y.R("No physics for object "+
a.name),null;if(b.hf(a)||b.jf(a))return b.PJ(a);y.error("Wrong object")};a.og=function(a){return b.og(a)};a.Vk=function(a,d,g){b.oa(a)?b.Vk(a,d,g):y.R("No physics for object "+a.name)};a.ni=function(a,d){b.oa(a)?b.ni(a,d):y.R("No physics for object "+a.name)};a.gM=function(a,d){b.oa(a)?b.gM(a,d):y.R("No physics for object "+a.name)};a.fM=function(a,d){b.oa(a)?b.fM(a,d):y.R("No physics for object "+a.name)};a.cM=function(a,d){b.oa(a)?b.cM(a,d):y.R("No physics for object "+a.name)};a.Pu=function(a){b.oa(a)?
b.Pu(a):y.R("No physics for object "+a.name)};a.nH=function(a,d,g){b.oa(a)?b.nH(a,d,g):y.R("No physics for object "+a.name)};a.uj=function(a,d,g){b.oa(a)?b.uj(a,d,g):y.R("No physics for object "+a.name)};a.eM=function(a,d){b.oa(a)?b.eM(a,d):y.R("No physics for object "+a.name)};a.dM=function(a,d){b.oa(a)?b.dM(a,d):y.R("No physics for object "+a.name)};a.Yz=function(a,d,g,l){b.oa(a)?b.Yz(a,d||"ANY",g,l||!1):y.R("No physics for object "+a.name)};a.vD=function(a,d,g){b.oa(a)?b.vD(a,d||"ANY",g):y.R("No physics for object "+
a.name)};a.$z=function(a,d){b.oa(a)?b.$z(a,d):y.R("No physics for object "+a.name)};a.zA=function(a){b.oa(a)?b.zA(a):y.R("No physics for object "+a.name)};a.xu=function(a,d,g,l,f,r){a=a||null;if(null==a||b.oa(a))return b.xu(a,d,g,l||"ANY",f,r||!1,!1,!1,!1);y.R("No physics for object "+a.name)};a.dR=function(a,d,g,l){var f="ANY",r=!0,c=!1,z=!0,A=!0;a=a||null;null==a||b.oa(a)?b.xu(a,d,g,f||"ANY",l,r||!1,c||!1,z||!1,A||!1):y.R("No physics for object "+a.name)};a.wD=function(a){b.tK(a)?b.wD(a):y.error("Wrong ray test ID")};
a.lH=function(a,d,g){b.tK(a)?b.lH(a,d,g):y.error("Wrong ray test ID")};a.xG=function(a,d,g,l,f,r,c,z,A,D){b.oa(d)&&b.oa(f)?b.xG(a,d,g,l,f,r,c,z,A,D):y.error("Wrong objects")};a.BH=function(a){b.oa(a)&&b.oW(a)?b.BH(a):y.error("Wrong object")};a.CL=function(a,d,g,l,f,r){b.oa(a)&&b.oa(l)?b.CL(a,d,g,l,f,r):y.error("Wrong objects")};a.XK=function(a,d,g){g||(g=l);if(b.oa(a)){var q=a.C.ws;return q?A.XK(q,d,g):(y.error(a.name+" is not a navigation mesh object"),null)}y.R("No physics for object "+a.name)};
a.WK=function(a,g,m,q){if(b.oa(a)){var f=a.C.ws;if(!f)return y.error(a.name+" is not a navigation mesh object"),null;q=q||{};a={};a.do_not_pull_string=Boolean(q.do_not_pull_string);a.distance_to_closest=q.distance_to_closest||l;a.distance_to_farthest=q.distance_to_farthest||d;a.island=q.island||0;a.allowed_distance=q.allowed_distance||Number.MAX_VALUE;a.return_normals=q.return_normals||!1;return A.WK(f,g,m,a)}y.R("No physics for object "+a.name)}};b4w.module.util=function(a,g){var l=g("__compat"),d=g("__obj_util"),b=g("__print"),y=g("__quat"),r=g("__util"),A=g("__vec3"),h=new Float32Array(6);a.Gg=new Float32Array([1,0,0]);a.Bi=new Float32Array([0,1,0]);a.nc=new Float32Array([0,0,1]);a.Hy=new Float32Array([-1,0,0]);a.Te=new Float32Array([0,-1,0]);a.Nc=new Float32Array([0,0,-1]);a.WF=r.WF;a.cG=r.cG;a.dG=r.dG;a.YF=r.YF;a.$F=r.$F;a.fG=r.fG;a.XF=r.XF;a.bG=r.bG;a.Pz=r.Pz;a.ZF=r.ZF;a.aG=r.aG;a.eG=r.eG;a.Jf=function(a){return r.Jf(a||0)};a.assert=
r.assert;a.CK=r.CK;a.Gd=r.Gd;a.CC=function(a){return r.CC(a)};a.gk=function(a,b){b||(b=new Float32Array(4));return r.gk(a,b)};a.XC=function(a,b,d){d||(d=y.create());return r.XC(a,b,d)};a.GL=function(a,b,d){d||(d=A.create());return r.GL(a,b,d)};a.kx=function(a,b){b||(b=new Float32Array(3));return r.kx(a,b)};a.sign=r.sign;a.V=r.V;a.mc=r.mc;a.r7=function(a,b){return r.jx(a,r.Nc,r.nc,r.Bi,b)};a.tA=function(a,b){return r.tA(a,b)};a.jx=function(a,d,g,f,h){return 0!=A.dot(g,f)?(b.error("Wrong in-plane direction"),
null):r.jx(a,d,g,f,h)};a.bK=r.bK;a.Zb=r.Zb;a.Sx=r.Sx;a.xk=r.xk;a.KA=r.KA;a.FL=r.FL;a.Ro=r.Ro;a.cC=r.cC;a.rs=function(a,d,g,f,l){b.Qb("util.line_plane_intersect","math.line_plane_intersect");h[0]=g[0];h[1]=g[1];h[2]=g[2];h[3]=f[0];h[4]=f[1];h[5]=f[2];return r.rs(a,d,h,l)};a.ce=function(a){b.Qb("util.is_mesh","objects.is_mesh");return d.ce(a)};a.Bm=function(a){b.Qb("util.is_armature","objects.is_armature");return d.Bm(a)};a.Hi=r.Hi;a.Ng=r.Ng;a.hn=r.hn;a.lerp=r.lerp;a.Cb=r.Cb;a.se=r.se;a.kB=r.kB;a.es=
l.es;a.Mr=r.Mr};b4w.module.main=function(a,g){function l(){}function d(){}function b(){}function y(){window.performance||(I.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(I.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});fa.CM(0)}function r(a,b){for(var c=null,e=b?oa:xa,d=0;d<e.length;d++){var f=e[d];try{c=a.getContext(f,v)}catch(g){}if(c)break}c&&B.rU(c);return c}function A(a,b,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();I.error("WebGL context lost");u()},!1);Q.Uf(e);var f=Q.Kv();f&&I.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));F.Uf(e);k.Uf(e);H.Uf(e);X.Uf(e);C.Uf(e);O.Uf(e);E.SZ(a);O.hh(a,b);T.HM(a.width,a.height,1);M.hh();d=c();q()}function h(){l=function(){}}function u(){m()||(na=performance.now()/1E3,M.pause(),ea.pause(),H.pause(),z.pause())}function m(){return R<na}function q(){var a="HMD"===aa.stereo&&
p.UJ();a?a.requestAnimationFrame(q):ua(q);var b=performance.now()/1E3;ya||(ya=b);var c=b-ya;if(!(c<1/aa.max_fps)){for(var e=fa.mk(),f=0;f<ca.length;f++)ca[f](e,c);m()||(R>ya&&(c-=R-Math.max(na,ya)),e+=c,fa.CM(e),C.update(),D.update(),E.update(),t(e,c),d(c));ya=b;a&&a.isPresenting&&a.submitFrame()}}function f(a,b,c){if(Z)if(Z.L_)Z.L_(a,b,c);else{c=atob(Z.toDataURL(b,c).split(",")[1]);for(var e=new Uint8Array(c.length),d=0;d<c.length;d++)e[d]=c.charCodeAt(d);a(new Blob([e],{type:b||"image/png"}))}}
function t(a,b){if(E.kh()&&(x.reset(),V.update(b),w.update(a,b),e.update(a,b),M.update(a,b),b&&L.update(b),E.kh()&&(ea.update(a,b),E.kh()&&(p.update(a),K.update(a,b),E.kh()&&(z.update(!1),n.update(a,b),ha.update(),l(b,a),E.kh()))))){T.update(a,b);z.XN();var c=ra.callback;c&&(ra.DK&&URL.revokeObjectURL(ra.gA),f(function(a){ra.gA=URL.createObjectURL(a);c(ra.gA)},ra.format,ra.quality),ra.callback=null,ra.format="image/png",ra.quality=1)}}function c(){var a=60,c=0,e=aa.DI,d=aa.gV;return function(f){f<
1/aa.max_fps||(a=P.Zb(1/f,a,f,e),f=ea.TV(),c=(c+1)%d,0==c&&b(Math.round(a),f))}}var z=g("__anchors"),L=g("__animation"),D=g("__assets"),G=g("__config"),B=g("__compat"),O=g("__container"),K=g("__controls"),E=g("__data"),C=g("__debug"),Q=g("__extensions"),k=g("__geometry"),p=g("__input"),x=g("__hud"),e=g("__nla"),w=g("__logic_nodes"),n=g("__objects"),ea=g("__physics"),I=g("__print"),F=g("__renderer"),T=g("__scenes"),M=g("__sfx"),X=g("__shaders"),H=g("__textures"),fa=g("__time"),V=g("__transform"),P=
g("__util"),W=g("__version"),ha=g("__particles"),v=G.context,aa=G.B,Z=null,ba=null,ya=0,na=0,R=0,ca=[],ra={callback:null,format:"image/png",quality:1,gA:"",DK:!1,eI:!1},xa=["webgl","experimental-webgl"],oa=["webgl2","experimental-webgl2"],Y=null,ua=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/aa.max_fps)}}();a.hh=function(a,
b){G.FZ();I.NZ(aa.console_verbose);var c=W.SE()+" "+W.type()+" ("+W.fB()+")";I.log("%cINIT ENGINE","color: #00a",c);I.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;y();Z=a;b?(x.hh(b),ba=b):(G.B.show_hud_debug_info=!1,G.Y.Iw=!1);B.tR();B.xA("Chrome")||B.xA("Firefox")||(aa.fc=!1);c=r(a,aa.fc);!c&&aa.fc&&(aa.fc=!1,c=r(a,!1));if(!c)return null;I.log("%cINIT WEBGL "+(aa.fc?"2":"1"),"color: #00a");Y=c;A(Z,ba,c);G.Nn();B.rM(c,!0);X.vX();aa.po&&(a.style["touch-action"]=
"none");I.log("%cSET PRECISION:","color: #00a",aa.precision);return c};a.resize=function(a,b,c){I.Qb("main.resize","container.resize");O.resize(a,b,c)};a.sZ=function(a){b=a};a.f4=function(){b=function(){}};a.S9=function(a){l=a};a.j4=function(){h()};a.q7=function(){I.Qb("main.global_timeline","time.get_timeline");return fa.mk()};a.pause=u;a.rj=function(){m()&&(R=performance.now()/1E3,M.rj(),ea.rj(),H.play(!0),z.rj())};a.fs=m;a.reset=function(){E.hy(0);E.reset();Q.reset();F.reset();k.reset();H.WY();
X.reset();C.reset();O.reset();E.reset();O.reset();fa.reset();M.reset();ba=Z=null;R=na=ya=0;b=function(){};d=function(){};l=function(){};ca.length=0;Y=null};a.oS=function(a,b,c){ra.eI=!0;ra.DK=ra.eI;ra.callback=a;ra.format=b||ra.format;ra.quality=c||ra.quality};a.L5=function(){I.Qb("main.get_canvas_elem","container.get_canvas");return Z};a.bf=function(){return B.bf()};a.rq=function(a){for(var b=0;b<ca.length;b++)if(ca[b]==a)return;ca.push(a)};a.IY=function(a){for(var b=0;b<ca.length;b++)if(ca[b]==
a){ca.splice(b,1);break}};a.Kv=function(){var a=Q.Kv();return a?{vendor:Y.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:Y.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.input=function(a,g){function l(a){var d=b.fa(b.zd);if(!d||!d.wh)return!1;if(c)return!0;var g=b.$i(d,b.GO,f),k=b.$i(d,b.HO,t);y.OD(a,g,k);if(g=b.vm(d,D))k=m.A(),a=h.ja(a,k).da,y.KD(a,g);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.vm(b.vl)!==b.Zp&&(a.distortion_coefs=[d.distortion_coefs[0],d.distortion_coefs[1]],a.chromatic_aberration_coefs=[d.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]],
d.Jp||(d.Sj&&d.pk&&d.Tj?a.base_line_factor=(d.Sj-d.Tj)/d.pk:d.Tj||(a.base_line_factor=d.Sj/d.pk)),d.bj&&d.yn&&!d.Jp&&(a.inter_lens_factor=d.bj/d.yn),z.enabled||(g=1+d.distortion_coefs[0]+d.distortion_coefs[1],m.VK(g,g)));m.yx(a);A.Qk(!0);b.ox(d);return c=!0}function d(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=g("__input"),y=g("__camera"),r=g("__config"),A=g("__container"),
h=g("__obj_util"),u=g("__print"),m=g("__scenes"),q=g("__vec4"),f=q.create(),t=q.create(),c=!1,z=r.or,L=r.B;a.Rt=b.Rt;a.St=b.St;a.Xp=b.Xp;a.Tt=b.Tt;a.tz=b.tz;a.hz=b.hz;a.Qt=b.Qt;a.mz=b.mz;a.vz=b.vz;a.Yp=b.Yp;a.uz=b.uz;a.Wt=b.Wt;a.wz=b.wz;a.xz=b.xz;a.iz=b.iz;a.jz=b.jz;a.Ut=b.Ut;a.Vt=b.Vt;a.kz=b.kz;a.lz=b.lz;a.nz=b.nz;a.oz=b.oz;a.pz=b.pz;a.qz=b.qz;a.rz=b.rz;a.sz=b.sz;a.Tp=b.Tp;a.Up=b.Up;a.Vp=b.Vp;a.Wp=b.Wp;a.bz=b.bz;a.cz=b.cz;a.dz=b.dz;a.ez=b.ez;a.fz=b.fz;a.gz=b.gz;a.$y=b.$y;a.az=b.az;a.Zt=b.Zt;a.$t=
b.$t;a.vl=b.vl;a.Fz=b.Fz;a.kF=b.kF;a.jF=b.jF;a.Zp=b.Zp;var D=b.Bz;a.Bz=D;a.Az=b.Az;a.yz=b.yz;a.Dz=b.Dz;a.Ez=b.Ez;a.Cz=b.Cz;a.zz=b.zz;a.Ei=b.Ei;a.wl=b.wl;a.cq=b.cq;a.dq=b.dq;a.aq=b.aq;a.$p=b.$p;a.Al=b.Al;a.jq=b.jq;a.zl=b.zl;a.Yt=b.Yt;a.Dn=b.Dn;var G={};G[b.zd]=[b.Zt,b.$t];G[b.bd]=[b.Ei];var B={};B[b.zd]=[b.vl];var O={};O[b.bd]=[b.Ei,b.wl,b.cq,b.dq];O[b.Op]=[b.aq,b.$p];O[b.Ig]=[b.Al,b.jq,b.zl];O[b.Gh]=[b.Yt,b.Dn];var K={};K[b.zd]=[b.Az,b.Bz,b.yz,b.Dz,b.Ez,b.Cz,b.zz];a.Gh=b.Gh;a.zd=b.zd;a.bd=b.bd;a.Op=
b.Op;a.Ig=b.Ig;a.Mu=b.Mu;a.fa=b.fa;a.oE=function(a,c){a&&b.oE(a,c)};a.P8=function(){u.R("input.register_device() deprecated")};a.ox=function(a){a&&a.type==b.zd?b.ox(a):u.error("reset_device is undefined for device.")};a.$i=function(a,c,d){if(a&&a.type in G&&0<=G[a.type].indexOf(c))return b.$i(a,c,d);u.error("device hasn't param: ",c)};a.vm=function(a,c){if(a&&a.type in B&&0<=B[a.type].indexOf(c))return b.vm(a,c);u.error("device hasn't param: ",c)};a.Ad=function(a,c,d){d=d||null;if(a&&a.type in O&&
0<=O[a.type].indexOf(c))return b.Ad(a,c,d);u.error("device hasn't param: ",c)};a.Dd=function(a,c,d){d=d||null;if(a&&a.type in O&&0<=O[a.type].indexOf(c))return b.Dd(a,c,d);u.error("device hasn't param: ",c)};a.JD=function(a,c,d){if(a&&a.type in K&&0<=K[a.type].indexOf(c))return b.JD(a,c,d);u.error("device hasn't config: ",c)};a.TY=function(){if(m.Da()){var a=m.rm(m.A());if(a&&(l(a),a=b.fa(b.zd))){var c=a.$f;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=A.Yh(),c.requestPresent([{source:a}]).then(function(){if(!L.is_mobile_device){var a=
c.getEyeParameters("left"),b=c.getEyeParameters("right");A.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){u.error("HMD fullscreen request failed.")})):u.error("HMD fullscreen request failed."))}}};a.GU=l;a.uU=function(){var a=b.fa(b.zd);if(c||a&&a.wh)m.yx({enable_hmd_stereo:!1}),a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]),m.VK(a,a),A.Qk(!0)};a.A9=function(a,c,f){d();switch(a){case 0:a=b.Lt;break;case 1:a=b.Ry;break;case 2:a=b.Sy;break;
case 3:a=b.Ty;break;default:a=b.Lt}a=b.fa(a);b.JD(a,c,f)};a.yJ=b.yJ;a.rJ=b.rJ;a.pH=d};b4w.module.transform=function(a,g){var l=g("__obj_util"),d=g("__physics"),b=g("__print"),y=g("__quat"),r=g("__transform"),A=g("__tsr"),h=g("__util"),u=A.create(),m=new Float32Array(3),q=new Float32Array(4);a.Jn=r.Jn;a.UF=r.UF;a.Xc=function(a,g,c,h){l.Ra(a)?(m[0]=g,m[1]=c,m[2]=h,r.Xc(a,m),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Gx=function(a,g,c,h){l.Ra(a)?(m[0]=g,m[1]=c,m[2]=h,r.Gx(a,m),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.DM=function(a,
g){l.Ra(a)?(r.Xc(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.a$=function(a,g){l.Ra(a)?(r.Gx(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Z9=function(a,g,c,q,u){l.Ra(a)?(m[0]=g,m[1]=c,m[2]=q,g=A.F(u.k.n),u=A.P(u.k.n),h.Gc(m,1,u,g,m),r.Xc(a,m),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Uc=function(a,b){b||(b=new Float32Array(3));r.Uc(a,b);return b};a.NJ=function(a,b){b||(b=new Float32Array(3));r.NJ(a,b);return b};
a.pi=function(a,g,c,h,m){l.Ra(a)?(q[0]=g,q[1]=c,q[2]=h,q[3]=m,r.pi(a,q),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Dx=function(a,g,c,h,m){l.Ra(a)?(q[0]=g,q[1]=c,q[2]=h,q[3]=m,r.Dx(a,q),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ex=function(a,g){l.Ra(a)?(r.pi(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.W9=function(a,g){l.Ra(a)?(r.Dx(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Nf=
function(a,b){b||(b=new Float32Array(4));r.Nf(a,b);return b};a.CJ=function(a,b){b||(b=new Float32Array(4));r.CJ(a,b);return b};a.Cx=function(a,g,c,h){l.Ra(a)?(m[0]=g,m[1]=c,m[2]=h,r.Cx(a,m),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.AJ=function(a,b){b||(b=new Float32Array(3));r.AJ(a,b);return b};a.BJ=function(a,b){b||(b=new Float32Array(3));r.BJ(a,b);return b};a.SD=function(a,g,c,h){l.Ra(a)?(m[0]=g,m[1]=c,m[2]=h,r.SD(a,m),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.V9=function(a,g){l.Ra(a)?(r.Cx(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.U9=function(a,g){l.Ra(a)?(r.SD(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Le=function(a,d){l.Ra(a)?(r.Le(a,d),r.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.TD=function(a,d){l.Ra(a)?(r.TD(a,d),r.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.td=function(a){return r.td(a)};a.EJ=function(a){return r.EJ(a)};
a.V4=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var g=0;g<a.Ze.length;g++)if(!l.Ra(a.Ze[g])){b.error('Wrong object: "'+a.Ze[g].name+'" is not dynamic.');return}r.Xc(a,[0,0,0]);r.pi(a,[0,0,0,1]);r.Le(a,1);r.D(a);d.H(a)}};a.Jv=function(a){return l.ce(a)?r.Jv(a):(b.error("Wrong object: "+a.name),0)};a.Iv=function(a,d,c){if(!l.ce(a))return b.error("Wrong object: "+a.name),null;c||(c=new Float32Array(3));return r.Iv(a,d,c)};a.ph=function(a,g,c,h){l.Ra(a)?(r.ph(a,g,c,h),r.D(a),
d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.e9=function(a,g){if(l.Ra(a)){var c=y.setAxisAngle(h.Gg,g,q);r.ED(a,c);r.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.f9=function(a,g){if(l.Ra(a)){var c=y.setAxisAngle(h.Te,g,q);r.ED(a,c);r.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.g9=function(a,g){if(l.Ra(a)){var c=y.setAxisAngle(h.nc,g,q);r.ED(a,c);r.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.vJ=function(a){return r.vJ(a)};a.vj=function(a,g){l.Ra(a)?(r.vj(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Hx=function(a,g){l.Ra(a)?(r.Hx(a,g),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Rr=function(a,b){b||(b=new Float32Array(8));r.Rr(a,b);return b};a.Sr=function(a,b){b||(b=new Float32Array(8));r.Sr(a,b);return b};a.distance=function(a,b){return r.distance(a,b)};a.F9=function(a,g){l.Ra(a)?(A.fh(g,u),r.vj(a,u),r.D(a),d.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.G9=function(a,g){l.Ra(a)?(A.fh(g,u),r.Hx(a,u),r.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.u6=function(a,b){b||(b=new Float32Array(16));r.Rr(a,u);A.ay(u,b);return b};a.v6=function(a,b){b||(b=new Float32Array(16));r.Sr(a,u);A.ay(u,b);return b}};b4w.module.constraints=function(a,g){var l=g("__camera"),d=g("__constraints"),b=g("__obj_util"),y=g("__physics"),r=g("__print"),A=g("__transform");a.uG=function(a,b,g){var l;l=l||1;b instanceof Array&&2==b.length?d.kR(a,b[0],b[1],g,l):d.vG(a,b,g,void 0,l);A.D(a);y.H(a)};a.l3=function(a,b,g,l){d.iR(a,b,g,l);A.D(a);y.H(a)};a.m3=function(a,b,g,q,f,t,c,z){l.jc(a)?(f=f||-Math.PI/2,t=t||Math.PI/2,c=c||Math.PI/2,z=z||-Math.PI/2,d.hR(a,b,g,q,f,t,c,z),A.D(a),y.H(a)):r.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.k3=function(a,b,g,q){if(l.jc(a)){if(!q||0>q)q=.25;d.gR(a,b,g,q);A.D(a);y.H(a)}else r.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.wG=function(a,b,g){d.mR(a,b,g);A.D(a);y.H(a)};a.sG=function(a,b){d.$Q(a,b);A.D(a);y.H(a)};a.n3=function(a,b,g,l){d.nR(a,b,g,l);A.D(a);y.H(a)};a.o3=function(a,b){3==b.length?d.qR(a,b):d.pR(a,b);A.D(a);y.H(a)};a.j3=function(a,b,g,l){3==b.length?d.cR(a,b,g,l):d.bR(a,b,g,l);A.D(a);y.H(a)};a.Zz=function(a,b,g){d.Zz(a,b,g);
A.D(a);y.H(a)};a.remove=function(a){a.pc&&d.remove(a)};a.wJ=function(a){r.Qb("constraints.get_parent","objects.get_parent");return b.wJ(a)}};b4w.module.hmd=function(a,g){function l(a,g){if(g){var l=A.Fd();if(l){d.jc(l)||(t=d.Aa(l),c=d.Za(l),z=d.Gm(l),d.WU(l));var l=b.Ug(),x=!1;b.K(null,"HMD_ROTATE_CAMERA",b.la,[l,g],null,function(c,g,k){if(0<k&&(k=A.Fd())&&(!x&&y.GU(k)&&(q=h.Nf(k,q),x=!0),x&&d.jc(k)&&(c=b.be(c,g,1))))if(1==a){c=r.multiply(C,c,E);var l=m.transformQuat(u.Te,c,L);d.VD(k,l);h.Ex(k,c)}else if(2==a||3==a){g=h.Nf(k,O);g=r.invert(g,O);var p=r.multiply(q,g,O);g=d.iW(k,L);Math.abs(g[2])<Math.PI/4?l=m.cross(g,u.Te,D):Math.abs(g[1])<
Math.PI/4&&(l=m.cross(g,u.nc,D));m.normalize(l,l);var p=m.transformQuat(l,p,G),t=m.dot(g,p),p=m.scaleAndAdd(p,g,-t,G);m.normalize(p,p);g=m.cross(g,l,L);l=Math.acos(u.V(m.dot(l,p),0,1));g=u.sign(m.dot(p,g));f+=l*g;l=r.setAxisAngle(u.nc,-f,O);3!=a&&(g=u.jx(c,u.Nc,u.nc,u.Bi,K),g=r.invert(g,K),c=r.multiply(g,c,K));c=r.multiply(l,c,B);l=m.transformQuat(u.Te,c,L);d.VD(k,l);h.Ex(k,c);r.copy(c,q)}})}}}var d=g("camera"),b=g("controls"),y=g("input"),r=g("quat"),A=g("scenes"),h=g("transform"),u=g("util"),m=
g("vec3"),q=r.create(),f=0,t=!1,c=!1,z=!1,L=m.create(),D=m.create(),G=m.create(),B=r.create(),O=r.create(),K=r.create(),E=r.create(),C=r.create();a.I1=0;a.FO=1;a.J1=2;a.H1=3;a.FU=function(a){var c=null;if(c=y.fa(y.zd))c=y.vm(c,y.vl)==y.Fz||y.vm(c,y.vl)==y.Zp?b.PA():b.OA(),l(a,c)};a.zS=function(){return Boolean(y.Mu(y.zd))};a.k6=function(){return null};a.reset=function(){var a=y.fa(y.zd);y.ox(a)};a.M4=function(){b.ie(null,"HMD_ROTATE_CAMERA");y.uU();var a=A.Fd();t?d.I_(a):c?d.hK(a):z&&d.u_(a);d.VD(a,
u.nc);var f=h.Nf(a,B);h.Ex(a,f)};a.T9=function(a){r.copy(a,C)};a.N6=function(a){r.copy(C,a);return a}};b4w.module.mouse=function(a,g){function l(){1==k&&(k=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);f.ie(z.Fd(),"SMOOTH_PL")}function d(a){2==k&&(k=0);a.removeEventListener("mousedown",y,!1);a.removeEventListener("mouseup",r,!1);a.removeEventListener("mousemove",b,!1);f.ie(z.Fd(),"SMOOTH_DRAG")}function b(a){C()&&(K[0]+=2*(a.clientX-B),K[1]+=2*(a.clientY-O),B=a.clientX,O=a.clientY);a.preventDefault()}function y(a){B=
a.clientX;O=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function r(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function A(a,b,c,d){if(.01<Math.abs(K[0])||.01<Math.abs(K[1]))b=f.ud(a,b,0),a=L.Zb(K[0],0,b,.1*G),b=L.Zb(K[1],0,b,.1*G),K[0]-=a,K[1]-=b,d(4E-4*-a,4E-4*-b)}function h(a,b){var c=z.tm(),d=z.Fd();m.hk(d,a,b);c&&(d=m.lk(d,E),t.uj(c,d[0],d[1]))}function u(a){a=q.Rq(a.clientX,a.clientY,E);(a=z.No(a[0],a[1]))?(z.aD(a)&&z.Yo(a,1),
z.aD(Q)&&a!=Q&&z.Yo(Q,0)):z.aD(Q)&&z.Yo(Q,0);Q=a}var m=g("camera"),q=g("container"),f=g("controls"),t=g("physics"),c=g("print"),z=g("scenes"),L=g("util"),D=g("main"),G=1,B=0,O=0,K=new Float32Array(2),E=new Float32Array(2),C=null,Q=null,k=0;a.VY=function(a){var b,e,g,l,m;function q(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){d(a);a.addEventListener("mousemove",g,!1);var c=z.Fd();if(!f.Ql(c,"SMOOTH_PL")){var h=f.Ug();f.K(c,"SMOOTH_PL",
f.la,[h],null,A,m)}b()}else a.removeEventListener("mousemove",g,!1),k=0,document.removeEventListener("pointerlockchange",q,!1),document.removeEventListener("webkitpointerlockchange",q,!1),document.removeEventListener("mozpointerlockchange",q,!1),e()}if(1!=k){k=1;b=b||function(){};e=e||function(){};m=m||h;l=l||function(){return!0};g=g||function(a){if(l()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):
"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;K[0]+=b;K[1]+=a}};document.addEventListener("pointerlockchange",q,!1);document.addEventListener("webkitpointerlockchange",q,!1);document.addEventListener("mozpointerlockchange",q,!1);var r=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof r?r.apply(a):c.error("Pointer lock is not available")}};a.j5=l;a.b4=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||
a.mozRequestPointerLock)?!0:!1};a.b9=function(a,b,c){2!=k&&(k=2,l(),C=b||function(){return!0},c=c||h,a.addEventListener("mousedown",y,!1),a.addEventListener("mouseup",r,!1),a=z.Fd(),f.Ql(a,"SMOOTH_DRAG")||(b=f.Ug(),f.K(a,"SMOOTH_DRAG",f.la,[b],null,A,c)))};a.i5=d;a.a5=function(){D.bf()||q.Yh().addEventListener("mousemove",u)};a.N4=function(){D.bf()||(q.Yh().removeEventListener("mousemove",u),Q&&z.Yo(Q,0))};a.Q5=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in
c[0]?c[0].clientX:-1};a.S5=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.Bx=function(a){G=a};a.L6=function(){return G}};b4w.module.screenshooter=function(a,g){var l=g("main");a.YZ=function(){var a,b;a=a||"image/png";l.oS(function(b){var g=window.document.createElement("a");document.body.appendChild(g);g.style.display="none";g.href=b;g.download="screenshot."+a.split("/")[1];g.click();document.body.removeChild(g)},a,b||1)}};b4w.module.animation=function(a,g){var l=g("__animation"),d=g("__armature"),b=g("__obj_util"),y=g("__print"),r=g("__tsr");a.pd=l.pd;a.OF=l.OF;a.PF=l.PF;a.QF=l.QF;a.RF=l.RF;a.SF=l.SF;a.TF=l.TF;a.ju=l.ju;a.yl=l.yl;a.FF=l.FF;a.Hz=l.Hz;a.Iz=l.Iz;a.IF=l.IF;a.HF=l.HF;a.GF=l.GF;a.EF=l.EF;a.Ay=l.Ay;a.By=l.By;a.Cy=l.Cy;var A=r.create();a.yc=function(a){return l.yc(a)};a.VI=function(a){return l.hL(a)?l.VI(a):[]};a.Or=function(a){var b;if(!l.yc(a))return null;b=b||l.pd;return l.DV(a,b)};a.apply=function(a,b,
d){if(d>l.ju)y.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=d||l.pd;if(l.yc(a)){var g=l.Mv(a,b);if(-1!=g&&g!=d){y.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+g+'").');return}}l.gO(a,b)?l.apply(a,null,b,d):y.error('No fcurves in action "'+b+'"')}};a.q3=function(a,b,d){if(d>l.ju)y.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');
else{d=d||l.pd;var g=b[0];if(l.yc(a)){var f=l.Mv(a,g);if(-1!=f&&f!=d){y.error('Animation "'+g+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}l.gO(a,g)?l.apply(a,b.slice(1),g,d):y.error('No fcurves in action "'+g+'"')}};a.remove=function(a){l.remove(a)};a.ML=function(a,b){l.yc(a)&&(b=b||l.pd,l.ML(a,b))};a.yu=function(a){l.yu(a)};a.play=function(a,b,d){l.yc(a)?(d=d||l.pd,l.play(a,b,d),l.q0(a,0,d,!0)):y.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,
b){l.yc(a)&&(b=b||l.pd,l.stop(a,b))};a.Rf=function(a,b){if(!l.yc(a))return!1;b=b||l.pd;return l.Rf(a,b)};a.dn=function(a,b,d){l.yc(a)&&(d=d||l.pd,l.dn(a,b,d))};a.MD=function(a,b){l.yc(a)&&l.MD(a,b)};a.B9=function(a,b){if(l.yc(a)){b=b||l.pd;var d=l.GB(a,b),g=l.Cv(a,b);l.dn(a,d+g-l.mP,b)}};a.oo=function(a,b){if(!l.yc(a))return 0;b=b||l.pd;return l.fJ(a,b)};a.zM=function(a,b,d){l.yc(a)&&(d=d||l.pd,l.zM(a,b||1,d))};a.JJ=function(a,b){if(!l.yc(a))return 0;b=b||l.pd;return a.ia[b]?l.JJ(a,b):0};a.GB=function(a,
b){return l.yc(a)&&(b=b||l.pd,a.ia[b])?l.GB(a,b):-1};a.Cv=function(a,b){return l.yc(a)&&(b=b||l.pd,a.ia[b])?l.Cv(a,b):-1};a.cn=function(a,b,d){l.yc(a)&&(d=d||l.pd,l.cn(a,b,d))};a.ZI=function(a,b){if(!l.yc(a))return null;b=b||l.pd;return l.ZI(a,b)};a.yG=function(a,b,d,g){g=g||l.pd;l.yc(a)&&l.yG(a,b,d,g)};a.FI=function(a){return l.FI(a)};a.F5=function(a,g,l){y.Qb("get_bone_translation","armature.get_bone_tsr");if(!b.Bm(a))return null;if(!d.vS(a,g))return y.error('There is no bone: "',g,'" in "',a.name,
'".'),null;l||(l=new Float32Array(3));d.Ev(a,g,!1,A);l[0]=A[0];l[1]=A[1];l[2]=A[2];return l};a.d6=function(){y.R("get_first_armature_object() deprecated");return null};a.Mv=function(a,b){return l.yc(a)&&b?l.Mv(a,b):-1};a.WI=function(a,b){return l.yc(a)?l.WI(a,b):null};a.zG=function(a,b){return l.zG(a,b)};a.U6=function(a){return a.k.Nh};a.xM=function(a,d,g){b.Bm(a)?(d=Math.min(Math.max(d,0),1),a.k.Nh!=d&&l.xM(a,d,g||0)):y.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.math=function(a,g){var l=g("__vec3"),d=g("__util"),b=g("__math"),y=new Float32Array(3);a.v4=function(a,d){var g=new Float32Array(6);b.Zo(g,a);l.subtract(d,a,y);b.en(g,y);return g};a.u4=function(a,d){var g=new Float32Array(6);b.Zo(g,point1);b.en(g,d);return g};a.wT=function(){return new Float32Array(6)};a.QB=b.QB;a.xJ=b.xJ;a.Zo=b.Zo;a.en=b.en;a.rs=d.rs;a.bH=b.bH;a.pf=b.pf};b4w.module.tsr=function(a,g){function l(a,b,d,g){g||(g=y.create());l(a,b,d,g);return g}var d=g("__mat4"),b=g("__print"),y=g("__tsr");a.create=y.create;a.HI=y.HI;a.copy=y.copy;a.identity=y.identity;a.z4=function(a,d,g,u){b.Qb("create_sep","set_sep");return l(a,d,g,u)};a.Ag=y.Ag;a.ue=y.ue;a.Le=y.Le;a.UD=y.UD;a.oi=y.oi;a.F=y.F;a.td=y.td;a.P=y.P;a.invert=y.invert;a.ay=function(a,b){b||(b=d.create());y.ay(a,b);return b};a.fh=y.fh;a.multiply=y.multiply;a.Gc=y.Gc;a.JN=y.JN;a.fl=y.fl;a.GE=y.GE;a.Yc=y.Yc;
a.HE=y.HE;a.translate=y.translate;a.as=function(a,b,d,g){g||(g=y.create());y.as(a,b,d,g);return g}};b4w.module.config=function(a,g){var l=g("__config"),d=g("__compat"),b=g("__debug"),y=g("__data"),r=g("__print");a.gq=l.gq;a.xl=l.xl;a.Fn=l.Fn;a.NF=l.NF;a.fq=l.fq;a.set=l.set;a.get=l.get;a.reset=l.reset;a.zD=l.zD;a.V6=l.Dv;a.Dv=l.Dv;a.Nn=function(a){y.kh()?r.error("Cannot change quality profile after a scene is loaded."):(l.set("quality",a),b.Gv()&&(l.Nn(),d.rM(b.Gv(),!1)))}};b4w.module.npc_ai=function(a,g){function l(a,b){var d=b.destination,f=b.cA,g=B;t.Uc(b.collider,g);var l=0,q=g[2];d[2]=q;switch(b.type){case k:if(b.random&&b.Nk){d[0]=(12*Math.random()-6)*b.speed+f[0];d[1]=-(12*Math.random()-6)*b.speed+f[1];var r=C,f=O,u=b.speed,y=b.rot_speed;t.Nf(b.collider,r);c.transformQuat(L.Te,r,f);f[2]=0;c.normalize(f,f);r=.5*u/Math.sin(y/2);g=c.dist(d,g);g<2*r&&c.scaleAndAdd(d,f,2*r-g,d);b.Nk=!1}b.XB&&(l=b.XB-q,g=b.speed*a,l>g?l=g:l<-g&&(l=-g));b.Hj=l;break;case p:case x:b.Fp?
l=b.Fp:b.Hj&&(l=b.Hj,b.type==x&&(l*=a)),b.random&&b.Nk&&(b.type==x?(b.speed=Math.random()+.1,g=b.NX-b.UX):g=b.max_height-b.min_height,d[0]=10*Math.random()-5+f[0],d[1]=10*Math.random()-5+f[1],d[2]=q-(Math.random()*g-.5*g),b.Nk=!1)}l&&(d[2]=q+l);var d=G,g=B,r=O,l=Q,y=b.rig,f=b.collider,q=b.destination,z=b.speed,D=b.actions,P=h.Or(y);if(!h.Rf(y)||!D.Xr||-1==D.Xr.indexOf(P)){t.Uc(f,d);var u=q[0]-d[0],W=q[1]-d[1],u=Math.sqrt(u*u+W*W);if(u>2*z*a)b.state=20,L.cC(q,d,r),D=b.rig,h.yc(D)&&(y=b.speed,z=h.oo(D),
D=h.Cv(D),y*=D/24*(1-z/D),.9>u/y&&c.scaleAndAdd(q,r,y-u,q)),u=C,y=K,t.Nf(b.collider,u),c.transformQuat(L.Te,u,g),y[0]=g[0],y[1]=g[1],y[2]=0,c.normalize(y,y),z=c.dot(y,r),D=a/(Math.abs(Math.acos(z))/Math.PI)*b.rot_speed*b.FD,m.rotationTo(y,r,l),m.rotationTo(L.Te,y,u),1<=Math.abs(z)?m.copy(u,l):(m.multiply(l,u,l),m.slerp(u,l,Math.min(D,1),l)),r=a,b.type!=p&&(r=Math.max(r,1/60),u=E,y=C,m.setAxisAngle(L.Gg,-Math.asin(-g[2]),y),m.setAxisAngle(L.Gg,-Math.atan(b.Hj/(b.speed*r)),u),m.slerp(y,u,r,u),m.multiply(l,
u,l)),t.Ex(f,l),g=O,f=K,L.mc(l,L.Te,g),c.scale(g,b.speed*a,f),c.add(f,d,f),f[2]=b.type!=k?(q[2]-d[2])*a*.1+d[2]:q[2],t.DM(b.collider,f);else if(b.type==k)D.move?P&&-1!=D.move.indexOf(P)&&h.Rf(y)?b.state=20:(b.state=10,b.Nk=!0):(b.state=10,b.Nk=!0);else if(b.type==x||b.type==p)b.Nk=!0;if(A(b)&&(d=b.rig,!h.Rf(d))){l=null;switch(b.state){case 10:l=b.actions;l=l.Xr?L.Ro(l.Xr):null;break;case 20:l=h.Or(b.rig),g=q=b.actions,g.jj&&-1==g.jj.indexOf(l)&&g.move&&-1!=g.move.indexOf(l)&&.33<Math.random()?(q=
b.actions,l=q.jj[q.move.indexOf(l)]):(g=b.actions,g.move&&(-1!=g.move.indexOf(l)||!g.jj&&!g.yk||!g.yk&&!l||g.jj&&-1!=g.jj.indexOf(l)||g.yk&&-1!=g.yk.indexOf(l))?(q=b.actions,q.jj?(g=q.jj.indexOf(l),-1!=g?(l=g+1,l=l<q.move.length?l:0,l=q.move[l]):l=-1!=q.move.indexOf(l)?l:L.Ro(q.move)):l=L.Ro(q.move)):(g=b.actions,l=g.yk&&-1==g.yk.indexOf(l)&&g.move&&-1==g.move.indexOf(l)?L.Ro(q.yk):null))}l&&(h.apply(d,l),h.cn(d,h.By),h.dn(d,0),h.play(d))}}}function d(a,b,c,d){if(d)if(1==c)switch(d.type){case p:a:{for(var f=
0;3>f;f++)if(c=u.be(a,b,f).hit_fract){b=c;break a}b=void 0}f=100*b;d.Hj=f<d.min_height?10:f>d.max_height?-10:0;break;case k:a=u.be(a,b,0);d.XB=a.hit_pos[2];break;case x:a=u.be(a,b,0),"CLOSE_GROUND"==b?(d.Hj=100*a.hit_fract-1,d.Hj=.1>d.Hj?.05:0):"CLOSE_WATER"==b&&(d.Fp=100*f,d.Fp=d.Fp<d.UX?-.02:d.Fp>d.NX?.02:0)}else d.Hj=0}function b(){for(var a=0;a<D.length;a++){var b=D[a];y(b);r(b);h.Or(b.rig)&&h.play(b.rig)}}function y(a){var b=c.create(),f=a.collider;switch(a.type){case p:var g=u.ck(f,b,[0,0,-100],
"TERRAIN",!0,!0),h=u.ck(f,b,[0,0,-100],"STONE",!0,!0),b=u.ck(f,b,[0,0,-100],"WATER",!0,!0),g=[g,h,b];u.K(f,"CLOSE_GROUND",u.la,g,function(a){return a[0]||a[1]||a[2]},d,a);break;case k:g=u.ck(f,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);g=[g];u.K(f,"CLOSE_GROUND",u.la,g,null,d,a);break;case x:g=u.ck(f,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=u.ck(f,b,[0,0,100],"WATER",!0,!0),g=[g],u.K(f,"CLOSE_WATER",u.la,[b],null,d,a),u.K(f,"CLOSE_GROUND",u.la,g,null,d,a)}}function r(a){function b(d,f,g){1==g?(c.copy(a.cA,a.destination),
a.FD=4):a.FD=1}var d=a.collider;if(a.type==k){var f=u.Yu(d,"CONSTRUCTION",!1);u.K(d,"CONSTRUCTION_COLL",u.la,[f],null,b)}}function A(a){var b=a.rig;if(!h.Rf(b))return!0;b=h.Or(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.Xr)return!1;if(-1==c.Xr.indexOf(b))break;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.yk&&-1!=c.yk.indexOf(b)||c.jj&&-1!=c.jj.indexOf(b))return!1;break;default:return!1}return!0}var h=g("animation"),u=g("controls"),m=g("quat"),q=g("scenes"),f=g("time"),t=
g("transform"),c=g("vec3"),z=g("print"),L=g("util"),D=[];new Float32Array(9);var G=new Float32Array(3),B=new Float32Array(3),O=new Float32Array(3),K=new Float32Array(3),E=new Float32Array(4),C=new Float32Array(4),Q=new Float32Array(4),k=a.GP=10,p=a.Q2=20,x=a.S2=30;a.$X=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:k,state:10,actions:{},cA:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],vv:[],delay:[],random:!0,Nk:!0,XB:0,Hj:0,Fp:0,FD:1,speed:1,rot_speed:.1,
max_height:0,min_height:0};if("object"!=typeof a.obj)z.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)z.error("Can't create event track. Wrong rig object");else if("object"!=typeof a.collider)z.error("Can't create event track. Wrong collider object");else{b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;t.Uc(a.collider,b.cA);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==
typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.vv[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=h.Or(b.rig),d;for(d in a)for(var f=a[d],g=0;g<f.length;g++)h.apply(b.rig,f[g]);c&&h.apply(b.rig,c);D.push(b)}};a.EU=function(){if(D.length){b();var a=u.Ug();u.K(D[0].collider,
"ELAPSED",u.la,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=u.ud(a,b,0),b=0;b<D.length;b++){c=D[b];var d=a;if(q.Im(c.obj))if(c.random)l(d,c);else{for(var e=f.mk(),g=0;g<c.path.length;g++)if(!c.ended[g]){c.vv[g]||(c.vv[g]=!0,c.destination[0]=c.path[g][0],c.destination[1]=c.path[g][1],c.destination[2]=c.path[g][2],c.start[g]=e+c.delay[g]);if(e<c.start[g])break;l(d,c);c.ended[g]=c.Nk;break}a:{for(d=0;d<c.path.length;d++)if(0==c.ended[d]){d=!1;break a}d=!0}if(d)for(d=0;d<c.path.length;d++)c.vv[d]=
!1,c.ended[d]=!1}}})}};a.I4=function(){if(!(0>=D.length))for(var a=0;a<D.length;a++){var b=D[a];u.HS(b.collider)&&u.ie(b.collider);h.Rf(b.rig)&&h.stop(b.rig)}}};b4w.module.time=function(a,g){var l=g("__time");a.Fx=l.Fx;a.Sn=l.Sn;a.mk=l.mk;a.Pj=l.Pj;a.Rn=l.Rn};b4w.module.app=function(a,g){function l(){var a=x.fs();document.addEventListener("visibilitychange",function(){document.hidden?(a=x.fs(),x.pause()):a||x.rj()},!1)}function d(){var a=0,b=E.me(),c=x.fs(),d=!0;x.rq(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=x.fs()),x.pause(),d=!1):c||d||(x.rj(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);f||(w.error('Warning: canvas container "'+a+'" not found, appending to body'),
f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!x.hh(e,a))return c&&D("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
d),!1;a&&E.kw(a,"LAST");return!0}function y(a,b){a?(b&&(document.getElementById(b).style.display="block"),M=document.getElementById(a)):(M=document.createElement("div"),M.innerHTML=0,M.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",E.kw(M,"JUST_AFTER_CANVAS"))}function r(a,b){var c=String(a);b&&(c+="/"+String(b));M.innerHTML=c}function A(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function h(a,b,c){var d=Math.max(B.uW(a),1),e=ea.Nf(a,v);b=I.mc(e,b,W);b[2]=0;F.normalize(b,b);F.scale(b,d*c,b);c=ea.Uc(a,ha);F.add(c,b,c);B.Xc(a,c)}function u(a,b){var c=B.fK(a,Z);if(c.up!=c.down){var d=B.sm(a,P)[1],c=(c.down-d)/(c.down-c.up),d=B.eK(a,Z),c=Math.max(c,2/d.max);B.gK(a,0,c*b)}}function m(a,b,c,d){ea.ph(a,5*b,5*c,5*d)}function q(a,b,c){var d=B.qE(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));ea.ph(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function f(a,b,c,d){for(var e=c*
b;0<a;--a)c+=e,d+=e,e=c*b;return d}function t(a,b,c,d,e){e?(e=B.D_(a,W),a=B.Uc(a),a=F.dist(e,a)+d,d=0<b?f(b,-c,a,d):f(-b,c/(1-c),a,d)):d-=2*b*c;return d}function c(a,b,c,d,f){function g(a,b,c,d){if(1==c){B.$h(a,Z);var e=Q?.003*Z.trans:.003*Z.rot;c=C.ud(a,b,0);C.be(a,b,0).gesture===C.iu?(Ja+="X"==d?-c*e:0,hb+="Y"==d?-c*e:0):C.be(a,b,0).gesture===C.gu&&(a=Q?.003*Z.rot:7.5E-4*Z.trans,eb+="X"==d?-c*a:0,cb+="Y"==d?-c*a:0)}}function k(a){B.$h(a,Z);bb-=.05*Z.zoom}function l(a){B.$h(a,Z);Ba-=.002*Z.trans}
function r(a){B.$h(a,Z);bb+=.05*Z.zoom}function v(a){B.$h(a,Z);Ba+=.002*Z.trans}function w(a,b,c,d){if(1==c){c=C.ud(a,b,1);B.$h(a,Z);if(Q)e=.003*Z.trans,f=7.5E-4*Z.rot;else var e=.003*Z.rot,f=7.5E-4*Z.trans;if(1===C.be(a,b,0).which)La+="X"==d?-c*e:0,Ra+="Y"==d?-c*e:0;else if(2===C.be(a,b,0).which||3===C.be(a,b,0).which)rb+="X"==d?-c*f:0,Ta+="Y"==d?-c*f:0}}function x(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function y(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function A(a){return a[0]&&(a[1]||-.1>a[2])}
function D(a){return a[0]&&(a[1]||.1<a[2])}function G(a){return a[0]&&(a[1]||a[2]||a[3])}function E(a,b,c){if(1==c)switch(c=C.ud(a,b,0),B.$h(a,Z),b){case "FORWARD":O?za[0]=1:Q?(b=B.sm(a,P)[1],b=Math.abs(b)>=Math.PI/4?I.Bi:I.Nc,h(a,b,.5*Z.trans*c)):L?q(a,-Z.zoom,c):m(a,0,0,-Z.trans*c);break;case "BACKWARD":O?za[0]=-1:Q?(b=B.sm(a,P)[1],b=Math.abs(b)>=Math.PI/4?I.Te:I.nc,h(a,b,.5*Z.trans*c)):L?q(a,Z.zoom,c):m(a,0,0,Z.trans*c);break;case "UP":Q?u(a,30*-Z.zoom*c):O||m(a,0,Z.trans*c,0);break;case "DOWN":Q?
u(a,30*Z.zoom*c):O||m(a,0,-Z.trans*c,0);break;case "LEFT":O?za[1]=1:Q?h(a,I.Hy,.5*Z.trans*c):m(a,-Z.trans*c,0,0);break;case "RIGHT":O?za[1]=-1:Q?h(a,I.Gg,.5*Z.trans*c):m(a,Z.trans*c,0,0);break;case "ROT_LEFT":L?B.nt(a,.75*-Z.rot*c,0):B.hk(a,.75*Z.rot*c,0);break;case "ROT_RIGHT":L?B.nt(a,.75*Z.rot*c,0):B.hk(a,.75*-Z.rot*c,0);break;case "ROT_UP":L?B.nt(a,0,.75*-Z.rot*c):B.hk(a,0,.75*Z.rot*c);break;case "ROT_DOWN":L?B.nt(a,0,.75*Z.rot*c):B.hk(a,0,.75*-Z.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":O&&
(za[0]=0);break;case "LEFT":case "RIGHT":O&&(za[1]=0)}O&&(e.Vk(O,za[0],za[1]),a=B.lk(a,V),e.uj(O,a[0],a[1]))}X=a;H=b;fa=c;var M=n.Fd();z(M);var L=!1,O=null,Q=!1;switch(B.um(M)){case B.Kb:L=!a;break;case B.od:O=n.tm();break;case B.Jg:return;case B.cd:Q=!0}var Z=B.$h(M,aa);a=C.Ug();if(e.aC(M)){var la=C.Yu(M,null,!0);C.K(M,"CAMERA_COLLISION",C.Af,[la],null,function(a,b){var c=C.be(a,b,0).coll_dist;if(0>c){var d=C.be(a,b,0).coll_norm,e=W;F.scale(d,-.25*c,e);c=ea.Uc(a,ha);F.add(c,e,c);ea.DM(a,c)}})}if(O){var la=
ea.Uc(M),Da=ea.Nf(M),Da=I.tA(Da);la[2]-=.5;e.bt(O,la,Da);K.wG(M,O,[0,0,.5]);var za=new Float32Array(2),Sa=!0;e.ni(O,e.Jy);C.Un(M,"TOGGLE_CHAR_MOVE_TYPE",C.Qd,C.oF,function(){Sa=!Sa;e.ni(O,Sa?e.Jy:e.Ky)})}var Fa=p.pH(),la=Fa.length?Fa[Fa.length-1]:0,Na,S,da,ka,xb,Ga,Dc,Qa,ga,Ea;b?Na=S=da=ka=xb=Ga=b=la=Dc=Qa=ga=Ea=C.MA(0):(Na=C.Gb(C.du),S=C.Gb(C.cu),da=C.Gb(C.au),ka=C.Gb(C.bu),xb=C.Gb(C.iP),Ga=C.Gb(C.eP),b=C.gr(p.Wt,la),la=C.gr(p.Yp,la),Dc=C.Gb(C.vF),Qa=C.Gb(C.pF),ga=C.Gb(C.qF),Ea=C.Gb(C.sF));var Da=
C.Qi(p.Tp,Fa),va=C.Qi(p.Up,Fa),U=C.Qi(p.Vp,Fa),Fa=C.Qi(p.Wp,Fa);Q||(C.K(M,"FORWARD",C.la,[a,Na,va],A,E),C.K(M,"BACKWARD",C.la,[a,S,va],D,E));L?(C.K(M,"ROT_UP",C.la,[a,Dc,xb,Fa],x,E),C.K(M,"ROT_DOWN",C.la,[a,Qa,Ga,Fa],y,E),C.K(M,"ROT_LEFT",C.la,[a,ga,da,U],x,E),C.K(M,"ROT_RIGHT",C.la,[a,Ea,ka,U],y,E)):Q?(C.K(M,"LEFT",C.la,[a,ga,da,Da],x,E),C.K(M,"RIGHT",C.la,[a,Ea,ka,Da],y,E),C.K(M,"FORWARD",C.la,[a,Dc,Na,va],x,E),C.K(M,"BACKWARD",C.la,[a,Qa,S,va],y,E),C.K(M,"UP",C.la,[a,Ga,Fa],D,E),C.K(M,"DOWN",C.la,
[a,xb,Fa],A,E)):(C.K(M,"UP",C.la,[a,xb,b],G,E),C.K(M,"DOWN",C.la,[a,Ga,la],G,E),C.K(M,"LEFT",C.la,[a,da,Da],A,E),C.K(M,"RIGHT",C.la,[a,ka,Da],D,E),C.K(M,"ROT_UP",C.la,[a,Dc,Fa],A,E),C.K(M,"ROT_DOWN",C.la,[a,Qa,Fa],D,E),C.K(M,"ROT_LEFT",C.la,[a,ga,U],A,E),C.K(M,"ROT_RIGHT",C.la,[a,Ea,U],D,E));if(!c){var Oa=0;c=C.RA(d);var wa=0,Fa=C.ZA(d);C.K(M,"MOUSE_WHEEL",C.Np,[c],null,function(a,b,c){1==c&&(b=C.ud(a,b,0),B.$h(a,Z),L||Q?Oa=t(a,b,Z.zoom,Oa,L):(Z.trans*=1+b*Z.zoom,B.MZ(a,Z)))});C.K(M,"TOUCH_ZOOM",
C.Np,[Fa],null,function(a,b,c){1==c&&(c=C.ud(a,b,0),B.$h(a,Z),C.be(a,b,0)===C.hu&&(wa=t(a,c,.03*Z.zoom,wa,L)))});C.K(M,"ZOOM_INTERPOL",C.Af,[a],null,function(a,b){if(L||Q)if(1E-5<Math.abs(Oa)||1E-5<Math.abs(wa)){var c=C.ud(a,b,0),d=I.Zb(Oa,0,c,.1*T);Oa-=d;c=I.Zb(wa,0,c,.15*T);wa-=c;Q?u(a,-(d+c)):(d=B.qE(a)+d+c,d=Math.max(d,.001),B.F_(a,d))}else wa=Oa=0})}var La=0,Ra=0,rb=0,Ta=0,Ba=0,bb=0;L?(C.K(M,"GMPD_PAN_Y_POS",C.la,[b],null,r),C.K(M,"GMPD_PAN_Y_NEG",C.la,[la],null,k),C.K(M,"GMPD_PAN_X_POS",C.la,
[Da],function(a){return-.1>a[0]},l),C.K(M,"GMPD_PAN_X_NEG",C.la,[Da],function(a){return.1<a[0]},v)):Q&&(C.K(M,"GMPD_PAN_X_POS",C.la,[U],function(a){return-.1>a[0]},l),C.K(M,"GMPD_PAN_X_NEG",C.la,[U],function(a){return.1<a[0]},v));if(f){f=C.Xl("X",window);c=C.Xl("Y",window);b=C.Vn(d);var la=C.Vn(window),Xa=!1,Da=function(a){a[2]?Xa=!0:a[0]||(Xa=!1);return Xa&&a[0]};C.K(M,"MOUSE_X",C.Af,[la,f,b],Da,w,"X");C.K(M,"MOUSE_Y",C.Af,[la,c,b],Da,w,"Y");f=p.fa(p.bd,window);p.oE(f,!1)}else f=C.Xl("X",d),c=C.Xl("Y",
d),b=C.Vn(d),C.K(M,"MOUSE_X",C.Af,[b,f],null,w,"X"),C.K(M,"MOUSE_Y",C.Af,[b,c],null,w,"Y");var Ja=0,hb=0,eb=0,cb=0;f=C.jr("X",d);d=C.jr("Y",d);C.K(M,"TOUCH_X",C.Af,[f],null,g,"X");C.K(M,"TOUCH_Y",C.Af,[d],null,g,"Y");C.K(M,"ROT_TRANS_INTERPOL",C.Af,[a],null,function(a,b){if(1E-5<Math.abs(La)||1E-5<Math.abs(Ra)||1E-5<Math.abs(Ja)||1E-5<Math.abs(hb)||1E-5<Math.abs(rb)||1E-5<Math.abs(Ta)||1E-5<Math.abs(eb)||1E-5<Math.abs(cb)||1E-5<Math.abs(Ba)||1E-5<Math.abs(bb)){var c=C.ud(a,b,0),d=I.Zb(La,0,c,.08*
T),f=I.Zb(Ra,0,c,.08*T);La-=d;Ra-=f;var g=I.Zb(Ja,0,c,.12*T),k=I.Zb(hb,0,c,.12*T);Ja-=g;hb-=k;var l=I.Zb(rb,0,c,.08*T),m=I.Zb(Ta,0,c,.08*T);rb-=l;Ta-=m;var n=I.Zb(eb,0,c,.12*T),p=I.Zb(cb,0,c,.12*T);eb-=n;cb-=p;var q=I.Zb(Ba,0,c,.08*T),c=I.Zb(bb,0,c,.08*T);Ba-=q;bb-=c;L?(B.nt(a,d+g,f+k),f=B.qE(a),B.E_(a,f*(l+n+q),f*(m+p+c))):Q?(d+g&&h(a,I.Gg,.2*(d+g)),f+k&&(m=B.sm(a,P)[1],h(a,Math.abs(m)>Math.PI/4?I.Te:I.nc,.2*(f+k))),B.gK(a,l+n+q,0)):(B.hk(a,.5*(d+g),.5*(f+k)),O&&(l=B.lk(a,V),e.uj(O,l[0],l[1])))}});
C.Un(M,"DEC_STEREO_DIST",C.Qd,C.hP,function(a){var b=B.LJ(a);B.BM(a,.9*b)});C.Un(M,"INC_STEREO_DIST",C.Qd,C.jP,function(a){var b=B.LJ(a);B.BM(a,1.1*b)})}function z(a){var b=B.um(a),d=C.Xu(function(){var c=B.um(a),d=c!=b;b=c;return d});C.K(a,"CHANGE_MOVE_STYLE",C.Af,[d],null,function(){L();c(X,H,fa)})}function L(){var a=n.Fd();C.Ql(a,"TOGGLE_CHAR_MOVE_TYPE")&&n.tm()&&K.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)C.ie(a,b[c])}function D(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function G(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&x.IY(f)}var g=performance.now();x.rq(f)}g("animation");var B=g("camera"),O=g("config"),K=g("constraints"),E=g("container"),C=g("controls"),Q=g("data"),k=g("debug"),p=g("input"),x=g("main"),e=g("physics"),w=g("print"),n=g("scenes"),ea=g("transform"),I=g("util"),F=g("vec3"),T=1,M=null,X=!1,H=!1,fa=
!1,V=new Float32Array(2),P=new Float32Array(2),W=new Float32Array(3),ha=new Float32Array(3);new Float32Array(3);var v=new Float32Array(4),aa={},Z={};a.hh=function(a){function c(){var a=b(h,M,z,m),e=E.Yh();if(a){var t=E.me();E.Qk();B&&(y(n,q),x.sZ(r));u&&(l(),d());p&&x.rq(function(){t.style.height=t.clientWidth/p+"px"});g&&x.rq(function(){E.Qk()});D&&x.rq(function(){E.BB()});v&&O.zD();H==O.fq?k.xN(function(a,b){0==a?(w.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),O.Nn(O.xl)):1.5>b?(w.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),O.Nn(O.gq)):(w.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),O.Nn(O.xl));f(e,!0)}):f(e,!0)}else f(e,!1)}function e(a){a.keyCode==C.rF&&(x.fs()?x.rj():x.pause())}function f(){}a=a||{};var g=!1,h=null,m=null,n=null,p=0,q=null,t=!0,v=!1,u=!0,z=!0,F=!1,B=!1,A=!1,D=!1,H=O.get("quality"),G;for(G in a)switch(G){case "canvas_container_id":h=a.canvas_container_id;break;case "callback":f=a.callback;break;case "autoresize":g=a.autoresize;break;case "show_hud_debug_info":A=a.show_hud_debug_info;
break;case "sfx_mix_mode":F=a.sfx_mix_mode;break;case "show_fps":B=a.show_fps;break;case "track_container_position":D=a.track_container_position;break;case "fps_wrapper_id":q=a.fps_wrapper_id;break;case "fps_elem_id":n=a.fps_elem_id;break;case "error_purge_elements":m=a.error_purge_elements;break;case "report_init_failure":z=a.report_init_failure;break;case "pause_invisible":u=a.pause_invisible;break;case "key_pause_enabled":t=a.key_pause_enabled;break;case "force_container_ratio":p=a.force_container_ratio;
break;case "min_capabilities":v=a.min_capabilities;break;case "quality":H=a.quality;break;default:O.set(G,a[G])}H!=O.fq&&O.set("quality",H);t&&document.addEventListener("keydown",e,!1);O.set("show_hud_debug_info",A);O.set("sfx_mix_mode",F);var M=A||F||null;"complete"==document.readyState?window.setTimeout(c,0):window.addEventListener("load",c,!1);window.addEventListener("unload",function(){Q.ua()},!1)};a.Qk=function(){w.Qb("app.resize_to_container","container.resize_to_container");E.Qk()};a.K9=function(a,
b){var c=A(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.J9=function(a,b){var c=A(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.L9=function(a,b){var c=A(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.W4=c;a.J4=L;a.n9=function(a){w.Wh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=n.Fd();B.QD(b,a)};a.b5=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,f){if(1==f)switch(f=C.ud(a,b,0),b){case "FORWARD":d?e.Ep(a,1):ea.ph(a,0,-1*f,0);break;case "BACKWARD":d?e.Ep(a,-1):ea.ph(a,0,1*f,0);break;case "LEFT":d?e.Dp(a,-1):ea.ph(a,1*f,0,0);break;case "RIGHT":d?e.Dp(a,1):ea.ph(a,-1*f,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&e.Ep(a,0);break;case "LEFT":case "RIGHT":d&&e.Dp(a,0)}}var d=e.hf(a)||e.jf(a),f=C.Ug(),g=C.Gb(C.du),h=C.Gb(C.cu),k=C.Gb(C.au),l=C.Gb(C.bu),m=C.Gb(C.vF),n=C.Gb(C.pF),p=C.Gb(C.qF),q=C.Gb(C.sF);C.K(a,
"FORWARD",C.la,[f,g,m],b,c);C.K(a,"BACKWARD",C.la,[f,h,n],b,c);C.K(a,"LEFT",C.la,[f,k,p],b,c);C.K(a,"RIGHT",C.la,[f,l,q],b,c)};a.O4=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)C.ie(a,b[c])};a.X4=function(){w.R("app.enable_controls() deprecated")};a.K4=function(){w.R("app.disable_controls() deprecated")};a.Y4=function(){C.Un(null,"CAMERA_SHOT",C.Qd,C.fP,function(){k.FX()});C.Un(null,"LIGHT_SHOT",C.Qd,C.gP,function(){k.IX()});C.Un(null,"TELEMETRY",C.Qd,C.kP,function(){k.iD()})};
a.a9=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",
d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():w.error("B4W App: request fullscreen method is not supported")};a.h5=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&w.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.U3=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.Z8=D;a.c7=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=
e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.gU=function(a,b,c,d,e,f,g,h){function k(e){a&&(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;G(a,c,d,e,k)}};a.HR=function(a,b,c,d,e,f){function g(e){a&&
(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},G(a,c,d,e,g))};a.DY=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.DY(b)};"css"==c.type?a.gU(d,e,f,g,h,k,l,m):"attr"==c.type&&a.HR(d,e,f,g,h,m)}};a.o9=function(a){T=a};a.I5=function(){return T}};b4w.module.data=function(a,g){var l=g("__data"),d=g("__loader");g("__print");a.load=l.load;a.hy=function(a){l.hy(a|0)};a.hM=l.hM;a.kh=l.kh;a.W7=d.Cm;a.i8=l.load;a.ua=a.hy;a.nG=l.nG;a.vL=l.vL;a.NN=l.NN};b4w.module.debug=function(a,g){function l(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;G.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.CB.ALL_OPS-a.CB.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.CB,e=c.Y0,f=y(c.eU),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";G.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);G.groupCollapsed("directives");for(var g=c.hb.Ui.slice().sort(),f=0;f<g.length;f++){var h=g[f];G.ee(h[0],h[1])}G.groupEnd();G.groupCollapsed("node elements");g=c.hb.ug;for(f=0;f<g.length;f++)G.ee(g[f]);G.groupEnd();G.groupCollapsed("vert source");G.ee(c.W0);G.groupEnd();G.groupCollapsed("vert translated source");G.ee(c.X0);G.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];G.groupCollapsed("vert ops stats");for(var k in e)-1==f.indexOf(k)&&G.ee(k,e[k]);
G.groupEnd();G.groupCollapsed("vert assembly");G.ee(c.V0);G.groupEnd();G.groupCollapsed("frag source");G.ee(c.oV);G.groupEnd();G.groupCollapsed("frag translated source");G.ee(c.pV);G.groupEnd();G.groupCollapsed("frag ops stats");for(k in d)-1==f.indexOf(k)&&G.ee(k,d[k]);G.groupEnd();G.groupCollapsed("frag assembly");G.ee(c.fV);G.groupEnd();G.groupEnd()}}function y(a){for(var b=[],c=O.Nr(),d=0;d<c.length;d++)for(var e=c[d],f=z.Ub(e,"MESH",z.oc),g=0;g<f.length;g++){var h=L.ja(f[g],e);if(h&&h.X.length)for(var h=
h.X,k=0;k<h.length;k++){var l=h[k];if(l.zb==a)for(var m=0;m<l.wd.length;m++){var n=l.wd[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function r(a,b){function c(){w.push(c);n=b;return a.apply(a,arguments)}return c}function A(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var h=g("__config"),u=g("__compat"),m=g("__controls"),q=g("__container"),
f=g("__debug"),t=g("__extensions"),c=g("__loader"),z=g("__objects"),L=g("__obj_util"),D=g("__physics"),G=g("__print"),B=g("__renderer"),O=g("__scenes"),K=g("__scenegraph"),E=g("__sfx"),C=g("__shaders"),Q=g("__subscene"),k=g("__textures"),p=g("__util"),x=g("__vec3"),e=h.B,w=[],n="",ea=!0,I=new Float32Array(2);a.Ot=f.Ot;a.Xy=f.Xy;a.Pt=f.Pt;a.Wy=f.Wy;a.Nt=f.Nt;a.Vy=f.Vy;a.Uy=f.Uy;a.Rp=f.Rp;a.K8=function(){D.nU()};a.J8=function(a){G.log("O",D.bV(a));for(var b=D.BV().Ac.sa,c=0;c<b.length;c++){var d=b[c];
d.C.ea==a&&G.log("B",d)}};a.faa=function(){for(var a=O.A(),b=z.Ub(a,"MESH",z.oc),a=[O.La(a,Q.Pb),O.La(a,Q.Pc),O.La(a,Q.ke)],c=0;c<a.length;c++){var d=a[c],e=subs.Qa;if(e.length){G.group(d.type,"DYNAMIC");for(var f=0;f<b.length;f++){var g=b[f],h=g.k;if("DYNAMIC"==h.type)for(var k=!1,l=0;l<e.length;l++){for(var m=e[l].sa,n=0;n<m.length;n++){var p=m[n];if(p.dc&&p.mf==h){G.ee(g.name,g);k=!0;break}}if(k)break}}G.groupEnd();G.groupCollapsed(d.type,"STATIC");for(f=0;f<b.length;f++)if(g=b[f],h=g.k,"DYNAMIC"!=
h.type)for(k=!1,l=0;l<e.length;l++){m=e[l].sa;for(n=0;n<m.length;n++)if(p=m[n],p.dc&&p.mf==h){G.ee(g.name,g);k=!0;break}if(k)break}G.groupEnd()}}};a.D8=function(a){for(var b=O.A(),c=z.Ub(b,"MESH",z.oc),d=0;d<c.length;d++){var e=c[d];if(e.name==a){G.log("Object",e);for(var f=O.FB(b),g=0;g<f.length;g++){for(var h=f[g],k=[],l=h.Qa,m=0;m<l.length;m++)for(var n=l[m].sa,p=0;p<n.length;p++)n[p].mf==e.k&&k.push(n[p]);G.log("Subscene "+h.type,k)}}}};a.E8=function(){var a=O.A();console.log("Armatures: "+z.Ub(a,
"ARMATURE",z.oc).length);console.log("Cameras: "+z.Ub(a,"CAMERA",z.oc).length);console.log("Curves: "+z.Ub(a,"CURVE",z.oc).length);console.log("Empties: "+z.Ub(a,"EMPTY",z.oc).length);console.log("Lamps: "+z.Ub(a,"LAMP",z.oc).length);console.log("Meshes: "+z.Ub(a,"MESH",z.oc).length);console.log("Speakers: "+z.Ub(a,"SPEAKER",z.oc).length)};a.zs=function(){for(var a=0,b=O.A(),b=[O.La(b,Q.Pb),O.La(b,Q.Pc),O.La(b,Q.ke)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=
d[e].sa,g=0;g<f.length;g++){var h=f[g].za;h&&(a+=h.zs)}}return a};a.Qm=function(){for(var a=0,b=O.A(),b=[O.La(b,Q.Pb),O.La(b,Q.Pc),O.La(b,Q.ke)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].sa,g=0;g<f.length;g++){var h=f[g].za;h&&(a+=h.Qm)}}return a};a.w8=function(){for(var a=O.A(),b=O.iE(a,[Q.Pb,Q.Pc,Q.ke,Q.Rd,Q.Cf]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Qa,f=0;f<e.length;f++)c+=e[f].sa.length;a=O.iE(a,[Q.nd,Q.Ue]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Qa,
f=0;f<e.length;f++)c+=6*e[f].sa.length;return c};a.z8=function(){return p.Pr(C.eJ())};a.D5=function(){for(var a=O.A(),b=O.FB(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=Q.In&&d.type!=Q.Bf)for(var e=d.Qa,f=0;f<e.length;f++)for(var g=e[f].sa,h=0;h<g.length;h++){var k=g[h].za,l=g[h].mf;k&&(d.type!=Q.zf&&d.type!=Q.Kg||l.Vw||l.Uw)&&(a[k.id]=k)}}var c=b=0,m;for(m in a)d=a[m].Ca,d.Xn&&(c+=d.Xn/1048576),b+=d.Zn/1048576;return{vbo_memory:b,ibo_memory:c}};a.A8=function(){for(var a=[],b=0,c=O.A(),c=[O.La(c,
Q.Pb),O.La(c,Q.Pc),O.La(c,Q.ke)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=e[f].sa,h=0;h<g.length;h++){var k=g[h].za;if(k)for(var k=k.ya,l=0;l<k.length;l++){var m=k[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var n=m.rb;-1===a.indexOf(n)&&(a.push(n),m=m.width*m.height*4/1048576/m.dr,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.y8=function(){for(var a=[],b=0,c=O.A(),c=O.FB(c),d=0;d<c.length;d++){var e=c[d];if(e.type!=Q.In){var f=e.p,g=[f.wc,
f.af];g.push.apply(g,e.ui);for(e=0;e<g.length;e++){var h=g[e];k.yo(h)&&-1==a.indexOf(h)&&(a.push(h),b+=f.width*f.height*k.gW(h))}}}return{number:a.length,memory:b/1024/1024}};a.FX=function(){var a=O.A();(a=O.La(a,Q.Pb))&&O.MK(a.p,a,[1,1,0])};a.IX=function(){var a=O.A(),b=O.La(a,Q.Pb),a=O.iE(a,[Q.dd]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}O.MK(d.p,b,e)}};a.j9=function(){for(var a=O.Nr(),b=0;b<a.length;b++)G.log("\n"+
K.kU(O.MB(a[b])))};a.k9=function(){};a.k8=function(){G.log("\n"+c.lW())};a.o4=m.debug;a.C8=function(a,b){var c=m_tsr.F(a.k.n),d=m_tsr.F(b.k.n);return x.dist(c,d)};a.UK=f.UK;a.tv=f.tv;a.zL=f.zL;a.iD=f.iD;a.q5=function(a,b){function c(){f.tv("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.z3=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,
0,-1]);if(!p.Xj(a,p.VF))throw"Wrong VEC3_IDENT";if(!p.Xj(b,p.Gn))throw"Wrong QUAT4_IDENT";if(!p.Xj(c,p.Gg))throw"Wrong AXIS_X";if(!p.Xj(d,p.Bi))throw"Wrong AXIS_Y";if(!p.Xj(e,p.nc))throw"Wrong AXIS_Z";if(!p.Xj(f,p.Hy))throw"Wrong AXIS_MX";if(!p.Xj(g,p.Te))throw"Wrong AXIS_MY";if(!p.Xj(h,p.Nc))throw"Wrong AXIS_MZ";};a.t8=function(){for(var a=E.eW(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==E.TB(c)&&E.qc(c,!0)}};a.qH=function(a){f.qH(a)};a.v9=function(a){var b=O.A();if(b=O.La(b,Q.Bf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case f.Ot:case f.Xy:case f.Pt:case f.Wy:case f.Nt:case f.Vy:case f.Uy:case f.Rp:O.nZ(b,a.debug_view_mode);break;default:G.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&O.mZ(b,a.debug_colors_seed);"number"==typeof a.PY&&O.IZ(b,a.PY);"object"==typeof a.wireframe_edge_color&&O.RZ(b,p.Jf(a.wireframe_edge_color))}else G.error("Debugging is not available on the scene.")};a.Y5=function(){return G.MV()};a.o7=function(){return G.jW()};
a.CH=function(){return G.CH()};a.e3=function(a){var c=C.eJ(),e=0,g;for(g in c)a&&-1===g.indexOf(a)||e++;var e="of "+e+" analyzing...",h={};for(g in c)if(!a||-1!==g.indexOf(a)){var k=c[g],m;var n=k.ty;m=k.zv;var p=t.JV();if(p){var q=p.getTranslatedShaderSource(n),p=p.getTranslatedShaderSource(m);if(u.bf())var q=q.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),r=d("/analyze_shader/vert_gles",q),w=d("/analyze_shader/frag_gles",p);else q=q.replace("#version","#version 400 //"),
p=p.replace("#version","#version 400 //"),r=d("/analyze_shader/vert",q),w=d("/analyze_shader/frag",p);var x=l(r),y=l(w);m={W0:f.Gv().getShaderSource(n),X0:q,V0:r,Y0:x,oV:f.Gv().getShaderSource(m),pV:p,fV:w,CB:y}}else G.error("WEBGL_debug_shaders extension not found"),m=void 0;q=k.hb;n=q.Eg+" + "+q.df;m.eU=k;m.hb=q;k=h[n]=h[n]||[];k.push(m);G.ee(e)}for(n in h)G.group("%c"+n,"color: #800"),k=h[n],b(k),G.groupEnd()};a.zI=f.zI;a.xN=function(b){if(C.vH())if(t.KB()){var c=e.gl_debug;e.gl_debug=!0;var d=
K.vT();O.NI(null,d);for(var g=K.hc(d,Q.eq),h=g.p,d=0;5>d;d++)B.co(g);e.gl_debug=c;window.setTimeout(function(){f.BY(g);var a=g.Hf;b(a,h.width*h.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.xN(b)},100)};a.dH=f.dH;a.PM=f.PM;a.yL=f.yL;a.s$=function(a){w=[];ea=!0;a=g(a);for(var b in a)"function"===typeof a[b]&&(a[b]=r(a[b],b))};a.T3=function(){return ea};a.test=function(a,b){try{return b(),!0}catch(c){return ea=!1,console.error(a+" test was failed. ",c),!1}};
a.M8=function(a){var b=q.RJ(),c=q.QJ(),d=b/2,e=c/2;q.resize(b,c,!1);b=O.A().s.Wa;(c=K.cV(b))||p.q("Couldn't find onscreen subscene");b=c.p;d=q.Nu(d,e,I,c.p);d[1]=b.height-d[1];d=B.sD(b.ff,d[0],d[1]);A(a,d,1)};a.e5=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+n;};a.f5=A;a.d5=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.c5=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
g(a);for(var b in a)-1==w.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.F8=function(a){if(!Boolean(a))throw"Wrong result. Function: "+n;}};b4w.module.preloader=function(a,g){var l=g("container"),d,b,y,r,A,h,u,m,q=null;a.w4=function(a){var g="#000",c="#5276cf",h="#fff",m="#fff",q;for(q in a)switch(q){case "container_color":g=a.container_color;break;case "bar_color":c=a.bar_color;break;case "frame_color":h=a.frame_color;break;case "font_color":m=a.font_color}a=document.createElement("div");q=a.cloneNode();var u=a.cloneNode(),A=a.cloneNode(),O=l.me();u.appendChild(q);u.appendChild(A);a.appendChild(u);O.appendChild(a);a.style.cssText="background-color: "+
g+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";u.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+h+";";q.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+c+";height: 100%;";A.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+m+";";d=q;b=A;y=a;r="DEFAULT"};
a.A4=function(a){var g=null,c=null,h="#bf9221",l="#000",m;for(m in a)switch(m){case "canvas_container_id":g=a.canvas_container_id;break;case "background_container_id":c=a.background_container_id;break;case "bg_color":l=a.bg_color;break;case "bar_color":h=a.bar_color}a=document.createElement("div");m=document.createElement("div");a.id="simple_preloader_container";var u=document.createElement("div"),B=document.createElement("div"),c=document.getElementById(c);q=document.getElementById(g);a.style.cssText=
"z-index: 4;background-color: "+l+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";m.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";u.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+h+";border-radius: 0px;";B.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
m.appendChild(u);m.appendChild(B);a.appendChild(m);document.body.appendChild(a);r="SIMPLE";y=a;d=u;b=B;A=c};a.x4=function(a){var d=null,c=null,g="rgba(0,0,0,0)",l="",m="",u="rgba(0,0,0,0)",B;for(B in a)switch(B){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":c=a.background_container_id;break;case "frame_bg_color":g=a.frame_bg_color;break;case "bg_color":u=a.bg_color;break;case "frame_class":l=a.frame_class;break;case "anim_elem_class":m=a.anim_elem_class}a=
document.createElement("div");B=document.createElement("div");var O=document.createElement("div"),K=document.createElement("div"),c=document.getElementById(c);q=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+u+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";B.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+g+";";O.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";
K.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";O.className=m;B.appendChild(O);B.className=l;B.appendChild(K);a.appendChild(B);q.appendChild(a);r="ROTATION";y=a;h=O;b=K;A=c};a.s4=function(a){var g=a.preloader_width,g=g/(g-a.img_width),c=document.getElementById(a.preloader_bar_id),h=document.getElementById(a.fill_band_id),l=document.getElementById(a.preloader_caption_id),D=document.getElementById(a.preloader_container_id),
G=document.getElementById(a.background_container_id);q=document.getElementById(a.canvas_container_id);r="ADVANCED";d=c;u=h;m=g;b=l;y=D;A=G};a.Y$=function(a){b.innerHTML=a+"%";"SIMPLE"==r?d.style.width=a+"%":"ADVANCED"==r?(d.style.width=a/m+"%",u.style.width=100-a+"%"):"ROTATION"==r?h.style.transform="rotate("+a+"deg)":"DEFAULT"==r&&(d.style.width=a+"%");100==a&&(y.parentNode.removeChild(y),A&&A.parentNode.removeChild(A))}};"object"==typeof module&&module.vB&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,g){g("__print");var l=g("__version");a.version=l.version;a.SE=l.SE;a.type=l.type;a.hI=l.hI;a.fB=l.fB};"object"==typeof module&&module.vB&&b4w.module.version(exports);if(b4w.module_check("ui"))throw"Failed to register module: environment";b4w.register("ui",function(a){var g,l;a.IW=function(){g=document.getElementById("hud");l=document.getElementById("info");g.style.visibility="visible";l.innerHTML="Iniciado"};a.m0=function(a){l.innerHTML=a}});if(b4w.module_check("game_options"))throw"Failed to register module: system";b4w.register("game_options",function(a){a.Oq={fF:[0,-.2,.85],eF:[0,5,3]}});if(b4w.module_check("game_properties_defaults"))throw"Failed to register module: system";b4w.register("game_properties_defaults",function(a){a.Oq={fF:[0,-.2,.85],eF:[0,5,3]};a.Pq={id:"character",gX:100,t_:100,xW:0,lS:2500,eX:1,fX:0}});if(b4w.module_check("game_properties"))throw"Failed to register module: system";b4w.register("game_properties",function(a,g){var l=g("game_options");a.Oq=l.Oq;a.Pq={id:"character",gX:100,t_:100,xW:0,lS:2500,eX:1,fX:0};a.L3={XY:[],c1:[],J$:[]}});if(b4w.module_check("environment"))throw"Failed to register module: environment";b4w.register("environment",function(a,g){g("particles");g("scenes");var l=g("lights");a.AW=function(){l.lZ()}});if(b4w.module_check("character"))throw"Failed to register module: character";
b4w.register("character",function(a,g){function l(){var a=h.Yh();a.addEventListener("mouseup",function(){u.VY(a)},!1);z.sG(p.Lu,p.Qn[p.dB])}function d(){var a=r.Gb(r.lP),b=r.Gb(r.rF),c=r.Gb(r.dP);r.K(p.of,"CHANGE_CAMERA",r.Qd,[a,A.Xp],function(a){return a[0]||a[1]},function(a,b,c){1==c&&(a=p.dB+1,1<a&&(a=0),p.dB=a,L.Nf(p.of,n),z.remove(p.Lu),z.sG(p.Lu,p.Qn[a]))});r.K(p.of,"PAUSE",r.Qd,[b,A.Ut],function(a){return a[0]||a[1]},function(a,b,c){1==c&&q.pause()});r.K(p.of,"PAUSE",r.Qd,[c,A.Vt,e[4]],function(a){return(a[0]||
a[1])&&a[2]},function(a,b,c){1==c&&(f.YZ(),console.log("Patata"))})}function b(){function a(b,c,d){if(1==d)switch(c){case "FORWARD":x.Hr=1;break;case "BACKWARD":x.Hr=-1;break;case "LEFT":x.os=1;break;case "RIGHT":x.os=-1;break;case "RUNNING":D.ni(b,D.gF)}else switch(c){case "FORWARD":case "BACKWARD":x.Hr=0;break;case "LEFT":case "RIGHT":x.os=0;break;case "RUNNING":D.ni(b,D.Ky)}D.Vk(b,x.Hr,x.os)}var b=r.Gb(r.au),c=r.Gb(r.cu),d=r.Gb(r.bu),f=r.Gb(r.du),g=r.Gb(r.uF),h=r.Gb(r.tF);x={os:0,Hr:0};e=b=[f,
c,b,d,h];r.K(p.of,"FORWARD",r.Hg,b,function(a){return a[0]},a);r.K(p.of,"BACKWARD",r.Hg,b,function(a){return a[1]},a);r.K(p.of,"LEFT",r.Hg,b,function(a){return a[2]},a);r.K(p.of,"RIGHT",r.Hg,b,function(a){return a[3]},a);r.K(p.of,"RUNNING",r.Hg,b,function(a){return(a[0]||a[1]||a[2]||a[3])&&a[4]},a);r.K(p.of,"JUMP",r.Qd,[g],null,function(a){D.Pu(a)})}function y(){function a(b,c,d,e,f){console.log("Object hit: "+d.name+" Hit position: "+f);k.m0(d.name)}var b=new Float32Array(3),c=K.wT(),d=new Float32Array(3);
E.create();E.create();C.create();var e=1,f=1,g=0,l=0,n=!1;h.me().addEventListener("mousemove",function(a){e=a.clientX;f=a.clientY;n=!0},!1);var q=r.Xu(function(){if(g==e&&l==f&&0==n&&0==x.Hr&&0==x.os){Q.gS(m.Fd(),e,f,c);K.QB(c,d);B.scale(d,100,d);var h=m.Fd();D.dR(h,b,d,a)}else 1==n&&(g=e,l=f,n=!1)});r.K(p.Lu,"VIEW",r.la,[q])}g("fps");var r=g("controls"),A=g("input"),h=g("container"),u=g("mouse"),m=g("scenes"),q=g("main"),f=g("screenshooter"),t=g("game_properties");g("game_options");var c=g("objects_manager"),
z=g("constraints"),L=g("transform"),D=g("physics"),G=g("animation"),B=g("vec3"),O=g("system"),K=g("math"),E=g("tsr"),C=g("quat"),Q=g("camera"),k=g("ui"),p,x,e,w=new Float32Array(3);new Float32Array(3);var n=new Float32Array(4);a.M3=p;a.zW=function(){p={of:m.Mf("GroupCharacterJim","Character"),rig:m.Mf("GroupCharacterJim","metarig"),VX:m.Mf("GroupCharacterJim","CharModel"),Lu:m.Fd(),dB:0,Qn:[m.Mf("GroupCharacterJim","EmptyHeadCam"),m.Mf("GroupCharacterJim","Empty3rdPersonCam")],type:"character",Pq:O.dJ()};
w=t.Oq.fF;z.remove(p.Qn[0]);z.uG(p.Qn[0],p.of,w);w=t.Oq.eF;z.remove(p.Qn[1]);z.uG(p.Qn[1],p.of,w);p.Pq.V2=0;l();b();d();c.$M(p.of,"EmptySpawner1");G.apply(p.rig,"GroupCharacterJim_proxyAction_B4W_BAKED");G.cn(p.rig,G.Ay);G.play(p.rig);y()}});if(b4w.module_check("npc_characters"))throw"Failed to register module: system";
b4w.register("npc_characters",function(a,g){g("config");var l=g("scenes"),d=g("npc_ai"),b=g("objects_manager"),y=g("animation"),r=g("system"),A=g("transform"),h;a.v8=h;a.DW=function(a){switch(a.type){case "npc":if("dino"==a.vb&&"TRex"==a.k_){h={of:l.Mf("GroupTRex","TRexPhysicsBody"),rig:l.Mf("GroupTRex","ArmatureTRex"),VX:l.Mf("GroupTRex","TRex"),B8:a,Pq:r.dJ()};a=A.Uc(l.OB("EmptySpawner2"));var g=A.Uc(l.OB("EmptySpawner3"));y.apply(l.Mf("GroupTRex","ArmatureTRex"),"ArmatureTRex_proxyAction_B4W_BAKED");
a={path:[a,g],delay:1,actions:{move:["ArmatureTRex_proxyAction_B4W_BAKED"]},obj:l.Mf("GroupTRex","TRex"),rig:l.Mf("GroupTRex","ArmatureTRex"),collider:l.Mf("GroupTRex","TRexPhysicsBody"),speed:1,rot_speed:1,random:!0,type:d.GP};b.$M(l.Mf("GroupTRex","TRexPhysicsBody"),"EmptySpawner2");d.$X(a);d.EU()}}}});if(b4w.module_check("system"))throw"Failed to register module: system";b4w.register("system",function(a,g){var l=g("config"),d=g("game_properties");g("game_properties_defaults");a.HW=function(){l.set("max_fps",45);l.set("max_fps_physics",500)};a.dJ=function(){return d.Pq}});if(b4w.module_check("objects_manager"))throw"Failed to register module: vehicles";
b4w.register("objects_manager",function(a,g){var l=g("scenes");g("main");g("screenshooter");g("constraints");var d=g("transform"),b=g("physics");g("animation");g("vec3");var y=g("npc_characters");new Float32Array(3);new Float32Array(3);var r=new Float32Array(4),A,h,u,m,q,f;a.g3=h;a.H4=u;a.items=m;a.c1=q;a.XY=f;a.EW=function(){h=[];u=[{id:[1,0],type:"npc",vb:"dino",k_:"TRex"}];m=[];q=[];f=[];A=[h,u,m,q,f];for(var a=0;a<A.length;a++)for(var b=A[a],d=0;d<b.length;d++){var g=b[d];switch(g.type){case "npc":y.DW(g)}}};
a.$M=function(a,c){if(b.qW(a)){var f=l.OB(c),g=d.Uc(f);d.Nf(f,r);console.log("Spawner rotation: "+r);b.bt(a,g,r)}}});b4w.register("project_ow_app",function(a,g){function l(a,c){c?(a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},document.getElementById("preloader_cont").style.visibility="visible",A.load(z+"project_ow.json",b,d)):console.log("b4w init failure")}function d(a){var b=document.getElementById("prelod_dynamic_path"),c=b.nextElementSibling;b.style.width=a+"%";c.innerHTML=a+"%";100==a&&(document.getElementById("preloader_cont").style.visibility="hidden")}function b(a,b){b?(u.HW(),
q.AW(),m.zW(),f.EW(),t.IW()):console.log("b4w load failure")}var y=g("app"),r=g("config"),A=g("data");g("preloader");var h=g("version");g("npc_ai");g("scenes");var u=g("system"),m=g("character"),q=g("environment");g("animation");var f=g("objects_manager"),t=g("ui"),c="DEBUG"==h.type(),z=r.Dv("project_ow");a.hh=function(){y.hh({canvas_container_id:"main_canvas_container",callback:l,show_fps:c,console_verbose:c,gl_debug:!0,autoresize:!0,key_pause_enabled:!0})}});b4w.require("project_ow_app").hh();
