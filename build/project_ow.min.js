var b4w="object"===typeof b4w?b4w:function(a){var h={};a.module=h;var p={};a.ua=function(a,b){var y=h[a];y&&(y.vn=null);p[b||"__b4w_default"]=null};a.register=function(a,b){h[a]||(h[a]=b)};a.require=function(a,b){if(!h[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";p[b]||(p[b]=function(a){return function(b){var e=h[b];if(!e)throw Error('Module "'+b+'" not found');e.vn||(e.vn={});e.vn[a]||(e.vn[a]={},e(e.vn[a],p[a]));return e.vn[a]}}(b));return p[b](a)};a.module_check=function(a){return h[a]?
!0:!1};a.get_namespace=function(a){for(var b in p)if(p[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.lights=function(a,h){function p(a){for(var e=k.A(),c=y.Ub(e,"LAMP",y.oc),p=0;p<c.length;p++){var r=c[p];if("SUN"==r.ub.type){var B=r;break}}if(!B)A.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){c=l.Cb(180-a.hor_position);a=l.Cb(90-a.vert_position);p=B.k;w.Ww(B,[a,0,c]);c=new Float32Array(3);l.lc(n.P(p.n),l.nc,c);p=f.length(n.G(p.n));f.copy(c,v);f.scale(v,p,v);w.Wc(B,v);w.D(B);c=B.ub;if(c.GH){var I=e.world.light_settings.environment_energy,
p=e.world.horizon_color,r=e.world.zenith_color,z=Math.cos(Math.abs(a));a=Math.max(Math.min(3*z,1),0)*c.xH;I*=Math.max(z,.1);b.Cs(c,a);k.Rw(e,I,p,r)}k.gp(B,e)}}function e(a){if(r.Zg(a))return a.ub.type;A.error("get_light_type(): Wrong object");return!1}var b=h("__lights"),y=h("__objects"),r=h("__obj_util"),A=h("__print"),k=h("__scenes"),w=h("__transform"),n=h("__tsr"),l=h("__util"),f=h("__vec3"),v=new Float32Array(3),c,B=60;a.Y4=function(a){var b=k.A(),b=y.Ub(b,"LAMP",y.oc);if(!a)return b;for(var e=
[],c=0;c<b.length;c++){var f=b[c];f.ub.type===a&&e.push(f)}return e};a.G5=function(){for(var a=k.A(),a=y.Ub(a,"LAMP",y.oc),b=null,e=0;e<a.length;e++){var c=a[e];if("SUN"==c.ub.type){b=c;break}}return b?(b=b.ub.direction,a=l.oe(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=l.oe(Math.atan2(b[2],Math.sqrt(b[0]*b[0]+b[1]*b[1]))),e={},e.hor_position=a,e.vert_position=b,e):null};a.L8=p;a.hY=function(){for(var a=k.A(),a=y.Ub(a,"LAMP",y.oc),b=0;b<a.length;b++){var e=a[b];if("SUN"==e.ub.type){var c=e;break}}c?
(c={hor_position:135},c.vert_position=-Math.cos(.75*Math.PI)*B,p(c)):A.error("There is no sun on the scene")};a.e8=function(a){(c=a.getDate())?1582==c&&10==a.Z6&&4<a.sT&&15>a.sT&&A.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):A.error("There is no year 0 in the Julian system!")};a.s8=function(a){B=Math.min(Math.max(a,0),90)};a.b5=function(a){if(r.Zg(a))var b=a.ub;else return A.error("get_light_params(): Wrong object"),null;if(a=e(a))switch(a){case "SPOT":var c=
{light_type:a,light_color:new Float32Array(3),light_energy:b.Df,light_spot_blend:b.Ms,light_spot_size:b.Vm,light_distance:b.distance};c.light_color.set(b.color);break;case "POINT":c={light_type:a,light_color:new Float32Array(3),light_energy:b.Df,light_distance:b.distance};c.light_color.set(b.color);break;default:c={light_type:a,light_color:new Float32Array(3),light_energy:b.Df},c.light_color.set(b.color)}return c?c:null};a.c5=e;a.n8=function(a,e){if(r.Zg(a)){var c=a.ub,f=k.A(),l=!1;"number"==typeof e.light_energy&&
b.Cs(c,e.light_energy);"object"==typeof e.light_color&&b.Vw(c,e.light_color);"number"==typeof e.light_spot_blend&&(b.vY(c,e.light_spot_blend),l=!0);"number"==typeof e.light_spot_size&&(b.wY(c,e.light_spot_size),l=!0);"number"==typeof e.light_distance&&(b.uY(c,e.light_distance),l=!0);k.gp(a,f);l&&k.TZ(f)}else A.error("set_light_params(): Wrong object")};a.a5=function(a){return r.Zg(a)?a.ub.Df:(A.error("get_light_energy(): Wrong object"),0)};a.Cs=function(a,e){if(r.Zg(a)){var c=k.A();b.Cs(a.ub,e);k.gp(a,
c)}else A.error("set_light_energy(): Wrong object")};a.Z4=function(a,b){if(!r.Zg(a))return A.error("get_light_color(): Wrong object"),null;b=b||new Float32Array(3);b.set(a.ub.color);return b};a.Vw=function(a,e){if(r.Zg(a)){var c=k.A();b.Vw(a.ub,e);k.gp(a,c)}else A.error("set_light_color(): Wrong object")}};b4w.module.__lights=function(a,h){function p(a){y.scale(a.color,a.Df,a.Eq)}h("__print");var e=h("__tsr"),b=h("__util"),y=h("__vec3"),r=new Float32Array(3);new Float32Array(3);a.fW=function(a,k){var w=a.data,n=k.ub={name:"",type:w.type,JK:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Eq:new Float32Array(3),xH:0,gE:!1,Vm:0,Ms:0,wq:.1,vq:30,bI:!1,mK:!1,GH:!1,$m:!0,bn:!0,Df:1,distance:25,Z3:"INVERSE_SQUARE"};n.name=k.name;n.$m=w.use_diffuse;n.bn=w.use_specular;var l=b.lc(e.P(k.k.n),
b.nc,r);y.normalize(l,l);n.direction.set(l);n.color[0]=w.color[0];n.color[1]=w.color[1];n.color[2]=w.color[2];n.Df=n.xH=w.energy;p(n);n.distance=w.distance;n.gE=w.use_sphere;n.wq=w.clip_start;n.vq=w.clip_end;if("POINT"===n.type||"SPOT"===n.type)n.distance=w.distance;"SPOT"===n.type?(n.Ms=w.spot_blend,n.Vm=w.spot_size):"POINT"===n.type&&(n.Vm=Math.PI/2);n.bI=w.b4w_generate_shadows;n.GH=w.b4w_dynamic_intensity};a.Vw=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];p(a)};a.vY=function(a,
b){a.Ms=b};a.uY=function(a,b){a.distance=b};a.wY=function(a,b){a.Vm=b};a.Cs=function(a,b){a.Df=b;p(a)};a.k_=function(a){var p=a.ub;if(p){b.lc(e.P(a.k.n),b.nc,p.direction);y.normalize(p.direction,p.direction);if("SUN"==p.type){a=Math.acos(y.dot(p.JK,b.hz));var r=Math.acos(y.dot(p.direction,b.hz));p.mK=Math.floor(a/.025)!=Math.floor(r/.025)?!0:!1}y.copy(p.direction,p.JK)}}};b4w.module.__print=function(a){function h(a,b){var e=[];-1<a[0].indexOf("%c")?e.push(a[0].replace("%c","%c"+b+": ")):e.push(b+": "+a[0]);for(var f=1;f<a.length;f++)e.push(a[f]);return e}function p(){r++;var a=h(arguments,"B4W ERROR");console.error.apply(console,a)}function e(a){a in k||(k[a]=a,p([a]))}function b(a,b){e(a+"() is deprecated, use "+b+"() instead.")}var y=!1,r=0,A=0,k={};a.LY=function(a){y=a};a.ae=function(){console.log.apply(console,arguments)};a.log=function(){if(y){var a=h(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=p;a.O=e;a.Sb=b;a.Oh=function(a,p){switch(1<p.length){case !0:e(a+"() is deprecated, use "+p.slice(0,-1).join("(), ")+"() or "+p[p.length-1]+"() instead.");break;case !1:b(a,p[0])}};a.TT=function(){e('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){A++;var a=h(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=h(arguments,"B4W INFO");console.info.apply(console,a)};a.WT=function(){r++;
var a=h(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.XT=function(){A++;var a=h(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){y&&console.time.apply(console,arguments)};a.timeEnd=function(){y&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.tV=function(){return A};a.VU=function(){return r};a.OG=function(){r=A=0}};b4w.module.print=b4w.module.__print;b4w.module.__tsr=function(a,h){function p(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function e(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function y(a,b,e,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=b;c[4]=e[0];c[5]=e[1];c[6]=e[2];c[7]=e[3];return c}function r(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function A(a,b,e){var c=b[0],f=b[1],p=b[2],l=b[3],d=b[4],m=b[5],v=b[6];
b=b[7];var k=a[0]*l,g=a[1]*l,n=a[2]*l;a=b*k+m*n-v*g;var l=b*g+v*k-d*n,t=b*n+d*g-m*k,k=-d*k-m*g-v*n;e[0]=a*b+k*-d+l*-v-t*-m;e[1]=l*b+k*-m+t*-d-a*-v;e[2]=t*b+k*-v+a*-m-l*-d;e[0]+=c;e[1]+=f;e[2]+=p;return e}var k=h("__mat4"),w=h("__quat"),n=h("__util"),l=h("__vec3"),f=Math.sin(-Math.PI/4),v=-f,c=new Float32Array(3),B=new Float32Array(4);new Float32Array(4);var Q=new Float32Array(16);a.create=p;a.clone=function(a){var e=p();b(a,e);return e};a.i4=function(a,b,e,c,f,l,v,d){var m=p();m[0]=a;m[1]=b;m[2]=
e;m[3]=c;m[4]=f;m[5]=l;m[6]=v;m[7]=d;return m};a.Hl=e;a.g3=function(a){var c=e();b(a,c);return c};a.j4=function(a,b,c,f,p,l,v,d){var m=e();m[0]=a;m[1]=b;m[2]=c;m[3]=f;m[4]=p;m[5]=l;m[6]=v;m[7]=d;return m};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.hi=y;a.kf=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Mf=function(a,b){b[3]=a;return b};a.IY=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.Jk=function(a,b){b[4]=a[0];b[5]=a[1];
b[6]=a[2];b[7]=a[3];return b};a.G=function(a){return a.subarray(0,3)};a.hc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Yd=function(a){return a[3]};a.rV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.P=function(a){return a.subarray(4,8)};a.Xd=r;a.invert=function(a,b){var e=1/a[3];if(!e)return null;var c=a[0],f=a[1],p=a[2];B[0]=a[4];B[1]=a[5];B[2]=a[6];B[3]=a[7];w.invert(B,B);var l=B[0],d=B[1],m=B[2],v=B[3],c=c*e,f=f*e,k=p*e,p=v*c+d*k-m*f,g=v*f+m*c-l*k,n=v*k+l*f-d*c,c=-l*c-d*f-
m*k;b[0]=-(p*v+c*-l+g*-m-n*-d);b[1]=-(g*v+c*-d+n*-l-p*-m);b[2]=-(n*v+c*-m+p*-d-g*-l);b[3]=e;b[4]=l;b[5]=d;b[6]=m;b[7]=v;return b};a.QM=function(a,b){var e=a[3];k.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var c=0;12>c;c++)b[c]*=e};a.Qi=function(a,b){var e=n.cK(a,c),f=n.bK(a),l=n.VB(a,B);y(e,f,l,b)};a.multiply=function(a,b,e){A(b,a,e);e[3]=a[3]*b[3];var c=a[4],f=a[5],l=a[6];a=a[7];var p=b[4],d=b[5],m=b[6];b=b[7];e[4]=c*b+a*p+f*m-l*d;e[5]=f*b+a*d+l*p-c*m;e[6]=l*b+a*m+c*d-f*p;e[7]=
a*b-c*p-f*d-l*m;return e};a.MZ=function(a,b,e){var c=b[3];b=k.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),Q);for(var f=0;12>f;f++)b[f]*=c;k.multiply(b,a,e);return e};a.Xc=A;a.y9=function(a,b,e){var c=b[3],f=a[0]-b[0],l=a[1]-b[1],p=a[2]-b[2];a=b[4];var d=b[5],m=b[6];b=b[7];var v=a*a+d*d+m*m+b*b,v=v?1/v:0;a=-a*v;d=-d*v;m=-m*v;b*=v;var v=b*f+d*p-m*l,k=b*l+m*f-a*p,g=b*p+a*l-d*f,f=-a*f-d*l-m*p;e[0]=v*b+f*-a+k*-m-g*-d;e[1]=k*b+f*-d+g*-a-v*-m;e[2]=g*b+f*-m+v*-d-k*-a;e[0]/=c;e[1]/=c;e[2]/=c;return e};
a.cp=function(a,b,e,c){c||(c=0);var f=a.length,l=b[0],p=b[1],d=b[2],m=b[3],v=b[4],k=b[5],g=b[6];b=b[7];for(var n=0;n<f;n+=3){var t=a[n]*m,r=a[n+1]*m,J=a[n+2]*m,F=b*t+k*J-g*r,B=b*r+g*t-v*J,N=b*J+v*r-k*t,t=-v*t-k*r-g*J;e[c+n]=F*b+t*-v+B*-g-N*-k;e[c+n+1]=B*b+t*-k+N*-v-F*-g;e[c+n+2]=N*b+t*-g+F*-k-B*-v;e[c+n]+=l;e[c+n+1]+=p;e[c+n+2]+=d}};a.LZ=function(a,b,e){var c=0,c=0,f=a.length,l=b[3],p=b[4],d=b[5],m=b[6];b=b[7];for(var v=0;v<f;v+=3){var k=a[v]*l,g=a[v+1]*l,n=a[v+2]*l,t=b*k+d*n-m*g,r=b*g+m*k-p*n,J=
b*n+p*g-d*k,k=-p*k-d*g-m*n;e[c+v]=t*b+k*-p+r*-m-J*-d;e[c+v+1]=r*b+k*-d+J*-p-t*-m;e[c+v+2]=J*b+k*-m+t*-d-r*-p}};a.wd=function(a,b,e){var c=b[3],f=b[4],l=b[5],p=b[6];b=b[7];var d=a[0]*c,m=a[1]*c,v=a[2]*c;a=b*d+l*v-p*m;var c=b*m+p*d-f*v,k=b*v+f*m-l*d,d=-f*d-l*m-p*v;e[0]=a*b+d*-f+c*-p-k*-l;e[1]=c*b+d*-l+k*-f-a*-p;e[2]=k*b+d*-p+a*-l-c*-f};a.OZ=function(a,b,e,c){c||(c=0);var f=a.length,l=b[3],p=b[4],d=b[5],m=b[6];b=b[7];for(var v=0;v<f;v+=4){var k=a[v]*l,g=a[v+1]*l,n=a[v+2]*l,t=b*k+d*n-m*g,r=b*g+m*k-p*
n,J=b*n+p*g-d*k,k=-p*k-d*g-m*n;e[c+v]=t*b+k*-p+r*-m-J*-d;e[c+v+1]=r*b+k*-d+J*-p-t*-m;e[c+v+2]=J*b+k*-m+t*-d-r*-p;e[c+v+3]=a[v+3]}};a.NZ=function(a,b,e){b=r(b,B);w.multiply(b,a,e)};a.VM=function(a,b,e,c){c=c||0;b=r(b,B);n.UK(a,b,e,c)};a.translate=function(a,b,e){var c=a[3],f=a[4],p=a[5],l=a[6],d=a[7],m=b[0]*c,v=b[1]*c,k=b[2]*c;b=d*m+p*k-l*v;var c=d*v+l*m-f*k,g=d*k+f*v-p*m,m=-f*m-p*v-l*k;e[0]=a[0]+b*d+m*-f+c*-l-g*-p;e[1]=a[1]+c*d+m*-p+g*-f-b*-l;e[2]=a[2]+g*d+m*-l+b*-p-c*-f;e[3]=a[3];e[4]=a[4];e[5]=
a[5];e[6]=a[6];e[7]=a[7];return e};a.CB=function(a,b,e,c){l.lerp(a.subarray(0,3),b.subarray(0,3),e,c.subarray(0,3));var f=a[3];c[3]=f+e*(b[3]-f);w.slerp(a.subarray(4,8),b.subarray(4,8),e,c.subarray(4,8));return c};a.V3=function(a,b,e,c){var f=a.subarray(0,3),p=b.subarray(0,3),l=c.subarray(0,3);l[0]=p[0]*(e+1)-f[0]*e;l[1]=p[1]*(e+1)-f[1]*e;l[2]=p[2]*(e+1)-f[2]*e;c[3]=b[3]*(e+1)-a[3]*e;a=a.subarray(4,8);b=b.subarray(4,8);f=c.subarray(4,8);f[0]=b[0]*(e+1)-a[0]*e;f[1]=b[1]*(e+1)-a[1]*e;f[2]=b[2]*(e+1)-
a[2]*e;f[3]=b[3]*(e+1)-a[3]*e;w.normalize(f,f);return c};a.NV=function(a,b,e,c,f){f[0]=a[0]+b*e[0];f[1]=a[1]+b*e[1];f[2]=a[2]+b*e[2];f[3]=a[3];e=c[0];var p=c[1];c=c[2];var l=a[4],d=a[5],m=a[6],v=a[7];f[4]=.5*(e*v+p*m-c*d);f[5]=.5*(p*v+c*l-e*m);f[6]=.5*(c*v+e*d-p*l);f[7]=.5*(-e*l-p*d-c*m);f[4]=a[4]+f[4]*b;f[5]=a[5]+f[5]*b;f[6]=a[6]+f[6]*b;f[7]=a[7]+f[7]*b;a=f[4];b=f[5];e=f[6];p=f[7];a=a*a+b*b+e*e+p*p;0<a&&(a=1/Math.sqrt(a),f[4]*=a,f[5]*=a,f[6]*=a,f[7]*=a)};a.w9=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];var e=a[4],c=a[5],p=a[6],l=a[7];b[4]=e*v+l*f;b[5]=c*v+p*f;b[6]=p*v-c*f;b[7]=l*v-e*f};a.v9=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__vec3=function(a){var h="undefined"!==typeof Float32Array?Float32Array:Array,p=Math.random;a.create=function(){var a=new h(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new h(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,p){var r=new h(3);r[0]=a;r[1]=b;r[2]=p;return r};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,p,r){r[0]=a;r[1]=b;r[2]=p;return r};a.add=function(a,b,p){p[0]=a[0]+b[0];p[1]=a[1]+b[1];p[2]=a[2]+b[2];
return p};a.subtract=function(a,b,p){p[0]=a[0]-b[0];p[1]=a[1]-b[1];p[2]=a[2]-b[2];return p};a.sub=a.subtract;a.multiply=function(a,b,p){p[0]=a[0]*b[0];p[1]=a[1]*b[1];p[2]=a[2]*b[2];return p};a.mul=a.multiply;a.divide=function(a,b,p){p[0]=a[0]/b[0];p[1]=a[1]/b[1];p[2]=a[2]/b[2];return p};a.div=a.divide;a.min=function(a,b,p){p[0]=Math.min(a[0],b[0]);p[1]=Math.min(a[1],b[1]);p[2]=Math.min(a[2],b[2]);return p};a.max=function(a,b,p){p[0]=Math.max(a[0],b[0]);p[1]=Math.max(a[1],b[1]);p[2]=Math.max(a[2],
b[2]);return p};a.scale=function(a,b,p){p[0]=a[0]*b;p[1]=a[1]*b;p[2]=a[2]*b;return p};a.scaleAndAdd=function(a,b,p,r){r[0]=a[0]+b[0]*p;r[1]=a[1]+b[1]*p;r[2]=a[2]+b[2]*p;return r};a.distance=function(a,b){var p=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2];return Math.sqrt(p*p+r*r+A*A)};a.dist=a.distance;a.squaredDistance=function(a,b){var p=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2];return p*p+r*r+A*A};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],p=a[1];a=a[2];return Math.sqrt(b*b+p*p+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],p=a[1];a=a[2];return b*b+p*p+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var p=a[0],r=a[1],A=a[2],p=p*p+r*r+A*A;0<p&&(p=1/Math.sqrt(p),b[0]=a[0]*p,b[1]=a[1]*p,b[2]=a[2]*p);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,p){var r=a[0],A=a[1];a=a[2];var k=b[0],w=b[1];b=b[2];
p[0]=A*b-a*w;p[1]=a*k-r*b;p[2]=r*w-A*k;return p};a.lerp=function(a,b,p,r){var A=a[0],k=a[1];a=a[2];r[0]=A+p*(b[0]-A);r[1]=k+p*(b[1]-k);r[2]=a+p*(b[2]-a);return r};a.q6=function(a,b,p,r,A,k){var w=A*A,n=w*(2*A-3)+1,l=w*(A-2)+A,f=w*(A-1);A=w*(3-2*A);k[0]=a[0]*n+b[0]*l+p[0]*f+r[0]*A;k[1]=a[1]*n+b[1]*l+p[1]*f+r[1]*A;k[2]=a[2]*n+b[2]*l+p[2]*f+r[2]*A;return k};a.cG=function(a,b,p,r,A,k){var w=1-A,n=w*w,l=A*A,f=n*w,n=3*A*n,w=3*l*w;A*=l;k[0]=a[0]*f+b[0]*n+p[0]*w+r[0]*A;k[1]=a[1]*f+b[1]*n+p[1]*w+r[1]*A;k[2]=
a[2]*f+b[2]*n+p[2]*w+r[2]*A;return k};a.random=function(a,b){a=a||1;var y=2*p()*Math.PI,r=2*p()-1,A=Math.sqrt(1-r*r)*a;b[0]=Math.cos(y)*A;b[1]=Math.sin(y)*A;b[2]=r*a;return b};a.transformMat4=function(a,b,p){var r=a[0],A=a[1];a=a[2];var k=b[3]*r+b[7]*A+b[11]*a+b[15],k=k||1;p[0]=(b[0]*r+b[4]*A+b[8]*a+b[12])/k;p[1]=(b[1]*r+b[5]*A+b[9]*a+b[13])/k;p[2]=(b[2]*r+b[6]*A+b[10]*a+b[14])/k;return p};a.transformMat3=function(a,b,p){var r=a[0],A=a[1];a=a[2];p[0]=r*b[0]+A*b[3]+a*b[6];p[1]=r*b[1]+A*b[4]+a*b[7];
p[2]=r*b[2]+A*b[5]+a*b[8];return p};a.transformQuat=function(a,b,p){var r=a[0],A=a[1],k=a[2];a=b[0];var w=b[1],n=b[2];b=b[3];var l=b*r+w*k-n*A,f=b*A+n*r-a*k,v=b*k+a*A-w*r,r=-a*r-w*A-n*k;p[0]=l*b+r*-a+f*-n-v*-w;p[1]=f*b+r*-w+v*-a-l*-n;p[2]=v*b+r*-n+l*-w-f*-a;return p};a.rotateX=function(a,b,p,r){var A=[],k=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];k[0]=A[0];k[1]=A[1]*Math.cos(p)-A[2]*Math.sin(p);k[2]=A[1]*Math.sin(p)+A[2]*Math.cos(p);r[0]=k[0]+b[0];r[1]=k[1]+b[1];r[2]=k[2]+b[2];return r};a.rotateY=
function(a,b,p,r){var A=[],k=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];k[0]=A[2]*Math.sin(p)+A[0]*Math.cos(p);k[1]=A[1];k[2]=A[2]*Math.cos(p)-A[0]*Math.sin(p);r[0]=k[0]+b[0];r[1]=k[1]+b[1];r[2]=k[2]+b[2];return r};a.rotateZ=function(a,b,p,r){var A=[],k=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];k[0]=A[0]*Math.cos(p)-A[1]*Math.sin(p);k[1]=A[0]*Math.sin(p)+A[1]*Math.cos(p);k[2]=A[2];r[0]=k[0]+b[0];r[1]=k[1]+b[1];r[2]=k[2]+b[2];return r};a.forEach=function(){var e=a.create();return function(a,
p,r,A,k,w){p||(p=3);r||(r=0);for(A=A?Math.min(A*p+r,a.length):a.length;r<A;r+=p)e[0]=a[r],e[1]=a[r+1],e[2]=a[r+2],k(e,w,e),a[r]=e[0],a[r+1]=e[1],a[r+2]=e[2];return a}}();a.X1=function(e,b){var p=a.fromValues(e[0],e[1],e[2]),r=a.fromValues(b[0],b[1],b[2]);a.normalize(p,p);a.normalize(r,r);p=a.dot(p,r);return 1<p?0:Math.acos(p)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var h="undefined"!==typeof Float32Array?Float32Array:Array,p=Math.random;a.create=function(){var a=new h(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new h(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,p,r){var A=new h(4);A[0]=a;A[1]=b;A[2]=p;A[3]=r;return A};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,p,r,A){A[0]=a;A[1]=b;A[2]=p;A[3]=r;return A};a.add=function(a,b,p){p[0]=
a[0]+b[0];p[1]=a[1]+b[1];p[2]=a[2]+b[2];p[3]=a[3]+b[3];return p};a.subtract=function(a,b,p){p[0]=a[0]-b[0];p[1]=a[1]-b[1];p[2]=a[2]-b[2];p[3]=a[3]-b[3];return p};a.sub=a.subtract;a.multiply=function(a,b,p){p[0]=a[0]*b[0];p[1]=a[1]*b[1];p[2]=a[2]*b[2];p[3]=a[3]*b[3];return p};a.mul=a.multiply;a.divide=function(a,b,p){p[0]=a[0]/b[0];p[1]=a[1]/b[1];p[2]=a[2]/b[2];p[3]=a[3]/b[3];return p};a.div=a.divide;a.min=function(a,b,p){p[0]=Math.min(a[0],b[0]);p[1]=Math.min(a[1],b[1]);p[2]=Math.min(a[2],b[2]);p[3]=
Math.min(a[3],b[3]);return p};a.max=function(a,b,p){p[0]=Math.max(a[0],b[0]);p[1]=Math.max(a[1],b[1]);p[2]=Math.max(a[2],b[2]);p[3]=Math.max(a[3],b[3]);return p};a.scale=function(a,b,p){p[0]=a[0]*b;p[1]=a[1]*b;p[2]=a[2]*b;p[3]=a[3]*b;return p};a.scaleAndAdd=function(a,b,p,r){r[0]=a[0]+b[0]*p;r[1]=a[1]+b[1]*p;r[2]=a[2]+b[2]*p;r[3]=a[3]+b[3]*p;return r};a.distance=function(a,b){var p=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2],k=b[3]-a[3];return Math.sqrt(p*p+r*r+A*A+k*k)};a.dist=a.distance;a.squaredDistance=
function(a,b){var p=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2],k=b[3]-a[3];return p*p+r*r+A*A+k*k};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],p=a[1],r=a[2];a=a[3];return Math.sqrt(b*b+p*p+r*r+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],p=a[1],r=a[2];a=a[3];return b*b+p*p+r*r+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var p=a[0],r=a[1],A=a[2],k=a[3],w=p*p+r*r+A*A+k*k;0<w&&(w=1/Math.sqrt(w),b[0]=p*w,b[1]=r*w,b[2]=A*w,b[3]=k*w);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,p,r){var A=a[0],k=a[1],w=a[2];a=a[3];r[0]=A+p*(b[0]-A);r[1]=k+p*(b[1]-k);r[2]=w+p*(b[2]-w);r[3]=a+p*(b[3]-a);return r};a.random=function(e,b){e=e||1;b[0]=p();b[1]=p();b[2]=p();b[3]=p();a.normalize(b,b);a.scale(b,e,b);return b};a.transformMat4=function(a,b,p){var r=a[0],A=a[1],k=
a[2];a=a[3];p[0]=b[0]*r+b[4]*A+b[8]*k+b[12]*a;p[1]=b[1]*r+b[5]*A+b[9]*k+b[13]*a;p[2]=b[2]*r+b[6]*A+b[10]*k+b[14]*a;p[3]=b[3]*r+b[7]*A+b[11]*k+b[15]*a;return p};a.transformQuat=function(a,b,p){var r=a[0],A=a[1],k=a[2],w=b[0],n=b[1],l=b[2];b=b[3];var f=b*r+n*k-l*A,v=b*A+l*r-w*k,c=b*k+w*A-n*r,r=-w*r-n*A-l*k;p[0]=f*b+r*-w+v*-l-c*-n;p[1]=v*b+r*-n+c*-w-f*-l;p[2]=c*b+r*-l+f*-n-v*-w;p[3]=a[3];return p};a.forEach=function(){var p=a.create();return function(a,y,r,A,k,w){y||(y=4);r||(r=0);for(A=A?Math.min(A*
y+r,a.length):a.length;r<A;r+=y)p[0]=a[r],p[1]=a[r+1],p[2]=a[r+2],p[3]=a[r+3],k(p,w,p),a[r]=p[0],a[r+1]=p[1],a[r+2]=p[2],a[r+3]=p[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,h){var p=h("__vec3"),e=h("__vec4"),b=h("__mat3"),y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=p.create(),e=p.fromValues(1,0,0),k=p.fromValues(0,1,0);return function(w,n,l){var f=p.dot(w,n);if(-.9999999>f)return p.cross(e,w,b),1E-6>p.length(b)&&p.cross(k,w,b),p.normalize(b,b),a.setAxisAngle(b,Math.PI,l),l;if(.9999999<f)return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l;p.cross(w,
n,b);l[0]=b[0];l[1]=b[1];l[2]=b[2];l[3]=1+f;return a.normalize(l,l)}}();a.setAxes=function(){var p=b.create();return function(b,e,w,n){p[0]=e[0];p[3]=e[1];p[6]=e[2];p[1]=w[0];p[4]=w[1];p[7]=w[2];p[2]=-b[0];p[5]=-b[1];p[8]=-b[2];return a.normalize(a.fromMat3(p,n),n)}}();a.clone=e.clone;a.fromValues=e.fromValues;a.copy=e.copy;a.set=e.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,p){b*=.5;var e=Math.sin(b);p[0]=e*a[0];p[1]=e*a[1];p[2]=e*a[2];p[3]=Math.cos(b);
return p};a.add=e.add;a.multiply=function(a,b,p){var e=a[0],n=a[1],l=a[2];a=a[3];var f=b[0],v=b[1],c=b[2];b=b[3];p[0]=e*b+a*f+n*c-l*v;p[1]=n*b+a*v+l*f-e*c;p[2]=l*b+a*c+e*v-n*f;p[3]=a*b-e*f-n*v-l*c;return p};a.mul=a.multiply;a.scale=e.scale;a.rotateX=function(a,b,p){b*=.5;var e=a[0],n=a[1],l=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);p[0]=e*b+a*f;p[1]=n*b+l*f;p[2]=l*b-n*f;p[3]=a*b-e*f;return p};a.rotateY=function(a,b,p){b*=.5;var e=a[0],n=a[1],l=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);p[0]=e*
b-l*f;p[1]=n*b+a*f;p[2]=l*b+e*f;p[3]=a*b-n*f;return p};a.rotateZ=function(a,b,p){b*=.5;var e=a[0],n=a[1],l=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);p[0]=e*b+n*f;p[1]=n*b-e*f;p[2]=l*b+a*f;p[3]=a*b-l*f;return p};a.calculateW=function(a,b){var p=a[0],e=a[1],n=a[2];b[0]=p;b[1]=e;b[2]=n;b[3]=Math.sqrt(Math.abs(1-p*p-e*e-n*n));return b};a.dot=e.dot;a.lerp=e.lerp;a.slerp=function(a,b,p,e){var n=a[0],l=a[1],f=a[2];a=a[3];var v=b[0],c=b[1],B=b[2];b=b[3];var y,h,G;h=n*v+l*c+f*B+a*b;0>h&&(h=-h,v=-v,c=-c,
B=-B,b=-b);1E-6<1-h?(y=Math.acos(h),G=Math.sin(y),h=Math.sin((1-p)*y)/G,p=Math.sin(p*y)/G):h=1-p;e[0]=h*n+p*v;e[1]=h*l+p*c;e[2]=h*f+p*B;e[3]=h*a+p*b;return e};a.d9=function(){var b=a.create(),p=a.create();return function(e,w,n,l,f,v){a.slerp(e,l,f,b);a.slerp(w,n,f,p);a.slerp(b,p,2*f*(1-f),v);return v}}();a.invert=function(a,b){var p=a[0],e=a[1],n=a[2],l=a[3],f=p*p+e*e+n*n+l*l,f=f?1/f:0;b[0]=-p*f;b[1]=-e*f;b[2]=-n*f;b[3]=l*f;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=e.length;a.len=a.length;a.squaredLength=e.squaredLength;a.sqrLen=a.squaredLength;a.normalize=e.normalize;a.fromMat3=function(a,b){var p=a[0]+a[4]+a[8];if(0<p)p=Math.sqrt(p+1),b[3]=.5*p,p=.5/p,b[0]=(a[5]-a[7])*p,b[1]=(a[6]-a[2])*p,b[2]=(a[1]-a[3])*p;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var n=(e+1)%3,l=(e+2)%3,p=Math.sqrt(a[3*e+e]-a[3*n+n]-a[3*l+l]+1);b[e]=.5*p;p=.5/p;b[3]=(a[3*n+l]-a[3*l+n])*p;b[n]=(a[3*n+e]+a[3*e+n])*p;b[l]=(a[3*l+e]+a[3*e+l])*p}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var h="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new h(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[4];e[4]=a[5];e[5]=a[6];e[6]=a[8];e[7]=a[9];e[8]=a[10];return e};a.clone=function(a){var e=new h(9);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.copy=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=
a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,e){if(e===a){var b=a[1],y=a[2],r=a[5];e[1]=a[3];e[2]=a[6];e[3]=b;e[5]=a[7];e[6]=y;e[7]=r}else e[0]=a[0],e[1]=a[3],e[2]=a[6],e[3]=a[1],e[4]=a[4],e[5]=a[7],e[6]=a[2],e[7]=a[5],e[8]=a[8];return e};a.invert=function(a,e){var b=a[0],y=a[1],r=a[2],h=a[3],k=a[4],w=a[5],n=a[6],l=a[7],f=a[8],v=f*k-w*l,c=-f*h+w*n,B=
l*h-k*n,Q=b*v+y*c+r*B;if(!Q)return null;Q=1/Q;e[0]=v*Q;e[1]=(-f*y+r*l)*Q;e[2]=(w*y-r*k)*Q;e[3]=c*Q;e[4]=(f*b-r*n)*Q;e[5]=(-w*b+r*h)*Q;e[6]=B*Q;e[7]=(-l*b+y*n)*Q;e[8]=(k*b-y*h)*Q;return e};a.adjoint=function(a,e){var b=a[0],y=a[1],r=a[2],h=a[3],k=a[4],w=a[5],n=a[6],l=a[7],f=a[8];e[0]=k*f-w*l;e[1]=r*l-y*f;e[2]=y*w-r*k;e[3]=w*n-h*f;e[4]=b*f-r*n;e[5]=r*h-b*w;e[6]=h*l-k*n;e[7]=y*n-b*l;e[8]=b*k-y*h;return e};a.determinant=function(a){var e=a[3],b=a[4],y=a[5],r=a[6],h=a[7],k=a[8];return a[0]*(k*b-y*h)+a[1]*
(-k*e+y*r)+a[2]*(h*e-b*r)};a.multiply=function(a,e,b){var y=a[0],r=a[1],h=a[2],k=a[3],w=a[4],n=a[5],l=a[6],f=a[7];a=a[8];var v=e[0],c=e[1],B=e[2],Q=e[3],K=e[4],G=e[5],D=e[6],R=e[7];e=e[8];b[0]=v*y+c*k+B*l;b[1]=v*r+c*w+B*f;b[2]=v*h+c*n+B*a;b[3]=Q*y+K*k+G*l;b[4]=Q*r+K*w+G*f;b[5]=Q*h+K*n+G*a;b[6]=D*y+R*k+e*l;b[7]=D*r+R*w+e*f;b[8]=D*h+R*n+e*a;return b};a.mul=a.multiply;a.translate=function(a,e,b){var y=a[0],r=a[1],h=a[2],k=a[3],w=a[4],n=a[5],l=a[6],f=a[7];a=a[8];var v=e[0];e=e[1];b[0]=y;b[1]=r;b[2]=h;
b[3]=k;b[4]=w;b[5]=n;b[6]=v*y+e*k+l;b[7]=v*r+e*w+f;b[8]=v*h+e*n+a;return b};a.rotate=function(a,e,b){var y=a[0],r=a[1],h=a[2],k=a[3],w=a[4],n=a[5],l=a[6],f=a[7];a=a[8];var v=Math.sin(e);e=Math.cos(e);b[0]=e*y+v*k;b[1]=e*r+v*w;b[2]=e*h+v*n;b[3]=e*k-v*y;b[4]=e*w-v*r;b[5]=e*n-v*h;b[6]=l;b[7]=f;b[8]=a;return b};a.scale=function(a,e,b){var y=e[0];e=e[1];b[0]=y*a[0];b[1]=y*a[1];b[2]=y*a[2];b[3]=e*a[3];b[4]=e*a[4];b[5]=e*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.wU=function(a,e){e[0]=1;e[1]=0;e[2]=
0;e[3]=0;e[4]=1;e[5]=0;e[6]=a[0];e[7]=a[1];e[8]=1;return e};a.uU=function(a,e){var b=Math.sin(a),y=Math.cos(a);e[0]=y;e[1]=b;e[2]=0;e[3]=-b;e[4]=y;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e};a.vU=function(a,e){e[0]=a[0];e[1]=0;e[2]=0;e[3]=0;e[4]=a[1];e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e};a.fromMat2d=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=0;e[3]=a[2];e[4]=a[3];e[5]=0;e[6]=a[4];e[7]=a[5];e[8]=1;return e};a.fromQuat=function(a,e){var b=a[0],y=a[1],r=a[2],h=a[3],k=b+b,w=y+y,n=r+r,b=b*k,l=y*k,y=y*w,f=r*k,v=
r*w,r=r*n,k=h*k,w=h*w,h=h*n;e[0]=1-y-r;e[3]=l-h;e[6]=f+w;e[1]=l+h;e[4]=1-b-r;e[7]=v-k;e[2]=f-w;e[5]=v+k;e[8]=1-b-y;return e};a.normalFromMat4=function(a,e){var b=a[0],y=a[1],r=a[2],h=a[3],k=a[4],w=a[5],n=a[6],l=a[7],f=a[8],v=a[9],c=a[10],B=a[11],Q=a[12],K=a[13],G=a[14],D=a[15],R=b*w-y*k,L=b*n-r*k,I=b*l-h*k,z=y*n-r*w,d=y*l-h*w,m=r*l-h*n,O=f*K-v*Q,x=f*G-c*Q,f=f*D-B*Q,g=v*G-c*K,v=v*D-B*K,c=c*D-B*G,B=R*c-L*v+I*g+z*f-d*x+m*O;if(!B)return null;B=1/B;e[0]=(w*c-n*v+l*g)*B;e[1]=(n*f-k*c-l*x)*B;e[2]=(k*v-w*
f+l*O)*B;e[3]=(r*v-y*c-h*g)*B;e[4]=(b*c-r*f+h*x)*B;e[5]=(y*f-b*v-h*O)*B;e[6]=(K*m-G*d+D*z)*B;e[7]=(G*I-Q*m-D*L)*B;e[8]=(Q*d-K*I+D*R)*B;return e};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.tU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var h="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new h(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var e=new h(16);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.copy=function(a,e){e[0]=a[0];
e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,e){if(e===a){var b=a[1],y=a[2],r=a[3],h=a[6],k=a[7],w=a[11];e[1]=a[4];e[2]=a[8];e[3]=a[12];e[4]=b;e[6]=a[9];e[7]=a[13];e[8]=y;e[9]=h;e[11]=a[14];e[12]=r;e[13]=
k;e[14]=w}else e[0]=a[0],e[1]=a[4],e[2]=a[8],e[3]=a[12],e[4]=a[1],e[5]=a[5],e[6]=a[9],e[7]=a[13],e[8]=a[2],e[9]=a[6],e[10]=a[10],e[11]=a[14],e[12]=a[3],e[13]=a[7],e[14]=a[11],e[15]=a[15];return e};a.invert=function(a,e){var b=a[0],y=a[1],r=a[2],h=a[3],k=a[4],w=a[5],n=a[6],l=a[7],f=a[8],v=a[9],c=a[10],B=a[11],Q=a[12],K=a[13],G=a[14],D=a[15],R=b*w-y*k,L=b*n-r*k,I=b*l-h*k,z=y*n-r*w,d=y*l-h*w,m=r*l-h*n,O=f*K-v*Q,x=f*G-c*Q,g=f*D-B*Q,P=v*G-c*K,t=v*D-B*K,da=c*D-B*G,J=R*da-L*t+I*P+z*g-d*x+m*O;if(!J)return null;
J=1/J;e[0]=(w*da-n*t+l*P)*J;e[1]=(r*t-y*da-h*P)*J;e[2]=(K*m-G*d+D*z)*J;e[3]=(c*d-v*m-B*z)*J;e[4]=(n*g-k*da-l*x)*J;e[5]=(b*da-r*g+h*x)*J;e[6]=(G*I-Q*m-D*L)*J;e[7]=(f*m-c*I+B*L)*J;e[8]=(k*t-w*g+l*O)*J;e[9]=(y*g-b*t-h*O)*J;e[10]=(Q*d-K*I+D*R)*J;e[11]=(v*I-f*d-B*R)*J;e[12]=(w*x-k*P-n*O)*J;e[13]=(b*P-y*x+r*O)*J;e[14]=(K*L-Q*z-G*R)*J;e[15]=(f*z-v*L+c*R)*J;return e};a.adjoint=function(a,e){var b=a[0],y=a[1],r=a[2],h=a[3],k=a[4],w=a[5],n=a[6],l=a[7],f=a[8],v=a[9],c=a[10],B=a[11],Q=a[12],K=a[13],G=a[14],D=
a[15];e[0]=w*(c*D-B*G)-v*(n*D-l*G)+K*(n*B-l*c);e[1]=-(y*(c*D-B*G)-v*(r*D-h*G)+K*(r*B-h*c));e[2]=y*(n*D-l*G)-w*(r*D-h*G)+K*(r*l-h*n);e[3]=-(y*(n*B-l*c)-w*(r*B-h*c)+v*(r*l-h*n));e[4]=-(k*(c*D-B*G)-f*(n*D-l*G)+Q*(n*B-l*c));e[5]=b*(c*D-B*G)-f*(r*D-h*G)+Q*(r*B-h*c);e[6]=-(b*(n*D-l*G)-k*(r*D-h*G)+Q*(r*l-h*n));e[7]=b*(n*B-l*c)-k*(r*B-h*c)+f*(r*l-h*n);e[8]=k*(v*D-B*K)-f*(w*D-l*K)+Q*(w*B-l*v);e[9]=-(b*(v*D-B*K)-f*(y*D-h*K)+Q*(y*B-h*v));e[10]=b*(w*D-l*K)-k*(y*D-h*K)+Q*(y*l-h*w);e[11]=-(b*(w*B-l*v)-k*(y*B-h*
v)+f*(y*l-h*w));e[12]=-(k*(v*G-c*K)-f*(w*G-n*K)+Q*(w*c-n*v));e[13]=b*(v*G-c*K)-f*(y*G-r*K)+Q*(y*c-r*v);e[14]=-(b*(w*G-n*K)-k*(y*G-r*K)+Q*(y*n-r*w));e[15]=b*(w*c-n*v)-k*(y*c-r*v)+f*(y*n-r*w);return e};a.determinant=function(a){var e=a[0],b=a[1],y=a[2],r=a[3],h=a[4],k=a[5],w=a[6],n=a[7],l=a[8],f=a[9],v=a[10],c=a[11],B=a[12],Q=a[13],K=a[14];a=a[15];return(e*k-b*h)*(v*a-c*K)-(e*w-y*h)*(f*a-c*Q)+(e*n-r*h)*(f*K-v*Q)+(b*w-y*k)*(l*a-c*B)-(b*n-r*k)*(l*K-v*B)+(y*n-r*w)*(l*Q-f*B)};a.multiply=function(a,e,b){var y=
a[0],r=a[1],h=a[2],k=a[3],w=a[4],n=a[5],l=a[6],f=a[7],v=a[8],c=a[9],B=a[10],Q=a[11],K=a[12],G=a[13],D=a[14];a=a[15];var R=e[0],L=e[1],I=e[2],z=e[3];b[0]=R*y+L*w+I*v+z*K;b[1]=R*r+L*n+I*c+z*G;b[2]=R*h+L*l+I*B+z*D;b[3]=R*k+L*f+I*Q+z*a;R=e[4];L=e[5];I=e[6];z=e[7];b[4]=R*y+L*w+I*v+z*K;b[5]=R*r+L*n+I*c+z*G;b[6]=R*h+L*l+I*B+z*D;b[7]=R*k+L*f+I*Q+z*a;R=e[8];L=e[9];I=e[10];z=e[11];b[8]=R*y+L*w+I*v+z*K;b[9]=R*r+L*n+I*c+z*G;b[10]=R*h+L*l+I*B+z*D;b[11]=R*k+L*f+I*Q+z*a;R=e[12];L=e[13];I=e[14];z=e[15];b[12]=R*y+
L*w+I*v+z*K;b[13]=R*r+L*n+I*c+z*G;b[14]=R*h+L*l+I*B+z*D;b[15]=R*k+L*f+I*Q+z*a;return b};a.mul=a.multiply;a.translate=function(a,e,b){var h=e[0],r=e[1];e=e[2];var A,k,w,n,l,f,v,c,B,Q,K,G;a===b?(b[12]=a[0]*h+a[4]*r+a[8]*e+a[12],b[13]=a[1]*h+a[5]*r+a[9]*e+a[13],b[14]=a[2]*h+a[6]*r+a[10]*e+a[14],b[15]=a[3]*h+a[7]*r+a[11]*e+a[15]):(A=a[0],k=a[1],w=a[2],n=a[3],l=a[4],f=a[5],v=a[6],c=a[7],B=a[8],Q=a[9],K=a[10],G=a[11],b[0]=A,b[1]=k,b[2]=w,b[3]=n,b[4]=l,b[5]=f,b[6]=v,b[7]=c,b[8]=B,b[9]=Q,b[10]=K,b[11]=G,
b[12]=A*h+l*r+B*e+a[12],b[13]=k*h+f*r+Q*e+a[13],b[14]=w*h+v*r+K*e+a[14],b[15]=n*h+c*r+G*e+a[15]);return b};a.scale=function(a,e,b){var h=e[0],r=e[1];e=e[2];b[0]=a[0]*h;b[1]=a[1]*h;b[2]=a[2]*h;b[3]=a[3]*h;b[4]=a[4]*r;b[5]=a[5]*r;b[6]=a[6]*r;b[7]=a[7]*r;b[8]=a[8]*e;b[9]=a[9]*e;b[10]=a[10]*e;b[11]=a[11]*e;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,e,b,h){var r=b[0],A=b[1];b=b[2];var k=Math.sqrt(r*r+A*A+b*b),w,n,l,f,v,c,B,Q,K,G,D,R,L,I,z,d,m,O,x,g;if(1E-7>Math.abs(k))return null;
k=1/k;r*=k;A*=k;b*=k;w=Math.sin(e);n=Math.cos(e);l=1-n;e=a[0];k=a[1];f=a[2];v=a[3];c=a[4];B=a[5];Q=a[6];K=a[7];G=a[8];D=a[9];R=a[10];L=a[11];I=r*r*l+n;z=A*r*l+b*w;d=b*r*l-A*w;m=r*A*l-b*w;O=A*A*l+n;x=b*A*l+r*w;g=r*b*l+A*w;r=A*b*l-r*w;A=b*b*l+n;h[0]=e*I+c*z+G*d;h[1]=k*I+B*z+D*d;h[2]=f*I+Q*z+R*d;h[3]=v*I+K*z+L*d;h[4]=e*m+c*O+G*x;h[5]=k*m+B*O+D*x;h[6]=f*m+Q*O+R*x;h[7]=v*m+K*O+L*x;h[8]=e*g+c*r+G*A;h[9]=k*g+B*r+D*A;h[10]=f*g+Q*r+R*A;h[11]=v*g+K*r+L*A;a!==h&&(h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]);
return h};a.rotateX=function(a,e,b){var h=Math.sin(e);e=Math.cos(e);var r=a[4],A=a[5],k=a[6],w=a[7],n=a[8],l=a[9],f=a[10],v=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=r*e+n*h;b[5]=A*e+l*h;b[6]=k*e+f*h;b[7]=w*e+v*h;b[8]=n*e-r*h;b[9]=l*e-A*h;b[10]=f*e-k*h;b[11]=v*e-w*h;return b};a.rotateY=function(a,e,b){var h=Math.sin(e);e=Math.cos(e);var r=a[0],A=a[1],k=a[2],w=a[3],n=a[8],l=a[9],f=a[10],v=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=r*e-n*h;b[1]=A*e-l*h;b[2]=k*e-f*h;b[3]=w*e-v*h;b[8]=r*h+n*e;b[9]=A*h+l*e;b[10]=k*h+f*e;b[11]=w*h+v*e;return b};a.rotateZ=function(a,e,b){var h=Math.sin(e);e=Math.cos(e);var r=a[0],A=a[1],k=a[2],w=a[3],n=a[4],l=a[5],f=a[6],v=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=r*e+n*h;b[1]=A*e+l*h;b[2]=k*e+f*h;b[3]=w*e+v*h;b[4]=n*e-r*h;b[5]=l*e-A*h;b[6]=f*e-k*h;b[7]=v*e-w*h;return b};
a.wU=function(a,e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=a[0];e[13]=a[1];e[14]=a[2];e[15]=1;return e};a.vU=function(a,e){e[0]=a[0];e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a[1];e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=a[2];e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.uU=function(a,e,b){var h=e[0],r=e[1];e=e[2];var A=Math.sqrt(h*h+r*r+e*e),k;if(1E-7>Math.abs(A))return null;A=1/A;h*=A;r*=A;e*=A;A=Math.sin(a);a=Math.cos(a);k=1-a;b[0]=h*h*k+a;b[1]=r*h*k+e*
A;b[2]=e*h*k-r*A;b[3]=0;b[4]=h*r*k-e*A;b[5]=r*r*k+a;b[6]=e*r*k+h*A;b[7]=0;b[8]=h*e*k+r*A;b[9]=r*e*k-h*A;b[10]=e*e*k+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.f4=function(a,e){var b=Math.sin(a),h=Math.cos(a);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=h;e[6]=b;e[7]=0;e[8]=0;e[9]=-b;e[10]=h;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.g4=function(a,e){var b=Math.sin(a),h=Math.cos(a);e[0]=h;e[1]=0;e[2]=-b;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=b;e[9]=0;e[10]=h;e[11]=0;e[12]=0;e[13]=0;
e[14]=0;e[15]=1;return e};a.h4=function(a,e){var b=Math.sin(a),h=Math.cos(a);e[0]=h;e[1]=b;e[2]=0;e[3]=0;e[4]=-b;e[5]=h;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.fromRotationTranslation=function(a,e,b){var h=a[0],r=a[1],A=a[2],k=a[3],w=h+h,n=r+r,l=A+A;a=h*w;var f=h*n,h=h*l,v=r*n,r=r*l,A=A*l,w=k*w,n=k*n,k=k*l;b[0]=1-(v+A);b[1]=f+k;b[2]=h-n;b[3]=0;b[4]=f-k;b[5]=1-(a+A);b[6]=r+w;b[7]=0;b[8]=h+n;b[9]=r-w;b[10]=1-(a+v);b[11]=0;b[12]=e[0];b[13]=e[1];b[14]=e[2];
b[15]=1;return b};a.d4=function(a,e,b,h){var r=a[0],A=a[1],k=a[2],w=a[3],n=r+r,l=A+A,f=k+k;a=r*n;var v=r*l,r=r*f,c=A*l,A=A*f,k=k*f,n=w*n,l=w*l,w=w*f,f=b[0],B=b[1];b=b[2];h[0]=(1-(c+k))*f;h[1]=(v+w)*f;h[2]=(r-l)*f;h[3]=0;h[4]=(v-w)*B;h[5]=(1-(a+k))*B;h[6]=(A+n)*B;h[7]=0;h[8]=(r+l)*b;h[9]=(A-n)*b;h[10]=(1-(a+c))*b;h[11]=0;h[12]=e[0];h[13]=e[1];h[14]=e[2];h[15]=1;return h};a.e4=function(a,e,b,h,r){var A=a[0],k=a[1],w=a[2],n=a[3],l=A+A,f=k+k,v=w+w;a=A*l;var c=A*f,A=A*v,B=k*f,k=k*v,w=w*v,l=n*l,f=n*f,n=
n*v,v=b[0],Q=b[1];b=b[2];var K=h[0],G=h[1];h=h[2];r[0]=(1-(B+w))*v;r[1]=(c+n)*v;r[2]=(A-f)*v;r[3]=0;r[4]=(c-n)*Q;r[5]=(1-(a+w))*Q;r[6]=(k+l)*Q;r[7]=0;r[8]=(A+f)*b;r[9]=(k-l)*b;r[10]=(1-(a+B))*b;r[11]=0;r[12]=e[0]+K-(r[0]*K+r[4]*G+r[8]*h);r[13]=e[1]+G-(r[1]*K+r[5]*G+r[9]*h);r[14]=e[2]+h-(r[2]*K+r[6]*G+r[10]*h);r[15]=1;return r};a.fromQuat=function(a,e){var b=a[0],h=a[1],r=a[2],A=a[3],k=b+b,w=h+h,n=r+r,b=b*k,l=h*k,h=h*w,f=r*k,v=r*w,r=r*n,k=A*k,w=A*w,A=A*n;e[0]=1-h-r;e[1]=l+A;e[2]=f-w;e[3]=0;e[4]=l-
A;e[5]=1-b-r;e[6]=v+k;e[7]=0;e[8]=f+w;e[9]=v-k;e[10]=1-b-h;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.frustum=function(a,e,b,h,r,A,k){var w=1/(e-a),n=1/(h-b),l=1/(r-A);k[0]=2*r*w;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=2*r*n;k[6]=0;k[7]=0;k[8]=(e+a)*w;k[9]=(h+b)*n;k[10]=(A+r)*l;k[11]=-1;k[12]=0;k[13]=0;k[14]=A*r*2*l;k[15]=0;return k};a.perspective=function(a,e,b,h,r){a=1/Math.tan(a/2);var A=1/(b-h);r[0]=a/e;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=a;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=(h+b)*A;r[11]=-1;r[12]=
0;r[13]=0;r[14]=2*h*b*A;r[15]=0;return r};a.t7=function(a,e,b,h){var r=Math.tan(a.upDegrees*Math.PI/180),A=Math.tan(a.downDegrees*Math.PI/180),k=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var w=2/(k+a),n=2/(r+A);h[0]=w;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=n;h[6]=0;h[7]=0;h[8]=-((k-a)*w*.5);h[9]=(r-A)*n*.5;h[10]=b/(e-b);h[11]=-1;h[12]=0;h[13]=0;h[14]=b*e/(e-b);h[15]=0;return h};a.ortho=function(a,e,b,h,r,A,k){var w=1/(a-e),n=1/(b-h),l=1/(r-A);k[0]=-2*w;k[1]=0;k[2]=0;k[3]=
0;k[4]=0;k[5]=-2*n;k[6]=0;k[7]=0;k[8]=0;k[9]=0;k[10]=2*l;k[11]=0;k[12]=(a+e)*w;k[13]=(h+b)*n;k[14]=(A+r)*l;k[15]=1;return k};a.lookAt=function(p,e,b,h){var r,A,k,w,n,l,f,v,c=p[0],B=p[1];p=p[2];k=b[0];w=b[1];A=b[2];f=e[0];b=e[1];r=e[2];if(1E-7>Math.abs(c-f)&&1E-7>Math.abs(B-b)&&1E-7>Math.abs(p-r))return a.identity(h);e=c-f;b=B-b;f=p-r;v=1/Math.sqrt(e*e+b*b+f*f);e*=v;b*=v;f*=v;r=w*f-A*b;A=A*e-k*f;k=k*b-w*e;(v=Math.sqrt(r*r+A*A+k*k))?(v=1/v,r*=v,A*=v,k*=v):k=A=r=0;w=b*k-f*A;n=f*r-e*k;l=e*A-b*r;(v=Math.sqrt(w*
w+n*n+l*l))?(v=1/v,w*=v,n*=v,l*=v):l=n=w=0;h[0]=r;h[1]=w;h[2]=e;h[3]=0;h[4]=A;h[5]=n;h[6]=b;h[7]=0;h[8]=k;h[9]=l;h[10]=f;h[11]=0;h[12]=-(r*c+A*B+k*p);h[13]=-(w*c+n*B+l*p);h[14]=-(e*c+b*B+f*p);h[15]=1;return h};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.tU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__util=function(a,h){function p(a){return 0<a?1:0>a?-1:0}function e(a,b,c){var g=a[0],d=a[1];a=a[2];var H=Math.cos(g/2),V=Math.cos(d/2),Y=Math.cos(a/2),q=Math.sin(g/2),d=Math.sin(d/2),C=Math.sin(a/2);if(-1<T.indexOf(b))var f=Math.cos((g+a)/2),e=Math.sin((g+a)/2),t=Math.cos((g-a)/2),u=Math.sin((g-a)/2),m=Math.cos((a-g)/2),l=Math.sin((a-g)/2);switch(b){case ua:c[0]=V*e;c[1]=d*t;c[2]=d*u;c[3]=V*f;break;case ja:c[0]=d*u;c[1]=V*e;c[2]=d*t;c[3]=V*f;break;case xa:c[0]=d*t;c[1]=d*u;c[2]=V*e;c[3]=
V*f;break;case 3:c[0]=V*e;c[1]=d*l;c[2]=d*m;c[3]=V*f;break;case ka:c[0]=d*m;c[1]=V*e;c[2]=d*l;c[3]=V*f;break;case Pa:c[0]=d*l;c[1]=d*m;c[2]=V*e;c[3]=V*f;break;case 6:c[0]=q*V*Y+H*d*C;c[1]=H*d*Y-q*V*C;c[2]=H*V*C+q*d*Y;c[3]=H*V*Y-q*d*C;break;case 7:c[0]=H*V*C+q*d*Y;c[1]=q*V*Y+H*d*C;c[2]=H*d*Y-q*V*C;c[3]=H*V*Y-q*d*C;break;case 8:c[0]=H*d*Y-q*V*C;c[1]=H*V*C+q*d*Y;c[2]=q*V*Y+H*d*C;c[3]=H*V*Y-q*d*C;break;case 9:c[0]=q*V*Y-H*d*C;c[1]=H*V*C-q*d*Y;c[2]=H*d*Y+q*V*C;c[3]=H*V*Y+q*d*C;break;case 10:c[0]=H*d*Y+
q*V*C;c[1]=q*V*Y-H*d*C;c[2]=H*V*C-q*d*Y;c[3]=H*V*Y+q*d*C;break;case 11:c[0]=H*V*C-q*d*Y,c[1]=H*d*Y+q*V*C,c[2]=q*V*Y-H*d*C,c[3]=H*V*Y+q*d*C}return c}function b(a,b,c){var d=a[0],g=a[1],H=a[2];a=a[3];switch(b){case ua:c[0]=Math.atan2(d*g+H*a,g*a-d*H);c[1]=Math.acos(1-2*(g*g+H*H));c[2]=Math.atan2(d*g-H*a,d*H+g*a);break;case ja:c[0]=Math.atan2(d*a+g*H,H*a-d*g);c[1]=Math.acos(1-2*(d*d+H*H));c[2]=Math.atan2(g*H-d*a,d*g+H*a);break;case xa:c[0]=Math.atan2(d*H+g*a,d*a-g*H);c[1]=Math.acos(1-2*(d*d+g*g));c[2]=
Math.atan2(d*H-g*a,d*a+g*H);break;case 3:c[0]=Math.atan2(d*H-g*a,d*g+H*a);c[1]=Math.acos(1-2*(g*g+H*H));c[2]=Math.atan2(d*H+g*a,H*a-d*g);break;case ka:c[0]=Math.atan2(d*g-H*a,d*a+g*H);c[1]=Math.acos(1-2*(d*d+H*H));c[2]=Math.atan2(d*g+H*a,d*a-g*H);break;case Pa:c[0]=Math.atan2(g*H-d*a,d*H+g*a);c[1]=Math.acos(1-2*(d*d+g*g));c[2]=Math.atan2(d*a+g*H,g*a-d*H);break;case 6:c[0]=Math.atan2(2*(d*a-g*H),1-2*(d*d+g*g));c[1]=Math.asin(2*(d*H+g*a));c[2]=Math.atan2(2*(H*a-d*g),1-2*(g*g+H*H));break;case 7:b=d*
g+H*a;.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=2*Math.atan2(d,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=-2*Math.atan2(d,a)):(c[0]=Math.atan2(2*(g*a-d*H),1-2*(g*g+H*H)),c[1]=Math.asin(2*(d*g+H*a)),c[2]=Math.atan2(2*(d*a-g*H),1-2*(d*d+H*H)));break;case 8:c[0]=Math.atan2(2*(H*a-d*g),1-2*(d*d+H*H));c[1]=Math.asin(2*(d*a+g*H));c[2]=Math.atan2(2*(g*a-d*H),1-2*(d*d+g*g));break;case 9:c[0]=Math.atan2(2*(d*a+g*H),1-2*(d*d+H*H));c[1]=Math.asin(2*(H*a-d*g));c[2]=Math.atan2(2*(d*H+g*a),1-2*(g*g+H*H));break;case 10:c[0]=
Math.atan2(2*(d*H+g*a),1-2*(d*d+g*g));c[1]=Math.asin(2*(d*a-g*H));c[2]=Math.atan2(2*(d*g+H*a),1-2*(d*d+H*H));break;case 11:b=g*a-d*H,.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=-2*Math.atan2(H,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=2*Math.atan2(H,a)):(c[0]=Math.atan2(2*(d*g+H*a),1-2*(g*g+H*H)),c[1]=Math.asin(2*(g*a-d*H)),c[2]=Math.atan2(2*(d*a+g*H),1-2*(d*d+g*g)))}return c}function y(a,b,c){var d=b.length,g=N;g[0]=a[0];g[1]=a[1];g[2]=a[2];t.normalize(g,g);d?(a=S,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=
b[3],b=t.cross(a,g,ga),t.normalize(b,b),t.cross(g,b,a),d=X,d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=g[0],d[4]=g[1],d[5]=g[2],d[6]=b[0],d[7]=b[1],d[8]=b[2],P.fromMat3(d,c),c[3]=0<c[3]?c[3]+3.1E-5:c[3]-3.1E-5,(0<c[3]&&0>a[3]||0>c[3]&&0<a[3])&&P.scale(c,-1,c),P.normalize(c,c)):P.rotationTo(na,g,c);return c}function r(a,b){b||(b=new Float32Array(4));d.fromMat4(a,X);var c=X[0],g=X[3],q=X[6],H=X[1],V=X[4],Y=X[7],C=X[2],f=X[5],e=X[8],c=Math.sqrt(c*c+g*g+q*q)||1,H=Math.sqrt(H*H+V*V+Y*Y)||1,C=Math.sqrt(C*C+f*f+
e*e)||1;X[0]/=c;X[3]/=c;X[6]/=c;X[1]/=H;X[4]/=H;X[7]/=H;X[2]/=C;X[5]/=C;X[8]/=C;P.fromMat3(X,b);P.normalize(b,b);return b}function A(a){var b=a[0],c=a[1],d=a[2],g=a[3],H=Math.sqrt(b*b+c*c+d*d),H=1/H;a[0]=b*H;a[1]=c*H;a[2]=d*H;a[3]=g*H}function k(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=k(a[d],c);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(d=
0;d<a.length;d++)c=w(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=k(a[d],c);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:c=w(0,c);break;default:K("Wrong object constructor")}else c=w(0,c);return c;case "number":return w(a,c);case "boolean":return w(a|0,c);case "string":return n(a,c);case "function":case "undefined":return w(0,c)}}function w(a,b){var c=b;aa[0]=a;c=(c<<5)-c+oa[0];c&=c;c=(c<<5)-c+oa[1];return c&c}function n(a,
b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function l(a){return(34*a+1)*a%289}function f(a){return a-Math.floor(a)}function v(a){return c((34*a+5)*a)}function c(a){return a-289*Math.floor(a/289)}function B(a){return a-7*Math.floor(a/7)}function Q(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function K(a){a&&x.error.apply(x,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function G(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function D(a){return G(a,0,2*Math.PI)}function R(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!L(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var g in a)if(!L(a[g],b[g]))return!1;for(g in b)if(!(g in a))return!1}return!0}return!(a||b)}function L(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return R(a,b);default:return!0}}function I(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var g=a[d];""!=g&&"."!=g&&(".."!=g||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(g):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function z(){var a=[{}];a.length=0;return a}var d=h("__mat3"),m=h("__mat4"),O=h("__math"),x=h("__print"),g=h("__tsr"),P=h("__quat"),t=h("__vec3"),da=h("__vec4"),J=0,F={},T=[ua,ja,xa,ka,Pa],N=new Float32Array(3),ba=new Float32Array(3),u=new Float32Array(3),ga=new Float32Array(3),Z=new Float32Array(3),E=new Float32Array(3),ca=new Float32Array(3),ha=new Float32Array(3),q=new Float32Array(4),S=new Float32Array(4),X=new Float32Array(9),
U=new Float32Array(16),sa=new Float32Array(16),pa=P.create(),aa=new Float64Array(1),oa=new Uint32Array(aa.buffer),ya=new Float32Array([0,0,0]),wa=new Float32Array([0,0,0,1]),la=new Float32Array([0,0,0,1,0,0,0,1]),ia=new Float32Array([1,1,1]),ta=new Float32Array([1,0,0]),na=new Float32Array([0,1,0]),M=new Float32Array([0,0,1]),ea=new Float32Array([-1,0,0]),C=new Float32Array([0,-1,0]),za=new Float32Array([0,0,-1]),ua=0,ja=1,xa=2,ka=4,Pa=5,Ea=Math.floor(44488.07041494893),Ca=[new Float32Array([0,0,
-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.jF=ya;a.rn=wa;a.N1=la;a.hz=ia;a.ti=ta;a.xh=na;a.nc=M;a.Wx=ea;a.wh=C;a.Nc=za;a.kF=ua;a.rF=ja;a.sF=xa;a.mF=3;a.oF=ka;a.uF=Pa;a.lF=6;a.qF=7;a.iz=8;a.nF=9;a.pF=10;a.tF=11;a.$N=Ca;a.Xx=1;a.Np=2;a.Aj=4;a.DE=
4;a.Wh=function(a){return"undefined"!=typeof a};a.PJ=function(a,b,c){for(var d=[],g=c.length,H=0;H<g;H++){var V=c[H];V[a]==b&&d.push(V)}return d};a.Ef=function(a){return new Float32Array(a)};a.nU=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.RZ=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.MR=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.KQ=function(a,b){var c=
[],d={},g=b.length,H,V;for(H=0;H<g;H++)d[b[H]]=!0;g=a.length;for(H=0;H<g;H++)V=a[H],V in d&&c.push(V);return c};a.sign=p;a.P6=function(a,b,c){for(var d=c.length,g=0;g<d;g++)if(c[g][a]==b)return!0;return!1};a.Dd=function(a,b,c){for(var d=0;d<c.length;d++){var g=c[d];if(g[a]===b)return g}return null};a.N6=function(a,b,c,d,g){for(var H=0;H<g.length;H++){var V=g[H];if(V[a]==b&&V[c]==d)return V}return null};a.gV=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.EQ=function(a,
b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.X2=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.IZ=function(a,b,c,d){d||(d=new Float32Array(16));m.identity(d);d[12]=a;d[13]=b;d[14]=c};var ma=1;a.CX=function(){ma=(69069*ma+5)%Math.pow(2,32);return Math.round(ma/65536)%32768/32767};a.nZ=function(a){ma=a};a.tg=function(a){var b=a[0]%Ea*48271-3399*Math.floor(a[0]/Ea);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.Ev=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.Wj=function(a,b){var c=N;c[0]=a[2];c[1]=a[1];c[2]=a[0];e(c,11,b);return b};a.qC=e;a.TK=b;a.UT=function(a){var b=d.create(),c=Math.cos(a[0]),g=Math.cos(a[1]),q=Math.cos(a[2]),H=Math.sin(a[0]),V=Math.sin(a[1]);a=Math.sin(a[2]);var Y=c*q,C=c*a,f=H*q,e=H*a;b[0]=g*q;b[1]=g*a;b[2]=-V;b[3]=V*f-C;b[4]=V*e+Y;b[5]=g*H;b[6]=V*Y+e;b[7]=V*C-f;b[8]=g*c;return b};a.Fw=function(a,c){var d=b(a,11,N);c[0]=d[2];c[1]=d[1];c[2]=d[0];return c};a.lc=function(a,b,c){c||(c=
new Float32Array(3));t.transformQuat(b,a,c);return c};a.EA=function(a,b,c){c||(c=new Float32Array(4));a=t.normalize(a,N);var d=t.dot(b,a);a=t.cross(b,a,u);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.JZ=function(a,b,c,d){d||(d=new Float32Array(4));t.transformQuat(c,b,d);d[3]=-t.dot(a,d)};a.CT=function(a){var b=g.P(a.k.n),c=N;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;t.transformQuat(c,b,c);u[0]=0;u[1]=0;u[2]=-1;break;
case "MESH":c[0]=0;c[1]=0;c[2]=1;t.transformQuat(c,b,c);u[0]=0;u[1]=0;u[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,t.transformQuat(c,b,c),u[0]=0,u[1]=1,u[2]=0}c[1]=0;t.normalize(c,c);a=t.dot(c,u);return Math.acos(a)*(0<-c[0]*u[2]?-1:1)};a.gG=function(a,b,c,d){if(0!=c){d=d||[];for(var g=0;g<a.length;g++)d[g]=(1-c)*a[g]+c*b[g]}};a.SZ=function(){J++;return J.toString(10)};a.Qs=function(a){F[a]||(F[a]=0);var b=a+F[a];F[a]++;return b};a.Mg=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.or=function(a,b,c){b=b||z();var d=b.length,g=a.length/3;c=c||new Float32Array(4*g);for(var H=0;H<g;++H){var V=N;V[0]=a[3*H];V[1]=a[3*H+1];V[2]=a[3*H+2];var Y;d?(Y=S,Y[0]=b[4*H],Y[1]=b[4*H+1],Y[2]=b[4*H+2],Y[3]=b[4*H+3]):Y=b;y(V,Y,c.subarray(4*H,4*(H+1)))}return c};a.YI=y;a.Ih=function(a){return JSON.parse(JSON.stringify(a))};a.S=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=
new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.S(b[d]);break;default:for(d in c=new c,b)c[d]=a.S(b[d])}return c};a.yq=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.VB=
r;a.cK=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.bK=function(a){q[0]=.577350269189626;q[1]=.577350269189626;q[2]=.577350269189626;q[3]=0;da.transformMat4(q,a,q);return da.length(q)};a.On=function(a,b){var c=b.left,d=b.right,g=b.top,H=b.bottom,V=b.near,Y=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-a[4];d[2]=a[11]-a[8];d[3]=a[15]-a[12];g[0]=a[3]-a[1];g[1]=a[7]-a[5];g[2]=a[11]-a[9];g[3]=a[15]-a[13];H[0]=a[3]+
a[1];H[1]=a[7]+a[5];H[2]=a[11]+a[9];H[3]=a[15]+a[13];V[0]=a[3]+a[2];V[1]=a[7]+a[6];V[2]=a[11]+a[10];V[3]=a[15]+a[14];Y[0]=a[3]-a[2];Y[1]=a[7]-a[6];Y[2]=a[11]-a[10];Y[3]=a[15]-a[14];A(c);A(d);A(g);A(H);A(V);A(Y)};a.iZ=function(a,b,c){return c<-O.sg(a,b.near)||c<-O.sg(a,b.left)||c<-O.sg(a,b.right)||c<-O.sg(a,b.top)||c<-O.sg(a,b.bottom)||c<-O.sg(a,b.far)?!0:!1};a.MT=function(a,b,c,d,g){var H=t.dot(c,b.far),V=t.dot(d,b.far),Y=t.dot(g,b.far),H=Math.sqrt(H*H+V*V+Y*Y);if(H<-O.sg(a,b.near)||H<-O.sg(a,b.far))return!0;
H=t.dot(c,b.left);V=t.dot(d,b.left);Y=t.dot(g,b.left);if(Math.sqrt(H*H+V*V+Y*Y)<-O.sg(a,b.left))return!0;H=t.dot(c,b.right);V=t.dot(d,b.right);Y=t.dot(g,b.right);if(Math.sqrt(H*H+V*V+Y*Y)<-O.sg(a,b.right))return!0;H=t.dot(c,b.top);V=t.dot(d,b.top);Y=t.dot(g,b.top);if(Math.sqrt(H*H+V*V+Y*Y)<-O.sg(a,b.top))return!0;H=t.dot(c,b.bottom);V=t.dot(d,b.bottom);Y=t.dot(g,b.bottom);return Math.sqrt(H*H+V*V+Y*Y)<-O.sg(a,b.bottom)?!0:!1};a.xo=function(a,b,c,d){d||(d=0);for(var g=a.length,H=0;H<g;H+=3){var V=
a[H],Y=a[H+1],q=a[H+2];c[d+H]=b[0]*V+b[4]*Y+b[8]*q+b[12];c[d+H+1]=b[1]*V+b[5]*Y+b[9]*q+b[13];c[d+H+2]=b[2]*V+b[6]*Y+b[10]*q+b[14]}};a.O9=function(a,b,c,d){d||(d=0);for(var g=a.length,H=0;H<g;H+=3){var V=a[H],Y=a[H+1],q=a[H+2];c[d+H]=b[0]*V+b[4]*Y+b[8]*q;c[d+H+1]=b[1]*V+b[5]*Y+b[9]*q;c[d+H+2]=b[2]*V+b[6]*Y+b[10]*q}return c};a.UK=function(a,b,c,d){d=d||0;for(var g=a.length,H=0;H<g;H+=4){pa[0]=a[H];pa[1]=a[H+1];pa[2]=a[H+2];pa[3]=a[H+3];var V=0<pa[3];P.multiply(b,pa,pa);(V&&0>pa[3]||!V&&0<pa[3])&&da.scale(pa,
-1,pa);c[d+H]=pa[0];c[d+H+1]=pa[1];c[d+H+2]=pa[2];c[d+H+3]=pa[3]}};a.M_=function(a,b,c){c||(c=new Float32Array(3));q[0]=a[0];q[1]=a[1];q[2]=a[2];q[3]=0;da.transformMat4(q,b,q);c[0]=q[0];c[1]=q[1];c[2]=q[2]};a.c4=function(a,b){var c=a.length;c||K("flatten(): Wrong or empty array");var d=a[0].length;d||K("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var g=0;g<c;g++)for(var H=0;H<d;H++)b[g*d+H]=a[g][H];return b};a.N_=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],
a[c+1],a[c+2]]);b[c/3]=d}return b};a.cu=function(b,c,d,g){if(g<d)return d;var q=d+Math.floor((g-d)/2);return b[q]>c?a.cu(b,c,d,q-1):b[q]<c?a.cu(b,c,q+1,g):q};a.Mj=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.h3=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.S7=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.MZ=function(a,b,c,d,g){g||(g=new Float32Array(16));
b=m.fromRotationTranslation(c,d,U);m.multiply(b,a,g);return g};a.Xc=function(a,b,c,d,g){g||(g=new Float32Array(3));c=m.fromRotationTranslation(c,d,U);1!==b&&(d=m.identity(sa),b=t.set(b,b,b,N),m.scale(d,b,d),m.multiply(c,d,c));t.transformMat4(a,c,g);return g};a.z9=function(a,b,c,d,g){g||(g=new Float32Array(4));b=m.fromRotationTranslation(c,d,U);da.transformMat4(a,b,g);return g};a.C6=function(a,b,c,d,g){g||(g=new Float32Array(3));b=m.fromRotationTranslation(c,d,U);m.invert(b,b);t.transformMat4(a,b,
g);return g};a.x9=function(a,b,c){c||(c=new Float32Array(16));m.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.b7=function(b,c,d){a.cK(b,c);c[3]=a.bK(b);r(b,d)};a.q2=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.XX=function(a,b,c,d){d||(d=new Float32Array(3));var g=N;t.subtract(b,a,g);t.transformQuat(g,c,g);t.subtract(b,g,d)};a.CU=function(){var a=N;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),
g=new Float32Array(16),H=new Float32Array(16),V=new Float32Array(16);m.lookAt(a,[-1,0,0],[0,-1,0],b);m.scale(b,[-1,1,1],b);m.scale(b,[-1,1,-1],c);m.lookAt(a,[0,-1,0],[0,0,-1],d);m.scale(d,[1,1,-1],d);m.scale(d,[1,-1,-1],g);m.lookAt(a,[0,0,-1],[0,-1,0],H);m.scale(H,[-1,1,1],H);m.scale(H,[-1,1,-1],V);return[b,c,d,g,H,V]};a.GU=function(){var a=N;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),g=new Float32Array(16),H=new Float32Array(16),V=new Float32Array(16);
m.lookAt(a,[1,0,0],[0,-1,0],b);m.scale(b,[-1,1,-1],c);m.lookAt(a,[0,1,0],[0,0,1],d);m.scale(d,[1,-1,-1],g);m.lookAt(a,[0,0,1],[0,-1,0],H);m.scale(H,[-1,1,-1],V);return[b,c,d,g,H,V]};a.uR=function(a){return k(a,0)};a.nJ=k;a.p6=n;a.LW=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.SK=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),
b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Cb=function(a){return a*Math.PI/180};a.oe=function(a){return 180*a/Math.PI};a.xD=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),g=.211324865405187*c+.211324865405187*d,b=a[0]-c+g;a=a[1]-d+g;var H=b>a?1:0,V=1-H,g=b+.211324865405187-H,Y=a+.211324865405187-V,q=b+-.577350269189626,C=a+-.577350269189626,
c=c%289,d=d%289,e=l(l(d)+c),V=l(l(d+V)+c+H),t=l(l(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(g*g+Y*Y),0),H=Math.max(.5-(q*q+C*C),0),u=2*f(.024390243902439*e)-1,m=2*f(.024390243902439*V)-1,v=2*f(.024390243902439*t)-1,e=Math.abs(u)-.5,V=Math.abs(m)-.5,t=Math.abs(v)-.5,u=u-Math.floor(u+.5),m=m-Math.floor(m+.5),v=v-Math.floor(v+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(u*u+e*e)),d=d*d*d*d*(1.79284291400159-.85373472095314*(m*m+V*V)),H=H*H*H*H*(1.79284291400159-.85373472095314*(v*v+t*t));
return 130*(c*(u*b+e*a)+d*(m*g+V*Y)+H*(v*q+t*C))};a.wG=function(a){var b=1/7,d=b/2,g=c(Math.floor(a[0])),q=c(Math.floor(a[1])),H=f(a[0]);a=f(a[1]);var V=H-.5,Y=H-1.5,H=a-.5;a-=1.5;var C=v(g),e=v(g+1),t=C,g=e,C=v(C+q),e=v(e+q),t=v(t+q+1),g=v(g+q+1),q=V+.7*(B(C)*b+d),u=Y+.7*(B(e)*b+d),V=V+.7*(B(t)*b+d),Y=Y+.7*(B(g)*b+d),C=H+.7*(B(Math.floor(C*b))*b+d),H=H+.7*(B(Math.floor(e*b))*b+d),t=a+.7*(B(Math.floor(t*b))*b+d),b=a+.7*(B(Math.floor(g*b))*b+d);return Math.min(q*q+C*C,u*u+H*H,V*V+t*t,Y*Y+b*b)};a.Ew=
function(a,b,c,d,g){g||(g=new Float32Array(4));a=t.transformQuat(b,a,N);b=c[0];var H=c[1];c=c[2];var V=X;V[0]=H*H+c*c;V[1]=-H*b;V[2]=-c*b;V[3]=-b*H;V[4]=b*b+c*c;V[5]=-c*H;V[6]=-b*c;V[7]=-H*c;V[8]=b*b+H*H;t.transformMat3(a,V,a);t.normalize(a,a);P.rotationTo(d,a,g);return g};a.Mz=function(a,b){b||(b=new Float32Array(4));var c=q,d=S,c=P.setAxisAngle([0,0,1],Math.PI,P.create()),d=P.setAxisAngle([1,0,0],Math.PI/2,P.create());P.multiply(c,d,c);P.multiply(a,c,b);return b};a.ua=function(){J=0;F={}};a.U=Q;
a.mc=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.jx=function(a,b,c,d,g){g||(g=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<g.length;d++)g[d]=(1-c)*a[d]+c*b[d];return g};a.kM=function(a,b,c,d,g){g||(g=new Float32Array(a.length));P.slerp(a,b,Math.exp(-c/d),g)};a.DB=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.jk=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.dA=
function(a,b){var c=d.fromQuat(a,X),g=N;g[0]=c[6];g[1]=c[7];g[2]=c[8];g=t.cross(M,g,g);t.normalize(g,g);var q=c[4];!b&&0<q&&(g[0]*=-1,g[1]*=-1,g[2]*=-1);u[0]=c[0];u[1]=c[1];u[2]=c[2];t.normalize(u,u);c=S;P.rotationTo(u,g,c);P.multiply(c,a,a)};a.jI=function(a,b,c,d){c=c*b-.5;var g=d*b-.5;d=c-Math.floor(c);var H=g-Math.floor(g);c=Math.floor(c);var g=Math.floor(g),V=b-1,Y=a[g*b+c],q=a[g*b+Math.min(c+1,V)],C=a[Math.min(g+1,V)*b+c];a=a[Math.min(g+1,V)*b+Math.min(c+1,V)];return(Y*(1-d)+q*d)*(1-H)+(C*(1-
d)+a*d)*H};a.Mm=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.fL=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Co=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.XA=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.qr=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.VK=function(a){if(!a.length)return null;
var b=Math.floor(Math.random()*a.length);return a[b]};a.qJ=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=0;t.normalize(c,c)};a.KZ=function(a,b,c){var d=a[0],g=a[1];a=a[2];var H=b[0],V=b[1],Y=b[2];b=b[3];var q=V*a-Y*g,C=Y*d-H*a,f=H*g-V*d,e=V*f-Y*C,Y=Y*q-H*f,H=H*C-V*q;c[0]=d+2*q*b+2*e;c[1]=g+2*C*b+2*Y;c[2]=a+2*f*b+2*H};a.assert=function(a){a||K("Assertion failed")};a.q=K;a.Fg=G;a.zi=D;a.fB=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.rZ=function(a,b){for(var c in a){var d=
!0,g=a[c],H=b[c];switch(typeof g){case "number":case "string":case "boolean":d=g==H;break;case "object":d=R(g,H)}if(!d)return!1}return!0};a.HC=function(a,b){var c=a[0],d=a[2],g=a[3];b[0]=a[1];b[1]=d;b[2]=g;b[3]=c};a.YH=function(a){a+=1;132651<a&&x.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.PB=function(a,b,c,d){q.set(a);q[3]=b;a=S;N[0]=c[3];N[1]=c[4];N[2]=c[5];a.set(N);a[3]=0;a=da.dot(q,a);if(0==a)return null;
b=S;t.copy(c,N);b.set(N);b[3]=1;a=-da.dot(q,b)/a;d[0]=c[0]+a*c[3];d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.mV=function(a,b,c,d){var g=b[0]-a[0],H=c[0]-a[0],V=b[1]-a[1],Y=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=V*a-b*Y;d[1]=H*b-g*a;d[2]=g*Y-V*H;return d};a.k3=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.YC=function(a,b,c){var d=N,g=t.dot(a,b);-.9999999>g?(t.cross(ta,a,d),1E-6>t.length(d)&&t.cross(na,a,d),t.normalize(d,d),P.setAxisAngle(d,Math.PI,c)):(t.cross(a,b,d),c.set(d),c[3]=
1+g,P.normalize(c,c));return c};a.Bl=function(a,b,c){if(b==c)return c-a;a=D(a);b=D(b);c=D(c);b=2*Math.PI-b;c=D(c+b);a=D(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.Sm=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=Q(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.LQ=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.t3=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.xN=function(a,b){for(var c=Math.max(a.length,
b.length),d=0;d<c;d++){var g=p((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(g)return g}return 0};a.bl=function(a){return a.join(".")};a.uM=function(a){return a.split(".").map(function(a){return a|0})};a.e9=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.S6=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.gj=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=I(b[1]),b.join("://")):I(a)};
a.tq=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.LT=function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.Sj=z;a.er=function(a){a=Math.round(32767.5*(a+1)-32768);return Q(a?a:0,-32768,32767)};a.U8=function(a){return Q((a+32768)/32767.5-1,-1,1)};a.QZ=function(a){return Q(Math.round(255*a),0,255)};a.C9=function(a){return Q(a/255,0,1)};a.FT=function(a,b,c,d){var g=t.subtract(c,b,N),H=t.subtract(d,c,ba),V=t.subtract(b,
d,u);b=t.subtract(a,b,ga);c=t.subtract(a,c,Z);a=t.subtract(a,d,E);d=t.cross(g,H,ca);if(0<=t.dot(t.cross(d,g,ha),b)&&0<=t.dot(t.cross(d,H,ha),c)&&0<=t.dot(t.cross(d,V,ha),a))return V=t.length(d),H=t.dot(d,b),Math.abs(H/V);g=t.scale(g,Q(t.dot(g,b)/t.length(g),0,1),ha);b=t.length(t.subtract(b,g,ha));H=t.scale(H,Q(t.dot(H,c)/t.length(H),0,1),ha);H=t.length(t.subtract(c,H,ha));V=t.scale(V,Q(t.dot(V,a)/t.length(V),0,1),ha);V=t.length(t.subtract(a,V,ha));return Math.min(Math.min(b,H),V)}};b4w.module.__math=function(a,h){function p(a,b){for(var f=a[1],e=1,l=2;l<a.length;l++)4!=l&&8!=l&&Math.abs(a[l])>Math.abs(f)&&(f=a[l],e=l);for(var n=Math.floor(e/3),e=e%3,f=.5*Math.atan(2*f/(a[3*n+n]-a[3*e+e])),l=0;l<b.length;l++)b[l]=0==l||4==l||8==l?1:0;b[e+3*n]=-Math.sin(f);b[n+3*e]=Math.sin(f);b[n+3*n]=Math.cos(f);b[e+3*e]=Math.cos(f);return b}function e(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var f=a.content[b];0<b;){var e=(b+1>>1)-1,l=a.content[e];if(a.Nm(f)<a.Nm(l))a.content[e]=
f,a.content[b]=l,b=e;else break}}function y(a,b){for(var f=a.content.length,e=a.content[b],l=a.Nm(e);;){var n=b+1<<1,k=n-1,r=null;if(k<f){var p=a.Nm(a.content[k]);p<l&&(r=k)}n<f&&a.Nm(a.content[n])<(null===r?l:p)&&(r=n);if(null!==r)a.content[b]=a.content[r],a.content[r]=e,b=r;else break}}var r=h("__mat3"),A=h("__vec3"),k=new Float32Array(3),w=new Float32Array(9),n=new Float32Array(9),l=new Float32Array(9),f=new Float32Array(9);a.v5=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.w5=function(a,b){b=b||new Float32Array(3);return A.copy(a,b)};a.JL=function(a,b){A.copy(b,a)};a.iD=function(a,b){A.normalize(b,k);a[3]=k[0];a[4]=k[1];a[5]=k[2]};a.C2=function(a,b,f){f=f||new Float32Array(3);f[0]=a[0]+a[3]*b;f[1]=a[1]+a[4]*b;f[2]=a[2]+a[5]*b};a.vR=function(a,b){b[0]=0;b[1]=0;for(var f=b[2]=0;f<a.length;f+=3)b[0]+=a[f],b[1]+=a[f+1],b[2]+=a[f+2];return A.scale(b,3/a.length,b)};a.oR=function(a,b,f){for(var e=0;e<f.length;e++)f[e]=0;for(e=0;e<a.length;e+=3){var l=a[e]-b[0],
n=a[e+1]-b[1],k=a[e+2]-b[2];f[0]+=l*l;f[1]+=l*n;f[2]+=l*k;f[4]+=n*n;f[5]+=n*k;f[8]+=k*k}f[3]=f[1];f[6]=f[2];f[7]=f[5];for(e=0;e<f.length;e++)f[e]*=3/a.length;return f};a.jU=function(a,b){var k=r.copy(a,w);if(5E-4>e(k))return r.identity(b);var h=p(k,n),K=r.transpose(h,l);r.multiply(k,K,f);r.multiply(h,f,k);for(var G=r.copy(h,b),D=1;5E-4<=e(k)&&100>D;)h=p(k,n),K=r.transpose(h,l),r.multiply(k,K,f),r.multiply(h,f,k),r.multiply(h,G,G),D++;return G};a.sg=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.$Q=function(a){return{content:[],Nm:a}};a.eG=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.aR=function(a){var b=a.content[0],f=a.content.pop();0<a.content.length&&(a.content[0]=f,y(a,0));return b};a.A2=function(a,c){var f=a.content.indexOf(c),e=a.content.pop();f!==a.content.length-1&&(a.content[f]=e,a.Nm(e)<a.Nm(c)?b(f):y(f))};a.bR=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__objects=function(a,h){function p(a){var b=a.I;a=a.k;for(var c=0;c<b.length;c++){var d=b[c].yb;d.s.outline&&a.ih&&P.SX(d)}}function e(a){a.k.ih=0;a=U.indexOf(a);-1!=a&&U.splice(a,1)}function b(a){if(a.Pn)for(var b=a.I,c=0;c<b.length;c++)P.bN(b[c].yb,a)}function y(a,b){for(var c=a.I,d=b.I,g=0;g<c.length;g++){for(var q=!1,f=0;f<d.length;f++)if(c[g].yb==d[f].yb){q=!0;break}q||r(b,c[g].yb)&&z.Yp(b,c[g].yb)}}function r(a,b){return!b.wF&&"SPEAKER"==a.type||!b.bQ&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function A(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.kz||a.parent&&a.parent.kz)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,g=a.b4w_collision,q=a.b4w_vehicle,f=a.b4w_floating,e=a.b4w_character,t=d.zV(a),u=L.mG(a),m=0<a.data.b4w_shape_keys.length,C=a.b4w_dynamic_geometry;if(!(c=v.nG(a,b)||c||g||q||m||f||t||e||u||C))a:{c=a.data;for(g=0;g<c.materials.length;g++)if(q=c.materials[g],q.b4w_water||q.b4w_lens_flares||k(q.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
L.mG(a),g=a.b4w_do_not_batch,q=Boolean(a.b4w_anchor),v.nG(a,b)||c||g||q;default:return!0}}function k(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,g=c.convert_to,q=c.outputs[0];if(!(!q.is_linked||"WORLD"==d&&"CAMERA"==g||"CAMERA"==d&&"WORLD"==g||"OBJECT"==d&&"OBJECT"==g))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,q=c.outputs[0],q.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(q=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||q.is_linked||d.is_linked))return!0}return!1}function w(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.s.type==v.bz||c.s.type==v.az&&"ARMATURE"==b.type||c.s.type==v.VO&&"LAMP"==b.type||c.s.type==v.UO&&"WORLD"==b.type)&&b.Ng.push(v.wJ(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Ng.push(v.wJ(null,d.action));"MESH"==b.type&&b.Ng.push.apply(b.Ng,v.OU(a))}function n(a,b,c){b=ca[b]||
[];for(var d=[],g=0;g<b.length;g++){var q=b[g];if(q.k.Ue==c||-1==c)for(var f=q.I,e=0;e<f.length;e++)f[e].yb==a&&d.push(q)}return d}function l(a,b,c,d,g){for(var q=null,f=0;f<b.length;f++){var e=b[f];if(!((c?e.Dm:e.name)!=a||e.k.Ue!=d&&-1!=d||g&&!e.Kj||(q=e,z.Ri(q))))break}return q}function f(a){ca.ALL.push(a);ca[a.type]||(ca[a.type]=[]);ca[a.type].push(a);var b=a.k.Ed;if(null!=b)for(var c=0;c<X.length;c++){var d=X[c];d.k.Ed==b&&d.ss.push(a)}}var v=h("__animation"),c=h("__batch"),B=h("__boundings"),
Q=h("__camera"),K=h("__config"),G=h("__constraints"),D=h("__geometry"),R=h("__lights"),L=h("__nla"),I=h("__nodemat"),z=h("__obj_util"),d=h("__particles"),m=h("__physics"),O=h("__print"),x=h("__primitives"),g=h("__quat"),P=h("__scenes"),t=h("__sfx"),da=h("__transform"),J=h("__textures"),F=h("__tsr"),T=h("__util"),N=h("__vec3"),ba=h("__armature"),u=h("__anchors"),ga=h("__renderer"),Z=K.B,E=K.Vc,ca={ALL:[]},ha=new Float32Array(24),q=0,S=0,X=[],U=[],sa=new Float32Array(3),pa=new Float32Array(4);a.my=
0;a.ly=1;a.Oc=2;a.oc=-1;a.update=function(a){for(var b=0;b<U.length;b++){var c=U[b],d=c,g=a,q=0,f=d.wK;0==f.qx&&(f.qx=g);g-=f.qx;if(f.NC&&g/f.Lf>=f.NC)e(d);else{g%=f.Lf;if(g<f.tC)switch(f=g/(f.tC/5),g=Math.floor(f),g){case 0:q=(f-g)/2;break;case 1:q=(f-g)/2+.5;break;case 2:q=1;break;case 3:q=1-(f-g)/2;break;case 4:q=.5-(f-g)/2}d.k.ih=q}c.k.ih&&p(c)}if(a=ca.ARMATURE)for(b=0;b<a.length;b++)c=a[b],c.lC&&(da.D(c),c.lC=!1)};a.IL=function(a,b){a.k.ih=b;p(a)};a.yn=function(a,b,c,d){var g=a.wK;g.qx=0;g.tC=
b;g.Lf=c;g.NC=d;-1==U.indexOf(a)&&U.push(a)};a.mu=e;a.Wk=function(a,b){b.wj=a.uuid;b.Kj=!0;w(a,b);a.kz=b.Sa=A(a,b);a.cQ=!0;b.af=a.b4w_vehicle;b.ig=a.b4w_character;b.qm=a.b4w_floating;b.an=a.b4w_collision;b.bc=a.b4w_collision_id;b.tu=a.b4w_correct_bounding_offset;var d=a.game;b.jh={es:d.physics_type,Ys:d.use_ghost,qN:d.use_sleep,Zh:d.mass,wN:d.velocity_min,vN:d.velocity_max,tH:d.damping,gL:d.rotation_damping,yW:d.lock_location_x,zW:d.lock_location_y,AW:d.lock_location_z,BW:d.lock_rotation_x,DW:d.lock_rotation_y,
EW:d.lock_rotation_z,Cq:d.collision_margin,Aq:d.collision_group,Dq:d.collision_mask,fE:d.use_collision_bounds,pu:d.collision_bounds_type,Us:d.use_collision_compound};if(d=a.b4w_vehicle_settings)b.of={name:d.name,gf:d.part,xZ:d.suspension_rest_length,FD:d.suspension_compression,HD:d.suspension_stiffness,GD:d.suspension_damping,qE:d.wheel_friction,WC:d.roll_influence,YB:d.max_suspension_travel_cm,ir:d.force_max,nq:d.brake_max,Uo:d.steering_max,lo:d.max_speed_angle,Uq:d.delta_tach_angle,Ls:d.speed_ratio,
Ns:d.steering_ratio,Er:d.inverse_control,Vl:d.floating_factor,fn:d.water_lin_damp,gn:d.water_rot_damp,CM:d.synchronize_position};if(d=a.b4w_floating_settings)b.Qn={name:d.name,gf:d.part,Vl:d.floating_factor,fn:d.water_lin_damp,gn:d.water_rot_damp,CM:d.synchronize_position};if(d=a.b4w_character_settings)b.AG={W_:d.walk_speed,ZX:d.run_speed,qZ:d.step_height,eW:d.jump_strength,Y_:d.waterline};for(d=0;d<a.constraints.length;d++){var g=a.constraints[d];"RIGID_BODY_JOINT"==g.type&&b.AC.push({target:g.target.pb,
lX:g.pivot_type,mX:g.pivot_x,nX:g.pivot_y,oX:g.pivot_z,Ga:g.axis_x,Ha:g.axis_y,Ia:g.axis_z,I_:g.use_limit_x,J_:g.use_limit_y,K_:g.use_limit_z,E_:g.use_angular_limit_x,F_:g.use_angular_limit_y,G_:g.use_angular_limit_z,oW:g.limit_max_x,pW:g.limit_max_y,qW:g.limit_max_z,rW:g.limit_min_x,sW:g.limit_min_y,tW:g.limit_min_z,iW:g.limit_angle_max_x,jW:g.limit_angle_max_y,kW:g.limit_angle_max_z,lW:g.limit_angle_min_x,mW:g.limit_angle_min_y,nW:g.limit_angle_min_z})}d=b.k=z.Mq("MESH"===b.type?b.Sa?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.pb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.bs=a.parent_bone),a.pinverse_tsr&&(b.xw=F.create(),F.copy(a.pinverse_tsr,b.xw))):a.dg_parent&&(b.parent=a.dg_parent.pb,b.xk=!0);var g=a.location,e=a.scale[0];T.HC(a.rotation_quaternion,pa);da.Wc(b,g);da.gi(b,pa);da.Mf(b,e);b.Ws=a.b4w_use_default_animation;b.rl=v.qz(a.b4w_anim_behavior);a.b4w_object_tags&&(b.bw={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,G2:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.Jx={fQ:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":ba.Wk(a,b);g=d.Hg;e=v.rR(g);a.b4w_animation_mixing?(d.ne=new Float32Array(e.Eb),d.Ge=new Float32Array(e.Eb),d.se=new Float32Array(e.trans),d.Je=new Float32Array(e.trans)):(d.ne=e.Eb,d.Ge=e.Eb,d.se=e.trans,d.Je=e.trans);for(var u in g){var m=g[u];1==m.ku.length&&ba.a_(m,!0,e.trans,e.Eb)}d.ls=e;d.Ye=0;d.Ai=a.b4w_animation_mixing;break;case "MESH":d.Kn=a.b4w_do_not_render;
d.vl=c.XQ(a.data.b4w_boundings.bb);d.Dk=E.outlining_overview_mode||a.b4w_selectable;d.pw=a.b4w_selectable;d.Vc=E.outlining_overview_mode||a.b4w_outlining;d.ow=a.b4w_outlining;d.qw=E.outlining_overview_mode||a.b4w_outline_on_select;d.Gg=a.b4w_billboard;d.hq=a.b4w_pres_glob_orientation;d.jq="BASIC";d.iq="SPHERICAL"==a.b4w_billboard_geometry;u=d.ai;u.rk=a.b4w_outline_settings.outline_duration;u.tk=a.b4w_outline_settings.outline_period;u.uk=a.b4w_outline_settings.outline_relapses;d.Dk&&(d.Nj=T.YH(q),
q++);for(u=0;u<a.data.b4w_vertex_anim.length;u++)g=a.data.b4w_vertex_anim[u],b.Zc.push({name:g.name,va:g.frame_start,ab:g.frame_end,x2:g.averaging,y2:g.averaging_interval,gQ:g.allow_nla});b.k.Zc=b.Zc.length?!0:!1;"MESH"!=a.type&&T.q("Wrong object type: "+a.name);u=b.k;if(a.data.b4w_shape_keys.length)for(u.Le=!0,g=0;g<a.data.b4w_shape_keys.length;g++)e={},e.value=a.data.b4w_shape_keys[g].value,e.name=a.data.b4w_shape_keys[g].name,u.ii.push(e);else u.Le=!1;d.He=a.b4w_shadow_cast;d.fe=a.b4w_shadow_receive;
d.qe=a.b4w_shadow_cast_only&&d.He;d.ee=a.b4w_reflexible;d.Hd=a.b4w_reflexible_only&&d.ee;d.Gd=a.b4w_reflective;d.lh=a.b4w_reflection_type;if(!d.Gd)for(u=a.data.materials,g=0;g<u.length;g++)e=u[g],e.use_nodes&&-1!=e.node_tree.jz.indexOf("BSDF_GLOSSY")&&(d.Gd=!0,d.lh="CUBE");d.Kg=a.b4w_caustics;if(d.rf=a.b4w_wind_bending)d.jn=a.b4w_wind_bending_angle,u=c.Z_(a.b4w_wind_bending_angle,d.vl,a.scale[0]),d.th=u,d.uh=a.b4w_wind_bending_freq,d.Pg=a.b4w_detail_bending_freq,d.Og=a.b4w_detail_bending_amp,d.Jg=
a.b4w_branch_bending_amp,d.Yi=a.b4w_main_bend_stiffness_col,u=a.b4w_detail_bend_colors,d.Ae.LB=u.leaves_stiffness_col,d.Ae.KB=u.leaves_phase_col,d.Ae.uC=u.overall_stiffness_col;d.Uh=a.b4w_hidden_on_load;d.ag=a.b4w_dynamic_geometry;"MESH"!==a.type&&T.q("Wrong object");u=a.data.materials[0];d.Yl=u.physics.friction;d.Rl=u.physics.elasticity;d.bh=0;d.ef=z.Hp;d.dh=a.b4w_lod_transition;d.ww=a.pass_index;break;case "LINE":d.R=B.Qd();d.ba=B.Lg();d.Ua=B.Qd();d.qb=B.Lg();break;case "CAMERA":Q.yR(a,b);Q.NQ(b);
break;case "LAMP":R.fW(a,b);break;case "SPEAKER":b.X=t.IS();d=!1;for(u=0;u<b.I.length;u++)if(b.I[u].yb.Rc){d=!0;break}d&&t.Wk(a,b);break;case "EMPTY":u=B.Qd(),d.R=u,u=B.Kh(),d.wa=u,a.field&&(b.Pn={type:a.field.type,vM:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Jn:a.b4w_anchor.detect_visibility,Uj:a.b4w_anchor.element_id,QW:a.b4w_anchor.max_width})}f(b)};a.A_=function(a,b){b.wj=a.uuid;b.Kj=!0;w(a,b);a.kz=b.Sa=A(a,b);a.cQ=!0;b.k=z.Mq(b.type);b.Ws=a.b4w_use_default_animation;
b.rl=v.qz(a.b4w_anim_behavior);f(b)};a.n_=function(a,b){var c=b.k;if(b.parent){!b.xk&&b.jh.Us&&b.parent.jh.Us&&(b.an=!1);for(var d=!1,q=0;q<b.I.length;q++)if(b.I[q].yb.zc){d=!0;break}if(q=d)q=b.jh,q=b.af||b.qm||m.ig(b)||b.an&&!q.Ys&&0<q.Zh&&("DYNAMIC"==q.es||"RIGID_BODY"==q.es);if(q)q=b.xk?F.copy(c.n,F.create()):c.n,F.multiply(b.parent.k.n,q,c.n),da.Wc(b,F.G(c.n)),da.Mf(b,F.Yd(c.n)),da.gi(b,F.P(c.n));else if(b.xk||!b.bs)if(q=F.copy(c.n,F.create()),b.Jx&&"CAMERA"==b.parent.type){q={distance:b.Jx.distance,
rotation:F.P(q)};switch(b.Jx.fQ){case "TOP_LEFT":q.top=0;q.left=0;break;case "TOP":q.top=0;q.left=.5;break;case "TOP_RIGHT":q.top=0;q.right=0;break;case "LEFT":q.top=.5;q.left=0;break;case "CENTER":q.top=.5;q.left=.5;break;case "RIGHT":q.top=.5;q.right=0;break;case "BOTTOM_LEFT":q.bottom=0;q.left=0;break;case "BOTTOM":q.bottom=0;q.left=.5;break;case "BOTTOM_RIGHT":q.bottom=0,q.right=0}G.sz(b,b.parent,q)}else G.kQ(b,b.parent,q);else q=F.copy(c.n,F.create()),G.lQ(b,b.parent,b.bs,q)}if("ARMATURE"==b.type)for(d=
a.pose.bones,q=0;q<d.length;q++){var e=d[q],u=e.constraints;if(u)for(var t=0;t<u.length;t++){var l=u[t];"COPY_TRANSFORMS"!=l.type||l.subtarget||l.mute||G.yQ(b,l.target.pb,e.name,T.jF,T.rn)}}if("MESH"==b.type)var E=v.mI(a);if(E){u=E.pb;q=u.k.ls;d=b.k;e=a.data;b.Yt=u;e=e.vertex_groups;if(e.length){var u=u.k.Hg,t=0,l={},C;for(C in u){var n=T.Dd("name",C,e);n&&(l[C]={zN:n.index,Jj:u[C].Jj,BA:t++})}d.Di=l;C=t;e=v.BI();d.eh=C;C>2*e?(d.hk=!1,O.error('too many bones for "'+a.name+'" / '+d.eh+" bones (max "+
e+" with blending, "+2*e+" without blending). Skinning will be disabled.")):d.hk=!0}C=v.aU(q.trans,q.Eb,c.Di);E.b4w_animation_mixing?(c.ne=new Float32Array(C.Eb),c.Ge=new Float32Array(C.Eb),c.se=new Float32Array(C.trans),c.Je=new Float32Array(C.trans)):(c.ne=C.Eb,c.Ge=C.Eb,c.se=C.trans,c.Je=C.trans);c.$p=new Float32Array(4);c.Zp=g.create();c.ls=C;c.Ye=0}if(c.Gd)if(c=b.k,"CUBE"==c.lh)c.Rd=S++;else if("PLANE"==c.lh){a:{E=a.constraints;for(C=0;C<E.length;C++)if(q=E[C],"LOCKED_TRACK"==q.type&&"REFLECTION PLANE"==
q.name){if(q.target.pb){E=q.target.pb;break a}O.warn('Reflection plane target "'+q.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}E=null}E||(E=T.Qs("%reflection%"),E=z.Lq(E,"EMPTY"),C=z.Mq("EMPTY"),E.k=C,y(b,E),G.IF(E,b,[0,0,0],null,1),f(E));C=null;for(q=0;q<X.length;q++)if(X[q]==E){C=q;break}null==C&&(C=X.length,X.push(E));E.k.Ed=C;c.Ed=C;E.ss.push(b)}};a.i_=b;a.m3=y;a.IR=r;a.o_=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=c.k.type&&
"CAMERA"!=c.k.type||da.D(c);c.Ws&&v.uK(c)&&(v.Wt(c),c.ja.length&&v.play(c,null,v.kl))}};a.bv=function(a){return T.S(a.bw)};a.ua=function(){S=q=0;X.length=0;U.length=0;ca={ALL:[]}};a.copy=function(a,b,d){var g=b,e=z.Ri(a);b=e?z.ZH(e.name,b):b;if(l(b,ca.ALL,!1,-1)){for(var e=1,u;;){u="."+(3>String(e).length?("000"+String(e)).slice(-3):String(e));if(!l(b+u,ca.ALL,!1,-1))break;e++}O.error('Object "'+b+'" already exists. Name was replaced by "'+b+u+'".');g+=u;b+=u}g=z.Lq(b,a.type,g);g.Kj=a.Kj;g.Sa=a.Sa;
g.Gr=a.Gr;g.Ws=a.Ws;g.Ng=a.Ng;g.k=z.Vz(a.k);g.bw=z.su(a.bw);y(a,g);g.Rt=z.bA(a.Rt);g.parent=z.bA(a.parent);g.xk=a.xk;g.bs=a.bs;g.Zc=z.bA(a.Zc);g.rl=a.rl;!a.C||a.af||a.ig||a.qm||(g.an=a.an,g.C=null);g.bc=a.bc;g.tu=a.tu;g.jh=z.su(a.jh);b=[];for(e=0;e<a.I.length;e++){u=g.I[e];var t=a.I[e].W;if(d){for(var m=u.W,E=0;E<t.length;E++)if(!t[E].eg){var n=z.su(t[E]);n.Ca=D.dS(t[E].Ca);m.push(n);b.push(t[E].Ca)}for(E=0;E<t.length;E++)if(t[E].eg){n=z.su(t[E]);m.push(n);for(var C=0;C<b.length;C++)b[C]==t[E].Ca&&
(n.Ca=m[C].Ca)}for(E=0;E<m.length;E++)m[E].Ca&&D.cN(m[E].Ca),Z.nz&&ga.RQ(m[E]),m[E].pk=g.wj,c.WZ(m[E]);J.VY(m)}else u.W=t;for(E=0;E<u.W.length;E++)for(t=u.W[E].ya,m=0;m<t.length;m++)J.Cv(t[m])}d||(g.k.hp=!1);z.ZC(g,!1);f(g);g.k.Hv=!0;g.k.Iv=d;g.k.Nj=T.YH(q);q++;return g};a.b_=function(a){for(var b=a.k,d=a.I[0].W,g,q,f,e,u,t,m,C,l,E,n,F,v=[],k=0;k<d.length;k++){var J=d[k];if("MAIN"==J.type){var U=D.xr("a_position"),U=D.hv(J.Ca.tc,U),P=J.Ca.kd.a_position.offset;g=e=U[P];q=u=U[P+1];f=t=U[P+2]}}for(k=
0;k<d.length;k++)if(J=d[k],J.Ca&&J.qb&&J.Ua){var U=D.xr("a_position"),U=D.hv(J.Ca.tc,U),P=J.Ca.kd.a_position.offset,S=J.Ca.kd.a_position.length+P;m=E=U[P];C=n=U[P+1];l=F=U[P+2];for(var N=P;N<S;N+=3){var P=U[N],r=U[N+1],ga=U[N+2];m=Math.max(P,m);C=Math.max(r,C);l=Math.max(ga,l);E=Math.min(P,E);n=Math.min(r,n);F=Math.min(ga,F)}J.R.max_x=m.toFixed(3);J.R.max_y=C.toFixed(3);J.R.max_z=l.toFixed(3);J.R.min_x=E.toFixed(3);J.R.min_y=n.toFixed(3);J.R.min_z=F.toFixed(3);B.Al(J.R,b.n,J.Ua);B.LH(J.Ua,ha);for(U=
v.length=0;U<ha.length;U++)v.push(ha[U]);J.qb=B.uu(v,!0);J.ba=B.mR(J.qb,b.n);J.wa=B.Jq(J.ba);J.lb=B.Jq(J.qb);J.Sf=B.EB(J.ba,J.wa);"MAIN"==J.type&&(g=Math.max(m,g),q=Math.max(C,q),f=Math.max(l,f),e=Math.min(E,e),u=Math.min(n,u),t=Math.min(F,t))}v={max_x:parseFloat(g.toFixed(3)),max_y:parseFloat(q.toFixed(3)),max_z:parseFloat(f.toFixed(3)),min_x:parseFloat(e.toFixed(3)),min_y:parseFloat(u.toFixed(3)),min_z:parseFloat(t.toFixed(3))};E=g-e;C=q-u;m=f-t;e=.5*(g+e);l=.5*(q+u);n=.5*(f+t);var T=e,H=n;u=Math.max(E,
Math.max(C,m))/2;t=Math.max(E,m)/2;var V=[e/(E?E:1),l/(C?C:1),n/(m?m:1)];F=.5;if(b.Gg)P=Math.max(Math.abs(v.max_x),Math.abs(v.min_x)),r=Math.max(Math.abs(v.max_y),Math.abs(v.min_y)),ga=Math.max(Math.abs(v.max_z),Math.abs(v.min_z)),f=Math.sqrt(P*P+r*r+ga*ga),k=Math.sqrt(P*P+r*r),v.max_x=v.max_y=v.max_z=f,v.min_x=v.min_y=v.min_z=-f,t=k,u=f,P=new Float32Array([0,0,0]),g=new Float32Array([u,u,u]),f=new Float32Array([0,0,0]);else{for(k=0;k<d.length;k++)if(J=d[k],"MAIN"==J.type)for(U=D.xr("a_position"),
U=D.hv(J.Ca.tc,U),S=d[k].Ca.kd,P=S.a_position.offset,S=S.a_position.length+P,N=P;N<S;N+=3){var P=U[N],r=U[N+1],ga=U[N+2],Y=Math.sqrt((e-P)*(e-P)+(l-r)*(l-r)+(n-ga)*(n-ga));if(Y>u){var J=e-u*(P-e)/Y,p=l-u*(r-l)/Y,Y=n-u*(ga-n)/Y;e=(J+P)/2;l=(p+r)/2;n=(Y+ga)/2;u=Math.sqrt((e-P)*(e-P)+(l-r)*(l-r)+(n-ga)*(n-ga))}p=Math.sqrt((T-P)*(T-P)+(H-ga)*(H-ga));p>t&&(J=T-t*(P-T)/p,Y=H-t*(ga-H)/p,T=(J+P)/2,H=(Y+ga)/2,t=Math.sqrt((T-P)*(T-P)+(H-ga)*(H-ga)));P/=E?E:1;r/=C?C:1;ga/=m?m:1;Y=Math.sqrt((V[0]-P)*(V[0]-P)+
(V[1]-r)*(V[1]-r)+(V[2]-ga)*(V[2]-ga));Y>F&&(J=V[0]-F*(P-V[0])/Y,p=V[1]-F*(r-V[1])/Y,Y=V[2]-F*(ga-V[2])/Y,V[0]=(J+P)/2,V[1]=(p+r)/2,V[2]=(Y+ga)/2,F=Math.sqrt((V[0]-P)*(V[0]-P)+(V[1]-r)*(V[1]-r)+(V[2]-ga)*(V[2]-ga)))}k=E?E*V[0]:g;q=C?C*V[1]:q;f=m?m*V[2]:f;g=F*E;U=F*C;S=F*m;P=new Float32Array([e,l,n]);g=new Float32Array([g,U,S]);f=new Float32Array([k,q,f]);t=parseFloat(t.toFixed(3))}b.R=v;c.xY(b,t,t,v);v=B.Gz(u,P);b.wa=v;v=B.gq([g[0],0,0],[0,g[1],0],[0,0,g[2]],f);b.ba=v;da.D(a);if(Z.debug_view)for(k=
0;k<d.length;k++)if("DEBUG_VIEW"===d[k].type&&d[k].Li){a=x.Xu(1,v.F);D.kL(a,[v.Ga[0],v.Ha[1],v.Ia[2]],v.F);D.px(a,1,!0);a.qa.a_polyindex=D.Pu(a);c.VZ(d[k],a);break}};a.Ub=n;a.RI=function(a,b,c){b=ca[b]||[];for(var d=[],g=0;g<b.length;g++){var q=b[g];if((q.k.Ue==c||-1==c)&&q.Kj)for(var f=q.I,e=0;e<f.length;e++)f[e].yb==a&&d.push(q)}return d};a.cm=function(a){var b=ca.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var g=b[d];g.k.Ue==a&&c.push(g)}return c};a.Wn=function(a){var b=ca.MESH;if(b)for(var c=
0;c<b.length;c++){var d=b[c];if(m.ig(d))for(var g=d.I,q=0;q<g.length;q++)if(g[q].yb==a)return d}return null};a.dZ=function(a){var b=n(a,"LAMP",-1);if(b.length==a.s.i7){for(var c=[],d=0;d<b.length;d++){var g=b[d],g=z.ka(g,a);c[g.wm]=d}for(d=0;d<c.length-1;d++)for(g=d+1;g<c.length;g++){var q=b[c[d]].ub,f=b[c[g]].ub;if(f.$m&&f.bn&&(!q.$m||!q.bn)||!q.$m&&(f.$m||!q.bn&&f.bn))q=c[d],c[d]=c[g],c[g]=q}for(d=0;d<c.length;d++)g=b[c[d]],z.ka(g,a).wm=d,P.gp(b[c[d]],a)}};a.mw=function(a,b,c,d){for(var g=0;g<a.I.length;g++)for(var q=
a.I[g].W,f=0;f<q.length;f++){var e=q[f];e.Ca.Yf=b;e.Yf=b;e.zb.Yf=c;""!==e.nk&&(e=I.EI(e.nk))&&(e.LG=d)}};a.SI=function(){var a=[],b=ca.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.Dk&&d.Kj&&a.push(d)}return a};a.s5=function(){var a=[],b=ca.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.Vc&&d.Kj&&a.push(d)}return a};a.xc=function(b,c,d,g){var q=null,f=ca.ALL;switch(b){case a.my:q=l(c,f,!0,d,g);break;case a.ly:a:{for(b=0;b<f.length;b++)if(q=f[b],q.Dm==d&&(q.k.Ue==g||-1==g)){var e=z.Ri(q);
if(e&&e.Dm==c)break a}q=null}break;case a.Oc:a:{for(g=0;g<f.length;g++){b=f[g];for(var q=c.length-1,e=b,u=!0;0<=q&&u;)u=e&&e.Dm==c[q]&&(e.k.Ue==d||-1==d),e&&(e=z.Ri(e)),q--;if(u&&!e){q=b;break a}}q=null}}return q};a.iv=function(a,b){return l("%meta_world%"+a,ca.WORLD,!0,b)};a.fs=function(b,c){var d=P.Rh();if(!d)return O.error("No active scene"),null;var g=u.jX(b,c);if(g)return g;g=P.kX(d,b,c);if(!g)return null;for(var d=n(d,"MESH",-1),q=0;q<d.length;q++){var e=d[q].k,f=e.Nj;if(f&&3>Math.abs(255*f[0]-
g[0])&&3>Math.abs(255*f[1]-g[1])&&3>Math.abs(255*f[2]-g[2]))return e.Vc&&e.qw&&(E.outlining_overview_mode?a.yn(d[q],E.rk,E.tk,E.uk):(g=e.ai,a.yn(d[q],g.rk,g.tk,g.uk))),d[q]}return null};a.TL=function(a,c){for(var d=n(a,"EMPTY",-1),g=0;g<d.length;g++){var q=d[g];if(q.Pn&&"WIND"===q.Pn.type){var e=q;break}}if(!e)return O.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=T.Cb(c.wind_dir),N.set(Math.sin(d),-Math.cos(d),0,sa),T.EA(sa,T.nc,pa),da.gi(e,pa));"number"==typeof c.wind_strength&&
(e.Pn.vM=c.wind_strength);b(e)};a.ts=function(a){G.KR(a)&&G.remove(a);var b=ca.ALL,c=ca[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.bX=f;a.cX=function(a){return ca[a.type]&&-1<ca[a.type].indexOf(a)}};b4w.module.__animation=function(a,h){function p(a,b){var c=a.ja[b];c&&c.UA&&c.dr&&(c.dr=!1,c.UA(a,b))}function e(a,b,c){c=a.ja[c];c.type=30;var d=b.va,g=b.ab-d+1;c.start=d;c.length=g;c.Bf=d;c.Bi=b.name;for(g=d=0;g<a.Zc.length;g++){var q=a.Zc[g];if(q==b)break;else d+=q.ab-q.va+1}c.rN=d}function b(a,b){a.type=50;a.Bi=b.name;a.start=b.va;a.length=b.ab-a.start;b.ze||(a.length+=b.NB)}function y(a){return a.replace(/_B4W_BAKED$/,"")}function r(a,b){return{po:a,action:b}}function A(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.s.type&&b.push(r(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var g=a[d];if(g.node_group){var q=g.node_group.node_tree;if(q){var e=c.slice();e.push(g.name);A(q,b,e)}}}}function k(a){return E.$d(a)&&a.k.Zc?!0:!1}function w(a,b,c){var d=a.ja;if(-1==c)for(c=0;8>c;c++){var g=d[c];g&&(g.Bf=b,l(a,0,c,!0))}else if(g=d[c])g.Bf=b,l(a,0,c,!0)}function n(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function l(a,b,c,d){D(a,b,c,d);p(a,c);a.k.Ai&&(I(a,b),L(a,
b))}function f(a,b,g,e){var f=g.frame_range;if(f[0]>f[1])return q.warn('Incompatible action "'+g.name+'" has been applied to object "'+a.name+'"'),!1;var C=g.s,u=a.ja[e];u.Bi=g.name;u.lz=f;u.BF=C.DK;u.zF=C.dG;u.Fi.set(C.Fi);u.start=f[0];u.length=f[1]-f[0];u.Bf=f[0];switch(C.type){case 10:if(E.om(a)){u.type=10;var t=v(a,b,g);if(!t){for(var t=a.k.Hg,f=[],m=[],H=g.s.oC,V=0;V<H;V++){for(var Y in t){var l=t[Y],n=l.tx,F=g.s.Cz[Y];F?ya.copy(F.subarray(8*V,8*V+8),n):ya.identity(n);l.ux=!1}l=z(t);f.push(l.trans);
m.push(l.Eb)}t={trans:f,Eb:m};c(a,b,g,t)}u.trans=t.trans;u.Eb=t.Eb;b=t;u=a.k;t=u.Mo;f=a.ja[e];Y=f.vD;a:{m=u.bx;for(H=0;H<m.length;H+=2)if(g==m[H]){m=m[H+1];break a}m=null}if(m)f.vD=m;else{for(f=0;f<t.length;f++){m=t[f].Di;H=[];V=[];l=b.trans;n=b.Eb;for(F=0;F<l.length;F++){var k=d(l[F],n[F],m);H.push(k.trans);V.push(k.Eb)}Y.push({trans:H,Eb:V})}u.bx.push(g,Y)}u.Ai&&(g=u.ep,e>g[1]?(b=g[1],g[1]=e,g[0]=b):e>g[0]&&e<g[1]&&(g[0]=e),B(a))}break;case 40:E.Jr(a)&&(u.volume=C.rb.volume||null,u.pitch=C.rb.pitch||
null,u.type=40);break;case 70:E.Zg(a)&&(u.color=C.rb.color||null,u.Df=C.rb.energy||null,u.type=70);break;case 60:if("MESH"==a.type){u.type=60;Y=v(a,b,g);if(!Y){Y=[];f=[];m=[];H=[];V=[];l=g.s;n=b?b[0]:null;for(t in l.rb){F=b;k=t.match(/"(.*?)"/)[1];if(F&&1<F.length){for(var J=F[1],P=2;P<F.length;P++)J=J+"%join%"+F[P];J+="%join%"+k}else J=k;F=J;for(k=0;k<a.I.length;k++)for(J=a.I[k].W,P=0;P<J.length;P++){var U=J[P];if(!n||-1!=U.sd.indexOf(n)){var Z=U.cj,S=K(t,F,l,f,Y,U.dj),Z=K(t,F,l,H,m,Z);(S||Z)&&V.push(U)}}}Y=
{L_:Y,values:f,UX:m,VX:H,jw:V};c(a,b,g,Y)}u.dj=Y.L_;u.oK=Y.values;u.cj=Y.UX;u.nK=Y.VX;u.jw=Y.jw}break;case 20:if(t=C.rb.tsr){u.type=20;Y=v(a,b,g);if(!Y){Y=g.s.oC;f=[];m=[];for(H=0;H<Y;H++)f.push(t.subarray(8*H,8*H+4)),m.push(t.subarray(8*H+4,8*H+8));Y={trans:f,Eb:m};c(a,b,g,Y)}u.trans=Y.trans;u.Eb=Y.Eb;ca.pC(a)&&ca.z_(a,u.trans[0],u.Eb[0])}else return q.warn('Incompatible action "'+g.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:E.HB(a)&&(u.Df=C.rb["light_settings.environment_energy"]||
null,u.ke=C.rb.horizon_color||null,u.te=C.rb.zenith_color||null,u.hr=C.rb["mist_settings.intensity"]||null,u.fog_depth=C.rb["mist_settings.depth"]||null,u.fog_start=C.rb["mist_settings.start"]||null,u.fog_height=C.rb["mist_settings.height"]||null,u.PH=C.rb.b4w_fog_color||null,u.type=80)}E.om(a)&&10!=C.type&&Q(a,e);return!0}function v(a,b,c){a=a.Rt;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}function c(a,b,c,d){a.Rt.push(c,b?b.join("%join%"):
null,d)}function B(a){var b=a.k.ep;if(-1!=b[0]&&-1!=b[1]){var c=a.ja;a=c[b[1]].Bf;var d=Math.floor(a),g=a-d,b=c[b[0]];a=b.Bf;d=Math.floor(a);b.Bf=d+g}}function Q(a,b){var c=a.k.ep,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var g=a.ja;0<=d;d--){var q=g[d];if(q&&10==q.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function K(a,b,c,d,g,q){if(!q)return!1;for(var f=!1,e=0;e<q.length;e+=2)b==q[e]&&(g.push(q[e+1]),d.push(new Float32Array(c.rb[a])),f=!0);return f}function G(a){a=a.s;for(var b in a.rb)if(-1!=
b.indexOf("nodes"))return!0;return!1}function D(a,b,c,d){if((c=a.ja[c])&&null!=c.type&&(c.play||d)){var g=a.k,q=c.Bf,f=c.start,e=c.length,q=q+c.speed*b*aa.rd(),u=c.type,H=c.speed;if(0<=H&&q>=f+e||0>H&&q<f)switch(d||(c.dr=!0),c.behavior){case 10:q=0<=H?(q-f)%e+f:f+e-1E-6;break;case 20:q=0<=H?f:f+e-1E-6;c.play=!1;break;case 30:q=0<=H?f+e-1E-6:f,c.play=!1}c.Bf=q;switch(u){case 10:if(!g.Ai){d=R(c);b=d[0];var V=d[1];d=d[2];g.ne=c.Eb[b];g.Ge=c.Eb[V];g.se=c.trans[b];g.Je=c.trans[V];g.Ye=d;d=g.Mo;c=c.vD;
for(var Y=0;Y<d.length;Y++){var t=d[Y],m=c[Y];t.ne=m.Eb[b];t.Ge=m.Eb[V];t.se=m.trans[b];t.Je=m.trans[V];t.Ye=g.Ye}oa.D(a)}break;case 20:d=R(c);var g=M,V=d[0],Y=d[1],t=d[2],m=c.trans,l=m[V][1],q=m[V][2],f=m[Y][1],e=m[Y][2];g[0]=(1-t)*m[V][0]+t*m[Y][0];g[1]=(1-t)*l+t*f;g[2]=(1-t)*q+t*e;V=C;q=d[0];Y=d[1];t=d[2];m=c.Eb;l=za;l[0]=m[q][0];l[1]=m[q][1];l[2]=m[q][2];l[3]=m[q][3];q=ua;q[0]=m[Y][0];q[1]=m[Y][1];q[2]=m[Y][2];q[3]=m[Y][3];S.slerp(l,q,t,V);Y=d[2];t=c.trans;d=(1-Y)*t[d[0]][3]+Y*t[d[1]][3];a.parent&&
a.xw&&(Y=ja,ya.hi(g,d,V,Y),ya.multiply(a.xw,Y,Y),ya.hc(Y,g),ya.Xd(Y,V),d=ya.Yd(Y));c.ZD&&(Y=ea,oa.ie(a,Y),wa.jx(g,Y,b,c.ZD,g));c.IC&&(Y=za,oa.Sh(a,Y),wa.kM(V,Y,b,c.IC,V));q=c.Fi;q[0]&&oa.Yw(a,g);q[1]&&oa.Xw(a,V);q[2]&&oa.nD(a,d);oa.D(a);ha.H(a);break;case 30:d=c.Bf-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.rN;na[0]=a+c;na[1]=b+c;na[2]=d;d=na;g.Cx=d[0];g.Dx=d[2];break;case 40:d=R(c);b=d[0];g=d[1];d=d[2];c.volume&&sa.OY(a,(1-
d)*c.volume[b]+d*c.volume[g]);c.pitch&&sa.sX(a,(1-d)*c.pitch[b]+d*c.pitch[g]);break;case 50:b=10==c.behavior?(q-f)/aa.rd():q/aa.rd();ca.HY(a,c.Bi,b);break;case 60:d=R(c);b=d[0];g=d[1];d=d[2];m=c.oK;l=c.dj;a=c.nK;V=c.cj;Y=c.jw;for(c=0;c<l.length;c++)for(q=m[c],t=l[c],f=(1-d)*q[b]+d*q[g],q=0;q<Y.length;q++)Y[q].ej[t]=f;for(c=0;c<V.length;c++)for(m=a[c],t=V[c],m=la.lerp(m.subarray(3*b,3*b+3),m.subarray(3*g,3*g+3),d,M),q=0;q<Y.length;q++)Y[q].Ee[3*t]=m[0],Y[q].Ee[3*t+1]=m[1],Y[q].Ee[3*t+2]=m[2];break;
case 70:d=R(c);b=d[0];g=d[1];d=d[2];q=c.Fi;(e=c.Df)&&q[0]&&Z.Cs(a.ub,(1-d)*e[b]+d*e[g]);(c=c.color)&&q[1]&&(M[0]=(1-d)*c[3*b]+d*c[3*g],M[1]=(1-d)*c[3*b+1]+d*c[3*g+1],M[2]=(1-d)*c[3*b+2]+d*c[3*g+2],Z.Vw(a.ub,M));f=a.I;for(c=0;c<f.length;c++)U.j_(a,f[c].yb);break;case 80:d=R(c);b=d[0];g=d[1];d=d[2];q=c.Fi;f=a.I;H=U.La(f[0].yb,pa.Pb);e=c.Df;e=q[0]?(1-d)*e[b]+d*e[g]:H.Df;u=c.ke;q[1]?(M[0]=(1-d)*u[3*b]+d*u[3*g],M[1]=(1-d)*u[3*b+1]+d*u[3*g+1],M[2]=(1-d)*u[3*b+2]+d*u[3*g+2],u=M):u=H.ke;var E=c.te;q[2]?(ea[0]=
(1-d)*E[3*b]+d*E[3*g],ea[1]=(1-d)*E[3*b+1]+d*E[3*g+1],ea[2]=(1-d)*E[3*b+2]+d*E[3*g+2],H=ea):H=H.te;E=c.hr;q[3]&&(V=(1-d)*E[b]+d*E[g]);E=c.fog_depth;q[4]&&(Y=(1-d)*E[b]+d*E[g]);E=c.fog_start;q[5]&&(t=(1-d)*E[b]+d*E[g]);E=c.fog_height;q[6]&&(m=(1-d)*E[b]+d*E[g]);c=c.PH;q[7]&&(C[0]=(1-d)*c[3*b]+d*c[3*g],C[1]=(1-d)*c[3*b+1]+d*c[3*g+1],C[2]=(1-d)*c[3*b+2]+d*c[3*g+2],l=C);for(c=0;c<f.length;c++)b=a.I[c].yb,(q[0]||q[1]||q[2])&&U.Rw(b,e,u,H),q[3]&&U.zL(b,V),q[4]&&U.xL(b,Y),q[5]&&U.AL(b,t),q[6]&&U.yL(b,m),
q[7]&&U.eD(b,l);break;default:wa.q("Unknown animation type:"+u)}}}function R(a){var b=a.lz[0],c=a.lz[1]-b,b=a.Bf-b;0>b&&(b=0);b>=c&&(b=c);b/=a.BF;c=Math.floor(b);a=a.zF[c]?b-c:0;b=Math.ceil(c+a);na[0]=c;na[1]=b;na[2]=a;return na}function L(a,b){var c=a.k,d=c.Fh,g=c.ep,q=g[0],g=g[1];if(-1!=g){if(-1!=q){var f=a.ja[q];if(f.play||0==b){var e=R(f),t=e[0],H=e[1];c.Ye=e[2];var e=f.Eb[t],V=f.Eb[H],t=f.trans[t],H=f.trans[H]}else d=1}else d=1;g=a.ja[g];if(g.play||0==b){var q=R(g),Y=q[0],m=q[1];c.Ye=q[2]}else if(-1!=
q&&f.play)d=0;else return;q=g.Eb[Y];f=g.Eb[m];Y=g.trans[Y];m=g.trans[m];if(1==d)c.ne.set(q),c.Ge.set(f),c.se.set(Y),c.Je.set(m);else if(0==d)c.ne.set(e),c.Ge.set(V),c.se.set(t),c.Je.set(H);else{for(g=0;g<e.length;g+=4){for(var l=C,E=za,n=0;4>n;n++)l[n]=e[g+n],E[n]=q[g+n];S.slerp(l,E,d,l);for(n=0;4>n;n++)c.ne[g+n]=l[n];for(n=0;4>n;n++)l[n]=V[g+n],E[n]=f[g+n];S.slerp(l,E,d,l);for(n=0;4>n;n++)c.Ge[g+n]=l[n]}wa.gG(t,Y,d,c.se);wa.gG(H,m,d,c.Je)}oa.D(a);u.w_(a)}}function I(a,b){var c=a.k,d=c.Fh,g=c.Vp;
if(0!=g){var d=c.Up-d,q=g*b;wa.sign(d)==wa.sign(g)&&Math.abs(q)<Math.abs(d)?c.Fh+=q:(c.Fh=c.Up,c.Vp=0)}}function z(a){var b=[],c=[],d=new Float32Array(4),g=new Float32Array(4),q;for(q in a){var f=a[q],e=d,u=g,H=f.ku,V=H[H.length-1],Y=V.aE;V.ux||ya.identity(Y);for(V=H.length-1;0<=V;V--){var C=H[V],t=C.aE;if(C.ux)Y=t;else{var m=C.Tk,l=C.tx;ya.invert(m,ja);ya.multiply(l,ja,ja);ya.multiply(m,ja,ja);ya.multiply(Y,ja,t);Y=t;C.ux=!0}}H=C.aE;e[0]=H[0];e[1]=H[1];e[2]=H[2];e[3]=H[3];u[0]=H[4];u[1]=H[5];u[2]=
H[6];u[3]=H[7];S.normalize(u,u);f=f.Jj;for(e=0;4>e;e++)u=4*f+e,b[u]=d[e],c[u]=g[e]}return{trans:b,Eb:c}}function d(a,b,c){var d=[],g=[];new Float32Array(4);new Float32Array(4);for(var q in c)for(var f=c[q],e=f.Jj,f=f.BA,u=0;4>u;u++){var H=4*f+u,V=4*e+u;d[H]=a[V];g[H]=b[V]}d=new Float32Array(d);g=new Float32Array(g);return{trans:d,Eb:g}}function m(a){var b=a.s,c;if(b.Cz)c=10;else if(b.rb)if("volume"in b.rb||"pitch"in b.rb)c=40;else if(G(a))c=60;else{var d;a:{if(a.s.rb){d=a.fcurves;for(var g in d)if("color"==
g&&!d[g][3]){d=!0;break a}if("energy"==g){d=!0;break a}}d=!1}if(d)c=70;else if(d=a.s.rb,"light_settings.environment_energy"in d||"horizon_color"in d||"zenith_color"in d||"mist_settings.intensity"in d||"mist_settings.depth"in d||"mist_settings.start"in d||"mist_settings.height"in d||"b4w_fog_color"in d)c=80;else{a:{if(a.s.rb)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function G(a){if(a=a.s.rb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;
return!1}function O(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function x(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function g(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==
c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function P(a,b,c,d,g,q,f){var e=a+(b-a)/2,u=t(e,d,g,q,f)-c;return.02>Math.abs(u)?e:0<u?P(a,e,c,d,g,q,f):P(e,b,c,d,g,q,f)}function t(a,b,c,d,g){var q=1-a;return b*q*q*q+3*c*q*q*a+3*d*q*a*a+g*a*a*a}function da(a,b){var c={type:null,Bi:null,lz:null,BF:0,zF:null,Fi:new Int8Array(8),Eb:null,trans:null,vD:[],play:!1,behavior:20,Bf:0,start:0,length:0,ZD:0,IC:0,dr:!1,rN:null,speed:1,volume:null,pitch:null,color:null,Df:null,te:null,ke:null,hr:null,fog_depth:null,fog_start:null,
fog_height:null,PH:null,oK:[],dj:[],nK:[],cj:[],jw:null};if(!a.ja.length)for(var d=0;8>d;d++)a.ja.push(null);a.ja[b]=c;-1==xa.indexOf(a)&&xa.push(a)}function J(a,b){oa.D(a);ha.H(a);l(a,0,b,!0)}function F(a,c,d,g){g=g||0;if(E.$d(a)){var u=T(a,d);if(u)return da(a,g),e(a,u,g),J(a,g),!0;if((u=N(a,d))&&"EMITTER"==u.rw){da(a,g);c=u.name;d=g;for(var u=a.I,C=0;C<u.length;C++)for(var t=u[C].W,m=0;m<t.length;m++){var l=t[m].hb;l&&l.name==c&&b(a.ja[d],l)}J(a,g);return!0}}if(u=wa.Dd("name",d,ka)||wa.Dd("name",
d+"_B4W_BAKED",ka)){da(a,g);if(f(a,c,u,g))return J(a,g),!0;a.ja[g]=null}q.error('Unsupported object: "'+a.name+'" or animation name: "'+d+'"');return!1}function T(a,b){for(var c=0;c<a.Zc.length;c++){var d=a.Zc[c];if(d.name===b)return d}return null}function N(a,b){for(var c=a.I,d=0;d<c.length;d++)for(var g=c[d].W,q=0;q<g.length;q++){var f=g[q].hb;if(f&&f.name===b)return f}return null}function ba(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}
var u=h("__armature"),ga=h("__config"),Z=h("__lights"),E=h("__obj_util"),ca=h("__particles"),ha=h("__physics"),q=h("__print"),S=h("__quat"),X=h("__reformer"),U=h("__scenes"),sa=h("__sfx"),pa=h("__subscene"),aa=h("__time"),oa=h("__transform"),ya=h("__tsr"),wa=h("__util"),la=h("__vec3"),ia=ga.sl,ta=ga.Gi;a.AO=1E-6;a.UE=0;a.az=10;a.bz=20;a.XE=30;a.WE=40;a.VE=50;a.TE=60;a.VO=70;a.UO=80;a.od=0;a.cF=1;a.dF=2;a.eF=3;a.fF=4;a.gF=5;a.hF=6;a.Ht=7;a.kl=-1;a.rE=10;a.sE=20;a.Rx=30;var na=Array(3),M=new Float32Array(3),
ea=new Float32Array(3),C=new Float32Array(4),za=new Float32Array(4),ua=new Float32Array(4),ja=ya.create();new Float32Array(16);var xa=[],ka=[];a.BI=function(){return wa.trunc((ta.Tr-50)/4)};a.TH=function(a){return a/aa.rd()};a.update=function(a){for(var b=0;b<xa.length;b++){for(var c=xa[b],d=0;8>d;d++)D(c,a,d);c.k.Ai&&(I(c,a),L(c,a))}for(b=0;b<xa.length;b++)for(c=xa[b],d=0;8>d&&c.ja.length;d++)p(c,d)};a.LU=function(){return ka};a.gI=function(a){var b=[];if(k(a))for(var c=0;c<a.Zc.length;c++)b.push(a.Zc[c].name);
for(var d=[],c=0;c<ka.length;c++){var g=ka[c],q=g.s;20==q.type?d.push(g):60==g.s.type&&"MESH"==a.type?d.push(g):10==q.type&&"ARMATURE"==a.type?d.push(g):40==q.type&&"SPEAKER"==a.type?d.push(g):80==q.type&&"WORLD"==a.type&&d.push(g)}for(c=0;c<d.length;c++)b.push(y(d[c].name));if(ca.pC(a)&&ca.sK(a))for(a=a.I,c=0;c<a.length;c++)for(d=a[c].W,g=0;g<d.length;g++)(q=d[g].hb)&&b.push(q.name);return b};a.wM=y;a.hI=function(a,b){var c=a.ja[b];return c?c.type:0};a.Wt=function(a){for(var c=0,d=a.I,g=0;g<d.length;g++)for(var q=
d[g].W,u=0;u<q.length;u++){var C=q[u].hb;C&&"EMITTER"==C.rw&&!q[u].eg&&(da(a,c),b(a.ja[c],C),J(a,c),a.ja[c].behavior=C.ze?10:a.rl,c++)}d=a.Ng.slice();for(g=0;g<d.length;g++)u=d[g],q=u.po,u=u.action,da(a,c),f(a,q,u,c)?(J(a,c),a.ja[c].behavior=a.rl,c++):a.ja[c]=null;k(a)&&(da(a,c),e(a,a.Zc[0],c),J(a,c),a.ja[c].behavior=a.rl)};a.qz=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:wa.q("Wrong animation behavior")}};a.OU=function(a){var b=
[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],g=d.node_tree;g&&A(g,b,[d.name])}return b};a.wJ=r;a.play=function(a,b,c){n(a.ja,c,function(a){a.play=!0;a.UA=b?b:null;a.dr=!1});a.k.Ai&&B(a)};a.stop=function(a,b){n(a.ja,b,function(a){a.play=!1;a.UA=null;a.dr=!1})};a.fk=function(a,b){var c=a.ja;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.Fo=w;a.dD=function(a,b){b=b||0;n(a.ja,b,function(c){w(a,c.start,b)})};a.qI=function(a,b){var c=a.ja[b];
return c&&c.Bf?c.Bf:0};a.SV=function(a,b){var c=a.ja[b];return c&&10==c.behavior};a.Bs=function(a,b,c){n(a.ja,c,function(a){a.behavior=b})};a.kI=function(a,b){var c=a.ja[b];return c&&c.behavior};a.LF=function(a,b,c,d){n(a.ja,d,function(a){a.ZD=b||0;a.IC=c||0})};a.$K=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.ja[c]=null;else a.ja[b]=null;a.k.Ai&&Q(a,b)};a.m_=l;a.uK=function(a){if("ARMATURE"==a.type||a.Yt||"WORLD"==a.type)return!0;for(var b=0;b<a.Ng.length;b++){var c=a.Ng[b].action.s.type;if(20==
c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return ca.pC(a)&&ca.sK(a)||"MESH"==a.type&&a.Zc.length?!0:!1};a.nG=function(a,b){if("ARMATURE"==b.type||ba(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.Ng.length;c++){var d=b.Ng[c].action.s.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return ca.hR(a)&&ca.gR(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.Dc=function(a){return Boolean(a.ja.length)};a.rR=z;a.aU=d;a.jQ=
function(a){function b(a,c){for(var d=0;d<c;d++){var H=a.subarray(8*d+4,8*d+8);S.normalize(H,H)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,H=b;else-1<a.indexOf("rotation_quaternion")?(d=4,H=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,H=0):(d=0,H=b);return d+H}function d(a,b,c,H,g){if(-1<c.search(q)){a=b;c=c.split('"')[1];var V=f}else 8==g?(c="tsr",V=f):V=1<g?new Float32Array(g):0;if(!a[c]){g=a;b=c;if("object"==typeof V&&V.length)for(var e=V.length,Y=new Float32Array(H*e),u=0;u<H;u++)for(var C=
0;C<e;C++)Y[u*e+C]=V[C];else if("number"==typeof V)for(Y=new Float32Array(H),u=0;u<H;u++)Y[u]=V;else wa.q("Wrong storage default value");g[b]=Y}return a[c]}var q=new RegExp(/pose.bones\[\".+\"\]/g),f=ya.create(),e=a.s={type:0,oC:0,DK:0,rb:null,Cz:null,dG:null,Fi:new Int8Array(8)};e.DK=1/ia.Wl;var u=a.fcurves,C={},H={},V=0,Y;for(Y in u){var t=u[Y],l;for(l in t){var E=t[l],n=E.zf;X.DR(E,a);E=E.num_channels;V||(V=n.length);for(var E=d(C,H,Y,V,E),F=E.length/V,v=c(Y,l|0),k=0;k<V;k++)E[k*F+v]=n[k]}}if(wa.qr(C)){for(var J in C)"tsr"==
J&&b(C[J],V);e.rb=C}if(wa.qr(H)){for(var P in H)b(H[P],V);e.Cz=H}e.oC=V;e.dG=a.$P;"tsr"in C&&O(u,e.Fi);("color"in C||"energy"in C)&&x(u,e.Fi);("light_settings.environment_energy"in C||"horizon_color"in C||"zenith_color"in C||"mist_settings.intensity"in C||"mist_settings.depth"in C||"mist_settings.start"in C||"mist_settings.height"in C||"b4w_fog_color"in C)&&g(u,e.Fi);m(a);ka.push(a)};a.NU=function(a,b){return(b-a)*ia.Wl+1};a.JQ=function(a,b,c,d,g,q){var f=new Float32Array(2),e=new Float32Array(2),
u=new Float32Array(2),H=new Float32Array(2),V=b[1],Y=b[2],C=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var m=0,l=0,E=null;g<=q;g++)if(g<V)for(var n=0;n<ia.Wl;n++)c[m++]=Y;else if(g>C)for(n=0;n<ia.Wl;n++)c[m++]=a;else{var F=b[l],v=3;0===F&&(v+=2);0===E&&(v+=2);var k=2===F?0:1;if(b[l+1]==b[l+v+1])E=F,l+=v;else{n=0;g==b[l+1]&&(k&&(d[m]=1),c[m]=b[l+2],m++,n++);if(g==C)for(;n<ia.Wl;n++)c[m++]=a;else for(f[0]=b[l+1],f[1]=b[l+2],0!==F?(e[0]=0,e[1]=0):0===E?(e[0]=b[l+5],e[1]=b[l+6]):(e[0]=b[l+
3],e[1]=b[l+4]),0!==F?(u[0]=0,u[1]=0):(u[0]=b[l+v+3],u[1]=b[l+v+4]),H[0]=b[l+v+1],H[1]=b[l+v+2];n<ia.Wl;n++){var J=g+n/ia.Wl;switch(F){case 0:var U=f,Z=e,S=u,N=H,ga=[],r=[],x=void 0,T=void 0,p=void 0,x=void 0;ga[0]=U[0]-Z[0];ga[1]=U[1]-Z[1];r[0]=N[0]-S[0];r[1]=N[1]-S[1];p=N[0]-U[0];x=Math.abs(ga[0]);T=Math.abs(r[0]);0!=x+T&&x+T>p&&(x=p/(x+T),Z[0]=U[0]-x*ga[0],Z[1]=U[1]-x*ga[1],S[0]=N[0]-x*r[0],S[1]=N[1]-x*r[1]);k&&(d[m]=1);c[m]=t(P(0,1,J,f[0],e[0],u[0],H[0]),f[1],e[1],u[1],H[1]);m++;break;case 1:k&&
(d[m]=1);U=f[0];Z=f[1];S=(H[1]-Z)/(H[0]-U);c[m]=S*J+(Z-S*U);m++;break;case 2:k&&(d[m]=1);c[m]=b[l+2];m++;break;default:wa.q("Unknown keyframe interpolation mode: "+F)}}g+1==b[l+v+1]&&(E=F,l+=v)}}};a.apply=F;a.FQ=function(a,b,c,d){d=d||0;var g=wa.Dd("uuid",c,ka);if(g){da(a,d);if(f(a,b,g,d)){J(a,d);return}a.ja[d]=null}q.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.sN=function(a,b){var c=wa.Dd("name",b,ka)||wa.Dd("name",b+"_B4W_BAKED",ka);if(c){if(0==c.s.type)return!1}else if(!(N(a,
b)||E.$d(a)&&T(a,b)))return!1;return!0};a.gv=function(a,b){for(var c=a.ja,d=0;d<c.length;d++){var g=c[d];if(g&&y(g.Bi)==y(b))return d}return-1};a.MU=function(a,b){var c=a.ja[b];return c&&c.Bi?y(c.Bi):null};a.remove=function(a){a.ja.length=0;a=xa.indexOf(a);-1!=a&&xa.splice(a,1)};a.FX=function(a){for(var b=ka.length-1;0<=b;b--)ka[b].aQ==a&&ka.splice(b,1)};a.MF=function(a,b){if(!a.ja.length)return F(a,b,0)?0:-1;for(var c=0;c<a.ja.length;c++)if(!a.ja[c])return F(a,b,c)?c:-1};a.KL=function(a,b,c){a.k.Vp=
(b-a.k.Fh)/c;a.k.Up=b};a.ML=function(a,b,c){n(a.ja,c,function(a){a.speed=b})};a.VI=function(a,b){return a.ja[b].speed};a.aB=function(a,b){return a.ja[b].start};a.$A=function(a,b){return a.ja[b].length};a.ua=function(){xa.length=0;ka.length=0};a.gU=function(a){var b=(a[0]||a[1]||a[2]).zf.length,c=C,d=M,g=Boolean(a[0]);g||(a[0]={zf:new Float32Array(b),num_channels:8});var q=Boolean(a[1]);q||(a[1]={zf:new Float32Array(b),num_channels:8});var e=Boolean(a[2]);e||(a[2]={zf:new Float32Array(b),num_channels:8});
a[3]={zf:new Float32Array(b),num_channels:8};for(var f=0;f<b;f++)d[0]=g?a[0].zf[f]:0,d[1]=q?a[1].zf[f]:0,d[2]=e?a[2].zf[f]:0,wa.Wj(d,c),a[0].zf[f]=c[3],a[1].zf[f]=c[0],a[2].zf[f]=c[1],a[3].zf[f]=c[2]};a.mI=ba;a.YY=function(a,b){for(var c=7,d=0,g=0;g<ka.length;g++){var q=ka[g];if(q.name==b){d=q.s.type;break}}0==d&&(T(a,b)?d=30:(g=N(a,b))&&"EMITTER"==g.rw&&(d=50));for(g=0;8>g;g++)if(q=a.ja[g]){if(q.type==d)return g}else g<c&&(c=g);return c}};b4w.module.__armature=function(a,h){function p(a){a=a.k;for(var b=a.Mo,f=a.$v,e=0;e<b.length;e++){for(var l=b[e],n=f[e],v=0;v<n.length;v+=2)for(var k=n[v],r=n[v+1],p=0;4>p;p++)l.ne[k+p]=a.ne[r+p],l.Ge[k+p]=a.Ge[r+p],l.se[k+p]=a.se[r+p],l.Je[k+p]=a.Je[r+p];l.Ye=a.Ye}}function e(a,b,f,l){var v=a.YM,k=a.Tk,r=a.vx,p=a.BK;p?(p=p.vx,b?y.multiply(p,v,r):(b=n,y.invert(p,b),y.multiply(b,r,v))):b?y.copy(v,r):y.copy(r,v);v=w;y.invert(k,v);y.multiply(r,v,v);k=a.Jj;f[4*k]=v[0];f[4*k+1]=v[1];f[4*k+2]=v[2];f[4*
k+3]=v[3];l[4*k]=v[4];l[4*k+1]=v[5];l[4*k+2]=v[6];l[4*k+3]=v[7];a=a.BH;for(k=0;k<a.length;k++)r=a[k],r.pc||e(r,!0,f,l)}var b=h("__util"),y=h("__tsr"),r=h("__quat"),A=h("__mat4"),k=h("__vec3"),w=y.create(),n=y.create(),l=new Float32Array(4),f=new Float32Array(4),v=new Float32Array(4);a.Wk=function(a,f){for(var e=a.data.bones,l=a.pose.bones,n={},v=0;v<l.length;v++){var r=l[v],p=r.bone,h=p.name,z=n[h]={Jj:0,zN:-1,BK:null,BH:[],ku:[],pc:null,$D:y.create(),YM:y.create(),Tk:y.create(),vx:y.create(),tx:y.create(),
aE:y.create(),ux:!1,FM:new Float32Array(3)},h=new Float32Array(p.matrix_local),d=new Float32Array(16);A.invert(h,d);var r=new Float32Array(r.matrix_basis),m=z.FM;k.subtract(b.Ef(p.tail_local),b.Ef(p.head_local),m);b.M_(m,d,m);y.Qi(h,z.Tk);y.Qi(r,z.tx);y.copy(z.Tk,z.vx)}for(v=0;v<e.length;v++){h=e[v].name;r=b.Dd("name",h,l);z=n[h];p=r.parent_recursive;z.ku.push(z);for(d=0;d<p.length;d++)r=p[d],r=r.name,r=n[r],z.ku.push(r);p.length?(r=p[0],r=r.name,r=n[r],z.BK=r,y.invert(r.Tk,w),y.multiply(w,z.Tk,z.$D),
r.BH.push(z)):y.copy(z.Tk,z.$D);z.Jj=v;z.name=h;y.multiply(z.$D,z.tx,z.YM)}f.k.Hg=n};a.Zu=function(a,b,e,k){var p=a.k,h=p.Ye;b=p.Hg[b];var R=b.Jj;a=b.Tk;var L=p.se,I=p.Je,z=p.ne,p=p.Ge,d=L[4*R+1],m=L[4*R+2],O=L[4*R+3],x=I[4*R+1],g=I[4*R+2],P=I[4*R+3];l[0]=(1-h)*L[4*R]+h*I[4*R];l[1]=(1-h)*d+h*x;l[2]=(1-h)*m+h*g;l[3]=(1-h)*O+h*P;f[0]=z[4*R];f[1]=z[4*R+1];f[2]=z[4*R+2];f[3]=z[4*R+3];v[0]=p[4*R];v[1]=p[4*R+1];v[2]=p[4*R+2];v[3]=p[4*R+3];r.slerp(f,v,h,f);h=w;y.IY(l,h);y.Jk(f,h);e?(e=n,y.translate(a,b.FM,
e),y.multiply(h,e,h)):y.multiply(h,a,h);y.copy(h,k)};a.fY=function(a,b,f){var l=a.k;b=l.Hg[b];var n=l.se,v=l.ne;y.copy(f,b.vx);e(b,!1,n,v);l.Ye=0;p(a)};a.w_=p;a.a_=e;a.FR=function(a,b){return b in a.k.Hg}};b4w.module.__config=function(a,h){function p(){return b4w.module_check(a.Fe.gu)}function e(){for(var e=a.Fe,p=null,k=document.getElementsByTagName("script"),h=0;h<k.length;h++){for(var n=k[h].src,l=0;l<e.KJ.length;l++)if(0<=n.indexOf(e.KJ[l])){p=n;break}if(null!==p)break}p||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),p=document.location.href);e=p.indexOf("?");0<=e&&(p=p.substring(0,e));return p.substring(0,p.lastIndexOf("/"))}var b=h("__print"),
y=h("__util");a.Mp=1;a.jl=2;a.qn=3;a.bF=4;a.Lp=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.XG=y.S(a.context);a.B={alpha_sort:!0,alpha_sort_threshold:.1,ym:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,RH:1,pU:5,background_color:[0,0,0,0],canvas_resolution_factor:1,ap:3,allow_cors:!1,QH:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,w3:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,FN:!1,fr:!0,sw:!0,hd:!0,water_dynamic:!0,Kk:!0,ax:!0,jN:!0,precision:"highp",quality:a.jl,Tt:!0,ZW:!1,qD:!1,FA:!1,yN:!1,is_mobile_device:!1,xB:!1,Uz:!1,Y8:!1,zs:!1,allow_hidpi:!1,aM:!1,cC:!1,enable_selectable:!0,enable_outlining:!0,Ui:!0,Xn:!1,OH:!1,SB:[0,0],br:!1,QK:!0,cx:!1,url_params:null,ec:!0,Fc:4,Fq:!1,iL:!1,jL:!1,UC:!1,JG:!1,vJ:!1,media_auto_activation:!0,dK:4,Wv:!1,gl_debug:!1,DG:!1,EF:!1,nz:!1,Gq:"dds",T8:"16x",srgb_type:"SRGB_SIMPLE",pz:!1};a.yH=y.S(a.B);
a.sl={Uu:-1,UH:!1,Wl:1};a.controls={VW:1/120};a.Pd={path:"",iX:"B4W_ASSETS_PATH=__JS__/../../../deploy/assets\/",AX:"B4W_PROJ_ASSETS_PATH=__JS__/../assets\/",PW:15,prevent_caching:!0,bC:!1,AA:!1,Cw:!1};a.QF=y.S(a.Pd);a.Fe={shaders_path:"",UY:"../shaders/",ZL:"include/",S8:"postprocessing/",gu:"built_in_data",KJ:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js project_ow.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.CV={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Vi:.064,Hj:.035,Ck:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],hn:.11,bk:.062,Ij:.004}};a.C={enabled:!0,max_fps:60,Ts:"",D_:"B4W_URANIUM_PATH=uranium.js",Iz:!1,ping:!1,bt:!0};a.CK=y.S(a.C);a.Eo={zr:1024,Au:256,pH:32,rT:128,qT:256,EK:.25,qX:.5,pX:1};a.mL=y.S(a.Eo);a.X={oE:!0,cw:!1,UF:!1,KG:!1,DH:!1};a.XL=y.S(a.X);a.Vc={outlining_overview_mode:!1,hj:[1,.4,.05],rk:.2,tk:3.8,uk:1};
a.Tq={enabled:!1,wZ:0,vZ:0,XY:"COLOR"};a.wH=y.S(a.Tq);a.Gi={OW:8,Yv:64,ZB:8,Zv:8,$B:15,eK:0,Tr:128,Zi:1024,WB:4096,Ec:4096,aC:[4096,4096]};a.WG=y.S(a.Gi);a.zn=function(){var b=a.B,e=a.C,k=a.Eo;switch(b.quality){case a.qn:b.shadows=!0;b.Kk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.fr=!0;b.sw=!0;b.hd=!0;k.zr=2048;k.Au=512;b.ap=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.ax=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Ui=!0;b.Fc=16;b.srgb_type="SRGB_PROPER";e.max_fps=120;break;case a.jl:b.shadows=!0;b.Kk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.fr=!0;b.sw=!0;b.hd=!0;k.zr=1024;k.Au=256;b.ap=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.ax=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Ui=!0;b.srgb_type="SRGB_SIMPLE";
b.Fc=4;e.max_fps=60;break;case a.Mp:b.shadows=!1;b.Kk=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.fr=!1;b.sw=!1;b.hd=!1;k.zr=512;k.Au=256;b.ap=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.ax=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.Ui=!1;b.srgb_type="SRGB_SIMPLE";b.Fc=1;e.max_fps=60;break;case a.Lp:y.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(e,p){switch(e){case "allow_cors":a.B.allow_cors=p;break;case "allow_hidpi":a.B.allow_hidpi=p;break;case "alpha":a.context.alpha=p;break;case "alpha_sort":a.B.alpha_sort=p;break;case "alpha_sort_threshold":a.B.alpha_sort_threshold=p;break;case "anaglyph_use":b.TT();a.B.stereo=p?"ANAGLYPH":a.B.stereo;break;case "animation_framerate":a.sl.Uu=p;break;case "anisotropic_filtering":a.B.anisotropic_filtering=p;break;case "antialiasing":a.B.antialiasing=p;break;case "assets_dir":case "assets_path":a.Pd.path=
p;break;case "assets_dds_available":a.Pd.AA=p;break;case "assets_pvr_available":a.Pd.Cw=p;break;case "assets_min50_available":a.Pd.bC=p;break;case "audio":a.X.oE=p;break;case "background_color":a.B.background_color=p;break;case "bloom":a.B.bloom=p;break;case "built_in_module_name":a.Fe.gu=p;break;case "canvas_resolution_factor":a.B.canvas_resolution_factor=p;break;case "console_verbose":a.B.console_verbose=p;break;case "compositing":a.B.compositing=p;break;case "dof":a.B.dof=p;break;case "do_not_load_resources":a.B.do_not_load_resources=
p;break;case "god_rays":a.B.god_rays=p;break;case "stereo":a.B.stereo=p;break;case "max_fps":a.B.max_fps=p;break;case "max_fps_physics":a.C.max_fps=p;break;case "media_auto_activation":a.B.media_auto_activation=p;break;case "motion_blur":a.B.motion_blur=p;break;case "physics_enabled":a.C.enabled=p;break;case "physics_uranium_path":a.C.Ts=p;break;case "physics_calc_fps":a.C.Iz=p;break;case "physics_use_workers":a.C.bt=p;break;case "precision":a.B.precision=p;break;case "prevent_caching":a.Pd.prevent_caching=
p;break;case "quality":a.B.quality=p;break;case "reflections":a.B.reflections=p;break;case "refractions":a.B.refractions=p;break;case "sfx_mix_mode":a.X.cw=p;break;case "shaders_dir":case "shaders_path":a.Fe.shaders_path=p;break;case "shadows":a.B.shadows=p;break;case "show_hud_debug_info":a.B.show_hud_debug_info=p;break;case "smaa":a.B.smaa=p;break;case "smaa_search_texture_path":a.Fe.smaa_search_texture_path=p;break;case "smaa_area_texture_path":a.Fe.smaa_area_texture_path=p;break;case "ssao":a.B.ssao=
p;break;case "debug_view":a.B.debug_view=p;break;case "enable_selectable":a.B.enable_selectable=p;break;case "enable_outlining":a.B.enable_outlining=p;break;case "outlining_overview_mode":a.Vc.outlining_overview_mode=p;break;case "glow_materials":a.B.Ui=p;break;case "url_params":a.B.url_params=p;break;case "use_min50":a.B.use_min50=p;break;case "gl_debug":a.B.gl_debug=p;break;case "srgb_type":a.B.srgb_type=p;break;default:b.error("Unknown config property: "+e)}};a.get=function(e){switch(e){case "allow_cors":return a.B.allow_cors;
case "allow_hidpi":return a.B.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.B.alpha_sort;case "alpha_sort_threshold":return a.B.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.B.stereo;case "animation_framerate":return a.sl.Uu;case "anisotropic_filtering":return a.B.anisotropic_filtering;case "antialiasing":return a.B.antialiasing;case "assets_dir":case "assets_path":return a.Pd.path;case "assets_dds_available":return a.Pd.AA;case "assets_pvr_available":return a.Pd.Cw;
case "assets_min50_available":return a.Pd.bC;case "audio":return a.X.oE;case "background_color":return a.B.background_color;case "bloom":return a.B.bloom;case "built_in_module_name":return a.Fe.gu;case "canvas_resolution_factor":return a.B.canvas_resolution_factor;case "console_verbose":return a.B.console_verbose;case "compositing":return a.B.compositing;case "dof":return a.B.dof;case "do_not_load_resources":return a.B.do_not_load_resources;case "is_mobile_device":return a.B.is_mobile_device;case "god_rays":return a.B.god_rays;
case "stereo":return a.B.stereo;case "max_fps":return a.B.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.B.media_auto_activation;case "motion_blur":return a.B.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.Ts;case "physics_calc_fps":return a.C.Iz;case "physics_use_workers":return a.C.bt;case "precision":return a.B.precision;case "prevent_caching":return a.Pd.prevent_caching;case "quality":return a.B.quality;case "reflections":return a.B.reflections;
case "refractions":return a.B.refractions;case "sfx_mix_mode":return a.X.cw;case "shaders_dir":case "shaders_path":return a.Fe.shaders_path;case "shadows":return a.B.shadows;case "show_hud_debug_info":return a.B.show_hud_debug_info;case "smaa":return a.B.smaa;case "smaa_search_texture_path":return a.Fe.smaa_search_texture_path;case "smaa_area_texture_path":return a.Fe.smaa_area_texture_path;case "ssao":return a.B.ssao;case "debug_view":return a.B.debug_view;case "enable_selectable":return a.B.enable_selectable;
case "enable_outlining":return a.B.enable_outlining;case "outlining_overview_mode":return a.Vc.outlining_overview_mode;case "glow_materials":return a.B.Ui;case "url_params":return a.B.url_params;case "use_min50":return a.B.use_min50;case "gl_debug":return a.B.gl_debug;case "srgb_type":return a.B.srgb_type;default:b.error("Unknown config property: "+e)}};a.reset=function(){for(var b in a.XG)a.context[b]=a.XG[b];for(b in a.yH)a.B[b]=a.yH[b];for(b in a.QF)a.Pd[b]=a.QF[b];for(b in a.CK)a.C[b]=a.CK[b];
for(b in a.mL)a.Eo[b]=a.mL[b];for(b in a.XL)a.X[b]=a.XL[b];for(b in a.wH)a.Tq[b]=a.wH[b]};a.SC=function(){for(var b in a.WG)a.Gi[b]=a.WG[b]};a.AJ=p;a.BY=function(){var b=a.Fe,h=a.C;p()||""!=b.shaders_path||(b.shaders_path=e()+"/"+b.UY);h.enabled&&""==h.Ts&&(h.Ts=e()+"/"+h.D_.replace("B4W_URANIUM_PATH=",""))};a.Yu=function(b){var p=a.Pd;if(p.path)return p.path;var k=p.iX,h="B4W_ASSETS_PATH=";b&&(k=p.AX,h="B4W_PROJ_ASSETS_PATH=",k=k.replace("__NAME__",b));k=k.replace(h,"");return k=k.replace("__JS__",
e())}};b4w.module.__obj_util=function(a,h){function p(a){a={type:a,Ue:0,n:k.Hl(),Qx:k.Hl(),pivot:new Float32Array(3),Vb:new Float32Array(3),ck:0,dk:0,Hv:!1,Iv:!1,Nj:null,ih:0,Rk:!1,pf:n.create(),use_panning:!1,vb:0,$k:1,Zk:1,al:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Cd:!1,dof_object:null,mb:null,la:null,tb:null,Cc:null,Bc:null,ce:null,Nh:!0,ai:{rk:1,tk:1,uk:0},Rd:-1,Ed:-1,rc:new Float32Array(4),Yl:0,Rl:0,co:!1,Rr:new Float32Array(3),
Sr:0,ef:-1,bh:0,dh:0,Kn:!1,He:!1,fe:!1,qe:!1,ee:!1,Hd:!1,Gd:!1,lh:"",rf:!1,ag:!1,hd:!1,Uh:!1,Dk:!1,pw:!1,Vc:!1,ow:!1,qw:!1,rm:!1,ho:!1,jr:!1,jn:0,th:0,uh:0,Pg:0,Og:0,Jg:0,Yi:"",Ae:{LB:"",KB:"",uC:""},wl:!1,rq:new Float32Array(3),Gg:!1,hq:!1,jq:"",iq:!1,Ye:0,Cx:0,Dx:0,eh:0,Xl:!1,Zc:!1,Le:!1,ii:[],hk:!1,Ai:!1,Fh:1,Vp:0,Up:1,ep:new Int8Array([-1,-1]),Mo:[],$v:[],bx:[],ne:null,Ge:null,se:null,Je:null,Hg:null,Di:null,ls:null,$p:null,Zp:null,vl:null,R:r.Qd(),Ua:r.Qd(),wa:r.Kh(),lb:r.Kh(),ba:r.Lg(),qb:r.Lg(),
zd:r.vu(),ZF:r.vu(),fq:null,dq:null,eq:null,hp:!0,Sf:!1,ww:0};n.copy(w.nc,a.pf);return a}function e(a){if(!(a instanceof Object))return a;var b=null,f=null,l=null,n=null,k=null,p=null;a.ya&&(b=a.ya,a.ya=null);a.Ld&&(f=a.Ld,a.Ld=null);a.Ig&&(l=a.Ig,a.Ig=null);a.jb&&(n=a.jb,a.jb=null);a.zb&&(k=a.zb,a.zb=null);a.Me&&(p=a.Me,a.Me=null);var h;h=a.constructor;switch(h){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:h=
new h(a);break;case Array:h=new h(a.length);for(var r=0;r<a.length;r++)h[r]=e(a[r]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:h=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:h=null;break;case Function:h=a;break;default:for(r in h=new h,a)h[r]=e(a[r])}b&&(h.ya=b,a.ya=b);f&&(h.Ld=f,a.Ld=f);l&&(h.Ig=l,a.Ig=l);n&&(h.jb=n,a.jb=n);k&&(h.zb=k,a.zb=k);p&&(h.Me=w.Sj(),a.Me=p);return h}function b(a,b){for(var e=a.I,f=0;f<e.length;f++){var l=e[f];if(l.yb==b)return l}return null}
function y(a){return a.xk?a.parent:a.parent?y(a.parent):null}var r=h("__boundings"),A=h("__config"),k=h("__tsr"),w=h("__util"),n=h("__vec3"),l=h("__vec4"),f=A.B;new Float32Array(4);new Float32Array(4);new Float32Array(4);k.create();k.create();a.Hp=-1;a.Mq=p;a.Vz=function(a){var b=p(a.type);b.Ue=a.Ue;k.copy(a.n,b.n);k.copy(a.Qx,b.Qx);n.copy(a.pivot,b.pivot);n.copy(a.Vb,b.Vb);b.ck=a.ck;b.dk=a.dk;b.Hv=a.Hv;b.Iv=a.Iv;a.Nj&&(b.Nj=n.clone(a.Nj));b.ih=a.ih;b.Rk=a.Rk;n.copy(a.pf,b.pf);b.use_panning=a.use_panning;
b.vb=a.vb;b.$k=a.$k;b.Zk=a.Zk;b.al=a.al;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Cd=a.Cd;b.dof_object=a.dof_object;b.mb=w.S(a.mb);b.la=w.S(a.la);b.tb=w.S(a.tb);b.Cc=w.S(a.Cc);b.Bc=w.S(a.Bc);b.ce=a.ce;b.Nh=a.Nh;b.ai.rk=a.ai.rk;b.ai.tk=a.ai.tk;b.ai.uk=a.ai.uk;b.Rd=a.Rd;b.Ed=a.Ed;b.rc=a.rc;
b.Yl=a.Yl;b.Rl=a.Rl;b.co=a.co;n.copy(a.Rr,b.Rr);b.Sr=a.Sr;b.ef=a.ef;b.bh=a.bh;b.dh=a.dh;b.Kn=a.Kn;b.He=a.He;b.fe=a.fe;b.qe=a.qe;b.ee=a.ee;b.Hd=a.Hd;b.Gd=a.Gd;b.lh=a.lh;b.rf=a.rf;b.ag=a.ag;b.hd=a.hd;b.Uh=a.Uh;b.Dk=a.Dk;b.pw=a.pw;b.Vc=a.Vc;b.ow=a.ow;b.qw=a.qw;b.rm=a.rm;b.ho=a.ho;b.jr=a.jr;b.jn=a.jn;b.th=a.th;b.uh=a.uh;b.Pg=a.Pg;b.Og=a.Og;b.Jg=a.Jg;b.Yi=a.Yi;b.Ae=a.Ae;b.wl=a.wl;n.copy(a.rq,b.rq);b.Gg=a.Gg;b.hq=a.hq;b.jq=a.jq;b.iq=a.iq;b.Ye=a.Ye;b.Cx=a.Cx;b.Dx=a.Dx;b.eh=a.eh;b.Xl=a.Xl;b.Zc=a.Zc;b.Le=
a.Le;b.ii=w.S(a.ii);b.hk=a.hk;b.Ai=a.Ai;b.Fh=a.Fh;b.Vp=a.Vp;b.Up=a.Up;b.ep.set(a.ep);b.Mo=w.S(a.Mo);b.$v=w.S(a.$v);b.bx=w.S(a.bx);b.ne=w.S(a.ne);b.Ge=w.S(a.Ge);b.se=w.S(a.se);b.Je=w.S(a.Je);b.Hg=w.S(a.Hg);b.Di=w.S(a.Di);b.ls=w.S(a.ls);b.$p=w.S(a.$p);b.Zp=w.S(a.Zp);b.vl=w.S(a.vl);r.Cn(a.R,b.R);r.Cn(a.Ua,b.Ua);r.cA(a.wa,b.wa);r.cA(a.lb,b.lb);r.aA(a.ba,b.ba);r.aA(a.qb,b.qb);b.fq=w.S(a.fq);b.dq=w.S(a.dq);b.eq=w.S(a.eq);b.hp=a.hp;b.Sf=a.Sf;b.ww=a.ww;return b};a.Lq=function(a,b,e){e||(e=a);return{name:a,
wj:w.XA(),Dm:e,type:b,Kj:!1,Sa:!1,Gr:!1,Ws:!1,k:null,pc:null,X:null,ub:null,Yt:null,anchor:null,Pn:null,bw:null,I:[],Zc:[],Te:w.Sj(),$z:w.Sj(),ja:[],ss:[],ng:[],Rt:[],oh:null,Om:[],parent:null,xk:!1,bs:"",Jx:null,xw:null,an:!1,bc:"",tu:"AUTO",af:!1,ig:!1,qm:!1,lG:!1,C:null,v:null,cg:null,of:null,Qn:null,AG:null,AC:[],jh:{es:"NO_COLLISION",Ys:!1,qN:!1,Zh:0,wN:0,vN:0,tH:0,gL:0,yW:!1,zW:!1,AW:!1,BW:!1,DW:!1,EW:!1,Cq:0,Aq:0,Dq:0,fE:!1,pu:"BOX",Us:!1},wK:{qx:0,tC:0,Lf:0,NC:0},rl:0,Ng:[],lC:!1,lK:!1,aw:[]}};
a.bA=function(a){return a instanceof Array?a.slice():a};a.l3=function(a){for(var b=[],f=0;f<a.length;f++){var l=a[f],n={},k;for(k in l)l[k]==l.Ua?n.Ua=e(l.Ua):l[k]==l.qb?n.qb=e(l.qb):n[k]=l[k];b.push(n)}return b};a.su=e;a.Sa=function(a){return a.Sa};a.TV=function(a){return"MESH"==a.type&&a.Sa};a.Yp=function(a,b){a.I.push({yb:b,Gv:!1,W:[],bi:[],Ji:null,sD:[],wm:0,tK:!1,da:[],$L:[]})};a.Ut=function(a,c,e){b(a,c).W.push(e)};a.I7=function(a,b){for(var e=a.I,f=0;f<e.length;f++)if(e[f].yb==b){e.splice(f,
1);break}};a.ka=b;a.eN=function(a,b){for(var e=0;e<a.length;e++)l.copy(b,a[e].k.rc)};a.ZC=function(a,b,e){for(var f=0;f<a.I.length;f++){var l=a.I[f];e&&l.yb!=e||(l.Gv=b)}};a.fv=function(a,b){for(var e=[],l=b?f.dK-1:f.dK,n=0;n<a.length;n++){var k=a[n];k.ub.bI&&e.length<l&&e.push(k)}return e.length?e:a[0]?[a[0]]:[]};a.UW=function(a,b){k.identity(b.n);b.Nj=null;a.k=b};a.FG=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var e=b.material-1,f=a.data.materials;if(0<=e&&e<f.length&&
("ADD"==f[e].game_settings.alpha_blend||"ALPHA"==f[e].game_settings.alpha_blend||"ALPHA_SORT"==f[e].game_settings.alpha_blend))return!0}return!1};a.PR=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var e=a[b].W,f=0;f<e.length;f++)for(var l=e[f].ib.Mi,n=0;n<l.length;n++){var k=l[n];if("USE_MODEL_TSR_INVERSE"==k[0]&&"1"==k[1])return!0}return!1};a.ZH=function(a,b){return a+"*"+b};a.II=function(a){return a.xk?null:a.parent};a.Ri=y;a.dB=function(a,b){for(var e=[],f=0;f<b.length;f++){var l=b[f];y(l)==
a&&e.push(l)}return e};a.iB=function(a){return a.k.Ue};a.$d=function(a){return"MESH"===a.type};a.om=function(a){return"ARMATURE"===a.type};a.Jr=function(a){return"SPEAKER"===a.type};a.xa=function(a){return"CAMERA"===a.type};a.Zg=function(a){return"LAMP"===a.type};a.bo=function(a){return"EMPTY"===a.type};a.I6=function(a){return"LINE"===a.type};a.HB=function(a){return"WORLD"===a.type}};b4w.module.__boundings=function(a,h){function p(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function e(){return{F:new Float32Array(3),Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function y(a,b){for(var d=a[0],c=a[1],e=a[2],f=a[0],l=a[1],m=a[2],n=3;n<a.length;n+=3)var u=a[n],k=a[n+1],p=a[n+2],d=Math.max(d,u),c=Math.max(c,k),e=Math.max(e,p),
f=Math.min(f,u),l=Math.min(l,k),m=Math.min(m,p);b.max_x=d;b.max_y=c;b.max_z=e;b.min_x=f;b.min_y=l;b.min_z=m;return b}function r(a,b){b||(b=new Float32Array(24));var d=a.max_x,c=a.max_y,e=a.max_z,f=a.min_x,l=a.min_y,m=a.min_z;b[0]=f;b[1]=l;b[2]=m;b[3]=d;b[4]=l;b[5]=m;b[6]=d;b[7]=c;b[8]=m;b[9]=f;b[10]=c;b[11]=m;b[12]=f;b[13]=l;b[14]=e;b[15]=d;b[16]=l;b[17]=e;b[18]=d;b[19]=c;b[20]=e;b[21]=f;b[22]=c;b[23]=e;return b}function A(){return{F:new Float32Array(3),Ya:0}}function k(a,b){b.F[0]=a.F[0];b.F[1]=
a.F[1];b.F[2]=a.F[2];b.Ya=a.Ya}function w(){return{Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),F:new Float32Array(3)}}function n(a,b){K.copy(a.Ga,b.Ga);K.copy(a.Ha,b.Ha);K.copy(a.Ia,b.Ia);K.copy(a.F,b.F);return b}function l(a){var b=w();n(a,b);return b}function f(a,b,d,c){return{Ga:new Float32Array(a),Ha:new Float32Array(b),Ia:new Float32Array(d),F:new Float32Array([c[0],c[1],c[2]])}}function v(a,b){var c=G.vR(a,d),c=b?G.oR(a,c,O):D.identity(O),c=G.jU(c,m);K.copy(a,L);K.transformMat3(L,
c,L);for(var e=L[0],l=e,n=L[1],k=n,p=L[2],h=p,u=0,ga=0,Z=0,E=0,v=0,r=0,q=3;q<a.length;q+=3)L[0]=a[q],L[1]=a[q+1],L[2]=a[q+2],K.transformMat3(L,c,L),u=L[0],ga=L[1],Z=L[2],u>e&&(e=u),u<l&&(l=u),ga>n&&(n=ga),ga<k&&(k=ga),Z>p&&(p=Z),Z<h&&(h=Z);n-=k;p-=h;e=Math.max(e-l,1E-9);n=Math.max(n,1E-9);p=Math.max(p,1E-9);l=D.identity(O);l[0]=0!=e?1/e:1E8;l[4]=0!=n?1/n:1E8;l[8]=0!=p?1/p:1E8;D.transpose(c,x);L[0]=a[0];L[1]=a[1];L[2]=a[2];K.transformMat3(L,c,L);K.transformMat3(L,l,L);K.transformMat3(L,x,L);u=L[0];
ga=L[0];Z=L[1];E=L[1];v=L[2];r=L[2];for(q=3;q<a.length;q+=3)L[0]=a[q],L[1]=a[q+1],L[2]=a[q+2],K.transformMat3(L,c,L),K.transformMat3(L,l,L),K.transformMat3(L,x,L),u=Math.max(u,L[0]),ga=Math.min(ga,L[0]),Z=Math.max(Z,L[1]),E=Math.min(E,L[1]),v=Math.max(v,L[2]),r=Math.min(r,L[2]);q=Math.sqrt((u-ga)*(u-ga)+(Z-E)*(Z-E)+(v-r)*(v-r))/2;q=Math.min(q,1);z[0]=(u+ga)/2;z[1]=(Z+E)/2;z[2]=(v+r)/2;u=z;l=D.identity(O);l[0]=e;l[4]=n;l[8]=p;K.transformMat3(u,c,u);K.transformMat3(u,l,u);K.transformMat3(u,x,u);l=[c[0],
c[3],c[6]];ga=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];K.scale(l,e*q,l);K.scale(ga,n*q,ga);K.scale(c,p*q,c);return f(l,ga,c,u)}function c(a,b,c){K.add(b,c,a.F);K.scale(a.F,.5,a.F);a.Ya=K.distance(a.F,b);return a}var B=h("__tsr"),Q=h("__util"),K=h("__vec3"),G=h("__math"),D=h("__mat3"),R=new Float32Array(24),L=new Float32Array(3),I=new Float32Array(3),z=new Float32Array(3),d=new Float32Array(3),m=new Float32Array(9),O=new Float32Array(9),x=new Float32Array(9);new Float32Array(9);a.Qd=p;a.vu=e;a.Cn=b;a.z2=
function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.a0=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Cl=function(a){var c=p();b(a,c);return c};a.pR=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.NA=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,f=a.min_y,l=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,
e);a.min_y=Math.min(b.min_y,f);a.min_z=Math.min(b.min_z,l)};a.YF=y;a.Al=function(a,b,c){c||(c=p());a=r(a,R);B.cp(a,b,a);return y(a,c)};a.LH=r;a.W8=function(a,b,c){c||(c=p());var d=b.min_x,e=b.max_x,f=b.min_y,l=b.max_y,m=b.min_z;b=b.max_z;if(d>=a.max_x||e<=a.min_x||f>=a.max_y||l<=a.min_y||m>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,e);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,l);
c.min_z=Math.max(a.min_z,m);c.max_z=Math.min(a.max_z,b);return c};a.k9=function(a,b,c){c||(c=p());var d=a.max_x-a.min_x,e=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*e;c.max_y=a.max_y+.5*(b-1)*e;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.lq=function(a,b,c){c||(c=A());B.Xc(a.F,b,c.F);b=B.Yd(b);c.Ya=a.Ya*(0>b?-b:b);return c};a.kq=function(a,b,c){c||(c=w());B.Xc(a.F,b,c.F);K.copy(a.Ga,c.Ga);K.copy(a.Ha,c.Ha);
K.copy(a.Ia,c.Ia);B.wd(c.Ga,b,c.Ga);B.wd(c.Ha,b,c.Ha);B.wd(c.Ia,b,c.Ia);return c};a.Dz=function(a,b,c){c||(c=e());B.Xc(a.F,b,c.F);K.copy(a.Ga,c.Ga);K.copy(a.Ha,c.Ha);K.copy(a.Ia,c.Ia);B.wd(c.Ga,b,c.Ga);B.wd(c.Ha,b,c.Ha);B.wd(c.Ia,b,c.Ia);return c};a.Gz=function(a,b){var c=A();K.copy(b,c.F);c.Ya=a;return c};a.WX=function(a,b,c,d,f){var l=e();K.copy(a,l.F);K.copy(b,l.Ga);K.copy(c,l.Ha);K.copy(d,l.Ia);K.scale(l.Ga,f[0],l.Ga);K.scale(l.Ha,f[1],l.Ha);K.scale(l.Ia,f[2],l.Ia);return l};a.Kh=A;a.cA=k;a.Lg=
w;a.aA=n;a.xq=l;a.Dl=function(a){var b=A();k(a,b);return b};a.gq=f;a.ZQ=function(){var a;a||(a=A());K.set(0,0,0,a.F);a.Ya=1E12;return a};a.VT=function(a,b){var c=K.subtract(b.F,a.F,K.create());0==K.length(c)&&K.set(1,0,0,c);var d=K.normalize(c,K.create()),c=K.scale(d,a.Ya,K.create());K.add(c,a.F,c);var e=K.scale(d,-a.Ya,K.create());K.add(e,a.F,e);var f=K.scale(d,b.Ya,K.create());K.add(f,b.F,f);var l=K.scale(d,-b.Ya,K.create());K.add(l,b.F,l);c=[c,e,f,l];d=K.normalize(d,K.create());e=c[0];f=c[0];for(l=
1;l<c.length;l++){var m=K.dot(c[l],d);m<K.dot(e,d)&&(e=c[l]);m>K.dot(f,d)&&(f=c[l])}d=[e,f];c=d[0];d=d[1];a.F=K.scale(K.add(c,d,K.create()),.5,K.create());a.Ya=K.length(K.subtract(d,c,K.create()))/2};a.RA=function(a,b){K.add(a.F,a.Ha,L);K.add(L,a.Ga,L);K.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);K.add(a.F,a.Ha,L);K.add(L,a.Ga,L);K.subtract(L,a.Ia,L);b.push(L[0],L[1],L[2]);K.add(a.F,a.Ha,L);K.subtract(L,a.Ga,L);K.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);K.add(a.F,a.Ha,L);K.subtract(L,a.Ga,L);K.subtract(L,a.Ia,
L);b.push(L[0],L[1],L[2]);K.subtract(a.F,a.Ha,L);K.add(L,a.Ga,L);K.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);K.subtract(a.F,a.Ha,L);K.add(L,a.Ga,L);K.subtract(L,a.Ia,L);b.push(L[0],L[1],L[2]);K.subtract(a.F,a.Ha,L);K.subtract(L,a.Ga,L);K.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);K.subtract(a.F,a.Ha,L);K.subtract(L,a.Ga,L);K.subtract(L,a.Ia,L);b.push(L[0],L[1],L[2])};a.uu=v;a.mS=function(a){var b=e();K.copy(a.Ga,b.Ga);K.copy(a.Ha,b.Ha);K.copy(a.Ia,b.Ia);K.copy(a.F,b.F);return b};a.Jq=function(a){var b=A(),c=
0,c=K.length(a.Ga),d=K.length(a.Ha),e=K.length(a.Ia),c=c>d?c:d;b.F=a.F;b.Ya=e>c?e:c;return b};a.mR=function(a,b){var c=l(a),e=B.hc(b,d);K.subtract(c.F,e,c.F);return c};a.EB=function(a,b){var c=K.length(a.Ga),d=K.length(a.Ha),e=K.length(a.Ia);return.75*b.Ya*b.Ya*b.Ya>c*d*e};a.$F=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d-2*a);return{Ya:a,height:e,F:new Float32Array([0,0,(c+d)/2])}};a.bG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d);return{Ya:a,height:e,F:new Float32Array([0,0,
(c+d)/2])}};a.aG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d);return{Ya:a,height:e,F:new Float32Array([0,0,(c+d)/2])}};a.L2=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.DX=function(a){for(var b=0,c=0,d=0,e=0,f=0,l=0,m=0,n=0,u=0,k=0,p=0,E=0,h=0,x=0,q=0;q<a.submeshes.length;q++){var S=a.submeshes[q];if(S.position.length){b=e=S.position[0];c=f=S.position[1];d=l=S.position[2];break}}for(q=0;q<a.submeshes.length;q++){for(var S=
a.submeshes[q],r=S.position,m=k=S.position[0],n=p=S.position[1],u=E=S.position[2],U=0;U<r.length/3;U++)var O=r[3*U],w=r[3*U+1],z=r[3*U+2],b=Math.max(O,b),c=Math.max(w,c),d=Math.max(z,d),e=Math.min(O,e),f=Math.min(w,f),l=Math.min(z,l),m=Math.max(O,m),n=Math.max(w,n),u=Math.max(z,u),k=Math.min(O,k),p=Math.min(w,p),E=Math.min(z,E),h=Math.max(Math.sqrt(O*O+w*w+z*z),h),x=Math.max(Math.sqrt(O*O+w*w),x);r=S.boundings.bb;r.max_x=m;r.min_x=k;r.max_y=n;r.min_y=p;r.max_z=u;r.min_z=E;r=R;r[0]=k;r[1]=p;r[2]=E;
r[3]=m;r[4]=p;r[5]=E;r[6]=m;r[7]=n;r[8]=E;r[9]=k;r[10]=n;r[11]=E;r[12]=k;r[13]=p;r[14]=u;r[15]=m;r[16]=p;r[17]=u;r[18]=m;r[19]=n;r[20]=u;r[21]=k;r[22]=n;r[23]=u;m=v(r,!1);S.boundings.be_cen=m.F;S.boundings.be_ax=[m.Ga[0],m.Ha[1],m.Ia[2]]}q=a.b4w_boundings.bb;q.max_x=b;q.min_x=e;q.max_y=c;q.min_y=f;q.max_z=d;q.min_z=l;q=a.b4w_boundings.bb_src;q.max_x=b;q.min_x=e;q.max_y=c;q.min_y=f;q.max_z=d;q.min_z=l;a.b4w_boundings.bs_rad=h;a.b4w_boundings.bc_rad=x;r=R;r[0]=e;r[1]=f;r[2]=l;r[3]=b;r[4]=f;r[5]=l;r[6]=
b;r[7]=c;r[8]=l;r[9]=e;r[10]=c;r[11]=l;r[12]=e;r[13]=f;r[14]=d;r[15]=b;r[16]=f;r[17]=d;r[18]=b;r[19]=c;r[20]=d;r[21]=e;r[22]=c;r[23]=d;m=v(r,!1);a.b4w_boundings.be_cen=m.F;a.b4w_boundings.be_ax=[m.Ga[0],m.Ha[1],m.Ia[2]]};a.cV=function(a){var b=a.subarray(0,3),d=a.subarray(6,9),e=a.subarray(12,15),f=a.subarray(18,21);a=K.subtract(d,b,L);K.normalize(a,a);var l=Q.mV(b,d,e,I),l=K.cross(l,a,l);K.normalize(l,l);var m=K.create(),n=K.create();K.subtract(d,b,z);n[0]=K.dot(z,a);n[1]=K.dot(z,l);d=K.create();
K.subtract(e,b,z);d[0]=K.dot(z,a);d[1]=K.dot(z,l);e=K.create();K.subtract(f,b,z);e[0]=K.dot(z,a);e[1]=K.dot(z,l);f=A();e=[m,n,d,e];m=c(f,e[0],e[1]);for(f=2;f<e.length;f++)if(K.distance(m.F,e[f])>m.Ya){for(var k=m,m=e,n=e[f],d=f-1,k=c(k,n,m[0]),u=1;u<=d;u++)if(K.distance(k.F,m[u])>k.Ya){for(var p=k,k=m,Z=n,E=m[u],h=u-1,p=c(p,Z,E),x=0;x<=h;x++)if(K.distance(p.F,k[x])>p.Ya){var q=Z,S=E,r=k[x],U=K.subtract(S,r,z),U=K.squaredLength(U),v=K.subtract(q,r,z),O=K.squaredLength(v),v=K.subtract(q,S,z),w=K.squaredLength(v),
v=U*(O+w-U),B=O*(w+U-O),U=w*(U+O-w),O=v+B+U;K.copy(q,p.F);K.scale(p.F,v/O,p.F);K.scaleAndAdd(p.F,S,B/O,p.F);K.scaleAndAdd(p.F,r,U/O,p.F);p.Ya=K.distance(p.F,q)}k=p}m=k}f=m;a=K.scale(a,f.F[0],z);K.scaleAndAdd(a,l,f.F[1],a);K.add(a,b,f.F);return f}};b4w.module.__particles=function(a,h){function p(){l.q("_rand() undefined")}function e(a,b,e,f,l,k){var d=a.Gu,m=a.Rg,p=a.time;a=a.KK;for(var h=0;h<d.length;h+=4){var g=d[h];if(p>a&&p>=g&&g>a||p<a&&(g>a||p>=g))for(g=0;8>g;g++)m[8*h+g]=f[g],B[g]=f[g];else for(g=0;8>g;g++)B[g]=m[8*h+g];g=Q;g[0]=b[3*h];g[1]=b[3*h+1];g[2]=b[3*h+2];n.Xc(g,B,g);l[3*h]=g[0];l[3*h+1]=g[1];l[3*h+2]=g[2];var r=c;r[0]=e[4*h];r[1]=e[4*h+1];r[2]=e[4*h+2];r[3]=e[4*h+3];n.NZ(r,B,r);k[4*h]=r[0];k[4*h+1]=r[1];k[4*h+2]=r[2];k[4*h+3]=
r[3];for(g=1;4>g;g++)l[3*(h+g)]=l[3*h],l[3*(h+g)+1]=l[3*h+1],l[3*(h+g)+2]=l[3*h+2],k[4*(h+g)]=r[0],k[4*(h+g)+1]=r[1],k[4*(h+g)+2]=r[2],k[4*(h+g)+3]=r[3]}}function b(a){a?(l.nZ(a),p=function(){return l.CX()}):p=function(){return Math.random()}}var y=h("__config"),r=h("__batch"),A=h("__geometry"),k=h("__textures"),w=h("__time"),n=h("__tsr"),l=h("__util"),f=h("__vec3"),v=y.B,c=new Float32Array(4),B=new Float32Array(8),Q=new Float32Array(3),K=[];a.update=function(){for(var a=0;a<K.length;a++)for(var b=
K[a],c=b.I,f=0;f<c.length;f++)for(var l=b,n=c[f].W,d=0;d<n.length;d++){var m=n[d],k=m.hb;k&&k.zx&&!m.eg&&(e(k,k.positions,k.IM,l.k.n,k.DC,k.MD),k.kK=!0)}};a.pC=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].W,e=0;e<c.length;e++)if(c[e].hb)return!0;return!1};a.sK=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].W,e=0;e<c.length;e++){var f=c[e].hb;if(f&&"EMITTER"==f.rw)return!0}return!1};a.hR=function(a){return 0<a.particle_systems.length};a.gR=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.zV=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.KV=function(a,b,c){var e=a.hb={name:b.name,rw:b.settings.type,time:0,KK:-1,zx:!1,va:0,ab:0,OM:0,NB:0,UJ:0,ze:0,Zh:0,mC:0,iJ:0,Ul:0,Ff:0,GN:0,size:0,GF:0,FF:0,SG:0,RG:new Float32Array(16),kK:!1,positions:null,DC:null,IM:null,MD:null,Gu:null,CA:null,Rg:null,xK:null,MM:0,NM:0};e.va=b.settings.frame_start;
e.ab=b.settings.frame_end;e.OM=(e.ab-e.va)/w.rd();e.NB=b.settings.lifetime;e.UJ=e.NB/w.rd();e.ze=b.settings.b4w_cyclic?1:0;e.Zh=b.settings.mass;e.mC=b.settings.normal_factor;e.iJ=9.81*b.settings.effector_weights.gravity;e.Ul=b.settings.b4w_fade_in/w.rd();e.Ff=b.settings.b4w_fade_out/w.rd();e.GN=b.settings.effector_weights.wind;e.zx="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,n,d;a.Ar?(f=c.halo.size,n=c.halo.hardness,30>n?(n=.5,d=.9):40>n?(n=.1,d=1):50>n?(n=0,d=.8):(n=0,d=.5)):(f=b.settings.particle_size,
d=n=1);e.size=f;e.GF=n;e.FF=d;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(r.jf(a,"NODES",1),r.jf(a,"PARTICLE_BATCH",1),a.ak=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&v.Tt&&(b=b[0].texture,f=[],k.nR(b.color_ramp,k.aF,f),f=new Uint8Array(f.map(function(a){return l.U(255*a,0,255)})),f=k.ZG(f,k.aF),r.Gj(a,f,"u_color_ramp_tex",b.name),r.jf(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)n=c[f/4],a[f]=n.position,a[f+1]=n.color[0],a[f+2]=n.color[1],a[f+3]=n.color[2];e.SG=c.length}e.RG.set(a)};a.DU=function(a,c,n,k){var h=a.hb,r=k.n;k=n.settings.count;var d=n.settings.frame_start/w.rd(),m=n.settings.frame_end/w.rd(),v=n.settings.lifetime/w.rd(),x=n.settings.lifetime_random,g=n.settings.emit_from,
P=n.settings.factor_random;if(n.settings.use_rotations)var t=n.settings.angular_velocity_mode,B=n.settings.angular_velocity_factor;else t="NONE",B=0;var J=n.settings.b4w_randomize_emission,F=n.settings.b4w_cyclic;h.MM=n.settings.billboard_tilt;h.NM=n.settings.billboard_tilt_random;b(n.seed);var T;c=A.MH(c,["a_position","a_tbn_quat"],null);switch(g){case "VERT":var N=c.aa[0].a_position;T=c.aa[0].a_tbn_quat;n=N.length/3;c=[];for(g=0;g<k;g++){var ba=Math.round((n-1)*p());c.push(ba);c.push(ba);c.push(ba);
c.push(ba)}n=[];for(g=0;g<c.length;g++)n.push(N[3*c[g]]),n.push(N[3*c[g]+1]),n.push(N[3*c[g]+2]);N=new Float32Array(n);n=[];for(g=0;g<c.length;g++)n.push(T[4*c[g]]),n.push(T[4*c[g]+1]),n.push(T[4*c[g]+2]),n.push(T[4*c[g]+3]);T=new Float32Array(n);break;case "FACE":N=[];T=[];g=[];l.Ev(0,g);n=A.YA(c,k,!1,g);l.Ev(0,g);c=A.YA(c,k,!0,g);for(g=0;g<n.length;g++)N.push(n[g][0],n[g][1],n[g][2]),N.push(n[g][0],n[g][1],n[g][2]),N.push(n[g][0],n[g][1],n[g][2]),N.push(n[g][0],n[g][1],n[g][2]),T.push(c[g][0],c[g][1],
c[g][2],c[g][3]),T.push(c[g][0],c[g][1],c[g][2],c[g][3]),T.push(c[g][0],c[g][1],c[g][2],c[g][3]),T.push(c[g][0],c[g][1],c[g][2],c[g][3]);N=new Float32Array(N);T=new Float32Array(T);break;case "VOLUME":l.q("Particle emission from volume is not supported");break;default:l.q("Wrong emit from option")}T=[N,T];N=T[0];T=T[1];h.positions=new Float32Array(N);h.IM=new Float32Array(T);h.DC=new Float32Array(N.length);h.MD=new Float32Array(T.length);c=[];m=(m-d)/k;for(n=0;n<k;n++)g=J?m*n+10*m*(.5-p()):m*n,F||
(g+=d),c.push(g),c.push(g),c.push(g),c.push(g);d=new Float32Array(c);h.Gu=new Float32Array(d);h.CA=new Float32Array(d);if(h.zx){h.Rg=new Float32Array(8*d.length);for(J=0;J<8*d.length;J++)for(F=0;8>F;F++)h.Rg[8*J+F]=r[F];e(h,N,T,r,N,T)}r=A.If("EMITTER_PARTICLES");J=l.Mg();J.a_position=N;J.a_tbn_quat=T;r.aa[0]=J;a.Mh=A.ot;a=[];for(J=0;J<k;J++)a.push(4*J,4*J+2,4*J+1,4*J,4*J+3,4*J+2);a=new Uint16Array(a);r.na=a;r.qa.a_p_bb_vertex=A.XH(k);r.Ja=N.length/3;a=[];x*=v;for(J=0;J<k;J++)F=x*p(),a.push(v-F),a.push(v-
F),a.push(v-F),a.push(v-F);v=r.qa;x=[];for(J=0;J<k;J++)F=Math.random(),x.push(a[4*J],d[4*J],F),x.push(a[4*J+1],d[4*J+1],F),x.push(a[4*J+2],d[4*J+2],F),x.push(a[4*J+3],d[4*J+3],F);x=new Float32Array(x);v.a_p_data=x;v=r.qa;x=[];for(a=0;a<k;a++){d=[p()-.5,p()-.5,p()-.5];f.normalize(d,d);x.push(P*d[0]);x.push(P*d[1]);x.push(P*d[2]);switch(t){case "NONE":x.push(0);break;case "SPIN":case "VELOCITY":x.push(B);break;case "RAND":x.push(2*B*(p()-.5));break;default:l.q("Undefined velocity factor")}d=x.slice(-4);
for(J=0;12>J;J++)x.push(d[J%4])}k=new Float32Array(x);v.a_p_vels=k;h.xK=new Float32Array(r.qa.a_p_data);return r};a.HY=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,l=0;l<f.length;l++){var d=f[l].hb;d&&d.name==b&&!f[l].eg&&(d.KK=d.time,d.time=c)}};a.wX=function(a){for(var b=a.Ja,c=a.aa[0].a_position,e=[],f=[],l=0;l<b;l++)f.push(c[3*l]),e.push(c[3*l+1]),f.push(c[3*l+2]);e=new Float32Array(e);f=new Float32Array(f);a.qa.a_lf_dist=e;a.qa.a_lf_bb_vertex=f;return a};a.K8=function(a,
b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,l=0;l<f.length;l++){var d=f[l].hb;d&&d.name==b&&(d.size=c)}};a.u8=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,l=0;l<f.length;l++){var d=f[l].hb;d&&d.name==b&&(d.mC=c)}};a.g8=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,l=0;l<f.length;l++){var d=f[l],m=d.hb;if(m&&m.name==b){var n=m.Gu;if(1==c)var k=n;else if(0==c)for(var k=m.CA,g=0;g<k.length;g+=4)k[g]=1E4,k[g+1]=k[g],k[g+2]=k[g],k[g+3]=k[g];else for(var p=
4/c,k=m.CA,t=0,g=0;g<k.length;g+=4)g>=t?(k[g]=n[g],t+=p):k[g]=1E4,k[g+1]=k[g],k[g+2]=k[g],k[g+3]=k[g];d=d.Ca;if(d.kd.a_p_data){m=m.xK;for(g=0;g<m.length;g+=3)m[g+1]=k[Math.round(g/3)];A.d_(d,m)}}}};a.z_=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,l=0;l<f.length;l++){var d=f[l].hb;if(d&&d.zx)for(var m=0;m<8*d.Gu.length;m++)d.Rg[8*m]=b[0],d.Rg[8*m+1]=b[1],d.Rg[8*m+2]=b[2],d.Rg[8*m+3]=b[3],d.Rg[8*m+4]=c[0],d.Rg[8*m+5]=c[1],d.Rg[8*m+6]=c[2],d.Rg[8*m+7]=c[3]}};a.r_=function(a,b,c){for(var e=
[],f=0;f<c;f++)e.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.qa.a_tbn_quat=new Float32Array(e);if(b.cs){e=[];for(f=0;f<c;f++)e.push(f,f,f,f);a.qa[b.cs.name]=new Float32Array(e)}};a.q_=function(a){-1==K.indexOf(a)&&K.push(a)};a.HX=function(a){a=K.indexOf(a);-1!=a&&K.splice(a,1)};a.ua=function(){K.length=0}};b4w.module.__batch=function(a,h){function p(a){a={type:a,Fb:"",id:0,zq:-1,pk:"",Cu:-1,Hn:-1,Rq:0,Cf:0,Ml:[],ya:[],Ld:[],Ig:[],sd:[],Oj:[],xj:null,$c:{},zb:null,ib:{yg:null,Xe:null,Mi:[],og:[],status:ia.gz,qU:0,O_:0,TF:0,KM:0},nk:"",cq:[],Ca:null,Me:C.Sj(),Le:!1,Li:!1,Du:!1,Yr:0,Cm:0,Ov:0,Pv:0,hd:!1,lv:0,yr:0,je:new Float32Array(3),ye:new Float32Array(16),Eg:!1,Lb:!1,Va:!1,vh:!1,Zb:!1,Ke:!1,ag:!1,He:!1,qe:!1,fe:!1,ee:!1,Hd:!1,Gd:!1,Iu:!1,Mh:ea.nn,sf:!1,eg:!1,Tj:!1,Kg:!1,ef:sa.Hp,bh:0,dh:0,Rd:-1,Ed:-1,
qv:!1,uv:0,rv:0,vv:0,wv:0,tv:new Float32Array(3),sv:new Float32Array(3),Ar:!1,Ej:0,Vj:0,Ol:1,zo:0,Po:0,Js:1,so:0,Nl:0,pl:1,kw:0,Ur:0,pg:0,Iw:0,Td:new Float32Array(2),Nk:new Float32Array(3),li:new Float32Array(3),Tm:new Float32Array(3),$f:new Float32Array(4),Pi:new Float32Array(4),vm:null,io:null,Nr:null,Mr:null,ak:!1,wireframe_edge_color:za.create(),yj:!1,water_dynamic:!1,gt:!1,Mx:!1,Nx:0,Ox:0,Lx:0,np:.1,Ho:0,Jo:0,Rn:0,Tu:new Float32Array(2),Su:new Float32Array(2),gr:new Float32Array(2),Go:new Float32Array(3),
Io:new Float32Array(3),fj:null,zk:!1,hb:null,Rv:0,ql:null,cs:null,ej:[],dj:[],Ee:[],cj:[],R:null,Ua:null,wa:null,lb:null,qb:null,ba:null,Sf:!1,Yf:!0,xJ:0,qo:new Float32Array(3)};a.$f[3]=1;a.Va=!0;a.Rv=1;return a}function e(a){var b=p(a.type);b.Fb=a.Fb;b.id=a.id;b.zq=a.zq;b.pk=a.pk;b.Cu=a.Cu;b.Hn=a.Hn;b.Rq=a.Rq;b.Cf=a.Cf;b.Ml=[];b.ya=a.ya.slice();b.Ld=a.Ld.slice();b.Ig=a.Ig.slice();b.sd=a.sd.slice();b.Oj=a.Oj.slice();b.xj=C.S(a.xj);b.$c=C.S(a.$c);b.zb=a.zb;b.ib=C.S(a.ib);b.nk=a.nk;b.cq=wa.cS(a.cq);
b.Ca=a.Ca;b.Le=a.Le;b.Li=a.Li;b.Du=a.Du;b.Yr=a.Yr;b.Cm=a.Cm;b.Ov=a.Ov;b.Pv=a.Pv;b.lv=a.lv;b.yr=a.yr;b.je=a.je;b.ye=a.ye;b.Eg=a.Eg;b.Lb=a.Lb;b.Va=a.Va;b.vh=a.vh;b.Zb=a.Zb;b.Ke=a.Ke;b.ag=a.ag;b.He=a.He;b.qe=a.qe;b.fe=a.fe;b.ee=a.ee;b.Hd=a.Hd;b.Gd=a.Gd;b.hd=a.hd;b.Iu=a.Iu;b.Mh=a.Mh;b.sf=a.sf;b.eg=a.eg;b.Tj=a.Tj;b.Kg=a.Kg;b.ef=a.ef;b.bh=a.bh;b.dh=a.dh;b.Rd=a.Rd;b.Ed=a.Ed;b.qv=a.qv;b.uv=a.uv;b.rv=a.rv;b.vv=a.vv;b.wv=a.wv;za.copy(a.tv,b.tv);za.copy(a.sv,b.sv);b.Ar=a.Ar;b.Ej=a.Ej;b.Vj=a.Vj;b.Ol=a.Ol;b.zo=
a.zo;b.Po=a.Po;b.Js=a.Js;b.so=a.so;b.Nl=a.Nl;b.pl=a.pl;b.kw=a.kw;b.Ur=a.Ur;b.pg=a.pg;b.Iw=a.Iw;b.Td[0]=a.Td[0];b.Td[1]=a.Td[1];za.copy(a.Nk,b.Nk);za.copy(a.li,b.li);za.copy(a.Tm,b.Tm);ua.copy(a.$f,b.$f);ua.copy(a.Pi,b.Pi);b.vm=C.S(a.vm);a.io&&(b.io=new Float32Array(a.io),b.Nr=new Float32Array(a.Nr),b.Mr=new Float32Array(a.Mr));b.ak=a.ak;za.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.yj=a.yj;b.water_dynamic=a.water_dynamic;b.gt=a.gt;b.Mx=a.Mx;b.Nx=a.Nx;b.Ox=a.Ox;b.Lx=a.Lx;b.np=a.np;b.Ho=
a.Ho;b.Jo=a.Jo;b.Rn=a.Rn;b.Tu.set(a.Tu);b.Su.set(a.Su);b.gr.set(a.gr);za.copy(a.Go,b.Go);za.copy(a.Io,b.Io);b.fj=C.S(a.fj);b.zk=a.zk;b.hb=C.S(a.hb);b.Rv=a.Rv;a.ql&&(b.ql=new Float32Array(a.ql));b.cs=C.S(a.cs);b.ej=C.S(a.ej);b.dj=C.S(a.dj);b.Ee=C.S(a.Ee);b.cj=C.S(a.cj);b.R=E.Cl(a.R);b.Ua=E.Cl(a.Ua);b.ba=E.xq(a.ba);b.qb=E.xq(a.qb);b.wa=E.Dl(a.wa);b.lb=E.Dl(a.lb);b.Sf=a.Sf;b.Yf=a.Yf;b.qo=a.qo;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.Fb=a.Lb?a.vh?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.Fb=a.qe?"CAST":"RECEIVE";break;case "COLOR_ID":a.Fb=a.vh?"COLOR_ID_XRAY":"COLOR_ID"}}function y(a,b,c){var d=[],g=k(c,b,!b.Kn,!1),e=a.data,q=e.materials,f=Array(q.length),l=Array(q.length),u=[],m=la.gc(c,ta.Pb),n=!1;m&&(n=m.Qr.length?!0:!1);for(var E=0;E<g.length;E++)for(var F=g[E],U=0;U<q.length;U++){var S=q[U];if(!ea.mJ(e,U))if("PHYSICS"==F&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)u.push(ea.SA(e,U,[],b.Di,{},null));else if(!S.b4w_lens_flares||n){var Z=p(F);
"MAIN"==F?f[U]=Z:"DEBUG_VIEW"==F&&(l[U]=Z);Z.zq=a.b4w_cluster_data.cluster_id;if(t(Z,S)){"SHADOW"==F&&f[U]&&(Z.Ke=f[U].Ke);Z.Mh=b.Le||b.ag?ea.ot:ea.nn;z(Z,b);for(var h=Z,J=a.particle_systems,r=0;r<J.length;r++){var v=J[r].settings.b4w_vcol_from_name,N=J[r].settings.b4w_vcol_to_name;""!==v&&""!==N&&(h.$c[v]={bm:!1,src:[{name:v,jg:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==Z.type)Z.pk=a.uuid;Z.Tj=a.b4w_do_not_cull;"MAIN"==Z.type&&(Z.Kg=a.b4w_caustics);x(Z,"DISABLE_FOG",("COLOR_ID"!=F&&"SHADOW"!=F&&a.b4w_disable_fogging)|
0);var ga=ea.SA(e,U,Z.Oj,b.Di,Z.$c,Z.xj);!S.use_tangent_shading||"a_shade_tangs"in ga.aa[0]||(x(Z,"CALC_TBN",1),O(Z,"a_tbn_quat"));S.b4w_lens_flares&&(ga=pa.wX(ga));da(Z);d.push({za:Z,ff:b,bu:b,Of:ga,kg:[S.name],Id:[a]})}}}if(u.length){Z=p("PHYSICS");Z.Fb="NAVMESH";Z.pk=a.uuid;for(var ga=ea.xM(u),T=[],E=0;E<q.length;E++)T.push(q[E].name);da(Z);d.push({za:Z,ff:b,bu:b,Of:ga,kg:T,Id:[a]})}for(E=0;E<l.length;E++)l[E]&&(l[E].Hn=f[E].id,da(l[E]));var B=a.particle_systems;if(0<B.length&&d.length){for(var ca=
!1,aa=!1,E=0;E<B.length;E++){var ba=B[E],oa=ba.settings;oa.use_render_emitter&&(ca=!0);"HAIR"!=oa.type||"OBJECT"!=oa.render_type&&"GROUP"!=oa.render_type&&ba.transforms.length||(aa=!0);if(ca&&aa)break}var I=d[0].za.$c,X;if(aa){var na;if(1<q.length){for(var D={},y=0;y<B.length;y++){var Q=B[y].settings;if("HAIR"==Q.type&&("OBJECT"==Q.render_type||"GROUP"==Q.render_type)){var K=Q.b4w_vcol_from_name,ua=Q.b4w_vcol_to_name;""!==K&&""!==ua&&(D[K]=C.S(I[K]))}}"a_bending_col_main"in I&&(D.a_bending_col_main=
C.S(I.a_bending_col_main));"a_bending_col_detail"in I&&(D.a_bending_col_detail=C.S(I.a_bending_col_detail));na=ea.MH(e,[],D)}else na=d[0].Of;X=na}else X=null;for(var G=X,A=a.pb,L=[],R=a.particle_systems,wa=a.data,xa=0;xa<R.length;xa++){var xb=R[xa],Wa=xb.settings;if(Wa.count)if("EMITTER"==Wa.type){if("DYNAMIC"==b.type){var Fa=p("PARTICLES");Fa.wa=b.wa;Fa.R=b.R;Fa.ba=b.ba;Fa.lb=b.lb;Fa.Ua=b.Ua;Fa.qb=b.qb;var yb,Rc=wa.materials,Xb=xb.settings.material-1;Xb>=Rc.length&&(ha.warn('Wrong material used for rendering particle system "'+
xb.name+'"'),Xb=0);yb=Rc[Xb];"HALO"===xb.settings.render_type&&"HALO"===yb.type&&(Fa.Ar=!0);w(Fa,yb);var ka=Fa,Pa=a,Ea=xb.settings;switch(Ea.b4w_billboard_align){case "VIEW":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:C.q("Wrong billboard align value")}x(ka,"BILLBOARD",0);var Ca=Ea.b4w_enable_soft_particles&&
sa.FG(Pa,Ea);x(ka,"SOFT_PARTICLES",0<Ea.b4w_particles_softness&&Ca&&ja.Hu?1:0);x(ka,"SOFT_STRENGTH",ia.N(Ea.b4w_particles_softness));ia.ia(ka.ib,"WORLD_SPACE","WORLD"==Ea.b4w_coordinate_system?1:0);Fa.ag=!0;Fa.Tj=a.b4w_do_not_cull;Fa.pk=A.name+"_"+Wa.uuid;pa.KV(Fa,xb,yb);var ma=pa.DU(Fa,wa,xb,A.k);pa.r_(ma,Fa,Wa.count);pa.q_(A);z(Fa,A.k);da(Fa);L.push({za:Fa,ff:b,bu:b,Of:ma,kg:[yb.name],Id:[a]})}}else if("HAIR"==Wa.type){var Ba=C.Ev(xb.seed),va=ya.GG(ja.SB)&&!Wa.b4w_initial_rand_rotation&&!Wa.b4w_hair_billboard,
cb=4;va&&(cb=8);if(xb.transforms.length)var Ga=xb.transforms;else for(var Ma=ea.YA(G,Wa.count,!1,Ba),Ga=new Float32Array(Ma.length*cb),ib=0;ib<Ma.length;ib++){var Ra=.75+.5*C.tg(Ba);Ga[ib*cb]=Ma[ib][0];Ga[ib*cb+1]=Ma[ib][1];Ga[ib*cb+2]=Ma[ib][2];Ga[ib*cb+3]=Ra;va&&(Ga[ib*cb+4]=1,Ga[ib*cb+5]=0,Ga[ib*cb+6]=0,Ga[ib*cb+7]=0)}var Cc=la.gc(c,ta.vi)?!0:!1;if("OBJECT"==Wa.render_type){var kc=[k(c,Wa.dupli_object.pb.k,!b.Kn,!0)],Qb=P(a,b,I,G,[Wa.dupli_object],kc,[Ga],Wa,xb,Cc,Ba,!1);L.push.apply(L,Qb)}else if("GROUP"==
Wa.render_type){for(var Pb=Wa.dupli_group.objects,kc=[],ib=0;ib<Pb.length;ib++){var lc=k(c,Pb[ib].pb.k,!b.Kn,!0);kc.push(lc)}for(var Gc=!1,Jb=[],ib=0;ib<Pb.length;ib++)Jb.push(Pb[ib].pb);if(Wa.use_whole_group){for(var mc,rb=Ga,db=Jb,ac=va,Yc=cb,Db={},Rb=new Float32Array([0,0,0,1]),gb=0;gb<rb.length;gb+=Yc)for(var ob=0;ob<db.length;ob++){var Hc=za.create();za.scale(M.G(db[ob].k.n),M.Yd(db[ob].k.n),Hc);var nc=za.clone([rb[gb],rb[gb+1],rb[gb+2]]);Db[ob]||(Db[ob]=new Float32Array(rb.length));ac&&(Db[ob][gb+
4]=Rb[0]=rb[gb+4],Db[ob][gb+5]=Rb[1]=rb[gb+5],Db[ob][gb+6]=Rb[2]=rb[gb+6],Db[ob][gb+7]=Rb[3]=rb[gb+7],C.HC(Rb,Rb),C.KZ(Hc,Rb,Hc));za.add(nc,Hc,nc);Db[ob][gb]=nc[0];Db[ob][gb+1]=nc[1];Db[ob][gb+2]=nc[2];Db[ob][gb+3]=rb[gb+3]}mc=Db;Gc=!0}else{var Ic;if(Wa.use_group_count){for(var Kb=Ga,oc=Jb,bc=Wa.dupli_weights,Za=Ba,cc=va,Lb=cb,tb={},pc=[],ub=0;ub<oc.length;ub++)for(var Mb=oc[ub],Sb=Mb.Dm||Mb.name,vc=0;vc<bc.length;vc++){var Jc=bc[vc];Sb==Jc.name&&pc.push(Jc)}bc.length!=pc.length&&ha.error("dupli weights match failed");
for(ub=0;ub<Kb.length;ub+=Lb){for(var Ia,fc=pc,Eb=[0],Fb=0;Fb<fc.length;Fb++)Eb[Fb+1]=Eb[Fb]+fc[Fb].count;for(var Dc=Eb[Eb.length-1]*C.tg(Za),Tb=0,Fb=0;Fb<Eb.length;Fb++)if(Dc>=Eb[Fb]&&Dc<Eb[Fb+1]){Tb=Fb;break}Ia=Tb;tb[Ia]=tb[Ia]||[];tb[Ia].push(Kb[ub],Kb[ub+1],Kb[ub+2],Kb[ub+3]);cc&&tb[Ia].push(Kb[ub+4],Kb[ub+5],Kb[ub+6],Kb[ub+7])}for(Ia in tb)tb[Ia]=new Float32Array(tb[Ia]);Ic=tb}else{for(var jb=Ga,hb=Ba,Ja=va,Yb=cb,Gb=Jb.length,Na={},Oa=0;Oa<jb.length;Oa+=Yb){var mb=Math.floor(Gb*C.tg(hb));Na[mb]=
Na[mb]||[];Na[mb].push(jb[Oa],jb[Oa+1],jb[Oa+2],jb[Oa+3]);Ja&&Na[mb].push(jb[Oa+4],jb[Oa+5],jb[Oa+6],jb[Oa+7])}for(mb in Na)Na[mb]=new Float32Array(Na[mb]);Ic=Na}mc=Ic}Qb=P(a,b,I,G,Pb,kc,mc,Wa,xb,Cc,Ba,Gc);L.push.apply(L,Qb)}"INSTANCE"==Wa.b4w_wind_bend_inheritance&&A.k.rf&&ha.warn('Emitter object "'+A.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else C.q("Unknown particle settings type")}ca?
d.push.apply(d,L):d=L}return d}function r(a){for(var b=[],c=[],d={},g=0;g<a.length;g++){var e=a[g].za,q=null;if(e.id in d){var f=d[e.id],l=c[f].za;J(e,function(a){J(l,function(b){C.rZ(a,b)&&1!=a.xJ&&(q=c[f])})});if(!q){do e.id++;while(d[e.id])}}q||(q={za:e,vK:[],XF:[],zM:[],Id:[],ZK:[],kg:[]},d[e.id]=c.length,c.push(q));if(a[g].Of&&a[g].Of.Ja){q.vK.push(a[g].ff);q.XF.push(a[g].bu);q.zM.push(a[g].Of);for(var u=0;u<a[g].Id.length;u++)e=a[g].Id[u],-1==q.ZK.indexOf(e.uuid)&&(q.Id.push(e),q.ZK.push(e.uuid));
for(u=0;u<a[g].kg.length;u++)e=a[g].kg[u],-1==q.kg.indexOf(e)&&q.kg.push(e)}q.kg.sort()}for(g=0;g<c.length;g++){var e=c[g].za,m=c[g].vK,n=c[g].XF,k=c[g].zM;a=sa.Vz(n[0]);if("STATIC"==a.type)for(u=0;u<m.length;u++){var t=m[u],F=n[u],d=k[u],p=M.identity(va);t.Gg&&!t.hq?(t=M.hc(t.n,Ea),M.kf(t,p)):M.copy(t.n,p);F.rm?d.Jf||(F.Gg?ea.tZ(d,p):ea.ox(d,p)):ea.ox(d,p);if(F.rm)x(e,"AU_QUALIFIER","GLSL_IN");else if(1<c[g].Id.length){t={};if(F.rf||F.Gg)t.au_center_pos=[p[0],p[1],p[2]];F.rf&&(t.au_wind_bending_amp=
[F.th],t.au_wind_bending_freq=[F.uh],t.au_detail_bending_amp=[F.Og],t.au_detail_bending_freq=[F.Pg],t.au_branch_bending_amp=[F.Jg]);ea.sZ(d,t);x(e,"AU_QUALIFIER","GLSL_IN")}else a.rq.set(p.subarray(0,3)),F.rq.set(p.subarray(0,3)),x(e,"AU_QUALIFIER","uniform")}if(0==k.length)d=ea.If(C.Qs("%empty"));else if(1==k.length)d=k[0];else{d=[];for(u=0;u<k.length;u++)ea.YV(k[u])||d.push(u);if(d.length<k.length)for(u=0;u<d.length;u++)ea.px(k[d[u]]);d=ea.xM(k)}if(1<c[g].Id.length){k=[];for(u=0;u<c[g].Id.length;u++)E.RA(c[g].Id[u].pb.k.ZF,
k);E.YF(k,a.Ua);E.Cn(a.Ua,a.R);a.qb=E.uu(C.Ef(k),!0);E.aA(a.qb,a.ba);a.lb=E.Jq(a.qb);E.cA(a.lb,a.wa)}a.Sf=E.EB(a.ba,a.wa);"STATIC"==a.type&&a.co&&(u=c[g].Id[0].b4w_cluster_data,u.cluster_center&&u.cluster_radius?(a.Rr.set(u.cluster_center),a.Sr=u.cluster_radius):(a.Rr.set(a.lb.F),a.Sr=a.lb.Ya));"PARTICLES"!=e.type&&(u=d.Pf,e.R=E.Cl(u.R),e.ba=E.xq(u.ba),e.wa=a.wa.Ya<u.wa.Ya?"STATIC"==a.type?E.Dl(a.lb):E.Dl(a.wa):E.Dl(u.wa),"STATIC"==a.type?(e.qb=e.ba,e.Ua=e.R,e.lb=e.wa):(u=a.n,e.qb=E.kq(e.ba,u),e.lb=
E.lq(e.wa,u),e.Ua=E.Al(e.R,u)),e.Sf=E.EB(e.ba,e.wa));b.push({za:e,k:a,Of:d,kg:c[g].kg,Id:c[g].Id})}return b}function A(a,b,c,d){a.fq=E.bG(b,d);a.dq=E.$F(c,d);a.eq=E.aG(b,d)}function k(a,b,c,d){var g=[];d||(b.Dk&&la.gc(a,ta.tf)||b.Vc&&la.gc(a,ta.Cg))&&g.push("COLOR_ID");c&&(g.push("MAIN"),g.push("NODES_GLOW"),la.gc(a,ta.wf)&&g.push("DEBUG_VIEW"),la.gc(a,ta.yf)&&g.push("SHADOW"),la.gc(a,ta.vi)&&g.push("GRASS_MAP"));g.push("PHYSICS");if(b.qe||b.Hd)for(a=null,b.qe&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),b.Hd&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?C.KQ(a,b):b),b=a,a=0;a<b.length;a++)c=g.indexOf(b[a]),-1!==c&&g.splice(c,1);return g}function w(a,b){var d;switch(a.type){case "MAIN":if(b.b4w_do_not_render)d=!1;else{if(b.use_nodes&&"HALO"!=b.type)K(a,b,"MAIN");else{f(a,b);d=b.game_settings.alpha_blend;a.vh=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.pg=b.offset_z;a.li.set([1,1,1]);var g=b.texture_slots;ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.$f);if(b.b4w_lens_flares){T(a,"lens_flares.glslv","lens_flares.glslf");O(a,"a_position");O(a,"a_texcoord");var e=na.he(g[0]),u=g[0].texture;N(a,e,"u_sampler",u.name)}else{T(a,"main.glslv","main_stack.glslf");b.use_shadeless||(d=U.lA(b.uuid,b.name,{Ke:b.use_shadeless,Vq:b.diffuse_shader,Ks:b.specular_shader,cn:b.use_tangent_shading}),a.ib.og=U.qu(d));var m=v("use_map_color_diffuse",g),k=v("use_map_color_spec",g),E=v("use_map_normal",g),t=v("use_map_mirror",g),F=v("use_stencil",g);d=m[0];
k=k[0];E=E[0];t=t[0];m=m[1];g=F[0]&&v("use_rgb_to_intensity",g)[0];if(d){u=d.texture;switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e=na.he(d);N(a,e,"u_colormap0",u.name);a.Nl=d.diffuse_color_factor;a.pl=d.use_map_alpha?d.alpha_factor:0;a.li.set(d.scale)}F=d&&d==k;k&&(F||(u=k.texture,e=na.he(k),N(a,e,"u_specmap0",u.name)),a.Po=k.specular_color_factor);if(E&&(u=E.texture,O(a,"a_tbn_quat"),
e=na.he(E),N(a,e,"u_normalmap0",u.name),a.kw=E.normal_factor,u.b4w_use_map_parallax&&ja.sw)){var e=ia.N(u.b4w_parallax_steps),p=ia.N(u.b4w_parallax_lod_dist);x(a,"PARALLAX",1);x(a,"PARALLAX_STEPS",e);x(a,"PARALLAX_LOD_DIST",p);a.so=u.b4w_parallax_scale}t&&(u=t.texture,e=na.he(t),N(a,e,"u_mirrormap",u.name),a.Ur=t.mirror_factor);if(t=d&&m&&g?1:0)e=na.he(m),u=m.texture,N(a,e,"u_colormap1",u.name),e=na.he(g),u=g.texture,N(a,e,"u_stencil0",u.name);(u=d||k||E)&&a.li.set(u.scale);x(a,"TEXTURE_SPEC",void 0==
k?0:1);x(a,"ALPHA_AS_SPEC",F?1:0);x(a,"TEXTURE_STENCIL_ALPHA_MASK",t);O(a,"a_position");O(a,"a_tbn_quat");(d||k||E)&&O(a,"a_texcoord");if(b.b4w_water){a.yj=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Lb?(ha.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.gt=!1):a.gt="REFLECT"!=a.Fb?b.b4w_water_shore_smoothing:!1;T(a,"water.glslv","water.glslf");t=U.lA(b.uuid,b.name,{Ke:!1,Vq:b.diffuse_shader,Ks:b.specular_shader,cn:b.use_tangent_shading});
a.ib.og=U.qu(t);O(a,"a_position");ja.FN?(O(a,"a_polyindex"),a.Va=!0,za.set(0,0,0,a.wireframe_edge_color),q.mB()?x(a,"DEBUG_WIREFRAME",1):x(a,"DEBUG_WIREFRAME",2)):x(a,"DEBUG_WIREFRAME",0);F=b.texture_slots;t=v("use_map_normal",F);e=v("use_map_mirror",F)[0];t.length&&(p=na.he(t[0]),u=t[0].texture,N(a,p,"u_normalmap0",u.name),a.np=b.b4w_water_norm_uv_velocity);x(a,"NUM_NORMALMAPS",t.length);a.fj=Array(t.length);for(u=0;u<t.length;u++)a.fj[u]=new Float32Array(2),a.fj[u].set([t[u].scale[0],t[u].scale[1]]);
e&&(p=na.he(e),u=e.texture,N(a,p,"u_mirrormap",u.name),a.Ur=e.mirror_factor);e=null;if(ja.fr)for(u=0;u<F.length;u++){var Z=F[u];if(!0===Z.texture.b4w_water_foam){e=Z;break}}e&&(x(a,"FOAM",1),p=na.he(e),u=e.texture,N(a,p,"u_foam",u.name),a.Rn=b.b4w_foam_factor,a.Tu.set(u.b4w_foam_uv_freq),a.Su.set(u.b4w_foam_uv_magnitude),a.gr[0]=e.scale[0],a.gr[1]=e.scale[1]);for(u=0;u<F.length;u++)if(Z=F[u],!0===Z.texture.b4w_shore_dist_map){var S=Z;break}S&&ja.Tt&&(F=na.he(S),u=S.texture,N(a,F,"u_shore_dist_map",
u.name),x(a,"SHORE_PARAMS",1),S=Z.texture.b4w_shore_boundings,x(a,"MAX_SHORE_DIST",ia.N(Z.texture.b4w_max_shore_dist)),x(a,"SHORE_MAP_SIZE_X",ia.N(S[0]-S[1])),x(a,"SHORE_MAP_SIZE_Y",ia.N(S[2]-S[3])),x(a,"SHORE_MAP_CENTER_X",ia.N((S[0]+S[1])/2)),x(a,"SHORE_MAP_CENTER_Y",ia.N((S[2]+S[3])/2)));b.b4w_generated_mesh?(x(a,"GENERATED_MESH",1),a.Mx=!0,a.Nx=b.b4w_water_num_cascads,a.Ox=b.b4w_water_subdivs,a.Lx=b.b4w_water_detailed_dist):(O(a,"a_tbn_quat"),(e||t.length)&&O(a,"a_texcoord"),x(a,"GENERATED_MESH",
0));if(b.b4w_water_dynamic){var Z=ia.N(b.b4w_water_dst_noise_scale0),S=ia.N(b.b4w_water_dst_noise_scale1),t=ia.N(b.b4w_water_dst_noise_freq0),F=ia.N(b.b4w_water_dst_noise_freq1),u=ia.N(b.b4w_water_dir_min_shore_fac),e=ia.N(b.b4w_water_dir_freq),p=ia.N(b.b4w_water_dir_noise_scale),h=ia.N(b.b4w_water_dir_noise_freq),J=ia.N(b.b4w_water_dir_min_noise_fac),r=ia.N(b.b4w_water_dst_min_fac),ga=ia.N(b.b4w_water_waves_hor_fac);x(a,"DST_NOISE_SCALE_0",Z);x(a,"DST_NOISE_SCALE_1",S);x(a,"DST_NOISE_FREQ_0",t);
x(a,"DST_NOISE_FREQ_1",F);x(a,"DIR_MIN_SHR_FAC",u);x(a,"DIR_FREQ",e);x(a,"DIR_NOISE_SCALE",p);x(a,"DIR_NOISE_FREQ",h);x(a,"DIR_MIN_NOISE_FAC",J);x(a,"DST_MIN_FAC",r);x(a,"WAVES_HOR_FAC",ga)}B(a,b);Q(a,b);a.Go.set(b.b4w_shallow_water_col);a.Io.set(b.b4w_shore_water_col);a.Ho=b.b4w_shallow_water_col_fac;a.Jo=b.b4w_shore_water_col_fac;x(a,"ABSORB",ia.N(b.b4w_water_absorb_factor));x(a,"SSS_STRENGTH",ia.N(b.b4w_water_sss_strength));x(a,"SSS_WIDTH",ia.N(b.b4w_water_sss_width))}"HALO"===b.type&&(T(a,"halo.glslv",
"halo.glslf"),n(a,b),a.Oj=["a_position"]);b.use_tangent_shading&&(x(a,"USE_TBN_SHADING",1),O(a,"a_shade_tangs"));x(a,"TEXCOORD",0);x(a,"NORMAL_TEXCOORD",0);d&&l(a,d,"TEXTURE_COLOR0_CO");m&&l(a,m,"TEXTURE_COLOR1_CO");g&&l(a,g,"TEXTURE_STENCIL_ALPHA_MASK_CO");k&&l(a,k,"TEXTURE_SPEC_CO");E&&l(a,E,"TEXTURE_NORM_CO");x(a,"SHADELESS",b.use_shadeless?1:0);a.Ke=b.use_shadeless}d=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===d?0:1);x(a,"ALPHA_CLIP","CLIP"===d?1:0);x(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);b.use_vertex_color_paint?(x(a,"VERTEX_COLOR",1),O(a,"a_color")):x(a,"VERTEX_COLOR",0);a.Ej=b.ambient;a.Ol=b.diffuse_intensity;a.Vj=b.emit;a.Tm.set(b.specular_color);a.Js=b.specular_alpha;B(a,b);Q(a,b);b.b4w_wettable?x(a,"WETTABLE",1):x(a,"WETTABLE",0);c(a,b);b.b4w_refractive&&!a.Lb?(ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.zk=!1):a.zk=b.b4w_refractive;a.Iw=b.b4w_refr_bump}d=!0}break;case "NODES_GLOW":d=K(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||
b.b4w_do_not_render||"HALO"===b.type)d=!1;else if(f(a,b),a.Lb)d=!1;else{k=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==k?K(a,b,"SHADOW"):T(a,"shadow.glslv","shadow.glslf");ua.set(0,0,0,b.alpha,a.$f);O(a,"a_position");O(a,"a_tbn_quat");x(a,"ALPHA","OPAQUE"===k?0:1);a.li.set([1,1,1]);if((d=v("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===k){switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.li.set(d.scale);
x(a,"TEXTURE_COLOR",1);O(a,"a_texcoord");k=na.he(d);d=d.texture;"IMAGE"!=k.source&&"ENVIRONMENT_MAP"!=k.source&&"CANVAS"!=k.source&&"NONE"!=k.source||N(a,k,"u_colormap0",d.name)}else x(a,"TEXTURE_COLOR",0);d=!0}break;case "PHYSICS":b.b4w_collision?(a.Ys=b.b4w_use_ghost,a.bc=b.b4w_collision_id,a.Cq=b.b4w_collision_margin,a.Aq=b.b4w_collision_group,a.Dq=b.b4w_collision_mask,a.Yl=b.physics.friction,a.Rl=b.physics.elasticity,d=!0):b.b4w_water?(a.yj=!0,a.X_=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,d=!0):d=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)d=!1;else{f(a,b);a.sf=!1;a.Va=!0;a.Lb=!1;k=b.game_settings.alpha_blend;a.vh=b.b4w_render_above_all&&"OPAQUE"!=k&&"CLIP"!=k;b.use_nodes&&"CLIP"==k?K(a,b,"COLOR_ID"):T(a,"color_id.glslv","color_id.glslf");ua.set(0,0,0,b.alpha,a.$f);O(a,"a_position");x(a,"ALPHA","OPAQUE"===k?0:1);a.li.set([1,1,1]);d=v("use_map_color_diffuse",b.texture_slots)[0];k="CLIP"===k?1:0;x(a,"ALPHA_CLIP",k);if(d&&k){switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.li.set(d.scale);x(a,"TEXTURE_COLOR",1);O(a,"a_texcoord");k=na.he(d);d=d.texture;"IMAGE"!=k.source&&"ENVIRONMENT_MAP"!=k.source&&"CANVAS"!=k.source&&"NONE"!=k.source||N(a,k,"u_colormap0",d.name)}else x(a,"TEXTURE_COLOR",0);d=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?d=!1:(f(a,b),a.Lb=!1,a.sf=!1,a.Va=!0,T(a,"grass_map.glslv","grass_map.glslf"),O(a,"a_position"),d=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,k=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.$c.a_grass_size={bm:!0,src:[]},d?(a.$c.a_grass_size.src.push({name:d,jg:4}),x(a,"DYNAMIC_GRASS_SIZE",1)):x(a,"DYNAMIC_GRASS_SIZE",0),a.$c.a_grass_color={bm:!0,src:[]},k?(a.$c.a_grass_color.src.push({name:k,jg:7}),x(a,"DYNAMIC_GRASS_COLOR",1)):x(a,"DYNAMIC_GRASS_COLOR",0),x(a,"GRASS_TEXTURE_SIZE",ia.N(ka.zr)),d=!0);break;case "DEBUG_VIEW":d=I(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)d=!1;else{d=b.texture_slots;if(a.Ar)T(a,"particle_system.glslv","particle_system_stack.glslf"),
x(a,"HALO_PARTICLES",1),n(a,b);else{k={Ke:!1,Vq:b.diffuse_shader,Ks:b.specular_shader,cn:b.use_tangent_shading};if(b.use_nodes){T(a,"particle_system.glslv","particle_system.glslf");K(a,b,"PARTICLES");d=!0;break a}T(a,"particle_system.glslv","particle_system_stack.glslf");k=U.lA(b.uuid,b.name,k);a.ib.og=U.qu(k);if(d=v("use_map_color_diffuse",d)[0]){x(a,"TEXTURE_COLOR",1);switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.Nl=d.diffuse_color_factor;a.pl=d.use_map_alpha?d.alpha_factor:0;k=na.he(d);N(a,k,"default"+String(a.ya.length),d.texture.name)}}ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.$f);a.Ej=b.ambient;a.Ol=b.diffuse_intensity;a.Vj=b.emit;a.Tm.set(b.specular_color);a.Js=b.specular_alpha;O(a,"a_position");O(a,"a_tbn_quat");d=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===d?0:1);x(a,"ALPHA_CLIP","CLIP"===d?1:0);x(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);B(a,b);Q(a,b);f(a,b);d=b.game_settings.alpha_blend;a.vh=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.pg=b.offset_z;d=!0}break;default:C.q("Wrong batch type: "+a.type)}return d}function n(a,b){var c=b.halo;x(a,"NUM_RINGS",c.ring_count);x(a,"NUM_LINES",c.line_count);x(a,"NUM_STARS",c.star_tip_count);x(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.uv=c.size;a.rv=c.hardness/20;a.tv.set(c.b4w_halo_rings_color);a.sv.set(c.b4w_halo_lines_color);a.vv=1/b.b4w_halo_stars_blend_height;a.wv=b.b4w_halo_stars_min_height;
a.qv=!0}function l(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":x(a,c,"TEXTURE_COORDS_UV_ORCO");x(a,"TEXCOORD",1);break;case "NORMAL":x(a,c,"TEXTURE_COORDS_NORMAL");x(a,"NORMAL_TEXCOORD",1);break;default:x(a,c,"TEXTURE_COORDS_NONE")}}function f(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Lb=!0;a.sf=!0;a.Va=!0;a.Eg=!1;break;case "ALPHA":a.Lb=!0;a.sf=!1;a.Va=!0;a.Eg=!1;break;case "CLIP":a.Lb=!1;a.sf=!1;a.Va=!0;a.Eg=!0;break;case "ADD":a.Lb=!0;a.sf=!1;a.Va=!1;a.Eg=
!1;break;case "OPAQUE":a.Lb=!1;a.sf=!1;a.Va=!0;a.Eg=!1;break;default:C.q("Unknown alpha blend mode: "+d)}a.Zb=c.use_backface_culling}function v(a,b){for(var c=[],d=b.length,g=0;g<d;g++){var e=b[g];1==e[a]&&e.texture&&e.texture.s&&c.push(e)}return c}function c(a,b){var c=b.raytrace_transparency;a.Pi[0]=c.fresnel;a.Pi[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.zo=c.reflect_factor;a.Pi[2]=c.fresnel;a.Pi[3]=1-c.fresnel_factor/5}function B(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=
b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:ha.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Nk[0]=b.specular_intensity;a.Nk[1]=c;a.Nk[2]=d}function Q(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Td[0]=0;a.Td[1]=0;break;case "OREN_NAYAR":a.Td[0]=b.roughness;a.Td[1]=0;break;case "FRESNEL":a.Td[0]=
b.diffuse_fresnel;a.Td[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Td[0]=b.darkness;a.Td[1]=0;break;case "TOON":a.Td[0]=b.diffuse_toon_size;a.Td[1]=b.diffuse_toon_smooth;break;default:ha.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Td[0]=0,a.Td[1]=0}}function K(a,b,d){if(!b.use_nodes||b.b4w_do_not_render)return!1;var g;switch(d){case "MAIN":T(a,"main.glslv","main.glslf");g=!1;break;case "GLOW":T(a,"main.glslv","main.glslf");g=!0;break;case "SHADOW":T(a,
"shadow.glslv","shadow.glslf");g=!1;break;case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf"),g=!1}var e=b.node_tree;d=U.gS(e,b.uuid,!1,b.name,d);if(!d.Xa)return ha.error('Failed to create node graph for material "'+b.name+'", disable nodes'),L(a,b),!0;a.nk=d.id;a.ak=!0;x(a,"NODES",1);x(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);O(a,"a_position");b.use_orco_tex_coord&&O(a,"a_orco_tex_coord");f(a,b);a.pg=b.offset_z;var u=b.game_settings.alpha_blend;g?(x(a,"ALPHA",1),x(a,"ALPHA_CLIP",
0)):(x(a,"ALPHA","OPAQUE"===u?0:1),x(a,"ALPHA_CLIP","CLIP"===u?1:0));a.vh=b.b4w_render_above_all&&"OPAQUE"!=u&&"CLIP"!=u;a.Vj=b.emit;a.Ej=b.ambient;c(a,b);b.b4w_wettable?x(a,"WETTABLE",1):x(a,"WETTABLE",0);var l=null,m=!1;S.pa(d.Xa,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var g=d.data.name,e=d.data.value;a.xj||(a.xj={});a.xj[e]=g;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":g=d.data.name;a.$c[g]={bm:!0,
src:[{name:d.data.value}]};e=0;if("GEOMETRY_VC"==d.type)e=7;else for(var f=0;f<d.gb.length;f++){var u="RGB".indexOf(d.gb[f].identifier);-1<u&&(e|=1<<2-u)}a.$c[g].src[0].jg=e;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":O(a,"a_tbn_quat");break;case "TEX_COORD_OB":x(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":x(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":d.data.value.cn&&(x(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&O(a,"a_shade_tangs"));
O(a,"a_tbn_quat");m=!0;break;case "BSDF_BEGIN":m=!0;O(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":g=d.data.name;e=d.data.Ez;f=d.data.value;N(a,f,g,e);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":x(a,"CALC_TBN_SPACE",1);O(a,"a_tbn_quat");d.data&&(g=d.data.name,e=d.data.Ez,f=d.data.value,N(a,f,g,e));break;case "NORMAL_MAP":O(a,"a_tbn_quat");switch(Number(d.Rb[0][1])){case U.JO:x(a,"CALC_TBN_SPACE",1);break;case U.IO:case U.HO:x(a,"USE_MODEL_TSR",1)}break;case "LAMP":d.data&&
(a.vm=d.data);break;case "B4W_REFRACTION":a.Lb?a.zk=!0:(a.zk=!1,ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));x(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":l||(l=d.data.kb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.cs=d.data);break;case "VECT_TRANSFORM":switch(Number(d.Rb[1][1])){case U.ZP:x(a,"USE_MODEL_TSR_INVERSE",1);break;case U.YP:x(a,"USE_VIEW_TSR",1);break;case U.XP:x(a,"USE_MODEL_TSR",1);break;case U.WP:x(a,"USE_MODEL_TSR",
1);x(a,"USE_VIEW_TSR",1);break;case U.VP:x(a,"USE_VIEW_TSR_INVERSE",1);break;case U.UP:x(a,"USE_MODEL_TSR_INVERSE",1),x(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":x(a,"USE_MODEL_TSR",1);a.qo[1]=b.pass_index;a.qo[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":x(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":x(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":O(a,"a_tbn_quat"),q.mB()?x(a,"USE_DERIVATIVES_EXT",1):ha.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});l&&N(a,l,"u_nodes_texture");m||(a.Ke=!0);g=a.ib.og=U.qu(d.Xa);G(e,a);e=a.dj;d=a.cj;for(u=0;u<g.length;u++){var C=g[u];switch(C.id){case "VALUE":var n=C.tw[0];if(n)for(var k=0;k<e.length;k+=2)if(e[k]==n){C.Rb.push(["VALUE_IND",e[k+1]]);break}break;case "RGB":if(n=C.tw[0])for(k=0;k<d.length;k+=2)if(d[k]==n){C.Rb.push(["RGB_IND",d[k+1]]);break}}}x(a,"NUM_VALUES",a.ej.length);x(a,"NUM_RGBS",a.Ee.length);return!0}function G(a,b){var c=[],d=[],g=[],e=[];D(a,"",c,d,g,e);b.ej=c;b.dj=
d;b.Ee=g;b.cj=e}function D(a,b,c,d,g,e){for(var q=0;q<a.nodes.length;q++){var f=a.nodes[q];if("VALUE"==f.type){var u=R(b,f.name);c.push(f.outputs[0].default_value);d.push(u,d.length/2)}else"RGB"==f.type?(u=R(b,f.name),f=f.outputs[0].default_value.slice(0,3),g.push(f[0],f[1],f[2]),e.push(u,e.length/2)):"GROUP"==f.type&&D(f.node_group.node_tree,R(b,f.name),c,d,g,e)}}function R(a,b){var c;return c=(a?a+"%join%":"")+b}function L(a,b){switch(a.type){case "SHADOW":T(a,"shadow.glslv","shadow.glslf");break;
case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf");break;default:T(a,"main.glslv","main_stack.glslf")}x(a,"SHADELESS",1);O(a,"a_position");O(a,"a_tbn_quat");ua.set(1,0,1,1,a.$f);if(b){var c=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===c?0:1);x(a,"ALPHA_CLIP","CLIP"===c?1:0);x(a,"VERTEX_COLOR",0);a.pg=b.offset_z;f(a,b)}return!0}function I(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;T(a,"debug_view.glslv","debug_view.glslf");O(a,"a_position");O(a,"a_tbn_quat");O(a,"a_polyindex");
a.Va=!0;za.set(0,0,0,a.wireframe_edge_color);return!0}function z(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.rm?x(a,"AU_QUALIFIER","GLSL_IN"):x(a,"AU_QUALIFIER","uniform"),x(a,"STATIC_BATCH",0)):(x(a,"AU_QUALIFIER","GLSL_IN"),x(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(q.mB()?x(a,"WIREFRAME_QUALITY",1):x(a,"WIREFRAME_QUALITY",0),a.Li?(x(a,"DEBUG_SPHERE",1),a.Du?x(a,"DEBUG_SPHERE_DYNAMIC",1):x(a,"DEBUG_SPHERE_DYNAMIC",0)):x(a,"DEBUG_SPHERE",0),x(a,"ALPHA",1));b.Le&&(a.Le=b.Le);b.rf?(""!==b.Yi?
(a.$c.a_bending_col_main={bm:!0,src:[{name:b.Yi,jg:4}]},O(a,"a_bending_col_main"),""!==b.Ae.LB&&""!==b.Ae.KB&&""!==b.Ae.uC?(a.$c.a_bending_col_detail={bm:!0,src:[{name:b.Ae.LB,jg:4},{name:b.Ae.KB,jg:2},{name:b.Ae.uC,jg:1}]},O(a,"a_bending_col_detail"),O(a,"a_tbn_quat"),x(a,"DETAIL_BEND",1)):x(a,"DETAIL_BEND",0),x(a,"MAIN_BEND_COL",1)):x(a,"MAIN_BEND_COL",0),b.wl?x(a,"BEND_CENTER_ONLY",1):x(a,"BEND_CENTER_ONLY",0),x(a,"WIND_BEND",1)):x(a,"WIND_BEND",0);x(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.hq|0);
b.Gg?x(a,"BILLBOARD",1):x(a,"BILLBOARD",0);b.Gg&&b.rm?x(a,"HAIR_BILLBOARD",1):x(a,"HAIR_BILLBOARD",0);b.iq?x(a,"BILLBOARD_SPHERICAL",1):x(a,"BILLBOARD_SPHERICAL",0);switch(b.jq){case "RANDOM":x(a,"BILLBOARD_RANDOM",1);x(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":x(a,"BILLBOARD_RANDOM",0);x(a,"BILLBOARD_JITTERED",1);break;default:x(a,"BILLBOARD_RANDOM",0),x(a,"BILLBOARD_JITTERED",0)}b.hd&&ja.Tt?x(a,"DYNAMIC_GRASS",1):x(a,"DYNAMIC_GRASS",0);a.hd=b.hd;"PARTICLES"!=a.type&&(a.ag=b.ag);a.He=b.He;
a.qe=b.qe;a.fe=b.fe&&!a.Ke&&!(a.Lb&&ja.FA);a.ee=b.ee;a.Hd=b.Hd;a.Gd=b.Gd;a.qo[0]=b.ww;a.ef=b.ef;a.bh=b.bh;a.dh=b.dh;a.Rd=b.Rd;a.Ed=b.Ed;b.hk?(O(a,"a_influence"),x(a,"SKINNED",1),ja.cx?(x(a,"DISABLE_TANGENT_SKINNING",1),x(a,"FRAMES_BLENDING",0)):(x(a,"DISABLE_TANGENT_SKINNING",0),b.Xl?x(a,"FRAMES_BLENDING",1):x(a,"FRAMES_BLENDING",0)),x(a,"MAX_BONES",b.eh)):(x(a,"SKINNED",0),x(a,"FRAMES_BLENDING",0),x(a,"DISABLE_TANGENT_SKINNING",0));b.Zc?(x(a,"VERTEX_ANIM",1),ja.yN?x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):x(a,"VERTEX_ANIM",0);b.hk&&b.Zc&&C.q("Skinning and vertex animation are mutually exlusive")}}function d(a,b,c){if(b.length){for(var d=sa.fv(b,ja.ssao&&c.b4w_enable_ssao),g=a.ib,e=a.vm,f=0,q=0;q<a.ib.og.length;q++){var u=a.ib.og[q];if("LIGHTING_LAMP"==u.id){var l=b[f++%b.length],C=l.ub,n=sa.ka(l,c);if("SPOT"==C.type||"POINT"==C.type)var k=Math.cos(C.Vm/2);if("SPOT"==C.type)var E=C.Ms*(1-k);l=d.indexOf(l);u.Rb=[["LAMP_TYPE",C.type],["LAMP_IND",
n.wm],["LAMP_SPOT_SIZE",ia.N(k||.01)],["LAMP_SPOT_BLEND",ia.N(E||.01)],["LAMP_LIGHT_DIST",ia.N(C.distance)],["LAMP_USE_SPHERE",C.gE?1:0],["LAMP_SHADOW_MAP_IND",l]]}else if("LAMP"==u.id&&e)for(var n=u.Rb[0][1],t=0;t<b.length;t++)if(l=b[t],e[l.wj]==n){C=l.ub;if("SPOT"==C.type||"POINT"==C.type)k=Math.cos(C.Vm/2);"SPOT"==C.type&&(E=C.Ms*(1-k));u.Rb.push(["LAMP_TYPE",C.type],["LAMP_SPOT_SIZE",ia.N(k||.01)],["LAMP_SPOT_BLEND",ia.N(E||.01)],["LAMP_LIGHT_DIST",ia.N(C.distance)],["LAMP_USE_SPHERE",C.gE?1:
0])}}if(e){c=0;for(var F in e)c++;a.io=new Float32Array(3*c);a.Nr=new Float32Array(3*c);a.Mr=new Float32Array(3*c);ia.ia(g,"NUM_LAMP_LIGHTS",c);for(q=0;q<b.length;q++)m(a,b[q])}}}function m(a,b){if(b.wj in a.vm){var c=a.vm[b.wj];a.io.set(M.G(b.k.n),3*c);a.Nr.set(b.ub.direction,3*c);a.Mr.set(b.ub.Eq,3*c)}}function O(a,b){var c=a.Oj;-1==c.indexOf(b)&&c.push(b);a.Oj=c.sort()}function x(a,b,c){ia.ia(a.ib,b,c)}function g(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.Fb?a.Ca=ea.yM(b,ea.nn,[]):(0<b.jb.length&&
ea.uZ(b,b.aa[0]),a.Of=b);else{var c=a.Mh;a.qv&&"PARTICLES"!=a.type&&(b=ea.$T(b));a.Mx&&(b=aa.AU(a.Nx,a.Ox,a.Lx));c=ea.yM(b,c,a.$c);a.Ca=c;a.ag||a.sf||a.Le||(c.le=null,c.tc.length=0);c=b.aa.length;a.Yr=b.Ja*c;var d;a:switch(a.Mh){case ea.nn:case ea.vp:case ea.ot:d=!0;break a;default:d=!1}d?ea.XV(b)?a.Cm=b.na.length/3*c:a.Cm=b.Ja/3*c:a.Cm=0}}function P(a,b,c,d,g,e,q,f,u,l,m,n){var k=a.pb,E=[],F=f.b4w_dynamic_grass;if(!l&&F)return E;for(var U="INSTANCE"==f.b4w_wind_bend_inheritance,Z="INSTANCE"==f.b4w_shadow_inheritance,
S="INSTANCE"==f.b4w_reflection_inheritance,h=[],J=[],r=0;r<g.length;r++){var v=g[r].pb.k,N=sa.Vz(b);N.Gg=f.b4w_hair_billboard;N.jq=f.b4w_hair_billboard_type;N.iq="SPHERICAL"==f.b4w_hair_billboard_geometry;N.hd=F;N.rm=!0;U?(N.rf=v.rf,N.jn=v.jn,N.uh=v.uh,N.Pg=v.Pg,N.Yi=v.Yi,N.Og=v.Og,N.Jg=v.Jg,N.th=v.th,N.Ae=v.Ae,N.wl=!1):(N.rf=k.k.rf,N.jn=k.k.jn,N.uh=k.k.uh,N.Pg=k.k.Pg,N.Yi=k.k.Yi,N.Og=k.k.Og,N.Jg=k.k.Jg,N.th=k.k.th,N.Ae=k.k.Ae,N.wl=!0);Z?(N.He=v.He,N.qe=v.qe,N.fe=v.fe):(N.He=k.k.He,N.qe=k.k.qe,N.fe=
k.k.fe);S?(N.ee=v.ee,N.Hd=v.Hd,N.Gd=v.Gd,N.Rd=v.Rd,N.Ed=v.Ed,N.lh=v.lh):(N.ee=k.k.ee,N.Hd=k.k.Hd,N.Gd=k.k.Gd,N.Rd=k.k.Rd,N.Ed=k.k.Ed,N.lh=k.k.lh);h.push(N);var ga=q[r];ga||(ga=new Float32Array);n&&C.Ev(u.seed,m);var T=new Float32Array(3),w=new Float32Array([0,0,0,1]),O=[],P=ya.GG(ja.SB)&&!f.b4w_initial_rand_rotation&&!f.b4w_hair_billboard,ia=4;P&&(ia=8);for(var B=0;B<ga.length;B+=ia){T[0]=ga[B];T[1]=ga[B+1];T[2]=ga[B+2];var ca=ga[B+3]*M.Yd(v.n);if(f.b4w_initial_rand_rotation){switch(f.b4w_rotation_type){case "XYZ":var aa=
new Float32Array([C.tg(m),C.tg(m),C.tg(m)]);za.normalize(aa,aa);break;case "Z":aa=new Float32Array([0,0,1]);break;default:C.q("Unsupported random rotation type: "+f.b4w_rotation_type)}oa.setAxisAngle(aa,f.b4w_rand_rotation_strength*(2*Math.PI*C.tg(m)-Math.PI),w)}else P&&(w.set(ga.subarray(B+4,B+8)),C.HC(w,w),f.use_whole_group||(f.use_rotation_dupli?oa.multiply(w,M.P(v.n),w):oa.multiply(w,Pa,w)));var ba=M.hi(T,ca,w,M.create());O.push(ba)}J.push(O)}for(var I={},ta=0,r=0;r<g.length;r++)for(var X=g[r].data.materials,
B=0;B<X.length;B++)X[B].name in I?I[X[B].name]++:(I[X[B].name]=1,ta++);for(var ta=ta?ta:1,na={},r=0;r<g.length;r++){var D=g[r],pa=e[r],N=h[r],y={};N.rf&&(y.au_wind_bending_amp=[N.th],y.au_wind_bending_freq=[N.uh],y.au_detail_bending_freq=[N.Pg],y.au_detail_bending_amp=[N.Og],y.au_branch_bending_amp=[N.Jg],N.th=0,N.uh=0,N.Pg=0,N.Og=0,N.Jg=0);O=J[r];if(O.length){for(var Q=D.data,X=Q.materials,K=Array(X.length),ua=Array(X.length),B=0;B<X.length;B++)if(!ea.mJ(Q,B))for(var xb=0;xb<pa.length;xb++){var Wa=
pa[xb],Fa=p(Wa),G=X[B];"MAIN"==Wa?K[B]=Fa:"DEBUG_VIEW"==Wa&&(ua[B]=Fa);Fa.zq=a.b4w_cluster_data.cluster_id;if(t(Fa,G)){"SHADOW"==Wa&&K[B]&&(Fa.Ke=K[B].Ke);Fa.Mh=ea.nn;z(Fa,N);Fa.pk=f.uuid;Fa.Tj=a.b4w_do_not_cull||f.b4w_dynamic_grass;"MAIN"==Fa.type&&(Fa.Kg=a.b4w_caustics);x(Fa,"DISABLE_FOG",("COLOR_ID"!=Wa&&"SHADOW"!=Wa&&a.b4w_disable_fogging)|0);"JITTERED"==f.b4w_hair_billboard_type&&(Fa.Ov=f.b4w_hair_billboard_jitter_amp,Fa.Pv=f.b4w_hair_billboard_jitter_freq);F&&(Fa.lv=f.b4w_dynamic_grass_scale_threshold);
U||(delete Fa.$c.a_bending_col_main,delete Fa.$c.a_bending_col_detail);var L=ea.SA(Q,B,Fa.Oj,b.Di,Fa.$c,Fa.xj),A=k.k.n,R=!0;if(1<I[G.name]){var wa=0,la;for(la in L.aa)wa++;R=L.na.length*O.length*wa*I[G.name]>2E5*ta}var xa=ja.EF&&R&&"PHYSICS"!=Fa.type;if(xa){Fa.xJ=f.use_whole_group?2:1;var ka=C.S(L);ea.oG(L,ka,O);ka.Jf={dp:O,mx:A,qM:"STATIC"==b.type,Os:y,Im:{},Ku:F};if(N.rf&&N.wl){var Ea=za.fromValues(0,0,0);M.Xc(Ea,k.k.n,Ea);for(var Ca=[],ma=0;ma<O.length;ma++)Ca.push(Ea[0],Ea[1],Ea[2]);ka.Jf.Im.a_emitter_center=
{Jc:3,data:Ca}}ea.oG(L,L,O);"STATIC"==b.type&&ea.fR(ka.Pf,A)}else{var Ba=ka=ea.IW(L,y,O),Ga=O;Ba.qa.au_center_pos=new Float32Array(3*Ba.Ja);for(var va=Ga.length,Ma=Ba.Ja/va,Ra=0;Ra<va;Ra++)for(var kc=Ga[Ra],Qb=3*Ma*Ra,Pb=0;Pb<Ma;Pb++)Ba.qa.au_center_pos[Qb+3*Pb]=kc[0],Ba.qa.au_center_pos[Qb+3*Pb+1]=kc[1],Ba.qa.au_center_pos[Qb+3*Pb+2]=kc[2];ka=Ba;if(N.rf&&N.wl){var lc=ka,Gc=k.k.n;lc.qa.a_emitter_center=new Float32Array(3*lc.Ja);var Jb=za.fromValues(0,0,0);M.Xc(Jb,Gc,Jb);for(var mc=0;mc<lc.Ja;mc++)lc.qa.a_emitter_center[3*
mc]=Jb[0],lc.qa.a_emitter_center[3*mc+1]=Jb[1],lc.qa.a_emitter_center[3*mc+2]=Jb[2];ka=lc}}var rb=f.b4w_vcol_from_name,db=f.b4w_vcol_to_name,ac=Fa,Yc=c,Db=!U,Rb=Q,gb=[];if(""!==rb&&""!==db){var ob,Hc=db,nc=ac.$c,Ic=[],Kb=void 0;for(Kb in nc)for(var oc=nc[Kb].src,bc=0,Za=0;Za<oc.length;Za++){var cc=oc[Za].jg;Hc==oc[Za].name&&Ic.push(Kb,cc,bc);bc+=C.Mm(cc)}ob=Ic;if(0<ob.length)for(var Lb=0;Lb<ob.length;Lb+=3)gb.push({cr:rb,Mu:7,uw:ob[Lb],vw:ob[Lb+1],Ju:ob[Lb+2]});else ea.xV(ac.Oj,"a_color")&&db==Rb.active_vcol_name&&
gb.push({cr:rb,Mu:7,uw:"a_color",vw:7,Ju:0})}Db&&("a_bending_col_main"in Yc&&gb.push({cr:"a_bending_col_main",Mu:4,uw:"a_bending_col_main",vw:4,Ju:0}),"a_bending_col_detail"in Yc&&gb.push({cr:"a_bending_col_detail",Mu:7,uw:"a_bending_col_detail",vw:7,Ju:0}));for(var tb=ka,pc=O,ub=d,Mb=gb,Sb=Fa.$c,vc=xa,Jc=!1,Ia=0;Ia<Mb.length;Ia++){var fc=Mb[Ia].cr,Eb=ub.qa[fc];if(Eb&&0<Eb.length){Jc=!0;break}}if(vc)var Fb=tb.Jf.Im;if(Jc){var Dc,Tb=k.k.R,jb=ub.aa[0].a_position,hb=pc,Ja=na,Yb=new Float32Array(3),Gb=
new Float32Array(3),Na=new Uint32Array(hb.length);if(!("verts_indices"in Ja)){Ja.Ei=new Float32Array(3);Ja.Ci=new Float32Array(3);Ja.kE=new Uint32Array(jb.length/3);Ja.Zr=new Uint32Array(jb.length/3);Ja.Ei[0]=(Tb.max_x-Tb.min_x)/20;Ja.Ei[1]=(Tb.max_y-Tb.min_y)/20;Ja.Ei[2]=(Tb.max_z-Tb.min_z)/20;Ja.Ci[0]=Tb.min_x;Ja.Ci[1]=Tb.min_y;Ja.Ci[2]=Tb.min_z;for(var Oa=0;Oa<jb.length/3;Oa++){var mb=C.trunc((jb[3*Oa]-Ja.Ci[0])/Ja.Ei[0]),Oc=C.trunc((jb[3*Oa+1]-Ja.Ci[1])/Ja.Ei[1]),Kc=C.trunc((jb[3*Oa+2]-Ja.Ci[2])/
Ja.Ei[2]),mb=C.U(mb,0,19),Oc=C.U(Oc,0,19),Kc=C.U(Kc,0,19);Ja.kE[Oa]=Oa;Ja.Zr[Oa]=Kc*Math.pow(20,2)+20*Oc+mb}ea.eZ(Ja.Zr,Ja.kE,ea.ez,!0);Ja.dn=new Uint32Array(Math.pow(20,3));for(Oa=0;Oa<Ja.Zr.length;Oa++)Ja.dn[Ja.Zr[Oa]]++;delete Ja.Zr;for(Oa=1;Oa<Ja.dn.length;Oa++)Ja.dn[Oa]+=Ja.dn[Oa-1]}for(var vb=0;vb<hb.length;vb++){Yb[0]=hb[vb][0];Yb[1]=hb[vb][1];Yb[2]=hb[vb][2];for(var Ec=1E10,Ub=-1,dc=C.trunc((Yb[0]-Ja.Ci[0])/Ja.Ei[0]),fd=C.trunc((Yb[1]-Ja.Ci[1])/Ja.Ei[1]),Zc=C.trunc((Yb[2]-Ja.Ci[2])/Ja.Ei[2]),
dc=C.U(dc,0,19),fd=C.U(fd,0,19),Zc=C.U(Zc,0,19),Sc=Zc*Math.pow(20,2)+20*fd+dc,$c=Ja.dn[Sc],zb=0==Sc?0:Ja.dn[Sc-1];zb<$c;zb++){var Ab=Ja.kE[zb];Gb[0]=jb[3*Ab];Gb[1]=jb[3*Ab+1];Gb[2]=jb[3*Ab+2];za.sub(Gb,Yb,Gb);var wc=za.sqrLen(Gb);wc<=Ec&&(Ec=wc,Ub=Ab)}if(-1==Ub)for(zb=0;zb<jb.length/3;zb++)Gb[0]=jb[3*zb],Gb[1]=jb[3*zb+1],Gb[2]=jb[3*zb+2],za.sub(Gb,Yb,Gb),wc=za.sqrLen(Gb),wc<=Ec&&(Ec=wc,Ub=zb);Na[vb]=Ub}Dc=Na;for(var gd=tb.Ja/pc.length,Ia=0;Ia<Mb.length;Ia++){var Xa=Mb[Ia].uw,$a=Mb[Ia].vw,fc=Mb[Ia].cr,
Tc=Mb[Ia].Mu,Eb=ub.qa[fc];switch(Xa){case "a_bending_col_main":var gc=1;break;case "a_bending_col_detail":gc=3;break;case "a_color":gc=3;break;default:for(var Nb=gc=0;Nb<Sb[Xa].src.length;Nb++)gc+=C.Mm(Sb[Xa].src[Nb].jg)}if(Eb&&0<Eb.length){var xc=C.Mm(Tc),hd=C.Mm($a),Uc=Tc&$a,yc=C.fL(Uc);Uc!=$a&&ha.error("Wrong color extraction from "+fc+" to "+Xa+".");if(vc)for(Fb[Xa]={Jc:gc,data:[]},Nb=0;Nb<pc.length;Nb++)for(qc=Dc[Nb],Lc=qc*xc,Vb=0;Vb<yc.length;Vb++)yc[Vb]&&(Mc=C.Co(Tc,Vb),Fb[Xa].data.push(Eb[Lc+
Mc]));else{if("a_bending_col_main"==Xa||"a_bending_col_detail"==Xa)tb.qa[Xa]=new Float32Array(tb.Ja*hd);for(Nb=0;Nb<pc.length;Nb++){var qc=Dc[Nb],Lc=qc*xc,Vc=Nb*gd*gc;if(-1!=qc)for(var hc=0;hc<gd;hc++)for(var rc=hc*gc,Vb=0;Vb<yc.length;Vb++)if(yc[Vb]){var Mc=C.Co(Tc,Vb);tb.qa[Xa][Vc+rc+(Mb[Ia].Ju+C.Co($a,Vb))]=Eb[Lc+Mc]}}}}else tb.qa[Xa]=new Float32Array(0)}}ka=tb;x(Fa,"USE_INSTANCED_PARTCLS",ka.Jf?1:0);da(Fa);E.push({za:Fa,ff:b,bu:N,Of:ka,kg:[G.name],Id:[a]})}}for(B=0;B<ua.length;B++)ua[B]&&(ua[B].Hn=
K[B].id,da(ua[B]))}}return E}function t(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=U.EG(b));return c=c&&w(a,b)}function da(a){J(a,function(a){a.id=0;a.id=C.uR(a)})}function J(a,b){for(var c=null,d=null,g=[],e=0;e<a.ya.length;e++){var f=a.ya[e],q=f.Xf;q&&(c||(c={}),c[e]=q,f.Xf=null);if(q=f.Ta)d||(d={}),d[e]=q,f.Ta=null;g.push(f.ok);f.ok=0}var f=a.R,q=a.ba,u=a.wa,l=a.Ua,C=a.qb,m=a.lb;a.R=null;a.ba=null;a.wa=null;a.Ua=null;a.qb=null;a.lb=null;var k=a.Me;a.Me=null;b(a);a.Me=k;a.R=f;a.ba=q;a.wa=u;a.Ua=l;a.qb=
C;a.lb=m;if(c)for(e in c)a.ya[e].Xf=c[e];if(d)for(e in d)a.ya[e].Ta=d[e];for(e=0;e<a.ya.length;e++)a.ya[e].ok=g[e]}function F(a,b,c,d){var e=p("DEBUG_VIEW");T(e,"debug_view.glslv","debug_view.glslf");e.Li=!0;e.Va=!0;e.pk=b;e.Du=c;z(e,a);da(e);if(d.Sf){c?(c=d.ba,M.kf(d.ba.F,va)):(c=d.qb,M.kf(c.F,va));var f=za.create();a=aa.Xu(1,f);b=za.fromValues(za.length(c.Ga),za.length(c.Ha),za.length(c.Ia));ea.kL(a,b,f);var f=za.normalize(c.Ga,Ea),q=za.normalize(c.Ha,Ca);c=za.normalize(c.Ia,ma);!b[0]&&b[1]&&b[2]?
za.cross(q,c,f):!b[1]&&b[0]&&b[2]?za.cross(c,f,q):!b[2]&&b[0]&&b[1]&&za.cross(f,q,c);b=C.LT(f,q,c,Ma);X.invert(b,b);b=oa.fromMat3(b,Ba);M.Jk(b,va);M.Mf(1,va);ea.ox(a,va)}else c?(b=d.wa,a=aa.Xu(b.Ya,b.F)):(b=d.lb,a=aa.Xu(b.Ya,za.create()),M.identity(va),M.kf(b.F,va),ea.ox(a,va));e.R=E.Cl(d.R);e.ba=E.xq(d.ba);e.wa=E.Dl(d.wa);e.Ua=E.Cl(d.Ua);e.qb=E.xq(d.qb);e.lb=E.Dl(d.lb);ea.px(a,1,!0);a.qa.a_polyindex=ea.Pu(a);g(e,a);return e}function T(a,b,c){a.ib.yg=b;a.ib.Xe=c;ia.lY(a.ib)}function N(a,b,c,d){d=
d||"";-1==a.Ld.indexOf(c)&&(a.ya.push(b),a.Ld.push(c),a.Ig.push(d),na.Cv(b));a.zb&&wa.SF(a)}function ba(a){a.ib||C.q("No shaders info for batch "+a.name);a.zb=ia.PU(a.ib);var b=a.ib;if(b.status===ia.gz){var c=a.zb.attributes,d=a.Ca.kd,g;for(g in c)d[g]||C.q('missing data for "'+g+'" attribute')}b.status&ia.WN&&ha.error("Texture limit exceeded for shader - "+b.Xe+', materials: "'+a.sd.join(", ")+'". Maximum texture count: '+xa.ZB+", actual texture count: "+b.KM);b.status&ia.VN&&ha.error("Fragment uniform limit exceeded for shader - "+
b.Xe+', materials: "'+a.sd.join(", ")+'". Maximum fragment uniform count: '+xa.Yv+", actual fragment uniform count: "+b.qU);b.status&ia.ZN&&ha.error("Vertex uniform limit exceeded for shader - "+b.yg+', materials: "'+a.sd.join(", ")+'". Maximum vertex uniform count: '+xa.Tr+", actual vertex uniform count: "+b.O_);b.status&ia.YN&&ha.error("Vertex attribute limit exceeded for shader - "+b.yg+', materials: "'+a.sd.join(", ")+'". Maximum attribute count: '+xa.$B+", actual attribute count: "+b.TF);b.status&
ia.XN&&("MAIN"!=a.type||a.ak||ha.error("Varying limit exceeded for shader - "+a.ib.Xe+', materials: "'+a.sd.join(", ")+'"'),"MAIN"==a.type&&a.ak||"NODES_GLOW"==a.type)&&(d=c=0,a.xj&&(c=C.qr(a.xj)),a.$c&&(d=C.qr(a.$c)),ha.error("Varying limit exceeded for node shader - "+a.ib.Xe+", uv: "+c+", vc: "+d+', materials: "'+a.sd.join(", ")+'"'));b.status&ia.QN&&ha.error("Shader compilation/linking error: "+b.yg+", "+b.Xe+', materials: "'+a.sd.join(", ")+'"');return a.ib.status===ia.gz?(wa.QQ(a.zb),wa.MQ(a),
wa.SF(a),!0):!1}function u(a,b,c){a=a.I[0].W;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].eg&&-1!=a[d].sd.indexOf(b))return a[d];return null}function ga(a,b,c){a=a.I[0].W;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].eg&&-1!=a[d].sd.indexOf(b))return a[d];return null}function Z(a,b){a.$f.set(b.$f);a.Ol=b.Ol;a.Tm.set(b.Tm);a.Po=b.Po;a.Nk.set(b.Nk);a.Vj=b.Vj;a.Ej=b.Ej;a.Nl=b.Nl;a.pl=b.pl;a.zo=b.zo;a.Pi.set(b.Pi);a.so=b.so;a.Go.set(b.Go);a.Ho=b.Ho;a.Io.set(b.Io);a.Jo=b.Jo;a.Rn=b.Rn;a.np=b.np}
var E=h("__boundings"),ca=h("__config"),ha=h("__print"),q=h("__extensions"),S=h("__graph"),X=h("__mat3"),U=h("__nodemat"),sa=h("__obj_util"),pa=h("__particles"),aa=h("__primitives"),oa=h("__quat"),ya=h("__reformer"),wa=h("__renderer"),la=h("__scenegraph"),ia=h("__shaders"),ta=h("__subscene"),na=h("__textures"),M=h("__tsr"),ea=h("__geometry"),C=h("__util"),za=h("__vec3"),ua=h("__vec4"),ja=ca.B,xa=ca.Gi,ka=ca.Eo,Pa=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),Ea=new Float32Array(3),Ca=new Float32Array(3),
ma=new Float32Array(3),Ba=new Float32Array(4),va=M.create(),Ma=X.create();a.e0=Ga;var Ga="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Ra={};a.VQ=function(a){return Ra[a]||null};a.WQ=function(a,b){Ra[a]=b};a.JU=function(a,c,e,f){var q;q=a.s.Xa;for(var u=[],l=0;l<c.length;l++){var m=c[l],k=m.pb,n=k.k;if(!k.Gr){var t=sa.Sa(k),k=k.k,p=m.data.b4w_boundings,U=p.bs_rad,Z=p.bs_cen,S=p.bc_rad,h=p.caxis_x,J=p.caxis_y,N=p.caxis_z,v=p.be_ax,ga=p.be_cen,x=p.rbb.rbb_c,T=p.rbb.rbb_s,
p=E.Cl(k.vl);k.Gg&&(U=Math.max(Math.abs(p.max_x),Math.abs(p.min_x)),Z=Math.max(Math.abs(p.max_y),Math.abs(p.min_y)),T=Math.max(Math.abs(p.max_z),Math.abs(p.min_z)),T=Math.sqrt(U*U+Z*Z+T*T),S=Math.sqrt(U*U+Z*Z),p.max_x=p.max_y=p.max_z=T,p.min_x=p.min_y=p.min_z=-T,U=T,Z=[0,0,0],h=[1,0,0],J=[0,1,0],N=[0,0,1],v=[T,T,T],ga=[0,0,0],x=[0,0,0],T=[T,T,T]);E.Cn(p,k.R);E.Al(k.R,k.n,k.Ua);k.wa=E.Gz(U,C.Ef(Z));E.lq(k.wa,k.n,k.lb);k.ba=t?E.gq(h,J,N,ga):E.gq([1,0,0],[0,1,0],[0,0,1],ga);za.scale(k.ba.Ga,v[0],k.ba.Ga);
za.scale(k.ba.Ha,v[1],k.ba.Ha);za.scale(k.ba.Ia,v[2],k.ba.Ia);E.kq(k.ba,k.n,k.qb);t?A(k,S,S,k.R):(k.zd=E.WX(x,h,J,N,T),E.Dz(k.zd,k.n,k.ZF));u.push.apply(u,y(m,n,q))}}q=r(u);for(u=0;u<q.length;u++)if(l=q[u].za,l.sd=q[u].kg,g(l,q[u].Of),d(l,e,a),"STATIC"==q[u].k.type&&"COLOR_ID"!=l.type){if(m=C.Qs("%meta%"+l.type+"%"+l.sd.join("%")+"%"),t=sa.Lq(m,"MESH"),sa.UW(t,q[u].k),sa.Yp(t,a),sa.Ut(t,a,l),f.push(t),"MAIN"==l.type)for(n=0;n<q[u].Id.length;n++)m=q[u].Id[n].pb,m.aw.push(t)}else m=q[u].Id[0].pb,sa.Ut(m,
a,l);if(ja.debug_view){for(u=0;u<q.length;u++)if(e=q[u].k,"DYNAMIC"==e.type&&(m=q[u].Id[0].pb,l=q[u].za,"MAIN"==l.type)){n=sa.ka(m,a);t=n.W;k=!1;for(n=0;n<t.length;n++)t[n].Li&&(k=!0);k||(e=F(e,m.name,!0,l),sa.Ut(m,a,e))}for(u=0;u<f.length;u++)m=f[u],e=m.k,n=sa.ka(m,a),l=n.W[0],"MAIN"==l.type&&(e=F(e,m.name,!1,l),sa.Ut(m,a,e));for(u=0;u<q.length;u++)l=q[u].za,"DEBUG_VIEW"==l.type&&(l.Cu=u)}for(u=0;u<c.length;u++)for(n=sa.ka(c[u].pb,a),t=n.W,n=0;n<t.length;n++)b(t[n]);for(u=0;u<f.length;u++)for(n=
sa.ka(f[u],a),t=n.W,n=0;n<t.length;n++)b(t[n])};a.vQ=function(a,c,d){var f=a.s.pp,q=p("MAIN");T(q,"sky.glslv","sky.glslf");if(c.procedural_skydome)x(q,"PROCEDURAL_SKYDOME",1),q.Iu=!0;else{var u=f.Oo,l=la.gc(a.s.Xa,ta.Dg).p.wc;N(q,l,"u_sky");u&&(x(q,"WO_SKYTEX",1),u.invert&&x(q,"MTEX_NEGATIVE",1),u.pN&&x(q,"MTEX_RGBTOINT",1),x(q,"BLENDTYPE",u.iG),u.kN&&x(q,"WOMAP_BLEND",1),u.lN&&x(q,"WOMAP_HORIZ",1),u.nN&&x(q,"WOMAP_ZENUP",1),u.mN&&x(q,"WOMAP_ZENDOWN",1));f.Zs&&x(q,"WO_SKYBLEND",1);f.$s&&x(q,"WO_SKYPAPER",
1);f.at&&x(q,"WO_SKYREAL",1)}c.ee&&(q.ee=!0,c.Hd&&(q.Hd=!0));q.pg=99999;O(q,"a_position");c=aa.FU();g(q,c);b(q);d=sa.ka(d,a);q.Tj=!0;q.ba=E.Lg();q.qb=E.Lg();q.R=E.Qd();q.Ua=E.Qd();q.wa=E.Kh();q.lb=E.Kh();da(q);d.W.push(q);la.gc(a.s.Xa,ta.wf)&&(a=e(q),a.type="DEBUG_VIEW",a.Fb="",I(a),x(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.qa.a_polyindex=ea.Pu(c),g(a,c),a.Hn=q.id,da(a),d.W.push(a))};a.iA=function(a,b,c){c=sa.ka(a,c).W;var d=[];la.gc(b,ta.cd);var g=la.gc(b,ta.Nd),q=la.gc(b,ta.md),f=la.gc(b,ta.Cg);b=la.gc(b,
ta.tf);for(var u=0;u<c.length;u++){var l=c[u],m=null;"SHADOW"==l.type&&"RECEIVE"==l.Fb&&l.He&&(m=e(l),m.Fb="CAST");"MAIN"!=l.type&&"PARTICLES"!=l.type||!g&&!q||!l.ee||(m=e(l),m.Fb="REFLECT",m.zk=!1,m.sf&&(m.sf=!1,m.Va=!1),m.hb=l.hb);"COLOR_ID"==l.type&&f&&a.k.Vc&&(b&&a.k.Dk?(m=e(l),m.Fb="OUTLINE"):l.Fb="OUTLINE");m&&(m.eg=!0,da(m),d.push(m))}c.push.apply(c,d)};a.xY=A;a.Z_=function(a,b,c){b?b=c*(b.max_z-b.min_z):(b=1,C.q("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(C.Cb(a));return.5*
(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.XQ=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.YZ=L;a.XZ=d;a.tY=m;a.RF=function(a,b){x(a,"CSM_SECTION1",0);x(a,"CSM_SECTION2",0);x(a,"CSM_SECTION3",0);x(a,"NUM_CAST_LAMPS",0);if(b){x(a,"NUM_CAST_LAMPS",b.ah.length);ja.Wv&&x(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)x(a,"CSM_SECTION"+String(c),1);x(a,"SHADOW_TEX_RES",ia.N(b.csm_resolution));x(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?
1:0);x(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else x(a,"SHADOW_TEX_RES",0),x(a,"CSM_FADE_LAST_CASCADE",0),x(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.jf=x;a.bB=function(a,b){return ia.UU(a.ib,b)};a.VZ=g;a.WZ=da;a.Xt=T;a.Gj=N;a.PX=function(a,b,c){c=a.Ld.indexOf(c);-1<c&&(a.ya[c]=b)};a.JS=function(a,b){var c=p("MAIN");c.Lb=!0;ua.set(b[0],b[1],b[2],.5,c.$f);c.Mh=ea.vp;g(c,a);T(c,"main.glslv","main_stack.glslf");x(c,"SHADELESS",1);ba(c);return c};a.Yc=ba;a.IU=function(a,c){for(var d=
0;d<c.length;d++){var e=c[d].pb,q=p("LINE");T(q,"line.glslv","line.glslf");q.Lb=!0;q.Tj=!0;var f=aa.HU();g(q,f);b(q);q.R=E.Qd();q.Ua=E.Qd();q.ba=E.Lg();q.qb=E.Lg();q.lb=E.Kh();q.wa=E.Kh();sa.Yp(e,a);sa.ka(e,a).W.push(q);ba(q)}};a.ER=function(a){return a.zb.ds.length?a.zb.zC.u_cube_fog?!0:!1:!1};a.sS=function(){var a=p("DEPTH_PACK");a.Zb=!0;a.Va=!1;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");ba(a);return a};a.pA=function(a){var b=p("POSTPROCESSING");
T(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":x(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":x(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":x(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":x(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":x(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":x(b,"POST_EFFECT",
"POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":x(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":x(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:C.q("Wrong postprocessing effect: "+a)}b.Zb=!0;b.Va=!1;a=aa.Tc();g(b,a);ba(b);return b};a.MS=function(a){var b=p("SSAO");b.Va=!1;b.Zb=!0;var c=aa.Tc();g(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");x(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.pM);x(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?
1:0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=na.Kl(na.Ah,!1);c.source="NODE_TEX";na.Ss(c,a,0);N(b,c,"u_ssao_special_tex");ba(b);return b};a.NS=function(a){var b=p("SSAO_BLUR");b.Va=!1;b.Zb=!0;var c=aa.Tc();g(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");x(b,"SSAO_BLUR_DEPTH",
a.ssao_blur_depth?1:0);ba(b);return b};a.pS=function(a){var b=p("COC");b.Va=!1;b.Zb=!0;var c=aa.Tc();g(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");x(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":x(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":x(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":x(b,"COC_TYPE","COC_COMBINE")}ba(b);return b};a.tS=function(a){var b=p("DOF");b.Va=!1;b.Zb=!0;var c=aa.Tc();g(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.p.dof_bokeh?x(b,"DOF_TYPE","DOF_BOKEH"):(x(b,"DOF_TYPE","DOF_SIMPLE"),x(b,"DEPTH_RGBA",1));ba(b);return b};a.CS=function(){var a=p("OUTLINE");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");ba(a);return a};a.vS=function(){var a=p("GLOW_COMBINE");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");ba(a);return a};a.wS=function(a,b,c){var d=p("GOD_RAYS");d.Va=!1;d.Zb=!0;var e=aa.zU();
g(d,e);T(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");x(d,"DEPTH_RGBA",a?1:0);x(d,"WATER_EFFECTS",b?1:0);x(d,"STEPS_PER_PASS",ia.N(c,1));ba(d);return d};a.xS=function(){var a=p("GOD_RAYS_COM");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");x(a,"SAFARI_CANVAS_ALPHA_HACK",ja.iL?1:0);ba(a);return a};a.rS=function(a,b){var c=p("SKY");c.Va=!1;c.Zb=!0;var d=aa.BU();g(c,d);if(b.procedural_skydome)T(c,"skybox.glslv",
"proc_skybox.glslf"),x(c,"WATER_EFFECTS",1);else{T(c,"skybox.glslv","tex_skybox.glslf");if(a){d=a.s.pp;if(d.ix){var e=d.ix.texture,q=na.he(d.ix);N(c,q,"u_sky_texture",e.name)}d.Oo&&x(c,"WO_SKYTEX",1)}b.eM&&x(c,"MTEX_NEGATIVE",1);b.jM&&x(c,"MTEX_RGBTOINT",1);x(c,"BLENDTYPE",b.dM);b.fM&&x(c,"WOMAP_BLEND",1);b.gM&&x(c,"WOMAP_HORIZ",1);b.iM&&x(c,"WOMAP_ZENUP",1);b.hM&&x(c,"WOMAP_ZENDOWN",1);b.Zs&&x(c,"WO_SKYBLEND",1);b.$s&&x(c,"WO_SKYPAPER",1);b.at&&x(c,"WO_SKYREAL",1)}c.ba=E.Lg();c.qb=E.Lg();c.R=E.Qd();
c.Ua=E.Qd();c.wa=E.Kh();c.lb=E.Kh();ba(c);return c};a.nQ=function(a,b){var c=la.gc(a.s.Xa,ta.Dg);c&&(c=c.Ra[0].sa[0].za,sa.ka(b,a).W.push(c))};a.kS=function(a){var b=p("ANTIALIASING");b.Va=!1;b.Zb=!0;var c=aa.Tc();g(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ja.QK?(x(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),x(b,"AA_QUALITY",a.VH)):x(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");ba(b);return b};a.KS=function(a){var b=p("SMAA"),c=aa.Tc();g(b,c);T(b,"postprocessing/smaa.glslv",
"postprocessing/smaa.glslf");x(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");x(b,"SMAA_PASS",a);x(b,"SMAA_PREDICATION",0);x(b,"SMAA_REPROJECTION",0);ba(b);b.Va=!1;b.Zb=!0;return b};a.qS=function(){var a=p("COMPOSITING");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");ba(a);return a};a.BS=function(){var a=p("MOTION_BLUR");a.Zb=!0;a.Va=!1;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");ba(a);
return a};a.OS=function(a){var b=p("STEREO");b.Zb=!0;b.Va=!1;var c=aa.Tc();g(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");x(b,"ANAGLYPH","ANAGLYPH"===a?1:0);ba(b);return b};a.yS=function(){var a=p("LUMINANCE");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");ba(a);return a};a.lS=function(){var a=p("LUMINANCE");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");
ba(a);return a};a.zS=function(){var a=p("LUMINANCE_X_BLUR");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");ba(a);return a};a.nS=function(){var a=p("POSTPROCESSING");a.Zb=!0;a.Va=!1;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");ba(a);return a};a.oS=function(){var a=p("BLOOM");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
ba(a);return a};a.lT=function(){var a=p("VELOCITY");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");ba(a);return a};a.jS=function(){var a=p("ANCHOR_VISIBILITY");a.Va=!0;a.Zb=!0;a.Mh=ea.vp;T(a,"anchors.glslv","anchors.glslf");var b=aa.aI(1);g(a,b);x(a,"ANCHOR_NUM",1);ba(a);a.ql=new Float32Array(3);return a};a.DS=function(){var a=p("PERFORMANCE");a.Va=!1;a.Zb=!0;var b=aa.Tc();g(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
ba(a);return a};a.UZ=function(a,b){var c=b.length/3;if(c!=a.ql.length/3){var d=aa.aI(c);g(a,d);x(a,"ANCHOR_NUM",c);ba(a)}a.ql=b};a.N4=function(a){if(!a.I.length)return null;a=a.I[0];return a.W.length?a.W[0]:null};a.iU=u;a.b4=ga;a.p8=Z;a.K2=function(a,b){for(var c=a.I[0].W,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.MG=function(a){for(var b=a.ya,c=0;c<b.length;c++)na.MC(b[c]);a.Ca.Yf&&ea.YR(a.Ca);a.Yf&&a.Me.length&&wa.aS(a);a.zb.Yf&&ia.$R(a.zb);a.nk&&(b=U.EI(a.nk))&&b.LG&&U.ZR(a.nk)};a.GV=
function(a,b,c,d){for(var g=["MAIN","SHADOW","COLOR_ID"],e=!1,q=0;q<g.length;q++){var f=g[q],l=u(a,b,f),m=u(c,d,f);if(l&&m){var e=!0,C=ga(c,d,f);"MAIN"==f&&(Z(m,l),C&&Z(C,l));for(f=0;f<m.Ld.length;f++){var k=m.Ld[f];if(-1!==Ga.indexOf(k)){var n=l.Ld.indexOf(k);-1!==n&&(n=l.ya[n],na.MC(m.ya[f]),m.ya[f]=n,na.Cv(n),C&&(k=C.Ld.indexOf(k),-1!==k&&(na.MC(C.ya[k]),C.ya[k]=n,na.Cv(n))))}}}}e||ha.error("Wrong objects for inheriting material!")};a.AY=function(a,b,c,d){for(var g=0;g<a.I.length;g++)for(var e=
a.I[g].W,q=0;q<e.length;q++){var f=e[q];-1!=f.sd.indexOf(b)&&f.ej&&(f.ej[c]=d)}};a.zY=function(a,b,c,d,g,e){for(var q=0;q<a.I.length;q++)for(var f=a.I[q].W,u=0;u<f.length;u++){var l=f[u];-1!=l.sd.indexOf(b)&&l.Ee&&(l.Ee[3*c]=d,l.Ee[3*c+1]=g,l.Ee[3*c+2]=e)}};a.i5=function(a,b){return a.ej[b]};a.h5=function(a,b,c){c[0]=a.Ee[3*b];c[1]=a.Ee[3*b+1];c[2]=a.Ee[3*b+2];return c};a.FI=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+="%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};
a.ua=function(){Ra={}}};b4w.module.__extensions=function(a,h){function p(a){if(a in k)return k[a];var b=A.getExtension(a)||null;k[a]=b;y.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function e(a){if(a in k)return k[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=A;break;case "EXT_disjoint_timer_query":(b=A.getExtension("EXT_disjoint_timer_query")||null)||(b=A.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}k[a]=b;y.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=h("__config"),y=h("__print"),r=b.B,A=null,k={};a.Nf=function(a){A=a};a.OI=function(){return p("WEBGL_compressed_texture_s3tc")||p("WEBKIT_WEBGL_compressed_texture_s3tc")||p("MOZ_WEBGL_compressed_texture_s3tc")};a.KI=function(){return p("WEBKIT_WEBGL_compressed_texture_pvrtc")||p("WEBGL_compressed_texture_pvrtc")};a.TU=function(){return r.ec?e("WEBGL_depth_texture"):p("WEBGL_depth_texture")||p("WEBKIT_WEBGL_depth_texture")||
p("MOZ_WEBGL_depth_texture")};a.iI=function(){return p("EXT_texture_filter_anisotropic")||p("WEBKIT_EXT_texture_filter_anisotropic")||p("MOZ_EXT_texture_filter_anisotropic")};a.SU=function(){return p("WEBGL_debug_shaders")};a.ev=function(){return p("WEBGL_debug_renderer_info")};a.sI=function(){return r.ec?e("OES_element_index_uint"):p("OES_element_index_uint")};a.mB=function(){return r.ec?e("OES_standard_derivatives"):p("OES_standard_derivatives")};a.eB=function(){var a=r.ec?e("EXT_disjoint_timer_query"):
p("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},dI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},eI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},cI:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return A.createQuery()},beginQuery:function(b){A.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){A.endQuery(a.TIME_ELAPSED_EXT)},dI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT_AVAILABLE)},eI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT)},cI:function(){return a.GPU_DISJOINT_EXT}}};a.iV=function(){if(r.ec)return e("ANGLE_instanced_arrays");var a=p("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,e,f,k,c){a.drawElementsInstancedANGLE(b,e,f,k,c)},vertexAttribDivisor:function(b,e){a.vertexAttribDivisorANGLE(b,e)},drawArraysInstanced:function(b,
e,f,k){a.drawArraysInstancedANGLE(b,e,f,k)}}};a.nB=function(){if(r.ec)return e("OES_vertex_array_object");var a=p("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.ua=function(){k={}};a.reset=function(){A=null}};b4w.module.__graph=function(a,h){function p(a,b,c){c||(c=null);e(a,b)?P.q("Graph already has node with given ID"):a.M.push(b,c)}function e(a,b){for(var c=a.M,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,c,d){d||(d=null);e(a,b)&&e(a,c)?a.Pa.push(b,c,d):P.q("Wrong node IDs")}function y(a,b){e(a,b)||P.q("Node not found");for(var c=a.M,d=0;d<c.length;d+=2)c[d]==b&&(c.splice(d,2),d-=2)}function r(a,b,c,d){m(a,b,c)||P.q("Edge not found");a=a.Pa;for(var g=0,e=0;e<a.length;e+=3)if(a[e]==
b&&a[e+1]==c){if(-1==d)a.splice(e,3);else{if(d==g){a.splice(e,3);break}g++}e-=3}}function A(a){a=a.M;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function k(a,b){for(var c=a.M,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function w(a){var b=[],c={};n(a,c);for(var d=a.M,g=0;g<d.length;g+=2)0==I(a,d[g])&&l(a,d[g],c,b);return{M:b,Pa:a.Pa.slice(0)}}function n(a,b){for(var c=a.M,d=0;d<c.length;d+=2)b[c[d]]=!1}function l(a,b,c,d){if(!c[b]){c[b]=!0;for(var g=0;g<L(a,b);g++)l(a,
z(a,b,g),c,d);d.unshift(b,R(a,b))}}function f(a,b,c,g){if(!c[b]){c[b]=!0;if(10==g||30==g)for(var e=0;e<L(a,b);e++){var l=z(a,b,e);f(a,l,c,g)}if(20==g||30==g)for(e=0;e<I(a,b);e++)l=d(a,b,e),f(a,l,c,g)}}function v(a){for(var b=a.Pa,c=0;c<b.length;c+=3){var d=b[c+1];e(a,b[c])&&e(a,d)||(b.splice(c,3),c-=3)}}function c(a){for(var b=[],c=a.M,d=0;d<c.length;d+=2){var g=c[d];L(a,g)||b.push(g)}return b}function B(a){var b=a.M;a=a.Pa;for(var c=[],d=[],g=[],e=0;e<b.length;e++)g[b[2*e]]=e,c.push(e,b[2*e+1]);
for(e=0;e<a.length;e+=3)d.push(g[a[e]],g[a[e+1]],a[e+2]);return{M:c,Pa:d}}function Q(a,b,c){if(c.Jh==c.mk){for(var g=0,e=0;g<c.mk;g++)-1!=c.Hi[g]&&(a[e]=g,b[e]=c.Hi[g],e++);return!0}if(c.mk>c.oo||c.Pk>c.Qk||c.Yo>c.$o||c.Xo>c.Zo)return!1;for(var e=g=-1,f=!1;!f&&K(c,t,g,e);)if(g=t[0],e=t[1],G(c,g,e)){var u;u=c;f={};f.mr=u.mr;f.nr=u.nr;f.nC=u.nC;f.Lu=u.Lu;f.mk=u.mk;f.oo=u.oo;f.qk=u.qk;f.Jh=f.nw=u.Jh;f.Xo=u.Xo;f.Yo=u.Yo;f.Pk=u.Pk;f.Zo=u.Zo;f.$o=u.$o;f.Qk=u.Qk;f.Tp=-1;f.Hi=u.Hi;f.Gl=u.Gl;f.lm=u.lm;f.mm=
u.mm;f.Em=u.Em;f.Fm=u.Fm;f.$w=u.$w;u.$w[0]+=1;var f=u=f,l=g,m=e,k=f.mr,n=f.nr,p=f.mk,q=f.oo,S=f.Hi,h=f.Gl,U=f.lm,r=f.mm,v=f.Em,x=f.Fm;D(l<p);D(m<q);D(f.Jh<p);D(f.Jh<q);p=++f.Jh;f.Tp=l;U[l]||(U[l]=p,f.Xo++,v[l]&&f.Pk++);v[l]||(v[l]=p,f.Yo++,U[l]&&f.Pk++);r[m]||(r[m]=p,f.Zo++,x[m]&&f.Qk++);x[m]||(x[m]=p,f.$o++,r[m]&&f.Qk++);S[l]=m;h[m]=l;for(S=0;S<I(k,l);S++)h=d(k,l,S),U[h]||(U[h]=p,f.Xo++,v[h]&&f.Pk++);for(S=0;S<L(k,l);S++)h=z(k,l,S),v[h]||(v[h]=p,f.Yo++,U[h]&&f.Pk++);for(S=0;S<I(n,m);S++)h=d(n,m,
S),r[h]||(r[h]=p,f.Zo++,x[h]&&f.Qk++);for(S=0;S<L(n,m);S++)h=z(n,m,S),x[h]||(x[h]=p,f.$o++,r[h]&&f.Qk++);f=Q(a,b,u);D(1>=u.Jh-u.nw);D(-1!=u.Tp);h=u.mr;l=u.nr;m=u.Jh;k=u.Tp;n=u.Hi;U=u.Gl;p=u.lm;r=u.mm;q=u.Em;v=u.Fm;if(u.nw<m){p[k]==m&&(p[k]=0);for(x=0;x<I(h,k);x++)S=d(h,k,x),p[S]==m&&(p[S]=0);q[k]==m&&(q[k]=0);for(x=0;x<L(h,k);x++)S=z(h,k,x),q[S]==m&&(q[S]=0);h=n[k];r[h]==m&&(r[h]=0);for(x=0;x<I(l,h);x++)S=d(l,h,x),r[S]==m&&(r[S]=0);v[h]==m&&(v[h]=0);for(x=0;x<L(l,h);x++)S=z(l,h,x),v[S]==m&&(v[S]=
0);n[k]=-1;U[h]=-1;u.Jh=u.nw;u.Tp=-1}}return f}function K(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var g=a.Pk,e=a.Qk,f=a.Yo,l=a.$o,m=a.Xo,k=a.Zo,n=a.Jh,t=a.mk,q=a.oo,p=a.Hi,h=a.Gl,U=a.lm,r=a.mm,v=a.Em,x=a.Fm;if(g>n&&e>n)for(;c<t&&(-1!=p[c]||0==v[c]||0==U[c]);)c++,d=0;else if(f>n&&l>n)for(;c<t&&(-1!=p[c]||0==v[c]);)c++,d=0;else if(m>n&&k>n)for(;c<t&&(-1!=p[c]||0==U[c]);)c++,d=0;else if(0==c&&0!=a.qk){for(U=0;U<t&&-1!=p[c=a.qk[U]];)U++;U==t&&(c=t)}else for(;c<t&&-1!=p[c];)c++,d=0;if(g>n&&e>n)for(;d<q&&(-1!=
h[d]||0==x[d]||0==r[d]);)d++;else if(f>n&&l>n)for(;d<q&&(-1!=h[d]||0==x[d]);)d++;else if(m>n&&k>n)for(;d<q&&(-1!=h[d]||0==r[d]);)d++;else for(;d<q&&-1!=h[d];)d++;return c<t&&d<q?(b[0]=c,b[1]=d,!0):!1}function G(a,b,c){var g=a.mr,e=a.nr,f=a.oo,u=a.Hi,l=a.Gl,k=a.lm,n=a.mm,t=a.Em,p=a.Fm;D(b<a.mk);D(c<f);D(-1==u[b]);D(-1==l[c]);if(!(0,a.nC)(R(g,b),R(e,c)))return!1;for(var q=f=0,h=0,r=0,U=0,v=0,x=0;x<L(g,b);x++){var P=z(g,b,x);if(-1!=u[P]){var B=u[P];if(!m(e,c,B)||!O(a.Lu,g,b,P,e,c,B))return!1}else k[P]&&
h++,t[P]&&f++,k[P]||t[P]||U++}for(x=0;x<I(g,b);x++)if(P=d(g,b,x),-1!=u[P]){if(B=u[P],!m(e,B,c)||!O(a.Lu,g,P,b,e,B,c))return!1}else k[P]&&h++,t[P]&&f++,k[P]||t[P]||U++;for(x=0;x<L(e,c);x++)if(B=z(e,c,x),-1!=l[B]){if(P=l[B],!m(g,b,P))return!1}else n[B]&&r++,p[B]&&q++,n[B]||p[B]||v++;for(x=0;x<I(e,c);x++)if(B=d(e,c,x),-1!=l[B]){if(P=l[B],!m(g,P,b))return!1}else n[B]&&r++,p[B]&&q++,n[B]||p[B]||v++;return h<=r&&f<=q&&U<=v}function D(a){a||P.q("Assertion failed")}function R(a,b){for(var c=a.M,d=0;d<c.length;d+=
2)if(c[d]==b)return c[d+1];return null}function L(a,b){for(var c=a.Pa,d=0,g=0;g<c.length;g+=3)c[g]==b&&d++;return d}function I(a,b){for(var c=a.Pa,d=0,g=0;g<c.length;g+=3)c[g+1]==b&&d++;return d}function z(a,b,c){a=a.Pa;for(var d=0,g=0;g<a.length;g+=3)if(a[g]==b){if(d==c)return a[g+1];d++}return-1}function d(a,b,c){a=a.Pa;for(var d=0,g=0;g<a.length;g+=3)if(a[g+1]==b){if(d==c)return a[g];d++}return-1}function m(a,b,c){a=a.Pa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function O(a,
b,c,d,e,f,u){for(var l=x(b,c,d),m=x(e,f,u),k=0;k<l;k++){for(var n=!1,t=0;t<m;t++)if(a(g(b,c,d,k),g(e,f,u,t))){n=!0;break}if(!n)return!1}return!0}function x(a,b,c){var d=0;a=a.Pa;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&d++;return d}function g(a,b,c,d){a=a.Pa;for(var g=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(g==d)return a[e+2];g++}return null}h("__print");var P=h("__util"),t=[-1,-1];a.$y=-1;a.A0=10;a.mt=20;a.O1=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var g=
a[d];switch(g.length){case 2:b.push(g[0],g[1]);break;case 3:c.push(g[0],g[1],g[2]);break;default:P.q("Wrong graph constructor params")}}return{M:b,Pa:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.M.length),g=0;g<a.M.length;g+=2)d[g]=a.M[g],d[g+1]=b(a.M[g+1]);else d=P.S(a.M);if(c)for(b=Array(a.Pa.length),g=0;g<a.Pa.length;g+=3)b[g]=a.Pa[g],b[g+1]=a.Pa[g+1],b[g+2]=c(a.Pa[g+2]);else b=P.S(a.Pa);return a={M:d,Pa:b}};a.o3=function(a,b){for(var c=[],d=[],g=0;g<a.length;g++)c.push(a[g][0],a[g][1]);
for(g=0;g<b.length;g++)d.push(b[g][0],b[g][1],b[g][2]);return{M:c,Pa:d}};a.Fj=p;a.j6=e;a.ed=b;a.ug=y;a.Ak=r;a.Ao=function(a,b,c,d){m(a,b,c)||P.q("Edge not found");a=a.Pa;for(var g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==c&&a[g+2][0]==d[0]&&a[g+2][1]==d[1]){a.splice(g,3);break}};a.J=function(a,b){if(-1==k(a,b)){var c=A(a);p(a,c,b);return c}P.q("Non-unique attribute")};a.OX=function(a,b,c,d,g){a=a.Pa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==d&&(a[e+2]=g)};a.BQ=function(a,c,d){var g;d=d||
[];g=g||[];for(var e={},f=0;f<a.M.length;f+=2){var u=a.M[f],l=a.M[f+1],m=A(c);p(c,m,l);e[u]=m}for(f=0;f<a.Pa.length;f+=3)l=e[a.Pa[f]],m=e[a.Pa[f+1]],u=a.Pa[f+2],b(c,l,m,u);for(f=0;f<d.length;f+=3)l=e[d[f]],a=d[f+1],u=d[f+2],b(c,l,a,u);for(f=0;f<g.length;f+=3)d=g[f],m=e[g[f+1]],u=g[f+2],b(c,d,m,u)};a.am=A;a.gh=k;a.r=function(a,c,d,g){c=k(a,c);d=k(a,d);-1!=c&&-1!=d?b(a,c,d,g):P.q("Attributes not found")};a.pa=function(a,b){for(var c=a.M,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.xg=function(a,b){for(var c=
a.Pa,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.ni=function(a,b,c){for(var d=a.Pa,g=0;g<d.length;g+=3)if(d[g+1]==b){var e=d[g];if(c(e,R(a,e),d[g+2]))break}};a.Sk=function(a,b,c){for(var d=a.Pa,g=0;g<d.length;g+=3)if(d[g]==b){var e=d[g+1];if(c(e,R(a,e),d[g+2]))break}};a.RD=w;a.HZ=function(a){a=w(a).M;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.D6=function(){};a.nx=function(a,b,c){e(a,b)||P.q("No such node");var d={};n(a,d);f(a,b,d,c);b=[];for(var g in d)d[g]&&(g=Number(g),b.push(g,
R(a,g)));a={M:b,Pa:a.Pa.slice(0)};v(a);return a};a.Sz=v;a.nV=function(a){for(var b=[],c=a.M,d=0;d<c.length;d+=2){var g=c[d];I(a,g)||b.push(g)}return b};a.sr=c;a.match=function(a,b,c,d){var g={};g.mr=B(a);g.nr=B(b);g.nC=c||function(a,b){return a==b};g.Lu=d||function(a,b){return a==b};d=a.M.length/2;var e=b.M.length/2;g.mk=d;g.oo=e;g.qk=0;g.Jh=g.nw=0;g.Pk=g.Xo=g.Yo=0;g.Qk=g.Zo=g.$o=0;g.Tp=-1;g.Hi=Array(d);g.Gl=Array(e);g.lm=Array(d);g.mm=Array(e);g.Em=Array(d);g.Fm=Array(e);g.$w=[1];for(c=0;c<d;c++)g.Hi[c]=
-1,g.lm[c]=0,g.Em[c]=0;for(c=0;c<e;c++)g.Gl[c]=-1,g.mm[c]=0,g.Fm[c]=0;e=Array(d);d=Array(d);if(Q(e,d,g)){for(c=0;c<e.length;c++)e[c]=a.M[2*e[c]],d[c]=b.M[2*d[c]];return[e,d]}return null};a.jV=function(a,b){for(var c=a.M,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Wa=R;a.rg=L;a.$n=I;a.Wg=z;a.Si=d;a.F4=x;a.Wd=g;a.replace=function(a,b,c){for(var d=a.Pa,g=A(a),e=0;e<b.length;e++){var f=b[e];y(a,f);for(var l=0;l<d.length;l+=3)d[l]==f&&(d[l]=g),d[l+1]==f&&(d[l+1]=g),d[l]==d[l+1]&&(d.splice(l,
3),l-=3)}p(a,g,c)};a.EX=function(a,b,c,d,g){m(a,b,c)||P.q("Edge not found");a=a.Pa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=d,a[e+1]=g)};a.ST=function(a,b){function d(a,b){if(-1!=m.indexOf(a)){var c=m.slice(m.indexOf(a));if(-1!=e[c[c.length-1]].indexOf(c[0])){k.push([a,c[c.length-1]]);return}}m.push(a);for(c=0;c<b.length;c++)b[c]in e&&d(b[c],e[b[c]])}b||(b=c(a)[0]);var g=a.Pa;if(g.length&&-1!=g.indexOf(b)){for(var e={},f=0,l=0;l<g.length;l+=3)g[l+1]in e?e[g[l+1]].push(g[l]):e[g[l+1]]=
[g[l]],f++;var m=[],k=[];d(b,e[b]);for(l=0;l<k.length;l++)for(var n=f=0;n<g.length;n+=3)k[l][1]==g[n+1]&&k[l][0]==g[n]&&r(a,g[n],g[n+1],f),f++}};a.uT=function(a,b,c){var d=a.M;a=a.Pa;var g;g="digraph debug {\n    node [shape=box];\n";for(var e=0;e<d.length;e+=2){var f=d[e],l=d[e+1],l=b?b(f,l):String(f);g+="    ";g+=String(f)+' [label="'+l.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<a.length;e+=3)b=a[e],d=a[e+1],l=a[e+2],g+="    ",g+=String(b)+" -> "+String(d),c&&(g+=' [label="'+c(b,d,l)+'"]'),g+=";\n";
return g+="}"}};b4w.module.__nodemat=function(a,h){function p(a,b,d,g,f){var q=Pa.A(),q=k(b,f,q.uuid);if(q in va)return va[q];var u={Xa:null,id:q,LG:!0};d||(Ga={},Ra=0);if("SHADOW"!=f&&"COLOR_ID"!=f){b=C.create();for(var m=a.nodes,t=0;t<m.length;t++)if(null==da(b,m[t],0,g,f))return va[q]=null,u;if(d&&-1==P(a,b,"GROUP_OUTPUT","group"))return u;t=aa(b);m=d?a.links:a.links.slice();if(!oa(b,m,t))return u;if(d)return u.Xa=b,u;for(t=0;t<m.length;t++){d=m[t];for(var E=B(d.from_node,b),U=B(d.to_node,b),h=0;h<E.length;h++)for(var H=
0;H<U.length;H++){var S=E[h],Z=U[H],x=C.Wa(b,S),F=C.Wa(b,Z);if(!sa(b,S,Z,x,F,d))return va[q]=null,u}}c(b);"GLOW"==f?t=P(a,b,"B4W_GLOW_OUTPUT","material",!0):(t=P(a,b,"OUTPUT","material",!1,!0),-1==t&&(t=P(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==t&&(b=n(),t=0);Q(b);a=C.nx(b,t,C.mt);e(a,g);r(a,g);l(a);G(a);O(a);v(a,g,f);na(a)}else g=p(a,b,d,g,"MAIN"),g=C.clone(g.Xa,function(a){var b=Ea.yq(a);b.L=Ea.S(a.L);b.gb=Ea.S(a.gb);return b}),t=P(a,g,"OUTPUT","material",!1,!0),-1==t&&(t=P(a,g,"OUTPUT_MATERIAL",
"material",!1,!0)),w(g,t),a=C.nx(g,t,C.mt),l(a);u.Xa=a;return va[q]=u}function e(a,c){var d=[];C.pa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({Xr:a,node:b})});for(var g=0;g<d.length;++g){var e=d[g].Xr,f=d[g].node,q=C.am(a);C.Fj(a,q,f.data.MW);var l=C.am(a);C.Fj(a,l,f.data.NW);C.ed(a,q,l,[4,2]);for(var u={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},m=C.$n(a,e),k=[],n=[],t=[],E={},p=0;p<m;p++){var U=C.Si(a,e,
p);U in E||(E[U]=0);var h=C.Wd(a,U,e,E[U]++);k.push([U,e,h]);var H=u[h[1]];if(H)switch(H[0]){case "MATERIAL_END":n.push([U,l,[h[0],H[1]]]);break;case "LIGHTING_APPLY":t.push([U,[h[0],H[1]]])}else n.push([U,q,h])}b(a,f.data.value,q,l,t,c);for(p=0;p<k.length;p++)C.Ao(a,k[p][0],k[p][1],k[p][2]);for(p=0;p<n.length;p++)C.ed(a,n[p][0],n[p][1],n[p][2]);f=C.rg(a,e);q=[];u=[];m={};for(p=0;p<f;p++)k=C.Wg(a,e,p),k in m||(m[k]=0),h=C.Wd(a,e,k,m[k]++),q.push([e,k,h]),u.push([l,k,h]);for(p=0;p<q.length;p++)C.Ao(a,
q[p][0],q[p][1],q[p][2]);for(p=0;p<u.length;p++)C.ed(a,u[p][0],u[p][1],u[p][2]);C.ug(a,e)}}function b(a,b,c,d,g,e){var f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},q=da(a,f,0,e,null),l=q;y(a,c,q,"E");y(a,c,q,"A");y(a,c,q,"D");q=Pa.A();q=ja.Ub(q,"LAMP",ja.oc);if(!b.Ke)for(var u,m,k,n=0;n<q.length;n++){k=q[n].ub;f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};u=da(a,f,0,e,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};m=da(a,f,0,e,null);y(a,l,m,"color");y(a,l,m,"specular");y(a,u,m,"ldir");
y(a,c,m,"normal");y(a,c,m,"D");y(a,c,m,"S");y(a,u,m,"lcolorint");y(a,c,u,"shadow_factor");l="SPECULAR_"+b.Ks;f={name:l,type:l,use_tangent_shading:b.cn};l=da(a,f,0,e,null);y(a,u,l,"ldir");y(a,u,l,"lfac");y(a,c,l,"normal");y(a,l,m,"sfactor");y(a,u,l,"norm_fac");y(a,c,l,"sp_params");l="HEMI"==k.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Vq;f={name:l,type:l,use_tangent_shading:b.cn};k=da(a,f,0,e,null);y(a,u,k,"ldir");y(a,u,k,"lfac");y(a,c,k,"normal");y(a,u,k,"norm_fac");y(a,k,m,"lfactor");"DIFFUSE_LAMBERT"!=
l&&y(a,c,k,"dif_params");for(u=0;u<g.length;u++)C.ed(a,g[u][0],m,g[u][1]);l=m}y(a,l,d,"color");y(a,l,d,"specular")}function y(a,b,c,d){for(var g=C.Wa(a,b),e=C.Wa(a,c),f,q=0;q<e.L.length;q++)if(d==e.L[q].identifier){f=q;break}if(void 0!==f){for(var l,q=0;q<g.gb.length;q++)if(d==g.gb[q].identifier){l=q;break}void 0!==l&&C.ed(a,b,c,[l,f])}}function r(a,b){var c=[];C.pa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({Xr:a,node:b})});for(var d=0;d<c.length;++d){var g=c[d].Xr,e=c[d].node,f=C.am(a);C.Fj(a,
f,e.data.iR);var q=C.am(a);C.Fj(a,q,e.data.jR);C.ed(a,f,q,[4,2]);for(var l=C.$n(a,g),u=[],m=[],k={},n=0;n<l;n++){var t=C.Si(a,g,n),E=C.Wa(a,t);t in k||(k[t]=0);var p=C.Wd(a,t,g,k[t]++);u.push([t,g,p]);m.push([t,f,p]);if("BSDF_GLOSSY"==E.type||"BSDF_DIFFUSE"==E.type||"MIX_SHADER"==E.type||"EMISSION"==E.type){m.push([t,f,[1,1]]);m.push([t,f,[2,2]]);m.push([t,f,[3,3]]);m.push([t,f,[4,4]]);m.push([t,f,[5,5]]);m.push([t,f,[6,6]]);m.push([t,f,[7,7]]);m.push([t,f,[8,8]]);var U=[];C.pa(a,function(a,b){"MIX_SHADER"==
b.type&&U.push({Xr:a,node:b})});for(p=0;p<U.length;++p)for(var t=U[p].Xr,E=C.$n(a,t),h=0;h<E;h++){var H=C.Si(a,t,h),S=C.Wa(a,H),Z=C.Wd(a,H,t,0);0==Z[1]||"BSDF_GLOSSY"!=S.type&&"BSDF_DIFFUSE"!=S.type&&"MIX_SHADER"!=S.type&&"EMISSION"!=S.type||(S=1==Z[1]?3:11,m.push([H,t,[1,S]]),m.push([H,t,[2,S+1]]),m.push([H,t,[3,S+2]]),m.push([H,t,[4,S+3]]),m.push([H,t,[5,S+4]]),m.push([H,t,[6,S+5]]),m.push([H,t,[7,S+6]]),m.push([H,t,[8,S+7]]))}}}A(a,e.data.value,f,q,b);for(n=0;n<u.length;n++)C.Ao(a,u[n][0],u[n][1],
u[n][2]);for(n=0;n<m.length;n++)C.ed(a,m[n][0],m[n][1],m[n][2]);e=C.rg(a,g);f=[];l=[];u={};for(n=0;n<e;n++)m=C.Wg(a,g,n),m in u||(u[m]=0),p=C.Wd(a,g,m,u[m]++),f.push([g,m,p]),l.push([q,m,p]);for(n=0;n<f.length;n++)C.Ao(a,f[n][0],f[n][1],f[n][2]);for(n=0;n<l.length;n++)C.ed(a,l[n][0],l[n][1],l[n][2]);C.ug(a,g)}}function A(a,b,c,d,g){var e=[],f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},q=da(a,f,0,g,null),l=q;y(a,c,q,"E");y(a,c,q,"A");y(a,c,q,"D");for(var q=Pa.A(),q=ja.Ub(q,"LAMP",ja.oc),u,m,
k=0;k<q.length;k++){f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};u=da(a,f,0,g,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};m=da(a,f,0,g,null);y(a,l,m,"color");y(a,l,m,"specular");y(a,u,m,"ldir");y(a,c,m,"normal");y(a,c,m,"D");y(a,c,m,"S");y(a,u,m,"lcolorint");y(a,c,u,"shadow_factor");l=b.kR;f={name:l,type:l};l=da(a,f,0,g,null);y(a,u,l,"ldir");y(a,u,l,"lfac");y(a,c,l,"normal");y(a,u,l,"norm_fac");y(a,c,l,"bsdf_params");y(a,l,m,"lfactor");y(a,l,m,"sfactor");for(l=0;l<e.length;l++)C.ed(a,e[l][0],
m,e[l][1]);l=m}y(a,c,d,"s_color");y(a,c,d,"metalness");y(a,c,d,"e_color");y(a,c,d,"emission");y(a,l,d,"color");y(a,l,d,"specular")}function k(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function w(a,b){C.xg(a,function(c,d,g){var e=C.Wa(a,d);d==b&&"Color"==e.L[g[1]].identifier&&C.Ao(a,c,d,g)})}function n(){var a=C.create(),b={data:null,Rb:[],rb:[],L:[{Ea:new Float32Array([0,0,0]),identifier:"Color",eb:!1,name:"Color"},{Ea:1,identifier:"Alpha",
eb:!1,name:"Alpha"}],gb:[],type:"OUTPUT",qi:[]};C.Fj(a,0,b);return a}function l(a){C.pa(a,function(b,c){for(var d=c.L,g=c.gb,e=0;e<d.length;e++)f(a,d[e],b,e,1);for(e=0;e<g.length;e++)f(a,g[e],b,e,0)})}function f(a,b,c,d,g){if(b.eb){var e=!0;C.xg(a,function(a,b,f){if(!g&&a==c&&f[0]==d||g&&b==c&&f[1]==d)e=!1});e&&(b.eb=!1)}}function v(a,b,c){var d=[];C.xg(a,function(g,e,f){var q=C.Wa(a,g),l=C.Wa(a,e),q=Ea.jk(q.gb[f[0]].Ea),l=Ea.jk(l.L[f[1]].Ea);if(q!=l){var u,m={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},k={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};q&&!l?u=t("vector_to_scalar","B4W_VECTOSCAL",[m],[k]):!q&&l&&(u=t("scalar_to_vector","B4W_SCALTOVEC",[k],[m]));da(a,u,0,b,c);d.push([g,e,a.M[a.M.length-2],f])}});for(var g=0;g<d.length;++g)C.Ao(a,d[g][0],d[g][1],d[g][3]),C.ed(a,d[g][0],d[g][2],[d[g][3][0],0]),C.ed(a,d[g][2],d[g][1],[0,d[g][3][1]])}function c(a){var b=[];C.pa(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":C.xg(a,function(g,e,f){var q=
C.Wa(a,e);g==c&&"MATERIAL_EXT"==q.type&&"Translucency"==d.gb[f[0]].name&&b.push(g,e,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)C.ed(a,b[c],b[c+1],b[c+2])}function B(a,b){var c=[];C.pa(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;Ea.q("Node not found")}function Q(a){var b=[];C.pa(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],g=b[c+1];if("B4W_PARALLAX"==g.type)K(a,d,g);else if("REROUTE"==g.type){for(var e=
C.Si(a,d,0),f=C.rg(a,d),q=[],l=[],u=[],m=0;m<f;m++){var k=C.Wg(a,d,m),n=l.indexOf(k),t=0<=n?u[t]:0,E=C.Wd(a,d,k,t);if(E){var E=E[1],p=g.L[0].Ea,E=C.Wa(a,k).L[E];switch(typeof p){case "number":if("object"==typeof E.Ea)for(var U=E.Ea,E=0;E<U.length;E++)U[E]=p;else"number"==typeof E.Ea&&(E.Ea=p);break;case "object":if("object"==typeof E.Ea)for(U=E.Ea,E=0;E<U.length;E++)U[E]=p[E];else"number"==typeof E.Ea&&(E.Ea=.35*p[0]+.45*p[1]+.2*p[2])}}p=g.gb;for(E=0;E<p.length;E++)p[E].Ea=g.L[0].Ea;-1!=n?u[n]+=1:
(l.push(k),u.push(1),q.push(d,k))}if(-1!=e)for(g=C.Wd(a,e,d,0)[0],m=0;m<l.length;m++)for(E=0;E<u[m];E++)f=C.Wd(a,d,l[m],E)[1],C.ed(a,e,l[m],[g,f]);for(m=0;m<q.length;m+=2)C.Ak(a,q[m],q[m+1],-1)}}}function K(a,b,c){var d;a:{d=a.Pa;for(var g=0;g<d.length;g+=3)if(d[g+1]==b&&1==d[g+2][1]){d=d[g];break a}d=-1}-1!=d&&(g=C.Wa(a,d),c.data=g.data,C.Ak(a,d,b,-1),0==C.rg(a,d)&&(b=C.Si(a,d,0),-1!=b&&C.Ak(a,b,d,-1),C.ug(a,d)));c.L.splice(1,1)}function G(a){R(a);z(a);D(a)}function D(a){var b=[],c="",d="",g={};
C.pa(a,function(a,e){if("GEOMETRY_UV"==e.type||"UVMAP"==e.type||"TEX_COORD_UV"==e.type){b.push(a,e);var f=e.data.value;c?c==f||d||(d=f,g[d]=0):(c=f,g[c]=0);g[f]++}});for(var e in g)if(2>g[e]){for(var f=0;f<b.length;f+=2)b[f+1].data.value==e&&b.splice(f,2);delete g[e];c==e&&(c=d,d="");d==e&&(d="")}if(!(3>b.length)){var f={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},q={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};e=t("merged_uv","UV_MERGED",
[],[f,q]);e.uv_layer=c;da(a,e,0,"",void 0);var l=a.M[a.M.length-2];e=a.M[a.M.length-1];if(d){q=t("merged_uv","UV_MERGED",[],[f,q]);q.uv_layer=d;da(a,q,0,"",void 0);var u=a.M[a.M.length-2],q=a.M[a.M.length-1]}else q=null;for(var k=-1,n=null,f=0;f<b.length;f+=2){var E=b[f],p=b[f+1];m(p,b[1])?(k=l,n=e):q&&(k=u,n=q);for(var U=[],h=C.rg(a,E),H={},S=0;S<h;S++){var Z=C.Wg(a,E,S);Z in H||(H[Z]=0);var r=C.Wd(a,E,Z,H[Z]++);U.push(E,Z,r);r=r.splice(0,r.length);switch(p.type){case "GEOMETRY_UV":r[0]=0;n.gb[0].eb=
!0;break;case "UVMAP":case "TEX_COORD_UV":r[0]=1,n.gb[1].eb=!0}C.ed(a,k,Z,r)}for(var S=0;S<U.length;S+=3)C.Ak(a,U[S],U[S+1],0);C.ug(a,E)}}}function R(a){var b=[];C.pa(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],g=0;g<b.length;g+=2){for(var e=b[g],f=b[g+1],q=!0,l=0;l<c.length;l++){var u=c[l];if(d(f,
u.Af)){q=[];l=C.rg(a,e);for(n=0;n<l;n++){var m=C.Wg(a,e,n),k=C.Wd(a,e,m,0);q.push(e,m,k);C.ed(a,u.id,m,k)}for(var n=0;n<q.length;n+=3)C.Ak(a,q[n],q[n+1],0);C.ug(a,e);q=!1;break}}q&&(u={id:e,Af:f},c.push(u))}}function L(a){for(var b={},c=0;c<a.M.length;c+=2){var d=a.M[c];b[d]={aq:{},CJ:!1}}for(c=0;c<a.Pa.length;c+=3)b[a.Pa[c+1]].aq[a.Pa[c]]=!0;for(d in b)I(d,b);for(d in b)b[d]=Object.keys(b[d].aq).map(function(a){return parseInt(a)});return b}function I(a,b){var c=b[a];if(!c.CJ){var d=Ea.S(c),g;for(g in c.aq){I(g,
b);var c=b[g],e;for(e in c.aq)d.aq[e]=!0}d.CJ=!0;b[a]=d}}function z(a){var b=[];C.pa(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=L(a),g=[],e=0;e<b.length;e+=2){for(var f=b[e],q=b[e+1],l=!0,u=0;u<g.length;u++){var m=g[u];if(!(3<=m.mo.length||!d(q,m.Af)||-1<c[f].indexOf(m.id)||-1<c[m.id].indexOf(f))){for(var k=!1,n=0;n<m.mo.length;n++){var t=m.mo[n].id;if(-1<c[f].indexOf(t)||-1<c[t].indexOf(f)){k=!0;break}}if(!k){for(var u=[],t=C.$n(a,f),E=
{},n=0;n<t;n++)k=C.Si(a,f,n),k in E||(E[k]=0),l=C.Wd(a,k,f,E[k]++),u.push(k,f,l);for(var t=[],E=C.rg(a,f),p={},n=0;n<E;n++)k=C.Wg(a,f,n),k in p||(p[k]=0),l=C.Wd(a,f,k,p[k]++),t.push(f,k,l);l=u.concat(t);for(n=0;n<l.length;n+=3)C.Ak(a,l[n],l[n+1],0);C.ug(a,f);n={id:f,Af:q,JT:u,KT:t};m.mo.push(n);l=!1;break}}}l&&(m={id:f,Af:q,mo:[]},g.push(m))}for(e=0;e<g.length;e++){m=g[e];c=m.mo.length;for(u=0;u<c;u++){q=m.mo[u];n=q.Af;f=q.JT;q=q.KT;m.Af.L[u+1].eb=n.L[0].eb;m.Af.L[u+1].Ea=n.L[0].Ea;m.Af.gb[2*(u+1)].eb=
n.gb[0].eb;m.Af.gb[2*(u+1)].Ea=n.gb[0].Ea;m.Af.gb[2*(u+1)+1].eb=n.gb[1].eb;m.Af.gb[2*(u+1)+1].Ea=n.gb[1].Ea;for(n=0;n<f.length;n+=3)k=f[n],l=f[n+2],l[1]+=u+1,C.ed(a,k,m.id,l);for(n=0;n<q.length;n+=3)k=q[n+1],l=q[n+2],l[0]+=2*(u+1),C.ed(a,m.id,k,l);m.Af.Rb.push(["USE_uv"+(u+2),1])}C.ug(a,m.id);C.Fj(a,m.id,m.Af)}}}function d(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.Fz==b.data.value.Fz&&a.data.value.Zn==b.data.value.Zn;default:return!1}}function m(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function O(a){var b=[],c=[];C.pa(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});x(a,b);g(a,c)}function x(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],g=b[c+1],e=!1,f=[],q=[],l=[[],
[],[]],u=C.rg(a,d),m=0;m<u;m++){var k=C.Wg(a,d,m);if("SEPRGB"!=C.Wa(a,k).type){e=!1;break}f.push(d,k);for(var n={},t=C.rg(a,k),e=0;e<t;e++){var E=C.Wg(a,k,e);E in n||(n[E]=0);var p=C.Wd(a,k,E,n[E]++);f.push(k,E);l[p[0]].push(d,E,p)}q.push(k);e=!0}if(e){for(m=d=u=0;m<l.length;m++)l[m].length&&(u++,d|=1<<2-m);if(u){g.type+=u;g.gb=[];for(m=0;m<l.length;m++)if(l[m].length)for(g.gb.push({Ea:0,identifier:"RGB"[m],eb:!0,name:"RGB"[m]}),e=0;e<l[m].length;e+=3)l[m][e+2][0]=Ea.Co(d,m);for(m=0;m<f.length;m+=
2)C.Ak(a,f[m],f[m+1],0);for(m=0;m<q.length;m++)C.ug(a,q[m]);for(m=0;m<l.length;m++)for(e=0;e<l[m].length;e+=3)C.ed(a,l[m][e],l[m][e+1],l[m][e+2])}}}}function g(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],g=!0,e=[],f=C.rg(a,d),q=0;q<f;q++){var l=C.Wg(a,d,q);if("B4W_REFLECT"==C.Wa(a,l).type){var u=C.Wd(a,d,l,0),m=C.Wd(a,d,l,1);u&&1==u[1]||m&&1==m[1]?g=!1:e.push(d,l)}else g=!1}for(q=0;q<e.length;q+=2)f=a,u=e[q],l=e[q+1],m=C.Wa(f,l),m.type+="_WORLD",C.Ak(f,u,l,0),m.L.splice(0,1),u=C.Si(f,l,0),u!=
C.$y&&(C.Wd(f,u,l,0)[1]=0);g&&C.ug(a,d)}}function P(a,b,c,d,g,e){a=a.nodes;for(var f=null,q=0;q<a.length;q++){var l=a[q];g?"GROUP"==l.type&&l.node_tree_name==c&&(f=l):l.type==c&&(f=l)}return f?B(f,b)[0]:(e||xa.error('No "'+c+'" node in node '+d),-1)}function t(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function da(a,b,c,d,g){var e=b.name,f=b.type,l=[],m=[],k=[],n=[],t=null,p=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":m=
S(b);k=X(b);xa.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":m=S(b);k=X(b);break;case "MIX_SHADER":m.push(E(b,"Fac"));var h=E(b,"Shader"),k=h.eb;m.push(h);(h=E(b,"Shader_001"))||(h=E(b,"Shader.001"));var H=h.eb;m.push(h);m.push(q("d_color1","d_color1",[0,0,0],k));m.push(q("d_roughness1","d_roughness1",0,k));m.push(q("s_color1","s_color1",[0,0,0],k));m.push(q("s_roughness1","s_roughness1",0,k));m.push(q("metalness1","metalness1",0,k));m.push(q("normal1","normal1",
[0,0,0],k));m.push(q("e_color1","e_color1",[0,0,0],k));m.push(q("emission1","emission1",0,k));m.push(q("d_color2","d_color2",[0,0,0],H));m.push(q("d_roughness2","d_roughness2",0,H));m.push(q("s_color2","s_color2",[0,0,0],H));m.push(q("s_roughness2","s_roughness2",0,H));m.push(q("metalness2","metalness2",0,H));m.push(q("normal2","normal2",[0,0,0],H));m.push(q("e_color2","e_color2",[0,0,0],H));m.push(q("emission2","emission2",0,H));k=ca(b,"Shader");h=k.eb;k=[k,q("d_color","d_color",[0,0,0],h),q("d_roughness",
"d_roughness",0,h),q("s_color","s_color",[0,0,0],h),q("s_roughness","s_roughness",0,h),q("metalness","metalness",0,h),q("normal","normal",[0,0,0],h),q("e_color","e_color",[0,0,0],h),q("emission","emission",0,h)];break;case "OBJECT_INFO":var m=S(b),k=[],h=ca(b,"Location"),H=ca(b,"Object Index"),r=ca(b,"Material Index"),v=ca(b,"Random");k.push(h);k.push(H);k.push(r);k.push(v);p.push(["USE_LOCATION_OUT",h.eb|0]);p.push(["USE_OBJ_IND_OUT",H.eb|0]);p.push(["USE_MAT_IND_OUT",r.eb|0]);p.push(["USE_RANDOM_OUT",
v.eb|0]);break;case "UVMAP":(h=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(t=N("param_"+f+"_a"),H=N("param_"+f+"_v"),l.push(U(t)),l.push(U(H)),n.push(U(H)),t={name:t,value:h});k=X(b);break;case "UV_MERGED":t=N("param_UV_MERGED_a");H=N("param_UV_MERGED_v");l.push(U(t));l.push(U(H));k.push(ca(b,"UV_geom"));k.push(ca(b,"UV_cycles"));n.push(U(H));t={name:t,value:b.uv_layer};break;case "CAMERA":m=[];k=X(b);break;case "COMBRGB":case "COMBHSV":m=S(b);k=X(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
f?(M(b,0,0)&&p.push(["READ_R",1]),M(b,1,0)&&p.push(["READ_G",1]),M(b,2,0)&&p.push(["READ_B",1]),M(b,3,0)&&p.push(["READ_A",1])):(M(b,0,-1)&&p.push(["READ_R",1]),M(b,1,-1)&&p.push(["READ_G",1]),M(b,2,-1)&&p.push(["READ_B",1]));m=S(b);k=X(b);t={value:b};break;case "PARTICLE_INFO":m=S(b);k=X(b);for(h=0;h<b.outputs.length;h++){H=b.outputs[h];r=H.identifier;v=U("v_param_PART_INFO_"+r.replace(" ",""));if(H.is_linked)switch(r){case "Size":p.push(["PART_INFO_SIZE",ka.N(1)]);break;case "Age":p.push(["PART_INFO_AGE",
ka.N(1)]);break;case "Lifetime":p.push(["PART_INFO_LT",ka.N(1)]);break;case "Location":p.push(["PART_INFO_LOC",ka.N(1)]);break;case "Index":var x=U("a_param_PART_INFO_"+H.identifier.replace(" ","")),t=x;p.push(["PART_INFO_IND",ka.N(1)]);break;case "Velocity":p.push(["PART_INFO_VEL",ka.N(1)]);break;case "Angular Velocity":p.push(["PART_INFO_A_VEL",ka.N(1)])}"Age"!=r&&"Lifetime"!=r&&"Size"!=r&&(l.push(v),n.push(v))}x&&l.push(x);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!ba(b))return!0;f=u(b,c);if(!f)return xa.error("Geometry output is not supported"),
null;switch(f){case "GEOMETRY_UV":(h=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(t=N("param_GEOMETRY_UV_a"),H=N("param_GEOMETRY_UV_v"),l.push(U(t)),l.push(U(H)),n.push(U(H)),t={name:t,value:h});k.push(ca(b,"UV"));break;case "GEOMETRY_VC":(h=b.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(t=N("param_GEOMETRY_VC_a"),H=N("param_GEOMETRY_VC_v"),l.push(U(t)),l.push(U(H)),n.push(U(H)),t={name:t,value:h});k.push(ca(b,"Vertex Color"));break;case "GEOMETRY_NO":k.push(ca(b,"Normal"));break;case "GEOMETRY_TRN":f=
"GEOMETRY_NO";k.push(ca(b,"True Normal"));xa.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":k.push(ca(b,"Front/Back"));break;case "GEOMETRY_VW":k.push(ca(b,"View"));break;case "GEOMETRY_GL":k.push(ca(b,"Global")||ca(b,"Position"));break;case "GEOMETRY_LO":k.push(ca(b,"Local"));break;case "GEOMETRY_OR":h=N("param_GEOMETRY_OR_v");l.push(U(h));k.push(ca(b,"Orco"));n.push(U(h));break;case "GEOMETRY_IN":k.push(ca(b,"Incoming"));break;case "GEOMETRY_BF":k.push(ca(b,
"Backfacing"))}break;case "TEX_COORD":if(!ba(b))return!0;f=ga(b,c);switch(f){case "TEX_COORD_UV":(h=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(t=N("param_TEX_COORD_UV_a"),H=N("param_TEX_COORD_UV_v"),l.push(U(t)),l.push(U(H)),n.push(U(H)),t={name:t,value:b.uv_layer});k.push(ca(b,"UV"));break;case "TEX_COORD_NO":k.push(ca(b,"Normal"));break;case "TEX_COORD_GE":h=N("param_TEX_COORD_GE_v");l.push(U(h));k.push(ca(b,"Generated"));n.push(U(h));break;case "TEX_COORD_OB":k.push(ca(b,"Object"));break;case "TEX_COORD_CA":k.push(ca(b,
"Camera"));break;case "TEX_COORD_WI":k.push(ca(b,"Window"));break;case "TEX_COORD_RE":k.push(ca(b,"Reflection"))}break;case "GROUP":h=b.node_tree_name;switch(h){case "B4W_LINEAR_TO_SRGB":if(!J(b,[1],[1])){t=F(b,d,g);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!J(b,[1],[1])){t=F(b,d,g);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!J(b,[1],[1])){t=F(b,d,g);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!J(b,[1,1],[1])){t=F(b,d,g);break}f=
"B4W_REFLECT";break;case "B4W_REFRACTION":if(!J(b,[1,0],[1])){t=F(b,d,g);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!J(b,[1,1,0,0,0],[1])){t=F(b,d,g);break}H=N("param_B4W_PARALLAX_texture");n.push(U(H));f="B4W_PARALLAX";break;case "B4W_CLAMP":if(!J(b,[1],[1])){t=F(b,d,g);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!J(b,[0,0,0,0,0],[0])){t=F(b,d,g);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!J(b,[],[0])){t=F(b,d,g);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!J(b,
[0,0,0],[0])){t=F(b,d,g);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:t=F(b,d,g)}m=S(b);k=X(b);"B4W_TRANSLUCENCY"==h&&(h=q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),h.eb=k[0].eb,k.push(h));break;case "LAMP":t=b.lamp;if(!t)return xa.error("There is no lamp in node: "+b.name),null;k.push(ca(b,"Color"));k.push(ca(b,"Light Vector"));k.push(ca(b,"Distance"));k.push(ca(b,"Visibility Factor"));t.uuid in Ga?p.push(["LAMP_INDEX",String(Ga[t.uuid])]):(Ga[t.uuid]=
Ra,p.push(["LAMP_INDEX",String(Ra++)]));t=Ga;break;case "LIGHTING_AMBIENT":m=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0)];k=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":k=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("dif_params","dif_params",[0,0],!0),q("sp_params","sp_params",[0,0],!0),q("shadow_factor","shadow_factor",0,!0),q("translucency_color",
"translucency_color",0,!0),q("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":m=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":m=[q("shadow_factor","shadow_factor",0,!0)];k=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("lcolorint","lcolorint",[0,0,0],!0),q("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":m=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac",
"norm_fac",0,!0)];k=[q("lfactor","lfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":m=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("dif_params","dif_params",[0,0],!0)];k=[q("lfactor","lfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":m=
[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("sp_params","sp_params",[0,0],!0)];k=[q("sfactor","sfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":m=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("sp_params","sp_params",[0,0],!0)];k=[q("sfactor","sfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":m=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("bsdf_params","bsdf_params",[0,0,0,0],!0)];k=[q("lfactor","lfactor",0,!0),q("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":m=[q("color","color",[0,0,0,0],!0),q("specular","specular",[0,0,0],!0),q("lfactor","lfactor",0,!0),q("sfactor","sfactor",0,!0),q("ldir","ldir",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("translucency_params",
"translucency_params",[0,0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("lcolorint","lcolorint",[0,0,0],!0),q("translucency_color","translucency_color",0,!0)];k=[q("color","color",[0,0,0,0],!0),q("specular","specular",[0,0,0],!0)];break;case "NORMAL":m=S(b);k=X(b);h=ca(b,"Normal");n.push(U(N("param_NORMAL_Normal"),h.Ea,3));break;case "MAPPING":h=b.vector_type;f="MAPPING";m.push(E(b,"Vector"));k.push(ca(b,"Vector"));var H=Ea.Ef(b.rotation),r=Ea.Ef(b.scale),v=Ea.Ef(b.translation),x=za.create(),
P=Ea.UT(H);"TEXTURE"==h&&(r[0]=r[0]||1,r[1]=r[1]||1,r[2]=r[2]||1);var B=new Float32Array([r[0],0,0,0,r[1],0,0,0,r[2]]);za.multiply(P,B,x);x=Ea.LW(x,ua.create());switch(h){case "POINT":x[12]=v[0];x[13]=v[1];x[14]=v[2];break;case "TEXTURE":x[12]=v[0];x[13]=v[1];x[14]=v[2];x=ua.invert(x,x);break;case "NORMAL":ua.invert(x,x),ua.transpose(x,x)}switch(h){case "NORMAL":p.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":p.push(["MAPPING_TRS_MATRIX_DEF",1]);p.push(["MAPPING_TRS_MATRIX",ka.N(x,16)]);break;case "POINT":0!==
Ca.length(H)?(p.push(["MAPPING_TRS_MATRIX_DEF",1]),p.push(["MAPPING_TRS_MATRIX",ka.N(x,16)])):(0!==Ca.length(r)&&(p.push(["MAPPING_SCALE_DEF",1]),p.push(["MAPPING_SCALE",ka.N(r,3)])),0!==Ca.length(v)&&(p.push(["MAPPING_TRANS_DEF",1]),p.push(["MAPPING_TRANS",ka.N(v,3)])));break;case "VECTOR":0!==Ca.length(H)?(p.push(["MAPPING_TRS_MATRIX_DEF",1]),p.push(["MAPPING_TRS_MATRIX",ka.N(x,16)])):0!==Ca.length(r)&&(p.push(["MAPPING_SCALE_DEF",1]),p.push(["MAPPING_SCALE",ka.N(r,3)]))}b.use_min&&(p.push(["MAPPING_MIN_CLIP_DEF",
1]),p.push(["MAPPING_MIN_CLIP",ka.N(b.min,3)]));b.use_max&&(p.push(["MAPPING_MAX_CLIP_DEF",1]),p.push(["MAPPING_MAX_CLIP",ka.N(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":t=[];h=[];H=[];r=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("dif_params","dif_params",[0,0],!0),q("sp_params","sp_params",[0,0],!0),q("shadow_factor","shadow_factor",0,!0)];v=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0),
q("normal","normal",[0,0,0],!0)];x=[ca(b,"Color"),ca(b,"Alpha"),ca(b,"Normal")];P=[];B=E(b,"Color");B.Ea.splice(3);H.push(B);m.push(B);B=E(b,"Spec");B.Ea.splice(3);H.push(B);m.push(B);(B=E(b,"DiffuseIntensity"))||(B=E(b,"Refl"));B.Ea=b.diffuse_intensity;H.push(B);m.push(B);var O=E(b,"Normal");O.Ea.splice(3);H.push(O);m.push(O);"MATERIAL_EXT"==f?((B=E(b,"Emit"))||(B=q("Emit","Emit",0)),H.push(B),m.push(B),(B=E(b,"Translucency"))?(B.Ea=0,B.name="Translucency",B.identifier="Translucency"):B=q("Translucency",
"Translucency",0),m.push(B),(B=E(b,"Translucency"))?(B.Ea=[0,0,0,0],B.name="TranslucencyParams",B.identifier="TranslucencyParams"):B=q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),m.push(B),k=E(b,"Reflectivity"),B=E(b,"Ray Mirror"),k?(B=k,k="Reflectivity"):B?k="Ray Mirror":(B=k,k="Reflectivity"),B||(B=q(k,k,0)),m.push(B),v.push(B),(B=E(b,"SpecTra"))||(B=q("SpecTra","SpecTra",0)),m.push(B),v.push(B),(B=E(b,"Alpha"))||(B=q("Alpha","Alpha",b.alpha)),m.push(B),v.push(B),x.push(ca(b,"Diffuse")),
x.push(ca(b,"Spec")),t.push(["MATERIAL_EXT",1]),h.push(["MATERIAL_EXT",1])):(H.push(q("emit_intensity","emit_intensity",0)),v.push(q("reflect_factor","reflect_factor",0)),v.push(q("specular_alpha","specular_alpha",0)),v.push(q("alpha_in","alpha_in",0)),x.push(q("diffuse_out","diffuse_out",0)),x.push(q("spec_out","spec_out",0)),t.push(["MATERIAL_EXT",0]),h.push(["MATERIAL_EXT",0]));P.push(U(N("param_MATERIAL_alpha"),b.alpha));P.push(U(N("param_MATERIAL_spec_alpha"),b.specular_alpha));k=x;t.push(["USE_MATERIAL_NORMAL",
O.eb|0]);b.use_diffuse&&(t.push(["USE_MATERIAL_DIFFUSE",1]),h.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&h.push(["USE_MATERIAL_SPECULAR",1]);var B=[],ia=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":O=b.specular_hardness;break;case "WARDISO":O=b.specular_slope;break;case "TOON":O=b.specular_toon_size;ia=b.specular_toon_smooth;break;case "BLINN":O=b.specular_ior;ia=b.specular_hardness;break;default:xa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),O=b.specular_hardness}var w,z;switch(b.diffuse_shader){case "LAMBERT":z=w=0;break;case "OREN_NAYAR":w=b.roughness;z=0;break;case "FRESNEL":w=b.diffuse_fresnel;z=b.diffuse_fresnel_factor;break;case "MINNAERT":w=b.darkness;z=0;break;case "TOON":w=b.diffuse_toon_size;z=b.diffuse_toon_smooth;break;default:xa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),z=w=0}B.push(U(N("param_MATERIAL_diffuse"),[w,z],2));B.push(U(N("param_MATERIAL_spec"),[b.specular_intensity,
O,ia],3));t.push(["SHADELESS_MAT",b.use_shadeless?1:0]);O={name:b.name,value:{Ks:b.specular_shader,Vq:b.diffuse_shader,Ke:b.use_shadeless,cn:b.use_tangent_shading}};t={name:b.name,value:{Ks:b.specular_shader,Vq:b.diffuse_shader,Ke:b.use_shadeless,cn:b.use_tangent_shading},MW:{name:"material_begin",type:"MATERIAL_BEGIN",L:H,gb:r,rb:B,data:O,Rb:t,qi:[]},NW:{name:"material_end",type:"MATERIAL_END",L:v,gb:x,rb:P,data:O,Rb:h,qi:[]}};break;case "BSDF_DIFFUSE":m=S(b);p.push(["USE_NORMAL_IN",m[2].eb|0]);
k=ca(b,"BSDF");h=k.eb;k=[k,q("d_color","d_color",[0,0,0],h),q("d_roughness","d_roughness",0,h),q("s_color","s_color",[0,0,0],h),q("s_roughness","s_roughness",0,h),q("metalness","metalness",0,h),q("normal","normal",[0,0,0],h),q("e_color","e_color",[0,0,0],h),q("emisson","emisson",0,h)];break;case "BSDF_GLOSSY":m=S(b);p.push(["USE_NORMAL_IN",m[2].eb|0]);k=ca(b,"BSDF");h=k.eb;k=[k,q("d_color","d_color",[0,0,0],h),q("d_roughness","d_roughness",0,h),q("s_color","s_color",[0,0,0],h),q("s_roughness","s_roughness",
0,h),q("metalness","metalness",1,h),q("normal","normal",[0,0,0],h),q("e_color","e_color",[0,0,0],h),q("emisson","emisson",0,h)];break;case "EMISSION":m=S(b);k=ca(b,"Emission");h=k.eb;k=[k,q("d_color","d_color",[0,0,0],h),q("d_roughness","d_roughness",0,h),q("s_color","s_color",[0,0,0],h),q("s_roughness","s_roughness",0,h),q("metalness","metalness",1,h),q("normal","normal",[0,0,0],h),q("e_color","e_color",[0,0,0],h),q("emisson","emisson",1,h)];break;case "MATH":switch(b.operation){case "ADD":f="MATH_ADD";
break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";break;case "ARCCOSINE":f="MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";break;
case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return xa.error("Unsupported MATH operation: "+b.operation),null}p.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);m=S(b);k=X(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f=
"MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;case "DODGE":f="MIX_RGB_DODGE";break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return xa.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}p.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);m=S(b);k=X(b);break;case "OUTPUT":m=S(b);k=[];break;case "OUTPUT_MATERIAL":S(b);m=E(b,"Surface");k=m.eb;t=[m,q("d_color","d_color",[0,0,0],k),q("d_roughness","d_roughness",0,k),q("s_color","s_color",[0,0,0],k),q("s_roughness","s_roughness",0,k),q("metalness","metalness",0,k),q("normal","normal",
[0,0,0],k),q("e_color","e_color",[0,0,0],k),q("emission","emission",0,k)];h=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("bsdf_params","bsdf_params",[0,0,0,0],!0),q("shadow_factor","shadow_factor",0,!0),q("s_color","s_color",[0,0,0],!0),q("metalness","metalness",0,!0),q("e_color","e_color",[0,0,0],!0),q("emission","emission",0,!0)];H=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0),q("normal","normal",
[0,0,0],!0),q("s_color","s_color",[0,0,0],!0),q("metalness","metalness",0,!0),q("e_color","e_color",[0,0,0],!0),q("emission","emission",0,!0)];r=[];m=t;k=r;t={name:b.name,value:{kR:"BSDF_COMPUTE"},iR:{name:"bsdf_begin",type:"BSDF_BEGIN",L:t,gb:h,rb:[],data:null,Rb:[],qi:[]},jR:{name:"bsdf_end",type:"BSDF_END",L:H,gb:r,rb:[],data:null,Rb:[],qi:[]}};break;case "RGB":h=b.name;h={name:"-1",value:h};n.push(h);k.push(ca(b,"Color"));break;case "SEPRGB":case "SEPHSV":m=S(b);k=X(b);break;case "TEX_ENVIRONMENT":(h=
b.image)?(f="TEXTURE_ENVIRONMENT","NONE"==b.color_space?p.push(["NON_COLOR",1]):p.push(["NON_COLOR",0]),m.push(E(b,"Vector")),k.push(ca(b,"Color")),H=N("param_TEXTURE_texture"),n.push(U(H)),t=ma.$G(128),t.source="ENVIRONMENT_MAP",ma.HF(t,h),t={name:H,value:t}):f="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(h=b.image){f="TEXTURE_COLOR";"NONE"==b.color_space?p.push(["NON_COLOR",1]):p.push(["NON_COLOR",0]);p.push(["CONVERT_UV",0]);for(H=0;4>H;++H)H?(B=q("Vector"+H,"Vector"+H,[0,0,0],!1),r=q("Color"+H,"Color"+
H,[0,0,0],!1),v=q("Alpha"+H,"Alpha"+H,0,!1)):(B=E(b,"Vector"),r=ca(b,"Color"),v=ca(b,"Alpha")),m.push(B),k.push(r),k.push(v);H=N("param_TEXTURE_texture");n.push(U(H));t=ma.Kl(ma.Ah,!1);t.repeat="REPEAT"==b.extension;t.source="IMAGE";ma.HF(t,h);t={Ez:b.name,name:H,value:t}}else f="TEXTURE_EMPTY";break;case "TEXTURE":f=Z(b);if("TEXTURE_EMPTY"==f)k.push(ca(b,"Color")),k.push(ca(b,"Normal")),k.push(ca(b,"Value"));else if("TEXTURE_ENVIRONMENT"==f)m.push(E(b,"Vector")),k.push(ca(b,"Color")),k.push(ca(b,
"Value"));else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==b.texture.type)return xa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==f&&(h=!1,(H=b.texture.image)&&"Non-Color"==H.colorspace_settings_name&&(h=!0),p.push(["NON_COLOR",Number(h)]),p.push(["CONVERT_UV",1]));for(H=0;4>H;++H)h="TEXTURE_COLOR"==f?"Color":"Normal",H?(B=q("Vector"+H,"Vector"+H,[0,0,0],!1),r=q(h+H,h+H,[0,0,0],!1),v=q("Value"+H,"Value"+H,0,!1)):(B=E(b,"Vector"),r=ca(b,h),v=ca(b,"Value")),m.push(B),
k.push(r),k.push(v)}"TEXTURE_EMPTY"!=f&&(H=N("param_TEXTURE_texture"),n.push(U(H)),t=b.texture.s,t={Ez:b.texture.name,name:H,value:t});break;case "VALTORGB":m=S(b);k=X(b);t={value:b};h=b.color_ramp.interpolation;"CONSTANT"!=h&&"LINEAR"!=h&&xa.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";h=b.name;h={name:"-1",value:h};n.push(h);k.push(ca(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";break;
case "AVERAGE":f="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return xa.error("Unsupported VECT_MATH operation: "+b.operation),null}m=S(b);k=X(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":p.push(["VECTOR_TYPE",ka.N(0)]);break;case "VECTOR":p.push(["VECTOR_TYPE",ka.N(1)]);break;case "NORMAL":p.push(["VECTOR_TYPE",ka.N(2)]);break;default:return xa.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}m=b.convert_from;k=b.convert_to;h=0;if("WORLD"==m)if("WORLD"==k)h=0;else if("OBJECT"==k)h=1;else if("CAMERA"==k)h=2;else return xa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==m)if("WORLD"==k)h=3;else if("OBJECT"==k)h=4;else if("CAMERA"==k)h=5;else return xa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==m)if("WORLD"==k)h=6;else if("OBJECT"==k)h=7;else if("CAMERA"==k)h=8;else return xa.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return xa.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;p.push(["CONVERT_TYPE",ka.N(h)]);m=S(b);k=X(b);break;case "NORMAL_MAP":h=0;switch(b.space){case "TANGENT":h=0;break;case "OBJECT":h=1;break;case "WORLD":h=2;break;case "BLENDER_OBJECT":h=3;break;case "BLENDER_WORLD":h=4;break;default:return xa.error("Unsupported NORMAL_MAP space: "+b.space),null}p.push(["SPACE",ka.N(h)]);m.push(E(b,"Strength"));m.push(E(b,"Color"));k.push(ca(b,"Normal"));break;
case "FRESNEL":O=E(b,"Normal");m.push(E(b,"IOR"));m.push(O);k.push(ca(b,"Fac"));p.push(["USE_FRESNEL_NORMAL",O.eb|0]);break;case "LAYER_WEIGHT":O=E(b,"Normal");m.push(E(b,"Blend"));m.push(O);k=X(b);p.push(["USE_NORMAL_IN",O.eb|0]);break;case "BUMP":O=E(b,"Normal"),p.push(["INVERT",b.invert?1:0]),p.push(["USE_NORMAL_IN",O.eb|0]),S(b),X(b);default:m=S(b),k=X(b)}f={name:e,type:f,qi:l,L:m,gb:k,rb:n,data:t,Rb:p};e=C.am(a);C.Fj(a,C.am(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{f=b.outputs;for(n=l=0;n<f.length;n++)if(f[n].is_linked&&l++>c){f=!0;break a}f=!1}f=!f}return f||null!=da(a,b,++c,d,g)?e:null}function J(a,b,c){for(var d=a.inputs,g=a.outputs,e=a.node_tree_name,f=0;f<b.length;f++){var q=d[f],l=b[f];if(!q||q.default_value instanceof Array!=l)return xa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',e,'".Processing as general node group.'),!1}for(f=0;f<c.length;f++)if(b=g[f],d=c[f],!b||b.default_value instanceof Array!=d)return xa.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',e,'".Processing as general node group.'),!1;return!0}function F(a,b,c){var d=a.node_group.node_tree,g={},e;for(e in d)if("links"==e||"nodes"==e){g[e]=[];for(var f=0;f<d[e].length;f++){g[e][f]={};for(var q in d[e][f])if("links"==e){g[e][f][q]={};for(var l in d[e][f][q])g[e][f][q][l]=T(d[e][f][q][l])}else g[e][f][q]=T(d[e][f][q])}}else g[e]=T(d[e]);d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)e=t("Group input","GROUP_INPUT",[],a.inputs),f=t("Group output",
"GROUP_OUTPUT",a.outputs,[]),q=null,q="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(H.quality==ea.Mp||H.QH)?{from_node:e,from_socket:e.outputs[1],to_node:f,to_socket:f.inputs[0]}:{from_node:e,from_socket:e.outputs[0],to_node:f,to_socket:f.inputs[0]},g.nodes=[e,f],g.links=[q];d=a.name;e=g.nodes;f=g.links;for(q=0;q<e.length;q++)e[q].name=pa(e[q].type,d,e[q].name);for(q=0;q<f.length;q++)f[q].from_node.name=pa(f[q].from_node.type,d,f[q].from_node.name),f[q].to_node.name=pa(f[q].to_node.type,d,f[q].to_node.name);
return{$W:p(g,a.node_group.uuid,!0,b,c).Xa,aX:g.links}}function T(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ea.yq(a):a}function N(a){Ba[a]||(Ba[a]=0);var b=a+"_"+Ba[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ba[a]++;return b}function ba(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function u(a,b){for(var c=a.outputs,d=0,g=0;g<c.length;g++){var e=c[g];if(e.is_linked&&!(d++<b))switch(e.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ga(a,b){for(var c=a.outputs,d=0,g=0;g<c.length;g++){var e=c[g];if(e.is_linked&&!(d++<b))switch(e.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function Z(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,g=!1,e=0;e<b.length;e++){var f=b[e];if(f.is_linked)switch(f.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":g=!0;break;default:Ea.q("Unknown texture output")}}if(c)return d&&
xa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(g)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function E(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var g=c[d];if(g.identifier==b)return ha(g)}return null}function ca(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var g=c[d];if(g.identifier==b)return ha(g)}return null}function ha(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=Ea.jk(a)?a.slice(0):a;return{name:b,identifier:c,eb:d,Ea:a}}function q(a,b,c,d){return{name:a,identifier:b,eb:d,Ea:c}}function S(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ha(a.inputs[c]);d.Ea.length&&d.Ea.splice(3);b.push(d)}return b}function X(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ha(a.outputs[c]);b.push(d)}return b}function U(a,b,c){b=null===b||void 0===b?null:ka.N(b,c);return{name:a,value:b}}function sa(a,b,c,d,g,e){var f=
[],q=e.from_socket.identifier;e=e.to_socket.identifier;var l=d.gb;for(d=0;d<l.length;d++)if(l[d].identifier==q){f.push(d);break}g=g.L;for(d=0;d<g.length;d++)if(g[d].identifier==e){f.push(d);break}2==f.length&&C.ed(a,b,c,f);return!0}function pa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function aa(a){var b=[];C.pa(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function oa(a,b,c){for(var d=0;d<c.length;d++){var g=c[d].data.$W,e=c[d].data.aX;if(!g)return!1;
C.pa(g,function(b,c){C.Fj(a,C.am(a),c)});for(g=0;g<e.length;g++)b.push(e[g]);ta(c[d],b,a)}return!0}function ya(a,b,c,d,g,e){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||g.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||e.push(c)}}function wa(a,b,c){for(var d=[],g=0;g<c.length;g++){for(var e=c[g],f=null,q=0;q<b.length;q++)if(e.from_socket.identifier==b[q].to_socket.identifier){f=b[q];break}f?(e.from_node=f.from_node,e.from_socket=f.from_socket):
d.push(e)}for(g=0;g<b.length;g++)a.splice(a.indexOf(b[g]),1);return d}function la(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function ia(a,b,c,d){for(var g=0;g<d.length;g++){for(var e=d[g],f,q=0;q<c.L.length;q++)if(e.from_socket.identifier==c.L[q].identifier){f=c.L[q].Ea;break}for(var q=e,l=b,m=f,u=B(q.to_node,l),k=0;k<u.length;k++)for(var n=C.Wa(l,u[k]),t=0;t<n.L.length;t++){var p=n.L[t];if(p.identifier==q.to_socket.identifier){n=p.Ea instanceof
Object?0:1;if((m instanceof Object?0:1)==n)p.Ea=m;else switch(n){case 0:p=p.Ea;p[0]=p[1]=p[2]=m;break;case 1:p.Ea=(m[0]+m[1]+m[2])/3}break}}e=a.indexOf(e);-1!=e&&a.splice(e,1)}}function ta(a,b,c){for(var d=a.name,g=[],e=[],f=[],q=[],l=0;l<b.length;l++){var m=b[l];ya(m.from_node,d,m,g,f,q);ya(m.to_node,d,m,e,f,q)}e=wa(b,e,f);g=wa(b,q,g);la(b,e);ia(b,c,a,e);if(g.length){var u;C.pa(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(u=b)});ia(b,c,u,g)}}function na(a){var b=[],c=[];C.pa(a,
function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,g=a=null,e=b.length+c.length;if(b.length){a=ma.YT(b,ma.PN);for(var f=0;f<b.length;f++)b[f].Rb.push(["NODE_TEX_ROW",ka.N((d+.5)/e)]),d++}if(c.length)for(g=ma.bU(c,ma.zE),f=0;f<c.length;f++)c[f].Rb.push(["NODE_TEX_ROW",ka.N((d+.5)/e)]),d++;f=null;a&&g?(f=new Uint8Array(a.length+g.length),f.set(a),f.set(g,a.length)):f=a?a:g;a=f?ma.ZG(f,ma.zE):null;for(f=0;f<b.length;f++)b[f].data.kb=a;
for(f=0;f<c.length;f++)c[f].data.kb=a}function M(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ea=h("__config");h("__debug");var C=h("__graph"),za=h("__mat3"),ua=h("__mat4"),ja=h("__objects"),xa=h("__print"),ka=h("__shaders"),Pa=h("__scenes"),Ea=h("__util"),Ca=h("__vec3"),ma=h("__textures"),Ba={},va={},Ma={},Ga={},Ra=0;new Float32Array(4);var H=ea.B;a.U1=0;a.ZP=1;a.YP=2;a.XP=3;a.T1=4;a.WP=5;a.VP=6;a.UP=7;a.S1=8;a.JO=0;
a.IO=1;a.K1=2;a.HO=3;a.J1=4;a.EI=function(a){return va[a]};a.ZR=function(a){delete va[a]};a.gS=p;a.lA=function(a,c,d){var g=Pa.A();a=k(a,"MAIN",g.uuid);if(a in Ma)return Ma[a];var g=C.create(),e={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},f=da(g,e,0,c,null),e={name:"LIGHTING_END",type:"LIGHTING_END"},e=da(g,e,0,c,null);b(g,d,f,e,[[f,[8,10]],[f,[9,6]]],c);l(g);return Ma[a]=g};a.qu=function(a){var b=[],c={};Ba={};var d=C.RD(a);C.pa(d,function(a,d){var g;g=[];for(var e=[],f=[],q=[],l=[],m=[],u=0;u<
d.L.length;u++){var k=d.L[u];if(k.eb)g.push(null),e.push(null);else{g.push(N("in_"+d.type+"_"+k.identifier.replace(/\./g,"")));var n=ka.N(k.Ea,0);H.qD&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==k.identifier||"Color2"==k.identifier||"Fac"==k.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==k.identifier||"Value_001"==k.identifier||"Value.001"==k.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==k.identifier||"Vector.001"==k.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||
0<=d.type.indexOf("MATERIAL_BEGIN"))&&(k=n,k=k.replace(/(,)/g,"$1 "),k=k.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),k=k.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),n=k=k.replace(/\s+/g,""));e.push(n)}}for(u=0;u<d.gb.length;u++)k=d.gb[u],k.eb?f.push(null):f.push(N("out_"+d.type+"_"+k.identifier.replace(/\./g,"")));for(u=0;u<d.rb.length;u++)k=d.rb[u],q.push(k.name),l.push(k.value);for(u=0;u<d.qi.length;u++)m.push(d.qi[u].name);g={id:d.type,L:g,yB:e,gb:f,rb:q,tw:l,qi:m,Rb:JSON.parse(JSON.stringify(d.Rb))};
b.push(g);c[a]=g});C.xg(d,function(a,b,g){var e=C.Wa(d,a);C.Wa(d,b);var f=e.gb[g[0]];a=c[a].gb;b=c[b].L;e=a[g[0]]||N("out_"+e.type+"_"+f.identifier.replace(/\./g,""));a[g[0]]=e;b[g[1]]=e});return b};a.EG=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.ua=function(){for(var a in va)delete va[a];for(a in Ma)delete Ma[a];for(var b in Ga)delete Ga[b];Ra=0}};b4w.module.__debug=function(a,h){function p(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function e(){var a=l.eB();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=x;return b&&b.debug_view_mode==a.xp}function y(a,b,c){var d=l.eB(),g=0;if(d)for(c&&d.endQuery(),c=0;c<a.length;c++){var e=a[c],f=d.dI(e),m=I.getParameter(d.cI());f&&!m&&(g=d.eI(e)/1E6,b&&(g=D.mc(g,b,1,10)),a.splice(c,1),c--)}else g=performance.now()-
a.pop(),b&&(g=D.mc(g,b,1,10));return g}function r(a,b){A(a)||D.q("Structure assertion failed: invalid first object value");A(b)||D.q("Structure assertion failed: invalid second object value");k(a,b)||D.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||D.DB(a)||a instanceof Array)){for(var c in a)A(a[c])||D.q("Structure assertion failed: invalid value for key in the first object: "+c),c in b||D.q("Structure assertion failed: missing key in the first object: "+
c);for(c in b)A(b[c])||D.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||D.q("Structure assertion failed: missing key in the second object: "+c),k(a[c],b[c])||D.q("Structure assertion failed: incompatible types for key "+c)}}function A(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function k(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;
c=D.DB(a);d=D.DB(b);if(c&&!d||!c&&d)return!1}return!0}var w=h("__compat"),n=h("__config"),l=h("__extensions"),f=h("__graph"),v=h("__objects"),c=h("__print"),B=h("__scenes"),Q=h("__subscene"),K=h("__textures"),G=h("__time"),D=h("__util"),R=n.B,L={},I=null,z={},d=[],m=-1,O=-1,x=null,g=null,P=!1,t={};a.qt=0;a.ky=1;a.rt=2;a.jy=3;a.pt=4;a.iy=5;a.hy=6;a.xp=7;a.Nf=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;
for(c in b){var d=b[c];d in a&&(L[a[d]]=d)}I=a};a.kY=function(a){x=a};a.D4=function(){return x};a.hU=function(a,b,c,d,g){t[a]||(t[a]={TY:b,Re:{}});c in t[a].Re||(t[a].Re[c]=d);g&&(t[a].Re[c]=0)};a.pG=function(){var a=0,b;for(b in t)for(var c in t[b].Re)a+=t[b].Re[c];return a};a.bM=function(){var a={},b;for(b in t)for(var d in t[b].Re){var g=t[b].Re[d];if(g){var e=t[b].TY;e in a||(a[e]={SD:0,Re:{}});d in a[e].Re||(a[e].Re[d]=0);a[e].Re[d]+=g;a[e].SD+=g}}for(e in a){c.groupCollapsed(e,a[e].SD);for(d in a[e].Re)c.ae(d,
a[e].Re[d]);c.groupEnd()}};a.LK=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),d=0,g=0,e=v.Ub(B.Rh(),"MESH",v.oc),f=0;f<e.length;f++)for(var l=0;l<e[f].I.length;l++)for(var m=0;m<e[f].I[l].W.length;m++){var k=D.Ih(e[f].I[l].W[m]),n=k.ib.yg+"/"+k.ib.Xe;k["shaders_info.directives"]=k.ib.Mi;k["shaders_info.node_elements"]=k.ib.og;delete k.ib;for(var t=0;t<b.length;t++)delete k[b[t]];
if(e[f].Sa)g++;else{d++;k.type in a||(a[k.type]={});n in a[k.type]||(a[k.type][n]={});for(var q in k)q in a[k.type][n]||(a[k.type][n][q]=[]),t=JSON.stringify(k[q]),-1==a[k.type][n][q].indexOf(t)&&a[k.type][n][q].push(t)}}c.group("Batches statistics:");c.ae("STATIC/DYNAMIC count:",d+"/"+g);c.group("STATIC batches diversity:");for(var p in a)for(n in a[p]){b=[];for(q in a[p][n])1<a[p][n][q].length&&b.push([q,a[p][n][q]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){c.groupCollapsed(p+" "+n);for(f=0;f<b.length;f++)c.ae(b[f][1].length,b[f][0],b[f][1]);c.groupEnd()}}c.groupEnd();c.groupEnd()};a.Qz=function(a){if(R.gl_debug){var b=I.getError();b!=I.NO_ERROR&&(b in L?D.q("GL Error: "+b+", gl."+L[b]+" ("+a+")"):D.q("Unknown GL error: "+b+" ("+a+")"))}};a.GR=function(){if(R.gl_debug||R.DG)switch(I.checkFramebufferStatus(I.FRAMEBUFFER)){case I.FRAMEBUFFER_COMPLETE:break;case I.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case I.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case I.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case I.FRAMEBUFFER_UNSUPPORTED:c.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case I.B0:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:c.error("FRAMEBUFFER CHECK FAILED")}};a.LR=function(){if(-1!=
m)return m;I.bindFramebuffer(I.FRAMEBUFFER,I.createFramebuffer());var a=K.Kl(K.nl,!1);K.resize(a,1,1);I.framebufferTexture2D(I.FRAMEBUFFER,I.DEPTH_ATTACHMENT,a.nb,a.sb,0);I.checkFramebufferStatus(I.FRAMEBUFFER)!=I.FRAMEBUFFER_COMPLETE?(m=!0,c.warn("depth-only issue was found")):m=!1;I.bindFramebuffer(I.FRAMEBUFFER,null);return m};a.QR=function(){if(1==R.Fc)return!1;if(-1!=O)return O;I.bindRenderbuffer(I.RENDERBUFFER,I.createRenderbuffer());I.renderbufferStorageMultisample(I.RENDERBUFFER,R.Fc,I.RGBA8,
1,1);var a=I.getRenderbufferParameter(I.RENDERBUFFER,I.RENDERBUFFER_SAMPLES);a!=R.Fc?(O=!0,c.warn("multisample issue was found: requested "+R.Fc+", got "+a),I.getError()==I.INVALID_OPERATION&&c.warn("the error from multisample issue detected, ignoring")):O=!1;I.bindRenderbuffer(I.RENDERBUFFER,null);return O};a.NR=function(){return w.Rz("Firefox")&&I.getError()==I.OUT_OF_MEMORY?(c.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.bL=function(a,b,d){R.gl_debug&&(d=p(d),c.error("shader compilation failed:\n"+
d+"\n"+I.getShaderInfoLog(a)+" ("+b+")"))};a.QX=function(a,b,d,g){R.gl_debug&&(d=p(d),g=p(g),c.error("shader linking failed:\n"+d+"\n\n\n"+g+"\n"+I.getProgramInfoLog(a)+" ("+b+")"))};a.QC=function(a){if(R.show_hud_debug_info||a.type==Q.Kp)a.IA||a.Ml.push(e())};a.LX=function(a){"MAIN"==a.type&&b()&&a.Ml.push(e())};a.RC=function(a){if((R.show_hud_debug_info||a.type==Q.Kp)&&!a.IA){var b=y(a.Ml,a.Cf,!0);b&&(a.Cf=b)}};a.MX=function(a){if("MAIN"==a.type&&b()){var c=y(a.Ml,a.Cf,!0);c&&(a.Cf=c)}};a.EJ=b;
a.zX=function(a){var b=y(a.Ml,a.Cf,!1);b&&(a.Cf=b)};a.S3=function(a){z[a]=a in z?z[a]+1:1};a.update=function(){for(var a in z)c.log(a,z[a]),z[a]=0};a.Qu=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(D.jk(c))for(var g=0;g<c.length;g++)a.push(c[g]);else a.push(arguments[b])}d.push(a)};a.gK=function(){for(var a=1,b=0;b<d.length;b++){var c=d[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],D.jk(a))for(var g=0;g<a.length;g++)c.push(a[g]);
else c.push(arguments[b]);d.push(c)};var da=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.MK=function(a){a||(a=1);for(var b=0,g={},e=Math.max(0,performance.now()-1E3*a),f=0;f<d.length;f++){var l=d[f];a=l[0];if(!(a<e)){var m=String(l[1]);g[m]||(g[m]=da[b++%da.length]);a=["%c"+(a/1E3).toFixed(6),g[m],m];for(m=2;m<l.length;m++)a.push(l[m]);c.log.apply(this,a)}}d.splice(0)};a.BC=function(a){a||(a=1);for(var b={},g=Math.max(0,performance.now()-1E3*a),e=0;e<d.length;e++){var f=
d[e];a=f[0];if(!(a<g))for(var l=2;l<f.length;l++){var m=String(f[1]);3<f.length&&(m+="_"+String(l-2));b[m]||(b[m]=m+"\n");b[m]+=String(a)+" "+f[l]+"\n"}}a="";for(m in b)a+=b[m]+"\n\n";c.log(a);d.splice(0)};a.M2=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.CG=function(a){if(D.jk(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.r2=function(a,b){a.constructor!=b&&D.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.t2=r;a.u2=function(a){P?r(a,g):P=!0;g=null!=a&&"object"==typeof a?D.yq(a):a};a.NH=function(a,
b,c,d,g){(a=a||null)||D.q("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&D.q("Max percentage must be less than 100");0>c&&D.q("Min percentage must be greater than 0");c>d&&D.q("Max percentage must be greater than min percentage");var e=G.wn(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(G.lu(e),g&&g())})};a.g7=function(a){return f.uT(a,function(a,b){var c=b.type+"("+b.name+")",d=b.L,c=c+"\n\nINPUTS:";if(d.length)for(var g=0;g<d.length;g++)c+="\n"+d[g].identifier+": ",c=d[g].eb?
c+"linked":c+d[g].Ea;else c+="\n---";d=b.gb;c+="\n\nOUTPUTS:";if(d.length)for(g=0;g<d.length;g++)c+="\n"+d[g].identifier+": ",c=d[g].eb?c+("linked(default "+d[g].Ea+")"):c+"not used";else c+="\n---";g="";switch(b.type){case "GEOMETRY_UV":g="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":g="\ntexture: "+b.data.value.name+"\n("+b.data.value.Yn+")"}""==g&&(g="\n---");return c=c+"\n\nDATA:"+g},function(b,c,d){b=f.Wa(a,b);c=f.Wa(a,c);return b.gb[d[0]].identifier+"\n==>\n"+
c.L[d[1]].identifier})};a.av=function(){return I};a.ua=function(){x=null;t={}};a.reset=function(){I=null}};b4w.module.__compat=function(a,h){function p(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function e(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var y=h("__config"),r=h("__debug"),A=h("__extensions"),
k=h("__print"),w=h("__renderer"),n="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.SE=256;var l=y.sl,f=y.B,v=y.Tq,c=y.context,B=y.Gi,Q=y.X,K=y.C,G=y.Pd;a.AT=function(a){a.getError()==a.INVALID_ENUM&&k.warn("Possible Tegra invalid enum issue detected, ignoring")};a.EL=function(h,R){function L(a){R&&k.warn(a)}B.OW=h.getParameter(h.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
B.Yv=h.getParameter(h.MAX_FRAGMENT_UNIFORM_VECTORS);B.ZB=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS);B.Zv=h.getParameter(h.MAX_VARYING_VECTORS);B.$B=h.getParameter(h.MAX_VERTEX_ATTRIBS);B.eK=h.getParameter(h.MAX_VERTEX_TEXTURE_IMAGE_UNITS);B.Tr=h.getParameter(h.MAX_VERTEX_UNIFORM_VECTORS);B.Zi=h.getParameter(h.MAX_CUBE_MAP_TEXTURE_SIZE);B.WB=h.getParameter(h.MAX_RENDERBUFFER_SIZE);B.Ec=h.getParameter(h.MAX_TEXTURE_SIZE);B.aC=h.getParameter(h.MAX_VIEWPORT_DIMS);f.ec&&!v.enabled&&(f.Fq=!0);f.ec?(f.Fc=
Math.min(f.Fc,h.getParameter(h.MAX_SAMPLES)),p("Firefox")&&(L("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),f.DG=!0),p("Windows")&&p("Chrome")&&(L("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),f.Fc=1)):f.Fc=1;p("Firefox")&&"NONE"!==f.stereo&&(L("Firefox and Stereo rendering detected, disable texture reusage"),f.OH=!0);if(f.ec&&r.QR()||p("Firefox"))L("Firefox detected, disabling multisample"),f.Fc=1;w.nY();var I=Boolean(A.TU());
p("Firefox/28.0")&&(p("Linux")||p("Macintosh"))&&(L("Firefox 28 detected, applying depth hack"),I=!1);p("Windows Phone")||(p("iPad")||p("iPhone")?(L("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),c.alpha||(f.background_color[3]=1),f.jL=!0,f.yN=!0,f.smaa=!1,f.ssao=!1,f.precision="highp",f.xB=!0,Boolean(A.KI())&&G.Cw&&(f.Gq="pvr")):p("Mac OS X")&&p("Safari")&&
!p("Chrome")&&(L("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),f.iL=!0,Q.UF=!0,Q.KG=!0));p("Windows")&&(p("Chrome/40")||p("Firefox/33")||p("Firefox/34")||p("Firefox/35")||p("Firefox/36"))&&(L("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.Uz=!0);p("Chrome")&&!e()&&y.AJ()&&(L('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
f.JG=!0);p("Mac OS X")&&(f.Wv=!0,L("OS X detected, applying shadows hack."));e()&&(L("Mobile detected, applying various hacks for video textures."),f.is_mobile_device=!0,p("iPad")||p("iPhone")||p("Windows Phone")||(L("Mobile (not iOS) detected, disable playback rate for video textures."),Q.DH=!0));(p("Firefox/35.0")||p("Firefox/36.0"))&&p("Windows")&&(L("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.aM=!0);if(p("iPhone")||b()||p("Edge"))L("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
f.zs=!0;10>B.Zv&&(L("Not enough varyings, disable shadows on blend objects"),f.FA=!0);p("Windows Phone")&&(L("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),f.debug_view=!1,f.precision="highp",f.Ui=!1,f.ssao=!1,f.smaa=!1,f.shadows=!1,f.reflections=!1,f.refractions=!1,f.QK=!1);if(p("UCBrowser")||p("Chrome")&&p("Nexus")&&f.is_mobile_device)L("Mobile Nexus Chrome or UCBrowser detected, disable workers."),K.bt=!1;var z=A.ev();if(z){var d=
h.getParameter(z.UNMASKED_VENDOR_WEBGL),z=h.getParameter(z.UNMASKED_RENDERER_WEBGL),m=/\b4\d{2}\b/;-1<d.indexOf("ARM")&&m.test(z)&&(L("ARM Mali-400 series detected, applying depth and frames blending hacks"),I=!1,l.UH=!0);-1<d.indexOf("ARM")&&-1<z.indexOf("Mali-T604")&&(L('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),f.precision="highp",f.shadows=!1);-1<d.indexOf("ARM")&&-1<z.indexOf("Mali-T760")&&(L('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),f.precision=
"highp",f.ssao=!1,f.cx=!0,f.ec&&(f.Fc=1,L("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<d.indexOf("Qualcomm")&&-1<z.indexOf("Adreno")&&(L("Qualcomm Adreno detected, applying shader constants hack."),f.qD=!0,-1<z.indexOf("305")&&(L('Qualcomm Adreno305 detected, set "highp" precision.'),f.precision="highp"),-1<z.indexOf("330")&&(L('Qualcomm Adreno330 detected, set "highp" precision.'),f.precision="highp"),-1<z.indexOf("420")&&(L("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
B.Ec=4096,B.Zi=4096));-1<d.indexOf("NVIDIA")&&-1<z.indexOf("Tegra 3")&&(L("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.QH=!0);p("Windows")&&p("Chrome")&&!p("Edge")&&(z.match(/NVIDIA GeForce 8..0/)||z.match(/NVIDIA GeForce 9..0/)||z.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(L("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),B.Zi=a.SE,f.UC=!0);-1<z.indexOf("AMD")&&p("Windows")&&p("Chrome")&&
(f.pz=!0);-1<z.indexOf("PowerVR")&&(L("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),f.UC=!0,f.cx=!0,f.shadows=!1);d="";for(m=0;m<n.length;m++)if(-1<z.indexOf(n[m])){d=n[m];break}d&&(L("Architecture "+d+" detected. Blending between frames and shadows on blend objects will be disabled."),f.cx=!0,f.FA=!0)}0==B.eK&&(L("Vertex textures are not allowed. Disabling vertex textures"),f.Tt=!1);I||(f.fr=!1,f.hd=!1,f.water_dynamic=
!1,f.Kk=!1,f.ax=!1,f.smaa=!1);f.jN=Boolean(A.OI())||"pvr"==f.Gq;f.Hu=I;if(h.getShaderPrecisionFormat)var O=h.getShaderPrecisionFormat(h.FRAGMENT_SHADER,h.HIGH_FLOAT);h.getShaderPrecisionFormat&&0!==O.precision||(f.precision="mediump");if(b()&&p("Touch")||p("Edge"))L("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),f.Xn=!0;if(b()||p("Edge"))f.vJ=!0;e()&&p("Firefox")&&(k.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
f.cC=!0,B.Ec=4096,B.Zi=4096);p("Edge")&&(L("Microsoft Edge detected, set up new minimal texture size."),f.br=!0)};a.Rz=p;a.Zf=e;a.GQ=function(){p("Firefox/35.0")&&p("Windows")&&(k.warn("Windows/Firefox 35 detected, forcing context's alpha"),y.context.alpha=!0)};a.Hr=b};b4w.module.__renderer=function(a,h){function p(a){for(var g=a.p,e=a.Ra,l=null,k=Q.hc(g.n,da),p=0;p<e.length;p++){var h=e[p];if(h.cc){var v=h.zb,h=h.sa;if(v.di!=l){m.useProgram(v.di);for(var l=a,q=g,S=v,x=S.WM,U=x.length;U--;){var B=x[U];B.Tn(m,B.df,l,q)}if(S.Wr&&!S.iw)for(S.yC.length||r(S),S=S.yC,U=S.length;U--;)B=S[U],B.Tn(m,B.df,l,q);l=v.di}for(q=0;q<h.length;q++)if(x=h[q],x.cc){S=x.ff;U=x.za;n.LX(U);n.EJ()&&"DEBUG_VIEW"==U.type&&(U.Rq=K.mc(A.VQ(U.Hn),U.Rq,1,15));if(T.alpha_sort&&U.sf){var B=S,
x=x.Dv,O=k,P=U.Ca,w=D.dist(O,x.LN),z=T.alpha_sort_threshold*Math.min(x.YQ,1);if(w>z||B.jr)f.c_(P,x,B.n,O),D.copy(O,x.LN),B.jr=!1}B=a;x=U;O=v;z=O.XM;for(P=z.length;P--;)w=z[P],w.Tn(m,w.df,S,x);if(O.Wr&&!O.iw){O.ds.length||r(O);z=O.ds;for(P=z.length;P--;)w=z[P],w.Tn(m,w.df,S,x);O.Wr=!1}m.depthMask(x.Va);x.Zb?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE);P=x.ya;w=m;for(z=0;z<P.length;z++){var I=P[z];w.activeTexture(w.TEXTURE0+z);w.bindTexture(I.nb,I.sb)}if(B.type==c.Dg){S=B;O=O.Ym;P=S.p.wc.sb;w=S.Ll;
for(z=0;6>z;z++)if(I=b(z),T.Uz?(m.bindTexture(m.TEXTURE_CUBE_MAP,P),m.texImage2D(I,0,m.RGBA,1,1,0,m.RGBA,m.UNSIGNED_BYTE,d)):(m.uniformMatrix4fv(O.u_cube_view_matrix,!1,w[z]),m.uniform4fv(O.u_sky_tex_fac,S.hx),m.uniform3fv(O.u_sky_tex_color,S.fx),m.uniform1f(O.u_sky_tex_dvar,S.gx),m.uniform3fv(O.u_horizon_color,S.ke),m.uniform3fv(O.u_zenith_color,S.te),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,I,P,0),t(x,0)),S.gw&&3!=z){var I=S,J=z,ia=F;T.Uz?ia.set(d):(m.readPixels(191,191,1,1,m.RGBA,
m.UNSIGNED_BYTE,ia),255!=ia[0]&&255!=ia[1]&&255!=ia[2]||m.readPixels(191,220,1,1,m.RGBA,m.UNSIGNED_BYTE,ia));var ta=ia[0],na=ia[1],ia=ia[2],ta=ta/255,na=na/255,ia=ia/255;2===J?(I.ye[3]=ta,I.ye[7]=na,I.ye[11]=ia):2>J?(I.ye[4*J]=ta,I.ye[4*J+1]=na,I.ye[4*J+2]=ia):(I.ye[4*(J-2)]=ta,I.ye[4*(J-2)+1]=na,I.ye[4*(J-2)+2]=ia)}B.Sq+=6}else t(x,S.Cx),B.Sq++;n.MX(U);n.EJ()&&"MAIN"==U.type&&A.WQ(U.id,U.Cf)}}}}function e(a){if(a){var b=(a.wb?m.COLOR_BUFFER_BIT:0)|(a.Bb?m.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case c.ge:a=
z;break;case c.cd:a=R;break;case c.yf:a=L;break;case c.tf:case c.ui:case c.kn:a=I;break;case c.Cg:case c.Op:case c.It:a=z;break;default:a=T.background_color}}else b=m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT,a=T.background_color;m.colorMask(!0,!0,!0,!0);m.depthMask(!0);m.clearColor(a[0],a[1],a[2],a[3]);m.clear(b)}function b(a){switch(a){case 0:return m.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return m.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return m.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return m.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return m.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return m.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function y(a){var b=l.nB(),c=a.cq,d=a.Ca,g=d.kd;a.Me.length=0;var e=1,f;for(f in g)e=Math.max(e,g[f].frames);for(g=0;g<e;g++){f=b.createVertexArray();P(f);d.hg&&m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,d.hg);for(var k=0;k<d.Md.length;k++){m.bindBuffer(m.ARRAY_BUFFER,d.Md[k].Yk);for(var q=0;q<c.length;q++){var n=c[q];n.uN==d.Md[k].type&&(m.enableVertexAttribArray(n.df),m.vertexAttribPointer(n.df,n.Jc,n.jv,n.jv==m.FLOAT?
!1:!0,n.Wm,n.WF+n.SH*g),x(n.df,n.Zq))}}P(null);a.Me.push(f)}}function r(a){var b=a.Ym,c=a.XM,d=a.ds,g=a.WM,e=a.yC;c.length=0;d.length=0;g.length=0;e.length=0;for(var f in b){var l=!1,q=null,m=null;switch(f){case "u_proj_matrix":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.xb)};l=!0;break;case "u_view_refl_matrix":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Hx)};l=!0;break;case "u_view_tsr":case "u_view_tsr_frag":q=function(a,b,c,d){d.rc?a.uniformMatrix3fv(b,!1,d.qs):a.uniformMatrix3fv(b,!1,d.qf)};
l=!0;break;case "u_view_tsr_inverse":q=function(a,b,c,d){d.rc?a.uniformMatrix3fv(b,!1,d.Hw):a.uniformMatrix3fv(b,!1,d.Ix)};l=!0;break;case "u_shadow_cast_billboard_view_tsr":q=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.Fs)};l=!0;break;case "u_view_proj_prev":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.EC)};l=!0;break;case "u_view_proj_matrix":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ld)};l=!0;break;case "u_view_proj_inverse":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Gx)};l=!0;break;case "u_sky_vp_inverse":q=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.vg)};l=!0;break;case "u_camera_eye":case "u_camera_eye_frag":q=function(a,b,c,d){a.uniform3fv(b,Q.hc(d.n,da))};l=!0;break;case "u_camera_quat":q=function(a,b,c,d){a.uniform4fv(b,Q.Xd(d.n,J))};l=!0;break;case "u_view_max_depth":q=function(a,b,c,d){a.uniform1f(b,d.far)};l=!0;break;case "u_camera_range":q=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":q=function(a,b,c,d){a.uniform4fv(b,d.zu)};break;case "u_height":q=function(a,
b,c,d){a.uniform1f(b,d.height)};l=!0;break;case "u_pcf_blur_radii":q=function(a,b,c,d){a.uniform4fv(b,d.vo)};break;case "u_dof_dist":q=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};l=!0;break;case "u_dof_front_start":q=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};l=!0;break;case "u_dof_front_end":q=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};l=!0;break;case "u_dof_rear_start":q=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};l=!0;break;case "u_dof_rear_end":q=
function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};l=!0;break;case "u_dof_bokeh_intensity":q=function(a,b,c,d){a.uniform1f(b,d.dof_bokeh_intensity)};l=!0;break;case "u_camera_direction":q=function(a,b,c,d){a.uniform3fv(b,d.direction)};l=!0;break;case "u_cam_water_depth":q=function(a,b,c){a.uniform1f(b,c.Nz)};l=!0;break;case "u_waves_height":q=function(a,b,c){a.uniform1f(b,c.mE)};break;case "u_waves_length":q=function(a,b,c){a.uniform1f(b,c.nE)};break;case "u_fog_color_density":q=function(a,b,c){a.uniform4fv(b,
c.Be)};break;case "u_fog_params":q=function(a,b,c){a.uniform4fv(b,c.dg)};break;case "u_underwater_fog_color_density":q=function(a,b,c){a.uniform4fv(b,c.ri)};break;case "u_bloom_key":q=function(a,b,c){a.uniform1f(b,c.eu)};break;case "u_bloom_edge_lum":q=function(a,b,c){a.uniform1f(b,c.du)};break;case "u_time":q=function(a,b,c){a.uniform1f(b,c.time)};l=!0;break;case "u_wind":q=function(a,b,c){a.uniform3fv(b,c.zj)};l=!0;break;case "u_sky_tex_dvar":q=function(a,b,c){a.uniform1f(b,c.gx)};break;case "u_sky_tex_fac":q=
function(a,b,c){a.uniform4fv(b,c.hx)};break;case "u_sky_tex_color":q=function(a,b,c){a.uniform3fv(b,c.fx)};break;case "u_horizon_color":q=function(a,b,c){a.uniform3fv(b,c.ke)};break;case "u_zenith_color":q=function(a,b,c){a.uniform3fv(b,c.te)};break;case "u_environment_energy":q=function(a,b,c){a.uniform1f(b,c.Sg)};break;case "u_sky_color":q=function(a,b,c){a.uniform3fv(b,c.No)};break;case "u_rayleigh_brightness":q=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":q=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":q=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":q=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":q=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":q=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":q=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":q=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":q=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":q=function(a,b,c){a.uniform4fv(b,c.Qr)};break;case "u_light_directions":q=function(a,b,c){a.uniform3fv(b,c.OB)};break;case "u_light_color_intensities":q=function(a,b,c){a.uniform4fv(b,c.Pr)};break;case "u_sun_quaternion":q=function(a,b,c){a.uniform4fv(b,c.BM)};break;case "u_sun_intensity":q=function(a,b,c){a.uniform3fv(b,c.AM)};
break;case "u_sun_direction":q=function(a,b,c){a.uniform3fv(b,c.ED)};break;case "u_debug_view_mode":q=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":q=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":q=function(a,b,c){a.uniform1f(b,c.vH)};break;case "u_subpixel_jitter":q=function(a,b,c){a.uniform2fv(b,c.bW)};l=!0;break;case "u_subsample_indices":q=function(a,b,c){a.uniform4fv(b,c.cW)};l=!0;break;case "u_radial_blur_step":q=
function(a,b,c){a.uniform1f(b,c.Gw)};break;case "u_god_rays_intensity":q=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":q=function(a,b,c){a.uniform1f(b,c.So)};break;case "u_ssao_blur_discard_value":q=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};l=!0;break;case "u_ssao_influence":q=function(a,b,c){a.uniform1f(b,c.Ro)};break;case "u_ssao_dist_factor":q=function(a,b,c){a.uniform1f(b,c.Qo)};break;case "u_texel_size":q=function(a,b,c){a.uniform2fv(b,
c.OD)};l=!0;break;case "u_normal_offset":q=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":q=function(a,b,c){a.uniform4fv(b,c.Bx)};l=!0;break;case "u_v_light_r":q=function(a,b,c){a.uniform4fv(b,c.Ax)};l=!0;break;case "u_v_light_tsr":q=function(a,b,c){a.uniformMatrix3fv(b,!1,c.hE)};l=!0;break;case "u_p_light_matrix0":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Gm[0])};l=!0;break;case "u_p_light_matrix1":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Gm[1])};l=!0;
break;case "u_p_light_matrix2":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Gm[2])};l=!0;break;case "u_p_light_matrix3":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Gm[3])};l=!0;break;case "u_outline_color":q=function(a,b,c){a.uniform3fv(b,c.hj)};break;case "u_draw_outline":q=function(a,b,c){a.uniform1f(b,c.KA)};l=!0;break;case "u_glow_mask_small_coeff":q=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};l=!0;break;case "u_glow_mask_large_coeff":q=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
l=!0;break;case "u_brightness":q=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":q=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":q=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":q=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":q=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":q=function(a,b,c){a.uniform4fv(b,c.Pl)};break;case "u_chromatic_aberration_coefs":q=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":q=function(a,b,c){a.uniform1f(b,c.fK)};l=!0;break;case "u_motion_blur_decay_threshold":q=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};l=!0;break;case "u_model_tsr":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};l=!0;break;case "u_model_tsr_inverse":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Qx)};l=!0;break;case "u_transb":m=function(a,b,c){a.uniform4fv(b,c.se)};l=!0;break;case "u_transa":m=function(a,b,c){a.uniform4fv(b,
c.Je)};l=!0;break;case "u_arm_rel_trans":m=function(a,b,c){a.uniform4fv(b,c.$p)};l=!0;break;case "u_arm_rel_quat":m=function(a,b,c){a.uniform4fv(b,c.Zp)};l=!0;break;case "u_quat":m=function(a,b,c){a.uniform4fv(b,Q.Xd(c.n,J))};l=!0;break;case "u_quatsb":m=function(a,b,c){a.uniform4fv(b,c.ne)};l=!0;break;case "u_quatsa":m=function(a,b,c){a.uniform4fv(b,c.Ge)};l=!0;break;case "u_frame_factor":m=function(a,b,c){a.uniform1f(b,c.Ye)};l=!0;break;case "au_center_pos":m=function(a,b,c){a.uniform3fv(b,c.rq)};
l=!0;break;case "au_wind_bending_amp":m=function(a,b,c){a.uniform1f(b,c.th)};l=!0;break;case "au_wind_bending_freq":m=function(a,b,c){a.uniform1f(b,c.uh)};l=!0;break;case "au_detail_bending_freq":m=function(a,b,c){a.uniform1f(b,c.Pg)};l=!0;break;case "au_detail_bending_amp":m=function(a,b,c){a.uniform1f(b,c.Og)};l=!0;break;case "au_branch_bending_amp":m=function(a,b,c){a.uniform1f(b,c.Jg)};l=!0;break;case "u_node_values":m=function(a,b,c,d){a.uniform1fv(b,d.ej)};l=!0;break;case "u_node_rgbs":m=function(a,
b,c,d){a.uniform3fv(b,d.Ee)};l=!0;break;case "u_diffuse_color":m=function(a,b,c,d){a.uniform4fv(b,d.$f)};l=!0;break;case "u_diffuse_intensity":m=function(a,b,c,d){a.uniform1f(b,d.Ol)};l=!0;break;case "u_diffuse_params":m=function(a,b,c,d){a.uniform2fv(b,d.Td)};l=!0;break;case "u_emit":m=function(a,b,c,d){a.uniform1f(b,d.Vj)};l=!0;break;case "u_ambient":m=function(a,b,c,d){a.uniform1f(b,d.Ej)};l=!0;break;case "u_specular_color":m=function(a,b,c,d){a.uniform3fv(b,d.Tm)};l=!0;break;case "u_specular_alpha":m=
function(a,b,c,d){a.uniform1f(b,d.Js)};l=!0;break;case "u_specular_params":m=function(a,b,c,d){a.uniform3fv(b,d.Nk)};l=!0;break;case "u_reflect_factor":m=function(a,b,c,d){a.uniform1f(b,d.zo)};l=!0;break;case "u_mirror_factor":m=function(a,b,c,d){a.uniform1f(b,d.Ur)};l=!0;break;case "u_grass_map_dim":m=function(a,b,c,d){a.uniform3fv(b,d.je)};l=!0;break;case "u_grass_size":m=function(a,b,c,d){a.uniform1f(b,d.yr)};l=!0;break;case "u_scale_threshold":m=function(a,b,c,d){a.uniform1f(b,d.lv)};l=!0;break;
case "u_cube_fog":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ye)};break;case "u_jitter_amp":m=function(a,b,c,d){a.uniform1f(b,d.Ov)};l=!0;break;case "u_jitter_freq":m=function(a,b,c,d){a.uniform1f(b,d.Pv)};l=!0;break;case "u_wireframe_edge_color":m=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":m=function(a,b,c,d){a.uniform1f(b,d.zq)};l=!0;break;case "u_batch_debug_id_color":m=function(a,b,c,d){a.uniform1f(b,d.Cu)};l=!0;break;case "u_batch_debug_main_render_time":m=
function(a,b,c,d){a.uniform1f(b,d.Rq)};l=!0;break;case "u_refr_bump":m=function(a,b,c,d){a.uniform1f(b,d.Iw)};l=!0;break;case "u_line_width":m=function(a,b,c,d){a.uniform1f(b,d.Rv)};l=!0;break;case "u_lamp_light_positions":m=function(a,b,c,d){a.uniform3fv(b,d.io)};break;case "u_lamp_light_directions":m=function(a,b,c,d){a.uniform3fv(b,d.Nr)};break;case "u_lamp_light_color_intensities":m=function(a,b,c,d){a.uniform3fv(b,d.Mr)};break;case "u_halo_size":m=function(a,b,c,d){a.uniform1f(b,d.uv)};l=!0;
break;case "u_halo_hardness":m=function(a,b,c,d){a.uniform1f(b,d.rv)};l=!0;break;case "u_halo_rings_color":m=function(a,b,c,d){a.uniform3fv(b,d.tv)};l=!0;break;case "u_halo_lines_color":m=function(a,b,c,d){a.uniform3fv(b,d.sv)};l=!0;break;case "u_halo_stars_blend":m=function(a,b,c,d){a.uniform1f(b,d.vv)};l=!0;break;case "u_halo_stars_height":m=function(a,b,c,d){a.uniform1f(b,d.wv)};l=!0;break;case "u_fresnel_params":m=function(a,b,c,d){a.uniform4fv(b,d.Pi)};l=!0;break;case "u_texture_scale":m=function(a,
b,c,d){a.uniform3fv(b,d.li)};l=!0;break;case "u_parallax_scale":m=function(a,b,c,d){a.uniform1f(b,d.so)};l=!0;break;case "u_color_id":m=function(a,b,c){a.uniform3fv(b,c.Nj)};l=!0;break;case "u_line_points":m=function(a,b,c,d){a.uniform3fv(b,d.T6)};l=!0;break;case "u_diffuse_color_factor":m=function(a,b,c,d){a.uniform1f(b,d.Nl)};l=!0;break;case "u_alpha_factor":m=function(a,b,c,d){a.uniform1f(b,d.pl)};l=!0;break;case "u_specular_color_factor":m=function(a,b,c,d){a.uniform1f(b,d.Po)};l=!0;break;case "u_normal_factor":m=
function(a,b,c,d){a.uniform1f(b,d.kw)};l=!0;break;case "u_normalmap0_scale":m=function(a,b,c,d){a.uniform2fv(b,d.fj[0])};l=!0;break;case "u_normalmap1_scale":m=function(a,b,c,d){a.uniform2fv(b,d.fj[1])};l=!0;break;case "u_normalmap2_scale":m=function(a,b,c,d){a.uniform2fv(b,d.fj[2])};l=!0;break;case "u_normalmap3_scale":m=function(a,b,c,d){a.uniform2fv(b,d.fj[3])};l=!0;break;case "u_foam_factor":m=function(a,b,c,d){a.uniform1f(b,d.Rn)};l=!0;break;case "u_foam_uv_freq":m=function(a,b,c,d){a.uniform2fv(b,
d.Tu)};l=!0;break;case "u_foam_mag":m=function(a,b,c,d){a.uniform2fv(b,d.Su)};l=!0;break;case "u_foam_scale":m=function(a,b,c,d){a.uniform2fv(b,d.gr)};l=!0;break;case "u_water_norm_uv_velocity":m=function(a,b,c,d){a.uniform1f(b,d.np)};l=!0;break;case "u_shallow_water_col":m=function(a,b,c,d){a.uniform3fv(b,d.Go)};l=!0;break;case "u_shore_water_col":m=function(a,b,c,d){a.uniform3fv(b,d.Io)};l=!0;break;case "u_water_shallow_col_fac":m=function(a,b,c,d){a.uniform1f(b,d.Ho)};l=!0;break;case "u_water_shore_col_fac":m=
function(a,b,c,d){a.uniform1f(b,d.Jo)};l=!0;break;case "u_p_length":m=function(a,b,c,d){a.uniform1f(b,d.hb.OM)};l=!0;break;case "u_p_cyclic":m=function(a,b,c,d){a.uniform1i(b,d.hb.ze)};l=!0;break;case "u_p_max_lifetime":m=function(a,b,c,d){a.uniform1f(b,d.hb.UJ)};l=!0;break;case "u_p_fade_in":m=function(a,b,c,d){a.uniform1f(b,d.hb.Ul)};l=!0;break;case "u_p_fade_out":m=function(a,b,c,d){a.uniform1f(b,d.hb.Ff)};l=!0;break;case "u_p_size":m=function(a,b,c,d){a.uniform1f(b,d.hb.size)};l=!0;break;case "u_p_alpha_start":m=
function(a,b,c,d){a.uniform1f(b,d.hb.GF)};l=!0;break;case "u_p_alpha_end":m=function(a,b,c,d){a.uniform1f(b,d.hb.FF)};l=!0;break;case "u_p_nfactor":m=function(a,b,c,d){a.uniform1f(b,d.hb.mC)};l=!0;break;case "u_p_gravity":m=function(a,b,c,d){a.uniform1f(b,d.hb.iJ)};l=!0;break;case "u_p_mass":m=function(a,b,c,d){a.uniform1f(b,d.hb.Zh)};l=!0;break;case "u_p_color_ramp":m=function(a,b,c,d){a.uniform4fv(b,d.hb.RG)};l=!0;break;case "u_p_wind_fac":m=function(a,b,c,d){a.uniform1f(b,d.hb.GN)};l=!0;break;
case "u_p_time":m=function(a,b,c,d){a.uniform1f(b,d.hb.time)};l=!0;break;case "u_p_tilt":m=function(a,b,c,d){a.uniform1f(b,d.hb.MM)};l=!0;break;case "u_p_tilt_rand":m=function(a,b,c,d){a.uniform1f(b,d.hb.NM)};l=!0;break;case "u_position":m=function(a,b,c,d){a.uniform3fv(b,d.ql)};l=!0;break;case "u_va_frame_factor":m=function(a,b,c){a.uniform1f(b,c.Dx)};l=!0;break;case "u_refl_plane":m=function(a,b,c){a.uniform4fv(b,c.rc)};l=!0;break;case "u_outline_intensity":m=function(a,b,c){a.uniform1f(b,c.ih)};
l=!0;break;case "u_obj_info":m=function(a,b,c,d){a.uniform3fv(b,d.qo)},l=!0}m&&(m={name:f,Tn:m,df:b[f]},l?c.push(m):d.push(m));q&&(m={name:f,Tn:q,df:b[f]},l?g.push(m):e.push(m))}if(d.length||e.length){a=a.zC;for(var k in a)delete a[k];for(k=0;k<d.length;k++)m=d[k],a[m.name]=m;for(k=0;k<e.length;k++)m=e[k],a[m.name]=m}else a.iw=!0}var A=h("__batch"),k=h("__camera"),w=h("__config"),n=h("__debug"),l=h("__extensions"),f=h("__geometry"),v=h("__quat"),c=h("__subscene"),B=h("__textures"),Q=h("__tsr"),K=
h("__util"),G=h("__version"),f=h("__geometry"),D=h("__vec3"),R=[1,1,1,1],L=[1,1,1,1],I=[0,0,0,1],z=[0,0,0,0],d=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var m=null,O=null,x=null,g=null,P=null,t=null,da=new Float32Array(3),J=v.create(),F=new Uint8Array(4),T=w.B;a.Nf=function(a){var b=T.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);m=a};a.Mn=function(a){if(a.cc)if(a.type==c.sn){n.QC(a);var d=a.p;m.bindFramebuffer(m.READ_FRAMEBUFFER,d.kr);m.bindFramebuffer(m.DRAW_FRAMEBUFFER,d.Ze);var g=0;d.wc&&(g|=m.COLOR_BUFFER_BIT);d.Ve&&(g|=m.DEPTH_BUFFER_BIT);m.blitFramebuffer(0,0,d.width,d.height,0,0,d.width,d.height,g,m.NEAREST);n.RC(a);n.Qz("draw resolve")}else if(a.type==c.ay)n.QC(a),d=a.p,m.bindFramebuffer(m.FRAMEBUFFER,
d.kr),m.bindTexture(m.TEXTURE_2D,d.wc.sb),m.copyTexSubImage2D(m.TEXTURE_2D,0,0,0,0,0,d.width,d.height,0),n.RC(a),n.Qz("draw copy");else{n.QC(a);d=a.p;m.bindFramebuffer(m.FRAMEBUFFER,d.Ze);a.vz&&(g=d.wc,m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,g.nb,g.sb,0));m.viewport(0,0,d.width,d.height);a.type!=c.md&&a.type!=c.Oe&&e(a);a.Lb?m.enable(m.BLEND):m.disable(m.BLEND);a.Sd?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST);switch(a.type){case c.cd:m.enable(m.POLYGON_OFFSET_FILL);m.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);m.cullFace(m.BACK);break;case c.Nd:case c.xf:m.disable(m.POLYGON_OFFSET_FILL);m.cullFace(m.FRONT);break;case c.wf:m.enable(m.POLYGON_OFFSET_FILL);m.polygonOffset(-4,-4);m.cullFace(m.BACK);break;case c.ge:if(1<T.Fc||T.jL){m.enable(m.POLYGON_OFFSET_FILL);m.polygonOffset(-2,-2);break}default:m.disable(m.POLYGON_OFFSET_FILL),m.cullFace(m.BACK)}if(a.type==c.md||a.type==c.Oe)for(var d=a.p,g=d.wc.sb,f=0;6>f;f++){var l=b(f);d.Ob=a.Ll[f];Q.Qi(d.Ob,d.qf);k.Jz(d);m.framebufferTexture2D(m.FRAMEBUFFER,
m.COLOR_ATTACHMENT0,l,g,0);e(a);for(var l=a.Ra,t=0;t<l.length;t++)for(var h=0;h<l[t].sa.length;h++){var r=l[t].sa[h];r.cc=r.JA[f]}p(a)}else p(a);n.RC(a);n.Qz("draw subscene: "+c.DD(a))}};a.clear=function(a){m.bindFramebuffer(m.FRAMEBUFFER,a.p.Ze);e(a)};a.MQ=function(a){var b=a.cq;b.length=0;var c=a.Ca,d=c.kd,g=a.zb.attributes,e;for(e in g){var l=d[e],m=f.xr(e),q=f.fV(e),k=f.$I(e);b.push({uN:m,jv:q,df:g[e],WF:l.offset*k,SH:1<l.frames?l.length*k:0,Jc:l.Jc,Wm:l.Wm*k,Zq:l.Zq})}if("DEBUG"==G.type())for(e in d)m=
f.xr(e),b=f.bY(c.Md,m),b=c.Md[b],l=a.ib.yg+" | "+a.ib.Xe,m=d[e].length*d[e].frames*f.$I(e),n.hU(b.vT,l,e,m,e in g);T.nz&&y(a)};a.RQ=y;a.aS=function(a){for(var b=l.nB(),c=0;c<a.Me.length;c++)b.deleteVertexArray(a.Me[c]);a.Me.length=0};a.cS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.QQ=r;a.SF=function(a){var b=a.zb,c=a.ya;a=a.Ld;m.useProgram(b.di);for(var d=0;d<c.length;d++)m.uniform1i(b.Ym[a[d]],d)};a.LC=function(a,b,c,d,g,e){d||(d=1);g||(g=1);e||(e=new Uint8Array(4*d*g));
e.length!=4*d*g&&K.q("read_pixels(): Wrong storage");m.bindFramebuffer(m.FRAMEBUFFER,a);m.readPixels(b,c,d,g,m.RGBA,m.UNSIGNED_BYTE,e);m.bindFramebuffer(m.FRAMEBUFFER,null);return e};a.ZZ=function(a){var b=a.zb;b.iw||(m.useProgram(b.di),b.ds.length||r(b),b=b.zC.u_cube_fog,b.Tn(m,b.df,null,a))};a.KX=function(a,b){var c=m.createFramebuffer();m.bindFramebuffer(m.FRAMEBUFFER,c);if(B.eo(a)){var d=a.Ne;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.RENDERBUFFER,d)}else if(B.fo(a)){var g=
a,d=g.sb,g=g.nb==m.TEXTURE_CUBE_MAP?m.TEXTURE_CUBE_MAP_NEGATIVE_Z:g.nb;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,g,d,0)}B.eo(b)?(d=b.Ne,m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,d)):B.fo(b)&&(g=b,d=g.sb,g=g.nb,m.framebufferTexture2D(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,g,d,0));n.GR();m.bindFramebuffer(m.FRAMEBUFFER,null);return c};a.JX=function(a,b,c,d,g){null==a?(m.bindFramebuffer(m.FRAMEBUFFER,a),m.viewport(0,0,d,g),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT)):
(B.eo(b)?m.deleteRenderbuffer(b.Ne):B.fo(b)&&m.deleteTexture(b.sb),B.eo(c)?m.deleteRenderbuffer(c.Ne):B.fo(c)&&m.deleteTexture(c.sb),m.deleteFramebuffer(a))};a.z6=function(){};a.HT=function(a,b,c,d,g,e){a=a.sb;m.viewport(0,0,c,c);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,b,a,0);b=A.pA("FLIP_CUBEMAP_COORDS");a=b.zb;m.activeTexture(m.TEXTURE0);m.bindTexture(m.TEXTURE_2D,g);var f=g=0;c!=d&&(g=1/(6*d),f=1/(4*d));m.uniform1i(a.Ym.u_tex_number,e);m.uniform2fv(a.Ym.u_delta,[g,f]);m.useProgram(a.di);
t(b,0);m.bindTexture(m.TEXTURE_2D,null)};a.IT=function(a,b,c,d,g){m.bindFramebuffer(m.FRAMEBUFFER,d);d=a.sb;a=a.nb;m.bindTexture(a,d);m.viewport(0,0,b,c);m.texImage2D(a,0,m.RGBA,b,c,0,m.RGBA,m.UNSIGNED_BYTE,null);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,a,d,0);b=A.pA("NONE");c=b.zb;m.activeTexture(m.TEXTURE0);m.bindTexture(a,g);m.useProgram(c.di);t(b,0);m.bindFramebuffer(m.FRAMEBUFFER,null);m.bindTexture(a,null)};a.ua=function(){};a.nY=function(){var a=l.iV(),b=l.nB();T.EF=a?!0:!1;
T.nz=b?!0:!1;a?(O=function(b,c,d,g){a.drawElementsInstanced(m.TRIANGLES,b,c,d,g)},x=function(b,c){a.vertexAttribDivisor(b,c)},g=function(b,c,d){a.drawArraysInstanced(m.TRIANGLES,b,c,d)}):(O=function(a,b,c){m.drawElements(m.TRIANGLES,a,b,c)},x=function(){},g=function(a,b){m.drawArrays(m.TRIANGLES,a,b)});b?(P=function(a){b.bindVertexArray(a)},t=function(a,b){var c=a.Ca;P(a.Me[b]);c.hg?O(c.count,c.jm,0,c.nm):g(0,c.count,c.nm);P(null)}):t=function(a,b){for(var c=a.Ca,d=a.cq,e=0;e<c.Md.length;e++){m.bindBuffer(m.ARRAY_BUFFER,
c.Md[e].Yk);for(var f=0;f<d.length;f++){var l=d[f];l.uN==c.Md[e].type&&(m.enableVertexAttribArray(l.df),m.vertexAttribPointer(l.df,l.Jc,l.jv,l.jv==m.FLOAT?!1:!0,l.Wm,l.WF+l.SH*b),x(l.df,l.Zq))}}c.hg?(m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c.hg),O(c.count,c.jm,0,c.nm)):g(0,c.count,c.nm);for(e=0;e<d.length;e++)l=d[e],m.disableVertexAttribArray(l.df)}};a.reset=function(){P=g=x=O=m=null}};b4w.module.__camera=function(a,h){function p(a,b,c,d,g){na.Wc(a,b);c&&D(a,b,c);I(a,d);z(a,g)}function e(a,b,c,d,e,f,l,q){var m=a.k;na.Wc(a,b);m.pivot.set(c);D(a,b,c);I(a,d);z(a,e);x(a,f);g(a,l);m.use_panning=q}function b(a,b,c,g,e,f,l,q){var m=a.k;na.Wc(a,b);m.Vb.set(c);D(a,b,c);O(a,g);d(a,e);P(a,f);t(a,l);m.Nh=q}function y(a,b,c){var d=a.k,g=M.G(d.n),e=M.P(d.n),d=Ba;d.set(ea.nc);d[3]=0;a=v(a,ja)[1];e=ea.lc(e,ea.Nc,ka);oa.JL(Ra,g);oa.iD(Ra,e);if(!ea.PB(d,-b,Ra,c)||Math.abs(a)<ua)wa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
c[0]=g[0],c[1]=0,c[2]=g[2];return c}function r(b){for(var c=b.k,d=0;d<b.I.length;d++){var g=b.I[d].da[0];if(g.type==a.we)switch(c.vb){case a.Kb:var e=M.G(c.n);c.ck=C.dist(e,c.pivot);c.dk=g.top;break;case a.bd:e=M.G(c.n),c.ck=C.dist(e,c.Vb),c.dk=g.top}}}function A(a){a={type:a,name:"",cM:1,width:0,height:0,Ze:null,kr:null,wc:null,Ve:null,Ab:0,Vd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,jd:za.create(),n:new Float32Array(9),Ob:new Float32Array(16),Hx:new Float32Array(16),xb:new Float32Array(16),
ld:new Float32Array(16),Gx:new Float32Array(16),EC:new Float32Array(16),vg:new Float32Array(16),direction:new Float32Array(3),qf:M.Hl(),Ix:M.Hl(),qs:M.Hl(),Hw:M.Hl(),Fs:M.Hl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,EH:!1,Cd:!1,dof_on:!1,Uv:new Float32Array(3),Ph:w(),Ok:0,mf:0,rc:null,Lh:null,Oq:null,zu:new Float32Array(4),vo:new Float32Array(4)};a.jd[0]=a.jd[2]=45;a.jd[1]=a.jd[3]=55;return a}function k(a,b){var c=
A(a.type);c.name=a.name;c.cM=a.cM;c.width=a.width;c.height=a.height;b||(c.Ze=a.Ze,c.kr=a.kr,c.wc=a.wc,c.Ve=a.Ve);c.Ab=a.Ab;c.Vd=a.Vd;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;za.copy(a.jd,c.jd);M.copy(a.n,c.n);aa.copy(a.Ob,c.Ob);aa.copy(a.xb,c.xb);aa.copy(a.ld,c.ld);aa.copy(a.Gx,c.Gx);aa.copy(a.EC,c.EC);aa.copy(a.vg,c.vg);M.copy(a.qf,c.qf);M.copy(a.Ix,c.Ix);M.copy(a.qs,c.qs);M.copy(a.Hw,c.Hw);M.copy(a.Fs,c.Fs);c.dof_distance=a.dof_distance;c.dof_front_start=
a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.EH=a.EH;c.Cd=a.Cd;c.dof_on=a.dof_on;C.copy(a.Uv,c.Uv);var d=a.Ph,g=c.Ph;za.copy(d.left,g.left);za.copy(d.right,g.right);za.copy(d.top,g.top);za.copy(d.bottom,g.bottom);za.copy(d.near,g.near);za.copy(d.far,g.far);c.Ok=a.Ok;c.mf=a.mf;a.rc&&(c.rc=za.clone(a.rc));if(a.Lh){d=a.Lh.length;c.Lh=Array(d);
for(g=0;g<d;g++)c.Lh[g]=C.clone(a.Lh[g]);c.Oq=new Float32Array(a.Oq)}za.copy(a.zu,c.zu);za.copy(a.vo,c.vo);return c}function w(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function n(b){switch(b){case "STATIC":return a.Bg;case "TARGET":return a.Kb;case "EYE":return a.nd;case "HOVER":return a.bd;default:ea.q("Unknown move style")}}function l(b){var c=
A(b);if(b==a.pd)return c;switch(b){case a.Od:B(c,40,.1,1E3);break;case a.we:B(c,2.5,.1,1E3);break;case a.Ch:break;case a.Bh:break;case a.yi:break;case a.Qc:case a.dd:case a.Pe:case a.Qe:ea.q("Stereo camera may only be created from perspective one");break;default:ea.q("Unknown camera type")}return c}function f(b,c,d){b.type!=a.Qc&&b.type!=a.dd&&b.type!=a.Pe&&b.type!=a.Qe&&ea.q("set_stereo_params(): wrong camera type");if(b.type==a.Qc||b.type==a.dd)b.Ok=c;b.mf=d;ga(b,b.Ab);if(ia.Da()&&(c=ia.A(),b=c.s.ud))for(c=
ya.ka(ia.dm(c),c).da,d=0;d<c.length;d++)ha(c[d],b)}function v(a,b){return c(M.P(a.k.n),b)}function c(a,b){var c=ea.lc(a,ea.nc,ka),d=ea.lc(a,ea.wh,Pa),g=-Math.asin(c[2]/C.length(c)),c=Math.abs(g)>Math.PI/4?C.scale(d,-ea.sign(g),Ea):C.scale(c,-ea.sign(d[2]),Ea),e=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(g=ea.sign(g)*Math.PI-g);d=e;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=g;return b}function B(b,c,d,g,e){switch(b.type){case a.Od:case a.Qc:case a.dd:b.Vd=c;b.Ab=1;break;case a.we:b.top=
c;b.Ab=1;break;case a.Ch:b.Vd=c;b.Ab=e/c;break;case a.Bh:b.top=c;b.Ab=e/c;break;case a.Pe:case a.Qe:break;default:wa.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=g}function Q(b,c){var d=M.hc(c.k.n,ka),g=M.Xd(c.k.n,Ca),e=aa.fromRotationTranslation(g,d,Ma);aa.invert(e,b.Ob);if(ia.Da())var e=ia.A(),f=ia.La(e,ta.xi);if(b.type==a.Qc||f&&f.enable_hmd_stereo&&b.type==a.Pe)b.Ob[12]+=b.mf/2;else if(b.type==a.dd||f&&f.enable_hmd_stereo&&b.type==a.Qe)b.Ob[12]-=b.mf/2;if(b.rc){M.Qi(b.Ob,
b.qs);M.invert(b.qs,b.Hw);var e=b.rc[0],f=b.rc[1],l=b.rc[2],q=b.rc[3],m=b.Hx;m[0]=1-2*e*e;m[1]=-2*e*f;m[2]=-2*e*l;m[3]=0;m[4]=-2*e*f;m[5]=1-2*f*f;m[6]=-2*f*l;m[7]=0;m[8]=-2*e*l;m[9]=-2*f*l;m[10]=1-2*l*l;m[11]=0;m[12]=-2*e*q;m[13]=-2*f*q;m[14]=-2*l*q;m[15]=1;aa.multiply(b.Ob,b.Hx,b.Ob);ga(b,b.Ab,!0);e=Ba;f=Ma;aa.invert(b.Ob,f);aa.transpose(f,f);za.transformMat4(b.rc,f,e);f=va;f[0]=(ea.sign(e[0])+b.xb[8])/b.xb[0];f[1]=(ea.sign(e[1])+b.xb[9])/b.xb[5];f[2]=-1;f[3]=(1+b.xb[10])/b.xb[14];za.scale(e,2/(e[0]*
f[0]+e[1]*f[1]+e[2]*f[2]+e[3]*f[3]),e);b.xb[2]=e[0];b.xb[6]=e[1];b.xb[10]=e[2]+1;b.xb[14]=e[3];C.transformMat4(d,b.Hx,d)}M.Qi(b.Ob,b.qf);M.invert(b.qf,b.Ix);E(b);Z(b);M.hi(d,1,g,b.n)}function K(b,c,d,g){aa.lookAt(c,d,g,b.Ob);d=ia.A();d=ia.La(d,ta.xi);ia.Da()&&(d=ia.A(),d=ia.La(d,ta.xi));if(b.type==a.Qc||d&&d.enable_hmd_stereo&&b.type==a.Pe)b.Ob[12]+=b.mf/2;else if(b.type==a.dd||d&&d.enable_hmd_stereo&&b.type==a.Qe)b.Ob[12]-=b.mf/2;M.Qi(b.Ob,b.qf);E(b);Z(b);M.kf(c,b.n)}function G(a,b,c){c=C.subtract(c,
b,ka);C.length(c)&&(C.normalize(c,c),c=ea.YC(ea.Nc,c,Ca),na.gi(a,c));na.Wc(a,b)}function D(a,b,c){var d=a.k,g=0>ea.lc(M.P(a.k.n),ea.xh,ka)[2];G(a,b,c);g?(b=C.copy(d.pf,ka),C.negate(b,b),sa.Qj(a,b,!0)):sa.Qj(a,d.pf,!0)}function R(a,b){for(var c=a.k,d=b.da,g=M.Xd(c.n,Ca),g=ea.lc(g,ea.Nc,ka),e=M.hc(c.n,Pa),f=b.$L,l=0;l<f.length;l++){var q=f[l];C.copy(g,q.direction);M.hc(c.n,q.Uv)}for(l=0;l<d.length;l++)q=d[l],Q(q,a),C.copy(g,q.direction),ea.On(q.ld,q.Ph),q.dof_object&&q.dof_on&&(c=na.ie(q.dof_object,
Ea),c=C.dist(e,c),q.dof_distance=c)}function L(b){var c=b.k;c.vb==a.Kb&&(c.Rk=0>ea.lc(M.P(b.k.n),ea.xh,ka)[2])}function I(b,c){var d=b.k;if(c){d.mb=d.mb||{};d.mb.left=c.left;d.mb.right=c.right;d.mb.jo=c.left;d.mb.Do=c.right;d.mb.camera_space=Boolean(c.camera_space);var g=b.k;!(d=g.mb)||g.vb!=a.nd&&g.vb!=a.Kb||(g=v(b,ja),d.camera_space?(d.left+=g[0],d.right+=g[0]):(d.jo-=g[0],d.Do-=g[0]),d.left=ea.zi(d.left),d.right=ea.zi(d.right),d.jo=ea.zi(d.jo),d.Do=ea.zi(d.Do))}else d.mb=null}function z(a,b){var c=
a.k;b?(c.la=c.la||{},c.la.down=b.down,c.la.up=b.up,c.la.Ln=b.down,c.la.fp=b.up,c.la.camera_space=Boolean(b.camera_space),m(a)):c.la=null}function d(a,b){var c=a.k;if(!b){var d=v(a,ja);b={down:d[1],up:d[1]}}c.la=c.la||{};c.la.down=b.down;c.la.up=b.up;m(a);c.tb&&c.la&&u(a)}function m(b){var c=b.k,d=c.la;if(d)switch(c.vb){case a.nd:case a.Kb:b=v(b,ja);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.fp-=b[1],d.Ln-=b[1]);d.up=ea.Fg(d.up,-Math.PI,Math.PI);d.down=ea.Fg(d.down,-Math.PI,Math.PI);d.fp=ea.Fg(d.fp,
-Math.PI,Math.PI);d.Ln=ea.Fg(d.Ln,-Math.PI,Math.PI);break;case a.bd:d.up=ea.Fg(d.up,-Math.PI,Math.PI),d.down=ea.Fg(d.down,-Math.PI,Math.PI),d.up=ea.U(d.up,-Math.PI/2,0),d.down=ea.U(d.down,-Math.PI/2,0)}}function O(a,b){var c=a.k;if(!b){var d=na.ro(a,c.Vb);b={min:d,max:d}}c.tb=c.tb||{};c.tb.min=b.min;c.tb.max=b.max;c.tb&&c.la&&u(a)}function x(a,b){var c=a.k;b?(c.tb=c.tb||{},c.tb.min=b.min,c.tb.max=b.max):c.tb=null}function g(a,b){var c=a.k;b?(c.ce=c.ce||{},c.ce.min_z=b.min_z,c.ce.max_z=b.max_z):c.ce=
null}function P(a,b){var c=a.k;b?(c.Bc=c.Bc||{},c.Bc.min=b.min,c.Bc.max=b.max):c.Bc=null}function t(a,b){var c=a.k;b?(c.Cc=c.Cc||{},c.Cc.min=b.min,c.Cc.max=b.max):c.Cc=null}function da(b){var c=b.k;if(ya.xa(b))for(var d=b.I,g=0;g<d.length;g++){var e=d[g].da;if(e[0].type===a.we){switch(c.vb){case a.Kb:var f=M.G(c.n),f=C.dist(f,c.pivot),f=f/c.ck*c.dk;break;case a.bd:f=M.G(c.n);f=C.distance(f,c.Vb);f=f/c.ck*c.dk;break;default:f=e[0].top}for(var l=0;l<e.length;l++){var q=e[l];q.top=f;ga(q,q.Ab)}R(b,d[g])}}}
function J(b){var c=b.k,d=c.vb;if(d===a.Kb||d===a.nd){if(c.mb){var g=c.mb.left,e=c.mb.right,f=v(b,ja);(f=d==a.Kb?ea.Bl(f[0],g,e):ea.Bl(f[0],e,g))&&(d==a.Kb?T(b,f,0):F(b,f,0))}c.la&&(g=c.la.down,e=c.la.up,f=v(b,ja),(f=d==a.Kb?ea.Bl(f[1],e,g):ea.Bl(f[1],g,e))&&(d==a.Kb?T(b,0,f):F(b,0,f)));if(d===a.Kb&&c.tb){var f=b.k,g=M.G(f.n),e=C.subtract(g,f.pivot,ka),l=C.length(e);l>f.tb.max?(C.scale(e,f.tb.max/l,e),C.add(f.pivot,e,g)):l<f.tb.min&&(l=ea.lc(M.P(f.n),ea.Nc,Pa),C.scale(l,100*f.tb.min,l),C.add(e,l,
e),C.scale(e,-f.tb.min/C.length(e),e),C.add(f.pivot,e,g))}}d===a.Kb&&c.ce&&(c=b.k,f=c.pivot[2],g=ea.U(c.pivot[2],c.ce.min_z,c.ce.max_z),g!=f&&(f=C.set(0,0,g-f,ka),C.add(c.pivot,f,c.pivot),c=M.G(c.n),C.add(c,f,c)));d===a.bd&&(d=b.k,d.Bc&&(f=ea.U(d.Vb[0],d.Bc.min,d.Bc.max)-d.Vb[0],d.Vb[0]+=f,c=M.G(d.n),c[0]+=f),d.Cc&&(f=ea.U(d.Vb[1],d.Cc.min,d.Cc.max)-d.Vb[1],d.Vb[1]+=f,c=M.G(d.n),c[1]+=f),d=b.k,c=v(b,ja)[1],(d=ea.Bl(c,d.la.up,d.la.down))&&N(b,0,d))}function F(a,b,c,d,g){var e=a.k,f=b,l=c;if(d||g)a=
v(a,xa),d&&(f=b-a[0]),g&&(l=c-a[1]);if(f||l)b=la.identity(Ca),f&&(f=la.setAxisAngle(e.pf,f,ma),la.multiply(b,f,b)),e=M.P(e.n),l&&(f=ea.lc(e,ea.ti,ka),l=la.setAxisAngle(f,l,ma),la.normalize(l,l),la.multiply(b,l,b)),la.multiply(b,e,e)}function T(a,b,c,d,g){var e=a.k,f=b,l=c;if(d||g){var q=v(a,xa);d&&(f=b-q[0]);g&&(l=c-q[1])}ba(a,a.k.pivot,f,l);a=v(a,xa);a=ea.Fg(a[1],-Math.PI,Math.PI);e.Rk=Math.abs(a)>Math.PI/2}function N(a,b,c,d,g){var e=a.k,f=b,l=c;if(d||g){var q=v(a,xa);d&&(f=b-q[0]);g&&(l=c-q[1])}e.Nh||
(f=0);ba(a,e.Vb,f,l);l&&u(a)}function ba(a,b,c,d){var g=a.k;if(c||d){a=la.identity(Ca);c&&(c=la.setAxisAngle(ea.nc,c,ma),la.multiply(a,c,a));c=M.P(g.n);if(d){var e=ea.lc(c,ea.ti,ka);d=la.setAxisAngle(e,d,ma);la.normalize(d,d);la.multiply(a,d,a)}d=M.G(g.n);ea.XX(d,b,a,d);la.multiply(a,c,c)}}function u(a){var b=a.k,c=v(a,ja)[1],d=a.k;a=d.la;d=d.tb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=M.G(b.n);d=ea.lc(M.P(b.n),ea.Nc,ka);C.normalize(d,d);C.scale(d,c,d);
C.subtract(b.Vb,d,a)}function ga(b,c,d){switch(b.type){case a.Od:c||ea.q("No aspect ratio"),b.Ab=c;case a.Ch:aa.perspective(ea.Cb(b.Vd),b.Ab,b.near,b.far,b.xb);break;case a.we:c||ea.q("No aspect ratio"),b.Ab=c;case a.Bh:c=b.top*b.Ab;aa.ortho(-c,c,-b.top,b.top,b.near,b.far,b.xb);break;case a.yi:aa.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb);break;case a.Qc:case a.dd:c||ea.q("No aspect ratio");b.Ab=c;var g=Math.tan(b.Vd*Math.PI/360);c=b.near*g;var e=b.Ab*b.Ok*g;b.type==a.Qc?(g=e-b.mf/2,e+=
b.mf/2):(g=e+b.mf/2,e-=b.mf/2);g=-(b.near/b.Ok*g);e*=b.near/b.Ok;aa.frustum(g,e,-c,c,b.near,b.far,b.xb);b.left=g;b.right=e;break;case a.Pe:case a.Qe:if(ia.Da())if(g=ia.A(),(g=ia.La(g,ta.xi))&&g.enable_hmd_stereo){c=Math.tan(ea.Cb(b.jd[0]));var g=Math.tan(ea.Cb(b.jd[1])),e=Math.tan(ea.Cb(b.jd[2])),f=Math.tan(ea.Cb(b.jd[3]));b.top=b.near*c;b.right=b.near*g;b.bottom=-b.near*e;b.left=-b.near*f;aa.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb)}else c||(c=b.Ab),aa.perspective(ea.Cb(b.Vd),c,b.near,
b.far,b.xb);break;case a.pd:return;default:ea.q("Wrong camera type: "+b.type)}d||(E(b),Z(b))}function Z(a){aa.copy(a.Ob,a.vg);a.vg[12]=0;a.vg[13]=0;a.vg[14]=0;a.vg[15]=1;aa.multiply(a.xb,a.vg,a.vg);aa.invert(a.vg,a.vg)}function E(a){aa.copy(a.Ob,a.ld);aa.multiply(a.xb,a.ld,a.ld);aa.invert(a.ld,a.Gx)}function ca(b,c,d,g,e){g||(g=new Float32Array(24));c||(c=b.near);d||(d=b.far);var f,l,q,m,k,u,n,C;switch(b.type){case a.pd:ea.q("Extraction from NONE camera is not possible");break;case a.Od:case a.Ch:f=
c*Math.tan(b.Vd*Math.PI/360);m=-f;l=f*b.Ab;q=-l;k=d/c*f;C=-k;u=k*b.Ab;n=-u;break;case a.we:case a.Bh:q=b.top*b.Ab;f=k=b.top;l=u=q;m=C=-b.top;q=n=-q;break;case a.yi:f=k=b.top;l=u=b.right;m=C=b.bottom;q=n=b.left;break;case a.Qc:case a.dd:k=c/b.near;f=c*Math.tan(b.Vd*Math.PI/360);m=-f;l=b.right*k;q=b.left*k;n=d/c;k=f*n;C=-k;u=l*n;n*=q;break;case a.Pe:case a.Qe:k=c/b.near;f=b.top*k;m=b.bottom*k;l=b.right*k;q=b.left*k;n=d/c;k=f*n;C=m*n;u=l*n;n*=q;break;default:ea.q("Wrong camera type: "+b.type)}g[0]=q;
g[1]=m;g[2]=-c;g[3]=l;g[4]=m;g[5]=-c;g[6]=l;g[7]=f;g[8]=-c;g[9]=q;g[10]=f;g[11]=-c;g[12]=n;g[13]=C;g[14]=-d;g[15]=n;g[16]=k;g[17]=-d;g[18]=u;g[19]=k;g[20]=-d;g[21]=u;g[22]=C;g[23]=-d;e&&(c=Ma,aa.invert(b.Ob,c),ea.xo(g,c,g,0));return g}function ha(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Lh){var d=b.csm_num;a.Lh=Array(d);for(var g=0;g<d;g++)a.Lh[g]=new Float32Array(3);a.Oq=new Float32Array(d)}for(d=0;d<c;d++){var g=0==d?a.near:q(b,a,d-1),e=q(b,a,d),g=ca(a,g,e,Ga),g=U.cV(g);a.Lh[d].set(g.F);a.Oq[d]=
g.Ya;a.zu[d]=C.length(g.F);a.vo[d]=S(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.vo[0]=b.first_cascade_blur_radius}function q(a,b,c){var d=a.csm_num,g=ea.U(a.csm_first_cascade_border,b.near,b.far);a=ea.U(a.csm_last_cascade_border,b.near,b.far);return ea.U(S(g,a,d,c),b.near,b.far)}function S(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function X(a,b){b||(b=new Float32Array(3));C.copy(M.G(a.k.n),b);return b}var U=h("__boundings");
h("__config");var sa=h("__constraints"),pa=h("__container"),aa=h("__mat4"),oa=h("__math"),ya=h("__obj_util"),wa=h("__print"),la=h("__quat"),ia=h("__scenes"),ta=h("__subscene"),na=h("__transform"),M=h("__tsr"),ea=h("__util"),C=h("__vec3"),za=h("__vec4");a.pd=10;a.Od=20;a.we=30;a.Ch=40;a.Bh=50;a.yi=60;a.Qc=70;a.dd=80;a.Pe=90;a.Qe=100;a.Bg=0;a.Kb=2;a.nd=3;a.bd=4;var ua=ea.Cb(.5),ja=new Float32Array(2),xa=new Float32Array(2),ka=new Float32Array(3),Pa=new Float32Array(3),Ea=new Float32Array(3),Ca=new Float32Array(4),
ma=new Float32Array(4),Ba=new Float32Array(4),va=new Float32Array(4),Ma=new Float32Array(16),Ga=new Float32Array(24),Ra=new Float32Array(6);a.yR=function(c,d){var g=d.k,f=c.data;switch(f.type){case "PERSP":var q=l(a.Od);if(f.angle_y)var m=ea.oe(f.angle_y);B(q,m,f.clip_start,f.clip_end);break;case "ORTHO":q=l(a.we),B(q,f.ortho_scale/2,f.clip_start,f.clip_end)}q.name=d.name;m=d.I;m[0].da.push(q);for(var u=1;u<m.length;u++){var C=k(q,!1);m[u].da.push(C)}g.vb=n(f.b4w_move_style);g.dof_distance=f.dof_distance;
q=f.dof_object;g.dof_object=q?q.pb:null;g.dof_front_start=f.b4w_dof_front_start;g.dof_front_end=f.b4w_dof_front_end;g.dof_rear_start=f.b4w_dof_rear_start;g.dof_rear_end=f.b4w_dof_rear_end;g.dof_power=f.b4w_dof_power;g.dof_bokeh=f.b4w_dof_bokeh;g.dof_bokeh_intensity=f.b4w_dof_bokeh_intensity;g.Cd=f.b4w_dof_foreground_blur;g.$k=f.b4w_trans_velocity;g.Zk=f.b4w_rot_velocity;g.al=f.b4w_zoom_velocity;q=d.k.vb;m=c.data;u=null;q!=a.Kb&&q!=a.nd||!m.b4w_use_horizontal_clamping||(u={left:m.b4w_rotation_left_limit,
right:m.b4w_rotation_right_limit,camera_space:"LOCAL"==m.b4w_horizontal_clamping_type},q==a.nd&&(u.left*=-1,u.right*=-1));q=u;m=d.k.vb;u=c.data;C=null;m!=a.Kb&&m!=a.nd||!u.b4w_use_vertical_clamping?m==a.bd&&u.b4w_use_zooming&&(u.b4w_hover_angle_min<=u.b4w_hover_angle_max?(C={down:u.b4w_hover_angle_min,up:u.b4w_hover_angle_max},C.down*=-1,C.up*=-1):wa.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(C={down:u.b4w_rotation_down_limit,up:u.b4w_rotation_up_limit,camera_space:"LOCAL"==
u.b4w_vertical_clamping_type},m==a.Kb&&(C.down*=-1,C.up*=-1));var m=C,u=d.k.vb,C=c.data,t=null;u==a.Kb&&C.b4w_use_target_distance_limits&&C.b4w_distance_min<=C.b4w_distance_max?t={min:C.b4w_distance_min,max:C.b4w_distance_max}:u===a.bd&&C.b4w_use_zooming&&(C.b4w_distance_min<=C.b4w_distance_max?t={min:C.b4w_distance_min,max:C.b4w_distance_max}:wa.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));u=t;C=c.data;t=null;d.k.vb==a.bd&&C.b4w_use_horizontal_clamping&&C.b4w_horizontal_translation_min<=
C.b4w_horizontal_translation_max&&(t={min:C.b4w_horizontal_translation_min,max:C.b4w_horizontal_translation_max});var C=t,t=c.data,h=null;d.k.vb==a.bd&&t.b4w_use_vertical_clamping&&t.b4w_vertical_translation_min<=t.b4w_vertical_translation_max&&(h={min:t.b4w_vertical_translation_min,max:t.b4w_vertical_translation_max});var t=h,h=c.data,E=null;d.k.vb==a.Kb&&h.b4w_use_pivot_limits&&(E={min_z:h.b4w_pivot_z_min,max_z:h.b4w_pivot_z_max});h=E;switch(g.vb){case a.nd:g=M.G(d.k.n);p(d,g,null,q,m);break;case a.Kb:g=
M.G(d.k.n);e(d,g,f.b4w_target,q,m,u,h,f.b4w_use_panning);break;case a.bd:g=M.G(d.k.n),q=y(d,c.data.b4w_hover_zero_level,Pa),b(d,g,q,u,m,C,t,f.b4w_enable_hover_hor_rotation)}J(d);r(d)};a.RY=p;a.WL=e;a.VL=b;a.ao=r;a.Hc=k;a.uS=w;a.d7=n;a.gd=l;a.J2=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.wc);case "DEPTH":return Boolean(a.Ve);case "SCREEN":return!Boolean(a.wc)&&!Boolean(a.Ve);default:ea.q("Wrong attachment type: "+b)}};a.Qw=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.wc=
c;break;case "DEPTH":a.Ve=c;break;case "SCREEN":a.wc=null;a.Ve=null;break;default:ea.q("Wrong attachment type: "+b)}};a.p4=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.wc;case "DEPTH":return a.Ve;case "SCREEN":return null;default:ea.q("Wrong attachment type: "+b)}};a.Xv=function(b,c){(b.type!=a.Od||c!=a.Qc&&c!=a.dd&&c!=a.Pe&&c!=a.Qe)&&ea.q("make_stereo(): wrong camera type");b.type=c;f(b,6,.065)};a.FY=f;a.em=v;a.cB=c;a.fm=function(a,b){v(a,b);b[0]=ea.zi(b[0]+Math.PI);b[1]*=-1;return b};
a.Sw=B;a.rY=function(b,c,d,g,f,e,l){switch(b.type){case a.yi:b.left=c;b.right=d;b.bottom=g;b.top=f;b.near=e;b.far=l;break;default:wa.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.hm=function(a){return a.k.vb};a.NY=Q;a.P8=K;a.pD=function(a,b,c){var d=ka;d[0]=0;d[1]=0;d[2]=-1;C.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var g=Pa;g[0]=0;g[1]=1;g[2]=0;C.transformQuat(g,c,g);K(a,b,d,g)};a.gD=G;a.yY=D;a.g_=R;a.f_=function(b){var c=b.k;J(b);da(b);switch(c.vb){case a.Kb:var d=
M.G(c.n);sa.YX(d,M.P(c.n),c.pivot);for(var g=0;g<b.I.length;g++)for(var e=b.I[g].da,l=0;l<e.length;l++){var q=e[l];q.type!=a.Qc&&q.type!=a.dd||f(q,C.dist(d,c.pivot),q.mf)}sa.Qj(b,c.pf);break;case a.nd:b.pc||sa.Qj(b,c.pf)}L(b)};a.cE=L;a.FL=I;a.RL=z;a.zv=d;a.yv=O;a.mY=x;a.CY=g;a.sY=P;a.MY=t;a.p_=da;a.us=F;a.Kw=T;a.vs=N;a.F6=function(b){switch(b.type){case a.Od:case a.we:case a.Qc:case a.dd:return!0;default:return!1}};a.fI=function(b){switch(b.type){case a.Od:case a.Ch:case a.Qc:case a.dd:return ea.Cb(b.Vd);
default:return wa.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.Ik=ga;a.gY=function(b,c,d,g,e){var f=1/Math.max(e,g);switch(b.type){case a.Od:case a.Ch:e/=2;g/=2;d=-(d-e)/e*Math.tan(ea.Cb(b.Vd)/2);c=(c-g)/g*Math.tan(ea.Cb(b.Vd)/2)*b.Ab;g=b.near*(d+f);e=b.near*(c+f);d=b.near*(d-f);c=b.near*(c-f);aa.frustum(c,e,d,g,b.near,b.far,b.xb);break;case a.we:case a.Bh:b.right=b.top*b.Ab;d=-d/e;c/=g;g=b.top+(d+f)*(b.top+b.top);e=-b.right+(c+f)*(b.right+b.right);d=b.top+(d-f)*(b.top+
b.top);c=-b.right+(c-f)*(b.right+b.right);aa.ortho(c,e,d,g,b.near,b.far,b.xb);break;case a.yi:d=-d/e,c/=g,g=b.top+(d+f)*(b.top-b.bottom),e=b.left+(c+f)*(b.right-b.left),d=b.top+(d-f)*(b.top-b.bottom),c=b.left+(c-f)*(b.right-b.left),aa.ortho(c,e,d,g,b.near,b.far,b.xb)}aa.copy(b.Ob,b.ld);aa.multiply(b.xb,b.ld,b.ld);ea.On(b.ld,b.Ph)};a.Jz=Z;a.qG=E;a.ZT=ca;a.NQ=function(a){a=a.k;var b=U.Qd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.R=b;var c=U.Gz(1,ea.Ef([0,0,0]));a.wa=c;a.dq=
U.$F(1,b);a.fq=U.bG(1,b);a.eq=U.aG(1,b)};a.tm=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.Bg};a.Aa=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.Kb};a.ic=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.nd};a.$a=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.bd};a.Lv=function(b){return ya.xa(b)&&b.k&&b.I[0].da[0].type==a.we};a.bE=ha;a.oT=q;a.FC=function(b,c,d){b=b.I[0].da[0];switch(b.type){case a.Od:case a.Ch:case a.we:case a.Bh:case a.Qc:case a.dd:case a.Pe:case a.Qe:var g=Ba;g.set(c);g[3]=1;za.transformMat4(g,
b.ld,g);c=-g[1]/g[3];d[0]=(g[0]/g[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;pa.R_(d[0],d[1],d,b);2<d.length&&(d[2]=(g[2]/Math.abs(g[3])+1)/2);return d;default:return wa.error("Non-compatible camera"),d}};a.WU=function(a){return a.I[0].da[0]};a.Vn=function(b,c){switch(b.type){case a.Od:case a.Ch:case a.Qc:case a.dd:var d=Math.tan(ea.Cb(b.Vd)/2);switch(c){case "LEFT":return-d*b.Ab;case "RIGHT":return d*b.Ab;case "TOP":return d;case "BOTTOM":return-d}break;case a.we:case a.Bh:switch(c){case "LEFT":return-b.top*
b.Ab;case "RIGHT":return b.top*b.Ab;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.yi:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Pe:case a.Qe:switch(c){case "LEFT":return-Math.tan(ea.Cb(Math.min(b.jd[1],b.jd[3])));case "RIGHT":return Math.tan(ea.Cb(Math.min(b.jd[1],b.jd[3])));case "TOP":return Math.tan(ea.Cb(Math.min(b.jd[0],b.jd[2])));case "BOTTOM":return-Math.tan(ea.Cb(Math.min(b.jd[0],b.jd[2])))}break;
default:ea.q("Unknown camera type")}};a.ZV=function(b){switch(b.type){case a.we:case a.Bh:case a.yi:return!0;default:return!1}};a.aV=function(b,c){switch(b.type){case a.Od:case a.Ch:case a.Qc:case a.dd:var d=ea.Cb(b.Vd);return c?d*b.Ab:d;default:return 0}};a.Ds=function(a,b,c){a=a.k;M.kf(b,a.n);C.copy(c,a.pivot)};a.Uw=function(a,b){var c=a.k,d=C.subtract(b,c.Vb,ka),d=C.add(d,M.G(c.n),d);na.Wc(a,d);C.copy(b,c.Vb)};a.GY=function(a,b){var c=a.k,d=C.subtract(b,c.pivot,ka),d=C.add(d,M.G(c.n),d);na.Wc(a,
d);C.copy(b,c.pivot)};a.uI=X;a.hD=function(c,d){c.k.vb=d;c.k.mb=null;c.k.la=null;c.k.tb=null;c.k.Bc=null;c.k.Cc=null;r(c);switch(d){case a.bd:var g=M.G(c.k.n),e=y(c,0,Pa);b(c,g,e,null,null,null,null,c.k.Nh);break;case a.Kb:g=X(c,ka),e=ea.lc(M.P(c.k.n),ea.Nc,Pa),e=C.scaleAndAdd(g,e,10,e),C.copy(e,c.k.pivot)}};a.ht=function(a){a=a.k;a.vb=0;C.set(0,0,0,a.pivot);C.set(0,0,0,a.Vb);a.Rk=!1;a.use_panning=!1;a.mb=null;a.la=null;a.tb=null;a.Bc=null;a.Cc=null;a.ce=null;a.Nh=!0};a.bD=function(a,b){for(var c=
0;c<a.length;c++){var d=a[c];70!=d.type&&80!=d.type&&90!=d.type&&100!=d.type||f(d,d.Ok,b)}};a.fD=function(a,b,c){var d=ia.A();a=ya.ka(a,d).da;for(d=0;d<a.length;d++){var g=a[d];if(90==g.type||100==g.type)90==g.type&&za.copy(b,g.jd),100==g.type&&za.copy(c,g.jd),g.rc||ga(g),E(g),Z(g)}}};b4w.module.__constraints=function(a,h){function p(a){var b={};b.type=a;return b}function e(a,c){a.pc&&a.pc.Fa&&b(a.pc.Fa,a);if(c.Fa){var d=c.Fa;-1==d.Te.indexOf(a)?d.Te.push(a):B.q("Descendant object override is forbidden")}a.pc=c}function b(a,b){var c=a.Te.indexOf(b);-1!=c?a.Te.splice(c,1):B.q("No descendant object")}function y(a,b,e){switch(b.type){case 1:var f=c.P(a.k.n),p=b.Fa.k.n;e=c.P(b.Fa.k.n);b.pe?(v.copy(b.pe,f),v.multiply(e,f,f)):v.copy(e,f);var h=c.Xc(b.offset,p,D);c.kf(h,a.k.n);c.Mf(b.ws*
c.Yd(b.Fa.k.n),a.k.n);break;case 9:h=c.G(a.k.n);f=c.P(a.k.n);p=b.Fa.k.n;e=c.P(b.Fa.k.n);v.multiply(v.invert(b.Hm,b.Hm),f,f);v.multiply(e,f,f);c.Xc(b.offset,p,h);v.copy(e,b.Hm);break;case 10:h=c.G(a.k.n);f=c.P(a.k.n);p=b.Fa.k.n;e=c.P(b.Fa.k.n);v.multiply(v.invert(b.Hm,b.Hm),f,f);v.multiply(e,f,f);c.Xc(b.offset,p,h);v.copy(e,b.Hm);h=c.P(a.k.n);f=v.multiply(c.P(b.Fa.k.n),b.pe,z);f=n.cB(f,K);h=n.cB(h,G);n.us(a,B.Bl(h[0],f[0]+b.WR,f[0]+b.VR),B.Bl(h[1],f[1]+b.UR,f[1]+b.XR));break;case 13:var h=c.G(a.k.n),
f=c.P(a.k.n),p=b.Fa.k.n,r=c.G(p),I=b.aZ,y=D,u=z;c.Xc(b.offset,p,y);B.jx(y,h,e,I,h);p=D;Q.sub(r,h,p);Q.normalize(p,p);var ga=f,h=d,r=h.subarray(0,3),y=h.subarray(3,6),Z=h.subarray(6,9);Q.copy(p,Z);Q.negate(Z,Z);Q.normalize(Z,Z);Boolean(.999999<Math.abs(Q.dot(p,B.nc)))?(p=l.fromQuat(v.normalize(ga,u),m),Q.copy(p.subarray(0,3),r)):Q.cross(B.nc,Z,r);Q.normalize(r,r);Q.cross(Z,r,y);Q.normalize(y,y);v.fromMat3(h,u);v.normalize(u,u);B.kM(u,f,e,.16*I,f);break;case 2:f=c.P(a.k.n);e=O;w.Zu(b.Fa,b.zl,!0,e);
c.multiply(b.Fa.k.n,e,e);f[0]=e[4];f[1]=e[5];f[2]=e[6];f[3]=e[7];b.pe&&(v.copy(b.pe,f),v.multiply(f,b.pe,f));c.Mf(b.ws*e[3],a.k.n);h=c.G(a.k.n);c.Xc(b.offset,e,h);break;case 3:h=c.G(a.k.n);f=c.P(a.k.n);e=c.G(b.Fa.k.n);A(h,f,e);break;case 4:h=c.G(a.k.n);f=c.P(a.k.n);e=b.target;A(h,f,e);break;case 5:h=c.G(a.k.n);f=c.P(a.k.n);e=c.G(b.Fa.k.n);A(h,f,e);f=Q.dist(h,e);if(f=f>b.Qg?f-b.Qg:f<b.Wq?f-b.Wq:0)Q.sub(e,h,D),Q.normalize(D,D),Q.scale(D,f,D),Q.add(h,D,h);break;case 6:h=c.G(a.k.n);f=c.P(a.k.n);e=b.target;
A(h,f,e);f=Q.dist(h,e);if(f=f>b.Qg?f-b.Qg:f<b.Wq?f-b.Wq:0)Q.sub(e,h,D),Q.normalize(D,D),Q.scale(D,f,D),Q.add(h,D,h);break;case 7:p=b.Fa.k.n;h=c.G(a.k.n);c.Xc(b.offset,p,h);break;case 8:r=c.G(b.Fa.k.n);h=c.G(a.k.n);Q.add(r,b.offset,h);break;case 14:f=c.P(a.k.n);p=b.Fa.k.n;e=c.P(b.Fa.k.n);b.pe?(v.copy(b.pe,f),v.multiply(e,f,f)):v.copy(e,f);h=c.G(a.k.n);c.Xc(b.offset,p,h);break;case 11:c.multiply(b.Fa.k.n,b.wx,a.k.n);break;case 12:h=b.wx;e=O;w.Zu(b.Fa,b.zl,!0,e);c.multiply(b.Fa.k.n,e,e);c.multiply(e,
h,a.k.n);break;case 15:f=b.Fa,e=n.WU(f),h=c.G(a.k.n),p=n.Vn(e,"LEFT"),r=n.Vn(e,"RIGHT"),I=n.Vn(e,"TOP"),u=n.Vn(e,"BOTTOM"),y="heights"==b.hor_units?I-u:r-p,b.TJ?(p=n.Vn(e,"LEFT"),h[0]=p+y*b.MB):(r=n.Vn(e,"RIGHT"),h[0]=r-y*b.MB),p="heights"==b.vert_units?I-u:r-p,h[1]=b.RM?I-p*b.QD:u+p*b.QD,n.ZV(e)?h[2]=-b.distance:(h[2]=-1,Q.normalize(h,h),Q.scale(h,b.distance/Math.abs(h[2]),h)),c.wd(h,f.k.n,h),Q.add(c.G(f.k.n),h,h),h=c.P(a.k.n),f=c.P(f.k.n),b.pe?(v.copy(b.pe,h),v.multiply(f,h,h)):v.copy(f,h)}"CAMERA"==
a.k.type&&(h=a.k.pf,10==b.type&&(e=c.P(b.Fa.k.n),h=Q.transformQuat(h,e,x)),n.cE(a),k(a,h))}function r(a,b){switch(b.type){case 1:var d=b.target.k.n,f=O;c.invert(a.k.n,f);c.multiply(f,d,f);w.fY(a,b.zl,f)}a.lC=!0}function A(a,b,c){var d=D;B.lc(b,B.Nc,d);Q.normalize(d,d);var f=R;Q.subtract(c,a,f);Q.normalize(f,f);a=B.YC(d,f,I);v.multiply(a,b,b);v.normalize(b,b)}function k(a,b,d){var f=a.k,e=c.P(f.n),l=B.lc(e,B.nc,D);Q.normalize(l,l);if(.999999<Math.abs(Q.dot(b,l)))l=v.identity(z);else{var m=Q.cross(b,
l,R);Q.normalize(m,m);f.vb==n.Kb?f.Rk&&Q.negate(m,m):(f=B.lc(e,B.wh,L),0<Q.dot(f,b)&&Q.negate(m,m));f=B.lc(e,B.ti,L);Q.normalize(f,f);var k=B.U(Q.dot(f,m),-1,1),l=-.999999>=k?v.setAxisAngle(l,Math.acos(k),z):v.rotationTo(f,m,z);v.normalize(l,l)}v.multiply(l,e,e);d&&(d=B.lc(e,B.xh,D),0>Q.dot(b,d)&&v.rotateZ(e,Math.PI,e));n.cE(a)}var w=h("__armature"),n=h("__camera"),l=h("__mat3"),f=h("__print"),v=h("__quat"),c=h("__tsr"),B=h("__util"),Q=h("__vec3");a.p0=1;a.o0=2;a.t0=3;a.u0=4;a.j0=5;a.k0=6;a.q0=7;
a.i0=8;a.n0=9;a.m0=10;a.g0=11;a.h0=12;a.l0=13;a.r0=14;a.s0=15;a.f0=1;var K=new Float32Array(2),G=new Float32Array(2),D=new Float32Array(3),R=new Float32Array(3),L=new Float32Array(3),I=new Float32Array(4),z=new Float32Array(4),d=new Float32Array(9),m=new Float32Array(9),O=c.create(),x=new Float32Array(3);a.IF=function(a,b,c,d,f){var l=p(1);l.Fa=b;l.offset=new Float32Array(c);l.pe=d?new Float32Array(d):null;l.ws=f;e(a,l);y(a,l,0)};a.xQ=function(a,b,c,d,f){var l=p(2);l.Fa=b;l.zl=c;l.offset=new Float32Array(d);
l.pe=null;l.ws=f;e(a,l);y(a,l,0)};a.uQ=function(a,b,d,f){var l=p(9),m=c.P(a.k.n),k=c.P(b.k.n);l.Fa=b;l.offset=new Float32Array(d);l.Hm=new Float32Array(k);f&&(v.copy(f,m),v.multiply(k,m,m));e(a,l);y(a,l,0)};a.tQ=function(a,b,d,f,l,m,k,n){var h=p(10),u=c.P(a.k.n),r=c.P(b.k.n);h.Fa=b;h.offset=new Float32Array(d);h.Hm=new Float32Array(r);h.VR=B.zi(l);h.WR=B.zi(m);h.XR=B.Fg(k,-Math.PI,Math.PI);h.UR=B.Fg(n,-Math.PI,Math.PI);f?(h.pe=new Float32Array(f),v.copy(f,u),v.multiply(r,u,u)):h.pe=v.create();e(a,
h);y(a,h,0)};a.sQ=function(a,b,c,d){var f=p(13);f.Fa=b;f.offset=new Float32Array(c);f.aZ=d;e(a,f);y(a,f,0)};a.AQ=function(a,b,c,d){var f=p(14);f.Fa=b;f.offset=new Float32Array(c);f.ws=1;f.pe=d?new Float32Array(d):null;e(a,f);y(a,f,0)};a.H7=b;a.CQ=function(a,b){var c=p(3);c.Fa=b;e(a,c);y(a,c,0)};a.DQ=function(a,b){var c=p(4);c.target=new Float32Array(b);e(a,c);y(a,c,0)};a.oQ=function(a,b,c,d){var f=p(5);f.Fa=b;f.Wq=c;f.Qg=d;e(a,f);y(a,f,0)};a.pQ=function(a,b,c,d){var f=p(6);f.target=new Float32Array(b);
f.Wq=c;f.Qg=d;e(a,f);y(a,f,0)};a.zQ=function(a,b,c){var d=p(7);d.Fa=b;d.offset=new Float32Array(c);e(a,d);y(a,d,0)};a.mQ=function(a,b,c){var d=p(8);d.Fa=b;d.offset=new Float32Array(c);e(a,d);y(a,d,0)};a.kQ=function(a,b,c){var d=p(11);d.Fa=b;d.wx=new Float32Array(c);e(a,d);y(a,d,0)};a.lQ=function(a,b,c,d){var f=p(12);f.Fa=b;f.zl=c;f.wx=new Float32Array(d);e(a,f);y(a,f,0)};a.sz=function(a,b,c){var d=p(15);d.Fa=b;if(B.Wh(c.left))d.TJ=!0,d.MB=c.left;else if(B.Wh(c.right))d.TJ=!1,d.MB=c.right;else{f.error("append_stiff_viewport: Wrong positioning params");
return}if(B.Wh(c.top))d.RM=!0,d.QD=c.top;else if(B.Wh(c.bottom))d.RM=!1,d.QD=c.bottom;else{f.error("append_stiff_viewport: Wrong positioning params");return}B.Wh(c.distance)?(d.distance=c.distance,d.pe=B.Wh(c.rotation)?new Float32Array(c.rotation):null,d.hor_units=B.Wh(c.hor_units)?c.hor_units:"widths",d.vert_units=B.Wh(c.vert_units)?c.vert_units:"heights",e(a,d),y(a,d,0)):f.error("append_stiff_viewport: Wrong positioning params")};a.h_=function(a,b){a.pc&&y(a,a.pc,b)};a.yQ=function(a,b,c,d,f){var e=
p(1);e.zl=c;e.target=b;e.offset=new Float32Array(d);e.pe=f?new Float32Array(f):null;e.ws=1;b=e.target;c=e.zl;d=a.k.Hg[c];f=b.$z;for(var l=0;l<f;l++){var m=f[l];if(m[0]==a&&m[1]==c){f.splice(l,1);break}}b.$z.push([a,c]);d.pc=e;r(a,e)};a.$Z=function(a,b){var c=a.k.Hg[b];c.pc&&r(a,c.pc)};a.YX=A;a.Qj=k;a.KR=function(a){return a.pc?!0:!1};a.remove=function(a){a.pc.Fa&&b(a.pc.Fa,a);a.pc=null};a.K5=function(a){return a.pc?a.pc.type:null};a.gg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?!1:!0};a.$u=
function(a){if((a=a.pc)&&11==a.type)return a.Fa.k.n;if(a&&12==a.type){var b=O;w.Zu(a.Fa,a.zl,!0,b);c.multiply(a.Fa.k.n,b,b);return b}return null};a.fg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?null:a.wx}};b4w.module.__container=function(a,h){var p,e,b,y,r;function A(a,b){p=a;e=b}function k(){var a=d.getBoundingClientRect();A(a.left,a.top)}function w(){return L.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function n(b,f,e){if(!b||!f){b=a.dy;f=a.cy;var k=O;k.style.width=a.dy+"px";k.style.height=a.cy+"px"}var k=d,n=m;!1!==e&&(k.style.width=b+"px",k.style.height=f+"px",n&&(n.style.width=b+"px",n.style.height=f+"px"));n&&(n.width=b,n.height=f,c.Rs());e=Math.floor(b*L.canvas_resolution_factor);f=Math.floor(f*
L.canvas_resolution_factor);w()&&(e*=window.devicePixelRatio,f*=window.devicePixelRatio);if(n=K.Rh())n=n.s,e=Math.floor(e*n.Bo),f=Math.floor(f*n.Bo);k.width=e;k.height=f;var n=Math.min(z.drawingBufferWidth,I.WB,I.aC[0]),h=Math.min(z.drawingBufferHeight,I.WB,I.aC[1]);if(e>n||f>h)Q.warn("Canvas size exceeds platform limits, downscaling"),n=Math.min(n/e,h/f),e*=n,f*=n,k.width=e,k.height=f;K.UL(e,f,e/b);K.Da()&&D.D(K.A().Cj);v.l_(k.width,k.height);v.$g()&&(l.update(),K.update(G.ur(),0),l.iN())}var l=
h("__anchors"),f=h("__config"),v=h("__data"),c=h("__hud"),B=h("__input"),Q=h("__print"),K=h("__scenes"),G=h("__time"),D=h("__transform"),R=h("__util"),L=f.B,I=f.Gi,z=null,d=null,m=null,O=null,x=!1;y=b=0;r=1;p=e=0;a.dy=320;a.cy=240;a.Nf=function(a){z=a};a.gm=function(){return d};a.oI=function(){return m};a.Ce=function(){return O};a.Xg=function(a,b){a&&a.parentNode?(d=a,m=b,O=a.parentNode):R.q("canvas container is not available")};a.Fv=function(a,b){b=b||"LAST";switch(b){case "FIRST":O.insertBefore(a,
O.firstElementChild);break;case "JUST_BEFORE_CANVAS":O.insertBefore(a,d);break;case "JUST_AFTER_CANVAS":d.nextElementSibling?O.insertBefore(a,d.nextElementSibling):O.appendChild(a,d);break;case "LAST":O.appendChild(a,d);break;default:Q.error(b+" invalid stack order")}};a.cJ=function(){return b};a.bJ=function(){return y};a.pL=A;a.$M=k;a.SY=function(a,c,d){b=a;y=c;r=d;k()};a.VA=function(){x=!0};a.ou=function(a,b,c){c||(c=new Float32Array(2));var d=c;x&&(k(),x=!1);d[0]=a-p;a=c;x&&(k(),x=!1);a[1]=b-e;
return c};a.ju=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*r;d[1]=c*r;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.R_=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/r;d[1]=c/r;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.BJ=function(b){return b&&b.parentNode?b.parentNode==O?!0:a.BJ(b.parentNode):!1};a.WV=w;a.mU=function(a){var b=document.getElementsByTagName("script");a=R.gj(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=n;a.Bk=function(a){var b=O,c=d,f=b.clientWidth,
b=b.clientHeight;if(a||f!=c.clientWidth||b!=c.clientHeight)(a="HMD"===L.stereo&&B.fJ())&&a.isPresenting||n(f,b,!0)};a.reset=function(){O=m=d=z=null}};b4w.module.__anchors=function(a,h){function p(){t=!0;B.Ce().addEventListener("mouseup",function(){function a(){return"visible"==c.style.visibility&&!m&&!n}if(!da&&!g){var b=P;if(b)if("visible"==b.lastElementChild.style.visibility)e(),P=null;else if(1==b.style.opacity){var c=b.lastElementChild,b=b.firstElementChild,d=c.firstElementChild,f=d.innerHTML;c.style.visibility="visible";var l=Math.min(parseInt(c.style.width)||200,A(f)-24),q=k(f,l),m=!0,n=!0;b.style.display="none";da=!0;I.wn(0,l,200,function(b){b==
l&&(m=!1,n||(da=!1),a&&(d.style.visibility="visible"));c.style.width=b+"px"});I.wn(0,q,200,function(b){b==q&&(n=!1,m||(da=!1),a&&(d.style.visibility="visible"));c.style.height=b+"px"})}}})}function e(){var a=P.lastElementChild;P.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function y(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function r(a,c,d){var f=document.createElement("div"),l=document.createElement("span");d&&(f.style.width=d+"px");y(f);b(l);l.innerHTML=a;f.style.visibility="hidden";l.style.visibility="hidden";f.appendChild(l);c.appendChild(f);c.addEventListener("mousedown",function(){da||c==P||1!=c.style.opacity||g||(P&&"visible"==P.lastElementChild.style.visibility&&e(),P=c)})}function A(a){var c=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);y(c);c.appendChild(d);document.body.appendChild(c);
a=c.offsetWidth+1;document.body.removeChild(c);return a}function k(a,c){var d=document.createElement("div"),f=document.createElement("span");f.innerHTML=a;b(f);y(d);d.style.width=c+"px";d.style.display="inline-block";d.appendChild(f);document.body.appendChild(d);f=d.offsetHeight-16;document.body.removeChild(d);return f}function w(){for(var a=0,b=0;b<x.length;b++)x[b].Jn&&a++;J=new Float32Array(3*a)}function n(a,b){return b.depth-a.depth}function l(a,b,c){a=a.element;O.vJ&&(b=Math.floor(b),c=Math.floor(c));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}var f=h("__batch"),v=h("__camera"),c=h("__config"),B=h("__container"),Q=h("__objects"),K=h("__obj_util"),G=h("__print"),D=h("__renderer"),R=h("__scenes"),L=h("__subscene"),I=h("__time"),z=h("__transform"),d=h("__tsr"),m=h("__vec3"),O=c.B,x=[],g=!1,P=null,t=!1,da=!1,J=new Float32Array(0),F=new Uint8Array(16),
T=new Float32Array(2),N=new Float32Array(3),ba=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<x.length;c++)if(x[c].ea==a){c=!0;break a}c=!1}if(!c){c=a.anchor.Jn&&Boolean(R.La(R.Rh(),L.kn));c={type:a.anchor.type,ea:a,x:0,y:0,depth:0,tl:"out",Jn:c,element:null,no:null,iQ:a.anchor.QW,Uj:a.anchor.Uj};switch(c.type){case "ANNOTATION":var d=c.ea;a=B.Ce();var f=Q.bv(d),d=d.name,g=document.createElement("div"),e=g.cloneNode(),l=document.createElement("span"),m="";g.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
e.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";g.style.visibility="hidden";f&&(m=f.description||m,d=f.title||d);l.innerHTML=d;l.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(l);l.style.whiteSpace="nowrap";e.appendChild(l);g.appendChild(e);m&&r(m,g,c.iQ);a.appendChild(g);c.element=g;break;case "ELEMENT":if(c.element=document.getElementById(a.anchor.Uj),c.element)for(f=0;f<x.length;f++)"ELEMENT"==x[f].type&&x[f].Uj==a.anchor.Uj&&(G.warn("Anchor with the id '"+a.anchor.Uj+"' already exists, making the new anchor generic."),c.type="GENERIC");else G.warn("Anchor HTML element with the id '"+a.anchor.Uj+"' was not found, making it generic."),c.type="GENERIC"}x.push(c);w();
t||p()}};a.remove=function(a){for(var b=0;b<x.length;b++){var c=x[b];if(c.ea==a){"ANNOTATION"==c.type&&(a=c,B.Ce().removeChild(a.element));x.splice(b,1);w();break}}};a.update=function(a){for(var b=0,c=x.length;c--;){var g=x[c];g.Jn&&J.set(d.G(g.ea.k.n),3*b++);var e,m=g,q=N;e=R.dm(R.Rh());e=q=v.FC(e,d.G(m.ea.k.n),q);m=e[0];q=e[1];e=e[2];if(a||m!=g.x||q!=g.y||e!=g.depth){switch(g.type){case "ANNOTATION":var k=m,h=q;l(g,k,h);break;case "ELEMENT":h=g.element.getBoundingClientRect(),k=m-h.width/2,h=q-
h.height/2,l(g,k,h)}g.x=m;g.y=q;g.depth=e;g.no&&g.no(m,q,g.tl,g.ea,g.element)}}x.sort(n);for(c=0;c<x.length;c++)g=x[c],"GENERIC"!=g.type&&(g.element.style.zIndex=P==g.element?x.length:c);0<b&&(a=R.La(R.Rh(),L.kn),b=a.Ra[0].sa[0],f.UZ(b.za,J),L.Sc(a,b))};a.iN=function(){for(var a=B.Ce(),b=x.length;b--;){var c=x[b],d=c.ea,f=d.k,g=c.x,l=c.y,k=c.depth,n=R.dm(R.Rh()),h=z.ie(d,N),n=z.ie(n,ba),h=m.dist(h,n);(k=0>g||0>l||0>k||1<k||R.FB(d)||g>=a.clientWidth||l>=a.clientHeight)||(k=f.ef,k=!(h<f.bh?0:k==K.Hp||
h<k));f=k?"out":"visible";c.Jn&&"out"!=f&&(f=c,k=R.La(R.Rh(),L.kn).p,h=B.ju(f.x,f.y,T,k),D.LC(k.Ze,h[0],k.height-h[1],2,2,F),f=1020==F[5]+F[6]+F[9]+F[10]?"visible":"out"==f.tl||0==F[5]+F[6]+F[9]+F[10]?"covered":f.tl);if(f!=c.tl){switch(c.type){case "ANNOTATION":case "ELEMENT":var p=c.element;if(!p)break;"out"==f?(p.style.visibility="hidden",p.children.length&&(p.children[0].style.visibility="hidden")):"visible"==f?(p.style.visibility="visible",p.children.length&&(p.children[0].style.visibility="visible"),
p.style.opacity=1):(p.style.visibility="visible",p.style.opacity=.1,p.children.length&&(p.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<p.children.length&&"visible"==p.lastElementChild.style.visibility&&(e(),p==P&&(P=null)))}c.tl=f;c.no&&c.no(g,l,c.tl,d,p)}}};a.w2=function(a,b){for(var c=0;c<x.length;c++)x[c].ea==a&&(x[c].no=b)};a.x3=function(a){for(var b=0;b<x.length;b++)x[b].ea==a&&(x[b].no=null)};a.ua=function(){for(var a=0;a<x.length;a++){var b=x[a];"ANNOTATION"==b.type&&B.Ce().removeChild(b.element)}x.length=
0};a.OV=function(a){for(var b=0;b<x.length;b++)if(x[b].ea==a)return!0;return!1};a.G4=function(a){for(var b=0;b<x.length;b++)if(x[b].ea==a)return x[b].Uj;return!1};a.pause=function(){g=!0};a.jj=function(){g=!1};a.jX=function(a,b){for(var c=-1,d=0;d<x.length;d++){var f;if(f="visible"==x[d].tl){var g=x[d];if(g.element){f=Math.round(g.element.offsetWidth)||0;var e=Math.round(g.element.offsetHeight)||0}else e=f=0;var l=g.x,g=g.y;f=a>=l&&a<=l+f&&b<g&&b>=g-e?!0:!1}if(f)if(0>c)var m=x[d].depth,c=d;else x[d].depth<
m&&(c=d,m=x[d].depth)}return 0>c?null:x[c].ea}};b4w.module.__scenes=function(a,h){function p(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.Vf||!c.Vf.length)return c}return null}function e(){wb||La.q("No active scene available");return wb}function b(a,b,c){if(!Aa.Hu||!y(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>ab.Ec?(d.csm_resolution=ab.Ec,Ha.error("Shadow map texture has unsupported size. Changed to "+ab.Ec+".")):d.csm_resolution=c.csm_resolution;Aa.eR=c.blur_samples;d.$Y=c.soft_shadows;a=H.fv(b,Aa.ssao&&a.b4w_enable_ssao);
d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.ah=[];d.oM=[];d.wq=[];d.vq=[];for(b=0;b<a.length;b++)d.ah.push(a[b].ub.type),d.oM.push(a[b].ub.Vm),d.wq.push(a[b].ub.wq),d.vq.push(a[b].ub.vq),"SPOT"!=d.ah[b]&&"POINT"!=d.ah[b]||!d.enable_csm||(Ha.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=
c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,
d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function y(a,b,c){if(0!=b.length&&Aa.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,f=!1;a=Aa.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var g=c[b];g.b4w_shadow_cast&&(d=!0);g.b4w_shadow_receive&&(f=!0);if((a||d)&&f)return!0}return!1}function r(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].ub.type)return!0;return!1}function A(a){if(!Aa.Kk)return!1;a=sa(a);
for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function k(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(H.FG(a[b],c[d].settings))return!0;return!1}function w(a){for(var b=sa(a),c=[],d=0;d<b.length;d++){var f=b[d];if(f.b4w_water){for(var g={},e=0;e<a.length;e++)for(var l=a[e],q=l.data.materials,m=0;m<q.length;m++)q[m]==f&&(g.el=l.location[2]);g.Be=f.b4w_water_fog_color.slice(0);g.Be.push(f.b4w_water_fog_density);
f.b4w_water_dynamic?(g.ar=!0,g.waves_height=f.b4w_waves_height,g.waves_length=f.b4w_waves_length,g.dst_noise_scale0=f.b4w_water_dst_noise_scale0,g.dst_noise_scale1=f.b4w_water_dst_noise_scale1,g.dst_noise_freq0=f.b4w_water_dst_noise_freq0,g.dst_noise_freq1=f.b4w_water_dst_noise_freq1,g.dir_min_shore_fac=f.b4w_water_dir_min_shore_fac,g.dir_freq=f.b4w_water_dir_freq,g.dir_noise_scale=f.b4w_water_dir_noise_scale,g.dir_noise_freq=f.b4w_water_dir_noise_freq,g.dir_min_noise_fac=f.b4w_water_dir_min_noise_fac,
g.dst_min_fac=f.b4w_water_dst_min_fac,g.waves_hor_fac=f.b4w_water_waves_hor_fac):(g.ar=!1,g.waves_height=0,g.waves_length=0);g.Kg=f.b4w_water_enable_caust;g.AR=f.b4w_water_caust_scale;g.zR=f.b4w_water_caust_brightness;g.BR=new Float32Array([.3,.7]);g.Lk=null;f=f.texture_slots;for(e=0;e<f.length;e++)l=f[e].texture,!0===l.b4w_shore_dist_map&&"FILE"==l.image.source&&(g.Lk=l.image,g.uD=l.image.size[0],g.XB=l.b4w_max_shore_dist,l=l.b4w_shore_boundings,g.Ko=[(l[0]+l[1])/2,(l[2]+l[3])/2],g.Lo=[l[0]-l[1],
l[2]-l[3]]);c.push(g)}}if(0<c.length){g=c[0];if(!g.ar)for(d=0;d<c.length;d++)c[d].ar&&(g=c[d]);return g}return null}function n(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var f=a[d];"GROUP"==f.type&&f.node_group&&b(f.node_group.node_tree);"GROUP"==f.type&&"B4W_REFRACTION"==f.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=sa(a);for(var d=0;d<a.length;d++){var f=a[d];f.b4w_refractive&&(c.refractions=!0);f.node_tree&&b(f.node_tree)}return c}function l(a,b,c){if(Aa.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var d=0,f=!1,g=0;g<b.length;g++){var e=b[g];e.k.Gd&&"CUBE"==e.k.lh&&d++;if(e.ss.length){for(var l=null,q=0;q<a.length;q++)if(a[q]==e){l=q;break}null==l&&a.push(e)}}for(g=0;g<c.length;g++){a:if(b=c[g],b.b4w_reflexible){b=b.data.materials;for(e=0;e<b.length;e++)if(l=b[e].game_settings.alpha_blend,"OPAQUE"!=l&&"CLIP"!=l){b=!0;break a}b=!1}else b=void 0;b&&(f=!0)}return{YK:a,qK:d,Ji:[],wA:[],bi:[],yw:[],kJ:f}}function f(a,b){var c=a.b4w_sky_settings,d={};d.aL=c.render_sky||c.procedural_skydome;
d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.No=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.ee=c.reflexible;d.Hd=c.reflexible_only;
!b&&c.procedural_skydome&&Ha.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function v(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.BV=a.hemisphere;b.dR=a.blur_depth;b.kG=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.$X=a.samples;return b}function c(a){if(!(Aa.bloom&&a.b4w_enable_bloom&&a.s.rj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function B(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function Q(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function K(a){var b={};a=a.b4w_god_rays_settings;b.zB=a.intensity;b.ko=a.max_ray_length;b.Wo=a.steps_per_pass;return b}function G(a){var b={};b.hj=a.b4w_outline_color;b.$r=a.b4w_outline_factor;return b}
function D(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function R(a,b){var c=a.light_settings,d={};d.Sg=c.environment_energy;d.Xs=c.use_environment_light;d.MA=c.environment_color;d.ke=a.horizon_color.slice(0);d.te=a.zenith_color.slice(0);d.$s=a.use_sky_paper;d.Zs=a.use_sky_blend;d.at=a.use_sky_real;d.ix=null;
d.Oo=null;d.Ou=null;c=!0;if(d.Xs&&"SKY_TEXTURE"==d.MA&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var f=null,g=0;g<a.texture_slots.length;g++)if(a.texture_slots[g].texture.b4w_use_as_environment_lighting&&!a.texture_slots[g].texture.b4w_use_as_skydome){f=a.texture_slots[g];break}f?d.Ou=f:c=!1}for(g=0;g<a.texture_slots.length;g++)if(a.texture_slots[g].texture.b4w_use_as_skydome){c=!0;f=a.texture_slots[g];d.ix=f;g=Math.min(ab.Zi,Qa.sR(f.texture.image.size[0]/3));d.Oo={EZ:g,hG:f.blend_factor,
pJ:f.horizon_factor,KN:f.zenith_up_factor,JN:f.zenith_down_factor,color:f.color,Ea:f.default_value,invert:f.invert,pN:f.use_rgb_to_intensity,iG:f.blend_type,kN:f.use_map_blend,lN:f.use_map_horizon,nN:f.use_map_zenith_up,mN:f.use_map_zenith_down};break}d.Xs=d.Xs?c:!1;return d}function L(a){var b=a.fog_settings,c={};c.H_=b.use_fog;c.zB=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.fU=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Be=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.dg=new Float32Array([c.zB,c.depth,c.start,c.height]);return c}function I(a,b){if(!Aa.hd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,d=!1,f=0;f<b.length;f++){for(var g=b[f],e=g.data.materials,l=0;l<e.length;l++)e[l].b4w_terrain&&(c=!0);g=g.particle_systems;for(l=0;l<g.length;l++)e=g[l].settings,"HAIR"==e.type&&e.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function z(a,b){if(Ya.outlining_overview_mode)return!0;if(Aa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].pb.k.Dk)return!0;return!1}else return!1}function d(a,b){if(Ya.outlining_overview_mode)return!0;if(Aa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].pb.k.Vc)return!0;return!1}else return!1}function m(a,b){if(Aa.Ui)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,
f=0;f<d.length;f++)if(Ga.EG(d[f]))return!0;return!1}else return!1}function O(a,b){if(Aa.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function x(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var f=c[d],g=f.game_settings.alpha_blend;if(f.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g)return!0}return!1}function g(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].pb;if(d.anchor&&d.anchor.Jn)return!0}return!1}}function P(a,b,c){var d=ma.gh(a,b);ma.ni(a,d,function(a,b,d){if(d.Gc){switch(d.from){case "COLOR":case "CUBEMAP":var f=b.p.wc;break;case "DEPTH":f=b.p.Ve;break;case "SCREEN":f=null;break;case W.md:return;default:La.q("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:f||La.q("Connection of SCREEN is forbidden"),f.Ne&&La.q("Batch texture can't use renderbuffer"),qa.IG(c.zb,d.to)&&ja.Gj(c,f,d.to)}}});for(a=0;a<b.Za.length;a++){var d=b.Za[a],f=b.mi[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:f.Ne&&La.q("Batch texture can't use renderbuffer"),qa.IG(c.zb,d.to)&&ja.Gj(c,f,d.to)}}}function t(a){if(a&&a.s&&a.s.Xa){var b=fa.gc(a.s.Xa,W.Dg);b&&U(a,b)}}function da(a,
b,c,d,f,g){for(var e=b.k,l=H.ka(b,f).W,q=0;q<l.length;q++){var m=l[q];if(!(m.qe||m.Hd||"MAIN"!=m.type&&"NODES_GLOW"!=m.type&&"PARTICLES"!=m.type&&"LINE"!=m.type)&&("OPAQUE"==m.Fb&&"OPAQUE"==d||"BLEND"==m.Fb&&"BLEND"==d||"XRAY"==m.Fb&&"XRAY"==d||"NODES_GLOW"==m.type&&"GLOW"==d)){if(!g&&(J(m,a,b,c,d,f),!ja.Yc(m)))if("DEBUG"===Ua.type())ja.Xt(m,"error.glslv","error.glslf"),ja.Yc(m);else continue;var k=W.Vh(m,e);W.Sc(a,k);P(c,a,m);F(m)}}}function J(a,b,c,d,f,g){var e=c.k,l=g.s,m=H.ka(c,g),q="NO_SHADOWS";
c=aa(g,[W.cd]);if(c.length&&a.fe){switch(f){case "OPAQUE":q="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":q="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":q="NO_SHADOWS";break;case "SHADOW":q="SHADOW_MASK_GENERATION";break;default:La.q("Wrong subscene type")}for(var k=0;k<c.length;k++)ja.RF(a,g.s.ud)}k="NO_SOFT_SHADOWS";if(l.ud&&l.ud.$Y)switch(Aa.eR){case "16x":k="POISSON_X_16";break;case "8x":k="POISSON_X_8";break;case "4x":k="POISSON_X_4"}c=a.ib;qa.ia(c,"SHADOW_USAGE",
q);qa.ia(c,"POISSON_DISK_NUM",k);a.hd&&(k=fa.gc(d,W.vi))&&T(a,k,e);k=b.p;k.type==ka.we||k.type==ka.Bh||k.type==ka.yi?qa.ia(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):qa.ia(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=f||a.ak){f=b.lw;qa.ia(c,"NUM_LIGHTS",f);qa.ia(c,"NUM_LFACTORS",0==f%2?f/2:Math.floor(f/2)+1);qa.ia(c,"REFLECTION_PASS","REFL_PASS_NONE");qa.ia(c,"SSAO_ONLY",0);if(f=l.Mc)qa.ia(c,"WATER_EFFECTS",1),qa.ia(c,"WAVES_HEIGHT",qa.N(f.waves_height)),qa.ia(c,"WAVES_LENGTH",qa.N(f.waves_length)),
qa.ia(c,"WATER_LEVEL",qa.N(f.el));if(b.Kg&&a.Kg){qa.ia(c,"CAUSTICS",1);if(k=l.ud){e=k.ah;for(k=q=0;k<e.length;k++)"SUN"==e[k]&&(q=k);qa.ia(c,"SUN_NUM",q)}qa.ia(c,"CAUST_SCALE",qa.N(b.uG));qa.ia(c,"CAUST_SPEED",qa.N(b.vG,2));qa.ia(c,"CAUST_BRIGHT",qa.N(b.tG))}b=m.Ji;m=m.bi;if(-1!==a.Ld.indexOf("u_mirrormap"))qa.ia(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Gd&&b)b=b.p.wc,ja.Gj(a,b,"u_cube_reflection"),qa.ia(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Gd&&m)for(k=0;k<m.length;k++)b=m[k].p.wc,ja.Gj(a,
b,"u_plane_reflection"),qa.ia(c,"REFLECTION_TYPE","REFL_PLANE");else qa.ia(c,"REFLECTION_TYPE","REFL_NONE");(m=fa.gc(d,W.Dg))?a.Iu?(b=m.p.wc,ja.Gj(a,b,"u_sky")):m.procedural_skydome&&(a.ye=m.ye,qa.ia(c,"PROCEDURAL_FOG",1)):qa.ia(c,"PROCEDURAL_FOG",0);b=l.pp;b.Xs&&(qa.ia(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.MA?(b.Ou?(m=b.Ou.texture,b=Qa.he(b.Ou),ja.Gj(a,b,"u_sky_texture",m.name)):m&&(b=m.p.wc,ja.Gj(a,b,"u_sky_texture")),qa.ia(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.MA&&qa.ia(c,"SKY_COLOR",1));
b=l.IN;b.H_&&(qa.ia(c,"USE_FOG",1),qa.ia(c,"FOG_TYPE",b.fU));a.zk&&a.Lb?(Aa.Hu&&qa.ia(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.ak||"NODES_GLOW"==a.type?(qa.ia(c,"REFRACTIVE",1),l.refractions?qa.ia(c,"USE_REFRACTION",1):qa.ia(c,"USE_REFRACTION",0)):l.refractions?qa.ia(c,"REFRACTIVE",1):qa.ia(c,"REFRACTIVE",0),(l.aK.refractions||l.refractions)&&qa.ia(c,"HAS_REFRACT_TEXTURE",1)):(qa.ia(c,"REFRACTIVE",0),qa.ia(c,"USE_REFRACTION",0),qa.ia(c,"USE_REFRACTION_CORRECTION",0));a.yj&&(Aa.Kk&&a.gt&&
fa.gc(d,W.AE)?qa.ia(c,"SHORE_SMOOTHING",1):qa.ia(c,"SHORE_SMOOTHING",0),a.water_dynamic&&f&&f.waves_height?qa.ia(c,"DYNAMIC",1):qa.ia(c,"DYNAMIC",0));"PARTICLES"==a.type&&(qa.ia(c,"SIZE_RAMP_LENGTH",a.hb.X8),qa.ia(c,"COLOR_RAMP_LENGTH",a.hb.SG));if(!a.eg)for(a=a.ya,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(l=0;l<Va.length;l++)for(c=Va[l],m=Va[l].Vf,f=0;f<m.length;f++)m[f]==b&&ma.r(Ob,c,g,null)}}function F(a){8<a.ya.length&&Ha.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.sd.join(", ")+'"')}function T(a,b,c){a.je=b.je;var d=b.je[0],f=b.je[1],g=b.je[2];c=c.R;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);g=0==g?c:Math.max(g,c);b.je[2]=g;b=b.p;ka.Sw(b,g/2,-f,-d,g/2);ka.Ik(b);d=a.yr||0;d=0==d?c:Math.max(d,c);a.yr=d}function N(a,b,c,d,f,g){for(var e=b.k,l=H.ka(b,f).W,m=0;m<l.length;m++){var q=l[m];if(("MAIN"==q.type||"PARTICLES"==q.type||"LINE"==q.type)&&"REFLECT"==q.Fb&&q.Lb==d){if(a.type==W.Nd||a.type==W.xf){var k;a:{var n=f.s.ei.bi;for(k=0;k<n.length;k++)for(var u=0;u<
n[k].length;u++)if(n[k][u]==a)break a;n=f.s.ei.yw;for(k=0;k<n.length;k++)for(u=0;u<n[k].length;u++)if(n[k][u]==a)break a;k=null}if(k==e.Ed)continue}else if(k=ua(f,a),k==e.Rd)continue;if(!g&&(J(q,a,b,c,"REFLECT",f),k=q.ib,qa.ia(k,"WATER_EFFECTS",0),a.type==W.Nd||a.type==W.xf?qa.ia(k,"REFLECTION_PASS","REFL_PASS_PLANE"):qa.ia(k,"REFLECTION_PASS","REFL_PASS_CUBE"),qa.ia(k,"TEXTURE_NORM",0),!ja.Yc(q)))if("DEBUG"===Ua.type())ja.Xt(q,"error.glslv","error.glslf"),ja.Yc(q);else continue;q=W.Vh(q,e);W.Sc(a,
q)}}}function ba(a){X(a);var b=oa(a,W.Pb),c=!0,d=a.s.ud;ma.pa(a.s.Xa,function(f,g){g.type===W.cd&&(ga(g,a,b.p,d,c),c=!1)})}function u(a){ma.pa(a.s.Xa,function(a,b){b.type===W.pn&&(b.KA=1)})}function ga(a,b,c,d,f){if(0!=a.Ra.length){var g=a.p,e=ra.hc(c.n,qb);ra.kf(e,g.n);ra.copy(c.qf,g.Fs);if("SUN"===d.ah[a.ph]||"HEMI"===d.ah[a.ph]){e=tc;xa.a0(e);for(var l=0;l<a.Ra.length;l++)for(var m=a.Ra[l].sa,q=0;q<m.length;q++){var k=m[q].ff;0==l&&0==q?xa.Cn(k.Ua,e):xa.NA(e,k.Ua)}e=xa.LH(e,Nc);La.xo(e,g.Ob,e);
if(d.enable_csm){b=Ta.copy(c.Lh[a.vA],qb);d=Ma.invert(c.Ob,jc);La.xo(b,d,b);La.xo(b,g.Ob,b);a=c.Oq[a.vA];if(f)for(Ib=0,ec=-Infinity,f=2;f<e.length;f+=3)Ib=Math.min(Ib,e[f]),ec=Math.max(ec,e[f]);f=tc;f.max_x=b[0]+a;f.max_y=b[1]+a;f.max_z=ec;f.min_x=b[0]-a;f.min_y=b[1]-a;f.min_z=Ib}else{c=f=tc;d=Wc;d.set(e);e=ic/9;l=Ma.identity(jc);Ma.rotate(l,e,La.Nc,l);q=m=-1;for(k=0;10>k;k++){var n=xa.YF(d,Qc),u=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==m||u<m)m=u,q=k,xa.Cn(n,c);La.xo(d,l,d)}c=q*e;0<c&&(e=Ma.identity(jc),
Ma.rotate(e,c,La.Nc,e),Ma.multiply(e,g.Ob,g.Ob),ra.Qi(g.Ob,g.qf));c=f.max_x-f.min_x;e=f.max_y-f.min_y;c&&e&&(d=Math.abs(c-e)/2,2<c/e?(f.max_y+=d,f.min_y-=d):2<e/c&&(f.max_x+=d,f.min_x-=d));f.max_x+=.005;f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005;Z(a,b.s.Xa)}ka.rY(g,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);ka.Ik(g);La.On(g.ld,g.Ph)}else"SPOT"!==d.ah[a.ph]&&"POINT"!==d.ah[a.ph]||ka.Ik(g,g.Ab)}}function Z(a,b){for(var c=a.p,d=fa.lV(b,a),f=0;f<d.length;f++){var g=
d[f];if(g.type==W.Pb||g.type==W.yf||g.type==W.Pc||g.type==W.Uf)if(Aa.Wv)g.hE.set(c.qf,9*a.ph);else{var e=ra.G(c.qf),l=ra.P(c.qf);pb.set(e[0],e[1],e[2],ra.Yd(c.qf),fb);g.Bx.set(fb,4*a.ph);g.Ax.set(l,4*a.ph)}}}function E(a,b,c,d,f){for(var g=b.k,e=H.ka(b,d).W,l=0;l<e.length;l++){var m=e[l];if("COLOR_ID"==m.type&&(a.type==W.tf&&"COLOR_ID"==m.Fb||a.type==W.ui&&"COLOR_ID_XRAY"==m.Fb)){if(!f&&(J(m,a,b,c,"COLOR_ID",d),ja.jf(m,"USE_OUTLINE",0),!ja.Yc(m)))continue;m=W.Vh(m,g);W.Sc(a,m)}}}function ca(a,b,c,
d,f){if(!d&&(f.hd&&(d=fa.gc(c,W.vi))&&T(f,d,b),!ja.Yc(f)))if("DEBUG"===Ua.type())ja.Xt(f,"error.glslv","error.glslf"),ja.Yc(f);else return;b=W.Vh(f,b);W.Sc(a,b);P(c,a,f);F(f)}function ha(a,b){q(a,b);for(var c=0;c<a.Te.length;c++)a.Te[c].parent==a&&ha(a.Te[c],b)}function q(a,b){a.k.Uh=b;if(H.Zg(a))for(var c=0;c<a.I.length;c++)for(var d=a.I[c],f=aa(d.yb,eb),g=0;g<f.length;g++){var e=f[g],l=a.k,m=a.ub,q=d.wm,k=m.$m&&!l.Uh?1:0;e.Qr[4*q+3]=k;k=m.bn&&!l.Uh?1:0;e.Pr[4*q+3]=k;e.Ba=!0}}function S(a,b){for(var c=
aa(b,eb),d=a.ub,f=a.k,g=H.ka(a,b),e=ra.G(f.n),f=ra.P(f.n),l=0;l<c.length;l++){var m=c[l],q=m,k=a.k,n=a.ub,u=g.wm,C=ra.G(a.k.n),h=n.Eq;q.OB.set(n.direction,3*u);fb[0]=C[0];fb[1]=C[1];fb[2]=C[2];fb[3]=n.$m&&!k.Uh?1:0;q.Qr.set(fb,4*u);fb[0]=h[0];fb[1]=h[1];fb[2]=h[2];fb[3]=n.bn&&!k.Uh?1:0;q.Pr.set(fb,4*u);q.Ba=!0;switch(d.type){case "SUN":m.BM.set(f);m.AM=d.Eq;m.type===W.Dg?(m.gw=d.mK,Ta.copy(d.direction,m.ED),U(b,m)):Ta.copy(d.direction,m.ED);break;case "HEMI":case "POINT":case "SPOT":break;default:Ha.error("Unknown light type: "+
d.type+'".')}m=m.Ra;for(q=0;q<m.length;q++)for(k=m[q].sa,n=0;n<k.length;n++)u=k[n].za,u.vm&&ja.tY(u,a)}c=oa(b,W.Pb).p;g=g.sD;d=b.s.ud;for(l=0;l<g.length;l++)m=g[l],ka.pD(m.p,e,f),ga(m,b,c,d,!0),Z(m,b.s.Xa)}function X(a){var b=Ra.Ub(a,"LAMP",Ra.oc),b=H.fv(b,Aa.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],f=d.k,g=ra.hc(f.n,qb),f=ra.Xd(f.n,Bb),e=0;e<d.I.length;e++){var l=d.I[e],m=l.sD;if(l.yb==a)for(l=0;l<m.length;l++)ka.pD(m[l].p,g,f)}}function U(a,b){Y.Aw(b);Sa.Mn(b);
if(b.gw)for(var c=aa(a,bb),d=0;d<c.length;d++)for(var f=c[d].Ra,g=0;g<f.length;g++)for(var e=f[g].sa,l=0;l<e.length;l++){var m=e[l];m.cc&&(m=m.za,ja.ER(m)&&Sa.ZZ(m))}}function sa(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,f=0;f<d.materials.length;f++){var g=d.materials[f];-1==b.indexOf(g)&&b.push(g)}return b}function pa(a,b,c){for(var d=a.s,f=H.ka(a.Cj,a).da,g=0;g<f.length;g++){var e=f[g];ka.Ik(e,b/c);d.ud&&ka.bE(e,d.ud)}d.ud&&(d.hw=!0,oa(a,W.yf).Ba=!0,oa(a,W.Pc).Ba=!0);var l=d.Xa;fa.PZ(l,
function(d,f,g){if(d.Rs){var e=d.Qm*b,m=d.Rm*c;if(f)for(f=0;f<g.Za.length;f++)g.Za[f]==d&&Qa.resize(d.kb,e,m);else switch(Qa.fo(d.kb)&&Qa.resize(d.kb,e,m),d=g.p,d.width=e,d.height=m,g.type){case W.wp:ya(a,{dof_power:g.p.dof_power});break;case W.yp:la(a,{small_glow_mask_width:g.small_glow_mask_width,large_glow_mask_width:g.large_glow_mask_width});break;case W.qp:wa(a,{bloom_blur:g.An});break;case W.pn:g=fa.Db(l,g,W.fc);e=fa.Db(l,g,W.fc);m=fa.Db(l,e,W.fc);d=fa.Db(l,m,W.fc);fa.Jd(g,1/b,1/c);fa.Jd(e,
1/b,1/c);fa.Jd(m,1/b,1/c);fa.Jd(d,1/b,1/c);break;default:fa.Jd(g,1/b,1/c)}}})}function aa(a,b){for(var c=[],d=0;d<b.length;d++){var f=b[d];ma.pa(a.s.Xa,function(a,b){b.type==f&&c.push(b)})}return c}function oa(a,b){return fa.gc(a.s.Xa,b)}function ya(a,b){var c=oa(a,W.wp);if(!c)return Ha.error("DOF is not enabled on the scene. Check camera settings"),0;var d=c.p.dof_bokeh,f=d?aa(a,[W.Zx]):[],g=a.s.Xa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,d))for(var e=0;e<f.length;e++)f[e].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,d))for(e=0;e<f.length;e++)f[e].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,d))for(e=0;e<f.length;e++)f[e].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,d))for(e=0;e<f.length;e++)f[e].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,d))for(e=0;e<f.length;e++)f[e].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,d))for(e=0;e<f.length;e++)f[e].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(c.p.dof_bokeh_intensity=b.dof_bokeh_intensity,d&&(f=fa.hB(g,c,W.fc),f[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,f[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,f[0]=fa.Db(g,f[0],W.fc),f[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(d){d=b.dof_power;c.p.dof_power=d;var d=
d/2,e=c.p.width,l=c.p.height,m=[1/e,0],q=[1/e*.5,1/l*.866],k=[-1/e*.5,1/l*.866],f=fa.hB(g,c,W.fc);fa.Lc(f[0],d);fa.Jd(f[0],k[0],k[1]);fa.Lc(f[1],d);fa.Jd(f[1],q[0],q[1]);f[0]=fa.Db(g,f[0],W.fc);fa.Lc(f[0],d);fa.Jd(f[0],m[0],m[1]);c.p.Cd&&(f[0]=fa.Db(g,f[0],W.Zx),f[0]=fa.Db(g,f[0],W.fc),fa.Jd(f[0],1/e,1/l),f[0]=fa.Db(g,f[0],W.fc),fa.Jd(f[0],1/e,1/l))}else c.p.dof_power=b.dof_power,f=fa.Db(g,c,W.fc),g=fa.Db(g,f,W.fc),fa.Lc(f,c.p.dof_power),fa.Jd(f,1/c.p.width,1/c.p.height),fa.Lc(g,c.p.dof_power),fa.Jd(g,
1/c.p.width,1/c.p.height)}function wa(a,b){var c=oa(a,W.Ct),d=oa(a,W.qp);if(!c||!d)return Ha.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.eu=b.key,c.Ba=!0);"number"==typeof b.edge_lum&&(c.du=b.edge_lum,c.Ba=!0);if("number"==typeof b.blur){var f=a.s.Xa,c=fa.Db(f,d,W.rp),f=fa.Db(f,c,W.rp);d.An=b.blur;fa.Lc(c,b.blur);fa.Jd(c,1/d.p.width,1/d.p.height);fa.Lc(f,b.blur);fa.Jd(f,1/d.p.width,1/d.p.height)}}function la(a,b){var c=oa(a,W.yp);if(!c)return Ha.error("Glow is not enabled on the scene"),
null;for(var d=a.s.Xa,f=fa.hV(d,c),g=0;g<f.length;++g){var e=f[g];if(e.type==W.fc&&"GLOW_MASK_LARGE"==e.Fb)var l=e;if(e.type==W.fc&&"GLOW_MASK_SMALL"==e.Fb)var m=e}f=fa.Db(d,l,W.fc);d=fa.Db(d,m,W.fc);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.Ba=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.Ba=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,fa.Lc(m,b.small_glow_mask_width),
fa.Jd(m,1/c.p.width,1/c.p.height),m.Ba=!0,fa.Lc(d,b.small_glow_mask_width),fa.Jd(d,1/c.p.width,1/c.p.height),d.Ba=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,fa.Lc(l,b.large_glow_mask_width),fa.Jd(l,1/c.p.width,1/c.p.height),l.Ba=!0,fa.Lc(f,b.large_glow_mask_width),fa.Jd(f,1/c.p.width,1/c.p.height),f.Ba=!0)}function ia(a,b,c){var d=a.s,f=d.Mc;if(!f.ar)return f.el;var g=f.waves_height,e=f.waves_length,l=f.el,m=Ta.length(d.zj)||1;a=oa(a,W.Pb).time;
a*=m;var q=Wb;q[0]=20/e*(b-.25*a);q[1]=20/e*(c-.25*a);m=La.wG(q);q[0]=17/e*(c+.1*a);q[1]=17/e*(b+.1*a);var q=La.wG(q),m=m+q-1,k=f.dst_noise_scale0,q=f.dst_noise_scale1,n=f.dst_noise_freq0,u=f.dst_noise_freq1,C=Wb;C[0]=k*(b+n*a);C[1]=k*(c+n*a);k=La.xD(C);C[0]=q*(c-u*a);C[1]=q*(b-u*a);q=La.xD(C);q*=g*k;if(f.Lk)if(u=(b-f.Ko[0])/f.Lo[0],C=(f.Ko[1]+c)/f.Lo[1],u+=.5,C+=.5,1<u||0>u||1<C||0>C)f=q;else{var d=La.jI(d.tD,f.uD,u,C),C=f.dir_freq,h=f.dir_noise_scale,p=f.dir_noise_freq,k=f.dir_min_noise_fac,u=f.dst_min_fac,
n=e/f.XB/Math.PI;c=[h/e*(b+p*a),h/e*(c+p*a)];b=Math.sqrt(d);f=g*Math.max(d,f.dir_min_shore_fac)*Math.sin(b/n+C*a)*Math.max(La.xD(c),k);g=Math.max(b,u);f=f*(1-g)+q*g;m*=d}else f=q;return l+(f+.05*m)}function ta(a,b){a.Fr&&a.type==W.fc&&b.cc!=a.cc&&(a.cc=b.cc);b.cc||a.type!=W.pn||(a.KA=0)}function na(a,b,c,d){var f=ma.Wa(a,b);ka.Qw(f.p,c,d);f.vz=!0;ma.Sk(a,b,function(b,f,g){g.Gc&&g.from==c&&fa.SR(g)&&M(a,b,g.to,d)});ma.ni(a,b,function(b,f,g){g.Gc&&g.from==c&&g.from==g.to&&na(a,b,c,d)})}function M(a,
b,c,d){a=ma.Wa(a,b).Ra;for(b=0;b<a.length;b++)for(var f=a[b].sa,g=0;g<f.length;g++)ja.PX(f[g].za,d,c)}function ea(a){var b=oa(a,W.vi);if(b){var c=b.p,d=a.Cj.k;a=ra.hc(d.n,qb);var f=nd;f[0]=0;f[1]=0;f[2]=-b.je[2]/2;b=ra.Xd(d.n,Bb);Ta.transformQuat(f,b,f);f[0]+=a[0];f[1]+=a[1];f[2]=0;Ac.identity(b);ka.pD(c,f,b)}}function C(a,b){ma.pa(a,function(c,d){if(d.type==W.zh){d.Za[0]&&d.mi[0]||La.q("Wrong MOTION_BLUR subscene");var f=d.Za[0],g=d.mi[0];d.mi[0]=d.p.wc;ma.Sk(a,c,function(b,c,d){d.Gc&&M(a,b,d.to,
g)});na(a,c,f.from,g);M(a,c,f.to,d.mi[0]);d.fK=Math.exp(-b/d.mb_factor)}})}function za(a){return a.s.zj}function ua(a,b){if(!a.s.ei)return null;for(var c=a.s.ei.Ji,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.s.ei.wA;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var ja=h("__batch"),xa=h("__boundings"),ka=h("__camera"),Pa=h("__config"),Ea=h("__container"),Ca=h("__debug"),ma=h("__graph"),Ba=h("__hud"),va=h("__input"),Ma=h("__mat4"),Ga=h("__nodemat"),Ra=h("__objects"),H=h("__obj_util"),V=h("__physics"),
Y=h("__prerender"),Cb=h("__primitives"),Ha=h("__print"),Ac=h("__quat"),Sa=h("__renderer"),fa=h("__scenegraph"),Da=h("__sfx"),qa=h("__shaders"),W=h("__subscene"),Qa=h("__textures"),ra=h("__tsr"),La=h("__util"),Ta=h("__vec3"),pb=h("__vec4"),Ua=h("__version"),Aa=Pa.B,ab=Pa.Gi,Ya=Pa.Vc,Ka=Pa.Eo,kb=[W.vi,W.cd,W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.xf,W.Oe,W.tf,W.ui,W.yf,W.Cg,W.wf];a.L1=kb;var eb=[W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.Bj,W.yt,W.Dg,W.xf,W.Oe,W.Ct,W.yf,W.cd,W.tf,W.ui,W.Cg],bb=[W.Pb,W.Kt,W.Pc,W.Uf,W.ge,
W.Nd,W.md,W.xf,W.Oe],sb=[W.cd,W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.xf,W.Oe,W.tf,W.ui,W.yf,W.Bj,W.Cg,W.wf],lb=[W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.xf,W.Oe],nb=null,wb=null,Va=[],Ob=null,ic=Math.PI/2,Wb=new Float32Array(2),qb=new Float32Array(3),nd=new Float32Array(3),Bb=new Float32Array(4),fb=new Float32Array(4),jc=new Float32Array(16),Nc=new Float32Array(24),Wc=new Float32Array(24),tc=xa.Qd(),Qc=xa.Qd(),Ib=0,ec=-Infinity;a.q3=function(){return{}};a.Pw=function(a){wb=a;Da.eY(a)};a.yX=function(a,b){var c=a.s,
d=fa.HS(c.Xa);if(a==b){pa(a,Ea.cJ(),Ea.bJ());for(var f=0;f<d.length;f++)a.s.Lm.push(d[f])}else for(f=a.Vf[0],pa(a,f.nj,f.nj),f=0;f<d.length;f++)b.s.Lm.push(d[f]);d=aa(a,sb);for(f=0;f<d.length;f++)d[f].zj.set(c.zj);for(f=0;f<c.Lm.length;f++)c.Lm[f].type==W.cd&&Sa.Mn(c.Lm[f])};a.Rh=function(){nb||(nb=p(Va));return nb};a.Ru=p;a.A=e;a.Da=function(){return wb?!0:!1};a.dm=function(a){return a.Cj};a.pr=function(){return Va};a.jB=function(){if(1==Va.length)return Va;for(var a=0;a<Va.length;a++){var b=Va[a].s.Xa;
ma.pa(b,function(b,c){for(var d=c.Ra,f=0;f<d.length;f++)for(var g=d[f].sa,e=0;e<g.length;e++){for(var l=g[e],m=l.za.ya,q=null,k=0;k<m.length;k++)if("SCENE"==m[k].source&&m[k].Is==Va[a].name&&c.type!=W.ay){Ha.error('Texture-scene loop detected. A scene is rendered to texture "'+m[k].name+'" yet this texture belongs to the same scene.');ma.gh(Ob,Va[a]);q=l.za;break}q&&(q.ya=[],q.Ld=[],ja.YZ(q,null),ja.Yc(q),W.Sc(c,l))}})}for(var c=[],a=0;a<Va.length;a++)if(b=Va[a],!b.Vf.length){b=ma.gh(Ob,b);ma.ST(Ob,
b);b=ma.nx(Ob,b,ma.mt);b=ma.RD(b);ma.pa(b,function(a,b){c.push(b)});break}return c};a.qQ=function(a,e,q,u,C){a.Vf=a.Vf||[];a.ra=null;var h=a.s,p=H.ka(a.Cj,a),t=a.Cj.k;h.mp=[];var E=a.world;h.gW=q.length;h.rj=r(q);h.ex=f(E,h.rj);h.pp=R(E,h.ex);h.IN=L(E);if(E=!a.Vf.length)a:{if("HMD"==Aa.stereo){if(p.da[0].type!=ka.Od){Ha.warn("Head-mounted display stereo is disabled for the non-perspective camera");Aa.stereo="NONE";E=!1;break a}if(!va.iu(va.xd)){Ha.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Aa.stereo="NONE";E=!1;break a}}E="HMD"==Aa.stereo}h.xv=E;if(E=!a.Vf.length)p.da[0].type!=ka.Od&&"ANAGLYPH"==Aa.stereo?(Ha.warn("Anaglyph stereo is disabled for the non-perspective camera"),Aa.stereo="NONE",E=!1):E="ANAGLYPH"==Aa.stereo;h.anaglyph_use=E;h.hQ=!h.xv&&!h.anaglyph_use&&g(a,C);h.ei=l(a,e,u);h.cR=c(a);h.RW=B(a);h.CR=Q(a);h.uV=K(a);h.eX=G(a);h.$j=D(a);h.dof=Aa.dof&&(0<t.dof_distance||t.dof_object);h.motion_blur=Aa.motion_blur&&a.b4w_enable_motion_blur;h.compositing=Aa.compositing&&a.b4w_enable_color_correction;
h.antialiasing=Aa.antialiasing&&1==Aa.Fc&&"NONE"!=a.b4w_antialiasing_quality;h.ssao=Aa.ssao&&a.b4w_enable_ssao;h.god_rays=Aa.god_rays&&a.b4w_enable_god_rays&&h.rj;h.yT=Aa.Hu;h.kv=a.b4w_glow_settings.render_glow_over_blend;h.oZ=v(a);C=n(u);h.aK=C;h.refractions=O(a,C);h.ud=b(a,q,u);h.Mc=w(u);h.vh=x(u);h.ZY=k(u);h.Kk=A(u);h.hd=I(a,u);h.fS=z(a,u);h.outline=d(a,u);h.Ui=m(a,u);switch(a.b4w_reflection_quality){case "LOW":h.Ki=Ka.pH;h.kh=Ka.EK;break;case "MEDIUM":h.Ki=Ka.rT;h.kh=Ka.qX;break;case "HIGH":h.Ki=
Ka.qT;h.kh=Ka.pX;break;default:h.Ki=Ka.pH,h.kh=Ka.EK}Ea.WV()?(Ha.log("%cENABLE HIDPI MODE","color: #00a"),h.xF="AA_QUALITY_LOW",h.Bo=1,Aa.Fc=1):1<Aa.Fc?(Ha.log("%cENABLE MSAA RENDERING: "+Aa.Fc+"x","color: #00a"),h.Bo=1):(h.xF="AA_QUALITY_"+a.b4w_antialiasing_quality,h.Bo="MEDIUM"===a.b4w_antialiasing_quality&&Aa.quality===Pa.qn||"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Pa.jl?1.33:"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Pa.qn||"NONE"===a.b4w_antialiasing_quality&&Aa.quality===Pa.qn?
2:1);q=a.Vf.sort(function(a,b){return b.nj-a.nj});h.Xa=fa.GS(h,p,t,q);h.Lm=[];h.hw=!1;h.jC=!1;h.kC=!1;h.zj=new Float32Array(3);Va.push(a);Ob||(Ob=ma.create());ma.J(Ob,a);for(h=0;h<e.length;h++)H.ZC(e[h],!0,a);a=Ea.Ce();Ea.resize(a.clientWidth,a.clientHeight,!0)};a.rQ=function(a,b,c){for(var d=0;d<b.length;d++){var f=b[d].s;f&&f.sm&&(f.ft=c,a.s.mp.push(b[d]))}};a.gB=function(a){return a.s.Xa};a.$H=function(a,b){ma.pa(b,function(c,d){var f=null;switch(d.type){case W.fc:f=ja.pA(d.zw);break;case W.Kt:f=
ja.MS(d);break;case W.fz:f=ja.NS(d);break;case W.AE:f=ja.sS();break;case W.Bj:fa.Db(b,d,W.sn)||fa.Db(b,d,W.wf)||fa.Db(b,d,W.Pc)||fa.Db(b,d,W.Bj);f=ja.wS(d.yK,d.yj,d.Wo);break;case W.yt:fa.Db(b,d,W.sn)||fa.Db(b,d,W.wf)||fa.Db(b,d,W.Pc);fa.Db(b,d,W.Bj);f=ja.xS();break;case W.zh:f=ja.BS();break;case W.Zx:f=ja.pS(d.PG);break;case W.wp:var f=ja.tS(d),g=d.p.dof_power;if(d.p.dof_bokeh){var g=g/2,e=fa.hB(b,d,W.fc);fa.Lc(e[0],g);fa.Lc(e[1],g);e[0]=fa.Db(b,e[0],W.fc);fa.Lc(e[0],g)}else{var e=fa.Db(b,d,W.fc),
l=fa.Db(b,e,W.fc);fa.Lc(e,g);fa.Lc(l,g)}break;case W.pn:var f=ja.CS(),g=fa.Db(b,d,W.fc),e=fa.Db(b,g,W.fc),l=fa.Db(b,e,W.fc),m=fa.Db(b,l,W.fc);fa.Lc(e,d.Az);fa.Lc(g,d.Az);fa.Lc(m,d.QA*d.$r);fa.Lc(l,d.QA*d.$r);break;case W.yp:f=ja.vS();break;case W.$x:f=ja.qS();break;case W.tE:f=ja.kS(d);break;case W.dz:case W.It:case W.Op:case W.Jt:f=ja.KS(d.type);break;case W.xi:f=ja.OS(d.Fb);break;case W.Dg:f=ja.rS(a,d);break;case W.LUMINANCE:f=ja.yS();break;case W.MN:f=ja.lS();break;case W.Ct:f=ja.zS();break;case W.rp:f=
ja.nS();break;case W.qp:f=fa.Db(b,d,W.rp);g=fa.Db(b,f,W.rp);fa.Lc(f,d.An);fa.Lc(g,d.An);f=ja.oS();break;case W.TP:f=ja.lT();break;case W.kn:f=ja.jS();break;case W.Kp:f=ja.DS()}f&&(g=W.Vh(f,H.Mq("NONE")),W.Sc(d,g),P(b,d,f),F(f))})};a.xn=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var d=a.s.Xa,f=b.k;!fa.gc(d,W.cd)&&f.fe&&(f.fe=!1);f=aa(a,kb);c&&b.an&&V.xn(b,a);for(var g=0;g<f.length;g++){var e=f[g],l=b,m=d,q=a,k=c;switch(e.type){case W.Pb:da(e,l,m,"OPAQUE",q,k);break;case W.Pc:da(e,
l,m,"BLEND",q,k);break;case W.Uf:da(e,l,m,"XRAY",q,k);break;case W.ge:da(e,l,m,"GLOW",q,k);break;case W.Nd:case W.md:N(e,l,m,!1,q,k);break;case W.xf:case W.Oe:N(e,l,m,!0,q,k);break;case W.yf:for(var u=H.ka(l,q).W,n=0;n<u.length;n++){var C=u[n];if("SHADOW"==C.type&&"RECEIVE"==C.Fb&&C.fe){if(!k&&(J(C,e,l,m,"SHADOW",q),!ja.Yc(C)))continue;var h=W.Vh(C,l.k);W.Sc(e,h);P(m,e,C);F(C)}}break;case W.cd:u=!1;n=l.k;l=H.ka(l,q).W;C=fa.gc(m,W.vi);for(h=0;h<l.length;h++){var p=l[h];if("SHADOW"==p.type&&"CAST"==
p.Fb){u=!0;if(!k){var t=e.lw;ja.jf(p,"NUM_LIGHTS",t);ja.jf(p,"NUM_LFACTORS",0==t%2?t/2:Math.floor(t/2)+1);qa.ia(p.ib,"SHADOW_USAGE","SHADOW_CASTING");p.hd&&C&&T(p,C,n);ja.jf(p,"SHADOW_TEX_RES",qa.N(q.s.ud.csm_resolution));if(!ja.Yc(p))continue}p=W.Vh(p,n);W.Sc(e,p)}}u&&(l=q.s.ud,k=fa.gc(m,W.Pb),ga(e,q,k.p,l,!0));break;case W.tf:E(e,l,m,q,k);break;case W.ui:E(e,l,m,q,k);break;case W.Cg:u=l.k;n=H.ka(l,q).W;for(C=0;C<n.length;C++)if(h=n[C],"COLOR_ID"==h.type&&"OUTLINE"==h.Fb){if(!k&&(J(h,e,l,m,"COLOR_ID",
q),ja.jf(h,"USE_OUTLINE",1),!ja.Yc(h)))continue;h=W.Vh(h,u);W.Sc(e,h)}break;case W.vi:m=l.k;l=H.ka(l,q).W;for(q=0;q<l.length;q++)if(u=l[q],"GRASS_MAP"==u.type){if(!k&&!ja.Yc(u))if("DEBUG"===Ua.type())ja.Xt(u,"error.glslv","error.glslf"),ja.Yc(u);else continue;u=W.Vh(u,m);W.Sc(e,u);u=e.p;p=m.Ua;n=e.je[0];C=e.je[1];h=e.je[2];0==n&&0==C?(n=p.min_z,C=p.max_z):(n=Math.min(n,p.min_z),C=Math.max(C,p.max_z));p=1E-4*(C-n);n-=p;C+=p;e.je[0]=n;e.je[1]=C;ka.Sw(u,h/2,-C,-n,h/2);ka.Ik(u)}break;case W.wf:for(u=
l.k,l=H.ka(l,q).W,q=0;q<l.length;q++)n=l[q],"DEBUG_VIEW"==n.type&&ca(e,u,m,k,n)}}break;case "LAMP":S(b,a),Ra.dZ(a)}H.ZC(b,!0,a)};a.dE=t;a.$C=function(a){a.s.hw=!0};a.v_=function(a,b){ma.pa(b,function(b,c){if(c.type===W.cd){var d=ra.hc(a.n,qb);ra.kf(d,c.p.n);ra.copy(a.qf,c.p.Fs)}})};a.N9=Z;a.RU=function(a,b){for(var c=a.s.ud,d=new Float32Array(c.csm_num),f=0;f<c.csm_num;f++)d[f]=ka.oT(c,b,f);return d};a.a2=ca;a.yG=ha;a.sq=q;a.FB=function(a){return a.k.Uh};a.IX=function(a){for(var b=0;b<a.I.length;b++)for(var c=
aa(a.I[b].yb,kb),b=0;b<c.length;b++)for(var d=c[b].Ra,f=0;f<d.length;f++)for(var g=d[f].sa,e=g.length-1;0<=e;e--){var l=g[e];l.ff==a.k&&(l.za&&ja.MG(l.za),g.splice(e,1))}};a.j_=function(a,b){for(var c=a.ub,d=H.ka(a,b).wm,f=aa(b,eb),g=0;g<f.length;g++){var e=f[g];e.Pr.set(c.Eq,4*d);e.Ba=!0}};a.gp=S;a.x_=function(a){a=a.I;for(var b=0;b<a.length;b++)t(a[b].yb)};a.ua=function(){for(var a=0;a<Va.length;a++){var b=Va[a];ma.pa(b.s.Xa,function(a,b){if(b.type!=W.tn){var c=b.p;Sa.JX(c.Ze,c.wc,c.Ve,c.width,
c.height);for(var c=b.Ra,d=0;d<c.length;d++)for(var f=c[d].sa,g=0;g<f.length;g++){var e=f[g].za;e&&ja.MG(e)}}});b.s.Xa=[];b.s.Lm=[]}wb=nb=null;Va.length=0;Ob=null};a.ZJ=function(a,b,c){a=ka.ZT(a,a.near,a.far,null,!0);var d=Cb.EU(a);a=H.Mq("DYNAMIC");a.Ua=a.R={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.lb=a.wa=xa.ZQ();var f=a.lb.Ya;a.qb=a.ba=xa.gq([f,0,0],[0,f,0],[0,0,f],a.lb.F);a.hp=!1;c=ja.JS(d,c);c=W.Vh(c,a);W.Sc(b,c)};a.z5=function(a){return[a.frame_start,a.frame_end]};
a.UL=function(a,b,c){Ea.SY(a,b,c);wb&&pa(wb,a,b)};a.Q8=pa;a.CD=aa;a.La=oa;a.tI=function(a){a=oa(a,W.Pb);var b=a.ke,c=a.te,d=[],f=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];f[0]=c[0];f[1]=c[1];f[2]=c[2];return[a.Sg,d,f]};a.Rw=function(a,b,c,d){a=aa(a,eb);for(var f=0;f<a.length;f++){var g=a[f];g.ke.set(c);g.te.set(d);g.Sg=b;g.Ba=!0}};a.UI=function(a){if(a=oa(a,W.Dg)){var b={};b.color=Array(3);Ta.copy(a.No,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.LL=function(a,b){var c=oa(a,W.Dg);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.No.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.Ba=!0,c.gw=!0,U(a,c))};a.ZU=function(a){return aa(a,bb)[0].dg[0]};a.XU=function(a){return aa(a,bb)[0].dg[1]};a.$U=function(a){return aa(a,bb)[0].dg[2]};
a.YU=function(a){return aa(a,bb)[0].dg[3]};a.zL=function(a,b){for(var c=aa(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[0]=b;f.Ba=!0}};a.xL=function(a,b){for(var c=aa(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[1]=b;f.Ba=!0}};a.AL=function(a,b){for(var c=aa(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[2]=b;f.Ba=!0}};a.yL=function(a,b){for(var c=aa(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[3]=b;f.Ba=!0}};a.wI=function(a,b){var c=b||[],d=aa(a,bb)[0].Be;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.eD=
function(a,b){for(var c=aa(a,bb),d=0;d<c.length;d++){var f=c[d];f.Be.set(b);f.Ba=!0}};a.WI=function(a){var b=oa(a,W.Kt);a=oa(a,W.fz);if(!b)return null;var c=b.Ra[0].sa[0].za,d={};d.ssao_quality=ja.bB(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.kG=a.ssao_blur_discard_value;d.radius_increase=b.So;d.influence=b.Ro;d.dist_factor=b.Qo;d.ssao_only=b.ssao_only;d.ssao_white=ja.bB(c,"SSAO_WHITE")[1];return d};a.NL=function(a,b){var c=oa(a,W.Kt),d=oa(a,W.fz);
if(!c)return Ha.error("SSAO is not enabled on the scene"),0;var f=c.Ra[0].sa[0],g=f.za;"string"==typeof b.ssao_quality&&(ja.jf(g,"SSAO_QUALITY",b.ssao_quality),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_hemisphere&&(ja.jf(g,"SSAO_HEMISPHERE",b.ssao_hemisphere),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_blur_depth&&(ja.jf(g,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_white&&(ja.jf(g,"SSAO_WHITE",b.ssao_white),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_blur_discard_value&&
(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.So&&(c.So=b.So);"number"==typeof b.Ro&&(c.Ro=b.Ro);"number"==typeof b.Qo&&(c.Qo=b.Qo);if("number"==typeof b.ssao_only){c=oa(a,W.Pb);c.ssao_only=b.ssao_only;for(var f=c.Ra,e=0;e<f.length;e++)for(var l=f[e].sa,m=0;m<l.length;m++)g=l[m].za,ja.jf(g,"SSAO_ONLY",b.ssao_only),ja.Yc(g),W.Sc(c,l[m])}c.Ba=!0;d.Ba=!0};a.rI=function(a){a=oa(a,W.wp);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=
a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.wL=ya;a.zI=function(a){var b=aa(a,[W.Bj]);a=oa(a,W.yt);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].ko;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ja.bB(b[0].Ra[0].sa[0].za,"STEPS_PER_PASS")[1];return c};a.CL=
function(a,b){var c=aa(a,[W.Bj]),d=oa(a,W.yt);if(!c||!d)return Ha.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var f=b.god_rays_max_ray_length,g=0;g<c.length;g++)c[g].ko=f,c[g].Gw=f/c[g].Wo/(g+1),c[g].Ba=!0;if("number"==typeof b.god_rays_steps)for(var e=qa.N(b.god_rays_steps,1),f=c[0].ko,g=0;g<c.length;g++){c[g].Wo=e;c[g].Gw=f/e/(g+1);c[g].Ba=!0;var l=c[g].Ra[0].sa[0],
m=l.za;ja.jf(m,"STEPS_PER_PASS",e);ja.Yc(m);W.Sc(c[g],l)}d.Ba=!0};a.lI=function(a){var b=oa(a,W.Ct);a=oa(a,W.qp);if(!b||!a)return null;var c={};c.key=b.eu;c.edge_lum=b.du;c.blur=a.An;return c};a.oL=wa;a.yI=function(a){a=oa(a,W.yp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.BL=la;a.hJ=function(a){var b=za(a);a=Ta.length(b);
if(0==a)return null;var b=La.oe(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};a.aY=function(a){a.s.jC=!0};a.eJ=ia;a.dJ=function(a,b){var c=a.s.Mc,d=oa(a,W.Pb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.ri&&(b.water_fog_density=d.ri[3],c=b.water_fog_color=[],c[0]=d.ri[0],c[1]=d.ri[1],c[2]=d.ri[2]))};a.SL=function(a,b){var c=a.s.Mc;if(!c)return Ha.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&
(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&
(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.ar=b.water_dynamic);for(var d=aa(a,lb),f=0;f<d.length;f++){var g=d[f];"number"==typeof b.water_fog_density&&c.Be&&(g.ri[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Be&&g.ri.set(b.water_fog_color);"number"==
typeof b.waves_height&&(g.mE=b.waves_height);"number"==typeof b.waves_length&&(g.nE=b.waves_length);g.Ba=!0}};a.TI=function(a,b,c){var d=a.s.Mc;if(!d.Lk)return 100;var f=d.XB;a=d.el;var g=(b[0]-d.Ko[0])/d.Lo[0],e=(d.Ko[1]+b[1])/d.Lo[1],g=g+.5,e=e+.5;if(1<g||0>g||1<e||0>e)b=1;else return d=f*La.jI(wb.s.tD,d.uD,g,e),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,b){for(var c=e().Cj.k,d=0;d<Va.length;d++){var f=Va[d],g=f.s.Xa,l=f.s;if(l.Mc)var m=ra.G(c.n),q=m[2]-ia(f,m[0],m[1]);for(m=0;m<l.mp.length;m++){var k=
l.mp[m].s,n=k.Ta,h=k.td;if(!(f.b4w_use_nla&&k.Xk||!n&&!h)&&Qa.DN(k)){var p=Qa.AN(k),t=Qa.CN(k);n&&Aa.is_mobile_device&&(t-=5);var E=Qa.Q_(k);p>=E&&k.vj||p<t?(Qa.eL(k),h&&(k.Fk=Qa.Ow(k,a))):p>=E&&!k.vj?Qa.xC(k):Qa.EN(k)&&(n?Qa.hN(k):(n=Qa.Ow(k,a),n!=k.Fk&&(Qa.gN(k),k.lj++),k.Fk=n))}}ma.pa(g,function(b,c){-1<sb.indexOf(c.type)&&(c.time=a);l.Mc&&(c.Nz=q)})}for(d=0;d<Va.length;d++)if(f=Va[d],l=f.s,g=l.Xa,c=l.Lm,c.length)for(l.hw&&(ba(f),l.hw=!1),l.jC&&(ea(f),l.jC=!1),l.kC&&(u(f),l.kC=!1),l.motion_blur&&
C(g,b),f=fa.gc(g,W.Cg),m=0;m<c.length;m++)g=c[m],Y.Aw(g),f&&ta(g,f),Sa.Mn(g);Aa.show_hud_debug_info&&Ba.WY(Va,b)};a.SX=function(a){a.s.kC=!0};a.ZA=function(a){var b=[];ma.pa(a.s.Xa,function(a,c){b.push(c)});return b};a.nI=function(){var a=oa(wb,W.Pc),b=wb;return a||b.s.Mc?a.Nz:null};a.fN=function(a){ma.pa(a.s.Xa,function(a,b){b.Ba=!0})};a.jY=function(a,b){a.debug_view_mode=b;a.cc=b!=Ca.qt;a.Lb=b==Ca.rt;a.Ba=!0;for(var c=e(),d=0;d<lb.length;d++){var f=oa(c,lb[d]);f&&(f.IA=b==Ca.xp)}};a.iY=function(a,
b){a.debug_colors_seed=b;a.Ba=!0};a.EY=function(a,b){a.vH=b;a.Ba=!0};a.PY=function(a,b){for(var c=a.Ra,d=0;d<c.length;d++)for(var f=c[d].sa,g=0;g<f.length;g++){var e=f[g].za;Ta.copy(b,e.wireframe_edge_color);e.Ba=!0}};a.bN=function(a,b){var c=b.Pn,d=a.s.zj;if(c&&"WIND"==c.type&&d){Ta.transformQuat(La.nc,ra.P(b.k.n),d);Ta.normalize(d,d);Ta.scale(d,c.vM,d);for(var c=aa(a,sb),f=0;f<c.length;f++)c[f].zj.set(d);return!0}return!1};a.kX=function(a,b,c){var d=oa(a,W.tf);if(d){var f=Ea.gm();ka.gY(d.p,b,c,
f.clientWidth,f.clientHeight);Y.Aw(d);d.cc&&Sa.Mn(d);if(a=oa(a,W.ui))Ma.copy(d.p.xb,a.p.xb),Ma.copy(d.p.ld,a.p.ld),La.On(a.p.ld,a.p.Ph),Y.Aw(a),a.cc&&Sa.Mn(a);if(d.cc||a&&a.cc)return Sa.LC(a?a.p.Ze:d.p.Ze,0,0)}else Ha.error("Object Selection is not available on the scene");return null};a.HL=function(a){var b=e();if(b=oa(b,W.pn))b.hj.set(a),b.Ba=!0};a.a6=za;a.bv=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.aN=function(a,
b){var c=qb;Ta.negate(b,c);for(var d=0;6>d;d++){var f=a.Ll[d],g=a.Pq[d],e=a.p;Ma.translate(La.$N[d],c,f);Ma.multiply(e.xb,f,e.ld);La.On(e.ld,g)}};a.dN=function(a,b,c){La.JZ(b,c,La.nc,a.p.rc)};a.PQ=function(a,b,c){var d=a.s.ud,f=a.s.ei;c=H.fv(c,Aa.ssao&&a.b4w_enable_ssao);if(f)for(var g=0;g<b.length;g++){var e=b[g],l=H.ka(e,a);if(-1!=e.k.Ed){var m=f.bi,q=f.yw,e=e.k.Ed;q.length?l.bi=q[e]:m.length&&(l.bi=m[e])}else-1!=e.k.Rd&&(m=f.Ji,q=f.wA,e=e.k.Rd,q.length?l.Ji=q[e]:m.length&&(l.Ji=m[e]))}for(g=0;g<
c.length;g++)if(l=H.ka(c[g],a),d)for(b=aa(a,[W.cd]),f=0;f<b.length;f++)g==b[f].ph&&l.sD.push(b[f])};a.$J=function(a,b){return a.timeline_markers[b]};a.Tw=function(a){var b=e();if(b=oa(b,W.xi))a.distortion_coefs&&(b.Pl[0]=a.distortion_coefs[0],b.Pl[1]=a.distortion_coefs[1],b.Ba=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],
b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Ba=!0),a.base_line_factor&&(b.Pl[2]=a.base_line_factor,b.Ba=!0),a.inter_lens_factor&&(b.Pl[3]=a.inter_lens_factor,b.Ba=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Ba=!0)};a.hK=function(b,c){for(var d=Va,f=0;f<d.length;f++)fa.XW(a.gB(d[f]),b,c)};a.TZ=function(a){for(var b=Ra.Ub(a,"LAMP",Ra.oc),c=aa(a,kb),d=0;d<c.length;d++)for(var f=c[d],g=f.Ra,e=0;e<g.length;e++)for(var l=g[e].sa,m=0;m<l.length;m++){var q=l[m],
k=q.za;"MAIN"==k.type&&(ja.XZ(k,b,a),ja.Yc(k),W.Sc(f,q))}};a.z7=function(a){for(var b=0;b<Va.length;b++)ma.pa(Va[b].s.Xa,function(b,c){for(var d=c.Ra,f=0;f<d.length;f++)for(var g=d[f].sa,e=0;e<g.length;e++){var l=g[e];l.za==a&&W.Sc(c,l)}})}};b4w.module.__hud=function(a,h){function p(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function e(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var c=0,f=0,e=0;k.pa(a.s.Xa,function(a,l){if(l.type!=w.tn){for(var k=Math.round(l.p.width)+"x"+Math.round(l.p.height),n=0,h=0;h<l.Ra.length;h++)n+=l.Ra[h].sa.length;h=l.Sq;if(l.type==w.md||l.type==w.Oe)n*=6;var p=l.cc,r=p?l.Cf:0;l.Ud||(l.Cf=0);var d=
p?" (\u2713)":" (\u2715)",m=w.DD(l);b(d,m,l.lw,k,h,"of",n,"  ",r.toFixed(3));l.Sq=0;p&&(c+=n,f+=h,e+=r)}});return[c,f,e]}b("No INFO")}function b(){for(var a=80+20*f[0],b=arguments[0],e=1;e<arguments.length;e++){for(var k="",h=0;h<n[e]-String(arguments[e]).length;h++)k+=" ";b+=k+arguments[e]}f[0]++;l.fillText(b,30,a)}function y(a,b,f){b*=a.uc;f.x=a.x+b;f.y=a.y;f.uc=a.uc-2*b;f.Ib=a.Ib}function r(a){return a.x+a.uc/2}function A(a){var b=l,f={x:0,y:0,uc:0,Ib:0},e=b.canvas.width,b=b.canvas.height;f.x=
0;f.y=0;f.uc=e;f.Ib=b;y(f,.01,f);e=.02*f.Ib;f.x=f.x;f.y+=e;f.uc=f.uc;f.Ib-=2*e;e=f.uc/8;f.x+=e*a;f.y=f.y;f.uc=e;f.Ib=f.Ib;y(f,.02,f);return f}var k=h("__graph");h("__print");var w=h("__subscene"),n=[5,30,4,10,5,3,5],l=null,f=[0,0];a.Xg=function(a){a=a.getContext("2d");p(a);return l=a};a.Rs=function(){l&&p(l)};a.reset=function(){var a=l;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),f[0]=0,f[1]=0)};a.WY=function(a,c){var k=
l;if(k){k.textAlign="left";k.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/c).toFixed(2));f[0]++;for(var n=k=0,h=0,p=0;p<a.length;p++){var r=e(a[p]),k=k+r[0],n=n+r[1],h=h+r[2];f[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",n,"of",k,"  ",h.toFixed(3))}};a.print=function(){var a=l;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.y7=function(a,b,f,e,k,n,h){var p=l;if(p){b=A(b);var w=b.Ib/5;b.x=b.x;b.y+=4*w;b.uc=
b.uc;b.Ib=w;p.textAlign="center";p.fillStyle="#00FF00";l.fillText(a,r(b),b.y-10);p.strokeStyle="#00FF00";p.lineWidth=.5;p.beginPath();p.moveTo(b.x,b.y);p.lineTo(b.x+b.uc,b.y);p.lineTo(b.x+b.uc,b.y+b.Ib);p.lineTo(b.x,b.y+b.Ib);p.closePath();p.stroke();if(!n&&!h)for(n=1E6,h=-1E6,a=0;a<f.length;a++)n=Math.min(n,f[a]),h=Math.max(h,f[a]);p.textAlign="right";l.fillText(String(n),b.x-10,b.y+b.Ib);l.fillText(String(h),b.x-10,b.y);p.textAlign="center";l.fillText(String(e),b.x,b.y+b.Ib+15);l.fillText(String(k),
b.x+b.uc,b.y+b.Ib+15);p.strokeStyle="#FF0000";p.lineWidth=1.5;p.beginPath();e=b.uc/(f.length-1);h=b.Ib/(h-n);for(a=0;a<f.length;a++)k=b.x+e*a,w=b.y+b.Ib-(f[a]-n)*h,0==a?p.moveTo(k,w):p.lineTo(k,w);p.stroke()}};a.F3=function(a,b,f,e,k,n,h){var p=l;if(p)for(p.textAlign="center",p.fillStyle="#00FF00",p.font="bold 12px Courier",f=A(f),l.fillText(b?"["+a+"]":a,r(f),f.y),0<=n&&l.fillText(n?"[M]":"[ ]",r(f)-15,f.y+30),0<=h&&l.fillText(h?"[S]":"[ ]",r(f)+15,f.y+30),a={x:0,y:0,uc:0,Ib:0},b=0;b<e.length;b++){n=
e[b];var w="VOLUME"==n[0];if(w){h=f.y+350;var I=f.uc,z=a;z.x=f.x;z.y=h;z.uc=I;z.Ib=250}else{h=f.y+50+50*b;var I=f.uc,z=f.Ib,d=a;d.x=f.x;d.y=h;d.uc=I;d.Ib=z}h=p;var I=a,d=b==k,m=n[0],z=n[1],O=n[2],x=n[3],g=(x-O)/n[4],g=1>g?Math.floor(1/g-1E-5).toFixed(0).length:0;n=n[5]?Math.log(z/O)/Math.log(x/O):(z-O)/(x-O);h.textAlign="center";d?h.fillText("["+m+"]",r(I),I.y):h.fillText(m,r(I),I.y);h.strokeStyle="#00FF00";h.lineWidth=w?3:1;w?(h.textAlign="right",h.fillText(x.toFixed(g),r(I)-10,I.y+15),h.textAlign=
"right",h.fillText(O.toFixed(g),r(I)-10,I.y+I.Ib-15)):(h.textAlign="right",h.fillText(O.toFixed(g),I.x+28,I.y+15),h.textAlign="left",h.fillText(x.toFixed(g),I.x+I.uc-28,I.y+15));h.beginPath();if(w){var P=I.y+15+(I.Ib-30)*(1-n);h.moveTo(r(I),I.y+15);h.lineTo(r(I),I.y+I.Ib-15);h.moveTo(r(I)-5,I.y+15);h.lineTo(r(I)+5,I.y+15);h.moveTo(r(I)-5,I.y+I.Ib-15);h.lineTo(r(I)+5,I.y+I.Ib-15);h.moveTo(r(I)-5,P);h.lineTo(r(I)+5,P)}else{var t=I.x+30+(I.uc-60)*n;h.moveTo(I.x+30,I.y+15);h.lineTo(I.x+I.uc-30,I.y+15);
h.moveTo(I.x+30,I.y+15-5);h.lineTo(I.x+30,I.y+15+5);h.moveTo(I.x+I.uc-30,I.y+15-5);h.lineTo(I.x+I.uc-30,I.y+15+5);h.moveTo(t,I.y+15-5);h.lineTo(t,I.y+15+5)}h.stroke();"EQ_Q"==m?(n=Math.log(1+1/(2*z*z)+Math.sqrt((2+1/(z*z))*(2+1/(z*z))/4-1))/Math.log(2),w?(h.textAlign="left",h.fillText(z.toFixed(g),r(I)+10,P),h.textAlign="left",h.fillText("("+n.toFixed(g+1)+")",r(I)+10,P+10)):(h.textAlign="right",h.fillText(z.toFixed(g),t,I.y+30),h.textAlign="left",h.fillText("("+n.toFixed(g+1)+")",t,I.y+30))):w?(h.textAlign=
"left",h.fillText(z.toFixed(g),r(I)+10,P)):(h.textAlign="center",h.fillText(z.toFixed(g),t,I.y+30))}}};b4w.module.__subscene=function(a,h){function p(a,b){a.lw=b;a.OB=new Float32Array(3*b);a.Qr=new Float32Array(4*b);a.Pr=new Float32Array(4*b)}function e(a){a={type:a,Fb:"",Lb:!1,yK:!1,vz:!1,gw:!1,Sq:0,Cf:0,Ml:[],debug_view_mode:0,debug_colors_seed:0,vH:1,IA:!1,time:0,p:null,Ll:null,Pq:[],Ra:[],Za:[],mi:[],zj:new Float32Array(3),je:new Float32Array(3),Be:new Float32Array(4),dg:new Float32Array(4),ye:new Float32Array(16),gx:0,Sg:0,lw:0,OB:null,Qr:null,Pr:null,Q6:null,ke:new Float32Array(3),te:new Float32Array(3),
hx:new Float32Array(4),AM:new Float32Array(3),ED:new Float32Array([0,0,1]),BM:new Float32Array(4),fx:new Float32Array(3),$r:0,KA:0,Fr:!1,hj:new Float32Array(3),yj:!1,Nz:0,ri:null,mE:0,nE:0,el:0,Mc:null,Kg:!1,uG:0,vG:new Float32Array(2),tG:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,No:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,So:0,Ro:0,Qo:0,pM:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,ko:0,Gw:0,Wo:0,vA:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Bx:null,Ax:null,hE:null,Gm:null,yc:!1,VH:"",eu:0,An:0,du:0,Az:0,QA:0,mb_decay_threshold:0,mb_factor:0,fK:0,zw:"",PG:"",bW:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,OD:new Float32Array(2),Gb:new Float32Array(2),
Pl:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,ph:0,iC:!0,eM:!1,jM:!1,fM:!1,gM:!1,iM:!1,hM:!1,dM:"",Zs:!1,$s:!1,at:!1,cc:!0,Ud:!0,wb:!0,Bb:!0,Sd:!0,Ba:!0,wg:1};a.Gb[0]=1;a.Gb[1]=1;a.Pl[2]=.5;a.Pl[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function y(a,f){return-b(a.Eg,f.Eg)||b(a.pg,f.pg)||b(a.zb.rD,f.zb.rD)}var r=h("__camera"),A=h("__config"),k=h("__util"),w=h("__boundings"),n=A.Vc;a.Pb=0;a.Pc=1;a.Uf=2;a.Nd=3;a.md=4;a.xf=5;a.Oe=6;a.ge=7;a.cd=
8;a.yf=9;a.vi=10;a.fc=11;a.rp=12;a.yp=13;a.sn=14;a.tf=15;a.ui=16;a.wf=17;a.kn=18;a.AE=19;a.Kt=20;a.fz=21;a.tE=22;a.Op=23;a.It=24;a.dz=25;a.Jt=26;a.$x=27;a.zh=28;a.Zx=29;a.wp=30;a.Cg=31;a.pn=32;a.Bj=33;a.yt=34;a.Dg=35;a.ay=36;a.xi=37;a.LUMINANCE=38;a.MN=39;a.Ct=40;a.qp=41;a.TP=42;a.tn=43;a.Kp=44;a.eT=function(a,b,n,c){var h=e(8);h.vA=a;h.self_shadow_polygon_offset=n.self_shadow_polygon_offset;h.ph=b;switch(n.ah[b]){case "SPOT":case "POINT":h.p=r.gd(r.Od);a=k.oe(n.oM[b]);r.Sw(h.p,a,n.wq[b],n.vq[b]);
break;default:h.p=r.gd(r.yi)}p(h,c);return h};a.eS=function(a){var b=a.p;a.p=null;var e=k.S(a);a.p=b;e.p=r.Hc(b,!0);return e};a.YS=function(){var a=e(10);a.p=r.gd(r.Bh);return a};a.Ad=function(a){var b=e(11);b.wb=!1;b.Bb=!1;b.Sd=!1;b.yc=!0;b.p=r.gd(r.pd);b.zw=a;switch(a){case "NONE":b.Gb[0]=1;b.Gb[1]=1;break;case "GRAYSCALE":b.Gb[0]=1;b.Gb[1]=1;break;case "X_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_BLUR":b.Gb[0]=0;b.Gb[1]=1;break;case "X_GLOW_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_GLOW_BLUR":b.Gb[0]=
0;b.Gb[1]=1;break;case "X_DOF_BLUR":b.Gb[0]=1;b.Gb[1]=1;break;case "Y_DOF_BLUR":b.Gb[0]=1;b.Gb[1]=1;break;case "X_ALPHA_BLUR":b.Gb[0]=1;b.Gb[1]=0;b.wg=3;break;case "Y_ALPHA_BLUR":b.Gb[0]=0;b.Gb[1]=1;b.wg=3;break;case "X_EXTEND":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_EXTEND":b.Gb[0]=0;b.Gb[1]=1;break;default:k.q("Wrong postprocessing effect: "+a)}return b};a.gH=function(a){var b=e(12);b.wb=!1;b.Bb=!1;b.Sd=!1;b.p=r.gd(r.pd);b.zw=a;b.yc=!0;switch(a){case "X_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_BLUR":b.Gb[0]=
0;b.Gb[1]=1;break;default:k.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.WS=function(a,b){var k=e(13);k.wb=!1;k.Bb=!1;k.Sd=!1;k.small_glow_mask_coeff=b.$j.small_glow_mask_coeff;k.large_glow_mask_coeff=b.$j.large_glow_mask_coeff;k.small_glow_mask_width=b.$j.small_glow_mask_width;k.large_glow_mask_width=b.$j.large_glow_mask_width;k.p=a;k.yc=!0;return k};a.Jl=function(a,b,n,c,h,r,w,y,D){var A=e(a);0==a?(A.wb=!0,A.Bb=n,A.Lb=!1):1==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):2==a?(A.wb=!1,A.Bb=!0,A.Lb=
!0):3==a||4==a?(A.wb=!0,A.Bb=!0,A.Lb=!1):5==a||6==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):7==a?(A.wb=!0,A.Bb=!1,A.Lb=!0):k.q("wrong main subscene type");A.Lb&&y&&(A.self_shadow_normal_offset=y.self_shadow_normal_offset);A.p=b;if(a=w.Oo)A.hx.set([a.hG,a.pJ,a.KN,a.JN]),A.fx.set(a.color),A.gx=a.Ea;A.ke.set(w.ke);A.te.set(w.te);A.Sg=w.Sg;A.Be=r.Be;A.dg=r.dg;c&&(A.Mc=c,c.Be&&(A.ri=new Float32Array(c.Be)),A.mE=c.waves_height,A.nE=c.waves_length,A.el=c.el,c.Kg&&D&&(A.Kg=!0,A.uG=c.AR,A.tG=c.zR,A.vG.set(c.BR)));p(A,h);
return A};a.xu=function(){var a=e(14);a.yc=!0;a.p=r.gd(r.pd);return a};a.hH=function(a,b,k){var c=e(15);b&&(c.type=16,c.wb=!1,c.Bb=!0);c.Ud=!1;c.p=a;p(c,k);return c};a.US=function(a){var b=e(17);b.cc=!1;b.wb=!1;b.Bb=!1;b.p=a;return b};a.QS=function(a){var b=e(18);b.wb=!0;b.Bb=!1;b.p=a;return b};a.fT=function(a,b){var k=e(9);k.p=a;p(k,b);return k};a.VS=function(a){var b=e(19);b.wb=!1;b.Bb=!1;b.p=a;b.yc=!0;return b};a.hT=function(a,b,k){var c=e(20);c.wb=!1;c.Bb=!1;c.Sd=!1;c.p=a;c.Be=b.Be;c.ri=new Float32Array(b.Be);
c.So=k.radius_increase;c.ssao_hemisphere=k.BV;c.Ro=k.influence;c.Qo=k.dist_factor;c.pM=k.$X;c.yc=!0;return c};a.iT=function(a,b){var k=e(21);k.wb=!1;k.Bb=!1;k.Sd=!1;k.p=a;k.ssao_blur_depth=b.dR;k.ssao_blur_discard_value=b.kG;k.yc=!0;return k};a.PS=function(a){var b=e(22);b.wb=!1;b.Bb=!1;b.Sd=!1;b.wg=1/a.Bo;b.VH=a.xF;b.p=r.gd(r.pd);b.yc=!0;return b};a.tA=function(a,b){var k=e(a);k.wb=23==a||24==a?!0:!1;k.Bb=!1;k.Sd=!1;k.wg=1/b.Bo;k.p=r.gd(r.pd);23==a&&(k.cW=new Float32Array(4));k.yc=!0;return k};a.TS=
function(a,b,k,c){var n=e(27);n.wb=!1;n.Bb=!1;n.Sd=!1;n.p=r.gd(r.pd);n.brightness=a;n.contrast=b;n.exposure=k;n.saturation=c;n.yc=!0;return n};a.aT=function(a,b){var k=e(28);k.wb=!1;k.Bb=!1;k.Sd=!1;k.p=r.gd(r.pd);k.vz=!0;k.mb_decay_threshold=a;k.mb_factor=b;k.yc=!0;return k};a.qA=function(a,b){var k=e(29);k.wb=!1;k.Bb=!1;k.Sd=!1;k.p=a;k.wg=k.p.dof_power;k.PG=b;k.yc=!0;return k};a.iH=function(a){var b=e(30);b.wb=!1;b.Bb=!1;b.Sd=!1;b.p=a;b.wg=b.p.dof_power;b.yc=!0;return b};a.cT=function(a,b){var k=
e(31);k.Sd=!1;k.p=a;p(k,b);return k};a.bT=function(a){var b=e(32);n.outlining_overview_mode?b.hj.set(n.hj):b.hj.set(a.hj);b.$r=a.$r;b.QA=5;b.Az=3;b.Sd=!1;b.p=r.gd(r.pd);b.yc=!0;return b};a.sA=function(a,b,k,c,n,h,r){var w=e(33);w.wb=!1;w.Bb=!1;w.Sd=!1;w.ke=new Float32Array([1,1,1]);w.te=new Float32Array([1,1,1]);w.Sg=1;w.yK=c;w.yj=b;w.Gw=n;w.ko=k;w.Wo=r;w.p=a;p(w,h);return w};a.XS=function(a,b){var k=e(34);k.wb=!1;k.Bb=!1;k.Sd=!1;k.p=r.gd(r.pd);k.god_rays_intensity=a;p(k,b);k.yc=!0;return k};a.gT=
function(a,b,n,c){var h=e(35);h.Ud=!1;h.wb=!1;h.Bb=!1;h.Sd=!1;var w=r.gd(r.pd);w.width=c;w.height=c;h.p=w;h.Ll=k.CU();p(h,b);h.ke=new Float32Array([1,1,1]);h.te=new Float32Array([1,1,1]);h.Sg=1;h.No.set(n.No);h.procedural_skydome=n.procedural_skydome;h.use_as_environment_lighting=n.use_as_environment_lighting;h.rayleigh_brightness=n.rayleigh_brightness;h.mie_brightness=n.mie_brightness;h.spot_brightness=n.spot_brightness;h.scatter_strength=n.scatter_strength;h.rayleigh_strength=n.rayleigh_strength;
h.mie_strength=n.mie_strength;h.rayleigh_collection_power=n.rayleigh_collection_power;h.mie_collection_power=n.mie_collection_power;h.mie_distribution=n.mie_distribution;if(a){h.ke.set(a.ke);h.te.set(a.te);h.Sg=a.Sg;if(b=a.Oo)h.hx.set([b.hG,b.pJ,b.KN,b.JN]),h.fx.set(b.color),h.gx=b.Ea,h.eM=b.invert,h.jM=b.pN,h.fM=b.kN,h.gM=b.lN,h.iM=b.nN,h.hM=b.mN,h.dM=b.iG;h.Zs=a.Zs;h.$s=a.$s;h.at=a.at}return h};a.rA=function(){var a=e(36);a.wb=!1;a.Bb=!1;a.p=r.gd(r.pd);a.yc=!0;return a};a.jT=function(a){var b=e(37);
b.wb=!1;b.Bb=!1;b.Fb=a?"HMD":"ANAGLYPH";b.p=r.gd(r.pd);b.yc=!0;return b};a.ZS=function(){var a=e(38);a.wb=!1;a.Bb=!1;a.p=r.gd(r.pd);a.yc=!0;return a};a.RS=function(){var a=e(39);a.wb=!1;a.Bb=!1;a.p=r.gd(r.pd);a.yc=!0;return a};a.$S=function(a,b,k,c){var n=e(40);n.wb=!1;n.Bb=!1;n.eu=a;n.du=b;n.p=c;p(n,k);n.yc=!0;return n};a.SS=function(a){var b=e(41);b.wb=!1;b.Bb=!1;b.p=r.gd(r.pd);b.An=a;b.yc=!0;return b};a.s3=function(a){var b=e(42);b.wb=!1;b.Bb=!1;b.p=a;b.yc=!0;return b};a.jH=function(){var a=e(43);
a.Ud=!1;return a};a.dT=function(){var a=e(44);a.yc=!0;return a};a.DD=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.zw.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Sc=function(a,b){for(var e=b.za,c=e.zb,k=0;k<a.Ra.length;k++){var n=a.Ra[k].sa,h=n.indexOf(b);
-1!=h&&(n.splice(h,1),n.length||a.Ra.splice(k,1))}k=a.Lb?e.pg:0;a:{n=a.Ra;for(h=0;h<n.length;h++){var p=n[h];if(p.zb==c&&k==p.pg){n=p;break a}}n=null}n?n.sa.push(b):(a.Ra.push({zb:c,sa:[b],Eg:e.Eg,pg:k,cc:!0}),a.iC=!0)};a.Vh=function(a,b){var e={cc:!0,JA:[!0,!0,!0,!0,!0,!0],ff:b,za:a,Dv:null};if(a.sf&&a.Ca.le){var c=a.Ca.le;e.Dv={SW:new Float32Array(c.length),TW:new Float32Array(c.length),ET:new Float32Array(c.length/3),LN:new Float32Array(3),YQ:w.pR(a.R)}}return e};a.cZ=function(a){a.Ra.sort(y);
a.iC=!1}};b4w.module.__input=function(a,h){function p(a){var b=T.Zf();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function e(a,b){if(!p(a))return null;var c={type:a,mh:!1,qg:[],hh:[],$i:[],be:[],aj:[],bj:[],Lr:[],MJ:[],Wi:[],uj:[],tj:[],sj:[],element:b,ci:!0,Xb:[],fw:new Float32Array(2),WW:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),op:null,si:null,Tf:null,orientation:ga.create(),position:E.create(),
Ni:new Float32Array(4),Oi:new Float32Array(4),Vi:0,Hj:0,Ck:0,hn:0,bk:0,Ij:0,Zl:[],Zj:[0,0,0,0,0,0,0,0,0,0,0,0],WH:[0,0,0,0,0,0,0,0,0,0,0,0],Wu:[]};c.Ni[0]=c.Ni[1]=c.Ni[2]=c.Ni[3]=45;c.Oi[0]=c.Oi[1]=c.Oi[2]=c.Oi[3]=45;30==a||40==a||50==a?(c.mh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.ci=!1)):10==a?c.mh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ha.is_mobile_device?r(c,q.webvr):(y(c),c.mh=!0));return c}function b(b,c){10==b||20==b?c=window:c||
(c=40==b?document:N.Ce());for(var d=0;d<la.length;d++)if(la[d].type==b&&la[d].element==c)return la[d];d=e(b,c);60!=b&&70!=b&&80!=b&&90!=b||d.Wu.push(a.vy,a.st,a.Cy,a.Jy,a.Ky,a.Ly,a.xt,a.Dp,a.My,a.Ny,a.wy,a.xy,a.tt,a.ut,a.vt,a.wt,a.yy,a.zy,a.Ay,a.By,a.Dy,a.Ey,a.Fy,a.Gy,a.Hy,a.Iy,a.zp,a.Ap,a.Bp,a.Cp,a.py,a.qy,a.ry,a.sy,a.ty,a.uy,a.ny,a.oy);d&&la.push(d);return d}function y(a){var b=q.nonwebvr;a.hn=b.hn;a.bk=b.bk;a.Ij=b.Ij;r(a,b);a.Vi=b.Vi;a.Hj=b.Hj;a.Ck=b.Ck;k(a)}function r(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function A(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function k(a){var b=a.Hj-a.Ij,c=a.bk-b,d=a.Vi/2,f=(a.hn-a.Vi)/2,b=Z.oe(Math.atan(b/a.Ck)),c=Z.oe(Math.atan(c/a.Ck)),d=Z.oe(Math.atan(d/
a.Ck)),f=Z.oe(Math.atan(f/a.Ck));c&&(a.Ni[0]=a.Oi[0]=Math.min(c,60));d&&(a.Ni[1]=a.Oi[3]=Math.min(d,60));b&&(a.Ni[2]=a.Oi[2]=Math.min(b,60));f&&(a.Ni[3]=a.Oi[1]=Math.min(f,60))}function w(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.op=d;a.si=c}function n(a,b,c){switch(a.type){case 20:var d=
a.Tf||a.op;d?(b=d.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,d=A(a,Math.tan(Z.Cb(b.downDegrees))),Z.oe(Math.atan(d)),d=A(a,Math.tan(Z.Cb(b.upDegrees))),Z.oe(Math.atan(d)),d=A(a,Math.tan(Z.Cb(b.leftDegrees))),Z.oe(Math.atan(d)),a=A(a,Math.tan(Z.Cb(b.rightDegrees))),Z.oe(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Ni:a.Oi,ca.copy(b,c));break;default:u.error("fov is undefined for device: ",a.type)}return c}
function l(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ha.is_mobile_device?1:0:2;case 23:var c=a.Tf||a.op;if(c){var d=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.Tf?c.offset[0]-d.offset[0]:c.eyeTranslation.x-d.eyeTranslation.x}return a.Vi}}function f(a,b){if(a.Tf){var c=a.Tf,d=c.capabilities,c=c.getPose();d.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],a.orientation[3]=
c.orientation[3]);d.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-sa&&(sa=b,navigator.getVRDisplays?a.Tf||navigator.getVRDisplays().then(function(b){0<b.length&&(a.Tf=b[0],a.mh=!0)},function(){u.O("WebVR displays are not found.");a.mh=!1}):navigator.getVRDevices?a.op||pa||navigator.getVRDevices().then(function(b){w(a,b);b.length&&(a.mh=!0);pa=!0},function(){u.O("WebVR devices are not found.");a.mh=!1;pa=!0}):ha.is_mobile_device||
u.O("HMD isn't supported."))}function v(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.Zl[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.Zj[c]=a.axes[c]}}function c(a){for(var b=0;b<a.Zl;b++)a.Zl[b]=0;for(b=0;b<a.Zj.length;b++)a.WH[b]=a.Zj[b],a.Zj[b]=0}function B(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function Q(a){return null===a}function K(a,b,c,f){switch(b){case 120:c&&B(a.qg,c);if(f||a.hh.every(Q)&&a.qg.every(Q))a.qg.length=0,a.hh.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("deviceorientation",D,!1));break;case 130:c&&B(a.hh,c);if(f||a.hh.every(Q)&&a.qg.every(Q))a.qg.length=0,a.hh.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;case 40:c&&B(a.$i,c);if(f||a.$i.every(Q))a.$i.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousedown",z,!1));break;case 30:c&&B(a.be,c);if(f||a.be.every(Q))a.be.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("mousemove",L,!1));break;case 31:c&&B(a.be,c);if(f||a.be.every(Q))a.be.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousemove",I,!1));break;case 50:c&&B(a.aj,c);if(f||a.aj.every(Q)){a.aj.length=0;b=a.Xb.indexOf(b);0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mouseout",d,!1),a.element.removeEventListener("mouseup",m,!1));break}break;case 60:c&&B(a.bj,c);if(f||a.bj.every(Q))a.bj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("wheel",O,!1));break;case 80:c&&B(a.Lr,c);if(f||a.Lr.every(Q))a.Lr.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keydown",x,!1));break;case 70:c&&B(a.Wi,c);if(f||a.Wi.every(Q))a.Wi.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keyup",g,!1));break;case 90:c&&B(a.uj,c);if(f||a.uj.every(Q))a.uj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchstart",P,!1));break;
case 100:c&&B(a.tj,c);if(f||a.tj.every(Q))a.tj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchmove",t,!1));break;case 110:if(c&&B(a.sj,c),f||a.sj.every(Q))a.sj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchend",da,!1))}}function G(a,b){Z.qC(a,Z.iz,b);var c="orientation"in window?Z.Cb(window.orientation):"orientation"in window.screen?Z.Cb(window.screen.orientation.angle):0,c=ga.setAxisAngle(Z.Nc,c,X);ga.multiply(b,c,b);
return b}function D(a){var c=U;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=Z.Cb(a.alpha),c[1]=Z.Cb(a.beta),c[2]=Z.Cb(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.hh.length;d++){var f=a.hh[d];f&&(E.copy(c,oa),f(oa))}if(a.qg.length)for(c=G(c,S),d=0;d<a.qg.length;d++)if(f=a.qg[d])ga.copy(c,ya),f(ya);for(d=0;d<a.qg.length;d++)a.qg[d]||a.qg.splice(d,1);for(d=0;d<a.hh.length;d++)a.hh[d]||a.hh.splice(d,1)}function R(a,b){switch(a.type){case 30:a.fw[0]=b.clientX,a.fw[1]=b.clientY,
a.WW=b.which}}function L(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);R(c,a);for(var d=0;d<c.be.length;d++){var f=c.be[d];f&&(aa[0]=a.clientX,aa[1]=a.clientY,f(aa))}c.ci&&a.preventDefault();for(d=0;d<c.be.length;d++)c.be[d]||c.be.splice(d,1)}}function I(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);R(c,a);for(var d=0;d<c.be.length;d++){var f=
c.be[d];if(f){if("number"==typeof a.movementX)var g=a.movementX,e=a.movementY;else"number"==typeof a.webkitMovementX?(g=a.webkitMovementX,e=a.webkitMovementY):"number"==typeof a.mozMovementX?(g=a.mozMovementX,e=a.mozMovementY):e=g=0;aa[0]=g;aa[1]=e;f(aa)}}c.ci&&a.preventDefault();for(d=0;d<c.be.length;d++)c.be[d]||c.be.splice(d,1)}}function z(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);R(c,a);for(var d=0;d<c.$i.length;d++){var f=
c.$i[d];f&&f(a.which)}c.ci&&a.preventDefault();for(d=0;d<c.$i.length;d++)c.$i[d]||c.$i.splice(d,1)}}function d(a){!N.BJ(a.relatedTarget)&&a.which&&m(a)}function m(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);R(c,a);for(var d=0;d<c.aj.length;d++){var f=c.aj[d];f&&f(a.which)}c.ci&&a.preventDefault();for(d=0;d<c.aj.length;d++)c.aj[d]||c.aj.splice(d,1)}}function O(a){for(var c=b(30,a.currentTarget),d=0;d<c.bj.length;d++){var f=
c.bj[d];f&&f(-a.deltaY)}c.ci&&a.preventDefault();for(d=0;d<c.bj.length;d++)c.bj[d]||c.bj.splice(d,1)}function x(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.MJ:c.Lr,f=0;f<d.length;f++){var g=d[f];g?g(a.keyCode):d.splice(f--,1)}c.ci&&a.preventDefault()}function g(a){for(var c=b(40,a.currentTarget),d=0;d<c.Wi.length;d++){var f=c.Wi[d];f&&f(a.keyCode)}c.ci&&a.preventDefault();for(d=0;d<c.Wi.length;d++)c.Wi[d]||c.Wi.splice(d,1)}function P(a){for(var c=b(50,a.currentTarget),d=
0;d<c.uj.length;d++){var f=c.uj[d];f&&f(a.targetTouches)}for(d=0;d<c.uj.length;d++)c.uj[d]||c.uj.splice(d,1)}function t(a){for(var c=b(50,a.currentTarget),d=0;d<c.tj.length;d++){var f=c.tj[d];f&&f(a.targetTouches)}c.ci&&a.preventDefault();for(d=0;d<c.tj.length;d++)c.tj[d]||c.tj.splice(d,1)}function da(a){for(var c=b(50,a.currentTarget),d=0;d<c.sj.length;d++){var f=c.sj[d];f&&f(a.targetTouches)}for(d=0;d<c.sj.length;d++)c.sj[d]||c.sj.splice(d,1)}function J(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function F(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}var T=h("__compat"),N=h("__container"),ba=h("__config"),u=h("__print"),ga=h("__quat"),Z=h("__util"),E=h("__vec3"),ca=h("__vec4"),ha=ba.B,q=ba.CV;a.yh=10;a.xd=20;a.ad=30;a.tp=40;a.Ag=50;a.nt=60;a.ey=70;a.fy=80;a.gy=90;a.Vy=0;a.CE=1;a.BE=2;a.Ep=3;a.hl=0;a.At=10;a.Bt=20;a.TN=21;a.UN=22;a.Ry=23;a.Qy=24;a.Oy=25;a.Ty=26;a.Uy=27;a.Sy=
28;a.Py=29;a.wi=30;a.LE=31;a.il=40;a.Ip=50;a.Jp=60;a.Gp=70;a.Fp=80;a.FE=81;a.ml=90;a.Pp=100;a.ll=110;a.zt=120;a.on=130;a.vy=300;a.st=301;a.Cy=302;a.Jy=303;a.Ky=304;a.Ly=305;a.xt=306;a.Dp=307;a.My=308;a.Ny=309;a.wy=310;a.xy=311;a.tt=312;a.ut=313;a.vt=314;a.wt=315;a.yy=316;a.zy=317;a.Ay=318;a.By=319;a.Dy=320;a.Ey=321;a.Fy=322;a.Gy=323;a.Hy=324;a.Iy=325;a.zp=326;a.Ap=327;a.Bp=328;a.Cp=329;a.py=330;a.qy=331;a.ry=332;a.sy=333;a.ty=334;a.uy=335;a.ny=336;a.oy=337;var S=ga.create(),X=ga.create(),U=E.create(),
sa=-Infinity,pa=!1,aa=new Float32Array(2);E.create();var oa=E.create(),ya=ga.create(),wa="ontouchstart"in document.documentElement,la=[];a.iu=p;a.ga=b;a.ID=function(a,b){a.ci=b};a.Jw=function(a){switch(a.type){case 20:if(a.mh)if(a.Tf)a.Tf.resetPose();else if(a.si)for(var b=0;b<a.si.length;b++)a.si[b].resetSensor();break;default:u.error("reset_device() is undefined for device: ",a.type)}};a.Ti=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:E.copy(Z.rn,c);if(a.Tf)c[0]=a.orientation[0],c[1]=
a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.si)for(b=0;b<a.si.length;b++){var d=a.si[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,c[2]=d.orientation.z,c[3]=d.orientation.w)}ga.normalize(c,c);a=ga.setAxisAngle(Z.ti,Math.PI/2,X);ga.multiply(a,c,c);break a;default:u.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:E.copy(Z.hz,c);if(a.Tf)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.si)for(b=0;b<a.si.length;b++)d=a.si[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);break a;default:u.error("position is undefined for device: ",a.type)}return c;case 21:return n(a,"left",c);case 22:return n(a,"right",c);case 30:case 31:return c[0]=a.fw[0],c[1]=a.fw[1],c}};a.im=l;a.aD=function(a,b,c){switch(a.type){case 20:if(3===l(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Vi=c;k(a);break;case 25:a.Hj=c;k(a);break;case 26:a.Ck=c;k(a);break;case 27:a.hn=c;k(a);break;case 28:a.bk=c;k(a);break;case 29:a.Ij=c,k(a)}break;case 60:case 70:case 80:case 90:a.Wu[b]=c}};a.eV=function(a,b){var c=b-300;return c<a.Zl.length?a.Zl[a.Wu[c]-300]:!1};a.dV=function(a,b){return b-326<a.Zj.length?a.Zj[a.Wu[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],d=0;d<la.length;d++){var g=la[d];switch(g.type){case 60:c(g);v(b[0],g);break;case 70:c(g);v(b[1],g);break;case 80:c(g);v(b[2],g);break;case 90:c(g);v(b[3],g);break;case 20:f(g,a)}}};a.yd=function(a,b,c){switch(b){case 120:a.qg.push(c);b=131;break;case 130:a.hh.push(c);b=131;break;case 40:a.$i.push(c);break;case 30:case 31:a.be.push(c);break;case 50:a.aj.push(c);break;case 60:a.bj.push(c);break;case 80:a.Lr.push(c);break;case 81:a.MJ.push(c);b=80;break;case 70:a.Wi.push(c);
break;case 90:a.uj.push(c);break;case 100:a.tj.push(c);break;case 110:a.sj.push(c)}if(-1==a.Xb.indexOf(b)&&(a.Xb.push(b),a.mh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",z,!1);break;case 30:a.element.addEventListener("mousemove",L,!1);break;case 31:a.element.addEventListener("mousemove",I,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",d,!1),a.element.addEventListener("mouseup",
m,!1));break;case 60:a.element.addEventListener("wheel",O,!1);break;case 80:a.element.addEventListener("keydown",x,!1);break;case 70:a.element.addEventListener("keyup",g,!1);break;case 90:a.element.addEventListener("touchstart",P,!1);break;case 100:a.element.addEventListener("touchmove",t,!1);break;case 110:a.element.addEventListener("touchend",da,!1);break;case 131:a.element.addEventListener("deviceorientation",D,!1)}};a.Bd=function(a,b,c){K(a,b,c,!1)};a.wV=G;a.ua=function(){for(var a=0;a<la.length;a++)for(var b=
la[a],c=0;c<b.Xb.length;c++)K(b,b.Xb[c],null,!0);la.length=0};a.JI=function(a){a=b(J(a));for(var c=0;c<a.Zl.length;c++)if(a.Zl[c])return c+300;return-1};a.CI=function(a){a=b(J(a));for(var c=0;c<a.Zj.length;c++)if(a.WH[c]-a.Zj[c])return c+326;return-1};a.vI=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.fJ=function(){var a=b(20);return a&&a.Tf};a.eQ=function(a){a.element.addEventListener("mousedown",
function(){a.value||F(a)},!1)}};b4w.module.__physics=function(a,h){function p(a,b){for(var c=a.Te,d=0;d<c.length;d++)c[d].jh.Us&&b.push(c[d]),p(c[d],b)}function e(a,b,c){for(var d=a.zc.sa,f=0;f<d.length;f++)for(var g=d[f].C,e=0;e<g.Se.length;e++){var m=g.Se[e];"ANY"!=m.bc&&c!=m.bc||R(m,a,b)}}function b(a,b,c){if(F.Gv(a))switch(b){case F.iO:var d=y(a);d.zc.HN=!0;F.ha(a,F.uP,Date.now()-performance.now(),X.max_fps,X.Iz?U.RH:0);break;case F.jO:N.ae("URANIUM:",c.slice(1));break;case F.eO:N.error(c);break;case F.fO:J.Qu.apply(this,c.slice(1));
break;case F.oO:var f=r(c.fa);if(f){a=c.trans;d=c.quat;b=c.Xh;var g=c.Eh,f=f.C;f.Bu=c.time;E.hi(a,1,d,f.Qq);ha.copy(b,f.Xh);ha.copy(g,f.Eh)}break;case F.lO:(a=r(c.Pz))&&E.hi(c.trans,1,c.quat,a.v.ms[c.GC]);break;case F.gO:if(d=r(c[1]))a=c[4],d=d.cg.fu[c[2]],Z.Wc(d,c[3]),Z.gi(d,a),Z.D(d);break;case F.pO:if(f=r(c[1]))f.v.speed=c[2];break;case F.aO:d=y(a);A(d,c.xl,c.yl,c.result,null,null,0);break;case F.cO:d=y(a);A(d,c.xl,c.yl,c.result,c.Fl,c.coll_norm,c.coll_dist);break;case F.bO:if(f=r(c[1]))a=f.C,
a.El&&a.El(c[2]);break;case F.EE:case F.mO:d=y(a);if(a=d.zc.yk[c.id])if(d=r(c.Bn),b==F.EE)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var g=c.hit_time,f=c.hit_pos,e=a.callback;f?e(a.id,b,d,g,f,c.hit_norm):e(a.id,b,d,g)}break;case F.nO:z(id);break;case F.kO:a=aa.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case F.hO:pa=c[1];break;case F.dO:a=
aa.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:N.error("Wrong message: "+b)}}function y(a){for(var b=0;b<aa.length;b++)if(aa[b]==a)return oa[b]}function r(a){return ya[a]||null}function A(a,b,c,d,f,g,e){a=a.zc.sa;for(var m=0;m<a.length;m++)for(var l=a[m].C,q=0;q<l.Se.length;q++){for(var n=l.Se[q],u=n.wk,h=!1,p=0;p<u.length;p++){var t=u[p];if(t[0]===b&&t[1]===c){n.as[p]=d;h=!0;break}}h&&(u=k(n),f&&n.Bz!=b&&(h=f,p=g,t=e,h[0]+=p[0]*t,h[1]+=p[1]*t,h[2]+=p[2]*t,p[0]*=
-1,p[1]*=-1,p[2]*=-1),n.callback(u,u?n.Bz==b?r(c):r(b):null,f,g,e))}}function k(a){a=a.as;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function w(){ia.body++;return ia.body}function n(a){var b=la.indexOf(a);return-1==b?(la.push(a),la.length-1):b}function l(a,b){return{fa:a,type:b,Zh:0,Jv:!1,Mk:!0,af:!1,ig:!1,UV:!1,ru:null,bc:"",Bq:0,i3:{},Se:[],El:null,Bu:0,Qq:new Float32Array([0,0,0,1,0,0,0,1]),Xh:new Float32Array(3),Eh:new Float32Array(3),hu:new Float32Array(3),oq:new Float32Array(4),Vr:null}}
function f(a,b){switch(a){case "BOX":var c=b.R;break;case "CYLINDER":c=b.fq;break;case "CONE":c=b.eq;break;case "SPHERE":c=b.wa;break;case "CAPSULE":c=b.dq}return c}function v(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.F&&(b.center=
a.F);"number"===typeof a.Ya&&(b.radius=a.Ya);"number"===typeof a.height&&(b.height=a.height);return b}function c(a,b,c,d,f){var g=E.G(a.k.n),e=E.invert(b.k.n,M),m=new Float32Array(3);E.Xc(g,e,m);switch(b.v.type){case 10:b=b.of;a=a.k.R;F.ha(f,F.YO,c,m,b.xZ,b.WC,(a.max_z-a.min_z)/2,d);break;case 20:F.ha(f,F.XO,c,m,a.l9)}}function B(a){return a.C&&a.C.ru}function Q(a,b,c,d,f,g,e,m,l,q){var k;ia.pc++;k=ia.pc.toString(16);var n=b.C.fa;F.ha(K(n),F.eP,k,a,m,n,c,d,f.C.fa,g,e,l,q);b.C.ru=k}function K(a){for(var b=
0;b<oa.length;b++)for(var c=oa[b].zc.sa,d=0;d<c.length;d++)if(c[d].C.fa==a)return aa[b];return null}function G(a){var b=a.C;if(b=b?0===b.Zh?!0:!0===b.Jv?!0:!1===b.Mk?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=E.hc(a.k.n,ta),c=E.Xd(a.k.n,na),b=b[0]!=a.C.hu[0]||b[1]!=a.C.hu[1]||b[2]!=a.C.hu[2]||c[0]!=a.C.oq[0]||c[1]!=a.C.oq[1]||c[2]!=a.C.oq[2]||c[3]!=a.C.oq[3];if(b){var b=a.C,d=a.k,c=F.DI(F.Dt);c.fa=b.fa;var f=E.hc(d.n,c.trans),d=E.Xd(d.n,c.quat);ha.copy(f,b.hu);ba.copy(d,b.oq);"DYNAMIC"==
b.type&&ba.identity(c.quat);F.ha(K(b.fa),F.Dt)}a=a.Te;for(b=0;b<a.length;b++)G(a[b])}function D(a,b,c,d,f){f=f||new Float32Array(3);a=E.P(a.k.n);f[0]=b;f[1]=c;f[2]=d;ha.transformQuat(f,a,f)}function R(a,b,c){var d=a.wk,f=a.as,g=a.Bz,e=[],m=a.bc;e||ca.q("At least one destination required");for(var l=0;l<b.zc.sa.length;l++){var q=b.zc.sa[l];if("ANY"==m||q.C.bc==m&&"NAVMESH"!=q.C.type)q=q.C.fa,e&&-1==e.indexOf(q)&&e.push(q)}for(b=0;b<e.length;b++)m=e[b],g<m&&!L(d,g,m)?(d.push([g,m]),f.push(!1)):g>m&&
!L(d,m,g)&&(d.push([m,g]),f.push(!1));F.ha(c,F.WO,g);F.ha(c,F.dP,d,a.Hh)}function L(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function I(a){a.C&&a.C.El&&(a=a.C,F.ha(K(a.fa),F.qP,a.fa),a.El=null)}function z(a){var b=m(a),c=d(a).zc;c.yk[a]&&(delete c.yk[a],c.KC.splice(c.KC.indexOf,1),F.ha(b,F.zP,a))}function d(a){for(var b=0;b<oa.length;b++){var c=oa[b];if(c.zc.yk[a])return c}return null}function m(a){for(var b=0;b<oa.length;b++)if(oa[b].zc.yk[a])return aa[b];return null}
function O(a,b,c){if(b.Vo){a=a.C.fa;var d=b.Nn*b.ir,f=b.mq*b.nq,g=-b.To*b.Uo*2*Math.PI/b.Ns;b.Er&&(g*=-1);switch(b.type){case 10:F.ha(c,F.MP,a,d,f,g);break;case 20:F.ha(c,F.LP,a,d,f,g)}}}function x(a){return a.af&&"CHASSIS"==a.of.gf}function g(a){return a.af&&"HULL"==a.of.gf}function P(a){return"NAVMESH"==a.jh.es}function t(a){return a.qm&&"MAIN_BODY"==a.Qn.gf}var da=h("__config"),J=h("__debug"),F=h("__ipc"),T=h("__obj_util"),N=h("__print"),ba=h("__quat"),u=h("__scenes"),ga=h("__subscene"),Z=h("__transform"),
E=h("__tsr"),ca=h("__util"),ha=h("__vec3"),q=h("__version"),S=h("__navmesh"),X=da.C,U=da.B,sa=da.Pd,pa=0,aa=[],oa=[],ya={},wa=[],la=["ANY"],ia={body:0,pc:0,WK:0},ta=new Float32Array(3);new Float32Array(4);var na=new Float32Array(4);new Float32Array(16);var M=E.create(),ea=E.create();a.LV=function(a){a.zc={HN:!1,sa:[],yk:{},KC:[]};var c=X.Ts;sa.prevent_caching&&(c+=q.timestamp());N.log("%cLOAD PHYSICS","color: #0a0",X.bt?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+X.max_fps);N.log("%cPHYSICS PATH",
"color: #0a0",c);var d=F.mT(c,!X.bt);F.SQ(d,b);aa.push(d);oa.push(a);X.ping&&setInterval(function(){F.ha(d,F.wP,performance.now())},1E3)};a.TR=function(a){return a.zc?a.zc.HN:!0};a.ua=function(){for(var a=0;a<aa.length;a++)F.terminate(aa[a]);aa.length=0;oa.length=0;ya={};wa.length=0;la.length=0;for(var b in ia)ia[b]=0};a.xn=function(a,b){a.k||ca.q("No object render: "+a.name);var d;a:{for(var m=0;m<oa.length;m++)if(oa[m]==b){d=aa[m];break a}d=void 0}var q=[];a.jh.Us&&p(a,q);var k=b.zc.sa;if(x(a)||
g(a)||a.ig||t(a)||a.an){var u=P(a),h;if(u){var r=a,Z=w(),z=l(Z,"NAVMESH"),U=T.ka(r,b).W;z.Vr=null;for(var I=0;I<U.length;I++){var ga=U[I];if("PHYSICS"==ga.type){z.Vr=S.YW(ga.Ca);break}}h=z}else{var ha=a,J=d,y=ha.k,X=ha.jh,D=X.es,K=w();if("CAMERA"==ha.type)var A=X.fE?X.pu:"BOX",L=f(A,y),ia=y.Yl,ta=y.Rl,ia=.5,ta=0;else if("EMPTY"==ha.type)A="EMPTY",L=null,ta=ia=0;else{var A=X.fE?X.pu:"BOX",L=f(A,y),la=E.Yd(y.n);if(1!=la){var G=L;switch(A){case "BOX":G.min_x*=la;G.max_x*=la;G.min_y*=la;G.max_y*=la;G.min_z*=
la;G.max_z*=la;break;case "CYLINDER":case "CONE":case "CAPSULE":G.height*=la;G.Ya*=la;break;case "SPHERE":G.Ya*=la}}ia=y.Yl;ta=y.Rl}var R=E.G(y.n),sa=E.P(y.n),pa=X.Ys,da=X.qN,pb=X.Zh,Ua=X.wN,Aa=X.vN,ab=X.tH,Ya=X.gL,Ka=ha.bc,kb=n(Ka),eb=X.Cq,bb=X.Aq,sb=X.Dq,lb=y.wa.Ya,nb=v(L),wb=ha.tu,Va;var Ob=A;if(q.length){var ic=[],Wb={};Wb.quat=new Float32Array([0,0,0,1]);Wb.trans=new Float32Array(3);Wb.worker_bounding=nb;Wb.bounding_type=Ob;ic.push(Wb);var qb=E.invert(y.n,M),nd=na;ba.invert(E.P(y.n),nd);for(var Bb=
0;Bb<q.length;Bb++){var fb={},jc=q[Bb],Nc=jc.jh.pu,Wc=new Float32Array(4),tc=new Float32Array(3),Qc=E.P(jc.k.n);E.Xc(E.G(jc.k.n),qb,tc);ba.multiply(nd,Qc,Wc);fb.trans=tc;fb.quat=Wc;fb.bounding_type=Nc;fb.worker_bounding=v(f(Nc,jc.k));ic.push(fb)}Va=ic}else Va=[];F.ha(J,F.aP,K,R,sa,D,pa,da,pb,Ua,Aa,ab,Ya,kb,eb,bb,sb,A,nb,lb,ia,ta,Va,wb);ya[K]=ha;wa.push(ha);var Ib=l(K,"BOUNDING");Ib.type=D;Ib.Zh=pb;Ib.Jv=pa;Ib.bc=Ka;Ib.Bq=kb;h=Ib}var ec=h;a.C=ec;var xb={za:null,C:ec};u||(k.push(xb),e(b,d,ec.bc))}else for(var Wa=
T.ka(a,b).W,Fa=0;Fa<Wa.length;Fa++){var yb=Wa[Fa],Rc;if(Rc="PHYSICS"==yb.type){var Xb;a:{for(var Bc=b.zc.sa,dd=0;dd<Bc.length;dd++){var uc=Bc[dd].za;if(uc&&uc.id==yb.id){Xb=!0;break a}}Xb=!1}Rc=!Xb}if(Rc)if(yb.Of.Ja)if(yb.yj&&b.s.Mc){var Zb=yb,Xc=b,ed=d,$b=Xc.s.Mc;F.ha(ed,F.jP,$b.el);if(Zb.X_){var cb={};cb.dst_noise_scale0=Zb.dst_noise_scale0;cb.dst_noise_scale1=Zb.dst_noise_scale1;cb.dst_noise_freq0=Zb.dst_noise_freq0;cb.dst_noise_freq1=Zb.dst_noise_freq1;cb.dir_min_shore_fac=Zb.dir_min_shore_fac;
cb.dir_freq=Zb.dir_freq;cb.dir_noise_scale=Zb.dir_noise_scale;cb.dir_noise_freq=Zb.dir_noise_freq;cb.dir_min_noise_fac=Zb.dir_min_noise_fac;cb.dst_min_fac=Zb.dst_min_fac;cb.waves_hor_fac=Zb.waves_hor_fac;var vd=$b.waves_height,Fc=$b.waves_length;$b.Lk?F.ha(ed,F.YE,cb,$b.Lo[0],$b.Lo[1],$b.Ko[0],$b.Ko[1],$b.XB,vd,Fc,$b.uD,Xc.s.tD):F.ha(ed,F.YE,cb,0,0,0,0,0,vd,Fc,0,null)}}else{var ib;if(yb.Ys){var od=a,Cc=yb,kc=d,Qb=w(),Pb=Cc.Of,lc=Pb.aa[0].a_position,Gc=Pb.na||null,Jb=Cc.bc,mc=n(Jb);F.ha(kc,F.gP,Qb,
lc,Gc,E.G(od.k.n),mc,Cc.Cq,Cc.Aq,Cc.Dq);var rb=l(Qb,"STATIC_MESH");rb.Jv=!0;rb.bc=Jb;rb.Bq=mc;ib=rb}else{var db=a,ac=yb,Yc=d,Db=w(),Rb=ac.Of,gb=Rb.aa[0].a_position,ob=Rb.na||null,Hc=E.G(db.k.n),nc=ac.Yl,Ic=ac.Rl,Kb=ac.bc,oc=n(Kb);F.ha(Yc,F.iP,Db,gb,ob,Hc,nc,Ic,oc,ac.Cq,ac.Aq,ac.Dq);var bc=l(Db,"STATIC_MESH");bc.bc=Kb;bc.Bq=oc;ib=bc}ec=ib;a.C=ec;xb={za:yb,C:ec};k.push(xb);e(b,d,ec.bc)}else N.error("Object "+a.name+" has collision material with no assigned vertices")}if(x(a)||g(a)){var Za=a,cc=d,Lb=
Za.C.fa;x(Za)?(Za.v.type=10,F.ha(cc,F.bP,Lb,Za.v.FD,Za.v.HD,Za.v.GD,Za.v.qE,Za.v.YB)):g(Za)&&(Za.v.type=20,F.ha(cc,F.$O,Lb,Za.v.Vl,Za.v.fn,Za.v.gn));if(Za.v.Km){var tb=Za.v.Km;switch(Za.v.type){case 10:c(tb[0],Za,Lb,!0,cc);c(tb[1],Za,Lb,!0,cc);c(tb[2],Za,Lb,!1,cc);c(tb[3],Za,Lb,!1,cc);break;case 20:for(var pc=0;pc<tb.length;pc++)c(tb[pc],Za,Lb,!1,cc)}}O(a,a.v,d)}else if(a.ig){var ub=d,Mb=a.k,Sb=a.C,vc=Mb.R.max_z-Mb.R.min_z,Jc=Sb.fa,Ia=a.AG,fc=Ia.W_,Eb=Ia.ZX,Fb=Ia.qZ,Dc=Ia.eW,Tb=Ia.Y_,jb=ca.CT(a);
F.ha(ub,F.cP,Jc,jb,vc,fc,Eb,Fb,Dc,Tb);Sb.ig=!0}else if(t(a)){var hb=a,Ja=d,Yb=hb.C.fa;F.ha(Ja,F.fP,Yb,hb.cg.Vl,hb.cg.fn,hb.cg.gn);if(hb.cg.fu)for(var Gb=hb.cg.fu,Na=0;Na<Gb.length;Na++){var Oa=Gb[Na],mb=E.G(Oa.k.n),Oc=E.invert(hb.k.n,M),Kc=new Float32Array(3);E.Xc(mb,Oc,Kc);F.ha(Ja,F.ZO,Yb,Kc,Oa.lG)}hb.C.UV=!0}for(Fa=0;Fa<wa.length;Fa++)if(a=wa[Fa],a.C){var vb=a;if(!B(vb))for(var Ec=0;Ec<vb.AC.length;Ec++){var Ub=vb.AC[Ec],dc=Ub.target,fd=Ub.lX;if(dc.C){var Zc=new Float32Array([Ub.mX,Ub.nX,Ub.oX]),
Sc,$c=new Float32Array([Ub.Ga,Ub.Ha,Ub.Ia]);Sc=ca.Wj($c,new Float32Array(4));var zb=E.identity(M),zb=E.kf(Zc,zb),zb=E.Jk(Sc,zb),Ab=E.multiply(vb.k.n,zb,M),wc=E.invert(dc.k.n,ea),gd=E.multiply(wc,Ab,wc),Xa=Ub,$a={};$a.use_limit_x=Xa.I_;$a.use_limit_y=Xa.J_;$a.use_limit_z=Xa.K_;$a.use_angular_limit_x=Xa.E_;$a.use_angular_limit_y=Xa.F_;$a.use_angular_limit_z=Xa.G_;$a.limit_max_x=Xa.oW;$a.limit_min_x=Xa.rW;$a.limit_max_y=Xa.pW;$a.limit_min_y=Xa.sW;$a.limit_max_z=Xa.qW;$a.limit_min_z=Xa.tW;$a.limit_angle_max_x=
Xa.iW;$a.limit_angle_min_x=Xa.lW;$a.limit_angle_max_y=Xa.jW;$a.limit_angle_min_y=Xa.mW;$a.limit_angle_max_z=Xa.kW;$a.limit_angle_min_z=Xa.nW;Q(fd,vb,Zc,Sc,dc,E.G(gd),E.P(gd),$a,null,null)}}}};a.kU=r;a.update=function(a,b){for(var c=0;c<aa.length;c++){var d=aa[c],f=a;d&&F.FJ(d)&&F.ha(d,F.NP,f,b);for(var g=0;g<wa.length;g++){var e=wa[g],m=e.C;if(m.Mk&&m.Bu){var l=F.FJ(d)?f-m.Bu:performance.now()/1E3-m.Bu,l=Math.min(l,10/X.max_fps),l=l-1/X.max_fps;U.ZW&&(l=0);var q=M;E.NV(m.Qq,l,m.Xh,m.Eh,M);Z.mj(e,
q);Z.D(e);G(e);if(e.v)for(var m=e,l=m.v.Km,q=m.k.n,k=M,n=0;n<l.length;n++){var h=l[n];E.multiply(q,m.v.ms[n],k);Z.mj(h,k);Z.D(h)}e.v&&e.v.Vo&&(k=e,l=k.v,m=l.Vo)&&(n=k.v.rM,E.multiply(k.k.n,k.v.sM,m.k.n),q=ta,E.wd(n,k.k.n,q),k=na,ba.setAxisAngle(q,-l.To*l.Uo*2*Math.PI,k),l=E.P(m.k.n),ba.multiply(k,l,l),Z.D(m));e.v&&e.v.yD&&(k=e,l=k.v,m=l.yD)&&(n=k.v.mM,E.multiply(k.k.n,k.v.nM,m.k.n),q=ta,E.wd(n,k.k.n,q),k=na,n=Math.abs(l.speed)*l.Ls,n>l.lo&&(n=l.lo),ba.setAxisAngle(q,-n,k),l=E.P(m.k.n),ba.multiply(k,
l,l),ba.normalize(l,l),Z.D(m));e.v&&e.v.JD&&(q=e,m=q.v,e=m.JD)&&(k=q.v.DM,E.multiply(q.k.n,q.v.EM,e.k.n),l=ta,E.wd(k,q.k.n,l),q=na,ba.setAxisAngle(l,-Math.abs(m.Nn)*m.Uq,q),m=E.P(e.k.n),ba.multiply(q,m,m),ba.normalize(m,m),Z.D(e))}}F.vX(d);d=oa[c];(f=d.s.Mc)&&0<f.waves_height&&(d=u.La(d,ga.Pb),f=ha.length(d.zj)||1,F.ha(aa[c],F.KP,d.time*f))}};a.KU=function(){return oa[0]};a.pause=function(){for(var a=0;a<aa.length;a++)F.ha(aa[a],F.vP)};a.jj=function(){for(var a=0;a<aa.length;a++)F.ha(aa[a],F.AP)};
a.HH=function(a){(a=a.C)||ca.q("No object physics");if(!a.Mk){var b=a.fa,c=K(b);a.Mk=!0;F.ha(c,F.tP,b)}};a.HA=function(a){(a=a.C)||ca.q("No object physics");if(a.Mk){var b=a.fa,c=K(b);a.Mk=!1;F.ha(c,F.sP,b)}};a.Lw=function(a){return Boolean(a.zc)};a.oa=function(a){return Boolean(a.C)};a.lJ=function(a){return(a=a.C)&&a.Mk&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Zh&&0==a.Jv?!0:!1};a.sB=function(a){return(a=a.C)&&a.Mk?!0:!1};a.DL=function(a,b){var c=a.C.fa;F.ha(K(c),F.JP,c,b)};a.yV=B;a.KF=Q;
a.NG=function(a){a=a.C;F.ha(K(body_a),F.yP,a.ru);a.ru=null};a.PK=function(b,c,d,f,g,e){c=E.hi(c,1,d,M);g=E.hi(g,1,e,ea);E.invert(c,c);E.multiply(g,c,c);Z.vr(f,g);E.multiply(g,c,c);Z.mj(b,c);Z.D(b);a.Es(b,E.G(b.k.n),E.P(b.k.n))};a.Es=function(a,b,c){var d=a.C,f=F.DI(F.Dt),g=E.hc(a.k.n,f.trans);a=E.Xd(a.k.n,f.quat);E.hi(g,1,a,d.Qq);f.fa=d.fa;ha.copy(b,f.trans);ba.copy(c,f.quat);F.ha(K(d.fa),F.Dt)};a.H=G;a.OF=function(a,b,c,d){var f=ta;D(a,b,c,d,f);a=a.C.fa;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);
var g=Math.abs(f[0]),e=Math.abs(f[1]),m=Math.abs(f[2]);f[0]=g?f[0]/g*Math.max(g,b):0;f[1]=e?f[1]/e*Math.max(e,c):0;f[2]=m?f[2]/m*Math.max(m,d):0;F.ha(K(a),F.$E,a,f[0],f[1],f[2])};a.PF=function(a,b,c,d){a=a.C.fa;F.ha(K(a),F.$E,a,b,c,d)};a.uz=function(a,b,c,d,f){var g=ta;f?(g[0]=b,g[1]=c,g[2]=d):D(a,b,c,d,g);a=a.C.fa;F.ha(K(a),F.kP,a,g[0],g[1],g[2])};a.NF=function(a,b,c,d){var f=ta;D(a,b,c,d,f);a=a.C.fa;F.ha(K(a),F.mP,a,f[0],f[1],f[2])};a.Pm=function(a,b,c){a=a.C.fa;F.ha(K(a),F.DP,a,b,c)};a.Gk=function(a,
b){var c=a.C.fa;F.ha(K(c),F.EP,c,b)};a.uL=function(a,b){var c=a.C.fa;F.ha(K(c),F.IP,c,b)};a.tL=function(a,b){var c=a.C.fa;F.ha(K(c),F.GP,c,b)};a.qL=function(a,b){var c=a.C.fa;F.ha(K(c),F.BP,c,b)};a.Oz=function(a){a=a.C.fa;F.ha(K(a),F.oP,a)};a.zG=function(a,b,c){a=a.C.fa;F.ha(K(a),F.pP,a,b,c)};a.Hk=function(a,b,c){a=a.C.fa;F.ha(K(a),F.FP,a,b,c)};a.rL=function(a,b){var c=a.C.fa;F.ha(K(c),F.CP,c,b)};a.sL=function(a,b){var c=a.C.fa;F.ha(K(c),F.HP,c,b)};a.rz=function(a,b,c,d){var f=a.C;if(!f.Vr){for(var g=
f.fa,e=0;e<f.Se.length;e++)if(a=f.Se[e],a.bc==b&&a.callback==c)return;a={Bz:g,Hh:d||!1,bc:b,callback:c,wk:[],as:[]};f.Se.push(a);b=K(g);R(a,y(b),b)}};a.OC=function(a,b,c){a=a.C;for(var d=K(a.fa),f=y(d),g=0;g<a.Se.length;g++){var e=a.Se[g];if(e.bc==b&&e.callback==c){if(k(e)){var m=ha.set(0,0,0,ta);e.callback(!1,null,m,m,0)}a.Se.splice(g,1);g--;for(var m=d,e=e.wk,l=f.zc.sa,q=0;q<l.length;q++)for(var n=l[q].C,u=0;u<n.Se.length;u++)for(var h=n.Se[u],p=0;p<h.wk.length;p++)for(var t=h.wk[p],E=0;E<e.length;E++){var r=
e[E];t[0]==r[0]&&t[1]==r[1]&&(e.splice(E,1),E--)}e.length&&F.ha(m,F.ZE,e)}}};a.tz=function(a,b){a.C&&a.C.El&&I(a);var c=a.C;F.ha(K(c.fa),F.lP,c.fa);c.El=b};a.Tz=I;a.Vt=function(a,b,c,d,f,g,e,m,l){var q;ia.WK++;q=ia.WK;a={id:q,fa:a?a.C.fa:0,from:new Float32Array(b),to:new Float32Array(c),bc:d,Bq:n(d),VF:g,lR:e,Hh:m,Av:l,callback:f};b=K(a.fa)||aa[0];c=y(b).zc;q=a.id;c.yk[q]=a;c.KC.push(a);F.ha(b,F.hP,a.id,a.fa,a.from,a.to,a.Bq,a.VF,a.lR,a.Hh,a.Av);return q};a.PC=z;a.xG=function(a,b,c){var f=m(a),g=
d(a).zc.yk[a];g&&!g.VF&&(g.from.set(b),g.to.set(c),F.ha(f,F.nP,a,b,c))};a.GJ=function(a){return d(a).zc.yk[a]?!0:!1};a.kp=function(a,b){var c=a.v;c.Nn=b;O(a,c,K(a.C.fa))};a.jp=function(a,b){var c=a.v;c.To=b;O(a,c,K(a.C.fa))};a.iE=function(a,b){var c=a.v;c.mq=b;O(a,c,K(a.C.fa))};a.bf=x;a.cf=g;a.M6=P;a.RV=function(a){if(!a.af)return!1;a=a.of.gf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.QV=function(a){return a.af?"BOB"==a.of.gf?!0:!1:!1};
a.VV=function(a){return a.qm?"BOB"==a.Qn.gf?!0:!1:!1};a.IJ=function(a){return a.af&&"STEERING_WHEEL"==a.of.gf?!0:!1};a.HJ=function(a){return a.af&&"SPEEDOMETER"==a.of.gf?!0:!1};a.JJ=function(a){return a.af&&"TACHOMETER"==a.of.gf?!0:!1};a.aJ=function(a){return a.v.speed};a.$_=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.ig=function(a){return a.ig};a.G6=t;a.bV=function(){return pa};a.wT=
function(){for(var a=0;a<aa.length;a++)F.ha(aa[a],F.rP)};a.ts=function(a){if("BOUNDING"==a.C.type){var b=wa.indexOf(a);-1==b&&N.error("Object "+a.name+" doesn't have bounding physics");delete ya[c];wa.splice(b,1)}for(var c=a.C.fa,b=K(c),d=y(b),f=c,g=d.zc.sa,e=[],m=0;m<g.length;m++)for(var l=g[m].C,q=0;q<l.Se.length;q++)for(var n=l.Se[q],u=0;u<n.wk.length;u++){var h=n.wk[u],p=n.as[u];if(h[0]==f||h[1]==f)n.wk.splice(u,1),n.as.splice(u,1),u--,p&&!k(n)&&(p=ha.set(0,0,0,ta),n.callback(!1,null,p,p,0)),
e.push(h)}e.length&&F.ha(b,F.ZE,e);a.C&&a.C.El&&I(a);a=d.zc.sa;for(d=0;d<a.length;d++)a[d].C.fa==c&&(a.splice(d,1),d--);F.ha(b,F.xP,c)}};b4w.module.__ipc=function(a,h){function p(a,b,c){for(var e=0;e<v.length;e+=2)v[e+1]==a&&(f[e+Number(!b)]=c)}function e(a){for(var b=0;b<a.length;b++){var c=a[b],f=0,e;for(e in c){var l=c[e];switch(l.constructor){case Float32Array:f+=l.length;break;case Number:f+=1}}--f;c.len=f}}var b=!0;a.iO=0;var y=a.aO=1,r=a.cO=2;a.bO=3;a.eO=4;a.fO=5;a.gO=6;a.jO=7;var A=a.lO=8,k=a.EE=9,w=a.mO=10;a.nO=11;var n=a.oO=12;a.pO=13;a.kO=14;a.hO=15;a.dO=16;a.uP=100;a.WO=101;a.XO=102;a.YO=103;a.ZO=104;a.aP=105;a.$O=106;
a.bP=107;a.cP=108;a.dP=109;a.eP=110;a.fP=111;a.gP=112;a.iP=113;a.jP=114;a.xP=115;a.kP=116;a.lP=117;a.mP=118;a.oP=119;a.pP=120;a.qP=121;a.sP=122;a.tP=123;a.vP=124;a.hP=125;a.zP=126;a.nP=127;a.ZE=128;a.yP=129;a.AP=130;a.BP=131;a.CP=132;a.DP=133;a.EP=134;a.FP=135;a.GP=136;a.HP=137;a.IP=138;a.JP=139;a.$E=140;var l=a.Dt=141;a.KP=142;a.YE=143;a.LP=144;a.MP=145;a.wP=146;a.rP=147;a.NP=148;var f=b4w.worker_listeners,v=b4w.worker_namespaces,c={Kf:n,fa:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Xh:new Float32Array(3),Eh:new Float32Array(3),len:0},B={Kf:A,Pz:0,GC:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},Q={Kf:k,id:0,Bn:0,hit_fract:0,hit_time:0,len:0},K={Kf:w,id:0,Bn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},G={Kf:y,xl:0,yl:0,result:0,len:0},D={Kf:r,xl:0,yl:0,result:0,Fl:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},R={Kf:l,fa:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},L=[c,B,Q,K,G,D,
R];a.mT=function(a,c){var d={Kv:a?!0:!1,fl:null,Gh:[],bg:""};if(c)if(d.fl={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");p(d.bg,d.Kv,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");p(d.bg,d.Kv,null)},postMessage:function(a){var b;a:{for(b=0;b<v.length;b+=2)if(v[b+1]==d.bg){b=f[b+Number(!!d.Kv)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<v.length;a+=2)if(v[a+1]==d.bg){f.splice(a,2);v.splice(a,2);break}}},d.Kv){var e=
h("__util"),l=h("__container"),k=b4w.get_namespace(h),e=e.Qs(k+"_worker");v.push(k);v.push(e);f.push(null);f.push(null);d.bg=e;(l=l.mU(a))?b?l.addEventListener("load",function(){b4w.require("__bindings",d.bg)},!1):(b4w.ua("__bindings",d.bg),b4w.ua("__ipc",d.bg),b4w.require("__bindings",d.bg)):(l=document.createElement("script"),l.src=a,l.defer="defer",l.async="async",l.addEventListener("load",function(){b=!1;b4w.require("__bindings",d.bg)},!1),document.head.appendChild(l))}else d.bg=b4w.get_namespace(h);
else d.fl=a?new Worker(a):self;return d};a.SQ=function(a,b){function d(f){if(f.constructor==ArrayBuffer)f=new Float32Array(f);else if(f[0].constructor==ArrayBuffer){for(var e=0;e<f.length;e++)d(f[e]);return}e=f[0]|0;switch(e){case n:var h=c;h.fa=f[1]|0;h.time=f[2];h.trans[0]=f[3];h.trans[1]=f[4];h.trans[2]=f[5];h.quat[0]=f[6];h.quat[1]=f[7];h.quat[2]=f[8];h.quat[3]=f[9];h.Xh[0]=f[10];h.Xh[1]=f[11];h.Xh[2]=f[12];h.Eh[0]=f[13];h.Eh[1]=f[14];h.Eh[2]=f[15];break;case A:h=B;h.Pz=f[1]|0;h.GC=f[2]|0;h.trans[0]=
f[3];h.trans[1]=f[4];h.trans[2]=f[5];h.quat[0]=f[6];h.quat[1]=f[7];h.quat[2]=f[8];h.quat[3]=f[9];break;case k:h=Q;h.id=f[1]|0;h.Bn=f[2]|0;h.hit_fract=f[3];h.hit_time=f[4];break;case w:h=K;h.id=f[1]|0;h.Bn=f[2]|0;h.hit_fract=f[3];h.hit_time=f[4];h.hit_pos[0]=f[5];h.hit_pos[1]=f[6];h.hit_pos[2]=f[7];h.hit_norm[0]=f[8];h.hit_norm[1]=f[9];h.hit_norm[2]=f[10];break;case y:h=G;h.xl=f[1]|0;h.yl=f[2]|0;h.result=!!f[3];break;case r:h=D;h.xl=f[1]|0;h.yl=f[2]|0;h.result=!!f[3];h.Fl[0]=f[4];h.Fl[1]=f[5];h.Fl[2]=
f[6];h.coll_norm[0]=f[7];h.coll_norm[1]=f[8];h.coll_norm[2]=f[9];h.coll_dist=f[10];break;case l:h=R;h.fa=f[1]|0;h.trans[0]=f[2];h.trans[1]=f[3];h.trans[2]=f[4];h.quat[0]=f[5];h.quat[1]=f[6];h.quat[2]=f[7];h.quat[3]=f[8];break;default:h=f}b(a,e,h)}e(L);a.fl.addEventListener("message",function(a){d(a.data)},!1)};a.ua=function(){};a.ha=function(a,b){if(a)switch(b){case n:var d=c,f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.fa;f[2]=d.time;f[3]=d.trans[0];f[4]=d.trans[1];f[5]=d.trans[2];f[6]=d.quat[0];f[7]=
d.quat[1];f[8]=d.quat[2];f[9]=d.quat[3];f[10]=d.Xh[0];f[11]=d.Xh[1];f[12]=d.Xh[2];f[13]=d.Eh[0];f[14]=d.Eh[1];f[15]=d.Eh[2];a.Gh.push(f.buffer);break;case A:d=B;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.Pz;f[2]=d.GC;f[3]=d.trans[0];f[4]=d.trans[1];f[5]=d.trans[2];f[6]=d.quat[0];f[7]=d.quat[1];f[8]=d.quat[2];f[9]=d.quat[3];a.Gh.push(f.buffer);break;case k:d=Q;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.id;f[2]=d.Bn;f[3]=d.hit_fract;f[4]=d.hit_time;a.Gh.push(f.buffer);break;case w:d=K;f=new Float32Array(d.len);
f[0]=d.Kf;f[1]=d.id;f[2]=d.Bn;f[3]=d.hit_fract;f[4]=d.hit_time;f[5]=d.hit_pos[0];f[6]=d.hit_pos[1];f[7]=d.hit_pos[2];f[8]=d.hit_norm[0];f[9]=d.hit_norm[1];f[10]=d.hit_norm[2];a.Gh.push(f.buffer);break;case y:d=G;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.xl;f[2]=d.yl;f[3]=d.result;a.Gh.push(f.buffer);break;case r:d=D;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.xl;f[2]=d.yl;f[3]=d.result;f[4]=d.Fl[0];f[5]=d.Fl[1];f[6]=d.Fl[2];f[7]=d.coll_norm[0];f[8]=d.coll_norm[1];f[9]=d.coll_norm[2];f[10]=d.coll_dist;
a.Gh.push(f.buffer);break;case l:d=R;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.fa;f[2]=d.trans[0];f[3]=d.trans[1];f[4]=d.trans[2];f[5]=d.quat[0];f[6]=d.quat[1];f[7]=d.quat[2];f[8]=d.quat[3];a.Gh.push(f.buffer);break;default:f=[];for(d=1;d<arguments.length;d++)f.push(arguments[d]);a.fl.postMessage(f)}};a.vX=function(a){a&&a.Gh.length&&(a.fl.postMessage(a.Gh),a.Gh.length=0)};a.DI=function(a){switch(a){case n:return c;case A:return B;case k:return Q;case w:return K;case y:return G;case r:return D;case l:return R;
default:return null}};a.terminate=function(a){a.fl.terminate();a.fl=null};a.Gv=function(a){return!!a.fl};a.FJ=function(a){return!!a.bg}};b4w.module.__transform=function(a,h){function p(a,b){f.gg(a)?G.kf(b,f.fg(a)):G.kf(b,a.k.n)}function e(a,b){var c=a.k;if(f.gg(a)){G.Jk(b,c.n);var e=f.$u(a),e=G.invert(e,d);G.multiply(e,c.n,f.fg(a))}else G.Jk(b,c.n)}function b(a,b){f.gg(a)?G.Jk(b,f.fg(a)):G.Jk(b,a.k.n)}function y(a,b){G.Xd(a.k.n,b);return b}function r(a,b){f.gg(a)?G.Xd(f.fg(a),b):G.Xd(a.k.n,b);return b}function A(a,b){f.gg(a)?G.copy(b,f.fg(a)):G.copy(b,a.k.n)}function k(a,b){f.gg(a)?G.copy(f.fg(a),b):G.copy(a.k.n,b);return b}function w(a){var b=
a.k,e=a.I,m=a.type;"CAMERA"==m&&l.cE(a);f.h_(a,O);"CAMERA"==m&&l.f_(a);var k=G.hc(b.n,L),h=G.Xd(b.n,z);n.Al(b.R,b.n,b.Ua);n.lq(b.wa,b.n,b.lb);if(b.hp)for(var p=0;p<e.length;p++)for(var r=e[p].W,I=0;I<r.length;I++){var u=r[I];n.Al(u.R,b.n,u.Ua);n.lq(u.wa,b.n,u.lb);u.Sf&&n.kq(u.ba,b.n,u.qb)}else b.Sf&&n.kq(b.ba,b.n,b.qb);switch(m){case "MESH":a.lK&&G.invert(a.k.n,a.k.Qx);if(r=a.Yt)G.invert(r.k.n,d),G.multiply(d,b.n,d),G.rV(d,b.$p),G.Xd(d,b.Zp);b.jr=!0;break;case "CAMERA":for(p=0;p<e.length;p++)l.g_(a,
e[p]);break;case "SPEAKER":K.gZ(a,O,x);break;case "LAMP":v.k_(a)}for(p=0;p<e.length;p++)if(I=e[p],I.Gv){r=I.yb;u=r.s;switch(m){case "MESH":b.He&&Q.$C(r);u=I.Ji;null!=b.Rd&&u&&Q.aN(u,k);break;case "EMPTY":c.i_(a);break;case "CAMERA":Q.aY(r);if(u.ud){u.ud.enable_csm&&Q.$C(r);var ga=B.ka(a,r).da[0];Q.v_(ga,u.Xa)}Q.A()==r&&Q.dm(r)==a&&K.vW(r,k,h,O,x);break;case "LAMP":Q.gp(a,r)}u=I.bi;ga=a.ss;if(ga.length)for(I=0;I<u.length;I++){var Z=u[I].p;Q.dN(u[I],k,h);B.eN(ga,Z.rc);l.NY(Z,Q.dm(r));D.On(Z.ld,Z.Ph)}}b=
a.Te;for(p=0;p<b.length;p++)w(b[p]);a=a.$z;for(p=0;p<a.length;p++)b=a[p],r=b[0],f.$Z(r,b[1])}var n=h("__boundings"),l=h("__camera"),f=h("__constraints"),v=h("__lights"),c=h("__objects"),B=h("__obj_util"),Q=h("__scenes"),K=h("__sfx"),G=h("__tsr"),D=h("__util"),R=h("__vec3"),L=new Float32Array(3),I=new Float32Array(3),z=new Float32Array(4);new Float32Array(9);var d=G.create(),m=G.create(),O=0,x=0;a.iF=0;a.un=1;a.update=function(a){O=a;x++};a.Wc=function(a,b){var c=a.k;if(f.gg(a)){G.kf(b,c.n);var e=
f.$u(a),e=G.invert(e,d);G.multiply(e,c.n,f.fg(a))}else G.kf(b,c.n)};a.Yw=p;a.ie=function(a,b){G.hc(a.k.n,b);return b};a.ZI=function(a,b){f.gg(a)?G.hc(f.fg(a),b):G.hc(a.k.n,b);return b};a.gi=e;a.Xw=b;a.Sh=y;a.NI=r;a.Ww=function(a,b){var c=D.Wj(b,z);e(a,c)};a.lD=function(a,c){var d=D.Wj(c,z);b(a,d)};a.LI=function(a,b){y(a,z);return b=D.Fw(euler,b)};a.MI=function(a,b){r(a,z);return b=D.Fw(euler,b)};a.Mf=function(a,b){var c=a.k;if(f.gg(a)){var c=f.fg(a),d=G.Yd(f.$u(a));G.Mf(b/d,c)}else G.Mf(b,c.n)};a.nD=
function(a,b){var c=a.k;f.gg(a)?G.Mf(b,f.fg(a)):G.Mf(b,c.n)};a.Yd=function(a){return G.Yd(a.k.n)};a.QI=function(a){return f.gg(a)?G.Yd(f.fg(a)):G.Yd(a.k.n)};a.mj=function(a,b){G.copy(b,a.k.n);if(f.gg(a)){var c=f.$u(a),c=G.invert(c,d);G.multiply(c,a.k.n,f.fg(a))}};a.Zw=A;a.vr=function(a,b){return G.copy(a.k.n,b)};a.wr=k;a.dv=function(a){var b=a.k;a=b.vl;var c=G.Yd(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.cv=function(a,b,c){b?(a=a.k,R.copy(a.lb.F,
c)):(a=a.k,b=a.vl,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,G.Xc(c,a.n,c));return c};a.fh=function(a,b,c,f){var e=k(a,d),l=L;l[0]=b;l[1]=c;l[2]=f;G.Xc(l,e,l);p(a,l)};a.XC=function(a,b){var c=k(a,d),f=G.Jk(b,G.identity(m));G.multiply(c,f,f);A(a,f)};a.D=w;a.distance=function(a,b){var c=G.hc(a.k.n,L),d=G.hc(b.k.n,I);return R.dist(c,d)};a.ro=function(a,b){var c=G.hc(a.k.n,L);return R.dist(c,b)};a.GI=function(a){return{max_x:a.k.Ua.max_x,min_x:a.k.Ua.min_x,max_y:a.k.Ua.max_y,
min_y:a.k.Ua.min_y,max_z:a.k.Ua.max_z,min_z:a.k.Ua.min_z}}};b4w.module.__sfx=function(a,h){function p(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return D.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function e(a,c,d){var f=a.X;if("NONE"!=f.behavior){var e=f.loop,g=f.pitch;if(f.src&&(e||0<=d)){f.wz=Math.floor(5E4*Math.random());var l=J.currentTime+c,l=
Math.max(0,l);f.lf=l;f.state=20;var m=F.Rc;"POSITIONAL"==f.behavior&&"none"==m.Yq&&(f.behavior="BACKGROUND_SOUND");b(a,F.Rc);if("POSITIONAL"==f.behavior||"BACKGROUND_SOUND"==f.behavior){c=J.createBufferSource();c.buffer=f.src;c.playbackRate.value=g;if(e){f.dc&&f.dc.disconnect();f.Kd&&f.Kd.disconnect();c.loop=!0;c.loopStart=f.YJ;if(c.loopEnd=f.Vv)d=J.createBufferSource(),d.buffer=f.src,d.playbackRate.value=g,f.Kd=d,d.connect(f.Fd);c.start(l);f.duration=0}else e=c.buffer?c.buffer.duration:0,d>e?(e=
l+d+f.Ff,c.loop=!0,c.start(l),c.stop(e),f.duration=d):(c.loop=!1,c.start(l),f.duration=e);c.connect(f.Fd);f.dc=c;r(f);A(f);k(f)}else"BACKGROUND_MUSIC"==f.behavior&&(L.nu(f.xz),L.nu(f.yz),d=function(){var b=a.X,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.dc=b.dc||J.createMediaElementSource(c),b.dc.connect(b.Fd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():f.xz=L.QL(d,1E3*c),f.duration=e?0:K(a));w(f,l)}}}function b(a,b){var c=a.X;if(!c.Fd){var f=I.G(a.k.n),e=I.P(a.k.n);if(O.cw){var g=
J.createBiquadFilter();g.type="peaking"}else g=null;var l=J.createGain();switch(c.behavior){case "POSITIONAL":var m=J.createPanner();"string"!=typeof m.panningModel?(m.panningModel=m.EQUALPOWER,m.distanceModel=m.INVERSE_DISTANCE):(m.panningModel="equalpower",m.distanceModel=b.Yq);m.setPosition(f[0],f[1],f[2]);d.copy(f,c.JB);f=x;z.lc(e,z.Nc,f);m.setOrientation(f[0],f[1],f[2]);m.refDistance=c.Xq;m.maxDistance=c.Qg;m.rolloffFactor=c.bq;m.coneInnerAngle=c.TG;m.coneOuterAngle=c.UG;m.coneOuterGain=c.VG;
var k=J.createGain();k.gain.value=Q(c);g?(m.connect(g),g.connect(k)):m.connect(k);k.connect(l);c.Fd=m;if(c.en){var n=J.createGain();l.connect(n);n.connect(b.Fd)}else n=null,l.connect(b.Fd);break;case "BACKGROUND_SOUND":m=null;k=J.createGain();k.gain.value=Q(c);g?(c.Fd=g,g.connect(k)):c.Fd=k;k.connect(l);c.en?(n=J.createGain(),l.connect(n),n.connect(b.Fd)):(n=null,l.connect(b.Fd));break;case "BACKGROUND_MUSIC":n=m=null,k=J.createGain(),k.gain.value=Q(c),g?(c.Fd=g,g.connect(k)):c.Fd=k,k.connect(l),
l.connect(b.Fd)}c.vC=m;c.Ug=g;c.Un=k;c.Xj=l;c.JC=n}}function y(a){var b=a.X,c=b.duration,b=b.zH+b.AH*Math.random();e(a,b,c)}function r(a){var b=a.Kd||a.dc;z.Wh(b.onended)&&(b.onended=function(){a.state=50})}function A(a){a.en&&a.JC.gain.cancelScheduledValues(a.lf);a.wo&&(a.dc.playbackRate.cancelScheduledValues(a.lf),a.Kd&&a.Kd.playbackRate.cancelScheduledValues(a.lf));a.et=a.lf}function k(a){if(a.en||a.wo){var b=a.JC,c=a.dc,d=c.buffer?c.buffer.duration:0;if(d){var f=a.lf;N[0]=a.wz;for(var e=0;5>e;){var g=
a.pitch+a.wo*z.tg(N);if(f>=a.et){if(a.en){var l=1-z.U(a.en,0,1)*Math.random();b.gain.setValueAtTime(l,f)}a.wo&&(c.playbackRate.setValueAtTime(g,f),a.Kd&&a.Kd.playbackRate.setValueAtTime(g,f));e++}f+=d/g}a.et=f-.001}}}function w(a,b){if(a.Ul||a.Ff){var c=a.Xj;c.gain.cancelScheduledValues(b);a.Ul?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Ul)):c.gain.setValueAtTime(1,b);a.Ff&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Ff))}}
function n(a){"SPEAKER"!=a.type&&z.q("Wrong object type");var b=a.X;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Xj,d=J.currentTime;b.Ff&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Ff));"BACKGROUND_MUSIC"==b.behavior?b.src&&(L.nu(b.xz),L.nu(b.yz),b.yz=L.QL(function(){var b=a.X.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Ff)):(c=b.dc,b.duration<c.buffer.duration?b.Ff&&20==b.state?c.stop(d+b.Ff):20==b.state&&(c.stop(0),c.disconnect()):
c.disconnect(),b.lf=0,b.wC=0,b.Hz=0);b.state=30}}function l(a){a=a.X;if(20==a.state){var b=J.currentTime;a.wC=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.Hz=b>a.lf?f(a,b):0,a.dc.onended=function(){},a.dc.stop(0),a.dc.disconnect(),A(a));a.state=40}}function f(a,b){N[0]=a.wz;for(var c=a.dc.buffer.duration,d=a.lf,f;d<b;)f=a.pitch+a.wo*z.tg(N),d+=c/f;return(c/f-(d-b))*f}function v(a){var b=a.X;if(40==b.state){var c=J.currentTime;b.lf+=c-b.wC;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();
else{a=a.X;var d=J.createBufferSource();d.loop=a.dc.loop;d.loopStart=a.dc.loopStart;d.loopEnd=a.dc.loopEnd;d.buffer=a.dc.buffer;d.playbackRate.value=a.dc.playbackRate.value;d.connect(a.Fd);a.dc=d;a.Kd&&(d=J.createBufferSource(),d.loop=a.Kd.loop,d.buffer=a.Kd.buffer,d.playbackRate.value=a.Kd.playbackRate.value,d.connect(a.Fd),a.Kd=d);b.et=c;c=b.dc;r(b);c.start(b.lf,b.Hz);k(b)}w(b,b.lf);b.state=20}}function c(a,b,c){var f=1,f=b.GT;if(0<f){var e=b.hZ;if(0!=d.dot(a.Ex,a.Ex)||0!=d.dot(b.xm,b.xm)){var g=
d.subtract(a.JB,b.Yh,x),l=d.length(g);b=d.dot(g,b.xm)/l;g=d.dot(g,a.Ex)/l;g=-g;l=e/f;b=Math.min(-b,l);g=Math.min(g,l);f=(e-f*b)/(e-f*g);isFinite(f)||(f=0);f=Math.min(f,16);f=Math.max(f,.125);f=z.mc(f,a.RJ,c,.3);a.dc.playbackRate.value=f;a.RJ=f}}}function B(a){a=a.X;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function Q(a){return a.muted?0:a.volume}function K(a){a=a.X;return(a=a.src)?a.duration:0}var G=h("__config"),D=h("__print"),R=h("__quat"),L=h("__time"),I=h("__tsr"),z=h("__util"),
d=h("__vec3"),m=G.B,O=G.X,x=new Float32Array(3),g=new Float32Array(3);new Float32Array(3);var P=R.create(),t=[],da=[],J=null,F=null,T=[],N=[1],ba=null;a.xE=10;a.Sx=20;a.wE=30;a.IS=function(){return{wj:-1,Tg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,bq:1,Xq:1,Qg:1E4,TG:360,UG:360,VG:1,autoplay:!1,ze:!1,loop:!1,YJ:0,Vv:0,zH:0,AH:0,en:0,wo:0,Ul:0,Ff:0,lf:0,wC:0,Hz:0,duration:0,et:0,wz:1,src:null,state:10,JB:new Float32Array(3),Ex:new Float32Array(3),Nu:!1,RJ:1,xz:-1,yz:-1,Ql:0,Fd:null,dc:null,Kd:null,
vC:null,Ug:null,Un:null,Xj:null,JC:null,Vk:0}};a.Xg=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(t.push("ogg"),t.push("ogv"),t.push("oga")),""!=a.canPlayType("audio/mpeg")&&t.push("mp3"),""!=a.canPlayType("audio/mp4")&&(t.push("mp4"),t.push("m4v"),t.push("m4a")),""!=a.canPlayType("audio/webm")&&t.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(da.push("ogv"),da.push("ogg"),da.push("oga")),""!=b.canPlayType("video/mp4")&&
(da.push("m4v"),da.push("mp4")),""!=b.canPlayType("video/webm")&&da.push("webm"),""!=b.canPlayType("video/mpeg")&&da.push("mp3"))};a.TQ=function(a){O.oE&&!J&&(J=p())&&D.log("%cINIT WEBAUDIO: "+J.sampleRate+"Hz","color: #00a");if(J){var b={Yh:new Float32Array(3),xm:new Float32Array(3),Vk:0},c=J.createGain(),d=J.createGain();b.Un=c;b.Xj=d;c.connect(d);d.connect(J.destination);if(a.b4w_enable_dynamic_compressor){var d=J.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;d.threshold.value=
f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.Iq=d;b.Fd=d}else b.Iq=null,b.Fd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Yq="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Yq="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Yq="exponential";break;case "NONE":b.Yq="none";break;default:z.q("Wrong audio distance model")}b.GT=a.audio_doppler_factor;b.hZ=a.audio_doppler_speed;b.muted=!1;
b.volume=a.audio_volume;c.gain.value=Q(b);b.Ql=0}else b=null;a.Rc=b};a.eY=function(a){F=a};a.zT=function(a){a||(a="ogg");return-1<t.indexOf(a)?a:-1<t.indexOf("m4a")?"m4a":-1<t.indexOf("oga")?"oga":""};a.BT=function(a){a||(a="webm");return-1<da.indexOf(a)?a:-1<da.indexOf("m4v")?"m4v":-1<da.indexOf("webm")?"webm":""};a.Wk=function(a,b){var c=a.data,d=b.X;d.wj=a.data.sound.uuid;d.Tg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=J?c.b4w_behavior:"NONE";
break;case "BACKGROUND_MUSIC":var f;J?(window.MediaElementAudioSourceNode?f=!0:(D.warn("MediaElementAudioSourceNode not found"),f=!1),f=f&&!m.JG?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):f="NONE";d.behavior=f;break;default:z.q("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Nu=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.bq=c.attenuation;d.Xq=c.distance_reference;d.Qg=c.distance_max||1E4;d.TG=c.cone_angle_inner;d.UG=c.cone_angle_outer;d.VG=c.cone_volume_outer;d.autoplay=
c.b4w_auto_play;d.ze=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.YJ=c.b4w_loop_start;d.Vv=c.b4w_loop_end;d.zH=c.b4w_delay;d.AH=c.b4w_delay_random;d.en=c.b4w_volume_random;d.wo=c.b4w_pitch_random;d.Ul=c.b4w_fade_in;d.Ff=c.b4w_fade_out;T.push(b)};a.lM=function(b){"SPEAKER"!=b.type&&z.q("Wrong object type");switch(b.X.behavior){case "POSITIONAL":return a.Sx;case "BACKGROUND_SOUND":return a.Sx;case "BACKGROUND_MUSIC":return a.wE;case "NONE":return a.xE;default:z.q("Wrong speaker behavior")}};a.y_=function(a,
b){var c=a.X;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:z.q("Wrong speaker behavior")}};a.GK=function(){var a=J.createBufferSource();a.buffer=J.createBuffer(1,22050,22050);a.connect(J.destination);a.start(0)};a.xT=function(a,b,c){J?J.decodeAudioData(a,b,c):c()};a.fZ=function(a){n(a);a.X=null;T.splice(T.indexOf(a),1)};a.ua=function(){for(var a=0;a<T.length;a++){var b=T[a].X;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():
(b.dc&&b.dc.disconnect(),b.Kd&&b.Kd.disconnect())}F&&F.Rc&&(a=F.Rc,a.Yh[0]=0,a.Yh[1]=0,a.Yh[2]=0,a.xm[0]=0,a.xm[1]=0,a.xm[2]=0);F=null;T.splice(0);ba=null};a.update=function(a){if(J&&0!=T.length){for(var b=0;b<T.length;b++){var c=T[b],d=c.X,f=d.dc,e=J.currentTime;!d.loop&&20==d.state&&d.duration&&d.lf+d.duration<e&&("BACKGROUND_MUSIC"==d.behavior||f&&!z.Wh(f.onended))&&(d.state=50);d.ze&&50==d.state&&y(c);20==d.state&&3>d.et-e&&k(d)}ba&&ba.oj.length&&(-1==ba.Gc||a>ba.DF+ba.FH[ba.Gc])&&(b=ba,-1<b.Gc&&
n(b.oj[b.Gc]),-1==b.Gc&&b.random?c=Math.round(Math.random()*(b.oj.length-1)):b.random?(c=1+Math.round(Math.random()*(b.oj.length-2)),c=(b.Gc+c)%b.oj.length):c=(b.Gc+1)%b.oj.length,y(b.oj[c]),b.Gc=c,b.DF=a)}};a.play=e;a.FK=y;a.stop=n;a.$V=function(a){return 20==a.X.state};a.Z8=l;a.a9=v;a.Y6=function(a,b){var c=a.X,d=c.Kd;if(B(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var f=J.currentTime+b;c.dc.stop(f);d.start(f,c.Vv)}};a.sX=function(a,b){var c=a.X;c.pitch=b;!B(a)||"POSITIONAL"!=
c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.dc.playbackRate.value=b,c.Kd&&(c.Kd.playbackRate.value=b),A(c),k(c))};a.u5=function(a){return a.X.pitch};a.ze=function(a,b){a.X.ze=Boolean(b)};a.PV=function(a){return a.X.autoplay};a.SV=function(a){return a.X.ze};a.vW=function(a,b,f,e,l){if(a=a.Rc){var m=x;m[0]=0;m[1]=0;m[2]=-1;d.transformQuat(m,f,m);g[0]=0;g[1]=1;g[2]=0;d.transformQuat(g,f,g);f=J.listener;f.setPosition(b[0],b[1],b[2]);f.setOrientation(m[0],m[1],m[2],g[0],g[1],g[2]);if(e&&a.Vk!=l){if(a.QB)a.QB=
!1,d.copy(b,a.Yh);else for(f=a.xm,f[0]=(b[0]-a.Yh[0])/e,f[1]=(b[1]-a.Yh[1])/e,f[2]=(b[2]-a.Yh[2])/e,d.copy(b,a.Yh),b=0;b<T.length;b++)f=T[b],m=f.X,B(f)&&"POSITIONAL"==m.behavior&&m.Nu&&c(m,a,e);a.Vk=l}else d.copy(b,a.Yh)}};a.QB=function(){var a=F.Rc;a&&(a.QB=!0)};a.gZ=function(a,b,f){var e=a.X;if(B(a)&&"POSITIONAL"==e.behavior){var l=I.hc(a.k.n,x);a=I.Xd(a.k.n,P);var m=e.vC;m.setPosition(l[0],l[1],l[2]);z.lc(a,z.Nc,g);m.setOrientation(g[0],g[1],g[2]);e.Nu&&(a=e.JB,b&&e.Vk!=f?(e.Wm?(d.copy(l,a),e.Wm=
!1):(m=e.Ex,m[0]=(l[0]-a[0])/b,m[1]=(l[1]-a[1])/b,m[2]=(l[2]-a[2])/b,d.copy(l,a),c(e,F.Rc,b)),e.Vk=f):d.copy(l,a))}};a.b9=function(a){var b=a.X;B(a)&&"POSITIONAL"==b.behavior&&b.Nu&&(b.Wm=!0)};a.lB=function(a){return a.X.behavior};a.I2=function(){for(var a=0;a<T.length;a++)if(B(T[a]))return!0;return!1};a.o8=function(a){var b=F.Rc;b&&(b.volume=a,J&&(b.Un.gain.value=Q(b)))};a.d5=function(){var a=F.Rc;return a?a.volume:0};a.OY=function(a,b){var c=a.X;c.volume=b;B(a)&&(c.Un.gain.value=Q(c))};a.Y5=function(a){return a.X.volume};
a.qc=function(a,b){a.X.muted=Boolean(b);B(a)&&(a.X.Un.gain.value=Q(a.X))};a.L6=function(a){return a.X.muted};a.e7=function(a){var b=F.Rc;b&&(b.muted=Boolean(a),J&&(b.Un.gain.value=Q(b)))};a.K6=function(){var a=F.Rc;return a?a.muted:!1};a.oV=function(){return T};a.pause=function(){for(var a=0;a<T.length;a++)l(T[a])};a.jj=function(){for(var a=0;a<T.length;a++)v(T[a])};a.b8=function(a,b){if(a.Rc&&a.Rc.Iq){var c=a.Rc.Iq;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=
b.attack;c.release.value=b.release}};a.z4=function(a){if(!a.Rc||!a.Rc.Iq)return null;a=a.Rc.Iq;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.G3=function(a,b,c){if(B(a)){a=a.X;var d=a.Xj,f=J.currentTime;d.gain.setValueAtTime(d.gain.value,f);d.gain.linearRampToValueAtTime(b,f+c);a.Ql=c}};a.D9=function(a){if(B(a)){a=a.X;var b=a.Xj,c=J.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Ql);
a.Ql=0}};a.H3=function(a,b){if(J){var c=F.Rc,d=c.Xj,f=J.currentTime;d.gain.setValueAtTime(d.gain.value,f);d.gain.linearRampToValueAtTime(a,f+b);c.Ql=b}};a.E9=function(){if(J){var a=F.Rc,b=a.Xj,c=J.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Ql);a.Ql=0}};a.o2=function(a,b,c){ba={Gc:-1,DF:0,random:c,oj:[],FH:[]};for(c=0;c<a.length;c++){var d=a[c],f=K(d);0==f?D.warn("Ignoring speaker with zero duration: "+d.name):(n(d),d.X.ze=!1,ba.oj.push(d),ba.FH.push(f+b))}};
a.E4=K;a.d3=function(){if(ba)for(var a=ba.oj,b=0;b<a.length;b++)n(a[b]);ba=null};a.x5=function(a){return(a=a.X)&&"POSITIONAL"==a.behavior?{dist_ref:a.Xq,dist_max:a.Qg,attenuation:a.bq}:null};a.C8=function(a,b){var c=a.X;if(c&&"POSITIONAL"==c.behavior){c.Xq=b.dist_ref;c.Qg=b.dist_max;c.bq=b.attenuation;var d=c.vC;d&&(d.refDistance=c.Xq,d.maxDistance=c.Qg,d.rolloffFactor=c.bq)}};a.h8=function(a,b){var c=a.X;c&&c.Ug&&(c.Ug.frequency.value=b.freq,c.Ug.Q.value=b.Q,c.Ug.gain.value=b.gain)};a.K4=function(a){return(a=
a.X)&&a.Ug?{freq:a.Ug.frequency.value,Q:a.Ug.Q.value,gain:a.Ug.gain.value}:null};a.J4=function(a,b,c,d){a=a.X;if(!a||!a.Ug)return null;a.Ug.getFrequencyResponse(b,c,d)};a.reset=function(){t.length=0;da.length=0;J=null}};b4w.module.__time=function(a,h){function p(){return-1!==e.sl.Uu?e.sl.Uu:n}var e=h("__config");h("__print");var b=0,y=0,r=[],A=0,k=0,w=[],n=-1;a.PL=function(a){b=a;y=performance.now();for(a=0;a<r.length;a++){var f=r[a];b>f.OA&&(r.splice(a,1),a--,f.callback())}for(a=0;a<w.length;a++){var f=w[a],e=1-(f.OA-b)/f.duration,e=Math.min(e,1);f.callback(f.from+e*(f.to-f.from));1==e&&(w.splice(a,1),a--)}};a.ur=function(){return b};a.QL=function(a,f){var e;A++;e=A;r.push({id:e,callback:a,OA:b+(performance.now()-
y+f)/1E3});return e};a.nu=function(a){for(var b=0;b<r.length;b++)if(r[b].id==a){r.splice(b,1);break}};a.lu=function(a){for(var b=w.length;b--;)if(w[b].id==a){w.splice(b,1);break}};a.wn=function(a,f,e,c){e/=1E3;var n;k++;n=k;w.push({id:n,callback:c,from:a,to:f,OA:b+e,duration:e});c(a);return n};a.reset=function(){y=b=0;r.length=0;k=A=w.length=0};a.rd=p;a.qY=function(a){n=a};a.rr=function(a){return a*p()}};"object"==typeof module&&module.PA&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function h(){var a=p,e=a.getDate(),e=10>e?"0"+String(e):String(e),h=a.getMonth()+1,h=10>h?"0"+String(h):String(h),A=String(a.getFullYear()),k=a.getHours(),k=10>k?"0"+String(k):String(k),w=a.getMinutes(),w=10>w?"0"+String(w):String(w),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return e+"."+h+"."+A+" "+k+":"+w+":"+a}var p=new Date(2017,4,24,16,24,28),e=[16,12,1];a.version=function(){return e};a.jE=function(){for(var a="",h=0;h<e.length;h++)a=1==h?a+(10>e[h]?"0"+
e[h]:e[h]):a+e[h],h!=e.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.uH=function(){return p};a.zA=h;a.timestamp=function(){var a=h(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.PA&&b4w.module.__version(exports);b4w.module.__navmesh=function(a,h){function p(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var f=a.cl,e=c.cl,g=[],l=0;l<f.length;l++)0<=b(e,f[l])&&g.push(f[l]);if(2>g.length)return[];0<=b(g,f[0])&&0<=b(g,f[f.length-1])&&d(f);0<=b(g,e[0])&&0<=b(g,e[e.length-1])&&d(e);g=[];for(l=0;l<f.length;l++)0<=b(e,f[l])&&g.push(f[l]);return g}function e(a){function b(a){for(var c=a.mg,d=0;d<c.length;d++){var f=c[d];void 0==f.island&&(f.island=a.island,b(f))}}a=a.tX;for(var c=[],d=0,f=0;f<a.length;f++){var e=
a[f];void 0==e.island&&(e.island=d++,b(e));c[e.island]||(c[e.island]=[]);c[e.island].push(a[f])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function y(a){function b(a,c){for(var d=0;d<a.length;d++)if(c===a[d])return d}for(var c={},d=a.lp,f=0;f<d.length;f++)d[f][0]=parseFloat(d[f][0].toFixed(2)),d[f][1]=parseFloat(d[f][1].toFixed(2)),d[f][2]=parseFloat(d[f][2].toFixed(2));c.lp=a.lp;a=e(a);c.IB=[];for(f=0;f<a.length;f++){for(var d=
[],g=a[f],l=0;l<g.length;l++){for(var m=[],k=g[l],q=0;q<k.mg.length;q++)m.push(b(g,k.mg[q]));for(var n=[],q=0;q<k.mg.length;q++)n.push(p(k,k.mg[q]));k.fd[0]=parseFloat(k.fd[0].toFixed(2));k.fd[1]=parseFloat(k.fd[1].toFixed(2));k.fd[2]=parseFloat(k.fd[2].toFixed(2));d.push({id:b(g,k),mg:m,cl:k.cl,fd:k.fd,Uc:k.Uc,uX:n,TA:0,lr:0,Ib:0,iS:1,lE:!1,closed:!1,parent:null})}c.IB.push(d)}return c}function r(a,b,c,d,f){function e(a,b){D.subtract(a,b,L);return D.dot(L,L)}function g(a,b){for(var c=[],d=0;d<b.mg.length;d++)c.push(a[b.mg[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.TA=0;c.lr=0;c.Ib=0;c.iS=1;c.lE=!1;c.closed=!1;c.parent=null}})(a);var l=Q.$Q(function(a){return a.TA});for(Q.eG(l,b);0<l.content.length;){var m=Q.aR(l);if(m===c){a=m;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}m.closed=!0;for(var q=g(a,m),k=0,n=q.length;k<n;k++){var h=q[k];if(!h.closed){var p=m.lr+D.dist(h.fd,m.fd),t=h.lE;if(!t||p<h.lr)h.lE=!0,h.parent=m,h.Ib=h.Ib||e(h.fd,f)+e(h.fd,d),h.lr=p,h.TA=h.lr+h.Ib,t?Q.bR(l,
h):Q.eG(l,h)}}}return[]}function A(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function k(a,b,c,d){b=D.subtract(b,a,L);a=D.subtract(c,a,I);a=D.cross(b,a,L);return G.sign(D.dot(d,a))}function w(a,b){D.subtract(a,b,L);return 1E-5>D.dot(L,L)}function n(a,b,c){var d=D.subtract(b.right,b.left,L),f=c.Uc,e=b.Uc;c=Math.acos(D.dot(f,e));f=G.sign(D.dot(d,D.cross(f,e,I)));c*=-f;f=K.identity(g);K.translate(f,b.left,f);K.rotate(f,c,d,f);K.translate(f,D.scale(b.left,-1,I),f);K.multiply(a,f,a)}function l(a,b,c,
f,e,g,l,k,h){for(var q=K.identity(O),p=e;p<c;p++)if(a[p].DJ&&(p>e||!p)){var t,r=b,x=f;t=a[p].left;var w=a[p].right,v=g,B=q,I=D.create(),F=D.transformMat4(t,B,z);F[3]=1;B=D.transformMat4(w,B,L);B=D.subtract(B,F,d);r=D.subtract(x,r,L);v=D.cross(v,r,m);.01>Math.abs(D.dot(v,B))?x=.5:(D.normalize(v,v),v[3]=-D.dot(v,x),x=-R.dot(v,F)/R.dot(v,B));w=D.subtract(w,t,L);t=D.scaleAndAdd(t,w,x,I);A(l,t);k&&A(h,a[p].Uc);p&&n(q,a[p],a[p-1])}}function f(a,b){function c(b,d){v=O=r=d;m=g=e=b;D.copy(b,h);D.copy(b,q);
D.copy(a[r].Uc,p)}var d=[],f=[],e,g,m,h,q,p,r=0,O=0,v=0;e=a[0].right;g=a[0].left;m=a[0].right;h=D.copy(g,P);q=D.copy(m,t);p=D.copy(a[0].Uc,F);A(d,e);b&&A(f,a[0].Uc);for(var B=K.identity(x),z=1;z<a.length;z++){var I=a[z].left,y=a[z].right,Q=D.transformMat4(I,B,da),L=D.transformMat4(y,B,J);a[z].DJ&&n(B,a[z],a[z-1]);if(0>=k(e,q,L,p)){var ia=w(e,m);if(ia||0<k(e,h,L,p))m=y,D.copy(L,q),v=z;else{(I=w(h,e))||l(a,h,O,e,r,p,d,b,f);B=K.identity(B);c(g,O);z=r;I||(A(d,e),b&&A(f,a[z].Uc));continue}}0<=k(e,h,Q,
p)&&((ia=w(e,g))||0>k(e,q,Q,p)?(g=I,D.copy(Q,h),O=z):((I=w(q,e))||l(a,q,v,e,r,p,d,b,f),B=K.identity(B),c(m,v),z=r,I||(A(d,e),b&&A(f,a[z].Uc))))}B=a.length-1;z=a[B].left;(I=w(e,z))||l(a,h,B,e,r,p,d,b,f);I&&r||A(d,z);return b?(A(f,a[B].Uc),{positions:new Float32Array(d),normals:new Float32Array(f)}):{positions:new Float32Array(d),normals:null}}function v(a,b,c,d,f){for(var e=null,g=Number.MAX_VALUE,l=0;l<a.length;l++){var m=a[l],q=f(c,m.fd,m.cl,b,g);q<g&&(e=m,g=q)}return 0<d&&g>d?null:e}function c(a,
b,c,d,f){a.push({left:b,right:c,DJ:d,Uc:f})}var B=h("__geometry"),Q=h("__math"),K=h("__mat4"),G=h("__util"),D=h("__vec3"),R=h("__vec4"),L=D.create(),I=D.create(),z=R.create(),d=R.create(),m=R.create(),O=K.create(),x=K.create(),g=K.create(),P=D.create(),t=D.create(),da=D.create(),J=D.create(),F=D.create();a.YW=function(a){var b=B.hv(a.tc,B.SP),c=a.le;a=[];for(var d=0;d<c.length;d+=3)a.push({na:new Uint32Array([c[d],c[d+1],c[d+2]]),fd:new Float32Array(3),Uc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var f=new Float32Array(3);f[0]=b[d];f[1]=b[d+1];f[2]=b[d+2];c.push(f)}for(b=0;b<a.length;b++)d=a[b],D.add(c[d.na[0]],c[d.na[1]],L),D.add(L,c[d.na[2]],L),D.scale(L,1/3,d.fd);for(b=0;b<a.length;b++){var d=a[b],f=D.subtract(c[d.na[1]],c[d.na[0]],L),e=D.subtract(c[d.na[2]],c[d.na[0]],I),f=D.cross(f,e,L);D.normalize(f,f);D.copy(f,d.Uc)}for(var g={},b=[],d=[],l,m,q=Math.pow(10,4),f=0,e=c.length;f<e;f++)l=c[f],m=Math.round(l[0]*q)+"_"+Math.round(l[1]*q)+"_"+Math.round(l[2]*q),void 0===g[m]?(g[m]=f,b.push(l),
d[f]=b.length-1):d[f]=d[g[m]];g=[];f=0;for(e=a.length;f<e;f++)for(l=a[f],l.na[0]=d[l.na[0]],l.na[1]=d[l.na[1]],l.na[2]=d[l.na[2]],l=[l.na[0],l.na[1],l.na[2]],m=0;3>m;m++)if(l[m]==l[(m+1)%3]){g.push(f);break}for(f=g.length-1;0<=f;f--)a.splice(g[f],1);c.length=0;for(f in b)c.push(b[f]);d=[];for(b=f=0;b<a.length;b++)e=a[b],d.push({id:f++,cl:e.na,fd:e.fd,Uc:e.Uc,mg:[]});a={tX:d,lp:c};c={};for(b=0;b<d.length;b++)for(f=0;3>f;f++)e=d[b].cl[f],g=d[b].cl[(f+1)%3],e=e>g?g+"-"+e:e+"-"+g,e in c||(c[e]=[]),c[e].push(d[b]);
d=Object.keys(c);b=0;for(g=d.length;b<g;b++)for(e=d[b],f=0;f<c[e].length;f++)for(l=f+1;l<c[e].length;l++)c[e][f].mg.push(c[e][l]),c[e][l].mg.push(c[e][f]);return y(a)};a.jK=function(a,b,c){for(var d=null,f=Number.MAX_VALUE,e=a.IB,g=0;g<e.length;g++)for(var l=0;l<e[g].length;l++){var m=e[g][l];D.subtract(m.fd,b,L);m=c(b,m.fd,m.cl,a.lp,f);m<f&&(d=g,f=m)}return d};a.aW=function(a,b,c){for(var d=[],f=0;f<b.length;f++)d.push(c[b[f]]);b=!1;c=-1;for(var f=d.length,e=f-1;++c<f;e=c)(d[c][1]<=a[1]&&a[1]<d[e][1]||
d[e][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[e][0]-d[c][0])*(a[1]-d[c][1])/(d[e][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.iK=function(a,b,d,e){var g;g=a.IB[e.island];var l=a.lp,m=v(g,l,b,e.allowed_distance,e.distance_to_closest);g=m?(l=v(g,l,d,e.allowed_distance,e.distance_to_farthest))?r(g,m,l,b,d):null:null;if(g&&g.length)if(e.do_not_pull_string)if(d=g,e.return_normals){b=new Float32Array(3*d.length);for(g=0;g<d.length;g++)b.set(d[g].fd,3*g);d={positions:b,normals:null}}else{b=new Float32Array(3*
d.length);a=new Float32Array(3*d.length);for(g=0;g<d.length;g++)b.set(d[g].fd,3*g),a.set(d[g].Uc,3*g);d={positions:b,normals:a}}else{a=a.lp;e=e.return_normals;m=[];c(m,b,b,!1,g[0]&&g[0].Uc||G.nc);for(b=0;b<g.length;b++){var k=g[b];if(l=g[b+1]){var n=.999>Math.abs(D.dot(k.Uc,l.Uc));a:{for(var q=0;q<k.mg.length;q++)if(k.mg[q]===l.id){k=k.uX[q];break a}k=void 0}c(m,a[k[0]],a[k[1]],n,l.Uc)}}c(m,d,d,!1,m[m.length-1].Uc);d=f(m,e)}else d=null;return d}};b4w.module.__geometry=function(a,h){function p(){return{length:0,frames:1,Jc:0,Wm:0,offset:0,Zq:0}}function e(a,b){for(var c=b.a_tbn_quat,d=b.a_position,f=c.length,e=d.length,g=1;g<a.jb.length;g++)for(var l=a.jb[g].Gf,m=a.jb[g].Cr,l=l.a_position,q=0;q<e;q++)d[q]+=m*l[q];d=U;for(g=0;g<f;g+=4){e=c.subarray(g,g+4);d.set(ca.rn);for(q=1;q<a.jb.length;q++)l=a.jb[q].Gf,m=a.jb[q].Cr,m=Z.slerp(ca.rn,l.a_tbn_quat,m,sa),Z.normalize(m,m),Z.multiply(m,d,d);Z.multiply(d,e,e)}}function b(a){return 65536<a.Ja?u.sI()?
!1:!0:!1}function y(a){return 0<a.na.length?!0:!1}function r(a,b,c){if(!y(a))return a;c||ga.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ja*(b||1)+", will use drawArrays","color: #aa0");b=a.na;c=a.Ja;var d=a.qa,f=a.aa,e;for(e in d){var g=d[e],l=R(g,c);d[e]=A(b,g,l)}for(d=0;d<f.length;d++){var m=f[d];for(e in m)g=m[e],l=R(g,c),m[e]=A(b,g,l)}for(d=0;d<a.jb.length;d++){e=a.jb[d].Gf;for(var q in e)g=e[q],l=R(g,c),e[q]=A(b,g,l)}a.Ja=b.length;a.na=new Uint16Array(0);return a}
function A(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),f=0;f<a.length;f++)for(var e=a[f],g=0;g<c;g++)d[c*f+g]=b[c*e+g];return d}function k(){return{le:null,tc:g(),jm:0,count:0,kd:{},Zm:0,Gn:0,In:0,Md:[],hg:null,jb:null,nm:1,Yf:!0}}function w(a,b){var c=a.kd[b];if(c){var d=T(b);return J(a.tc,d).subarray(c.offset,c.offset+c.length)}ca.q("extract_array() failed; invalid name: "+b)}function n(b,c){var d;switch(c){case a.nn:case a.vp:d=aa.STATIC_DRAW;break;case a.ot:d=
aa.DYNAMIC_DRAW;break;default:ca.q("Wrong draw_mode")}b.Zm=d}function l(a,b,c){function d(a,b){f[a]||(f[a]=0);f[a]+=b}var f={},e;for(e in a[0]){var g=a[0][e],l=T(e);d(l,g.length*a.length)}for(e in b)g=b[e],l=T(e),d(l,g.length);if(c){a=c.dp.length;l=T("a_part_ts");d(l,4*a);l=T("a_part_r");d(l,4*a);b=c.Im;for(e in b)l=T(e),d(l,b[e].Jc*a);c=c.Os;for(e in c)l=T(e),d(l,a)}return f}function f(a){a.le?(a.hg||(a.hg=aa.createBuffer()),aa.bindBuffer(aa.ELEMENT_ARRAY_BUFFER,a.hg),aa.bufferData(aa.ELEMENT_ARRAY_BUFFER,
a.le,a.Zm),a.Gn=a.le.byteLength):a.Gn=0;for(var b=a.In=0;b<a.tc.length;b++){var c=a.tc[b].type,d=t(a.Md,c);-1==d&&(a.Md.push({Yk:null,type:c,vT:ca.SZ()}),d=a.Md.length-1);c=a.Md[d];c.Yk||(c.Yk=aa.createBuffer());aa.bindBuffer(aa.ARRAY_BUFFER,c.Yk);aa.bufferData(aa.ARRAY_BUFFER,a.tc[b].pi,a.Zm);a.In+=a.tc[b].pi.byteLength}}function v(a,b){a.R=ba.Al(a.R,b);a.ba=ba.kq(a.ba,b);a.wa=ba.lq(a.wa,b);a.zd=ba.Dz(a.zd,b)}function c(a){for(var b=a[0],c=a[0],d=x("JOIN_"+a.length+"_SUBMESHES"),f=0,e=0;e<a.length;e++)f+=
a[e].na.length;d.na=new Uint32Array(f);var g=f=0;if(0<a[0].jb.length)for(var l=0;l<a[0].jb.length;l++){for(e=0;e<a.length;e++)f+=a[e].jb[l].Gf.a_position.length,g+=a[e].jb[l].Gf.a_tbn_quat.length;e={a_position:new Float32Array(f),a_tbn_quat:new Float32Array(g)};d.jb.push({Cr:a[0].jb[l].Cr,Gf:e})}for(e=f=0;e<a.length;e++)f+=a[e].Ja;d.Ja=f;for(var m in c.qa){for(e=f=0;e<a.length;e++)f+=a[e].qa[m].length;d.qa[m]=new Float32Array(f)}for(m in c.aa[0]){for(e=f=0;e<a.length;e++)f+=a[e].aa[0][m].length;for(e=
0;e<c.aa.length;e++)d.aa[e]=d.aa[e]||{},d.aa[e][m]=new Float32Array(f)}e=d.Pf;e.R=ba.Cl(b.Pf.R);g=f=0;l=[];for(c=0;c<a.length;c++){var q=a[c],k=q.na,n=q.Ja,h=q.qa;m=q.Pf.wa;ba.NA(e.R,q.Pf.R);ba.VT(e.wa,m);ba.RA(q.Pf.zd,l);for(m=0;m<k.length;m++)d.na[f+m]=k[m]+g;var f=f+k.length,p;for(p in h){var k=h[p],t=g*R(k,n);d.qa[p].set(k,t)}for(m=0;m<q.aa.length;m++){var h=q.aa[m],u=d.aa[m];for(p in h)k=h[p],t=g*R(k,n),u[p].set(k,t)}g+=n}e.ba=ba.uu(ca.Ef(l),!0);if(0<d.jb.length)for(c=0;c<d.jb.length;c++)for(p=
d.jb[c].Gf,m=f=e=0;m<a.length;m++)g=a[m].jb[c].Gf,p.a_position.set(g.a_position,e),p.a_tbn_quat.set(g.a_tbn_quat,f),e+=g.a_position.length,f+=g.a_tbn_quat.length;a[0].Jf&&(d.Jf={dp:b.Jf.dp,mx:b.Jf.mx,qM:!0,Os:b.Jf.Os,Im:b.Jf.Im,Ku:b.Jf.Ku});return d}function B(a,b,c){b=b.Pf;for(var d=ba.Qd(),f=ba.vu(),e=[],g=0;g<c.length;g++)ba.Al(a.Pf.R,c[g],d),ba.NA(b.R,d),ba.Dz(a.Pf.zd,c[g],f),ba.RA(f,e);b.ba=ba.uu(ca.Ef(e),!0);b.zd=ba.mS(b.ba);b.wa=ba.Jq(b.ba)}function Q(a,b,c,f,e,g){var l=a.submeshes[b],m=l.base_length,
q=x("SUBMESH_"+a.name+"_"+a.materials[b].name);q.Ja=m;var k=!1;if(G(c,"a_texcoord")){var n=null,h=a.materials[b];b=a.submeshes[b];if(h.texture_slots.length)switch(h=h.texture_slots[0],h.texture_coords){case "UV":h=a.uv_textures.indexOf(h.uv_layer);0==h?n=new Float32Array(b.texcoord):1==h&&(n=new Float32Array(b.texcoord2));break;case "ORCO":for(var p=a.b4w_boundings.bb_src,n=new Float32Array(2*b.base_length),h=(p.max_x+p.min_x)/2,t=(p.max_y+p.min_y)/2,u=p.max_x-p.min_x,p=p.max_y-p.min_y,E=0,w=0;w<
b.position.length;w+=3)n[E++]=(b.position[w]-h)/u+.5,n[E++]=(b.position[w+1]-t)/p+.5}null===n&&(n=new Float32Array(2*b.base_length));b=n}else b=new Float32Array(0);if(G(c,"a_orco_tex_coord")){n=a.b4w_boundings.bb_src;h=new Float32Array(3*l.base_length);t=n.max_x-n.min_x;u=n.max_y-n.min_y;p=n.max_z-n.min_z;for(w=E=0;w<l.position.length;w+=3)0==t?h[E++]=.5:h[E++]=ca.U(parseFloat(((l.position[w]-n.min_x)/t).toFixed(5)),0,1),0==u?h[E++]=.5:h[E++]=ca.U(parseFloat(((l.position[w+1]-n.min_y)/u).toFixed(5)),
0,1),0==p?h[E++]=.5:h[E++]=ca.U(parseFloat(((l.position[w+2]-n.min_z)/p).toFixed(5)),0,1);n=h}else n=new Float32Array(0);h=l.group;if(G(c,"a_influence")&&f){t=new Float32Array(4*m);u=h.length/m;p=new Float32Array(u);for(E=0;E<u;E++){p[E]=-1;for(var O in f)if(w=f[O],w.zN===E){p[E]=w.BA;break}}var v=3<u?u:4;f=new Float32Array(v);O=new Uint32Array(v);for(var E=new Float32Array(4),w=new Float32Array(v),v=new Uint32Array(v),S=new Float32Array(4),B=0;B<m;B++)f.set(w),O.set(v),E.set(S),t.set(D(h,u,B,m,p,
f,O,E),4*B)}else t=new Float32Array(0);f=t;e=e?ca.S(e):{};e.a_color={bm:!0};e.a_color.src=G(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,jg:7}]:[];q.qa.a_texcoord=b;q.qa.a_influence=f;q.qa.a_orco_tex_coord=n;f=q.qa;O=l.vertex_colors;b=l.color;n=a.name;h=[];for(t=0;t<O.length;t++)h.push(O[t].name);for(var z in e)if(t=e[z].src,t.length){for(p=u=0;p<t.length;p++)u+=ca.Mm(t[p].jg);f[z]=new Float32Array(u*m);for(p=E=0;p<t.length;p++){var I=t[p].name,w=t[p].jg,v=ca.fL(w),U=h.indexOf(I);-1==
U&&ca.q('vertex color "'+I+'" for mesh "'+n+'" not found.');S=O[U].mask;B=ca.Mm(S);(w&S)!==w&&ga.error("Wrong color extraction from "+I+" to "+z+".");for(var F=I=0;F<U;F++)I+=ca.Mm(O[F].mask);U=I*m;for(I=0;I<m;I++)for(F=0;3>F;F++)v[F]&&(f[z][I*u+(E+ca.Co(w,F))]=b[U+I*B+ca.Co(S,F)]);E+=B}}else f[z]=new Float32Array(0);z=a.uv_textures;e=l.texcoord;f=l.texcoord2;O=q.qa;if(g)for(var Z in g){b=z.indexOf(Z);if(0==b)var P=new Float32Array(e);else 1==b&&(P=new Float32Array(f));O[g[Z]]=P}q.na=new Uint32Array(l.indices);
Z=l.position.length/m/3;P=G(c,"a_tbn_quat")&&l.tbn_quat.length?!0:!1;z=G(c,"a_shade_tangs")&&l.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(k=!0);for(e=0;e<Z;e++){g=K(l,m,P,z,e);if(k)if(f={},f.name=a.b4w_shape_keys[e].name,q.jb.push(f),0!=e){f.Gf=g;f.Cr=a.b4w_shape_keys[e].value;continue}else f.Gf=K(l,m,P,z,e),f.Cr=1;q.aa.push(g)}if(1<Z&&!k){a=q.aa[0];g={};for(var y in a)g[y]=new Float32Array(a[y]);q.aa.push(g)}G(c,"a_polyindex")&&(r(q,1,!0),q.qa.a_polyindex=d(q));l=l.boundings;c=q.Pf;c.R=
ba.Qd();c.R.max_x=l.bb.max_x;c.R.max_y=l.bb.max_y;c.R.max_z=l.bb.max_z;c.R.min_x=l.bb.min_x;c.R.min_y=l.bb.min_y;c.R.min_z=l.bb.min_z;y=l.rbb;a=l.caxis_x;m=l.caxis_y;k=l.caxis_z;g=l.be_ax;c.ba=ba.gq(a,m,k,l.be_cen);ha.scale(c.ba.Ga,g[0],c.ba.Ga);ha.scale(c.ba.Ha,g[1],c.ba.Ha);ha.scale(c.ba.Ia,g[2],c.ba.Ia);c.wa=ba.Jq(c.ba);ha.copy(y.rbb_c,c.zd.F);ha.copy(a,c.zd.Ga);ha.copy(m,c.zd.Ha);ha.copy(k,c.zd.Ia);l=y.rbb_s;ha.scale(c.zd.Ga,l[0],c.zd.Ga);ha.scale(c.zd.Ha,l[1],c.zd.Ha);ha.scale(c.zd.Ia,l[2],c.zd.Ia);
return q}function K(a,b,c,d,f){var e={},g=new Float32Array(3*b),l=new Float32Array(c?4*b:0),m=f*b*3;g.set(a.position.subarray(m,m+3*b),0);c&&(m=f*b*4,l.set(a.tbn_quat.subarray(m,m+4*b),0));d&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),e.a_shade_tangs=c);e.a_position=g;e.a_tbn_quat=l;return e}function G(a,b){return-1<a.indexOf(b)?!0:!1}function D(b,c,d,f,e,g,l,m){for(var q=!0,k=0;k<c;k++){var n=b[k*f+d];if(-1!==n){var h=e[k];-1!==h&&(g[k]=n,l[k]=h,q=!1)}}if(q)return m;L(g,l,a.ez,
!1);for(k=b=0;4>k;k++)b+=g[k];if(.01>b)return m;for(k=0;4>k;k++)g[k]/=b;if(.01>Math.abs(g[0]-1))m[0]=l[0]+1;else for(k=0;4>k;k++)m[k]=l[k]+g[k];return m}function R(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&ca.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function L(b,c,d,f){for(var e=b.length,g=e,l=!1,m=f?-1:1;1<g||l;){1<g&&(g=Math.floor(g/1.247330950103979));for(var l=!1,q=0;g+q<e;q++)if(d==a.ez?0>m*(b[q]-b[q+g]):b[q]<b[q+g]&&
f)l=b[q],b[q]=b[q+g],b[q+g]=l,l=c[q],c[q]=c[q+g],c[q+g]=l,l=!0}}function I(a,b,c){var d=[],f=[];ha.subtract(b,a,d);ha.subtract(c,a,f);ha.normalize(d,d);ha.normalize(f,f);a=ca.U(ha.dot(d,f),-1,1);return Math.acos(a)}function z(a,b,c){if(y(b)){b=b.na;for(var d=b.length/3,f=0;f<d;f++){var e=new Float32Array(9),g=b[3*f];e[0]=a[3*g];e[1]=a[3*g+1];e[2]=a[3*g+2];g=b[3*f+1];e[3]=a[3*g];e[4]=a[3*g+1];e[5]=a[3*g+2];g=b[3*f+2];e[6]=a[3*g];e[7]=a[3*g+1];e[8]=a[3*g+2];c[f]=e}}else for(f=0;f<a.length;f++)e=new Float32Array(9),
e[0]=a[9*f],e[1]=a[9*f+1],e[2]=a[9*f+2],e[3]=a[9*f+3],e[4]=a[9*f+4],e[5]=a[9*f+5],e[6]=a[9*f+6],e[7]=a[9*f+7],e[8]=a[9*f+8],c[f]=e;return c}function d(a){for(var b=new Float32Array(a.Ja),c=0;c<a.Ja;c++)b[c]=c%3/2;return b}function m(a,b,c){var d=ha.dist(a,b);a=ha.dist(a,c);b=ha.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function O(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function x(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ja:0,na:null,aa:[],qa:b,jb:[],Pf:{R:ba.Qd(),ba:ba.Lg(),wa:ba.Kh(),zd:ba.vu()},Jf:null}}function g(a){var b=[],c;for(c in a)b.push(P(c,a[c]));return b}function P(a,b){return{pi:new (F(a))(b),type:a}}function t(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function da(a,b){var c=t(a,b);return-1==c?null:a[c].Yk}function J(a,b){var c=t(a,b);return-1==c?null:a[c].pi}function F(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function T(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function N(a,
b,c,d){var f=T(b);b=t(a,f);switch(f){case "float":a[b].pi.set(c,d);break;case "short":for(f=0;f<c.length;f++)a[b].pi[d+f]=ca.er(c[f]);break;case "unsigned_byte":for(f=0;f<c.length;f++)a[b].pi[d+f]=ca.QZ(c[f])}}var ba=h("__boundings"),u=h("__extensions"),ga=h("__print"),Z=h("__quat"),E=h("__tsr"),ca=h("__util"),ha=h("__vec3");new Float32Array(2);var q=new Float32Array(3),S=new Float32Array(3),X=new Float32Array(3),U=new Float32Array(4),sa=new Float32Array(4),pa=new Float32Array(8);a.vp=10;a.ot=20;
a.ez=0;a.M1=1;a.nn=a.vp;var aa=null;a.SP="float";a.P1="short";a.Q1="unsigned_byte";a.Nf=function(a){aa=a};a.yM=function(a,c,d){b(a)&&r(a);var m=a.na,q=a.Ja,h=a.aa,t={},u;for(u in a.qa)u in d&&!d[u].bm||(t[u]=a.qa[u]);d=k();0<a.jb.length&&e(a,h[0]);u=a.Jf;if(m.length){var x=m.length;if(65536>=q)var m=new Uint16Array(m),C=aa.UNSIGNED_SHORT;else m=new Uint32Array(m),C=aa.UNSIGNED_INT}else x=q,m=null;for(var w=l(h,t,u),w=g(w),O={},v=0;v<w.length;v++)O[w[v].type]=0;var S={},B;for(B in t){var z=t[B],I=
z.length;if(I){var U=T(B),v=S[B]=p();v.length=I;v.Jc=R(z,q);v.offset=O[U];N(w,B,z,O[U]);O[U]+=I}}t=h.length;for(B in h[0])if(z=h[0][B],U=T(B),I=z.length,z=R(z,q),I)for(v=S[B]=p(),v.length=I,v.frames=t,v.Jc=z,v.offset=O[U],1<t&&(v=S[B+"_next"]=p(),v.length=I,v.frames=t,v.Jc=z,v.offset=O[U]+I),v=0;v<t;v++)z=h[v][B],U=T(B),N(w,B,z,O[U]),O[U]+=I;if(u){h=u.dp;B=u.mx;t=u.Im;I=u.Os;h=u.dp;B=u.mx;var t=u.Im,I=u.Os,U=u.qM,q={a_part_ts:{data:[],Jc:4},a_part_r:{data:[],Jc:4}},F;for(F in t)q[F]={data:[],Jc:t[F].Jc};
for(F in I)q[F]={data:[],Jc:1};for(z=0;z<h.length;z++){v=h[z];U&&B&&!u.Ku&&(v=E.multiply(B,h[z],pa));!U&&u.Ku&&ha.subtract(h[z],B,h[z]);q.a_part_ts.data.push(v[0],v[1],v[2],v[3]);q.a_part_r.data.push(v[4],v[5],v[6],v[7]);for(F in t)for(var v=t[F].Jc,Z=0;Z<v;Z++)q[F].data.push(t[F].data[z*v+Z]);for(F in I)q[F].data.push(I[F][0])}for(F in q)h=T(F),N(w,F,q[F].data,O[h]),B=p(),B.Jc=q[F].Jc,B.offset=O[h],B.Zq=1,B.length=q[F].data.length,S[F]=B,O[h]+=B.length;d.nm=u.dp.length}d.count=x;d.le=m;d.tc=w;d.jm=
C;d.kd=S;n(d,c);f(d);d.jb=a.jb;return d};a.uZ=e;a.YV=b;a.XV=y;a.px=r;a.e_=function(a,b,c){n(a,b);a.count=c.length;a.le=c;a.jm=c instanceof Uint16Array?aa.UNSIGNED_SHORT:aa.UNSIGNED_INT};a.d_=function(a,b){var c=a.kd,d=c.a_p_data,e=T("a_p_data");if(d)3!=d.Jc&&ca.q('invalid num_comp for "a_p_data"'),N(a.tc,"a_p_data",b,d.offset);else{d=t(a.tc,e);-1==d&&(a.tc.push(P(e,0)),d=a.tc.length-1);var e=a.tc[d].pi,g=new e.constructor(e.length+b.length);g.set(e);a.tc[d].pi=g;N(a.tc,"a_p_data",b,e.length);c=c.a_p_data=
p();c.Jc=3;c.offset=e.length;c.length=b.length}f(a)};a.U3=w;a.a7=function(a){a.Zm=aa.STATIC_DRAW};a.JW=function(a){a.Zm=aa.DYNAMIC_DRAW};a.cN=f;a.YR=function(a){a.hg&&aa.deleteBuffer(a.hg);for(var b=0;b<a.Md.length;b++)a.Md[b].Yk&&aa.deleteBuffer(a.Md[b].Yk);a.Md.length=0};a.mJ=function(a,b){return a.submeshes[b].base_length?!1:!0};a.ox=function(a,b){for(var c=0;c<a.aa.length;c++){var d=a.aa[c].a_position;E.cp(d,b,d,0);d=a.aa[c].a_tbn_quat;0<d.length&&E.VM(d,b,d,0);(d=a.aa[c].a_shade_tangs)&&0<d.length&&
E.LZ(d,b,d)}(c=a.qa.au_center_pos)&&c.length&&E.cp(c,b,c,0);v(a.Pf,b)};a.tZ=function(a,b){var c=a.qa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);E.cp(d,b,d,0);for(var f=0;f<a.aa.length;f++)for(var e=0;e<d.length;e++)a.aa[f].a_position[e]+=d[e]-c[e];c.set(d)}else ca.q('Attribute "au_center_pos" is missing in particle submesh');v(a.Pf,b)};a.fR=v;a.sZ=function(a,b){var c=a.Ja,d;for(d in b){var f=b[d].length;a.qa[d]=new Float32Array(f*c);for(var e=0;e<c;e++)for(var g=0;g<f;g++)a.qa[d][e*f+
g]=b[d][g]}};a.xM=c;a.IW=function(a,b,c){if(!a.Ja)return x("EMPTY");var d=c.length;65536<a.Ja*d&&!u.sI()&&r(a,d);var f=a.na,e=a.Ja,g=a.qa,l=a.aa,m;for(m in b){var q=b[m].length,k=q*e;g[m]=new Float32Array(k);for(var n=0;n<e;n++)for(k=0;k<q;k++)g[m][n*q+k]=b[m][k]}b=x("CLONE_"+d+"_SUBMESHES");b.Ja=e*d;b.na=new Uint32Array(f.length*d);for(n=0;n<d;n++)for(q=f.length*n,m=e*n,k=0;k<f.length;k++)b.na[q+k]=f[k]+m;for(var h in g)for(f=g[h],k=f.length*d,q=R(f,e),b.qa[h]=new Float32Array(k),n=0;n<d;n++)m=e*
q*n,b.qa[h].set(f,m);for(h in l[0])for(n=0;n<l.length;n++)for(f=l[n][h],k=f.length*d,q=R(f,e),b.aa[n]=b.aa[n]||{},b.aa[n][h]=new Float32Array(k),k=0;k<d;k++)switch(g=c[k],m=e*q*k,h){case "a_position":E.cp(f,g,b.aa[n][h],m);break;case "a_tbn_quat":E.VM(f,g,b.aa[n][h],m);break;case "a_shade_tangs":E.OZ(f,g,b.aa[n][h],m);break;default:ca.q("Wrong attribute name: "+h)}B(a,b,c);return b};a.oG=B;a.SA=Q;a.$T=function(a){var b=a.Ja,c=a.aa[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.na.length);
for(var f=new Float32Array(4*b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var g=Math.random();f[4*e]=g;f[4*e+1]=g;f[4*e+2]=g;f[4*e+3]=g}c=x("HALO");c.aa[0]={};c.Ja=4*b;c.aa[0].a_position=d;c.qa.a_halo_bb_vertex=O(b);c.qa.a_random_vals=
f;c.na=a;return c};a.xV=G;a.MH=function(a,b,d){for(var f=[],e=0;e<a.submeshes.length;e++){var g=Q(a,e,b,null,d,null);g.Ja&&f.push(g)}return 0==f.length?x("EMPTY"):1==f.length?f[0]:c(f)};a.c_=function(a,b,c,d){var f=a.le,e=w(a,"a_position"),g=b.SW,l=b.TW;b=b.ET;for(var m=f,q=m.length/3,k=0;k<q;k++){var n=m[3*k],h=m[3*k+1],p=m[3*k+2],t=e[3*n+1],u=e[3*n+2],r=e[3*h+1],x=e[3*h+2],O=e[3*p+1],v=e[3*p+2];g[3*k]=(e[3*n]+e[3*h]+e[3*p])/3;g[3*k+1]=(t+r+O)/3;g[3*k+2]=(u+x+v)/3}E.cp(g,c,l);c=l.length/3;for(e=
0;e<c;e++)g=l[3*e]-d[0],m=l[3*e+1]-d[1],q=l[3*e+2]-d[2],b[e]=g*g+m*m+q*q;d=f;f=b.length;if(!(2>f))for(l=f,e=!1;1<l||e;)for(1<l&&(l=Math.floor(l/1.247330950103979)),e=!1,c=0;l+c<f;c++)0>b[c]-b[c+l]&&(e=b[c],b[c]=b[c+l],b[c+l]=e,e=d,g=c,m=c+l,q=e[3*g],k=e[3*g+1],n=e[3*g+2],e[3*g]=e[3*m],e[3*g+1]=e[3*m+1],e[3*g+2]=e[3*m+2],e[3*m]=q,e[3*m+1]=k,e[3*m+2]=n,e=!0);f=d;aa.bindBuffer(aa.ELEMENT_ARRAY_BUFFER,a.hg);aa.bufferData(aa.ELEMENT_ARRAY_BUFFER,f,aa.DYNAMIC_DRAW)};a.eZ=L;a.qR=function(a,b,c){for(var d=
b.length/3,f=a.length/3,e=[],g=Array(3),l=Array(3),m=Array(3),q=0;q<f;q++){for(var k=a[3*q],n=a[3*q+1],h=a[3*q+2],p=0;3>p;p++)g[p]=b[3*k+p],l[p]=b[3*n+p],m[p]=b[3*h+p];if(c)var p=I(g,l,m),t=I(l,m,g),u=Math.PI-p-t;else u=t=p=1;var r=e,E;E=g;var w=m,x=[],O=[],v=[];ha.subtract(l,E,x);ha.subtract(w,E,O);ha.cross(x,O,v);ha.normalize(v,v);E=v;for(w=0;3>w;w++)x=3*n+w,O=3*h+w,r[3*k+w]=p*E[w],r[x]=t*E[w],r[O]=u*E[w]}if(c)for(var S in c)for(q=c[S],a=0;3>a;a++){b=3*q[0]+a;for(f=1;f<q.length;f++)g=3*q[f]+a,e[b]+=
e[g];for(f=1;f<q.length;f++)g=3*q[f]+a,e[g]=e[b]}for(q=0;q<d;q++){c=q;S=e;a=new Float32Array(3);for(b=0;3>b;b++)f=3*c+b,a[b]=S[f];ha.normalize(a,a);for(b=0;3>b;b++)f=3*c+b,S[f]=a[b]}return e};a.tR=function(a,b,c){for(var d={},f=b.length/3,e=0;e<f;e++){var g=String(b[3*e])+String(b[3*e+1])+String(b[3*e+2]);d[g]=[]}f=a.length;for(e=0;e<f;e++)b=a[e],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in d&&d[g].push(b);return d};a.YA=function(a,b,c,d){var f;f=null;f=[];f=z(a.aa[0].a_position,a,f);if(c){var e;
e=null;e=[];for(var g=a.aa[0].a_tbn_quat,l=g.length/4,k=new Float32Array(3*l),n=0;n<l;n++){var h=U;h[0]=g[4*n];h[1]=g[4*n+1];h[2]=g[4*n+2];h[3]=g[4*n+3];h=ha.transformQuat(ca.xh,h,q);k[3*n]=h[0];k[3*n+1]=h[1];k[3*n+2]=h[2]}e=z(k,a,e)}l=f.length;k=new Float32Array(l);for(a=0;a<l;a++)n=f[a],q.set(n.subarray(0,3)),S.set(n.subarray(3,6)),X.set(n.subarray(6)),k[a]=Math.sqrt(m(q,S,X));g=new Float32Array(l);g[0]=k[0];for(a=1;a<l;a++)g[a]=g[a-1]+k[a];l=g[k.length-1];k=[];for(a=0;a<b;a++){var n=l*ca.tg(d),
n=ca.cu(g,n,0,g.length-1),p=n=c?e[n]:f[n],t=d;(n=q)||(n=new Float32Array(3));var h=p[0],u=p[1],r=p[2],E=p[3],w=p[4],x=p[5],O=p[6],v=p[7],B=p[8],p=ca.tg(t),t=ca.tg(t);1<p+t&&(p=1-p,t=1-t);var I=1-p-t,u=I*u+p*w+t*v,r=I*r+p*x+t*B;n[0]=I*h+p*E+t*O;n[1]=u;n[2]=r;c?(k[a]=new Float32Array(4),ha.normalize(n,n),n=Z.rotationTo(ca.xh,n,U),k[a][0]=n[0],k[a][1]=n[1],k[a][2]=n[2],k[a][3]=n[3]):(k[a]=new Float32Array(3),k[a][0]=n[0],k[a][1]=n[1],k[a][2]=n[2])}return k};a.Pu=d;a.B9=m;a.XH=O;a.kL=function(a,b,c){a=
a.aa[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.IQ=function(a,b,c){var d=a.I[0].W;a=a.k.ii;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=c);for(f=0;f<d.length;f++)if(!d[f].eg&&d[f].Le&&!d[f].Li){b=d[f].Ca;var e=T("a_position");c=da(b.Md,e);e=J(b.tc,e);aa.bindBuffer(aa.ARRAY_BUFFER,c);var g=b.kd.a_position;c=d[f];var l=a;if(g){for(var m=g.offset,g=g.length+m,q=c.Ca.jb[0].Gf.a_position,k=m;k<g;k++)e[k]=
q[k-m];for(k=1;k<c.Ca.jb.length;k++){var q=c.Ca.jb[k].Gf.a_position,n=l[k].value;if(n)for(var h=m;h<g;h++)e[h]+=n*q[h-m]}aa.bufferSubData(aa.ARRAY_BUFFER,ca.Aj*m,e.subarray(m))}e=T("a_tbn_quat");c=da(b.Md,e);e=J(b.tc,e);aa.bindBuffer(aa.ARRAY_BUFFER,c);m=b.kd.a_tbn_quat;b=d[f];c=e;e=a;if(m){l=m.offset;m=m.length+l;g=b.Ca.jb[0].Gf.a_tbn_quat;k=U;for(q=l;q<m;q+=4){k[0]=0;k[1]=0;k[2]=0;for(n=k[3]=1;n<b.Ca.jb.length;n++){var h=b.Ca.jb[n].Gf.a_tbn_quat,p=e[n].value;if(p){var t=sa;t[0]=h[q-l];t[1]=h[q+
1-l];t[2]=h[q+2-l];t[3]=h[q+3-l];h=Z.slerp(ca.rn,t,p,sa);Z.multiply(h,k,k)}}n=sa;n[0]=g[q-l];n[1]=g[q-l+1];n[2]=g[q-l+2];n[3]=g[q-l+3];h=0<n[3];Z.multiply(k,n,n);(0<n[3]&&!h||0>n[3]&&h)&&Z.scale(n,-1,n);c[q]=ca.er(n[0]);c[q+1]=ca.er(n[1]);c[q+2]=ca.er(n[2]);c[q+3]=ca.er(n[3])}aa.bufferSubData(aa.ARRAY_BUFFER,ca.Aj*l,c.subarray(l))}}};a.RR=function(a){return a.k.Le};a.D5=function(a){var b=[];if(a.k)for(var c=1;c<a.k.ii.length;c++)b.push(a.k.ii[c].name);return b};a.C5=function(a,b){if(a.k)for(var c=
1;c<a.k.ii.length;c++)if(b==a.k.ii[c].name)return a.k.ii[c].value;return 0};a.AV=function(a,b){var c=a.k.ii;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.e6=function(a){return a&&a.k&&a.k.ag?!0:!1};a.E3=function(b,c,d){var e=b.Ca;if(e){for(var l=d?c.length/3/2:c.length/3-1,m=new Float32Array(12*l),q=new Float32Array(12*l),k=new Uint16Array(6*l),n=0;n<l;n++){if(d)var h=6*n,p=6*n+3;else h=3*n,p=3*(n+1);var t=c[h],u=c[h+1],h=c[h+2],r=c[p],E=c[p+1],p=c[p+2],w=r-t,x=E-u,O=p-h;m[12*
n]=t;m[12*n+1]=u;m[12*n+2]=h;q[12*n]=w;q[12*n+1]=x;q[12*n+2]=O;m[12*n+3]=r;m[12*n+4]=E;m[12*n+5]=p;q[12*n+3]=-w;q[12*n+4]=-x;q[12*n+5]=-O;m[12*n+6]=t;m[12*n+7]=u;m[12*n+8]=h;q[12*n+6]=-w;q[12*n+7]=-x;q[12*n+8]=-O;m[12*n+9]=r;m[12*n+10]=E;m[12*n+11]=p;q[12*n+9]=w;q[12*n+10]=x;q[12*n+11]=O;k[6*n]=4*n;k[6*n+1]=4*n+1;k[6*n+2]=4*n+2;k[6*n+3]=4*n;k[6*n+4]=4*n+3;k[6*n+5]=4*n+1}d=0;for(var v in e.kd)c=e.kd[v],d+=m.length/3*c.Jc;c={};c["float"]=d;d=e.tc=g(c);a.e_(e,b.Mh,k);b=0;for(v in e.kd)switch(c=e.kd[v],
v){case "a_position":N(d,v,m,b);c.offset=b;c.length=m.length;b+=c.length;break;case "a_direction":N(d,v,q,b);c.offset=b;c.length=q.length;b+=c.length;break;default:c.offset=b,c.length=m.length/3*c.Jc,k=new Float32Array(c.length),N(d,v,k,b),b+=c.length}f(e)}};a.dS=function(a){var b=k();if(a.le)switch(a.jm){case aa.UNSIGNED_SHORT:b.le=new Uint16Array(a.le);break;case aa.UNSIGNED_INT:b.le=new Uint32Array(a.le)}else b.le=null;for(var c=a.tc,d=[],f=0;f<c.length;f++){var e=c[f].pi,g=c[f].type;d.push({pi:new e.constructor(e),
type:g})}b.tc=d;b.jm=a.jm;b.count=a.count;b.kd=ca.S(a.kd);b.Zm=a.Zm;b.Gn=a.Gn;b.In=a.In;b.hg=null;b.Dv=ca.S(a.Dv);b.jb=ca.S(a.jb);b.nm=a.nm;b.Yf=a.Yf;return b};a.If=x;a.reset=function(){aa=null};a.A6=g;a.bY=t;a.N5=da;a.hv=J;a.A4=F;a.xr=T;a.$I=function(a){switch(T(a)){case "float":return ca.Aj;case "short":return ca.Np;case "unsigned_byte":return ca.Xx;default:return ca.Aj}};a.fV=function(a){switch(T(a)){case "float":return aa.FLOAT;case "short":return aa.SHORT;case "unsigned_byte":return aa.UNSIGNED_BYTE;
default:return aa.FLOAT}};a.tN=N};b4w.module.__prerender=function(a,h){function p(a,f){var e=a.ff;e.ho=!1;if(e.Uh)return!1;var h=f.p,p=f.type==k.cd?h.Uv:w.hc(h.n,v);if("STATIC"==e.type&&e.co)var y=e.Rr,A=e.Sr;else y=e.lb.F,A=e.lb.Ya;var L=e.bh,I=e.ef,p=l.dist(y,p);if(!(p<L?0:I==r.Hp||p<I+e.dh*A))return!1;e.ho=!0;I=a.za;if(f.type==k.wf)return f.debug_view_mode==b.pt?I.Li:!I.Li;if(f.type==k.Cg&&0==e.ih)return!1;e.hp?(A=I.lb,L=I.qb,e=I.Sf):(A=e.lb,L=e.qb,e=e.Sf);if(I=!I.Tj)h=h.Ph,I=A.F,n.iZ(I,h,A.Ya)?I=!0:e?(I=L.F,I=n.MT(I,h,L.Ga,L.Ha,
L.Ia)):I=!1;return I?!1:!0}function e(a){var b=a.hb;if(b&&b.kK){a=a.Ca;y.JW(a);var f=a.kd,e=f.a_position.offset;y.tN(a.tc,"a_position",b.DC,e);e=f.a_tbn_quat.offset;y.tN(a.tc,"a_tbn_quat",b.MD,e);y.cN(a)}}h("__config");var b=h("__debug"),y=h("__geometry"),r=h("__obj_util"),A=h("__renderer"),k=h("__subscene"),w=h("__tsr"),n=h("__util"),l=h("__vec3"),f=[k.Pb,k.Pc,k.Nd,k.md,k.xf,k.Oe,k.ge,k.Uf,k.cd,k.yf,k.Cg,k.wf,k.tf,k.ui],v=new Float32Array(3);a.Aw=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,
l=a.type==k.md||a.type==k.Oe,n=a.Ra,h=0;h<n.length;h++){for(var r=n[h],w=r.sa,v=!1,I=0;I<w.length;I++){var z=w[I],d=z.za;if(l)for(var m=0;6>m;m++)a.p.Ph=a.Pq[m],z.JA[m]=p(z,a),z.JA[m]&&(v=b=!0,e(d));else z.cc=p(z,a),z.cc&&(v=b=!0,e(d));a.Ba&&(d.zb.Wr=!0)}r.cc=v}a.Ba=!1;switch(a.type){case k.wf:break;default:a.type==k.Pb||a.type==k.yf||a.type==k.ge||a.type==k.Nd||a.type==k.md||b?a.cc=!0:(a.cc&&A.clear(a),a.cc=!1)}}else if(a.Ba){n=a.Ra;for(h=0;h<n.length;h++)for(w=n[h].sa,I=0;I<w.length;I++)z=w[I],
d=z.za,d.zb.Wr=!0;a.Ba=!1}a.iC&&k.cZ(a)}};b4w.module.__primitives=function(a,h){function p(a,b,f,e){for(var c=[],h=[],p=[],r=[],w=2*f/(a-1),y=2*e/(b-1),R=0;R<a;R++)for(var L=-f+R*w,I=0;I<b;I++)if(h.push(L,-e+I*y,0),r.push(0,0,0,1),p.push(R/(a-1),I/(b-1)),R&&I){var z=R*b+I,d=z-1,m=(R-1)*b+I,O=m-1;c.push(z,d,m);c.push(d,O,m)}a=k.Mg();a.a_position=new Float32Array(h);a.a_tbn_quat=new Float32Array(r);r=A.If("GRID_PLANE");r.aa[0]=a;r.qa.a_texcoord=new Float32Array(p);r.na=new Uint32Array(c);r.Ja=h.length/3;return r}function e(a){var b=a.length;
b%4&&k.q("Wrong array");for(var f=[],e=[],c=0;c<b;c+=4){var h=a[c+1],p=a[c+2],r=a[c+3];y(a[c],e);y(h,e);y(p,e);y(r,e);f.push(c,c+1,c+2);f.push(c,c+2,c+3)}a=k.Mg();a.a_position=new Float32Array(e);b=A.If("FROM_QUADS");b.aa[0]=a;b.na=new Uint32Array(f);b.Ja=e.length/3;return b}function b(a,b){var f=3*b;return[a[f],a[f+1],a[f+2]]}function y(a,b){b.push(a[0],a[1],a[2])}var r=h("__config"),A=h("__geometry");h("__print");var k=h("__util"),w=r.B;a.HU=function(){var a=A.If("LINE"),b=k.Mg();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.na=new Uint32Array(1);a.Ja=1;return a};a.n4=function(a,b){var f=p(2,2,a,b);f.name="PLANE";return f};a.m4=p;a.AU=function(a,b,f){function e(a,b){return 1==a%2&&(0==b||b==r-1)||1==b%2&&(0==a||a==p-1)?!0:!1}var c=f/=Math.pow(2,a-1),h=f,p=b+1,r=b+1;b=[];f=[];for(var y=[],D=0,R=0,L=-1,I=[],z=0;z<a;z++){for(var d=2*c/(p-1),m=2*h/(r-1),O=[],x=[],g=0,P=0;P<p;P++){for(var t=-c+P*d,da=[],J=0;J<r;J++){var F=-h+J*m;if(t>-D&&t<D&&F>-R&&F<R)da.push(-1),g++;else{for(var T=
null,N=0;N<I.length;N+=3)if(t==I[N]&&F==I[N+1]){T=I[N+2];break}N=null!==T?T:L+1;e(P,J)?(da.push(-2),g++):(null==T&&(0==J||J==r-1||0==P||P==p-1?(T=z==a-1?d:2*d,O.push(t,F,N)):T=d,f.push(t,F,T),y.push(.707,0,0,.707),L++),da.push(N));if(P&&J)if(1==P)if(e(P-1,J)){if(1<J){var F=N-1,T=x[P-1][J+1],ba=T-1;b.push(ba,F,N)}else T=x[P-1][J+1],ba=T-1;b.push(T,ba,N)}else e(P,J)||(F=N-1,T=x[P-1][J],b.push(T,F,N));else if(P==p-1){if(!e(P,J))if(J==r-1)F=N-1,T=x[P-1][J-1],ba=x[P-2][J],b.push(T,F,N),b.push(ba,T,N);
else{var F=N-1,T=x[P-1][J],ba=T-1,u=T+1;b.push(ba,F,N);b.push(T,ba,N);b.push(u,T,N);2==J&&(u=x[P-2][J-2],b.push(ba,u,F))}}else 1==J?e(P,J-1)?(F=x[P-1][J],T=x[P-1][J-1],b.push(F,T,N)):(F=da[J-1],T=x[P-1][J],ba=x[P-2][J-1],b.push(T,F,N),b.push(T,ba,F)):J==r-1?e(P,J)||(F=da[J-1],T=x[P-1][J-1],ba=x[P-2][J],b.push(T,F,N),b.push(ba,T,N)):-1!=x[P-1][J]&&-1!=x[P-1][J-1]&&-1!=da[J-1]?(F=da[J-1],T=x[P-1][J],ba=x[P-1][J-1],b.push(T,F,N),b.push(T,ba,F),J==r-2&&e(P,J+1)&&(u=x[P-1][J+1],b.push(u,T,N))):J==r-2&&
e(P,J+1)&&(T=x[P-1][J],u=x[P-1][J+1],b.push(u,T,N))}}x.push(da)}I=O;D=c;R=h;c*=2;h*=2}if(2E4>D)for(a=-(2*D)/(p-1),f.push(-2E4,-2E4,a),f.push(-2E4,2E4,a),f.push(-D,-R,a),f.push(-D,R,a),f.push(2E4,-2E4,a),f.push(2E4,2E4,a),f.push(D,-R,a),f.push(D,R,a),N=L+1,b.push(N+1,N+2,N+3,N+1,N+0,N+2,N+2,N+4,N+6,N+2,N+0,N+4,N+1,N+7,N+5,N+1,N+3,N+7,N+7,N+4,N+5,N+6,N+4,N+7),P=0;8>P;P++)y.push(.707,0,0,.707);a=k.Mg();a.a_position=new Float32Array(f);a.a_tbn_quat=new Float32Array(y);c=A.If("MULTIGRID_PLANE");c.aa[0]=
a;c.na=new Uint32Array(b);c.Ja=f.length/3;w.FN&&(A.px(c,1,!0),a.a_polyindex=A.Pu(c));return c};a.l4=function(a){var b=a.length;b%3&&k.q("Wrong array");for(var f=[],e=[],c=0;c<b;c+=3){var h=a[c+1],p=a[c+2];y(a[c],e);y(h,e);y(p,e);f.push(c,c+1,c+2)}a=k.Mg();a.a_position=new Float32Array(e);b=A.If("FROM_TRIANGLES");b.aa[0]=a;b.na=new Uint32Array(f);b.Ja=e.length/3;return b};a.k4=e;a.EU=function(a){a=k.N_(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);
b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=e(b);a.name="FRUSTUM";return a};a.Tc=function(){var a=A.If("FULLSCREEN_TRI"),b=k.Mg();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.na=new Uint32Array([0,1,2]);a.Ja=3;return a};a.FU=function(){var a=A.If("FULLSCREEN_QUAD"),b=k.Mg();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,1,2,3]);a.Ja=4;return a};a.zU=function(){var a=A.If("BILLBOARD"),b=k.Mg();b.a_bb_vertex=
A.XH(1);a.aa[0]=b;a.na=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.BU=function(){var a=A.If("CUBEMAP_BOARD"),b=k.Mg();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.Xu=function(a,e){var f=A.If("UV_SPHERE"),h,c,p=[],r=[],w=[];for(c=0;8>=c;c++)for(h=0;16>=h;h++){var G=h/16,D=c/8;r.push(-a*Math.cos(2*G*Math.PI)*Math.sin(D*Math.PI)+e[0],a*Math.cos(D*Math.PI)+e[1],a*Math.sin(2*G*Math.PI)*Math.sin(D*Math.PI)+e[2])}for(c=G=0;8>
c;c++)for(h=0;16>h;h++){var D=b(r,17*c+h+1),R=b(r,17*c+h),L=b(r,17*(c+1)+h),I=b(r,17*(c+1)+h+1);Math.abs(D[1])==a+e[1]?(y(D,p),y(L,p),y(I,p),w.push(G,G+1,G+2),G+=3):Math.abs(L[1])==a+e[1]?(y(D,p),y(R,p),y(L,p),w.push(G,G+1,G+2),G+=3):(y(D,p),y(R,p),y(L,p),y(I,p),w.push(G,G+1,G+2),w.push(G,G+2,G+3),G+=4)}h={};h.a_position=p;r=A.tR(w,r,p);r=A.qR(w,p,r);h.a_tbn_quat=k.or(r);f.aa[0]=h;f.na=w;f.Ja=p.length/3;return f};a.aI=function(a){var b=A.If("INDEX"),f=k.Mg();f.a_index=new Float32Array(3*a);for(var e=
new Uint16Array(3*a),c=0;c<3*a;c++)f.a_index[c]=c,e[c]=c;b.aa[0]=f;b.na=e;b.Ja=3*a;return b}};b4w.module.__scenegraph=function(a,h){function p(a,b){var c=[];t.xg(a,function(b,d,f){-1<c.indexOf(f)?t.OX(a,b,d,f,R(f)):c.push(f)});t.pa(a,function(a,d){for(var f=0;f<d.Za.length;f++){var e=d.Za[f];b||d.type!=J.Nd&&d.type!=J.md&&d.type!=J.Uf||(e.nf=!0);-1<c.indexOf(e)?d.Za[f]=R(e):c.push(e)}})}function e(a,c){t.pa(a,function(b,d){d.type==J.tE&&t.ni(a,b,function(a,b){if(b.type==J.zh)for(var c=0;c<b.Za.length;c++){var d=b.Za[c];d.Na=F.K;d.Ma=F.K}});c||t.ni(a,b,function(a,b,c){"DEPTH"==c.from&&(c.nf=
!0)})});t.pa(a,function(c){var d={};b(a,c,d);for(var f in d){c=d[f];for(var e=c[0],g=0;g<c.length;g++)if(c[g].Na==F.K){e=c[g];break}for(var l=c[0],g=0;g<c.length;g++)if(c[g].Ma==F.K){l=c[g];break}for(var m=c[0],g=0;g<c.length;g++)if(!c[g].nf){m=c[g];break}for(g=0;g<c.length;g++)c[g].Na=e.Na,c[g].Ma=l.Ma,c[g].nf=m.nf}})}function b(a,c,d){t.ni(a,c,function(c,f,e){e.Gc&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),b(a,c,d))});t.Sk(a,c,function(a,b,c){c.Gc&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=t.Wa(a,c);if(c.type==J.zh)for(var f=0;f<c.Za.length;f++){var e=c.Za[f];d[e.from].push(e)}}function y(a){var b=[J.zh,J.dz,J.Jt,J.Nd,J.md,J.Kp],c=t.RD(a),d=[];t.pa(c,function(a,f){for(var e=0;e<f.Za.length;e++){var g=f.Za[e];-1<b.indexOf(f.type)&&(g.xx=!0);var l=n(d,g,r(g));g.kb=l;f.mi[e]=l}for(e=0;e<f.mi.length;e++)l=f.mi[e],w(d,l);t.Sk(c,a,function(e,g,l){-1<b.indexOf(f.type)&&(l.xx=!0);l.kb||((e=A(c,a,l.from))&&l.Gc&&!l.kb?k(d,e):e=n(d,
l,r(l)),l.kb=e)});t.ni(c,a,function(a,b,c){w(d,c.kb)});t.Sk(c,a,function(a,b,c){c.kb&&"NONE"==c.to&&w(d,c.kb)})})}function r(a){a=T.Ih(a);delete a.to;delete a.Gc;delete a.kb;return JSON.stringify(a)}function A(a,b,c){var d=null;t.ni(a,b,function(a,b,f){if(f.Gc&&f.from==f.to&&f.from==c&&f.kb)return d=f.kb,!0});t.Sk(a,b,function(a,b,f){if(f.Gc&&f.from==c&&f.kb)return d=f.kb,!0});return d}function k(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.ND===b&&d.rs++}}function w(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.ND===b&&d.rs&&d.rs--}}function n(a,b,c){if(b.uo)return k(a,b.uo.kb),b.uo.kb;if(b.xx)return l(b);for(var d=null,f=0;f<a.length;f++){var e=a[f];if(e.id==c&&0===e.rs){d=e;break}}if(d&&!ba.OH)return d.rs++,d.ND;b=l(b);a.push({id:c,rs:1,ND:b});return b}function l(a){var b=a.Qm*a.size,c=a.Rm*a.size;switch(a.from){case "COLOR":if(a.nf){var d=F.Kl(a.lk?F.Ot:F.Nt,a.Vs);F.resize(d,b,c)}else d=F.Kl(F.Ah,a.Vs),F.resize(d,b,c),F.cD(d,a.Na,a.Ma);return d;case "DEPTH":return a.nf?(d=F.Kl(a.lk?F.Mt:F.Lt,a.Vs),
F.resize(d,b,c)):(d=F.Kl(F.nl,a.Vs),F.resize(d,b,c),F.cD(d,a.Na,a.Ma)),d;case "CUBEMAP":return d=F.$G(b);case "SCREEN":case "NONE":return null;default:T.q("Wrong slink param: "+a.from)}}function f(a,b){var c=!1;t.xg(a,function(d,f,e){if(e&&(d=t.Wa(a,d),f=t.Wa(a,f),b(e,!1,d,f)))return c=!0});c||t.pa(a,function(a,c){for(var d=0;d<c.Za.length;d++)if(b(c.Za[d],!0,c,null))return!0})}function v(a){t.pa(a,function(b,c){if(c.type!=J.tn){var d=c.p;t.Sk(a,b,function(a,b,c){c.Gc&&c.kb&&(x.Qw(d,c.from,c.kb),
c.from==c.to&&b.p&&x.Qw(b.p,c.from,c.kb))});for(var f=0;f<c.Za.length;f++){var e=c.Za[f];e.Gc&&e.from==e.to&&x.Qw(d,e.from,c.mi[f])}!d.wc&&!d.Ve||d.Ze||(d.Ze=da.KX(d.wc,d.Ve))}});t.pa(a,function(b,c){if(c.type==J.sn||c.type==J.ay){var d=z(a,c);c.p.kr=d[0].p.Ze}})}function c(a){var b=null,c=0;t.pa(a,function(a,d){if(d.type==N.wZ){if(c==N.vZ)return b=d,!0;c++}});return b}function B(a,b){var c=t.gh(a,b),d=J.Ad("NONE"),f=t.J(a,d),e=t.sr(a)[0];t.xg(a,function(b,c){c==e&&t.EX(a,b,e,b,f)});var g=Q(b,a);
t.xg(a,function(f,e,l){if(f==c){if(g){f=J.xu();t.J(a,f);e=D("COLOR","RESOLVE",1,1,1,!0);e.lk=!0;e.nf=!0;var m=D("DEPTH","RESOLVE",1,1,1,!0);m.lk=!0;m.nf=!0;t.r(a,b,f,e);t.r(a,b,f,m);b=f}t.r(a,b,d,D(N.XY,"u_color",l.size,l.Qm,l.Rm,l.Rs));return!0}});t.ed(a,f,e,D("SCREEN","NONE",.5,.5,.5,!0))}function Q(a,b){var c=!1,d=t.gh(b,a);t.rg(b,d)&&(c=t.Wg(b,d,0),d=t.Wd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=t.Wa(b,c),c=Q(d,b)):c="RESOLVE"==d.to);return c}function K(a,b,c,
d){var f=c.da,e=b.xv,g=b.ei.bi,l=b.ei.yw,m=t.nx(a,t.jV(a,d),t.mt),k=[],h=[],n=[],m=t.clone(m,function(b){var d;if(-1<ga.indexOf(b.type))h.push(b),d=b;else{d=J.eS(b);if(d.type==J.Nd)for(var m=0;m<g.length;m++)if(g[m][0]==b){g[m]=[b,d];d.p.rc=b.p.rc;c.da.push(d.p);break}if(b.type==J.xf)for(m=0;m<g.length;m++){if(l[m][0]==b){l[m]=[b,d];d.p=g[m][1].p;break}}else-1<f.indexOf(b.p)&&(e?(x.Xv(b.p,x.Pe),x.Xv(d.p,x.Qe)):(x.Xv(b.p,x.Qc),x.Xv(d.p,x.dd)),f.push(d.p));var p=t.gh(a,b);t.ni(a,p,function(a,b,c){-1<
ga.indexOf(b.type)&&k.push([b,d,c])});if(b.type!==J.zh)for(m=0;m<b.Za.length;m++)d.Za[m].uo=b.Za[m];b=!0;for(m=0;m<t.$n(a,p);m++){var u=t.Si(a,p,m),u=t.Wa(a,u);-1==ga.indexOf(u.type)&&(b=!1)}b&&n.push(d)}return d},function(a){var b=R(a,!0);b.uo=a;return b});t.xg(m,function(a,b,c){t.Wa(m,a).type===J.zh&&(c.uo=null)});for(var p=0;p<h.length;p++)t.ug(m,t.gh(m,h[p]));t.Sz(m);b=J.jT(e);var p=t.J(a,b),u=J.rA();t.J(a,u);var r=D("COLOR","COPY",1,1,1,!0);t.r(a,d,u,r);var w=D("COLOR","u_sampler_left",1,1,1,
!0);w.xx=!0;w.Na=F.K;w.Ma=F.K;t.r(a,u,b,w);d.yc||(d=J.rA(),t.J(m,d),w=D("COLOR","COPY",1,1,1,!0),w.uo=r,r=t.sr(m)[0],r=t.Wa(m,r),t.r(m,r,d,w));d=D("COLOR","u_sampler_right",1,1,1,!0);d.Na=F.K;d.Ma=F.K;t.BQ(m,a,[t.sr(m)[0],p,d]);for(p=0;p<k.length;p++)t.r(a,k[p][0],k[p][1],k[p][2]);d=D("SCREEN","NONE",0,0,0,!1);for(p=0;p<n.length;p++)t.r(a,u,n[p],d);e&&G(a,.5,1);return b}function G(a,b,c){var d=[];t.pa(a,function(b,c){if(-1==ga.indexOf(c.type)&&c.Za.length&&L(a,c,J.xi))for(var f=0;f<c.Za.length;f++){var e=
c.Za[f];-1==d.indexOf(e)&&d.push(e)}});t.xg(a,function(b,c,f){b=t.Wa(a,b);c=t.Wa(a,c);-1==ga.indexOf(b.type)&&L(a,c,J.xi)&&-1==d.indexOf(f)&&d.push(f)});for(var f=0;f<d.length;f++)d[f].Qm*=b,d[f].Rm*=c}function D(a,b,c,d,f,e){return{from:a,to:b,size:c,Qm:d,Rm:f,Rs:e,Gc:!0,kb:null,lk:!1,nf:!1,Na:F.ve,Ma:F.ve,xx:!1,Vs:!1}}function R(a,b){if(b){var c=a.kb;a.kb=null}a.kb&&T.q("Failed to clone slink with attached texture");var d=T.Ih(a);b&&(a.kb=c,d.kb=c);return d}function L(a,b,c){if(b.type==c)return!0;
b=d(a,b);for(var f=0;f<b.length;f++)if(L(a,b[f],c))return!0;return!1}function I(a,b,c){if(b.type==c)return!0;b=z(a,b);for(var d=0;d<b.length;d++)if(I(a,b[d],c))return!0;return!1}function z(a,b){var c=t.gh(a,b);c==t.$y&&T.q("Subscene not in graph");for(var d=[],f=t.$n(a,c),e=0;e<f;e++){var g=t.Si(a,c,e);g!=c&&d.push(t.Wa(a,g))}return d}function d(a,b){var c=t.gh(a,b);c==t.$y&&T.q("Subscene not in graph");for(var d=[],f=t.rg(a,c),e=0;e<f;e++){var g=t.Wg(a,c,e);g!=c&&d.push(t.Wa(a,g))}return d}function m(a){var b=
[],c=[];f(a,function(a){a.kb&&-1==b.indexOf(a.kb)&&(b.push(a.kb),c.push(a.kb,b.length-1))});return c}function O(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.Rs){var d=a.Qm,f=a.Rm;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(f)!=f&&(f=f.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==f?"":f)+"S")}else d=a.Qm,f=a.Rm,c+=a.size*d+"x"+a.size*f;if("SCREEN"!=a.from){c+=" ";if(a.nf)c+="RR";else{var d=a.Na,f=a.Ma,e="";d==F.K?e+="L":d==F.ve&&(e+="N");f==F.K?e+="L":f==F.ve&&(e+="N");c+=e}for(d=
0;d<b.length;d+=2)b[d]==a.kb&&(c+=" "+b[d+1])}return c+")\\n"}var x=h("__camera"),g=h("__config"),P=h("__debug"),t=h("__graph"),da=h("__renderer"),J=h("__subscene"),F=h("__textures"),T=h("__util"),N=g.Tq,ba=g.B,u=g.Eo,ga=[J.vi,J.cd,J.md,J.Oe];a.SR=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.PZ=f;a.GS=function(a,b,f,g){function l(c){var d=x.Hc(Sa,!0);b.da.push(d);d=J.Jl(c,d,!1,
Q,L,Ea,Pa,Ca,a.rj);t.J(m,d);c==J.Uf?(t.r(m,k[0],d,D("COLOR","COLOR",1,1,1,!0)),d.Za.push(D("DEPTH","DEPTH",1,1,1,!0))):(c=Y&&k[0].type==J.sn?Bb:k[0],t.r(m,c,d,Ha),t.r(m,c,d,Cb));Ka&&(t.r(m,Ka,d,kb),t.r(m,Ka,d,eb));for(c=0;c<n.length;c++)t.r(m,n[c],d,r[c]);Wa&&t.r(m,Wa,d,Fa);if(w.length){var f=w.length;for(c=0;c<f;c++)t.r(m,w[c],d,O[c])}if(I.length)for(c=0;c<I.length;c++)t.r(m,I[c],d,A[c]);Ib&&t.r(m,Ib,d,ec);return d}var m=t.create(),k=[],h=[],n=[],r=[],w=[],O=[],I=[],A=[],L=a.gW,Q=a.Mc,G=a.Kk,ga=
a.ZY,M=a.ssao,da=a.god_rays,C=a.ei,za=a.aK,ua=a.cR,ja=a.motion_blur,xa=a.compositing,ka=a.antialiasing,Pa=a.pp,Ea=a.IN,Ca=a.ud,ma=a.RW,Ba=a.CR,va=a.uV,Ma=a.eX,Ga=a.dof,Ra=a.yT,H=a.refractions,V=Boolean(g.length),Y=1<ba.Fc,Cb=D("COLOR","COLOR",1,1,1,!0),Ha=D("DEPTH","DEPTH",1,1,1,!0);if(Y){R(Ha);var Ac=R(Ha);Cb.lk=!0;Cb.nf=!0;Ha.lk=!0;Ha.nf=!0}var Sa=b.da[0];if(Ca){x.bE(Sa,Ca);for(var fa=0;fa<Ca.ah.length;fa++)for(var Da=Ca.csm_num,qa=0;qa<Da;qa++){var W=J.eT(qa,fa,Ca,L);t.J(m,W);n.push(W);var Qa=
Ca.csm_resolution,ra=W.p;b.$L.push(ra);ra.width=Qa;ra.height=Qa;W.wb=!1;var La=D("DEPTH","u_shadow_map"+(0<fa?fa:qa),Qa,1,1,!1);ba.Fq&&(La.Na=F.K,La.Ma=F.K,La.Vs=!0);r.push(La);(P.LR()||ba.aM)&&W.Za.push(D("COLOR","COLOR",Qa,1,1,!1))}}if(C&&C.qK&&!V)for(qa=0;qa<C.qK;qa++){ra=x.gd(x.Od);ra.width=a.Ki;ra.height=a.Ki;x.Sw(ra,90,.1,100);x.Ik(ra,ra.Ab);var Ta=J.Jl(J.md,ra,!1,Q,L,Ea,Pa,null,a.rj);Ta.Ll=T.GU();for(fa=0;6>fa;fa++)Ta.Pq.push(x.uS());t.J(m,Ta);var pb=D("CUBEMAP","u_cube_reflection",a.Ki,1,
1,!1);pb.Na=F.K;pb.Ma=F.K;A.push(pb);if(C.kJ){var Ua=J.Jl(J.Oe,ra,!1,Q,L,Ea,Pa,null,a.rj);Ua.Ll=Ta.Ll;Ua.Pq=Ta.Pq;t.J(m,Ua);var Aa=D("DEPTH","DEPTH",a.Ki,1,1,!1),ab=D("COLOR","COLOR",a.Ki,1,1,!1);t.r(m,Ta,Ua,Aa);t.r(m,Ta,Ua,ab);I.push(Ua);C.wA.push(Ua)}else{var Ya=D("DEPTH","DEPTH",a.Ki,1,1,!1);Ta.Za.push(Ya);I.push(Ta)}C.Ji.push(Ta)}if(C&&0<C.YK.length&&!V)for(fa=0;fa<C.YK.length;fa++)ra=x.Hc(Sa,!0),ra.rc=new Float32Array(4),b.da.push(ra),Ta=J.Jl(J.Nd,ra,!1,Q,L,Ea,Pa,null,a.rj),t.J(m,Ta),pb=D("COLOR",
"u_plane_reflection",1,a.kh,a.kh,!0),pb.Na=F.K,pb.Ma=F.K,O.push(pb),C.kJ?(Ua=J.Jl(J.xf,ra,!1,Q,L,Ea,Pa,null,a.rj),t.J(m,Ua),Aa=D("DEPTH","DEPTH",1,a.kh,a.kh,!0),ab=D("COLOR","COLOR",1,a.kh,a.kh,!0),ab.Na=F.ve,ab.Ma=F.ve,t.r(m,Ta,Ua,Aa),t.r(m,Ta,Ua,ab),C.yw.push([Ua]),w.push(Ua)):(Ya=D("DEPTH","DEPTH",1,a.kh,a.kh,!0),Ta.Za.push(Ya),w.push(Ta)),C.bi.push([Ta]);if(a.hd){var Ka=J.YS();t.J(m,Ka);Qa=u.zr;Ka.p.width=Qa;Ka.p.height=Qa;var kb=D("DEPTH","u_grass_map_depth",Qa,1,1,!1);ba.ec||(kb.Na=F.K,kb.Ma=
F.K);var eb=D("COLOR","u_grass_map_color",Qa,1,1,!1);eb.Na=F.K;eb.Ma=F.K}else eb=kb=Ka=null;if(Ra&&Ca){var bb=x.Hc(Sa,!0);b.da.push(bb);var sb=J.fT(bb,L);t.J(m,sb);sb.self_shadow_normal_offset=Ca.self_shadow_normal_offset;for(qa=0;qa<n.length;qa++)W=n[qa],t.r(m,W,sb,r[qa]);var lb=D("COLOR","u_color",1,1,1,!0),nb=D("DEPTH","u_depth",1,1,1,!0);if(M){var wb=x.Hc(Sa,!0);b.da.push(wb);var Va=a.oZ,Ob=J.hT(wb,Ea,Va);t.J(m,Ob);var ic=D("COLOR","u_ssao_mask",1,1,1,!0);t.r(m,sb,Ob,lb);t.r(m,sb,Ob,nb);var Wb=
x.Hc(Sa,!0);b.da.push(Wb);var qb=J.iT(Wb,Va);t.J(m,qb);var nd=D("COLOR","u_shadow_mask",1,1,1,!0);t.r(m,Ob,qb,ic);t.r(m,sb,qb,nb)}Y?sb.Za.push(D("DEPTH","DEPTH",1,1,1,!0)):sb.Za.push(Ha);Ka&&(t.r(m,Ka,sb,kb),t.r(m,Ka,sb,eb))}else sb=null;var Bb=J.Jl(J.Pb,Sa,!0,Q,L,Ea,Pa,null,a.rj);t.J(m,Bb);if(Y){var fb=J.xu();t.J(m,fb);h.push(fb);var jc=D("COLOR","RESOLVE",1,1,1,!0);jc.lk=!0;jc.nf=!0;var Nc=D("DEPTH","RESOLVE",1,1,1,!0);Nc.lk=!0;Nc.nf=!0;t.r(m,Bb,fb,jc);t.r(m,Bb,fb,Nc)}else h.push(Bb);sb&&(ic?t.r(m,
qb,Bb,nd):Ca?t.r(m,sb,Bb,D("COLOR","u_shadow_mask",1,1,1,!0)):T.q("Internal error"));Ka&&(t.r(m,Ka,Bb,kb),t.r(m,Ka,Bb,eb));if(w.length)for(var Wc=w.length,fa=0;fa<Wc;fa++)t.r(m,w[fa],Bb,O[fa]);if(I.length)for(fa=0;fa<I.length;fa++)t.r(m,I[fa],Bb,A[fa]);k=h;h=[];if(!V&&a.fS){ra=x.Hc(Sa,!0);ra.width=1;ra.height=1;b.da.push(ra);var tc=J.hH(ra,!1,L);t.J(m,tc);if(a.vh){ra=x.Hc(Sa,!0);ra.width=1;ra.height=1;b.da.push(ra);var Qc=J.hH(ra,!0,L);t.J(m,Qc);t.r(m,tc,Qc,D("COLOR","COLOR",1,1,1,!1));t.r(m,tc,Qc,
D("DEPTH","DEPTH",1,1,1,!1))}}else tc=null;if(!za.refractions&&!H||V)Ib=null;else{if(Y)Ib=fb;else{var Ib=J.rA();t.J(m,Ib);t.r(m,k[0],Ib,D("COLOR","COPY",1,1,1,!0))}var ec=D("COLOR","u_refractmap",1,1,1,!0)}if(Ra&&(H||G||ga)){var xb=x.Hc(Sa,!0);b.da.push(xb);var Wa=J.VS(xb);t.J(m,Wa);t.r(m,Y?fb:Bb,Wa,D("DEPTH","u_depth",1,1,1,!0));var Fa=D("COLOR","u_scene_depth",1,1,1,!0);Fa.Na=F.ve;Fa.Ma=F.ve}else Wa=null;if(a.kv){var yb=l(J.Pc);h.push(yb);k=h;h=[]}if(a.Ui){var Rc=x.Hc(Sa,!0);b.da.push(Rc);var Xb=
J.Jl(J.ge,Rc,!1,Q,L,Ea,Pa);t.J(m,Xb);Wa&&t.r(m,Wa,Xb,Fa);Ib&&t.r(m,Ib,Xb,ec);Ka&&(t.r(m,Ka,Xb,kb),t.r(m,Ka,Xb,eb));if(w.length)for(Wc=w.length,fa=0;fa<Wc;fa++)t.r(m,w[fa],Xb,O[fa]);if(I.length)for(fa=0;fa<I.length;fa++)t.r(m,I[fa],Xb,A[fa]);t.r(m,Y?fb:Bb,Xb,Y?Ac:Ha);var Bc=J.Ad("X_GLOW_BLUR");Bc.Fb="GLOW_MASK_SMALL";Bc.wg=a.$j.small_glow_mask_width;var dd=D("COLOR","u_color",1,1,1,!0);dd.Na=F.K;dd.Ma=F.K;t.J(m,Bc);t.r(m,Xb,Bc,dd);var uc=J.Ad("Y_GLOW_BLUR");uc.Fb="GLOW_MASK_SMALL";uc.wg=a.$j.small_glow_mask_width;
var Zb=D("COLOR","u_color",1,.5,.5,!0);Zb.Na=F.K;Zb.Ma=F.K;t.J(m,uc);t.r(m,Bc,uc,Zb);var Xc=J.Ad("X_GLOW_BLUR");Xc.Fb="GLOW_MASK_LARGE";Xc.wg=a.$j.large_glow_mask_width;var ed=D("COLOR","u_color",1,.5,.5,!0);ed.Na=F.K;ed.Ma=F.K;t.J(m,Xc);t.r(m,uc,Xc,ed);var $b=J.Ad("Y_GLOW_BLUR");$b.Fb="GLOW_MASK_LARGE";$b.wg=a.$j.large_glow_mask_width;var cb=D("COLOR","u_color",1,.25,.25,!0);cb.Na=F.K;cb.Ma=F.K;t.J(m,$b);t.r(m,Xc,$b,cb);var vd=x.Hc(Sa,!0);b.da.push(vd);var Fc=J.WS(vd,a);t.J(m,Fc);var ib=D("COLOR",
"u_src_color",1,1,1,!0);if(a.kv)if(Y){var od=J.xu();t.J(m,od);t.r(m,yb,od,jc);t.r(m,yb,od,Nc);t.r(m,od,Fc,ib)}else t.r(m,yb,Fc,ib);else t.r(m,Y?fb:Bb,Fc,ib);t.r(m,a.kv?yb:Bb,Fc,Ha);var Cc=D("COLOR","u_glow_mask_small",1,.5,.5,!0);Cc.Na=F.K;Cc.Ma=F.K;t.r(m,uc,Fc,Cc);var kc=D("COLOR","u_glow_mask_large",1,.25,.25,!0);kc.Na=F.K;kc.Ma=F.K;t.r(m,$b,Fc,kc);k=[Fc];h=[]}a.kv||(yb=l(J.Pc),h.push(yb),k=h,h=[]);if(ba.debug_view){ra=x.Hc(Sa,!0);b.da.push(ra);var Qb=J.US(ra);h.push(Qb);t.J(m,Qb);t.r(m,k[0],Qb,
Cb);t.r(m,k[0],Qb,Ha);Ka&&(t.r(m,Ka,Qb,kb),t.r(m,Ka,Qb,eb));P.kY(Qb);k=h;h=[]}if(Y){var Pb=J.xu();t.J(m,Pb);h.push(Pb);t.r(m,k[0],Pb,jc);t.r(m,k[0],Pb,Nc);k=h;h=[]}var lc=k.slice(0);if(!V&&a.hQ){ra=x.Hc(Sa,!0);b.da.push(ra);var Gc=J.QS(ra);t.J(m,Gc);t.r(m,k[0],Gc,Y?Ac:Ha)}if(da&&Ra&&!V){var Jb=va.ko,mc=va.zB,rb=va.Wo,db=k[0],ac=Q?!0:!1,Yc=D("DEPTH","u_input",1,1,1,!0),Db=D("COLOR","u_input",1,.25,.25,!0);Db.Na=F.K;Db.Ma=F.K;var Rb=Jb/rb,gb=x.Hc(Sa,!0);b.da.push(gb);var ob=J.sA(gb,ac,Jb,!0,Rb,L,rb);
t.J(m,ob);t.r(m,db,ob,Yc);var Rb=Jb/rb*.5,Hc=x.Hc(Sa,!0);b.da.push(Hc);var nc=J.sA(Hc,ac,Jb,!1,Rb,L,rb);t.J(m,nc);t.r(m,ob,nc,Db);var Rb=Jb/rb*.25,Ic=x.Hc(Sa,!0);b.da.push(Ic);var Kb=J.sA(Ic,ac,Jb,!1,Rb,L,rb);t.J(m,Kb);t.r(m,nc,Kb,Db);var oc=J.XS(mc,L);h.push(oc);t.J(m,oc);t.r(m,db,oc,D("COLOR","u_main",1,1,1,!0));t.r(m,Kb,oc,D("COLOR","u_god_rays",1,1,1,!0));k=h;h=[]}if(ua&&!V){var db=k[0],bc=J.ZS();t.J(m,bc);t.r(m,db,bc,D("COLOR","u_input",1,1,1,!0));var Za=J.RS();t.J(m,Za);Za.p.width=ba.br?2:1;
Za.p.height=ba.br?2:1;var cc=D("COLOR","u_input",1,.25,.25,!0);cc.Na=F.K;cc.Ma=F.K;var Lb=D("COLOR","u_luminance",1,.25,.25,!0);Lb.Na=F.K;Lb.Ma=F.K;t.r(m,bc,Za,cc);var tb=ua.key,pc=ua.edge_lum,ub=x.Hc(Sa,!0);b.da.push(ub);var Mb=J.$S(tb,pc,L,ub);t.J(m,Mb);t.r(m,db,Mb,D("COLOR","u_main",1,1,1,!0));t.r(m,bc,Mb,Lb);t.r(m,Za,Mb,D("COLOR","u_average_lum",1,1,1,!1));var Sb=D("COLOR","u_color",1,.25,.25,!0);Sb.Na=F.K;Sb.Ma=F.K;Bc=J.gH("X_BLUR");t.J(m,Bc);t.r(m,Mb,Bc,Sb);uc=J.gH("Y_BLUR");t.J(m,uc);t.r(m,
Bc,uc,Sb);var vc=J.SS(ua.blur);t.J(m,vc);var Jc=D("COLOR","u_bloom",1,.25,.25,!0);Jc.Na=F.K;Jc.Ma=F.K;t.r(m,uc,vc,Jc);t.r(m,db,vc,D("COLOR","u_main",1,1,1,!0));h.push(vc);k=h;h=[]}if(Ga&&Ra&&!V){var db=k[0],Ia=x.Hc(Sa,!0);b.da.push(Ia);if(f.dof_bokeh){var fc=D("COLOR","u_color",1,1,1,!0);fc.Na=F.K;fc.Ma=F.K;var Eb=D("DEPTH","u_depth",1,1,1,!0),Fb=D("COLOR","u_color",1,.5,.5,!0);Fb.Na=F.ve;Fb.Ma=F.ve;Sb=D("COLOR","u_color",1,.5,.5,!0);Sb.Na=F.ve;Sb.Ma=F.ve;var Dc=D("COLOR","u_blurred1",1,.5,.5,!0);
Dc.Na=F.K;Dc.Ma=F.K;var Tb=D("COLOR","u_blurred2",1,.5,.5,!0);Tb.Na=F.K;Tb.Ma=F.K;var jb=lc[0];if(f.Cd){var hb=x.Hc(Sa,!0);b.da.push(hb);var Ja=J.qA(hb,"COC_FOREGROUND");hb.dof_distance=f.dof_distance;hb.dof_object=f.dof_object;hb.dof_front_start=f.dof_front_start;hb.dof_front_end=f.dof_front_end;hb.dof_rear_start=f.dof_rear_start;hb.dof_rear_end=f.dof_rear_end;hb.dof_power=f.dof_power;hb.dof_bokeh=f.dof_bokeh;hb.dof_bokeh_intensity=f.dof_bokeh_intensity;hb.Cd=f.Cd;hb.dof_on=!0;t.J(m,Ja);t.r(m,db,
Ja,fc);t.r(m,jb,Ja,Eb);var Yb=J.Ad("X_ALPHA_BLUR");t.J(m,Yb);t.r(m,Ja,Yb,Fb);var Gb=J.Ad("Y_ALPHA_BLUR");t.J(m,Gb);t.r(m,Yb,Gb,Sb);var Na=x.Hc(Sa,!0),Oa=J.qA(Na,"COC_COMBINE");b.da.push(Na);Na.dof_distance=f.dof_distance;Na.dof_object=f.dof_object;Na.dof_front_start=f.dof_front_start;Na.dof_front_end=f.dof_front_end;Na.dof_rear_start=f.dof_rear_start;Na.dof_rear_end=f.dof_rear_end;Na.dof_power=f.dof_power;Na.dof_bokeh=f.dof_bokeh;Na.dof_bokeh_intensity=f.dof_bokeh_intensity;Na.Cd=f.Cd;Na.dof_on=!0;
t.J(m,Oa);t.r(m,db,Oa,fc);t.r(m,jb,Oa,Eb);t.r(m,Gb,Oa,D("COLOR","u_coc_fg",1,.5,.5,!0))}else Na=x.Hc(Sa,!0),b.da.push(Na),Oa=J.qA(Na,"COC_ALL"),Na.dof_distance=f.dof_distance,Na.dof_object=f.dof_object,Na.dof_front_start=f.dof_front_start,Na.dof_front_end=f.dof_front_end,Na.dof_rear_start=f.dof_rear_start,Na.dof_rear_end=f.dof_rear_end,Na.dof_power=f.dof_power,Na.dof_bokeh=f.dof_bokeh,Na.dof_bokeh_intensity=f.dof_bokeh_intensity,Na.Cd=f.Cd,Na.dof_on=!0,t.J(m,Oa),t.r(m,db,Oa,fc),t.r(m,jb,Oa,Eb);var mb=
J.Ad("X_DOF_BLUR");mb.p.dof_bokeh_intensity=f.dof_bokeh_intensity;t.J(m,mb);t.r(m,Oa,mb,Fb);var Oc=J.Ad("Y_DOF_BLUR");Oc.p.dof_bokeh_intensity=f.dof_bokeh_intensity;t.J(m,Oc);t.r(m,mb,Oc,Sb);var Kc=J.Ad("Y_DOF_BLUR");Kc.p.dof_bokeh_intensity=f.dof_bokeh_intensity;t.J(m,Kc);t.r(m,mb,Kc,Sb);var vb=J.iH(Ia);Ia.dof_distance=f.dof_distance;Ia.dof_object=f.dof_object;Ia.dof_front_start=f.dof_front_start;Ia.dof_front_end=f.dof_front_end;Ia.dof_rear_start=f.dof_rear_start;Ia.dof_rear_end=f.dof_rear_end;Ia.dof_power=
f.dof_power;Ia.dof_bokeh=f.dof_bokeh;Ia.dof_bokeh_intensity=f.dof_bokeh_intensity;Ia.Cd=f.Cd;Ia.dof_on=!0;h.push(vb);t.J(m,vb);t.r(m,db,vb,D("COLOR","u_sharp",1,1,1,!0));t.r(m,Oc,vb,Dc);t.r(m,Kc,vb,Tb)}else{var Ec=D("COLOR","u_color",1,1,1,!0);Ec.Na=F.K;Ec.Ma=F.K;var Ub=D("COLOR","u_color",1,1,1,!0);Ub.Na=F.K;Ub.Ma=F.K;mb=J.Ad("X_BLUR");t.J(m,mb);t.r(m,db,mb,Ec);var dc=J.Ad("Y_BLUR");t.J(m,dc);t.r(m,mb,dc,Ub);var fd=lc[0],vb=J.iH(Ia);Ia.dof_distance=f.dof_distance;Ia.dof_object=f.dof_object;Ia.dof_front_start=
f.dof_front_start;Ia.dof_front_end=f.dof_front_end;Ia.dof_rear_start=f.dof_rear_start;Ia.dof_rear_end=f.dof_rear_end;Ia.dof_power=f.dof_power;Ia.dof_bokeh=f.dof_bokeh;Ia.dof_bokeh_intensity=f.dof_bokeh_intensity;Ia.Cd=f.Cd;Ia.dof_on=!0;h.push(vb);t.J(m,vb);t.r(m,db,vb,D("COLOR","u_sharp",1,1,1,!0));t.r(m,dc,vb,D("COLOR","u_blurred",1,1,1,!0));t.r(m,fd,vb,D("DEPTH","u_depth",1,1,1,!0))}k=h;h=[]}if(a.vh){var Zc=l(J.Uf);h.push(Zc);k=h;h=[]}if(ja&&!V){var Sc=k[0],$c=J.aT(ma.mb_decay_threshold,ma.mb_factor);
h.push($c);t.J(m,$c);t.r(m,Sc,$c,D("COLOR","u_mb_tex_curr",1,1,1,!0));$c.Za.push(D("COLOR","u_mb_tex_accum",1,1,1,!0));k=h;h=[]}if(!V&&a.outline){var db=k[0],zb=x.Hc(Sa,!0);b.da.push(zb);var Ab=J.cT(zb,L);t.J(m,Ab);var wc=J.Ad("X_EXTEND"),gd=D("COLOR","u_color",1,1,1,!0),Xa=D("COLOR","u_outline_mask",1,1,1,!0);wc.Fr=!0;t.J(m,wc);t.r(m,Ab,wc,gd);var $a=D("COLOR","u_color",1,.5,.5,!0);$a.Na=F.K;$a.Ma=F.K;var Tc=J.Ad("Y_EXTEND");Tc.Fr=!0;t.J(m,Tc);t.r(m,wc,Tc,$a);mb=J.Ad("X_BLUR");mb.Fr=!0;t.J(m,mb);
t.r(m,Tc,mb,$a);var gc=D("COLOR","u_color",1,.25,.25,!0);gc.Na=F.K;gc.Ma=F.K;var Nb=D("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Nb.Na=F.K;Nb.Ma=F.K;dc=J.Ad("Y_BLUR");dc.Fr=!0;t.J(m,dc);t.r(m,mb,dc,gc);var xc=J.bT(Ma);t.J(m,xc);t.r(m,db,xc,D("COLOR","u_outline_src",1,1,1,!0));t.r(m,Ab,xc,Xa);t.r(m,dc,xc,Nb);h.push(xc);k=h;h=[]}p(m,Ra);if((a.anaglyph_use||a.xv)&&!V){var hd=K(m,a,b,k[0]);h.push(hd);k=h;h=[]}if(xa&&!V){var db=k[0],Uc=J.TS(Ba.brightness,Ba.contrast,Ba.exposure,Ba.saturation);t.J(m,
Uc);t.r(m,db,Uc,D("COLOR","u_color",1,1,1,!0));h.push(Uc);k=h;h=[]}if(ka){db=k[0];if(ba.smaa){var yc=D("COLOR","u_color",1,1,1,!0);yc.Na=F.K;yc.Ma=F.K;var qc=J.tA(J.It,a);t.J(m,qc);t.r(m,db,qc,yc);var Lc=J.tA(J.Op,a);t.J(m,Lc);t.r(m,qc,Lc,yc);var Vc=D("COLOR","u_search_tex",1,1,1,!1),hc=D("COLOR","u_area_tex",1,1,1,!1);Vc.Na=F.K;Vc.Ma=F.K;hc.Na=F.K;hc.Ma=F.K;Lc.Za.push(Vc);Lc.Za.push(hc);var rc=J.tA(J.Jt,a);t.J(m,rc);t.r(m,db,rc,yc);var Vb=D("COLOR","u_blend",1,1,1,!0);Vb.Na=F.K;Vb.Ma=F.K;t.r(m,Lc,
rc,Vb);h.push(rc)}else{var Mc=J.PS(a);t.J(m,Mc);var jd=D("COLOR","u_color",1,1,1,!0);jd.Na=F.K;jd.Ma=F.K;t.r(m,db,Mc,jd);h.push(Mc)}k=h;h=[]}var zc=t.gh(m,k[0]);if(k[0].type==J.zh||k[0].type==J.sn)var pd=!0;else pd=!1,t.ni(m,zc,function(a,b,c){if(c.from==c.to)return pd=!0});if(pd){var kd=J.Ad("NONE");t.J(m,kd);t.r(m,k[0],kd,D("COLOR","u_color",1,1,1,!0));h.push(kd);k=h;h=[]}h.push(k[0]);tc&&(Qc?h.push(Qc):h.push(tc));Gc&&h.push(Gc);Qa=u.Au;if(a.ex.aL){var ld=a.ex,wd=a.pp,qd=wd.Oo,Qa=qd?qd.EZ:Qa,ad=
J.gT(wd,L,ld,Qa);t.J(m,ad);h.push(ad)}var sc=J.jH();t.J(m,sc);for(qa=0;qa<h.length;qa++){var bd=h[qa];switch(bd.type){case J.tf:case J.ui:t.r(m,bd,sc,D("COLOR","NONE",1,1,1,!1));t.r(m,bd,sc,D("DEPTH","NONE",1,1,1,!1));break;case J.Dg:t.r(m,bd,sc,D("CUBEMAP","u_sky",Qa,1,1,!1));break;case J.kn:t.r(m,bd,sc,D("COLOR","NONE",1,1,1,!0));break;default:if(V){var rd=g[0],cd=D("COLOR","OFFSCREEN",1,1,1,!0);cd.kb=rd;t.r(m,h[qa],sc,cd);for(fa=1;fa<g.length;fa++){var sd=g[fa],Hb=J.Ad("NONE");t.J(m,Hb);t.r(m,
h[qa],Hb,D("COLOR","SCALE",1,1,1,!0));var xd=sd.nj/rd.nj,cd=D("COLOR","OFFSCREEN",1,xd,xd,!0);cd.kb=sd;t.r(m,Hb,sc,cd)}}else t.r(m,h[qa],sc,D("SCREEN","NONE",1,1,1,!0))}}fb&&!d(m,fb).length&&(t.ug(m,t.gh(m,fb)),t.Sz(m));p(m,Ra);e(m,Ra);if(N.enabled){var Pc=c(m);Pc&&B(m,Pc)}y(m);v(m);Ca&&t.pa(m,function(a,b){if(b.type==J.yf||b.type==J.Pc||b.type==J.Uf){for(var c=0,d=z(m,b),f=0,e=0;e<d.length;e++){var g=d[e];g.type==J.cd&&(f++,b.Gm=b.Gm||[],b.Gm[0<g.ph?g.ph:c]=g.p.xb,c++)}b.Bx&&b.Ax||(ba.Wv?b.hE=new Float32Array(9*
f):(b.Bx=new Float32Array(4*f),b.Ax=new Float32Array(4*f)))}});return m};a.XW=G;a.Jd=function(a,b,c){var d=a.wg;a.OD[0]=b*a.Gb[0]*d;a.OD[1]=c*a.Gb[1]*d};a.Lc=function(a,b){a.wg=b};a.ES=function(){var a=t.create(),b=J.dT(),c=x.gd(x.pd);c.width=512;c.height=512;b.p=c;t.J(a,b);b.Za.push(D("COLOR","u_color",512,1,1,!1));c=J.jH();t.J(a,c);t.r(a,b,c,D("COLOR","NONE",512,1,1,!1));y(a);v(a);return a};a.lU=function(a){var b=null;t.pa(a,function(a,c){return c.p&&null===c.p.Ze?(b=c,!0):!1});return b};a.Db=function(a,
b,c){a=z(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.hB=function(a,b,c){a=z(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.i6=L;a.l6=I;a.hV=z;a.lV=d;a.gc=function(a,b){var c=null;t.pa(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.tT=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=m(a);t.pa(a,function(a,d){var f=
b+="    ",e=J.DD(d);if(d.p){for(var e=e+"\\n",g=0;g<c.length;g+=2){var m=d.p.wc;c[g]==m&&(e=F.eo(m)?e+("CR"+c[g+1]+" "):e+("C"+c[g+1]+" "))}for(g=0;g<c.length;g+=2)m=d.p.Ve,c[g]==m&&(e=F.eo(m)?e+("DR"+c[g+1]):e+("D"+c[g+1]))}d.Za.length&&(e+="\\n-----\\n");for(g=0;g<d.Za.length;g++)e+=O(d.Za[g],c);g=d.type==J.tn?"dotted":d.Ud?"solid":"dashed";b=f+(String(a)+' [label="'+e+'" color="black" style="'+(g+",bold")+'"];\n')});t.xg(a,function(a,d,f){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+O(f,
c)+'" style="'+(f.Gc?"solid":"dotted")+'"];\n'});return b+="}"};a.HS=function(a){a=t.HZ(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.Ud&&b.push(d)}return b}};b4w.module.__textures=function(a,h){function p(){return{type:0,source:"",Is:"",width:0,height:0,Hq:1,anisotropic_filtering:"",nj:1024,Sl:!1,Xf:null,nb:0,sb:null,Ne:null,sm:!1,ft:-1,Ta:null,Fx:"",kk:0,Vg:0,va:0,Tb:0,Yj:0,lg:!1,nh:1,td:null,ys:0,xs:0,lj:-1,As:!1,Fk:-1,dt:!1,eE:!1,vj:!1,Xk:!1,repeat:!0,Br:"",Yn:"",Zn:"",vB:"",uB:"",Bv:!1,km:"",Fz:"",ok:0}}function e(a,b,c){a.Zn=b.uuid;a.Yn=b.filepath;a.vB=b.source;a.uB=b.name;a.Br=ha.gj(c+b.filepath);if(a.Bv=b.Dh)a.km=b.Sp;ia.push(a)}function b(a,b,
c){var d=-1<b.indexOf(".dds"),f=-1<b.indexOf(".pvr");a.Bv=d||f;a.km=d?"dds":f?"pvr":"";a.Yn=b;a.Br=c}function y(b,c){var d=p();d.type=b;d.source="NONE";if(b==a.Nt||b==a.Lt||b==a.Ot||b==a.Mt)d.Ne=M.createRenderbuffer();else{var f=M.TEXTURE_2D,e=M.createTexture();M.bindTexture(f,e);M.texParameteri(f,M.TEXTURE_MAG_FILTER,M.LINEAR);M.texParameteri(f,M.TEXTURE_MIN_FILTER,M.LINEAR);M.texParameteri(f,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE);M.texParameteri(f,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE);var g=Q(d),m=K(d),
l=G(d),k=b==a.nl?null:new Uint8Array([204,204,204,255]);M.texImage2D(f,0,m,1,1,0,g,l,k);pa.Fq&&c&&M.texParameterf(f,M.TEXTURE_COMPARE_MODE,M.COMPARE_REF_TO_TEXTURE);M.bindTexture(f,null);d.nb=f;d.sb=e}return d}function r(a){"CANVAS"!=a.source&&ha.q("Wrong texture");var b=a.nb;M.bindTexture(b,a.sb);var c=Q(a),d=K(a),f=G(a),e=a.Xf.canvas;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);M.texImage2D(b,0,d,c,f,e);M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!1);a.Sl&&M.generateMipmap(b);M.bindTexture(b,null);a.width=e.width;
a.height=e.height}function A(a){var b=a.nb;M.bindTexture(b,a.sb);M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ta.length?a.lg?n(a,a.Ta,a.width*a.nh,a.height*a.nh,!1):M.texImage2D(b,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,a.Ta):M.texImage2D(b,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,a.Ta);M.bindTexture(b,null)}function k(a){var b=a.nb;M.bindTexture(b,a.sb);M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);a.lg?n(a,a.td[a.lj],a.width*a.nh,a.height*a.nh,!1):M.texImage2D(b,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,a.td[a.lj]);M.bindTexture(b,
null)}function w(){ya||(ya=document.createElement("canvas"));return ya}function n(a,b,c,d,e){e||(f(M.TEXTURE_2D),M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,b));M.bindTexture(M.TEXTURE_2D,null);q.IT(a,c,d,la,wa)}function l(a,b,c,d){for(var f=0;6>f;f++){var e=d[f],g=w();g.width=c;g.height=c;var m=g.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(m.translate(0,c),m.scale(1,-1)):(m.translate(c,0),m.scale(-1,1));m.drawImage(a,e[1]*b,e[2]*b,b,b,0,0,c,c);M.texImage2D(M["TEXTURE_CUBE_MAP_"+
e[0]],0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,g)}}function f(a){la||(la=M.createFramebuffer());M.bindTexture(a,null);wa||(wa=M.createTexture());M.bindTexture(a,wa);M.texParameteri(a,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE);M.texParameteri(a,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE);M.texParameteri(a,M.TEXTURE_MAG_FILTER,M.LINEAR);M.texParameteri(a,M.TEXTURE_MIN_FILTER,M.LINEAR)}function v(a,b,d){var e=a.source,g=a.sb,m=a.nb,k=a.km,h=a.Yn,p=1,t=1;M.bindTexture(m,g);a.repeat?(M.texParameteri(m,M.TEXTURE_WRAP_S,M.REPEAT),
M.texParameteri(m,M.TEXTURE_WRAP_T,M.REPEAT)):(M.texParameteri(m,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(m,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE));if(4==b.length){var r=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==e)if(r)M.texImage2D(m,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(k){t=u.gJ(b,k);r=ha.tq(t.width)||ha.tq(t.height);if(t.width>aa.Ec||t.height>aa.Ec){E.error('Image "'+h+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+
aa.Ec+"x"+aa.Ec+".");return}p=t.width;t=t.height;if(r||"pvr"==k)a.lg=!0,f(m),p=B(p*a.nh),t=B(t*a.nh);"dds"==k?u.B_(M,Z.OI(),b,!0):"pvr"==k&&u.C_(M,Z.KI(),b);a.lg&&(n(a,null,p,t,!0),M.bindTexture(m,g),M.generateMipmap(m));a.width=p;a.height=t;a.Hq=u.QU(b,k)}else{M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);a.sm?pa.zs?(p=b[0].width,t=b[0].height):(p=b.videoWidth,t=b.videoHeight):(p=b.width,t=b.height);a.width=p;a.height=t;if(p>aa.Ec||p>aa.Ec)E.warn('Image "'+h+'" has unsupported size: '+p+"x"+t+". Max available: "+
aa.Ec+"x"+aa.Ec+". Reduced image size will be used."),a.nh=Math.min(aa.Ec/p,aa.Ec/t),a.lg=!0;a.sm&&(d in na||(na[d]={}),na[d][a.Fx]=a,pa.zs?(a.td=b,a.ys=b.length,a.Vg=a.xs*a.kk/b.length,b=b[0]):(a.Ta=b,a.Ta.loop=a.vj,a.Vg=b.duration?a.kk/b.duration:ca.rd(),oa.DH||(b.playbackRate=ca.rd()/a.Vg,oa.KG&&2<b.playbackRate&&(b.playbackRate=2)),c(a)));p=B(a.width*a.nh);t=B(a.height*a.nh);a.lg?(h=w(),g=h.getContext("2d"),h.width=p,h.height=t,g.drawImage(b,0,0,a.width,a.height,0,0,p,t),M.texImage2D(m,0,M.RGBA,
M.RGBA,M.UNSIGNED_BYTE,h)):pa.ec||!ha.tq(a.width)&&!ha.tq(a.height)?M.texImage2D(m,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,b):(n(a,b,p,t,!1),a.lg=!0);g=a.sb;a.sm||(M.bindTexture(m,g),M.generateMipmap(m),M.bindTexture(m,null));a.width=p;a.height=t}else if("ENVIRONMENT_MAP"==e)if(p=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],r){for(h=0;6>h;h++)M.texImage2D(M["TEXTURE_CUBE_MAP_"+p[h][0]],0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,b);a.width=
3;a.height=2}else{M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){E.error('Cubemap Image "'+h+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}t=b.width/3;t>aa.Zi?(E.warn('Cubemap Image "'+h+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*aa.Zi+"x"+2*aa.Zi+". Reduced image size will be used."),h=B(aa.Zi/t*t),a.lg=!0):(h=B(t),!pa.ec&&(3*h>aa.Ec||2*h>aa.Ec)&&(a.lg=!0));if(a.lg||pa.UC)l(b,
t,h,p);else{k=b;g=h;f(M.TEXTURE_2D);M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,k);M.bindTexture(M.TEXTURE_2D,null);for(k=0;6>k;k++)M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+k,0,M.RGBA,g,g,0,M.RGBA,M.UNSIGNED_BYTE,null);M.bindTexture(a.nb,null);M.bindFramebuffer(M.FRAMEBUFFER,la);for(k=0;6>k;k++)q.HT(a,M.TEXTURE_CUBE_MAP_POSITIVE_X+k,g,t,wa,k);M.bindFramebuffer(M.FRAMEBUFFER,null);M.bindTexture(a.nb,a.sb);M.texParameteri(a.nb,M.TEXTURE_MIN_FILTER,ea[pa.ap]);M.texParameteri(a.nb,M.TEXTURE_MAG_FILTER,
M.LINEAR)}ga.NR()&&(E.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),l(b,t,N.SE,p));a.width=3*h;a.height=2*h;M.generateMipmap(m)}else"NODE_TEX"==e&&(M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!1),M.texImage2D(m,0,M.RGBA,b.width,b.height,0,M.RGBA,M.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);M.bindTexture(m,null)}function c(a){a.Ta.q7=function(){A(a)}}function B(a){return ha.tq(a)?ha.U(Math.pow(2,parseInt(a).toString(2).length),2,aa.Ec):a}function Q(b){var c;
switch(b.type){case a.Ah:c=M.RGBA;break;case a.Pt:c=M.RGB;break;case a.Qp:c=M.RGBA;break;case a.Rp:c=M.RGB;break;case a.nl:c=M.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}function K(b){var c;switch(b.type){case a.Ah:c=pa.ec?M.RGBA8:M.RGBA;break;case a.Pt:c=pa.ec?M.RGB8:M.RGB;break;case a.Qp:c=pa.ec?M.RGBA8:M.RGBA;break;case a.Rp:c=pa.ec?M.RGB8:M.RGB;break;case a.nl:c=pa.ec?pa.pz?M.DEPTH_COMPONENT16:M.DEPTH_COMPONENT24:M.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}
function G(b){var c;switch(b.type){case a.Ah:c=M.UNSIGNED_BYTE;break;case a.Pt:c=M.UNSIGNED_BYTE;break;case a.Qp:c=M.FLOAT;break;case a.Rp:c=M.FLOAT;break;case a.nl:c=pa.pz?M.UNSIGNED_SHORT:M.UNSIGNED_INT;break;default:ha.q("Wrong texture type")}return c}function D(a){return a&&a.Ne?!0:!1}function R(a){a.Ta?a.Ta.play():a.td&&(a.As=!0);a.dt=!1}function L(a){a.Ta?a.Ta.pause():a.td&&(a.As=!1);a.dt=!0}function I(a){a.Ta?a.Ta.currentTime=a.Tb/a.Vg:a.td&&(a.lj=d(a,a.Tb),k(a))}function z(a){return a.Ta?
!a.Ta.paused:a.td?a.As:!1}function d(a,b){return Math.round(b*a.ys/a.kk)}function m(a,b){if(S.Sa(a))return O(a,b);for(var c=a.aw,d=0;d<c.length;d++){var f=O(c[d],b);if(f)return f}return null}function O(a,b){var c=a.I;if(c.length)for(var c=c[0].W,d=0;d<c.length;d++){var f=c[d];if("MAIN"==f.type||"SKY"==f.type)for(var e=0;e<f.ya.length;e++)if(f.Ig[e]==b)return f.ya[e]}return null}function x(a,b,c){a=a.I;if(a.length){a=a[0].W;for(var d=0;d<a.length;d++){var f=a[d];if("MAIN"==f.type)for(var e=0;e<f.ya.length;e++)f.Ig[e]==
b&&(J(f.ya[e]),f.ya[e]=c,F(c))}}}function g(a,b){var c=a.I;if(c.length)for(var c=c[0].W,d=0;d<c.length;d++){var f=c[d];if("MAIN"==f.type)for(var e=0;e<f.ya.length;e++){var g=f.ya[e],m=f.Ig[e];-1==b.indexOf(m)&&"NODE_TEX"!=g.source&&b.push(m)}}}function P(a,b,c){var d=a.elements;a=a.interpolation;for(var f=0;f<b;f++){var e=f/(b-1),g=t(d,e,!0),m=da(d,e,!0);if(g&&m)if("CONSTANT"==a)c.push.apply(c,g.color);else{var l=c,k=g,q=m;k==q?l.push.apply(l,k.color):(l.push(X.Sv(q.color[0],q.position,k.color[0],
k.position,e)),l.push(X.Sv(q.color[1],q.position,k.color[1],k.position,e)),l.push(X.Sv(q.color[2],q.position,k.color[2],k.position,e)),l.push(X.Sv(q.color[3],q.position,k.color[3],k.position,e)))}m&&!g&&c.push.apply(c,m.color);g&&!m&&c.push.apply(c,g.color)}}function t(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?b-a[f].position:b-a[f][1][0];0<=e&&(d?e<=(c?b-d.position:b-a[f][1][0])&&(d=a[f]):d=a[f])}return d}function da(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?a[f].position-b:a[f][1][0]-
b;0<=e&&(d?e<=(c?d.position-b:d[1][0]-b)&&(d=a[f]):d=a[f])}return d}function J(a){0<a.ok&&--a.ok;0>=a.ok&&(a.sb&&M.deleteTexture(a.sb),a=ia.indexOf(a),-1!=a&&ia.splice(a,1))}function F(a){a.ok+=1}function T(a,b){for(var c=0;c<ia.length;c++){var d=ia[c];if(d.Br==a&&d.type==b.type&&d.repeat==b.repeat&&d.anisotropic_filtering==b.anisotropic_filtering&&d.Xk==b.Xk)return d}return null}var N=h("__compat"),ba=h("__config"),u=h("__texcomp"),ga=h("__debug"),Z=h("__extensions"),E=h("__print"),ca=h("__time"),
ha=h("__util"),q=h("__renderer"),S=h("__obj_util"),X=h("__curve"),U=h("__vec3"),sa=h("__scenes"),pa=ba.B,aa=ba.Gi,oa=ba.X,ya=null,wa=null,la=null;a.ve=0;a.K=0;a.RP=0;a.PP=0;a.QP=0;a.OP=0;a.Ah=10;a.Pt=20;a.Qp=30;a.Rp=40;a.nl=50;a.Nt=60;a.Lt=70;a.Ot=80;a.Mt=90;a.zE=128;a.PN=128;a.aF=128;var ia=[],ta={},na={},M=null,ea;a.Nf=function(b){ea=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.ve=b.NEAREST;a.K=b.LINEAR;a.RP=b.NEAREST_MIPMAP_NEAREST;a.PP=b.LINEAR_MIPMAP_NEAREST;
a.QP=b.NEAREST_MIPMAP_LINEAR;a.OP=b.LINEAR_MIPMAP_LINEAR;M=b};a.u4=function(a,b){return b in ta&&a in ta[b]?ta[b][a].Xf:null};a.K9=function(a,b){return b in ta&&a in ta[b]?(r(ta[b][a]),!0):!1};a.HF=e;a.Kl=y;a.$G=function(b){var c=M.createTexture(),d=M.TEXTURE_CUBE_MAP;M.bindTexture(d,c);M.texParameteri(d,M.TEXTURE_MAG_FILTER,M.LINEAR);M.texParameteri(d,M.TEXTURE_MIN_FILTER,M.LINEAR);M.texParameteri(d,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE);M.texParameteri(d,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE);for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
e=0;6>e;e++)M.texImage2D(M[f[e]],0,M.RGBA,b,b,0,M.RGBA,M.UNSIGNED_BYTE,null);M.bindTexture(d,null);d=p();d.type=a.Ah;d.source="NONE";d.width=3*b;d.height=2*b;d.Hq=1;d.sb=c;d.nb=M.TEXTURE_CUBE_MAP;return d};a.cD=function(a,b,c){if(!D(a)){var d=a.nb;M.bindTexture(d,a.sb);b&&M.texParameteri(d,M.TEXTURE_MIN_FILTER,b);c&&M.texParameteri(d,M.TEXTURE_MAG_FILTER,c);M.bindTexture(d,null)}};a.L4=function(b){if(D(b))return{min:a.ve,GW:a.ve};var c=b.nb;M.bindTexture(c,b.sb);b=M.getTexParameter(c,M.TEXTURE_MIN_FILTER);
var d=M.getTexParameter(c,M.TEXTURE_MAG_FILTER);M.bindTexture(c,null);return{min:b,GW:d}};a.resize=function(b,c,d){c=Math.max(c,pa.br?2:1);d=Math.max(d,pa.br?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.Nt:M.bindRenderbuffer(M.RENDERBUFFER,b.Ne);M.renderbufferStorage(M.RENDERBUFFER,M.RGB565,c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);break;case a.Lt:M.bindRenderbuffer(M.RENDERBUFFER,b.Ne);M.renderbufferStorage(M.RENDERBUFFER,M.DEPTH_COMPONENT16,c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);
break;case a.Ot:M.bindRenderbuffer(M.RENDERBUFFER,b.Ne);M.renderbufferStorageMultisample(M.RENDERBUFFER,pa.Fc,M.RGBA8,c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);break;case a.Mt:M.bindRenderbuffer(M.RENDERBUFFER,b.Ne);M.renderbufferStorageMultisample(M.RENDERBUFFER,pa.Fc,M.DEPTH_COMPONENT24,c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);break;default:var f=b.nb;M.bindTexture(f,b.sb);var e=Q(b),g=K(b),m=G(b);M.texImage2D(f,0,g,c,d,0,e,m,null);M.bindTexture(f,null)}c>aa.Ec||d>aa.Ec?ha.q('Slink texture "'+
b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+aa.Ec+"x"+aa.Ec+"."):(b.width=c,b.height=d)}};a.kT=function(b,c,d,f,g){var m=b.type,l=b.image,k=p();k.Fz=b.uuid;k.type=a.Ah;k.width=1;k.height=1;var q=b.b4w_anisotropic_filtering;"DEFAULT"===q&&(q=c);"OFF"!==q&&pa.anisotropic_filtering&&Z.iI()&&(q=parseFloat(q.split("x")[0]),k.anisotropic_filtering=q);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)k.repeat=!1;if(l&&("IMAGE"==m&&"MOVIE"==l.source&&(k.sm=!0,k.Fx=b.name,k.va=b.frame_start,
k.Tb=b.frame_offset,k.Yj=b.frame_duration,k.eE=b.use_auto_refresh,k.vj=b.use_cyclic,k.kk=b.movie_length,k.Xk=b.b4w_nla_video,0!=k.Tb&&E.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),c=ha.gj(g+l.filepath),c=T(c,k))){b.s=c;return}c=new Uint8Array([204,204,204,255]);switch(m){case "IMAGE":var q=M.createTexture(),h=M.TEXTURE_2D;M.bindTexture(h,q);M.texImage2D(h,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,c);break;case "NONE":q=M.createTexture();
h=M.TEXTURE_2D;M.bindTexture(h,q);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(d=ha.Dd("name",b.b4w_source_id,d)))k.nj=b.b4w_source_size,d.Vf=d.Vf||[],d.Vf.push(k),F(k),M.texImage2D(h,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,c);else return;break;case "ENVIRONMENT_MAP":q=M.createTexture();h=M.TEXTURE_CUBE_MAP;M.bindTexture(h,q);d="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var n=0;6>n;n++)M.texImage2D(M["TEXTURE_CUBE_MAP_"+
d[n]],0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,c);break;case "BLEND":return;default:E.error('texture "'+b.name+'" has unsupported type "'+m+'"');return}k.sb=q;k.nb=h;k.anisotropic_filtering&&M.texParameterf(k.nb,Z.iI().TEXTURE_MAX_ANISOTROPY_EXT,k.anisotropic_filtering);"NONE"==m&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==m&&"MOVIE"==l.source?M.texParameteri(h,M.TEXTURE_MIN_FILTER,M.LINEAR):M.texParameteri(h,M.TEXTURE_MIN_FILTER,ea[pa.ap]);M.texParameteri(h,M.TEXTURE_MAG_FILTER,
M.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==m?(m=b.b4w_source_id,d=b.b4w_source_size,k.Sl=b.b4w_enable_canvas_mipmapping,k.Is=m,k.source="CANVAS",c=document.createElement("canvas"),c.width=d,c.height=d,k.Xf=c.getContext("2d"),f in ta||(ta[f]={}),ta[f][m]=k,r(k)):"SCENE"==b.b4w_source_type&&"NONE"==m?(k.Is=b.b4w_source_id,k.source="SCENE"):(k.source=m,M.generateMipmap(h),M.bindTexture(h,null));l&&e(k,l,g);b.s=k};a.hN=A;a.gN=k;a.Ss=v;a.sR=B;a.fo=function(a){return a&&(a.sb||a.Ne)?!0:!1};a.eo=D;a.E6=
function(b){return b.type==a.Qp||b.type==a.Rp?!0:!1};a.qV=function(b){var c=0;switch(b.type){case a.Ah:case a.Pt:c=4;break;case a.Qp:case a.Rp:c=16;break;case a.nl:c=3;break;case a.Nt:case a.Lt:c=2;break;case a.Ot:c=4*pa.Fc;break;case a.Mt:c=3*pa.Fc}return c};a.ua=function(){if(!pa.zs)for(var a in na)for(var b in na[a])na[a][b].Ta.pause(),na[a][b].Ta.src="",na[a][b].Ta.load();ia.length=0;ta={};na={}};a.pause=function(){for(var a in na)for(var b in na[a]){var c=na[a][b];z(c)&&L(c)}};a.reset=function(){for(var a in na)for(var b in na[a])I(na[a][b])};
a.play=function(a){for(var b in na)for(var c in na[b]){var d=na[b][c];a&&!d.dt||R(d)}};a.V5=function(a,b){return b in na&&a in na[b]?na[b][a]:null};a.S9=function(a){return a.Xk};a.HK=R;a.xC=L;a.eL=I;a.pY=function(a,b){if(void 0 in na&&a in na[void 0]){var c=na[void 0][a];c.Ta?c.Ta.currentTime=b/c.Vg:c.td&&(c.lj=b,k(c))}};a.DN=z;a.EN=function(a){return a.Ta||a.td?a.Ta?2<=a.Ta.readyState:!0:0};a.AN=function(a){return a.Ta||a.td?a.Ta?Math.round(a.Ta.currentTime*a.Vg):a.lj:0};a.CN=function(a){return a.Ta||
a.td?a.Ta?a.Tb:d(a,a.Tb):0};a.Q_=function(a){if(!a.Ta&&!a.td)return 0;var b=Math.min(a.Yj,a.kk-a.Tb);return a.Ta?a.Tb+b:d(a,a.Tb+b)};a.Ow=function(a,b){return Math.round(b*a.xs*(ca.rd()/a.Vg))};a.BN=function(a){return Math.min(a.Yj,a.kk-a.Tb)};a.P_=d;a.v4=function(a,b){var c=m(a,b);return c&&"CANVAS"==c.source?c.Xf:null};a.L9=function(a,b){var c=m(a,b);return c&&"CANVAS"==c.source?(r(c),!0):!1};a.I5=m;a.J5=function(a){var b=[];if(S.Sa(a))g(a,b);else{a=a.aw;for(var c=0;c<a.length;c++)g(a[c],b)}return b};
a.VY=function(a){for(var b={},c=0;c<a.length;c++){for(var d=a[c].ya,f=a[c].Ld,e=[],g=[],m=0;m<d.length;m++){var l=d[m],k=f[m];if("CANVAS"==l.source)if(k in b)l=b[k];else{var q=d[m],l=p();l.source="CANVAS";l.width=q.width;l.height=q.height;l.Sl=q.Sl;l.type=q.type;q=document.createElement("canvas");q.width=l.width;q.height=l.height;l.Xf=q.getContext("2d");l.nb=M.TEXTURE_2D;l.sb=M.createTexture();M.bindTexture(M.TEXTURE_2D,l.sb);l.Sl?M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,ea[pa.ap]):M.texParameteri(M.TEXTURE_2D,
M.TEXTURE_MIN_FILTER,M.LINEAR);M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,M.LINEAR);M.bindTexture(M.TEXTURE_2D,null);q=l;q.Xf.drawImage(d[m].Xf.canvas,0,0);r(q);b[k]=l}e.push(l);g.push(k)}a[c].ya=e}};a.YT=function(a,b){for(var c=[],d=0;d<a.length;d++)P(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ha.U(255*a,0,255)}))};a.nR=P;a.bU=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),f=[],e=0;e<a.length;e++){for(var g=a[e].data.value,m=[],l=g.curve_mapping.curves_data,
k=g.curve_mapping.curve_extend,q=g.curve_mapping.curves_handle_types,g=0;g<l.length;g++){for(var h=k[g],n=l[g],p=[],u=q[g],r=0;r<n.length;r++)p.push([new Float32Array(3),new Float32Array(n[r].concat(0)),new Float32Array(3)]);X.Kz(p[0],null,p[1],u[0],u[0]);for(r=1;r<p.length-1;r++)X.Kz(p[r],p[r-1],p[r+1],u[r],u[r]);X.Kz(p[p.length-1],p[p.length-2],null,u[p.length-1],u[p.length-1]);if(2<p.length){if("AUTO"==u[0]){U.subtract(p[0][2],p[0][1],c);r=U.length(c);U.copy(p[1][0],d);d[0]<p[0][1][0]&&(d[0]=p[0][1][0]);
U.subtract(d,p[0][1],d);var w=U.length(d);1E-8<w&&(U.scale(d,r/w,d),U.add(p[0][1],d,p[0][2]),U.subtract(p[0][1],d,p[0][0]))}n=p.length-1;"AUTO"==u[0]&&(U.subtract(p[n][0],p[n][1],c),r=U.length(c),U.copy(p[n-1][2],d),d[0]>p[n][1][0]&&(d[0]=p[n][1][0]),U.subtract(d,p[n][1],d),w=U.length(d),1E-8<w&&(U.scale(d,r/w,d),U.add(p[n][1],d,p[n][0]),U.subtract(p[n][1],d,p[n][2])))}for(n=0;n<p.length-1;n++)X.hS(p[n][1],p[n][2],p[n+1][0],p[n+1][1]);n=[];3>=l.length?(r=Math.round(-b/2),u=Math.round(b/2)):(r=0,u=
b);for(;r<u;r++){var w=r/(u-1),O=t(p,w,!1),x=da(p,w,!1);O&&x?n.push(X.cG(w,O[1],O[2],x[0],x[1],.001)):x&&!O?"EXTRAPOLATED"==h?(w=x[1][0]==x[2][0]?x[1][1]:X.VJ(w,x[1],x[2]),n.push(w)):n.push(x[1][1]):O&&!x&&("EXTRAPOLATED"==h?(w=O[0][0]==O[1][0]?O[1][1]:X.VJ(w,O[0],O[1]),n.push(w)):n.push(O[1][1]))}m.push(n)}f.push(m)}c=[];for(r=0;r<f.length;r++)for(m=f[r],g=0;g<m[0].length;g++)3>=m.length?(d=ha.U(127.5*(m[0][g]+1),0,255),e=ha.U(127.5*(m[1][g]+1),0,255),l=ha.U(127.5*(m[2][g]+1),0,255),n=255):(d=ha.U(255*
m[0][g],0,255),e=ha.U(255*m[1][g],0,255),l=ha.U(255*m[2][g],0,255),n=ha.U(255*m[3][g],0,255)),c.push(d,e,l,n);return new Uint8Array(c)};a.ZG=function(b,c){var d=y(a.Ah,!1);d.source="NODE_TEX";d.repeat=!1;v(d,{width:c,height:b.length/(4*c),data:b});return d};a.H2=function(a,c,d,f,e){var g=ha.gj(e);if("WORLD"!=a.type){var m=T(g,c);if(!m){m=p();m.type=c.type;m.source=c.source;m.Is=c.Is;m.width=c.width;m.height=c.height;m.Hq=c.Hq;m.nj=c.nj;m.Sl=c.Sl;m.Xf=c.Xf;m.nb=c.nb;m.sb=c.sb;m.Ne=c.Ne;m.sm=c.sm;m.ft=
c.ft;m.Ta=c.Ta;m.Fx=c.Fx;m.kk=c.kk;m.Vg=c.Vg;m.va=c.va;m.Tb=c.Tb;m.Yj=c.Yj;m.lg=c.lg;m.nh=c.nh;m.td=c.td;m.ys=c.ys;m.xs=c.xs;m.lj=c.lj;m.As=c.As;m.Fk=c.Fk;m.dt=c.dt;m.eE=c.eE;m.vj=c.vj;m.Xk=c.Xk;m.repeat=c.repeat;m.Yn=c.Yn;m.Br=c.Br;m.Zn=c.Zn;m.vB=c.vB;m.uB=c.uB;m.Bv=c.Bv;m.km=c.km;var l=m;M.bindTexture(c.nb,c.sb);var k=M.getTexParameter(c.nb,M.TEXTURE_MAG_FILTER),q=M.getTexParameter(c.nb,M.TEXTURE_MIN_FILTER),h=M.getTexParameter(c.nb,M.TEXTURE_WRAP_S);c=M.getTexParameter(c.nb,M.TEXTURE_WRAP_T);l.sb=
M.createTexture();M.bindTexture(l.nb,l.sb);M.texParameteri(l.nb,M.TEXTURE_MAG_FILTER,k);M.texParameteri(l.nb,M.TEXTURE_MIN_FILTER,q);M.texParameteri(l.nb,M.TEXTURE_WRAP_S,h);M.texParameteri(l.nb,M.TEXTURE_WRAP_T,c);M.bindTexture(l.nb,null);b(m,e,g);ia.push(m);v(m,f,0)}f=m;if(S.Sa(a))x(a,d,f);else for(a=a.aw,e=0;e<a.length;e++)x(a[e],d,f)}else m=c,b(m,e),v(m,f,0),sa.x_(a)};a.MC=J;a.Cv=F;a.he=function(a){return a.texture.s};a.TX=function(){M=null};a.AI=function(){return ia}};b4w.module.__texcomp=function(a,h){function p(a,b,e,c){var h=new Int32Array(e,0,31),p,A,G,D,R,L;if(542327876!=h[0])return r.error("Invalid magic number in DDS header"),0;if(!h[20]&4)return r.error("Unsupported format, must contain a FourCC code"),0;p=h[21];switch(p){case k:A=8;G=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case w:A=16;G=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case n:A=16;G=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return r.error("Unsupported FourCC code:",y(p)),null}L=
1;h[2]&131072&&!1!==c&&(L=Math.max(1,h[7]));D=h[4];R=h[3];h=h[1]+4;if(b)for(p=0;p<L;++p)c=Math.max(4,D)/4*Math.max(4,R)/4*A,b=new Uint8Array(e,h,c),a.compressedTexImage2D(a.TEXTURE_2D,p,G,D,R,0,b),h+=c,D=Math.max(.5*D,1),R=Math.max(.5*R,1);else if(p==k){Math.max(4,D);Math.max(4,R);e=b=new Uint16Array(e);A=h/2;G=D;var I=R,h=new Uint16Array(4);b=new Uint16Array(G*I);for(var z=0,d=0,m=d=z=p=0,O=0,x=0,g=0,P=G/4,I=I/4,t=0;t<I;t++)for(var da=0;da<P;da++)p=A+4*(t*P+da),h[0]=e[p],h[1]=e[p+1],z=h[0]&31,d=
h[0]&2016,m=h[0]&63488,O=h[1]&31,x=h[1]&2016,g=h[1]&63488,h[2]=5*z+3*O>>3|5*d+3*x>>3&2016|5*m+3*g>>3&63488,h[3]=5*O+3*z>>3|5*x+3*d>>3&2016|5*g+3*m>>3&63488,z=e[p+2],d=4*t*G+4*da,b[d]=h[z&3],b[d+1]=h[z>>2&3],b[d+2]=h[z>>4&3],b[d+3]=h[z>>6&3],d+=G,b[d]=h[z>>8&3],b[d+1]=h[z>>10&3],b[d+2]=h[z>>12&3],b[d+3]=h[z>>14],z=e[p+3],d+=G,b[d]=h[z&3],b[d+1]=h[z>>2&3],b[d+2]=h[z>>4&3],b[d+3]=h[z>>6&3],d+=G,b[d]=h[z>>8&3],b[d+1]=h[z>>10&3],b[d+2]=h[z>>12&3],b[d+3]=h[z>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,D,R,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);c&&a.generateMipmap(a.TEXTURE_2D)}else return r.error("No manual decoder for",y(p),"and no native support"),0;return L}function e(a,b,e,c,k){var h=new XMLHttpRequest;h.open("GET",e,!0);h.responseType="arraybuffer";h.onload=function(){if(200==h.status){a.bindTexture(a.TEXTURE_2D,c);var e=p(a,b,h.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<e?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}k&&k(c)};h.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function y(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var r=h("__print"),A=h("__util"),k=b("DXT1"),w=b("DXT3"),n=b("DXT5");a.B_=p;a.C_=function(a,b,e){var c=new Uint32Array(e,0,13);if(55727696==c[0]){var k=c[7],h=c[6],n=c[11],p=52+c[12];switch(c[2]){case 0:var r=2,w=1;break;case 1:r=2;w=3;break;case 2:r=4;w=0;break;case 3:r=4;w=2;break;default:A.q("Unsupported PVR V3 format.")}}else if(559044176==
c[11]){k=c[2];h=c[1];n=c[3];p=c[0];n++;var y=c[4]&255,c=0<c[10];25==y?(r=4,w=c?2:0):24==y?(r=2,w=c?3:1):A.q("Unsupported PVR V2 format.")}else A.q("Unsupported PVR version.");y=2==r?8:4;c=4;switch(w){case 0:var I=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:I=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:I=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:I=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=y*c*r/8;for(r=0;r<n;r++){var w=Math.max(k>>r,1),z=Math.max(h>>r,1),d=w/y,m=z/c;2>d&&(d=2);2>m&&(m=2);d=
d*m*b;m=new Uint8Array(e,p,d);a.compressedTexImage2D(a.TEXTURE_2D,r,I,w,z,0,m);p+=d}};a.gJ=function(a,b){switch(b){case "dds":var e=new Int32Array(a,0,31);return{width:e[4],height:e[3]};case "pvr":e=new Uint32Array(a,0,13);if(55727696==e[0])var c=e[7],e=e[6];else c=e[2],e=e[1];return{width:c,height:e}}};a.QU=function(a,b){var e=1;if("dds"==b){var c=new Int32Array(a,0,31),h=c[21];switch(h){case k:e=6;break;case w:case n:e=4;break;default:r.error("Unsupported FourCC code:",y(h))}}else if("pvr"==b)if(c=
new Uint32Array(a,0,13),55727696==c[0])switch(c[2]){case 0:e=12;break;case 1:e=16;break;case 2:e=6;break;case 3:e=8}else h=c[4]&255,c=0<c[10],25==h?e=c?8:6:24==h&&(e=c?16:12);return e};a.V6=function(a,b,k,c){var h=a.createTexture();e(a,b,k,h,c);return h}};b4w.module.__curve=function(a,h){function p(a,b,e,f,k){var c=f.length;k||(k=new Float32Array(c));for(var h=c+a,p=new Float32Array(h),r=1;r<=h-1;r++)p[r-1]=b>=e[r-1]&&b<e[r+1-1]?1:0;for(var y=2;y<=a;y++)for(r=1;r<=h-y;r++)p[r-1]=(0!=p[r-1]?(b-e[r-1])*p[r-1]/(e[r+y-1-1]-e[r-1]):0)+(0!=p[r+1-1]?(e[r+y-1]-b)*p[r+1-1]/(e[r+y-1]-e[r+1-1]):0);b==e[h-1]&&(p[c-1]=1);a=0;for(r=1;r<=c;r++)a+=p[r-1]*f[r-1];for(r=1;r<=c;r++)k[r-1]=0!=a?p[r-1]*f[r-1]/a:0;return k}function e(a){a=a.Qv;return a[a.length-1]}function b(a){a=
a.qH;return a[a.length-1]}function y(a,b,e,f,k,c,h,p){var A=a+(b-a)/2,G=r(A,f,k,c,h)-e;p=p?p:.01;return Math.abs(G)<p?A:0<G?y(a,A,e,f,k,c,h,p):y(A,b,e,f,k,c,h,p)}function r(a,b,e,f,k){var c=1-a;return b*c*c*c+3*e*c*c*a+3*f*c*a*a+k*a*a*a}h("__print");var A=h("__util"),k=h("__vec3");a.LS=function(a){var b={},e=a.data;a=e.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var f=a.order_u;b.qk=f;a=a.points;var k=a.length/5,c=[],h=k+f,k=k+2;c[0]=0;for(var r=2;r<=h;r++)c[r-1]=r>f&&r<k?c[r-
2]+1:c[r-2];b.Qv=c;"2D"==e.dimensions?b.ek=!1:"3D"==e.dimensions?b.ek=!0:A.q("Wrong curve dimensions");f=[];c=[];for(e=0;e<a.length;e+=5)f.push(a[e]),f.push(a[e+1]),f.push(a[e+2]),b.ek&&f.push(a[e+3]),c.push(a[e+4]);b.eA=f;b.pE=c;a=[];for(var e=b.eA,f=b.ek?4:3,c=b.pE,h=b.Qv,k=b.qk,r=e.length/f,y=r+k,G=0,D=h[y-1]/999,R=0;1E3>R;R++){5E-6>h[y-1]-G&&(G=h[y-1]);for(var L=p(k,G,h,c),I=0;I<f;I++)for(var z=a[f*R+I]=0;z<r;z++)a[f*R+I]+=L[z]*e[f*z+I];G+=D}f=b.ek?4:3;c=new Float32Array(1E3);c[0]=0;for(e=1;1E3>
e;e+=1)h=a[(e-1)*f],k=a[(e-1)*f+1],r=a[(e-1)*f+2],y=a[e*f],G=a[e*f+1],D=a[e*f+2],c[e]=c[e-1]+Math.sqrt((y-h)*(y-h)+(G-k)*(G-k)+(D-r)*(D-r));b.qH=c;return b};a.mZ=function(a,b,k){k||(k=[]);var f=b,h=Math.max(f,0);b=h=Math.min(f,e(a));var f=a.eA,h=a.ek?4:3,c=a.pE,r=a.Qv,y=a.qk;a=f.length/h;var A=a+y;5E-6>r[A-1]-b&&(b=r[A-1]);A=new Float32Array(a);p(y,b,r,c,A);for(b=0;b<h;b++)for(c=k[b]=0;c<a;c++)k[b]+=A[c]*f[h*c+b]};a.jZ=function(a,b,e){e||(e=[]);var f=a.eA,k=a.ek?4:3,c=a.pE,h=a.Qv,p=a.qk;a=f.length/
k;var r=a+p;5E-6>h[r-1]-b&&(b=h[r-1]);var r=new Float32Array(a),y=b;b=r;var A=c.length;b||(b=new Float32Array(A));var R=new Float32Array(A),L=new Float32Array(A),I=R,z=L;I||(I=new Float32Array(A));z||(z=new Float32Array(A));for(var d=A+p,m=new Float32Array(d),O=new Float32Array(d),x=1;x<=d-1;x++)m[x-1]=y>=h[x-1]&&y<h[x+1-1]?1:0;y==h[d-1]&&(m[A-1]=1);for(var g=2;g<=p;g++)for(x=1;x<=d-g;x++){var P=0!=m[x-1]?m[x-1]/(h[x+g-1-1]-h[x-1]):0,t=0!=m[x+1-1]?-m[x+1-1]/(h[x+g-1]-h[x+1-1]):0,da=0!=O[x-1]?(y-h[x-
1])*O[x-1]/(h[x+g-1-1]-h[x-1]):0,J=0!=O[x+1-1]?(h[x+g-1]-y)*O[x+1-1]/(h[x+g-1]-h[x+1-1]):0;m[x-1]=(0!=m[x-1]?(y-h[x-1])*m[x-1]/(h[x+g-1-1]-h[x-1]):0)+(0!=m[x+1-1]?(h[x+g-1]-y)*m[x+1-1]/(h[x+g-1]-h[x+1-1]):0);O[x-1]=P+t+da+J}for(x=1;x<=A;x++)I[x-1]=m[x-1],z[x-1]=O[x-1];h=0;for(p=1;p<=A;p++)h+=R[p-1]*c[p-1];y=0;for(p=1;p<=A;p++)y+=L[p-1]*c[p-1];for(p=1;p<=A;p++)b[p-1]=0!=h?L[p-1]*c[p-1]/h+R[p-1]*c[p-1]*y/(h*h):0;for(c=0;c<k;c++)for(h=e[c]=0;h<a;h++)e[c]+=r[h]*f[k*h+c]};a.c9=e;a.lZ=b;a.kZ=function(a,
k){if(0>=k)return 0;var l=e(a);if(k>=b(a))return l;var f=a.qH,h=A.cu(f,k,0,f.length-1);return l*(h+(k-f[h])/(f[h+1]-f[h]))/1E3};a.Sv=function(a,b,e,f,k){return e+(k-f)*(a-e)/(b-f)};a.VJ=function(a,b,e){var f=b[0];b=b[1];e=(e[1]-b)/(e[0]-f);return e*a+(b-e*f)};a.cG=function(a,b,e,f,k,c){return r(y(0,1,a,b[0],e[0],f[0],k[0],c),b[1],e[1],f[1],k[1])};a.Kz=function(a,b,e,f,h){var c=new Float32Array(3),p=new Float32Array(3),r=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(3),D=new Float32Array(3);
k.copy(a[1],p);null==b?(k.copy(e[1],r),c[0]=2*p[0]-r[0],c[1]=2*p[1]-r[1]):k.copy(b[1],c);null==e?(k.copy(b[1],c),r[0]=2*p[0]-c[0],r[1]=2*p[1]-c[1]):k.copy(e[1],r);k.subtract(p,c,y);k.subtract(r,p,A);b=k.length(y);e=k.length(A);0==b&&(b=1);0==e&&(e=1);if("AUTO"==f||"AUTO"==h)D[0]=A[0]/e+y[0]/b,D[1]=A[1]/e+y[1]/b,c=2.5614*k.length(D),0!=c&&("AUTO"==f&&k.scaleAndAdd(p,D,-(b/c),a[0]),"AUTO"==h&&k.scaleAndAdd(p,D,e/c,a[2]));"VECTOR"==f&&k.scaleAndAdd(p,y,-1/3,a[0]);"VECTOR"==h&&k.scaleAndAdd(p,A,1/3,a[2])};
a.hS=function(a,b,e,f){var k=[],c=[],h,p,r;k[0]=a[0]-b[0];k[1]=a[1]-b[1];c[0]=f[0]-e[0];c[1]=f[1]-e[1];r=f[0]-a[0];h=Math.abs(k[0]);p=Math.abs(c[0]);0!=h+p&&h+p>r&&(h=r/(h+p),b[0]=a[0]-h*k[0],b[1]=a[1]-h*k[1],e[0]=f[0]-h*c[0],e[1]=f[1]-h*c[1])}};b4w.module.__shaders=function(a,h){function p(a,b,c){var d=a.Mi;"string"==typeof c?(a=e(a,c))&&(c=a[1]):c=String(c);for(a=0;a<d.length;a++)if(d[a][0]==b){d[a][1]=c;break}}function e(a,b){for(var c=a.Mi,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var d=a+b;if(!(d in T)){var f=c(t.shaders_path,a),e=c(t.shaders_path,b),f=Q(f),e=Q(e),g;for(g in e)f[g]=e[g];e=[];for(g in f)e.push([g,f[g]]);T[d]=e}return T[d]}function y(a,b){return a+b}function r(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(y,0)}function A(a,b){var c=v(a.type),d=v(b.type),f=a.ul,e=b.ul;return c>d?-1:c<d?1:f>e?-1:f<e?1:0}function k(a){if(g.ec){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ga}else b=Z;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],ul:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return n(a,ca,P.Zv)}function w(a,b,c){a=a.split(";").map(function(a){return(a=a.match(u))&&{type:a[2],ul:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return n(a,b,c)}function n(a,b,c){function d(){for(var c=0;h<a.length;){var e=a[h];if(3!=v(e.type))break;c+=f(e.type)*e.ul;h++}k=q+c;if(k>X)return!1;l(b,q,c,0,3);return!0}function e(){for(var c=X-k,d=c,g=c;h<a.length;){var m=a[h];if(2!=v(m.type))break;m=f(m.type)*m.ul;if(m<=d)d-=m;else if(m<=g)g-=m;else return!1;h++}g=c-g;l(b,k,c-d,0,2);l(b,X-g,g,2,2);return!0}function g(){for(;h<a.length;){for(var d=a[h],d=f(d.type)*d.ul,e=-1,m=c+1,k=-1,q=0;4>q;q++){var n=E;n[0]=
0;n[1]=1;var p;p=b;for(var t=q,r=d,u=n;S<p.length&&15===p[S];)S++;for(;0<X&&15===p[X];)X--;if(X-S<r)p=!1;else{for(var t=1<<t,O=0,x=-1,w=p.length+1,z=!1,v=S;v<=X;v++)v<X&&!(p[v]&t)?z||(O=v,z=!0):(z&&(z=v-O,z>=r&&z<w&&(w=z,x=O)),z=!1);0>x?p=!1:(u[0]=x,u[1]=w,p=!0)}p&&n[1]<m&&(k=n[0],m=n[1],e=q)}if(0>e)return!1;l(b,k,d,e,1);h++}return!0}if(!a.length)return!0;for(var m=0;m<c;m++)b[m]=0;X=c;a.sort(A);var k=0,q=0,h=0;return function(){for(;h<a.length;){var c=a[h];if(4!=v(c.type))break;q+=f(c.type)*c.ul;
h++}if(q>X)return!1;S=q;l(b,0,q,0,4);return!0}()&&d()&&e()&&g()}function l(a,b,c,d,f){for(var e=0,g=0;g<f;g++)e|=1<<d+g;for(g=0;g<c;g++)a[b+g]|=e}function f(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function v(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}function c(a,
b){var c=a+b;if(J[c])return J[c];if(F){var d=F[b];if(!d)return null;d=h("__gpp_parser").s7.parse(d)}else if(d=h("shader_texts")[b],!d)return null;return J[c]=d}function B(a,b){for(var c={},d=b.Mi||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.og.length;f++)c["USE_NODE_"+b.og[f].id]=["1"];g.ec?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],c.GLSL_TEXTURE_PROJ=
["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=g.Fq?["sampler2DShadow"]:["sampler2D"];for(var e in c)c[e][0].constructor!=String&&O.warn("Warning! The value of a directive '"+e+"' is not of type string.");return c}function Q(a){function b(a){"var"==
a.a?f[a.c]=a.b.join(""):"include"==a.a&&(a=c(t.shaders_path,t.ZL+a.o),d(a,b))}function d(a,b,c){if(a instanceof Array)for(var f=0;f<a.length;f++)d(a[f],b,c);else if(a instanceof Object&&a){b&&b(a);for(f in a)d(a[f],b,c);c&&c(a)}}var f={};d(a,b);return f}function K(a,b,d){function f(b){b=b.d;for(var d=0;d<b.length;d++){var g=b[d];switch(g.a){case "cond":a:for(var g=g.d,h=0;h<g.length;h++){var z=g[h];switch(z.a){case "if":case "elif":if(e(z.g)){f(z.h);break a}break;case "else":f(z.h);break a;case "ifdef":z.c in
r&&f(z.h);break;case "ifndef":z.c in r||f(z.h)}}break;case "include":g=g.o;h=c(t.shaders_path,t.ZL+g);w.push("include/"+g);f(h);w.pop();break;case "var":break;case "define":r[g.c]=g.b;break;case "error":x.q("Shader error: #error "+g.b.join(" "));break;case "line":break;case "pragma":p.push("#pragma "+g.c+" "+g.b.join(" "));break;case "undef":delete r[g.c];break;case "warning":O.warn("Shader warning: #warning "+g.b.join(" "));break;case "extension":g=q(g.b,r,u,!1);p.push("#extension "+g.join(" "));
break;case "version":g=q(g.b,r,u,!1),p.push("#version "+g.join(" "));case "#":break;case "node":v[g.c]=g;break;case "nodes_global":g=n;for(h=0;h<g.length;h++){var z=g[h],F=v[z.id];if(F)for(var B=0,y=0;y<F.l.length;y++){var P=F.l[y];if("node_param"==P.a){var A;if("PARTICLE_INFO"==z.id&&P.e)if(1==r.PARTICLE_BATCH)switch(A=!1,B){case 0:A=I(z.Rb,"PART_INFO_IND")||I(z.Rb,"PART_INFO_AGE")||I(z.Rb,"PART_INFO_LT")||I(z.Rb,"PART_INFO_SIZE");break;case 1:A=I(z.Rb,"PART_INFO_LOC");break;case 2:A=I(z.Rb,"PART_INFO_VEL");
break;case 3:A=I(z.Rb,"PART_INFO_A_VEL");break;case 4:A=I(z.Rb,"PART_INFO_IND")}else A=!1;else A=!0;A&&(P=P.f.join(" ")+" ","vert"==a?P+=z.qi[B]:"frag"==a&&(P+=z.rb[B],null!==z.tw[B]&&(P+="="+z.tw[B])),P+=";",l(k(P)));B++}}}break;case "nodes_main":g=n;for(h=0;h<g.length;h++)if(z=g[h],F=v[z.id]){B={};J=U=S=0;y=F;P=z;A=y;for(var D={},L=0;L<A.m.length;L++){var N=A.m[L];D[N.c]=[N.b.join("")]}A=D;for(D=0;D<P.Rb.length;D++)L=P.Rb[D][0],L in A&&(A[L]=[P.Rb[D][1]]);for(D=L=0;D<y.l.length;D++)N=y.l[D],"node_out"==
N.a&&(A["USE_OUT_"+N.c]=[-1<E.indexOf(P.gb[L])|0],L++);y=A;P=z;A=F.l;D=B;L=y;for(N=0;N<A.length;N++){var T=A[N];switch(T.a){case "node_in":var X=P.L[S];if(null!==P.yB[S]){if(("MATERIAL_BEGIN"==P.id&&3===S||!L.MATERIAL_EXT&&("MATERIAL_BEGIN"==P.id&&4===S||"MATERIAL_END"==P.id&&3===S||"MATERIAL_END"==P.id&&4===S||"MATERIAL_END"==P.id&&5===S)||"TEXTURE_COLOR"==P.id||"TEXTURE_NORMAL"==P.id)&&T.e){D[T.c]=P.yB[S];S++;continue}var K=T.f.join(" ")+" ",K=K+(X+"="+P.yB[S]+";");l(k(K))}D[T.c]=X;S++;break;case "node_out":X=
P.gb[U];if(!T.e||-1<E.indexOf(X))K=T.f.join(" ")+" ",K+=X+";",l(k(K)),D[T.c]=X;U++;break;case "node_param":"vert"==a?X=P.qi[J]:"frag"==a&&(X=P.rb[J]),D[T.c]=X,J++}}p.push("{");m(z,F.j,B,y);p.push("}")}break;case "txt":l(g.b);break;default:x.q("Unknown element type: "+g.a)}}}function e(a,b){var c;c=q(a,r,u,!0,b);for(var d=[],f=0;f<c.length;f++)if(c[f]instanceof Object)switch(c[f].a){case "conditional_expr":var g=d.pop(),m=d.pop();d.pop()?d.push(m):d.push(g);break;case "logical_or_expr":for(var m=d.pop(),
k=0;k<c[f].i-1;k++)g=d.pop(),m=m||g;d.push(m);break;case "logical_and_expr":m=d.pop();for(k=0;k<c[f].i-1;k++)g=d.pop(),m=m&&g;d.push(m);break;case "logical_bitor_expr":m=d.pop();for(k=0;k<c[f].i-1;k++)m|=d.pop();d.push(m);break;case "logical_bitxor_expr":m=d.pop();for(k=0;k<c[f].i-1;k++)m^=d.pop();d.push(m);break;case "logical_bitand_expr":m=d.pop();for(k=0;k<c[f].i-1;k++)m&=d.pop();d.push(m);break;case "equal_expr":g=d.pop();m=d.pop();d.push(m==g);break;case "non_equal_expr":g=d.pop();m=d.pop();
d.push(m!=g);break;case "le_expr":g=d.pop();m=d.pop();d.push(m<=g);break;case "ge_expr":g=d.pop();m=d.pop();d.push(m>=g);break;case "l_expr":g=d.pop();m=d.pop();d.push(m<g);break;case "g_expr":g=d.pop();m=d.pop();d.push(m>g);break;case "left_shift_expr":m=d.pop();g=d.pop();d.push(m<<g);break;case "right_shift_expr":m=d.pop();g=d.pop();d.push(m>>g);break;case "add_expr":m=d.pop();g=d.pop();d.push(m+g);break;case "sub_expr":m=d.pop();g=d.pop();d.push(m-g);break;case "mul_expr":m=d.pop();g=d.pop();d.push(m*
g);break;case "div_expr":m=d.pop();g=d.pop();d.push(m/g);break;case "mod_expr":m=d.pop();g=d.pop();d.push(m%g);break;case "pre_inc_expr":case "post_inc_expr":g=d.pop();d.push(++g);break;case "pre_dec_expr":case "post_dec_expr":g=d.pop();d.push(--g);break;case "positive_expr":g=d.pop();d.push(+g);break;case "negative_expr":g=d.pop();d.push(-g);break;case "one_compl_expr":g=d.pop();d.push(~g);break;case "logic_negative_expr":g=d.pop();d.push(!g);break;default:x.q("Unknown operation type: "+c[f].a)}else g=
c[f],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(g)?(d.push(0),0!=g.indexOf("USE_NODE_")&&(m=w[w.length-1],m in z||(z[m]=[]),-1==z[m].indexOf(g)&&(z[m].push(g),O.error("Undefined directive '"+g+"' in shader '"+m+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[f]));1==d.length?c=d[0]:(x.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function m(a,b,c,d){for(var f=0;f<b.length;f++){var g=b[f];switch(g.a){case "node_cond":a:for(var k=a,g=g.d,q=c,h=d,n=0;n<g.length;n++){var p=
g[n];switch(p.a){case "node_if":case "node_elif":if(e(p.g,h)){m(k,p.j,q,h);break a}break;case "node_else":m(k,p.j,q,h);break a;case "node_ifdef":(p.c in r||p.c in h)&&m(k,p.j,q,h);break;case "node_ifndef":p.c in r||p.c in h||m(k,p.j,q,h)}}break;case "txt":k=[];for(q=0;q<g.b.length;q++)h=g.b[q],h in c?k.push(c[h]):k.push(h);l(k,d)}}}function k(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function l(b,c){var d=b;g.ec||"frag"!=a||(d=d.join(" "),P&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),P=!1):
d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),P=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=q(b,r,u,!1,c),p.push(d.join(" ")))}function q(a,b,c,d,f){var e=[];h(a,b,c,d,e,f);return e}function h(a,b,c,d,f,e){for(var g=0;g<a.length;g++){var m=a[g];if(e&&m in e)m=e[m];else if(m in b)m=b[m];else{f.push(m);continue}0==m.length&&d?f.push(0):h(m,b,c,d,f,e)}}var n=d.og,p=[],r=B(a,d),u={},w=[d[a]],z={},v=
{},E=[],F;for(F in n)for(var y in n[F].L)E.push(n[F].L[y]);var P=!1;f(b);var S=0,U=0,J=0;return p.join("\n")}function G(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function D(a){sa.deleteProgram(a.di);sa.deleteShader(a.Kx);sa.deleteShader(a.Vu);delete da[a.rD]}function R(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return L(a);case 2:return"vec2("+L(a[0])+","+L(a[1])+")";case 3:return"vec3("+L(a[0])+","+L(a[1])+","+L(a[2])+")";case 4:return"vec4("+L(a[0])+
","+L(a[1])+","+L(a[2])+","+L(a[3])+")";case 9:return"mat3("+L(a[0])+","+L(a[1])+","+L(a[2])+","+L(a[3])+","+L(a[4])+","+L(a[5])+","+L(a[6])+","+L(a[7])+","+L(a[8])+")";case 16:return"mat4("+L(a[0])+","+L(a[1])+","+L(a[2])+","+L(a[3])+","+L(a[4])+","+L(a[5])+","+L(a[6])+","+L(a[7])+","+L(a[8])+","+L(a[9])+","+L(a[10])+","+L(a[11])+","+L(a[12])+","+L(a[13])+","+L(a[14])+","+L(a[15])+")";default:x.q("Wrong glsl value dimension")}}function L(a){return a%1?String(a):String(a)+".0"}function I(a,b){for(var c=
0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var z=h("__assets"),d=h("__config"),m=h("__debug"),O=h("__print"),x=h("__util"),g=d.B,P=d.Gi,t=d.Fe,da={},J={},F=null,T={},N="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.gz=0;a.WN=1;a.VN=2;a.ZN=4;a.YN=8;a.XN=16;a.QN=32;var ba=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,u=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ga=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,Z=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
E=new Int16Array(2),ca=null,ha=null,q=null,S=0,X=0,U=[],sa=null,pa=!1;a.Nf=function(a){sa=a};a.ia=p;a.UU=e;a.lY=function(a){a.Mi=x.Ih(b(a.yg,a.Xe));p(a,"PRECISION",d.B.precision);"highp"==d.B.precision?p(a,"EPSILON",R(1E-6)):p(a,"EPSILON",R(1E-4));p(a,"CONSTANTS_HACK",g.qD|0);p(a,"SRGB",g.srgb_type);p(a,"COMPARED_MODE",g.Fq|0)};a.X5=function(a){return a.yg};a.O4=function(a){return a.Xe};a.PU=function(a){var b=JSON.stringify(a.yg)+JSON.stringify(a.Xe)+JSON.stringify(a.Mi)+JSON.stringify(a.og),d=da[b];
if(d)return d;var f=a.Xe,e=c(t.shaders_path,a.yg),f=c(t.shaders_path,f);if(!e||!f)return null;var e=K("vert",e,a),f=K("frag",f,a),d=0,l=r(f,ba);a.KM=l;l>P.ZB&&(d|=1);ca||(ca=new Uint32Array(P.Zv));ha||(ha=new Uint32Array(P.Yv));q||(q=new Uint32Array(P.Tr));w(f,ha,P.Yv)||(d|=2);w(e,q,P.Tr)||(d|=4);l=g.ec?(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.TF=l;l>P.$B&&(d|=8);k(f)||(d|=16);a.status=d;if(0===
a.status){var d=sa,h=G(d,e,d.VERTEX_SHADER),n=G(d,f,d.FRAGMENT_SHADER),l=d.createProgram();d.attachShader(l,h);d.attachShader(l,n);d.linkProgram(l);for(var h={Kx:h,Vu:n,di:l,attributes:{},Ym:{},ds:x.Sj(),yC:x.Sj(),zC:{},Wr:!0,iw:!1,XM:x.Sj(),WM:x.Sj(),ib:x.Ih(a),rD:b,Yf:!0},p=d.getProgramParameter(l,d.ACTIVE_ATTRIBUTES),n=0;n<p;n++){var u=d.getActiveAttrib(l,n).name;h.attributes[u]=d.getAttribLocation(l,u)}p=d.getProgramParameter(l,d.ACTIVE_UNIFORMS);for(n=0;n<p;n++)u=d.getActiveUniform(l,n).name.split("[0]").join(""),
h.Ym[u]=d.getUniformLocation(l,u);da[b]=d=h;l=!sa.getShaderParameter(d.Vu,sa.COMPILE_STATUS);h=!sa.getShaderParameter(d.Kx,sa.COMPILE_STATUS);n=!sa.getProgramParameter(d.di,sa.LINK_STATUS);l?m.bL(d.Vu,b,f):h?m.bL(d.Kx,b,e):n&&m.QX(d.di,b,e,f);if(l||h||n)a.status|=32,d=null}else d=null;return d};a.wW=function(){pa=!1;if(b4w.module_check("shader_texts"))pa=!0;else{for(var a=[],b=z.Vx,c=0;c<N.length;c++){var d=x.gj(t.shaders_path+N[c]);a.push({id:N[c],type:b,url:d})}b=function(a,b){F||(F={});F[b]=a};
a.length?z.Ud(a,b,function(){pa=!0}):O.error("Shaders have not been found.")}};a.HG=function(){return pa};a.u3=function(){return U};a.pI=function(){return da};a.ua=function(){for(var a in da)D(da[a]);for(var b in J)delete J[b];for(var c in U)delete U[c];q=ha=ca=null;T={}};a.$R=D;a.v3=function(a){var b=a.Mi;O.log("Shader: "+a.yg+" "+a.Xe+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)O.log("  "+b[a][0],b[a][1])};a.N=R;a.IG=function(a,b){return b in a.Ym?!0:!1};a.reset=function(){sa=
null}};b4w.module.__assets=function(a,h){function p(){return B.AJ()?h(B.Fe.gu).data:null}function e(){var a={Qt:null,dQ:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),f=0;f<c;f++)d[f]=b.charCodeAt(f);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Qt=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=p();b&&a.Qt in b&&(a.status=200,b[a.Qt]&&(a.response=a.dQ(b[a.Qt])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var f=b[d];20===f.state&&c++;if(c>=I.PW)break;if(10===f.state)switch(f.state=20,c++,f.type){case a.it:y(f,"arraybuffer");break;case a.ln:y(f,"json");break;case a.Vx:y(f,"text");break;case a.Tx:r(f);break;case a.jt:A(f);break;case a.Ux:k(f);break;case a.lt:w(f);break;
case a.kt:n(f);break;default:D.q("Wrong asset type: "+f.type)}}}function y(b,c){var d=b.url.split("?t=")[0];if(d in O)"json"==c?b.$b(D.S(O[d]),b.id,b.type,b.url,b.Jb):b.$b(O[d],b.id,b.type,b.url,b.Jb);else{var f=p(),g=f&&b.url in f?new e:new XMLHttpRequest,f=null;if("GET"==b.fi)g.open("GET",b.url,!0);else if("POST"==b.fi)switch(g.open("POST",b.url,!0),b.yo){case a.vE:f="text/plain";break;case a.uE:f="application/json"}if(b.vk)for(var m in b.vk)"Content-Type"==m?f=b.vk[m]:g.setRequestHeader(m,b.vk[m]);
f&&g.setRequestHeader("Content-Type",f);"text"==c?(g.overrideMimeType("text/plain"),g.responseType="text"):"json"==c?(g.overrideMimeType("application/json"),g.responseType="text"):g.responseType=c;g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState){if(200==g.status||0==g.status){var a=g.response;if(a){if("json"==c&&"string"==typeof a)try{a=JSON.parse(a,b.dW)}catch(f){K.error(f+" (parsing JSON "+b.url+")");b.$b(null,b.id,b.type,b.url,b.Jb);return}b.Yg&&(O[d]="json"==c?D.S(a):a);b.$b(a,
b.id,b.type,b.url,b.Jb)}else K.error("empty responce when trying to get "+b.url),b.$b(null,b.id,b.type,b.url,b.Jb)}else K.error(g.status+" when trying to get "+b.url),b.$b(null,b.id,b.type,b.url,b.Jb);b.state=30}};g.addEventListener("progress",function(a){a.lengthComputable&&b.OK(a.loaded/a.total)},!1);g.send(b.Jm)}}function r(a){var b=a.url.split("?t=")[0];if(b in P)a.$b(P[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for audio buffer");var c=(b=p())&&a.url in
b?new e:new XMLHttpRequest;c.open("GET",a.url,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(40!=a.state&&4==c.readyState)if(200==c.status||0==c.status){var b=c.response;b?G.xT(b,function(b){a.$b(b,a.id,a.type,a.url,a.Jb);a.state=30;a.Yg&&(P[a.url.split("?t=")[0]]=b)},function(){a.$b(null,a.id,a.type,a.url,a.Jb);K.error("failed to decode "+a.url);a.state=30}):(a.$b(null,a.id,a.type,a.url,a.Jb),K.error("empty responce when trying to get "+a.url),a.state=30)}else a.$b(null,a.id,
a.type,a.url,a.Jb),K.error(c.status+" when trying to get "+a.url),a.state=30};c.send(a.Jm)}}function A(a){var b=a.url.split("?t=")[0];if(b in x)a.$b(x[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for image element");var c=document.createElement("img");L.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.$b(c,a.id,a.type,a.url,a.Jb),a.state=30,a.Yg&&(x[a.url.split("?t=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(a.$b(null,
a.id,a.type,a.url,a.Jb),K.error("could not load image: "+a.url),a.state=30)},!1);if((b=p())&&a.url in b)if(b[a.url]){var d=f(a.url);c.src="data:"+d+";base64,"+b[a.url]}else Q.Hr()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function k(a){var b=a.url.split("?t=")[0];if(b in g)a.$b(g[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for audio element");var c=document.createElement("audio");
L.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.$b(c,a.id,a.type,a.url,a.Jb),a.state=30,a.Yg&&(g[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.$b(null,a.id,a.type,a.url,a.Jb),K.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.$b(null,a.id,a.type,a.url,a.Jb),K.error("could not load sound: "+a.url),a.state=30)},!1);if((b=p())&&a.url in b)if(b[a.url]){var d=
v(a.url);c.src="data:"+d+";base64,"+b[a.url];40!=a.state&&(a.$b(c,a.id,a.type,a.url,a.Jb),a.state=30)}else Q.Hr()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,L.is_mobile_device&&c.load();L.cC&&(c.autoplay=!0,c.pause());setTimeout(function(){c.bZ=1},5E3)}}function w(a){function b(){40!=a.state&&(a.$b(null,a.id,a.type,a.url),K.error("could not load video: "+a.url,a.Jb),a.state=30)}var d=a.url.split("?t=")[0];
if(d in x)a.$b(x[d],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for video element");var f=document.createElement("video");f.muted=!0;L.allow_cors&&(f.crossOrigin="Anonymous");f.addEventListener("loadeddata",function(){f.removeEventListener("error",b,!1);40!=a.state&&(a.$b(f,a.id,a.type,a.url,a.Jb),a.state=30,a.Yg&&(x[a.url.split("?t=")[0]]=f))},!1);f.addEventListener("error",b,!1);if((d=p())&&a.url in d)if(d[a.url]){var e=c(a.url);f.src="data:"+e+";base64,"+
d[a.url];40!=a.state&&f.addEventListener("loadeddata",function(){a.$b(f,a.id,a.type,a.url,a.Jb);a.state=30},!1)}else Q.Hr()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),f.dispatchEvent(d);else f.src=a.url,L.is_mobile_device&&f.load();L.cC&&(f.autoplay=!0,f.pause());setTimeout(function(){f.bZ=1},1E4)}}function n(b){function c(a){b.$b(a,b.id,b.type,b.url,b.Jb);b.state=30;b.Yg&&(x[b.url.split("?t=")[0]]=a)}var d=b.url.split("?t=")[0];if(d in
x)b.$b(x[d],b.id,b.type,b.url,b.Jb),b.state=30;else{"GET"!=b.fi&&D.q("Unsupported request type for seq video element");var f=(d=p())&&b.url in d?new e:new XMLHttpRequest;if(null==b.yo&&null==b.Jm)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.yo){case a.vE:f.setRequestHeader("Content-type","text/plain");break;case a.uE:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?l(a,c):(b.$b(null,b.id,b.type,b.url,b.Jb),K.error("empty responce when trying to get "+b.url),b.state=30)}else b.$b(null,b.id,b.type,b.url,b.Jb),K.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.OK(a.loaded/a.total)},!1);f.send(b.Jm)}}function l(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),f=c[3],e={images:[],jG:[],Vg:c[4]},g=20,m=0;m<f;m++){var k=c[g/4],l=new Blob([d.subarray(g+4,g+4+k)],
{type:"image/jpg"}),h=document.createElement("img");h.src=window.URL.createObjectURL(l);e.images.push(h);e.jG.push(l);g+=k+8-k%4}h.onload=function(){for(var a=0;a<e.images.length;a++)window.URL.revokeObjectURL(e.images[a].src);delete e.jG;b(e)}}function f(a){var b="image";switch(D.fB(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function v(a){var b="audio";switch(D.fB(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function c(a){var b="video";switch(D.fB(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var B=h("__config"),Q=h("__compat"),K=h("__print"),G=h("__sfx"),D=h("__util"),R=h("__version"),L=B.B,I=B.Pd;a.it=10;a.ln=20;a.Vx=30;a.Tx=40;a.jt=50;a.Ux=60;a.lt=70;a.kt=80;a.uE=a.ln;a.vE=a.Vx;var z=[],d=0,m={},O={},x={},g={},P={};a.Um=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.H5=function(a){if(m[a])return m[a];var b=I.prevent_caching?a+R.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return m[a]=b;D.q("Error XHR: responce is empty, GET "+a)}else D.q("Error XHR: "+c.status+", GET "+a)};a.ua=function(){for(var a=0;a<z.length;a++)z[a].state=40;z=[];d=0;m={}};a.Ud=function(a,c,f,e,g){for(var m=0;m<a.length;m++){var k=a[m],k={id:k.id,type:k.type,url:k.url,
Yg:k.Yg,fi:k.fi?k.fi:"GET",yo:k.yo?k.yo:null,vk:k.vk?k.vk:null,Jm:k.Jm?k.Jm:null,Jb:k.Jb?k.Jb:null,state:10,$b:c||function(){},zK:f||function(){},OK:e||function(){},dW:g||null,AK:d};if(I.prevent_caching){var l=p();l&&k.url in l||(k.url+=R.timestamp())}z.push(k)}b(z);d++};a.update=function(){b(z);for(var a=z,c=0,d=!0,f=0;f<a.length;f++){var e=a[f];e.AK===a[c].AK?30!==e.state&&(d=!1):(d&&(a[f-1].zK(),d=f-c,a.splice(c,d),f-=d),c=f,d=30===a[f].state?!0:!1);f===a.length-1&&d&&(a[f].zK(),a.splice(c))}};
a.OR=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.bS=function(){O={};x={};g={};P={}}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__data=function(a,h){function p(a,b){Ua[b.id]=null;Aa[b.id]=null}function e(a,b,c,d){a instanceof ArrayBuffer&&(a=M.gJ(a,d));d=a.width;a=a.height;va.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(ab)&&c&&va.warn("image",b,"is not from app root.")}function b(a,b,c,d,f,e){(d=b.Tg)||Da.q("Nothing requested");la.Ud([{id:d,type:la.ln,url:d,Yg:b.gk}],function(d,e,g,m){if(d){va.log("%cLOAD METADATA","color: #616",m);e=Da.uM(d.b4w_format_version);
switch(Da.xN(e,ra.ym)){case -1:e[0]<ra.ym[0]?Da.q("JSON version is too old relative to B4W engine: "+Da.bl(e)+", required: "+Da.bl(ra.ym)+". Reexport scene with the latest B4W addon to fix it."):va.warn("JSON version is a bit old relative to B4W engine: "+Da.bl(e)+", required: "+Da.bl(ra.ym)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:e[0]>ra.ym[0]?Da.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
va.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ra.SB=e;for(var k in d)a[k]=d[k];b.Mb&&(Ya=H.Ru(a.scenes));(d=a.binaries[0].binfile)?b.fG=d:(ua.dx(b,"load_binaries"),ua.dx(b,"prepare_bindata"));ra.is_mobile_device||ua.dx(b,"mobile_media_start");ra.antialiasing&&ra.smaa||ua.dx(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Mb&&"PRIMARY"==k.type||
"ALL"==k.type)&&va.WT(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Mb&&"PRIMARY"==k.type||"ALL"==k.type)&&va.XT(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.gk&&D(a);f(b,c)}else ua.yF(b)},null,function(a){e(b,c,a)})}function y(a,b,c,d,f,e){(d=pa(b.Tg)+b.fG)||Da.q("Binary data is missing");la.Ud([{id:d,
type:la.it,url:d,Yg:b.gk}],function(d,e,g,m){d?(va.log("%cLOAD BINARY","color: #616",m),a.bin_data=d,d=k(d),e=Da.uM(a.b4w_format_version),d[0]!=e[0]&&Da.q("BIN version does not match to JSON version: "+Da.bl(d)+", required: "+Da.bl(ra.ym)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=e[1]&&va.warn("BIN version does not match to JSON version: "+ +Da.bl(d)+", required: "+Da.bl(ra.ym)+". Some compatibility issues can occur. Reexport scene to fix it."),f(b,c)):ua.yF(b)},null,function(a){e(b,
c,a)})}function r(a,b,c,d,f){Y.HG()&&f(b,c)}function A(a,b,c,d,f){d=a.bin_data;var e=a.binaries[0],g=a.objects,m=a.meshes;a=a.actions;var l=Da.MR();k(d);for(var q=["indices"],h=["position","texcoord","texcoord2","shade_tangs"],n=["normal","tangent"],p=["group"],r=["color"],u=0;u<m.length;u++)for(var t=m[u].submeshes,O=0;O<t.length;O++){for(var x in t[O]){var z=t[O][x][1];if(-1!=q.indexOf(x)){var v=t[O][x][0]*Da.DE+e["int"]+12,E=t[O],I=x,B=d;if(l)var P=new Uint32Array(B,v,z);else for(var P=new Uint32Array(z),
B=new DataView(B),y=0;y<z;y++)P[y]=B.getUint32(v+y*Da.DE,!0);E[I]=P}else if(-1!=h.indexOf(x))v=t[O][x][0]*Da.Aj+e["float"]+12,t[O][x]=w(d,v,z,l);else if(-1!=n.indexOf(x)){v=t[O][x][0]*Da.Np+e["short"]+12;E=t[O];I=x;B=d;P=new Float32Array(z);B=new DataView(B);for(y=0;y<z;y++)P[y]=B.getInt16(v+y*Da.Np,!0)/32767;E[I]=P}else if(-1!=p.indexOf(x)){v=t[O][x][0]*Da.Np+e.ushort+12;E=t[O];I=x;B=d;P=new Float32Array(z);B=new DataView(B);for(y=0;y<z;y++)P[y]=B.getUint16(v+y*Da.Np,!0)/65535;E[I]=P}else if(-1!=
r.indexOf(x)){v=t[O][x][0]*Da.Xx+e.uchar+12;E=t[O];I=x;B=d;P=new Float32Array(z);B=new DataView(B);for(y=0;y<z;y++)P[y]=B.getUint8(v+y*Da.Xx,!0)/255;E[I]=P}}z=t[O];if(m[u].b4w_shape_keys.length)for(v=z.base_length,E=z.normal.length/v/3,z.tbn_quat=Da.or(z.normal.subarray(0,3*v),z.tangent.subarray(0,4*v),new Float32Array(z.normal.length/3*4)),I=1;I<E;I++)for(B=I*v,P=0;P<v;P++){var F=z.normal.subarray(3*P,3*(P+1)),y=qa.add(z.normal.subarray(3*(B+P),3*(B+P+1)),F,kb);if(z.tangent.length){var S=z.tangent.subarray(4*
P,4*(P+1)),U=W.add(z.tangent.subarray(4*(B+P),4*(B+P+1)),S,eb),F=Da.YI(F,S,bb),y=Da.YI(y,U,sb);Ma.invert(F,bb);y=Ma.multiply(y,F,bb)}else y=Ma.rotationTo(F,y,bb);z.tbn_quat.set(y,4*(B+P))}else z.tbn_quat=Da.or(z.normal,z.tangent)}for(x=0;x<g.length;x++)for(m=g[x].particle_systems,q=0;q<m.length;q++)h=m[q],h.transforms=w(d,h.transforms[0]*Da.Aj+e["float"]+12,h.transforms[1],l);for(g=0;g<a.length;g++){x=a[g];m=x.fcurves;q=x.frame_range;n=q[0];p=q[1];r=wa.NU(n,p);q=null;0>r&&(r=0);var t=u=!1,A;for(A in m)u|=
-1<A.indexOf("rotation_euler"),t|=-1<A.indexOf("rotation_quaternion");h=[];for(A in m)if(u&&t&&-1<A.indexOf("rotation_euler"))delete m[A];else{var O=m[A],C;for(C in O)z=O[C],v=w(d,e["float"]+z.bin_data_pos[0]*Da.Aj+12,z.bin_data_pos[1],l),E=new Float32Array(r),null===q&&(q=new Int8Array(r)),wa.JQ(z,v,E,q,n,p),z.zf=E;-1<A.indexOf("rotation_euler")&&(wa.gU(m[A]),h.push(A))}for(n=0;n<h.length;n++)p=h[n],r=p.replace("euler","quaternion"),m[r]=m[p],delete m[p];x.$P=q}f(b,c)}function k(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function w(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var f=0;f<c;f++)d[f]=a.getFloat32(b+f*Da.Aj,!0)}return d}function n(a,b,c,e,g){var k=a.cameras,l=a.groups,q=a.materials,h=a.meshes,n=a.node_groups,p=a.objects,r=a.particles,u=a.scenes,t=a.speakers,x=a.lamps,O=a.textures,w=a.worlds;n||(va.warn('"node_groups" datablock undefined. reexport main scene.'),n=a.node_groups=[]);
for(var z="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),E={},I=0;I<z.length;I++)for(var P=a[z[I]],y=0;y<P.length;y++){var F=P[y];E[F.uuid]=F}for(var S=0;S<u.length;S++){for(var U=u[S],A=U.objects,C=0;C<A.length;C++)m(A,C,E);U.camera&&m(U,"camera",E);U.world&&m(U,"world",E)}for(S=0;S<l.length;S++)for(var J=l[S].objects,C=0;C<J.length;C++)m(J,C,E);for(S=0;S<p.length;S++){var L=p[S];L.dupli_group&&
m(L,"dupli_group",E);L.parent&&m(L,"parent",E);L.dg_parent&&m(L,"dg_parent",E);if(L.animation_data){var X=L.animation_data;X.action&&m(X,"action",E);if(X.nla_tracks)for(C=0;C<X.nla_tracks.length;C++)for(var M=X.nla_tracks[C],K=0;K<M.strips.length;K++)M.strips[K].action&&m(M.strips[K],"action",E)}switch(L.type){case "MESH":L.data||Da.q("mesh not found for object "+L.name);m(L,"data",E);for(var T=!1,G=L.modifiers,C=0;C<G.length;C++){var R=G[C];"ARMATURE"==R.type?(T&&va.warn('Object "'+L.name+'" has more than one armature modifiers. Only the first one will be used.'),
T=!0,m(R,"object",E)):"CURVE"==R.type&&m(R,"object",E)}var Z=L.particle_systems;if(Z)for(C=0;C<Z.length;C++)m(Z[C],"settings",E);break;case "ARMATURE":m(L,"data",E);for(var aa=L.pose.bones,ga=L.data.bones,C=0;C<aa.length;C++){var ha=aa[C];ha.bone=ga[ha.bone];var ca=ha.constraints;if(ca)for(K=0;K<ca.length;K++){var sa=ca[K];sa.target&&m(sa,"target",E)}for(var ba=ha.parent_recursive,K=0;K<ba.length;K++)ba[K]=aa[ba[K]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":m(L,"data",E)}if(ca=L.constraints)for(C=
0;C<ca.length;C++)sa=ca[C],sa.target&&m(sa,"target",E);var da=L.lod_levels;if(da)for(C=0;C<da.length;C++){var W=da[C];W.object&&m(W,"object",E)}}for(S=0;S<h.length;S++)for(var oa=h[S].materials,C=0;C<oa.length;C++)m(oa,C,E);for(S=0;S<q.length;S++){for(var ia=q[S],ea=ia.texture_slots,C=0;C<ea.length;C++)m(ea[C],"texture",E);var Y=ia.node_tree;Y&&d(Y,E)}for(S=0;S<n.length;S++)(Y=n[S].node_tree)&&d(Y,E);for(S=0;S<O.length;S++){var la=O[S],na=la.type;"IMAGE"!=na&&"ENVIRONMENT_MAP"!=na||m(la,"image",E)}for(S=
0;S<k.length;S++){var ya=k[S];ya.dof_object&&m(ya,"dof_object",E)}for(S=0;S<t.length;S++){var fa=t[S];fa.sound&&m(fa,"sound",E);if(fa.animation_data&&(X=fa.animation_data,X.action&&m(X,"action",E),X.nla_tracks))for(C=0;C<X.nla_tracks.length;C++)for(M=X.nla_tracks[C],K=0;K<M.strips.length;K++)M.strips[K].action&&m(M.strips[K],"action",E)}for(S=0;S<r.length;S++){for(var ta=r[S],ea=ta.texture_slots,C=0;C<ea.length;C++)m(ea[C],"texture",E);ta.dupli_group&&m(ta,"dupli_group",E);ta.dupli_object&&m(ta,"dupli_object",
E)}for(S=0;S<x.length;S++){var ja=x[S];if(ja.animation_data&&(X=ja.animation_data,X.action&&m(X,"action",E),X.nla_tracks))for(C=0;C<X.nla_tracks.length;C++)for(M=X.nla_tracks[C],K=0;K<M.strips.length;K++)M.strips[K].action&&m(M.strips[K],"action",E)}for(S=0;S<w.length;S++){var sb=w[S];if(ea=sb.texture_slots)for(C=0;C<ea.length;C++)m(ea[C],"texture",E);if(sb.animation_data&&(X=sb.animation_data,X.action&&m(X,"action",E),X.nla_tracks))for(C=0;C<X.nla_tracks.length;C++)for(M=X.nla_tracks[C],K=0;K<M.strips.length;K++)M.strips[K].action&&
m(M.strips[K],"action",E)}Ga.HR(a);D(a);for(var ka=pa(b.Tg),xa=a.textures,za=b.Mb?a.scenes[0].b4w_anisotropic_filtering:Ya.b4w_anisotropic_filtering,ma=0;ma<xa.length;ma++)b.Mb||"SCENE"!=xa[ma].b4w_source_type||(xa[ma].b4w_source_id=""),Ha.kT(xa[ma],za,a.scenes,b.id,ka);for(var nb={},ua=a.objects,qa=0;qa<ua.length;qa++){var ra=ua[qa];if("MESH"===ra.type&&!ra.particle_systems.length)for(var Ea=ra.data,Pa=Ea.name,lb=Ea.submeshes,Va=Ea.materials,Ma=0;Ma<lb.length;Ma++)0!==lb[Ma].base_length||nb[Pa]||
(Va[Ma]&&va.warn('material "'+Va[Ma].name+'" is not assigned to any face (object "'+ra.name+'").'),nb[Pa]=!0)}for(var Ja=a.meshes,Ka=0;Ka<Ja.length;Ka++){var wb=Ja[Ka];wb.materials.length||wb.uv_textures.length&&va.warn('mesh "'+wb.name+'" has a UV map but has no exported material.')}a.materials.push(Ga.AS());for(var Na=a.meshes,Oa=Da.Dd("name","DEFAULT",a.materials),La=0;La<Na.length;La++){var Qa=Na[La];0==Qa.materials.length&&Qa.materials.push(Oa)}for(var Ra=a.actions,Sa=b.id,Ua=0;Ua<Ra.length;Ua++){var bb=
Ra[Ua];bb.aQ=Sa;wa.jQ(bb)}for(var qb=a.scenes,ab=0;ab<qb.length;ab++){for(var kb=qb[ab],eb=[],pb=[],zb=qb[ab].objects,Ab=0;Ab<zb.length;Ab++){var Wb=zb[Ab];N(zb,Wb,null,eb,pb);var Cb=Wb.dupli_group;if(Cb)for(var Xa=Cb.objects,$a=0;$a<Xa.length;$a++)N(Xa,Xa[$a],Wb,eb,pb)}for(Ab=0;Ab<pb.length;Ab++)for(var ic=pb[Ab],gc=[kb],Nb=0;Nb<gc.length;Nb++){for(var xc=gc[Nb].objects,hd=0;hd<xc.length;hd++){var Uc=xc[hd].dupli_group;if(Uc){var yc=Uc.objects,qc=yc.indexOf(ic);-1<qc&&yc.splice(qc,1)}}var qc=xc.indexOf(ic);
-1<qc&&xc.splice(qc,1)}for(Ab=0;Ab<eb.length;Ab++)Da.EQ(eb[Ab][0],eb[Ab][1])}!b.Mb&&1<a.scenes.length&&(a.scenes=[H.Ru(a.scenes)],va.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Lc=b.Mb?Ya:H.Ru(a.scenes);Ac.qY(Ya.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Ya),1),a.scenes.unshift(Ya));for(var Vc=0;Vc<a.scenes.length;Vc++){var hc=a.scenes[Vc];hc.s={};hc.wF=hc==Lc;hc.bQ=b.Mb;Ta.enabled&&hc.b4w_enable_physics&&(b.Mb||!Ba.Lw(Ya)&&hc==H.Ru(a))&&
Ba.LV(hc)}for(var rc=0;rc<a.scenes.length;rc++){for(var Vb=a.scenes[rc],Mc=v(Vb),jd=0;jd<Mc.length;jd++){var zc=Mc[jd];Ca.IR(zc,Vb,a)&&(zc.qd||(zc.qd=[]),zc.qd.push(b.Mb?Vb:Ya))}for(var pd=Mc,kd=0;kd<pd.length;kd++){var ld=pd[kd];if(ld.qd&&"WORLD"!=ld.type)for(var wd=ld.particle_systems,qd=0;qd<wd.length;qd++){var ad=wd[qd].settings;if("HAIR"==ad.type)if("OBJECT"==ad.render_type){var sc=ad.dupli_object;sc.qd||(sc.qd=ld.qd.slice())}else if("GROUP"==ad.render_type)for(var bd=ad.dupli_group,rd=0;rd<
bd.objects.length;rd++)sc=bd.objects[rd],sc.qd||(sc.qd=ld.qd.slice())}}}for(var cd=a.scenes,sd=[],Hb=0;Hb<cd.length;Hb++)B(cd[Hb].objects,0,b.Mb,sd);Aa[b.id]=[];for(Hb=0;Hb<sd.length;Hb++)for(var xd=sd[Hb],Pc=0;Pc<xd.length;Pc++)for(var Jd=xd[Pc],zd=0;zd<Jd.length;zd++)Aa[b.id].push(Jd[zd]);for(var Ad=a.particles,Hb=0;Hb<Ad.length;Hb++){var td=Ad[Hb].dupli_object;td&&(td.vF=!0,Aa[b.id].push(td));var Kd=Ad[Hb].dupli_group;if(Kd)for(var Ld=Kd.objects,Pc=0;Pc<Ld.length;Pc++)td=Ld[Pc],td.vF=!0,Aa[b.id].push(td)}for(var Bd=
Aa[b.id],Hb=Bd.length-1;0<=Hb;Hb--)Bd[Hb].qd||Bd.splice(Hb,1);for(var Md=Aa[b.id],rc=0;rc<Md.length;rc++)if(zc=Md[rc],!b.Mb&&zc.parent&&-1<Ob.indexOf(zc.parent.type)&&(zc.parent=""),"MESH"==zc.type){var Cd=Ga.HQ(zc);Cd&&(a.meshes.push(Cd),zc.data=Cd)}for(var Dd=0;Dd<a.scenes.length;Dd++){var Nd=a.scenes[Dd],Ed=Nd.world;Ed.qd||(Ed.qd=[]);Ed.qd.push(b.Mb?Nd:Ya)}for(var Od=a.node_groups,Pd=a.materials,md=0;md<Od.length;md++){var ud=Od[md].node_tree;if(ud){var yd=[];f(ud,yd,!0);ud.jz=yd}}for(md=0;md<
Pd.length;md++)if(ud=Pd[md].node_tree)yd=[],f(ud,yd,!1),ud.jz=yd;for(var Fd=0;Fd<a.scenes.length;Fd++){var Gd=a.scenes[Fd];if(Gd.b4w_use_logic_editor){var Qd=v(Gd);Ga.OQ(Qd,Gd)}}for(var Hd=0;Hd<a.scenes.length;Hd++){var Rd=a.scenes[Hd],Id=b.Mb?Rd:Ya;Boolean(Q(b.id,Id,"SPEAKER").length)&&!Id.Rc&&V.TQ(Id)}g(b,c)}function l(a,b){for(var c=pa(b.Tg),d=[],f=[],e=0;e<a.speakers.length;e++){var g=a.speakers[e],m=g.sound.uuid;if(-1==f.indexOf(m)){f.push(m);switch(g.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var k=
la.Tx;break;case "BACKGROUND_MUSIC":k=la.Ux}g=Da.gj(c+g.sound.filepath);la.Um(g);da(d,m,k,g,b.gk)}}d.length&&la.Ud(d,function(){},function(){})}function f(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],g=e.type;if("GROUP"==g&&e.node_group){if(e=e.node_group.node_tree)if(c)f(e,b,!0);else for(e=e.jz,g=0;g<e.length;g++){var m=e[g];-1==b.indexOf(m)&&b.push(m)}}else-1!=Wb.indexOf(g)&&-1==b.indexOf(g)&&b.push(g)}}function v(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);
c(a.objects,"ALL",b);return b}function c(a,b,d){for(var f=0;f<a.length;f++){var e=a[f];"ALL"!=b&&b!=e.type||d.push(e);(e=e.dupli_group)&&c(e.objects,b,d)}}function B(a,b,c,d){d[b]=d[b]||[];for(var f=d[b],e=0;e<a.length;e++){var g=a[e],m=oa(g);f[m]=f[m]||[];(c||-1==Ob.indexOf(g.type))&&-1==f[m].indexOf(g)&&f[m].push(g);(g=g.dupli_group)&&B(g.objects,b+1,c,d)}}function Q(a,b,c){var d=[];a=Aa[a];for(var f=0;f<a.length;f++){var e=a[f];if(e.type==c||"ALL"==c)for(var g=0;g<e.qd.length;g++)b==e.qd[g]&&d.push(e)}return d}
function K(a,b,c,d,f){var e=Aa[b.id],g=a.worlds;d=b.id;for(var m=0;m<e.length;m++){for(var k=e[m],l=ma.Lq(k.name,k.type,k.origin_name),q=0;q<k.qd.length;q++)ma.Yp(l,k.qd[q]);k.pb=l;Ca.Wk(k,l);l.k.Ue=d;l.Gr=k.vF||!1}for(d=0;d<g.length;d++){m=g[d];k="%meta_world%"+m.name;k=ma.Lq(k,"WORLD",k);for(l=0;l<m.qd.length;l++)ma.Yp(k,m.qd[l]);m.pb=k;Ca.A_(m,k)}d=Ca.cm(b.id);for(m=0;m<e.length;m++)k=e[m],l=k.pb,xa.Wk(k,l);for(m=0;m<g.length;m++)k=g[m],xa.Wk(k,k.pb);if(b.Mb)for(g=b.id,m=0;m<a.scenes.length;m++)for(var k=
a.scenes[m],l=0,q=Ca.Ub(k,"LAMP",g),h=0;h<q.length;h++)ma.ka(q[h],k).wm=l++;for(m=0;m<e.length;m++)k=e[m],l=k.pb,l.Gr||(Ca.n_(k,l),Sa.D(l));for(a=0;a<e.length;a++)if(g=e[a],m=g.pb,ma.$d(m)||ma.bo(m))if(k=g.lod_levels.length)for(l=m,m.k.co=!0,q=0;q<k;q++)if(h=g.lod_levels[q].object){h=h.pb;h.k.co=!0;h.k.dh=m.k.dh;l.k.ef=g.lod_levels[q].distance;h.k.bh=g.lod_levels[q].distance;if(g.lod_levels[q+1])h.k.ef=g.lod_levels[q+1].distance;else{h.k.ef=ma.Hp;break}l=h}else{l.k.ef=g.lod_levels[q].distance;break}for(e=
0;e<d.length;e++)if(a=d[e],"MESH"==a.type&&(g=a.Yt)){var g=g.k,m=a.k.Di,k=[],n;for(n in m)l=m[n],k.push(4*l.BA,4*l.Jj);g.$v.push(k);g.Mo.push(a.k)}e=n=-1;a=wa.BI();for(g=0;g<d.length;g++)m=d[g],k=m.k,ma.$d(m)&&k.hk&&(m=k.eh,m>n&&(n=m),a>=m&&m>e&&(e=m));for(g=0;g<d.length;g++)m=d[g],k=m.k,ma.$d(m)&&k.hk&&(k.Xl=!0,n<a?k.eh=n:k.eh<=a?k.eh=e:(va.warn('too many bones for "'+m.name+'" / '+k.eh+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.eh=
n,k.Xl=!1),k.Xl=k.Xl&&!Qa.UH);for(n=0;n<d.length;n++)if(e=d[n],e.af)if(a=e.of,"CHASSIS"==a.gf){e.v={};e.v.ir=a.ir;e.v.nq=a.nq;e.v.FD=a.FD;e.v.HD=a.HD;e.v.GD=a.GD;e.v.qE=a.qE;e.v.WC=a.WC;e.v.YB=a.YB;e.v.Nn=0;e.v.mq=1;e.v.To=0;e.v.speed=0;e.v.Km=[];e.v.ms=[];e.v.Vo=null;m=(g=ma.Ri(e))?ma.dB(g,d):d;for(g=0;g<m.length;g++)k=m[g],k.af&&(l=k.of,Ba.RV(k)&&a.name==l.name?(l=Ba.$_(k.of.gf),e.v.Km[l]=k,e.v.ms[l]=new Float32Array(8)):Ba.IJ(k)&&a.name==l.name?(e.v.Vo=k,e.v.Uo=l.Uo,e.v.Ns=l.Ns,e.v.Er=l.Er,l=fa.invert(e.k.n,
fa.create()),k=fa.multiply(l,k.k.n,l),e.v.sM=k,l=new Float32Array([1,0,0]),fa.wd(l,k,l),e.v.rM=l):Ba.HJ(k)&&a.name==l.name?(e.v.yD=k,e.v.Ls=l.Ls,e.v.lo=l.lo,l=fa.invert(e.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),e.v.nM=k,l=new Float32Array([1,0,0]),fa.wd(l,k,l),e.v.mM=l):Ba.JJ(k)&&a.name==l.name&&(e.v.JD=k,e.v.Uq=l.Uq,l=fa.invert(e.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),e.v.EM=k,l=new Float32Array([1,0,0]),fa.wd(l,k,l),e.v.DM=l));4!=e.v.Km.length&&Da.q("Not enough wheels for chassis "+e.name)}else if("HULL"==
a.gf)for(e.v={},e.v.Km=[],e.v.ms=[],e.v.ir=a.ir,e.v.nq=a.nq,e.v.Vl=a.Vl,e.v.fn=a.fn,e.v.gn=a.gn,e.v.Nn=0,e.v.mq=1,e.v.To=0,e.v.speed=0,e.v.Vo=null,m=(g=ma.Ri(e))?ma.dB(g,d):d,g=0;g<m.length;g++)k=m[g],k.af&&(l=k.of,Ba.QV(k)&&a.name==l.name?(e.v.Km.push(k),e.v.ms.push(new Float32Array(8))):Ba.IJ(k)&&a.name==l.name?(e.v.Vo=k,e.v.Uo=l.Uo,e.v.Ns=l.Ns,e.v.Er=l.Er,l=fa.invert(e.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),e.v.sM=k,l=new Float32Array([1,0,0]),fa.wd(l,k,l),e.v.rM=l):Ba.HJ(k)&&a.name==l.name?
(e.v.yD=k,e.v.Ls=l.Ls,e.v.lo=l.lo,l=fa.invert(e.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),e.v.nM=k,l=new Float32Array([1,0,0]),fa.wd(l,k,l),e.v.mM=l):Ba.JJ(k)&&a.name==l.name&&(e.v.JD=k,e.v.Uq=l.Uq,l=fa.invert(e.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),e.v.EM=k,l=new Float32Array([1,0,0]),fa.wd(l,k,l),e.v.DM=l));for(n=0;n<d.length;n++)if(e=d[n],e.qm&&(a=e.Qn,"MAIN_BODY"==a.gf))for(e.cg={},e.cg.Vl=a.Vl,e.cg.fn=a.fn,e.cg.gn=a.gn,e.cg.fu=[],g=(g=ma.Ri(e))?ma.dB(g,d):d,m=0;m<g.length;m++)k=g[m],k.qm&&
(l=k.Qn,Ba.VV(k)&&a.name==l.name&&(e.cg.fu.push(k),k.lG=k.Qn.CM));f(b,c)}function G(a,b,c,d,f){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];e.Cj=e.camera.pb}for(d=0;d<a.scenes.length;d++){var e=b.Mb?a.scenes[d]:Ya,g=b.Mb?Ca.Ub(e,"LAMP",b.id):Ca.Ub(e,"LAMP",0),m=Ca.Ub(e,"ALL",b.id),k=Q(b.id,e,"MESH"),l=Q(b.id,e,"EMPTY");Q(b.id,e,"WORLD");b.Mb&&H.qQ(e,m,g,k,l);for(var m=!1,q=0;q<l.length;q++)for(var h=l[q].pb,n=h.I,p=0;p<n.length;p++){var r=n[p].yb,u=H.bN(r,h);e.name==r.name&&(m=m||u)}b.Mb&&e.s.Mc&&
!m&&va.warn('Scene "'+e.name+'" has water but has no wind. Using default settings.');l=[];H.Pw(e);ia.JU(e,k,g,l);q=Q(b.id,e,"LINE");ia.IU(e,q);h=H.gB(e);if(b.Mb){m=e.s.ex;q=e.world;if(m.aL||m.procedural_skydome)n=q.pb,ia.vQ(e,m,n),ia.iA(n,h,e);H.$H(e,h);(m=e.s.pp)&&m.Xs&&ia.nQ(e,q.pb)}for(q=0;q<k.length;q++)ia.iA(k[q].pb,h,e);for(q=0;q<l.length;q++)ia.iA(l[q],h,e),Ca.bX(l[q]);m=Ca.Ub(e,"ALL",b.id);H.PQ(e,m,g);for(q=0;q<m.length;q++)h=m[q],h.k.Le&&Ca.b_(h),ma.PR(h)&&(h.lK=!0)}H.rQ(Ya,a.textures,b.id);
b.Mb&&Ya.s.mp.length&&(b.tB=!0);f(b,c)}function D(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c],f=Boolean("FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==ra.Gq);d.Dh=f;d.Sp=f?"dds":""}if((La.AA||La.Cw)&&ra.jN)for(a=0;a<b.length;a++){for(var d=b[a],e=d.texture_slots,c=0;c<e.length;c++){var f=e[c],g=f.texture;if("IMAGE"==g.type||"ENVIRONMENT_MAP"==g.type){var m=g.image;m&&!m.Dh&&(f=!g.b4w_disable_compression&&!f.use_map_normal&&"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&
"MOVIE"!=m.source,R(m,f))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){e=d[c];f=!1;if("TEXTURE"==e.type){if((g=e.texture)&&(m=g.image)&&!m.Dh&&(f=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{f=e.outputs;for(e=0;e<f.length;e++)if(g=f[e],g.is_linked&&"Normal"==g.identifier){f=!0;break a}f=!1}f=!f}}else"TEX_IMAGE"==e.type?(m=e.image)&&!m.Dh&&(f="MOVIE"!=m.source):"TEX_ENVIRONMENT"==e.type&&(f=!1);m&&!m.Dh&&R(m,f)}}}function R(a,b){-1<a.filepath.indexOf(".dds")?
(a.Dh=!0,a.Sp="dds"):(a.Dh=b)?(a.Sp=ra.Gq,a.filepath="dds"==ra.Gq?a.filepath+".dds":la.Um(a.filepath)[0]+".pvr"):a.Sp=""}function L(a,b,c,d,f){d=a.groups;for(var e=a.objects,g={},m={},k={},l={},q=0;q<d.length;q++){var h=d[q];g[h.uuid]=h;k[h.uuid]=h}for(q=0;q<e.length;q++)h=e[q],m[h.uuid]=h,l[h.uuid]=h;a=a.scenes;for(q=0;q<a.length;q++)I(a[q].objects,null,l,k,null);for(var n in k)n in g||d.push(k[n]);for(n in l)n in m||e.push(l[n]);f(b,c)}function I(a,b,c,d,f){for(var e=[],g=0;g<a.length;g++){var m=
a[g],k=c[m.uuid];if(m=k.proxy){b&&-1==e.indexOf(m.uuid)&&e.push(m.uuid);for(var l=c[m.uuid],q=l.constraints,m=0;m<q.length;m++){var h=Da.Ih(q[m]);h.name+="_CLONE";k.constraints.push(h)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(l.animation_data=Da.Ih(k.animation_data)),l.b4w_use_default_animation=k.b4w_use_default_animation,l.b4w_auto_skel_anim=k.b4w_auto_skel_anim,l.b4w_anim_behavior=k.b4w_anim_behavior,l.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=0;g<e.length;g++)k=
Da.gV(a,e[g]),-1<k&&a.splice(k,1);e={};if(b)for(g=0;g<a.length;g++)m=a[g],k=c[m.uuid],q=Da.Ih(k),l="origin_name"in k?k.origin_name:k.name,q.name=ma.ZH(b.name,l),q.origin_name=l,q.dg_parent={uuid:b.uuid},z(q),c[q.uuid]=q,e[m.uuid]=q.uuid,m.uuid=q.uuid,f&&f[k.uuid]&&(q.b4w_cluster_data=f[k.uuid]);for(g=0;g<a.length;g++)m=a[g],k=c[m.uuid],k.dupli_group&&(m=k.dupli_group,f=d[m.uuid],q=Da.Ih(f),q.name=Da.Qs(f.name+"_CLONE"),q.uuid=ja.oJ("Group"+q.name),d[q.uuid]=q,m.uuid=q.uuid,I(q.objects,k,c,d,k.b4w_cluster_data));
if(b)for(g=0;g<a.length;g++){m=a[g];k=c[m.uuid];k.parent&&k.parent.uuid in e?k.parent.uuid=e[k.parent.uuid]:k.parent&&(va.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);q=k.constraints;for(m=0;m<q.length;m++)b=q[m],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);if(b=k.pose)for(d=b.bones,m=0;m<d.length;m++)if(f=d[m].constraints)for(q=0;q<f.length;q++)b=f[q],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=k.modifiers;
for(m=0;m<b.length;m++)d=b[m],d.object&&d.object.uuid in e&&(d.object.uuid=e[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(m=0;m<k.length;m++)b=k[m],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var n in e)Ka[n]=e[n]}function z(a){a.uuid=ja.oJ("Object"+a.name)}function d(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var f=c[d];"TEXTURE"==f.type&&f.texture&&m(f,"texture",b);"LAMP"==f.type&&f.lamp&&(f.lamp.uuid in Ka&&(f.lamp.uuid=Ka[f.lamp.uuid]),b[f.lamp.uuid]||(f.lamp=null));
"GROUP"==f.type&&f.node_group&&m(f,"node_group",b);"TEX_IMAGE"!=f.type&&"TEX_ENVIRONMENT"!=f.type||!f.image||m(f,"image",b)}f=a.links;for(d=0;d<f.length;d++){var e=f[d];O(e,"from_node",c);O(e,"to_node",c);x(e,"from_socket",e.from_node.outputs);x(e,"to_socket",e.to_node.inputs)}if(c=a.animation_data)if(c.action&&m(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(f=c.nla_tracks[d],e=0;e<f.strips.length;e++)f.strips[e].action&&m(f.strips[e],"action",b)}function m(a,b,c){(c=c[a[b].uuid])||
va.error("Dangling link found:",b,a);a[b]=c}function O(a,b,c){c=Da.Dd("name",a[b].name,c);a[b]=c}function x(a,b,c){c=Da.Dd("identifier",a[b].identifier,c);a[b]=c}function g(a,b,c,d,f,g){var m=[],k={};d=a.images;for(var l=Ha.AI(),q=pa(b.Tg),h=0;h<d.length;h++){var n=d[h],p=n.uuid;if(p){var r=Da.gj(q+n.filepath),u=n.source;if("FILE"===u){var u=n.Dh?la.it:la.jt,t=la.Um(r),x=t[1].toLowerCase();if(!la.OR(x)){va.error("image ",n," has unsupported format.");continue}La.bC&&ra.use_min50&&("dds"==t[1]?(r=
la.Um(t[0]),r=r[0]+".min50."+r[1]+".dds"):r=t[0]+".min50."+t[1])}else if("MOVIE"===u)if(ra.zs)t=la.Um(r),r=t[0]+".altconv.seq",u=la.kt;else{t=la.Um(r);x=t[1].toLowerCase();u=V.BT(x);if(""==u){va.error("failed to load video file (unsupported format)",r);continue}r=u!=x?t[0]+".altconv."+u:t[0]+"."+t[1];u=la.lt}else{va.error('Image "'+n.name+'" has unsupported format "'+u+'".');continue}if(!b.gk)for((p in k)||(k[p]=[]),t=0;t<l.length;t++)x=l[t],x.Zn==p&&x.km==n.Sp&&k[p].push(x);k[p].length&&m.push({id:p,
type:u,url:r,Yg:b.gk})}}if(m.length){var O=0;la.Ud(m,function(d,f,l,q){if(d){var h=l;if(!b.gk){f=k[f];for(h=0;h<f.length;h++){var n=f[h];if(l==la.kt)n.xs=d.Vg,Ha.Ss(n,d.images,b.id);else if(Ha.Ss(n,d,b.id),"ENVIRONMENT_MAP"==n.source)for(n=0;n<a.scenes.length;n++)H.dE(a.scenes[n])}h=f[0].km}l==la.lt||l==la.kt?(l==la.lt?(l=d.videoWidth,d=d.videoHeight):(l=d.images[0].width,d=d.images[0].height),va.log("%cLOAD VIDEO "+l+"x"+d,"color: #"+(2048<l||2048<d?"a00":1024<l||1024<d?"aa0":"0a0"),q),-1==q.indexOf(ab)&&
va.warn("video",q,"is not from app root.")):e(d,q,!0,h)}q=++O/m.length;g(b,c,q)},function(){va.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})}else f(b,c)}function P(a,b,c,d,f){a=H.jB();for(d=0;d<a.length;d++){var e=a[d];if(e.b4w_use_nla){var g=e.b4w_nla_cyclic;e.b4w_use_logic_editor&&(g=!1);xa.t_(e,g,b.id)}}f(b,c)}function t(a,b,c,d,f,e){a=pa(b.Tg);var g=[],m={};d=Ca.cm(b.id);for(var k=0;k<d.length;k++){var l=d[k];if(ma.Jr(l)&&V.lM(l)!=V.xE){var q=l.X.wj;"BACKGROUND_MUSIC"==V.lB(l)?(q=Da.XA(),
b.rB=!0):"NONE"!=V.lB(l)&&ra.xB&&(b.wB=!0);if(!(q in m)){m[q]=[];var h=Da.gj(a+l.X.Tg);switch(V.lM(l)){case V.Sx:var n=la.Tx;break;case V.wE:n=la.Ux}da(g,q,n,h,b.gk)}m[q].push(l)}}if(g.length){var p=0;la.Ud(g,function(a,d,f,k){if(a)for(va.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(ab)&&va.warn("sound",k,"is not from app root."),d=m[d],f=0;f<d.length;f++)V.y_(d[f],a);a=++p/g.length;e(b,c,a)},function(){va.log("%cLOADED ALL SOUNDS","color: #0aa");f(b,c)})}else f(b,c)}function da(a,b,c,d,f){var e=
la.Um(d),g=e[1].toLowerCase(),m=V.zT(g);""!=m?(d=m!=g?e[0]+".altconv."+m:e[0]+"."+e[1],a.push({id:b,type:c,url:d,Yg:f})):va.error("failed to load audio file (unsupported format)",d)}function J(a,b,c){a=Ca.Ub(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];ma.Jr(d)&&(V.PV(d)||c)&&V.FK(d)}}function F(a,b){for(var c=a.s.mp,d=0;d<c.length;d++){var f=c[d].s;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=f.ft||(Ha.eL(f),Ha.HK(f))}}function T(a,b,c,d,f){xa.start();va.log("%cSTART NLA","color: #0a0");
f(b,c)}function N(a,b,c,d,f){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,g=0;g<e;g++){var m=b.lod_levels[g],k=m.object;if(k){var l=Da.yq(k);l.name=b.name+"_LOD_"+String(g+1);l.b4w_cluster_data=b.b4w_cluster_data;z(l);l.lod_levels=[];c&&(l.dg_parent=c);d.push([a,l]);f.push(k);m.object=l}}}function ba(a,b,c,d,f){d=!0;for(var e=0;e<a.scenes.length;e++)if(!Ba.TR(a.scenes[e])){d=!1;break}d&&(f(b,c),va.log("%cPHYSICS READY","color: #0a0"))}function u(a,b,c,d,f){for(d=0;d<a.scenes.length;d++){var e=
a.scenes[d];if(b.Mb)var g=Ba.Lw(e);else g=Ba.Lw(Ya)||Ba.Lw(e),e=Ya;if(Ta.enabled&&g)for(g=0;g<ic.length;g++)for(var m=Ca.Ub(e,ic[g],b.id),k=0;k<m.length;k++){var l=m[k];l.k.Ue==b.id&&(Ba.xn(l,e),b.WJ&&Ba.oa(l)&&Ba.HA(l))}}f(b,c)}function ga(a,b,c,d,f){var g={};d=[];for(var m=a.scenes,k=0;k<a.scenes.length;k++){var l=m[k];if(l.s.Mc){var q=l.s.Mc.Lk;if(q&&"FILE"===q.source){var l=q.uuid,h=Da.gj(pa(b.Tg)+q.filepath);d.push({id:l,type:q.Dh?la.it:la.jt,url:h});g[l]=q}}}d.length?la.Ud(d,function(a,c,d,
f){if(a){e(a,f,!0);d=[];f=Ha.AI();for(var k=0;k<f.length;k++){var l=f[k];l.uri===c&&d.push(l)}for(c=0;c<d.length;c++)Ha.Ss(d[c],a,b.id);for(c=0;c<m.length;c++)if(d=m[c],d.s.Mc&&(f=d.s.Mc.Lk,f===q)){var l=a,h=document.createElement("canvas");f=q.size[0];k=q.size[1];h.width=f;h.height=k;h=h.getContext("2d");h.drawImage(l,0,0);l=h.getImageData(0,0,f,k).data;h=new Float32Array(4);h[0]=1/16581375;h[1]=1/65025;h[2]=1/255;h[3]=1;f*=k;for(var k=new Float32Array(f),n=0;n<f;n++)k[n]=h[1]*l[4*n+2]+h[2]*l[4*
n+3];d.s.tD=k}}else for(a=g[c],c=0;c<m.length;c++)d=m[c],f=d.s.Mc.Lk,f===a&&(d.s.Mc.Lk=null,va.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,c)}):f(b,c)}function Z(a,b,c,d,f){d=a.scenes[0];a=[];for(var g=[Cb.It,Cb.Op,Cb.Jt,Cb.dz],m=0;m<g.length;m++){var k=H.La(d,g[m]);k&&a.push(k)}if(a.length){d=[];m=la.jt;d.push({id:"SEARCH_TEXTURE",type:m,Tg:ta.Fe.smaa_search_texture_path});d.push({id:"AREA_TEXTURE",type:m,url:ta.Fe.smaa_area_texture_path});for(m=0;m<
a.length;m++)if(g=a[m],g.type==Cb.Op){a=g.Za;for(m=0;m<a.length;m++)if(g=a[m],"u_search_tex"==g.to)var l=g.kb;else if("u_area_tex"==g.to)var q=g.kb;break}d.length?la.Ud(d,function(a,c,d,f){a&&(e(a,f,!1),c="SEARCH_TEXTURE"==c?l:q,c.source="IMAGE",Ha.Ss(c,a,b.id),Ha.cD(c,Ha.K,Ha.K))},function(){f(b,c)}):f(b,c)}else f(b,c)}function E(a,b,c,d){for(c=0;c<a.scenes.length;c++){var f=a.scenes[c];b.Mb||(f=Ya);for(var e=Ca.Ub(f,"LAMP",b.id),g=0;g<e.length;g++){var m=e[g];m.k.Ue==b.id&&d.mz.push({yb:f,ea:m})}e=
Ca.Ub(f,"ALL",b.id);for(g=0;g<e.length;g++)m=e[g],"LAMP"!=m.type&&m.k.Ue==b.id&&(b.WJ&&ma.$d(m)&&H.sq(m,!0),d.mz.push({yb:f,ea:m}))}}function ca(a,b,c,d,f,e){var g=d.mz;f=d.rK;if(g.length){a=g[f].ea;var m=g[f].yb;f=ma.ka(a,m);H.xn(m,a,!1);!a.anchor||m.s.xv||m.s.anaglyph_use||ya.append(a);d=++d.rK/g.length;g=f.Ji;if(-1!=a.k.Rd&&g){var k=qa.copy(a.k.lb.F,kb);H.aN(g,k)}g=a.ss;if(g.length&&m.s.ei)for(m=fa.G(a.k.n),a=fa.P(a.k.n),f=f.bi,k=0;k<f.length;k++)H.dN(f[k],m,a),ma.eN(g,f[k].p.rc)}else d=1;e(b,
c,d)}function ha(a,b,c,d,f){if(b.Mb){d=H.Rh();H.dE(d);var e=H.jB();for(a=0;a<e.length;a++){var g=e[a];H.dE(g);H.yX(g,d)}H.Pw(d)}else H.fN(Ya);d=Ca.cm(b.id);Ca.o_(d);for(e=0;e<d.length;e++)for(g=d[e],a=0;a<g.I.length;a++)for(var m=g.I[a].W,k=0;k<m.length;k++)null==m[k].zb&&m.splice(k--,1);f(b,c)}function q(a,b,c,d,f){if(b.Mb)for(a=H.jB(),d=0;d<a.length;d++){var e=a[d];e.b4w_use_logic_editor&&ka.JV(e,b.id)}f(b,c)}function S(a,b,c,d,f){if(b.Mb)for(d=0;d<a.scenes.length;d++)F(a.scenes[d],b.id),J(a.scenes[d],
b.id,!1);else F(Ya,b.id),J(Ya,b.id,!1);f(b,c)}function X(a,b,c,d,f){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ra.media_auto_activation&&(b.tB||b.rB||b.wB)?lb||U(a,f,b,c):f(b,c)}function U(a,b,c,d){var f=qb.parentElement;wb=f.style.zIndex;f.style.zIndex="999";lb=document.createElement("div");lb.style.position="relative";lb.style.height="88px";lb.style.width="88px";var e=Math.round(qb.offsetWidth/2-44);lb.style.top=Math.round(qb.offsetHeight/2-44).toString()+"px";lb.style.left=e.toString()+
"px";lb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
lb.style.backgroundSize="88px";nb=document.createElement("div");nb.style.position="relative";nb.style.height=qb.offsetHeight.toString()+"px";nb.style.width=qb.offsetWidth.toString()+"px";nb.style.background="rgba(0, 0, 0, 0.5)";nb.style.zIndex="999";f.appendChild(nb);nb.appendChild(lb);lb.addEventListener("click",function(){c.tB&&(Ha.play(),Ha.pause(),Ha.reset());if(c.rB){if(c.Mb)for(var f=0;f<a.scenes.length;f++)J(a.scenes[f],c.id,!0);else J(Ya,c.id,!0);V.pause()}c.wB&&V.GK();sa();b(c,d)},!1)}function sa(){if(lb){var a=
qb.parentElement;a.style.zIndex=wb;nb.removeChild(lb);a.removeChild(nb);lb=nb=null;wb=0}}function pa(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function aa(a){wa.Dc(a)&&wa.remove(a);Pa.HX(a);Ca.mu(a);na.uq(a)&&na.hf(a);Ba.oa(a)&&Ba.ts(a);H.IX(a);ma.Jr(a)&&V.fZ(a);ya.OV(a)&&ya.remove(a)}function oa(a){var b=wa.mI(a);return(a=b&&b.parent==a?null:a.parent||b)?1+oa(a):0}var ya=h("__anchors"),wa=h("__animation"),la=h("__assets"),ia=h("__batch"),ta=h("__config"),na=h("__controls"),M=h("__texcomp"),
ea=h("__debug"),C=h("__extensions"),za=h("__input"),ua=h("__loader"),ja=h("__md5"),xa=h("__nla"),ka=h("__logic_nodes"),Pa=h("__particles"),Ea=h("__nodemat"),Ca=h("__objects"),ma=h("__obj_util"),Ba=h("__physics"),va=h("__print"),Ma=h("__quat"),Ga=h("__reformer"),Ra=h("__renderer"),H=h("__scenes"),V=h("__sfx"),Y=h("__shaders"),Cb=h("__subscene"),Ha=h("__textures"),Ac=h("__time"),Sa=h("__transform"),fa=h("__tsr"),Da=h("__util"),qa=h("__vec3"),W=h("__vec4"),Qa=ta.sl,ra=ta.B,La=ta.Pd,Ta=ta.C,pb=ta.X,Ua=
null,Aa=null,ab="",Ya=null,Ka={},kb=new Float32Array(3),eb=new Float32Array(4),bb=new Float32Array(4),sb=new Float32Array(4),lb=null,nb=null,wb=0,Va=!1,Ob=["LAMP","CAMERA"],ic=["MESH","CAMERA","EMPTY"],Wb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],qb=null;a.$g=function(a){return ua.$g(a)};a.update=function(){ua.u_(Ua)};a.QY=function(a){qb=a};a.l_=function(a,b){if(lb){nb.style.height=b.toString()+"px";nb.style.width=a.toString()+"px";var c=Math.round(a/2-44);lb.style.top=Math.round(b/2-44).toString()+"px";
lb.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,e){var m={load_main:{Nb:ua.zg,Qb:!1,L:[],Wb:!1,Yb:500,kc:!1,ac:b},duplicate_objects:{Nb:ua.ue,Qb:!1,L:["load_main"],Wb:!1,Yb:50,kc:!1,ac:L},load_binaries:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:y},wait_for_shaders:{Nb:ua.ue,Qb:!1,L:[],Wb:!1,Yb:50,kc:!0,Lj:r},prepare_bindata:{Nb:ua.ue,Qb:!1,L:["duplicate_objects","load_binaries"],Wb:!1,Yb:100,kc:!1,ac:A},prepare_bpy_data:{Nb:ua.ue,Qb:!1,L:["duplicate_objects","prepare_bindata"],
Wb:!1,Yb:100,kc:!1,ac:n},process_objects:{Nb:ua.ue,Qb:!1,L:["prepare_bpy_data"],Wb:!1,Yb:150,kc:!1,ac:K},process_scenes:{Nb:ua.ue,Qb:!1,L:["process_objects","wait_for_shaders"],Wb:!1,Yb:300,kc:!1,ac:G},load_smaa_textures:{Nb:ua.zg,Qb:!1,L:["process_scenes"],Wb:!1,Yb:30,kc:!0,ac:Z},load_shoremap:{Nb:ua.zg,Qb:!1,L:["process_scenes"],Wb:!1,Yb:30,kc:!0,ac:ga},load_images:{Nb:ua.zg,Qb:!0,L:["process_scenes"],Wb:!0,Yb:500,kc:!1,ac:g},update_scenes_nla:{Nb:ua.ue,Qb:!1,L:["process_scenes","load_images"],
Wb:!1,Yb:50,kc:!1,ac:P},wait_physics_workers:{Nb:ua.ue,Qb:!1,L:["load_shoremap"],Wb:!1,Yb:20,kc:!1,Lj:ba},add_physics_objects:{Nb:ua.ue,Qb:!1,L:["wait_physics_workers"],Wb:!1,Yb:50,kc:!1,ac:u},add_objects:{Nb:ua.ue,Qb:!1,L:["add_physics_objects"],Wb:!1,Yb:600,kc:!1,ac:E,Lj:ca,pq:ha,qq:{mz:[],rK:0}},init_logic_nodes:{Nb:ua.ue,Qb:!1,L:["update_scenes_nla","add_objects"],Wb:!1,Yb:50,kc:!1,ac:q},load_speakers:{Nb:ua.zg,Qb:!0,L:["add_objects"],Wb:!0,Yb:100,kc:!1,ac:t},mobile_media_start:{Nb:ua.ue,Qb:!1,
L:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Wb:!0,Yb:5,kc:!1,ac:X,Lj:X},synchronize_media:{Nb:ua.ue,Qb:!0,L:["mobile_media_start"],Wb:!0,Yb:50,kc:!1,ac:S},start_nla:{Nb:ua.ue,Qb:!0,L:["mobile_media_start"],Wb:!1,Yb:5,kc:!0,ac:T}},k=ua.kB();k||(k=ua.fH(),Ua={},Aa={},Ka={});Ua[k.qh.length]={};return ua.kH(m,a,c,d,p,f||pb.UF,ra.do_not_load_resources,e,!1)};a.yx=function(a){var b=ua.kB();if(!b||!b.qh.length||a&&!ua.FZ(b.qh[a]))va.error("Unable to unload data!");else{if(0==
a)va.log("%cUNLOAD ALL","color: #00a"),ya.ua(),wa.ua(),V.ua(),ia.ua(),H.ua(),ua.ua(),na.ua(),Ba.ua(),Ca.ua(),Da.ua(),Ra.ua(),Ea.ua(),Y.ua(),C.ua(),la.ua(),Ha.ua(),ka.ua(),Pa.ua(),za.ua(),ea.ua(),Aa=null,Ka={},Ua=Ya=null,Va=!1;else{va.log("%cUNLOAD DATA "+a,"color: #00a");wa.FX(a);for(var b=Ca.cm(Ca.oc),c=0;c<b.length;c++){var d=b[c];ma.iB(d)!=a&&Ca.mw(d,!1,!1,!1)}b=Ca.cm(a);for(c=b.length-1;0<=c;c--)d=b[c],aa(d),Ca.ts(d);b=Ca.cm(Ca.oc);for(c=0;c<b.length;c++)Ca.mw(b[c],!0,!0,!0)}xa.ua(a);sa()}};a.xX=
aa;a.vL=function(a){ab=a};a.CF=function(){Va||ra.media_auto_activation||(Ha.play(),Ha.pause(),Ha.reset(),J(Ya,Ca.oc,!0),V.pause(),ra.xB&&V.GK(),Va=!0)};a.reset=function(){qb=null};a.IK=function(a,c,d){var f={load_main:{Nb:ua.zg,Qb:!1,L:[],Wb:!1,Yb:500,kc:!1,ac:b},load_binaries:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:y},load_images:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:g},preload_sounds:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:l}},e=ua.kB();e||(e=ua.fH(),
Ua={},Aa={},Ka={});Ua[e.qh.length]={};return ua.kH(f,a,c,d,p,!1,ra.do_not_load_resources,!1,!0)};a.ZM=function(){la.bS()}};b4w.module.__controls=function(a,h){function p(a,b){b||(b=v.Ce());return{type:a,value:0,Z:null,element:b,Ka:!1,key:0,bc:"",Hh:!1,Yz:null,Xz:function(){},Wz:null,QG:function(){},ji:null,from:new Float32Array(3),to:new Float32Array(3),zJ:!1,Av:!1,ps:0,XK:function(){},axis:"",Rf:0,bp:new Float32Array(3),Dw:new Float32Array(4),threshold:0,RK:new Float32Array(4),$t:0,Zt:0,hL:0,au:0,Lf:0,repeat:!1,IH:!1,$l:0,callback:function(){}}}function e(a){function b(){return{Pj:new Float32Array(2),um:!0,ea:null,identifier:-1,
Mv:!0}}a||(a=v.Ce());for(var f=0;f<P.length;f++){var e=P[f];if(a==e.element)return e}e={element:a,Kr:!0,De:0,Nv:!0,dw:0,ew:0,zm:0,Am:0,hs:0,ks:0,rh:new Float32Array(2),re:new Float32Array(2),sh:new Float32Array(2),Ie:new Float32Array(2),sx:0,YD:0,SM:0,We:new Uint8Array(256),Px:0,oB:null,$h:b(),Xm:Array(10),GB:!1,jJ:G.create(),pv:0,ov:0,nv:0,qB:0,pB:0,mv:Infinity,sC:null,rC:null,hC:null,dC:null,fC:null,WD:null,VD:null,gC:null,eC:null,CC:null,O6:null,XD:null,UD:null,TD:null,ij:{}};for(f=0;10>f;++f)e.Xm[f]=
b();e.sC=function(a){e.GB||(c.wV(a,e.jJ),e.GB=!0)};e.rC=function(a){a=I.copy(a,J);e.nv=a[0];e.ov=a[1];e.pv=a[2];Infinity==e.mv&&(e.mv=a[0],e.pB=a[1],e.qB=a[2])};e.hC=function(a){e.Px+=a*z.VW};e.dC=function(a){var b=c.ga(c.ad,e.element),b=c.Ti(b,c.wi,t);e.dw=b[0];e.ew=b[1];e.zm=b[0];e.Am=b[1];if(3==e.De||0==e.De)e.De=1;e.which=a};e.fC=function(){var a=c.ga(c.ad,e.element),a=c.Ti(a,c.wi,t),a=v.ou(a[0],a[1],t);e.$h.um=!1;e.$h.Pj[0]=a[0];e.$h.Pj[1]=a[1]};e.WD=function(a){for(var b=0;b<a.length;++b){for(var c=
a[b],d=null,f=null,g=0;g<e.Xm.length;g++){var m=e.Xm[g];if(m.identifier==c.identifier){m.Mv&&(f=m);break}else!d&&m.Mv&&(d=m,d.identifier=c.identifier)}if(c=f||d)d=v.ou(a[b].clientX,a[b].clientY,t),c.um=!1,c.Mv=!1,c.Pj[0]=d[0],c.Pj[1]=d[1]}};e.VD=function(a){for(var b=0;b<e.Xm.length;++b){for(var c=e.Xm[b],d=!1,f=0;f<a.length;++f)if(a[f].identifier==c.identifier){d=!0;break}d||(c.um=!0,c.Mv=!0,c.ea=null)}};e.gC=function(a){var b=c.ga(c.ad,e.element),b=c.Ti(b,c.wi,t);e.dw=b[0];e.ew=b[1];e.zm=b[0];e.Am=
b[1];0<e.De&&(e.De=3);e.which=a};e.eC=function(a){if(!d.Xn||e.De)e.zm=a[0],e.Am=a[1]};e.CC=function(a){if(!d.Xn||e.De)e.hs+=a[0],e.ks+=a[1]};e.LJ=function(a){2!=e.We[a]&&(e.We[a]=1,e.Kr=!1)};e.NJ=function(){for(var a=0;a<e.We.length;a++)0!=e.We[a]&&(e.We[a]=3,e.Kr=!1)};e.OJ=function(a){e.Kr=!1;e.We[a]=3};e.XD=function(a){e.Nv=!1;if(1==a.length)e.rh[0]=a[0].clientX,e.rh[1]=-1,e.sh[0]=a[0].clientY,e.sh[1]=-1;else if(1<a.length){e.sx=e.YD=n(a);e.rh[0]=a[0].clientX;e.rh[1]=a[1].clientX;e.sh[0]=a[0].clientY;
e.sh[1]=a[1].clientY;var b=a[0];a=a[1];e.SM=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}e.re.set(e.rh);e.Ie.set(e.sh)};e.UD=function(a){1===a.length?(e.re[0]=a[0].clientX,e.re[1]=-1,e.Ie[0]=a[0].clientY,e.Ie[1]=-1):1<a.length&&(e.re[0]=a[0].clientX,e.re[1]=a[1].clientX,e.Ie[0]=a[0].clientY,e.Ie[1]=a[1].clientY,e.sx=n(a))};e.TD=function(a){0==a.length&&(e.Nv=!0)};P.push(e);return e}function b(a,b){if(b in a.ij&&0<a.ij[b])a.ij[b]+=1;else switch(a.ij[b]=1,b){case "orientation_quat":var d=c.ga(c.yh);
d&&c.yd(d,c.on,a.sC);break;case "orientation_angles":(d=c.ga(c.yh))&&c.yd(d,c.on,a.rC);break;case "mouse_wheel":(d=c.ga(c.ad,a.element))&&c.yd(d,c.Jp,a.hC);break;case "mouse_down_which":(d=c.ga(c.ad,a.element))&&c.yd(d,c.il,a.dC);break;case "mouse_select":(d=c.ga(c.ad,a.element))&&c.yd(d,c.il,a.fC);break;case "touch_select":if(d=c.ga(c.Ag,a.element))c.yd(d,c.ml,a.WD),c.yd(d,c.ll,a.VD);break;case "mouse_up_which":(d=c.ga(c.ad,a.element))&&c.yd(d,c.Ip,a.gC);break;case "mouse_location":(d=c.ga(c.ad,
a.element))&&c.yd(d,c.wi,a.eC);break;case "mouse_pointerlock":(d=c.ga(c.ad,a.element))&&c.yd(d,c.LE,a.CC);break;case "keyboard_downed_keys":if(d=c.ga(c.tp,a.element))c.yd(d,c.Fp,a.LJ),c.yd(d,c.FE,a.NJ),c.yd(d,c.Gp,a.OJ);break;case "touch_start":(d=c.ga(c.Ag,a.element))&&c.yd(d,c.ml,a.XD);break;case "touch_move":(d=c.ga(c.Ag,a.element))&&c.yd(d,c.Pp,a.UD);break;case "touch_end":(d=c.ga(c.Ag,a.element))&&c.yd(d,c.ll,a.TD)}}function y(a,b){if(!(!b in a.ij)&&0<a.ij[b]&&(--a.ij[b],!a.ij[b]))switch(b){case "orientation_quat":var d=
c.ga(c.yh);d&&c.Bd(d,c.zt,a.sC);break;case "orientation_angles":(d=c.ga(c.yh))&&c.Bd(d,c.on,a.rC);break;case "mouse_wheel":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.Jp,a.hC);break;case "mouse_down_which":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.il,a.dC);break;case "mouse_select":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.il,a.fC);break;case "touch_select":if(d=c.ga(c.Ag,a.element))c.Bd(d,c.ml,a.WD),c.Bd(d,c.ll,a.VD);break;case "mouse_up_which":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.Ip,a.gC);break;case "mouse_location":(d=
c.ga(c.ad,a.element))&&c.Bd(d,c.wi,a.eC);break;case "mouse_pointerlock":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.LE,a.CC);break;case "keyboard_downed_keys":if(d=c.ga(c.tp,a.element))c.Bd(d,c.Fp,a.LJ),c.Bd(d,c.FE,a.NJ),c.Bd(d,c.Gp,a.OJ);break;case "touch_start":(d=c.ga(c.Ag,a.element))&&c.Bd(d,c.ml,a.XD);break;case "touch_move":(d=c.ga(c.Ag,a.element))&&c.Bd(d,c.Pp,a.UD);break;case "touch_end":(d=c.ga(c.Ag,a.element))&&c.Bd(d,c.ll,a.TD)}}function r(a,b){a.value=Number(b)}function A(a){for(var b=a.Ek,c=a.dY,
d=0;d<b.length;d++)c[d]=b[d].value;return a.FW(c)}function k(a,b){a=a||O;var c=a.oh;if(c){var d=a.Om;if(b){var f=c[b];if(f){for(var e=f.Ek,l=0;l<e.length;l++){var h=e[l],n;n=x.indexOf(h);n=-1<n?g[n]:[];1==n.length?(w(h),h=x.indexOf(h),-1<h?(x.splice(h,1),g.splice(h,1)):L.q("Sensors cache is corrupted")):1<n.length&&n.splice(n.indexOf(f),1)}delete c[b];l=d.indexOf(f);-1<l?d.splice(l,1):L.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=m.indexOf(a),-1<c?m.splice(c,1):Q.error("Wrong object"))}}else{d=
[];for(b in c)d.push(b);for(l=0;l<d.length;l++)k(a,d[l])}T=!0}}function w(a){switch(a.type){case 90:K.OC(a.Yz,a.bc,a.Xz);a.Ka=!0;break;case 100:K.Tz(a.Wz);a.Ka=!0;break;case 110:K.PC(a.ps);a.Ka=!0;break;case 140:a.Ka=!0;break;case 20:var b=e(a.element);y(b,"keyboard_downed_keys");a.Ka=!0;break;case 30:b=e(a.element);y(b,"mouse_wheel");a.Ka=!0;break;case 40:b=e(a.element);y(b,"mouse_down_which");y(b,"mouse_up_which");y(b,"mouse_location");a.Ka=!0;break;case 260:b=e(a.element);y(b,"mouse_pointerlock");
a.Ka=!0;break;case 50:b=e(a.element);y(b,"mouse_down_which");y(b,"mouse_up_which");a.Ka=!0;break;case 60:b=e(a.element);y(b,"touch_start");y(b,"touch_move");y(b,"touch_end");a.Ka=!0;break;case 70:b=e(a.element);y(b,"touch_start");y(b,"touch_move");a.Ka=!0;break;case 75:b=e(a.element);y(b,"touch_start");y(b,"touch_move");a.Ka=!0;break;case 80:b=e(a.element);y(b,"touch_start");y(b,"touch_end");a.Ka=!0;break;case 170:b=e(a.element);y(b,"mouse_select");y(b,"touch_select");y(b,"touch_start");y(b,"touch_end");
y(b,"mouse_down_which");y(b,"mouse_up_which");a.Ka=!0;break;case 180:case 190:b=e(a.element);y(b,"orientation_angles");a.Ka=!0;break;case 200:b=e(a.element);y(b,"orientation_quat");a.Ka=!0;break;case 210:case 220:a.Ka=!0}}function n(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function l(a){return 0==a?c.ga(c.nt):1==a?c.ga(c.ey):2==a?c.ga(c.fy):c.ga(c.gy)}var f=h("__config"),v=h("__container"),c=h("__input"),B=h("__objects"),Q=h("__print"),K=h("__physics"),
G=h("__quat"),D=h("__time"),R=h("__tsr"),L=h("__util"),I=h("__vec3"),z=f.controls,d=f.B,m=[],O={},x=[],g=[],P=[],t=new Float32Array(2),da=new Float32Array(2),J=I.create(),F=G.create(),T=!1,N=0;a.uf=10;a.Qa=20;a.mn=30;a.vf=40;a.sp=50;a.by=60;a.Gt=0;a.Ft=1;a.Et=2;a.cz=3;var ba=1;a.update=function(b,f){for(var g=0;g<P.length;g++){var k=P[g];k.$h.um||(k.$h.ea=B.fs(k.$h.Pj[0],k.$h.Pj[1]),k.$h.um=!0,k.oB=k.$h.ea);for(var h=0;10>h;++h){var n=k.Xm[h];n.um||(n.ea=B.fs(n.Pj[0],n.Pj[1]),n.um=!0,k.oB=n.ea)}}for(g=
0;g<x.length;g++)if(k=x[g],n=b,h=f)switch(k.type){case 120:var q=k.ji,p=R.hc(q.k.n,J),q=R.Xd(q.k.n,F),w=I.dist(k.bp,p),z=k.RK;G.invert(k.Dw,z);G.multiply(q,z,z);G.normalize(z,z);z=Math.abs(2*Math.acos(z[3]));w/=h;k.$t=L.mc(w,k.$t,h,.3);k.Z[0]=w;w=z/h;k.Zt=L.mc(w,k.Zt,h,.3);k.Z[1]=w;k.$t>=k.threshold||k.Zt>=k.hL?r(k,1):r(k,0);I.copy(p,k.bp);G.copy(q,k.Dw);k.Rf=n;break;case 130:q=k.ji;p=R.hc(q.k.n,J);q=Math.abs(p[1]-k.bp[1])/h;k.au=L.mc(q,k.au,h,.3);k.Z=q;k.au>=k.threshold?r(k,1):r(k,0);I.copy(p,k.bp);
k.Rf=n;break;case 140:!k.Ka&&0<=k.Lf&&n-k.Rf>=k.Lf&&(r(k,1),k.repeat?k.Rf=n:k.Lf=-k.Lf);break;case 150:k.Rf||(k.Rf=n);r(k,n-k.Rf);k.Rf=n;break;case 160:r(k,n);break;case 180:n=e(k.element);k.Z[0]=n.pv-n.qB;k.Z[1]=n.ov-n.pB;k.Z[2]=n.nv-n.mv;break;case 190:n=e(k.element);k.Z[0]=n.pv;k.Z[1]=n.ov;k.Z[2]=n.nv;break;case 200:n=e(k.element);G.copy(n.jJ,k.Z);break;case 210:h=c.ga(c.xd);c.Ti(h,c.At,k.Z);break;case 220:h=c.ga(c.xd);c.Ti(h,c.Bt,k.Z);break;case 240:h=l(k.$l);k.value=c.eV(h,k.key);break;case 250:h=
l(k.$l);k.value=c.dV(h,k.key);break;case 230:r(k,k.callback());break;case 30:n=e(k.element);r(k,n.Px);break;case 40:n=e(k.element);if(!d.Xn||1==n.De||2==n.De)switch(p=n.zm-n.dw,q=n.Am-n.ew,k.Z.coords[0]=n.zm,k.Z.coords[1]=n.Am,k.axis){case "X":r(k,p);break;case "Y":r(k,q);break;case "XY":h=Math.sqrt(p*p+q*q),r(k,h)}break;case 260:n=e(k.element);d.Xn||(p=n.hs,q=n.ks,w=L.mc(p,0,h,.1*ba),h=L.mc(q,0,h,.1*ba),.01<Math.abs(p)||.01<Math.abs(q)?(n.hs-=w,n.ks-=h,k.Z.coords[0]=w,k.Z.coords[1]=h):(k.Z.coords[0]=
0,k.Z.coords[1]=0),r(k,Math.sqrt(p*p+q*q)));break;case 50:n=e(k.element);r(k,0<n.De|0);k.Z.which=n.which;k.Z.coords[0]=n.zm;k.Z.coords[1]=n.Am;break;case 170:n=e(k.element);r(k,0);if(k.IH)n.oB==k.ji&&r(k,1);else if(n.De&&n.$h.ea==k.ji)r(k,1);else if(!n.Nv)for(h=0;10>h;++h)if(n.Xm[h].ea==k.ji){r(k,1);break}break;case 20:n=e(k.element);k.Z=n.We[k.key];1==k.Z||n.We[0]&&16==k.key?r(k,1):k.Z||r(k,0);break;case 60:n=e(k.element);if(-1==n.re[1]&&-1==n.Ie[1]){p=n.re[0]-n.rh[0];q=n.Ie[0]-n.sh[0];h=Math.sqrt(p*
p+q*q);if(-1!=n.rh[1]&&-1!=n.sh[1]){var w=n.re[0]-n.rh[1],z=n.Ie[0]-n.sh[1],v=Math.sqrt(w*w+z*z);v<h&&(p=w,q=z,h=v)}k.Z.gesture=a.Gt}else h=t,h[0]=(n.re[0]+n.re[1])/2,h[1]=(n.Ie[0]+n.Ie[1])/2,q=da,q[0]=(n.rh[0]+n.rh[1])/2,q[1]=(n.sh[0]+n.sh[1])/2,p=h[0]-q[0],q=h[1]-q[1],h=Math.sqrt(p*p+q*q),k.Z.gesture=a.Et;k.Z.coords[0]=n.re[0];k.Z.coords[1]=n.Ie[0];switch(k.axis){case "X":r(k,p);break;case "Y":r(k,q);break;case "XY":r(k,h)}break;case 70:n=e(k.element);h=n.sx-n.YD;k.Z=a.Ft;r(k,h);break;case 75:n=
e(k.element);-1!=n.re[1]&&(h=Math.atan2(n.Ie[0]-n.Ie[1],n.re[0]-n.re[1]),k.Z=a.cz,r(k,h-n.SM));break;case 80:n=e(k.element),k.Z.coords[0]=n.re[0],k.Z.coords[1]=n.Ie[0],n.Nv?r(k,0):r(k,1)}for(g=0;g<m.length;g++)for(n=m[g],k=n.Om,h=0;h<k.length;h++)if(p=k[h],p.Vk!=N){p.Vk=N;z=p;q=0;switch(z.type){case a.uf:q=(w=A(z))?1:0;break;case a.Qa:q=z.Xi;(w=A(z))?(q=1,z.Xi=1):1==q?(q=-1,z.Xi=-1):q=0;break;case a.mn:q=z.Xi;(w=A(z))&&-1==q?(q=1,z.Xi=1):w||1!=q?q=0:(q=-1,z.Xi=-1);break;case a.vf:q=z.Xi;(w=A(z))&&
-1==q?(q=1,z.Xi=1):w||1!=q?q=0:(q=0,z.Xi=-1);break;case a.sp:w=A(z);z.SJ!=w?(q=1,z.SJ=w):q=0;break;case a.by:w=z.Ek;z=z.hW;for(v=0;v<w.length;v++){var y=w[v].value;q||y==z[v]||(q=1);z[v]=y}break;default:L.q("Wrong sensor manifold type: "+z.type)}if(q&&(w=n==O?null:n,T=!1,p.callback(w,p.id,q,p.wR),T)){g=-1;break}}for(g=0;g<m.length;g++)for(n=m[g],k=n.Om,h=0;h<k.length;h++)for(p=k[h],n=p.Ek,p=0;p<n.length;p++)switch(q=n[p],q.type){case 30:r(q,0);break;case 40:r(q,0);break;case 60:r(q,0);break;case 70:r(q,
0);break;case 75:r(q,0);break;case 80:r(q,0);break;case 140:r(q,0)}for(g=0;g<P.length;g++){k=P[g];if(!k.Kr){for(h=0;h<k.We.length;h++)1==k.We[h]?k.We[h]=2:3==k.We[h]&&(k.We[h]=0);k.Kr=!0}1==k.De?k.De=2:3==k.De&&(k.De=0);k.Px=0;k.dw=k.zm;k.ew=k.Am;k.We[0]=0;k.rh.set(k.re);k.sh.set(k.Ie);k.YD=k.sx;k.qB=k.pv;k.pB=k.ov;k.mv=k.nv;k.GB=!1}N++};a.hA=function(a){var b=p(10);r(b,a);return b};a.Ic=function(a){var b=p(20,document);b.key=a;b.Ka=!0;return b};a.Kq=function(a,b){var d=p(240,document);b=b||c.vI();
d.$l=b;d.key=a;d.Ka=!0;return d};a.Ii=function(a,b){var d=p(250,document);b=void 0==b?c.vI():b;d.$l=b;d.key=a;d.Ka=!0;return d};a.gA=function(a,b,c){if(!a||!K.oa(a))return Q.error("Wrong collision object"),null;var d=p(90);d.Yz=a;d.bc=b;d.Hh=c;d.Z={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.Xz=function(a,b,c,f,e){r(d,a);a=d.Z;a.coll_obj=b;d.Hh&&(a.coll_pos.set(c),a.coll_norm.set(f),a.coll_dist=e)};d.Ka=!0;return d};a.YG=function(a){if(!a||
!a.C)return Q.error("Wrong collision impulse object"),null;var b=p(100);b.Wz=a;b.QG=function(a){r(b,a)};b.Ka=!0;return b};a.eH=function(a,b,c,d,f,e,g){var m=p(110);m.ji=a;m.from=b;m.to=c;m.bc=d;m.zJ=f;m.Hh=e;m.Av=g;m.Z={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),ps:0};m.XK=function(a,b,c,d,f,e){m.zJ?r(m,-1==b?0:1):r(m,b);m.Z.hit_fract=b;m.Z.obj_hit=c;m.Z.hit_time=d;m.Hh&&(m.Z.hit_pos.set(f),m.Z.hit_norm.set(e))};m.Ka=!0;return m};a.En=function(a){a=
p(50,a);a.Ka=!0;a.Z={coords:new Float32Array(2),which:null};return a};a.mA=function(a){a=p(30,a);a.Ka=!0;return a};a.Il=function(a,b){var c=p(40,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2)};c.Ka=!0;return c};a.Nq=function(a,b){var c=p(60,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2),gesture:0};c.Ka=!0;return c};a.uA=function(a){a=p(70,a);a.Z=0;a.Ka=!0;return a};a.nH=function(a){a=p(75,a);a.Z=0;a.Ka=!0;return a};a.yu=function(a){a=p(80,a);a.Z={coords:new Float32Array(2)};a.Ka=!0;return a};
a.dH=function(a,b,c){if(!a)return Q.error("Wrong collision object"),null;var d=p(120);d.ji=a;var f=R.G(a.k.n);a=R.P(a.k.n);d.RK=new Float32Array(4);d.bp=new Float32Array(f);d.Dw=new Float32Array(a);d.$t=0;d.Zt=0;d.threshold=b||.1;d.hL=c||.1;d.Rf=0;d.Z=new Float32Array([0,0]);return d};a.oH=function(a,b){if(!a)return Q.error("Wrong collision object"),null;var c=p(130);c.ji=a;var d=R.P(a.k.n);c.bp=new Float32Array(R.G(a.k.n));c.Dw=new Float32Array(d);c.au=0;c.threshold=b||1;c.Rf=0;c.Z=0;return c};a.mH=
function(a,b){var c=p(140);c.Lf=a;c.repeat=b;c.Ka=!0;return c};a.dL=function(a,b,c,d){a=a||O;a=a.oh;if(!a||!a[b])return Q.error("reset_timer_sensor(): wrong object"),null;b=a[b].Ek[c];if(!b)return Q.error("reset_timer_sensor(): sensor not found"),null;b.Rf=D.ur();b.Lf=d};a.Rj=function(){var a=p(150);a.Rf=0;return a};a.bH=function(){var a=p(180,window);a.Z=new Float32Array(3);c.ga(c.yh)?r(a,1):r(a,0);a.Ka=!0;return a};a.aH=function(){var a=p(190,window);a.Z=new Float32Array(3);c.ga(c.yh)?r(a,1):r(a,
0);a.Ka=!0;return a};a.jA=function(){var a=p(200,window);a.Z=G.create();c.ga(c.yh)?r(a,1):r(a,0);a.Ka=!0;return a};a.kA=function(){var a=p(210,window);a.Z=G.create();c.ga(c.xd)?r(a,1):r(a,0);a.Ka=!0;return a};a.cH=function(){var a=p(220,window);a.Z=I.create();c.ga(c.xd)?r(a,1):r(a,0);a.Ka=!0;return a};a.lH=function(){return p(160)};a.wu=function(a,b){var c=p(170);c.ji=a;c.IH=b;c.Ka=!0;return c};a.fA=function(a,b){var c=p(230);c.callback=a;r(c,b);return c};a.nA=function(a){a=p(260,a);a.Z={coords:new Float32Array(2)};
a.Ka=!0;return a};a.oA=function(a){a=p(270,a);a.Ka=!0;return a};a.cY=r;a.Zd=function(a,b,c){a=a||O;a=a.oh;if(!a||!a[b])return Q.error("get_sensor_value(): wrong object"),null;b=a[b].Ek[c];return b?b.value:(Q.error("get_sensor_value(): sensor not found"),null)};a.$e=function(a,b,c){a=a||O;a=a.oh;if(!a||!a[b])return Q.error("get_sensor_payload(): wrong object"),null;b=a[b].Ek[c];return b?b.Z:(Q.error("get_sensor_payload(): sensor not found"),null)};a.ua=function(){m=[];O={};for(var a=0;a<x.length;a++)w(x[a]);
x.length=0;g.length=0};a.uq=function(a,b){a=a||O;if(!a.oh)return!1;if(b&&a.oh[b])return!0;if(!b)for(var c in a.oh)return!0;return!1};a.Y=function(a,d,f,l,h,n,q){a=a||O;a.Om=a.Om||[];a.oh=a.oh||{};var p=a.oh,r=a.Om;p[d]&&k(a,d);f={id:d,type:f,Ek:l.slice(0),FW:h,dY:Array(l.length),callback:n,wR:q,Xi:-1,SJ:0,hW:Array(l.length),Vk:-1};p[d]=f;r.push(f);-1==m.indexOf(a)&&m.push(a);l=f.Ek;for(a=0;a<l.length;a++){p=d=l[a];if(p.Ka){switch(p.type){case 90:K.rz(p.Yz,p.bc,p.Xz,p.Hh);break;case 100:K.tz(p.Wz,
p.QG);break;case 110:p.ps=K.Vt(p.ji,p.from,p.to,p.bc,p.XK,!1,!1,p.Hh,p.Av);p.Z.ps=p.ps;break;case 140:p.Rf=D.ur();0>p.Lf&&(p.Lf=-p.Lf);break;case 20:r=e(p.element);b(r,"keyboard_downed_keys");break;case 30:r=e(p.element);b(r,"mouse_wheel");break;case 40:r=e(p.element);b(r,"mouse_down_which");b(r,"mouse_up_which");b(r,"mouse_location");break;case 260:r=e(p.element);b(r,"mouse_pointerlock");break;case 270:c.eQ(p);break;case 50:r=e(p.element);b(r,"mouse_down_which");b(r,"mouse_up_which");break;case 60:r=
e(p.element);b(r,"touch_start");b(r,"touch_move");b(r,"touch_end");break;case 70:r=e(p.element);b(r,"touch_start");b(r,"touch_move");break;case 75:r=e(p.element);b(r,"touch_start");b(r,"touch_move");break;case 80:r=e(p.element);b(r,"touch_start");b(r,"touch_end");break;case 170:r=e(p.element);b(r,"mouse_select");b(r,"touch_select");b(r,"touch_start");b(r,"touch_end");b(r,"mouse_down_which");b(r,"mouse_up_which");break;case 180:case 190:r=e(p.element);b(r,"orientation_angles");break;case 200:r=e(p.element);
b(r,"orientation_quat");break;case 240:0==p.$l?c.ga(c.nt):1==p.$l?c.ga(c.ey):2==p.$l?c.ga(c.fy):c.ga(c.gy)}p.Ka=!1}p=x.indexOf(d);-1==p?(x.push(d),g.push([f])):g[p].push(f)}T=!0};a.Eu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.Fu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.hf=k;a.reset=function(){for(var a=0;a<m.length;a++){var b=m[a],c=b.oh,b=b.Om,d;for(d in c)delete c[d];b.length=0}for(a=0;a<x.length;a++)w(x[a]);m.length=
0;x.length=0;g.length=0};a.debug=function(){Q.log(String(m.length)+" objects with manifolds",m);Q.log(String(x.length)+" sensors",x);for(var a=[],b=[],c=0;c<x.length;c++){var d=x[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}Q.log(String(a.length)+" collision sensors",a);Q.log(String(b.length)+" ray sensors",b)};a.jD=function(a){ba=a}};b4w.module.__loader=function(a,h){function p(b,c,k,l){var d=D,m=Q.create(),h;for(h in c){var n=e(c[h]);(l&&n.Wb||!b&&n.kc)&&f(n);Q.J(m,n)}for(h in c)for(n=c[h],n.name=h,b=0;b<n.L.length;b++)Q.r(m,c[n.L[b]],n,null);c=e({name:"out",Nb:a.RN,ac:function(a,b,c,f,e){b.Mb&&(d.AD=!0);B(b)||(b.status=2);b.XJ(b.id,!0);e(b,c);K.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Yb:5});if(k)k=Q.sr(m);else{h=Q.clone(m);do{k=Q.sr(h);n=[];for(b=0;b<k.length;b++){l=k[b];var g=Q.Wa(h,l);g.Qb&&n.push(l)}for(b=
0;b<n.length;b++)Q.ug(h,n[b]);n.length&&Q.Sz(h)}while(n.length)}Q.J(m,c);for(b=0;b<k.length;b++)l=k[b],g=Q.Wa(m,l),c.L.push(g.name),Q.r(m,g,c,null);return m}function e(a){a.Qb=a.Qb||!1;a.Nb||0===a.Nb||(a.Nb=a.ue);a.L=a.L||[];a.pm=a.pm||!1;a.wD=a.wD||!1;a.Yb=a.Yb||0;a.Wb=a.Wb||!1;a.kc=a.kc||!1;a.status=0;a.X6=0;a.RB=0;a.qq=a.qq||null;return a}function b(a,b){for(var c=[],f=[],d=0;d<b.length;d++){var e=b[d];Q.Wa(a.ki,e).pm&&(Q.Sk(a.ki,e,function(d){var f=!0;Q.ni(a.ki,d,function(a,b){if(!b.pm)return f=
!1,1});f&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),f.push(d))}for(d=f.length-1;0<=d;d--)b.splice(f[d],1);return c}function y(a){function c(b,d){var f=Q.Wa(a.ki,b),e=Q.Wa(a.ki,d),m=e.Nb-f.Nb;0==m&&(m=f.Qb-e.Qb);return m}var f=[],e=a.pj,d=!1;do{var m=b(a,e);f.push.apply(f,e);0<m.length&&(d=!0);e=m}while(0<m.length);d&&f.sort(c);a.pj=f;return a.pj.length}function r(a,b,c){if(b.wD)return b.pm=!0,k(a,b),!1;if(!b.ac&&!b.Lj&&!b.pq)return k(a,b),!1;if(0==b.status&&(b.status++,b.ac))return b.ac(c,a,
b,b.qq,k,w),!0;if(1==b.status){if(b.Lj)return b.Lj(c,a,b,b.qq,k,w),!0;b.status++}return 2==b.status&&(b.status++,b.pq)?(b.pq(c,a,b,b.qq,k,w),!0):!1}function A(a){if(0==a.lx)return 100;var b=0;Q.pa(a.ki,function(c,f){a.do_not_load_resources&&f.Wb||(b+=f.RB*f.Yb)});return G.trunc(100*b/a.lx)}function k(a,b){b.pm=!0;b.status=3;n(a,b,1)}function w(a,b,c){1>c?n(a,b,c):b.status++}function n(a,b,c){var f=D;if(b.ac||b.Lj||b.pq)if(b.RB=c,b=A(a),a.sH!=b||1==c)a.zD(b,performance.now()-a.PM),a.sH=b,f.TB=!0}function l(a,
b){var c=null;Q.pa(a.ki,function(a,d){if(d.name==b)return c=d,1});return c}function f(a){a.wD=!0;a.RB=1}function v(a){a.zD=null;a.Zz=null;a.ki=null;a.pj=null}function c(){return 0==D.St}function B(a){return a&&(3==a.status||4==a.status)}var Q=h("__graph"),K=h("__print"),G=h("__util");a.ue=0;a.zg=1;a.RN=2;var D=null;a.kB=function(){return D};a.fH=function(){var a={qh:[],yA:0,St:0,AD:!1,TB:!1};return D=a};a.kH=function(a,b,c,f,d,e,k,l,g){var h=D,n=h.qh.length,r={id:n,Mb:0==n,status:0,Tg:b,fG:"",XJ:c||
function(){},WJ:l||!1,U9:e,PM:0,sH:0,lx:0,TC:!1,zD:f||function(){},Zz:d||function(){},ki:null,pj:null,tB:!1,rB:!1,wB:!1,gk:g};a=p(r.Mb,a,e,k);r.ki=a;b=[];c=Q.nV(a);for(f=0;f<c.length;f++)b.push(c[f]);r.pj=b;Q.pa(a,function(a,b){!(b.ac||b.Lj||b.pq)||r.do_not_load_resources&&b.Wb||(r.lx+=b.Yb)});h.qh.push(r);h.St++;return r.id};a.u_=function(b){var f=D;if(f&&!c())if(f.TB)f.TB=!1;else{var e=performance.now();do{var k=f.qh[f.yA],d=b[k.id];if(!B(k))if(0==k.status&&(k.status=1,k.PM=performance.now(),k.zD(0,
0)),y(k)){var m=k,l=m.pj.length;do{var h=Q.Wa(m.ki,m.pj[0]),g=r(m,h,d);h.Nb==a.zg&&(m.TC=!0);h=m.pj.shift();m.pj.push(h);l--}while(!g&&0!=l)}else m=f,l=k,l.Zz(d,l),l.status=3,m.St--,v(l);f.AD&&(f.yA=(f.yA+1)%f.qh.length);if(k.TC){k.TC=!1;break}}while(16>performance.now()-e)}};a.yF=function(a){var b=D;a.Zz(null,a);a.status=3;b.St--;v(a);a.status=4;a.Mb&&(b.AD=!0);a.XJ(a.id,!1)};a.f9=w;a.dx=function(a,b){var c=l(a,b);null!==c&&f(c)};a.pm=c;a.FZ=B;a.$g=function(a){var b=D;if(!b)return!1;a|=0;return b.qh[a]&&
(3==b.qh[a].status||2==b.qh[a].status)};a.vV=function(){K.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ua=function(){D=null}};b4w.module.__md5=function(a){function h(a,k){var h=a[0],n=a[1],l=a[2],f=a[3],h=e(h,n,l,f,k[0],7,-680876936),f=e(f,h,n,l,k[1],12,-389564586),l=e(l,f,h,n,k[2],17,606105819),n=e(n,l,f,h,k[3],22,-1044525330),h=e(h,n,l,f,k[4],7,-176418897),f=e(f,h,n,l,k[5],12,1200080426),l=e(l,f,h,n,k[6],17,-1473231341),n=e(n,l,f,h,k[7],22,-45705983),h=e(h,n,l,f,k[8],7,1770035416),f=e(f,h,n,l,k[9],12,-1958414417),l=e(l,f,h,n,k[10],17,-42063),n=e(n,l,f,h,k[11],22,-1990404162),h=e(h,n,l,f,k[12],7,1804603682),f=e(f,h,n,l,
k[13],12,-40341101),l=e(l,f,h,n,k[14],17,-1502002290),n=e(n,l,f,h,k[15],22,1236535329),h=b(h,n,l,f,k[1],5,-165796510),f=b(f,h,n,l,k[6],9,-1069501632),l=b(l,f,h,n,k[11],14,643717713),n=b(n,l,f,h,k[0],20,-373897302),h=b(h,n,l,f,k[5],5,-701558691),f=b(f,h,n,l,k[10],9,38016083),l=b(l,f,h,n,k[15],14,-660478335),n=b(n,l,f,h,k[4],20,-405537848),h=b(h,n,l,f,k[9],5,568446438),f=b(f,h,n,l,k[14],9,-1019803690),l=b(l,f,h,n,k[3],14,-187363961),n=b(n,l,f,h,k[8],20,1163531501),h=b(h,n,l,f,k[13],5,-1444681467),f=
b(f,h,n,l,k[2],9,-51403784),l=b(l,f,h,n,k[7],14,1735328473),n=b(n,l,f,h,k[12],20,-1926607734),h=p(n^l^f,h,n,k[5],4,-378558),f=p(h^n^l,f,h,k[8],11,-2022574463),l=p(f^h^n,l,f,k[11],16,1839030562),n=p(l^f^h,n,l,k[14],23,-35309556),h=p(n^l^f,h,n,k[1],4,-1530992060),f=p(h^n^l,f,h,k[4],11,1272893353),l=p(f^h^n,l,f,k[7],16,-155497632),n=p(l^f^h,n,l,k[10],23,-1094730640),h=p(n^l^f,h,n,k[13],4,681279174),f=p(h^n^l,f,h,k[0],11,-358537222),l=p(f^h^n,l,f,k[3],16,-722521979),n=p(l^f^h,n,l,k[6],23,76029189),h=
p(n^l^f,h,n,k[9],4,-640364487),f=p(h^n^l,f,h,k[12],11,-421815835),l=p(f^h^n,l,f,k[15],16,530742520),n=p(l^f^h,n,l,k[2],23,-995338651),h=y(h,n,l,f,k[0],6,-198630844),f=y(f,h,n,l,k[7],10,1126891415),l=y(l,f,h,n,k[14],15,-1416354905),n=y(n,l,f,h,k[5],21,-57434055),h=y(h,n,l,f,k[12],6,1700485571),f=y(f,h,n,l,k[3],10,-1894986606),l=y(l,f,h,n,k[10],15,-1051523),n=y(n,l,f,h,k[1],21,-2054922799),h=y(h,n,l,f,k[8],6,1873313359),f=y(f,h,n,l,k[15],10,-30611744),l=y(l,f,h,n,k[6],15,-1560198380),n=y(n,l,f,h,k[13],
21,1309151649),h=y(h,n,l,f,k[4],6,-145523070),f=y(f,h,n,l,k[11],10,-1120210379),l=y(l,f,h,n,k[2],15,718787259),n=y(n,l,f,h,k[9],21,-343485551);a[0]=h+a[0]&4294967295;a[1]=n+a[1]&4294967295;a[2]=l+a[2]&4294967295;a[3]=f+a[3]&4294967295}function p(a,b,e,h,l,f){b=(b+a&4294967295)+(h+f&4294967295)&4294967295;return(b<<l|b>>>32-l)+e&4294967295}function e(a,b,e,h,l,f,r){return p(b&e|~b&h,a,b,l,f,r)}function b(a,b,e,h,l,f,r){return p(b&h|e&~h,a,b,l,f,r)}function y(a,b,e,h,l,f,r){return p(e^(b|~h),a,b,l,
f,r)}var r="0123456789abcdef".split("");a.oJ=function(a){var b=a,e=b.length;a=[1732584193,-271733879,-1732584194,271733878];var n;for(n=64;n<=b.length;n+=64){for(var l=b.substring(n-64,n),f=[],p=void 0,p=0;64>p;p+=4)f[p>>2]=l.charCodeAt(p)+(l.charCodeAt(p+1)<<8)+(l.charCodeAt(p+2)<<16)+(l.charCodeAt(p+3)<<24);h(a,f)}b=b.substring(n-64);l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<b.length;n++)l[n>>2]|=b.charCodeAt(n)<<(n%4<<3);l[n>>2]|=128<<(n%4<<3);if(55<n)for(h(a,l),n=0;16>n;n++)l[n]=0;l[14]=8*
e;h(a,l);for(b=0;b<a.length;b++){e=a[b];n="";for(l=0;4>l;l++)n+=r[e>>8*l+4&15]+r[e>>8*l&15];a[b]=n}return a.join("")}};b4w.module.__nla=function(a,h){function p(){return{type:"CLIP",va:0,ab:0,kj:!1,paused:!1,Wf:"",Wp:"",Ac:0,po:null,Dj:0,ol:0,KH:0,JH:0,oN:!1,scale:1,repeat:1,AF:0}}function e(a,b,c){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var k=0;k<f.length;k++)f[k].po=c,b.push(f[k])}a=a.nodes;for(k=0;k<a.length;k++)if(f=a[k],f.node_group){var l=f.node_group.node_tree;if(l){var g=c.slice();g.push(f.name);e(l,b,g)}}}function b(a,b){var c=Math.round(a)-b.va;b.vj&&(c%=b.Yj,0>c&&(c+=b.Yj));return b.Tb+
c}function y(a,b){var c=(b-L)*G.rd()+a.Tb;c>a.va?(c-=a.va,a.ze&&(c%=a.ab-a.va+1),c+=a.va):c=a.va;return c}function r(a,b){a=D.U(a,b.va,b.ab);var c=a==b.ab?b.AF:b.Dj+(a-b.va)/b.scale%(b.ol-b.Dj);b.oN&&(c=b.ol-c+b.Dj);return c}function A(a,b){for(var c=[],f=0;f<a.length;f++){var e=a[f],k=e.strips;if(k)for(var g=0;g<k.length;g++){var l=k[g],h=p();h.type=l.type;h.va=l.frame_start;h.ab=l.frame_end;h.Ac=b;h.Dj=l.action_frame_start;h.ol=l.action_frame_end;h.oN=l.use_reverse;h.scale=l.scale;h.repeat=l.repeat;
l.action&&(h.Wf=l.action.name,h.Wp=l.action.uuid,h.po=e.po);c.push(h)}}return c}function k(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function w(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],f=c.node_tree;if(c=c.use_nodes&&f)a:{if(f.animation_data&&(c=f.animation_data.nla_tracks)&&c.length){c=!0;break a}f=f.nodes;for(c=0;c<f.length;c++);c=!1}if(c)return!0}return!1}
function n(a,b){var c=B.A();if(c.ra){var f=y(c.ra,b);c.ra.Tb-=f-a;c.ra.Sn=!0}}var l=h("__animation");h("__config");var f=h("__objects"),v=h("__obj_util"),c=h("__print"),B=h("__scenes"),Q=h("__sfx"),K=h("__textures"),G=h("__time"),D=h("__util"),R=[],L=-1;a.Wk=function(a,b){var c,f=null;for(c=b.I.length-1;0<=c;c--){var h=b.I[c];if(h.yb.b4w_use_nla&&(f=h,h.yb.wF))break}if(c=f){c.tK=!0;var n=0;if((f=a.animation_data)&&f.nla_tracks.length){var g=f.nla_tracks;if(v.om(b)||v.xa(b)||v.$d(b)||v.bo(b)||v.Zg(b)||
v.Jr(b)||v.HB(b))g=A(g,n),g.length&&(b.ng=b.ng.concat(g),n++)}k(a)&&(g=a.data.animation_data.nla_tracks,g=A(g,n),g.length&&(b.ng=b.ng.concat(g),n++));if(v.$d(b))for(h=a.data.materials,f=0;f<h.length;f++){var r=h[f];if(r.use_nodes&&r.node_tree&&(g=[],e(r.node_tree,g,[r.name]),g=A(g,n),g.length)){for(var r=n,t=g,w=l.LU(),B=[],y=0,K=0;K<t.length;K++){var N=t[K];""!=N.Wp?N=D.Dd("uuid",N.Wp,w):(N=N.Wf,N=D.Dd("name",N,w)||D.Dd("name",N+"_B4W_BAKED",w));if(N){var N=N.fcurves,L=[],u;for(u in N)L.push(u);
B.push(L)}}for(K=0;K<B.length;K++){w=!1;for(N=0;N<K;N++)if(D.LQ(B[K],B[N])){t[K].Ac=t[N].Ac;w=!0;break}w||(t[K].Ac=n+y++)}n=r+y;b.ng=b.ng.concat(g)}}if(!v.HB(b)){for(f=0;f<a.particle_systems.length;f++)h=a.particle_systems[f],u=h.settings,"EMITTER"==u.type&&u.b4w_allow_nla&&(u=p(),u.type="CLIP",u.va=c.yb.frame_start,u.ab=c.yb.frame_end+1,u.Wf=h.name,u.Ac=n,u.Dj=u.va,u.ol=u.ab,b.ng.push(u),n++);c=n+1;for(f=0;f<b.Zc.length;f++)h=b.Zc[f],h.gQ&&(n=c,u=p(),u.type="CLIP",u.va=h.va,u.ab=h.ab,u.Wf=h.name,
u.Ac=n,u.Dj=u.va,u.ol=u.ab,b.ng.push(u))}}};a.t_=function(a,b,d){a.ra||(a.ra={va:a.frame_start,ab:a.frame_end,Tb:0,Or:-1,ns:a.frame_end,os:a.frame_start,ip:null,ze:b,fb:[],ya:[],lL:a.name,ik:!1,Sn:!1,VC:!0},R.push(a.ra));b=a.ra;for(var e=f.RI(a,"ALL",d),k=0;k<e.length;k++){var l=e[k];if(l.ng.length){b.fb[d]||(b.fb[d]=[]);for(var g=0;g<l.I.length;g++){var h=l.I[g];h.yb==a&&h.tK&&b.fb[d].push(l)}for(var g=l.ng,h=b,n=l.name,r=0;r<g.length;r++){var w=g[r];h.va>w.ab||h.ab<w.va?(c.warn("NLA: Strip is out of scene range: "+
(n+" ["+w.va+":"+w.ab+"]")),g.splice(r,1),r--):w.Wf||"CLIP"!=w.type||(c.warn('NLA: no action in strip for object "'+n+'".'),g.splice(r,1),r--)}l=l.ng;g=b;for(h=0;h<l.length;h++){for(var n=l[h],r=g.va,w=g.ab+1,v=0;v<l.length;v++){var B=l[v];n.Ac==B.Ac&&(B.ab<=n.va&&(r=n.va),B.va>=n.ab&&(w=Math.min(w,B.va)))}n.KH=r;n.JH=w;n.AF=0===n.repeat%1?n.ol:n.Dj+n.repeat%1*(n.ol-n.Dj)}}}a=a.s.mp;for(k=0;k<a.length;k++)e=a[k].s,e.Xk&&(e.Ta||e.td)&&e.ft==d&&(l=p(),l.type="VIDEO",e.vj?(l.va=0,l.ab=b.ab):(l.va=D.U(e.va,
0,b.ab),l.ab=D.U(e.va+e.Yj,0,b.ab)),l.Wf=a[k].name,b.ya.push(e))};a.start=function(){L=0};a.pV=function(){return L};a.Q4=function(a){return a.ra?a.ra.Tb:null};a.k8=function(a,b){return a.ra?(a.ra.Tb=b,!0):!1};a.update=function(a,c){if(!(0>L)){0==L&&(L=a);for(var d=0;d<R.length;d++){var f=R[d];f.ik&&(f.Tb-=G.rd()*c);var e=y(f,a);if((!f.ik||f.Sn)&&e>=f.ns)if(f.ze){var e=f,k=a;e.ip&&e.ip();n(e.os,k);e.VC=!0;e=y(e,k)}else{var k=f,g=e;k.ik=!0;k.Tb-=g-k.ns;k.ip&&k.ip()}if(!f.ik||f.Sn){for(var k=f,g=e,h=
0;h<k.fb.length;h++){var p=k.fb[h];if(p)for(var w=0;w<p.length;w++){for(var v=p[w],B=v.ng,A=0;A<B.length;A++){var N=B[A];"SOUND"==N.type&&g<k.Or-1E-6&&(N.kj=!1)}for(A=0;A<B.length;A++)switch(N=B[A],N.type){case "CLIP":if(N.KH<=g&&g<N.JH&&!N.kj){var h=v,ba=N,u=ba.po;""!=ba.Wp?l.FQ(h,u,ba.Wp,ba.Ac):l.apply(h,u,ba.Wf,ba.Ac);l.Bs(h,l.Rx,ba.Ac);u=r(ba.va,ba);l.Fo(h,u,ba.Ac);for(h=0;h<B.length;h++)B[h]!=N&&B[h].Ac==N.Ac&&(B[h].kj=!1);N.kj=!0}N.kj&&(ba=v,u=r(g,N),1E-6<Math.abs(u-l.qI(ba,N.Ac))&&l.Fo(ba,
u,N.Ac));break;case "SOUND":if((g<k.Or-1E-6||k.Or<N.va)&&N.va<=g&&g<N.ab&&!N.kj){var ba=v,ga=N,u=(ga.va-g)/G.rd(),ga=(ga.ab-ga.va)/G.rd();Q.play(ba,u,ga);N.kj=!0}k.Or<N.ab&&N.ab<=g&&N.kj&&(N.kj=!1)}}}k=a;g=f;p=e;for(w=0;w<g.ya.length;w++)if(v=g.ya[w],v.Ta||v.td){B=K.AN(v);A=v;N=D.U(b(p,A),A.Tb,A.Tb+K.BN(A)-1);A.td&&(N=K.P_(A,N),N==A.ys&&N--);A=N;N=K.CN(v);ba=h=!1;if(g.Sn||g.VC)ba=!0;g.ik||(u=b(p,v),u=v.Tb<=u&&u<=v.Tb+K.BN(v),ga=K.DN(v),v.vj&&A==N&&(ba=!0),ga||B==A||(ba=!0),u&&!ga?K.HK(v):u&&ga?h=
!0:!u&&ga&&(v.Ta&&B<A?h=!0:K.xC(v)));ba?(K.pY(v,A),v.td&&(v.Fk=K.Ow(v,k))):h&&K.EN(v)&&(v.Ta?K.hN(v):(B=K.Ow(v,k),B!=v.Fk&&(v.lj=A,K.gN(v)),v.Fk=B))}f.Or=e}f.Sn=!1;f.VC=!1}}};a.ua=function(a){if(0==a)R.length=0,L=-1;else for(var b=0;b<R.length;b++)R[b].fb[a]=null};a.mG=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||k(a)||w(a)?!0:!1};a.Fo=n;a.rr=function(a){var b=B.A();return b.ra?y(b.ra,a):-1};a.tM=function(){var a=B.A();if(a.ra){a.ra.ik=!0;for(var a=a.ra.ya,b=0;b<a.length;b++)K.xC(a[b])}};
a.rX=function(){var a=B.A();a.ra&&(a.ra.ik=!1,a.ra.ip=null)};a.S4=function(){var a=B.A();return a.ra?a.ra.va:-1};a.xI=function(){var a=B.A();return a.ra?a.ra.ab:-1};a.fk=function(){var a=B.A();return a.ra?!a.ra.ik:!1};a.Q2=function(){var a=B.A();return a.ra?a.b4w_use_nla:!1};a.P2=function(){var a=B.A();return a.ra?0<a.b4w_logic_nodes.length:!1};a.D8=function(a,b){var c=B.A();if(c.ra)c.ra.os=a,c.ra.ns=b;else return!1};a.kD=function(a){var b=B.A();b.ra&&(b.ra.ns=a)};a.DY=function(a){var b=B.A();b.ra&&
(b.ra.os=a)};a.L7=function(){var a=B.A();if(a.ra)a=a.ra,a.os=a.va,a.ns=a.ab;else return!1};a.d8=function(a){var b=B.A();if(b.ra)b.ra.ze=a;else return!1};a.Y2=function(){var a=B.A();a.ra&&(a.ra.ip=null)};a.GL=function(a){var b=B.A().ra;b&&(b.Tb=-(a-L)*G.rd()+b.os,b.Sn=!0)};a.xI=function(){var a=B.A().ra;return a?a.ab:null}};b4w.module.__logic_nodes=function(a,h){function p(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];if(-2==c.state){for(var e=0;e<c.Nw;e++)if(L.Zd(a,b,e))for(var g=0;g<c.Mw.length;g++)if(c.Mw[g]==e){f.Bm==c.LM?(Q.fk(f.ra)&&(c.state=-1),d.Qf.Hf||(c.state=1,c.Gs=c.Tv[g])):(c.state=1,c.Gs=c.Tv[g]);return}c.state=0}}}function e(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];for(var e=0;e<c.Nw;e++)if(L.Zd(a,b,e)&&e==c.nL){if(Q.fk(f.ra)&&f.Bm==c.LM)c.state=-1;else if(!d.Qf.Hf||c.T.no_wait)c.state=
1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Oa:a.slot_idx_order,Gs:a.slot_idx_jump,va:a.frame_range[0],ab:a.frame_range[1],sU:a.frame_range_mask?a.frame_range_mask[0]:!0,rU:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,Nw:-1,nL:-1,fX:a.param_name,dX:a.operation,qc:a.mute,$q:a.object,ea:null,jc:null,vc:null,fb:{},Wf:a.anim_name,Ac:v.kl,hX:a.parse_json_vars,gX:a.parse_json_paths,Kc:a.objects_paths,pK:a.nodes_paths,Hb:a.floats,T:a.bools,V:a.variables,qj:a.strings,
UB:a.materials_names,YL:a.shader_nd_type,xe:a.common_usage_names,RT:a.encode_json_vars,QT:a.encode_json_paths,LM:b,NK:E[a.type]?E[a.type]:k,Bw:!1,rx:0,Mw:null,uW:a.links,Tv:[]}}function y(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function r(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function A(a,b,c){switch(b.state){case 2:c.ma=a.Oa}}function k(a,b,c){switch(b.state){case 1:G.error("Unknown node type: "+a.type);break;case 2:c.ma=a.Oa}}function w(a){return K.xc(K.Oc,a.$q||[],0)}function n(a,c){var d=a.b4w_logic_nodes,
f=c.me;c.state=1;for(var e=0;e<d.length;e++){var g={M:[],Qf:{yb:a,ma:0,Hf:!1,PD:e,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};f.push(g);for(var m=f[f.length-1],k=d[e],l=0;l<k.length;l++){var h=b(k[l],m);m.M.push(h)}for(k=0;k<m.M.length;k++)h=m.M[k],h.qc||h.NK(h,c,g.Qf,0,0)}var d=a.timeline_markers,n;for(n in d)c.Hs.push(d[n]);c.Hs.sort(function(a,b){return a-b});c.state=2;ca.push(c)}function l(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function f(a){switch(typeof a){case "string":return l(a,1);case "number":return l(a,0);default:return l(a,1)}}var v=h("__animation"),c=h("__assets"),B=h("__camera"),Q=h("__nla"),K=h("__objects"),G=h("__print"),D=h("__scenes"),R=h("__config"),L=h("__controls"),I=h("__batch"),z=h("__geometry"),d=h("__mat3"),m=h("__mat4"),O=h("__physics"),x=h("__quat"),g=h("__sfx"),P=h("__time"),t=h("__transform"),da=h("__tsr"),J=h("__util"),F=h("__vec3"),T=new Float32Array(4);new Float32Array(4);var N=new Float32Array(3),
ba=new Float32Array(3),u=new Float32Array(2),ga=new Float32Array(9),Z=new Float32Array(16);a.SO=0;a.TO=1;a.MO=0;a.LO=1;a.NO=2;a.OO=3;a.KO=4;a.NE=0;a.PE=1;a.OE=2;a.QE=3;a.RE=4;a.ME=5;a.RO=0;a.QO=1;a.PO=2;a.DO=0;a.EO=1;a.BO=2;a.CO=3;a.FO=0;a.GO=1;var E={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.ma=a.Oa}},HIDE:function(a,b,c){switch(b.state){case 1:a.ea=w(a);a.ea||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:D.sq(a.ea,!0),c.ma=a.Oa}},SHOW:function(a,
b,c){switch(b.state){case 1:a.ea=w(a);a.ea||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:D.sq(a.ea,!1),c.ma=a.Oa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.V.vd;b=b.u;var f=c.u,e;a:{e=a.fX;var g=a.Hb.ptp,m=a.T.hsh,k=R.get("url_params");if(k&&e in k)e=Number(k[e]);else{if(m=m?location.hash:location.search)for(m=m.slice(1).split("&"),k=0;k<m.length;k++){var h=m[k].split("=");if(1<h.length&&h[0]==e){e=l(h[1],g);break a}}e=0}}r(d,b,f,e);c.ma=a.Oa}},
SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.me[c.PD];var d=K.SI();a.Mw=[];a.Tv=[];for(var f in a.Kc){var e=K.xc(K.Oc,a.Kc[f],0),g=d.indexOf(e);if(-1==g){G.error("logic script error: non-selectable object:",a.Kc[f][a.Kc[f].length-1]);break a}a.Mw.push(g);a.Tv.push(a.uW[f])}a.state=-1;a.Nw=d.length;f=[];for(g=0;g<d.length;g++)f.push(L.wu(d[g],!1));L.Y(e,"LOGIC_NODES_SWITCH_SELECT_"+a.label,L.vf,f,L.Fu,p(),[a,b,c])}break;case 2:if(-1==a.state){b=b.me[c.PD].M;for(e=0;e<b.length;e++)d=
b[e],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.ma=a.state?a.Gs:a.Oa,a.state=-1}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.me[c.PD];var d=w(a),f=K.SI(),g=f.indexOf(d);if(-1==g)G.error("logic script error: non-selectable object:",a.$q[a.$q.length-1]);else{a.state=-1;a.Nw=f.length;a.nL=g;for(var g=[],m=0;m<f.length;m++)g.push(L.wu(f[m],!1));L.Y(d,"LOGIC_NODES_SELECT_"+a.label,L.vf,g,L.Fu,e(),[a,b,c])}break;case 2:if(0==a.state||1==a.state){c.ma=a.state?a.Gs:
a.Oa;a.state=-1;break}a.T.not_wait&&(c.ma=a.Oa)}},PLAY:function(a,b,c,d){switch(b.state){case 1:Q.tM();a.state=-1;a.T.not_wait||(a.T.not_wait=!1);break;case 2:switch(a.state){case -1:if(Q.fk(b.ra))if(b.xA==b.Bm&&c.Hf)break;else{var f=b.Bm;if(f){f.Qf.ma=f.M[f.Qf.ma].Oa;f.M[f.Qf.ma].state=-1;for(var f=b.Bm.M,e=0;e<f.length;e++){var g=f[e];"PLAY"==g.type&&(g.state=-1)}}}c.Hf=!a.T.not_wait;b.Bm=b.xA;a.state=0;a.sU&&(Q.DY(a.va),Q.GL(d));if(a.rU)Q.kD(a.ab);else{d=Q.rr(d);var f=-1,m;for(m in b.Hs)if(d<b.Hs[m]){f=
m;break}0<=f?Q.kD(b.Hs[f]):Q.kD(Q.xI())}Q.rX();a.T.not_wait&&(c.ma=a.Oa,a.state=-1,c.Hf=!1);break;case 0:Q.fk()||(c.ma=a.Oa,a.state=-1,c.Hf=!1);break;case 1:c.ma=a.Oa;a.state=-1;b.Bm=null;c.Hf=!1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.T.url?l(y(a.V.url,b.u,c.u),1):a.qj.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.V.v1[1]?a.Hb.inp1:l(y(a.V.v1,b.u,c.u),0),f=-1==a.V.v2[1]?a.Hb.inp2:
l(y(a.V.v2,b.u,c.u),0),e=0;switch(a.dX){case "ADD":e=d+f;break;case "MUL":e=d*f;break;case "SUB":e=d-f;break;case "DIV":0==f&&J.q("Division by zero in Logic script");e=d/f;break;case "RAND":e=Math.random()*(f-d)+d}r(a.V.vd,b.u,c.u,e);c.ma=a.Oa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.T.str?1:0,f=a.T.str?a.qj:a.Hb,e=-1==a.V.v1[1]?f.inp1:l(y(a.V.v1,b.u,c.u),d);b=-1==a.V.v2[1]?f.inp2:l(y(a.V.v2,b.u,c.u),d);d=!1;switch(a.xe.condition){case 5:e==b&&(d=!0);break;case 4:e!=b&&(d=!0);break;
case 3:e<b&&(d=!0);break;case 2:e>b&&(d=!0);break;case 1:e<=b&&(d=!0);break;case 0:e>=b&&(d=!0)}c.ma=d?a.Gs:a.Oa}},REGSTORE:function(a,b,c){switch(b.state){case 2:r([a.T.gl||a.V.vd[0],a.V.vd[1]],b.u,c.u,(1==a.xe.variable_type?a.qj:a.Hb).inp1),c.ma=a.Oa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.ea=a.T.env?K.iv(a.$q[0],0):w(a);a.ea||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:switch(0!=a.state||v.fk(a.ea,a.Ac)||(a.state=1),a.state){case -1:for(var d in b.me){var f=
b.me[d].Qf.ma;-1!=f&&(f=b.me[d].M[f],"PLAY_ANIM"==f.type&&f!=a&&0==f.state&&f.ea==a.ea&&(f.state=1))}b=a.xe.param_anim_behavior;if(""==a.Wf)v.Wt(a.ea),v.Bs(a.ea,b,v.kl);else{a:{d=a.ea;for(var f=a.Wf,e=-1,g=0;8>g;g++){var m=d.ja[g];if(m&&m.Bi&&v.wM(m.Bi)==v.wM(f))if(-1!=e)e=g;else{d=-1;break a}}d=e}-1==d?(a.Ac=v.YY(a.ea,a.Wf),v.apply(a.ea,null,a.Wf,a.Ac)):a.Ac=d;v.Bs(a.ea,b,a.Ac)}a.T.not_wait||(c.Hf=!0);v.play(a.ea,null,a.Ac);a.state=0;a.T.not_wait&&(c.ma=a.Oa,a.state=-1);break;case 0:break;case 1:a.T.not_wait||
(c.Hf=!1);c.ma=a.Oa;a.state=-1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:A,SEND_REQ:function(a,b,d){function f(a,c,e,g,m){a=JSON.stringify(a);r(m[0].V.dst,b.u,d.u,a);m[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.T.url?l(y(a.V.url,b.u,d.u),1):a.qj.url,g={};a.T.ct&&(g["Content-Type"]=a.qj.ct);"GET"==a.xe.request_type?c.Ud([{id:e,type:c.ln,url:e,vk:g,Jb:[a,d.u]}],f,null,null,null):"POST"==a.xe.request_type&&c.Ud([{id:e,type:c.ln,url:e,vk:g,
fi:"POST",yo:c.ln,Jm:l(y(a.V.dst1,b.u,d.u),1),Jb:[a,d.u]}],f,null,null,null);break;case 1:a.state=-1,d.ma=a.Oa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.fb["id"+b]=K.xc(K.Oc,a.Kc["id"+b],0),a.fb["id"+b]||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:I.GV(a.fb.id0,a.UB.id0,a.fb.id1,a.UB.id1),c.ma=a.Oa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Kc.id0&&(a.fb.id0=K.xc(K.Oc,a.Kc.id0,0),a.Kc.id0||(G.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0),a.pK.id0.unshift(a.UB.id0));break;case 2:var d=a.fb.id0,f=a.pK.id0,e=f[0],g=I.iU(d,e,"MAIN");c.ma=a.Oa;if(null===g){G.error('Material "'+e+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.YL){var m=I.FI(g.cj,f);I.zY(d,e,m,a.T.id0?l(y(a.V.id0,b.u,c.u),0):a.Hb.id0,a.T.id1?l(y(a.V.id1,b.u,c.u),0):a.Hb.id1,a.T.id2?l(y(a.V.id2,b.u,c.u),0):a.Hb.id2)}"ShaderNodeValue"==a.YL&&(m=I.FI(g.dj,f),I.AY(d,e,m,a.T.id0?l(y(a.V.id0,b.u,c.u),0):a.Hb.id0))}},DELAY:function(a,
b,c,d,f){switch(b.state){case 2:-1==a.state?(a.state=0,a.rx=0,c.Hf=!0):0==a.state&&(a.rx+=f,(a.T.dl?l(y(a.V.dl,b.u,c.u),0):a.Hb.dl)<a.rx&&(a.state=-1,c.ma=a.Oa,c.Hf=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.fb.id0=K.xc(K.Oc,a.Kc.id0,0);b||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);c=a.xe.sk;z.RR(b)?z.AV(b,c)||(G.error("Wrong key name:",c),a.qc=!0):(G.error("No shape keys in object:",b.name),a.qc=!0);break;case 2:z.IQ(a.fb.id0,a.xe.sk,a.T.skv?l(y(a.V.skv,
b.u,c.u),0):a.Hb.skv),c.ma=a.Oa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.fb.id0=K.xc(K.Oc,a.Kc.id0,0);d||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);d&&d.k&&d.k.Vc||(G.error("Can't evaluate 'Outline' logic node: wrong object"),a.qc=!0);break;case 2:d=a.fb.id0;switch(a.xe.outline_operation){case "PLAY":b=d.k.ai;K.yn(d,b.rk,b.tk,b.uk);break;case "STOP":K.mu(d);break;case "INTENSITY":d.k.ih=a.T["in"]?l(y(a.V["in"],b.u,c.u),0):a.Hb["in"]}c.ma=a.Oa}},MOVE_CAMERA:function(a,
b,c){function f(a,b,c,d){switch(B.hm(a)){case B.Kb:B.Ds(a,b,c);break;case B.nd:case B.Bg:t.mj(a,d);break;case B.bd:F.sub(c,b,N),F.normalize(N,N),B.Uw(a,c),c=b=0,ba[0]=N[0],ba[1]=0,ba[2]=N[2],b=F.dot(ba,N),c=Math.acos(b/(F.length(ba)*F.length(N))),b=N[2]?Math.atan(N[0]/N[2]):0<N[0]?0:Math.PI,0<N[2]&&0<N[0]?u[1]=-(Math.PI+u[1]):0<N[2]&&0>N[0]?u[1]=-(Math.PI+u[1]):0>N[2]&&0>N[0]?(u[0]+=Math.PI,b=-(Math.PI-b)):0>N[2]&&0<N[0]&&(u[0]+=Math.PI,b-=Math.PI),B.vs(a,b+Math.PI,-c,!0,!0)}t.D(a);O.H(a)}function e(a,
b,c,f){m.lookAt(b,c,J.nc,Z);m.invert(Z,Z);d.fromMat4(Z,ga);x.fromMat3(ga,T);x.normalize(T,T);da.hi(b,da.Yd(a.k.n),T,f)}switch(b.state){case 1:c=null;c=a.fb.ca=K.xc(K.Oc,a.Kc.id0,0);c||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.fb.tr=K.xc(K.Oc,a.Kc.id1,0);a.fb.tr||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.fb.ta=K.xc(K.Oc,a.Kc.id2,0);a.fb.ta||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.vc={UM:new Float32Array(3),
TM:new Float32Array(3),BB:new Float32Array(3),LD:new Float32Array(3),GM:new Float32Array(3),AB:new Float32Array(3),Uk:new Float32Array(8),oi:new Float32Array(8),Dr:new Float32Array(8)};break;case 2:var g=a.fb.ca,k=da.G(a.fb.tr.k.n),h=da.G(a.fb.ta.k.n);switch(a.state){case -1:b=a.T.dur?l(y(a.V.dur,b.u,c.u),0):a.Hb.dur;if(0==b){e(g,k,h,a.vc.oi);f(g,k,h,a.vc.oi);c.ma=a.Oa;break}F.copy(da.G(g.k.n),a.vc.UM);var n=B.hm(g);n==B.bd?F.copy(g.k.Vb,a.vc.LD):n==B.Bg||n==B.nd?(da.copy(g.k.n,a.vc.Uk),e(g,k,h,a.vc.oi)):
F.copy(g.k.pivot,a.vc.LD);F.copy(k,a.vc.TM);F.copy(h,a.vc.GM);a.state=0;var p=P.wn(0,1,1E3*b,function(b){D.Da()&&(n==B.Bg||n==B.nd?da.CB(a.vc.Uk,a.vc.oi,J.Sm(b),a.vc.Dr):(a.vc.AB=F.lerp(a.vc.LD,a.vc.GM,J.Sm(b),a.vc.AB),a.vc.BB=F.lerp(a.vc.UM,a.vc.TM,J.Sm(b),a.vc.BB)),f(g,a.vc.BB,a.vc.AB,a.vc.Dr),1==b&&(a.state=1))});break;case 1:P.lu(p),a.state=-1,c.ma=a.Oa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d=null,d=a.fb.ca=K.xc(K.Oc,a.Kc.id0,0);d||(G.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0);b=d.k;a.xR={Rk:b.Rk,use_panning:b.use_panning,mb:b.mb,la:b.la,tb:b.tb,Bc:b.Bc,Cc:b.Cc,ce:b.ce,Nh:b.Nh};break;case 2:var d=a.fb.ca,f=d.k,e=a.xR;B.ht(d);switch(a.xe.camera_move_style){case 0:f.vb=B.Bg;break;case 2:f.vb=B.nd;var g=da.G(f.n);B.RY(d,g,null,e.mb,e.la);break;case 3:f.vb=B.bd;var g=da.G(f.n),m=N;a.T.pvo?(m=K.xc(K.Oc,a.Kc.id1,0),m=da.G(m.k.n)):(m[0]=a.T.pvx?l(y(a.V.pvx,b.u,c.u),0):a.Hb.pvx,m[1]=a.T.pvy?l(y(a.V.pvy,b.u,c.u),0):a.Hb.pvy,m[2]=a.T.pvz?l(y(a.V.pvz,b.u,c.u),0):
a.Hb.pvz);B.VL(d,g,m,e.tb,e.la,e.Bc,e.Cc,e.Nh);break;case 1:f.vb=B.Kb,g=da.G(f.n),m=N,a.T.pvo?(m=K.xc(K.Oc,a.Kc.id1,0),m=da.G(m.k.n)):(m[0]=a.T.pvx?l(y(a.V.pvx,b.u,c.u),0):a.Hb.pvx,m[1]=a.T.pvy?l(y(a.V.pvy,b.u,c.u),0):a.Hb.pvy,m[2]=a.T.pvz?l(y(a.V.pvz,b.u,c.u),0):a.Hb.pvz),B.WL(d,g,m,e.mb,e.la,e.D3,e.ce,e.use_panning)}ba[0]=a.T.vtr?l(y(a.V.vtr,b.u,c.u),0):a.Hb.vtr;ba[1]=a.T.vro?l(y(a.V.vro,b.u,c.u),0):a.Hb.vro;ba[2]=a.T.vzo?l(y(a.V.vzo,b.u,c.u),0):a.Hb.vzo;ba[0]=J.U(ba[0],0,Infinity);ba[1]=J.U(ba[1],
0,Infinity);ba[2]=J.U(ba[2],0,.99);f.$k=ba[0];f.Zk=ba[1];f.al=ba[2];t.D(d);O.H(d);B.ao(d);c.ma=a.Oa}},MOVE_TO:function(a,b,c){function d(a,b){t.mj(a,b);t.D(a);O.H(a)}switch(b.state){case 1:a.fb.ob=K.xc(K.Oc,a.Kc.id0,0);a.fb.ob||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.fb.de=K.xc(K.Oc,a.Kc.id1,0);a.fb.de||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.jc={CH:new Float32Array(8),DA:new Float32Array(8),yJ:new Float32Array(8)};break;
case 2:var f=a.fb.ob;da.copy(a.fb.ob.k.n,a.jc.CH);da.copy(a.fb.de.k.n,a.jc.DA);switch(a.state){case -1:b=a.T.dur?l(y(a.V.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(f,a.jc.DA);c.ma=a.Oa;break}a.state=0;var e=P.wn(0,1,1E3*b,function(b){D.Da()&&(a.jc.B6=da.CB(a.jc.CH,a.jc.DA,J.Sm(b),a.jc.yJ),d(f,a.jc.yJ),1==b&&(a.state=1))});break;case 1:P.lu(e),a.state=-1,c.ma=a.Oa}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?t.mj(a,b):t.Zw(a,b);t.D(a);O.H(a)}switch(b.state){case 1:a.fb.ob=K.xc(K.Oc,a.Kc.id0,
0);a.fb.ob||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.jc={kx:0,Uk:new Float32Array(8),oi:new Float32Array(8),Dr:new Float32Array(8)};break;case 2:var f=a.fb.ob;switch(a.state){case -1:ba[0]=a.T.trx?l(y(a.V.trx,b.u,c.u),0):a.Hb.trx;ba[1]=a.T["try"]?l(y(a.V["try"],b.u,c.u),0):a.Hb["try"];ba[2]=a.T.trz?l(y(a.V.trz,b.u,c.u),0):a.Hb.trz;N[0]=a.T.rox?l(y(a.V.rox,b.u,c.u),0)*Math.PI/180:a.Hb.rox;N[1]=a.T.roy?l(y(a.V.roy,b.u,c.u),0)*Math.PI/180:a.Hb.roy;N[2]=a.T.roz?
l(y(a.V.roz,b.u,c.u),0)*Math.PI/180:a.Hb.roz;var e=a.T.sc?y(a.V.sc,b.u,c.u):a.Hb.sc;J.Wj(N,T);da.hi(ba,e,T,a.jc.oi);a.jc.kx=a.xe.space_type;switch(a.jc.kx){case 0:t.vr(f,a.jc.Uk);break;case 1:t.wr(f,a.jc.Uk);break;case 2:t.wr(f,a.jc.Uk),da.multiply(a.jc.Uk,a.jc.oi,a.jc.oi)}b=a.T.dur?l(y(a.V.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(f,a.jc.oi,a.jc.kx);c.ma=a.Oa;break}a.state=0;e=P.wn(0,1,1E3*b,function(b){D.Da()&&(da.CB(a.jc.Uk,a.jc.oi,J.Sm(b),a.jc.Dr),d(f,a.jc.Dr,a.jc.kx),1==b&&(a.state=1))});break;case 1:P.lu(e),
a.state=-1,c.ma=a.Oa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.ea=K.xc(K.Oc,a.Kc.id0,0);a.ea||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);void 0==a.T.not_wait&&(a.T.not_wait=!0);break;case 2:switch(g.$V(a.ea)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.me){var f=b.me[d].Qf.ma;-1!=f&&(f=b.me[d].M[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.ea==a.ea&&(f.state=1))}a.T.not_wait||(c.Hf=!0);g.FK(a.ea);a.state=0;break;case 0:a.T.not_wait&&(c.ma=
a.Oa,a.state=-1);break;case 1:a.T.not_wait||(c.Hf=!1);c.ma=a.Oa;a.state=-1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.ea=K.xc(K.Oc,a.Kc.id0,0);a.ea||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:g.stop(a.ea),c.ma=a.Oa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.ea=a.T.env?K.iv(a.$q[0],0):w(a);a.ea||(G.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:v.stop(a.ea,
v.kl),a.T.rst&&v.dD(a.ea,v.kl),c.ma=a.Oa}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.T.rst&&Q.GL(d),Q.tM(),c.ma=a.Oa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},f;for(f in a.V)d[a.V[f][1]]=y(a.V[f],b.u,c.u);G.log(a.xe.msg,JSON.stringify(d));c.ma=a.Oa}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.T.id0?l(y(a.V.id0,b.u,c.u),1):a.qj.id0,f=a.T.id1?l(y(a.V.id1,b.u,c.u),1):a.qj.id1,e=0;switch(a.xe.string_operation){case 0:e=d+f;break;case 1:e=d.indexOf(f);break;
case 2:e=d.replace(f,a.T.id2?l(y(a.V.id2,b.u,c.u),1):a.qj.id2);break;case 3:var g=a.V,e=d.substring(0,d.indexOf(f));r(g.dst1,b.u,c.u,d.substring(d.indexOf(f)+1,d.length));""==y(g.dst,b.u,c.u)&&(e=y(g.dst1,b.u,c.u),r(g.dst1,b.u,c.u,""));break;case 4:switch(a.xe.condition){case 5:e=d==f?1:0;break;case 4:e=d!=f?1:0;break;case 3:e=d<f?1:0;break;case 2:e=d>f?1:0;break;case 1:e=d<=f?1:0;break;case 0:e=d>=f?1:0}}r(a.V.dst,b.u,c.u,e);c.ma=a.Oa}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=a.T.nla?
l(Q.rr(d),0):l(P.rr(d),0),r(a.V.vd,b.u,c.u,d),c.ma=a.Oa}},JSON:function(a,b,c){function d(a,b,c,e){for(var g=0;g<b.length;g++){for(var m=b[g].split("."),k=a,l=c[g],h=0;h<m.length&&(k=k[m[h]],void 0!==k&&null!==k);h++);k=f(k);e[l]=k}}function e(a,b,c,d){d||(d={});for(var g=0;g<b.length;g++){var m=b[g].split("."),k=d,l=c[g];if(!(!l in a)){for(var h=0;h<m.length-1;h++)void 0===k[m[h]]&&(k[m[h]]=isNaN(m[h+1])?{}:[]),k=k[m[h]];k[m[m.length-1]]=f(a[l])}}}switch(b.state){case 2:switch(a.xe.json_operation){case "PARSE":try{var g=
JSON.parse(l(y(a.V.jsn,b.u,c.u),1));d(g,a.gX,a.hX,c.u)}catch(m){G.error("logic script error: non valid JSON string")}break;case "ENCODE":g={},e(c.u,a.QT,a.RT,g),g=l(JSON.stringify(g),1),r(a.V.jsn,b.u,c.u,g)}c.ma=a.Oa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.T.cb?l(y(a.V.cb,b.u,c.u),1):a.qj.cb,e=[],g=0,m="id"+g,k=a.xe.js_cb_params;m in k;)m=0==k[m]?K.xc(K.Oc,a.Kc[m],0):y(a.V[m],b.u,c.u),e.push(m),g++,m="id"+g;k=[];g=0;for(m="out"+g;m in a.V;)m=y(a.V[m],b.u,c.u),k.push(m),g++,
m="out"+g;g=1;if(d in ha){if(g=!ha[d](e,k))for(d=0;d<k.length;d++)m="out"+d,m in a.V&&r(a.V[m],b.u,c.u,f(k[d]))}else G.error("logic script error: no custom callback with id "+d);g&&(c.ma=a.Oa)}},EMPTY:A},ca=[],ha={};a.JV=function(a,b){var c={Ue:b,lL:a.name,state:0,Bm:null,yb:a,xA:null,me:[],Hs:[],u:{}};a.V1=c;n(a,c)};a.update=function(a,b){var c=Q.pV();if(!(0>=c))for(var d=0;d<ca.length;d++)for(var f=d,e=a,g=b,m=c,k=ca[f],l=0;l<ca[f].me.length;l++){k.xA=ca[f].me[l];var h=ca[f].me[l],n=k,p=e,r=g,t=
m,u=h.M;if(u.length){for(var O=0;O<u.length;O++)u[O].Bw=!1;for(O=0;O<u.length;O++){if(0<=h.Qf.ma)var x=u[h.Qf.ma];else break;if(x.Bw)break;if(x.qc)if("ENTRYPOINT"==x.type)break;else h.Qf.ma=x.Oa,x.Bw=!0;else x.NK(x,n,h.Qf,p,r,t),x.Bw=!0}}}};a.Z1=function(a,b){ha[a]=b};a.G7=function(a){delete ha[a]};a.Q7=function(a,b){for(var c=0;c<ca.length;c++)if(ca[c].lL==a){for(var c=ca[c],d=0;d<c.me.length;d++){var f=c.me[d].M[0];if(f.name==b){f.T.js&&(f.qc=!1);c.me[d].Qf.ma=0;break}}break}};a.ua=function(){ca.length=
0;ha={}}};b4w.module.__reformer=function(a,h){function p(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function e(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],f=0;f<d.strips.length;f++){var e=d.strips[f];"action"in e||(e.action=null,b("strip",e,"action"));"action_frame_start"in e||(e.action_frame_start=0,b("strip",e,"action_frame_start"));"action_frame_end"in e||(e.action_frame_end=e.frame_end-e.frame_start,b("strip",e,"action_frame_end"));"repeat"in e||(e.repeat=1,b("strip",e,"repeat"));
"use_reverse"in e||(e.use_reverse=!1,b("strip",e,"use_reverse"));"scale"in e||(e.scale=1,b("strip",e,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={BD:[],cL:"undefined",type:a});D[c].BD.push(b.name)}function y(a,b,c){c=c+">>"+a;c in D||(D[c]={BD:[],cL:"deprecated",type:a});D[c].BD.push(b.name)}function r(a){l.warn(a)}function A(a,b){b||(b=a.name+"_COPY");var c=a.materials,f=a.submeshes;a.materials=null;a.submeshes=null;var e=v.Ih(a);a.materials=c;a.submeshes=f;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<f.length;c++){var k=v.yq(f[c]);e.submeshes.push(k)}return e}var k=h("__boundings"),w=h("__curve"),n=h("__mat4"),l=h("__print"),f=h("__quat"),v=h("__util"),c=h("__vec3"),B=h("__mat3"),Q=h("__logic_nodes"),K=h("__animation"),G=[5,4],D={},R=B.create(),L=f.create();a.GG=function(a){return-1!=v.xN(a,G)};a.HR=function(a){D={};var c=a.worlds;if(0==c.length){l.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var d={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};c.push(d)}for(var c=a.worlds,f=0;f<c.length;f++){d=c[f];"use_sky_blend"in d||(b("world",d,"use_sky_blend"),d.use_sky_blend=!1);"use_sky_paper"in d||(b("world",d,"use_sky_paper"),
d.use_sky_paper=!1);"use_sky_real"in d||(b("world",d,"use_sky_real"),d.use_sky_real=!1);"b4w_sky_settings"in d&&"rayleigh_brightness"in d.b4w_sky_settings||(b("world",d,"rayleigh_brightness"),d.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
d||(b("world",d,"fog_settings"),d.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in d&&(d.fog_settings.use_custom_color=!0,d.fog_settings.color=d.b4w_fog_color),"b4w_fog_density"in d&&0<d.b4w_fog_density&&(d.fog_settings.depth=1/d.b4w_fog_density));"render_sky"in d.b4w_sky_settings||(b("world",d,"render_sky"),d.b4w_sky_settings.render_sky=!1);for(var k=d.texture_slots,h=0;h<k.length;h++){var g=k[h];"blend_type"in
g||(g.blend_type="MIX",b("world_texture_slot",g,"blend_type"));"use_map_blend"in g||(g.use_map_blend=!1,b("world_texture_slot",g,"use_map_blend"));"use_map_horizon"in g||(g.use_map_horizon=!0,b("world_texture_slot",g,"use_map_horizon"));"use_map_zenith_up"in g||(g.use_map_zenith_up=!1,b("world_texture_slot",g,"use_map_zenith_up"));"use_rgb_to_intensity"in g||(g.use_rgb_to_intensity=!1,b("world_texture_slot",g,"use_rgb_to_intensity"));"invert"in g||(g.invert=!1,b("world_texture_slot",g,"invert"));
"color"in g||(g.color=[1,0,1],b("world_texture_slot",g,"color"));"blend_factor"in g||(g.blend_factor=0,b("world_texture_slot",g,"blend_factor"));"horizon_factor"in g||(g.horizon_factor=1,b("world_texture_slot",g,"horizon_factor"));"zenith_up_factor"in g||(g.zenith_up_factor=0,b("world_texture_slot",g,"zenith_up_factor"));"zenith_down_factor"in g||(g.zenith_down_factor=0,b("world_texture_slot",g,"zenith_down_factor"));"default_value"in g||(g.default_value=1,b("world_texture_slot",g,"default_value"))}"b4w_use_default_animation"in
d||(b("world",d,"b4w_use_default_animation"),d.b4w_use_default_animation=!1);"b4w_anim_behavior"in d||(b("world",d,"b4w_anim_behavior"),d.b4w_anim_behavior="CYCLIC")}h=a.scenes;for(f=0;f<h.length;f++)k=h[f],g=k.world,"timeline_markers"in k||(k.timeline_markers=null,b("scene",k,"timeline_markers")),"b4w_reflection_quality"in k||(k.b4w_reflection_quality="MEDIUM",b("scene",k,"b4w_reflection_quality")),"b4w_use_nla"in k||(k.b4w_use_nla=!1,b("scene",k,"b4w_use_nla")),"fps"in k||(k.fps=24,b("scene",k,
"fps")),"b4w_nla_cyclic"in k||(k.b4w_nla_cyclic=!1,b("scene",k,"b4w_nla_cyclic")),"b4w_logic_nodes"in k||(k.b4w_logic_nodes=[],b("scene",k,"b4w_logic_nodes")),"b4w_detect_collisions"in k&&(y("scene",k,"b4w_detect_collisions"),delete k.b4w_detect_collisions),"audio_doppler_speed"in k||(k.audio_doppler_speed=343.3),"audio_doppler_factor"in k||(k.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in k||(k.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",k,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in k||(k.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in k||(k.b4w_enable_bloom=!1,b("scene",k,"b4w_enable_bloom")),"b4w_enable_motion_blur"in k||(k.b4w_enable_motion_blur=!1,b("scene",k,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in k||(k.b4w_enable_color_correction=!1,b("scene",k,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in k||(k.b4w_antialiasing_quality="MEDIUM",b("scene",k,"b4w_antialiasing_quality")),
"b4w_tags"in k||(k.b4w_tags={title:"",description:""},b("scene",k,"b4w_tags")),"b4w_enable_object_selection"in k||(k.b4w_enable_object_selection="AUTO",b("scene",k,"b4w_enable_object_selection")),"b4w_enable_outlining"in k||(k.b4w_enable_outlining="AUTO",b("scene",k,"b4w_enable_outlining")),"b4w_enable_glow_materials"in k||(k.b4w_enable_glow_materials="AUTO",b("scene",k,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in k||(k.b4w_enable_anchors_visibility="AUTO",b("scene",k,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in k||(k.b4w_outline_color=[1,1,1],b("scene",k,"b4w_outline_color")),"b4w_outline_factor"in k||(k.b4w_outline_factor="b4w_glow_factor"in k?k.b4w_glow_factor:1,b("scene",k,"b4w_outline_factor")),"b4w_shadow_settings"in k||(b("scene",k,"b4w_shadow_settings"),c=g.b4w_shadow_settings,k.b4w_shadow_settings=c?c:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),c=k.b4w_shadow_settings,"csm_resolution"in c||(b("scene",k,"b4w_shadow_settings.csm_resolution"),c.csm_resolution=2048),"blur_samples"in c||(b("scene",k,"b4w_shadow_settings.blur_samples"),c.blur_samples="16x"),"soft_shadows"in c||(b("scene",k,"b4w_shadow_settings.soft_shadows"),c.soft_shadows=!0),"self_shadow_polygon_offset"in c||(b("scene",k,"b4w_shadow_settings.self_shadow_polygon_offset"),c.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in c||(b("scene",k,"b4w_shadow_settings.self_shadow_normal_offset"),c.self_shadow_normal_offset=.01),"b4w_enable_csm"in c||(b("scene",k,"b4w_shadow_settings.b4w_enable_csm"),c.b4w_enable_csm=!1),"csm_num"in c||(b("scene",k,"b4w_shadow_settings.csm_num"),c.csm_num=1),"csm_first_cascade_border"in c||(b("scene",k,"b4w_shadow_settings.csm_first_cascade_border"),c.csm_first_cascade_border=10),"first_cascade_blur_radius"in c||(b("scene",k,"b4w_shadow_settings.first_cascade_blur_radius"),
c.first_cascade_blur_radius=3),"csm_last_cascade_border"in c||(b("scene",k,"b4w_shadow_settings.csm_last_cascade_border"),c.csm_last_cascade_border=100),"last_cascade_blur_radius"in c||(b("scene",k,"b4w_shadow_settings.last_cascade_blur_radius"),c.last_cascade_blur_radius=1.5),"fade_last_cascade"in c||(b("scene",k,"b4w_shadow_settings.fade_last_cascade"),c.fade_last_cascade=!0),"blend_between_cascades"in c||(b("scene",k,"b4w_shadow_settings.blend_between_cascades"),c.blend_between_cascades=!0),"b4w_ssao_settings"in
k||(b("scene",k,"b4w_ssao_settings"),c=g.b4w_ssao_settings,k.b4w_ssao_settings=c?c:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),c=k.b4w_ssao_settings,"dist_factor"in c||(b("scene",k,"b4w_ssao_settings.dist_factor"),c.dist_factor=0),"samples"in c||(b("scene",k,"b4w_ssao_settings.samples"),c.samples=16),"hemisphere"in c||(b("scene",k,"b4w_ssao_settings.hemisphere"),c.hemisphere=!1),"blur_depth"in c||(b("scene",k,"b4w_ssao_settings.blur_depth"),c.blur_depth=!1),"blur_discard_value"in
c||(b("scene",k,"b4w_ssao_settings.blur_discard_value"),c.blur_discard_value=1),"b4w_bloom_settings"in k||(b("scene",k,"b4w_bloom_settings"),c=g.b4w_bloom_settings,k.b4w_bloom_settings=c?c:{key:.2,blur:4,edge_lum:1}),"key"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.key"),k.b4w_bloom_settings.key=.2),"blur"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.blur"),k.b4w_bloom_settings.blur=4),"edge_lum"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.edge_lum"),k.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in k||(b("scene",k,"b4w_motion_blur_settings"),c=g.b4w_motion_blur_settings,k.b4w_motion_blur_settings=c?c:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_factor"),k.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_decay_threshold"),k.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in k||(b("scene",k,"b4w_color_correction_settings"),c=g.b4w_color_correction_settings,k.b4w_color_correction_settings=c?c:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in k||(b("scene",k,"b4w_god_rays_settings"),c=g.b4w_god_rays_settings,k.b4w_god_rays_settings=c?c:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in k.b4w_god_rays_settings||(b("scene",k,"b4w_god_rays_settings.steps_per_pass"),k.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in k||(b("scene",k,"b4w_glow_settings"),k.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},c=k.b4w_glow_settings,"b4w_render_glow_over_blend"in g&&(c.render_glow_over_blend=g.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in g&&(c.small_glow_mask_coeff=g.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in g&&(c.large_glow_mask_coeff=g.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
g&&(c.small_glow_mask_width=g.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in g&&(c.large_glow_mask_width=g.b4w_large_glow_mask_width)),g=k.b4w_render_shadows,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(k.b4w_render_shadows=g?"ON":"OFF"),g=k.b4w_render_reflections,"OFF"!=g&&"ON"!=g&&(k.b4w_render_reflections=g?"ON":"OFF"),g=k.b4w_render_refractions,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(k.b4w_render_refractions=g?"ON":"OFF"),"b4w_render_dynamic_grass"in k||(b("scene",k,"b4w_render_dynamic_grass"),k.b4w_render_dynamic_grass=
"AUTO"),k.b4w_nla_script&&y("scene",k,"b4w_nla_script"),"audio_distance_model"in k||(b("scene",k,"audio_distance_model"),k.audio_distance_model="INVERSE_CLAMPED");k=a.meshes;for(f=0;f<k.length;f++){g=k[f];g.b4w_boundings||(b("mesh",g,"b4w_boundings"),g.b4w_boundings={},c=g.b4w_boundings,c.bb=g.b4w_bounding_box?g.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},c.bb_src=g.b4w_bounding_box_source?g.b4w_bounding_box_source:g.b4w_bounding_box,c.bs_cen=g.b4w_bounding_sphere_center?g.b4w_bounding_sphere_center:
[0,0,0],c.bc_cen=g.b4w_bounding_cylinder_center?g.b4w_bounding_cylinder_center:[0,0,0],c.be_cen=g.b4w_bounding_ellipsoid_center?g.b4w_bounding_ellipsoid_center:[0,0,0],g.b4w_bounding_ellipsoid_axes?c.be_ax=g.b4w_bounding_ellipsoid_axes:(h=c.bb,c.be_ax=[(h.max_x-h.min_x)/2,(h.max_y-h.min_y)/2,(h.max_z-h.min_z)/2]),g.b4w_rotated_bounding_box?c.rbb=g.b4w_rotated_bounding_box:(h=c.bb,c.rbb={rbb_c:[(h.max_x+h.min_x)/2,(h.max_y+h.min_y)/2,(h.max_z+h.min_z)/2],rbb_s:[1,1,1]}),c.caxis_x=g.b4w_cov_axis_x?
g.b4w_cov_axis_x:[1,0,0],c.caxis_y=g.b4w_cov_axis_y?g.b4w_cov_axis_y:[0,1,0],c.caxis_z=g.b4w_cov_axis_z?g.b4w_cov_axis_z:[0,0,1]);g.uv_textures||(b("mesh",g,"uv_textures"),g.uv_textures=[]);"b4w_shape_keys"in g||(g.b4w_shape_keys=[],b("mesh",g,"b4w_shape_keys"));c=!0;for(d=0;d<g.submeshes.length;d++){var n=g.submeshes[d];"boundings"in n||(c=!1,n.boundings={be_ax:g.b4w_bounding_ellipsoid_axes,be_cen:g.b4w_bounding_ellipsoid_center,bb:{max_x:g.b4w_bounding_box.max_x,max_y:g.b4w_bounding_box.max_y,max_z:g.b4w_bounding_box.max_z,
min_x:g.b4w_bounding_box.min_x,min_y:g.b4w_bounding_box.min_y,min_z:g.b4w_bounding_box.min_z}});"be_ax"in n.boundings||(n.boundings.be_ax=g.b4w_bounding_ellipsoid_axes);"be_cen"in n.boundings||(n.boundings.be_cen=g.b4w_bounding_ellipsoid_center);"bb"in n.boundings||(n.boundings.bb=g.b4w_bounding_box);"rbb"in n.boundings||(h=g.b4w_bounding_box,n.boundings.rbb={rbb_c:[(h.max_x+h.min_x)/2,(h.max_y+h.min_y)/2,(h.max_z+h.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in n.boundings||(n.boundings.caxis_x=[1,0,0]);
"caxis_y"in n.boundings||(n.boundings.caxis_y=[0,1,0]);"caxis_z"in n.boundings||(n.boundings.caxis_z=[0,0,1])}c||b("mesh",g,"submesh_bd");h=g;c=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];d=null;for(n=0;n<c.length;n++)h[c[n]]&&(d?(h[c[n]]=!1,l.warn('WARNING property "'+c[n]+'" of object "'+h.name+'" has been set to "false". Foreground property "'+d+'" already exists.')):d=c[n]);for(h=0;h<g.b4w_vertex_anim.length;h++)c=g.b4w_vertex_anim[h],
"allow_nla"in c||(b('mesh["b4w_vertex_anim"]',g,"allow_nla"),c.allow_nla=!0)}h=a.cameras;for(f=0;f<h.length;f++)k=h[f],k.type||(k.type="PERSP",b("camera",k,"type")),"b4w_eye_target_dist"in k&&(delete k.b4w_eye_target_dist,y("camera",k,"b4w_eye_target_dist")),"b4w_hover_zero_level"in k||(k.b4w_hover_zero_level=0,b("camera",k,"b4w_hover_zero_level")),"b4w_trans_velocity"in k||(k.b4w_trans_velocity=1,b("camera",k,"b4w_trans_velocity")),"b4w_rot_velocity"in k||(k.b4w_rot_velocity=1,b("camera",k,"b4w_rot_velocity")),
"b4w_zoom_velocity"in k||(k.b4w_zoom_velocity=.1,b("camera",k,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in k||(k.b4w_use_target_distance_limits=k.b4w_use_distance_limits||!1,b("camera",k,"b4w_use_target_distance_limits")),"b4w_use_zooming"in k||(k.b4w_use_zooming=k.b4w_use_distance_limits||!1,b("camera",k,"b4w_use_zooming")),"b4w_distance_min"in k||(k.b4w_distance_min=1,b("camera",k,"b4w_distance_min")),"b4w_distance_max"in k||(k.b4w_distance_max=100,b("camera",k,"b4w_distance_max")),
"b4w_horizontal_translation_min"in k||(k.b4w_horizontal_translation_min=-100,b("camera",k,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in k||(k.b4w_horizontal_translation_max=100,b("camera",k,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in k||(k.b4w_vertical_translation_min=-100,b("camera",k,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in k||(k.b4w_vertical_translation_max=100,b("camera",k,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
k||(k.b4w_use_horizontal_clamping=!1,b("camera",k,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in k||(k.b4w_rotation_left_limit=-Math.PI,b("camera",k,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in k||(k.b4w_rotation_right_limit=Math.PI,b("camera",k,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in k||(k.b4w_horizontal_clamping_type="LOCAL",b("camera",k,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in k||(k.b4w_use_vertical_clamping=!1,b("camera",k,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in k||(k.b4w_rotation_down_limit=-Math.PI/2,b("camera",k,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in k||(k.b4w_rotation_up_limit=Math.PI/2,b("camera",k,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in k||(k.b4w_vertical_clamping_type="LOCAL",b("camera",k,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in k||(k.b4w_hover_angle_min=Math.PI/6,b("camera",k,"b4w_hover_angle_min")),"b4w_hover_angle_max"in k||(k.b4w_hover_angle_max=Math.PI/6,b("camera",k,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in k||(k.b4w_enable_hover_hor_rotation=!0,b("camera",k,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in k||(k.b4w_use_panning=!0,b("camera",k,"b4w_use_panning")),"b4w_use_pivot_limits"in k||(k.b4w_use_pivot_limits=!1,k.b4w_pivot_z_min=0,k.b4w_pivot_z_max=10,b("camera",k,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in k||(k.b4w_dof_bokeh=!1,b("camera",k,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in k||(k.b4w_dof_bokeh_intensity=.3,b("camera",k,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in k||(k.b4w_dof_foreground_blur=!1,b("camera",k,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in k||(k.b4w_dof_front_start=0,b("camera",k,"b4w_dof_front_start")),"b4w_dof_front_end"in k||(k.b4w_dof_front_end=k.b4w_dof_front,b("camera",k,"b4w_dof_front_end")),"b4w_dof_rear_start"in k||(k.b4w_dof_rear_start=0,b("camera",k,"b4w_dof_rear_start")),"b4w_dof_rear_end"in k||(k.b4w_dof_rear_end=k.b4w_dof_rear,b("camera",k,"b4w_dof_rear_end"));h=a.lamps;for(f=0;f<h.length;f++)k=
h[f],"b4w_generate_shadows"in k||(k.b4w_generate_shadows=!1,b("lamp",k,"b4w_generate_shadows")),"b4w_dynamic_intensity"in k||(k.b4w_dynamic_intensity=!1,b("lamp",k,"b4w_dynamic_intensity")),"use_diffuse"in k||(k.use_diffuse=!0,b("lamp",k,"use_diffuse")),"use_specular"in k||(k.use_specular=!0,b("lamp",k,"use_specular")),"clip_start"in k||(k.clip_start=.1,b("lamp",k,"clip_start")),"clip_end"in k||(k.clip_end=30,b("lamp",k,"clip_end")),"POINT"!=k.type&&"SPOT"!=k.type||"use_sphere"in k||(k.use_sphere=
!1,b("lamp",k,"use_sphere"));h=a.speakers;for(f=0;f<h.length;f++)k=h[f],"b4w_behavior"in k||(k.b4w_behavior=k.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in k||(k.b4w_auto_play=!1,b("speaker",k,"b4w_auto_play")),"b4w_enable_doppler"in k||(k.b4w_enable_doppler=!1,b("speaker",k,"b4w_enable_doppler")),"b4w_delay"in k||(k.b4w_delay=0),"b4w_delay_random"in k||(k.b4w_delay_random=0),"b4w_volume_random"in k||(k.b4w_volume_random=0),"b4w_pitch_random"in k||(k.b4w_pitch_random=0),
"b4w_fade_in"in k||(k.b4w_fade_in=0),"b4w_fade_out"in k||(k.b4w_fade_out=0),"b4w_loop"in k||(k.b4w_loop=!1),"b4w_loop_start"in k||(k.b4w_loop_start=0,b("speaker",k,"b4w_loop_start")),"b4w_loop_end"in k||(k.b4w_loop_end=0,b("speaker",k,"b4w_loop_end")),k.animation_data&&e(k.animation_data);h=a.textures;for(f=0;f<h.length;f++)k=h[f],"b4w_anisotropic_filtering"in k||(k.b4w_anisotropic_filtering="OFF",b("texture",k,"b4w_anisotropic_filtering")),"b4w_water_foam"in k||(k.b4w_water_foam=!1,b("texture",k,
"b4w_water_foam")),"b4w_foam_uv_freq"in k||(k.b4w_foam_uv_freq=[1,1],b("texture",k,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in k||(k.b4w_foam_uv_magnitude=[1,1],b("texture",k,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in k||(k.b4w_parallax_steps=5,b("material",k,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in k||(k.b4w_parallax_lod_dist=10,b("material",k,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in k||(k.b4w_shore_dist_map=!1,b("texture",k,"b4w_shore_dist_map")),"b4w_shore_boundings"in
k||(k.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",k,"b4w_shore_boundings")),"b4w_max_shore_dist"in k||(k.b4w_max_shore_dist=100,b("texture",k,"b4w_max_shore_dist")),"b4w_disable_compression"in k||(k.b4w_disable_compression=!1,b("texture",k,"b4w_disable_compression")),"b4w_source_type"in k||(k.b4w_source_type="",b("texture",k,"b4w_source_type")),"b4w_source_id"in k||(k.b4w_source_id="",b("texture",k,"b4w_source_id")),"b4w_source_size"in k||(k.b4w_source_size=1024,b("texture",k,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in k||(k.b4w_enable_canvas_mipmapping=!0,b("texture",k,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in k||(k.b4w_nla_video=!1,b("texture",k,"b4w_nla_video"));h=a.images;for(f=0;f<h.length;f++)k=h[f],"colorspace_settings_name"in k||(k.colorspace_settings_name="sRGB",b("image",k,"colorspace_settings_name"));c=a.materials;for(f=0;f<c.length;f++){d=c[f];"ALPHA_ANTIALIASING"==d.game_settings.alpha_blend&&(d.game_settings.alpha_blend="CLIP");"use_tangent_shading"in d||(d.use_tangent_shading=
!1,b("material",d,"use_tangent_shading"));"b4w_node_mat_type"in d&&y("material",d,"b4w_node_mat_type");"b4w_skydome"in d&&y("material",d,"b4w_skydome");"b4w_procedural_skydome"in d&&y("material",d,"b4w_procedural_skydome");"b4w_lens_flares"in d||(d.b4w_lens_flares=!1,b("material",d,"b4w_lens_flares"));"LENS_FLARES"===d.name&&(d.b4w_lens_flares||l.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),d.b4w_lens_flares=!0);d.b4w_water&&("b4w_water_shore_smoothing"in
d||(d.b4w_water_shore_smoothing=!1,b("material",d,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in d||(d.b4w_water_dynamic=!1,b("material",d,"b4w_water_dynamic")),"b4w_waves_height"in d||(d.b4w_waves_height=1,b("material",d,"b4w_waves_height")),"b4w_waves_length"in d||(d.b4w_waves_length=1,b("material",d,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in d||(d.b4w_water_dst_noise_scale0=.05,b("material",d,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in d||(d.b4w_water_dst_noise_scale1=
.03,b("material",d,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in d||(d.b4w_water_dst_noise_freq0=1.3,b("material",d,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in d||(d.b4w_water_dst_noise_freq1=1,b("material",d,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in d||(d.b4w_water_dir_min_shore_fac=.4,b("material",d,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in d||(d.b4w_water_dir_freq=.5,b("material",d,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
d||(d.b4w_water_dir_noise_scale=.05,b("material",d,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in d||(d.b4w_water_dir_noise_freq=.07,b("material",d,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in d||(d.b4w_water_dir_min_noise_fac=.5,b("material",d,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in d||(d.b4w_water_dst_min_fac=.2,b("material",d,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in d||(d.b4w_water_waves_hor_fac=5,b("material",d,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in d||(d.b4w_water_absorb_factor=6,b("material",d,"b4w_water_absorb_factor")),"b4w_water_fog_color"in d||(d.b4w_water_fog_color=[.5,.7,.7],b("material",d,"b4w_water_fog_color")),"b4w_foam_factor"in d||(d.b4w_foam_factor=5,b("material",d,"b4w_foam_factor")),"b4w_generated_mesh"in d||(d.b4w_generated_mesh=!1,b("material",d,"b4w_generated_mesh")),"b4w_water_num_cascads"in d||(d.b4w_water_num_cascads=5,b("material",d,"b4w_water_num_cascads")),"b4w_water_subdivs"in d||(d.b4w_water_subdivs=
64,b("material",d,"b4w_water_subdivs")),"b4w_water_detailed_dist"in d||(d.b4w_water_detailed_dist=1E3,b("material",d,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in d||(d.b4w_water_enable_caust=!1,b("material",d,"b4w_water_enable_caust")),"b4w_water_caust_scale"in d||(d.b4w_water_caust_scale=.25,b("material",d,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in d||(d.b4w_water_caust_brightness=.5,b("material",d,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in d||(d.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in d||(d.b4w_dynamic_grass_color="");"diffuse_intensity"in d||(d.diffuse_intensity=1,b("material",d,"diffuse_intensity"));"b4w_use_ghost"in d||(d.b4w_use_ghost=!1);"b4w_collision_margin"in d||(d.b4w_collision_margin=.04,b("material",d,"b4w_collision_margin"));"b4w_collision_group"in d||(d.b4w_collision_group=128,b("material",d,"b4w_collision_group"));"b4w_collision_mask"in d||(d.b4w_collision_mask=127,b("material",d,"b4w_collision_mask"));"b4w_do_not_render"in d||(d.b4w_do_not_render=
!1,b("material",d,"b4w_do_not_render"));"HALO"!=d.type||"b4w_halo_sky_stars"in d||(d.b4w_halo_sky_stars=!1,b("material",d,"b4w_halo_sky_stars"));"HALO"!=d.type||"b4w_halo_stars_blend_height"in d||(d.b4w_halo_stars_blend_height=10,b("material",d,"b4w_halo_stars_blend_height"));"HALO"!=d.type||"b4w_halo_stars_min_height"in d||(d.b4w_halo_stars_min_height=0,b("material",d,"b4w_halo_stars_min_height"));"specular_shader"in d||(d.specular_shader="COOKTORR",b("material",d,"specular_shader"));"diffuse_shader"in
d||(d.diffuse_shader="LAMBERT",b("material",d,"diffuse_shader"));"roughness"in d||(d.roughness=.5,b("material",d,"roughness"));"diffuse_fresnel"in d||(d.diffuse_fresnel=.1,b("material",d,"diffuse_fresnel"));"diffuse_fresnel_factor"in d||(d.diffuse_fresnel_factor=.5,b("material",d,"diffuse_fresnel_factor"));"specular_slope"in d||(d.specular_slope=.2,b("material",d,"specular_slope"));"specular_toon_size"in d||(d.specular_toon_size=.5,b("material",d,"specular_toon_size"));"specular_toon_smooth"in d||
(d.specular_toon_smooth=.1,b("material",d,"specular_toon_smooth"));"specular_alpha"in d||(d.specular_alpha=1,b("material",d,"specular_alpha"));"b4w_wettable"in d||(d.b4w_wettable=!1,b("material",d,"b4w_wettable"));"b4w_refractive"in d||(d.b4w_refractive=!1,b("material",d,"b4w_refractive"));"b4w_refr_bump"in d||(d.b4w_refr_bump=0,b("material",d,"b4w_refr_bump"));"b4w_shallow_water_col"in d||(d.b4w_shallow_water_col=[0,.8,.3],b("material",d,"b4w_shallow_water_col"));"b4w_shore_water_col"in d||(d.b4w_shore_water_col=
[0,.9,.2],b("material",d,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in d||(d.b4w_shallow_water_col_fac=1,b("material",d,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in d||(d.b4w_shore_water_col_fac=.5,b("material",d,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in d||(d.b4w_water_sss_strength=5.9,b("material",d,"b4w_water_sss_strength"));"b4w_water_sss_width"in d||(d.b4w_water_sss_width=.45,b("material",d,"b4w_water_sss_width"));"b4w_render_above_all"in d||(d.b4w_render_above_all=
!1,b("material",d,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in d||(d.b4w_water_norm_uv_velocity=.05,b("material",d,"b4w_water_norm_uv_velocity"));"specular_ior"in d||(d.specular_ior=1,b("material",d,"specular_ior"));"darkness"in d||(d.darkness=0,b("material",d,"darkness"));"diffuse_toon_size"in d||(d.diffuse_toon_size=0,b("material",d,"diffuse_toon_size"));"diffuse_toon_smooth"in d||(d.diffuse_toon_smooth=0,b("material",d,"diffuse_toon_smooth"));"pass_index"in d||(d.pass_index=0,b("material",
d,"pass_index"));k=d.texture_slots;for(h=0;h<k.length;h++)g=k[h],"blend_type"in g||(g.blend_type="MIX",b("texture_slot",g,"blend_type"));if(d.node_tree){k=d.node_tree.nodes;for(h=0;h<k.length;h++)p(k[h]);d.node_tree.animation_data&&e(d.node_tree.animation_data)}}g=a.node_groups;for(f=0;f<g.length;f++)for(k=g[f].node_tree.nodes,h=0;h<k.length;h++)p(k[h]);k=a.objects;for(f=0;f<k.length;f++){g=k[f];switch(g.type){case "MESH":"b4w_dynamic_geometry"in g||(g.b4w_dynamic_geometry=!1);"b4w_reflexible"in g||
(g.b4w_reflexible=!1);"b4w_reflexible_only"in g||(g.b4w_reflexible_only=!1);"b4w_reflective"in g||(g.b4w_reflective=!1);"b4w_reflection_type"in g||(g.b4w_reflection_type="PLANE",b("object",g,"b4w_reflection_type"));"b4w_wind_bending"in g||(g.b4w_wind_bending=!1,b("object",g,"b4w_wind_bending"));"b4w_wind_bending_angle"in g||(g.b4w_wind_bending_angle=10,g.b4w_wind_bending_freq=.25,b("object",g,"wind bending params"));"b4w_detail_bending_amp"in g||(g.b4w_detail_bending_amp=.1,g.b4w_branch_bending_amp=
.3,b("object",g,"detail bending params"));"b4w_detail_bending_freq"in g||(g.b4w_detail_bending_freq=1,b("object",g,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in g||(g.b4w_main_bend_stiffness_col="",b("object",g,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in g||(g.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",g,"b4w_detail_bend_colors"));"b4w_caustics"in g||(g.b4w_caustics=!1);"vertex_groups"in g&&g.vertex_groups.length&&
g.data&&0==g.data.vertex_groups.length&&(g.data.vertex_groups=g.vertex_groups,delete g.vertex_groups,b("object",g,"vertex_groups"));"b4w_vertex_anim"in g&&g.b4w_vertex_anim.length&&g.data&&0==g.data.b4w_vertex_anim.length&&(g.data.b4w_vertex_anim=g.b4w_vertex_anim,delete g.b4w_vertex_anim,b("object",g,"b4w_vertex_anim"));"b4w_do_not_render"in g||(g.b4w_do_not_render=!1);"b4w_hidden_on_load"in g||(g.b4w_hidden_on_load=!1);"use_ghost"in g.game||(g.game.use_ghost=!1);"use_sleep"in g.game||(g.game.use_sleep=
!1);"velocity_min"in g.game||(g.game.velocity_min=0);"velocity_max"in g.game||(g.game.velocity_max=0);"collision_group"in g.game||(g.game.collision_group=1);"collision_mask"in g.game||(g.game.collision_mask=255);h=g;c=h.game;d=c.collision_bounds_type;c.use_collision_bounds&&"BOX"!=d&&"CYLINDER"!=d&&"CONE"!=d&&"SPHERE"!=d&&"CAPSULE"!=d&&"EMPTY"!=d&&(l.error("Wrong collision bounds type "+d+". Disable physics for object "+h.name),h.b4w_collision=!1,h.b4w_floating=!1,h.b4w_vehicle=!1,h.b4w_character=
!1);"b4w_vehicle_settings"in g?g.b4w_vehicle_settings&&("steering_ratio"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_ratio=10),"steering_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_max=1),"inverse_control"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.inverse_control=!1),"force_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.force_max=1500),"brake_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.brake_max=100),"speed_ratio"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.water_rot_damp=.9)):(g.b4w_vehicle_settings=null,b("object",g,"b4w_vehicle_settings"));"b4w_floating_settings"in g?g.b4w_floating_settings&&("floating_factor"in g.b4w_floating_settings||(g.b4w_floating_settings.floating_factor=3),"water_lin_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_rot_damp=
.8)):(g.b4w_floating_settings=null,b("object",g,"b4w_floating_settings"));"b4w_character_settings"in g?g.b4w_character_settings&&("walk_speed"in g.b4w_character_settings||(g.b4w_character_settings.walk_speed=4),"run_speed"in g.b4w_character_settings||(g.b4w_character_settings.run_speed=8),"step_height"in g.b4w_character_settings||(g.b4w_character_settings.step_height=.25),"jump_strength"in g.b4w_character_settings||(g.b4w_character_settings.jump_strength=5),"waterline"in g.b4w_character_settings||
(g.b4w_character_settings.waterline=0)):(g.b4w_character_settings=null,b("object",g,"b4w_character_settings"));"b4w_selectable"in g||(g.b4w_selectable=!1,b("object",g,"b4w_selectable"));"b4w_outlining"in g||(g.b4w_outlining=!1,b("object",g,"b4w_outlining"));"b4w_outline_on_select"in g||(g.b4w_outline_on_select=!1,b("object",g,"b4w_outline_on_select"));"b4w_billboard"in g||(g.b4w_billboard=!1,b("object",g,"b4w_billboard"));"b4w_billboard_geometry"in g||(g.b4w_billboard_geometry="SPHERICAL",b("object",
g,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in g||(g.b4w_pres_glob_orientation=!1,b("object",g,"b4w_pres_glob_orientation"));"b4w_outline_settings"in g||("b4w_glow_settings"in g?g.b4w_outline_settings=g.b4w_glow_settings:(g.b4w_outline_settings={},g.b4w_outline_settings.outline_duration=1,g.b4w_outline_settings.outline_period=1,g.b4w_outline_settings.outline_relapses=0),b("object",g,"b4w_outline_settings"));"b4w_lod_transition"in g||(g.b4w_lod_transition=.01,b("object",g,"b4w_lod_transition"));
"lod_levels"in g||(g.lod_levels=[],b("object",g,"lod_levels"));"b4w_animation_mixing"in g||(g.b4w_animation_mixing=!1,b("object",g,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in g||(g.b4w_anchor=null,b("object",g,"b4w_anchor")),!g.b4w_anchor||"max_width"in g.b4w_anchor||(g.b4w_anchor.max_width=250)}"collision_margin"in g.game||(g.game.collision_margin=.04,b("object",g,"collision_margin"));"b4w_anim_behavior"in g||(g.b4w_anim_behavior=g.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
g,"b4w_anim_behavior"));if(!("rotation_quaternion"in g)){h=[0,0,0,1];v.Wj(g.rotation_euler,h);var c=h,d=h[0],n=h[1],t=h[2];c[0]=h[3];c[1]=d;c[2]=n;c[3]=t;g.rotation_quaternion=h;b("object",g,"rotation_quaternion")}"webgl_do_not_batch"in g&&(g.b4w_do_not_batch=g.webgl_do_not_batch)&&y("object",g,"webgl_do_not_batch");"b4w_shadow_cast_only"in g||(g.b4w_shadow_cast_only=!1,b("object",g,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in g||(g.b4w_correct_bounding_offset="AUTO",b("object",g,"b4w_correct_bounding_offset"));
c=g.particle_systems;for(h=0;h<c.length;h++)d=c[h],n=d.settings,"use_rotation_dupli"in n||(n.use_rotation_dupli=!1,b("particle_settings",n,"use_rotation_dupli")),"use_whole_group"in n||(n.use_whole_group=!1,b("particle_settings",n,"use_whole_group")),d.transforms||(d.transforms=new Float32Array,b("particle_system",d,"transforms")),"b4w_billboard_align"in n||(n.b4w_billboard_align="VIEW",b("particle_settings",n,"b4w_billboard_align")),"b4w_dynamic_grass"in n||(n.b4w_dynamic_grass=!1,b("object",n,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in n||(n.b4w_dynamic_grass_scale_threshold=.01,b("object",n,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in n||(n.b4w_initial_rand_rotation=!1,b("particle_settings",n,"b4w_initial_rand_rotation")),"b4w_rotation_type"in n||(n.b4w_rotation_type="Z",b("particle_settings",n,"b4w_rotation_type")),"b4w_rand_rotation_strength"in n||(n.b4w_rand_rotation_strength=1,b("particle_settings",n,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in n||(n.b4w_hair_billboard=
!1,b("particle_settings",n,"b4w_hair_billboard")),"b4w_hair_billboard_type"in n||(n.b4w_hair_billboard_type="BASIC",b("particle_settings",n,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in n||(n.b4w_hair_billboard_jitter_amp=0,b("particle_settings",n,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in n||(n.b4w_hair_billboard_jitter_freq=0,b("particle_settings",n,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in n||(n.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",n,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in n||(n.b4w_wind_bend_inheritance="PARENT",b("particle_settings",n,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in n||(n.b4w_shadow_inheritance="PARENT",b("particle_settings",n,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in n||(n.b4w_reflection_inheritance="PARENT",b("particle_settings",n,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in n||(n.b4w_vcol_from_name="",b("particle_settings",n,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in n||(n.b4w_vcol_to_name="",b("particle_settings",n,"b4w_vcol_to_name")),"b4w_coordinate_system"in n||(n.b4w_coordinate_system="LOCAL",b("particle_settings",n,"b4w_coordinate_system")),"b4w_allow_nla"in n||(n.b4w_allow_nla=!0,b("particle_settings",n,"b4w_allow_nla")),"b4w_enable_soft_particles"in n||(n.b4w_enable_soft_particles=!1,b("particle_settings",n,"b4w_enable_soft_particles")),"b4w_particles_softness"in n||(n.b4w_particles_softness=1,b("particle_settings",n,"b4w_particles_softness")),
"billboard_tilt"in n||(n.billboard_tilt=0,b("particle_settings",n,"billboard_tilt")),"billboard_tilt_random"in n||(n.billboard_tilt_random=0,b("particle_settings",n,"billboard_tilt_random")),"use_rotations"in n||(n.use_rotations=!1,b("particle_settings",n,"use_rotations"));"constraints"in g||(g.constraints=[],b("object",g,"constraints"));c=g.modifiers;for(h=0;h<c.length;h++){a:{d=c[h];switch(d.type){case "ARRAY":if(!("fit_type"in d)){l.error("WARNING Incomplete modifier "+String(d.type)+' for "'+
g.name+'", reexport "'+a.b4w_filepath_blend+'" scene');d=!1;break a}}d=!0}d||(c.splice(h,1),h--)}"animation_data"in g||(g.animation_data={action:null,nla_tracks:[]},b("object",g,"animation_data"));g.animation_data&&("action"in g.animation_data||(g.animation_data.action=null,r("no action in animation data "+g.name)),"nla_tracks"in g.animation_data||(g.animation_data.nla_tracks=[],r("no NLA in animation data "+g.name)),e(g.animation_data));"b4w_collision_id"in g||(g.b4w_collision_id="",b("object",g,
"b4w_collision_id"));"b4w_viewport_alignment"in g||(g.b4w_viewport_alignment=null,b("object",g,"b4w_viewport_alignment"));"pinverse_tsr"in g||(g.pinverse_tsr=null,b("object",g,"pinverse_tsr"));"b4w_cluster_data"in g||(g.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",g,"b4w_cluster_data"));"pass_index"in g||(g.pass_index=0,b("object",g,"pass_index"));(0>g.scale[0]||0>g.scale[1]||0>g.scale[2])&&r('negative scale for object "'+g.name+'", can lead to some errors');h=
g.scale;0==h[0]&&0==h[1]&&0==h[2]?h=!0:(c=Math.abs((h[1]-h[2])/h[1]),h=.005>Math.abs((h[0]-h[1])/h[0])&&.005>c);h||r("non-uniform scale for object "+g.name)}for(var w in D)f=D[w],h=w.match(/.*?(?=>>|$)/i)[0],l.warn('Property "'+String(h)+'" is '+f.cL+' for "'+f.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.DR=function(a,b){"num_channels"in a||(a.num_channels=1,r('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.HQ=function(a){var b;a:{b=
a.modifiers;for(var d=0;d<b.length;d++){var e=b[d].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;b=A(a.data,a.data.name+"_MOD");a=a.modifiers;for(d=0;d<a.length;d++){var h=a[d];switch(h.type){case "ARRAY":for(var e=b,l=h,g=0,p=0,r=0,y=new Float32Array(16),h=[],D=1;D<l.count;D++){l.use_constant_offset&&(g+=l.constant_offset_displace[0],p+=l.constant_offset_displace[1],r+=l.constant_offset_displace[2]);if(l.use_relative_offset)var F=e.b4w_bounding_box,g=g+(F.max_x-F.min_x)*l.relative_offset_displace[0],
p=p+(F.max_y-F.min_y)*l.relative_offset_displace[1],r=r+(F.max_z-F.min_z)*l.relative_offset_displace[2];v.IZ(g,p,r,y);for(var K=F=A(e),N=y,G=B.fromMat4(N,R),G=f.fromMat3(G,L),u=0;u<K.submeshes.length;u++){var Q=K.submeshes[u];v.xo(Q.position,N,Q.position,0);v.UK(Q.tbn_quat,G,Q.tbn_quat,0)}h.push(F)}for(D=0;D<h.length;D++)for(l=e,g=h[D],p=0;p<l.submeshes.length;p++){r=l.submeshes[p];y=g.submeshes[p];F=r.base_length;K=r.indices.length;r.base_length+=y.base_length;for(var Z in r)if("base_length"!=Z&&
"boundings"!=Z)if("indices"==Z)for(r[Z]=v.RZ(r[Z],y[Z]),N=K;N<r.indices.length;N++)r.indices[N]+=F;else"vertex_colors"!=Z&&(r[Z]=v.nU(r[Z],y[Z]))}break;case "CURVE":for(e=b,D=w.LS(h.object),l=new Float32Array(16),p=D.ek?4:3,g=new Float32Array(p),p=new Float32Array(p),r=new Float32Array(3),y=new Float32Array(4),F=new Float32Array(4),K=new Float32Array(3),N=new Float32Array(3),G=new Float32Array(3),new Float32Array(4),new Float32Array(4),u=0;u<e.submeshes.length;u++){var E=e.submeshes[u],Q=E.position,
E=E.tbn_quat,ca;a:{ca=h.deform_axis;switch(ca){case "POS_X":case "NEG_X":ca=0;break a;case "POS_Y":case "NEG_Y":ca=1;break a;case "POS_Z":case "NEG_Z":ca=2;break a;default:v.q("Wrong deform axis value "+ca)}ca=void 0}K[0]=0;K[1]=0;K[2]=0;K[ca]=1;for(var ha=w.lZ(D),q=0;q<Q.length/3;q++){G[0]=Q[3*q];G[1]=Q[3*q+1];G[2]=Q[3*q+2];var S=G[ca],X=w.kZ(D,S);w.mZ(D,X,g);r[0]=g[0];r[1]=g[1];r[2]=g[2];w.jZ(D,X,p);N[0]=p[0];N[1]=0;N[2]=p[2];c.normalize(N,N);f.rotationTo(K,N,y);0>S?(g[0]=N[0],g[1]=N[1],g[2]=N[2],
c.scale(g,S,g),c.add(r,g,r)):S>ha&&(g[0]=N[0],g[1]=N[1],g[2]=N[2],c.scale(g,S-ha,g),c.add(r,g,r));n.fromRotationTranslation(y,r,l);D.ek&&(f.setAxisAngle(K,g[3],F),c.transformQuat(G,F,G));G[ca]=0;c.transformMat4(G,l,G);Q[3*q]=G[0];Q[3*q+1]=G[1];Q[3*q+2]=G[2];E.length&&(L[0]=E[4*q],L[1]=E[4*q+1],L[2]=E[4*q+2],L[3]=E[4*q+3],f.multiply(L,y,L),E[4*q]=L[0],E[4*q+1]=L[1],E[4*q+2]=L[2],E[4*q+3]=L[3])}}}k.DX(b)}return b};a.AS=function(){return{name:"DEFAULT",uuid:v.XA(),use_nodes:!1,diffuse_shader:"LAMBERT",
diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,
.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,
1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.OQ=function(a,b){function c(b,d){for(var f in b){var e=b[f],g=e[0];if(1<e.length)for(var k=1;k<e.length;k++)g+="*"+e[k];for(k=0;k<a.length;k++)if(e=a[k],e.name==g)for(var m in d)e[m]=d[m]}}for(var f=b.b4w_logic_nodes,e=0;e<f.length;e++)for(var k=f[e],g=0;g<k.length;g++){var h=k[g],l={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in l)n in
h&&(h[l[n]]=h[n]);for(var p in h.variables)"boolean"!=typeof h.variables[p][0]&&(h.variables[p]=[!1,h.variables[p]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(h.type)&&("variable1"in h&&(h.variables.v1=[!1,h.variable1]),"variable2"in h&&(h.variables.v2=[!1,h.variable2]),"variabled"in h&&(h.variables.vd=[!1,h.variabled]));switch(h.type){case "SELECT":for(var w=0;w<a.length;w++)l=a[w],l.name==h.object&&(l.b4w_selectable=!0);h.bools||(h.bools={});h.bools.not_wait||(h.bools.not_wait=!1);r('Logic nodes type "SELECT" is deprecated');
break;case "SWITCH_SELECT":c(h.objects_paths,{b4w_selectable:!0});if(h.links instanceof Array){r('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var l={},v=0;for(w in h.objects_paths)l[w]=h.links[v],v++;h.links=l}break;case "SELECT_PLAY":r('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');h.mute=!0;break;case "SELECT_PLAY_ANIM":r('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');
break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(h.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(h.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(h.objects_paths,{b4w_do_not_batch:!0});switch(h.common_usage_names.space_type){case "WORLD":h.common_usage_names.space_type=Q.RO;break;case "PARENT":h.common_usage_names.space_type=Q.QO;break;case "LOCAL":h.common_usage_names.space_type=Q.PO}break;case "OUTLINE":c(h.objects_paths,
{b4w_outlining:!0});break;case "CONDJUMP":h.condition&&(h.common_usage_names.condition=h.condition);if("cnd"in h.floats)h.common_usage_names.condition=h.floats.cnd;else switch(h.common_usage_names.condition){case "GEQUAL":h.common_usage_names.condition=Q.NE;break;case "LEQUAL":h.common_usage_names.condition=Q.PE;break;case "GREATER":h.common_usage_names.condition=Q.OE;break;case "LESS":h.common_usage_names.condition=Q.QE;break;case "NOTEQUAL":h.common_usage_names.condition=Q.RE;break;case "EQUAL":h.common_usage_names.condition=
Q.ME}void 0!=h.number1&&(h.input1=h.number1);void 0!=h.number2&&(h.input2=h.number2);h.bools||(h.bools={});void 0===h.bools.str&&(h.bools.str=!1,h.floats.inp1=h.input1,h.floats.inp2=h.input2);break;case "SEND_REQ":h.bools||(h.bools={});h.strings||(h.strings={});void 0===h.bools.ct&&(h.bools.ct=!1);void 0!=h.url&&(h.bools.url=!1,h.strings.url=h.url);break;case "MATH":void 0!=h.number1&&(h.input1=h.number1);void 0!=h.number2&&(h.input2=h.number2);void 0!=h.input1&&(h.floats.inp1=h.input1);void 0!=h.input2&&
(h.floats.inp2=h.input2);break;case "REGSTORE":h.floats||(h.floats={});h.strings||(h.strings={});void 0!=h.number1&&(h.input1=h.number1);if(void 0!=h.input1)switch(typeof h.input1){case "number":h.floats.inp1=h.input1;h.common_usage_names.variable_type="NUMBER";break;default:h.strings.inp1=h.input1,h.common_usage_names.variable_type="STRING"}switch(h.common_usage_names.variable_type){case "NUMBER":h.common_usage_names.variable_type=Q.SO;break;case "STRING":h.common_usage_names.variable_type=Q.TO}break;
case "PAGEPARAM":h.bools||(h.bools={});void 0===h.bools.hsh&&(h.bools.hsh=!1);h.floats||(h.floats={});void 0===h.floats.ptp&&(h.floats.ptp=0);break;case "PLAY_ANIM":c(h.objects_paths,{b4w_do_not_batch:!0});h.bools||(h.bools={});void 0===h.bools.env&&(h.bools.env=!1);(l=h.common_usage_names.param_anim_behavior)||(l="FINISH_STOP");h.common_usage_names.param_anim_behavior=K.qz(l);break;case "STOP_ANIM":h.bools||(h.bools={});void 0===h.bools.env&&(h.bools.env=!1);break;case "STRING":switch(h.common_usage_names.string_operation){case "JOIN":h.common_usage_names.string_operation=
Q.MO;break;case "FIND":h.common_usage_names.string_operation=Q.LO;break;case "REPLACE":h.common_usage_names.string_operation=Q.NO;break;case "SPLIT":h.common_usage_names.string_operation=Q.OO;break;case "COMPARE":h.common_usage_names.string_operation=Q.KO}if("cnd"in h.floats)h.common_usage_names.condition=h.floats.cnd;else switch(h.common_usage_names.condition){case "GEQUAL":h.common_usage_names.condition=Q.NE;break;case "LEQUAL":h.common_usage_names.condition=Q.PE;break;case "GREATER":h.common_usage_names.condition=
Q.OE;break;case "LESS":h.common_usage_names.condition=Q.QE;break;case "NOTEQUAL":h.common_usage_names.condition=Q.RE;break;case "EQUAL":h.common_usage_names.condition=Q.ME}break;case "REDIRECT":void 0!=h.url&&(h.bools.url=!1,h.strings.url=h.url);break;case "SET_CAMERA_MOVE_STYLE":switch(h.common_usage_names.camera_move_style){case "STATIC":h.common_usage_names.camera_move_style=Q.DO;break;case "TARGET":h.common_usage_names.camera_move_style=Q.EO;break;case "EYE":h.common_usage_names.camera_move_style=
Q.BO;break;case "HOVER":h.common_usage_names.camera_move_style=Q.CO}break;case "ENTRYPOINT":h.bools||(h.bools={});void 0===h.bools.js&&(h.bools.js=!1);h.bools.js&&(h.mute=!0);break;case "JS_CALLBACK":for(n in h=h.common_usage_names.js_cb_params,h)switch(h[n]){case "OBJECT":h[n]=Q.FO;break;case "VARIABLE":h[n]=Q.GO}}}}};b4w.module.fps=function(a,h){function p(a,b,c){var d=R.Qh();K.Tl(d,b,c);a&&(b=K.fm(d,Z),D.Hk(a,b[0],b[1]))}function e(a,b,c,d){if(.01<Math.abs(J[0])||.01<Math.abs(J[1]))c=G.Zd(a,b,0),b=L.mc(J[0],0,c,.2*F),c=L.mc(J[1],0,c,.2*F),J[0]-=b,J[1]-=c,d(a,-b*T,-c*T)}function b(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function y(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function r(a,b){if(y(a)&&!I.Zf()){var c=G.nA(a),f=u?u:G.oA(a);u=f;G.Y(b,"FPS_PLOCK",G.Qa,[c,f],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=G.$e(a,b,0),p(a,-b.coords[0]*T,-b.coords[1]*T))});G.Y(null,"FPS_ACTIVATE_PLOCK",G.mn,[f],function(a){return a[0]},function(b,c,d){0<d?ga.LA&&ga.LA(a):ga.GA&&ga.GA(a)})}else{if(I.Zf())var c=
G.Nq("XY",a),f=G.yu(a),g=4;else{var c=G.Il("XY",a),f=G.En(a),g=2,k=R.Qh(),m=G.Rj(),h=G.Ii(d.Bp),l=G.Ii(d.Cp);G.Y(b,"FPS_CAM_ROT",G.Qa,[m,h,l],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=G.Zd(a,b,0);c=G.Zd(a,b,1);var f=G.Zd(a,b,2);b=2.5*d;f=.05>Math.abs(f)?0:f;d=K.em(k,Z);f=d[1]-f*b;c=-(.05>Math.abs(c)?0:c)*b;f=L.U(f,t,da);K.Tl(k,c,f,!1,!0);D.Hk(a,d[0]+c+Math.PI,0)}})}var n=0,r=0;G.Y(null,"FPS_DRAG_PRESS",G.vf,[f],function(a){return a[0]},function(a,b,c){1==
c&&(a=G.$e(a,b,0).coords,n=a[0],r=a[1])});G.Y(null,"FPS_DRAG_MOVE",G.Qa,[c,f],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=G.$e(a,b,0).coords,J[0]+=(a[0]-n)*g,J[1]+=(a[1]-r)*g,n=a[0],r=a[1])});c=G.Rj();G.Y(b,"FPS_SMOOTH_DRAG",G.Qa,[c],null,e,p)}}function A(a){g.OT(g.SN);a.addEventListener("mousedown",function(){d.RX()},!1)}function k(a){var b=G.Rj(),c=R.Qh();G.Y(a,"FPS_CHARECTER_VR_ROT",G.Qa,[b],null,function(a){var b=K.fm(c,Z)[0];D.Hk(a,b,0)})}function w(){var a=g.JR()&&!I.Zf(),b=d.ga(d.xd);
b&&(a=a&&d.im(b,d.hl)==d.Ep);return a}function n(a,f,e){function g(a){a=0<a?1:a;n=-(0>a?-1:a);a=p+r;var b=l+n;D.Pm(f,a,b);e&&e(a,b);m(a,b)}function k(a){a=0<a?1:a;r=-(0>a?-1:a);a=p+r;var b=l+n;D.Pm(f,a,b);e&&e(a,b);m(a,b)}function m(a,b){var d=h.Fn.id;a||b?0==d&&c(h,1):c(h,0)}I.Zf()&&b(a.parentElement?a.parentElement:a);var h=B(f),l=0,n=0,p=0,r=0;a=[G.Zy,d.tt];var t=[G.Yy,d.ut];I.Zf()&&(a.push("B4W_DEFAULT_BTN_1"),t.push("B4W_DEFAULT_BTN_2"));Q(1,a,function(a){p=a;a=p+r;var b=l+n;D.Pm(f,a,b);e&&e(a,
b);m(a,b)});Q(1,t,k);Q(1,[G.Xy,d.wt],g);Q(1,[G.Wy,d.vt],function(a){l=a;a=p+r;var b=l+n;D.Pm(f,a,b);e&&e(a,b);m(a,b)});Q(1,[G.yO,d.st],function(a){0<a&&D.Oz(f)});Q(3,[d.zp],g);Q(3,[d.Ap],k);Q(1,[G.xO,d.Dp],function(a){p+r+l+n?0<a?c(h,2):c(h,1):c(h,0)});Q(1,[G.GE],function(a){0<a&&(a=ba.Fn.id,1==a||0==a?c(h,3):c(h,1))})}function l(a,b,c,d){a.M.push({id:b,oz:c,sG:d,rG:null,Lz:null})}function f(a){for(var b=[],c=0;c<a.M;c++){var d=a.M[c].id;if(0<=b.indexOf(d))return;b.push(d)}for(c=0;c<a.M;c++)for(var d=
a.M[c],f=0;f<d.oz.length;f++)if(0>b.indexOf(d.oz[f]))return}function v(a,b){for(var c=null,d=0;d<a.M.length;d++)if(a.M[d].id==b){c=a.M[d];break}return c}function c(a,b){if(!a.xW){var c=a.Fn,d=c.id;if(0<=c.oz.indexOf(b)){var f=!0;c.rG&&(f=c.rG(d,b));f&&(a.Fn=v(a,b),c.sG&&c.sG(d,b),c.Lz&&c.Lz(d,b))}}}function B(a){function b(c,d){switch(d){case 0:case 1:D.Gk(a,D.yE);break;case 2:D.Gk(a,D.ON);break;case 3:D.Gk(a,D.Yx);break;case 4:D.Gk(a,D.NN)}}var c=ba={M:[],Fn:null,xW:!1};l(c,0,[1,3,4],b);l(c,1,[2,
3,4,0],b);l(c,2,[1,3,4,0],b);l(c,3,[1],b);l(c,4,[1,2,0],b);f(c);c.Fn=v(c,0);return ba}function Q(a,b,c){function f(){}function e(){return!1}for(var g=[],k=d.BG(),m=0;m<b.length;m++)if("number"==typeof b[m])if(300>b[m])g.push(G.Ic(b[m]));else if(326>b[m])for(var h=0;h<k.length;h++)g.push(G.Kq(b[m],k[h]));else g.push(G.Ii(b[m]));else"string"==typeof b[m]&&((h=document.getElementById(b[m]))?g.push(G.yu(h)):P.error("Couldn't find element with "+b[m]+" ID."));b=G.vf;switch(a){case 1:b=G.mn;e=function(a){for(var b=
0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0<d?c(1):c(0)};break;case 2:b=G.mn;e=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0>d?c(1):c(0)};break;case 3:b=G.Qa,e=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},f=function(a,b,d,f){if(0<d)for(d=0;d<f;d++){var e=G.Zd(a,b,d);if(.05<Math.abs(e)){c(e);break}}else c(0)}}G.Y(null,"FPS_USER_CONTROL_ACTION_"+N.toString(),b,g,e,f,g.length);N++}var K=h("camera"),G=h("controls"),
D=h("physics"),R=h("scenes"),L=h("util"),I=h("main"),z=h("container"),d=h("input"),m=h("transform"),O=h("constraints"),x=h("vec3"),g=h("hmd"),P=h("__print"),t=(-Math.PI+.1)/2,da=(Math.PI-.1)/2,J=new Float32Array(2),F=1,T=4E-4,N=0,ba=null,u=null,ga={LA:null,GA:null},Z=new Float32Array(2),E=new Float32Array(3),ca=new Float32Array(3);new Float32Array(3);a.y0=0;a.z0=1;a.x0=2;a.w0=3;a.v0=4;a.c0=1;a.d0=2;a.b0=3;a.B2=Q;a.NT=function(a,b){var c=null;a=a||R.Wn();c=c||z.gm();if(a){b=b||null;var d=a,f=R.Qh(),
e=m.ie(f,E),g=m.ie(d,ca);x.subtract(e,g,e);O.JF(f,d,e);f=K.fm(f,Z);D.Hk(d,f[0],f[1]);d=c;f=a;w()?(A(d),k(f)):r(d,f);n(c,a,b)}};a.A3=function(a,b){a=a||R.Wn();b=b||z.Ce();if(a){for(var c=0;c<N;c++)G.hf(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;y(b)&&!I.Zf()&&(G.hf(c,"FPS_PLOCK"),G.hf(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!y(b)||I.Zf())G.hf(c,"FPS_CAM_ROT"),G.hf(c,"FPS_DRAG_PRESS"),G.hf(c,"FPS_DRAG_MOVE"),G.hf(c,"FPS_SMOOTH_DRAG");c=a;w()&&G.hf(c,"FPS_CHARECTER_VR_ROT");c=b;if(I.Zf()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),
f=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);f&&c.removeChild(f)}}};a.Z7=function(a,b){v(ba,a).Lz=b};a.W7=function(a){G.jD(a);F=a};a.V7=function(a){T=a/2E5};a.B8=function(a){ga.LA=a};a.A8=function(a){ga.GA=a};a.x4=function(){return ba.Fn.id}};b4w.module.camera=function(a,h){function p(a,b){n.Sb("camera.set_pivot","camera.target_set_trans_pivot");e.Aa(a)?(B.copy(b,a.k.pivot),f.D(a),w.H(a)):n.error("set_pivot(): Wrong object or camera move style")}var e=h("__camera");h("__config");var b=h("__constraints"),y=h("__container"),r=h("__mat4"),A=h("__math"),k=h("__obj_util"),w=h("__physics"),n=h("__print"),l=h("__scenes"),f=h("__transform"),v=h("__tsr"),c=h("__util"),B=h("__vec3"),Q=h("__vec4"),K=h("__quat"),G=new Float32Array(2),D=new Float32Array(3),
R=new Float32Array(3);new Float32Array(4);var L=K.create();new Float32Array(9);var I={},z={};a.Bg=e.Bg;a.Kb=e.Kb;a.nd=e.nd;a.bd=e.bd;a.pZ=function(a){k.xa(a)?(e.ht(a),a.k.vb=e.Bg,f.D(a),w.H(a),e.ao(a)):n.error("static_setup(): Wrong camera object")};a.i9=function(a,b,c){e.tm(a)?(b=b||v.G(a.k.n),c?e.gD(a,b,c):f.Wc(a,b),f.D(a),w.H(a)):n.error("static_set_look_at(): Wrong camera object or camera move style")};a.j9=function(a,b){e.tm(a)?(f.gi(a,b),f.D(a),w.H(a)):n.error("static_set_rotation(): Wrong camera object or camera move style")};
a.h9=function(a,b){if(!e.tm(a))return n.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return f.Sh(a,b)};a.eU=function(a){k.xa(a)?(e.ht(a),a.k.vb=e.nd,f.D(a),w.H(a),e.ao(a)):n.error("eye_setup(): Wrong camera object")};a.Y3=function(a,c,k){e.ic(a)?(c=c||v.G(a.k.n),k?e.yY(a,c,k):f.Wc(a,c),b.Qj(a,a.k.pf,!0),f.D(a),w.H(a)):n.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Tl=function(a,b,c,k,g){e.ic(a)?(e.us(a,b,c,k||!1,
g||!1),f.D(a),w.H(a)):n.error("eye_rotate(): Wrong camera object or camera move style")};a.dU=function(a,b){e.ic(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(e.RL(a,b),f.D(a),w.H(a)):n.error("eye_set_vertical_limits(): Incorrect limits object."):n.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.X3=function(a,b,c){if(!e.ic(a))return n.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.la?(b=b||{},c?(b.down=a.la.Ln,
b.up=a.la.fp):(b.down=a.la.down,b.up=a.la.up),b.camera_space=c||!1,b):null};a.cU=function(a,b){e.ic(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(e.FL(a,b),f.D(a),w.H(a)):n.error("eye_set_horizontal_limits(): Incorrect limits object."):n.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.W3=function(a,b,c){if(!e.ic(a))return n.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.mb?(b=b||{},c?(b.left=a.mb.jo,
b.right=a.mb.Do):(b.left=a.mb.left,b.right=a.mb.right),b.camera_space=c||!1,b):null};a.DZ=function(a){if(k.xa(a))if(!(void 0).horiz_rot_lim||"number"==typeof(void 0).horiz_rot_lim.left&&"number"==typeof(void 0).horiz_rot_lim.right)if(!(void 0).vert_rot_lim||"number"==typeof(void 0).vert_rot_lim.down&&"number"==typeof(void 0).vert_rot_lim.up){if((void 0).dist_lim){if("number"!=typeof(void 0).dist_lim.min||"number"!=typeof(void 0).dist_lim.max||(void 0).dist_lim.min>(void 0).dist_lim.max){n.error("target_setup(): Wrong distance limits object");
return}(void 0).dist_lim.min=Math.max((void 0).dist_lim.min,0);(void 0).dist_lim.max=Math.max((void 0).dist_lim.max,0)}(void 0).gs&&("number"!=typeof(void 0).gs.min_y||"number"!=typeof(void 0).gs.max_y||(void 0).gs.min_y>(void 0).gs.max_y)?n.error("target_setup(): Wrong pivot limits object"):(e.ht(a),a.k.vb=e.Kb,e.WL(a,(void 0).pos||v.G(a.k.n),(void 0).pivot,(void 0).horiz_rot_lim,(void 0).vert_rot_lim,(void 0).dist_lim,(void 0).gs,(void 0).use_panning||!1),f.D(a),w.H(a),e.ao(a))}else n.error("target_setup(): Wrong vertical limits object");
else n.error("target_setup(): Wrong horizontal limits object");else n.error("target_setup(): Wrong camera object")};a.Ps=function(a,b,c){var k,g;e.Aa(a)?(e.Kw(a,b,c,k||!1,g||!1),f.D(a),w.H(a)):n.error("target_rotate(): Wrong camera object or camera move style")};a.s9=function(a,b,c){e.Aa(a)?(b=b||v.G(a.k.n),c=c||a.k.pivot,e.Ds(a,b,c),f.D(a),w.H(a)):n.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.r9=function(a,b){e.Aa(a)?(e.GY(a,b),f.D(a),w.H(a)):n.error("target_set_pivot_translation(): Wrong camera object or camera move style")};
a.AZ=function(a,b){if(e.Aa(a)){var c=f.ro(a,a.k.pivot),k=Math.max(0,b);f.fh(a,0,0,k-c);f.D(a);w.H(a)}else n.error("target_set_distance(): Wrong camera object or camera move style")};a.KD=function(a){return e.Aa(a)?f.ro(a,a.k.pivot):(n.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.u9=function(a,b){if(e.Aa(a)){var c=f.cv(b,!1,D),h=f.dv(b),g=l.A(),g=k.ka(a,g).da[0],g=e.fI(g)/2,h=h/Math.sin(g),g=f.ro(a,c);e.Ds(a,v.G(a.k.n),c);f.D(a);f.fh(a,0,0,h-g);f.D(a);w.H(a)}else n.error("target_zoom_object(): Wrong camera object or camera move style")};
a.yZ=function(a,b){if(!e.Aa(a))return n.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);B.copy(a.k.pivot,b);return b};a.HM=function(a,b){if(e.Aa(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){n.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}e.mY(a,b);f.D(a);w.H(a)}else n.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.m9=
function(a,b){if(!e.Aa(a))return n.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.tb?(b=b||{},b.min=c.tb.min,b.max=c.tb.max,b):null};a.CZ=function(a,b){e.Aa(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(e.RL(a,b),f.D(a),w.H(a)):n.error("target_set_vertical_limits(): Wrong limits object"):n.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.p9=function(a,b,c){if(!e.Aa(a))return n.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.la?(b=b||{},c?(b.down=a.la.Ln,b.up=a.la.fp):(b.down=a.la.down,b.up=a.la.up),b.camera_space=c||!1,b):null};a.BZ=function(a,b){e.Aa(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(e.FL(a,b),f.D(a),w.H(a)):n.error("target_set_horizontal_limits(): Wrong limits object"):n.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.n9=function(a,b,c){if(!e.Aa(a))return n.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.mb?(b=b||{},c?(b.left=a.mb.jo,b.right=a.mb.Do):(b.left=a.mb.left,b.right=a.mb.right),b.camera_space=c||!1,b):null};a.q9=function(a,b){e.Aa(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?n.error("target_set_pivot_limits(): Wrong limits object"):(e.CY(a,b),f.D(a),w.H(a)):n.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.o9=function(a,b){if(!e.Aa(a))return n.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.ce?(b=b||{},b.min_z=c.ce.min_z,b.max_z=c.ce.max_z,b):null};a.zZ=function(a,b,c){if(e.Aa(a)){var k=a.k;k.use_panning&&(D[0]=b,D[1]=-c,D[2]=0,v.wd(D,k.n,D),B.add(k.pivot,D,k.pivot),b=v.G(k.n),B.add(b,D,b),f.D(a),w.H(a))}else n.error("target_pan_pivot(): wrong object")};a.t9=function(a,b){if(!e.Aa(a))return n.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.x6=function(b,k){a.uJ(b,{pos:k.pos,pivot:k.pivot});var h="undefined"==
typeof k.dist_interval?0:Math.max(k.dist_interval,0),l="undefined"==typeof k.angle_interval?0:Math.max(k.angle_interval,0),g="undefined"==typeof k.t?.5:c.U(k.t,0,1),n=a.rJ(b,I);n.min=Math.max(n.min-g*h,0);n.max+=(1-g)*h;h=a.sJ(b,z);h.down=c.U(h.down+g*l,-Math.PI/2,0);h.up=c.U(h.up-(1-g)*l,-Math.PI/2,0);e.yv(b,n);e.zv(b,h);f.D(b);w.H(b);e.ao(b)};a.uJ=function(a,b){if(k.xa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){n.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up)?n.error("hover_setup(): Wrong hover angle limits object"):b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max)?n.error("hover_setup(): Wrong horizontal translation limits object"):
b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max)?n.error("hover_setup(): Wrong vertical translation limits object"):(e.ht(a),a.k.vb=e.bd,e.VL(a,b.pos||v.G(a.k.n),b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1),f.D(a),w.H(a),e.ao(a))}else n.error("hover_setup(): Wrong camera object")};a.tJ=function(a,b,c){var k,g;e.$a(a)?(e.vs(a,b,c,k||!1,g||!1),f.D(a),w.H(a)):
n.error("hover_rotate(): Wrong camera object or camera move style")};a.w6=function(a,b){e.$a(a)?(e.Uw(a,b),f.D(a),w.H(a)):n.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.u6=function(a,b){if(!e.$a(a))return n.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);B.copy(a.k.Vb,b);return b};a.DV=function(a){return e.$a(a)?f.ro(a,a.k.Vb):(n.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.zv=
function(a,b){e.$a(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?n.error("hover_set_vertical_limits(): Wrong limits object"):(e.zv(a,b),f.D(a),w.H(a)):n.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.sJ=function(a,b){if(!e.$a(a))return n.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var c=a.k;b=b||{};b.down=c.la.down;b.up=c.la.up;return b};a.yv=function(a,b){e.$a(a)?"number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max?n.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),e.yv(a,b),f.D(a),w.H(a)):n.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.rJ=function(a,b){if(!e.$a(a))return n.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var c=a.k;b=b||{};b.min=c.tb.min;b.max=c.tb.max;return b};a.FV=function(a,b){e.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?
n.error("hover_set_vert_trans_limits(): Wrong limits object"):(e.MY(a,b),f.D(a),w.H(a)):n.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.v6=function(a,b){if(!e.$a(a))return n.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.Cc?(b=b||{},b.min=c.Cc.min,b.max=c.Cc.max,b):null};a.EV=function(a,b){e.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?n.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(e.sY(a,b),f.D(a),w.H(a)):n.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.t6=function(a,b){if(!e.$a(a))return n.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.Bc?(b=b||{},b.min=c.Bc.min,b.max=c.Bc.max,b):null};a.y6=function(a,b){if(!e.$a(a))return n.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Nh=b};a.tm=e.tm;a.Aa=e.Aa;a.ic=e.ic;a.$a=e.$a;a.hD=function(a,b){if(!k.xa(a))return n.error("set_move_style(): Wrong camera object"),
!1;if(b!=e.Bg&&b!=e.nd&&b!=e.Kb&&b!=e.bd)return n.error("set_move_style(): Wrong move style"),!1;e.hD(a,b);f.D(a);w.H(a);return!0};a.hm=function(a){return k.xa(a)?e.hm(a):(n.error("get_move_style(): Wrong camera object"),null)};a.Wc=function(a,b){if(k.xa(a)){var c=a.k;if(e.Aa(a)){var h=v.G(c.n),h=B.subtract(b,h,D);B.add(h,c.pivot,c.pivot)}else e.$a(a)&&(h=v.G(c.n),h=B.subtract(b,h,D),B.add(h,c.Vb,c.Vb));f.Wc(a,b);f.D(a);w.H(a)}else n.error("set_translation(): Wrong camera object")};a.ie=function(a,
b){if(!k.xa(a))return n.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return f.ie(a,b)};a.M7=function(a,b,c,h,g){k.xa(a)?(h=h||!1,g=g||!1,e.Aa(a)?e.Kw(a,b,c,h,g):e.ic(a)?e.us(a,b,c,h,g):e.$a(a)?e.vs(a,b,c,h,g):e.tm(a)?n.warn("rotate_camera(): not supported for STATIC cameras"):n.error("rotate_camera(): Wrong camera move style"),f.D(a),w.H(a)):n.error("rotate_camera(): Wrong camera object")};a.KY=function(a,b){if(k.xa(a)){var f=a.k;"number"==typeof b.trans&&(f.$k=c.U(b.trans,
0,Infinity));"number"==typeof b.rot&&(f.Zk=c.U(b.rot,0,Infinity));"number"==typeof b.zoom&&(f.al=c.U(b.zoom,0,.99))}else n.error("set_velocities(): Wrong camera object")};a.Th=function(a,b){if(!k.xa(a))return n.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.$k;b.rot=c.Zk;b.zoom=c.al;return b};a.J6=function(a){return k.xa(a)?0<=c.lc(v.P(a.k.n),c.Nc,D)[1]:(n.error("is_look_up(): Wrong camera object"),!1)};a.em=function(a,b){if(!k.xa(a))return n.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);e.em(a,b);return b};a.fm=function(a,b){if(!k.xa(a))return n.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);e.fm(a,b);return b};a.s4=function(a,b){b=b||new Float32Array(2);var f=B.normalize(a,D),f=c.YC(c.Nc,f,L);c.dA(f,!0);e.cB(f,b);return b};a.OL=function(a,b){if(k.xa(a))for(var c=l.A(),c=k.ka(a,c).da,f=0;f<c.length;f++){var g=c[f];g.type!=e.Qc&&g.type!=e.dd&&g.type!=e.Pe&&g.type!=e.Qe||e.FY(g,b,g.mf)}else n.error("set_stereo_distance(): Wrong camera object")};
a.XI=function(a){if(!k.xa(a))return n.error("get_stereo_distance(): Wrong camera object"),0;var b=l.A();a=k.ka(a,b).da;for(b=0;b<a.length;b++){var c=a[b];if(c.type==e.Qc||c.type==e.dd)return c.Ok}return 0};a.bD=function(a,b){if(k.xa(a)){var c=l.A(),c=k.ka(a,c).da;e.bD(c,b)}else n.error("set_eye_distance(): Wrong camera object")};a.I4=function(a){if(!k.xa(a))return n.error("get_eye_distance(): Wrong camera object"),0;var b=l.A();a=k.ka(a,b).da;for(b=0;b<a.length;b++){var c=a[b];if(c.type==e.Qc||c.type==
e.dd||c.type==e.Pe||c.type==e.Qe)return c.mf}return 0};a.oD=function(a,b){k.xa(a)?(B.copy(b,a.k.pf),f.D(a),w.H(a)):n.error("set_vertical_axis(): Wrong camera object")};a.sV=function(a,b){if(k.xa(a))return b||(b=B.create()),B.copy(a.k.pf,b),b;n.error("get_vertical_axis(): Wrong camera object")};a.A9=function(a,b,c,f){if(k.xa(a)){var g=l.A();a=k.ka(a,g).da;for(g=0;g<a.length;g++){var h=a[g];h.rc||e.Ik(h,h.Ab);var p=D;p[0]=-b;p[1]=-c;p[2]=0;r.translate(h.xb,p,h.xb);r.rotateZ(h.xb,f,h.xb);e.qG(h);e.Jz(h)}}else n.error("translate_view(): Wrong camera object")};
a.W5=function(a,b){if(!k.xa(a))return n.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);c.lc(v.P(a.k.n),c.Nc,b);return b};a.aV=function(a){if(!k.xa(a))return n.error("get_fov(): Wrong camera object"),0;var b=l.A();a=k.ka(a,b).da;return c.Cb(a[0].Vd)};a.j8=function(a,b){if(k.xa(a))for(var f=l.A(),f=k.ka(a,f).da,h=0;h<f.length;h++){var g=f[h];g.Vd=c.oe(b);g.rc||e.Ik(g,g.Ab);e.qG(g);e.Jz(g)}else n.error("set_fov(): Wrong camera object")};a.fD=function(a,b,c){var f;if(!(f=
k.xa(a)))a:{if(k.xa(a)){f=l.A();f=k.ka(a,f).da;for(var g=0;g<f.length;g++){var h=f[g];if(h.type==e.Pe||h.type==e.Qe){f=!0;break a}}}else n.error("is_hmd_camera(): Wrong camera object");f=!1}f?b&&c&&e.fD(a,b,c):n.error("set_hmd_fov(): Wrong camera object")};a.Qj=function(a,c,e){k.xa(a)?(c=c||a.k.pf,b.Qj(a,c,e||!1),f.D(a),w.H(a)):n.error("correct_up(): Wrong camera object")};a.y8=function(a,b){if(k.xa(a)&&e.Lv(a)){var c=a.k;if(e.Aa(a)){var f=v.G(c.n),f=B.dist(f,c.pivot);c.dk=b/2*c.ck/f}else e.$a(a)?
(f=v.G(c.n),f=B.distance(f,c.Vb),c.dk=b/2*c.ck/f):(c=l.A(),k.ka(a,c).da[0].top=b/2);e.p_(a)}else n.error("set_ortho_scale(): Wrong camera object")};a.p5=function(a){if(!k.xa(a)||!e.Lv(a))return n.error("get_ortho_scale(): Wrong camera object"),0;var b=l.A();return 2*k.ka(a,b).da[0].top};a.Lv=function(a){return k.xa(a)?e.Lv(a):(n.error("is_ortho_camera(): Wrong camera object"),!1)};a.D2=function(a,b,h,p){if(!k.xa(a))return n.error("calc_ray(): Wrong camera object"),null;var g=l.A(),r=k.ka(a,g).da[0];
p&&3==p.length?n.O('dest parameter in the function "calc_ray" should be type of parametric line.'):p=p||new Float32Array(6);switch(r.type){case e.Od:case e.Ch:case e.Qc:case e.dd:var t=Math.tan(r.Vd*Math.PI/360),w=t*r.Ab,g=D;b=y.ju(b,h,G,r);g[0]=(2*b[0]/r.width-1)*w;g[1]=(1-2*b[1]/r.height)*t;g[2]=-1;v.wd(g,a.k.n,g);B.normalize(g,g);3==p.length?B.copy(g,p):(a=f.ie(a,R),A.JL(p,a),A.iD(p,g));return p;case e.we:return g=D,b=y.ju(b,h,G,r),g[0]=(2*b[0]/r.width-1)*r.top*r.Ab,g[1]=(1-2*b[1]/r.height)*r.top,
g[2]=0,v.Xc(g,a.k.n,g),B.copy(g,p),B.transformQuat(c.Nc,v.P(a.k.n),g),A.iD(p,g),p;default:return n.error("calc_ray(): Non-compatible camera"),p}};a.FC=function(a,b,c){if(!k.xa(a))return n.error("project_point(): Wrong camera object"),null;c=c||new Float32Array(2);return e.FC(a,b,c)};a.d6=function(a){return(e.Aa(a)||e.$a(a))&&null!==a.k.tb};a.n6=function(a){return(e.ic(a)||e.Aa(a)||e.$a(a))&&null!==a.k.la};a.m6=function(a){n.Sb("has_vertical_limits","has_vertical_rot_limits");return e.Aa(a)||e.ic(a)?
null!==a.k.la:(n.error("has_vertical_limits(): Wrong camera object"),!1)};a.g6=function(a){return(e.Aa(a)||e.ic(a))&&null!==a.k.mb};a.f6=function(a){n.Sb("has_horizontal_limits","has_horizontal_rot_limits");return e.Aa(a)||e.ic(a)?null!==a.k.mb:(n.error("has_horizontal_limits(): Wrong camera object"),!1)};a.o6=function(a){return e.$a(a)&&null!==a.k.Cc};a.h6=function(a){return e.$a(a)&&null!==a.k.Bc};a.c7=function(a,b,c){n.Sb("move_pivot","target_pan_pivot");if(e.Aa(a)){var k=a.k;if(k.use_panning){var g=
v.G(k.n),h=B.subtract(g,k.pivot,R);D[0]=b;D[1]=0;D[2]=c;B.scale(D,B.len(h),D);v.wd(D,k.n,D);B.add(k.pivot,D,k.pivot);B.add(g,D,g);f.D(a);w.H(a)}}else n.error("move_pivot(): wrong object")};a.O8=function(a,b){n.Sb("set_velocity_params","set_velocities");if(k.xa(a)){var f=a.k;f.$k=c.U(b[0],0,Infinity);f.Zk=c.U(b[1],0,Infinity);f.al=c.U(b[2],0,.99)}else n.error("set_velocity_params(): Wrong camera object")};a.T5=function(a,b){n.Sb("get_velocity_params","get_velocities");if(!k.xa(a))return n.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var c=a.k;b[0]=c.$k;b[1]=c.Zk;b[2]=c.al;return b};a.b3=function(a){n.O('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');k.xa(a)?e.Aa(a)||e.ic(a)?a.k.mb=null:e.$a(a)&&(a.k.Bc=null):n.error("clear_horizontal_limits(): Wrong camera object")};a.f3=function(a){n.O('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');
k.xa(a)?e.Aa(a)||e.ic(a)?a.k.la=null:e.$a(a)&&(a.k.Cc=null):n.error("clear_vertical_limits(): Wrong camera object")};a.c3=function(){n.O("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.gD=function(a,c,k,h){n.Oh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);h=h||a.k.pf;e.gD(a,c,k);b.Qj(a,h,!0);f.D(a);w.H(a)};a.us=function(a,b,c,k,g){n.Oh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);e.ic(a)?(e.us(a,
b,c,k,g),f.D(a),w.H(a)):n.error("rotate_eye_camera(): wrong object")};a.Kw=function(a,b,c,k,g){n.Oh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);e.Aa(a)?(e.Kw(a,b,c,k,g),f.D(a),w.H(a)):n.error("rotate_target_camera(): wrong object")};a.Ds=function(a,b,c){n.Sb("camera.set_trans_pivot","camera.target_set_trans_pivot");e.Aa(a)?(e.Ds(a,b,c),f.D(a),w.H(a)):n.error("set_trans_pivot(): Wrong object or camera move style")};a.V9=function(a,b){n.Sb("camera.zoom_object","camera.target_zoom_object");
if(e.Aa(a)){f.cv(b,!1,D);p(a,D);f.D(a);var c=f.dv(b),h=l.A(),h=k.ka(a,h).da[0],h=e.fI(h)/2,c=c/Math.sin(h),h=f.ro(a,D);f.fh(a,0,0,c-h);f.D(a);w.H(a)}else n.error("zoom_object(): wrong object")};a.z8=p;a.vs=function(a,b,c,k,g){n.Sb("camera.rotate_hover_camera","camera.hover_rotate");e.$a(a)?(e.vs(a,b,c,k,g),f.D(a),w.H(a)):n.error("rotate_hover_camera(): wrong object")};a.X4=function(a,b){n.Sb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!e.$a(a))return n.error("get_hover_cam_pivot(): wrong object"),
null;b||(b=new Float32Array(3));B.copy(a.k.Vb,b);return b};a.uI=function(a,b){n.Sb("camera.get_eye","camera.get_translation");return k.xa(a)?e.uI(a,b):(n.error("get_eye(): Wrong object"),null)};a.t5=function(a,b){n.Sb("camera.get_pivot","camera.target_get_pivot");if(!e.Aa(a))return n.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));B.copy(a.k.pivot,b);return b};a.s6=function(a,b){n.Sb("camera.hover_cam_set_translation","camera.set_translation");if(e.$a(a)){var c=
a.k,k=B.subtract(b,v.G(c.n),D);B.add(k,c.Vb,c.Vb);f.Wc(a,b);f.D(a);w.H(a)}else n.error("hover_cam_set_translation(): wrong object")};a.Uw=function(a,b){n.Sb("camera.set_hover_pivot","camera.hover_set_pivot_translation");e.$a(a)?(e.Uw(a,b),f.D(a),w.H(a)):n.error("set_hover_pivot(): Wrong object or camera move style")};a.W4=function(a,b){n.Sb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!e.$a(a))return n.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);
b[0]=a.k.la.down;b[1]=a.k.la.up;return b};a.r4=function(a,b){n.Oh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!e.$a(a)&&!e.Aa(a))return n.error("get_cam_dist_limits(): wrong object"),null;if(a.k.tb)b=b||new Float32Array(2),b[0]=a.k.tb.max,b[1]=a.k.tb.min;else return null;return b};a.p2=function(b,c,k,h){n.Oh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);
if(e.Aa(b)){var g=I;g.down=c;g.up=k;g.camera_space=h==f.un;a.CZ(b,g)}else e.ic(b)?(g=I,g.down=c,g.up=k,g.camera_space=h==f.un,a.dU(b,g)):e.$a(b)?(g=I,g.min=c,g.max=k,a.FV(b,g)):n.error("apply_vertical_limits(): wrong object")};a.m2=function(b,c,f){n.Sb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");I.down=c;I.up=f;a.zv(b,I)};a.i2=function(b,c,f){n.Oh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(e.Aa(b)){var k=I;
k.min=c;k.max=f;a.HM(b,k)}else e.$a(b)?(k=I,k.min=c,k.max=f,a.yv(b,k)):n.error("apply_distance_limits(): wrong object")};a.Z2=function(b){n.Sb("camera.clear_distance_limits","camera.target_set_distance_limits");a.HM(b,null)};a.U5=function(a,b){n.Oh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!e.Aa(a)&&!e.ic(a)&&!e.$a(a))return n.error("get_vertical_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);
if(e.ic(a)||e.Aa(a)){if(c.la)return b[0]=c.la.down,b[1]=c.la.up,b}else if(e.$a(a)&&c.Cc)return b[0]=c.Cc.min,b[1]=c.Cc.max,b;return null};a.l2=function(b,c,k,h){n.Oh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(e.Aa(b)){var g=I;g.left=c;g.right=k;g.camera_space=h==f.un;a.BZ(b,g)}else e.ic(b)?(g=I,g.left=c,g.right=k,g.camera_space=h==f.un,a.cU(b,g)):e.$a(b)?(g=I,g.min=c,g.max=k,a.EV(b,g)):n.error("apply_horizontal_limits(): wrong object")};
a.V4=function(a,b){n.Oh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!e.Aa(a)&&!e.ic(a)&&!e.$a(a))return n.error("get_horizontal_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);if(e.ic(a)||e.Aa(a)){if(c.mb)return b[0]=c.mb.left,b[1]=c.mb.right,b}else if(e.$a(a)&&c.Bc)return b[0]=c.Bc.min,b[1]=c.Bc.max,b;return null};a.T4=function(a,b){if(!k.xa(a))return n.error("get_frustum_planes(): Wrong camera object"),
null;var c=l.A(),c=k.ka(a,c).da[0].Ph;Q.copy(c.left,b.left);Q.copy(c.right,b.right);Q.copy(c.top,b.top);Q.copy(c.bottom,b.bottom);Q.copy(c.near,b.near);Q.copy(c.far,b.far);return b}};b4w.module.controls=function(a,h){var p=h("__controls"),e=h("__print");a.uf=p.uf;a.Qa=p.Qa;a.mn=p.mn;a.vf=p.vf;a.sp=p.sp;a.by=p.by;a.R0=8;a.D1=9;a.$0=13;a.xO=16;a.V0=17;a.P0=18;a.x1=19;a.T0=20;a.b1=27;a.yO=32;a.IE=37;a.KE=38;a.JE=39;a.HE=40;a.F0=49;a.G0=50;a.H0=51;a.I0=52;a.J0=53;a.K0=54;a.L0=55;a.M0=56;a.N0=57;a.Wy=65;a.Q0=66;a.GE=67;a.Xy=68;a.Z0=69;a.qO=70;a.d1=71;a.f1=72;a.g1=73;a.h1=74;a.rO=75;a.sO=76;a.i1=77;a.k1=78;a.w1=79;a.uO=80;a.z1=81;a.vO=82;a.Yy=83;a.zO=84;a.E1=85;a.F1=86;a.Zy=87;a.G1=
88;a.H1=89;a.I1=90;a.l1=96;a.m1=97;a.n1=98;a.o1=99;a.p1=100;a.q1=101;a.r1=102;a.s1=103;a.t1=104;a.u1=105;a.j1=106;a.O0=107;a.C1=109;a.X0=110;a.Y0=111;a.A1=186;a.a1=187;a.U0=188;a.W0=189;a.y1=190;a.c1=191;a.e1=192;a.tO=219;a.S0=220;a.wO=221;a.B1=222;a.Gt=p.Gt;a.Ft=p.Ft;a.Et=p.Et;a.cz=p.cz;a.Eu=p.Eu;a.Fu=p.Fu;a.Kq=p.Kq;a.Ii=p.Ii;a.hA=p.hA;a.Ic=p.Ic;a.gA=function(a,e,h){return p.gA(a,e||"ANY",h||!1)};a.YG=p.YG;a.eH=function(a,e,h,A,k,w,n){return p.eH(a,e,h,A||"ANY",k||!1,w||!1,n||!1)};a.En=p.En;a.mA=
p.mA;a.Il=p.Il;a.nA=p.nA;a.oA=p.oA;a.Nq=p.Nq;a.uA=p.uA;a.nH=p.nH;a.yu=p.yu;a.dH=p.dH;a.oH=p.oH;a.aH=p.aH;a.jA=p.jA;a.bH=p.bH;a.kA=p.kA;a.cH=p.cH;a.mH=function(a,e){return p.mH(a,e||!1)};a.dL=p.dL;a.Rj=p.Rj;a.lH=p.lH;a.wu=function(a,e){return p.wu(a,e||!1)};a.fA=function(a,e){return p.fA(a,e||0)};a.c8=function(a,e){p.cY(a,e)};a.C4=function(a){return a.value};a.Zd=p.Zd;a.$e=p.$e;a.Y=function(a,e,h,A,k,w,n){k=k||p.Eu;p.Y(a,e,h,A,k,w,void 0===n?null:n)};a.Dn=function(a,e,h,A,k){var w;A=p.Ic(A);p.Y(a,
e,h,[A],p.Eu,k,void 0===w?null:w)};a.W2=function(a){return p.uq(a,null)};a.uq=p.uq;a.hf=p.hf;a.reset=p.reset;a.C7=function(){e.O("controls.register_keyboard_events() deprecated")};a.D7=function(){e.O("controls.register_mouse_events() deprecated")};a.F7=function(){e.O("controls.register_wheel_events() deprecated")};a.E7=function(){e.O("controls.register_touch_events() deprecated")};a.B7=function(){e.O("controls.register_device_orientation() deprecated")};a.G9=function(){e.O("controls.unregister_keyboard_events() deprecated")};
a.H9=function(){e.O("controls.unregister_mouse_events() deprecated")};a.J9=function(){e.O("controls.unregister_wheel_events() deprecated")};a.I9=function(){e.O("controls.unregister_touch_events() deprecated")};a.F9=function(){e.O("controls.unregister_device_orientation() deprecated")};a.jD=p.jD};b4w.module.physics=function(a,h){function p(a,b,e,h){return r.FT(a,h[e[0]],h[e[1]],h[e[2]])}function e(a,b,e,h,f){b=Math.abs(a[2]-b[2]);return b<f&&A.aW(a,e,h)?b:Number.MAX_VALUE}h("__config");var b=h("__physics"),y=h("__print"),r=h("__util"),A=h("__navmesh");h("__vec3");new Float32Array(3);a.yE=0;a.ON=1;a.NN=2;a.Yx=3;a.HH=function(a){b.oa(a)?b.HH(a):y.O("No physics for object "+a.name)};a.HA=function(a){b.oa(a)?b.HA(a):y.O("No physics for object "+a.name)};a.k6=function(a){return b.oa(a)};a.sB=function(a){return b.sB(a)};
a.lJ=function(a){return b.lJ(a)};a.DL=function(a,e){b.oa(a)?b.DL(a,e):y.O("No physics for object "+a.name)};a.Es=function(a,e,h){b.oa(a)?b.Es(a,e,h):y.O("No physics for object "+a.name)};a.H=function(a){b.oa(a)?b.H(a):y.O("No physics for object "+a.name)};a.OF=function(a,e,h,l){b.oa(a)?b.OF(a,e,h,l):y.O("No physics for object "+a.name)};a.PF=function(a,e,h,l){b.oa(a)?b.PF(a,e,h,l):y.O("No physics for object "+a.name)};a.uz=function(a,e,h,l){b.oa(a)?b.uz(a,e,h,l,!1):y.O("No physics for object "+a.name)};
a.k2=function(a,e,h,l){b.oa(a)?b.uz(a,e,h,l,!0):y.O("No physics for object "+a.name)};a.NF=function(a,e,h,l){b.oa(a)?b.NF(a,e,h,l):y.O("No physics for object "+a.name)};a.kp=function(a,e){b.oa(a)?(b.bf(a)||b.cf(a)||y.error("Wrong object"),b.kp(a,r.U(e,-1,1))):y.O("No physics for object "+a.name)};a.R9=function(a,e,h){if(b.oa(a)){b.bf(a)||b.cf(a)||y.error("Wrong object");e=r.U(e,0,1);var l=a.v.Nn;-1==h||1==h?l=Math.max(-1,Math.min(l+h*e,1)):0==h&&0<=l?(l-=e,l=Math.max(0,l)):0==h&&0>l?(l+=e,l=Math.min(0,
l)):y.error("Wrong steering direction");b.kp(a,r.U(l,-1,1))}else y.O("No physics for object "+a.name)};a.jp=function(a,e){b.oa(a)?(b.bf(a)||b.cf(a)||y.error("Wrong object"),b.jp(a,r.U(e,-1,1))):y.O("No physics for object "+a.name)};a.Q9=function(a,e,h){if(b.oa(a)){b.bf(a)||b.cf(a)||y.error("Wrong object");e=r.U(e,0,1);var l=a.v.To;-1==h||1==h?l=Math.max(-1,Math.min(l+h*e,1)):0==h&&0<=l?(l-=e,l=Math.max(0,l)):0==h&&0>l?(l+=e,l=Math.min(0,l)):y.error("Wrong steering direction");b.jp(a,r.U(l,-1,1))}else y.O("No physics for object "+
a.name)};a.iE=function(a,e){b.oa(a)?(b.bf(a)||b.cf(a)||y.error("Wrong object"),b.iE(a,r.U(e,0,1))):y.O("No physics for object "+a.name)};a.P9=function(a,e){if(b.oa(a)){b.bf(a)||b.cf(a)||y.error("Wrong object");e=r.U(e,-1,1);var h=a.v.mq;b.iE(a,r.U(h+h*e,0,1))}else y.O("No physics for object "+a.name)};a.bf=function(a){return b.bf(a)};a.cf=function(a){return b.cf(a)};a.P5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.of.name;y.error("Wrong object");
return null};a.S5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.v.Nn;y.error("Wrong object");return null};a.Q5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.v.To;y.error("Wrong object")};a.O5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.v.mq;y.error("Wrong object")};a.aJ=function(a){if(!b.oa(a))return y.O("No physics for object "+
a.name),null;if(b.bf(a)||b.cf(a))return b.aJ(a);y.error("Wrong object")};a.ig=function(a){return b.ig(a)};a.Pm=function(a,e,h){b.oa(a)?b.Pm(a,e,h):y.O("No physics for object "+a.name)};a.Gk=function(a,e){b.oa(a)?b.Gk(a,e):y.O("No physics for object "+a.name)};a.uL=function(a,e){b.oa(a)?b.uL(a,e):y.O("No physics for object "+a.name)};a.tL=function(a,e){b.oa(a)?b.tL(a,e):y.O("No physics for object "+a.name)};a.qL=function(a,e){b.oa(a)?b.qL(a,e):y.O("No physics for object "+a.name)};a.Oz=function(a){b.oa(a)?
b.Oz(a):y.O("No physics for object "+a.name)};a.zG=function(a,e,h){b.oa(a)?b.zG(a,e,h):y.O("No physics for object "+a.name)};a.Hk=function(a,e,h){b.oa(a)?b.Hk(a,e,h):y.O("No physics for object "+a.name)};a.sL=function(a,e){b.oa(a)?b.sL(a,e):y.O("No physics for object "+a.name)};a.rL=function(a,e){b.oa(a)?b.rL(a,e):y.O("No physics for object "+a.name)};a.rz=function(a,e,h,l){b.oa(a)?b.rz(a,e||"ANY",h,l||!1):y.O("No physics for object "+a.name)};a.OC=function(a,e,h){b.oa(a)?b.OC(a,e||"ANY",h):y.O("No physics for object "+
a.name)};a.tz=function(a,e){b.oa(a)?b.tz(a,e):y.O("No physics for object "+a.name)};a.Tz=function(a){b.oa(a)?b.Tz(a):y.O("No physics for object "+a.name)};a.Vt=function(a,e,h,l,f,p){a=a||null;if(null==a||b.oa(a))return b.Vt(a,e,h,l||"ANY",f,p||!1,!1,!1,!1);y.O("No physics for object "+a.name)};a.c2=function(a,e,h,l,f,p,c,r,A){a=a||null;if(null==a||b.oa(a))return b.Vt(a,e,h,l||"ANY",f,p||!1,c||!1,r||!1,A||!1);y.O("No physics for object "+a.name)};a.PC=function(a){b.GJ(a)?b.PC(a):y.error("Wrong ray test ID")};
a.xG=function(a,e,h){b.GJ(a)?b.xG(a,e,h):y.error("Wrong ray test ID")};a.KF=function(a,e,h,l,f,p,c,r,A,K){b.oa(e)&&b.oa(f)?b.KF(a,e,h,l,f,p,c,r,A,K):y.error("Wrong objects")};a.NG=function(a){b.oa(a)&&b.yV(a)?b.NG(a):y.error("Wrong object")};a.PK=function(a,e,h,l,f,p){b.oa(a)&&b.oa(l)?b.PK(a,e,h,l,f,p):y.error("Wrong objects")};a.jK=function(a,e,h){h||(h=p);if(b.oa(a)){var l=a.C.Vr;return l?A.jK(l,e,h):(y.error(a.name+" is not a navigation mesh object"),null)}y.O("No physics for object "+a.name)};
a.iK=function(a,h,n,l){if(b.oa(a)){var f=a.C.Vr;if(!f)return y.error(a.name+" is not a navigation mesh object"),null;l=l||{};a={};a.do_not_pull_string=Boolean(l.do_not_pull_string);a.distance_to_closest=l.distance_to_closest||p;a.distance_to_farthest=l.distance_to_farthest||e;a.island=l.island||0;a.allowed_distance=l.allowed_distance||Number.MAX_VALUE;a.return_normals=l.return_normals||!1;return A.iK(f,h,n,a)}y.O("No physics for object "+a.name)}};b4w.module.scenes=function(a,h){function p(){var a=y.gm();return k.fs(a.clientWidth/2,a.clientHeight/2)}var e=h("__batch"),b=h("__camera"),y=h("__container"),r=h("__data"),A=h("__graph"),k=h("__objects"),w=h("__obj_util"),n=h("__print"),l=h("__scenes"),f=h("__subscene"),v=h("__util");a.oc=k.oc;a.Pw=function(a){var b=l.pr();l.Pw(v.Dd("name",a,b))};a.A=function(){return l.Da()?l.A().name:""};a.A5=function(){for(var a=l.pr(),b=[],f=0;f<a.length;f++)b.push(a[f].name);return b};a.Qh=function(){if(l.Da())return l.dm(l.A());
n.error("No active scene");return!1};a.kV=function(){var a=k.xc(k.my,"EmptySpawner1",0,!0);if(a)return a;n.error("get object EmptySpawner1: not found")};a.HI=function(a){var b=k.xc(k.ly,"GroupCharacterJim",a,0);if(b)return b;n.error("get object "+a+": not found")};a.j5=function(a,b){var f=k.xc(k.Oc,a,b|0);if(f)return f;n.error("get object "+a+": not found")};a.iv=function(a,b){var f=k.iv(a,b|0);if(f)return f;n.error("get object "+a+": not found")};a.iB=function(a){return w.iB(a)};a.fs=function(a,
b){var e=l.Rh();return e?(e=l.La(e,f.xi))&&e.enable_hmd_stereo?(n.O("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),p()):k.fs(a,b):(n.error("No active scene"),null)};a.w7=p;a.r7=function(a){return a&&a.k&&a.k.Vc};a.IL=function(a,b){a&&a.k&&a.k.Vc?k.IL(a,b):n.error("set_outline_intensity(): wrong object")};a.r5=function(a){if(a&&a.k&&a.k.Vc)return a.k.ih;n.error("get_outline_intensity(): wrong object")};a.yn=function(a,b,f,e){a&&a.k&&a.k.Vc?k.yn(a,b,
f,e):n.error("apply_outline_anim(): wrong object")};a.n2=function(a){if(a&&a.k&&a.k.Vc){var b=a.k.ai;k.yn(a,b.rk,b.tk,b.uk)}else n.error("apply_outline_anim_def(): wrong object")};a.mu=function(a){a&&a.k&&a.k.Vc?k.mu(a):n.error("clear_outline_anim(): wrong object")};a.HL=l.HL;a.q5=function(a){var b=l.A();if(b=l.La(b,f.pn))return a=a||new Float32Array(3),a.set(b.hj),a};a.Tw=function(a){l.Da()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||
a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),l.Tw(a)):n.error("No active scene")};a.B5=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A(),b=l.La(a,f.cd);if(!b)return null;var e=a.s.ud,k=l.La(a,f.Pb),h=l.La(a,f.yf),p={};p.csm_resolution=e.csm_resolution;
p.self_shadow_polygon_offset=b.self_shadow_polygon_offset;h&&(p.self_shadow_normal_offset=h.self_shadow_normal_offset);p.enable_csm=e.enable_csm;p.csm_num=e.csm_num;p.csm_first_cascade_border=e.csm_first_cascade_border;p.first_cascade_blur_radius=e.first_cascade_blur_radius;p.csm_last_cascade_border=e.csm_last_cascade_border;p.last_cascade_blur_radius=e.last_cascade_blur_radius;p.fade_last_cascade=e.fade_last_cascade;p.blend_between_cascades=e.blend_between_cascades;e.enable_csm?(p.csm_borders=l.RU(a,
k.p),p.blur_radii=new Float32Array(e.csm_num),p.blur_radii.set(k.p.vo.subarray(0,e.csm_num))):(p.csm_borders=null,p.blur_radii=null);return p};a.J8=function(a){if(l.Da()){var k=l.A();"number"==typeof a.self_shadow_polygon_offset&&A.pa(k.s.Xa,function(b,e){e.type==f.cd&&(e.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var h=l.La(k,f.yf);h&&("number"==typeof a.self_shadow_normal_offset&&(h.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(h.pcf_blur_radius=
a.pcf_blur_radius));var p=l.La(k,f.Pc);p&&("number"==typeof a.self_shadow_normal_offset&&(p.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(p.pcf_blur_radius=a.pcf_blur_radius),p.Ba=!0);p=k.s.ud;"number"==typeof a.csm_first_cascade_border&&(p.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(p.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(p.csm_last_cascade_border=
a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(p.last_cascade_blur_radius=a.last_cascade_blur_radius);if(h){for(var r=h.Ra,v=0;v<r.length;v++)for(var y=r[v].sa,L=0;L<y.length;L++){var I=y[L];if(I.ff.fe){var z=I.za;e.RF(z,p);e.Yc(z);f.Sc(h,I)}}h.Ba=!0}h=w.ka(k.Cj,k).da;for(v=0;v<h.length;v++)b.bE(h[v],p);l.$C(k)}else n.error("No active scene")};a.tI=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.tI(a)};a.Rw=function(a,b,e){if(l.Da()){var k=
l.A(),h=l.La(k,f.Pb);l.Rw(k,a||0==a?parseFloat(a):h.Sg,b||0==b?b:h.ke,e||0==e?e:h.te)}else n.error("No active scene")};a.wI=function(a){if(!l.Da())return n.error("No active scene"),!1;var b=l.A();return l.wI(b,a)};a.eD=function(a){if(l.Da()){var b=l.A();l.eD(b,a)}else n.error("No active scene")};a.P4=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A(),b={};b.hr=l.ZU(a);b.fog_depth=l.XU(a);b.fog_start=l.$U(a);b.fog_height=l.YU(a);return b};a.i8=function(a){if(l.Da()){var b=l.A();
"number"==typeof a.hr&&l.zL(b,a.hr);"number"==typeof a.fog_depth&&l.xL(b,a.fog_depth);"number"==typeof a.fog_start&&l.AL(b,a.fog_start);"number"==typeof a.fog_height&&l.yL(b,a.fog_height)}else n.error("No active scene")};a.WI=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.WI(a)};a.NL=function(a){if(l.Da()){var b=l.A();l.NL(b,a)}else n.error("No active scene")};a.y4=function(){if(!l.Da())return n.error("No active scene"),null;var a=l.A(),a=l.La(a,f.$x);if(!a)return null;
var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.a8=function(a){if(l.Da()){var b=l.A();if(b=l.La(b,f.$x))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Ba=!0}else n.error("No active scene")};a.UI=function(){if(!l.Da())return n.error("No active scene"),!1;
var a=l.A();return l.UI(a)};a.LL=function(a){if(l.Da()){var b=l.A();l.LL(b,a)}else n.error("No active scene")};a.rI=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.La(a,f.wp)?l.rI(a):null};a.wL=function(a){if(l.Da()){var b=l.A();l.wL(b,a)}else n.error("No active scene")};a.zI=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.La(a,f.Bj)?l.zI(a):null};a.CL=function(a){if(l.Da()){var b=l.A();l.CL(b,a)}else n.error("No active scene")};a.lI=
function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.La(a,f.qp)?l.lI(a):null};a.oL=function(a){if(l.Da()){var b=l.A();l.oL(b,a)}else n.error("No active scene")};a.yI=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.La(a,f.yp)?l.yI(a):null};a.BL=function(a){if(l.Da()){var b=l.A();l.BL(b,a)}else n.error("No active scene")};a.hJ=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.hJ(a)};a.TL=function(a){if(l.Da()){var b=
l.A();k.TL(b,a)}else n.error("No active scene")};a.eJ=function(a,b){if(!l.Da())return n.error("No active scene"),0;var f=l.A();return f.s.Mc?l.eJ(f,a,b):(n.error("No water parameters on the active scene"),0)};a.SL=function(a){if(l.Da()){var b=l.A();l.SL(b,a)}else n.error("No active scene")};a.dJ=function(a){if(l.Da()){var b=l.A();l.dJ(b,a)}else n.error("No active scene")};a.M9=function(){if(l.Da()){var a=l.A();l.fN(a)}else n.error("No active scene")};a.r6=function(a,b){b=b||!1;!w.$d(a)&&!w.bo(a)||
w.Sa(a)?b?l.sq(a,!0):l.yG(a,!0):n.error("show/hide is only supported for dynamic objects.")};a.V8=function(a,b){b=b||!1;!w.$d(a)&&!w.bo(a)||w.Sa(a)?b?l.sq(a,!1):l.yG(a,!1):n.error("show/hide is only supported for dynamic objects.")};a.FB=function(a){if(w.TV(a)||w.bo(a)||w.Zg(a))return l.FB(a);n.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.ho=function(a){return a.k.ho};a.S2=function(a){n.Sb("scenes.check_object","scenes.check_object_by_name");return l.Da()?
k.cX(a,l.A()):(n.error("No active scene"),!1)};a.V2=function(a,b){return k.xc(k.my,a,b|0,!0)?!0:!1};a.T2=function(a,b,f){return k.xc(k.ly,a,b,f|0)?!0:!1};a.U2=function(a,b){return k.xc(k.Oc,a,b|0)?!0:!1};a.cm=function(a,b){var f=l.A();a||(a="ALL");b||0===b||(b=k.oc);return k.RI(f,a,b)};a.m5=function(a){return a?a.Dm:(n.error("Wrong object name"),"")};a.n5=function(a){if(!a)return n.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Dm),a=w.Ri(a);return b.reverse()};a.o5=function(a){return a&&
a.type?a.type:(n.error("Wrong object"),"UNDEFINED")};a.l5=function(a){n.Sb("scenes.get_object_dg_parent","objects.get_dg_parent");return w.Ri(a)};a.k5=function(a){return a.Te.slice(0)};a.Wn=function(){return k.Wn(l.A())};a.TI=function(a,b){b||0===b||(b=1);if(!l.Da())return n.error("No active scene"),!1;var f=l.A();return l.TI(f,a,b)};a.nI=function(){return l.nI()};a.L5=function(a){return w.$d(a)?a.k.type:null};a.bv=function(){if(!l.Da())return n.error("No active scene"),!1;var a=l.A();return l.bv(a)};
a.xn=function(a,b){if(a.k.Hv){if(b)var f=l.pr(),f=v.Dd("name",b,f);else f=l.A();l.xn(f,a,!0)}else n.error('object "'+a.name+'" has been created not by coping.')};a.ts=function(a){(w.$d(a)||w.bo(a))&&w.Sa(a)?(k.mw(a,a.k.Iv,!1,!1),r.xX(a),k.mw(a,!0,!0,!0),k.ts(a)):n.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.$J=function(a){var b=l.A();if(b.timeline_markers&&a in b.timeline_markers)return l.$J(b,a);n.error('"'+a+'" marker not found.');return 0};a.g5=
function(){var a=l.A();return(a=l.La(a,f.zh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.t8=function(a){var b=l.A();(b=l.La(b,f.zh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):n.error("The motion blur subscene doesn't exist.")};a.E2=function(){var a=l.A();return Boolean(l.La(a,f.tf))}};b4w.module.container=function(a,h){var p=h("__container"),e=h("__print");a.gm=p.gm;a.oI=p.oI;a.Ce=p.Ce;a.Fv=function(a,h){2!=arguments.length?e.error("insert_to_container(): two arguments required"):a&&h&&p.Fv(a,h)};a.pL=p.pL;a.$M=p.$M;a.ou=p.ou;a.VA=p.VA;a.resize=function(a,h,r){a&&h||e.warn("Wrong canvas container dimensions: "+a+"x"+h+". Zero dimensions aren't allowed. Resized to: "+p.dy+"x"+p.cy+".");p.resize(a,h,r)};a.Bk=function(a){p.Bk(a||!1)}};b4w.module.util=function(a,h){var p=h("__compat"),e=h("__obj_util"),b=h("__print"),y=h("__quat"),r=h("__util"),A=h("__vec3"),k=new Float32Array(6);a.ti=new Float32Array([1,0,0]);a.xh=new Float32Array([0,1,0]);a.nc=new Float32Array([0,0,1]);a.Wx=new Float32Array([-1,0,0]);a.wh=new Float32Array([0,-1,0]);a.Nc=new Float32Array([0,0,-1]);a.kF=r.kF;a.rF=r.rF;a.sF=r.sF;a.mF=r.mF;a.oF=r.oF;a.uF=r.uF;a.lF=r.lF;a.qF=r.qF;a.iz=r.iz;a.nF=r.nF;a.pF=r.pF;a.tF=r.tF;a.Ef=function(a){return r.Ef(a||0)};a.assert=
r.assert;a.PJ=r.PJ;a.Dd=r.Dd;a.VB=function(a){return r.VB(a)};a.Wj=function(a,b){b||(b=new Float32Array(4));return r.Wj(a,b)};a.qC=function(a,b,e){e||(e=y.create());return r.qC(a,b,e)};a.TK=function(a,b,e){e||(e=A.create());return r.TK(a,b,e)};a.Fw=function(a,b){b||(b=new Float32Array(3));return r.Fw(a,b)};a.sign=r.sign;a.U=r.U;a.lc=r.lc;a.c6=function(a,b){return r.Ew(a,r.Nc,r.nc,r.xh,b)};a.Mz=function(a,b){return r.Mz(a,b)};a.Ew=function(a,e,k,f,h){return 0!=A.dot(k,f)?(b.error("Wrong in-plane direction"),
null):r.Ew(a,e,k,f,h)};a.nJ=r.nJ;a.mc=r.mc;a.jx=r.jx;a.jk=r.jk;a.dA=r.dA;a.SK=r.SK;a.VK=r.VK;a.qJ=r.qJ;a.PB=function(a,e,h,f,p){b.Sb("util.line_plane_intersect","math.line_plane_intersect");k[0]=h[0];k[1]=h[1];k[2]=h[2];k[3]=f[0];k[4]=f[1];k[5]=f[2];return r.PB(a,e,k,p)};a.$d=function(a){b.Sb("util.is_mesh","objects.is_mesh");return e.$d(a)};a.om=function(a){b.Sb("util.is_armature","objects.is_armature");return e.om(a)};a.zi=r.zi;a.Fg=r.Fg;a.Sm=r.Sm;a.lerp=r.lerp;a.Cb=r.Cb;a.oe=r.oe;a.EA=r.EA;a.Hr=
p.Hr;a.or=r.or};b4w.module.main=function(a,h){function p(){}function e(){}function b(){}function y(){window.performance||(J.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(J.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});ga.PL(0)}function r(a,b){for(var c=null,d=b?la:wa,f=0;f<d.length;f++){var e=d[f];try{c=a.getContext(e,q)}catch(g){}if(c)break}c&&D.AT(c);return c}function A(a,b,f){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();J.error("WebGL context lost");w()},!1);d.Nf(f);var g=d.ev();g&&J.log("%cRENDERER INFO:","color: #00a",f.getParameter(g.UNMASKED_VENDOR_WEBGL)+", "+f.getParameter(g.UNMASKED_RENDERER_WEBGL));F.Nf(f);m.Nf(f);u.Nf(f);ba.Nf(f);z.Nf(f);R.Nf(f);I.QY(a);R.Xg(a,b);T.UL(a.width,a.height,1);N.Xg();e=c();l()}function k(){p=function(){}}function w(){n()||(pa=performance.now()/1E3,N.pause(),da.pause(),u.pause(),B.pause())}function n(){return aa<pa}function l(){var a="HMD"===S.stereo&&
O.fJ();a?a.requestAnimationFrame(l):ta(l);var b=performance.now()/1E3;sa||(sa=b);var c=b-sa;if(!(c<1/S.max_fps)){for(var d=ga.ur(),f=0;f<oa.length;f++)oa[f](d,c);n()||(aa>sa&&(c-=aa-Math.max(pa,sa)),d+=c,ga.PL(d),z.update(),K.update(),I.update(),v(d,c),e(c));sa=b;a&&a.isPresenting&&a.submitFrame()}}function f(a,b,c){if(X)if(X.GZ)X.GZ(a,b,c);else{c=atob(X.toDataURL(b,c).split(",")[1]);for(var d=new Uint8Array(c.length),f=0;f<c.length;f++)d[f]=c.charCodeAt(f);a(new Blob([d],{type:b||"image/png"}))}}
function v(a,b){if(I.$g()&&(x.reset(),Z.update(b),P.update(a,b),g.update(a,b),N.update(a,b),b&&Q.update(b),I.$g()&&(da.update(a,b),I.$g()&&(O.update(a),L.update(a,b),I.$g()&&(B.update(!1),t.update(a,b),ha.update(),p(b,a),I.$g()))))){T.update(a,b);B.iN();var c=ya.callback;c&&(ya.QJ&&URL.revokeObjectURL(ya.zz),f(function(a){ya.zz=URL.createObjectURL(a);c(ya.zz)},ya.format,ya.quality),ya.callback=null,ya.format="image/png",ya.quality=1)}}function c(){var a=60,c=0,d=S.RH,f=S.pU;return function(e){e<1/
S.max_fps||(a=E.mc(1/e,a,e,d),e=da.bV(),c=(c+1)%f,0==c&&b(Math.round(a),e))}}var B=h("__anchors"),Q=h("__animation"),K=h("__assets"),G=h("__config"),D=h("__compat"),R=h("__container"),L=h("__controls"),I=h("__data"),z=h("__debug"),d=h("__extensions"),m=h("__geometry"),O=h("__input"),x=h("__hud"),g=h("__nla"),P=h("__logic_nodes"),t=h("__objects"),da=h("__physics"),J=h("__print"),F=h("__renderer"),T=h("__scenes"),N=h("__sfx"),ba=h("__shaders"),u=h("__textures"),ga=h("__time"),Z=h("__transform"),E=h("__util"),
ca=h("__version"),ha=h("__particles"),q=G.context,S=G.B,X=null,U=null,sa=0,pa=0,aa=0,oa=[],ya={callback:null,format:"image/png",quality:1,zz:"",QJ:!1,rH:!1},wa=["webgl","experimental-webgl"],la=["webgl2","experimental-webgl2"],ia=null,ta=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/S.max_fps)}}();a.Xg=function(a,b){G.BY();
J.LY(S.console_verbose);var c=ca.jE()+" "+ca.type()+" ("+ca.zA()+")";J.log("%cINIT ENGINE","color: #00a",c);J.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;y();X=a;b?(x.Xg(b),U=b):(G.B.show_hud_debug_info=!1,G.X.cw=!1);D.GQ();D.Rz("Chrome")||D.Rz("Firefox")||(S.ec=!1);c=r(a,S.ec);!c&&S.ec&&(S.ec=!1,c=r(a,!1));if(!c)return null;J.log("%cINIT WEBGL "+(S.ec?"2":"1"),"color: #00a");ia=c;A(X,U,c);G.zn();D.EL(c,!0);ba.wW();S.Xn&&(a.style["touch-action"]=
"none");J.log("%cSET PRECISION:","color: #00a",S.precision);return c};a.resize=function(a,b,c){J.Sb("main.resize","container.resize");R.resize(a,b,c)};a.oY=function(a){b=a};a.a3=function(){b=function(){}};a.E8=function(a){p=a};a.e3=function(){k()};a.b6=function(){J.Sb("main.global_timeline","time.get_timeline");return ga.ur()};a.pause=w;a.jj=function(){n()&&(aa=performance.now()/1E3,N.jj(),da.jj(),u.play(!0),B.jj())};a.Ir=n;a.reset=function(){I.yx(0);I.reset();d.reset();F.reset();m.reset();u.TX();
ba.reset();z.reset();R.reset();I.reset();R.reset();ga.reset();N.reset();U=X=null;aa=pa=sa=0;b=function(){};e=function(){};p=function(){};oa.length=0;ia=null};a.F2=function(a,b,c,d){ya.rH="undefined"===typeof d?d:!0;ya.QJ=ya.rH;ya.callback=a;ya.format=b||ya.format;ya.quality=c||ya.quality};a.w4=function(){J.Sb("main.get_canvas_elem","container.get_canvas");return X};a.Zf=function(){return D.Zf()};a.Xp=function(a){for(var b=0;b<oa.length;b++)if(oa[b]==a)return;oa.push(a)};a.GX=function(a){for(var b=
0;b<oa.length;b++)if(oa[b]==a){oa.splice(b,1);break}};a.ev=function(){var a=d.ev();return a?{vendor:ia.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:ia.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.input=function(a,h){function p(a){var e=b.ga(b.xd);if(!e||!e.mh)return!1;if(c)return!0;var d=b.Ti(e,b.TN,f),h=b.Ti(e,b.UN,v);y.fD(a,d,h);if(d=b.im(e,K))h=n.A(),a=k.ka(a,h).da,y.bD(a,d);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.im(b.hl)!==b.Ep&&(a.distortion_coefs=[e.distortion_coefs[0],e.distortion_coefs[1]],a.chromatic_aberration_coefs=[e.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]],
e.op||(e.Hj&&e.bk&&e.Ij?a.base_line_factor=(e.Hj-e.Ij)/e.bk:e.Ij||(a.base_line_factor=e.Hj/e.bk)),e.Vi&&e.hn&&!e.op&&(a.inter_lens_factor=e.Vi/e.hn),B.enabled||(d=1+e.distortion_coefs[0]+e.distortion_coefs[1],n.hK(d,d)));n.Tw(a);A.Bk(!0);b.Jw(e);return c=!0}function e(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=h("__input"),y=h("__camera"),r=h("__config"),A=h("__container"),
k=h("__obj_util"),w=h("__print"),n=h("__scenes"),l=h("__vec4"),f=l.create(),v=l.create(),c=!1,B=r.Tq,Q=r.B;a.tt=b.tt;a.ut=b.ut;a.wt=b.wt;a.vt=b.vt;a.Jy=b.Jy;a.vy=b.vy;a.st=b.st;a.Cy=b.Cy;a.Ly=b.Ly;a.Dp=b.Dp;a.Ky=b.Ky;a.xt=b.xt;a.My=b.My;a.Ny=b.Ny;a.wy=b.wy;a.xy=b.xy;a.yy=b.yy;a.zy=b.zy;a.Ay=b.Ay;a.By=b.By;a.Dy=b.Dy;a.Ey=b.Ey;a.Fy=b.Fy;a.Gy=b.Gy;a.Hy=b.Hy;a.Iy=b.Iy;a.zp=b.zp;a.Ap=b.Ap;a.Bp=b.Bp;a.Cp=b.Cp;a.py=b.py;a.qy=b.qy;a.ry=b.ry;a.sy=b.sy;a.ty=b.ty;a.uy=b.uy;a.ny=b.ny;a.oy=b.oy;a.At=b.At;a.Bt=
b.Bt;a.hl=b.hl;a.Vy=b.Vy;a.CE=b.CE;a.BE=b.BE;a.Ep=b.Ep;var K=b.Ry;a.Ry=K;a.Qy=b.Qy;a.Oy=b.Oy;a.Ty=b.Ty;a.Uy=b.Uy;a.Sy=b.Sy;a.Py=b.Py;a.wi=b.wi;a.il=b.il;a.Ip=b.Ip;a.Jp=b.Jp;a.Gp=b.Gp;a.Fp=b.Fp;a.ml=b.ml;a.Pp=b.Pp;a.ll=b.ll;a.zt=b.zt;a.on=b.on;var G={};G[b.xd]=[b.At,b.Bt];G[b.ad]=[b.wi];var D={};D[b.xd]=[b.hl];var R={};R[b.ad]=[b.wi,b.il,b.Ip,b.Jp];R[b.tp]=[b.Gp,b.Fp];R[b.Ag]=[b.ml,b.Pp,b.ll];R[b.yh]=[b.zt,b.on];var L={};L[b.xd]=[b.Qy,b.Ry,b.Oy,b.Ty,b.Uy,b.Sy,b.Py];a.yh=b.yh;a.xd=b.xd;a.ad=b.ad;a.tp=
b.tp;a.Ag=b.Ag;a.iu=b.iu;a.ga=b.ga;a.ID=function(a,c){a&&b.ID(a,c)};a.A7=function(){w.O("input.register_device() deprecated")};a.Jw=function(a){a&&a.type==b.xd?b.Jw(a):w.error("reset_device is undefined for device.")};a.Ti=function(a,c,d){if(a&&a.type in G&&0<=G[a.type].indexOf(c))return b.Ti(a,c,d);w.error("device hasn't param: ",c)};a.im=function(a,c){if(a&&a.type in D&&0<=D[a.type].indexOf(c))return b.im(a,c);w.error("device hasn't param: ",c)};a.yd=function(a,c,d){d=d||null;if(a&&a.type in R&&
0<=R[a.type].indexOf(c))return b.yd(a,c,d);w.error("device hasn't param: ",c)};a.Bd=function(a,c,d){d=d||null;if(a&&a.type in R&&0<=R[a.type].indexOf(c))return b.Bd(a,c,d);w.error("device hasn't param: ",c)};a.aD=function(a,c,d){if(a&&a.type in L&&0<=L[a.type].indexOf(c))return b.aD(a,c,d);w.error("device hasn't config: ",c)};a.RX=function(){if(n.Da()){var a=n.dm(n.A());if(a&&(p(a),a=b.ga(b.xd))){var c=a.Tf;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=A.gm(),c.requestPresent([{source:a}]).then(function(){if(!Q.is_mobile_device){var a=
c.getEyeParameters("left"),b=c.getEyeParameters("right");A.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){w.error("HMD fullscreen request failed.")})):w.error("HMD fullscreen request failed."))}}};a.PT=p;a.DT=function(){var a=b.ga(b.xd);if(c||a&&a.mh)n.Tw({enable_hmd_stereo:!1}),a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]),n.hK(a,a),A.Bk(!0)};a.l8=function(a,c,d){e();switch(a){case 0:a=b.nt;break;case 1:a=b.ey;break;case 2:a=b.fy;break;
case 3:a=b.gy;break;default:a=b.nt}a=b.ga(a);b.aD(a,c,d)};a.JI=b.JI;a.CI=b.CI;a.BG=e};b4w.module.transform=function(a,h){var p=h("__obj_util"),e=h("__physics"),b=h("__print"),y=h("__quat"),r=h("__transform"),A=h("__tsr"),k=h("__util"),w=A.create(),n=new Float32Array(3),l=new Float32Array(4);a.un=r.un;a.iF=r.iF;a.Wc=function(a,k,c,h){p.Sa(a)?(n[0]=k,n[1]=c,n[2]=h,r.Wc(a,n),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yw=function(a,k,c,h){p.Sa(a)?(n[0]=k,n[1]=c,n[2]=h,r.Yw(a,n),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.JY=function(a,
k){p.Sa(a)?(r.Wc(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.N8=function(a,k){p.Sa(a)?(r.Yw(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.M8=function(a,h,c,l,w){p.Sa(a)?(n[0]=h,n[1]=c,n[2]=l,k.Xc(n,1,A.P(w.k.n),A.G(w.k.n),n),r.Wc(a,n),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ie=function(a,b){b||(b=new Float32Array(3));r.ie(a,b);return b};a.ZI=function(a,b){b||(b=new Float32Array(3));r.ZI(a,b);return b};
a.gi=function(a,k,c,h,n){p.Sa(a)?(l[0]=k,l[1]=c,l[2]=h,l[3]=n,r.gi(a,l),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Xw=function(a,k,c,h,n){p.Sa(a)?(l[0]=k,l[1]=c,l[2]=h,l[3]=n,r.Xw(a,l),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.mD=function(a,k){p.Sa(a)?(r.gi(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.I8=function(a,k){p.Sa(a)?(r.Xw(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Sh=
function(a,b){b||(b=new Float32Array(4));r.Sh(a,b);return b};a.NI=function(a,b){b||(b=new Float32Array(4));r.NI(a,b);return b};a.Ww=function(a,k,c,h){p.Sa(a)?(n[0]=k,n[1]=c,n[2]=h,r.Ww(a,n),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.LI=function(a,b){b||(b=new Float32Array(3));r.LI(a,b);return b};a.MI=function(a,b){b||(b=new Float32Array(3));r.MI(a,b);return b};a.lD=function(a,k,c,h){p.Sa(a)?(n[0]=k,n[1]=c,n[2]=h,r.lD(a,n),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.H8=function(a,k){p.Sa(a)?(r.Ww(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.G8=function(a,k){p.Sa(a)?(r.lD(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Mf=function(a,e){p.Sa(a)?(r.Mf(a,e),r.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.nD=function(a,e){p.Sa(a)?(r.nD(a,e),r.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yd=function(a){return r.Yd(a)};a.QI=function(a){return r.QI(a)};
a.I3=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var k=0;k<a.Te.length;k++)if(!p.Sa(a.Te[k])){b.error('Wrong object: "'+a.Te[k].name+'" is not dynamic.');return}r.Wc(a,[0,0,0]);r.gi(a,[0,0,0,1]);r.Mf(a,1);r.D(a);e.H(a)}};a.dv=function(a){return p.$d(a)?r.dv(a):(b.error("Wrong object: "+a.name),0)};a.cv=function(a,e,c){if(!p.$d(a))return b.error("Wrong object: "+a.name),null;c||(c=new Float32Array(3));return r.cv(a,e,c)};a.fh=function(a,k,c,h){p.Sa(a)?(r.fh(a,k,c,h),r.D(a),
e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.N7=function(a,h){if(p.Sa(a)){var c=y.setAxisAngle(k.ti,h,l);r.XC(a,c);r.D(a);e.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.O7=function(a,h){if(p.Sa(a)){var c=y.setAxisAngle(k.wh,h,l);r.XC(a,c);r.D(a);e.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.P7=function(a,h){if(p.Sa(a)){var c=y.setAxisAngle(k.nc,h,l);r.XC(a,c);r.D(a);e.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.GI=function(a){return r.GI(a)};a.mj=function(a,k){p.Sa(a)?(r.mj(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Zw=function(a,k){p.Sa(a)?(r.Zw(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.vr=function(a,b){b||(b=new Float32Array(8));r.vr(a,b);return b};a.wr=function(a,b){b||(b=new Float32Array(8));r.wr(a,b);return b};a.distance=function(a,b){return r.distance(a,b)};a.q8=function(a,k){p.Sa(a)?(A.Qi(k,w),r.mj(a,w),r.D(a),e.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.r8=function(a,k){p.Sa(a)?(A.Qi(k,w),r.Zw(a,w),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.e5=function(a,b){b||(b=new Float32Array(16));r.vr(a,w);A.QM(w,b);return b};a.f5=function(a,b){b||(b=new Float32Array(16));r.wr(a,w);A.QM(w,b);return b}};b4w.module.constraints=function(a,h){var p=h("__camera"),e=h("__constraints"),b=h("__obj_util"),y=h("__physics"),r=h("__print"),A=h("__transform");a.wQ=function(a,b,h){var l;l=l||1;b instanceof Array&&2==b.length?e.xQ(a,b[0],b[1],h,l):e.IF(a,b,h,void 0,l);A.D(a);y.H(a)};a.e2=function(a,b,h,l){e.uQ(a,b,h,l);A.D(a);y.H(a)};a.f2=function(a,b,h,l,f,v,c,B){p.ic(a)?(f=f||-Math.PI/2,v=v||Math.PI/2,c=c||Math.PI/2,B=B||-Math.PI/2,e.tQ(a,b,h,l,f,v,c,B),A.D(a),y.H(a)):r.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.d2=function(a,b,h,l){if(p.ic(a)){if(!l||0>l)l=.25;e.sQ(a,b,h,l);A.D(a);y.H(a)}else r.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.JF=function(a,b,h){e.zQ(a,b,h);A.D(a);y.H(a)};a.Y1=function(a,b,h){e.mQ(a,b,h);A.D(a);y.H(a)};a.g2=function(a,b,h,l){e.AQ(a,b,h,l);A.D(a);y.H(a)};a.h2=function(a,b){3==b.length?e.DQ(a,b):e.CQ(a,b);A.D(a);y.H(a)};a.b2=function(a,b,h,l){3==b.length?e.pQ(a,b,h,l):e.oQ(a,b,h,l);A.D(a);y.H(a)};a.sz=function(a,b,h){e.sz(a,
b,h);A.D(a);y.H(a)};a.remove=function(a){a.pc&&e.remove(a)};a.II=function(a){r.Sb("constraints.get_parent","objects.get_parent");return b.II(a)}};b4w.module.hmd=function(a,h){function p(a,h){if(h){var p=A.Qh();if(p){e.ic(p)||(v=e.Aa(p),c=e.$a(p),B=e.tm(p),e.eU(p));var p=b.Rj(),x=!1;b.Y(null,"HMD_ROTATE_CAMERA",b.Qa,[p,h],null,function(c,h,m){if(0<m&&(m=A.Qh())&&(!x&&y.PT(m)&&(l=k.Sh(m,l),x=!0),x&&e.ic(m)&&(c=b.$e(c,h,1))))if(1==a){c=r.multiply(z,c,I);var p=n.transformQuat(w.wh,c,Q);e.oD(m,p);k.mD(m,c)}else if(2==a||3==a){h=k.Sh(m,R);h=r.invert(h,R);var v=r.multiply(l,h,R);h=e.sV(m,Q);Math.abs(h[2])<Math.PI/4?p=n.cross(h,w.wh,K):Math.abs(h[1])<
Math.PI/4&&(p=n.cross(h,w.nc,K));n.normalize(p,p);var v=n.transformQuat(p,v,G),F=n.dot(h,v),v=n.scaleAndAdd(v,h,-F,G);n.normalize(v,v);h=n.cross(h,p,Q);p=Math.acos(w.U(n.dot(p,v),0,1));h=w.sign(n.dot(v,h));f+=p*h;p=r.setAxisAngle(w.nc,-f,R);3!=a&&(h=w.Ew(c,w.Nc,w.nc,w.xh,L),h=r.invert(h,L),c=r.multiply(h,c,L));c=r.multiply(p,c,D);p=n.transformQuat(w.wh,c,Q);e.oD(m,p);k.mD(m,c);r.copy(c,l)}})}}}var e=h("camera"),b=h("controls"),y=h("input"),r=h("quat"),A=h("scenes"),k=h("transform"),w=h("util"),n=
h("vec3"),l=r.create(),f=0,v=!1,c=!1,B=!1,Q=n.create(),K=n.create(),G=n.create(),D=r.create(),R=r.create(),L=r.create(),I=r.create(),z=r.create();a.D0=0;a.SN=1;a.E0=2;a.C0=3;a.OT=function(a){var c=null;if(c=y.ga(y.xd))c=y.im(c,y.hl)==y.Vy||y.im(c,y.hl)==y.Ep?b.kA():b.jA(),p(a,c)};a.JR=function(){return Boolean(y.iu(y.xd))};a.U4=function(){return null};a.reset=function(){var a=y.ga(y.xd);y.Jw(a)};a.B3=function(){b.hf(null,"HMD_ROTATE_CAMERA");y.DT();var a=A.Qh();v?e.DZ(a):c?e.uJ(a):B&&e.pZ(a);e.oD(a,
w.nc);var f=k.Sh(a,D);k.mD(a,f)};a.F8=function(a){r.copy(a,z)};a.y5=function(a){r.copy(z,a);return a}};b4w.module.config=function(a,h){var p=h("__config"),e=h("__compat"),b=h("__debug"),y=h("__data"),r=h("__print");a.Mp=p.Mp;a.jl=p.jl;a.qn=p.qn;a.bF=p.bF;a.Lp=p.Lp;a.set=p.set;a.get=p.get;a.reset=p.reset;a.SC=p.SC;a.F5=p.Yu;a.Yu=p.Yu;a.zn=function(a){y.$g()?r.error("Cannot change quality profile after a scene is loaded."):(p.set("quality",a),b.av()&&(p.zn(),e.EL(b.av(),!1)))}};b4w.module.app=function(a,h){function p(){var a=x.Ir();document.addEventListener("visibilitychange",function(){document.hidden?(a=x.Ir(),x.pause()):a||x.jj()},!1)}function e(){var a=0,b=I.Ce(),c=x.Ir(),d=!0;x.Xp(function(){if(0==a%10){var f=b.getBoundingClientRect();f.top>window.innerHeight||0>f.bottom?(d&&(c=x.Ir()),x.pause(),d=!1):c||d||(x.jj(),d=!0)}a++})}function b(a,b,c,d){var f=document.createElement("canvas"),e=document.getElementById(a);e||(P.error('Warning: canvas container "'+a+'" not found, appending to body'),
e=document.body);f.style.position="absolute";f.style.left=0;f.style.top=0;f.style.width=e.offsetWidth+"px";f.style.height=e.offsetHeight+"px";f.width=e.offsetWidth*window.devicePixelRatio;f.height=e.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",f.style.left=0,f.style.top=0,a.style.pointerEvents="none"):a=null;e.appendChild(f);if(!x.Xg(f,a))return c&&K("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
d),!1;a&&I.Fv(a,"LAST");return!0}function y(a,b){a?(b&&(document.getElementById(b).style.display="block"),N=document.getElementById(a)):(N=document.createElement("div"),N.innerHTML=0,N.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",I.Fv(N,"JUST_AFTER_CANVAS"))}function r(a,b){var c=String(a);b&&(c+="/"+String(b));N.innerHTML=c}function A(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function k(a,b,c){var d=Math.max(D.DV(a),1),f=da.Sh(a,q);b=J.lc(f,b,ca);b[2]=0;F.normalize(b,b);F.scale(b,d*c,b);c=da.ie(a,ha);F.add(c,b,c);D.Wc(a,c)}function w(a,b){var c=D.sJ(a,X);if(c.up!=c.down){var d=D.em(a,E)[1],c=(c.down-d)/(c.down-c.up),d=D.rJ(a,X),c=Math.max(c,2/d.max);D.tJ(a,0,c*b)}}function n(a,b,c,d){da.fh(a,5*b,5*c,5*d)}function l(a,b,c){var d=D.KD(a),f=Math.abs(b);c=Math.pow(f*c,1-Math.pow(f*c,.15));da.fh(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function f(a,b,c,d){for(var f=c*
b;0<a;--a)c+=f,d+=f,f=c*b;return d}function v(a,b,c,d,e){e?(e=D.yZ(a,ca),a=D.ie(a),a=F.dist(e,a)+d,d=0<b?f(b,-c,a,d):f(-b,c/(1-c),a,d)):d-=2*b*c;return d}function c(a,b,c,d,f){function e(a,b,c,d){if(1==c){D.Th(a,X);var f=R?.003*X.trans:.003*X.rot;c=z.Zd(a,b,0);z.$e(a,b,0).gesture===z.Gt?(Ka+="X"==d?-c*f:0,kb+="Y"==d?-c*f:0):z.$e(a,b,0).gesture===z.Et&&(a=R?.003*X.rot:7.5E-4*X.trans,eb+="X"==d?-c*a:0,bb+="Y"==d?-c*a:0)}}function h(a){D.Th(a,X);ab-=.05*X.zoom}function m(a){D.Th(a,X);Aa-=.002*X.trans}
function p(a){D.Th(a,X);ab+=.05*X.zoom}function q(a){D.Th(a,X);Aa+=.002*X.trans}function r(a,b,c,d){if(1==c){c=z.Zd(a,b,1);D.Th(a,X);if(R)f=.003*X.trans,e=7.5E-4*X.rot;else var f=.003*X.rot,e=7.5E-4*X.trans;if(1===z.$e(a,b,0).which)La+="X"==d?-c*f:0,Ta+="Y"==d?-c*f:0;else if(2===z.$e(a,b,0).which||3===z.$e(a,b,0).which)pb+="X"==d?-c*e:0,Ua+="Y"==d?-c*e:0}}function x(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function y(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function A(a){return a[0]&&(a[1]||-.1>a[2])}
function N(a){return a[0]&&(a[1]||.1<a[2])}function K(a){return a[0]&&(a[1]||a[2]||a[3])}function I(a,b,c){if(1==c)switch(c=z.Zd(a,b,0),D.Th(a,X),b){case "FORWARD":P?va[0]=1:R?(b=D.em(a,E)[1],b=Math.abs(b)>=Math.PI/4?J.xh:J.Nc,k(a,b,.5*X.trans*c)):Q?l(a,-X.zoom,c):n(a,0,0,-X.trans*c);break;case "BACKWARD":P?va[0]=-1:R?(b=D.em(a,E)[1],b=Math.abs(b)>=Math.PI/4?J.wh:J.nc,k(a,b,.5*X.trans*c)):Q?l(a,X.zoom,c):n(a,0,0,X.trans*c);break;case "UP":R?w(a,30*-X.zoom*c):P||n(a,0,X.trans*c,0);break;case "DOWN":R?
w(a,30*X.zoom*c):P||n(a,0,-X.trans*c,0);break;case "LEFT":P?va[1]=1:R?k(a,J.Wx,.5*X.trans*c):n(a,-X.trans*c,0,0);break;case "RIGHT":P?va[1]=-1:R?k(a,J.ti,.5*X.trans*c):n(a,X.trans*c,0,0);break;case "ROT_LEFT":Q?D.Ps(a,.75*-X.rot*c,0):D.Tl(a,.75*X.rot*c,0);break;case "ROT_RIGHT":Q?D.Ps(a,.75*X.rot*c,0):D.Tl(a,.75*-X.rot*c,0);break;case "ROT_UP":Q?D.Ps(a,0,.75*-X.rot*c):D.Tl(a,0,.75*X.rot*c);break;case "ROT_DOWN":Q?D.Ps(a,0,.75*X.rot*c):D.Tl(a,0,.75*-X.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":P&&
(va[0]=0);break;case "LEFT":case "RIGHT":P&&(va[1]=0)}P&&(g.Pm(P,va[0],va[1]),a=D.fm(a,Z),g.Hk(P,a[0],a[1]))}ba=a;u=b;ga=c;var G=t.Qh();B(G);var Q=!1,P=null,R=!1;switch(D.hm(G)){case D.Kb:Q=!a;break;case D.nd:P=t.Wn();break;case D.Bg:return;case D.bd:R=!0}var X=D.Th(G,S);a=z.Rj();if(g.sB(G)){var ma=z.gA(G,null,!0);z.Y(G,"CAMERA_COLLISION",z.uf,[ma],null,function(a,b){var c=z.$e(a,b,0).coll_dist;if(0>c){var d=z.$e(a,b,0).coll_norm,f=ca;F.scale(d,-.25*c,f);c=da.ie(a,ha);F.add(c,f,c);da.JY(a,c)}})}if(P){var ma=
da.ie(G),Ba=da.Sh(G),Ba=J.Mz(Ba);ma[2]-=.5;g.Es(P,ma,Ba);L.JF(G,P,[0,0,.5]);var va=new Float32Array(2),Ma=!0;g.Gk(P,g.Yx);z.Dn(G,"TOGGLE_CHAR_MOVE_TYPE",z.vf,z.GE,function(){Ma=!Ma;g.Gk(P,Ma?g.Yx:g.yE)})}var Ga=O.BG(),ma=Ga.length?Ga[Ga.length-1]:0,Ra,H,V,Y,Cb,Ha,Ac,Sa,fa,Da;b?Ra=H=V=Y=Cb=Ha=b=ma=Ac=Sa=fa=Da=z.hA(0):(Ra=z.Ic(z.Zy),H=z.Ic(z.Yy),V=z.Ic(z.Wy),Y=z.Ic(z.Xy),Cb=z.Ic(z.vO),Ha=z.Ic(z.qO),b=z.Kq(O.xt,ma),ma=z.Kq(O.Dp,ma),Ac=z.Ic(z.KE),Sa=z.Ic(z.HE),fa=z.Ic(z.IE),Da=z.Ic(z.JE));var Ba=z.Ii(O.zp,
Ga),qa=z.Ii(O.Ap,Ga),W=z.Ii(O.Bp,Ga),Ga=z.Ii(O.Cp,Ga);R||(z.Y(G,"FORWARD",z.Qa,[a,Ra,qa],A,I),z.Y(G,"BACKWARD",z.Qa,[a,H,qa],N,I));Q?(z.Y(G,"ROT_UP",z.Qa,[a,Ac,Cb,Ga],x,I),z.Y(G,"ROT_DOWN",z.Qa,[a,Sa,Ha,Ga],y,I),z.Y(G,"ROT_LEFT",z.Qa,[a,fa,V,W],x,I),z.Y(G,"ROT_RIGHT",z.Qa,[a,Da,Y,W],y,I)):R?(z.Y(G,"LEFT",z.Qa,[a,fa,V,Ba],x,I),z.Y(G,"RIGHT",z.Qa,[a,Da,Y,Ba],y,I),z.Y(G,"FORWARD",z.Qa,[a,Ac,Ra,qa],x,I),z.Y(G,"BACKWARD",z.Qa,[a,Sa,H,qa],y,I),z.Y(G,"UP",z.Qa,[a,Ha,Ga],N,I),z.Y(G,"DOWN",z.Qa,[a,Cb,Ga],
A,I)):(z.Y(G,"UP",z.Qa,[a,Cb,b],K,I),z.Y(G,"DOWN",z.Qa,[a,Ha,ma],K,I),z.Y(G,"LEFT",z.Qa,[a,V,Ba],A,I),z.Y(G,"RIGHT",z.Qa,[a,Y,Ba],N,I),z.Y(G,"ROT_UP",z.Qa,[a,Ac,Ga],A,I),z.Y(G,"ROT_DOWN",z.Qa,[a,Sa,Ga],N,I),z.Y(G,"ROT_LEFT",z.Qa,[a,fa,W],A,I),z.Y(G,"ROT_RIGHT",z.Qa,[a,Da,W],N,I));if(!c){var Qa=0;c=z.mA(d);var ra=0,Ga=z.uA(d);z.Y(G,"MOUSE_WHEEL",z.sp,[c],null,function(a,b,c){1==c&&(b=z.Zd(a,b,0),D.Th(a,X),Q||R?Qa=v(a,b,X.zoom,Qa,Q):(X.trans*=1+b*X.zoom,D.KY(a,X)))});z.Y(G,"TOUCH_ZOOM",z.sp,[Ga],null,
function(a,b,c){1==c&&(c=z.Zd(a,b,0),D.Th(a,X),z.$e(a,b,0)===z.Ft&&(ra=v(a,c,.03*X.zoom,ra,Q)))});z.Y(G,"ZOOM_INTERPOL",z.uf,[a],null,function(a,b){if(Q||R)if(1E-5<Math.abs(Qa)||1E-5<Math.abs(ra)){var c=z.Zd(a,b,0),d=J.mc(Qa,0,c,.1*T);Qa-=d;c=J.mc(ra,0,c,.15*T);ra-=c;R?w(a,-(d+c)):(d=D.KD(a)+d+c,d=Math.max(d,.001),D.AZ(a,d))}else ra=Qa=0})}var La=0,Ta=0,pb=0,Ua=0,Aa=0,ab=0;Q?(z.Y(G,"GMPD_PAN_Y_POS",z.Qa,[b],null,p),z.Y(G,"GMPD_PAN_Y_NEG",z.Qa,[ma],null,h),z.Y(G,"GMPD_PAN_X_POS",z.Qa,[Ba],function(a){return-.1>
a[0]},m),z.Y(G,"GMPD_PAN_X_NEG",z.Qa,[Ba],function(a){return.1<a[0]},q)):R&&(z.Y(G,"GMPD_PAN_X_POS",z.Qa,[W],function(a){return-.1>a[0]},m),z.Y(G,"GMPD_PAN_X_NEG",z.Qa,[W],function(a){return.1<a[0]},q));if(f){f=z.Il("X",window);c=z.Il("Y",window);b=z.En(d);var ma=z.En(window),Ya=!1,Ba=function(a){a[2]?Ya=!0:a[0]||(Ya=!1);return Ya&&a[0]};z.Y(G,"MOUSE_X",z.uf,[ma,f,b],Ba,r,"X");z.Y(G,"MOUSE_Y",z.uf,[ma,c,b],Ba,r,"Y");f=O.ga(O.ad,window);O.ID(f,!1)}else f=z.Il("X",d),c=z.Il("Y",d),b=z.En(d),z.Y(G,"MOUSE_X",
z.uf,[b,f],null,r,"X"),z.Y(G,"MOUSE_Y",z.uf,[b,c],null,r,"Y");var Ka=0,kb=0,eb=0,bb=0;f=z.Nq("X",d);d=z.Nq("Y",d);z.Y(G,"TOUCH_X",z.uf,[f],null,e,"X");z.Y(G,"TOUCH_Y",z.uf,[d],null,e,"Y");z.Y(G,"ROT_TRANS_INTERPOL",z.uf,[a],null,function(a,b){if(1E-5<Math.abs(La)||1E-5<Math.abs(Ta)||1E-5<Math.abs(Ka)||1E-5<Math.abs(kb)||1E-5<Math.abs(pb)||1E-5<Math.abs(Ua)||1E-5<Math.abs(eb)||1E-5<Math.abs(bb)||1E-5<Math.abs(Aa)||1E-5<Math.abs(ab)){var c=z.Zd(a,b,0),d=J.mc(La,0,c,.08*T),f=J.mc(Ta,0,c,.08*T);La-=d;
Ta-=f;var e=J.mc(Ka,0,c,.12*T),h=J.mc(kb,0,c,.12*T);Ka-=e;kb-=h;var l=J.mc(pb,0,c,.08*T),m=J.mc(Ua,0,c,.08*T);pb-=l;Ua-=m;var n=J.mc(eb,0,c,.12*T),p=J.mc(bb,0,c,.12*T);eb-=n;bb-=p;var q=J.mc(Aa,0,c,.08*T),c=J.mc(ab,0,c,.08*T);Aa-=q;ab-=c;Q?(D.Ps(a,d+e,f+h),f=D.KD(a),D.zZ(a,f*(l+n+q),f*(m+p+c))):R?(d+e&&k(a,J.ti,.2*(d+e)),f+h&&(m=D.em(a,E)[1],k(a,Math.abs(m)>Math.PI/4?J.wh:J.nc,.2*(f+h))),D.tJ(a,l+n+q,0)):(D.Tl(a,.5*(d+e),.5*(f+h)),P&&(l=D.fm(a,Z),g.Hk(P,l[0],l[1])))}});z.Dn(G,"DEC_STEREO_DIST",z.vf,
z.tO,function(a){var b=D.XI(a);D.OL(a,.9*b)});z.Dn(G,"INC_STEREO_DIST",z.vf,z.wO,function(a){var b=D.XI(a);D.OL(a,1.1*b)})}function B(a){var b=D.hm(a),d=z.fA(function(){var c=D.hm(a),d=c!=b;b=c;return d});z.Y(a,"CHANGE_MOVE_STYLE",z.uf,[d],null,function(){Q();c(ba,u,ga)})}function Q(){var a=t.Qh();z.uq(a,"TOGGLE_CHAR_MOVE_TYPE")&&t.Wn()&&L.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)z.hf(a,b[c])}function K(a,b,c,d){var f=document.createElement("div"),e=document.createElement("div"),g=document.createElement("div");if(d)for(var k=0;k<d.length;k++){var h=document.getElementById(d[k]);h&&h.parentNode.removeChild(h)}f.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";e.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";e.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";f.appendChild(e);f.appendChild(g);document.body.appendChild(f)}function G(a,b,c,d,f){function e(){var k=performance.now()-g;f(b+k*(c-b)/d);(k>=d||!a.parentNode)&&x.GX(e)}var g=performance.now();x.Xp(e)}h("animation");var D=h("camera"),R=h("config"),L=h("constraints"),I=h("container"),z=h("controls"),d=h("data"),m=h("debug"),O=h("input"),x=h("main"),g=h("physics"),P=h("print"),t=h("scenes"),da=h("transform"),J=h("util"),F=h("vec3"),T=1,N=null,ba=!1,u=!1,ga=
!1,Z=new Float32Array(2),E=new Float32Array(2),ca=new Float32Array(3),ha=new Float32Array(3);new Float32Array(3);var q=new Float32Array(4),S={},X={};a.Xg=function(a){function c(){var a=b(h,K,F,l),d=I.gm();if(a){var f=I.Ce();I.Bk();A&&(y(n,u),x.oY(r));v&&(p(),e());q&&x.Xp(function(){f.style.height=f.clientWidth/q+"px"});k&&x.Xp(function(){I.Bk()});D&&x.Xp(function(){I.VA()});w&&R.SC();N==R.Lp?m.JM(function(a,b){0==a?(P.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),R.zn(R.jl)):1.5>b?(P.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),R.zn(R.Mp)):(P.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),R.zn(R.jl));g(d,!0)}):g(d,!0)}else g(d,!1)}function f(a){a.keyCode==z.uO&&(x.Ir()?x.jj():x.pause())}function g(){}a=a||{};var k=!1,h=null,l=null,n=null,q=0,u=null,t=!0,w=!1,v=!0,F=!0,B=!1,A=!1,E=!1,D=!1,N=R.get("quality"),G;for(G in a)switch(G){case "canvas_container_id":h=a.canvas_container_id;break;case "callback":g=a.callback;break;case "autoresize":k=a.autoresize;break;case "show_hud_debug_info":E=a.show_hud_debug_info;
break;case "sfx_mix_mode":B=a.sfx_mix_mode;break;case "show_fps":A=a.show_fps;break;case "track_container_position":D=a.track_container_position;break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":n=a.fps_elem_id;break;case "error_purge_elements":l=a.error_purge_elements;break;case "report_init_failure":F=a.report_init_failure;break;case "pause_invisible":v=a.pause_invisible;break;case "key_pause_enabled":t=a.key_pause_enabled;break;case "force_container_ratio":q=a.force_container_ratio;
break;case "min_capabilities":w=a.min_capabilities;break;case "quality":N=a.quality;break;default:R.set(G,a[G])}N!=R.Lp&&R.set("quality",N);t&&document.addEventListener("keydown",f,!1);R.set("show_hud_debug_info",E);R.set("sfx_mix_mode",B);var K=E||B||null;"complete"==document.readyState?window.setTimeout(c,0):window.addEventListener("load",c,!1);window.addEventListener("unload",function(){d.ua()},!1)};a.Bk=function(){P.Sb("app.resize_to_container","container.resize_to_container");I.Bk()};a.w8=function(a,
b){var c=A(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.v8=function(a,b){var c=A(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.x8=function(a,b){var c=A(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.J3=c;a.y3=Q;a.X7=function(a){P.Oh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=t.Qh();D.hD(b,a)};a.M3=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,f){if(1==f)switch(f=z.Zd(a,b,0),b){case "FORWARD":d?g.kp(a,1):da.fh(a,0,-1*f,0);break;case "BACKWARD":d?g.kp(a,-1):da.fh(a,0,1*f,0);break;case "LEFT":d?g.jp(a,-1):da.fh(a,1*f,0,0);break;case "RIGHT":d?g.jp(a,1):da.fh(a,-1*f,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&g.kp(a,0);break;case "LEFT":case "RIGHT":d&&g.jp(a,0)}}var d=g.bf(a)||g.cf(a),f=z.Rj(),e=z.Ic(z.Zy),k=z.Ic(z.Yy),h=z.Ic(z.Wy),l=z.Ic(z.Xy),m=z.Ic(z.KE),n=z.Ic(z.HE),p=z.Ic(z.IE),q=z.Ic(z.JE);z.Y(a,
"FORWARD",z.Qa,[f,e,m],b,c);z.Y(a,"BACKWARD",z.Qa,[f,k,n],b,c);z.Y(a,"LEFT",z.Qa,[f,h,p],b,c);z.Y(a,"RIGHT",z.Qa,[f,l,q],b,c)};a.C3=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)z.hf(a,b[c])};a.K3=function(){P.O("app.enable_controls() deprecated")};a.z3=function(){P.O("app.disable_controls() deprecated")};a.L3=function(){z.Dn(null,"CAMERA_SHOT",z.vf,z.rO,function(){m.HW()});z.Dn(null,"LIGHT_SHOT",z.vf,z.sO,function(){m.KW()});z.Dn(null,"TELEMETRY",z.vf,z.zO,function(){m.BC()})};
a.K7=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",
d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():P.error("B4W App: request fullscreen method is not supported")};a.T3=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&P.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.O2=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.J7=K;a.M5=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var f=b[d].split("="),e=f[0];1<f.length?(f=
f[1],a?e in c?c[e].push(f):c[e]=[f]:c[e]=f):a?e in c||(c[e]=[]):c[e]=""}return c};a.pT=function(a,b,c,d,f,e,g,k){function h(f){a&&(l[b]=e+f+g,c>d&&f<=d||c<d&&f>=d)&&(l[b]=e+d+g,k())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(f)){e=e||"";g=g||"";k=k||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;G(a,c,d,f,h)}};a.UQ=function(a,b,c,d,f,e){function g(f){a&&
(0<=f&&a.setAttribute(b,f),c>d&&f<=d||c<d&&f>=d)&&(a.setAttribute(b,d),e())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(f)&&(e=e||function(){},G(a,c,d,f,g))};a.BX=function(b){if(b.length){var c=b.shift(),d=c.elem,f=c.prop,e=c.from,g=c.to,k=c.duration,h=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.BX(b)};"css"==c.type?a.pT(d,f,e,g,k,h,l,m):"attr"==c.type&&a.UQ(d,f,e,g,k,m)}};a.Y7=function(a){T=a};a.t4=function(){return T}};b4w.module.animation=function(a,h){var p=h("__animation"),e=h("__armature"),b=h("__obj_util"),y=h("__print"),r=h("__tsr");a.od=p.od;a.cF=p.cF;a.dF=p.dF;a.eF=p.eF;a.fF=p.fF;a.gF=p.gF;a.hF=p.hF;a.Ht=p.Ht;a.kl=p.kl;a.UE=p.UE;a.az=p.az;a.bz=p.bz;a.XE=p.XE;a.WE=p.WE;a.VE=p.VE;a.TE=p.TE;a.rE=p.rE;a.sE=p.sE;a.Rx=p.Rx;var A=r.create();a.Dc=function(a){return p.Dc(a)};a.gI=function(a){return p.uK(a)?p.gI(a):[]};a.B4=function(a,b){if(!p.Dc(a))return null;b=b||p.od;return p.MU(a,b)};a.apply=function(a,b,e){if(e>
p.Ht)y.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||p.od;if(p.Dc(a)){var h=p.gv(a,b);if(-1!=h&&h!=e){y.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+h+'").');return}}p.sN(a,b)?p.apply(a,null,b,e):y.error('No fcurves in action "'+b+'"')}};a.j2=function(a,b,e){if(e>p.Ht)y.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=
e||p.od;var h=b[0];if(p.Dc(a)){var f=p.gv(a,h);if(-1!=f&&f!=e){y.error('Animation "'+h+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}p.sN(a,h)?p.apply(a,b.slice(1),h,e):y.error('No fcurves in action "'+h+'"')}};a.remove=function(a){p.remove(a)};a.$K=function(a,b){p.Dc(a)&&(b=b||p.od,p.$K(a,b))};a.Wt=function(a){p.Wt(a)};a.play=function(a,b,e){p.Dc(a)?(e=e||p.od,p.play(a,b,e),p.m_(a,0,e,!0)):y.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){p.Dc(a)&&
(b=b||p.od,p.stop(a,b))};a.fk=function(a,b){if(!p.Dc(a))return!1;b=b||p.od;return p.fk(a,b)};a.Fo=function(a,b,e){p.Dc(a)&&(e=e||p.od,p.Fo(a,b,e))};a.dD=function(a,b){p.Dc(a)&&p.dD(a,b)};a.m8=function(a,b){if(p.Dc(a)){b=b||p.od;var e=p.aB(a,b),h=p.$A(a,b);p.Fo(a,e+h-p.AO,b)}};a.rr=function(a,b){if(!p.Dc(a))return 0;b=b||p.od;return p.qI(a,b)};a.ML=function(a,b,e){p.Dc(a)&&(e=e||p.od,p.ML(a,b||1,e))};a.VI=function(a,b){if(!p.Dc(a))return 0;b=b||p.od;return a.ja[b]?p.VI(a,b):0};a.aB=function(a,b){return p.Dc(a)&&
(b=b||p.od,a.ja[b])?p.aB(a,b):-1};a.$A=function(a,b){return p.Dc(a)&&(b=b||p.od,a.ja[b])?p.$A(a,b):-1};a.Bs=function(a,b,e){p.Dc(a)&&(e=e||p.od,p.Bs(a,b,e))};a.kI=function(a,b){if(!p.Dc(a))return null;b=b||p.od;return p.kI(a,b)};a.LF=function(a,b,e,h){h=h||p.od;p.Dc(a)&&p.LF(a,b,e,h)};a.TH=function(a){return p.TH(a)};a.q4=function(a,h,n){y.Sb("get_bone_translation","armature.get_bone_tsr");if(!b.om(a))return null;if(!e.FR(a,h))return y.error('There is no bone: "',h,'" in "',a.name,'".'),null;n||(n=
new Float32Array(3));e.Zu(a,h,!1,A);n[0]=A[0];n[1]=A[1];n[2]=A[2];return n};a.M4=function(){y.O("get_first_armature_object() deprecated");return null};a.gv=function(a,b){return p.Dc(a)&&b?p.gv(a,b):-1};a.hI=function(a,b){return p.Dc(a)?p.hI(a,b):null};a.MF=function(a,b){return p.MF(a,b)};a.E5=function(a){return a.k.Fh};a.KL=function(a,e,h){b.om(a)?(e=Math.min(Math.max(e,0),1),a.k.Fh!=e&&p.KL(a,e,h||0)):y.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.data=function(a,h){var p=h("__data"),e=h("__loader");h("__print");a.load=p.load;a.yx=function(a){p.yx(a|0)};a.vL=p.vL;a.$g=p.$g;a.H6=e.pm;a.U6=p.load;a.ua=a.yx;a.CF=p.CF;a.IK=p.IK;a.ZM=p.ZM};b4w.module.debug=function(a,h){function p(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var f=d.split(" ")[0];f in b||(b[f]=0);b[f]++}}d=c=a=0;for(f in b)switch(f){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[f];a+=b[f];break;case "ATTRIB":d+=b[f];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[f]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function e(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;G.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.WA.ALL_OPS-a.WA.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.WA,f=c.V_,e=y(c.nT),e=e.length?"\t\t("+e.join(", ")+")":"\t\t(NA)";G.groupCollapsed("VERT ->","OPS",f.ALL_OPS,"ATT",f.ATTRIBS,"TEX",f.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,e);G.groupCollapsed("directives");for(var g=c.ib.Mi.slice().sort(),e=0;e<g.length;e++){var h=g[e];G.ae(h[0],h[1])}G.groupEnd();G.groupCollapsed("node elements");g=c.ib.og;for(e=0;e<g.length;e++)G.ae(g[e]);G.groupEnd();G.groupCollapsed("vert source");G.ae(c.T_);G.groupEnd();G.groupCollapsed("vert translated source");G.ae(c.U_);G.groupEnd();e=["ALL_OPS","TEX_OPS","ATTRIBS"];G.groupCollapsed("vert ops stats");for(var k in f)-1==e.indexOf(k)&&G.ae(k,f[k]);
G.groupEnd();G.groupCollapsed("vert assembly");G.ae(c.S_);G.groupEnd();G.groupCollapsed("frag source");G.ae(c.xU);G.groupEnd();G.groupCollapsed("frag translated source");G.ae(c.yU);G.groupEnd();G.groupCollapsed("frag ops stats");for(k in d)-1==e.indexOf(k)&&G.ae(k,d[k]);G.groupEnd();G.groupCollapsed("frag assembly");G.ae(c.oU);G.groupEnd();G.groupEnd()}}function y(a){for(var b=[],c=R.pr(),d=0;d<c.length;d++)for(var f=c[d],e=B.Ub(f,"MESH",B.oc),g=0;g<e.length;g++){var h=Q.ka(e[g],f);if(h&&h.W.length)for(var h=
h.W,k=0;k<h.length;k++){var l=h[k];if(l.zb==a)for(var m=0;m<l.sd.length;m++){var n=l.sd[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function r(a,b){function c(){P.push(c);t=b;return a.apply(a,arguments)}return c}function A(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var k=h("__config"),w=h("__compat"),n=h("__controls"),l=h("__container"),
f=h("__debug"),v=h("__extensions"),c=h("__loader"),B=h("__objects"),Q=h("__obj_util"),K=h("__physics"),G=h("__print"),D=h("__renderer"),R=h("__scenes"),L=h("__scenegraph"),I=h("__sfx"),z=h("__shaders"),d=h("__subscene"),m=h("__textures"),O=h("__util"),x=h("__vec3"),g=k.B,P=[],t="",da=!0,J=new Float32Array(2);a.qt=f.qt;a.ky=f.ky;a.rt=f.rt;a.jy=f.jy;a.pt=f.pt;a.iy=f.iy;a.hy=f.hy;a.xp=f.xp;a.v7=function(){K.wT()};a.u7=function(a){G.log("O",K.kU(a));for(var b=K.KU().zc.sa,c=0;c<b.length;c++){var d=b[c];
d.C.fa==a&&G.log("B",d)}};a.T9=function(){for(var a=R.A(),b=B.Ub(a,"MESH",B.oc),a=[R.La(a,d.Pb),R.La(a,d.Pc),R.La(a,d.ge)],c=0;c<a.length;c++){var f=a[c],e=subs.Ra;if(e.length){G.group(f.type,"DYNAMIC");for(var g=0;g<b.length;g++){var h=b[g],k=h.k;if("DYNAMIC"==k.type)for(var l=!1,m=0;m<e.length;m++){for(var n=e[m].sa,p=0;p<n.length;p++){var r=n[p];if(r.cc&&r.ff==k){G.ae(h.name,h);l=!0;break}}if(l)break}}G.groupEnd();G.groupCollapsed(f.type,"STATIC");for(g=0;g<b.length;g++)if(h=b[g],k=h.k,"DYNAMIC"!=
k.type)for(l=!1,m=0;m<e.length;m++){n=e[m].sa;for(p=0;p<n.length;p++)if(r=n[p],r.cc&&r.ff==k){G.ae(h.name,h);l=!0;break}if(l)break}G.groupEnd()}}};a.n7=function(a){for(var b=R.A(),c=B.Ub(b,"MESH",B.oc),d=0;d<c.length;d++){var f=c[d];if(f.name==a){G.log("Object",f);for(var e=R.ZA(b),g=0;g<e.length;g++){for(var h=e[g],k=[],l=h.Ra,m=0;m<l.length;m++)for(var n=l[m].sa,p=0;p<n.length;p++)n[p].ff==f.k&&k.push(n[p]);G.log("Subscene "+h.type,k)}}}};a.o7=function(){var a=R.A();console.log("Armatures: "+B.Ub(a,
"ARMATURE",B.oc).length);console.log("Cameras: "+B.Ub(a,"CAMERA",B.oc).length);console.log("Curves: "+B.Ub(a,"CURVE",B.oc).length);console.log("Empties: "+B.Ub(a,"EMPTY",B.oc).length);console.log("Lamps: "+B.Ub(a,"LAMP",B.oc).length);console.log("Meshes: "+B.Ub(a,"MESH",B.oc).length);console.log("Speakers: "+B.Ub(a,"SPEAKER",B.oc).length)};a.Yr=function(){for(var a=0,b=R.A(),b=[R.La(b,d.Pb),R.La(b,d.Pc),R.La(b,d.ge)],c=0;c<b.length;c++){var f=b[c];if(f)for(var f=f.Ra,e=0;e<f.length;e++)for(var g=
f[e].sa,h=0;h<g.length;h++){var k=g[h].za;k&&(a+=k.Yr)}}return a};a.Cm=function(){for(var a=0,b=R.A(),b=[R.La(b,d.Pb),R.La(b,d.Pc),R.La(b,d.ge)],c=0;c<b.length;c++){var f=b[c];if(f)for(var f=f.Ra,e=0;e<f.length;e++)for(var g=f[e].sa,h=0;h<g.length;h++){var k=g[h].za;k&&(a+=k.Cm)}}return a};a.h7=function(){for(var a=R.A(),b=R.CD(a,[d.Pb,d.Pc,d.ge,d.Nd,d.xf]),c=0,f=0;f<b.length;f++)for(var e=b[f],e=e.Ra,g=0;g<e.length;g++)c+=e[g].sa.length;a=R.CD(a,[d.md,d.Oe]);for(f=0;f<a.length;f++)for(e=a[f],e=e.Ra,
g=0;g<e.length;g++)c+=6*e[g].sa.length;return c};a.k7=function(){return O.qr(z.pI())};a.o4=function(){for(var a=R.A(),b=R.ZA(a),a={},c=0;c<b.length;c++){var f=b[c];if(f.type!=d.tn&&f.type!=d.wf)for(var e=f.Ra,g=0;g<e.length;g++)for(var h=e[g].sa,k=0;k<h.length;k++){var l=h[k].za,m=h[k].ff;l&&(f.type!=d.tf&&f.type!=d.Cg||m.pw||m.ow)&&(a[l.id]=l)}}var c=b=0,n;for(n in a)f=a[n].Ca,f.Gn&&(c+=f.Gn/1048576),b+=f.In/1048576;return{vbo_memory:b,ibo_memory:c}};a.l7=function(){for(var a=[],b=0,c=R.A(),c=[R.La(c,
d.Pb),R.La(c,d.Pc),R.La(c,d.ge)],f=0;f<c.length;f++){var e=c[f];if(e)for(var e=e.Ra,g=0;g<e.length;g++)for(var h=e[g].sa,k=0;k<h.length;k++){var l=h[k].za;if(l)for(var l=l.ya,m=0;m<l.length;m++){var n=l[m];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var p=n.sb;-1===a.indexOf(p)&&(a.push(p),n=n.width*n.height*4/1048576/n.Hq,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.j7=function(){for(var a=[],b=0,c=R.A(),c=R.ZA(c),f=0;f<c.length;f++){var e=c[f];if(e.type!=d.tn){var g=e.p,h=[g.wc,
g.Ve];h.push.apply(h,e.mi);for(e=0;e<h.length;e++){var k=h[e];m.fo(k)&&-1==a.indexOf(k)&&(a.push(k),b+=g.width*g.height*m.qV(k))}}}return{number:a.length,memory:b/1024/1024}};a.HW=function(){var a=R.A();(a=R.La(a,d.Pb))&&R.ZJ(a.p,a,[1,1,0])};a.KW=function(){var a=R.A(),b=R.La(a,d.Pb),a=R.CD(a,[d.cd]);if(b)for(var c=0;c<a.length;c++){var f=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}R.ZJ(f.p,b,e)}};a.T7=function(){for(var a=R.pr(),b=0;b<a.length;b++)G.log("\n"+
L.tT(R.gB(a[b])))};a.U7=function(){};a.W6=function(){G.log("\n"+c.vV())};a.j3=n.debug;a.m7=function(a,b){return x.dist(m_tsr.G(a.k.n),m_tsr.G(b.k.n))};a.gK=f.gK;a.Qu=f.Qu;a.MK=f.MK;a.BC=f.BC;a.a4=function(a,b){function c(){f.Qu("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.s2=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),f=new Float32Array([0,0,1]),e=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,
0,-1]);if(!O.Mj(a,O.jF))throw"Wrong VEC3_IDENT";if(!O.Mj(b,O.rn))throw"Wrong QUAT4_IDENT";if(!O.Mj(c,O.ti))throw"Wrong AXIS_X";if(!O.Mj(d,O.xh))throw"Wrong AXIS_Y";if(!O.Mj(f,O.nc))throw"Wrong AXIS_Z";if(!O.Mj(e,O.Wx))throw"Wrong AXIS_MX";if(!O.Mj(g,O.wh))throw"Wrong AXIS_MY";if(!O.Mj(h,O.Nc))throw"Wrong AXIS_MZ";};a.f7=function(){for(var a=I.oV(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==I.lB(c)&&I.qc(c,!0)}};a.CG=function(a){f.CG(a)};a.f8=function(a){var b=R.A();if(b=R.La(b,d.wf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case f.qt:case f.ky:case f.rt:case f.jy:case f.pt:case f.iy:case f.hy:case f.xp:R.jY(b,a.debug_view_mode);break;default:G.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&R.iY(b,a.debug_colors_seed);"number"==typeof a.NX&&R.EY(b,a.NX);"object"==typeof a.wireframe_edge_color&&R.PY(b,O.Ef(a.wireframe_edge_color))}else G.error("Debugging is not available on the scene.")};a.H4=function(){return G.VU()};a.Z5=function(){return G.tV()};
a.OG=function(){return G.OG()};a.W1=function(a){var c=z.pI(),d=0,g;for(g in c)a&&-1===g.indexOf(a)||d++;var d="of "+d+" analyzing...",h={};for(g in c)if(!a||-1!==g.indexOf(a)){var k=c[g],l;var m=k.Kx;l=k.Vu;var n=v.SU();if(n){var r=n.getTranslatedShaderSource(m),n=n.getTranslatedShaderSource(l);if(w.Zf())var r=r.replace("#version","#version 300 //"),n=n.replace("#version","#version 300 //"),q=e("/analyze_shader/vert_gles",r),t=e("/analyze_shader/frag_gles",n);else r=r.replace("#version","#version 400 //"),
n=n.replace("#version","#version 400 //"),q=e("/analyze_shader/vert",r),t=e("/analyze_shader/frag",n);var x=p(q),y=p(t);l={T_:f.av().getShaderSource(m),U_:r,S_:q,V_:x,xU:f.av().getShaderSource(l),yU:n,oU:t,WA:y}}else G.error("WEBGL_debug_shaders extension not found"),l=void 0;r=k.ib;m=r.yg+" + "+r.Xe;l.nT=k;l.ib=r;k=h[m]=h[m]||[];k.push(l);G.ae(d)}for(m in h)G.group("%c"+m,"color: #800"),k=h[m],b(k),G.groupEnd()};a.NH=f.NH;a.JM=function(b){if(z.HG())if(v.eB()){var c=g.gl_debug;g.gl_debug=!0;var e=
L.ES();R.$H(null,e);for(var h=L.gc(e,d.Kp),k=h.p,e=0;5>e;e++)D.Mn(h);g.gl_debug=c;window.setTimeout(function(){f.zX(h);var a=h.Cf;b(a,k.width*k.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.JM(b)},100)};a.pG=f.pG;a.bM=f.bM;a.LK=f.LK;a.g9=function(a){P=[];da=!0;a=h(a);for(var b in a)"function"===typeof a[b]&&(a[b]=r(a[b],b))};a.N2=function(){return da};a.test=function(a,b){try{return b(),!0}catch(c){return da=!1,console.error(a+" test was failed. ",c),!1}};
a.x7=function(a){var b=l.cJ(),c=l.bJ(),d=b/2,f=c/2;l.resize(b,c,!1);b=R.A().s.Xa;(c=L.lU(b))||O.q("Couldn't find onscreen subscene");b=c.p;d=l.ju(d,f,J,c.p);d[1]=b.height-d[1];d=D.LC(b.Ze,d[0],d[1]);A(a,d,1)};a.P3=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+t;};a.Q3=A;a.O3=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.N3=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
h(a);for(var b in a)-1==P.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.p7=function(a){if(!Boolean(a))throw"Wrong result. Function: "+t;}};b4w.module.preloader=function(a,h){var p=h("container"),e,b,y,r,A,k,w,n,l=null;a.FS=function(){var a="#000",h="#5276cf",c="#fff",k="#fff",l;for(l in void 0)switch(l){case "container_color":a=(void 0).container_color;break;case "bar_color":h=(void 0).bar_color;break;case "frame_color":c=(void 0).frame_color;break;case "font_color":k=(void 0).font_color}l=document.createElement("div");var n=l.cloneNode(),w=l.cloneNode(),A=l.cloneNode(),R=p.Ce();w.appendChild(n);w.appendChild(A);l.appendChild(w);R.appendChild(l);
l.style.cssText="background-color: "+a+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";w.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+c+";";n.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+h+";height: 100%;";A.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
k+";";e=n;b=A;y=l;r="DEFAULT"};a.r3=function(a){var h=null,c=null,k="#bf9221",n="#000",p;for(p in a)switch(p){case "canvas_container_id":h=a.canvas_container_id;break;case "background_container_id":c=a.background_container_id;break;case "bg_color":n=a.bg_color;break;case "bar_color":k=a.bar_color}a=document.createElement("div");p=document.createElement("div");a.id="simple_preloader_container";var w=document.createElement("div"),D=document.createElement("div"),c=document.getElementById(c);l=document.getElementById(h);
a.style.cssText="z-index: 4;background-color: "+n+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";p.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";w.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+k+";border-radius: 0px;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
p.appendChild(w);p.appendChild(D);a.appendChild(p);document.body.appendChild(a);r="SIMPLE";y=a;e=w;b=D;A=c};a.p3=function(a){var e=null,c=null,h="rgba(0,0,0,0)",n="",p="",w="rgba(0,0,0,0)",D;for(D in a)switch(D){case "canvas_container_id":e=a.canvas_container_id;break;case "background_container_id":c=a.background_container_id;break;case "frame_bg_color":h=a.frame_bg_color;break;case "bg_color":w=a.bg_color;break;case "frame_class":n=a.frame_class;break;case "anim_elem_class":p=a.anim_elem_class}a=
document.createElement("div");D=document.createElement("div");var R=document.createElement("div"),L=document.createElement("div"),c=document.getElementById(c);l=document.getElementById(e);a.style.cssText="z-index: 4;background-color: "+w+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+h+";";R.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";
L.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";R.className=p;D.appendChild(R);D.className=n;D.appendChild(L);a.appendChild(D);l.appendChild(a);r="ROTATION";y=a;k=R;b=L;A=c};a.n3=function(a){var h=a.preloader_width,h=h/(h-a.img_width),c=document.getElementById(a.preloader_bar_id),k=document.getElementById(a.fill_band_id),p=document.getElementById(a.preloader_caption_id),K=document.getElementById(a.preloader_container_id),
G=document.getElementById(a.background_container_id);l=document.getElementById(a.canvas_container_id);r="ADVANCED";e=c;w=k;n=h;b=p;y=K;A=G};a.s_=function(a){b.innerHTML=a+"%";"SIMPLE"==r?e.style.width=a+"%":"ADVANCED"==r?(e.style.width=a/n+"%",w.style.width=100-a+"%"):"ROTATION"==r?k.style.transform="rotate("+a+"deg)":"DEFAULT"==r&&(e.style.width=a+"%");100==a&&(y.parentNode.removeChild(y),A&&A.parentNode.removeChild(A))}};"object"==typeof module&&module.PA&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,h){h("__print");var p=h("__version");a.version=p.version;a.jE=p.jE;a.type=p.type;a.uH=p.uH;a.zA=p.zA};"object"==typeof module&&module.PA&&b4w.module.version(exports);if(b4w.module_check("environment"))throw"Failed to register module: environment";b4w.register("environment",function(a,h){var p=h("lights");a.IV=function(){p.hY()}});if(b4w.module_check("character"))throw"Failed to register module: character";b4w.register("character",function(a,h){function p(){console.log("Model_position: "+n.C.Qq);console.log("Phys_body_position: "+w.C.Qq)}var e=h("fps"),b=h("scenes"),y=h("constraints"),r=h("transform"),A=h("physics"),k=new Float32Array(3),w,n,l=new Float32Array(4);a.HV=function(){var a=b.kV(),h=r.ie(a);r.Sh(a,l);w=b.HI("Character");n=b.HI("CharModel");k=[0,-3,-.85];y.wQ(n,w,k);A.Es(w,[h[0],h[1],h[2]],l);e.NT(w,p)}});if(b4w.module_check("system"))throw"Failed to register module: system";b4w.register("system",function(a,h){var p=h("config");a.MV=function(){p.set("max_fps",45);p.set("max_fps_physics",500)}});b4w.register("project_ow_app",function(a,h){function p(a,f){f?(k.FS(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},A.load(c+"project_ow.json",b,e)):console.log("b4w init failure")}function e(a){k.s_(a)}function b(a,b){b?(n.MV(),f.IV(),l.HV()):console.log("b4w load failure")}var y=h("app"),r=h("config"),A=h("data"),k=h("preloader"),w=h("version"),n=h("system"),l=h("character"),f=h("environment"),v="DEBUG"==w.type(),c=r.Yu("project_ow");a.Xg=function(){y.Xg({canvas_container_id:"main_canvas_container",
callback:p,show_fps:v,console_verbose:v,autoresize:!0,key_pause_enabled:!0})}});b4w.require("project_ow_app").Xg();
