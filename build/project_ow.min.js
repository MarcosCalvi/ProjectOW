var b4w="object"===typeof b4w?b4w:function(a){var r={};a.module=r;var m={};a.sa=function(a,b){var t=r[a];t&&(t.an=null);m[b||"__b4w_default"]=null};a.register=function(a,b){r[a]||(r[a]=b)};a.require=function(a,b){if(!r[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";m[b]||(m[b]=function(a){return function(b){var d=r[b];if(!d)throw Error('Module "'+b+'" not found');d.an||(d.an={});d.an[a]||(d.an[a]={},d(d.an[a],m[a]));return d.an[a]}}(b));return m[b](a)};a.module_check=function(a){return r[a]?
!0:!1};a.get_namespace=function(a){for(var b in m)if(m[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.app=function(a,r){function m(){var a=v.jr();document.addEventListener("visibilitychange",function(){document.hidden?(a=v.jr(),v.pause()):a||v.cj()},!1)}function d(){var a=0,b=M.We(),e=v.jr(),c=!0;v.Ap(function(){if(0==a%10){var d=b.getBoundingClientRect();d.top>window.innerHeight||0>d.bottom?(c&&(e=v.jr()),v.pause(),c=!1):e||c||(v.cj(),c=!0)}a++})}function b(a,b,e,c){var d=document.createElement("canvas"),g=document.getElementById(a);g||(R.error('Warning: canvas container "'+a+'" not found, appending to body'),
g=document.body);d.style.position="absolute";d.style.left=0;d.style.top=0;d.style.width=g.offsetWidth+"px";d.style.height=g.offsetHeight+"px";d.width=g.offsetWidth*window.devicePixelRatio;d.height=g.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",d.style.left=0,d.style.top=0,a.style.pointerEvents="none"):a=null;g.appendChild(d);if(!v.Tg(d,a))return e&&H("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
c),!1;a&&M.lv(a,"LAST");return!0}function t(a,b){a?(b&&(document.getElementById(b).style.display="block"),U=document.getElementById(a)):(U=document.createElement("div"),U.innerHTML=0,U.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",M.lv(U,"JUST_AFTER_CANVAS"))}function q(a,b){var e=String(a);b&&(e+="/"+String(b));U.innerHTML=e}function z(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function n(a,b,e){var c=Math.max(D.dV(a),1),d=ba.En(a,u);b=J.kc(d,b,Y);b[2]=0;B.normalize(b,b);B.scale(b,c*e,b);e=ba.Bf(a,ia);B.add(e,b,e);D.Uc(a,e)}function x(a,b){var e=D.ZI(a,ca);if(e.up!=e.down){var c=D.Bn(a,I)[1],e=(e.down-c)/(e.down-e.up),c=D.YI(a,ca),e=Math.max(e,2/c.max);D.$I(a,0,e*b)}}function h(a,b,e,c){ba.$g(a,5*b,5*e,5*c)}function k(a,b,e){var c=D.nD(a),d=Math.abs(b);e=Math.pow(d*e,1-Math.pow(d*e,.15));ba.$g(a,0,0,0>b?.001<c?-c*e:0:e/(1-e)*c)}function f(a,b,e,c){for(var d=
e*b;0<a;--a)e+=d,c+=d,d=e*b;return c}function y(a,b,e,c,d){d?(d=D.RY(a,Y),a=D.Bf(a),a=B.dist(d,a)+c,c=0<b?f(b,-e,a,c):f(-b,e/(1-e),a,c)):c-=2*b*e;return c}function g(a,b,c,d,g){function l(a,G,T,b){if(1==T){D.Lh(a,N);var da=ca?.003*N.trans:.003*N.rot;T=F.ag(a,G,0);F.Kh(a,G,0).gesture===F.ht?(La+="X"==b?-T*da:0,hb+="Y"==b?-T*da:0):F.Kh(a,G,0).gesture===F.ft&&(a=ca?.003*N.rot:7.5E-4*N.trans,jb+="X"==b?-T*a:0,ab+="Y"==b?-T*a:0)}}function u(a){D.Lh(a,N);kb-=.05*N.zoom}function f(a){D.Lh(a,N);Aa-=.002*
N.trans}function m(a){D.Lh(a,N);kb+=.05*N.zoom}function R(a){D.Lh(a,N);Aa+=.002*N.trans}function q(a,G,T,b){if(1==T){T=F.ag(a,G,1);D.Lh(a,N);if(ca)da=.003*N.trans,e=7.5E-4*N.rot;else var da=.003*N.rot,e=7.5E-4*N.trans;if(1===F.Kh(a,G,0).which)Ma+="X"==b?-T*da:0,Ua+="Y"==b?-T*da:0;else if(2===F.Kh(a,G,0).which||3===F.Kh(a,G,0).which)nb+="X"==b?-T*e:0,Va+="Y"==b?-T*e:0}}function v(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function U(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function E(a){return a[0]&&(a[1]||
-.1>a[2])}function t(a){return a[0]&&(a[1]||.1<a[2])}function M(a){return a[0]&&(a[1]||a[2]||a[3])}function O(a,G,T){if(1==T)switch(T=F.ag(a,G,0),D.Lh(a,N),G){case "FORWARD":z?sa[0]=1:ca?(G=D.Bn(a,I)[1],G=Math.abs(G)>=Math.PI/4?J.mi:J.Zc,n(a,G,.5*N.trans*T)):P?k(a,-N.zoom,T):h(a,0,0,-N.trans*T);break;case "BACKWARD":z?sa[0]=-1:ca?(G=D.Bn(a,I)[1],G=Math.abs(G)>=Math.PI/4?J.Wk:J.$c,n(a,G,.5*N.trans*T)):P?k(a,N.zoom,T):h(a,0,0,N.trans*T);break;case "UP":ca?x(a,30*-N.zoom*T):z||h(a,0,N.trans*T,0);break;
case "DOWN":ca?x(a,30*N.zoom*T):z||h(a,0,-N.trans*T,0);break;case "LEFT":z?sa[1]=1:ca?n(a,J.Dx,.5*N.trans*T):h(a,-N.trans*T,0,0);break;case "RIGHT":z?sa[1]=-1:ca?n(a,J.li,.5*N.trans*T):h(a,N.trans*T,0,0);break;case "ROT_LEFT":P?D.ps(a,.75*-N.rot*T,0):D.Gq(a,.75*N.rot*T,0);break;case "ROT_RIGHT":P?D.ps(a,.75*N.rot*T,0):D.Gq(a,.75*-N.rot*T,0);break;case "ROT_UP":P?D.ps(a,0,.75*-N.rot*T):D.Gq(a,0,.75*N.rot*T);break;case "ROT_DOWN":P?D.ps(a,0,.75*N.rot*T):D.Gq(a,0,.75*-N.rot*T)}else switch(G){case "FORWARD":case "BACKWARD":z&&
(sa[0]=0);break;case "LEFT":case "RIGHT":z&&(sa[1]=0)}z&&(e.FC(z,sa[0],sa[1]),a=D.Du(a,Q),e.xw(z,a[0],a[1]))}Z=a;w=b;ga=c;var H=p.AA();A(H);var P=!1,z=null,ca=!1;switch(D.Tl(H)){case D.Ib:P=!a;break;case D.nd:z=p.Fu();break;case D.xg:return;case D.bd:ca=!0}var N=D.Lh(H,aa);a=F.Wt();if(e.VA(H)){var r=F.Nz(H,null,!0);F.ua(H,"CAMERA_COLLISION",F.qf,[r],null,function(a,G){var T=F.Kh(a,G,0).coll_dist;if(0>T){var b=F.Kh(a,G,0).coll_norm,da=Y;B.scale(b,-.25*T,da);T=ba.Bf(a,ia);B.add(T,da,T);ba.dY(a,T)}})}if(z){var r=
ba.Bf(H),Ba=ba.En(H),Ba=J.sz(Ba);r[2]-=.5;e.Dw(z,r,Ba);K.dQ(H,z);var sa=new Float32Array(2),Ra=!0;e.ww(z,e.bE);F.kn(H,"TOGGLE_CHAR_MOVE_TYPE",F.vg,F.XN,function(){Ra=!Ra;e.ww(z,Ra?e.bE:e.vN)})}var Na=C.qR(),r=Na.length?Na[Na.length-1]:0,Da,G,T,da,Ab,Ha,zc,Sa,ha,Ea;b?Da=G=T=da=Ab=Ha=b=r=zc=Sa=ha=Ea=F.Oz(0):(Da=F.Pc(F.rE),G=F.Pc(F.pE),T=F.Pc(F.kE),da=F.Pc(F.lE),Ab=F.Pc(F.cO),Ha=F.Pc(F.YN),b=F.Xt(C.Ws,r),r=F.Xt(C.Xs,r),zc=F.Pc(F.qE),Sa=F.Pc(F.mE),ha=F.Pc(F.nE),Ea=F.Pc(F.oE));var Ba=F.jn(C.Ss,Na),qa=
F.jn(C.Ts,Na),W=F.jn(C.Us,Na),Na=F.jn(C.Vs,Na);ca||(F.ua(H,"FORWARD",F.ub,[a,Da,qa],E,O),F.ua(H,"BACKWARD",F.ub,[a,G,qa],t,O));P?(F.ua(H,"ROT_UP",F.ub,[a,zc,Ab,Na],v,O),F.ua(H,"ROT_DOWN",F.ub,[a,Sa,Ha,Na],U,O),F.ua(H,"ROT_LEFT",F.ub,[a,ha,T,W],v,O),F.ua(H,"ROT_RIGHT",F.ub,[a,Ea,da,W],U,O)):ca?(F.ua(H,"LEFT",F.ub,[a,ha,T,Ba],v,O),F.ua(H,"RIGHT",F.ub,[a,Ea,da,Ba],U,O),F.ua(H,"FORWARD",F.ub,[a,zc,Da,qa],v,O),F.ua(H,"BACKWARD",F.ub,[a,Sa,G,qa],U,O),F.ua(H,"UP",F.ub,[a,Ha,Na],t,O),F.ua(H,"DOWN",F.ub,[a,
Ab,Na],E,O)):(F.ua(H,"UP",F.ub,[a,Ab,b],M,O),F.ua(H,"DOWN",F.ub,[a,Ha,r],M,O),F.ua(H,"LEFT",F.ub,[a,T,Ba],E,O),F.ua(H,"RIGHT",F.ub,[a,da,Ba],t,O),F.ua(H,"ROT_UP",F.ub,[a,zc,Na],E,O),F.ua(H,"ROT_DOWN",F.ub,[a,Sa,Na],t,O),F.ua(H,"ROT_LEFT",F.ub,[a,ha,W],E,O),F.ua(H,"ROT_RIGHT",F.ub,[a,Ea,W],t,O));if(!c){var Oa=0;c=F.Rz(d);var ua=0,Na=F.Xz(d);F.ua(H,"MOUSE_WHEEL",F.bp,[c],null,function(a,G,T){1==T&&(G=F.ag(a,G,0),D.Lh(a,N),P||ca?Oa=y(a,G,N.zoom,Oa,P):(N.trans*=1+G*N.zoom,D.eY(a,N)))});F.ua(H,"TOUCH_ZOOM",
F.bp,[Na],null,function(a,G,T){1==T&&(T=F.ag(a,G,0),D.Lh(a,N),F.Kh(a,G,0)===F.gt&&(ua=y(a,T,.03*N.zoom,ua,P)))});F.ua(H,"ZOOM_INTERPOL",F.qf,[a],null,function(a,G){if(P||ca)if(1E-5<Math.abs(Oa)||1E-5<Math.abs(ua)){var T=F.ag(a,G,0),b=J.vc(Oa,0,T,.1*V);Oa-=b;T=J.vc(ua,0,T,.15*V);ua-=T;ca?x(a,-(b+T)):(b=D.nD(a)+b+T,b=Math.max(b,.001),D.TY(a,b))}else ua=Oa=0})}var Ma=0,Ua=0,nb=0,Va=0,Aa=0,kb=0;P?(F.ua(H,"GMPD_PAN_Y_POS",F.ub,[b],null,m),F.ua(H,"GMPD_PAN_Y_NEG",F.ub,[r],null,u),F.ua(H,"GMPD_PAN_X_POS",
F.ub,[Ba],function(a){return-.1>a[0]},f),F.ua(H,"GMPD_PAN_X_NEG",F.ub,[Ba],function(a){return.1<a[0]},R)):ca&&(F.ua(H,"GMPD_PAN_X_POS",F.ub,[W],function(a){return-.1>a[0]},f),F.ua(H,"GMPD_PAN_X_NEG",F.ub,[W],function(a){return.1<a[0]},R));if(g){g=F.ln("X",window);c=F.ln("Y",window);b=F.nq(d);var r=F.nq(window),Ya=!1,Ba=function(a){a[2]?Ya=!0:a[0]||(Ya=!1);return Ya&&a[0]};F.ua(H,"MOUSE_X",F.qf,[r,g,b],Ba,q,"X");F.ua(H,"MOUSE_Y",F.qf,[r,c,b],Ba,q,"Y");g=C.ia(C.ad,window);C.lD(g,!1)}else g=F.ln("X",
d),c=F.ln("Y",d),b=F.nq(d),F.ua(H,"MOUSE_X",F.qf,[b,g],null,q,"X"),F.ua(H,"MOUSE_Y",F.qf,[b,c],null,q,"Y");var La=0,hb=0,jb=0,ab=0;g=F.au("X",d);d=F.au("Y",d);F.ua(H,"TOUCH_X",F.qf,[g],null,l,"X");F.ua(H,"TOUCH_Y",F.qf,[d],null,l,"Y");F.ua(H,"ROT_TRANS_INTERPOL",F.qf,[a],null,function(a,G){if(1E-5<Math.abs(Ma)||1E-5<Math.abs(Ua)||1E-5<Math.abs(La)||1E-5<Math.abs(hb)||1E-5<Math.abs(nb)||1E-5<Math.abs(Va)||1E-5<Math.abs(jb)||1E-5<Math.abs(ab)||1E-5<Math.abs(Aa)||1E-5<Math.abs(kb)){var T=F.ag(a,G,0),
b=J.vc(Ma,0,T,.08*V),da=J.vc(Ua,0,T,.08*V);Ma-=b;Ua-=da;var c=J.vc(La,0,T,.12*V),d=J.vc(hb,0,T,.12*V);La-=c;hb-=d;var g=J.vc(nb,0,T,.08*V),E=J.vc(Va,0,T,.08*V);nb-=g;Va-=E;var l=J.vc(jb,0,T,.12*V),u=J.vc(ab,0,T,.12*V);jb-=l;ab-=u;var w=J.vc(Aa,0,T,.08*V),T=J.vc(kb,0,T,.08*V);Aa-=w;kb-=T;P?(D.ps(a,b+c,da+d),da=D.nD(a),D.SY(a,da*(g+l+w),da*(E+u+T))):ca?(b+c&&n(a,J.li,.2*(b+c)),da+d&&(E=D.Bn(a,I)[1],n(a,Math.abs(E)>Math.PI/4?J.Wk:J.$c,.2*(da+d))),D.$I(a,g+l+w,0)):(D.Gq(a,.5*(b+c),.5*(da+d)),z&&(g=D.Du(a,
Q),e.xw(z,g[0],g[1])))}});F.kn(H,"DEC_STEREO_DIST",F.vg,F.aO,function(a){var G=D.CI(a);D.uL(a,.9*G)});F.kn(H,"INC_STEREO_DIST",F.vg,F.dO,function(a){var G=D.CI(a);D.uL(a,1.1*G)})}function A(a){var b=D.Tl(a),e=F.Mz(function(){var e=D.Tl(a),c=e!=b;b=e;return c});F.ua(a,"CHANGE_MOVE_STYLE",F.qf,[e],null,function(){N();g(Z,w,ga)})}function N(){var a=p.AA();F.Yp(a,"TOGGLE_CHAR_MOVE_TYPE")&&p.Fu()&&K.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
e=0;e<b.length;e++)F.Vr(a,b[e])}function H(a,b,e,c){var d=document.createElement("div"),g=document.createElement("div"),l=document.createElement("div");if(c)for(var u=0;u<c.length;u++){var w=document.getElementById(c[u]);w&&w.parentNode.removeChild(w)}d.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";g.style.cssText="color:#fff;font-size:24px;";l.style.cssText="color:#fff;font-size:20px;";g.innerHTML=a;l.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
e+'">'+e.replace("https://www.","")+"</a>";d.appendChild(g);d.appendChild(l);document.body.appendChild(d)}function O(a,b,e,c,d){function g(){var u=performance.now()-l;d(b+u*(e-b)/c);(u>=c||!a.parentNode)&&v.dX(g)}var l=performance.now();v.Ap(g)}r("animation");var D=r("camera"),P=r("config"),K=r("constraints"),M=r("container"),F=r("controls"),c=r("data"),l=r("debug"),C=r("input"),v=r("main"),e=r("physics"),R=r("print"),p=r("scenes"),ba=r("transform"),J=r("util"),B=r("vec3"),V=1,U=null,Z=!1,w=!1,ga=
!1,Q=new Float32Array(2),I=new Float32Array(2),Y=new Float32Array(3),ia=new Float32Array(3);new Float32Array(3);var u=new Float32Array(4),aa={},ca={};a.Tg=function(a){function e(){var a=b(p,x,E,f),c=M.Cn();if(a){var g=M.We();M.tk();J&&(t(k,B),v.KX(q));h&&(m(),d());I&&v.Ap(function(){g.style.height=g.clientWidth/I+"px"});w&&v.Ap(function(){M.tk()});C&&v.Ap(function(){M.wA()});n&&P.wC();A==P.np?l.qM(function(a,b){0==a?(R.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),P.en(P.Yk)):1.5>b?(R.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),P.en(P.op)):(R.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),P.en(P.Yk));u(c,!0)}):u(c,!0)}else u(c,!1)}function g(a){a.keyCode==F.bO&&(v.jr()?v.cj():v.pause())}function u(){}a=a||{};var w=!1,p=null,f=null,k=null,I=0,B=null,y=!0,n=!1,h=!0,E=!0,Q=!1,J=!1,U=!1,C=!1,A=P.get("quality"),V;for(V in a)switch(V){case "canvas_container_id":p=a.canvas_container_id;break;case "callback":u=a.callback;break;case "autoresize":w=a.autoresize;break;case "show_hud_debug_info":U=a.show_hud_debug_info;
break;case "sfx_mix_mode":Q=a.sfx_mix_mode;break;case "show_fps":J=a.show_fps;break;case "track_container_position":C=a.track_container_position;break;case "fps_wrapper_id":B=a.fps_wrapper_id;break;case "fps_elem_id":k=a.fps_elem_id;break;case "error_purge_elements":f=a.error_purge_elements;break;case "report_init_failure":E=a.report_init_failure;break;case "pause_invisible":h=a.pause_invisible;break;case "key_pause_enabled":y=a.key_pause_enabled;break;case "force_container_ratio":I=a.force_container_ratio;
break;case "min_capabilities":n=a.min_capabilities;break;case "quality":A=a.quality;break;default:P.set(V,a[V])}A!=P.np&&P.set("quality",A);y&&document.addEventListener("keydown",g,!1);P.set("show_hud_debug_info",U);P.set("sfx_mix_mode",Q);var x=U||Q||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){c.sa()},!1)};a.tk=function(){R.Rb("app.resize_to_container","container.resize_to_container");M.tk()};a.v7=function(a,
b){var e=z(a);e.addEventListener("mouseup",function(){b(e.value)},!1)};a.u7=function(a,b){var e=z(a);e.addEventListener("change",function(){var a=e.checked;b(void 0!=a?a:e.value)},!1)};a.w7=function(a,b){var e=z(a);e.addEventListener("keypress",function(a){b(a.keyCode,e.value)},!1)};a.sT=g;a.G2=N;a.X6=function(a){R.Hh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=p.AA();D.NC(b,a)};a.T2=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,g){if(1==g)switch(g=F.ag(a,b,0),b){case "FORWARD":d?e.Uo(a,1):ba.$g(a,0,-1*g,0);break;case "BACKWARD":d?e.Uo(a,-1):ba.$g(a,0,1*g,0);break;case "LEFT":d?e.To(a,-1):ba.$g(a,1*g,0,0);break;case "RIGHT":d?e.To(a,1):ba.$g(a,-1*g,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&e.Uo(a,0);break;case "LEFT":case "RIGHT":d&&e.To(a,0)}}var d=e.Ye(a)||e.Ze(a),g=F.Wt(),l=F.Pc(F.rE),u=F.Pc(F.pE),w=F.Pc(F.kE),p=F.Pc(F.lE),f=F.Pc(F.qE),k=F.Pc(F.mE),m=F.Pc(F.nE),I=F.Pc(F.oE);F.ua(a,
"FORWARD",F.ub,[g,l,f],b,c);F.ua(a,"BACKWARD",F.ub,[g,u,k],b,c);F.ua(a,"LEFT",F.ub,[g,w,m],b,c);F.ua(a,"RIGHT",F.ub,[g,p,I],b,c)};a.I2=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],e=0;e<b.length;e++)F.Vr(a,b[e])};a.Q2=function(){R.N("app.enable_controls() deprecated")};a.H2=function(){R.N("app.disable_controls() deprecated")};a.S2=function(){F.kn(null,"CAMERA_SHOT",F.vg,F.ZN,function(){l.dW()});F.kn(null,"LIGHT_SHOT",F.vg,F.$N,function(){l.gW()});F.kn(null,"TELEMETRY",F.vg,F.eO,function(){l.dC()})};
a.L6=function(a,b,e){function c(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",c,!1),document.removeEventListener("webkitfullscreenchange",c,!1),document.removeEventListener("mozfullscreenchange",c,!1),document.removeEventListener("MSFullscreenChange",c,!1),e())}b=b||function(){};e=e||function(){};document.addEventListener("fullscreenchange",
c,!1);document.addEventListener("webkitfullscreenchange",c,!1);document.addEventListener("mozfullscreenchange",c,!1);document.addEventListener("MSFullscreenChange",c,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():R.error("B4W App: request fullscreen method is not supported")};a.a3=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&R.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.W1=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.K6=H;a.N4=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),e={},c=0;c<b.length;c++){var d=b[c].split("="),g=d[0];1<d.length?(d=
d[1],a?g in e?e[g].push(d):e[g]=[d]:e[g]=d):a?g in e||(e[g]=[]):e[g]=""}return e};a.VS=function(a,b,e,c,d,g,l,u){function w(d){a&&(p[b]=g+d+l,e>c&&d<=c||e<c&&d>=c)&&(p[b]=g+c+l,u())}if(a&&b&&isFinite(e)&&isFinite(c)&&isFinite(d)){g=g||"";l=l||"";u=u||function(){};var p=a.style,f=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==p[b])if(void 0!=p["webkit"+f])b="webkit"+f;else if(void 0!=p["ms"+f])b="ms"+f;else if(void 0!=p["moz"+f])b="moz"+f;else return;O(a,e,c,d,w)}};a.zQ=function(a,b,e,c,d,g){function l(d){a&&
(0<=d&&a.setAttribute(b,d),e>c&&d<=c||e<c&&d>=c)&&(a.setAttribute(b,c),g())}a&&b&&isFinite(e)&&isFinite(c)&&isFinite(d)&&(g=g||function(){},O(a,e,c,d,l))};a.ZW=function(b){if(b.length){var e=b.shift(),c=e.elem,d=e.prop,g=e.from,l=e.to,u=e.duration,w=e.opt_prefix,p=e.opt_suffix,f=function(){e.cb&&e.cb();a.ZW(b)};"css"==e.type?a.VS(c,d,g,l,u,w,p,f):"attr"==e.type&&a.zQ(c,d,g,l,u,f)}};a.Y6=function(a){V=a};a.B3=function(){return V}};b4w.module.animation=function(a,r){var m=r("__animation"),d=r("__armature"),b=r("__obj_util"),t=r("__print"),q=r("__tsr");a.od=m.od;a.KE=m.KE;a.LE=m.LE;a.ME=m.ME;a.NE=m.NE;a.OE=m.OE;a.PE=m.PE;a.it=m.it;a.Zk=m.Zk;a.BE=m.BE;a.Jy=m.Jy;a.Ky=m.Ky;a.EE=m.EE;a.DE=m.DE;a.CE=m.CE;a.AE=m.AE;a.VD=m.VD;a.WD=m.WD;a.yx=m.yx;var z=q.create();a.Ac=function(a){return m.Ac(a)};a.OH=function(a){return m.$J(a)?m.OH(a):[]};a.I3=function(a,b){if(!m.Ac(a))return null;b=b||m.od;return m.oU(a,b)};a.apply=function(a,b,d){if(d>
m.it)t.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=d||m.od;if(m.Ac(a)){var k=m.Mu(a,b);if(-1!=k&&k!=d){t.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+k+'").');return}}m.aN(a,b)?m.apply(a,null,b,d):t.error('No fcurves in action "'+b+'"')}};a.r1=function(a,b,d){if(d>m.it)t.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=
d||m.od;var k=b[0];if(m.Ac(a)){var f=m.Mu(a,k);if(-1!=f&&f!=d){t.error('Animation "'+k+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}m.aN(a,k)?m.apply(a,b.slice(1),k,d):t.error('No fcurves in action "'+k+'"')}};a.remove=function(a){m.remove(a)};a.FK=function(a,b){m.Ac(a)&&(b=b||m.od,m.FK(a,b))};a.xt=function(a){m.xt(a)};a.play=function(a,b,d){m.Ac(a)?(d=d||m.od,m.play(a,b,d),m.DZ(a,0,d,!0)):t.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){m.Ac(a)&&
(b=b||m.od,m.stop(a,b))};a.Yj=function(a,b){if(!m.Ac(a))return!1;b=b||m.od;return m.Yj(a,b)};a.no=function(a,b,d){m.Ac(a)&&(d=d||m.od,m.no(a,b,d))};a.KC=function(a,b){m.Ac(a)&&m.KC(a,b)};a.k7=function(a,b){if(m.Ac(a)){b=b||m.od;var d=m.DA(a,b),k=m.CA(a,b);m.no(a,d+k-m.fO,b)}};a.Uq=function(a,b){if(!m.Ac(a))return 0;b=b||m.od;return m.YH(a,b)};a.sL=function(a,b,d){m.Ac(a)&&(d=d||m.od,m.sL(a,b||1,d))};a.AI=function(a,b){if(!m.Ac(a))return 0;b=b||m.od;return a.ha[b]?m.AI(a,b):0};a.DA=function(a,b){return m.Ac(a)&&
(b=b||m.od,a.ha[b])?m.DA(a,b):-1};a.CA=function(a,b){return m.Ac(a)&&(b=b||m.od,a.ha[b])?m.CA(a,b):-1};a.cs=function(a,b,d){m.Ac(a)&&(d=d||m.od,m.cs(a,b,d))};a.SH=function(a,b){if(!m.Ac(a))return null;b=b||m.od;return m.SH(a,b)};a.rF=function(a,b,d,k){k=k||m.od;m.Ac(a)&&m.rF(a,b,d,k)};a.AH=function(a){return m.AH(a)};a.y3=function(a,m,h){t.Rb("get_bone_translation","armature.get_bone_tsr");if(!b.Zl(a))return null;if(!d.kR(a,m))return t.error('There is no bone: "',m,'" in "',a.name,'".'),null;h||(h=
new Float32Array(3));d.Cu(a,m,!1,z);h[0]=z[0];h[1]=z[1];h[2]=z[2];return h};a.U3=function(){t.N("get_first_armature_object() deprecated");return null};a.Mu=function(a,b){return m.Ac(a)&&b?m.Mu(a,b):-1};a.PH=function(a,b){return m.Ac(a)?m.PH(a,b):null};a.sF=function(a,b){return m.sF(a,b)};a.G4=function(a){return a.k.yh};a.qL=function(a,d,h){b.Zl(a)?(d=Math.min(Math.max(d,0),1),a.k.yh!=d&&m.qL(a,d,h||0)):t.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.__animation=function(a,r){function m(a,b){var e=a.ha[b];e&&e.vA&&e.Fq&&(e.Fq=!1,e.vA(a,b))}function d(a,b,e){e=a.ha[e];e.type=30;var c=b.va,d=b.Za-c+1;e.start=c;e.length=d;e.wf=c;e.ui=b.name;for(d=c=0;d<a.Xc.length;d++){var g=a.Xc[d];if(g==b)break;else c+=g.Za-g.va+1}e.$M=c}function b(a,b){a.type=50;a.ui=b.name;a.start=b.va;a.length=b.Za-a.start;b.ve||(a.length+=b.pB)}function t(a){return a.replace(/_B4W_BAKED$/,"")}function q(a,b){return{Xn:a,action:b}}function z(a,b,e){if(a.animation_data){var c=
a.animation_data.action;c&&60==c.s.type&&b.push(q(e,c))}a=a.nodes;for(c=0;c<a.length;c++){var d=a[c];if(d.node_group){var g=d.node_group.node_tree;if(g){var l=e.slice();l.push(d.name);z(g,b,l)}}}}function n(a){return I.Yd(a)&&a.k.Xc?!0:!1}function x(a,b,e){var c=a.ha;if(-1==e)for(e=0;8>e;e++){var d=c[e];d&&(d.wf=b,k(a,0,e,!0))}else if(d=c[e])d.wf=b,k(a,0,e,!0)}function h(a,b,e){if(-1==b)for(b=0;8>b;b++){var c=a[b];c&&e(c)}else(c=a[b])&&e(c)}function k(a,b,e,c){D(a,b,e,c);m(a,e);a.k.ti&&(M(a,b),K(a,
b))}function f(a,b,e,d){var l=e.frame_range;if(l[0]>l[1])return u.warn('Incompatible action "'+e.name+'" has been applied to object "'+a.name+'"'),!1;var E=e.s,w=a.ha[d];w.ui=e.name;w.Uy=l;w.iF=E.iK;w.gF=E.KF;w.yi.set(E.yi);w.start=l[0];w.length=l[1]-l[0];w.wf=l[0];switch(E.type){case 10:if(I.Zl(a)){w.type=10;var p=y(a,b,e);if(!p){for(var p=a.k.Dg,l=[],f=[],G=e.s.RB,T=0;T<G;T++){for(var da in p){var k=p[da],m=k.ax,B=e.s.jz[da];B?oa.copy(B.subarray(8*T,8*T+8),m):oa.identity(m);k.bx=!1}k=F(p);l.push(k.trans);
f.push(k.Cb)}p={trans:l,Cb:f};g(a,b,e,p)}w.trans=p.trans;w.Cb=p.Cb;b=p;w=a.k;p=w.vo;l=a.ha[d];da=l.ZC;a:{f=w.Iw;for(G=0;G<f.length;G+=2)if(e==f[G]){f=f[G+1];break a}f=null}if(f)l.ZC=f;else{for(l=0;l<p.length;l++){f=p[l].wi;G=[];T=[];k=b.trans;m=b.Cb;for(B=0;B<k.length;B++){var R=c(k[B],m[B],f);G.push(R.trans);T.push(R.Cb)}da.push({trans:G,Cb:T})}w.Iw.push(e,da)}w.ti&&(e=w.Po,d>e[1]?(b=e[1],e[1]=d,e[0]=b):d>e[0]&&d<e[1]&&(e[0]=d),A(a))}break;case 40:I.kr(a)&&(w.volume=E.qb.volume||null,w.pitch=E.qb.pitch||
null,w.type=40);break;case 70:I.qv(a)&&(w.color=E.qb.color||null,w.Fi=E.qb.energy||null,w.type=70);break;case 60:if("MESH"==a.type){w.type=60;da=y(a,b,e);if(!da){da=[];l=[];f=[];G=[];T=[];k=e.s;m=b?b[0]:null;for(p in k.qb){B=b;R=p.match(/"(.*?)"/)[1];if(B&&1<B.length){for(var Q=B[1],J=2;J<B.length;J++)Q=Q+"%join%"+B[J];Q+="%join%"+R}else Q=R;B=Q;for(R=0;R<a.I.length;R++)for(Q=a.I[R].U,J=0;J<Q.length;J++){var h=Q[J];if(!m||-1!=h.sd.indexOf(m)){var q=h.Wi,v=H(p,B,k,l,da,h.Xi),q=H(p,B,k,G,f,q);(v||q)&&
T.push(h)}}}da={b_:da,values:l,qX:f,rX:G,Rv:T};g(a,b,e,da)}w.Xi=da.b_;w.UJ=da.values;w.Wi=da.qX;w.TJ=da.rX;w.Rv=da.Rv}break;case 20:if(p=E.qb.tsr){w.type=20;da=y(a,b,e);if(!da){da=e.s.RB;l=[];f=[];for(G=0;G<da;G++)l.push(p.subarray(8*G,8*G+4)),f.push(p.subarray(8*G+4,8*G+8));da={trans:l,Cb:f};g(a,b,e,da)}w.trans=da.trans;w.Cb=da.Cb;Y.SB(a)&&Y.QZ(a,w.trans[0],w.Cb[0])}else return u.warn('Incompatible action "'+e.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:I.jB(a)&&(w.Fi=E.qb["light_settings.environment_energy"]||
null,w.he=E.qb.horizon_color||null,w.pe=E.qb.zenith_color||null,w.Kq=E.qb["mist_settings.intensity"]||null,w.fog_depth=E.qb["mist_settings.depth"]||null,w.fog_start=E.qb["mist_settings.start"]||null,w.fog_height=E.qb["mist_settings.height"]||null,w.wH=E.qb.b4w_fog_color||null,w.type=80)}I.Zl(a)&&10!=E.type&&N(a,d);return!0}function y(a,b,e){a=a.st;b=b?b.join("%join%"):null;for(var c=0;c<a.length;c+=3)if(e==a[c]&&b==a[c+1])return a[c+2];return null}function g(a,b,e,c){a.st.push(e,b?b.join("%join%"):
null,c)}function A(a){var b=a.k.Po;if(-1!=b[0]&&-1!=b[1]){var e=a.ha;a=e[b[1]].wf;var c=Math.floor(a),d=a-c,b=e[b[0]];a=b.wf;c=Math.floor(a);b.wf=c+d}}function N(a,b){var e=a.k.Po,c=e[1];e[0]=-1;e[1]=-1;if(-1!=b)for(var d=a.ha;0<=c;c--){var g=d[c];if(g&&10==g.type)if(c>e[1])e[1]=c;else{c>e[0]&&(e[1]=c);break}}}function H(a,b,e,c,d,g){if(!g)return!1;for(var l=!1,E=0;E<g.length;E+=2)b==g[E]&&(d.push(g[E+1]),c.push(new Float32Array(e.qb[a])),l=!0);return l}function O(a){a=a.s;for(var b in a.qb)if(-1!=
b.indexOf("nodes"))return!0;return!1}function D(a,b,e,c){if((e=a.ha[e])&&null!=e.type&&(e.play||c)){var d=a.k,g=e.wf,l=e.start,w=e.length,g=g+e.speed*b*S.rd(),u=e.type,G=e.speed;if(0<=G&&g>=l+w||0>G&&g<l)switch(c||(e.Fq=!0),e.behavior){case 10:g=0<=G?(g-l)%w+l:l+w-1E-6;break;case 20:g=0<=G?l:l+w-1E-6;e.play=!1;break;case 30:g=0<=G?l+w-1E-6:l,e.play=!1}e.wf=g;switch(u){case 10:if(!d.ti){c=P(e);b=c[0];var T=c[1];c=c[2];d.ke=e.Cb[b];d.Be=e.Cb[T];d.oe=e.trans[b];d.Ee=e.trans[T];d.Ue=c;c=d.vo;e=e.ZC;for(var da=
0;da<c.length;da++){var p=c[da],f=e[da];p.ke=f.Cb[b];p.Be=f.Cb[T];p.oe=f.trans[b];p.Ee=f.trans[T];p.Ue=d.Ue}fa.D(a)}break;case 20:c=P(e);var d=L,T=c[0],da=c[1],p=c[2],f=e.trans,k=f[T][1],g=f[T][2],l=f[da][1],w=f[da][2];d[0]=(1-p)*f[T][0]+p*f[da][0];d[1]=(1-p)*k+p*l;d[2]=(1-p)*g+p*w;T=E;g=c[0];da=c[1];p=c[2];f=e.Cb;k=za;k[0]=f[g][0];k[1]=f[g][1];k[2]=f[g][2];k[3]=f[g][3];g=ra;g[0]=f[da][0];g[1]=f[da][1];g[2]=f[da][2];g[3]=f[da][3];aa.slerp(k,g,p,T);da=c[2];p=e.trans;c=(1-da)*p[c[0]][3]+da*p[c[1]][3];
a.parent&&a.ew&&(da=ka,oa.$h(d,c,T,da),oa.multiply(a.ew,da,da),oa.fc(da,d),oa.Wd(da,T),c=oa.Xd(da));e.CD&&(da=ea,fa.Bf(a,da),xa.Qw(d,da,b,e.CD,d));e.lC&&(da=za,fa.En(a,da),xa.SL(T,da,b,e.lC,T));g=e.yi;g[0]&&fa.Ew(a,d);g[1]&&fa.Cw(a,T);g[2]&&fa.SC(a,c);fa.D(a);ia.H(a);break;case 30:c=e.wf-e.start;0>c&&(c=0);c>=e.length&&(c=e.length);a=Math.floor(c);b=a+1;c-=a;10!=e.behavior&&b==e.length&&(b=--a,c=1);e=e.$M;na[0]=a+e;na[1]=b+e;na[2]=c;c=na;d.jx=c[0];d.kx=c[2];break;case 40:c=P(e);b=c[0];d=c[1];c=c[2];
e.volume&&wa.iY(a,(1-c)*e.volume[b]+c*e.volume[d]);e.pitch&&wa.QW(a,(1-c)*e.pitch[b]+c*e.pitch[d]);break;case 50:b=10==e.behavior?(g-l)/S.rd():g/S.rd();Y.bY(a,e.ui,b);break;case 60:c=P(e);b=c[0];d=c[1];c=c[2];f=e.UJ;k=e.Xi;a=e.TJ;T=e.Wi;da=e.Rv;for(e=0;e<k.length;e++)for(g=f[e],p=k[e],l=(1-c)*g[b]+c*g[d],g=0;g<da.length;g++)da[g].Yi[p]=l;for(e=0;e<T.length;e++)for(f=a[e],p=T[e],f=la.lerp(f.subarray(3*b,3*b+3),f.subarray(3*d,3*d+3),c,L),g=0;g<da.length;g++)da[g].ze[3*p]=f[0],da[g].ze[3*p+1]=f[1],da[g].ze[3*
p+2]=f[2];break;case 70:c=P(e);b=c[0];d=c[1];c=c[2];g=e.yi;(w=e.Fi)&&g[0]&&Q.RX(a.Rc,(1-c)*w[b]+c*w[d]);(e=e.color)&&g[1]&&(L[0]=(1-c)*e[3*b]+c*e[3*d],L[1]=(1-c)*e[3*b+1]+c*e[3*d+1],L[2]=(1-c)*e[3*b+2]+c*e[3*d+2],Q.QX(a.Rc,L));l=a.I;for(e=0;e<l.length;e++)ja.AZ(a,l[e].xb);break;case 80:c=P(e);b=c[0];d=c[1];c=c[2];g=e.yi;l=a.I;G=ja.La(l[0].xb,pa.Ob);w=e.Fi;w=g[0]?(1-c)*w[b]+c*w[d]:G.Fi;u=e.he;g[1]?(L[0]=(1-c)*u[3*b]+c*u[3*d],L[1]=(1-c)*u[3*b+1]+c*u[3*d+1],L[2]=(1-c)*u[3*b+2]+c*u[3*d+2],u=L):u=G.he;
var m=e.pe;g[2]?(ea[0]=(1-c)*m[3*b]+c*m[3*d],ea[1]=(1-c)*m[3*b+1]+c*m[3*d+1],ea[2]=(1-c)*m[3*b+2]+c*m[3*d+2],G=ea):G=G.pe;m=e.Kq;g[3]&&(T=(1-c)*m[b]+c*m[d]);m=e.fog_depth;g[4]&&(da=(1-c)*m[b]+c*m[d]);m=e.fog_start;g[5]&&(p=(1-c)*m[b]+c*m[d]);m=e.fog_height;g[6]&&(f=(1-c)*m[b]+c*m[d]);e=e.wH;g[7]&&(E[0]=(1-c)*e[3*b]+c*e[3*d],E[1]=(1-c)*e[3*b+1]+c*e[3*d+1],E[2]=(1-c)*e[3*b+2]+c*e[3*d+2],k=E);for(e=0;e<l.length;e++)b=a.I[e].xb,(g[0]||g[1]||g[2])&&ja.HC(b,w,u,G),g[3]&&ja.eL(b,T),g[4]&&ja.cL(b,da),g[5]&&
ja.fL(b,p),g[6]&&ja.dL(b,f),g[7]&&ja.LC(b,k);break;default:xa.q("Unknown animation type:"+u)}}}function P(a){var b=a.Uy[0],e=a.Uy[1]-b,b=a.wf-b;0>b&&(b=0);b>=e&&(b=e);b/=a.iF;e=Math.floor(b);a=a.gF[e]?b-e:0;b=Math.ceil(e+a);na[0]=e;na[1]=b;na[2]=a;return na}function K(a,b){var e=a.k,c=e.yh,d=e.Po,g=d[0],d=d[1];if(-1!=d){if(-1!=g){var l=a.ha[g];if(l.play||0==b){var u=P(l),p=u[0],G=u[1];e.Ue=u[2];var u=l.Cb[p],T=l.Cb[G],p=l.trans[p],G=l.trans[G]}else c=1}else c=1;d=a.ha[d];if(d.play||0==b){var g=P(d),
da=g[0],f=g[1];e.Ue=g[2]}else if(-1!=g&&l.play)c=0;else return;g=d.Cb[da];l=d.Cb[f];da=d.trans[da];f=d.trans[f];if(1==c)e.ke.set(g),e.Be.set(l),e.oe.set(da),e.Ee.set(f);else if(0==c)e.ke.set(u),e.Be.set(T),e.oe.set(p),e.Ee.set(G);else{for(d=0;d<u.length;d+=4){for(var k=E,m=za,B=0;4>B;B++)k[B]=u[d+B],m[B]=g[d+B];aa.slerp(k,m,c,k);for(B=0;4>B;B++)e.ke[d+B]=k[B];for(B=0;4>B;B++)k[B]=T[d+B],m[B]=l[d+B];aa.slerp(k,m,c,k);for(B=0;4>B;B++)e.Be[d+B]=k[B]}xa.NF(p,da,c,e.oe);xa.NF(G,f,c,e.Ee)}fa.D(a);w.NZ(a)}}
function M(a,b){var e=a.k,c=e.yh,d=e.yp;if(0!=d){var c=e.xp-c,g=d*b;xa.sign(c)==xa.sign(d)&&Math.abs(g)<Math.abs(c)?e.yh+=g:(e.yh=e.xp,e.yp=0)}}function F(a){var b=[],e=[],c=new Float32Array(4),d=new Float32Array(4),g;for(g in a){var l=a[g],w=c,E=d,G=l.Lt,T=G[G.length-1],da=T.ED;T.bx||oa.identity(da);for(T=G.length-1;0<=T;T--){var u=G[T],p=u.ED;if(u.bx)da=p;else{var f=u.Jk,k=u.ax;oa.invert(f,ka);oa.multiply(k,ka,ka);oa.multiply(f,ka,ka);oa.multiply(da,ka,p);da=p;u.bx=!0}}G=u.ED;w[0]=G[0];w[1]=G[1];
w[2]=G[2];w[3]=G[3];E[0]=G[4];E[1]=G[5];E[2]=G[6];E[3]=G[7];aa.normalize(E,E);l=l.Cj;for(w=0;4>w;w++)E=4*l+w,b[E]=c[w],e[E]=d[w]}return{trans:b,Cb:e}}function c(a,b,e){var c=[],d=[];new Float32Array(4);new Float32Array(4);for(var g in e)for(var l=e[g],w=l.Cj,l=l.eA,E=0;4>E;E++){var G=4*l+E,T=4*w+E;c[G]=a[T];d[G]=b[T]}c=new Float32Array(c);d=new Float32Array(d);return{trans:c,Cb:d}}function l(a){var b=a.s,e;if(b.jz)e=10;else if(b.qb)if("volume"in b.qb||"pitch"in b.qb)e=40;else if(O(a))e=60;else{var c;
a:{if(a.s.qb){c=a.fcurves;for(var d in c)if("color"==d&&!c[d][3]){c=!0;break a}if("energy"==d){c=!0;break a}}c=!1}if(c)e=70;else if(c=a.s.qb,"light_settings.environment_energy"in c||"horizon_color"in c||"zenith_color"in c||"mist_settings.intensity"in c||"mist_settings.depth"in c||"mist_settings.start"in c||"mist_settings.height"in c||"b4w_fog_color"in c)e=80;else{a:{if(a.s.qb)for(e in a=a.fcurves,a)if("location"==e||"rotation_quaternion"==e||"scale"==e){e=!0;break a}e=!1}e=e?20:0}}else e=0;b.type=
e}function O(a){if(a=a.s.qb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function C(a,b){b[0]=b[1]=b[2]=0;for(var e in a)"location"==e?b[0]=1:"rotation_quaternion"==e?b[1]=1:"scale"==e&&(b[2]=1)}function v(a,b){b[0]=b[1]=0;for(var e in a)"energy"==e?b[0]=1:"color"==e&&(b[1]=1)}function e(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var e in a)"light_settings.environment_energy"==e?b[0]=1:"horizon_color"==e?b[1]=1:"zenith_color"==e?b[2]=1:"mist_settings.intensity"==e?b[3]=1:
"mist_settings.depth"==e?b[4]=1:"mist_settings.start"==e?b[5]=1:"mist_settings.height"==e?b[6]=1:"b4w_fog_color"==e&&(b[7]=1)}function R(a,b,e,c,d,g,l){var E=a+(b-a)/2,w=p(E,c,d,g,l)-e;return.02>Math.abs(w)?E:0<w?R(a,E,e,c,d,g,l):R(E,b,e,c,d,g,l)}function p(a,b,e,c,d){var g=1-a;return b*g*g*g+3*e*g*g*a+3*c*g*a*a+d*a*a*a}function ba(a,b){var e={type:null,ui:null,Uy:null,iF:0,gF:null,yi:new Int8Array(8),Cb:null,trans:null,ZC:[],play:!1,behavior:20,wf:0,start:0,length:0,CD:0,lC:0,Fq:!1,$M:null,speed:1,
volume:null,pitch:null,color:null,Fi:null,pe:null,he:null,Kq:null,fog_depth:null,fog_start:null,fog_height:null,wH:null,UJ:[],Xi:[],TJ:[],Wi:[],Rv:null};if(!a.ha.length)for(var c=0;8>c;c++)a.ha.push(null);a.ha[b]=e;-1==va.indexOf(a)&&va.push(a)}function J(a,b){fa.D(a);ia.H(a);k(a,0,b,!0)}function B(a,e,c,g){g=g||0;if(I.Yd(a)){var l=V(a,c);if(l)return ba(a,g),d(a,l,g),J(a,g),!0;if((l=U(a,c))&&"EMITTER"==l.Zv){ba(a,g);e=l.name;c=g;for(var l=a.I,E=0;E<l.length;E++)for(var w=l[E].U,p=0;p<w.length;p++){var k=
w[p].gb;k&&k.name==e&&b(a.ha[c],k)}J(a,g);return!0}}if(l=xa.Cd("name",c,ma)||xa.Cd("name",c+"_B4W_BAKED",ma)){ba(a,g);if(f(a,e,l,g))return J(a,g),!0;a.ha[g]=null}u.error('Unsupported object: "'+a.name+'" or animation name: "'+c+'"');return!1}function V(a,b){for(var e=0;e<a.Xc.length;e++){var c=a.Xc[e];if(c.name===b)return c}return null}function U(a,b){for(var e=a.I,c=0;c<e.length;c++)for(var d=e[c].U,g=0;g<d.length;g++){var l=d[g].gb;if(l&&l.name===b)return l}return null}function Z(a){a=a.modifiers;
for(var b=0;b<a.length;b++){var e=a[b];if("ARMATURE"==e.type)return e.object}return null}var w=r("__armature"),ga=r("__config"),Q=r("__lights"),I=r("__obj_util"),Y=r("__particles"),ia=r("__physics"),u=r("__print"),aa=r("__quat"),ca=r("__reformer"),ja=r("__scenes"),wa=r("__sfx"),pa=r("__subscene"),S=r("__time"),fa=r("__transform"),oa=r("__tsr"),xa=r("__util"),la=r("__vec3"),X=ga.il,ya=ga.zi;a.fO=1E-6;a.BE=0;a.Jy=10;a.Ky=20;a.EE=30;a.DE=40;a.CE=50;a.AE=60;a.AO=70;a.zO=80;a.od=0;a.KE=1;a.LE=2;a.ME=3;
a.NE=4;a.OE=5;a.PE=6;a.it=7;a.Zk=-1;a.VD=10;a.WD=20;a.yx=30;var na=Array(3),L=new Float32Array(3),ea=new Float32Array(3),E=new Float32Array(4),za=new Float32Array(4),ra=new Float32Array(4),ka=oa.create();new Float32Array(16);var va=[],ma=[];a.iI=function(){return xa.trunc((ya.vr-50)/4)};a.AH=function(a){return a/S.rd()};a.update=function(a){for(var b=0;b<va.length;b++){for(var e=va[b],c=0;8>c;c++)D(e,a,c);e.k.ti&&(M(e,a),K(e,a))}for(b=0;b<va.length;b++)for(e=va[b],c=0;8>c&&e.ha.length;c++)m(e,c)};
a.nU=function(){return ma};a.OH=function(a){var b=[];if(n(a))for(var e=0;e<a.Xc.length;e++)b.push(a.Xc[e].name);for(var c=[],e=0;e<ma.length;e++){var d=ma[e],g=d.s;20==g.type?c.push(d):60==d.s.type&&"MESH"==a.type?c.push(d):10==g.type&&"ARMATURE"==a.type?c.push(d):40==g.type&&"SPEAKER"==a.type?c.push(d):80==g.type&&"WORLD"==a.type&&c.push(d)}for(e=0;e<c.length;e++)b.push(t(c[e].name));if(Y.SB(a)&&Y.YJ(a))for(a=a.I,e=0;e<a.length;e++)for(c=a[e].U,d=0;d<c.length;d++)(g=c[d].gb)&&b.push(g.name);return b};
a.dM=t;a.PH=function(a,b){var e=a.ha[b];return e?e.type:0};a.xt=function(a){for(var e=0,c=a.I,g=0;g<c.length;g++)for(var l=c[g].U,E=0;E<l.length;E++){var w=l[E].gb;w&&"EMITTER"==w.Zv&&!l[E].Zf&&(ba(a,e),b(a.ha[e],w),J(a,e),a.ha[e].behavior=w.ve?10:a.hl,e++)}c=a.Jg.slice();for(g=0;g<c.length;g++)E=c[g],l=E.Xn,E=E.action,ba(a,e),f(a,l,E,e)?(J(a,e),a.ha[e].behavior=a.hl,e++):a.ha[e]=null;n(a)&&(ba(a,e),d(a,a.Xc[0],e),J(a,e),a.ha[e].behavior=a.hl)};a.Yy=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;
case "FINISH_STOP":return 30;default:xa.q("Wrong animation behavior")}};a.qU=function(a){var b=[];a=a.data.materials;for(var e=0;e<a.length;e++){var c=a[e],d=c.node_tree;d&&z(d,b,[c.name])}return b};a.bJ=q;a.play=function(a,b,e){h(a.ha,e,function(a){a.play=!0;a.vA=b?b:null;a.Fq=!1});a.k.ti&&A(a)};a.stop=function(a,b){h(a.ha,b,function(a){a.play=!1;a.vA=null;a.Fq=!1})};a.Yj=function(a,b){var e=a.ha;if(-1==b)for(var c=0;8>c;c++){if(e[c]&&e[c].play)return!0}else if(e=e[b])return e.play;return!1};a.no=
x;a.KC=function(a,b){b=b||0;h(a.ha,b,function(e){x(a,e.start,b)})};a.YH=function(a,b){var e=a.ha[b];return e&&e.wf?e.wf:0};a.qV=function(a,b){var e=a.ha[b];return e&&10==e.behavior};a.cs=function(a,b,e){h(a.ha,e,function(a){a.behavior=b})};a.SH=function(a,b){var e=a.ha[b];return e&&e.behavior};a.rF=function(a,b,e,c){h(a.ha,c,function(a){a.CD=b||0;a.lC=e||0})};a.FK=function(a,b){if(-1==b)for(var e=0;8>e;e++)a.ha[e]=null;else a.ha[b]=null;a.k.ti&&N(a,b)};a.DZ=k;a.$J=function(a){if("ARMATURE"==a.type||
a.zt||"WORLD"==a.type)return!0;for(var b=0;b<a.Jg.length;b++){var e=a.Jg[b].action.s.type;if(20==e||10==e||40==e&&"SPEAKER"==a.type||70==e&&"LAMP"==a.type||60==e&&"MESH"==a.type)return!0}return Y.SB(a)&&Y.YJ(a)||"MESH"==a.type&&a.Xc.length?!0:!1};a.UF=function(a,b){if("ARMATURE"==b.type||Z(a)||"WORLD"==b.type)return!0;for(var e=0;e<b.Jg.length;e++){var c=b.Jg[e].action.s.type;if(20==c||10==c||40==c&&"SPEAKER"==b.type||60==c&&"MESH"==b.type)return!0}return Y.NQ(a)&&Y.MQ(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?
!0:!1};a.Ac=function(a){return Boolean(a.ha.length)};a.XQ=F;a.ET=c;a.PP=function(a){function b(a,G){for(var e=0;e<G;e++){var T=a.subarray(8*e+4,8*e+8);aa.normalize(T,T)}}function c(a,G){if(-1<a.indexOf("location"))var b=0,e=G;else-1<a.indexOf("rotation_quaternion")?(b=4,e=0==G?3:G-1):-1<a.indexOf("scale")?(b=3,e=0):(b=0,e=G);return b+e}function d(a,G,b,e,T){if(-1<b.search(g)){a=G;b=b.split('"')[1];var c=E}else 8==T?(b="tsr",c=E):c=1<T?new Float32Array(T):0;if(!a[b]){T=a;G=b;if("object"==typeof c&&
c.length)for(var da=c.length,l=new Float32Array(e*da),w=0;w<e;w++)for(var p=0;p<da;p++)l[w*da+p]=c[p];else if("number"==typeof c)for(l=new Float32Array(e),w=0;w<e;w++)l[w]=c;else xa.q("Wrong storage default value");T[G]=l}return a[b]}var g=new RegExp(/pose.bones\[\".+\"\]/g),E=oa.create(),w=a.s={type:0,RB:0,iK:0,qb:null,jz:null,KF:null,yi:new Int8Array(8)};w.iK=1/X.Kl;var u=a.fcurves,p={},G={},T=0,da;for(da in u){var f=u[da],k;for(k in f){var m=f[k],B=m.uf;ca.iR(m,a);m=m.num_channels;T||(T=B.length);
for(var m=d(p,G,da,T,m),I=m.length/T,y=c(da,k|0),R=0;R<T;R++)m[R*I+y]=B[R]}}if(xa.Tq(p)){for(var Q in p)"tsr"==Q&&b(p[Q],T);w.qb=p}if(xa.Tq(G)){for(var J in G)b(G[J],T);w.jz=G}w.RB=T;w.KF=a.FP;"tsr"in p&&C(u,w.yi);("color"in p||"energy"in p)&&v(u,w.yi);("light_settings.environment_energy"in p||"horizon_color"in p||"zenith_color"in p||"mist_settings.intensity"in p||"mist_settings.depth"in p||"mist_settings.start"in p||"mist_settings.height"in p||"b4w_fog_color"in p)&&e(u,w.yi);l(a);ma.push(a)};a.pU=
function(a,b){return(b-a)*X.Kl+1};a.oQ=function(a,b,e,c,d,g){var l=new Float32Array(2),w=new Float32Array(2),E=new Float32Array(2),G=new Float32Array(2),T=b[1],da=b[2],u=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var f=0,k=0,m=null;d<=g;d++)if(d<T)for(var B=0;B<X.Kl;B++)e[f++]=da;else if(d>u)for(B=0;B<X.Kl;B++)e[f++]=a;else{var I=b[k],y=3;0===I&&(y+=2);0===m&&(y+=2);var Q=2===I?0:1;if(b[k+1]==b[k+y+1])m=I,k+=y;else{B=0;d==b[k+1]&&(Q&&(c[f]=1),e[f]=b[k+2],f++,B++);if(d==u)for(;B<X.Kl;B++)e[f++]=
a;else for(l[0]=b[k+1],l[1]=b[k+2],0!==I?(w[0]=0,w[1]=0):0===m?(w[0]=b[k+5],w[1]=b[k+6]):(w[0]=b[k+3],w[1]=b[k+4]),0!==I?(E[0]=0,E[1]=0):(E[0]=b[k+y+3],E[1]=b[k+y+4]),G[0]=b[k+y+1],G[1]=b[k+y+2];B<X.Kl;B++){var J=d+B/X.Kl;switch(I){case 0:var h=l,q=w,v=E,U=G,n=[],S=[],C=void 0,A=void 0,V=void 0,C=void 0;n[0]=h[0]-q[0];n[1]=h[1]-q[1];S[0]=U[0]-v[0];S[1]=U[1]-v[1];V=U[0]-h[0];C=Math.abs(n[0]);A=Math.abs(S[0]);0!=C+A&&C+A>V&&(C=V/(C+A),q[0]=h[0]-C*n[0],q[1]=h[1]-C*n[1],v[0]=U[0]-C*S[0],v[1]=U[1]-C*S[1]);
Q&&(c[f]=1);e[f]=p(R(0,1,J,l[0],w[0],E[0],G[0]),l[1],w[1],E[1],G[1]);f++;break;case 1:Q&&(c[f]=1);h=l[0];q=l[1];v=(G[1]-q)/(G[0]-h);e[f]=v*J+(q-v*h);f++;break;case 2:Q&&(c[f]=1);e[f]=b[k+2];f++;break;default:xa.q("Unknown keyframe interpolation mode: "+I)}}d+1==b[k+y+1]&&(m=I,k+=y)}}};a.apply=B;a.kQ=function(a,b,e,c){c=c||0;var d=xa.Cd("uuid",e,ma);if(d){ba(a,c);if(f(a,b,d,c)){J(a,c);return}a.ha[c]=null}u.error('Unsupported object: "'+a.name+'" or animation uuid: "'+e+'"')};a.aN=function(a,b){var e=
xa.Cd("name",b,ma)||xa.Cd("name",b+"_B4W_BAKED",ma);if(e){if(0==e.s.type)return!1}else if(!(U(a,b)||I.Yd(a)&&V(a,b)))return!1;return!0};a.Mu=function(a,b){for(var e=a.ha,c=0;c<e.length;c++){var d=e[c];if(d&&t(d.ui)==t(b))return c}return-1};a.oU=function(a,b){var e=a.ha[b];return e&&e.ui?t(e.ui):null};a.remove=function(a){a.ha.length=0;a=va.indexOf(a);-1!=a&&va.splice(a,1)};a.cX=function(a){for(var b=ma.length-1;0<=b;b--)ma[b].GP==a&&ma.splice(b,1)};a.sF=function(a,b){if(!a.ha.length)return B(a,b,
0)?0:-1;for(var e=0;e<a.ha.length;e++)if(!a.ha[e])return B(a,b,e)?e:-1};a.qL=function(a,b,e){a.k.yp=(b-a.k.yh)/e;a.k.xp=b};a.sL=function(a,b,e){h(a.ha,e,function(a){a.speed=b})};a.AI=function(a,b){return a.ha[b].speed};a.DA=function(a,b){return a.ha[b].start};a.CA=function(a,b){return a.ha[b].length};a.sa=function(){va.length=0;ma.length=0};a.JT=function(a){var b=(a[0]||a[1]||a[2]).uf.length,e=E,c=L,d=Boolean(a[0]);d||(a[0]={uf:new Float32Array(b),num_channels:8});var g=Boolean(a[1]);g||(a[1]={uf:new Float32Array(b),
num_channels:8});var l=Boolean(a[2]);l||(a[2]={uf:new Float32Array(b),num_channels:8});a[3]={uf:new Float32Array(b),num_channels:8};for(var w=0;w<b;w++)c[0]=d?a[0].uf[w]:0,c[1]=g?a[1].uf[w]:0,c[2]=l?a[2].uf[w]:0,xa.Oj(c,e),a[0].uf[w]=e[3],a[1].uf[w]=e[0],a[2].uf[w]=e[1],a[3].uf[w]=e[2]};a.UH=Z;a.rY=function(a,b){for(var e=7,c=0,d=0;d<ma.length;d++){var g=ma[d];if(g.name==b){c=g.s.type;break}}0==c&&(V(a,b)?c=30:(d=U(a,b))&&"EMITTER"==d.Zv&&(c=50));for(d=0;8>d;d++)if(g=a.ha[d]){if(g.type==c)return d}else d<
e&&(e=d);return e}};b4w.module.__armature=function(a,r){function m(a){a=a.k;for(var b=a.vo,d=a.Hv,f=0;f<b.length;f++){for(var k=b[f],m=d[f],y=0;y<m.length;y+=2)for(var h=m[y],q=m[y+1],n=0;4>n;n++)k.ke[h+n]=a.ke[q+n],k.Be[h+n]=a.Be[q+n],k.oe[h+n]=a.oe[q+n],k.Ee[h+n]=a.Ee[q+n];k.Ue=a.Ue}}function d(a,b,f,k){var m=a.FM,y=a.Jk,q=a.cx,n=a.gK;n?(n=n.cx,b?t.multiply(n,m,q):(b=h,t.invert(n,b),t.multiply(b,q,m))):b?t.copy(m,q):t.copy(q,m);m=x;t.invert(y,m);t.multiply(q,m,m);y=a.Cj;f[4*y]=m[0];f[4*y+1]=m[1];f[4*y+2]=m[2];f[4*
y+3]=m[3];k[4*y]=m[4];k[4*y+1]=m[5];k[4*y+2]=m[6];k[4*y+3]=m[7];a=a.jH;for(y=0;y<a.length;y++)q=a[y],q.ic||d(q,!0,f,k)}var b=r("__util"),t=r("__tsr"),q=r("__quat"),z=r("__mat4"),n=r("__vec3"),x=t.create(),h=t.create(),k=new Float32Array(4),f=new Float32Array(4),y=new Float32Array(4);a.Mk=function(a,d){for(var f=a.data.bones,k=a.pose.bones,m={},y=0;y<k.length;y++){var h=k[y],q=h.bone,M=q.name,F=m[M]={Cj:0,hN:-1,gK:null,jH:[],Lt:[],ic:null,DD:t.create(),FM:t.create(),Jk:t.create(),cx:t.create(),ax:t.create(),
ED:t.create(),bx:!1,mM:new Float32Array(3)},M=new Float32Array(q.matrix_local),c=new Float32Array(16);z.invert(M,c);var h=new Float32Array(h.matrix_basis),l=F.mM;n.subtract(b.yf(q.tail_local),b.yf(q.head_local),l);b.c_(l,c,l);t.Ji(M,F.Jk);t.Ji(h,F.ax);t.copy(F.Jk,F.cx)}for(y=0;y<f.length;y++){M=f[y].name;h=b.Cd("name",M,k);F=m[M];q=h.parent_recursive;F.Lt.push(F);for(c=0;c<q.length;c++)h=q[c],h=h.name,h=m[h],F.Lt.push(h);q.length?(h=q[0],h=h.name,h=m[h],F.gK=h,t.invert(h.Jk,x),t.multiply(x,F.Jk,F.DD),
h.jH.push(F)):t.copy(F.Jk,F.DD);F.Cj=y;F.name=M;t.multiply(F.DD,F.ax,F.FM)}d.k.Dg=m};a.Cu=function(a,b,d,m){var n=a.k,D=n.Ue;b=n.Dg[b];var z=b.Cj;a=b.Jk;var K=n.oe,M=n.Ee,F=n.ke,n=n.Be,c=K[4*z+1],l=K[4*z+2],C=K[4*z+3],v=M[4*z+1],e=M[4*z+2],R=M[4*z+3];k[0]=(1-D)*K[4*z]+D*M[4*z];k[1]=(1-D)*c+D*v;k[2]=(1-D)*l+D*e;k[3]=(1-D)*C+D*R;f[0]=F[4*z];f[1]=F[4*z+1];f[2]=F[4*z+2];f[3]=F[4*z+3];y[0]=n[4*z];y[1]=n[4*z+1];y[2]=n[4*z+2];y[3]=n[4*z+3];q.slerp(f,y,D,f);D=x;t.cY(k,D);t.zk(f,D);d?(d=h,t.translate(a,b.mM,
d),t.multiply(D,d,D)):t.multiply(D,a,D);t.copy(D,m)};a.CX=function(a,b,f){var k=a.k;b=k.Dg[b];var y=k.oe,h=k.ke;t.copy(f,b.cx);d(b,!1,y,h);k.Ue=0;m(a)};a.NZ=m;a.rZ=d;a.kR=function(a,b){return b in a.k.Dg}};b4w.module.__util=function(a,r){function m(a){return 0<a?1:0>a?-1:0}function d(a,b,e){var c=a[0],d=a[1];a=a[2];var G=Math.cos(c/2),T=Math.cos(d/2),da=Math.cos(a/2),g=Math.sin(c/2),d=Math.sin(d/2),l=Math.sin(a/2);if(-1<V.indexOf(b))var w=Math.cos((c+a)/2),E=Math.sin((c+a)/2),p=Math.cos((c-a)/2),u=Math.sin((c-a)/2),f=Math.cos((a-c)/2),k=Math.sin((a-c)/2);switch(b){case ra:e[0]=T*E;e[1]=d*p;e[2]=d*u;e[3]=T*w;break;case ka:e[0]=d*u;e[1]=T*E;e[2]=d*p;e[3]=T*w;break;case va:e[0]=d*p;e[1]=d*u;e[2]=T*E;e[3]=
T*w;break;case 3:e[0]=T*E;e[1]=d*k;e[2]=d*f;e[3]=T*w;break;case ma:e[0]=d*f;e[1]=T*E;e[2]=d*k;e[3]=T*w;break;case Ka:e[0]=d*k;e[1]=d*f;e[2]=T*E;e[3]=T*w;break;case 6:e[0]=g*T*da+G*d*l;e[1]=G*d*da-g*T*l;e[2]=G*T*l+g*d*da;e[3]=G*T*da-g*d*l;break;case 7:e[0]=G*T*l+g*d*da;e[1]=g*T*da+G*d*l;e[2]=G*d*da-g*T*l;e[3]=G*T*da-g*d*l;break;case 8:e[0]=G*d*da-g*T*l;e[1]=G*T*l+g*d*da;e[2]=g*T*da+G*d*l;e[3]=G*T*da-g*d*l;break;case 9:e[0]=g*T*da-G*d*l;e[1]=G*T*l-g*d*da;e[2]=G*d*da+g*T*l;e[3]=G*T*da+g*d*l;break;case 10:e[0]=
G*d*da+g*T*l;e[1]=g*T*da-G*d*l;e[2]=G*T*l-g*d*da;e[3]=G*T*da+g*d*l;break;case 11:e[0]=G*T*l-g*d*da,e[1]=G*d*da+g*T*l,e[2]=g*T*da-G*d*l,e[3]=G*T*da+g*d*l}return e}function b(a,b,e){var c=a[0],d=a[1],G=a[2];a=a[3];switch(b){case ra:e[0]=Math.atan2(c*d+G*a,d*a-c*G);e[1]=Math.acos(1-2*(d*d+G*G));e[2]=Math.atan2(c*d-G*a,c*G+d*a);break;case ka:e[0]=Math.atan2(c*a+d*G,G*a-c*d);e[1]=Math.acos(1-2*(c*c+G*G));e[2]=Math.atan2(d*G-c*a,c*d+G*a);break;case va:e[0]=Math.atan2(c*G+d*a,c*a-d*G);e[1]=Math.acos(1-2*
(c*c+d*d));e[2]=Math.atan2(c*G-d*a,c*a+d*G);break;case 3:e[0]=Math.atan2(c*G-d*a,c*d+G*a);e[1]=Math.acos(1-2*(d*d+G*G));e[2]=Math.atan2(c*G+d*a,G*a-c*d);break;case ma:e[0]=Math.atan2(c*d-G*a,c*a+d*G);e[1]=Math.acos(1-2*(c*c+G*G));e[2]=Math.atan2(c*d+G*a,c*a-d*G);break;case Ka:e[0]=Math.atan2(d*G-c*a,c*G+d*a);e[1]=Math.acos(1-2*(c*c+d*d));e[2]=Math.atan2(c*a+d*G,d*a-c*G);break;case 6:e[0]=Math.atan2(2*(c*a-d*G),1-2*(c*c+d*d));e[1]=Math.asin(2*(c*G+d*a));e[2]=Math.atan2(2*(G*a-c*d),1-2*(d*d+G*G));break;
case 7:b=c*d+G*a;.499999<b?(e[0]=0,e[1]=Math.PI/2,e[2]=2*Math.atan2(c,a)):-.499999>b?(e[0]=0,e[1]=-Math.PI/2,e[2]=-2*Math.atan2(c,a)):(e[0]=Math.atan2(2*(d*a-c*G),1-2*(d*d+G*G)),e[1]=Math.asin(2*(c*d+G*a)),e[2]=Math.atan2(2*(c*a-d*G),1-2*(c*c+G*G)));break;case 8:e[0]=Math.atan2(2*(G*a-c*d),1-2*(c*c+G*G));e[1]=Math.asin(2*(c*a+d*G));e[2]=Math.atan2(2*(d*a-c*G),1-2*(c*c+d*d));break;case 9:e[0]=Math.atan2(2*(c*a+d*G),1-2*(c*c+G*G));e[1]=Math.asin(2*(G*a-c*d));e[2]=Math.atan2(2*(c*G+d*a),1-2*(d*d+G*G));
break;case 10:e[0]=Math.atan2(2*(c*G+d*a),1-2*(c*c+d*d));e[1]=Math.asin(2*(c*a-d*G));e[2]=Math.atan2(2*(c*d+G*a),1-2*(c*c+G*G));break;case 11:b=d*a-c*G,.499999<b?(e[0]=0,e[1]=Math.PI/2,e[2]=-2*Math.atan2(G,a)):-.499999>b?(e[0]=0,e[1]=-Math.PI/2,e[2]=2*Math.atan2(G,a)):(e[0]=Math.atan2(2*(c*d+G*a),1-2*(d*d+G*G)),e[1]=Math.asin(2*(d*a-c*G)),e[2]=Math.atan2(2*(c*a+d*G),1-2*(c*c+d*d)))}return e}function t(a,e,b){var c=e.length,d=U;d[0]=a[0];d[1]=a[1];d[2]=a[2];p.normalize(d,d);c?(a=aa,a[0]=e[0],a[1]=
e[1],a[2]=e[2],a[3]=e[3],e=p.cross(a,d,ga),p.normalize(e,e),p.cross(d,e,a),c=ca,c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=e[0],c[7]=e[1],c[8]=e[2],R.fromMat3(c,b),b[3]=0<b[3]?b[3]+3.1E-5:b[3]-3.1E-5,(0<b[3]&&0>a[3]||0>b[3]&&0<a[3])&&R.scale(b,-1,b),R.normalize(b,b)):R.rotationTo(na,d,b);return b}function q(a,e){e||(e=new Float32Array(4));c.fromMat4(a,ca);var b=ca[0],d=ca[3],g=ca[6],G=ca[1],T=ca[4],da=ca[7],l=ca[2],w=ca[5],E=ca[8],b=Math.sqrt(b*b+d*d+g*g)||1,G=Math.sqrt(G*G+
T*T+da*da)||1,l=Math.sqrt(l*l+w*w+E*E)||1;ca[0]/=b;ca[3]/=b;ca[6]/=b;ca[1]/=G;ca[4]/=G;ca[7]/=G;ca[2]/=l;ca[5]/=l;ca[8]/=l;R.fromMat3(ca,e);R.normalize(e,e);return e}function z(a){var e=a[0],b=a[1],c=a[2],d=a[3],G=Math.sqrt(e*e+b*b+c*c),G=1/G;a[0]=e*G;a[1]=b*G;a[2]=c*G;a[3]=d*G}function n(a,e){var b=e;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var c in a)b=n(a[c],b);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(c=
0;c<a.length;c++)b=x(a[c],b);break;case Array:for(c=0;c<a.length;c++)b=n(a[c],b);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:b=x(0,b);break;default:H("Wrong object constructor")}else b=x(0,b);return b;case "number":return x(a,b);case "boolean":return x(a|0,b);case "string":return h(a,b);case "function":case "undefined":return x(0,b)}}function x(a,b){var e=b;S[0]=a;e=(e<<5)-e+fa[0];e&=e;e=(e<<5)-e+fa[1];return e&e}function h(a,
e){for(var b=e,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return b}function k(a){return(34*a+1)*a%289}function f(a){return a-Math.floor(a)}function y(a){return g((34*a+5)*a)}function g(a){return a-289*Math.floor(a/289)}function A(a){return a-7*Math.floor(a/7)}function N(a,e,b){a<e&&(a=e);a>b&&(a=b);return a}function H(a){a&&v.error.apply(v,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function O(a,e,b){a-=e;b-=e;return e+(a-Math.floor(a/b)*b)}function D(a){return O(a,0,2*Math.PI)}function P(a,e){if(a&&e){var b=a instanceof Array;if(b!=e instanceof Array)return!1;var c=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(c!=(e.buffer instanceof ArrayBuffer&&"undefined"!==e.byteLength))return!1;if(b){if(a.length!=e.length)return!1;for(b=0;b<a.length;b++)if(!K(a[b],e[b]))return!1}else if(c){if(a.length!=e.length)return!1;for(b=0;b<a.length;b++)if(a[b]!=e[b])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
e}for(var d in a)if(!K(a[d],e[d]))return!1;for(d in e)if(!(d in a))return!1}return!0}return!(a||e)}function K(a,e){if(typeof a!=typeof e)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==e;case "object":return P(a,e);default:return!0}}function M(a){if(""==a)return".";var e=0==a.indexOf("/")|0;e&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(e=2);a=a.split("/");for(var b=[],c=0;c<a.length;c++){var d=a[c];""!=d&&"."!=d&&(".."!=d||!e&&!b.length||b.length&&".."==b[b.length-1]?
b.push(d):b.length&&b.pop())}a=b.join("/");for(c=0;c<e;c++)a="/"+a;return a||"."}function F(){var a=[{}];a.length=0;return a}var c=r("__mat3"),l=r("__mat4"),C=r("__math"),v=r("__print"),e=r("__tsr"),R=r("__quat"),p=r("__vec3"),ba=r("__vec4"),J=0,B={},V=[ra,ka,va,ma,Ka],U=new Float32Array(3),Z=new Float32Array(3),w=new Float32Array(3),ga=new Float32Array(3),Q=new Float32Array(3),I=new Float32Array(3),Y=new Float32Array(3),ia=new Float32Array(3),u=new Float32Array(4),aa=new Float32Array(4),ca=new Float32Array(9),
ja=new Float32Array(16),wa=new Float32Array(16),pa=R.create(),S=new Float64Array(1),fa=new Uint32Array(S.buffer),oa=new Float32Array([0,0,0]),xa=new Float32Array([0,0,0,1]),la=new Float32Array([0,0,0,1,0,0,0,1]),X=new Float32Array([1,1,1]),ya=new Float32Array([1,0,0]),na=new Float32Array([0,1,0]),L=new Float32Array([0,0,1]),ea=new Float32Array([-1,0,0]),E=new Float32Array([0,-1,0]),za=new Float32Array([0,0,-1]),ra=0,ka=1,va=2,ma=4,Ka=5,Ga=Math.floor(44488.07041494893),Ca=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.RE=oa;a.Xm=xa;a.W0=la;a.Qy=X;a.li=ya;a.mi=na;a.$c=L;a.Dx=ea;a.Wk=E;a.Zc=za;a.SE=ra;a.ZE=ka;a.$E=va;a.UE=3;a.WE=ma;a.bF=Ka;a.TE=6;a.YE=7;a.Ry=8;a.VE=9;a.XE=10;a.aF=11;a.GN=Ca;a.Ex=1;a.pp=2;a.tj=4;a.hE=4;
a.Oh=function(a){return"undefined"!=typeof a};a.uJ=function(a,e,b){for(var c=[],d=b.length,G=0;G<d;G++){var T=b[G];T[a]==e&&c.push(T)}return c};a.yf=function(a){return new Float32Array(a)};a.QT=function(a,e){var b=a.length,c=new Float32Array(b+e.length);c.set(a);c.set(e,b);return c};a.iZ=function(a,e){var b=a.length,c=new Uint32Array(b+e.length);c.set(a);c.set(e,b);return c};a.rR=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.pQ=function(a,e){var b=
[],c={},d=e.length,G,T;for(G=0;G<d;G++)c[e[G]]=!0;d=a.length;for(G=0;G<d;G++)T=a[G],T in c&&b.push(T);return b};a.sign=m;a.S5=function(a,e,b){for(var c=b.length,d=0;d<c;d++)if(b[d][a]==e)return!0;return!1};a.Cd=function(a,b,e){for(var c=0;c<e.length;c++){var d=e[c];if(d[a]===b)return d}return null};a.P5=function(a,e,b,c,d){for(var G=0;G<d.length;G++){var T=d[G];if(T[a]==e&&T[b]==c)return T}return null};a.JU=function(a,e){for(var b=0;b<a.length;b++)if(a[b].uuid==e)return b;return-1};a.jQ=function(a,
b){for(var e=0;e<a.length;e++)if(a[e]==b)return;a.push(b)};a.e2=function(a){for(var b=0;b<a.length-1;b++)for(var e=a[b],c=b+1;c<a.length;c++)if(e==a[c])return!1;return!0};a.$Y=function(a,b,e,c){c||(c=new Float32Array(16));l.identity(c);c[12]=a;c[13]=b;c[14]=e};var ta=1;a.$W=function(){ta=(69069*ta+5)%Math.pow(2,32);return Math.round(ta/65536)%32768/32767};a.HY=function(a){ta=a};a.og=function(a){var b=a[0]%Ga*48271-3399*Math.floor(a[0]/Ga);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.kv=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.Oj=function(a,b){var e=U;e[0]=a[2];e[1]=a[1];e[2]=a[0];d(e,11,b);return b};a.TB=d;a.yK=b;a.xT=function(a){var b=c.create(),e=Math.cos(a[0]),d=Math.cos(a[1]),g=Math.cos(a[2]),G=Math.sin(a[0]),T=Math.sin(a[1]);a=Math.sin(a[2]);var da=e*g,l=e*a,w=G*g,E=G*a;b[0]=d*g;b[1]=d*a;b[2]=-T;b[3]=T*w-l;b[4]=T*E+da;b[5]=d*G;b[6]=T*da+E;b[7]=T*l-w;b[8]=d*e;return b};a.lw=function(a,e){var c=b(a,11,U);e[0]=c[2];e[1]=c[1];e[2]=c[0];return e};a.kc=function(a,b,e){e||
(e=new Float32Array(3));p.transformQuat(b,a,e);return e};a.hA=function(a,b,e){e||(e=new Float32Array(4));a=p.normalize(a,U);var c=p.dot(b,a);a=p.cross(b,a,w);c=Math.acos(c);e[0]=a[0]*Math.sin(c/2);e[1]=a[1]*Math.sin(c/2);e[2]=a[2]*Math.sin(c/2);e[3]=Math.cos(c/2);return e};a.aZ=function(a,b,e,c){c||(c=new Float32Array(4));p.transformQuat(e,b,c);c[3]=-p.dot(a,c)};a.hT=function(a){var b=e.R(a.k.n),c=U;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;p.transformQuat(c,b,c);w[0]=0;w[1]=0;w[2]=-1;break;
case "MESH":c[0]=0;c[1]=0;c[2]=1;p.transformQuat(c,b,c);w[0]=0;w[1]=0;w[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,p.transformQuat(c,b,c),w[0]=0,w[1]=1,w[2]=0}c[1]=0;p.normalize(c,c);a=p.dot(c,w);return Math.acos(a)*(0<-c[0]*w[2]?-1:1)};a.NF=function(a,b,e,c){if(0!=e){c=c||[];for(var d=0;d<a.length;d++)c[d]=(1-e)*a[d]+e*b[d]}};a.jZ=function(){J++;return J.toString(10)};a.qs=function(a){B[a]||(B[a]=0);var b=a+B[a];B[a]++;return b};a.Ig=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.Rq=function(a,b,e){b=b||F();var c=b.length,d=a.length/3;e=e||new Float32Array(4*d);for(var G=0;G<d;++G){var T=U;T[0]=a[3*G];T[1]=a[3*G+1];T[2]=a[3*G+2];var g;c?(g=aa,g[0]=b[4*G],g[1]=b[4*G+1],g[2]=b[4*G+2],g[3]=b[4*G+3]):g=b;t(T,g,e.subarray(4*G,4*(G+1)))}return e};a.DI=t;a.Bh=function(a){return JSON.parse(JSON.stringify(a))};a.P=function(b){if(!(b instanceof Object))return b;var e;e=b.constructor;switch(e){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:e=
new e(b);break;case Array:e=new e(b.length);for(var c=0;c<b.length;c++)e[c]=a.P(b[c]);break;default:for(c in e=new e,b)e[c]=a.P(b[c])}return e};a.bq=function(a){var b=a instanceof Array?[]:{},e;for(e in a)if(a[e]instanceof Object){var c=a[e].constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[e]=new c(a[e]);break;case Array:b[e]=a[e].slice(0);break;default:b[e]=a[e]}}else b[e]=a[e];return b};a.xB=
q;a.IJ=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.HJ=function(a){u[0]=.577350269189626;u[1]=.577350269189626;u[2]=.577350269189626;u[3]=0;ba.transformMat4(u,a,u);return ba.length(u)};a.un=function(a,b){var e=b.left,c=b.right,d=b.top,G=b.bottom,T=b.near,g=b.far;e[0]=a[3]+a[0];e[1]=a[7]+a[4];e[2]=a[11]+a[8];e[3]=a[15]+a[12];c[0]=a[3]-a[0];c[1]=a[7]-a[4];c[2]=a[11]-a[8];c[3]=a[15]-a[12];d[0]=a[3]-a[1];d[1]=a[7]-a[5];d[2]=a[11]-a[9];d[3]=a[15]-a[13];G[0]=a[3]+
a[1];G[1]=a[7]+a[5];G[2]=a[11]+a[9];G[3]=a[15]+a[13];T[0]=a[3]+a[2];T[1]=a[7]+a[6];T[2]=a[11]+a[10];T[3]=a[15]+a[14];g[0]=a[3]-a[2];g[1]=a[7]-a[6];g[2]=a[11]-a[10];g[3]=a[15]-a[14];z(e);z(c);z(d);z(G);z(T);z(g)};a.CY=function(a,b,e){return e<-C.ng(a,b.near)||e<-C.ng(a,b.left)||e<-C.ng(a,b.right)||e<-C.ng(a,b.top)||e<-C.ng(a,b.bottom)||e<-C.ng(a,b.far)?!0:!1};a.rT=function(a,b,e,c,d){var G=p.dot(e,b.far),T=p.dot(c,b.far),g=p.dot(d,b.far),G=Math.sqrt(G*G+T*T+g*g);if(G<-C.ng(a,b.near)||G<-C.ng(a,b.far))return!0;
G=p.dot(e,b.left);T=p.dot(c,b.left);g=p.dot(d,b.left);if(Math.sqrt(G*G+T*T+g*g)<-C.ng(a,b.left))return!0;G=p.dot(e,b.right);T=p.dot(c,b.right);g=p.dot(d,b.right);if(Math.sqrt(G*G+T*T+g*g)<-C.ng(a,b.right))return!0;G=p.dot(e,b.top);T=p.dot(c,b.top);g=p.dot(d,b.top);if(Math.sqrt(G*G+T*T+g*g)<-C.ng(a,b.top))return!0;G=p.dot(e,b.bottom);T=p.dot(c,b.bottom);g=p.dot(d,b.bottom);return Math.sqrt(G*G+T*T+g*g)<-C.ng(a,b.bottom)?!0:!1};a.eo=function(a,b,e,c){c||(c=0);for(var d=a.length,G=0;G<d;G+=3){var T=
a[G],g=a[G+1],l=a[G+2];e[c+G]=b[0]*T+b[4]*g+b[8]*l+b[12];e[c+G+1]=b[1]*T+b[5]*g+b[9]*l+b[13];e[c+G+2]=b[2]*T+b[6]*g+b[10]*l+b[14]}};a.O8=function(a,b,e,c){c||(c=0);for(var d=a.length,G=0;G<d;G+=3){var T=a[G],g=a[G+1],l=a[G+2];e[c+G]=b[0]*T+b[4]*g+b[8]*l;e[c+G+1]=b[1]*T+b[5]*g+b[9]*l;e[c+G+2]=b[2]*T+b[6]*g+b[10]*l}return e};a.zK=function(a,b,e,c){c=c||0;for(var d=a.length,G=0;G<d;G+=4){pa[0]=a[G];pa[1]=a[G+1];pa[2]=a[G+2];pa[3]=a[G+3];var T=0<pa[3];R.multiply(b,pa,pa);(T&&0>pa[3]||!T&&0<pa[3])&&ba.scale(pa,
-1,pa);e[c+G]=pa[0];e[c+G+1]=pa[1];e[c+G+2]=pa[2];e[c+G+3]=pa[3]}};a.c_=function(a,b,e){e||(e=new Float32Array(3));u[0]=a[0];u[1]=a[1];u[2]=a[2];u[3]=0;ba.transformMat4(u,b,u);e[0]=u[0];e[1]=u[1];e[2]=u[2]};a.k3=function(a,b){var e=a.length;e||H("flatten(): Wrong or empty array");var c=a[0].length;c||H("flatten(): Wrong or empty subarray");b||(b=new Float32Array(e*c));for(var d=0;d<e;d++)for(var G=0;G<c;G++)b[d*c+G]=a[d][G];return b};a.d_=function(a){for(var b=[],e=0;e<a.length;e+=3){var c=new Float32Array([a[e],
a[e+1],a[e+2]]);b[e/3]=c}return b};a.Et=function(b,e,c,d){if(d<c)return c;var g=c+Math.floor((d-c)/2);return b[g]>e?a.Et(b,e,c,g-1):b[g]<e?a.Et(b,e,g+1,d):g};a.Fj=function(a,b){for(var e=0;e<a.length;e++)if(a[e]!=b[e])return!1;return!0};a.o2=function(a,b,e){for(var c=0;c<a.length;c++)if(Math.abs(a[c]-b[c])>e)return!1;return!0};a.U6=function(a,b,e){e||(e=new Float32Array(16));for(var c=0;12>c;c++)e[c]=a[c]*b;e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.dZ=function(a,b,e,c,d){d||(d=new Float32Array(16));
b=l.fromRotationTranslation(e,c,ja);l.multiply(b,a,d);return d};a.Vc=function(a,b,e,c,d){d||(d=new Float32Array(3));e=l.fromRotationTranslation(e,c,ja);1!==b&&(c=l.identity(wa),b=p.set(b,b,b,U),l.scale(c,b,c),l.multiply(e,c,e));p.transformMat4(a,e,d);return d};a.y8=function(a,b,e,c,d){d||(d=new Float32Array(4));b=l.fromRotationTranslation(e,c,ja);ba.transformMat4(a,b,d);return d};a.E5=function(a,b,e,c,d){d||(d=new Float32Array(3));b=l.fromRotationTranslation(e,c,ja);l.invert(b,b);p.transformMat4(a,
b,d);return d};a.w8=function(a,b,e){e||(e=new Float32Array(16));l.fromRotationTranslation(b,a,e);a=a[3];for(b=0;12>b;b++)e[b]*=a;return e};a.c6=function(b,e,c){a.IJ(b,e);e[3]=a.HJ(b);q(b,c)};a.z1=function(a){for(var b=[],e=0;e<a.length;e++)b.push(a[e]);return JSON.stringify(b)};a.tX=function(a,b,e,c){c||(c=new Float32Array(3));var d=U;p.subtract(b,a,d);p.transformQuat(d,e,d);p.subtract(b,d,c)};a.eU=function(){var a=U;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),
d=new Float32Array(16),G=new Float32Array(16),T=new Float32Array(16);l.lookAt(a,[-1,0,0],[0,-1,0],b);l.scale(b,[-1,1,1],b);l.scale(b,[-1,1,-1],e);l.lookAt(a,[0,-1,0],[0,0,-1],c);l.scale(c,[1,1,-1],c);l.scale(c,[1,-1,-1],d);l.lookAt(a,[0,0,-1],[0,-1,0],G);l.scale(G,[-1,1,1],G);l.scale(G,[-1,1,-1],T);return[b,e,c,d,G,T]};a.iU=function(){var a=U;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),e=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),G=new Float32Array(16),T=new Float32Array(16);
l.lookAt(a,[1,0,0],[0,-1,0],b);l.scale(b,[-1,1,-1],e);l.lookAt(a,[0,1,0],[0,0,1],c);l.scale(c,[1,-1,-1],d);l.lookAt(a,[0,0,1],[0,-1,0],G);l.scale(G,[-1,1,-1],T);return[b,e,c,d,G,T]};a.$Q=function(a){return n(a,0)};a.UI=n;a.r5=h;a.hW=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.xK=function(a,b){b||(b=a);var e=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<e?(b[3]=2*Math.acos(a[3]),e=1/Math.sqrt(e),
b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Kb=function(a){return a*Math.PI/180};a.df=function(a){return 180*a/Math.PI};a.aD=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],e=Math.floor(a[0]+b),c=Math.floor(a[1]+b),d=.211324865405187*e+.211324865405187*c,b=a[0]-e+d;a=a[1]-c+d;var G=b>a?1:0,T=1-G,d=b+.211324865405187-G,g=a+.211324865405187-T,l=b+-.577350269189626,w=a+-.577350269189626,
e=e%289,c=c%289,E=k(k(c)+e),T=k(k(c+T)+e+G),p=k(k(c+1)+e+1),e=Math.max(.5-(b*b+a*a),0),c=Math.max(.5-(d*d+g*g),0),G=Math.max(.5-(l*l+w*w),0),u=2*f(.024390243902439*E)-1,m=2*f(.024390243902439*T)-1,B=2*f(.024390243902439*p)-1,E=Math.abs(u)-.5,T=Math.abs(m)-.5,p=Math.abs(B)-.5,u=u-Math.floor(u+.5),m=m-Math.floor(m+.5),B=B-Math.floor(B+.5),e=e*e*e*e*(1.79284291400159-.85373472095314*(u*u+E*E)),c=c*c*c*c*(1.79284291400159-.85373472095314*(m*m+T*T)),G=G*G*G*G*(1.79284291400159-.85373472095314*(B*B+p*p));
return 130*(e*(u*b+E*a)+c*(m*d+T*g)+G*(B*l+p*w))};a.aG=function(a){var b=1/7,e=b/2,c=g(Math.floor(a[0])),d=g(Math.floor(a[1])),G=f(a[0]);a=f(a[1]);var T=G-.5,da=G-1.5,G=a-.5;a-=1.5;var l=y(c),w=y(c+1),E=l,c=w,l=y(l+d),w=y(w+d),E=y(E+d+1),c=y(c+d+1),d=T+.7*(A(l)*b+e),p=da+.7*(A(w)*b+e),T=T+.7*(A(E)*b+e),da=da+.7*(A(c)*b+e),l=G+.7*(A(Math.floor(l*b))*b+e),G=G+.7*(A(Math.floor(w*b))*b+e),E=a+.7*(A(Math.floor(E*b))*b+e),b=a+.7*(A(Math.floor(c*b))*b+e);return Math.min(d*d+l*l,p*p+G*G,T*T+E*E,da*da+b*b)};
a.kC=function(a,b,e,c,d){d||(d=new Float32Array(4));a=p.transformQuat(b,a,U);b=e[0];var G=e[1];e=e[2];var T=ca;T[0]=G*G+e*e;T[1]=-G*b;T[2]=-e*b;T[3]=-b*G;T[4]=b*b+e*e;T[5]=-e*G;T[6]=-b*e;T[7]=-G*e;T[8]=b*b+G*G;p.transformMat3(a,T,a);p.normalize(a,a);R.rotationTo(c,a,d);return d};a.sz=function(a,b){b||(b=new Float32Array(4));var e=u,c=aa,e=R.setAxisAngle([0,0,1],Math.PI,R.create()),c=R.setAxisAngle([1,0,0],Math.PI/2,R.create());R.multiply(e,c,e);R.multiply(a,e,b);return b};a.sa=function(){J=0;B={}};
a.V=N;a.vc=function(a,b,e,c){e=Math.exp(-e/c);return(1-e)*a+e*b};a.Qw=function(a,b,e,c,d){d||(d=new Float32Array(a.length));e=Math.exp(-e/c);for(c=0;c<d.length;c++)d[c]=(1-e)*a[c]+e*b[c];return d};a.SL=function(a,b,e,c,d){d||(d=new Float32Array(a.length));R.slerp(a,b,Math.exp(-e/c),d)};a.fB=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.bk=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};
a.Kz=function(a,b){var e=c.fromQuat(a,ca),d=U;d[0]=e[6];d[1]=e[7];d[2]=e[8];d=p.cross(L,d,d);p.normalize(d,d);var g=e[4];!b&&0<g&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);w[0]=e[0];w[1]=e[1];w[2]=e[2];p.normalize(w,w);e=aa;R.rotationTo(w,d,e);R.multiply(e,a,a)};a.RH=function(a,b,e,c){e=e*b-.5;var d=c*b-.5;c=e-Math.floor(e);var G=d-Math.floor(d);e=Math.floor(e);var d=Math.floor(d),T=b-1,g=a[d*b+e],l=a[d*b+Math.min(e+1,T)],w=a[Math.min(d+1,T)*b+e];a=a[Math.min(d+1,T)*b+Math.min(e+1,T)];return(g*(1-c)+l*c)*(1-G)+
(w*(1-c)+a*c)*G};a.vm=function(a){for(var b=0,e=0;3>e;e++)0<(a&1<<e)&&b++;return b};a.LK=function(a){for(var b=[0,0,0],e=0;3>e;e++)0<(a&1<<e)&&(b[2-e]=1);return b};a.ko=function(a,b){var e=0;(1==b||2==b)&&0<(a&4)&&e++;2==b&&0<(a&2)&&e++;return e};a.yA=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.Tq=function(a){var b=0,e;for(e in a)a.hasOwnProperty(e)&&b++;return b};a.AK=function(a){if(!a.length)return null;
var b=Math.floor(Math.random()*a.length);return a[b]};a.XI=function(a,b,e){e||(e=new Float32Array(3));e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=0;p.normalize(e,e)};a.bZ=function(a,b,e){var c=a[0],d=a[1];a=a[2];var G=b[0],T=b[1],g=b[2];b=b[3];var l=T*a-g*d,w=g*c-G*a,E=G*d-T*c,p=T*E-g*w,g=g*l-G*E,G=G*w-T*l;e[0]=c+2*l*b+2*p;e[1]=d+2*w*b+2*g;e[2]=a+2*E*b+2*G};a.assert=function(a){a||H("Assertion failed")};a.q=H;a.Bg=O;a.si=D;a.IA=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.KY=function(a,b){for(var e in a){var c=
!0,d=a[e],G=b[e];switch(typeof d){case "number":case "string":case "boolean":c=d==G;break;case "object":c=P(d,G)}if(!c)return!1}return!0};a.jC=function(a,b){var e=a[0],c=a[2],d=a[3];b[0]=a[1];b[1]=c;b[2]=d;b[3]=e};a.FH=function(a){a+=1;132651<a&&v.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var e=Math.floor(a/51);return new Float32Array([b/51,e/51,a%51/51])};a.rB=function(a,b,e,c){u.set(a);u[3]=b;a=aa;U[0]=e[3];U[1]=e[4];U[2]=e[5];a.set(U);a[3]=0;a=ba.dot(u,a);if(0==a)return null;
b=aa;p.copy(e,U);b.set(U);b[3]=1;a=-ba.dot(u,b)/a;c[0]=e[0]+a*e[3];c[1]=e[1]+a*e[4];c[2]=e[2]+a*e[5];return c};a.OU=function(a,b,e,c){var d=b[0]-a[0],G=e[0]-a[0],T=b[1]-a[1],g=e[1]-a[1];b=b[2]-a[2];a=e[2]-a[2];c[0]=T*a-b*g;c[1]=G*b-d*a;c[2]=d*g-T*G;return c};a.r2=function(a,b){for(var e=0;e<a.length;e++)b[e]=a[e];return b};a.CC=function(a,b,e){var c=U,d=p.dot(a,b);-.9999999>d?(p.cross(ya,a,c),1E-6>p.length(c)&&p.cross(na,a,c),p.normalize(c,c),R.setAxisAngle(c,Math.PI,e)):(p.cross(a,b,c),e.set(c),
e[3]=1+d,R.normalize(e,e));return e};a.rl=function(a,b,e){if(b==e)return e-a;a=D(a);b=D(b);e=D(e);b=2*Math.PI-b;e=D(e+b);a=D(a+b);return a>e?(e-=a,a=2*Math.PI-a,-e>a?a:e):0};a.Am=function(a,b,e){isFinite(b)&&isFinite(e)&&(a=N(a,b,e));return a*a*(3-2*a)};a.lerp=function(a,b,e){return b+a*(e-b)};a.qQ=function(a,b){for(var e=0;e<a.length;e++)for(var c=0;c<b.length;c++)if(b[c]==a[e])return!0;return!1};a.B2=function(a){for(var b=Array(a),e=0;e<a;e++)b[e]=0;return b};a.fN=function(a,b){for(var e=Math.max(a.length,
b.length),c=0;c<e;c++){var d=m((c>=a.length?0:a[c])-(c>=b.length?0:b[c]));if(d)return d}return 0};a.Sk=function(a){return a.join(".")};a.bM=function(a){return a.split(".").map(function(a){return a|0})};a.b8=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.U5=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.$i=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=M(b[1]),b.join("://")):M(a)};
a.Xp=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.qT=function(a,b,e,c){c[0]=a[0];c[1]=b[0];c[2]=e[0];c[3]=a[1];c[4]=b[1];c[5]=e[1];c[6]=a[2];c[7]=b[2];c[8]=e[2];return c};a.Kj=F;a.Hq=function(a){a=Math.round(32767.5*(a+1)-32768);return N(a?a:0,-32768,32767)};a.Q7=function(a){return N((a+32768)/32767.5-1,-1,1)};a.hZ=function(a){return N(Math.round(255*a),0,255)};a.B8=function(a){return N(a/255,0,1)};a.jT=function(a,b,e,c){var d=p.subtract(e,b,U),G=p.subtract(c,e,Z),T=p.subtract(b,c,
w);b=p.subtract(a,b,ga);e=p.subtract(a,e,Q);a=p.subtract(a,c,I);c=p.cross(d,G,Y);if(0<=p.dot(p.cross(c,d,ia),b)&&0<=p.dot(p.cross(c,G,ia),e)&&0<=p.dot(p.cross(c,T,ia),a))return T=p.length(c),G=p.dot(c,b),Math.abs(G/T);d=p.scale(d,N(p.dot(d,b)/p.length(d),0,1),ia);b=p.length(p.subtract(b,d,ia));G=p.scale(G,N(p.dot(G,e)/p.length(G),0,1),ia);G=p.length(p.subtract(e,G,ia));T=p.scale(T,N(p.dot(T,a)/p.length(T),0,1),ia);T=p.length(p.subtract(a,T,ia));return Math.min(Math.min(b,G),T)}};b4w.module.__vec3=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array,m=Math.random;a.create=function(){var a=new r(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new r(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,m){var q=new r(3);q[0]=a;q[1]=b;q[2]=m;return q};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,m,q){q[0]=a;q[1]=b;q[2]=m;return q};a.add=function(a,b,m){m[0]=a[0]+b[0];m[1]=a[1]+b[1];m[2]=a[2]+b[2];
return m};a.subtract=function(a,b,m){m[0]=a[0]-b[0];m[1]=a[1]-b[1];m[2]=a[2]-b[2];return m};a.sub=a.subtract;a.multiply=function(a,b,m){m[0]=a[0]*b[0];m[1]=a[1]*b[1];m[2]=a[2]*b[2];return m};a.mul=a.multiply;a.divide=function(a,b,m){m[0]=a[0]/b[0];m[1]=a[1]/b[1];m[2]=a[2]/b[2];return m};a.div=a.divide;a.min=function(a,b,m){m[0]=Math.min(a[0],b[0]);m[1]=Math.min(a[1],b[1]);m[2]=Math.min(a[2],b[2]);return m};a.max=function(a,b,m){m[0]=Math.max(a[0],b[0]);m[1]=Math.max(a[1],b[1]);m[2]=Math.max(a[2],
b[2]);return m};a.scale=function(a,b,m){m[0]=a[0]*b;m[1]=a[1]*b;m[2]=a[2]*b;return m};a.scaleAndAdd=function(a,b,m,q){q[0]=a[0]+b[0]*m;q[1]=a[1]+b[1]*m;q[2]=a[2]+b[2]*m;return q};a.distance=function(a,b){var m=b[0]-a[0],q=b[1]-a[1],z=b[2]-a[2];return Math.sqrt(m*m+q*q+z*z)};a.dist=a.distance;a.squaredDistance=function(a,b){var m=b[0]-a[0],q=b[1]-a[1],z=b[2]-a[2];return m*m+q*q+z*z};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],m=a[1];a=a[2];return Math.sqrt(b*b+m*m+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],m=a[1];a=a[2];return b*b+m*m+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var m=a[0],q=a[1],z=a[2],m=m*m+q*q+z*z;0<m&&(m=1/Math.sqrt(m),b[0]=a[0]*m,b[1]=a[1]*m,b[2]=a[2]*m);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,m){var q=a[0],z=a[1];a=a[2];var n=b[0],x=b[1];b=b[2];
m[0]=z*b-a*x;m[1]=a*n-q*b;m[2]=q*x-z*n;return m};a.lerp=function(a,b,m,q){var z=a[0],n=a[1];a=a[2];q[0]=z+m*(b[0]-z);q[1]=n+m*(b[1]-n);q[2]=a+m*(b[2]-a);return q};a.s5=function(a,b,m,q,z,n){var x=z*z,h=x*(2*z-3)+1,k=x*(z-2)+z,f=x*(z-1);z=x*(3-2*z);n[0]=a[0]*h+b[0]*k+m[0]*f+q[0]*z;n[1]=a[1]*h+b[1]*k+m[1]*f+q[1]*z;n[2]=a[2]*h+b[2]*k+m[2]*f+q[2]*z;return n};a.JF=function(a,b,m,q,z,n){var x=1-z,h=x*x,k=z*z,f=h*x,h=3*z*h,x=3*k*x;z*=k;n[0]=a[0]*f+b[0]*h+m[0]*x+q[0]*z;n[1]=a[1]*f+b[1]*h+m[1]*x+q[1]*z;n[2]=
a[2]*f+b[2]*h+m[2]*x+q[2]*z;return n};a.random=function(a,b){a=a||1;var t=2*m()*Math.PI,q=2*m()-1,z=Math.sqrt(1-q*q)*a;b[0]=Math.cos(t)*z;b[1]=Math.sin(t)*z;b[2]=q*a;return b};a.transformMat4=function(a,b,m){var q=a[0],z=a[1];a=a[2];var n=b[3]*q+b[7]*z+b[11]*a+b[15],n=n||1;m[0]=(b[0]*q+b[4]*z+b[8]*a+b[12])/n;m[1]=(b[1]*q+b[5]*z+b[9]*a+b[13])/n;m[2]=(b[2]*q+b[6]*z+b[10]*a+b[14])/n;return m};a.transformMat3=function(a,b,m){var q=a[0],z=a[1];a=a[2];m[0]=q*b[0]+z*b[3]+a*b[6];m[1]=q*b[1]+z*b[4]+a*b[7];
m[2]=q*b[2]+z*b[5]+a*b[8];return m};a.transformQuat=function(a,b,m){var q=a[0],z=a[1],n=a[2];a=b[0];var x=b[1],h=b[2];b=b[3];var k=b*q+x*n-h*z,f=b*z+h*q-a*n,y=b*n+a*z-x*q,q=-a*q-x*z-h*n;m[0]=k*b+q*-a+f*-h-y*-x;m[1]=f*b+q*-x+y*-a-k*-h;m[2]=y*b+q*-h+k*-x-f*-a;return m};a.rotateX=function(a,b,m,q){var z=[],n=[];z[0]=a[0]-b[0];z[1]=a[1]-b[1];z[2]=a[2]-b[2];n[0]=z[0];n[1]=z[1]*Math.cos(m)-z[2]*Math.sin(m);n[2]=z[1]*Math.sin(m)+z[2]*Math.cos(m);q[0]=n[0]+b[0];q[1]=n[1]+b[1];q[2]=n[2]+b[2];return q};a.rotateY=
function(a,b,m,q){var z=[],n=[];z[0]=a[0]-b[0];z[1]=a[1]-b[1];z[2]=a[2]-b[2];n[0]=z[2]*Math.sin(m)+z[0]*Math.cos(m);n[1]=z[1];n[2]=z[2]*Math.cos(m)-z[0]*Math.sin(m);q[0]=n[0]+b[0];q[1]=n[1]+b[1];q[2]=n[2]+b[2];return q};a.rotateZ=function(a,b,m,q){var z=[],n=[];z[0]=a[0]-b[0];z[1]=a[1]-b[1];z[2]=a[2]-b[2];n[0]=z[0]*Math.cos(m)-z[1]*Math.sin(m);n[1]=z[0]*Math.sin(m)+z[1]*Math.cos(m);n[2]=z[2];q[0]=n[0]+b[0];q[1]=n[1]+b[1];q[2]=n[2]+b[2];return q};a.forEach=function(){var d=a.create();return function(a,
m,q,z,n,x){m||(m=3);q||(q=0);for(z=z?Math.min(z*m+q,a.length):a.length;q<z;q+=m)d[0]=a[q],d[1]=a[q+1],d[2]=a[q+2],n(d,x,d),a[q]=d[0],a[q+1]=d[1],a[q+2]=d[2];return a}}();a.e1=function(d,b){var m=a.fromValues(d[0],d[1],d[2]),q=a.fromValues(b[0],b[1],b[2]);a.normalize(m,m);a.normalize(q,q);m=a.dot(m,q);return 1<m?0:Math.acos(m)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array,m=Math.random;a.create=function(){var a=new r(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new r(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,m,q){var z=new r(4);z[0]=a;z[1]=b;z[2]=m;z[3]=q;return z};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,m,q,z){z[0]=a;z[1]=b;z[2]=m;z[3]=q;return z};a.add=function(a,b,m){m[0]=
a[0]+b[0];m[1]=a[1]+b[1];m[2]=a[2]+b[2];m[3]=a[3]+b[3];return m};a.subtract=function(a,b,m){m[0]=a[0]-b[0];m[1]=a[1]-b[1];m[2]=a[2]-b[2];m[3]=a[3]-b[3];return m};a.sub=a.subtract;a.multiply=function(a,b,m){m[0]=a[0]*b[0];m[1]=a[1]*b[1];m[2]=a[2]*b[2];m[3]=a[3]*b[3];return m};a.mul=a.multiply;a.divide=function(a,b,m){m[0]=a[0]/b[0];m[1]=a[1]/b[1];m[2]=a[2]/b[2];m[3]=a[3]/b[3];return m};a.div=a.divide;a.min=function(a,b,m){m[0]=Math.min(a[0],b[0]);m[1]=Math.min(a[1],b[1]);m[2]=Math.min(a[2],b[2]);m[3]=
Math.min(a[3],b[3]);return m};a.max=function(a,b,m){m[0]=Math.max(a[0],b[0]);m[1]=Math.max(a[1],b[1]);m[2]=Math.max(a[2],b[2]);m[3]=Math.max(a[3],b[3]);return m};a.scale=function(a,b,m){m[0]=a[0]*b;m[1]=a[1]*b;m[2]=a[2]*b;m[3]=a[3]*b;return m};a.scaleAndAdd=function(a,b,m,q){q[0]=a[0]+b[0]*m;q[1]=a[1]+b[1]*m;q[2]=a[2]+b[2]*m;q[3]=a[3]+b[3]*m;return q};a.distance=function(a,b){var m=b[0]-a[0],q=b[1]-a[1],z=b[2]-a[2],n=b[3]-a[3];return Math.sqrt(m*m+q*q+z*z+n*n)};a.dist=a.distance;a.squaredDistance=
function(a,b){var m=b[0]-a[0],q=b[1]-a[1],z=b[2]-a[2],n=b[3]-a[3];return m*m+q*q+z*z+n*n};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],m=a[1],q=a[2];a=a[3];return Math.sqrt(b*b+m*m+q*q+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],m=a[1],q=a[2];a=a[3];return b*b+m*m+q*q+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var m=a[0],q=a[1],z=a[2],n=a[3],x=m*m+q*q+z*z+n*n;0<x&&(x=1/Math.sqrt(x),b[0]=m*x,b[1]=q*x,b[2]=z*x,b[3]=n*x);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,m,q){var z=a[0],n=a[1],x=a[2];a=a[3];q[0]=z+m*(b[0]-z);q[1]=n+m*(b[1]-n);q[2]=x+m*(b[2]-x);q[3]=a+m*(b[3]-a);return q};a.random=function(d,b){d=d||1;b[0]=m();b[1]=m();b[2]=m();b[3]=m();a.normalize(b,b);a.scale(b,d,b);return b};a.transformMat4=function(a,b,m){var q=a[0],z=a[1],n=
a[2];a=a[3];m[0]=b[0]*q+b[4]*z+b[8]*n+b[12]*a;m[1]=b[1]*q+b[5]*z+b[9]*n+b[13]*a;m[2]=b[2]*q+b[6]*z+b[10]*n+b[14]*a;m[3]=b[3]*q+b[7]*z+b[11]*n+b[15]*a;return m};a.transformQuat=function(a,b,m){var q=a[0],z=a[1],n=a[2],x=b[0],h=b[1],k=b[2];b=b[3];var f=b*q+h*n-k*z,y=b*z+k*q-x*n,g=b*n+x*z-h*q,q=-x*q-h*z-k*n;m[0]=f*b+q*-x+y*-k-g*-h;m[1]=y*b+q*-h+g*-x-f*-k;m[2]=g*b+q*-k+f*-h-y*-x;m[3]=a[3];return m};a.forEach=function(){var d=a.create();return function(a,m,q,z,n,x){m||(m=4);q||(q=0);for(z=z?Math.min(z*
m+q,a.length):a.length;q<z;q+=m)d[0]=a[q],d[1]=a[q+1],d[2]=a[q+2],d[3]=a[q+3],n(d,x,d),a[q]=d[0],a[q+1]=d[1],a[q+2]=d[2],a[q+3]=d[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,r){var m=r("__vec3"),d=r("__vec4"),b=r("__mat3"),t="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new t(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=m.create(),d=m.fromValues(1,0,0),n=m.fromValues(0,1,0);return function(x,h,k){var f=m.dot(x,h);if(-.9999999>f)return m.cross(d,x,b),1E-6>m.length(b)&&m.cross(n,x,b),m.normalize(b,b),a.setAxisAngle(b,Math.PI,k),k;if(.9999999<f)return k[0]=0,k[1]=0,k[2]=0,k[3]=1,k;m.cross(x,
h,b);k[0]=b[0];k[1]=b[1];k[2]=b[2];k[3]=1+f;return a.normalize(k,k)}}();a.setAxes=function(){var d=b.create();return function(b,m,x,h){d[0]=m[0];d[3]=m[1];d[6]=m[2];d[1]=x[0];d[4]=x[1];d[7]=x[2];d[2]=-b[0];d[5]=-b[1];d[8]=-b[2];return a.normalize(a.fromMat3(d,h),h)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,d){b*=.5;var m=Math.sin(b);d[0]=m*a[0];d[1]=m*a[1];d[2]=m*a[2];d[3]=Math.cos(b);
return d};a.add=d.add;a.multiply=function(a,b,d){var m=a[0],h=a[1],k=a[2];a=a[3];var f=b[0],y=b[1],g=b[2];b=b[3];d[0]=m*b+a*f+h*g-k*y;d[1]=h*b+a*y+k*f-m*g;d[2]=k*b+a*g+m*y-h*f;d[3]=a*b-m*f-h*y-k*g;return d};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,d){b*=.5;var m=a[0],h=a[1],k=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);d[0]=m*b+a*f;d[1]=h*b+k*f;d[2]=k*b-h*f;d[3]=a*b-m*f;return d};a.rotateY=function(a,b,d){b*=.5;var m=a[0],h=a[1],k=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);d[0]=m*
b-k*f;d[1]=h*b+a*f;d[2]=k*b+m*f;d[3]=a*b-h*f;return d};a.rotateZ=function(a,b,d){b*=.5;var m=a[0],h=a[1],k=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);d[0]=m*b+h*f;d[1]=h*b-m*f;d[2]=k*b+a*f;d[3]=a*b-k*f;return d};a.calculateW=function(a,b){var d=a[0],m=a[1],h=a[2];b[0]=d;b[1]=m;b[2]=h;b[3]=Math.sqrt(Math.abs(1-d*d-m*m-h*h));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,d,m){var h=a[0],k=a[1],f=a[2];a=a[3];var y=b[0],g=b[1],A=b[2];b=b[3];var t,H,O;H=h*y+k*g+f*A+a*b;0>H&&(H=-H,y=-y,g=-g,
A=-A,b=-b);1E-6<1-H?(t=Math.acos(H),O=Math.sin(t),H=Math.sin((1-d)*t)/O,d=Math.sin(d*t)/O):H=1-d;m[0]=H*h+d*y;m[1]=H*k+d*g;m[2]=H*f+d*A;m[3]=H*a+d*b;return m};a.a8=function(){var b=a.create(),d=a.create();return function(m,x,h,k,f,y){a.slerp(m,k,f,b);a.slerp(x,h,f,d);a.slerp(b,d,2*f*(1-f),y);return y}}();a.invert=function(a,b){var d=a[0],m=a[1],h=a[2],k=a[3],f=d*d+m*m+h*h+k*k,f=f?1/f:0;b[0]=-d*f;b[1]=-m*f;b[2]=-h*f;b[3]=k*f;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,b){var d=a[0]+a[4]+a[8];if(0<d)d=Math.sqrt(d+1),b[3]=.5*d,d=.5/d,b[0]=(a[5]-a[7])*d,b[1]=(a[6]-a[2])*d,b[2]=(a[1]-a[3])*d;else{var m=0;a[4]>a[0]&&(m=1);a[8]>a[3*m+m]&&(m=2);var h=(m+1)%3,k=(m+2)%3,d=Math.sqrt(a[3*m+m]-a[3*h+h]-a[3*k+k]+1);b[m]=.5*d;d=.5/d;b[3]=(a[3*h+k]-a[3*k+h])*d;b[h]=(a[3*h+m]+a[3*m+h])*d;b[k]=(a[3*k+m]+a[3*m+k])*d}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new r(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new r(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],t=a[2],q=a[5];d[1]=a[3];d[2]=a[6];d[3]=b;d[5]=a[7];d[6]=t;d[7]=q}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=a[4],x=a[5],h=a[6],k=a[7],f=a[8],y=f*n-x*k,g=-f*z+x*h,A=
k*z-n*h,N=b*y+t*g+q*A;if(!N)return null;N=1/N;d[0]=y*N;d[1]=(-f*t+q*k)*N;d[2]=(x*t-q*n)*N;d[3]=g*N;d[4]=(f*b-q*h)*N;d[5]=(-x*b+q*z)*N;d[6]=A*N;d[7]=(-k*b+t*h)*N;d[8]=(n*b-t*z)*N;return d};a.adjoint=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=a[4],x=a[5],h=a[6],k=a[7],f=a[8];d[0]=n*f-x*k;d[1]=q*k-t*f;d[2]=t*x-q*n;d[3]=x*h-z*f;d[4]=b*f-q*h;d[5]=q*z-b*x;d[6]=z*k-n*h;d[7]=t*h-b*k;d[8]=b*n-t*z;return d};a.determinant=function(a){var d=a[3],b=a[4],t=a[5],q=a[6],z=a[7],n=a[8];return a[0]*(n*b-t*z)+a[1]*
(-n*d+t*q)+a[2]*(z*d-b*q)};a.multiply=function(a,d,b){var t=a[0],q=a[1],z=a[2],n=a[3],x=a[4],h=a[5],k=a[6],f=a[7];a=a[8];var y=d[0],g=d[1],A=d[2],N=d[3],H=d[4],O=d[5],D=d[6],P=d[7];d=d[8];b[0]=y*t+g*n+A*k;b[1]=y*q+g*x+A*f;b[2]=y*z+g*h+A*a;b[3]=N*t+H*n+O*k;b[4]=N*q+H*x+O*f;b[5]=N*z+H*h+O*a;b[6]=D*t+P*n+d*k;b[7]=D*q+P*x+d*f;b[8]=D*z+P*h+d*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var t=a[0],q=a[1],z=a[2],n=a[3],x=a[4],h=a[5],k=a[6],f=a[7];a=a[8];var y=d[0];d=d[1];b[0]=t;b[1]=q;b[2]=z;
b[3]=n;b[4]=x;b[5]=h;b[6]=y*t+d*n+k;b[7]=y*q+d*x+f;b[8]=y*z+d*h+a;return b};a.rotate=function(a,d,b){var t=a[0],q=a[1],z=a[2],n=a[3],x=a[4],h=a[5],k=a[6],f=a[7];a=a[8];var y=Math.sin(d);d=Math.cos(d);b[0]=d*t+y*n;b[1]=d*q+y*x;b[2]=d*z+y*h;b[3]=d*n-y*t;b[4]=d*x-y*q;b[5]=d*h-y*z;b[6]=k;b[7]=f;b[8]=a;return b};a.scale=function(a,d,b){var t=d[0];d=d[1];b[0]=t*a[0];b[1]=t*a[1];b[2]=t*a[2];b[3]=d*a[3];b[4]=d*a[4];b[5]=d*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.ZT=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.XT=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=t;d[1]=b;d[2]=0;d[3]=-b;d[4]=t;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.YT=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=b+b,x=t+t,h=q+q,b=b*n,k=t*n,t=t*x,f=q*n,y=
q*x,q=q*h,n=z*n,x=z*x,z=z*h;d[0]=1-t-q;d[3]=k-z;d[6]=f+x;d[1]=k+z;d[4]=1-b-q;d[7]=y-n;d[2]=f-x;d[5]=y+n;d[8]=1-b-t;return d};a.normalFromMat4=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=a[4],x=a[5],h=a[6],k=a[7],f=a[8],y=a[9],g=a[10],A=a[11],N=a[12],H=a[13],O=a[14],D=a[15],P=b*x-t*n,K=b*h-q*n,M=b*k-z*n,F=t*h-q*x,c=t*k-z*x,l=q*k-z*h,C=f*H-y*N,v=f*O-g*N,f=f*D-A*N,e=y*O-g*H,y=y*D-A*H,g=g*D-A*O,A=P*g-K*y+M*e+F*f-c*v+l*C;if(!A)return null;A=1/A;d[0]=(x*g-h*y+k*e)*A;d[1]=(h*f-n*g-k*v)*A;d[2]=(n*y-x*
f+k*C)*A;d[3]=(q*y-t*g-z*e)*A;d[4]=(b*g-q*f+z*v)*A;d[5]=(t*f-b*y-z*C)*A;d[6]=(H*l-O*c+D*F)*A;d[7]=(O*M-N*l-D*K)*A;d[8]=(N*c-H*M+D*P)*A;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.WT=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var r="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new r(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new r(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];
d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],t=a[2],q=a[3],z=a[6],n=a[7],x=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=b;d[6]=a[9];d[7]=a[13];d[8]=t;d[9]=z;d[11]=a[14];d[12]=q;d[13]=
n;d[14]=x}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=a[4],x=a[5],h=a[6],k=a[7],f=a[8],y=a[9],g=a[10],A=a[11],N=a[12],H=a[13],O=a[14],D=a[15],P=b*x-t*n,K=b*h-q*n,M=b*k-z*n,F=t*h-q*x,c=t*k-z*x,l=q*k-z*h,C=f*H-y*N,v=f*O-g*N,e=f*D-A*N,R=y*O-g*H,p=y*D-A*H,ba=g*D-A*O,J=P*ba-K*p+M*R+F*e-c*v+l*C;if(!J)return null;
J=1/J;d[0]=(x*ba-h*p+k*R)*J;d[1]=(q*p-t*ba-z*R)*J;d[2]=(H*l-O*c+D*F)*J;d[3]=(g*c-y*l-A*F)*J;d[4]=(h*e-n*ba-k*v)*J;d[5]=(b*ba-q*e+z*v)*J;d[6]=(O*M-N*l-D*K)*J;d[7]=(f*l-g*M+A*K)*J;d[8]=(n*p-x*e+k*C)*J;d[9]=(t*e-b*p-z*C)*J;d[10]=(N*c-H*M+D*P)*J;d[11]=(y*M-f*c-A*P)*J;d[12]=(x*v-n*R-h*C)*J;d[13]=(b*R-t*v+q*C)*J;d[14]=(H*K-N*F-O*P)*J;d[15]=(f*F-y*K+g*P)*J;return d};a.adjoint=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=a[4],x=a[5],h=a[6],k=a[7],f=a[8],y=a[9],g=a[10],A=a[11],N=a[12],H=a[13],O=a[14],D=
a[15];d[0]=x*(g*D-A*O)-y*(h*D-k*O)+H*(h*A-k*g);d[1]=-(t*(g*D-A*O)-y*(q*D-z*O)+H*(q*A-z*g));d[2]=t*(h*D-k*O)-x*(q*D-z*O)+H*(q*k-z*h);d[3]=-(t*(h*A-k*g)-x*(q*A-z*g)+y*(q*k-z*h));d[4]=-(n*(g*D-A*O)-f*(h*D-k*O)+N*(h*A-k*g));d[5]=b*(g*D-A*O)-f*(q*D-z*O)+N*(q*A-z*g);d[6]=-(b*(h*D-k*O)-n*(q*D-z*O)+N*(q*k-z*h));d[7]=b*(h*A-k*g)-n*(q*A-z*g)+f*(q*k-z*h);d[8]=n*(y*D-A*H)-f*(x*D-k*H)+N*(x*A-k*y);d[9]=-(b*(y*D-A*H)-f*(t*D-z*H)+N*(t*A-z*y));d[10]=b*(x*D-k*H)-n*(t*D-z*H)+N*(t*k-z*x);d[11]=-(b*(x*A-k*y)-n*(t*A-z*
y)+f*(t*k-z*x));d[12]=-(n*(y*O-g*H)-f*(x*O-h*H)+N*(x*g-h*y));d[13]=b*(y*O-g*H)-f*(t*O-q*H)+N*(t*g-q*y);d[14]=-(b*(x*O-h*H)-n*(t*O-q*H)+N*(t*h-q*x));d[15]=b*(x*g-h*y)-n*(t*g-q*y)+f*(t*h-q*x);return d};a.determinant=function(a){var d=a[0],b=a[1],t=a[2],q=a[3],z=a[4],n=a[5],x=a[6],h=a[7],k=a[8],f=a[9],y=a[10],g=a[11],A=a[12],N=a[13],H=a[14];a=a[15];return(d*n-b*z)*(y*a-g*H)-(d*x-t*z)*(f*a-g*N)+(d*h-q*z)*(f*H-y*N)+(b*x-t*n)*(k*a-g*A)-(b*h-q*n)*(k*H-y*A)+(t*h-q*x)*(k*N-f*A)};a.multiply=function(a,d,b){var t=
a[0],q=a[1],z=a[2],n=a[3],x=a[4],h=a[5],k=a[6],f=a[7],y=a[8],g=a[9],A=a[10],N=a[11],H=a[12],O=a[13],D=a[14];a=a[15];var P=d[0],K=d[1],M=d[2],F=d[3];b[0]=P*t+K*x+M*y+F*H;b[1]=P*q+K*h+M*g+F*O;b[2]=P*z+K*k+M*A+F*D;b[3]=P*n+K*f+M*N+F*a;P=d[4];K=d[5];M=d[6];F=d[7];b[4]=P*t+K*x+M*y+F*H;b[5]=P*q+K*h+M*g+F*O;b[6]=P*z+K*k+M*A+F*D;b[7]=P*n+K*f+M*N+F*a;P=d[8];K=d[9];M=d[10];F=d[11];b[8]=P*t+K*x+M*y+F*H;b[9]=P*q+K*h+M*g+F*O;b[10]=P*z+K*k+M*A+F*D;b[11]=P*n+K*f+M*N+F*a;P=d[12];K=d[13];M=d[14];F=d[15];b[12]=P*t+
K*x+M*y+F*H;b[13]=P*q+K*h+M*g+F*O;b[14]=P*z+K*k+M*A+F*D;b[15]=P*n+K*f+M*N+F*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var t=d[0],q=d[1];d=d[2];var z,n,x,h,k,f,y,g,A,N,H,O;a===b?(b[12]=a[0]*t+a[4]*q+a[8]*d+a[12],b[13]=a[1]*t+a[5]*q+a[9]*d+a[13],b[14]=a[2]*t+a[6]*q+a[10]*d+a[14],b[15]=a[3]*t+a[7]*q+a[11]*d+a[15]):(z=a[0],n=a[1],x=a[2],h=a[3],k=a[4],f=a[5],y=a[6],g=a[7],A=a[8],N=a[9],H=a[10],O=a[11],b[0]=z,b[1]=n,b[2]=x,b[3]=h,b[4]=k,b[5]=f,b[6]=y,b[7]=g,b[8]=A,b[9]=N,b[10]=H,b[11]=O,
b[12]=z*t+k*q+A*d+a[12],b[13]=n*t+f*q+N*d+a[13],b[14]=x*t+y*q+H*d+a[14],b[15]=h*t+g*q+O*d+a[15]);return b};a.scale=function(a,d,b){var t=d[0],q=d[1];d=d[2];b[0]=a[0]*t;b[1]=a[1]*t;b[2]=a[2]*t;b[3]=a[3]*t;b[4]=a[4]*q;b[5]=a[5]*q;b[6]=a[6]*q;b[7]=a[7]*q;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*d;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,d,b,t){var q=b[0],z=b[1];b=b[2];var n=Math.sqrt(q*q+z*z+b*b),x,h,k,f,y,g,A,N,H,O,D,P,K,M,F,c,l,C,v,e;if(1E-7>Math.abs(n))return null;
n=1/n;q*=n;z*=n;b*=n;x=Math.sin(d);h=Math.cos(d);k=1-h;d=a[0];n=a[1];f=a[2];y=a[3];g=a[4];A=a[5];N=a[6];H=a[7];O=a[8];D=a[9];P=a[10];K=a[11];M=q*q*k+h;F=z*q*k+b*x;c=b*q*k-z*x;l=q*z*k-b*x;C=z*z*k+h;v=b*z*k+q*x;e=q*b*k+z*x;q=z*b*k-q*x;z=b*b*k+h;t[0]=d*M+g*F+O*c;t[1]=n*M+A*F+D*c;t[2]=f*M+N*F+P*c;t[3]=y*M+H*F+K*c;t[4]=d*l+g*C+O*v;t[5]=n*l+A*C+D*v;t[6]=f*l+N*C+P*v;t[7]=y*l+H*C+K*v;t[8]=d*e+g*q+O*z;t[9]=n*e+A*q+D*z;t[10]=f*e+N*q+P*z;t[11]=y*e+H*q+K*z;a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);
return t};a.rotateX=function(a,d,b){var t=Math.sin(d);d=Math.cos(d);var q=a[4],z=a[5],n=a[6],x=a[7],h=a[8],k=a[9],f=a[10],y=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=q*d+h*t;b[5]=z*d+k*t;b[6]=n*d+f*t;b[7]=x*d+y*t;b[8]=h*d-q*t;b[9]=k*d-z*t;b[10]=f*d-n*t;b[11]=y*d-x*t;return b};a.rotateY=function(a,d,b){var t=Math.sin(d);d=Math.cos(d);var q=a[0],z=a[1],n=a[2],x=a[3],h=a[8],k=a[9],f=a[10],y=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=q*d-h*t;b[1]=z*d-k*t;b[2]=n*d-f*t;b[3]=x*d-y*t;b[8]=q*t+h*d;b[9]=z*t+k*d;b[10]=n*t+f*d;b[11]=x*t+y*d;return b};a.rotateZ=function(a,d,b){var t=Math.sin(d);d=Math.cos(d);var q=a[0],z=a[1],n=a[2],x=a[3],h=a[4],k=a[5],f=a[6],y=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=q*d+h*t;b[1]=z*d+k*t;b[2]=n*d+f*t;b[3]=x*d+y*t;b[4]=h*d-q*t;b[5]=k*d-z*t;b[6]=f*d-n*t;b[7]=y*d-x*t;return b};
a.ZT=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.YT=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.XT=function(a,d,b){var t=d[0],q=d[1];d=d[2];var z=Math.sqrt(t*t+q*q+d*d),n;if(1E-7>Math.abs(z))return null;z=1/z;t*=z;q*=z;d*=z;z=Math.sin(a);a=Math.cos(a);n=1-a;b[0]=t*t*n+a;b[1]=q*t*n+d*
z;b[2]=d*t*n-q*z;b[3]=0;b[4]=t*q*n-d*z;b[5]=q*q*n+a;b[6]=d*q*n+t*z;b[7]=0;b[8]=t*d*n+q*z;b[9]=q*d*n-t*z;b[10]=d*d*n+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.n3=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=t;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=t;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.o3=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=t;d[1]=0;d[2]=-b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=b;d[9]=0;d[10]=t;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.p3=function(a,d){var b=Math.sin(a),t=Math.cos(a);d[0]=t;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=t;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,b){var t=a[0],q=a[1],z=a[2],n=a[3],x=t+t,h=q+q,k=z+z;a=t*x;var f=t*h,t=t*k,y=q*h,q=q*k,z=z*k,x=n*x,h=n*h,n=n*k;b[0]=1-(y+z);b[1]=f+n;b[2]=t-h;b[3]=0;b[4]=f-n;b[5]=1-(a+z);b[6]=q+x;b[7]=0;b[8]=t+h;b[9]=q-x;b[10]=1-(a+y);b[11]=0;b[12]=d[0];b[13]=d[1];b[14]=d[2];
b[15]=1;return b};a.l3=function(a,d,b,t){var q=a[0],z=a[1],n=a[2],x=a[3],h=q+q,k=z+z,f=n+n;a=q*h;var y=q*k,q=q*f,g=z*k,z=z*f,n=n*f,h=x*h,k=x*k,x=x*f,f=b[0],A=b[1];b=b[2];t[0]=(1-(g+n))*f;t[1]=(y+x)*f;t[2]=(q-k)*f;t[3]=0;t[4]=(y-x)*A;t[5]=(1-(a+n))*A;t[6]=(z+h)*A;t[7]=0;t[8]=(q+k)*b;t[9]=(z-h)*b;t[10]=(1-(a+g))*b;t[11]=0;t[12]=d[0];t[13]=d[1];t[14]=d[2];t[15]=1;return t};a.m3=function(a,d,b,t,q){var z=a[0],n=a[1],x=a[2],h=a[3],k=z+z,f=n+n,y=x+x;a=z*k;var g=z*f,z=z*y,A=n*f,n=n*y,x=x*y,k=h*k,f=h*f,h=
h*y,y=b[0],N=b[1];b=b[2];var H=t[0],O=t[1];t=t[2];q[0]=(1-(A+x))*y;q[1]=(g+h)*y;q[2]=(z-f)*y;q[3]=0;q[4]=(g-h)*N;q[5]=(1-(a+x))*N;q[6]=(n+k)*N;q[7]=0;q[8]=(z+f)*b;q[9]=(n-k)*b;q[10]=(1-(a+A))*b;q[11]=0;q[12]=d[0]+H-(q[0]*H+q[4]*O+q[8]*t);q[13]=d[1]+O-(q[1]*H+q[5]*O+q[9]*t);q[14]=d[2]+t-(q[2]*H+q[6]*O+q[10]*t);q[15]=1;return q};a.fromQuat=function(a,d){var b=a[0],t=a[1],q=a[2],z=a[3],n=b+b,x=t+t,h=q+q,b=b*n,k=t*n,t=t*x,f=q*n,y=q*x,q=q*h,n=z*n,x=z*x,z=z*h;d[0]=1-t-q;d[1]=k+z;d[2]=f-x;d[3]=0;d[4]=k-
z;d[5]=1-b-q;d[6]=y+n;d[7]=0;d[8]=f+x;d[9]=y-n;d[10]=1-b-t;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,b,t,q,z,n){var x=1/(d-a),h=1/(t-b),k=1/(q-z);n[0]=2*q*x;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=2*q*h;n[6]=0;n[7]=0;n[8]=(d+a)*x;n[9]=(t+b)*h;n[10]=(z+q)*k;n[11]=-1;n[12]=0;n[13]=0;n[14]=z*q*2*k;n[15]=0;return n};a.perspective=function(a,d,b,t,q){a=1/Math.tan(a/2);var z=1/(b-t);q[0]=a/d;q[1]=0;q[2]=0;q[3]=0;q[4]=0;q[5]=a;q[6]=0;q[7]=0;q[8]=0;q[9]=0;q[10]=(t+b)*z;q[11]=-1;q[12]=
0;q[13]=0;q[14]=2*t*b*z;q[15]=0;return q};a.u6=function(a,d,b,t){var q=Math.tan(a.upDegrees*Math.PI/180),z=Math.tan(a.downDegrees*Math.PI/180),n=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var x=2/(n+a),h=2/(q+z);t[0]=x;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=h;t[6]=0;t[7]=0;t[8]=-((n-a)*x*.5);t[9]=(q-z)*h*.5;t[10]=b/(d-b);t[11]=-1;t[12]=0;t[13]=0;t[14]=b*d/(d-b);t[15]=0;return t};a.ortho=function(a,d,b,t,q,z,n){var x=1/(a-d),h=1/(b-t),k=1/(q-z);n[0]=-2*x;n[1]=0;n[2]=0;n[3]=
0;n[4]=0;n[5]=-2*h;n[6]=0;n[7]=0;n[8]=0;n[9]=0;n[10]=2*k;n[11]=0;n[12]=(a+d)*x;n[13]=(t+b)*h;n[14]=(z+q)*k;n[15]=1;return n};a.lookAt=function(m,d,b,t){var q,z,n,x,h,k,f,y,g=m[0],A=m[1];m=m[2];n=b[0];x=b[1];z=b[2];f=d[0];b=d[1];q=d[2];if(1E-7>Math.abs(g-f)&&1E-7>Math.abs(A-b)&&1E-7>Math.abs(m-q))return a.identity(t);d=g-f;b=A-b;f=m-q;y=1/Math.sqrt(d*d+b*b+f*f);d*=y;b*=y;f*=y;q=x*f-z*b;z=z*d-n*f;n=n*b-x*d;(y=Math.sqrt(q*q+z*z+n*n))?(y=1/y,q*=y,z*=y,n*=y):n=z=q=0;x=b*n-f*z;h=f*q-d*n;k=d*z-b*q;(y=Math.sqrt(x*
x+h*h+k*k))?(y=1/y,x*=y,h*=y,k*=y):k=h=x=0;t[0]=q;t[1]=x;t[2]=d;t[3]=0;t[4]=z;t[5]=h;t[6]=b;t[7]=0;t[8]=n;t[9]=k;t[10]=f;t[11]=0;t[12]=-(q*g+z*A+n*m);t[13]=-(x*g+h*A+k*m);t[14]=-(d*g+b*A+f*m);t[15]=1;return t};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.WT=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__math=function(a,r){function m(a,b){for(var d=a[1],f=1,k=2;k<a.length;k++)4!=k&&8!=k&&Math.abs(a[k])>Math.abs(d)&&(d=a[k],f=k);for(var h=Math.floor(f/3),f=f%3,d=.5*Math.atan(2*d/(a[3*h+h]-a[3*f+f])),k=0;k<b.length;k++)b[k]=0==k||4==k||8==k?1:0;b[f+3*h]=-Math.sin(d);b[h+3*f]=Math.sin(d);b[h+3*h]=Math.cos(d);b[f+3*f]=Math.cos(d);return b}function d(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var d=a.content[b];0<b;){var f=(b+1>>1)-1,k=a.content[f];if(a.wm(d)<a.wm(k))a.content[f]=
d,a.content[b]=k,b=f;else break}}function t(a,b){for(var d=a.content.length,f=a.content[b],k=a.wm(f);;){var h=b+1<<1,n=h-1,q=null;if(n<d){var m=a.wm(a.content[n]);m<k&&(q=n)}h<d&&a.wm(a.content[h])<(null===q?k:m)&&(q=h);if(null!==q)a.content[b]=a.content[q],a.content[q]=f,b=q;else break}}var q=r("__mat3"),z=r("__vec3"),n=new Float32Array(3),x=new Float32Array(9),h=new Float32Array(9),k=new Float32Array(9),f=new Float32Array(9);a.y4=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.z4=function(a,b){b=b||new Float32Array(3);return z.copy(a,b)};a.oL=function(a,b){z.copy(b,a)};a.OC=function(a,b){z.normalize(b,n);a[3]=n[0];a[4]=n[1];a[5]=n[2]};a.J1=function(a,b,d){d=d||new Float32Array(3);d[0]=a[0]+a[3]*b;d[1]=a[1]+a[4]*b;d[2]=a[2]+a[5]*b};a.aR=function(a,b){b[0]=0;b[1]=0;for(var d=b[2]=0;d<a.length;d+=3)b[0]+=a[d],b[1]+=a[d+1],b[2]+=a[d+2];return z.scale(b,3/a.length,b)};a.UQ=function(a,b,d){for(var f=0;f<d.length;f++)d[f]=0;for(f=0;f<a.length;f+=3){var k=a[f]-b[0],
h=a[f+1]-b[1],n=a[f+2]-b[2];d[0]+=k*k;d[1]+=k*h;d[2]+=k*n;d[4]+=h*h;d[5]+=h*n;d[8]+=n*n}d[3]=d[1];d[6]=d[2];d[7]=d[5];for(f=0;f<d.length;f++)d[f]*=3/a.length;return d};a.MT=function(a,b){var n=q.copy(a,x);if(5E-4>d(n))return q.identity(b);var t=m(n,h),H=q.transpose(t,k);q.multiply(n,H,f);q.multiply(t,f,n);for(var O=q.copy(t,b),D=1;5E-4<=d(n)&&100>D;)t=m(n,h),H=q.transpose(t,k),q.multiply(n,H,f),q.multiply(t,f,n),q.multiply(t,O,O),D++;return O};a.ng=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.FQ=function(a){return{content:[],wm:a}};a.LF=function(a,d){a.content.push(d);b(a,a.content.length-1)};a.GQ=function(a){var b=a.content[0],d=a.content.pop();0<a.content.length&&(a.content[0]=d,t(a,0));return b};a.I1=function(a,d){var f=a.content.indexOf(d),k=a.content.pop();f!==a.content.length-1&&(a.content[f]=k,a.wm(k)<a.wm(d)?b(f):t(f))};a.HQ=function(a,d){b(a,a.content.indexOf(d))}};b4w.module.__print=function(a){function r(a,b){var d=[];-1<a[0].indexOf("%c")?d.push(a[0].replace("%c","%c"+b+": ")):d.push(b+": "+a[0]);for(var f=1;f<a.length;f++)d.push(a[f]);return d}function m(){q++;var a=r(arguments,"B4W ERROR");console.error.apply(console,a)}function d(a){a in n||(n[a]=a,m([a]))}function b(a,b){d(a+"() is deprecated, use "+b+"() instead.")}var t=!1,q=0,z=0,n={};a.fY=function(a){t=a};a.Zd=function(){console.log.apply(console,arguments)};a.log=function(){if(t){var a=r(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=m;a.N=d;a.Rb=b;a.Hh=function(a,h){switch(1<h.length){case !0:d(a+"() is deprecated, use "+h.slice(0,-1).join("(), ")+"() or "+h[h.length-1]+"() instead.");break;case !1:b(a,h[0])}};a.wT=function(){d('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){z++;var a=r(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=r(arguments,"B4W INFO");console.info.apply(console,a)};a.zT=function(){q++;
var a=r(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.AT=function(){z++;var a=r(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){t&&console.time.apply(console,arguments)};a.timeEnd=function(){t&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.UU=function(){return z};a.xU=function(){return q};a.sG=function(){q=z=0}};b4w.module.print=b4w.module.__print;b4w.module.__tsr=function(a,r){function m(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function d(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function t(a,b,d,g){g[0]=a[0];g[1]=a[1];g[2]=a[2];g[3]=b;g[4]=d[0];g[5]=d[1];g[6]=d[2];g[7]=d[3];return g}function q(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function z(a,b,d){var g=b[0],f=b[1],k=b[2],h=b[3],c=b[4],l=b[5],y=b[6];
b=b[7];var v=a[0]*h,e=a[1]*h,R=a[2]*h;a=b*v+l*R-y*e;var h=b*e+y*v-c*R,p=b*R+c*e-l*v,v=-c*v-l*e-y*R;d[0]=a*b+v*-c+h*-y-p*-l;d[1]=h*b+v*-l+p*-c-a*-y;d[2]=p*b+v*-y+a*-l-h*-c;d[0]+=g;d[1]+=f;d[2]+=k;return d}var n=r("__mat4"),x=r("__quat"),h=r("__util"),k=r("__vec3"),f=Math.sin(-Math.PI/4),y=-f,g=new Float32Array(3),A=new Float32Array(4);new Float32Array(4);var N=new Float32Array(16);a.create=m;a.clone=function(a){var d=m();b(a,d);return d};a.q3=function(a,b,d,g,f,k,h,c){var l=m();l[0]=a;l[1]=b;l[2]=
d;l[3]=g;l[4]=f;l[5]=k;l[6]=h;l[7]=c;return l};a.xl=d;a.n2=function(a){var g=d();b(a,g);return g};a.r3=function(a,b,g,f,k,h,y,c){var l=d();l[0]=a;l[1]=b;l[2]=g;l[3]=f;l[4]=k;l[5]=h;l[6]=y;l[7]=c;return l};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.$h=t;a.ff=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Hf=function(a,b){b[3]=a;return b};a.cY=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.zk=function(a,b){b[4]=a[0];b[5]=a[1];
b[6]=a[2];b[7]=a[3];return b};a.F=function(a){return a.subarray(0,3)};a.fc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Xd=function(a){return a[3]};a.TU=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.R=function(a){return a.subarray(4,8)};a.Wd=q;a.invert=function(a,b){var d=1/a[3];if(!d)return null;var g=a[0],f=a[1],k=a[2];A[0]=a[4];A[1]=a[5];A[2]=a[6];A[3]=a[7];x.invert(A,A);var h=A[0],c=A[1],l=A[2],y=A[3],g=g*d,f=f*d,v=k*d,k=y*g+c*v-l*f,e=y*f+l*g-h*v,R=y*v+h*f-c*g,g=-h*g-c*f-
l*v;b[0]=-(k*y+g*-h+e*-l-R*-c);b[1]=-(e*y+g*-c+R*-h-k*-l);b[2]=-(R*y+g*-l+k*-c-e*-h);b[3]=d;b[4]=h;b[5]=c;b[6]=l;b[7]=y;return b};a.xM=function(a,b){var d=a[3];n.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var g=0;12>g;g++)b[g]*=d};a.Ji=function(a,b){var d=h.IJ(a,g),f=h.HJ(a),k=h.xB(a,A);t(d,f,k,b)};a.multiply=function(a,b,d){z(b,a,d);d[3]=a[3]*b[3];var g=a[4],f=a[5],k=a[6];a=a[7];var h=b[4],c=b[5],l=b[6];b=b[7];d[4]=g*b+a*h+f*l-k*c;d[5]=f*b+a*c+k*h-g*l;d[6]=k*b+a*l+g*c-f*h;d[7]=
a*b-g*h-f*c-k*l;return d};a.dZ=function(a,b,d){var g=b[3];b=n.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),N);for(var f=0;12>f;f++)b[f]*=g;n.multiply(b,a,d);return d};a.Vc=z;a.x8=function(a,b,d){var g=b[3],f=a[0]-b[0],k=a[1]-b[1],h=a[2]-b[2];a=b[4];var c=b[5],l=b[6];b=b[7];var y=a*a+c*c+l*l+b*b,y=y?1/y:0;a=-a*y;c=-c*y;l=-l*y;b*=y;var y=b*f+c*h-l*k,v=b*k+l*f-a*h,e=b*h+a*k-c*f,f=-a*f-c*k-l*h;d[0]=y*b+f*-a+v*-l-e*-c;d[1]=v*b+f*-c+e*-a-y*-l;d[2]=e*b+f*-l+y*-c-v*-a;d[0]/=g;d[1]/=g;d[2]/=g;return d};
a.No=function(a,b,d,g){g||(g=0);var f=a.length,k=b[0],h=b[1],c=b[2],l=b[3],y=b[4],v=b[5],e=b[6];b=b[7];for(var R=0;R<f;R+=3){var p=a[R]*l,n=a[R+1]*l,J=a[R+2]*l,B=b*p+v*J-e*n,V=b*n+e*p-y*J,U=b*J+y*n-v*p,p=-y*p-v*n-e*J;d[g+R]=B*b+p*-y+V*-e-U*-v;d[g+R+1]=V*b+p*-v+U*-y-B*-e;d[g+R+2]=U*b+p*-e+B*-v-V*-y;d[g+R]+=k;d[g+R+1]+=h;d[g+R+2]+=c}};a.cZ=function(a,b,d){var g=0,g=0,f=a.length,k=b[3],h=b[4],c=b[5],l=b[6];b=b[7];for(var y=0;y<f;y+=3){var v=a[y]*k,e=a[y+1]*k,R=a[y+2]*k,p=b*v+c*R-l*e,n=b*e+l*v-h*R,J=
b*R+h*e-c*v,v=-h*v-c*e-l*R;d[g+y]=p*b+v*-h+n*-l-J*-c;d[g+y+1]=n*b+v*-c+J*-h-p*-l;d[g+y+2]=J*b+v*-l+p*-c-n*-h}};a.wd=function(a,b,d){var g=b[3],f=b[4],k=b[5],h=b[6];b=b[7];var c=a[0]*g,l=a[1]*g,y=a[2]*g;a=b*c+k*y-h*l;var g=b*l+h*c-f*y,v=b*y+f*l-k*c,c=-f*c-k*l-h*y;d[0]=a*b+c*-f+g*-h-v*-k;d[1]=g*b+c*-k+v*-f-a*-h;d[2]=v*b+c*-h+a*-k-g*-f};a.fZ=function(a,b,d,g){g||(g=0);var f=a.length,k=b[3],h=b[4],c=b[5],l=b[6];b=b[7];for(var y=0;y<f;y+=4){var v=a[y]*k,e=a[y+1]*k,R=a[y+2]*k,p=b*v+c*R-l*e,n=b*e+l*v-h*
R,J=b*R+h*e-c*v,v=-h*v-c*e-l*R;d[g+y]=p*b+v*-h+n*-l-J*-c;d[g+y+1]=n*b+v*-c+J*-h-p*-l;d[g+y+2]=J*b+v*-l+p*-c-n*-h;d[g+y+3]=a[y+3]}};a.eZ=function(a,b,d){b=q(b,A);x.multiply(b,a,d)};a.CM=function(a,b,d,g){g=g||0;b=q(b,A);h.zK(a,b,d,g)};a.translate=function(a,b,d){var g=a[3],f=a[4],k=a[5],h=a[6],c=a[7],l=b[0]*g,y=b[1]*g,v=b[2]*g;b=c*l+k*v-h*y;var g=c*y+h*l-f*v,e=c*v+f*y-k*l,l=-f*l-k*y-h*v;d[0]=a[0]+b*c+l*-f+g*-h-e*-k;d[1]=a[1]+g*c+l*-k+e*-f-b*-h;d[2]=a[2]+e*c+l*-h+b*-k-g*-f;d[3]=a[3];d[4]=a[4];d[5]=
a[5];d[6]=a[6];d[7]=a[7];return d};a.eB=function(a,b,d,g){k.lerp(a.subarray(0,3),b.subarray(0,3),d,g.subarray(0,3));var f=a[3];g[3]=f+d*(b[3]-f);x.slerp(a.subarray(4,8),b.subarray(4,8),d,g.subarray(4,8));return g};a.c3=function(a,b,d,g){var f=a.subarray(0,3),k=b.subarray(0,3),h=g.subarray(0,3);h[0]=k[0]*(d+1)-f[0]*d;h[1]=k[1]*(d+1)-f[1]*d;h[2]=k[2]*(d+1)-f[2]*d;g[3]=b[3]*(d+1)-a[3]*d;a=a.subarray(4,8);b=b.subarray(4,8);f=g.subarray(4,8);f[0]=b[0]*(d+1)-a[0]*d;f[1]=b[1]*(d+1)-a[1]*d;f[2]=b[2]*(d+1)-
a[2]*d;f[3]=b[3]*(d+1)-a[3]*d;x.normalize(f,f);return g};a.lV=function(a,b,d,g,f){f[0]=a[0]+b*d[0];f[1]=a[1]+b*d[1];f[2]=a[2]+b*d[2];f[3]=a[3];d=g[0];var k=g[1];g=g[2];var h=a[4],c=a[5],l=a[6],y=a[7];f[4]=.5*(d*y+k*l-g*c);f[5]=.5*(k*y+g*h-d*l);f[6]=.5*(g*y+d*c-k*h);f[7]=.5*(-d*h-k*c-g*l);f[4]=a[4]+f[4]*b;f[5]=a[5]+f[5]*b;f[6]=a[6]+f[6]*b;f[7]=a[7]+f[7]*b;a=f[4];b=f[5];d=f[6];k=f[7];a=a*a+b*b+d*d+k*k;0<a&&(a=1/Math.sqrt(a),f[4]*=a,f[5]*=a,f[6]*=a,f[7]*=a)};a.v8=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];var d=a[4],g=a[5],k=a[6],h=a[7];b[4]=d*y+h*f;b[5]=g*y+k*f;b[6]=k*y-g*f;b[7]=h*y-d*f};a.u8=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__config=function(a,r){function m(){return b4w.module_check(a.Ae.It)}function d(){for(var d=a.Ae,m=null,n=document.getElementsByTagName("script"),x=0;x<n.length;x++){for(var h=n[x].src,k=0;k<d.pJ.length;k++)if(0<=h.indexOf(d.pJ[k])){m=h;break}if(null!==m)break}m||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),m=document.location.href);d=m.indexOf("?");0<=d&&(m=m.substring(0,d));return m.substring(0,m.lastIndexOf("/"))}var b=r("__print"),
t=r("__util");a.op=1;a.Yk=2;a.Wm=3;a.JE=4;a.np=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.BG=t.P(a.context);a.A={alpha_sort:!0,alpha_sort_threshold:.1,hm:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,yH:1,ST:5,background_color:[0,0,0,0],canvas_resolution_factor:1,Lo:3,allow_cors:!1,xH:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,E2:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,nN:!1,Iq:!0,$v:!0,hd:!0,water_dynamic:!0,Ak:!0,Hw:!0,SM:!0,precision:"highp",quality:a.Yk,ut:!0,vW:!1,UC:!1,iA:!1,gN:!1,is_mobile_device:!1,$A:!1,Az:!1,V7:!1,as:!1,allow_hidpi:!1,IL:!1,FB:!1,enable_selectable:!0,enable_outlining:!0,Ni:!0,Fn:!1,vH:!1,uB:[0,0],Dq:!1,vK:!0,Jw:!1,url_params:null,cc:!0,Cc:4,iq:!1,OK:!1,PK:!1,yC:!1,nG:!1,aJ:!1,media_auto_activation:!0,JJ:4,Dv:!1,gl_debug:!1,hG:!1,lF:!1,Wy:!1,jq:"dds",P7:"16x",srgb_type:"SRGB_SIMPLE",Xy:!1};a.gH=t.P(a.A);
a.il={xu:-1,BH:!1,Kl:1};a.controls={rW:1/120};a.Od={path:"",GW:"B4W_ASSETS_PATH=__JS__/../../../deploy/assets\/",YW:"B4W_PROJ_ASSETS_PATH=__JS__/../assets\/",lW:15,prevent_caching:!0,EB:!1,dA:!1,jw:!1};a.wF=t.P(a.Od);a.Ae={shaders_path:"",nY:"../shaders/",GL:"include/",O7:"postprocessing/",It:"built_in_data",pJ:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js project_ow.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.cV={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Oi:.064,Aj:.035,uk:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],Pm:.11,Uj:.062,Bj:.004}};a.C={enabled:!0,max_fps:60,ts:"",UZ:"B4W_URANIUM_PATH=uranium.js",pz:!1,ping:!1,Cs:!0};a.hK=t.P(a.C);a.mo={ar:1024,cu:256,ZG:32,XS:128,WS:256,jK:.25,OW:.5,NW:1};a.SK=t.P(a.mo);a.W={SD:!0,Kv:!1,AF:!1,oG:!1,lH:!1};a.EL=t.P(a.W);a.Tc={outlining_overview_mode:!1,aj:[1,.4,.05],jk:.2,kk:3.8,lk:1};
a.uq={enabled:!1,PY:0,OY:0,qY:"COLOR"};a.fH=t.P(a.uq);a.zi={kW:8,Fv:64,BB:8,Gv:8,CB:15,KJ:0,vr:128,Si:1024,yB:4096,Bc:4096,DB:[4096,4096]};a.AG=t.P(a.zi);a.en=function(){var b=a.A,d=a.C,n=a.mo;switch(b.quality){case a.Wm:b.shadows=!0;b.Ak=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Iq=!0;b.$v=!0;b.hd=!0;n.ar=2048;n.cu=512;b.Lo=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Hw=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Ni=!0;b.Cc=16;b.srgb_type="SRGB_PROPER";d.max_fps=120;break;case a.Yk:b.shadows=!0;b.Ak=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Iq=!0;b.$v=!0;b.hd=!0;n.ar=1024;n.cu=256;b.Lo=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Hw=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Ni=!0;b.srgb_type="SRGB_SIMPLE";
b.Cc=4;d.max_fps=60;break;case a.op:b.shadows=!1;b.Ak=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.Iq=!1;b.$v=!1;b.hd=!1;n.ar=512;n.cu=256;b.Lo=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.Hw=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.Ni=!1;b.srgb_type="SRGB_SIMPLE";b.Cc=1;d.max_fps=60;break;case a.np:t.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(d,m){switch(d){case "allow_cors":a.A.allow_cors=m;break;case "allow_hidpi":a.A.allow_hidpi=m;break;case "alpha":a.context.alpha=m;break;case "alpha_sort":a.A.alpha_sort=m;break;case "alpha_sort_threshold":a.A.alpha_sort_threshold=m;break;case "anaglyph_use":b.wT();a.A.stereo=m?"ANAGLYPH":a.A.stereo;break;case "animation_framerate":a.il.xu=m;break;case "anisotropic_filtering":a.A.anisotropic_filtering=m;break;case "antialiasing":a.A.antialiasing=m;break;case "assets_dir":case "assets_path":a.Od.path=
m;break;case "assets_dds_available":a.Od.dA=m;break;case "assets_pvr_available":a.Od.jw=m;break;case "assets_min50_available":a.Od.EB=m;break;case "audio":a.W.SD=m;break;case "background_color":a.A.background_color=m;break;case "bloom":a.A.bloom=m;break;case "built_in_module_name":a.Ae.It=m;break;case "canvas_resolution_factor":a.A.canvas_resolution_factor=m;break;case "console_verbose":a.A.console_verbose=m;break;case "compositing":a.A.compositing=m;break;case "dof":a.A.dof=m;break;case "do_not_load_resources":a.A.do_not_load_resources=
m;break;case "god_rays":a.A.god_rays=m;break;case "stereo":a.A.stereo=m;break;case "max_fps":a.A.max_fps=m;break;case "max_fps_physics":a.C.max_fps=m;break;case "media_auto_activation":a.A.media_auto_activation=m;break;case "motion_blur":a.A.motion_blur=m;break;case "physics_enabled":a.C.enabled=m;break;case "physics_uranium_path":a.C.ts=m;break;case "physics_calc_fps":a.C.pz=m;break;case "physics_use_workers":a.C.Cs=m;break;case "precision":a.A.precision=m;break;case "prevent_caching":a.Od.prevent_caching=
m;break;case "quality":a.A.quality=m;break;case "reflections":a.A.reflections=m;break;case "refractions":a.A.refractions=m;break;case "sfx_mix_mode":a.W.Kv=m;break;case "shaders_dir":case "shaders_path":a.Ae.shaders_path=m;break;case "shadows":a.A.shadows=m;break;case "show_hud_debug_info":a.A.show_hud_debug_info=m;break;case "smaa":a.A.smaa=m;break;case "smaa_search_texture_path":a.Ae.smaa_search_texture_path=m;break;case "smaa_area_texture_path":a.Ae.smaa_area_texture_path=m;break;case "ssao":a.A.ssao=
m;break;case "debug_view":a.A.debug_view=m;break;case "enable_selectable":a.A.enable_selectable=m;break;case "enable_outlining":a.A.enable_outlining=m;break;case "outlining_overview_mode":a.Tc.outlining_overview_mode=m;break;case "glow_materials":a.A.Ni=m;break;case "url_params":a.A.url_params=m;break;case "use_min50":a.A.use_min50=m;break;case "gl_debug":a.A.gl_debug=m;break;case "srgb_type":a.A.srgb_type=m;break;default:b.error("Unknown config property: "+d)}};a.get=function(d){switch(d){case "allow_cors":return a.A.allow_cors;
case "allow_hidpi":return a.A.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.A.alpha_sort;case "alpha_sort_threshold":return a.A.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.A.stereo;case "animation_framerate":return a.il.xu;case "anisotropic_filtering":return a.A.anisotropic_filtering;case "antialiasing":return a.A.antialiasing;case "assets_dir":case "assets_path":return a.Od.path;case "assets_dds_available":return a.Od.dA;case "assets_pvr_available":return a.Od.jw;
case "assets_min50_available":return a.Od.EB;case "audio":return a.W.SD;case "background_color":return a.A.background_color;case "bloom":return a.A.bloom;case "built_in_module_name":return a.Ae.It;case "canvas_resolution_factor":return a.A.canvas_resolution_factor;case "console_verbose":return a.A.console_verbose;case "compositing":return a.A.compositing;case "dof":return a.A.dof;case "do_not_load_resources":return a.A.do_not_load_resources;case "is_mobile_device":return a.A.is_mobile_device;case "god_rays":return a.A.god_rays;
case "stereo":return a.A.stereo;case "max_fps":return a.A.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.A.media_auto_activation;case "motion_blur":return a.A.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.ts;case "physics_calc_fps":return a.C.pz;case "physics_use_workers":return a.C.Cs;case "precision":return a.A.precision;case "prevent_caching":return a.Od.prevent_caching;case "quality":return a.A.quality;case "reflections":return a.A.reflections;
case "refractions":return a.A.refractions;case "sfx_mix_mode":return a.W.Kv;case "shaders_dir":case "shaders_path":return a.Ae.shaders_path;case "shadows":return a.A.shadows;case "show_hud_debug_info":return a.A.show_hud_debug_info;case "smaa":return a.A.smaa;case "smaa_search_texture_path":return a.Ae.smaa_search_texture_path;case "smaa_area_texture_path":return a.Ae.smaa_area_texture_path;case "ssao":return a.A.ssao;case "debug_view":return a.A.debug_view;case "enable_selectable":return a.A.enable_selectable;
case "enable_outlining":return a.A.enable_outlining;case "outlining_overview_mode":return a.Tc.outlining_overview_mode;case "glow_materials":return a.A.Ni;case "url_params":return a.A.url_params;case "use_min50":return a.A.use_min50;case "gl_debug":return a.A.gl_debug;case "srgb_type":return a.A.srgb_type;default:b.error("Unknown config property: "+d)}};a.reset=function(){for(var b in a.BG)a.context[b]=a.BG[b];for(b in a.gH)a.A[b]=a.gH[b];for(b in a.wF)a.Od[b]=a.wF[b];for(b in a.hK)a.C[b]=a.hK[b];
for(b in a.SK)a.mo[b]=a.SK[b];for(b in a.EL)a.W[b]=a.EL[b];for(b in a.fH)a.uq[b]=a.fH[b]};a.wC=function(){for(var b in a.AG)a.zi[b]=a.AG[b]};a.fJ=m;a.WX=function(){var b=a.Ae,t=a.C;m()||""!=b.shaders_path||(b.shaders_path=d()+"/"+b.nY);t.enabled&&""==t.ts&&(t.ts=d()+"/"+t.UZ.replace("B4W_URANIUM_PATH=",""))};a.Bu=function(b){var m=a.Od;if(m.path)return m.path;var n=m.GW,x="B4W_ASSETS_PATH=";b&&(n=m.YW,x="B4W_PROJ_ASSETS_PATH=",n=n.replace("__NAME__",b));n=n.replace(x,"");return n=n.replace("__JS__",
d())}};b4w.module.__lights=function(a,r){function m(a){t.scale(a.color,a.Fi,a.hq)}r("__print");var d=r("__tsr"),b=r("__util"),t=r("__vec3"),q=new Float32Array(3);new Float32Array(3);a.EV=function(a,n){var x=a.data,h=n.Rc={name:"",type:x.type,oK:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),hq:new Float32Array(3),cT:0,KD:!1,zo:0,Sw:0,$p:.1,Zp:30,JH:!1,SJ:!1,nT:!1,Hm:!0,Jm:!0,Fi:1,distance:25,h3:"INVERSE_SQUARE"};h.name=n.name;h.Hm=x.use_diffuse;h.Jm=x.use_specular;var k=b.kc(d.R(n.k.n),
b.$c,q);t.normalize(k,k);h.direction.set(k);h.color[0]=x.color[0];h.color[1]=x.color[1];h.color[2]=x.color[2];h.Fi=h.cT=x.energy;m(h);h.distance=x.distance;h.KD=x.use_sphere;h.$p=x.clip_start;h.Zp=x.clip_end;if("POINT"===h.type||"SPOT"===h.type)h.distance=x.distance;"SPOT"===h.type?(h.Sw=x.spot_blend,h.zo=x.spot_size):"POINT"===h.type&&(h.zo=Math.PI/2);h.JH=x.b4w_generate_shadows;h.nT=x.b4w_dynamic_intensity};a.QX=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];m(a)};a.m7=function(a,
b){a.Sw=b};a.l7=function(a,b){a.distance=b};a.n7=function(a,b){a.zo=b};a.RX=function(a,b){a.Fi=b;m(a)};a.BZ=function(a){var n=a.Rc;if(n){b.kc(d.R(a.k.n),b.$c,n.direction);t.normalize(n.direction,n.direction);if("SUN"==n.type){a=Math.acos(t.dot(n.oK,b.Qy));var m=Math.acos(t.dot(n.direction,b.Qy));n.SJ=Math.floor(a/.025)!=Math.floor(m/.025)?!0:!1}t.copy(n.direction,n.oK)}}};b4w.module.__obj_util=function(a,r){function m(a){a={type:a,Qe:0,n:n.xl(),xx:n.xl(),pivot:new Float32Array(3),Tb:new Float32Array(3),Vj:0,Wj:0,nv:!1,ov:!1,Gj:null,dh:0,Hk:!1,lf:h.create(),use_panning:!1,tb:0,Qk:1,Pk:1,Rk:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Bd:!1,dof_object:null,lb:null,ka:null,sb:null,zc:null,yc:null,ae:null,Gh:!0,Th:{jk:1,kk:1,lk:0},Qd:-1,Dd:-1,lc:new Float32Array(4),Ml:0,Gl:0,Ln:!1,sr:new Float32Array(3),
ur:0,af:-1,Xg:0,Yg:0,qn:!1,Ce:!1,ce:!1,me:!1,be:!1,Gd:!1,Fd:!1,gh:"",nf:!1,Vf:!1,hd:!1,Mh:!1,vk:!1,Xv:!1,Tc:!1,Wv:!1,Yv:!1,bm:!1,Pn:!1,Mq:!1,Qm:0,oh:0,ph:0,Lg:0,Kg:0,Fg:0,Ri:"",we:{nB:"",mB:"",XB:""},ml:!1,Vp:new Float32Array(3),Cg:!1,Lp:!1,Np:"",Mp:!1,Ue:0,jx:0,kx:0,Zg:0,Ll:!1,Xc:!1,Ge:!1,ai:[],$j:!1,ti:!1,yh:1,yp:0,xp:1,Po:new Int8Array([-1,-1]),vo:[],Hv:[],Iw:[],ke:null,Be:null,oe:null,Ee:null,Dg:null,wi:null,Mr:null,Dp:null,Cp:null,ll:null,O:q.Pd(),Ta:q.Pd(),wa:q.Dh(),kb:q.Dh(),aa:q.Hg(),pb:q.Hg(),
yd:q.Yt(),FF:q.Yt(),Jp:null,Hp:null,Ip:null,Ro:!0,Nf:!1,dw:0};h.copy(x.$c,a.lf);return a}function d(a){if(!(a instanceof Object))return a;var b=null,f=null,k=null,h=null,n=null,m=null;a.ya&&(b=a.ya,a.ya=null);a.Kd&&(f=a.Kd,a.Kd=null);a.Eg&&(k=a.Eg,a.Eg=null);a.ib&&(h=a.ib,a.ib=null);a.yb&&(n=a.yb,a.yb=null);a.He&&(m=a.He,a.He=null);var q;q=a.constructor;switch(q){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:q=
new q(a);break;case Array:q=new q(a.length);for(var t=0;t<a.length;t++)q[t]=d(a[t]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:q=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:q=null;break;case Function:q=a;break;default:for(t in q=new q,a)q[t]=d(a[t])}b&&(q.ya=b,a.ya=b);f&&(q.Kd=f,a.Kd=f);k&&(q.Eg=k,a.Eg=k);h&&(q.ib=h,a.ib=h);n&&(q.yb=n,a.yb=n);m&&(q.He=x.Kj(),a.He=m);return q}function b(a,b){for(var d=a.I,f=0;f<d.length;f++){var k=d[f];if(k.xb==b)return k}return null}
function t(a){return a.ok?a.parent:a.parent?t(a.parent):null}var q=r("__boundings"),z=r("__config"),n=r("__tsr"),x=r("__util"),h=r("__vec3"),k=r("__vec4"),f=z.A;new Float32Array(4);new Float32Array(4);new Float32Array(4);n.create();n.create();a.jp=-1;a.pq=m;a.Bz=function(a){var b=m(a.type);b.Qe=a.Qe;n.copy(a.n,b.n);n.copy(a.xx,b.xx);h.copy(a.pivot,b.pivot);h.copy(a.Tb,b.Tb);b.Vj=a.Vj;b.Wj=a.Wj;b.nv=a.nv;b.ov=a.ov;a.Gj&&(b.Gj=h.clone(a.Gj));b.dh=a.dh;b.Hk=a.Hk;h.copy(a.lf,b.lf);b.use_panning=a.use_panning;
b.tb=a.tb;b.Qk=a.Qk;b.Pk=a.Pk;b.Rk=a.Rk;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Bd=a.Bd;b.dof_object=a.dof_object;b.lb=x.P(a.lb);b.ka=x.P(a.ka);b.sb=x.P(a.sb);b.zc=x.P(a.zc);b.yc=x.P(a.yc);b.ae=a.ae;b.Gh=a.Gh;b.Th.jk=a.Th.jk;b.Th.kk=a.Th.kk;b.Th.lk=a.Th.lk;b.Qd=a.Qd;b.Dd=a.Dd;b.lc=a.lc;
b.Ml=a.Ml;b.Gl=a.Gl;b.Ln=a.Ln;h.copy(a.sr,b.sr);b.ur=a.ur;b.af=a.af;b.Xg=a.Xg;b.Yg=a.Yg;b.qn=a.qn;b.Ce=a.Ce;b.ce=a.ce;b.me=a.me;b.be=a.be;b.Gd=a.Gd;b.Fd=a.Fd;b.gh=a.gh;b.nf=a.nf;b.Vf=a.Vf;b.hd=a.hd;b.Mh=a.Mh;b.vk=a.vk;b.Xv=a.Xv;b.Tc=a.Tc;b.Wv=a.Wv;b.Yv=a.Yv;b.bm=a.bm;b.Pn=a.Pn;b.Mq=a.Mq;b.Qm=a.Qm;b.oh=a.oh;b.ph=a.ph;b.Lg=a.Lg;b.Kg=a.Kg;b.Fg=a.Fg;b.Ri=a.Ri;b.we=a.we;b.ml=a.ml;h.copy(a.Vp,b.Vp);b.Cg=a.Cg;b.Lp=a.Lp;b.Np=a.Np;b.Mp=a.Mp;b.Ue=a.Ue;b.jx=a.jx;b.kx=a.kx;b.Zg=a.Zg;b.Ll=a.Ll;b.Xc=a.Xc;b.Ge=
a.Ge;b.ai=x.P(a.ai);b.$j=a.$j;b.ti=a.ti;b.yh=a.yh;b.yp=a.yp;b.xp=a.xp;b.Po.set(a.Po);b.vo=x.P(a.vo);b.Hv=x.P(a.Hv);b.Iw=x.P(a.Iw);b.ke=x.P(a.ke);b.Be=x.P(a.Be);b.oe=x.P(a.oe);b.Ee=x.P(a.Ee);b.Dg=x.P(a.Dg);b.wi=x.P(a.wi);b.Mr=x.P(a.Mr);b.Dp=x.P(a.Dp);b.Cp=x.P(a.Cp);b.ll=x.P(a.ll);q.hn(a.O,b.O);q.hn(a.Ta,b.Ta);q.Jz(a.wa,b.wa);q.Jz(a.kb,b.kb);q.Hz(a.aa,b.aa);q.Hz(a.pb,b.pb);b.Jp=x.P(a.Jp);b.Hp=x.P(a.Hp);b.Ip=x.P(a.Ip);b.Ro=a.Ro;b.Nf=a.Nf;b.dw=a.dw;return b};a.oq=function(a,b,d){d||(d=a);return{name:a,
pj:x.yA(),mm:d,type:b,Dj:!1,Ra:!1,hr:!1,ws:!1,k:null,ic:null,W:null,Rc:null,zt:null,anchor:null,vn:null,Jv:null,I:[],Xc:[],Pe:x.Kj(),Gz:x.Kj(),ha:[],Tr:[],ig:[],st:[],jh:null,xm:[],parent:null,ok:!1,Er:"",qx:null,ew:null,Im:!1,$b:"",Ut:"AUTO",Xe:!1,dg:!1,am:!1,SF:!1,C:null,v:null,Xf:null,kf:null,wn:null,fG:null,cC:[],eh:{Hr:"NO_COLLISION",ys:!1,ZM:!1,Rh:0,eN:0,dN:0,cH:0,MK:0,WV:!1,XV:!1,YV:!1,ZV:!1,$V:!1,aW:!1,fq:0,dq:0,gq:0,JD:!1,Qt:"BOX",us:!1},bK:{Yw:0,WB:0,Gf:0,qC:0},hl:0,Jg:[],OB:!1,RJ:!1,Iv:[]}};
a.Iz=function(a){return a instanceof Array?a.slice():a};a.s2=function(a){for(var b=[],f=0;f<a.length;f++){var k=a[f],h={},n;for(n in k)k[n]==k.Ta?h.Ta=d(k.Ta):k[n]==k.pb?h.pb=d(k.pb):h[n]=k[n];b.push(h)}return b};a.Tt=d;a.Ra=function(a){return a.Ra};a.rV=function(a){return"MESH"==a.type&&a.Ra};a.Bp=function(a,b){a.I.push({xb:b,mv:!1,U:[],Uh:[],Bi:null,WC:[],fm:0,ZJ:!1,ba:[],HL:[]})};a.vt=function(a,d,f){b(a,d).U.push(f)};a.J6=function(a,b){for(var d=a.I,f=0;f<d.length;f++)if(d[f].xb==b){d.splice(f,
1);break}};a.ja=b;a.NM=function(a,b){for(var d=0;d<a.length;d++)k.copy(b,a[d].k.lc)};a.DC=function(a,b,d){for(var f=0;f<a.I.length;f++){var k=a.I[f];d&&k.xb!=d||(k.mv=b)}};a.Lu=function(a,b){for(var d=[],k=b?f.JJ-1:f.JJ,h=0;h<a.length;h++){var n=a[h];n.Rc.JH&&d.length<k&&d.push(n)}return d.length?d:a[0]?[a[0]]:[]};a.qW=function(a,b){n.identity(b.n);b.Gj=null;a.k=b};a.jG=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var d=b.material-1,f=a.data.materials;if(0<=d&&d<f.length&&
("ADD"==f[d].game_settings.alpha_blend||"ALPHA"==f[d].game_settings.alpha_blend||"ALPHA_SORT"==f[d].game_settings.alpha_blend))return!0}return!1};a.uR=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].U,f=0;f<d.length;f++)for(var k=d[f].hb.Ei,h=0;h<k.length;h++){var n=k[h];if("USE_MODEL_TSR_INVERSE"==n[0]&&"1"==n[1])return!0}return!1};a.GH=function(a,b){return a+"*"+b};a.oI=function(a){return a.ok?null:a.parent};a.Ki=t;a.GA=function(a,b){for(var d=[],f=0;f<b.length;f++){var k=b[f];t(k)==
a&&d.push(k)}return d};a.LA=function(a){return a.k.Qe};a.Yd=function(a){return"MESH"===a.type};a.Zl=function(a){return"ARMATURE"===a.type};a.kr=function(a){return"SPEAKER"===a.type};a.xa=function(a){return"CAMERA"===a.type};a.qv=function(a){return"LAMP"===a.type};a.Kn=function(a){return"EMPTY"===a.type};a.K5=function(a){return"LINE"===a.type};a.jB=function(a){return"WORLD"===a.type}};b4w.module.__boundings=function(a,r){function m(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function d(){return{G:new Float32Array(3),Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function t(a,b){for(var c=a[0],d=a[1],l=a[2],g=a[0],f=a[1],k=a[2],h=3;h<a.length;h+=3)var w=a[h],v=a[h+1],Q=a[h+2],c=Math.max(c,w),d=Math.max(d,v),l=Math.max(l,Q),
g=Math.min(g,w),f=Math.min(f,v),k=Math.min(k,Q);b.max_x=c;b.max_y=d;b.max_z=l;b.min_x=g;b.min_y=f;b.min_z=k;return b}function q(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,l=a.max_z,g=a.min_x,f=a.min_y,k=a.min_z;b[0]=g;b[1]=f;b[2]=k;b[3]=c;b[4]=f;b[5]=k;b[6]=c;b[7]=d;b[8]=k;b[9]=g;b[10]=d;b[11]=k;b[12]=g;b[13]=f;b[14]=l;b[15]=c;b[16]=f;b[17]=l;b[18]=c;b[19]=d;b[20]=l;b[21]=g;b[22]=d;b[23]=l;return b}function z(){return{G:new Float32Array(3),Xa:0}}function n(a,b){b.G[0]=a.G[0];b.G[1]=
a.G[1];b.G[2]=a.G[2];b.Xa=a.Xa}function x(){return{Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),G:new Float32Array(3)}}function h(a,b){H.copy(a.Ga,b.Ga);H.copy(a.Ha,b.Ha);H.copy(a.Ia,b.Ia);H.copy(a.G,b.G);return b}function k(a){var b=x();h(a,b);return b}function f(a,b,c,d){return{Ga:new Float32Array(a),Ha:new Float32Array(b),Ia:new Float32Array(c),G:new Float32Array([d[0],d[1],d[2]])}}function y(a,b){var d=O.aR(a,c),d=b?O.UQ(a,d,C):D.identity(C),d=O.MT(d,l);H.copy(a,K);H.transformMat3(K,
d,K);for(var g=K[0],k=g,h=K[1],n=h,U=K[2],m=U,w=0,ga=0,Q=0,I=0,y=0,q=0,u=3;u<a.length;u+=3)K[0]=a[u],K[1]=a[u+1],K[2]=a[u+2],H.transformMat3(K,d,K),w=K[0],ga=K[1],Q=K[2],w>g&&(g=w),w<k&&(k=w),ga>h&&(h=ga),ga<n&&(n=ga),Q>U&&(U=Q),Q<m&&(m=Q);h-=n;U-=m;g=Math.max(g-k,1E-9);h=Math.max(h,1E-9);U=Math.max(U,1E-9);k=D.identity(C);k[0]=0!=g?1/g:1E8;k[4]=0!=h?1/h:1E8;k[8]=0!=U?1/U:1E8;D.transpose(d,v);K[0]=a[0];K[1]=a[1];K[2]=a[2];H.transformMat3(K,d,K);H.transformMat3(K,k,K);H.transformMat3(K,v,K);w=K[0];
ga=K[0];Q=K[1];I=K[1];y=K[2];q=K[2];for(u=3;u<a.length;u+=3)K[0]=a[u],K[1]=a[u+1],K[2]=a[u+2],H.transformMat3(K,d,K),H.transformMat3(K,k,K),H.transformMat3(K,v,K),w=Math.max(w,K[0]),ga=Math.min(ga,K[0]),Q=Math.max(Q,K[1]),I=Math.min(I,K[1]),y=Math.max(y,K[2]),q=Math.min(q,K[2]);u=Math.sqrt((w-ga)*(w-ga)+(Q-I)*(Q-I)+(y-q)*(y-q))/2;u=Math.min(u,1);F[0]=(w+ga)/2;F[1]=(Q+I)/2;F[2]=(y+q)/2;w=F;k=D.identity(C);k[0]=g;k[4]=h;k[8]=U;H.transformMat3(w,d,w);H.transformMat3(w,k,w);H.transformMat3(w,v,w);k=[d[0],
d[3],d[6]];ga=[d[1],d[4],d[7]];d=[d[2],d[5],d[8]];H.scale(k,g*u,k);H.scale(ga,h*u,ga);H.scale(d,U*u,d);return f(k,ga,d,w)}function g(a,b,c){H.add(b,c,a.G);H.scale(a.G,.5,a.G);a.Xa=H.distance(a.G,b);return a}var A=r("__tsr"),N=r("__util"),H=r("__vec3"),O=r("__math"),D=r("__mat3"),P=new Float32Array(24),K=new Float32Array(3),M=new Float32Array(3),F=new Float32Array(3),c=new Float32Array(3),l=new Float32Array(9),C=new Float32Array(9),v=new Float32Array(9);new Float32Array(9);a.Pd=m;a.Yt=d;a.hn=b;a.H1=
function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.r_=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.sl=function(a){var c=m();b(a,c);return c};a.VQ=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.oA=function(a,b){var c=a.max_y,d=a.max_z,g=a.min_x,l=a.min_y,f=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,
g);a.min_y=Math.min(b.min_y,l);a.min_z=Math.min(b.min_z,f)};a.EF=t;a.ql=function(a,b,c){c||(c=m());a=q(a,P);A.No(a,b,a);return t(a,c)};a.sH=q;a.T7=function(a,b,c){c||(c=m());var d=b.min_x,g=b.max_x,l=b.min_y,f=b.max_y,k=b.min_z;b=b.max_z;if(d>=a.max_x||g<=a.min_x||l>=a.max_y||f<=a.min_y||k>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,g);c.min_y=Math.max(a.min_y,l);c.max_y=Math.min(a.max_y,f);
c.min_z=Math.max(a.min_z,k);c.max_z=Math.min(a.max_z,b);return c};a.i8=function(a,b,c){c||(c=m());var d=a.max_x-a.min_x,g=a.max_y-a.min_y,l=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*g;c.max_y=a.max_y+.5*(b-1)*g;c.min_z=a.min_z-.5*(b-1)*l;c.max_z=a.max_z+.5*(b-1)*l;return c};a.Pp=function(a,b,c){c||(c=z());A.Vc(a.G,b,c.G);b=A.Xd(b);c.Xa=a.Xa*(0>b?-b:b);return c};a.Op=function(a,b,c){c||(c=x());A.Vc(a.G,b,c.G);H.copy(a.Ga,c.Ga);H.copy(a.Ha,c.Ha);
H.copy(a.Ia,c.Ia);A.wd(c.Ga,b,c.Ga);A.wd(c.Ha,b,c.Ha);A.wd(c.Ia,b,c.Ia);return c};a.kz=function(a,b,c){c||(c=d());A.Vc(a.G,b,c.G);H.copy(a.Ga,c.Ga);H.copy(a.Ha,c.Ha);H.copy(a.Ia,c.Ia);A.wd(c.Ga,b,c.Ga);A.wd(c.Ha,b,c.Ha);A.wd(c.Ia,b,c.Ia);return c};a.nz=function(a,b){var c=z();H.copy(b,c.G);c.Xa=a;return c};a.sX=function(a,b,c,g,l){var f=d();H.copy(a,f.G);H.copy(b,f.Ga);H.copy(c,f.Ha);H.copy(g,f.Ia);H.scale(f.Ga,l[0],f.Ga);H.scale(f.Ha,l[1],f.Ha);H.scale(f.Ia,l[2],f.Ia);return f};a.Dh=z;a.Jz=n;a.Hg=
x;a.Hz=h;a.aq=k;a.tl=function(a){var b=z();n(a,b);return b};a.Kp=f;a.EQ=function(){var a;a||(a=z());H.set(0,0,0,a.G);a.Xa=1E12;return a};a.yT=function(a,b){var c=H.subtract(b.G,a.G,H.create());0==H.length(c)&&H.set(1,0,0,c);var d=H.normalize(c,H.create()),c=H.scale(d,a.Xa,H.create());H.add(c,a.G,c);var g=H.scale(d,-a.Xa,H.create());H.add(g,a.G,g);var l=H.scale(d,b.Xa,H.create());H.add(l,b.G,l);var f=H.scale(d,-b.Xa,H.create());H.add(f,b.G,f);c=[c,g,l,f];d=H.normalize(d,H.create());g=c[0];l=c[0];for(f=
1;f<c.length;f++){var k=H.dot(c[f],d);k<H.dot(g,d)&&(g=c[f]);k>H.dot(l,d)&&(l=c[f])}d=[g,l];c=d[0];d=d[1];a.G=H.scale(H.add(c,d,H.create()),.5,H.create());a.Xa=H.length(H.subtract(d,c,H.create()))/2};a.sA=function(a,b){H.add(a.G,a.Ha,K);H.add(K,a.Ga,K);H.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);H.add(a.G,a.Ha,K);H.add(K,a.Ga,K);H.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2]);H.add(a.G,a.Ha,K);H.subtract(K,a.Ga,K);H.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);H.add(a.G,a.Ha,K);H.subtract(K,a.Ga,K);H.subtract(K,a.Ia,
K);b.push(K[0],K[1],K[2]);H.subtract(a.G,a.Ha,K);H.add(K,a.Ga,K);H.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);H.subtract(a.G,a.Ha,K);H.add(K,a.Ga,K);H.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2]);H.subtract(a.G,a.Ha,K);H.subtract(K,a.Ga,K);H.add(K,a.Ia,K);b.push(K[0],K[1],K[2]);H.subtract(a.G,a.Ha,K);H.subtract(K,a.Ga,K);H.subtract(K,a.Ia,K);b.push(K[0],K[1],K[2])};a.Vt=y;a.SR=function(a){var b=d();H.copy(a.Ga,b.Ga);H.copy(a.Ha,b.Ha);H.copy(a.Ia,b.Ia);H.copy(a.G,b.G);return b};a.mq=function(a){var b=z(),c=
0,c=H.length(a.Ga),d=H.length(a.Ha),g=H.length(a.Ia),c=c>d?c:d;b.G=a.G;b.Xa=g>c?g:c;return b};a.SQ=function(a,b){var d=k(a),g=A.fc(b,c);H.subtract(d.G,g,d.G);return d};a.gB=function(a,b){var c=H.length(a.Ga),d=H.length(a.Ha),g=H.length(a.Ia);return.75*b.Xa*b.Xa*b.Xa>c*d*g};a.GF=function(a,b){var c=b.max_z,d=b.min_z,g=Math.max(0,c-d-2*a);return{Xa:a,height:g,G:new Float32Array([0,0,(c+d)/2])}};a.IF=function(a,b){var c=b.max_z,d=b.min_z,g=Math.max(0,c-d);return{Xa:a,height:g,G:new Float32Array([0,0,
(c+d)/2])}};a.HF=function(a,b){var c=b.max_z,d=b.min_z,g=Math.max(0,c-d);return{Xa:a,height:g,G:new Float32Array([0,0,(c+d)/2])}};a.T1=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.aX=function(a){for(var b=0,c=0,d=0,g=0,l=0,f=0,k=0,h=0,w=0,v=0,Q=0,I=0,n=0,m=0,u=0;u<a.submeshes.length;u++){var aa=a.submeshes[u];if(aa.position.length){b=g=aa.position[0];c=l=aa.position[1];d=f=aa.position[2];break}}for(u=0;u<a.submeshes.length;u++){for(var aa=
a.submeshes[u],C=aa.position,k=v=aa.position[0],h=Q=aa.position[1],w=I=aa.position[2],q=0;q<C.length/3;q++)var F=C[3*q],A=C[3*q+1],S=C[3*q+2],b=Math.max(F,b),c=Math.max(A,c),d=Math.max(S,d),g=Math.min(F,g),l=Math.min(A,l),f=Math.min(S,f),k=Math.max(F,k),h=Math.max(A,h),w=Math.max(S,w),v=Math.min(F,v),Q=Math.min(A,Q),I=Math.min(S,I),n=Math.max(Math.sqrt(F*F+A*A+S*S),n),m=Math.max(Math.sqrt(F*F+A*A),m);C=aa.boundings.bb;C.max_x=k;C.min_x=v;C.max_y=h;C.min_y=Q;C.max_z=w;C.min_z=I;C=P;C[0]=v;C[1]=Q;C[2]=
I;C[3]=k;C[4]=Q;C[5]=I;C[6]=k;C[7]=h;C[8]=I;C[9]=v;C[10]=h;C[11]=I;C[12]=v;C[13]=Q;C[14]=w;C[15]=k;C[16]=Q;C[17]=w;C[18]=k;C[19]=h;C[20]=w;C[21]=v;C[22]=h;C[23]=w;k=y(C,!1);aa.boundings.be_cen=k.G;aa.boundings.be_ax=[k.Ga[0],k.Ha[1],k.Ia[2]]}u=a.b4w_boundings.bb;u.max_x=b;u.min_x=g;u.max_y=c;u.min_y=l;u.max_z=d;u.min_z=f;u=a.b4w_boundings.bb_src;u.max_x=b;u.min_x=g;u.max_y=c;u.min_y=l;u.max_z=d;u.min_z=f;a.b4w_boundings.bs_rad=n;a.b4w_boundings.bc_rad=m;C=P;C[0]=g;C[1]=l;C[2]=f;C[3]=b;C[4]=l;C[5]=
f;C[6]=b;C[7]=c;C[8]=f;C[9]=g;C[10]=c;C[11]=f;C[12]=g;C[13]=l;C[14]=d;C[15]=b;C[16]=l;C[17]=d;C[18]=b;C[19]=c;C[20]=d;C[21]=g;C[22]=c;C[23]=d;k=y(C,!1);a.b4w_boundings.be_cen=k.G;a.b4w_boundings.be_ax=[k.Ga[0],k.Ha[1],k.Ia[2]]};a.FU=function(a){var b=a.subarray(0,3),c=a.subarray(6,9),d=a.subarray(12,15),l=a.subarray(18,21);a=H.subtract(c,b,K);H.normalize(a,a);var f=N.OU(b,c,d,M),f=H.cross(f,a,f);H.normalize(f,f);var k=H.create(),h=H.create();H.subtract(c,b,F);h[0]=H.dot(F,a);h[1]=H.dot(F,f);c=H.create();
H.subtract(d,b,F);c[0]=H.dot(F,a);c[1]=H.dot(F,f);d=H.create();H.subtract(l,b,F);d[0]=H.dot(F,a);d[1]=H.dot(F,f);l=z();d=[k,h,c,d];k=g(l,d[0],d[1]);for(l=2;l<d.length;l++)if(H.distance(k.G,d[l])>k.Xa){for(var v=k,k=d,h=d[l],c=l-1,v=g(v,h,k[0]),w=1;w<=c;w++)if(H.distance(v.G,k[w])>v.Xa){for(var n=v,v=k,Q=h,I=k[w],m=w-1,n=g(n,Q,I),C=0;C<=m;C++)if(H.distance(n.G,v[C])>n.Xa){var u=Q,aa=I,y=v[C],q=H.subtract(aa,y,F),q=H.squaredLength(q),A=H.subtract(u,y,F),x=H.squaredLength(A),A=H.subtract(u,aa,F),S=H.squaredLength(A),
A=q*(x+S-q),fa=x*(S+q-x),q=S*(q+x-S),x=A+fa+q;H.copy(u,n.G);H.scale(n.G,A/x,n.G);H.scaleAndAdd(n.G,aa,fa/x,n.G);H.scaleAndAdd(n.G,y,q/x,n.G);n.Xa=H.distance(n.G,u)}v=n}k=v}l=k;a=H.scale(a,l.G[0],F);H.scaleAndAdd(a,f,l.G[1],a);H.add(a,b,l.G);return l}};b4w.module.__particles=function(a,r){function m(){k.q("_rand() undefined")}function d(a,b,d,f,k,n){var c=a.iu,l=a.Ng,C=a.time;a=a.pK;for(var v=0;v<c.length;v+=4){var e=c[v];if(C>a&&C>=e&&e>a||C<a&&(e>a||C>=e))for(e=0;8>e;e++)l[8*v+e]=f[e],A[e]=f[e];else for(e=0;8>e;e++)A[e]=l[8*v+e];e=N;e[0]=b[3*v];e[1]=b[3*v+1];e[2]=b[3*v+2];h.Vc(e,A,e);k[3*v]=e[0];k[3*v+1]=e[1];k[3*v+2]=e[2];var m=g;m[0]=d[4*v];m[1]=d[4*v+1];m[2]=d[4*v+2];m[3]=d[4*v+3];h.eZ(m,A,m);n[4*v]=m[0];n[4*v+1]=m[1];n[4*v+2]=m[2];n[4*v+3]=
m[3];for(e=1;4>e;e++)k[3*(v+e)]=k[3*v],k[3*(v+e)+1]=k[3*v+1],k[3*(v+e)+2]=k[3*v+2],n[4*(v+e)]=m[0],n[4*(v+e)+1]=m[1],n[4*(v+e)+2]=m[2],n[4*(v+e)+3]=m[3]}}function b(a){a?(k.HY(a),m=function(){return k.$W()}):m=function(){return Math.random()}}var t=r("__config"),q=r("__batch"),z=r("__geometry"),n=r("__textures"),x=r("__time"),h=r("__tsr"),k=r("__util"),f=r("__vec3"),y=t.A,g=new Float32Array(4),A=new Float32Array(8),N=new Float32Array(3),H=[];a.update=function(){for(var a=0;a<H.length;a++)for(var b=
H[a],g=b.I,f=0;f<g.length;f++)for(var k=b,h=g[f].U,c=0;c<h.length;c++){var l=h[c],n=l.gb;n&&n.gx&&!l.Zf&&(d(n,n.positions,n.pM,k.k.n,n.fC,n.pD),n.QJ=!0)}};a.SB=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].U,g=0;g<d.length;g++)if(d[g].gb)return!0;return!1};a.YJ=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var d=a[b].U,g=0;g<d.length;g++){var f=d[g].gb;if(f&&"EMITTER"==f.Zv)return!0}return!1};a.NQ=function(a){return 0<a.particle_systems.length};a.MQ=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.$U=function(a){for(var b=0;b<a.particle_systems.length;b++){var d=a.particle_systems[b].settings;if("HAIR"==d.type&&d.b4w_dynamic_grass)return!0}return!1};a.jV=function(a,b,d){var g=a.gb={name:b.name,Zv:b.settings.type,time:0,pK:-1,gx:!1,va:0,Za:0,vM:0,pB:0,zJ:0,ve:0,Rh:0,PB:0,OI:0,Il:0,zf:0,oN:0,size:0,nF:0,mF:0,wG:0,vG:new Float32Array(16),QJ:!1,positions:null,fC:null,pM:null,pD:null,iu:null,fA:null,Ng:null,cK:null,tM:0,uM:0};g.va=b.settings.frame_start;
g.Za=b.settings.frame_end;g.vM=(g.Za-g.va)/x.rd();g.pB=b.settings.lifetime;g.zJ=g.pB/x.rd();g.ve=b.settings.b4w_cyclic?1:0;g.Rh=b.settings.mass;g.PB=b.settings.normal_factor;g.OI=9.81*b.settings.effector_weights.gravity;g.Il=b.settings.b4w_fade_in/x.rd();g.zf=b.settings.b4w_fade_out/x.rd();g.oN=b.settings.effector_weights.wind;g.gx="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,h,c;a.br?(f=d.halo.size,h=d.halo.hardness,30>h?(h=.5,c=.9):40>h?(h=.1,c=1):50>h?(h=0,c=.8):(h=0,c=.5)):(f=b.settings.particle_size,
c=h=1);g.size=f;g.nF=h;g.mF=c;d.use_nodes&&"BILLBOARD"==b.settings.render_type&&(q.ef(a,"NODES",1),q.ef(a,"PARTICLE_BATCH",1),a.Tj=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&y.ut&&(b=b[0].texture,f=[],n.TQ(b.color_ramp,n.IE,f),f=new Uint8Array(f.map(function(a){return k.V(255*a,0,255)})),f=n.DG(f,n.IE),q.zj(a,f,"u_color_ramp_tex",b.name),q.ef(a,"USE_COLOR_RAMP",1));d=d.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(d[0]&&"STRAND"==d[0].texture_coords&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){d=d[0].texture.color_ramp.elements;b=Math.min(4*d.length,a.length);for(f=0;f<b;f+=4)h=d[f/4],a[f]=h.position,a[f+1]=h.color[0],a[f+2]=h.color[1],a[f+3]=h.color[2];g.wG=d.length}g.vG.set(a)};a.fU=function(a,g,h,n){var y=a.gb,q=n.n;n=h.settings.count;var c=h.settings.frame_start/x.rd(),l=h.settings.frame_end/x.rd(),C=h.settings.lifetime/x.rd(),v=h.settings.lifetime_random,e=h.settings.emit_from,
R=h.settings.factor_random;if(h.settings.use_rotations)var p=h.settings.angular_velocity_mode,A=h.settings.angular_velocity_factor;else p="NONE",A=0;var J=h.settings.b4w_randomize_emission,B=h.settings.b4w_cyclic;y.tM=h.settings.billboard_tilt;y.uM=h.settings.billboard_tilt_random;b(h.seed);var V;g=z.tH(g,["a_position","a_tbn_quat"],null);switch(e){case "VERT":var U=g.Z[0].a_position;V=g.Z[0].a_tbn_quat;h=U.length/3;g=[];for(e=0;e<n;e++){var Z=Math.round((h-1)*m());g.push(Z);g.push(Z);g.push(Z);g.push(Z)}h=
[];for(e=0;e<g.length;e++)h.push(U[3*g[e]]),h.push(U[3*g[e]+1]),h.push(U[3*g[e]+2]);U=new Float32Array(h);h=[];for(e=0;e<g.length;e++)h.push(V[4*g[e]]),h.push(V[4*g[e]+1]),h.push(V[4*g[e]+2]),h.push(V[4*g[e]+3]);V=new Float32Array(h);break;case "FACE":U=[];V=[];e=[];k.kv(0,e);h=z.zA(g,n,!1,e);k.kv(0,e);g=z.zA(g,n,!0,e);for(e=0;e<h.length;e++)U.push(h[e][0],h[e][1],h[e][2]),U.push(h[e][0],h[e][1],h[e][2]),U.push(h[e][0],h[e][1],h[e][2]),U.push(h[e][0],h[e][1],h[e][2]),V.push(g[e][0],g[e][1],g[e][2],
g[e][3]),V.push(g[e][0],g[e][1],g[e][2],g[e][3]),V.push(g[e][0],g[e][1],g[e][2],g[e][3]),V.push(g[e][0],g[e][1],g[e][2],g[e][3]);U=new Float32Array(U);V=new Float32Array(V);break;case "VOLUME":k.q("Particle emission from volume is not supported");break;default:k.q("Wrong emit from option")}V=[U,V];U=V[0];V=V[1];y.positions=new Float32Array(U);y.pM=new Float32Array(V);y.fC=new Float32Array(U.length);y.pD=new Float32Array(V.length);g=[];l=(l-c)/n;for(h=0;h<n;h++)e=J?l*h+10*l*(.5-m()):l*h,B||(e+=c),
g.push(e),g.push(e),g.push(e),g.push(e);c=new Float32Array(g);y.iu=new Float32Array(c);y.fA=new Float32Array(c);if(y.gx){y.Ng=new Float32Array(8*c.length);for(J=0;J<8*c.length;J++)for(B=0;8>B;B++)y.Ng[8*J+B]=q[B];d(y,U,V,q,U,V)}q=z.Df("EMITTER_PARTICLES");J=k.Ig();J.a_position=U;J.a_tbn_quat=V;q.Z[0]=J;a.Fh=z.Os;a=[];for(J=0;J<n;J++)a.push(4*J,4*J+2,4*J+1,4*J,4*J+3,4*J+2);a=new Uint16Array(a);q.ma=a;q.pa.a_p_bb_vertex=z.EH(n);q.Ja=U.length/3;a=[];v*=C;for(J=0;J<n;J++)B=v*m(),a.push(C-B),a.push(C-
B),a.push(C-B),a.push(C-B);C=q.pa;v=[];for(J=0;J<n;J++)B=Math.random(),v.push(a[4*J],c[4*J],B),v.push(a[4*J+1],c[4*J+1],B),v.push(a[4*J+2],c[4*J+2],B),v.push(a[4*J+3],c[4*J+3],B);v=new Float32Array(v);C.a_p_data=v;C=q.pa;v=[];for(a=0;a<n;a++){c=[m()-.5,m()-.5,m()-.5];f.normalize(c,c);v.push(R*c[0]);v.push(R*c[1]);v.push(R*c[2]);switch(p){case "NONE":v.push(0);break;case "SPIN":case "VELOCITY":v.push(A);break;case "RAND":v.push(2*A*(m()-.5));break;default:k.q("Undefined velocity factor")}c=v.slice(-4);
for(J=0;12>J;J++)v.push(c[J%4])}n=new Float32Array(v);C.a_p_vels=n;y.cK=new Float32Array(q.pa.a_p_data);return q};a.bY=function(a,b,d){a=a.I;for(var g=0;g<a.length;g++)for(var f=a[g].U,k=0;k<f.length;k++){var c=f[k].gb;c&&c.name==b&&!f[k].Zf&&(c.pK=c.time,c.time=d)}};a.UW=function(a){for(var b=a.Ja,d=a.Z[0].a_position,g=[],f=[],k=0;k<b;k++)f.push(d[3*k]),g.push(d[3*k+1]),f.push(d[3*k+2]);g=new Float32Array(g);f=new Float32Array(f);a.pa.a_lf_dist=g;a.pa.a_lf_bb_vertex=f;return a};a.H7=function(a,b,
d){a=a.I;for(var g=0;g<a.length;g++)for(var f=a[g].U,k=0;k<f.length;k++){var c=f[k].gb;c&&c.name==b&&(c.size=d)}};a.t7=function(a,b,d){a=a.I;for(var g=0;g<a.length;g++)for(var f=a[g].U,k=0;k<f.length;k++){var c=f[k].gb;c&&c.name==b&&(c.PB=d)}};a.e7=function(a,b,d){a=a.I;for(var g=0;g<a.length;g++)for(var f=a[g].U,k=0;k<f.length;k++){var c=f[k],l=c.gb;if(l&&l.name==b){var h=l.iu;if(1==d)var n=h;else if(0==d)for(var n=l.fA,e=0;e<n.length;e+=4)n[e]=1E4,n[e+1]=n[e],n[e+2]=n[e],n[e+3]=n[e];else for(var m=
4/d,n=l.fA,p=0,e=0;e<n.length;e+=4)e>=p?(n[e]=h[e],p+=m):n[e]=1E4,n[e+1]=n[e],n[e+2]=n[e],n[e+3]=n[e];c=c.Ba;if(c.kd.a_p_data){l=l.cK;for(e=0;e<l.length;e+=3)l[e+1]=n[Math.round(e/3)];z.uZ(c,l)}}}};a.QZ=function(a,b,d){a=a.I;for(var g=0;g<a.length;g++)for(var f=a[g].U,k=0;k<f.length;k++){var c=f[k].gb;if(c&&c.gx)for(var l=0;l<8*c.iu.length;l++)c.Ng[8*l]=b[0],c.Ng[8*l+1]=b[1],c.Ng[8*l+2]=b[2],c.Ng[8*l+3]=b[3],c.Ng[8*l+4]=d[0],c.Ng[8*l+5]=d[1],c.Ng[8*l+6]=d[2],c.Ng[8*l+7]=d[3]}};a.IZ=function(a,b,d){for(var g=
[],f=0;f<d;f++)g.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.pa.a_tbn_quat=new Float32Array(g);if(b.Fr){g=[];for(f=0;f<d;f++)g.push(f,f,f,f);a.pa[b.Fr.name]=new Float32Array(g)}};a.HZ=function(a){-1==H.indexOf(a)&&H.push(a)};a.eX=function(a){a=H.indexOf(a);-1!=a&&H.splice(a,1)};a.sa=function(){H.length=0}};b4w.module.__batch=function(a,r){function m(a){a={type:a,Db:"",id:0,cq:-1,hk:"",eu:-1,nn:-1,sq:0,xf:0,Bl:[],ya:[],Kd:[],Eg:[],sd:[],Hj:[],qj:null,Yc:{},yb:null,hb:{tg:null,Te:null,Ei:[],jg:[],status:X.Py,TT:0,e_:0,zF:0,rM:0},fk:"",Gp:[],Ba:null,He:E.Kj(),Ge:!1,Di:!1,fu:!1,Ar:0,lm:0,vv:0,wv:0,hd:!1,Su:0,$q:0,ge:new Float32Array(3),ue:new Float32Array(16),Ag:!1,Jb:!1,Ua:!1,qh:!1,Xb:!1,Fe:!1,Vf:!1,Ce:!1,me:!1,ce:!1,be:!1,Gd:!1,Fd:!1,lu:!1,Fh:ea.Tm,of:!1,Zf:!1,Lj:!1,Gg:!1,af:wa.jp,Xg:0,Yg:0,Qd:-1,Dd:-1,
Xu:!1,av:0,Yu:0,bv:0,cv:0,$u:new Float32Array(3),Zu:new Float32Array(3),br:!1,xj:0,Nj:0,Dl:1,ho:0,yo:0,ks:1,$n:0,Cl:0,el:1,Sv:0,wr:0,kg:0,ow:0,Sd:new Float32Array(2),Dk:new Float32Array(3),di:new Float32Array(3),Bm:new Float32Array(3),Uf:new Float32Array(4),Ii:new Float32Array(4),em:null,Qn:null,or:null,nr:null,Tj:!1,wireframe_edge_color:za.create(),rj:!1,water_dynamic:!1,Gs:!1,tx:!1,ux:0,vx:0,sx:0,Xo:.1,po:0,ro:0,xn:0,wu:new Float32Array(2),vu:new Float32Array(2),Jq:new Float32Array(2),oo:new Float32Array(3),
qo:new Float32Array(3),Zi:null,qk:!1,gb:null,yv:0,fl:null,Fr:null,Yi:[],Xi:[],ze:[],Wi:[],O:null,Ta:null,wa:null,kb:null,pb:null,aa:null,Nf:!1,Tf:!0,cJ:0,Yn:new Float32Array(3)};a.Uf[3]=1;a.Ua=!0;a.yv=1;return a}function d(a){var b=m(a.type);b.Db=a.Db;b.id=a.id;b.cq=a.cq;b.hk=a.hk;b.eu=a.eu;b.nn=a.nn;b.sq=a.sq;b.xf=a.xf;b.Bl=[];b.ya=a.ya.slice();b.Kd=a.Kd.slice();b.Eg=a.Eg.slice();b.sd=a.sd.slice();b.Hj=a.Hj.slice();b.qj=E.P(a.qj);b.Yc=E.P(a.Yc);b.yb=a.yb;b.hb=E.P(a.hb);b.fk=a.fk;b.Gp=xa.IR(a.Gp);
b.Ba=a.Ba;b.Ge=a.Ge;b.Di=a.Di;b.fu=a.fu;b.Ar=a.Ar;b.lm=a.lm;b.vv=a.vv;b.wv=a.wv;b.Su=a.Su;b.$q=a.$q;b.ge=a.ge;b.ue=a.ue;b.Ag=a.Ag;b.Jb=a.Jb;b.Ua=a.Ua;b.qh=a.qh;b.Xb=a.Xb;b.Fe=a.Fe;b.Vf=a.Vf;b.Ce=a.Ce;b.me=a.me;b.ce=a.ce;b.be=a.be;b.Gd=a.Gd;b.Fd=a.Fd;b.hd=a.hd;b.lu=a.lu;b.Fh=a.Fh;b.of=a.of;b.Zf=a.Zf;b.Lj=a.Lj;b.Gg=a.Gg;b.af=a.af;b.Xg=a.Xg;b.Yg=a.Yg;b.Qd=a.Qd;b.Dd=a.Dd;b.Xu=a.Xu;b.av=a.av;b.Yu=a.Yu;b.bv=a.bv;b.cv=a.cv;za.copy(a.$u,b.$u);za.copy(a.Zu,b.Zu);b.br=a.br;b.xj=a.xj;b.Nj=a.Nj;b.Dl=a.Dl;b.ho=
a.ho;b.yo=a.yo;b.ks=a.ks;b.$n=a.$n;b.Cl=a.Cl;b.el=a.el;b.Sv=a.Sv;b.wr=a.wr;b.kg=a.kg;b.ow=a.ow;b.Sd[0]=a.Sd[0];b.Sd[1]=a.Sd[1];za.copy(a.Dk,b.Dk);za.copy(a.di,b.di);za.copy(a.Bm,b.Bm);ra.copy(a.Uf,b.Uf);ra.copy(a.Ii,b.Ii);b.em=E.P(a.em);a.Qn&&(b.Qn=new Float32Array(a.Qn),b.or=new Float32Array(a.or),b.nr=new Float32Array(a.nr));b.Tj=a.Tj;za.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.rj=a.rj;b.water_dynamic=a.water_dynamic;b.Gs=a.Gs;b.tx=a.tx;b.ux=a.ux;b.vx=a.vx;b.sx=a.sx;b.Xo=a.Xo;b.po=
a.po;b.ro=a.ro;b.xn=a.xn;b.wu.set(a.wu);b.vu.set(a.vu);b.Jq.set(a.Jq);za.copy(a.oo,b.oo);za.copy(a.qo,b.qo);b.Zi=E.P(a.Zi);b.qk=a.qk;b.gb=E.P(a.gb);b.yv=a.yv;a.fl&&(b.fl=new Float32Array(a.fl));b.Fr=E.P(a.Fr);b.Yi=E.P(a.Yi);b.Xi=E.P(a.Xi);b.ze=E.P(a.ze);b.Wi=E.P(a.Wi);b.O=I.sl(a.O);b.Ta=I.sl(a.Ta);b.aa=I.aq(a.aa);b.pb=I.aq(a.pb);b.wa=I.tl(a.wa);b.kb=I.tl(a.kb);b.Nf=a.Nf;b.Tf=a.Tf;b.Yn=a.Yn;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.Db=a.Jb?a.qh?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.Db=a.me?"CAST":"RECEIVE";break;case "COLOR_ID":a.Db=a.qh?"COLOR_ID_XRAY":"COLOR_ID"}}function t(a,b,c){var e=[],d=n(c,b,!b.qn,!1),g=a.data,f=g.materials,l=Array(f.length),k=Array(f.length),w=[],u=la.ec(c,ya.Ob),h=!1;u&&(h=u.rr.length?!0:!1);for(var I=0;I<d.length;I++)for(var B=d[I],Q=0;Q<f.length;Q++){var S=f[Q];if(!ea.TI(g,Q))if("PHYSICS"==B&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)w.push(ea.tA(g,Q,[],b.wi,{},null));else if(!S.b4w_lens_flares||h){var U=m(B);
"MAIN"==B?l[Q]=U:"DEBUG_VIEW"==B&&(k[Q]=U);U.cq=a.b4w_cluster_data.cluster_id;if(p(U,S)){"SHADOW"==B&&l[Q]&&(U.Fe=l[Q].Fe);U.Fh=b.Ge||b.Vf?ea.Os:ea.Tm;F(U,b);for(var J=U,aa=a.particle_systems,y=0;y<aa.length;y++){var ga=aa[y].settings.b4w_vcol_from_name,V=aa[y].settings.b4w_vcol_to_name;""!==ga&&""!==V&&(J.Yc[ga]={Ql:!1,src:[{name:ga,eg:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==U.type)U.hk=a.uuid;U.Lj=a.b4w_do_not_cull;"MAIN"==U.type&&(U.Gg=a.b4w_caustics);v(U,"DISABLE_FOG",("COLOR_ID"!=B&&"SHADOW"!=
B&&a.b4w_disable_fogging)|0);var fa=ea.tA(g,Q,U.Hj,b.wi,U.Yc,U.qj);!S.use_tangent_shading||"a_shade_tangs"in fa.Z[0]||(v(U,"CALC_TBN",1),C(U,"a_tbn_quat"));S.b4w_lens_flares&&(fa=pa.UW(fa));ba(U);e.push({za:U,bf:b,Dt:b,Jf:fa,fg:[S.name],Hd:[a]})}}}if(w.length){U=m("PHYSICS");U.Db="NAVMESH";U.hk=a.uuid;for(var fa=ea.eM(w),q=[],I=0;I<f.length;I++)q.push(f[I].name);ba(U);e.push({za:U,bf:b,Dt:b,Jf:fa,fg:q,Hd:[a]})}for(I=0;I<k.length;I++)k[I]&&(k[I].nn=l[I].id,ba(k[I]));var A=a.particle_systems;if(0<A.length&&
e.length){for(var ja=!1,Y=!1,I=0;I<A.length;I++){var Z=A[I],t=Z.settings;t.use_render_emitter&&(ja=!0);"HAIR"!=t.type||"OBJECT"!=t.render_type&&"GROUP"!=t.render_type&&Z.transforms.length||(Y=!0);if(ja&&Y)break}var M=e[0].za.Yc,na;if(Y){var D;if(1<f.length){for(var ca={},xa=0;xa<A.length;xa++){var r=A[xa].settings;if("HAIR"==r.type&&("OBJECT"==r.render_type||"GROUP"==r.render_type)){var H=r.b4w_vcol_from_name,N=r.b4w_vcol_to_name;""!==H&&""!==N&&(ca[H]=E.P(M[H]))}}"a_bending_col_main"in M&&(ca.a_bending_col_main=
E.P(M.a_bending_col_main));"a_bending_col_detail"in M&&(ca.a_bending_col_detail=E.P(M.a_bending_col_detail));D=ea.tH(g,[],ca)}else D=e[0].Jf;na=D}else na=null;for(var z=na,ra=a.nb,K=[],P=a.particle_systems,O=a.data,va=0;va<P.length;va++){var wb=P[va],Wa=wb.settings;if(Wa.count)if("EMITTER"==Wa.type){if("DYNAMIC"==b.type){var Fa=m("PARTICLES");Fa.wa=b.wa;Fa.O=b.O;Fa.aa=b.aa;Fa.kb=b.kb;Fa.Ta=b.Ta;Fa.pb=b.pb;var xb,Rc=O.materials,Vb=wb.settings.material-1;Vb>=Rc.length&&(ia.warn('Wrong material used for rendering particle system "'+
wb.name+'"'),Vb=0);xb=Rc[Vb];"HALO"===wb.settings.render_type&&"HALO"===xb.type&&(Fa.br=!0);x(Fa,xb);var ma=Fa,Ga=a,Ka=wb.settings;switch(Ka.b4w_billboard_align){case "VIEW":v(ma,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":v(ma,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":v(ma,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":v(ma,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:E.q("Wrong billboard align value")}v(ma,"BILLBOARD",0);var ta=Ka.b4w_enable_soft_particles&&
wa.jG(Ga,Ka);v(ma,"SOFT_PARTICLES",0<Ka.b4w_particles_softness&&ta&&ka.ju?1:0);v(ma,"SOFT_STRENGTH",X.M(Ka.b4w_particles_softness));X.ga(ma.hb,"WORLD_SPACE","WORLD"==Ka.b4w_coordinate_system?1:0);Fa.Vf=!0;Fa.Lj=a.b4w_do_not_cull;Fa.hk=ra.name+"_"+Wa.uuid;pa.jV(Fa,wb,xb);var Ca=pa.fU(Fa,O,wb,ra.k);pa.IZ(Ca,Fa,Wa.count);pa.HZ(ra);F(Fa,ra.k);ba(Fa);K.push({za:Fa,bf:b,Dt:b,Jf:Ca,fg:[xb.name],Hd:[a]})}}else if("HAIR"==Wa.type){var Ba=E.kv(wb.seed),Na=oa.kG(ka.uB)&&!Wa.b4w_initial_rand_rotation&&!Wa.b4w_hair_billboard,
bb=4;Na&&(bb=8);if(wb.transforms.length)var sa=wb.transforms;else for(var Ra=ea.zA(z,Wa.count,!1,Ba),sa=new Float32Array(Ra.length*bb),Da=0;Da<Ra.length;Da++){var Xc=.75+.5*E.og(Ba);sa[Da*bb]=Ra[Da][0];sa[Da*bb+1]=Ra[Da][1];sa[Da*bb+2]=Ra[Da][2];sa[Da*bb+3]=Xc;Na&&(sa[Da*bb+4]=1,sa[Da*bb+5]=0,sa[Da*bb+6]=0,sa[Da*bb+7]=0)}var Bc=la.ec(c,ya.oi)?!0:!1;if("OBJECT"==Wa.render_type){var jc=[n(c,Wa.dupli_object.nb.k,!b.qn,!0)],Pb=R(a,b,M,z,[Wa.dupli_object],jc,[sa],Wa,wb,Bc,Ba,!1);K.push.apply(K,Pb)}else if("GROUP"==
Wa.render_type){for(var Ob=Wa.dupli_group.objects,jc=[],Da=0;Da<Ob.length;Da++){var kc=n(c,Ob[Da].nb.k,!b.qn,!0);jc.push(kc)}for(var Gc=!1,Ib=[],Da=0;Da<Ob.length;Da++)Ib.push(Ob[Da].nb);if(Wa.use_whole_group){for(var lc,qb=sa,cb=Ib,$b=Na,Yc=bb,Cb={},Qb=new Float32Array([0,0,0,1]),eb=0;eb<qb.length;eb+=Yc)for(var pb=0;pb<cb.length;pb++){var Hc=za.create();za.scale(L.F(cb[pb].k.n),L.Xd(cb[pb].k.n),Hc);var mc=za.clone([qb[eb],qb[eb+1],qb[eb+2]]);Cb[pb]||(Cb[pb]=new Float32Array(qb.length));$b&&(Cb[pb][eb+
4]=Qb[0]=qb[eb+4],Cb[pb][eb+5]=Qb[1]=qb[eb+5],Cb[pb][eb+6]=Qb[2]=qb[eb+6],Cb[pb][eb+7]=Qb[3]=qb[eb+7],E.jC(Qb,Qb),E.bZ(Hc,Qb,Hc));za.add(mc,Hc,mc);Cb[pb][eb]=mc[0];Cb[pb][eb+1]=mc[1];Cb[pb][eb+2]=mc[2];Cb[pb][eb+3]=qb[eb+3]}lc=Cb;Gc=!0}else{var Ic;if(Wa.use_group_count){for(var Jb=sa,nc=Ib,ac=Wa.dupli_weights,Za=Ba,bc=Na,Kb=bb,rb={},oc=[],tb=0;tb<nc.length;tb++)for(var Lb=nc[tb],Rb=Lb.mm||Lb.name,uc=0;uc<ac.length;uc++){var Jc=ac[uc];Rb==Jc.name&&oc.push(Jc)}ac.length!=oc.length&&ia.error("dupli weights match failed");
for(tb=0;tb<Jb.length;tb+=Kb){for(var Ia,fc=oc,Db=[0],Eb=0;Eb<fc.length;Eb++)Db[Eb+1]=Db[Eb]+fc[Eb].count;for(var Cc=Db[Db.length-1]*E.og(Za),Sb=0,Eb=0;Eb<Db.length;Eb++)if(Cc>=Db[Eb]&&Cc<Db[Eb+1]){Sb=Eb;break}Ia=Sb;rb[Ia]=rb[Ia]||[];rb[Ia].push(Jb[tb],Jb[tb+1],Jb[tb+2],Jb[tb+3]);bc&&rb[Ia].push(Jb[tb+4],Jb[tb+5],Jb[tb+6],Jb[tb+7])}for(Ia in rb)rb[Ia]=new Float32Array(rb[Ia]);Ic=rb}else{for(var ib=sa,fb=Ba,Ja=Na,Wb=bb,Fb=Ib.length,Pa={},Qa=0;Qa<ib.length;Qa+=Wb){var lb=Math.floor(Fb*E.og(fb));Pa[lb]=
Pa[lb]||[];Pa[lb].push(ib[Qa],ib[Qa+1],ib[Qa+2],ib[Qa+3]);Ja&&Pa[lb].push(ib[Qa+4],ib[Qa+5],ib[Qa+6],ib[Qa+7])}for(lb in Pa)Pa[lb]=new Float32Array(Pa[lb]);Ic=Pa}lc=Ic}Pb=R(a,b,M,z,Ob,jc,lc,Wa,wb,Bc,Ba,Gc);K.push.apply(K,Pb)}"INSTANCE"==Wa.b4w_wind_bend_inheritance&&ra.k.nf&&ia.warn('Emitter object "'+ra.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else E.q("Unknown particle settings type")}ja?
e.push.apply(e,K):e=K}return e}function q(a){for(var b=[],c=[],e={},d=0;d<a.length;d++){var g=a[d].za,f=null;if(g.id in e){var l=e[g.id],k=c[l].za;J(g,function(a){J(k,function(b){E.KY(a,b)&&1!=a.cJ&&(f=c[l])})});if(!f){do g.id++;while(e[g.id])}}f||(f={za:g,aK:[],DF:[],gM:[],Hd:[],EK:[],fg:[]},e[g.id]=c.length,c.push(f));if(a[d].Jf&&a[d].Jf.Ja){f.aK.push(a[d].bf);f.DF.push(a[d].Dt);f.gM.push(a[d].Jf);for(var w=0;w<a[d].Hd.length;w++)g=a[d].Hd[w],-1==f.EK.indexOf(g.uuid)&&(f.Hd.push(g),f.EK.push(g.uuid));
for(w=0;w<a[d].fg.length;w++)g=a[d].fg[w],-1==f.fg.indexOf(g)&&f.fg.push(g)}f.fg.sort()}for(d=0;d<c.length;d++){var g=c[d].za,u=c[d].aK,h=c[d].DF,p=c[d].gM;a=wa.Bz(h[0]);if("STATIC"==a.type)for(w=0;w<u.length;w++){var B=u[w],n=h[w],e=p[w],Q=L.identity(sa);B.Cg&&!B.Lp?(B=L.fc(B.n,Ga),L.ff(B,Q)):L.copy(B.n,Q);n.bm?e.Ef||(n.Cg?ea.MY(e,Q):ea.Ww(e,Q)):ea.Ww(e,Q);if(n.bm)v(g,"AU_QUALIFIER","GLSL_IN");else if(1<c[d].Hd.length){B={};if(n.nf||n.Cg)B.au_center_pos=[Q[0],Q[1],Q[2]];n.nf&&(B.au_wind_bending_amp=
[n.oh],B.au_wind_bending_freq=[n.ph],B.au_detail_bending_amp=[n.Kg],B.au_detail_bending_freq=[n.Lg],B.au_branch_bending_amp=[n.Fg]);ea.LY(e,B);v(g,"AU_QUALIFIER","GLSL_IN")}else a.Vp.set(Q.subarray(0,3)),n.Vp.set(Q.subarray(0,3)),v(g,"AU_QUALIFIER","uniform")}if(0==p.length)e=ea.Df(E.qs("%empty"));else if(1==p.length)e=p[0];else{e=[];for(w=0;w<p.length;w++)ea.wV(p[w])||e.push(w);if(e.length<p.length)for(w=0;w<e.length;w++)ea.Xw(p[e[w]]);e=ea.eM(p)}if(1<c[d].Hd.length){p=[];for(w=0;w<c[d].Hd.length;w++)I.sA(c[d].Hd[w].nb.k.FF,
p);I.EF(p,a.Ta);I.hn(a.Ta,a.O);a.pb=I.Vt(E.yf(p),!0);I.Hz(a.pb,a.aa);a.kb=I.mq(a.pb);I.Jz(a.kb,a.wa)}a.Nf=I.gB(a.aa,a.wa);"STATIC"==a.type&&a.Ln&&(w=c[d].Hd[0].b4w_cluster_data,w.cluster_center&&w.cluster_radius?(a.sr.set(w.cluster_center),a.ur=w.cluster_radius):(a.sr.set(a.kb.G),a.ur=a.kb.Xa));"PARTICLES"!=g.type&&(w=e.Kf,g.O=I.sl(w.O),g.aa=I.aq(w.aa),g.wa=a.wa.Xa<w.wa.Xa?"STATIC"==a.type?I.tl(a.kb):I.tl(a.wa):I.tl(w.wa),"STATIC"==a.type?(g.pb=g.aa,g.Ta=g.O,g.kb=g.wa):(w=a.n,g.pb=I.Op(g.aa,w),g.kb=
I.Pp(g.wa,w),g.Ta=I.ql(g.O,w)),g.Nf=I.gB(g.aa,g.wa));b.push({za:g,k:a,Jf:e,fg:c[d].fg,Hd:c[d].Hd})}return b}function z(a,b,c,e){a.Jp=I.IF(b,e);a.Hp=I.GF(c,e);a.Ip=I.HF(b,e)}function n(a,b,c,e){var d=[];e||(b.vk&&la.ec(a,ya.pf)||b.Tc&&la.ec(a,ya.yg))&&d.push("COLOR_ID");c&&(d.push("MAIN"),d.push("NODES_GLOW"),la.ec(a,ya.rf)&&d.push("DEBUG_VIEW"),la.ec(a,ya.tf)&&d.push("SHADOW"),la.ec(a,ya.oi)&&d.push("GRASS_MAP"));d.push("PHYSICS");if(b.me||b.Gd)for(a=null,b.me&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),b.Gd&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?E.pQ(a,b):b),b=a,a=0;a<b.length;a++)c=d.indexOf(b[a]),-1!==c&&d.splice(c,1);return d}function x(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)H(a,b,"MAIN");else{f(a,b);c=b.game_settings.alpha_blend;a.qh=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.kg=b.offset_z;a.di.set([1,1,1]);var e=b.texture_slots;ra.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.Uf);if(b.b4w_lens_flares){V(a,"lens_flares.glslv","lens_flares.glslf");C(a,"a_position");C(a,"a_texcoord");var d=na.fe(e[0]),l=e[0].texture;U(a,d,"u_sampler",l.name)}else{V(a,"main.glslv","main_stack.glslf");b.use_shadeless||(c=ja.Qz(b.uuid,b.name,{Fe:b.use_shadeless,wq:b.diffuse_shader,ls:b.specular_shader,Km:b.use_tangent_shading}),a.hb.jg=ja.Rt(c));var w=y("use_map_color_diffuse",e),p=y("use_map_color_spec",e),I=y("use_map_normal",e),B=y("use_map_mirror",e),n=y("use_stencil",e);c=w[0];
p=p[0];I=I[0];B=B[0];w=w[1];e=n[0]&&y("use_rgb_to_intensity",e)[0];if(c){l=c.texture;switch(c.blend_type){case "MIX":v(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":v(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}d=na.fe(c);U(a,d,"u_colormap0",l.name);a.Cl=c.diffuse_color_factor;a.el=c.use_map_alpha?c.alpha_factor:0;a.di.set(c.scale)}n=c&&c==p;p&&(n||(l=p.texture,d=na.fe(p),U(a,d,"u_specmap0",l.name)),a.yo=p.specular_color_factor);if(I&&(l=I.texture,C(a,"a_tbn_quat"),
d=na.fe(I),U(a,d,"u_normalmap0",l.name),a.Sv=I.normal_factor,l.b4w_use_map_parallax&&ka.$v)){var d=X.M(l.b4w_parallax_steps),Q=X.M(l.b4w_parallax_lod_dist);v(a,"PARALLAX",1);v(a,"PARALLAX_STEPS",d);v(a,"PARALLAX_LOD_DIST",Q);a.$n=l.b4w_parallax_scale}B&&(l=B.texture,d=na.fe(B),U(a,d,"u_mirrormap",l.name),a.wr=B.mirror_factor);if(B=c&&w&&e?1:0)d=na.fe(w),l=w.texture,U(a,d,"u_colormap1",l.name),d=na.fe(e),l=e.texture,U(a,d,"u_stencil0",l.name);(l=c||p||I)&&a.di.set(l.scale);v(a,"TEXTURE_SPEC",void 0==
p?0:1);v(a,"ALPHA_AS_SPEC",n?1:0);v(a,"TEXTURE_STENCIL_ALPHA_MASK",B);C(a,"a_position");C(a,"a_tbn_quat");(c||p||I)&&C(a,"a_texcoord");if(b.b4w_water){a.rj=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Jb?(ia.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.Gs=!1):a.Gs="REFLECT"!=a.Db?b.b4w_water_shore_smoothing:!1;V(a,"water.glslv","water.glslf");B=ja.Qz(b.uuid,b.name,{Fe:!1,wq:b.diffuse_shader,ls:b.specular_shader,Km:b.use_tangent_shading});
a.hb.jg=ja.Rt(B);C(a,"a_position");ka.nN?(C(a,"a_polyindex"),a.Ua=!0,za.set(0,0,0,a.wireframe_edge_color),u.PA()?v(a,"DEBUG_WIREFRAME",1):v(a,"DEBUG_WIREFRAME",2)):v(a,"DEBUG_WIREFRAME",0);n=b.texture_slots;B=y("use_map_normal",n);d=y("use_map_mirror",n)[0];B.length&&(Q=na.fe(B[0]),l=B[0].texture,U(a,Q,"u_normalmap0",l.name),a.Xo=b.b4w_water_norm_uv_velocity);v(a,"NUM_NORMALMAPS",B.length);a.Zi=Array(B.length);for(l=0;l<B.length;l++)a.Zi[l]=new Float32Array(2),a.Zi[l].set([B[l].scale[0],B[l].scale[1]]);
d&&(Q=na.fe(d),l=d.texture,U(a,Q,"u_mirrormap",l.name),a.wr=d.mirror_factor);d=null;if(ka.Iq)for(l=0;l<n.length;l++){var S=n[l];if(!0===S.texture.b4w_water_foam){d=S;break}}d&&(v(a,"FOAM",1),Q=na.fe(d),l=d.texture,U(a,Q,"u_foam",l.name),a.xn=b.b4w_foam_factor,a.wu.set(l.b4w_foam_uv_freq),a.vu.set(l.b4w_foam_uv_magnitude),a.Jq[0]=d.scale[0],a.Jq[1]=d.scale[1]);for(l=0;l<n.length;l++)if(S=n[l],!0===S.texture.b4w_shore_dist_map){var m=S;break}m&&ka.ut&&(n=na.fe(m),l=m.texture,U(a,n,"u_shore_dist_map",
l.name),v(a,"SHORE_PARAMS",1),m=S.texture.b4w_shore_boundings,v(a,"MAX_SHORE_DIST",X.M(S.texture.b4w_max_shore_dist)),v(a,"SHORE_MAP_SIZE_X",X.M(m[0]-m[1])),v(a,"SHORE_MAP_SIZE_Y",X.M(m[2]-m[3])),v(a,"SHORE_MAP_CENTER_X",X.M((m[0]+m[1])/2)),v(a,"SHORE_MAP_CENTER_Y",X.M((m[2]+m[3])/2)));b.b4w_generated_mesh?(v(a,"GENERATED_MESH",1),a.tx=!0,a.ux=b.b4w_water_num_cascads,a.vx=b.b4w_water_subdivs,a.sx=b.b4w_water_detailed_dist):(C(a,"a_tbn_quat"),(d||B.length)&&C(a,"a_texcoord"),v(a,"GENERATED_MESH",0));
if(b.b4w_water_dynamic){var S=X.M(b.b4w_water_dst_noise_scale0),m=X.M(b.b4w_water_dst_noise_scale1),B=X.M(b.b4w_water_dst_noise_freq0),n=X.M(b.b4w_water_dst_noise_freq1),l=X.M(b.b4w_water_dir_min_shore_fac),d=X.M(b.b4w_water_dir_freq),Q=X.M(b.b4w_water_dir_noise_scale),J=X.M(b.b4w_water_dir_noise_freq),aa=X.M(b.b4w_water_dir_min_noise_fac),ga=X.M(b.b4w_water_dst_min_fac),fa=X.M(b.b4w_water_waves_hor_fac);v(a,"DST_NOISE_SCALE_0",S);v(a,"DST_NOISE_SCALE_1",m);v(a,"DST_NOISE_FREQ_0",B);v(a,"DST_NOISE_FREQ_1",
n);v(a,"DIR_MIN_SHR_FAC",l);v(a,"DIR_FREQ",d);v(a,"DIR_NOISE_SCALE",Q);v(a,"DIR_NOISE_FREQ",J);v(a,"DIR_MIN_NOISE_FAC",aa);v(a,"DST_MIN_FAC",ga);v(a,"WAVES_HOR_FAC",fa)}A(a,b);N(a,b);a.oo.set(b.b4w_shallow_water_col);a.qo.set(b.b4w_shore_water_col);a.po=b.b4w_shallow_water_col_fac;a.ro=b.b4w_shore_water_col_fac;v(a,"ABSORB",X.M(b.b4w_water_absorb_factor));v(a,"SSS_STRENGTH",X.M(b.b4w_water_sss_strength));v(a,"SSS_WIDTH",X.M(b.b4w_water_sss_width))}"HALO"===b.type&&(V(a,"halo.glslv","halo.glslf"),
h(a,b),a.Hj=["a_position"]);b.use_tangent_shading&&(v(a,"USE_TBN_SHADING",1),C(a,"a_shade_tangs"));v(a,"TEXCOORD",0);v(a,"NORMAL_TEXCOORD",0);c&&k(a,c,"TEXTURE_COLOR0_CO");w&&k(a,w,"TEXTURE_COLOR1_CO");e&&k(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");p&&k(a,p,"TEXTURE_SPEC_CO");I&&k(a,I,"TEXTURE_NORM_CO");v(a,"SHADELESS",b.use_shadeless?1:0);a.Fe=b.use_shadeless}c=b.game_settings.alpha_blend;v(a,"ALPHA","OPAQUE"===c?0:1);v(a,"ALPHA_CLIP","CLIP"===c?1:0);v(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);b.use_vertex_color_paint?(v(a,"VERTEX_COLOR",1),C(a,"a_color")):v(a,"VERTEX_COLOR",0);a.xj=b.ambient;a.Dl=b.diffuse_intensity;a.Nj=b.emit;a.Bm.set(b.specular_color);a.ks=b.specular_alpha;A(a,b);N(a,b);b.b4w_wettable?v(a,"WETTABLE",1):v(a,"WETTABLE",0);g(a,b);b.b4w_refractive&&!a.Jb?(ia.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.qk=!1):a.qk=b.b4w_refractive;a.ow=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=H(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||
b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(f(a,b),a.Jb)c=!1;else{p=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==p?H(a,b,"SHADOW"):V(a,"shadow.glslv","shadow.glslf");ra.set(0,0,0,b.alpha,a.Uf);C(a,"a_position");C(a,"a_tbn_quat");v(a,"ALPHA","OPAQUE"===p?0:1);a.di.set([1,1,1]);if((c=y("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===p){switch(c.blend_type){case "MIX":v(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":v(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.di.set(c.scale);
v(a,"TEXTURE_COLOR",1);C(a,"a_texcoord");p=na.fe(c);c=c.texture;"IMAGE"!=p.source&&"ENVIRONMENT_MAP"!=p.source&&"CANVAS"!=p.source&&"NONE"!=p.source||U(a,p,"u_colormap0",c.name)}else v(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.ys=b.b4w_use_ghost,a.$b=b.b4w_collision_id,a.fq=b.b4w_collision_margin,a.dq=b.b4w_collision_group,a.gq=b.b4w_collision_mask,a.Ml=b.physics.friction,a.Gl=b.physics.elasticity,c=!0):b.b4w_water?(a.rj=!0,a.n_=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)c=!1;else{f(a,b);a.of=!1;a.Ua=!0;a.Jb=!1;p=b.game_settings.alpha_blend;a.qh=b.b4w_render_above_all&&"OPAQUE"!=p&&"CLIP"!=p;b.use_nodes&&"CLIP"==p?H(a,b,"COLOR_ID"):V(a,"color_id.glslv","color_id.glslf");ra.set(0,0,0,b.alpha,a.Uf);C(a,"a_position");v(a,"ALPHA","OPAQUE"===p?0:1);a.di.set([1,1,1]);c=y("use_map_color_diffuse",b.texture_slots)[0];p="CLIP"===p?1:0;v(a,"ALPHA_CLIP",p);if(c&&p){switch(c.blend_type){case "MIX":v(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":v(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.di.set(c.scale);v(a,"TEXTURE_COLOR",1);C(a,"a_texcoord");p=na.fe(c);c=c.texture;"IMAGE"!=p.source&&"ENVIRONMENT_MAP"!=p.source&&"CANVAS"!=p.source&&"NONE"!=p.source||U(a,p,"u_colormap0",c.name)}else v(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(f(a,b),a.Jb=!1,a.of=!1,a.Ua=!0,V(a,"grass_map.glslv","grass_map.glslf"),C(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,p=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.Yc.a_grass_size={Ql:!0,src:[]},c?(a.Yc.a_grass_size.src.push({name:c,eg:4}),v(a,"DYNAMIC_GRASS_SIZE",1)):v(a,"DYNAMIC_GRASS_SIZE",0),a.Yc.a_grass_color={Ql:!0,src:[]},p?(a.Yc.a_grass_color.src.push({name:p,eg:7}),v(a,"DYNAMIC_GRASS_COLOR",1)):v(a,"DYNAMIC_GRASS_COLOR",0),v(a,"GRASS_TEXTURE_SIZE",X.M(ma.ar)),c=!0);break;case "DEBUG_VIEW":c=M(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.br)V(a,"particle_system.glslv","particle_system_stack.glslf"),
v(a,"HALO_PARTICLES",1),h(a,b);else{p={Fe:!1,wq:b.diffuse_shader,ls:b.specular_shader,Km:b.use_tangent_shading};if(b.use_nodes){V(a,"particle_system.glslv","particle_system.glslf");H(a,b,"PARTICLES");c=!0;break a}V(a,"particle_system.glslv","particle_system_stack.glslf");p=ja.Qz(b.uuid,b.name,p);a.hb.jg=ja.Rt(p);if(c=y("use_map_color_diffuse",c)[0]){v(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":v(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":v(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.Cl=c.diffuse_color_factor;a.el=c.use_map_alpha?c.alpha_factor:0;p=na.fe(c);U(a,p,"default"+String(a.ya.length),c.texture.name)}}ra.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Uf);a.xj=b.ambient;a.Dl=b.diffuse_intensity;a.Nj=b.emit;a.Bm.set(b.specular_color);a.ks=b.specular_alpha;C(a,"a_position");C(a,"a_tbn_quat");c=b.game_settings.alpha_blend;v(a,"ALPHA","OPAQUE"===c?0:1);v(a,"ALPHA_CLIP","CLIP"===c?1:0);v(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);A(a,b);N(a,b);f(a,b);c=b.game_settings.alpha_blend;a.qh=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.kg=b.offset_z;c=!0}break;default:E.q("Wrong batch type: "+a.type)}return c}function h(a,b){var c=b.halo;v(a,"NUM_RINGS",c.ring_count);v(a,"NUM_LINES",c.line_count);v(a,"NUM_STARS",c.star_tip_count);v(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.av=c.size;a.Yu=c.hardness/20;a.$u.set(c.b4w_halo_rings_color);a.Zu.set(c.b4w_halo_lines_color);a.bv=1/b.b4w_halo_stars_blend_height;a.cv=b.b4w_halo_stars_min_height;
a.Xu=!0}function k(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":v(a,c,"TEXTURE_COORDS_UV_ORCO");v(a,"TEXCOORD",1);break;case "NORMAL":v(a,c,"TEXTURE_COORDS_NORMAL");v(a,"NORMAL_TEXCOORD",1);break;default:v(a,c,"TEXTURE_COORDS_NONE")}}function f(a,b){var c=b.game_settings,e=c.alpha_blend;switch(e){case "ALPHA_SORT":a.Jb=!0;a.of=!0;a.Ua=!0;a.Ag=!1;break;case "ALPHA":a.Jb=!0;a.of=!1;a.Ua=!0;a.Ag=!1;break;case "CLIP":a.Jb=!1;a.of=!1;a.Ua=!0;a.Ag=!0;break;case "ADD":a.Jb=!0;a.of=!1;a.Ua=!1;a.Ag=
!1;break;case "OPAQUE":a.Jb=!1;a.of=!1;a.Ua=!0;a.Ag=!1;break;default:E.q("Unknown alpha blend mode: "+e)}a.Xb=c.use_backface_culling}function y(a,b){for(var c=[],e=b.length,d=0;d<e;d++){var g=b[d];1==g[a]&&g.texture&&g.texture.s&&c.push(g)}return c}function g(a,b){var c=b.raytrace_transparency;a.Ii[0]=c.fresnel;a.Ii[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.ho=c.reflect_factor;a.Ii[2]=c.fresnel;a.Ii[3]=1-c.fresnel_factor/5}function A(a,b){var c,e=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=
b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;e=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;e=b.specular_hardness;break;default:ia.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Dk[0]=b.specular_intensity;a.Dk[1]=c;a.Dk[2]=e}function N(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Sd[0]=0;a.Sd[1]=0;break;case "OREN_NAYAR":a.Sd[0]=b.roughness;a.Sd[1]=0;break;case "FRESNEL":a.Sd[0]=
b.diffuse_fresnel;a.Sd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Sd[0]=b.darkness;a.Sd[1]=0;break;case "TOON":a.Sd[0]=b.diffuse_toon_size;a.Sd[1]=b.diffuse_toon_smooth;break;default:ia.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Sd[0]=0,a.Sd[1]=0}}function H(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var e;switch(c){case "MAIN":V(a,"main.glslv","main.glslf");e=!1;break;case "GLOW":V(a,"main.glslv","main.glslf");e=!0;break;case "SHADOW":V(a,
"shadow.glslv","shadow.glslf");e=!1;break;case "COLOR_ID":V(a,"color_id.glslv","color_id.glslf"),e=!1}var d=b.node_tree;c=ja.MR(d,b.uuid,!1,b.name,c);if(!c.Wa)return ia.error('Failed to create node graph for material "'+b.name+'", disable nodes'),K(a,b),!0;a.fk=c.id;a.Tj=!0;v(a,"NODES",1);v(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);C(a,"a_position");b.use_orco_tex_coord&&C(a,"a_orco_tex_coord");f(a,b);a.kg=b.offset_z;var l=b.game_settings.alpha_blend;e?(v(a,"ALPHA",1),v(a,"ALPHA_CLIP",
0)):(v(a,"ALPHA","OPAQUE"===l?0:1),v(a,"ALPHA_CLIP","CLIP"===l?1:0));a.qh=b.b4w_render_above_all&&"OPAQUE"!=l&&"CLIP"!=l;a.Nj=b.emit;a.xj=b.ambient;g(a,b);b.b4w_wettable?v(a,"WETTABLE",1):v(a,"WETTABLE",0);var w=null,k=!1;aa.oa(c.Wa,function(c,e){switch(e.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var d=e.data.name,g=e.data.value;a.qj||(a.qj={});a.qj[g]=d;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":d=e.data.name;a.Yc[d]={Ql:!0,
src:[{name:e.data.value}]};g=0;if("GEOMETRY_VC"==e.type)g=7;else for(var f=0;f<e.fb.length;f++){var l="RGB".indexOf(e.fb[f].identifier);-1<l&&(g|=1<<2-l)}a.Yc[d].src[0].eg=g;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":C(a,"a_tbn_quat");break;case "TEX_COORD_OB":v(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":v(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":e.data.value.Km&&(v(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&C(a,"a_shade_tangs"));
C(a,"a_tbn_quat");k=!0;break;case "BSDF_BEGIN":k=!0;C(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":d=e.data.name;g=e.data.lz;f=e.data.value;U(a,f,d,g);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":v(a,"CALC_TBN_SPACE",1);C(a,"a_tbn_quat");e.data&&(d=e.data.name,g=e.data.lz,f=e.data.value,U(a,f,d,g));break;case "NORMAL_MAP":C(a,"a_tbn_quat");switch(Number(e.Qb[0][1])){case ja.oO:v(a,"CALC_TBN_SPACE",1);break;case ja.nO:case ja.mO:v(a,"USE_MODEL_TSR",1)}break;case "LAMP":e.data&&
(a.em=e.data);break;case "B4W_REFRACTION":a.Jb?a.qk=!0:(a.qk=!1,ia.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));v(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":w||(w=e.data.jb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&e.data&&(a.Fr=e.data);break;case "VECT_TRANSFORM":switch(Number(e.Qb[1][1])){case ja.EP:v(a,"USE_MODEL_TSR_INVERSE",1);break;case ja.DP:v(a,"USE_VIEW_TSR",1);break;case ja.CP:v(a,"USE_MODEL_TSR",1);break;case ja.BP:v(a,
"USE_MODEL_TSR",1);v(a,"USE_VIEW_TSR",1);break;case ja.AP:v(a,"USE_VIEW_TSR_INVERSE",1);break;case ja.zP:v(a,"USE_MODEL_TSR_INVERSE",1),v(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":v(a,"USE_MODEL_TSR",1);a.Yn[1]=b.pass_index;a.Yn[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":v(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":v(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":C(a,"a_tbn_quat"),u.PA()?v(a,"USE_DERIVATIVES_EXT",1):ia.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});w&&U(a,w,"u_nodes_texture");k||(a.Fe=!0);e=a.hb.jg=ja.Rt(c.Wa);O(d,a);d=a.Xi;c=a.Wi;for(l=0;l<e.length;l++){var E=e[l];switch(E.id){case "VALUE":var h=E.aw[0];if(h)for(var p=0;p<d.length;p+=2)if(d[p]==h){E.Qb.push(["VALUE_IND",d[p+1]]);break}break;case "RGB":if(h=E.aw[0])for(p=0;p<c.length;p+=2)if(c[p]==h){E.Qb.push(["RGB_IND",c[p+1]]);break}}}v(a,"NUM_VALUES",a.Yi.length);v(a,"NUM_RGBS",a.ze.length);return!0}function O(a,b){var c=[],e=[],d=[],g=[];D(a,"",c,e,d,g);b.Yi=c;
b.Xi=e;b.ze=d;b.Wi=g}function D(a,b,c,e,d,g){for(var f=0;f<a.nodes.length;f++){var l=a.nodes[f];if("VALUE"==l.type){var w=P(b,l.name);c.push(l.outputs[0].default_value);e.push(w,e.length/2)}else"RGB"==l.type?(w=P(b,l.name),l=l.outputs[0].default_value.slice(0,3),d.push(l[0],l[1],l[2]),g.push(w,g.length/2)):"GROUP"==l.type&&D(l.node_group.node_tree,P(b,l.name),c,e,d,g)}}function P(a,b){var c;return c=(a?a+"%join%":"")+b}function K(a,b){switch(a.type){case "SHADOW":V(a,"shadow.glslv","shadow.glslf");
break;case "COLOR_ID":V(a,"color_id.glslv","color_id.glslf");break;default:V(a,"main.glslv","main_stack.glslf")}v(a,"SHADELESS",1);C(a,"a_position");C(a,"a_tbn_quat");ra.set(1,0,1,1,a.Uf);if(b){var c=b.game_settings.alpha_blend;v(a,"ALPHA","OPAQUE"===c?0:1);v(a,"ALPHA_CLIP","CLIP"===c?1:0);v(a,"VERTEX_COLOR",0);a.kg=b.offset_z;f(a,b)}return!0}function M(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;V(a,"debug_view.glslv","debug_view.glslf");C(a,"a_position");C(a,"a_tbn_quat");C(a,"a_polyindex");
a.Ua=!0;za.set(0,0,0,a.wireframe_edge_color);return!0}function F(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.bm?v(a,"AU_QUALIFIER","GLSL_IN"):v(a,"AU_QUALIFIER","uniform"),v(a,"STATIC_BATCH",0)):(v(a,"AU_QUALIFIER","GLSL_IN"),v(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(u.PA()?v(a,"WIREFRAME_QUALITY",1):v(a,"WIREFRAME_QUALITY",0),a.Di?(v(a,"DEBUG_SPHERE",1),a.fu?v(a,"DEBUG_SPHERE_DYNAMIC",1):v(a,"DEBUG_SPHERE_DYNAMIC",0)):v(a,"DEBUG_SPHERE",0),v(a,"ALPHA",1));b.Ge&&(a.Ge=b.Ge);b.nf?(""!==b.Ri?
(a.Yc.a_bending_col_main={Ql:!0,src:[{name:b.Ri,eg:4}]},C(a,"a_bending_col_main"),""!==b.we.nB&&""!==b.we.mB&&""!==b.we.XB?(a.Yc.a_bending_col_detail={Ql:!0,src:[{name:b.we.nB,eg:4},{name:b.we.mB,eg:2},{name:b.we.XB,eg:1}]},C(a,"a_bending_col_detail"),C(a,"a_tbn_quat"),v(a,"DETAIL_BEND",1)):v(a,"DETAIL_BEND",0),v(a,"MAIN_BEND_COL",1)):v(a,"MAIN_BEND_COL",0),b.ml?v(a,"BEND_CENTER_ONLY",1):v(a,"BEND_CENTER_ONLY",0),v(a,"WIND_BEND",1)):v(a,"WIND_BEND",0);v(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.Lp|0);
b.Cg?v(a,"BILLBOARD",1):v(a,"BILLBOARD",0);b.Cg&&b.bm?v(a,"HAIR_BILLBOARD",1):v(a,"HAIR_BILLBOARD",0);b.Mp?v(a,"BILLBOARD_SPHERICAL",1):v(a,"BILLBOARD_SPHERICAL",0);switch(b.Np){case "RANDOM":v(a,"BILLBOARD_RANDOM",1);v(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":v(a,"BILLBOARD_RANDOM",0);v(a,"BILLBOARD_JITTERED",1);break;default:v(a,"BILLBOARD_RANDOM",0),v(a,"BILLBOARD_JITTERED",0)}b.hd&&ka.ut?v(a,"DYNAMIC_GRASS",1):v(a,"DYNAMIC_GRASS",0);a.hd=b.hd;"PARTICLES"!=a.type&&(a.Vf=b.Vf);a.Ce=b.Ce;
a.me=b.me;a.ce=b.ce&&!a.Fe&&!(a.Jb&&ka.iA);a.be=b.be;a.Gd=b.Gd;a.Fd=b.Fd;a.Yn[0]=b.dw;a.af=b.af;a.Xg=b.Xg;a.Yg=b.Yg;a.Qd=b.Qd;a.Dd=b.Dd;b.$j?(C(a,"a_influence"),v(a,"SKINNED",1),ka.Jw?(v(a,"DISABLE_TANGENT_SKINNING",1),v(a,"FRAMES_BLENDING",0)):(v(a,"DISABLE_TANGENT_SKINNING",0),b.Ll?v(a,"FRAMES_BLENDING",1):v(a,"FRAMES_BLENDING",0)),v(a,"MAX_BONES",b.Zg)):(v(a,"SKINNED",0),v(a,"FRAMES_BLENDING",0),v(a,"DISABLE_TANGENT_SKINNING",0));b.Xc?(v(a,"VERTEX_ANIM",1),ka.gN?v(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):v(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):v(a,"VERTEX_ANIM",0);b.$j&&b.Xc&&E.q("Skinning and vertex animation are mutually exlusive")}}function c(a,b,c){if(b.length){for(var e=wa.Lu(b,ka.ssao&&c.b4w_enable_ssao),d=a.hb,g=a.em,f=0,w=0;w<a.hb.jg.length;w++){var k=a.hb.jg[w];if("LIGHTING_LAMP"==k.id){var E=b[f++%b.length],u=E.Rc,h=wa.ja(E,c);if("SPOT"==u.type||"POINT"==u.type)var p=Math.cos(u.zo/2);if("SPOT"==u.type)var I=u.Sw*(1-p);E=e.indexOf(E);k.Qb=[["LAMP_TYPE",u.type],["LAMP_IND",
h.fm],["LAMP_SPOT_SIZE",X.M(p||.01)],["LAMP_SPOT_BLEND",X.M(I||.01)],["LAMP_LIGHT_DIST",X.M(u.distance)],["LAMP_USE_SPHERE",u.KD?1:0],["LAMP_SHADOW_MAP_IND",E]]}else if("LAMP"==k.id&&g)for(var h=k.Qb[0][1],B=0;B<b.length;B++)if(E=b[B],g[E.pj]==h){u=E.Rc;if("SPOT"==u.type||"POINT"==u.type)p=Math.cos(u.zo/2);"SPOT"==u.type&&(I=u.Sw*(1-p));k.Qb.push(["LAMP_TYPE",u.type],["LAMP_SPOT_SIZE",X.M(p||.01)],["LAMP_SPOT_BLEND",X.M(I||.01)],["LAMP_LIGHT_DIST",X.M(u.distance)],["LAMP_USE_SPHERE",u.KD?1:0])}}if(g){c=
0;for(var n in g)c++;a.Qn=new Float32Array(3*c);a.or=new Float32Array(3*c);a.nr=new Float32Array(3*c);X.ga(d,"NUM_LAMP_LIGHTS",c);for(w=0;w<b.length;w++)l(a,b[w])}}}function l(a,b){if(b.pj in a.em){var c=a.em[b.pj];a.Qn.set(L.F(b.k.n),3*c);a.or.set(b.Rc.direction,3*c);a.nr.set(b.Rc.hq,3*c)}}function C(a,b){var c=a.Hj;-1==c.indexOf(b)&&c.push(b);a.Hj=c.sort()}function v(a,b,c){X.ga(a.hb,b,c)}function e(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.Db?a.Ba=ea.fM(b,ea.Tm,[]):(0<b.ib.length&&ea.NY(b,b.Z[0]),
a.Jf=b);else{var c=a.Fh;a.Xu&&"PARTICLES"!=a.type&&(b=ea.DT(b));a.tx&&(b=S.cU(a.ux,a.vx,a.sx));c=ea.fM(b,c,a.Yc);a.Ba=c;a.Vf||a.of||a.Ge||(c.ie=null,c.mc.length=0);c=b.Z.length;a.Ar=b.Ja*c;var e;a:switch(a.Fh){case ea.Tm:case ea.dp:case ea.Os:e=!0;break a;default:e=!1}e?ea.vV(b)?a.lm=b.ma.length/3*c:a.lm=b.Ja/3*c:a.lm=0}}function R(a,b,c,e,d,g,f,l,w,k,u,h){var I=a.nb,B=[],n=l.b4w_dynamic_grass;if(!k&&n)return B;for(var Q="INSTANCE"==l.b4w_wind_bend_inheritance,S="INSTANCE"==l.b4w_shadow_inheritance,
U="INSTANCE"==l.b4w_reflection_inheritance,J=[],C=[],aa=0;aa<d.length;aa++){var y=d[aa].nb.k,X=wa.Bz(b);X.Cg=l.b4w_hair_billboard;X.Np=l.b4w_hair_billboard_type;X.Mp="SPHERICAL"==l.b4w_hair_billboard_geometry;X.hd=n;X.bm=!0;Q?(X.nf=y.nf,X.Qm=y.Qm,X.ph=y.ph,X.Lg=y.Lg,X.Ri=y.Ri,X.Kg=y.Kg,X.Fg=y.Fg,X.oh=y.oh,X.we=y.we,X.ml=!1):(X.nf=I.k.nf,X.Qm=I.k.Qm,X.ph=I.k.ph,X.Lg=I.k.Lg,X.Ri=I.k.Ri,X.Kg=I.k.Kg,X.Fg=I.k.Fg,X.oh=I.k.oh,X.we=I.k.we,X.ml=!0);S?(X.Ce=y.Ce,X.me=y.me,X.ce=y.ce):(X.Ce=I.k.Ce,X.me=I.k.me,
X.ce=I.k.ce);U?(X.be=y.be,X.Gd=y.Gd,X.Fd=y.Fd,X.Qd=y.Qd,X.Dd=y.Dd,X.gh=y.gh):(X.be=I.k.be,X.Gd=I.k.Gd,X.Fd=I.k.Fd,X.Qd=I.k.Qd,X.Dd=I.k.Dd,X.gh=I.k.gh);J.push(X);var ga=f[aa];ga||(ga=new Float32Array);h&&E.kv(w.seed,u);var V=new Float32Array(3),q=new Float32Array([0,0,0,1]),R=[],A=oa.kG(ka.uB)&&!l.b4w_initial_rand_rotation&&!l.b4w_hair_billboard,ja=4;A&&(ja=8);for(var Y=0;Y<ga.length;Y+=ja){V[0]=ga[Y];V[1]=ga[Y+1];V[2]=ga[Y+2];var x=ga[Y+3]*L.Xd(y.n);if(l.b4w_initial_rand_rotation){switch(l.b4w_rotation_type){case "XYZ":var ya=
new Float32Array([E.og(u),E.og(u),E.og(u)]);za.normalize(ya,ya);break;case "Z":ya=new Float32Array([0,0,1]);break;default:E.q("Unsupported random rotation type: "+l.b4w_rotation_type)}fa.setAxisAngle(ya,l.b4w_rand_rotation_strength*(2*Math.PI*E.og(u)-Math.PI),q)}else A&&(q.set(ga.subarray(Y+4,Y+8)),E.jC(q,q),l.use_whole_group||(l.use_rotation_dupli?fa.multiply(q,L.R(y.n),q):fa.multiply(q,Ka,q)));var Z=L.$h(V,x,q,L.create());R.push(Z)}C.push(R)}for(var t={},M=0,aa=0;aa<d.length;aa++)for(var na=d[aa].data.materials,
Y=0;Y<na.length;Y++)na[Y].name in t?t[na[Y].name]++:(t[na[Y].name]=1,M++);for(var M=M?M:1,D={},aa=0;aa<d.length;aa++){var ca=d[aa],xa=g[aa],X=J[aa],r={};X.nf&&(r.au_wind_bending_amp=[X.oh],r.au_wind_bending_freq=[X.ph],r.au_detail_bending_freq=[X.Lg],r.au_detail_bending_amp=[X.Kg],r.au_branch_bending_amp=[X.Fg],X.oh=0,X.ph=0,X.Lg=0,X.Kg=0,X.Fg=0);R=C[aa];if(R.length){for(var H=ca.data,na=H.materials,N=Array(na.length),la=Array(na.length),Y=0;Y<na.length;Y++)if(!ea.TI(H,Y))for(var wb=0;wb<xa.length;wb++){var Wa=
xa[wb],Fa=m(Wa),z=na[Y];"MAIN"==Wa?N[Y]=Fa:"DEBUG_VIEW"==Wa&&(la[Y]=Fa);Fa.cq=a.b4w_cluster_data.cluster_id;if(p(Fa,z)){"SHADOW"==Wa&&N[Y]&&(Fa.Fe=N[Y].Fe);Fa.Fh=ea.Tm;F(Fa,X);Fa.hk=l.uuid;Fa.Lj=a.b4w_do_not_cull||l.b4w_dynamic_grass;"MAIN"==Fa.type&&(Fa.Gg=a.b4w_caustics);v(Fa,"DISABLE_FOG",("COLOR_ID"!=Wa&&"SHADOW"!=Wa&&a.b4w_disable_fogging)|0);"JITTERED"==l.b4w_hair_billboard_type&&(Fa.vv=l.b4w_hair_billboard_jitter_amp,Fa.wv=l.b4w_hair_billboard_jitter_freq);n&&(Fa.Su=l.b4w_dynamic_grass_scale_threshold);
Q||(delete Fa.Yc.a_bending_col_main,delete Fa.Yc.a_bending_col_detail);var ra=ea.tA(H,Y,Fa.Hj,b.wi,Fa.Yc,Fa.qj),pa=I.k.n,K=!0;if(1<t[z.name]){var P=0,O;for(O in ra.Z)P++;K=ra.ma.length*R.length*P*t[z.name]>2E5*M}var ma=ka.lF&&K&&"PHYSICS"!=Fa.type;if(ma){Fa.cJ=l.use_whole_group?2:1;var va=E.P(ra);ea.VF(ra,va,R);va.Ef={Oo:R,Uw:pa,YL:"STATIC"==b.type,os:r,rm:{},nu:n};if(X.nf&&X.ml){var Ga=za.fromValues(0,0,0);L.Vc(Ga,I.k.n,Ga);for(var ta=[],Ca=0;Ca<R.length;Ca++)ta.push(Ga[0],Ga[1],Ga[2]);va.Ef.rm.a_emitter_center=
{Fc:3,data:ta}}ea.VF(ra,ra,R);"STATIC"==b.type&&ea.LQ(va.Kf,pa)}else{var Ba=va=ea.eW(ra,r,R),Na=R;Ba.pa.au_center_pos=new Float32Array(3*Ba.Ja);for(var sa=Na.length,Ra=Ba.Ja/sa,Da=0;Da<sa;Da++)for(var jc=Na[Da],Pb=3*Ra*Da,Ob=0;Ob<Ra;Ob++)Ba.pa.au_center_pos[Pb+3*Ob]=jc[0],Ba.pa.au_center_pos[Pb+3*Ob+1]=jc[1],Ba.pa.au_center_pos[Pb+3*Ob+2]=jc[2];va=Ba;if(X.nf&&X.ml){var kc=va,Gc=I.k.n;kc.pa.a_emitter_center=new Float32Array(3*kc.Ja);var Ib=za.fromValues(0,0,0);L.Vc(Ib,Gc,Ib);for(var lc=0;lc<kc.Ja;lc++)kc.pa.a_emitter_center[3*
lc]=Ib[0],kc.pa.a_emitter_center[3*lc+1]=Ib[1],kc.pa.a_emitter_center[3*lc+2]=Ib[2];va=kc}}var qb=l.b4w_vcol_from_name,cb=l.b4w_vcol_to_name,$b=Fa,Yc=c,Cb=!Q,Qb=H,eb=[];if(""!==qb&&""!==cb){var pb,Hc=cb,mc=$b.Yc,Ic=[],Jb=void 0;for(Jb in mc)for(var nc=mc[Jb].src,ac=0,Za=0;Za<nc.length;Za++){var bc=nc[Za].eg;Hc==nc[Za].name&&Ic.push(Jb,bc,ac);ac+=E.vm(bc)}pb=Ic;if(0<pb.length)for(var Kb=0;Kb<pb.length;Kb+=3)eb.push({Eq:qb,pu:7,bw:pb[Kb],cw:pb[Kb+1],mu:pb[Kb+2]});else ea.YU($b.Hj,"a_color")&&cb==Qb.active_vcol_name&&
eb.push({Eq:qb,pu:7,bw:"a_color",cw:7,mu:0})}Cb&&("a_bending_col_main"in Yc&&eb.push({Eq:"a_bending_col_main",pu:4,bw:"a_bending_col_main",cw:4,mu:0}),"a_bending_col_detail"in Yc&&eb.push({Eq:"a_bending_col_detail",pu:7,bw:"a_bending_col_detail",cw:7,mu:0}));for(var rb=va,oc=R,tb=e,Lb=eb,Rb=Fa.Yc,uc=ma,Jc=!1,Ia=0;Ia<Lb.length;Ia++){var fc=Lb[Ia].Eq,Db=tb.pa[fc];if(Db&&0<Db.length){Jc=!0;break}}if(uc)var Eb=rb.Ef.rm;if(Jc){var Cc,Sb=I.k.O,ib=tb.Z[0].a_position,fb=oc,Ja=D,Wb=new Float32Array(3),Fb=
new Float32Array(3),Pa=new Uint32Array(fb.length);if(!("verts_indices"in Ja)){Ja.xi=new Float32Array(3);Ja.vi=new Float32Array(3);Ja.OD=new Uint32Array(ib.length/3);Ja.Br=new Uint32Array(ib.length/3);Ja.xi[0]=(Sb.max_x-Sb.min_x)/20;Ja.xi[1]=(Sb.max_y-Sb.min_y)/20;Ja.xi[2]=(Sb.max_z-Sb.min_z)/20;Ja.vi[0]=Sb.min_x;Ja.vi[1]=Sb.min_y;Ja.vi[2]=Sb.min_z;for(var Qa=0;Qa<ib.length/3;Qa++){var lb=E.trunc((ib[3*Qa]-Ja.vi[0])/Ja.xi[0]),Oc=E.trunc((ib[3*Qa+1]-Ja.vi[1])/Ja.xi[1]),Kc=E.trunc((ib[3*Qa+2]-Ja.vi[2])/
Ja.xi[2]),lb=E.V(lb,0,19),Oc=E.V(Oc,0,19),Kc=E.V(Kc,0,19);Ja.OD[Qa]=Qa;Ja.Br[Qa]=Kc*Math.pow(20,2)+20*Oc+lb}ea.yY(Ja.Br,Ja.OD,ea.Ny,!0);Ja.Lm=new Uint32Array(Math.pow(20,3));for(Qa=0;Qa<Ja.Br.length;Qa++)Ja.Lm[Ja.Br[Qa]]++;delete Ja.Br;for(Qa=1;Qa<Ja.Lm.length;Qa++)Ja.Lm[Qa]+=Ja.Lm[Qa-1]}for(var ub=0;ub<fb.length;ub++){Wb[0]=fb[ub][0];Wb[1]=fb[ub][1];Wb[2]=fb[ub][2];for(var Dc=1E10,Tb=-1,cc=E.trunc((Wb[0]-Ja.vi[0])/Ja.xi[0]),gd=E.trunc((Wb[1]-Ja.vi[1])/Ja.xi[1]),Zc=E.trunc((Wb[2]-Ja.vi[2])/Ja.xi[2]),
cc=E.V(cc,0,19),gd=E.V(gd,0,19),Zc=E.V(Zc,0,19),Sc=Zc*Math.pow(20,2)+20*gd+cc,$c=Ja.Lm[Sc],yb=0==Sc?0:Ja.Lm[Sc-1];yb<$c;yb++){var zb=Ja.OD[yb];Fb[0]=ib[3*zb];Fb[1]=ib[3*zb+1];Fb[2]=ib[3*zb+2];za.sub(Fb,Wb,Fb);var vc=za.sqrLen(Fb);vc<=Dc&&(Dc=vc,Tb=zb)}if(-1==Tb)for(yb=0;yb<ib.length/3;yb++)Fb[0]=ib[3*yb],Fb[1]=ib[3*yb+1],Fb[2]=ib[3*yb+2],za.sub(Fb,Wb,Fb),vc=za.sqrLen(Fb),vc<=Dc&&(Dc=vc,Tb=yb);Pa[ub]=Tb}Cc=Pa;for(var hd=rb.Ja/oc.length,Ia=0;Ia<Lb.length;Ia++){var Xa=Lb[Ia].bw,$a=Lb[Ia].cw,fc=Lb[Ia].Eq,
Ec=Lb[Ia].pu,Db=tb.pa[fc];switch(Xa){case "a_bending_col_main":var gc=1;break;case "a_bending_col_detail":gc=3;break;case "a_color":gc=3;break;default:for(var Mb=gc=0;Mb<Rb[Xa].src.length;Mb++)gc+=E.vm(Rb[Xa].src[Mb].eg)}if(Db&&0<Db.length){var wc=E.vm(Ec),yd=E.vm($a),Tc=Ec&$a,xc=E.LK(Tc);Tc!=$a&&ia.error("Wrong color extraction from "+fc+" to "+Xa+".");if(uc)for(Eb[Xa]={Fc:gc,data:[]},Mb=0;Mb<oc.length;Mb++)for(pc=Cc[Mb],Lc=pc*wc,Ub=0;Ub<xc.length;Ub++)xc[Ub]&&(Mc=E.ko(Ec,Ub),Eb[Xa].data.push(Db[Lc+
Mc]));else{if("a_bending_col_main"==Xa||"a_bending_col_detail"==Xa)rb.pa[Xa]=new Float32Array(rb.Ja*yd);for(Mb=0;Mb<oc.length;Mb++){var pc=Cc[Mb],Lc=pc*wc,Uc=Mb*hd*gc;if(-1!=pc)for(var hc=0;hc<hd;hc++)for(var qc=hc*gc,Ub=0;Ub<xc.length;Ub++)if(xc[Ub]){var Mc=E.ko(Ec,Ub);rb.pa[Xa][Uc+qc+(Lb[Ia].mu+E.ko($a,Ub))]=Db[Lc+Mc]}}}}else rb.pa[Xa]=new Float32Array(0)}}va=rb;v(Fa,"USE_INSTANCED_PARTCLS",va.Ef?1:0);ba(Fa);B.push({za:Fa,bf:b,Dt:X,Jf:va,fg:[z.name],Hd:[a]})}}for(Y=0;Y<la.length;Y++)la[Y]&&(la[Y].nn=
N[Y].id,ba(la[Y]))}}return B}function p(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=ja.iG(b));return c=c&&x(a,b)}function ba(a){J(a,function(a){a.id=0;a.id=E.$Q(a)})}function J(a,b){for(var c=null,e=null,d=[],g=0;g<a.ya.length;g++){var l=a.ya[g],f=l.Sf;f&&(c||(c={}),c[g]=f,l.Sf=null);if(f=l.Sa)e||(e={}),e[g]=f,l.Sa=null;d.push(l.gk);l.gk=0}var l=a.O,f=a.aa,w=a.wa,k=a.Ta,E=a.pb,u=a.kb;a.O=null;a.aa=null;a.wa=null;a.Ta=null;a.pb=null;a.kb=null;var h=a.He;a.He=null;b(a);a.He=h;a.O=l;a.aa=f;a.wa=w;a.Ta=k;
a.pb=E;a.kb=u;if(c)for(g in c)a.ya[g].Sf=c[g];if(e)for(g in e)a.ya[g].Sa=e[g];for(g=0;g<a.ya.length;g++)a.ya[g].gk=d[g]}function B(a,b,c,d){var g=m("DEBUG_VIEW");V(g,"debug_view.glslv","debug_view.glslf");g.Di=!0;g.Ua=!0;g.hk=b;g.fu=c;F(g,a);ba(g);if(d.Nf){c?(c=d.aa,L.ff(d.aa.G,sa)):(c=d.pb,L.ff(c.G,sa));var l=za.create();a=S.Au(1,l);b=za.fromValues(za.length(c.Ga),za.length(c.Ha),za.length(c.Ia));ea.QK(a,b,l);var l=za.normalize(c.Ga,Ga),f=za.normalize(c.Ha,Ca);c=za.normalize(c.Ia,ta);!b[0]&&b[1]&&
b[2]?za.cross(f,c,l):!b[1]&&b[0]&&b[2]?za.cross(c,l,f):!b[2]&&b[0]&&b[1]&&za.cross(l,f,c);b=E.qT(l,f,c,Ra);ca.invert(b,b);b=fa.fromMat3(b,Ba);L.zk(b,sa);L.Hf(1,sa);ea.Ww(a,sa)}else c?(b=d.wa,a=S.Au(b.Xa,b.G)):(b=d.kb,a=S.Au(b.Xa,za.create()),L.identity(sa),L.ff(b.G,sa),ea.Ww(a,sa));g.O=I.sl(d.O);g.aa=I.aq(d.aa);g.wa=I.tl(d.wa);g.Ta=I.sl(d.Ta);g.pb=I.aq(d.pb);g.kb=I.tl(d.kb);ea.Xw(a,1,!0);a.pa.a_polyindex=ea.su(a);e(g,a);return g}function V(a,b,c){a.hb.tg=b;a.hb.Te=c;X.HX(a.hb)}function U(a,b,c,e){e=
e||"";-1==a.Kd.indexOf(c)&&(a.ya.push(b),a.Kd.push(c),a.Eg.push(e),na.iv(b));a.yb&&xa.yF(a)}function Z(a){a.hb||E.q("No shaders info for batch "+a.name);a.yb=X.rU(a.hb);var b=a.hb;if(b.status===X.Py){var c=a.yb.attributes,e=a.Ba.kd,d;for(d in c)e[d]||E.q('missing data for "'+d+'" attribute')}b.status&X.CN&&ia.error("Texture limit exceeded for shader - "+b.Te+', materials: "'+a.sd.join(", ")+'". Maximum texture count: '+va.BB+", actual texture count: "+b.rM);b.status&X.BN&&ia.error("Fragment uniform limit exceeded for shader - "+
b.Te+', materials: "'+a.sd.join(", ")+'". Maximum fragment uniform count: '+va.Fv+", actual fragment uniform count: "+b.TT);b.status&X.FN&&ia.error("Vertex uniform limit exceeded for shader - "+b.tg+', materials: "'+a.sd.join(", ")+'". Maximum vertex uniform count: '+va.vr+", actual vertex uniform count: "+b.e_);b.status&X.EN&&ia.error("Vertex attribute limit exceeded for shader - "+b.tg+', materials: "'+a.sd.join(", ")+'". Maximum attribute count: '+va.CB+", actual attribute count: "+b.zF);b.status&
X.DN&&("MAIN"!=a.type||a.Tj||ia.error("Varying limit exceeded for shader - "+a.hb.Te+', materials: "'+a.sd.join(", ")+'"'),"MAIN"==a.type&&a.Tj||"NODES_GLOW"==a.type)&&(e=c=0,a.qj&&(c=E.Tq(a.qj)),a.Yc&&(e=E.Tq(a.Yc)),ia.error("Varying limit exceeded for node shader - "+a.hb.Te+", uv: "+c+", vc: "+e+', materials: "'+a.sd.join(", ")+'"'));b.status&X.xN&&ia.error("Shader compilation/linking error: "+b.tg+", "+b.Te+', materials: "'+a.sd.join(", ")+'"');return a.hb.status===X.Py?(xa.vQ(a.yb),xa.rQ(a),
xa.yF(a),!0):!1}function w(a,b,c){a=a.I[0].U;for(var e=0;e<a.length;e++)if(a[e].type==c&&!a[e].Zf&&-1!=a[e].sd.indexOf(b))return a[e];return null}function ga(a,b,c){a=a.I[0].U;for(var e=0;e<a.length;e++)if(a[e].type==c&&a[e].Zf&&-1!=a[e].sd.indexOf(b))return a[e];return null}function Q(a,b){a.Uf.set(b.Uf);a.Dl=b.Dl;a.Bm.set(b.Bm);a.yo=b.yo;a.Dk.set(b.Dk);a.Nj=b.Nj;a.xj=b.xj;a.Cl=b.Cl;a.el=b.el;a.ho=b.ho;a.Ii.set(b.Ii);a.$n=b.$n;a.oo.set(b.oo);a.po=b.po;a.qo.set(b.qo);a.ro=b.ro;a.xn=b.xn;a.Xo=b.Xo}
var I=r("__boundings"),Y=r("__config"),ia=r("__print"),u=r("__extensions"),aa=r("__graph"),ca=r("__mat3"),ja=r("__nodemat"),wa=r("__obj_util"),pa=r("__particles"),S=r("__primitives"),fa=r("__quat"),oa=r("__reformer"),xa=r("__renderer"),la=r("__scenegraph"),X=r("__shaders"),ya=r("__subscene"),na=r("__textures"),L=r("__tsr"),ea=r("__geometry"),E=r("__util"),za=r("__vec3"),ra=r("__vec4"),ka=Y.A,va=Y.zi,ma=Y.mo,Ka=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),Ga=new Float32Array(3),Ca=new Float32Array(3),
ta=new Float32Array(3),Ba=new Float32Array(4),sa=L.create(),Ra=ca.create();a.s_=Na;var Na="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Da={};a.AQ=function(a){return Da[a]||null};a.BQ=function(a,b){Da[a]=b};a.lU=function(a,d,g,l){var f;f=a.s.Wa;for(var w=[],k=0;k<d.length;k++){var u=d[k],h=u.nb,p=h.k;if(!h.hr){var n=wa.Ra(h),h=h.k,Q=u.data.b4w_boundings,v=Q.bs_rad,m=Q.bs_cen,S=Q.bc_rad,U=Q.caxis_x,X=Q.caxis_y,J=Q.caxis_z,C=Q.be_ax,y=Q.be_cen,aa=Q.rbb.rbb_c,ga=
Q.rbb.rbb_s,Q=I.sl(h.ll);h.Cg&&(v=Math.max(Math.abs(Q.max_x),Math.abs(Q.min_x)),m=Math.max(Math.abs(Q.max_y),Math.abs(Q.min_y)),ga=Math.max(Math.abs(Q.max_z),Math.abs(Q.min_z)),ga=Math.sqrt(v*v+m*m+ga*ga),S=Math.sqrt(v*v+m*m),Q.max_x=Q.max_y=Q.max_z=ga,Q.min_x=Q.min_y=Q.min_z=-ga,v=ga,m=[0,0,0],U=[1,0,0],X=[0,1,0],J=[0,0,1],C=[ga,ga,ga],y=[0,0,0],aa=[0,0,0],ga=[ga,ga,ga]);I.hn(Q,h.O);I.ql(h.O,h.n,h.Ta);h.wa=I.nz(v,E.yf(m));I.Pp(h.wa,h.n,h.kb);h.aa=n?I.Kp(U,X,J,y):I.Kp([1,0,0],[0,1,0],[0,0,1],y);za.scale(h.aa.Ga,
C[0],h.aa.Ga);za.scale(h.aa.Ha,C[1],h.aa.Ha);za.scale(h.aa.Ia,C[2],h.aa.Ia);I.Op(h.aa,h.n,h.pb);n?z(h,S,S,h.O):(h.yd=I.sX(aa,U,X,J,ga),I.kz(h.yd,h.n,h.FF));w.push.apply(w,t(u,p,f))}}f=q(w);for(w=0;w<f.length;w++)if(k=f[w].za,k.sd=f[w].fg,e(k,f[w].Jf),c(k,g,a),"STATIC"==f[w].k.type&&"COLOR_ID"!=k.type){if(u=E.qs("%meta%"+k.type+"%"+k.sd.join("%")+"%"),n=wa.oq(u,"MESH"),wa.qW(n,f[w].k),wa.Bp(n,a),wa.vt(n,a,k),l.push(n),"MAIN"==k.type)for(p=0;p<f[w].Hd.length;p++)u=f[w].Hd[p].nb,u.Iv.push(n)}else u=
f[w].Hd[0].nb,wa.vt(u,a,k);if(ka.debug_view){for(w=0;w<f.length;w++)if(g=f[w].k,"DYNAMIC"==g.type&&(u=f[w].Hd[0].nb,k=f[w].za,"MAIN"==k.type)){p=wa.ja(u,a);n=p.U;h=!1;for(p=0;p<n.length;p++)n[p].Di&&(h=!0);h||(g=B(g,u.name,!0,k),wa.vt(u,a,g))}for(w=0;w<l.length;w++)u=l[w],g=u.k,p=wa.ja(u,a),k=p.U[0],"MAIN"==k.type&&(g=B(g,u.name,!1,k),wa.vt(u,a,g));for(w=0;w<f.length;w++)k=f[w].za,"DEBUG_VIEW"==k.type&&(k.eu=w)}for(w=0;w<d.length;w++)for(p=wa.ja(d[w].nb,a),n=p.U,p=0;p<n.length;p++)b(n[p]);for(w=0;w<
l.length;w++)for(p=wa.ja(l[w],a),n=p.U,p=0;p<n.length;p++)b(n[p])};a.aQ=function(a,c,g){var l=a.s.Zo,f=m("MAIN");V(f,"sky.glslv","sky.glslf");if(c.procedural_skydome)v(f,"PROCEDURAL_SKYDOME",1),f.lu=!0;else{var w=l.xo,k=la.ec(a.s.Wa,ya.zg).p.pc;U(f,k,"u_sky");w&&(v(f,"WO_SKYTEX",1),w.invert&&v(f,"MTEX_NEGATIVE",1),w.YM&&v(f,"MTEX_RGBTOINT",1),v(f,"BLENDTYPE",w.PF),w.TM&&v(f,"WOMAP_BLEND",1),w.UM&&v(f,"WOMAP_HORIZ",1),w.WM&&v(f,"WOMAP_ZENUP",1),w.VM&&v(f,"WOMAP_ZENDOWN",1));l.zs&&v(f,"WO_SKYBLEND",
1);l.As&&v(f,"WO_SKYPAPER",1);l.Bs&&v(f,"WO_SKYREAL",1)}c.be&&(f.be=!0,c.Gd&&(f.Gd=!0));f.kg=99999;C(f,"a_position");c=S.hU();e(f,c);b(f);g=wa.ja(g,a);f.Lj=!0;f.aa=I.Hg();f.pb=I.Hg();f.O=I.Pd();f.Ta=I.Pd();f.wa=I.Dh();f.kb=I.Dh();ba(f);g.U.push(f);la.ec(a.s.Wa,ya.rf)&&(a=d(f),a.type="DEBUG_VIEW",a.Db="",M(a),v(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.pa.a_polyindex=ea.su(c),e(a,c),a.nn=f.id,ba(a),g.U.push(a))};a.Pz=function(a,b,c){c=wa.ja(a,c).U;var e=[];la.ec(b,ya.cd);var g=la.ec(b,ya.Md),f=la.ec(b,ya.md),
l=la.ec(b,ya.yg);b=la.ec(b,ya.pf);for(var w=0;w<c.length;w++){var k=c[w],E=null;"SHADOW"==k.type&&"RECEIVE"==k.Db&&k.Ce&&(E=d(k),E.Db="CAST");"MAIN"!=k.type&&"PARTICLES"!=k.type||!g&&!f||!k.be||(E=d(k),E.Db="REFLECT",E.qk=!1,E.of&&(E.of=!1,E.Ua=!1),E.gb=k.gb);"COLOR_ID"==k.type&&l&&a.k.Tc&&(b&&a.k.vk?(E=d(k),E.Db="OUTLINE"):k.Db="OUTLINE");E&&(E.Zf=!0,ba(E),e.push(E))}c.push.apply(c,e)};a.SX=z;a.p_=function(a,b,c){b?b=c*(b.max_z-b.min_z):(b=1,E.q("No bounding box for mesh"));if(0==b)return 0;a=b*
Math.tan(E.Kb(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.CQ=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.oZ=K;a.nZ=c;a.PX=l;a.xF=function(a,b){v(a,"CSM_SECTION1",0);v(a,"CSM_SECTION2",0);v(a,"CSM_SECTION3",0);v(a,"NUM_CAST_LAMPS",0);if(b){v(a,"NUM_CAST_LAMPS",b.Wg.length);ka.Dv&&v(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)v(a,"CSM_SECTION"+String(c),1);v(a,"SHADOW_TEX_RES",X.M(b.csm_resolution));v(a,"CSM_FADE_LAST_CASCADE",
b.fade_last_cascade?1:0);v(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else v(a,"SHADOW_TEX_RES",0),v(a,"CSM_FADE_LAST_CASCADE",0),v(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.ef=v;a.EA=function(a,b){return X.wU(a.hb,b)};a.lZ=e;a.mZ=ba;a.yt=V;a.zj=U;a.mX=function(a,b,c){c=a.Kd.indexOf(c);-1<c&&(a.ya[c]=b)};a.oS=function(a,b){var c=m("MAIN");c.Jb=!0;ra.set(b[0],b[1],b[2],.5,c.Uf);c.Fh=ea.dp;e(c,a);V(c,"main.glslv","main_stack.glslf");v(c,"SHADELESS",1);Z(c);return c};a.Wc=Z;a.kU=function(a,
c){for(var d=0;d<c.length;d++){var g=c[d].nb,f=m("LINE");V(f,"line.glslv","line.glslf");f.Jb=!0;f.Lj=!0;var l=S.jU();e(f,l);b(f);f.O=I.Pd();f.Ta=I.Pd();f.aa=I.Hg();f.pb=I.Hg();f.kb=I.Dh();f.wa=I.Dh();wa.Bp(g,a);wa.ja(g,a).U.push(f);Z(f)}};a.jR=function(a){return a.yb.Gr.length?a.yb.bC.u_cube_fog?!0:!1:!1};a.YR=function(){var a=m("DEPTH_PACK");a.Xb=!0;a.Ua=!1;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");Z(a);return a};a.Sz=function(a){var b=m("POSTPROCESSING");
V(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":v(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":v(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":v(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":v(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":v(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":v(b,"POST_EFFECT",
"POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":v(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":v(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:E.q("Wrong postprocessing effect: "+a)}b.Xb=!0;b.Ua=!1;a=S.Qc();e(b,a);Z(b);return b};a.rS=function(a){var b=m("SSAO");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");v(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.XL);v(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:
0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=na.zl(na.th,!1);c.source="NODE_TEX";na.ss(c,a,0);U(b,c,"u_ssao_special_tex");Z(b);return b};a.sS=function(a){var b=m("SSAO_BLUR");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");v(b,"SSAO_BLUR_DEPTH",
a.ssao_blur_depth?1:0);Z(b);return b};a.VR=function(a){var b=m("COC");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");v(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":v(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":v(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":v(b,"COC_TYPE","COC_COMBINE")}Z(b);return b};a.ZR=function(a){var b=m("DOF");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.p.dof_bokeh?v(b,"DOF_TYPE","DOF_BOKEH"):(v(b,"DOF_TYPE","DOF_SIMPLE"),v(b,"DEPTH_RGBA",1));Z(b);return b};a.hS=function(){var a=m("OUTLINE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");Z(a);return a};a.aS=function(){var a=m("GLOW_COMBINE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");Z(a);return a};a.bS=function(a,b,c){var d=m("GOD_RAYS");d.Ua=!1;d.Xb=!0;var g=S.bU();e(d,
g);V(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");v(d,"DEPTH_RGBA",a?1:0);v(d,"WATER_EFFECTS",b?1:0);v(d,"STEPS_PER_PASS",X.M(c,1));Z(d);return d};a.cS=function(){var a=m("GOD_RAYS_COM");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");v(a,"SAFARI_CANVAS_ALPHA_HACK",ka.OK?1:0);Z(a);return a};a.XR=function(a,b){var c=m("SKY");c.Ua=!1;c.Xb=!0;var d=S.dU();e(c,d);if(b.procedural_skydome)V(c,"skybox.glslv","proc_skybox.glslf"),
v(c,"WATER_EFFECTS",1);else{V(c,"skybox.glslv","tex_skybox.glslf");if(a){d=a.s.Zo;if(d.Pw){var g=d.Pw.texture,f=na.fe(d.Pw);U(c,f,"u_sky_texture",g.name)}d.xo&&v(c,"WO_SKYTEX",1)}b.ML&&v(c,"MTEX_NEGATIVE",1);b.RL&&v(c,"MTEX_RGBTOINT",1);v(c,"BLENDTYPE",b.LL);b.NL&&v(c,"WOMAP_BLEND",1);b.OL&&v(c,"WOMAP_HORIZ",1);b.QL&&v(c,"WOMAP_ZENUP",1);b.PL&&v(c,"WOMAP_ZENDOWN",1);b.zs&&v(c,"WO_SKYBLEND",1);b.As&&v(c,"WO_SKYPAPER",1);b.Bs&&v(c,"WO_SKYREAL",1)}c.aa=I.Hg();c.pb=I.Hg();c.O=I.Pd();c.Ta=I.Pd();c.wa=
I.Dh();c.kb=I.Dh();Z(c);return c};a.TP=function(a,b){var c=la.ec(a.s.Wa,ya.zg);c&&(c=c.Qa[0].ra[0].za,wa.ja(b,a).U.push(c))};a.QR=function(a){var b=m("ANTIALIASING");b.Ua=!1;b.Xb=!0;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ka.vK?(v(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),v(b,"AA_QUALITY",a.CH)):v(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");Z(b);return b};a.pS=function(a){var b=m("SMAA"),c=S.Qc();e(b,c);V(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");
v(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");v(b,"SMAA_PASS",a);v(b,"SMAA_PREDICATION",0);v(b,"SMAA_REPROJECTION",0);Z(b);b.Ua=!1;b.Xb=!0;return b};a.WR=function(){var a=m("COMPOSITING");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");Z(a);return a};a.gS=function(){var a=m("MOTION_BLUR");a.Xb=!0;a.Ua=!1;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");Z(a);return a};a.tS=function(a){var b=
m("STEREO");b.Xb=!0;b.Ua=!1;var c=S.Qc();e(b,c);V(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");v(b,"ANAGLYPH","ANAGLYPH"===a?1:0);Z(b);return b};a.dS=function(){var a=m("LUMINANCE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");Z(a);return a};a.RR=function(){var a=m("LUMINANCE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");Z(a);return a};
a.eS=function(){var a=m("LUMINANCE_X_BLUR");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");Z(a);return a};a.TR=function(){var a=m("POSTPROCESSING");a.Xb=!0;a.Ua=!1;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");Z(a);return a};a.UR=function(){var a=m("BLOOM");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
Z(a);return a};a.RS=function(){var a=m("VELOCITY");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");Z(a);return a};a.PR=function(){var a=m("ANCHOR_VISIBILITY");a.Ua=!0;a.Xb=!0;a.Fh=ea.dp;V(a,"anchors.glslv","anchors.glslf");var b=S.IH(1);e(a,b);v(a,"ANCHOR_NUM",1);Z(a);a.fl=new Float32Array(3);return a};a.iS=function(){var a=m("PERFORMANCE");a.Ua=!1;a.Xb=!0;var b=S.Qc();e(a,b);V(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
Z(a);return a};a.kZ=function(a,b){var c=b.length/3;if(c!=a.fl.length/3){var d=S.IH(c);e(a,d);v(a,"ANCHOR_NUM",c);Z(a)}a.fl=b};a.V3=function(a){if(!a.I.length)return null;a=a.I[0];return a.U.length?a.U[0]:null};a.LT=w;a.j3=ga;a.p7=Q;a.S1=function(a,b){for(var c=a.I[0].U,e=0;e<c.length;e++)if(c[e].type==b)return!0;return!1};a.qG=function(a){for(var b=a.ya,c=0;c<b.length;c++)na.pC(b[c]);a.Ba.Tf&&ea.DR(a.Ba);a.Tf&&a.He.length&&xa.GR(a);a.yb.Tf&&X.FR(a.yb);a.fk&&(b=ja.lI(a.fk))&&b.pG&&ja.ER(a.fk)};a.hV=
function(a,b,c,e){for(var d=["MAIN","SHADOW","COLOR_ID"],g=!1,f=0;f<d.length;f++){var l=d[f],k=w(a,b,l),E=w(c,e,l);if(k&&E){var g=!0,u=ga(c,e,l);"MAIN"==l&&(Q(E,k),u&&Q(u,k));for(l=0;l<E.Kd.length;l++){var h=E.Kd[l];if(-1!==Na.indexOf(h)){var p=k.Kd.indexOf(h);-1!==p&&(p=k.ya[p],na.pC(E.ya[l]),E.ya[l]=p,na.iv(p),u&&(h=u.Kd.indexOf(h),-1!==h&&(na.pC(u.ya[h]),u.ya[h]=p,na.iv(p))))}}}}g||ia.error("Wrong objects for inheriting material!")};a.VX=function(a,b,c,e){for(var d=0;d<a.I.length;d++)for(var g=
a.I[d].U,f=0;f<g.length;f++){var l=g[f];-1!=l.sd.indexOf(b)&&l.Yi&&(l.Yi[c]=e)}};a.UX=function(a,b,c,e,d,g){for(var f=0;f<a.I.length;f++)for(var l=a.I[f].U,w=0;w<l.length;w++){var k=l[w];-1!=k.sd.indexOf(b)&&k.ze&&(k.ze[3*c]=e,k.ze[3*c+1]=d,k.ze[3*c+2]=g)}};a.j4=function(a,b){return a.Yi[b]};a.i4=function(a,b,c){c[0]=a.ze[3*b];c[1]=a.ze[3*b+1];c[2]=a.ze[3*b+2];return c};a.mI=function(a,b){var c;c=b[1];for(var e=2;e<b.length;e++)c+="%join%"+b[e];for(e=0;e<a.length;e+=2)if(a[e]==c)return a[e+1];return null};
a.sa=function(){Da={}}};b4w.module.__extensions=function(a,r){function m(a){if(a in n)return n[a];var b=z.getExtension(a)||null;n[a]=b;t.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function d(a){if(a in n)return n[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=z;break;case "EXT_disjoint_timer_query":(b=z.getExtension("EXT_disjoint_timer_query")||null)||(b=z.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}n[a]=b;t.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=r("__config"),t=r("__print"),q=b.A,z=null,n={};a.If=function(a){z=a};a.uI=function(){return m("WEBGL_compressed_texture_s3tc")||m("WEBKIT_WEBGL_compressed_texture_s3tc")||m("MOZ_WEBGL_compressed_texture_s3tc")};a.qI=function(){return m("WEBKIT_WEBGL_compressed_texture_pvrtc")||m("WEBGL_compressed_texture_pvrtc")};a.vU=function(){return q.cc?d("WEBGL_depth_texture"):m("WEBGL_depth_texture")||m("WEBKIT_WEBGL_depth_texture")||
m("MOZ_WEBGL_depth_texture")};a.QH=function(){return m("EXT_texture_filter_anisotropic")||m("WEBKIT_EXT_texture_filter_anisotropic")||m("MOZ_EXT_texture_filter_anisotropic")};a.uU=function(){return m("WEBGL_debug_shaders")};a.Ku=function(){return m("WEBGL_debug_renderer_info")};a.$H=function(){return q.cc?d("OES_element_index_uint"):m("OES_element_index_uint")};a.PA=function(){return q.cc?d("OES_standard_derivatives"):m("OES_standard_derivatives")};a.HA=function(){var a=q.cc?d("EXT_disjoint_timer_query"):
m("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},LH:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},MH:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},KH:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return z.createQuery()},beginQuery:function(b){z.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){z.endQuery(a.TIME_ELAPSED_EXT)},LH:function(a){return z.getQueryParameter(a,z.QUERY_RESULT_AVAILABLE)},MH:function(a){return z.getQueryParameter(a,z.QUERY_RESULT)},KH:function(){return a.GPU_DISJOINT_EXT}}};a.LU=function(){if(q.cc)return d("ANGLE_instanced_arrays");var a=m("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,d,f,n,g){a.drawElementsInstancedANGLE(b,d,f,n,g)},vertexAttribDivisor:function(b,d){a.vertexAttribDivisorANGLE(b,d)},drawArraysInstanced:function(b,
d,f,n){a.drawArraysInstancedANGLE(b,d,f,n)}}};a.QA=function(){if(q.cc)return d("OES_vertex_array_object");var a=m("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.sa=function(){n={}};a.reset=function(){z=null}};b4w.module.__graph=function(a,r){function m(a,b,c){c||(c=null);d(a,b)?R.q("Graph already has node with given ID"):a.X.push(b,c)}function d(a,b){for(var c=a.X,e=0;e<c.length;e+=2)if(c[e]==b)return!0;return!1}function b(a,b,c,e){e||(e=null);d(a,b)&&d(a,c)?a.Pa.push(b,c,e):R.q("Wrong node IDs")}function t(a,b){d(a,b)||R.q("Node not found");for(var c=a.X,e=0;e<c.length;e+=2)c[e]==b&&(c.splice(e,2),e-=2)}function q(a,b,c,e){l(a,b,c)||R.q("Edge not found");a=a.Pa;for(var d=0,g=0;g<a.length;g+=3)if(a[g]==
b&&a[g+1]==c){if(-1==e)a.splice(g,3);else{if(e==d){a.splice(g,3);break}d++}g-=3}}function z(a){a=a.X;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function n(a,b){for(var c=a.X,e=0;e<c.length;e+=2)if(c[e+1]==b)return c[e];return-1}function x(a){var b=[],c={};h(a,c);for(var e=a.X,d=0;d<e.length;d+=2)0==M(a,e[d])&&k(a,e[d],c,b);return{X:b,Pa:a.Pa.slice(0)}}function h(a,b){for(var c=a.X,e=0;e<c.length;e+=2)b[c[e]]=!1}function k(a,b,c,e){if(!c[b]){c[b]=!0;for(var d=0;d<K(a,b);d++)k(a,
F(a,b,d),c,e);e.unshift(b,P(a,b))}}function f(a,b,e,d){if(!e[b]){e[b]=!0;if(10==d||30==d)for(var g=0;g<K(a,b);g++){var l=F(a,b,g);f(a,l,e,d)}if(20==d||30==d)for(g=0;g<M(a,b);g++)l=c(a,b,g),f(a,l,e,d)}}function y(a){for(var b=a.Pa,c=0;c<b.length;c+=3){var e=b[c+1];d(a,b[c])&&d(a,e)||(b.splice(c,3),c-=3)}}function g(a){for(var b=[],c=a.X,e=0;e<c.length;e+=2){var d=c[e];K(a,d)||b.push(d)}return b}function A(a){var b=a.X;a=a.Pa;for(var c=[],e=[],d=[],g=0;g<b.length;g++)d[b[2*g]]=g,c.push(g,b[2*g+1]);
for(g=0;g<a.length;g+=3)e.push(d[a[g]],d[a[g+1]],a[g+2]);return{X:c,Pa:e}}function N(a,b,e){if(e.Ch==e.ek){for(var d=0,g=0;d<e.ek;d++)-1!=e.Ai[d]&&(a[g]=d,b[g]=e.Ai[d],g++);return!0}if(e.ek>e.Wn||e.Fk>e.Gk||e.Io>e.Ko||e.Ho>e.Jo)return!1;for(var g=d=-1,f=!1;!f&&H(e,p,d,g);)if(d=p[0],g=p[1],O(e,d,g)){var l;l=e;f={};f.Pq=l.Pq;f.Qq=l.Qq;f.QB=l.QB;f.ou=l.ou;f.ek=l.ek;f.Wn=l.Wn;f.ik=l.ik;f.Ch=f.Vv=l.Ch;f.Ho=l.Ho;f.Io=l.Io;f.Fk=l.Fk;f.Jo=l.Jo;f.Ko=l.Ko;f.Gk=l.Gk;f.wp=-1;f.Ai=l.Ai;f.wl=l.wl;f.Wl=l.Wl;f.Xl=
l.Xl;f.nm=l.nm;f.om=l.om;f.Gw=l.Gw;l.Gw[0]+=1;var f=l=f,k=d,h=g,I=f.Pq,n=f.Qq,v=f.ek,u=f.Wn,m=f.Ai,C=f.wl,y=f.Wl,q=f.Xl,R=f.nm,S=f.om;D(k<v);D(h<u);D(f.Ch<v);D(f.Ch<u);v=++f.Ch;f.wp=k;y[k]||(y[k]=v,f.Ho++,R[k]&&f.Fk++);R[k]||(R[k]=v,f.Io++,y[k]&&f.Fk++);q[h]||(q[h]=v,f.Jo++,S[h]&&f.Gk++);S[h]||(S[h]=v,f.Ko++,q[h]&&f.Gk++);m[k]=h;C[h]=k;for(m=0;m<M(I,k);m++)C=c(I,k,m),y[C]||(y[C]=v,f.Ho++,R[C]&&f.Fk++);for(m=0;m<K(I,k);m++)C=F(I,k,m),R[C]||(R[C]=v,f.Io++,y[C]&&f.Fk++);for(m=0;m<M(n,h);m++)C=c(n,h,
m),q[C]||(q[C]=v,f.Jo++,S[C]&&f.Gk++);for(m=0;m<K(n,h);m++)C=F(n,h,m),S[C]||(S[C]=v,f.Ko++,q[C]&&f.Gk++);f=N(a,b,l);D(1>=l.Ch-l.Vv);D(-1!=l.wp);C=l.Pq;k=l.Qq;h=l.Ch;I=l.wp;n=l.Ai;y=l.wl;v=l.Wl;q=l.Xl;u=l.nm;R=l.om;if(l.Vv<h){v[I]==h&&(v[I]=0);for(S=0;S<M(C,I);S++)m=c(C,I,S),v[m]==h&&(v[m]=0);u[I]==h&&(u[I]=0);for(S=0;S<K(C,I);S++)m=F(C,I,S),u[m]==h&&(u[m]=0);C=n[I];q[C]==h&&(q[C]=0);for(S=0;S<M(k,C);S++)m=c(k,C,S),q[m]==h&&(q[m]=0);R[C]==h&&(R[C]=0);for(S=0;S<K(k,C);S++)m=F(k,C,S),R[m]==h&&(R[m]=
0);n[I]=-1;y[C]=-1;l.Ch=l.Vv;l.wp=-1}}return f}function H(a,b,c,e){-1==c&&(c=0);-1==e?e=0:e++;var d=a.Fk,g=a.Gk,f=a.Io,l=a.Ko,k=a.Ho,h=a.Jo,p=a.Ch,n=a.ek,u=a.Wn,v=a.Ai,m=a.wl,C=a.Wl,y=a.Xl,q=a.nm,S=a.om;if(d>p&&g>p)for(;c<n&&(-1!=v[c]||0==q[c]||0==C[c]);)c++,e=0;else if(f>p&&l>p)for(;c<n&&(-1!=v[c]||0==q[c]);)c++,e=0;else if(k>p&&h>p)for(;c<n&&(-1!=v[c]||0==C[c]);)c++,e=0;else if(0==c&&0!=a.ik){for(C=0;C<n&&-1!=v[c=a.ik[C]];)C++;C==n&&(c=n)}else for(;c<n&&-1!=v[c];)c++,e=0;if(d>p&&g>p)for(;e<u&&(-1!=
m[e]||0==S[e]||0==y[e]);)e++;else if(f>p&&l>p)for(;e<u&&(-1!=m[e]||0==S[e]);)e++;else if(k>p&&h>p)for(;e<u&&(-1!=m[e]||0==y[e]);)e++;else for(;e<u&&-1!=m[e];)e++;return c<n&&e<u?(b[0]=c,b[1]=e,!0):!1}function O(a,b,e){var d=a.Pq,g=a.Qq,f=a.Wn,k=a.Ai,h=a.wl,p=a.Wl,I=a.Xl,n=a.nm,v=a.om;D(b<a.ek);D(e<f);D(-1==k[b]);D(-1==h[e]);if(!(0,a.QB)(P(d,b),P(g,e)))return!1;for(var u=f=0,m=0,y=0,q=0,R=0,A=0;A<K(d,b);A++){var S=F(d,b,A);if(-1!=k[S]){var fa=k[S];if(!l(g,e,fa)||!C(a.ou,d,b,S,g,e,fa))return!1}else p[S]&&
m++,n[S]&&f++,p[S]||n[S]||q++}for(A=0;A<M(d,b);A++)if(S=c(d,b,A),-1!=k[S]){if(fa=k[S],!l(g,fa,e)||!C(a.ou,d,S,b,g,fa,e))return!1}else p[S]&&m++,n[S]&&f++,p[S]||n[S]||q++;for(A=0;A<K(g,e);A++)if(fa=F(g,e,A),-1!=h[fa]){if(S=h[fa],!l(d,b,S))return!1}else I[fa]&&y++,v[fa]&&u++,I[fa]||v[fa]||R++;for(A=0;A<M(g,e);A++)if(fa=c(g,e,A),-1!=h[fa]){if(S=h[fa],!l(d,S,b))return!1}else I[fa]&&y++,v[fa]&&u++,I[fa]||v[fa]||R++;return m<=y&&f<=u&&q<=R}function D(a){a||R.q("Assertion failed")}function P(a,b){for(var c=
a.X,e=0;e<c.length;e+=2)if(c[e]==b)return c[e+1];return null}function K(a,b){for(var c=a.Pa,e=0,d=0;d<c.length;d+=3)c[d]==b&&e++;return e}function M(a,b){for(var c=a.Pa,e=0,d=0;d<c.length;d+=3)c[d+1]==b&&e++;return e}function F(a,b,c){a=a.Pa;for(var e=0,d=0;d<a.length;d+=3)if(a[d]==b){if(e==c)return a[d+1];e++}return-1}function c(a,b,c){a=a.Pa;for(var e=0,d=0;d<a.length;d+=3)if(a[d+1]==b){if(e==c)return a[d];e++}return-1}function l(a,b,c){a=a.Pa;for(var e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c)return!0;
return!1}function C(a,b,c,d,g,f,l){for(var k=v(b,c,d),h=v(g,f,l),p=0;p<k;p++){for(var n=!1,m=0;m<h;m++)if(a(e(b,c,d,p),e(g,f,l,m))){n=!0;break}if(!n)return!1}return!0}function v(a,b,c){var e=0;a=a.Pa;for(var d=0;d<a.length;d+=3)a[d]==b&&a[d+1]==c&&e++;return e}function e(a,b,c,e){a=a.Pa;for(var d=0,g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==c){if(d==e)return a[g+2];d++}return null}r("__print");var R=r("__util"),p=[-1,-1];a.Iy=-1;a.L_=10;a.Ms=20;a.X0=30;a.create=function(){for(var a=arguments,b=[],c=
[],e=0;e<a.length;e++){var d=a[e];switch(d.length){case 2:b.push(d[0],d[1]);break;case 3:c.push(d[0],d[1],d[2]);break;default:R.q("Wrong graph constructor params")}}return{X:b,Pa:c}};a.clone=function(a,b,c){if(b)for(var e=Array(a.X.length),d=0;d<a.X.length;d+=2)e[d]=a.X[d],e[d+1]=b(a.X[d+1]);else e=R.P(a.X);if(c)for(b=Array(a.Pa.length),d=0;d<a.Pa.length;d+=3)b[d]=a.Pa[d],b[d+1]=a.Pa[d+1],b[d+2]=c(a.Pa[d+2]);else b=R.P(a.Pa);return a={X:e,Pa:b}};a.w2=function(a,b){for(var c=[],e=[],d=0;d<a.length;d++)c.push(a[d][0],
a[d][1]);for(d=0;d<b.length;d++)e.push(b[d][0],b[d][1],b[d][2]);return{X:c,Pa:e}};a.yj=m;a.l5=d;a.ed=b;a.pg=t;a.rk=q;a.io=function(a,b,c,e){l(a,b,c)||R.q("Edge not found");a=a.Pa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c&&a[d+2][0]==e[0]&&a[d+2][1]==e[1]){a.splice(d,3);break}};a.J=function(a,b){if(-1==n(a,b)){var c=z(a);m(a,c,b);return c}R.q("Non-unique attribute")};a.lX=function(a,b,c,e,d){a=a.Pa;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&a[g+2]==e&&(a[g+2]=d)};a.gQ=function(a,c,e){var d;
e=e||[];d=d||[];for(var g={},f=0;f<a.X.length;f+=2){var l=a.X[f],k=a.X[f+1],h=z(c);m(c,h,k);g[l]=h}for(f=0;f<a.Pa.length;f+=3)k=g[a.Pa[f]],h=g[a.Pa[f+1]],l=a.Pa[f+2],b(c,k,h,l);for(f=0;f<e.length;f+=3)k=g[e[f]],a=e[f+1],l=e[f+2],b(c,k,a,l);for(f=0;f<d.length;f+=3)e=d[f],h=g[d[f+1]],l=d[f+2],b(c,e,h,l)};a.Pl=z;a.ah=n;a.r=function(a,c,e,d){c=n(a,c);e=n(a,e);-1!=c&&-1!=e?b(a,c,e,d):R.q("Attributes not found")};a.oa=function(a,b){for(var c=a.X,e=0;e<c.length&&!b(c[e],c[e+1]);e+=2);};a.sg=function(a,b){for(var c=
a.Pa,e=0;e<c.length&&!b(c[e],c[e+1],c[e+2]);e+=3);};a.fi=function(a,b,c){for(var e=a.Pa,d=0;d<e.length;d+=3)if(e[d+1]==b){var g=e[d];if(c(g,P(a,g),e[d+2]))break}};a.Ik=function(a,b,c){for(var e=a.Pa,d=0;d<e.length;d+=3)if(e[d]==b){var g=e[d+1];if(c(g,P(a,g),e[d+2]))break}};a.uD=x;a.ZY=function(a){a=x(a).X;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.F5=function(){};a.Vw=function(a,b,c){d(a,b)||R.q("No such node");var e={};h(a,e);f(a,b,e,c);b=[];for(var g in e)e[g]&&(g=Number(g),b.push(g,
P(a,g)));a={X:b,Pa:a.Pa.slice(0)};y(a);return a};a.yz=y;a.PU=function(a){for(var b=[],c=a.X,e=0;e<c.length;e+=2){var d=c[e];M(a,d)||b.push(d)}return b};a.Vq=g;a.match=function(a,b,c,e){var d={};d.Pq=A(a);d.Qq=A(b);d.QB=c||function(a,b){return a==b};d.ou=e||function(a,b){return a==b};e=a.X.length/2;var g=b.X.length/2;d.ek=e;d.Wn=g;d.ik=0;d.Ch=d.Vv=0;d.Fk=d.Ho=d.Io=0;d.Gk=d.Jo=d.Ko=0;d.wp=-1;d.Ai=Array(e);d.wl=Array(g);d.Wl=Array(e);d.Xl=Array(g);d.nm=Array(e);d.om=Array(g);d.Gw=[1];for(c=0;c<e;c++)d.Ai[c]=
-1,d.Wl[c]=0,d.nm[c]=0;for(c=0;c<g;c++)d.wl[c]=-1,d.Xl[c]=0,d.om[c]=0;g=Array(e);e=Array(e);if(N(g,e,d)){for(c=0;c<g.length;c++)g[c]=a.X[2*g[c]],e[c]=b.X[2*e[c]];return[g,e]}return null};a.MU=function(a,b){for(var c=a.X,e=1;e<c.length;e+=2)if(c[e]==b)return c[e-1];return null};a.Va=P;a.mg=K;a.In=M;a.Sg=F;a.Li=c;a.M3=v;a.Vd=e;a.replace=function(a,b,c){for(var e=a.Pa,d=z(a),g=0;g<b.length;g++){var f=b[g];t(a,f);for(var l=0;l<e.length;l+=3)e[l]==f&&(e[l]=d),e[l+1]==f&&(e[l+1]=d),e[l]==e[l+1]&&(e.splice(l,
3),l-=3)}m(a,d,c)};a.bX=function(a,b,c,e,d){l(a,b,c)||R.q("Edge not found");a=a.Pa;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&(a[g]=e,a[g+1]=d)};a.vT=function(a,b){function c(a,b){if(-1!=k.indexOf(a)){var e=k.slice(k.indexOf(a));if(-1!=d[e[e.length-1]].indexOf(e[0])){h.push([a,e[e.length-1]]);return}}k.push(a);for(e=0;e<b.length;e++)b[e]in d&&c(b[e],d[b[e]])}b||(b=g(a)[0]);var e=a.Pa;if(e.length&&-1!=e.indexOf(b)){for(var d={},f=0,l=0;l<e.length;l+=3)e[l+1]in d?d[e[l+1]].push(e[l]):d[e[l+1]]=
[e[l]],f++;var k=[],h=[];c(b,d[b]);for(l=0;l<h.length;l++)for(var p=f=0;p<e.length;p+=3)h[l][1]==e[p+1]&&h[l][0]==e[p]&&q(a,e[p],e[p+1],f),f++}};a.ZS=function(a,b,c){var e=a.X;a=a.Pa;var d;d="digraph debug {\n    node [shape=box];\n";for(var g=0;g<e.length;g+=2){var f=e[g],l=e[g+1],l=b?b(f,l):String(f);d+="    ";d+=String(f)+' [label="'+l.replace(/\"/g,'\\"')+'"];\n'}for(g=0;g<a.length;g+=3)b=a[g],e=a[g+1],l=a[g+2],d+="    ",d+=String(b)+" -> "+String(e),c&&(d+=' [label="'+c(b,e,l)+'"]'),d+=";\n";
return d+="}"}};b4w.module.__nodemat=function(a,r){function m(a,b,c,e,f){var l=Ka.B(),l=n(b,f,l.uuid);if(l in sa)return sa[l];var w={Wa:null,id:l,pG:!0};c||(Na={},Da=0);if("SHADOW"!=f&&"COLOR_ID"!=f){b=E.create();for(var u=a.nodes,p=0;p<u.length;p++)if(null==ba(b,u[p],0,e,f))return sa[l]=null,w;if(c&&-1==R(a,b,"GROUP_OUTPUT","group"))return w;p=S(b);u=c?a.links:a.links.slice();if(!fa(b,u,p))return w;if(c)return w.Wa=b,w;for(p=0;p<u.length;p++){c=u[p];for(var I=A(c.from_node,b),G=A(c.to_node,b),Q=0;Q<I.length;Q++)for(var v=
0;v<G.length;v++){var X=I[Q],B=G[v],aa=E.Va(b,X),ga=E.Va(b,B);if(!wa(b,X,B,aa,ga,c))return sa[l]=null,w}}g(b);"GLOW"==f?p=R(a,b,"B4W_GLOW_OUTPUT","material",!0):(p=R(a,b,"OUTPUT","material",!1,!0),-1==p&&(p=R(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==p&&(b=h(),p=0);N(b);a=E.Vw(b,p,E.Ms);d(a,e);q(a,e);k(a);O(a);C(a);y(a,e,f);na(a)}else e=m(a,b,c,e,"MAIN"),e=E.clone(e.Wa,function(a){var b=Ga.bq(a);b.L=Ga.P(a.L);b.fb=Ga.P(a.fb);return b}),p=R(a,e,"OUTPUT","material",!1,!0),-1==p&&(p=R(a,e,"OUTPUT_MATERIAL",
"material",!1,!0)),x(e,p),a=E.Vw(e,p,E.Ms),k(a);w.Wa=a;return sa[l]=w}function d(a,c){var e=[];E.oa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||e.push({zr:a,node:b})});for(var d=0;d<e.length;++d){var g=e[d].zr,f=e[d].node,l=E.Pl(a);E.yj(a,l,f.data.iW);var k=E.Pl(a);E.yj(a,k,f.data.jW);E.ed(a,l,k,[4,2]);for(var w={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},u=E.In(a,g),p=[],h=[],I=[],n={},G=0;G<u;G++){var Q=E.Li(a,g,
G);Q in n||(n[Q]=0);var v=E.Vd(a,Q,g,n[Q]++);p.push([Q,g,v]);var m=w[v[1]];if(m)switch(m[0]){case "MATERIAL_END":h.push([Q,k,[v[0],m[1]]]);break;case "LIGHTING_APPLY":I.push([Q,[v[0],m[1]]])}else h.push([Q,l,v])}b(a,f.data.value,l,k,I,c);for(G=0;G<p.length;G++)E.io(a,p[G][0],p[G][1],p[G][2]);for(G=0;G<h.length;G++)E.ed(a,h[G][0],h[G][1],h[G][2]);f=E.mg(a,g);l=[];w=[];u={};for(G=0;G<f;G++)p=E.Sg(a,g,G),p in u||(u[p]=0),v=E.Vd(a,g,p,u[p]++),l.push([g,p,v]),w.push([k,p,v]);for(G=0;G<l.length;G++)E.io(a,
l[G][0],l[G][1],l[G][2]);for(G=0;G<w.length;G++)E.ed(a,w[G][0],w[G][1],w[G][2]);E.pg(a,g)}}function b(a,b,c,e,d,g){var f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},l=ba(a,f,0,g,null),k=l;t(a,c,l,"E");t(a,c,l,"A");t(a,c,l,"D");l=Ka.B();l=ka.rc(l,"LAMP",ka.Jc);if(!b.Fe)for(var w,u,p,h=0;h<l.length;h++){p=l[h].Rc;f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};w=ba(a,f,0,g,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};u=ba(a,f,0,g,null);t(a,k,u,"color");t(a,k,u,"specular");t(a,w,u,"ldir");
t(a,c,u,"normal");t(a,c,u,"D");t(a,c,u,"S");t(a,w,u,"lcolorint");t(a,c,w,"shadow_factor");k="SPECULAR_"+b.ls;f={name:k,type:k,use_tangent_shading:b.Km};k=ba(a,f,0,g,null);t(a,w,k,"ldir");t(a,w,k,"lfac");t(a,c,k,"normal");t(a,k,u,"sfactor");t(a,w,k,"norm_fac");t(a,c,k,"sp_params");k="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.wq;f={name:k,type:k,use_tangent_shading:b.Km};p=ba(a,f,0,g,null);t(a,w,p,"ldir");t(a,w,p,"lfac");t(a,c,p,"normal");t(a,w,p,"norm_fac");t(a,p,u,"lfactor");"DIFFUSE_LAMBERT"!=
k&&t(a,c,p,"dif_params");for(w=0;w<d.length;w++)E.ed(a,d[w][0],u,d[w][1]);k=u}t(a,k,e,"color");t(a,k,e,"specular")}function t(a,b,c,e){for(var d=E.Va(a,b),g=E.Va(a,c),f,l=0;l<g.L.length;l++)if(e==g.L[l].identifier){f=l;break}if(void 0!==f){for(var k,l=0;l<d.fb.length;l++)if(e==d.fb[l].identifier){k=l;break}void 0!==k&&E.ed(a,b,c,[k,f])}}function q(a,b){var c=[];E.oa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({zr:a,node:b})});for(var e=0;e<c.length;++e){var d=c[e].zr,g=c[e].node,f=E.Pl(a);E.yj(a,
f,g.data.OQ);var l=E.Pl(a);E.yj(a,l,g.data.PQ);E.ed(a,f,l,[4,2]);for(var k=E.In(a,d),w=[],u=[],p={},h=0;h<k;h++){var I=E.Li(a,d,h),n=E.Va(a,I);I in p||(p[I]=0);var G=E.Vd(a,I,d,p[I]++);w.push([I,d,G]);u.push([I,f,G]);if("BSDF_GLOSSY"==n.type||"BSDF_DIFFUSE"==n.type||"MIX_SHADER"==n.type||"EMISSION"==n.type){u.push([I,f,[1,1]]);u.push([I,f,[2,2]]);u.push([I,f,[3,3]]);u.push([I,f,[4,4]]);u.push([I,f,[5,5]]);u.push([I,f,[6,6]]);u.push([I,f,[7,7]]);u.push([I,f,[8,8]]);var Q=[];E.oa(a,function(a,b){"MIX_SHADER"==
b.type&&Q.push({zr:a,node:b})});for(G=0;G<Q.length;++G)for(var I=Q[G].zr,n=E.In(a,I),v=0;v<n;v++){var m=E.Li(a,I,v),C=E.Va(a,m),S=E.Vd(a,m,I,0);0==S[1]||"BSDF_GLOSSY"!=C.type&&"BSDF_DIFFUSE"!=C.type&&"MIX_SHADER"!=C.type&&"EMISSION"!=C.type||(C=1==S[1]?3:11,u.push([m,I,[1,C]]),u.push([m,I,[2,C+1]]),u.push([m,I,[3,C+2]]),u.push([m,I,[4,C+3]]),u.push([m,I,[5,C+4]]),u.push([m,I,[6,C+5]]),u.push([m,I,[7,C+6]]),u.push([m,I,[8,C+7]]))}}}z(a,g.data.value,f,l,b);for(h=0;h<w.length;h++)E.io(a,w[h][0],w[h][1],
w[h][2]);for(h=0;h<u.length;h++)E.ed(a,u[h][0],u[h][1],u[h][2]);g=E.mg(a,d);f=[];k=[];w={};for(h=0;h<g;h++)u=E.Sg(a,d,h),u in w||(w[u]=0),G=E.Vd(a,d,u,w[u]++),f.push([d,u,G]),k.push([l,u,G]);for(h=0;h<f.length;h++)E.io(a,f[h][0],f[h][1],f[h][2]);for(h=0;h<k.length;h++)E.ed(a,k[h][0],k[h][1],k[h][2]);E.pg(a,d)}}function z(a,b,c,e,d){var g=[],f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},l=ba(a,f,0,d,null),k=l;t(a,c,l,"E");t(a,c,l,"A");t(a,c,l,"D");for(var l=Ka.B(),l=ka.rc(l,"LAMP",ka.Jc),w,u,
h=0;h<l.length;h++){f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};w=ba(a,f,0,d,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};u=ba(a,f,0,d,null);t(a,k,u,"color");t(a,k,u,"specular");t(a,w,u,"ldir");t(a,c,u,"normal");t(a,c,u,"D");t(a,c,u,"S");t(a,w,u,"lcolorint");t(a,c,w,"shadow_factor");k=b.QQ;f={name:k,type:k};k=ba(a,f,0,d,null);t(a,w,k,"ldir");t(a,w,k,"lfac");t(a,c,k,"normal");t(a,w,k,"norm_fac");t(a,c,k,"bsdf_params");t(a,k,u,"lfactor");t(a,k,u,"sfactor");for(k=0;k<g.length;k++)E.ed(a,g[k][0],
u,g[k][1]);k=u}t(a,c,e,"s_color");t(a,c,e,"metalness");t(a,c,e,"e_color");t(a,c,e,"emission");t(a,k,e,"color");t(a,k,e,"specular")}function n(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function x(a,b){E.sg(a,function(c,e,d){var g=E.Va(a,e);e==b&&"Color"==g.L[d[1]].identifier&&E.io(a,c,e,d)})}function h(){var a=E.create(),b={data:null,Qb:[],qb:[],L:[{Da:new Float32Array([0,0,0]),identifier:"Color",ab:!1,name:"Color"},{Da:1,identifier:"Alpha",
ab:!1,name:"Alpha"}],fb:[],type:"OUTPUT",ii:[]};E.yj(a,0,b);return a}function k(a){E.oa(a,function(b,c){for(var e=c.L,d=c.fb,g=0;g<e.length;g++)f(a,e[g],b,g,1);for(g=0;g<d.length;g++)f(a,d[g],b,g,0)})}function f(a,b,c,e,d){if(b.ab){var g=!0;E.sg(a,function(a,b,f){if(!d&&a==c&&f[0]==e||d&&b==c&&f[1]==e)g=!1});g&&(b.ab=!1)}}function y(a,b,c){var e=[];E.sg(a,function(d,g,f){var l=E.Va(a,d),k=E.Va(a,g),l=Ga.bk(l.fb[f[0]].Da),k=Ga.bk(k.L[f[1]].Da);if(l!=k){var w,u={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},h={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};l&&!k?w=p("vector_to_scalar","B4W_VECTOSCAL",[u],[h]):!l&&k&&(w=p("scalar_to_vector","B4W_SCALTOVEC",[h],[u]));ba(a,w,0,b,c);e.push([d,g,a.X[a.X.length-2],f])}});for(var d=0;d<e.length;++d)E.io(a,e[d][0],e[d][1],e[d][3]),E.ed(a,e[d][0],e[d][2],[e[d][3][0],0]),E.ed(a,e[d][2],e[d][1],[0,e[d][3][1]])}function g(a){var b=[];E.oa(a,function(c,e){switch(e.type){case "B4W_TRANSLUCENCY":E.sg(a,function(d,g,f){var l=
E.Va(a,g);d==c&&"MATERIAL_EXT"==l.type&&"Translucency"==e.fb[f[0]].name&&b.push(d,g,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)E.ed(a,b[c],b[c+1],b[c+2])}function A(a,b){var c=[];E.oa(b,function(b,e){e.name==a.name&&c.push(b)});if(c.length)return c;Ga.q("Node not found")}function N(a){var b=[];E.oa(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var e=b[c],d=b[c+1];if("B4W_PARALLAX"==d.type)H(a,e,d);else if("REROUTE"==d.type){for(var g=
E.Li(a,e,0),f=E.mg(a,e),l=[],k=[],w=[],u=0;u<f;u++){var h=E.Sg(a,e,u),p=k.indexOf(h),I=0<=p?w[I]:0,n=E.Vd(a,e,h,I);if(n){var n=n[1],G=d.L[0].Da,n=E.Va(a,h).L[n];switch(typeof G){case "number":if("object"==typeof n.Da)for(var Q=n.Da,n=0;n<Q.length;n++)Q[n]=G;else"number"==typeof n.Da&&(n.Da=G);break;case "object":if("object"==typeof n.Da)for(Q=n.Da,n=0;n<Q.length;n++)Q[n]=G[n];else"number"==typeof n.Da&&(n.Da=.35*G[0]+.45*G[1]+.2*G[2])}}G=d.fb;for(n=0;n<G.length;n++)G[n].Da=d.L[0].Da;-1!=p?w[p]+=1:
(k.push(h),w.push(1),l.push(e,h))}if(-1!=g)for(d=E.Vd(a,g,e,0)[0],u=0;u<k.length;u++)for(n=0;n<w[u];n++)f=E.Vd(a,e,k[u],n)[1],E.ed(a,g,k[u],[d,f]);for(u=0;u<l.length;u+=2)E.rk(a,l[u],l[u+1],-1)}}}function H(a,b,c){var e;a:{e=a.Pa;for(var d=0;d<e.length;d+=3)if(e[d+1]==b&&1==e[d+2][1]){e=e[d];break a}e=-1}-1!=e&&(d=E.Va(a,e),c.data=d.data,E.rk(a,e,b,-1),0==E.mg(a,e)&&(b=E.Li(a,e,0),-1!=b&&E.rk(a,b,e,-1),E.pg(a,e)));c.L.splice(1,1)}function O(a){P(a);F(a);D(a)}function D(a){var b=[],c="",e="",d={};
E.oa(a,function(a,g){if("GEOMETRY_UV"==g.type||"UVMAP"==g.type||"TEX_COORD_UV"==g.type){b.push(a,g);var f=g.data.value;c?c==f||e||(e=f,d[e]=0):(c=f,d[c]=0);d[f]++}});for(var g in d)if(2>d[g]){for(var f=0;f<b.length;f+=2)b[f+1].data.value==g&&b.splice(f,2);delete d[g];c==g&&(c=e,e="");e==g&&(e="")}if(!(3>b.length)){var f={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},k={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};g=p("merged_uv","UV_MERGED",
[],[f,k]);g.uv_layer=c;ba(a,g,0,"",void 0);var w=a.X[a.X.length-2];g=a.X[a.X.length-1];if(e){k=p("merged_uv","UV_MERGED",[],[f,k]);k.uv_layer=e;ba(a,k,0,"",void 0);var u=a.X[a.X.length-2],k=a.X[a.X.length-1]}else k=null;for(var h=-1,I=null,f=0;f<b.length;f+=2){var n=b[f],G=b[f+1];l(G,b[1])?(h=w,I=g):k&&(h=u,I=k);for(var Q=[],v=E.mg(a,n),m={},C=0;C<v;C++){var S=E.Sg(a,n,C);S in m||(m[S]=0);var X=E.Vd(a,n,S,m[S]++);Q.push(n,S,X);X=X.splice(0,X.length);switch(G.type){case "GEOMETRY_UV":X[0]=0;I.fb[0].ab=
!0;break;case "UVMAP":case "TEX_COORD_UV":X[0]=1,I.fb[1].ab=!0}E.ed(a,h,S,X)}for(var C=0;C<Q.length;C+=3)E.rk(a,Q[C],Q[C+1],0);E.pg(a,n)}}}function P(a){var b=[];E.oa(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var e=[],d=0;d<b.length;d+=2){for(var g=b[d],f=b[d+1],l=!0,k=0;k<e.length;k++){var w=e[k];if(c(f,
w.vf)){l=[];k=E.mg(a,g);for(p=0;p<k;p++){var u=E.Sg(a,g,p),h=E.Vd(a,g,u,0);l.push(g,u,h);E.ed(a,w.id,u,h)}for(var p=0;p<l.length;p+=3)E.rk(a,l[p],l[p+1],0);E.pg(a,g);l=!1;break}}l&&(w={id:g,vf:f},e.push(w))}}function K(a){for(var b={},c=0;c<a.X.length;c+=2){var e=a.X[c];b[e]={Ep:{},hJ:!1}}for(c=0;c<a.Pa.length;c+=3)b[a.Pa[c+1]].Ep[a.Pa[c]]=!0;for(e in b)M(e,b);for(e in b)b[e]=Object.keys(b[e].Ep).map(function(a){return parseInt(a)});return b}function M(a,b){var c=b[a];if(!c.hJ){var e=Ga.P(c),d;for(d in c.Ep){M(d,
b);var c=b[d],g;for(g in c.Ep)e.Ep[g]=!0}e.hJ=!0;b[a]=e}}function F(a){var b=[];E.oa(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var e=K(a),d=[],g=0;g<b.length;g+=2){for(var f=b[g],l=b[g+1],k=!0,w=0;w<d.length;w++){var u=d[w];if(!(3<=u.Un.length||!c(l,u.vf)||-1<e[f].indexOf(u.id)||-1<e[u.id].indexOf(f))){for(var h=!1,p=0;p<u.Un.length;p++){var I=u.Un[p].id;if(-1<e[f].indexOf(I)||-1<e[I].indexOf(f)){h=!0;break}}if(!h){for(var w=[],I=E.In(a,f),n=
{},p=0;p<I;p++)h=E.Li(a,f,p),h in n||(n[h]=0),k=E.Vd(a,h,f,n[h]++),w.push(h,f,k);for(var I=[],n=E.mg(a,f),G={},p=0;p<n;p++)h=E.Sg(a,f,p),h in G||(G[h]=0),k=E.Vd(a,f,h,G[h]++),I.push(f,h,k);k=w.concat(I);for(p=0;p<k.length;p+=3)E.rk(a,k[p],k[p+1],0);E.pg(a,f);p={id:f,vf:l,oT:w,pT:I};u.Un.push(p);k=!1;break}}}k&&(u={id:f,vf:l,Un:[]},d.push(u))}for(g=0;g<d.length;g++){u=d[g];e=u.Un.length;for(w=0;w<e;w++){l=u.Un[w];p=l.vf;f=l.oT;l=l.pT;u.vf.L[w+1].ab=p.L[0].ab;u.vf.L[w+1].Da=p.L[0].Da;u.vf.fb[2*(w+1)].ab=
p.fb[0].ab;u.vf.fb[2*(w+1)].Da=p.fb[0].Da;u.vf.fb[2*(w+1)+1].ab=p.fb[1].ab;u.vf.fb[2*(w+1)+1].Da=p.fb[1].Da;for(p=0;p<f.length;p+=3)h=f[p],k=f[p+2],k[1]+=w+1,E.ed(a,h,u.id,k);for(p=0;p<l.length;p+=3)h=l[p+1],k=l[p+2],k[0]+=2*(w+1),E.ed(a,u.id,h,k);u.vf.Qb.push(["USE_uv"+(w+2),1])}E.pg(a,u.id);E.yj(a,u.id,u.vf)}}}function c(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.mz==b.data.value.mz&&a.data.value.Hn==b.data.value.Hn;default:return!1}}function l(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function C(a){var b=[],c=[];E.oa(a,function(a,e){"GEOMETRY_VC"==e.type&&b.push(a,e);"GEOMETRY_VW"==e.type&&c.push(a,e)});v(a,b);e(a,c)}function v(a,b){for(var c=0;c<b.length;c+=2){for(var e=b[c],d=b[c+1],g=!1,f=[],l=[],k=[[],
[],[]],w=E.mg(a,e),u=0;u<w;u++){var p=E.Sg(a,e,u);if("SEPRGB"!=E.Va(a,p).type){g=!1;break}f.push(e,p);for(var h={},I=E.mg(a,p),g=0;g<I;g++){var n=E.Sg(a,p,g);n in h||(h[n]=0);var G=E.Vd(a,p,n,h[n]++);f.push(p,n);k[G[0]].push(e,n,G)}l.push(p);g=!0}if(g){for(u=e=w=0;u<k.length;u++)k[u].length&&(w++,e|=1<<2-u);if(w){d.type+=w;d.fb=[];for(u=0;u<k.length;u++)if(k[u].length)for(d.fb.push({Da:0,identifier:"RGB"[u],ab:!0,name:"RGB"[u]}),g=0;g<k[u].length;g+=3)k[u][g+2][0]=Ga.ko(e,u);for(u=0;u<f.length;u+=
2)E.rk(a,f[u],f[u+1],0);for(u=0;u<l.length;u++)E.pg(a,l[u]);for(u=0;u<k.length;u++)for(g=0;g<k[u].length;g+=3)E.ed(a,k[u][g],k[u][g+1],k[u][g+2])}}}}function e(a,b){for(var c=0;c<b.length;c+=2){for(var e=b[c],d=!0,g=[],f=E.mg(a,e),l=0;l<f;l++){var k=E.Sg(a,e,l);if("B4W_REFLECT"==E.Va(a,k).type){var w=E.Vd(a,e,k,0),u=E.Vd(a,e,k,1);w&&1==w[1]||u&&1==u[1]?d=!1:g.push(e,k)}else d=!1}for(l=0;l<g.length;l+=2)f=a,w=g[l],k=g[l+1],u=E.Va(f,k),u.type+="_WORLD",E.rk(f,w,k,0),u.L.splice(0,1),w=E.Li(f,k,0),w!=
E.Iy&&(E.Vd(f,w,k,0)[1]=0);d&&E.pg(a,e)}}function R(a,b,c,e,d,g){a=a.nodes;for(var f=null,l=0;l<a.length;l++){var k=a[l];d?"GROUP"==k.type&&k.node_tree_name==c&&(f=k):k.type==c&&(f=k)}return f?A(f,b)[0]:(g||va.error('No "'+c+'" node in node '+e),-1)}function p(a,b,c,e){return{name:a,type:b,inputs:c,outputs:e}}function ba(a,b,c,e,d){var g=b.name,f=b.type,l=[],k=[],p=[],h=[],n=null,G=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":k=
aa(b);p=ca(b);va.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":k=aa(b);p=ca(b);break;case "MIX_SHADER":k.push(I(b,"Fac"));var v=I(b,"Shader"),p=v.ab;k.push(v);(v=I(b,"Shader_001"))||(v=I(b,"Shader.001"));var m=v.ab;k.push(v);k.push(u("d_color1","d_color1",[0,0,0],p));k.push(u("d_roughness1","d_roughness1",0,p));k.push(u("s_color1","s_color1",[0,0,0],p));k.push(u("s_roughness1","s_roughness1",0,p));k.push(u("metalness1","metalness1",0,p));k.push(u("normal1",
"normal1",[0,0,0],p));k.push(u("e_color1","e_color1",[0,0,0],p));k.push(u("emission1","emission1",0,p));k.push(u("d_color2","d_color2",[0,0,0],m));k.push(u("d_roughness2","d_roughness2",0,m));k.push(u("s_color2","s_color2",[0,0,0],m));k.push(u("s_roughness2","s_roughness2",0,m));k.push(u("metalness2","metalness2",0,m));k.push(u("normal2","normal2",[0,0,0],m));k.push(u("e_color2","e_color2",[0,0,0],m));k.push(u("emission2","emission2",0,m));p=Y(b,"Shader");v=p.ab;p=[p,u("d_color","d_color",[0,0,0],
v),u("d_roughness","d_roughness",0,v),u("s_color","s_color",[0,0,0],v),u("s_roughness","s_roughness",0,v),u("metalness","metalness",0,v),u("normal","normal",[0,0,0],v),u("e_color","e_color",[0,0,0],v),u("emission","emission",0,v)];break;case "OBJECT_INFO":var k=aa(b),p=[],v=Y(b,"Location"),m=Y(b,"Object Index"),C=Y(b,"Material Index"),S=Y(b,"Random");p.push(v);p.push(m);p.push(C);p.push(S);G.push(["USE_LOCATION_OUT",v.ab|0]);G.push(["USE_OBJ_IND_OUT",m.ab|0]);G.push(["USE_MAT_IND_OUT",C.ab|0]);G.push(["USE_RANDOM_OUT",
S.ab|0]);break;case "UVMAP":(v=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(n=U("param_"+f+"_a"),m=U("param_"+f+"_v"),l.push(ja(n)),l.push(ja(m)),h.push(ja(m)),n={name:n,value:v});p=ca(b);break;case "UV_MERGED":n=U("param_UV_MERGED_a");m=U("param_UV_MERGED_v");l.push(ja(n));l.push(ja(m));p.push(Y(b,"UV_geom"));p.push(Y(b,"UV_cycles"));h.push(ja(m));n={name:n,value:b.uv_layer};break;case "CAMERA":k=[];p=ca(b);break;case "COMBRGB":case "COMBHSV":k=aa(b);p=ca(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
f?(L(b,0,0)&&G.push(["READ_R",1]),L(b,1,0)&&G.push(["READ_G",1]),L(b,2,0)&&G.push(["READ_B",1]),L(b,3,0)&&G.push(["READ_A",1])):(L(b,0,-1)&&G.push(["READ_R",1]),L(b,1,-1)&&G.push(["READ_G",1]),L(b,2,-1)&&G.push(["READ_B",1]));k=aa(b);p=ca(b);n={value:b};break;case "PARTICLE_INFO":k=aa(b);p=ca(b);for(v=0;v<b.outputs.length;v++){m=b.outputs[v];C=m.identifier;S=ja("v_param_PART_INFO_"+C.replace(" ",""));if(m.is_linked)switch(C){case "Size":G.push(["PART_INFO_SIZE",ma.M(1)]);break;case "Age":G.push(["PART_INFO_AGE",
ma.M(1)]);break;case "Lifetime":G.push(["PART_INFO_LT",ma.M(1)]);break;case "Location":G.push(["PART_INFO_LOC",ma.M(1)]);break;case "Index":var X=ja("a_param_PART_INFO_"+m.identifier.replace(" ","")),n=X;G.push(["PART_INFO_IND",ma.M(1)]);break;case "Velocity":G.push(["PART_INFO_VEL",ma.M(1)]);break;case "Angular Velocity":G.push(["PART_INFO_A_VEL",ma.M(1)])}"Age"!=C&&"Lifetime"!=C&&"Size"!=C&&(l.push(S),h.push(S))}X&&l.push(X);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!Z(b))return!0;f=w(b,c);if(!f)return va.error("Geometry output is not supported"),
null;switch(f){case "GEOMETRY_UV":(v=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(n=U("param_GEOMETRY_UV_a"),m=U("param_GEOMETRY_UV_v"),l.push(ja(n)),l.push(ja(m)),h.push(ja(m)),n={name:n,value:v});p.push(Y(b,"UV"));break;case "GEOMETRY_VC":(v=b.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(n=U("param_GEOMETRY_VC_a"),m=U("param_GEOMETRY_VC_v"),l.push(ja(n)),l.push(ja(m)),h.push(ja(m)),n={name:n,value:v});p.push(Y(b,"Vertex Color"));break;case "GEOMETRY_NO":p.push(Y(b,"Normal"));break;case "GEOMETRY_TRN":f=
"GEOMETRY_NO";p.push(Y(b,"True Normal"));va.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":p.push(Y(b,"Front/Back"));break;case "GEOMETRY_VW":p.push(Y(b,"View"));break;case "GEOMETRY_GL":p.push(Y(b,"Global")||Y(b,"Position"));break;case "GEOMETRY_LO":p.push(Y(b,"Local"));break;case "GEOMETRY_OR":v=U("param_GEOMETRY_OR_v");l.push(ja(v));p.push(Y(b,"Orco"));h.push(ja(v));break;case "GEOMETRY_IN":p.push(Y(b,"Incoming"));break;case "GEOMETRY_BF":p.push(Y(b,"Backfacing"))}break;
case "TEX_COORD":if(!Z(b))return!0;f=ga(b,c);switch(f){case "TEX_COORD_UV":(v=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(n=U("param_TEX_COORD_UV_a"),m=U("param_TEX_COORD_UV_v"),l.push(ja(n)),l.push(ja(m)),h.push(ja(m)),n={name:n,value:b.uv_layer});p.push(Y(b,"UV"));break;case "TEX_COORD_NO":p.push(Y(b,"Normal"));break;case "TEX_COORD_GE":v=U("param_TEX_COORD_GE_v");l.push(ja(v));p.push(Y(b,"Generated"));h.push(ja(v));break;case "TEX_COORD_OB":p.push(Y(b,"Object"));break;case "TEX_COORD_CA":p.push(Y(b,
"Camera"));break;case "TEX_COORD_WI":p.push(Y(b,"Window"));break;case "TEX_COORD_RE":p.push(Y(b,"Reflection"))}break;case "GROUP":v=b.node_tree_name;switch(v){case "B4W_LINEAR_TO_SRGB":if(!J(b,[1],[1])){n=B(b,e,d);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!J(b,[1],[1])){n=B(b,e,d);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!J(b,[1],[1])){n=B(b,e,d);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!J(b,[1,1],[1])){n=B(b,e,d);break}f=
"B4W_REFLECT";break;case "B4W_REFRACTION":if(!J(b,[1,0],[1])){n=B(b,e,d);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!J(b,[1,1,0,0,0],[1])){n=B(b,e,d);break}m=U("param_B4W_PARALLAX_texture");h.push(ja(m));f="B4W_PARALLAX";break;case "B4W_CLAMP":if(!J(b,[1],[1])){n=B(b,e,d);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!J(b,[0,0,0,0,0],[0])){n=B(b,e,d);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!J(b,[],[0])){n=B(b,e,d);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!J(b,
[0,0,0],[0])){n=B(b,e,d);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:n=B(b,e,d)}k=aa(b);p=ca(b);"B4W_TRANSLUCENCY"==v&&(v=u("TranslucencyParams","TranslucencyParams",[0,0,0,0]),v.ab=p[0].ab,p.push(v));break;case "LAMP":n=b.lamp;if(!n)return va.error("There is no lamp in node: "+b.name),null;p.push(Y(b,"Color"));p.push(Y(b,"Light Vector"));p.push(Y(b,"Distance"));p.push(Y(b,"Visibility Factor"));n.uuid in Na?G.push(["LAMP_INDEX",String(Na[n.uuid])]):(Na[n.uuid]=
Da,G.push(["LAMP_INDEX",String(Da++)]));n=Na;break;case "LIGHTING_AMBIENT":k=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0)];p=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":p=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("dif_params","dif_params",[0,0],!0),u("sp_params","sp_params",[0,0],!0),u("shadow_factor","shadow_factor",0,!0),u("translucency_color",
"translucency_color",0,!0),u("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":k=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":k=[u("shadow_factor","shadow_factor",0,!0)];p=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("lcolorint","lcolorint",[0,0,0],!0),u("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":k=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac",
"norm_fac",0,!0)];p=[u("lfactor","lfactor",0,!0)];G.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":k=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("dif_params","dif_params",[0,0],!0)];p=[u("lfactor","lfactor",0,!0)];G.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":k=
[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("sp_params","sp_params",[0,0],!0)];p=[u("sfactor","sfactor",0,!0)];G.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":k=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("sp_params","sp_params",[0,0],!0)];p=[u("sfactor","sfactor",0,!0)];G.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":k=[u("ldir","ldir",[0,0,0],!0),u("lfac","lfac",[0,0],!0),u("normal","normal",[0,0,0],!0),u("norm_fac","norm_fac",0,!0),u("bsdf_params","bsdf_params",[0,0,0,0],!0)];p=[u("lfactor","lfactor",0,!0),u("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":k=[u("color","color",[0,0,0,0],!0),u("specular","specular",[0,0,0],!0),u("lfactor","lfactor",0,!0),u("sfactor","sfactor",0,!0),u("ldir","ldir",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("translucency_params",
"translucency_params",[0,0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("lcolorint","lcolorint",[0,0,0],!0),u("translucency_color","translucency_color",0,!0)];p=[u("color","color",[0,0,0,0],!0),u("specular","specular",[0,0,0],!0)];break;case "NORMAL":k=aa(b);p=ca(b);v=Y(b,"Normal");h.push(ja(U("param_NORMAL_Normal"),v.Da,3));break;case "MAPPING":v=b.vector_type;f="MAPPING";k.push(I(b,"Vector"));p.push(Y(b,"Vector"));var m=Ga.yf(b.rotation),C=Ga.yf(b.scale),S=Ga.yf(b.translation),X=za.create(),
y=Ga.xT(m);"TEXTURE"==v&&(C[0]=C[0]||1,C[1]=C[1]||1,C[2]=C[2]||1);var q=new Float32Array([C[0],0,0,0,C[1],0,0,0,C[2]]);za.multiply(y,q,X);X=Ga.hW(X,ra.create());switch(v){case "POINT":X[12]=S[0];X[13]=S[1];X[14]=S[2];break;case "TEXTURE":X[12]=S[0];X[13]=S[1];X[14]=S[2];X=ra.invert(X,X);break;case "NORMAL":ra.invert(X,X),ra.transpose(X,X)}switch(v){case "NORMAL":G.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":G.push(["MAPPING_TRS_MATRIX_DEF",1]);G.push(["MAPPING_TRS_MATRIX",ma.M(X,16)]);break;case "POINT":0!==
Ca.length(m)?(G.push(["MAPPING_TRS_MATRIX_DEF",1]),G.push(["MAPPING_TRS_MATRIX",ma.M(X,16)])):(0!==Ca.length(C)&&(G.push(["MAPPING_SCALE_DEF",1]),G.push(["MAPPING_SCALE",ma.M(C,3)])),0!==Ca.length(S)&&(G.push(["MAPPING_TRANS_DEF",1]),G.push(["MAPPING_TRANS",ma.M(S,3)])));break;case "VECTOR":0!==Ca.length(m)?(G.push(["MAPPING_TRS_MATRIX_DEF",1]),G.push(["MAPPING_TRS_MATRIX",ma.M(X,16)])):0!==Ca.length(C)&&(G.push(["MAPPING_SCALE_DEF",1]),G.push(["MAPPING_SCALE",ma.M(C,3)]))}b.use_min&&(G.push(["MAPPING_MIN_CLIP_DEF",
1]),G.push(["MAPPING_MIN_CLIP",ma.M(b.min,3)]));b.use_max&&(G.push(["MAPPING_MAX_CLIP_DEF",1]),G.push(["MAPPING_MAX_CLIP",ma.M(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":n=[];v=[];m=[];C=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("dif_params","dif_params",[0,0],!0),u("sp_params","sp_params",[0,0],!0),u("shadow_factor","shadow_factor",0,!0)];S=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0),
u("normal","normal",[0,0,0],!0)];X=[Y(b,"Color"),Y(b,"Alpha"),Y(b,"Normal")];y=[];q=I(b,"Color");q.Da.splice(3);m.push(q);k.push(q);q=I(b,"Spec");q.Da.splice(3);m.push(q);k.push(q);(q=I(b,"DiffuseIntensity"))||(q=I(b,"Refl"));q.Da=b.diffuse_intensity;m.push(q);k.push(q);var fa=I(b,"Normal");fa.Da.splice(3);m.push(fa);k.push(fa);"MATERIAL_EXT"==f?((q=I(b,"Emit"))||(q=u("Emit","Emit",0)),m.push(q),k.push(q),(q=I(b,"Translucency"))?(q.Da=0,q.name="Translucency",q.identifier="Translucency"):q=u("Translucency",
"Translucency",0),k.push(q),(q=I(b,"Translucency"))?(q.Da=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams"):q=u("TranslucencyParams","TranslucencyParams",[0,0,0,0]),k.push(q),p=I(b,"Reflectivity"),q=I(b,"Ray Mirror"),p?(q=p,p="Reflectivity"):q?p="Ray Mirror":(q=p,p="Reflectivity"),q||(q=u(p,p,0)),k.push(q),S.push(q),(q=I(b,"SpecTra"))||(q=u("SpecTra","SpecTra",0)),k.push(q),S.push(q),(q=I(b,"Alpha"))||(q=u("Alpha","Alpha",b.alpha)),k.push(q),S.push(q),X.push(Y(b,"Diffuse")),
X.push(Y(b,"Spec")),n.push(["MATERIAL_EXT",1]),v.push(["MATERIAL_EXT",1])):(m.push(u("emit_intensity","emit_intensity",0)),S.push(u("reflect_factor","reflect_factor",0)),S.push(u("specular_alpha","specular_alpha",0)),S.push(u("alpha_in","alpha_in",0)),X.push(u("diffuse_out","diffuse_out",0)),X.push(u("spec_out","spec_out",0)),n.push(["MATERIAL_EXT",0]),v.push(["MATERIAL_EXT",0]));y.push(ja(U("param_MATERIAL_alpha"),b.alpha));y.push(ja(U("param_MATERIAL_spec_alpha"),b.specular_alpha));p=X;n.push(["USE_MATERIAL_NORMAL",
fa.ab|0]);b.use_diffuse&&(n.push(["USE_MATERIAL_DIFFUSE",1]),v.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&v.push(["USE_MATERIAL_SPECULAR",1]);var q=[],R=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":fa=b.specular_hardness;break;case "WARDISO":fa=b.specular_slope;break;case "TOON":fa=b.specular_toon_size;R=b.specular_toon_smooth;break;case "BLINN":fa=b.specular_ior;R=b.specular_hardness;break;default:va.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),fa=b.specular_hardness}var A,oa;switch(b.diffuse_shader){case "LAMBERT":oa=A=0;break;case "OREN_NAYAR":A=b.roughness;oa=0;break;case "FRESNEL":A=b.diffuse_fresnel;oa=b.diffuse_fresnel_factor;break;case "MINNAERT":A=b.darkness;oa=0;break;case "TOON":A=b.diffuse_toon_size;oa=b.diffuse_toon_smooth;break;default:va.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),oa=A=0}q.push(ja(U("param_MATERIAL_diffuse"),[A,oa],2));q.push(ja(U("param_MATERIAL_spec"),
[b.specular_intensity,fa,R],3));n.push(["SHADELESS_MAT",b.use_shadeless?1:0]);fa={name:b.name,value:{ls:b.specular_shader,wq:b.diffuse_shader,Fe:b.use_shadeless,Km:b.use_tangent_shading}};n={name:b.name,value:{ls:b.specular_shader,wq:b.diffuse_shader,Fe:b.use_shadeless,Km:b.use_tangent_shading},iW:{name:"material_begin",type:"MATERIAL_BEGIN",L:m,fb:C,qb:q,data:fa,Qb:n,ii:[]},jW:{name:"material_end",type:"MATERIAL_END",L:S,fb:X,qb:y,data:fa,Qb:v,ii:[]}};break;case "BSDF_DIFFUSE":k=aa(b);G.push(["USE_NORMAL_IN",
k[2].ab|0]);p=Y(b,"BSDF");v=p.ab;p=[p,u("d_color","d_color",[0,0,0],v),u("d_roughness","d_roughness",0,v),u("s_color","s_color",[0,0,0],v),u("s_roughness","s_roughness",0,v),u("metalness","metalness",0,v),u("normal","normal",[0,0,0],v),u("e_color","e_color",[0,0,0],v),u("emisson","emisson",0,v)];break;case "BSDF_GLOSSY":k=aa(b);G.push(["USE_NORMAL_IN",k[2].ab|0]);p=Y(b,"BSDF");v=p.ab;p=[p,u("d_color","d_color",[0,0,0],v),u("d_roughness","d_roughness",0,v),u("s_color","s_color",[0,0,0],v),u("s_roughness",
"s_roughness",0,v),u("metalness","metalness",1,v),u("normal","normal",[0,0,0],v),u("e_color","e_color",[0,0,0],v),u("emisson","emisson",0,v)];break;case "EMISSION":k=aa(b);p=Y(b,"Emission");v=p.ab;p=[p,u("d_color","d_color",[0,0,0],v),u("d_roughness","d_roughness",0,v),u("s_color","s_color",[0,0,0],v),u("s_roughness","s_roughness",0,v),u("metalness","metalness",1,v),u("normal","normal",[0,0,0],v),u("e_color","e_color",[0,0,0],v),u("emisson","emisson",1,v)];break;case "MATH":switch(b.operation){case "ADD":f=
"MATH_ADD";break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";break;case "ARCCOSINE":f="MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";
break;case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return va.error("Unsupported MATH operation: "+b.operation),null}G.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);k=aa(b);p=ca(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f=
"MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;case "DODGE":f="MIX_RGB_DODGE";break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return va.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}G.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);k=aa(b);p=ca(b);break;case "OUTPUT":k=aa(b);p=[];break;case "OUTPUT_MATERIAL":aa(b);k=I(b,"Surface");p=k.ab;n=[k,u("d_color","d_color",[0,0,0],p),u("d_roughness","d_roughness",0,p),u("s_color","s_color",[0,0,0],p),u("s_roughness","s_roughness",0,p),u("metalness","metalness",0,p),u("normal","normal",
[0,0,0],p),u("e_color","e_color",[0,0,0],p),u("emission","emission",0,p)];v=[u("E","E",[0,0,0],!0),u("A","A",[0,0,0],!0),u("D","D",[0,0,0],!0),u("S","S",[0,0,0],!0),u("normal","normal",[0,0,0],!0),u("bsdf_params","bsdf_params",[0,0,0,0],!0),u("shadow_factor","shadow_factor",0,!0),u("s_color","s_color",[0,0,0],!0),u("metalness","metalness",0,!0),u("e_color","e_color",[0,0,0],!0),u("emission","emission",0,!0)];m=[u("color","color",[0,0,0],!0),u("specular","specular",[0,0,0],!0),u("normal","normal",
[0,0,0],!0),u("s_color","s_color",[0,0,0],!0),u("metalness","metalness",0,!0),u("e_color","e_color",[0,0,0],!0),u("emission","emission",0,!0)];C=[];k=n;p=C;n={name:b.name,value:{QQ:"BSDF_COMPUTE"},OQ:{name:"bsdf_begin",type:"BSDF_BEGIN",L:n,fb:v,qb:[],data:null,Qb:[],ii:[]},PQ:{name:"bsdf_end",type:"BSDF_END",L:m,fb:C,qb:[],data:null,Qb:[],ii:[]}};break;case "RGB":v=b.name;v={name:"-1",value:v};h.push(v);p.push(Y(b,"Color"));break;case "SEPRGB":case "SEPHSV":k=aa(b);p=ca(b);break;case "TEX_ENVIRONMENT":(v=
b.image)?(f="TEXTURE_ENVIRONMENT","NONE"==b.color_space?G.push(["NON_COLOR",1]):G.push(["NON_COLOR",0]),k.push(I(b,"Vector")),p.push(Y(b,"Color")),m=U("param_TEXTURE_texture"),h.push(ja(m)),n=ta.EG(128),n.source="ENVIRONMENT_MAP",ta.oF(n,v),n={name:m,value:n}):f="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(v=b.image){f="TEXTURE_COLOR";"NONE"==b.color_space?G.push(["NON_COLOR",1]):G.push(["NON_COLOR",0]);G.push(["CONVERT_UV",0]);for(m=0;4>m;++m)m?(q=u("Vector"+m,"Vector"+m,[0,0,0],!1),C=u("Color"+m,"Color"+
m,[0,0,0],!1),S=u("Alpha"+m,"Alpha"+m,0,!1)):(q=I(b,"Vector"),C=Y(b,"Color"),S=Y(b,"Alpha")),k.push(q),p.push(C),p.push(S);m=U("param_TEXTURE_texture");h.push(ja(m));n=ta.zl(ta.th,!1);n.repeat="REPEAT"==b.extension;n.source="IMAGE";ta.oF(n,v);n={lz:b.name,name:m,value:n}}else f="TEXTURE_EMPTY";break;case "TEXTURE":f=Q(b);if("TEXTURE_EMPTY"==f)p.push(Y(b,"Color")),p.push(Y(b,"Normal")),p.push(Y(b,"Value"));else if("TEXTURE_ENVIRONMENT"==f)k.push(I(b,"Vector")),p.push(Y(b,"Color")),p.push(Y(b,"Value"));
else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==b.texture.type)return va.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==f&&(v=!1,(m=b.texture.image)&&"Non-Color"==m.colorspace_settings_name&&(v=!0),G.push(["NON_COLOR",Number(v)]),G.push(["CONVERT_UV",1]));for(m=0;4>m;++m)v="TEXTURE_COLOR"==f?"Color":"Normal",m?(q=u("Vector"+m,"Vector"+m,[0,0,0],!1),C=u(v+m,v+m,[0,0,0],!1),S=u("Value"+m,"Value"+m,0,!1)):(q=I(b,"Vector"),C=Y(b,v),S=Y(b,"Value")),k.push(q),p.push(C),
p.push(S)}"TEXTURE_EMPTY"!=f&&(m=U("param_TEXTURE_texture"),h.push(ja(m)),n=b.texture.s,n={lz:b.texture.name,name:m,value:n});break;case "VALTORGB":k=aa(b);p=ca(b);n={value:b};v=b.color_ramp.interpolation;"CONSTANT"!=v&&"LINEAR"!=v&&va.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";v=b.name;v={name:"-1",value:v};h.push(v);p.push(Y(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";break;case "AVERAGE":f=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return va.error("Unsupported VECT_MATH operation: "+b.operation),null}k=aa(b);p=ca(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":G.push(["VECTOR_TYPE",ma.M(0)]);break;case "VECTOR":G.push(["VECTOR_TYPE",ma.M(1)]);break;case "NORMAL":G.push(["VECTOR_TYPE",ma.M(2)]);break;default:return va.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}k=b.convert_from;p=b.convert_to;v=0;if("WORLD"==k)if("WORLD"==p)v=0;else if("OBJECT"==p)v=1;else if("CAMERA"==p)v=2;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==k)if("WORLD"==p)v=3;else if("OBJECT"==p)v=4;else if("CAMERA"==p)v=5;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==k)if("WORLD"==p)v=6;else if("OBJECT"==p)v=7;else if("CAMERA"==p)v=8;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return va.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;G.push(["CONVERT_TYPE",ma.M(v)]);k=aa(b);p=ca(b);break;case "NORMAL_MAP":v=0;switch(b.space){case "TANGENT":v=0;break;case "OBJECT":v=1;break;case "WORLD":v=2;break;case "BLENDER_OBJECT":v=3;break;case "BLENDER_WORLD":v=4;break;default:return va.error("Unsupported NORMAL_MAP space: "+b.space),null}G.push(["SPACE",ma.M(v)]);k.push(I(b,"Strength"));k.push(I(b,"Color"));p.push(Y(b,"Normal"));break;
case "FRESNEL":fa=I(b,"Normal");k.push(I(b,"IOR"));k.push(fa);p.push(Y(b,"Fac"));G.push(["USE_FRESNEL_NORMAL",fa.ab|0]);break;case "LAYER_WEIGHT":fa=I(b,"Normal");k.push(I(b,"Blend"));k.push(fa);p=ca(b);G.push(["USE_NORMAL_IN",fa.ab|0]);break;case "BUMP":fa=I(b,"Normal"),G.push(["INVERT",b.invert?1:0]),G.push(["USE_NORMAL_IN",fa.ab|0]),aa(b),ca(b);default:k=aa(b),p=ca(b)}f={name:g,type:f,ii:l,L:k,fb:p,qb:h,data:n,Qb:G};g=E.Pl(a);E.yj(a,E.Pl(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{f=b.outputs;for(h=l=0;h<f.length;h++)if(f[h].is_linked&&l++>c){f=!0;break a}f=!1}f=!f}return f||null!=ba(a,b,++c,e,d)?g:null}function J(a,b,c){for(var e=a.inputs,d=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var l=e[g],k=b[g];if(!l||l.default_value instanceof Array!=k)return va.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=d[g],e=c[g],!b||b.default_value instanceof Array!=e)return va.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function B(a,b,c){var e=a.node_group.node_tree,d={},f;for(f in e)if("links"==f||"nodes"==f){d[f]=[];for(var g=0;g<e[f].length;g++){d[f][g]={};for(var l in e[f][g])if("links"==f){d[f][g][l]={};for(var k in e[f][g][l])d[f][g][l][k]=V(e[f][g][l][k])}else d[f][g][l]=V(e[f][g][l])}}else d[f]=V(e[f]);e=a.node_tree_name;if("B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e)f=p("Group input","GROUP_INPUT",[],a.inputs),g=p("Group output",
"GROUP_OUTPUT",a.outputs,[]),l=null,l="B4W_REPLACE"==e||"B4W_LEVELS_OF_QUALITY"==e&&(G.quality==ea.op||G.xH)?{from_node:f,from_socket:f.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:g,to_socket:g.inputs[0]},d.nodes=[f,g],d.links=[l];e=a.name;f=d.nodes;g=d.links;for(l=0;l<f.length;l++)f[l].name=pa(f[l].type,e,f[l].name);for(l=0;l<g.length;l++)g[l].from_node.name=pa(g[l].from_node.type,e,g[l].from_node.name),g[l].to_node.name=pa(g[l].to_node.type,e,g[l].to_node.name);
return{wW:m(d,a.node_group.uuid,!0,b,c).Wa,xW:d.links}}function V(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ga.bq(a):a}function U(a){Ba[a]||(Ba[a]=0);var b=a+"_"+Ba[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ba[a]++;return b}function Z(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function w(a,b){for(var c=a.outputs,e=0,d=0;d<c.length;d++){var f=c[d];if(f.is_linked&&!(e++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ga(a,b){for(var c=a.outputs,e=0,d=0;d<c.length;d++){var f=c[d];if(f.is_linked&&!(e++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function Q(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,e=!1,d=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":e=!0;break;case "Value":d=!0;break;default:Ga.q("Unknown texture output")}}if(c)return e&&
va.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(e)return"TEXTURE_NORMAL";if(d)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function I(a,b){for(var c=a.inputs,e=0;e<c.length;e++){var d=c[e];if(d.identifier==b)return ia(d)}return null}function Y(a,b){for(var c=a.outputs,e=0;e<c.length;e++){var d=c[e];if(d.identifier==b)return ia(d)}return null}function ia(a){var b=
a.name,c=a.identifier,e=a.is_linked;a=a.default_value;a=Ga.bk(a)?a.slice(0):a;return{name:b,identifier:c,ab:e,Da:a}}function u(a,b,c,e){return{name:a,identifier:b,ab:e,Da:c}}function aa(a){for(var b=[],c=0;c<a.inputs.length;c++){var e=ia(a.inputs[c]);e.Da.length&&e.Da.splice(3);b.push(e)}return b}function ca(a){for(var b=[],c=0;c<a.outputs.length;c++){var e=ia(a.outputs[c]);b.push(e)}return b}function ja(a,b,c){b=null===b||void 0===b?null:ma.M(b,c);return{name:a,value:b}}function wa(a,b,c,e,d,f){var g=
[],l=f.from_socket.identifier;f=f.to_socket.identifier;var k=e.fb;for(e=0;e<k.length;e++)if(k[e].identifier==l){g.push(e);break}d=d.L;for(e=0;e<d.length;e++)if(d[e].identifier==f){g.push(e);break}2==g.length&&E.ed(a,b,c,g);return!0}function pa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function S(a){var b=[];E.oa(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function fa(a,b,c){for(var e=0;e<c.length;e++){var d=c[e].data.wW,f=c[e].data.xW;if(!d)return!1;
E.oa(d,function(b,c){E.yj(a,E.Pl(a),c)});for(d=0;d<f.length;d++)b.push(f[d]);ya(c[e],b,a)}return!0}function oa(a,b,c,e,d,f){switch(a.type){case "GROUP":a.name==b&&e.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||d.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function xa(a,b,c){for(var e=[],d=0;d<c.length;d++){for(var f=c[d],g=null,l=0;l<b.length;l++)if(f.from_socket.identifier==b[l].to_socket.identifier){g=b[l];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):
e.push(f)}for(d=0;d<b.length;d++)a.splice(a.indexOf(b[d]),1);return e}function la(a,b){if(b.length)for(var c=b[0].from_node.name,e=0;e<a.length;e++)a[e].from_node.name==c&&b.push(a[e])}function X(a,b,c,e){for(var d=0;d<e.length;d++){for(var f=e[d],g,l=0;l<c.L.length;l++)if(f.from_socket.identifier==c.L[l].identifier){g=c.L[l].Da;break}for(var l=f,k=b,p=g,w=A(l.to_node,k),u=0;u<w.length;u++)for(var h=E.Va(k,w[u]),n=0;n<h.L.length;n++){var I=h.L[n];if(I.identifier==l.to_socket.identifier){h=I.Da instanceof
Object?0:1;if((p instanceof Object?0:1)==h)I.Da=p;else switch(h){case 0:I=I.Da;I[0]=I[1]=I[2]=p;break;case 1:I.Da=(p[0]+p[1]+p[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function ya(a,b,c){for(var e=a.name,d=[],f=[],g=[],l=[],k=0;k<b.length;k++){var p=b[k];oa(p.from_node,e,p,d,g,l);oa(p.to_node,e,p,f,g,l)}f=xa(b,f,g);d=xa(b,l,d);la(b,f);X(b,c,a,f);if(d.length){var w;E.oa(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(e+"*GO*")||(w=b)});X(b,c,w,d)}}function na(a){var b=[],c=[];E.oa(a,
function(a,e){switch(e.type){case "VALTORGB":b.push(e);break;case "CURVE_VEC":case "CURVE_RGB":c.push(e)}});var e=0,d=a=null,f=b.length+c.length;if(b.length){a=ta.BT(b,ta.wN);for(var g=0;g<b.length;g++)b[g].Qb.push(["NODE_TEX_ROW",ma.M((e+.5)/f)]),e++}if(c.length)for(d=ta.FT(c,ta.cE),g=0;g<c.length;g++)c[g].Qb.push(["NODE_TEX_ROW",ma.M((e+.5)/f)]),e++;g=null;a&&d?(g=new Uint8Array(a.length+d.length),g.set(a),g.set(d,a.length)):g=a?a:d;a=g?ta.DG(g,ta.cE):null;for(g=0;g<b.length;g++)b[g].data.jb=a;
for(g=0;g<c.length;g++)c[g].data.jb=a}function L(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ea=r("__config");r("__debug");var E=r("__graph"),za=r("__mat3"),ra=r("__mat4"),ka=r("__objects"),va=r("__print"),ma=r("__shaders"),Ka=r("__scenes"),Ga=r("__util"),Ca=r("__vec3"),ta=r("__textures"),Ba={},sa={},Ra={},Na={},Da=0;new Float32Array(4);var G=ea.A;a.b1=0;a.EP=1;a.DP=2;a.CP=3;a.a1=4;a.BP=5;a.AP=6;a.zP=7;a.$0=8;a.oO=0;
a.nO=1;a.T0=2;a.mO=3;a.S0=4;a.lI=function(a){return sa[a]};a.ER=function(a){delete sa[a]};a.MR=m;a.Qz=function(a,c,e){var d=Ka.B();a=n(a,"MAIN",d.uuid);if(a in Ra)return Ra[a];var d=E.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=ba(d,f,0,c,null),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=ba(d,f,0,c,null);b(d,e,g,f,[[g,[8,10]],[g,[9,6]]],c);k(d);return Ra[a]=d};a.Rt=function(a){var b=[],c={};Ba={};var e=E.uD(a);E.oa(e,function(a,e){var d;d=[];for(var f=[],g=[],l=[],k=[],p=[],w=0;w<
e.L.length;w++){var u=e.L[w];if(u.ab)d.push(null),f.push(null);else{d.push(U("in_"+e.type+"_"+u.identifier.replace(/\./g,"")));var h=ma.M(u.Da,0);G.UC&&(0<=e.type.indexOf("MIX_RGB_")&&("Color1"==u.identifier||"Color2"==u.identifier||"Fac"==u.identifier)||0<=e.type.indexOf("MATH_")&&("Value"==u.identifier||"Value_001"==u.identifier||"Value.001"==u.identifier)||0<=e.type.indexOf("VECT_MATH_")&&("Vector_001"==u.identifier||"Vector.001"==u.identifier)||0<=e.type.indexOf("LIGHTING_APPLY")||0<=e.type.indexOf("MATERIAL_END")||
0<=e.type.indexOf("MATERIAL_BEGIN"))&&(u=h,u=u.replace(/(,)/g,"$1 "),u=u.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),u=u.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),h=u=u.replace(/\s+/g,""));f.push(h)}}for(w=0;w<e.fb.length;w++)u=e.fb[w],u.ab?g.push(null):g.push(U("out_"+e.type+"_"+u.identifier.replace(/\./g,"")));for(w=0;w<e.qb.length;w++)u=e.qb[w],l.push(u.name),k.push(u.value);for(w=0;w<e.ii.length;w++)p.push(e.ii[w].name);d={id:e.type,L:d,aB:f,fb:g,qb:l,aw:k,ii:p,Qb:JSON.parse(JSON.stringify(e.Qb))};
b.push(d);c[a]=d});E.sg(e,function(a,b,d){var f=E.Va(e,a);E.Va(e,b);var g=f.fb[d[0]];a=c[a].fb;b=c[b].L;f=a[d[0]]||U("out_"+f.type+"_"+g.identifier.replace(/\./g,""));a[d[0]]=f;b[d[1]]=f});return b};a.iG=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.sa=function(){for(var a in sa)delete sa[a];for(a in Ra)delete Ra[a];for(var b in Na)delete Na[b];Da=0}};b4w.module.__debug=function(a,r){function m(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(){var a=k.HA();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=v;return b&&b.debug_view_mode==a.fp}function t(a,b,c){var e=k.HA(),d=0;if(e)for(c&&e.endQuery(),c=0;c<a.length;c++){var f=a[c],g=e.LH(f),l=M.getParameter(e.KH());g&&!l&&(d=e.MH(f)/1E6,b&&(d=D.vc(d,b,1,10)),a.splice(c,1),c--)}else d=performance.now()-
a.pop(),b&&(d=D.vc(d,b,1,10));return d}function q(a,b){z(a)||D.q("Structure assertion failed: invalid first object value");z(b)||D.q("Structure assertion failed: invalid second object value");n(a,b)||D.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||D.fB(a)||a instanceof Array)){for(var c in a)z(a[c])||D.q("Structure assertion failed: invalid value for key in the first object: "+c),c in b||D.q("Structure assertion failed: missing key in the first object: "+
c);for(c in b)z(b[c])||D.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||D.q("Structure assertion failed: missing key in the second object: "+c),n(a[c],b[c])||D.q("Structure assertion failed: incompatible types for key "+c)}}function z(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function n(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var c=a instanceof Array,e=b instanceof Array;if(c&&!e||!c&&e)return!1;
c=D.fB(a);e=D.fB(b);if(c&&!e||!c&&e)return!1}return!0}var x=r("__compat"),h=r("__config"),k=r("__extensions"),f=r("__graph"),y=r("__objects"),g=r("__print"),A=r("__scenes"),N=r("__subscene"),H=r("__textures"),O=r("__time"),D=r("__util"),P=h.A,K={},M=null,F={},c=[],l=-1,C=-1,v=null,e=null,R=!1,p={};a.Qs=0;a.Sx=1;a.Rs=2;a.Rx=3;a.Ps=4;a.Qx=5;a.Px=6;a.fp=7;a.If=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;
for(c in b){var e=b[c];e in a&&(K[a[e]]=e)}M=a};a.GX=function(a){v=a};a.K3=function(){return v};a.KT=function(a,b,c,e,d){p[a]||(p[a]={mY:b,Ne:{}});c in p[a].Ne||(p[a].Ne[c]=e);d&&(p[a].Ne[c]=0)};a.WF=function(){var a=0,b;for(b in p)for(var c in p[b].Ne)a+=p[b].Ne[c];return a};a.JL=function(){var a={},b;for(b in p)for(var c in p[b].Ne){var e=p[b].Ne[c];if(e){var d=p[b].mY;d in a||(a[d]={vD:0,Ne:{}});c in a[d].Ne||(a[d].Ne[c]=0);a[d].Ne[c]+=e;a[d].vD+=e}}for(d in a){g.groupCollapsed(d,a[d].vD);for(c in a[d].Ne)g.Zd(c,
a[d].Ne[c]);g.groupEnd()}};a.qK=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),c=0,e=0,d=y.rc(A.Jh(),"MESH",y.Jc),f=0;f<d.length;f++)for(var l=0;l<d[f].I.length;l++)for(var k=0;k<d[f].I[l].U.length;k++){var p=D.Bh(d[f].I[l].U[k]),h=p.hb.tg+"/"+p.hb.Te;p["shaders_info.directives"]=p.hb.Ei;p["shaders_info.node_elements"]=p.hb.jg;delete p.hb;for(var n=0;n<b.length;n++)delete p[b[n]];
if(d[f].Ra)e++;else{c++;p.type in a||(a[p.type]={});h in a[p.type]||(a[p.type][h]={});for(var u in p)u in a[p.type][h]||(a[p.type][h][u]=[]),n=JSON.stringify(p[u]),-1==a[p.type][h][u].indexOf(n)&&a[p.type][h][u].push(n)}}g.group("Batches statistics:");g.Zd("STATIC/DYNAMIC count:",c+"/"+e);g.group("STATIC batches diversity:");for(var v in a)for(h in a[v]){b=[];for(u in a[v][h])1<a[v][h][u].length&&b.push([u,a[v][h][u]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){g.groupCollapsed(v+" "+h);for(f=0;f<b.length;f++)g.Zd(b[f][1].length,b[f][0],b[f][1]);g.groupEnd()}}g.groupEnd();g.groupEnd()};a.wz=function(a){if(P.gl_debug){var b=M.getError();b!=M.NO_ERROR&&(b in K?D.q("GL Error: "+b+", gl."+K[b]+" ("+a+")"):D.q("Unknown GL error: "+b+" ("+a+")"))}};a.lR=function(){if(P.gl_debug||P.hG)switch(M.checkFramebufferStatus(M.FRAMEBUFFER)){case M.FRAMEBUFFER_COMPLETE:break;case M.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:g.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case M.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:g.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case M.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:g.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case M.FRAMEBUFFER_UNSUPPORTED:g.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case M.M_:g.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:g.error("FRAMEBUFFER CHECK FAILED")}};a.pR=function(){if(-1!=
l)return l;M.bindFramebuffer(M.FRAMEBUFFER,M.createFramebuffer());var a=H.zl(H.bl,!1);H.resize(a,1,1);M.framebufferTexture2D(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,a.mb,a.rb,0);M.checkFramebufferStatus(M.FRAMEBUFFER)!=M.FRAMEBUFFER_COMPLETE?(l=!0,g.warn("depth-only issue was found")):l=!1;M.bindFramebuffer(M.FRAMEBUFFER,null);return l};a.vR=function(){if(1==P.Cc)return!1;if(-1!=C)return C;M.bindRenderbuffer(M.RENDERBUFFER,M.createRenderbuffer());M.renderbufferStorageMultisample(M.RENDERBUFFER,P.Cc,M.RGBA8,
1,1);var a=M.getRenderbufferParameter(M.RENDERBUFFER,M.RENDERBUFFER_SAMPLES);a!=P.Cc?(C=!0,g.warn("multisample issue was found: requested "+P.Cc+", got "+a),M.getError()==M.INVALID_OPERATION&&g.warn("the error from multisample issue detected, ignoring")):C=!1;M.bindRenderbuffer(M.RENDERBUFFER,null);return C};a.sR=function(){return x.xz("Firefox")&&M.getError()==M.OUT_OF_MEMORY?(g.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.HK=function(a,b,c){P.gl_debug&&(c=m(c),g.error("shader compilation failed:\n"+
c+"\n"+M.getShaderInfoLog(a)+" ("+b+")"))};a.nX=function(a,b,c,e){P.gl_debug&&(c=m(c),e=m(e),g.error("shader linking failed:\n"+c+"\n\n\n"+e+"\n"+M.getProgramInfoLog(a)+" ("+b+")"))};a.tC=function(a){if(P.show_hud_debug_info||a.type==N.mp)a.kA||a.Bl.push(d())};a.iX=function(a){"MAIN"==a.type&&b()&&a.Bl.push(d())};a.uC=function(a){if((P.show_hud_debug_info||a.type==N.mp)&&!a.kA){var b=t(a.Bl,a.xf,!0);b&&(a.xf=b)}};a.jX=function(a){if("MAIN"==a.type&&b()){var c=t(a.Bl,a.xf,!0);c&&(a.xf=c)}};a.jJ=b;
a.XW=function(a){var b=t(a.Bl,a.xf,!1);b&&(a.xf=b)};a.Z2=function(a){F[a]=a in F?F[a]+1:1};a.update=function(){for(var a in F)g.log(a,F[a]),F[a]=0};a.tu=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var e=arguments[b];if(D.bk(e))for(var d=0;d<e.length;d++)a.push(e[d]);else a.push(arguments[b])}c.push(a)};a.MJ=function(){for(var a=1,b=0;b<c.length;b++){var e=c[b];e[1]==arguments[0]&&a++}e=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],D.bk(a))for(var d=0;d<a.length;d++)e.push(a[d]);
else e.push(arguments[b]);c.push(e)};var ba=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.rK=function(a){a||(a=1);for(var b=0,e={},d=Math.max(0,performance.now()-1E3*a),f=0;f<c.length;f++){var l=c[f];a=l[0];if(!(a<d)){var k=String(l[1]);e[k]||(e[k]=ba[b++%ba.length]);a=["%c"+(a/1E3).toFixed(6),e[k],k];for(k=2;k<l.length;k++)a.push(l[k]);g.log.apply(this,a)}}c.splice(0)};a.dC=function(a){a||(a=1);for(var b={},e=Math.max(0,performance.now()-1E3*a),d=0;d<c.length;d++){var f=
c[d];a=f[0];if(!(a<e))for(var l=2;l<f.length;l++){var k=String(f[1]);3<f.length&&(k+="_"+String(l-2));b[k]||(b[k]=k+"\n");b[k]+=String(a)+" "+f[l]+"\n"}}a="";for(k in b)a+=b[k]+"\n\n";g.log(a);c.splice(0)};a.U1=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.gG=function(a){if(D.bk(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.A1=function(a,b){a.constructor!=b&&D.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.C1=q;a.D1=function(a){R?q(a,e):R=!0;e=null!=a&&"object"==typeof a?D.bq(a):a};a.uH=function(a,
b,c,e,d){(a=a||null)||D.q("Stage load callback is undefined");b=b||5E3;c=c||0;e=e||100;100<e&&D.q("Max percentage must be less than 100");0>c&&D.q("Min percentage must be greater than 0");c>e&&D.q("Max percentage must be greater than min percentage");var f=O.bn(c,e,b,function(b){b=b.toFixed();a(b);100==b&&(O.Mt(f),d&&d())})};a.h6=function(a){return f.ZS(a,function(a,b){var c=b.type+"("+b.name+")",e=b.L,c=c+"\n\nINPUTS:";if(e.length)for(var d=0;d<e.length;d++)c+="\n"+e[d].identifier+": ",c=e[d].ab?
c+"linked":c+e[d].Da;else c+="\n---";e=b.fb;c+="\n\nOUTPUTS:";if(e.length)for(d=0;d<e.length;d++)c+="\n"+e[d].identifier+": ",c=e[d].ab?c+("linked(default "+e[d].Da+")"):c+"not used";else c+="\n---";d="";switch(b.type){case "GEOMETRY_UV":d="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":d="\ntexture: "+b.data.value.name+"\n("+b.data.value.Gn+")"}""==d&&(d="\n---");return c=c+"\n\nDATA:"+d},function(b,c,e){b=f.Va(a,b);c=f.Va(a,c);return b.fb[e[0]].identifier+"\n==>\n"+
c.L[e[1]].identifier})};a.Gu=function(){return M};a.sa=function(){v=null;p={}};a.reset=function(){M=null}};b4w.module.__compat=function(a,r){function m(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var t=r("__config"),q=r("__debug"),z=r("__extensions"),
n=r("__print"),x=r("__renderer"),h="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.zE=256;var k=t.il,f=t.A,y=t.uq,g=t.context,A=t.zi,N=t.W,H=t.C,O=t.Od;a.fT=function(a){a.getError()==a.INVALID_ENUM&&n.warn("Possible Tegra invalid enum issue detected, ignoring")};a.jL=function(D,r){function K(a){r&&n.warn(a)}A.kW=D.getParameter(D.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
A.Fv=D.getParameter(D.MAX_FRAGMENT_UNIFORM_VECTORS);A.BB=D.getParameter(D.MAX_TEXTURE_IMAGE_UNITS);A.Gv=D.getParameter(D.MAX_VARYING_VECTORS);A.CB=D.getParameter(D.MAX_VERTEX_ATTRIBS);A.KJ=D.getParameter(D.MAX_VERTEX_TEXTURE_IMAGE_UNITS);A.vr=D.getParameter(D.MAX_VERTEX_UNIFORM_VECTORS);A.Si=D.getParameter(D.MAX_CUBE_MAP_TEXTURE_SIZE);A.yB=D.getParameter(D.MAX_RENDERBUFFER_SIZE);A.Bc=D.getParameter(D.MAX_TEXTURE_SIZE);A.DB=D.getParameter(D.MAX_VIEWPORT_DIMS);f.cc&&!y.enabled&&(f.iq=!0);f.cc?(f.Cc=
Math.min(f.Cc,D.getParameter(D.MAX_SAMPLES)),m("Firefox")&&(K("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),f.hG=!0),m("Windows")&&m("Chrome")&&(K("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),f.Cc=1)):f.Cc=1;m("Firefox")&&"NONE"!==f.stereo&&(K("Firefox and Stereo rendering detected, disable texture reusage"),f.vH=!0);if(f.cc&&q.vR()||m("Firefox"))K("Firefox detected, disabling multisample"),f.Cc=1;x.JX();var M=Boolean(z.vU());
m("Firefox/28.0")&&(m("Linux")||m("Macintosh"))&&(K("Firefox 28 detected, applying depth hack"),M=!1);m("Windows Phone")||(m("iPad")||m("iPhone")?(K("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),g.alpha||(f.background_color[3]=1),f.PK=!0,f.gN=!0,f.smaa=!1,f.ssao=!1,f.precision="highp",f.$A=!0,Boolean(z.qI())&&O.jw&&(f.jq="pvr")):m("Mac OS X")&&m("Safari")&&
!m("Chrome")&&(K("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),f.OK=!0,N.AF=!0,N.oG=!0));m("Windows")&&(m("Chrome/40")||m("Firefox/33")||m("Firefox/34")||m("Firefox/35")||m("Firefox/36"))&&(K("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.Az=!0);m("Chrome")&&!d()&&t.fJ()&&(K('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
f.nG=!0);m("Mac OS X")&&(f.Dv=!0,K("OS X detected, applying shadows hack."));d()&&(K("Mobile detected, applying various hacks for video textures."),f.is_mobile_device=!0,m("iPad")||m("iPhone")||m("Windows Phone")||(K("Mobile (not iOS) detected, disable playback rate for video textures."),N.lH=!0));(m("Firefox/35.0")||m("Firefox/36.0"))&&m("Windows")&&(K("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.IL=!0);if(m("iPhone")||b()||m("Edge"))K("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
f.as=!0;10>A.Gv&&(K("Not enough varyings, disable shadows on blend objects"),f.iA=!0);m("Windows Phone")&&(K("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),f.debug_view=!1,f.precision="highp",f.Ni=!1,f.ssao=!1,f.smaa=!1,f.shadows=!1,f.reflections=!1,f.refractions=!1,f.vK=!1);if(m("UCBrowser")||m("Chrome")&&m("Nexus")&&f.is_mobile_device)K("Mobile Nexus Chrome or UCBrowser detected, disable workers."),H.Cs=!1;var F=z.Ku();if(F){var c=
D.getParameter(F.UNMASKED_VENDOR_WEBGL),F=D.getParameter(F.UNMASKED_RENDERER_WEBGL),l=/\b4\d{2}\b/;-1<c.indexOf("ARM")&&l.test(F)&&(K("ARM Mali-400 series detected, applying depth and frames blending hacks"),M=!1,k.BH=!0);-1<c.indexOf("ARM")&&-1<F.indexOf("Mali-T604")&&(K('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),f.precision="highp",f.shadows=!1);-1<c.indexOf("ARM")&&-1<F.indexOf("Mali-T760")&&(K('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),f.precision=
"highp",f.ssao=!1,f.Jw=!0,f.cc&&(f.Cc=1,K("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<c.indexOf("Qualcomm")&&-1<F.indexOf("Adreno")&&(K("Qualcomm Adreno detected, applying shader constants hack."),f.UC=!0,-1<F.indexOf("305")&&(K('Qualcomm Adreno305 detected, set "highp" precision.'),f.precision="highp"),-1<F.indexOf("330")&&(K('Qualcomm Adreno330 detected, set "highp" precision.'),f.precision="highp"),-1<F.indexOf("420")&&(K("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
A.Bc=4096,A.Si=4096));-1<c.indexOf("NVIDIA")&&-1<F.indexOf("Tegra 3")&&(K("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.xH=!0);m("Windows")&&m("Chrome")&&!m("Edge")&&(F.match(/NVIDIA GeForce 8..0/)||F.match(/NVIDIA GeForce 9..0/)||F.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(K("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),A.Si=a.zE,f.yC=!0);-1<F.indexOf("AMD")&&m("Windows")&&m("Chrome")&&
(f.Xy=!0);-1<F.indexOf("PowerVR")&&(K("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),f.yC=!0,f.Jw=!0,f.shadows=!1);c="";for(l=0;l<h.length;l++)if(-1<F.indexOf(h[l])){c=h[l];break}c&&(K("Architecture "+c+" detected. Blending between frames and shadows on blend objects will be disabled."),f.Jw=!0,f.iA=!0)}0==A.KJ&&(K("Vertex textures are not allowed. Disabling vertex textures"),f.ut=!1);M||(f.Iq=!1,f.hd=!1,f.water_dynamic=
!1,f.Ak=!1,f.Hw=!1,f.smaa=!1);f.SM=Boolean(z.uI())||"pvr"==f.jq;f.ju=M;if(D.getShaderPrecisionFormat)var C=D.getShaderPrecisionFormat(D.FRAGMENT_SHADER,D.HIGH_FLOAT);D.getShaderPrecisionFormat&&0!==C.precision||(f.precision="mediump");if(b()&&m("Touch")||m("Edge"))K("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),f.Fn=!0;if(b()||m("Edge"))f.aJ=!0;d()&&m("Firefox")&&(n.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
f.FB=!0,A.Bc=4096,A.Si=4096);m("Edge")&&(K("Microsoft Edge detected, set up new minimal texture size."),f.Dq=!0)};a.xz=m;a.ku=d;a.lQ=function(){m("Firefox/35.0")&&m("Windows")&&(n.warn("Windows/Firefox 35 detected, forcing context's alpha"),t.context.alpha=!0)};a.ir=b};b4w.module.__renderer=function(a,r){function m(a){for(var e=a.p,d=a.Qa,k=null,n=N.fc(e.n,ba),I=0;I<d.length;I++){var v=d[I];if(v.ac){var m=v.yb,v=v.ra;if(m.Wh!=k){l.useProgram(m.Wh);for(var k=a,u=e,C=m,y=C.DM,R=y.length;R--;){var A=y[R];A.zn(l,A.$e,k,u)}if(C.yr&&!C.Qv)for(C.aC.length||q(C),C=C.aC,R=C.length;R--;)A=C[R],A.zn(l,A.$e,k,u);k=m.Wh}for(u=0;u<v.length;u++)if(y=v[u],y.ac){C=y.bf;R=y.za;h.iX(R);h.jJ()&&"DEBUG_VIEW"==R.type&&(R.sq=H.vc(z.AQ(R.nn),R.sq,1,15));if(V.alpha_sort&&R.of){var A=C,
y=y.jv,F=n,S=R.Ba,fa=D.dist(F,y.tN),oa=V.alpha_sort_threshold*Math.min(y.DQ,1);if(fa>oa||A.Mq)f.tZ(S,y,A.n,F),D.copy(F,y.tN),A.Mq=!1}A=a;y=R;F=m;oa=F.EM;for(S=oa.length;S--;)fa=oa[S],fa.zn(l,fa.$e,C,y);if(F.yr&&!F.Qv){F.Gr.length||q(F);oa=F.Gr;for(S=oa.length;S--;)fa=oa[S],fa.zn(l,fa.$e,C,y);F.yr=!1}l.depthMask(y.Ua);y.Xb?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE);S=y.ya;fa=l;for(oa=0;oa<S.length;oa++){var x=S[oa];fa.activeTexture(fa.TEXTURE0+oa);fa.bindTexture(x.mb,x.rb)}if(A.type==g.zg){C=A;F=
F.Fm;S=C.p.pc.rb;fa=C.Al;for(oa=0;6>oa;oa++)if(x=b(oa),V.Az?(l.bindTexture(l.TEXTURE_CUBE_MAP,S),l.texImage2D(x,0,l.RGBA,1,1,0,l.RGBA,l.UNSIGNED_BYTE,c)):(l.uniformMatrix4fv(F.u_cube_view_matrix,!1,fa[oa]),l.uniform4fv(F.u_sky_tex_fac,C.Ow),l.uniform3fv(F.u_sky_tex_color,C.Mw),l.uniform1f(F.u_sky_tex_dvar,C.Nw),l.uniform3fv(F.u_horizon_color,C.he),l.uniform3fv(F.u_zenith_color,C.pe),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,x,S,0),p(y,0)),C.Ov&&3!=oa){var x=C,t=oa,X=B;V.Az?X.set(c):
(l.readPixels(191,191,1,1,l.RGBA,l.UNSIGNED_BYTE,X),255!=X[0]&&255!=X[1]&&255!=X[2]||l.readPixels(191,220,1,1,l.RGBA,l.UNSIGNED_BYTE,X));var ya=X[0],M=X[1],X=X[2],ya=ya/255,M=M/255,X=X/255;2===t?(x.ue[3]=ya,x.ue[7]=M,x.ue[11]=X):2>t?(x.ue[4*t]=ya,x.ue[4*t+1]=M,x.ue[4*t+2]=X):(x.ue[4*(t-2)]=ya,x.ue[4*(t-2)+1]=M,x.ue[4*(t-2)+2]=X)}A.tq+=6}else p(y,C.jx),A.tq++;h.jX(R);h.jJ()&&"MAIN"==R.type&&z.BQ(R.id,R.xf)}}}}function d(a){if(a){var b=(a.vb?l.COLOR_BUFFER_BIT:0)|(a.Ab?l.DEPTH_BUFFER_BIT:0);if(!b)return;
switch(a.type){case g.ee:a=F;break;case g.cd:a=P;break;case g.tf:a=K;break;case g.pf:case g.ni:case g.Rm:a=M;break;case g.yg:case g.qp:case g.jt:a=F;break;default:a=V.background_color}}else b=l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT,a=V.background_color;l.colorMask(!0,!0,!0,!0);l.depthMask(!0);l.clearColor(a[0],a[1],a[2],a[3]);l.clear(b)}function b(a){switch(a){case 0:return l.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return l.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return l.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return l.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return l.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return l.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function t(a){var b=k.QA(),c=a.Gp,e=a.Ba,d=e.kd;a.He.length=0;var f=1,g;for(g in d)f=Math.max(f,d[g].frames);for(d=0;d<f;d++){g=b.createVertexArray();R(g);e.cg&&l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,e.cg);for(var p=0;p<e.Ld.length;p++){l.bindBuffer(l.ARRAY_BUFFER,e.Ld[p].Ok);for(var u=0;u<c.length;u++){var h=c[u];h.cN==e.Ld[p].type&&(l.enableVertexAttribArray(h.$e),l.vertexAttribPointer(h.$e,h.Fc,h.Qu,h.Qu==l.FLOAT?
!1:!0,h.Dm,h.CF+h.zH*d),v(h.$e,h.Aq))}}R(null);a.He.push(g)}}function q(a){var b=a.Fm,c=a.EM,e=a.Gr,d=a.DM,f=a.aC;c.length=0;e.length=0;d.length=0;f.length=0;for(var g in b){var l=!1,k=null,p=null;switch(g){case "u_proj_matrix":k=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.wb)};l=!0;break;case "u_view_refl_matrix":k=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.ox)};l=!0;break;case "u_view_tsr":case "u_view_tsr_frag":k=function(a,b,c,e){e.lc?a.uniformMatrix3fv(b,!1,e.Rr):a.uniformMatrix3fv(b,!1,e.mf)};
l=!0;break;case "u_view_tsr_inverse":k=function(a,b,c,e){e.lc?a.uniformMatrix3fv(b,!1,e.nw):a.uniformMatrix3fv(b,!1,e.px)};l=!0;break;case "u_shadow_cast_billboard_view_tsr":k=function(a,b,c,e){a.uniformMatrix3fv(b,!1,e.es)};l=!0;break;case "u_view_proj_prev":k=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.gC)};l=!0;break;case "u_view_proj_matrix":k=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.ld)};l=!0;break;case "u_view_proj_inverse":k=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.nx)};l=!0;break;case "u_sky_vp_inverse":k=
function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.qg)};l=!0;break;case "u_camera_eye":case "u_camera_eye_frag":k=function(a,b,c,e){a.uniform3fv(b,N.fc(e.n,ba))};l=!0;break;case "u_camera_quat":k=function(a,b,c,e){a.uniform4fv(b,N.Wd(e.n,J))};l=!0;break;case "u_view_max_depth":k=function(a,b,c,e){a.uniform1f(b,e.far)};l=!0;break;case "u_camera_range":k=function(a,b,c,e){a.uniform2f(b,e.near,e.far)};break;case "u_csm_center_dists":k=function(a,b,c,e){a.uniform4fv(b,e.bu)};break;case "u_height":k=function(a,
b,c,e){a.uniform1f(b,e.height)};l=!0;break;case "u_pcf_blur_radii":k=function(a,b,c,e){a.uniform4fv(b,e.bo)};break;case "u_dof_dist":k=function(a,b,c,e){e.dof_on?a.uniform1f(b,e.dof_distance):a.uniform1f(b,0)};l=!0;break;case "u_dof_front_start":k=function(a,b,c,e){a.uniform1f(b,e.dof_front_start)};l=!0;break;case "u_dof_front_end":k=function(a,b,c,e){a.uniform1f(b,e.dof_front_end)};l=!0;break;case "u_dof_rear_start":k=function(a,b,c,e){a.uniform1f(b,e.dof_rear_start)};l=!0;break;case "u_dof_rear_end":k=
function(a,b,c,e){a.uniform1f(b,e.dof_rear_end)};l=!0;break;case "u_dof_bokeh_intensity":k=function(a,b,c,e){a.uniform1f(b,e.dof_bokeh_intensity)};l=!0;break;case "u_camera_direction":k=function(a,b,c,e){a.uniform3fv(b,e.direction)};l=!0;break;case "u_cam_water_depth":k=function(a,b,c){a.uniform1f(b,c.tz)};l=!0;break;case "u_waves_height":k=function(a,b,c){a.uniform1f(b,c.QD)};break;case "u_waves_length":k=function(a,b,c){a.uniform1f(b,c.RD)};break;case "u_fog_color_density":k=function(a,b,c){a.uniform4fv(b,
c.xe)};break;case "u_fog_params":k=function(a,b,c){a.uniform4fv(b,c.Yf)};break;case "u_underwater_fog_color_density":k=function(a,b,c){a.uniform4fv(b,c.ji)};break;case "u_bloom_key":k=function(a,b,c){a.uniform1f(b,c.Gt)};break;case "u_bloom_edge_lum":k=function(a,b,c){a.uniform1f(b,c.Ft)};break;case "u_time":k=function(a,b,c){a.uniform1f(b,c.time)};l=!0;break;case "u_wind":k=function(a,b,c){a.uniform3fv(b,c.sj)};l=!0;break;case "u_sky_tex_dvar":k=function(a,b,c){a.uniform1f(b,c.Nw)};break;case "u_sky_tex_fac":k=
function(a,b,c){a.uniform4fv(b,c.Ow)};break;case "u_sky_tex_color":k=function(a,b,c){a.uniform3fv(b,c.Mw)};break;case "u_horizon_color":k=function(a,b,c){a.uniform3fv(b,c.he)};break;case "u_zenith_color":k=function(a,b,c){a.uniform3fv(b,c.pe)};break;case "u_environment_energy":k=function(a,b,c){a.uniform1f(b,c.Og)};break;case "u_sky_color":k=function(a,b,c){a.uniform3fv(b,c.wo)};break;case "u_rayleigh_brightness":k=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":k=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":k=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":k=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":k=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":k=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":k=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":k=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":k=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":k=function(a,b,c){a.uniform4fv(b,c.rr)};break;case "u_light_directions":k=function(a,b,c){a.uniform3fv(b,c.qB)};break;case "u_light_color_intensities":k=function(a,b,c){a.uniform4fv(b,c.qr)};break;case "u_sun_quaternion":k=function(a,b,c){a.uniform4fv(b,c.iM)};break;case "u_sun_intensity":k=function(a,b,c){a.uniform3fv(b,c.hM)};
break;case "u_sun_direction":k=function(a,b,c){a.uniform3fv(b,c.hD)};break;case "u_debug_view_mode":k=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":k=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":k=function(a,b,c){a.uniform1f(b,c.eH)};break;case "u_subpixel_jitter":k=function(a,b,c){a.uniform2fv(b,c.AV)};l=!0;break;case "u_subsample_indices":k=function(a,b,c){a.uniform4fv(b,c.BV)};l=!0;break;case "u_radial_blur_step":k=
function(a,b,c){a.uniform1f(b,c.mw)};break;case "u_god_rays_intensity":k=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":k=function(a,b,c){a.uniform1f(b,c.Co)};break;case "u_ssao_blur_discard_value":k=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};l=!0;break;case "u_ssao_influence":k=function(a,b,c){a.uniform1f(b,c.Bo)};break;case "u_ssao_dist_factor":k=function(a,b,c){a.uniform1f(b,c.Ao)};break;case "u_texel_size":k=function(a,b,c){a.uniform2fv(b,
c.rD)};l=!0;break;case "u_normal_offset":k=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":k=function(a,b,c){a.uniform4fv(b,c.ix)};l=!0;break;case "u_v_light_r":k=function(a,b,c){a.uniform4fv(b,c.hx)};l=!0;break;case "u_v_light_tsr":k=function(a,b,c){a.uniformMatrix3fv(b,!1,c.LD)};l=!0;break;case "u_p_light_matrix0":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.pm[0])};l=!0;break;case "u_p_light_matrix1":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.pm[1])};l=!0;
break;case "u_p_light_matrix2":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.pm[2])};l=!0;break;case "u_p_light_matrix3":k=function(a,b,c){a.uniformMatrix4fv(b,!1,c.pm[3])};l=!0;break;case "u_outline_color":k=function(a,b,c){a.uniform3fv(b,c.aj)};break;case "u_draw_outline":k=function(a,b,c){a.uniform1f(b,c.mA)};l=!0;break;case "u_glow_mask_small_coeff":k=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};l=!0;break;case "u_glow_mask_large_coeff":k=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
l=!0;break;case "u_brightness":k=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":k=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":k=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":k=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":k=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":k=function(a,b,c){a.uniform4fv(b,c.El)};break;case "u_chromatic_aberration_coefs":k=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":k=function(a,b,c){a.uniform1f(b,c.LJ)};l=!0;break;case "u_motion_blur_decay_threshold":k=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};l=!0;break;case "u_model_tsr":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};l=!0;break;case "u_model_tsr_inverse":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.xx)};l=!0;break;case "u_transb":p=function(a,b,c){a.uniform4fv(b,c.oe)};l=!0;break;case "u_transa":p=function(a,b,c){a.uniform4fv(b,
c.Ee)};l=!0;break;case "u_arm_rel_trans":p=function(a,b,c){a.uniform4fv(b,c.Dp)};l=!0;break;case "u_arm_rel_quat":p=function(a,b,c){a.uniform4fv(b,c.Cp)};l=!0;break;case "u_quat":p=function(a,b,c){a.uniform4fv(b,N.Wd(c.n,J))};l=!0;break;case "u_quatsb":p=function(a,b,c){a.uniform4fv(b,c.ke)};l=!0;break;case "u_quatsa":p=function(a,b,c){a.uniform4fv(b,c.Be)};l=!0;break;case "u_frame_factor":p=function(a,b,c){a.uniform1f(b,c.Ue)};l=!0;break;case "au_center_pos":p=function(a,b,c){a.uniform3fv(b,c.Vp)};
l=!0;break;case "au_wind_bending_amp":p=function(a,b,c){a.uniform1f(b,c.oh)};l=!0;break;case "au_wind_bending_freq":p=function(a,b,c){a.uniform1f(b,c.ph)};l=!0;break;case "au_detail_bending_freq":p=function(a,b,c){a.uniform1f(b,c.Lg)};l=!0;break;case "au_detail_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Kg)};l=!0;break;case "au_branch_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Fg)};l=!0;break;case "u_node_values":p=function(a,b,c,e){a.uniform1fv(b,e.Yi)};l=!0;break;case "u_node_rgbs":p=function(a,
b,c,e){a.uniform3fv(b,e.ze)};l=!0;break;case "u_diffuse_color":p=function(a,b,c,e){a.uniform4fv(b,e.Uf)};l=!0;break;case "u_diffuse_intensity":p=function(a,b,c,e){a.uniform1f(b,e.Dl)};l=!0;break;case "u_diffuse_params":p=function(a,b,c,e){a.uniform2fv(b,e.Sd)};l=!0;break;case "u_emit":p=function(a,b,c,e){a.uniform1f(b,e.Nj)};l=!0;break;case "u_ambient":p=function(a,b,c,e){a.uniform1f(b,e.xj)};l=!0;break;case "u_specular_color":p=function(a,b,c,e){a.uniform3fv(b,e.Bm)};l=!0;break;case "u_specular_alpha":p=
function(a,b,c,e){a.uniform1f(b,e.ks)};l=!0;break;case "u_specular_params":p=function(a,b,c,e){a.uniform3fv(b,e.Dk)};l=!0;break;case "u_reflect_factor":p=function(a,b,c,e){a.uniform1f(b,e.ho)};l=!0;break;case "u_mirror_factor":p=function(a,b,c,e){a.uniform1f(b,e.wr)};l=!0;break;case "u_grass_map_dim":p=function(a,b,c,e){a.uniform3fv(b,e.ge)};l=!0;break;case "u_grass_size":p=function(a,b,c,e){a.uniform1f(b,e.$q)};l=!0;break;case "u_scale_threshold":p=function(a,b,c,e){a.uniform1f(b,e.Su)};l=!0;break;
case "u_cube_fog":p=function(a,b,c,e){a.uniformMatrix4fv(b,!1,e.ue)};break;case "u_jitter_amp":p=function(a,b,c,e){a.uniform1f(b,e.vv)};l=!0;break;case "u_jitter_freq":p=function(a,b,c,e){a.uniform1f(b,e.wv)};l=!0;break;case "u_wireframe_edge_color":p=function(a,b,c,e){a.uniform3fv(b,e.wireframe_edge_color)};break;case "u_cluster_id":p=function(a,b,c,e){a.uniform1f(b,e.cq)};l=!0;break;case "u_batch_debug_id_color":p=function(a,b,c,e){a.uniform1f(b,e.eu)};l=!0;break;case "u_batch_debug_main_render_time":p=
function(a,b,c,e){a.uniform1f(b,e.sq)};l=!0;break;case "u_refr_bump":p=function(a,b,c,e){a.uniform1f(b,e.ow)};l=!0;break;case "u_line_width":p=function(a,b,c,e){a.uniform1f(b,e.yv)};l=!0;break;case "u_lamp_light_positions":p=function(a,b,c,e){a.uniform3fv(b,e.Qn)};break;case "u_lamp_light_directions":p=function(a,b,c,e){a.uniform3fv(b,e.or)};break;case "u_lamp_light_color_intensities":p=function(a,b,c,e){a.uniform3fv(b,e.nr)};break;case "u_halo_size":p=function(a,b,c,e){a.uniform1f(b,e.av)};l=!0;
break;case "u_halo_hardness":p=function(a,b,c,e){a.uniform1f(b,e.Yu)};l=!0;break;case "u_halo_rings_color":p=function(a,b,c,e){a.uniform3fv(b,e.$u)};l=!0;break;case "u_halo_lines_color":p=function(a,b,c,e){a.uniform3fv(b,e.Zu)};l=!0;break;case "u_halo_stars_blend":p=function(a,b,c,e){a.uniform1f(b,e.bv)};l=!0;break;case "u_halo_stars_height":p=function(a,b,c,e){a.uniform1f(b,e.cv)};l=!0;break;case "u_fresnel_params":p=function(a,b,c,e){a.uniform4fv(b,e.Ii)};l=!0;break;case "u_texture_scale":p=function(a,
b,c,e){a.uniform3fv(b,e.di)};l=!0;break;case "u_parallax_scale":p=function(a,b,c,e){a.uniform1f(b,e.$n)};l=!0;break;case "u_color_id":p=function(a,b,c){a.uniform3fv(b,c.Gj)};l=!0;break;case "u_line_points":p=function(a,b,c,e){a.uniform3fv(b,e.V5)};l=!0;break;case "u_diffuse_color_factor":p=function(a,b,c,e){a.uniform1f(b,e.Cl)};l=!0;break;case "u_alpha_factor":p=function(a,b,c,e){a.uniform1f(b,e.el)};l=!0;break;case "u_specular_color_factor":p=function(a,b,c,e){a.uniform1f(b,e.yo)};l=!0;break;case "u_normal_factor":p=
function(a,b,c,e){a.uniform1f(b,e.Sv)};l=!0;break;case "u_normalmap0_scale":p=function(a,b,c,e){a.uniform2fv(b,e.Zi[0])};l=!0;break;case "u_normalmap1_scale":p=function(a,b,c,e){a.uniform2fv(b,e.Zi[1])};l=!0;break;case "u_normalmap2_scale":p=function(a,b,c,e){a.uniform2fv(b,e.Zi[2])};l=!0;break;case "u_normalmap3_scale":p=function(a,b,c,e){a.uniform2fv(b,e.Zi[3])};l=!0;break;case "u_foam_factor":p=function(a,b,c,e){a.uniform1f(b,e.xn)};l=!0;break;case "u_foam_uv_freq":p=function(a,b,c,e){a.uniform2fv(b,
e.wu)};l=!0;break;case "u_foam_mag":p=function(a,b,c,e){a.uniform2fv(b,e.vu)};l=!0;break;case "u_foam_scale":p=function(a,b,c,e){a.uniform2fv(b,e.Jq)};l=!0;break;case "u_water_norm_uv_velocity":p=function(a,b,c,e){a.uniform1f(b,e.Xo)};l=!0;break;case "u_shallow_water_col":p=function(a,b,c,e){a.uniform3fv(b,e.oo)};l=!0;break;case "u_shore_water_col":p=function(a,b,c,e){a.uniform3fv(b,e.qo)};l=!0;break;case "u_water_shallow_col_fac":p=function(a,b,c,e){a.uniform1f(b,e.po)};l=!0;break;case "u_water_shore_col_fac":p=
function(a,b,c,e){a.uniform1f(b,e.ro)};l=!0;break;case "u_p_length":p=function(a,b,c,e){a.uniform1f(b,e.gb.vM)};l=!0;break;case "u_p_cyclic":p=function(a,b,c,e){a.uniform1i(b,e.gb.ve)};l=!0;break;case "u_p_max_lifetime":p=function(a,b,c,e){a.uniform1f(b,e.gb.zJ)};l=!0;break;case "u_p_fade_in":p=function(a,b,c,e){a.uniform1f(b,e.gb.Il)};l=!0;break;case "u_p_fade_out":p=function(a,b,c,e){a.uniform1f(b,e.gb.zf)};l=!0;break;case "u_p_size":p=function(a,b,c,e){a.uniform1f(b,e.gb.size)};l=!0;break;case "u_p_alpha_start":p=
function(a,b,c,e){a.uniform1f(b,e.gb.nF)};l=!0;break;case "u_p_alpha_end":p=function(a,b,c,e){a.uniform1f(b,e.gb.mF)};l=!0;break;case "u_p_nfactor":p=function(a,b,c,e){a.uniform1f(b,e.gb.PB)};l=!0;break;case "u_p_gravity":p=function(a,b,c,e){a.uniform1f(b,e.gb.OI)};l=!0;break;case "u_p_mass":p=function(a,b,c,e){a.uniform1f(b,e.gb.Rh)};l=!0;break;case "u_p_color_ramp":p=function(a,b,c,e){a.uniform4fv(b,e.gb.vG)};l=!0;break;case "u_p_wind_fac":p=function(a,b,c,e){a.uniform1f(b,e.gb.oN)};l=!0;break;
case "u_p_time":p=function(a,b,c,e){a.uniform1f(b,e.gb.time)};l=!0;break;case "u_p_tilt":p=function(a,b,c,e){a.uniform1f(b,e.gb.tM)};l=!0;break;case "u_p_tilt_rand":p=function(a,b,c,e){a.uniform1f(b,e.gb.uM)};l=!0;break;case "u_position":p=function(a,b,c,e){a.uniform3fv(b,e.fl)};l=!0;break;case "u_va_frame_factor":p=function(a,b,c){a.uniform1f(b,c.kx)};l=!0;break;case "u_refl_plane":p=function(a,b,c){a.uniform4fv(b,c.lc)};l=!0;break;case "u_outline_intensity":p=function(a,b,c){a.uniform1f(b,c.dh)};
l=!0;break;case "u_obj_info":p=function(a,b,c,e){a.uniform3fv(b,e.Yn)},l=!0}p&&(p={name:g,zn:p,$e:b[g]},l?c.push(p):e.push(p));k&&(p={name:g,zn:k,$e:b[g]},l?d.push(p):f.push(p))}if(e.length||f.length){a=a.bC;for(var h in a)delete a[h];for(h=0;h<e.length;h++)p=e[h],a[p.name]=p;for(h=0;h<f.length;h++)p=f[h],a[p.name]=p}else a.Qv=!0}var z=r("__batch"),n=r("__camera"),x=r("__config"),h=r("__debug"),k=r("__extensions"),f=r("__geometry"),y=r("__quat"),g=r("__subscene"),A=r("__textures"),N=r("__tsr"),H=
r("__util"),O=r("__version"),f=r("__geometry"),D=r("__vec3"),P=[1,1,1,1],K=[1,1,1,1],M=[0,0,0,1],F=[0,0,0,0],c=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var l=null,C=null,v=null,e=null,R=null,p=null,ba=new Float32Array(3),J=y.create(),B=new Uint8Array(4),V=x.A;a.If=function(a){var b=V.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);l=a};a.sn=function(a){if(a.ac)if(a.type==g.Ym){h.tC(a);var c=a.p;l.bindFramebuffer(l.READ_FRAMEBUFFER,c.Nq);l.bindFramebuffer(l.DRAW_FRAMEBUFFER,c.Ve);var e=0;c.pc&&(e|=l.COLOR_BUFFER_BIT);c.Re&&(e|=l.DEPTH_BUFFER_BIT);l.blitFramebuffer(0,0,c.width,c.height,0,0,c.width,c.height,e,l.NEAREST);h.uC(a);h.wz("draw resolve")}else if(a.type==g.Hx)h.tC(a),c=a.p,l.bindFramebuffer(l.FRAMEBUFFER,
c.Nq),l.bindTexture(l.TEXTURE_2D,c.pc.rb),l.copyTexSubImage2D(l.TEXTURE_2D,0,0,0,0,0,c.width,c.height,0),h.uC(a),h.wz("draw copy");else{h.tC(a);c=a.p;l.bindFramebuffer(l.FRAMEBUFFER,c.Ve);a.cz&&(e=c.pc,l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,e.mb,e.rb,0));l.viewport(0,0,c.width,c.height);a.type!=g.md&&a.type!=g.Ke&&d(a);a.Jb?l.enable(l.BLEND):l.disable(l.BLEND);a.Rd?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST);switch(a.type){case g.cd:l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);l.cullFace(l.BACK);break;case g.Md:case g.sf:l.disable(l.POLYGON_OFFSET_FILL);l.cullFace(l.FRONT);break;case g.rf:l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(-4,-4);l.cullFace(l.BACK);break;case g.ee:if(1<V.Cc||V.PK){l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(-2,-2);break}default:l.disable(l.POLYGON_OFFSET_FILL),l.cullFace(l.BACK)}if(a.type==g.md||a.type==g.Ke)for(var c=a.p,e=c.pc.rb,f=0;6>f;f++){var k=b(f);c.Nb=a.Al[f];N.Ji(c.Nb,c.mf);n.qz(c);l.framebufferTexture2D(l.FRAMEBUFFER,
l.COLOR_ATTACHMENT0,k,e,0);d(a);for(var k=a.Qa,p=0;p<k.length;p++)for(var v=0;v<k[p].ra.length;v++){var C=k[p].ra[v];C.ac=C.lA[f]}m(a)}else m(a);h.uC(a);h.wz("draw subscene: "+g.gD(a))}};a.clear=function(a){l.bindFramebuffer(l.FRAMEBUFFER,a.p.Ve);d(a)};a.rQ=function(a){var b=a.Gp;b.length=0;var c=a.Ba,e=c.kd,d=a.yb.attributes,g;for(g in d){var l=e[g],k=f.Zq(g),p=f.IU(g),n=f.FI(g);b.push({cN:k,Qu:p,$e:d[g],CF:l.offset*n,zH:1<l.frames?l.length*n:0,Fc:l.Fc,Dm:l.Dm*n,Aq:l.Aq})}if("DEBUG"==O.type())for(g in e)k=
f.Zq(g),b=f.yX(c.Ld,k),b=c.Ld[b],l=a.hb.tg+" | "+a.hb.Te,k=e[g].length*e[g].frames*f.FI(g),h.KT(b.$S,l,g,k,g in d);V.Wy&&t(a)};a.wQ=t;a.GR=function(a){for(var b=k.QA(),c=0;c<a.He.length;c++)b.deleteVertexArray(a.He[c]);a.He.length=0};a.IR=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.vQ=q;a.yF=function(a){var b=a.yb,c=a.ya;a=a.Kd;l.useProgram(b.Wh);for(var e=0;e<c.length;e++)l.uniform1i(b.Fm[a[e]],e)};a.oC=function(a,b,c,e,d,f){e||(e=1);d||(d=1);f||(f=new Uint8Array(4*e*d));
f.length!=4*e*d&&H.q("read_pixels(): Wrong storage");l.bindFramebuffer(l.FRAMEBUFFER,a);l.readPixels(b,c,e,d,l.RGBA,l.UNSIGNED_BYTE,f);l.bindFramebuffer(l.FRAMEBUFFER,null);return f};a.pZ=function(a){var b=a.yb;b.Qv||(l.useProgram(b.Wh),b.Gr.length||q(b),b=b.bC.u_cube_fog,b.zn(l,b.$e,null,a))};a.hX=function(a,b){var c=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,c);if(A.Mn(a)){var e=a.Ie;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,e)}else if(A.On(a)){var d=
a,e=d.rb,d=d.mb==l.TEXTURE_CUBE_MAP?l.TEXTURE_CUBE_MAP_NEGATIVE_Z:d.mb;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,d,e,0)}A.Mn(b)?(e=b.Ie,l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,e)):A.On(b)&&(d=b,e=d.rb,d=d.mb,l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,d,e,0));h.lR();l.bindFramebuffer(l.FRAMEBUFFER,null);return c};a.gX=function(a,b,c,e,d){null==a?(l.bindFramebuffer(l.FRAMEBUFFER,a),l.viewport(0,0,e,d),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)):
(A.Mn(b)?l.deleteRenderbuffer(b.Ie):A.On(b)&&l.deleteTexture(b.rb),A.Mn(c)?l.deleteRenderbuffer(c.Ie):A.On(c)&&l.deleteTexture(c.rb),l.deleteFramebuffer(a))};a.B5=function(){};a.lT=function(a,b,c,e,d,f){a=a.rb;l.viewport(0,0,c,c);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,b,a,0);b=z.Sz("FLIP_CUBEMAP_COORDS");a=b.yb;l.activeTexture(l.TEXTURE0);l.bindTexture(l.TEXTURE_2D,d);var g=d=0;c!=e&&(d=1/(6*e),g=1/(4*e));l.uniform1i(a.Fm.u_tex_number,f);l.uniform2fv(a.Fm.u_delta,[d,g]);l.useProgram(a.Wh);
p(b,0);l.bindTexture(l.TEXTURE_2D,null)};a.mT=function(a,b,c,e,d){l.bindFramebuffer(l.FRAMEBUFFER,e);e=a.rb;a=a.mb;l.bindTexture(a,e);l.viewport(0,0,b,c);l.texImage2D(a,0,l.RGBA,b,c,0,l.RGBA,l.UNSIGNED_BYTE,null);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,a,e,0);b=z.Sz("NONE");c=b.yb;l.activeTexture(l.TEXTURE0);l.bindTexture(a,d);l.useProgram(c.Wh);p(b,0);l.bindFramebuffer(l.FRAMEBUFFER,null);l.bindTexture(a,null)};a.sa=function(){};a.JX=function(){var a=k.LU(),b=k.QA();V.lF=a?!0:!1;
V.Wy=b?!0:!1;a?(C=function(b,c,e,d){a.drawElementsInstanced(l.TRIANGLES,b,c,e,d)},v=function(b,c){a.vertexAttribDivisor(b,c)},e=function(b,c,e){a.drawArraysInstanced(l.TRIANGLES,b,c,e)}):(C=function(a,b,c){l.drawElements(l.TRIANGLES,a,b,c)},v=function(){},e=function(a,b){l.drawArrays(l.TRIANGLES,a,b)});b?(R=function(a){b.bindVertexArray(a)},p=function(a,b){var c=a.Ba;R(a.He[b]);c.cg?C(c.count,c.Ul,0,c.Yl):e(0,c.count,c.Yl);R(null)}):p=function(a,b){for(var c=a.Ba,d=a.Gp,f=0;f<c.Ld.length;f++){l.bindBuffer(l.ARRAY_BUFFER,
c.Ld[f].Ok);for(var g=0;g<d.length;g++){var k=d[g];k.cN==c.Ld[f].type&&(l.enableVertexAttribArray(k.$e),l.vertexAttribPointer(k.$e,k.Fc,k.Qu,k.Qu==l.FLOAT?!1:!0,k.Dm,k.CF+k.zH*b),v(k.$e,k.Aq))}}c.cg?(l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,c.cg),C(c.count,c.Ul,0,c.Yl)):e(0,c.count,c.Yl);for(f=0;f<d.length;f++)k=d[f],l.disableVertexAttribArray(k.$e)}};a.reset=function(){R=e=v=C=l=null}};b4w.module.__camera=function(a,r){function m(a,b,c,e,d){na.Uc(a,b);c&&D(a,b,c);M(a,e);F(a,d)}function d(a,b,c,d,f,g,l,k){var p=a.k;na.Uc(a,b);p.pivot.set(c);D(a,b,c);M(a,d);F(a,f);v(a,g);e(a,l);p.use_panning=k}function b(a,b,e,d,f,g,l,k){var h=a.k;na.Uc(a,b);h.Tb.set(e);D(a,b,e);C(a,d);c(a,f);R(a,g);p(a,l);h.Gh=k}function t(a,b,c){var e=a.k,d=L.F(e.n),f=L.R(e.n),e=Ba;e.set(ea.$c);e[3]=0;a=y(a,ka)[1];f=ea.kc(f,ea.Zc,ma);fa.oL(Da,d);fa.OC(Da,f);if(!ea.rB(e,-b,Da,c)||Math.abs(a)<ra)xa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
c[0]=d[0],c[1]=0,c[2]=d[2];return c}function q(b){for(var c=b.k,e=0;e<b.I.length;e++){var d=b.I[e].ba[0];if(d.type==a.se)switch(c.tb){case a.Ib:var f=L.F(c.n);c.Vj=E.dist(f,c.pivot);c.Wj=d.top;break;case a.bd:f=L.F(c.n),c.Vj=E.dist(f,c.Tb),c.Wj=d.top}}}function z(a){a={type:a,name:"",KL:1,width:0,height:0,Ve:null,Nq:null,pc:null,Re:null,zb:0,Ud:0,near:0,far:0,left:0,right:0,top:0,bottom:0,jd:za.create(),n:new Float32Array(9),Nb:new Float32Array(16),ox:new Float32Array(16),wb:new Float32Array(16),
ld:new Float32Array(16),nx:new Float32Array(16),gC:new Float32Array(16),qg:new Float32Array(16),direction:new Float32Array(3),mf:L.xl(),px:L.xl(),Rr:L.xl(),nw:L.xl(),es:L.xl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,mH:!1,Bd:!1,dof_on:!1,Bv:new Float32Array(3),Ih:x(),Ek:0,hf:0,lc:null,Eh:null,qq:null,bu:new Float32Array(4),bo:new Float32Array(4)};a.jd[0]=a.jd[2]=45;a.jd[1]=a.jd[3]=55;return a}function n(a,b){var c=
z(a.type);c.name=a.name;c.KL=a.KL;c.width=a.width;c.height=a.height;b||(c.Ve=a.Ve,c.Nq=a.Nq,c.pc=a.pc,c.Re=a.Re);c.zb=a.zb;c.Ud=a.Ud;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;za.copy(a.jd,c.jd);L.copy(a.n,c.n);S.copy(a.Nb,c.Nb);S.copy(a.wb,c.wb);S.copy(a.ld,c.ld);S.copy(a.nx,c.nx);S.copy(a.gC,c.gC);S.copy(a.qg,c.qg);L.copy(a.mf,c.mf);L.copy(a.px,c.px);L.copy(a.Rr,c.Rr);L.copy(a.nw,c.nw);L.copy(a.es,c.es);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;
c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.mH=a.mH;c.Bd=a.Bd;c.dof_on=a.dof_on;E.copy(a.Bv,c.Bv);var e=a.Ih,d=c.Ih;za.copy(e.left,d.left);za.copy(e.right,d.right);za.copy(e.top,d.top);za.copy(e.bottom,d.bottom);za.copy(e.near,d.near);za.copy(e.far,d.far);c.Ek=a.Ek;c.hf=a.hf;a.lc&&(c.lc=za.clone(a.lc));if(a.Eh){e=a.Eh.length;c.Eh=Array(e);for(d=0;d<e;d++)c.Eh[d]=
E.clone(a.Eh[d]);c.qq=new Float32Array(a.qq)}za.copy(a.bu,c.bu);za.copy(a.bo,c.bo);return c}function x(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function h(b){switch(b){case "STATIC":return a.xg;case "TARGET":return a.Ib;case "EYE":return a.nd;case "HOVER":return a.bd;default:ea.q("Unknown move style")}}function k(b){var c=z(b);if(b==
a.pd)return c;switch(b){case a.Nd:A(c,40,.1,1E3);break;case a.se:A(c,2.5,.1,1E3);break;case a.vh:break;case a.uh:break;case a.ri:break;case a.Mc:case a.dd:case a.Le:case a.Me:ea.q("Stereo camera may only be created from perspective one");break;default:ea.q("Unknown camera type")}return c}function f(b,c,e){b.type!=a.Mc&&b.type!=a.dd&&b.type!=a.Le&&b.type!=a.Me&&ea.q("set_stereo_params(): wrong camera type");if(b.type==a.Mc||b.type==a.dd)b.Ek=c;b.hf=e;ga(b,b.zb);if(X.Ca()&&(c=X.B(),b=c.s.ud))for(c=
oa.ja(X.Sl(c),c).ba,e=0;e<c.length;e++)ia(c[e],b)}function y(a,b){return g(L.R(a.k.n),b)}function g(a,b){var c=ea.kc(a,ea.$c,ma),e=ea.kc(a,ea.Wk,Ka),d=-Math.asin(c[2]/E.length(c)),c=Math.abs(d)>Math.PI/4?E.scale(e,-ea.sign(d),Ga):E.scale(c,-ea.sign(e[2]),Ga),f=Math.atan(Math.abs(c[0]/c[1]));0<e[2]&&(d=ea.sign(d)*Math.PI-d);e=f;0<c[1]&&(e=Math.PI-e);0>c[0]&&(e=2*Math.PI-e);b[0]=e;b[1]=d;return b}function A(b,c,e,d,f){switch(b.type){case a.Nd:case a.Mc:case a.dd:b.Ud=c;b.zb=1;break;case a.se:b.top=
c;b.zb=1;break;case a.vh:b.Ud=c;b.zb=f/c;break;case a.uh:b.top=c;b.zb=f/c;break;case a.Le:case a.Me:break;default:xa.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=e;b.far=d}function N(b,c){var e=L.fc(c.k.n,ma),d=L.Wd(c.k.n,Ca),f=S.fromRotationTranslation(d,e,Ra);S.invert(f,b.Nb);if(X.Ca())var f=X.B(),g=X.La(f,ya.qi);if(b.type==a.Mc||g&&g.enable_hmd_stereo&&b.type==a.Le)b.Nb[12]+=b.hf/2;else if(b.type==a.dd||g&&g.enable_hmd_stereo&&b.type==a.Me)b.Nb[12]-=b.hf/2;if(b.lc){L.Ji(b.Nb,
b.Rr);L.invert(b.Rr,b.nw);var f=b.lc[0],g=b.lc[1],l=b.lc[2],k=b.lc[3],p=b.ox;p[0]=1-2*f*f;p[1]=-2*f*g;p[2]=-2*f*l;p[3]=0;p[4]=-2*f*g;p[5]=1-2*g*g;p[6]=-2*g*l;p[7]=0;p[8]=-2*f*l;p[9]=-2*g*l;p[10]=1-2*l*l;p[11]=0;p[12]=-2*f*k;p[13]=-2*g*k;p[14]=-2*l*k;p[15]=1;S.multiply(b.Nb,b.ox,b.Nb);ga(b,b.zb,!0);f=Ba;g=Ra;S.invert(b.Nb,g);S.transpose(g,g);za.transformMat4(b.lc,g,f);g=sa;g[0]=(ea.sign(f[0])+b.wb[8])/b.wb[0];g[1]=(ea.sign(f[1])+b.wb[9])/b.wb[5];g[2]=-1;g[3]=(1+b.wb[10])/b.wb[14];za.scale(f,2/(f[0]*
g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.wb[2]=f[0];b.wb[6]=f[1];b.wb[10]=f[2]+1;b.wb[14]=f[3];E.transformMat4(e,b.ox,e)}L.Ji(b.Nb,b.mf);L.invert(b.mf,b.px);I(b);Q(b);L.$h(e,1,d,b.n)}function H(b,c,e,d){S.lookAt(c,e,d,b.Nb);e=X.B();e=X.La(e,ya.qi);X.Ca()&&(e=X.B(),e=X.La(e,ya.qi));if(b.type==a.Mc||e&&e.enable_hmd_stereo&&b.type==a.Le)b.Nb[12]+=b.hf/2;else if(b.type==a.dd||e&&e.enable_hmd_stereo&&b.type==a.Me)b.Nb[12]-=b.hf/2;L.Ji(b.Nb,b.mf);I(b);Q(b);L.ff(c,b.n)}function O(a,b,c){c=E.subtract(c,b,
ma);E.length(c)&&(E.normalize(c,c),c=ea.CC(ea.Zc,c,Ca),na.Zh(a,c));na.Uc(a,b)}function D(a,b,c){var e=a.k,d=0>ea.kc(L.R(a.k.n),ea.mi,ma)[2];O(a,b,c);d?(b=E.copy(e.lf,ma),E.negate(b,b),wa.Jj(a,b,!0)):wa.Jj(a,e.lf,!0)}function P(a,b){for(var c=a.k,e=b.ba,d=L.Wd(c.n,Ca),d=ea.kc(d,ea.Zc,ma),f=L.fc(c.n,Ka),g=b.HL,l=0;l<g.length;l++){var k=g[l];E.copy(d,k.direction);L.fc(c.n,k.Bv)}for(l=0;l<e.length;l++)k=e[l],N(k,a),E.copy(d,k.direction),ea.un(k.ld,k.Ih),k.dof_object&&k.dof_on&&(c=na.Bf(k.dof_object,Ga),
c=E.dist(f,c),k.dof_distance=c)}function K(b){var c=b.k;c.tb==a.Ib&&(c.Hk=0>ea.kc(L.R(b.k.n),ea.mi,ma)[2])}function M(b,c){var e=b.k;if(c){e.lb=e.lb||{};e.lb.left=c.left;e.lb.right=c.right;e.lb.Rn=c.left;e.lb.lo=c.right;e.lb.camera_space=Boolean(c.camera_space);var d=b.k;!(e=d.lb)||d.tb!=a.nd&&d.tb!=a.Ib||(d=y(b,ka),e.camera_space?(e.left+=d[0],e.right+=d[0]):(e.Rn-=d[0],e.lo-=d[0]),e.left=ea.si(e.left),e.right=ea.si(e.right),e.Rn=ea.si(e.Rn),e.lo=ea.si(e.lo))}else e.lb=null}function F(a,b){var c=
a.k;b?(c.ka=c.ka||{},c.ka.down=b.down,c.ka.up=b.up,c.ka.rn=b.down,c.ka.Qo=b.up,c.ka.camera_space=Boolean(b.camera_space),l(a)):c.ka=null}function c(a,b){var c=a.k;if(!b){var e=y(a,ka);b={down:e[1],up:e[1]}}c.ka=c.ka||{};c.ka.down=b.down;c.ka.up=b.up;l(a);c.sb&&c.ka&&w(a)}function l(b){var c=b.k,e=c.ka;if(e)switch(c.tb){case a.nd:case a.Ib:b=y(b,ka);e.camera_space?(e.up+=b[1],e.down+=b[1]):(e.Qo-=b[1],e.rn-=b[1]);e.up=ea.Bg(e.up,-Math.PI,Math.PI);e.down=ea.Bg(e.down,-Math.PI,Math.PI);e.Qo=ea.Bg(e.Qo,
-Math.PI,Math.PI);e.rn=ea.Bg(e.rn,-Math.PI,Math.PI);break;case a.bd:e.up=ea.Bg(e.up,-Math.PI,Math.PI),e.down=ea.Bg(e.down,-Math.PI,Math.PI),e.up=ea.V(e.up,-Math.PI/2,0),e.down=ea.V(e.down,-Math.PI/2,0)}}function C(a,b){var c=a.k;if(!b){var e=na.Zn(a,c.Tb);b={min:e,max:e}}c.sb=c.sb||{};c.sb.min=b.min;c.sb.max=b.max;c.sb&&c.ka&&w(a)}function v(a,b){var c=a.k;b?(c.sb=c.sb||{},c.sb.min=b.min,c.sb.max=b.max):c.sb=null}function e(a,b){var c=a.k;b?(c.ae=c.ae||{},c.ae.min_z=b.min_z,c.ae.max_z=b.max_z):c.ae=
null}function R(a,b){var c=a.k;b?(c.yc=c.yc||{},c.yc.min=b.min,c.yc.max=b.max):c.yc=null}function p(a,b){var c=a.k;b?(c.zc=c.zc||{},c.zc.min=b.min,c.zc.max=b.max):c.zc=null}function ba(b){var c=b.k;if(oa.xa(b))for(var e=b.I,d=0;d<e.length;d++){var f=e[d].ba;if(f[0].type===a.se){switch(c.tb){case a.Ib:var g=L.F(c.n),g=E.dist(g,c.pivot),g=g/c.Vj*c.Wj;break;case a.bd:g=L.F(c.n);g=E.distance(g,c.Tb);g=g/c.Vj*c.Wj;break;default:g=f[0].top}for(var l=0;l<f.length;l++){var k=f[l];k.top=g;ga(k,k.zb)}P(b,e[d])}}}
function J(b){var c=b.k,e=c.tb;if(e===a.Ib||e===a.nd){if(c.lb){var d=c.lb.left,f=c.lb.right,g=y(b,ka);(g=e==a.Ib?ea.rl(g[0],d,f):ea.rl(g[0],f,d))&&(e==a.Ib?V(b,g,0):B(b,g,0))}c.ka&&(d=c.ka.down,f=c.ka.up,g=y(b,ka),(g=e==a.Ib?ea.rl(g[1],f,d):ea.rl(g[1],d,f))&&(e==a.Ib?V(b,0,g):B(b,0,g)));if(e===a.Ib&&c.sb){var g=b.k,d=L.F(g.n),f=E.subtract(d,g.pivot,ma),l=E.length(f);l>g.sb.max?(E.scale(f,g.sb.max/l,f),E.add(g.pivot,f,d)):l<g.sb.min&&(l=ea.kc(L.R(g.n),ea.Zc,Ka),E.scale(l,100*g.sb.min,l),E.add(f,l,
f),E.scale(f,-g.sb.min/E.length(f),f),E.add(g.pivot,f,d))}}e===a.Ib&&c.ae&&(c=b.k,g=c.pivot[2],d=ea.V(c.pivot[2],c.ae.min_z,c.ae.max_z),d!=g&&(g=E.set(0,0,d-g,ma),E.add(c.pivot,g,c.pivot),c=L.F(c.n),E.add(c,g,c)));e===a.bd&&(e=b.k,e.yc&&(g=ea.V(e.Tb[0],e.yc.min,e.yc.max)-e.Tb[0],e.Tb[0]+=g,c=L.F(e.n),c[0]+=g),e.zc&&(g=ea.V(e.Tb[1],e.zc.min,e.zc.max)-e.Tb[1],e.Tb[1]+=g,c=L.F(e.n),c[1]+=g),e=b.k,c=y(b,ka)[1],(e=ea.rl(c,e.ka.up,e.ka.down))&&U(b,0,e))}function B(a,b,c,e,d){var f=a.k,g=b,l=c;if(e||d)a=
y(a,va),e&&(g=b-a[0]),d&&(l=c-a[1]);if(g||l)b=la.identity(Ca),g&&(g=la.setAxisAngle(f.lf,g,ta),la.multiply(b,g,b)),f=L.R(f.n),l&&(g=ea.kc(f,ea.li,ma),l=la.setAxisAngle(g,l,ta),la.normalize(l,l),la.multiply(b,l,b)),la.multiply(b,f,f)}function V(a,b,c,e,d){var f=a.k,g=b,l=c;if(e||d){var k=y(a,va);e&&(g=b-k[0]);d&&(l=c-k[1])}Z(a,a.k.pivot,g,l);a=y(a,va);a=ea.Bg(a[1],-Math.PI,Math.PI);f.Hk=Math.abs(a)>Math.PI/2}function U(a,b,c,e,d){var f=a.k,g=b,l=c;if(e||d){var k=y(a,va);e&&(g=b-k[0]);d&&(l=c-k[1])}f.Gh||
(g=0);Z(a,f.Tb,g,l);l&&w(a)}function Z(a,b,c,e){var d=a.k;if(c||e){a=la.identity(Ca);c&&(c=la.setAxisAngle(ea.$c,c,ta),la.multiply(a,c,a));c=L.R(d.n);if(e){var f=ea.kc(c,ea.li,ma);e=la.setAxisAngle(f,e,ta);la.normalize(e,e);la.multiply(a,e,a)}e=L.F(d.n);ea.tX(e,b,a,e);la.multiply(a,c,c)}}function w(a){var b=a.k,c=y(a,ka)[1],e=a.k;a=e.ka;e=e.sb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(e.max-e.min)+e.min;a=L.F(b.n);e=ea.kc(L.R(b.n),ea.Zc,ma);E.normalize(e,e);E.scale(e,c,e);
E.subtract(b.Tb,e,a)}function ga(b,c,e){switch(b.type){case a.Nd:c||ea.q("No aspect ratio"),b.zb=c;case a.vh:S.perspective(ea.Kb(b.Ud),b.zb,b.near,b.far,b.wb);break;case a.se:c||ea.q("No aspect ratio"),b.zb=c;case a.uh:c=b.top*b.zb;S.ortho(-c,c,-b.top,b.top,b.near,b.far,b.wb);break;case a.ri:S.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.wb);break;case a.Mc:case a.dd:c||ea.q("No aspect ratio");b.zb=c;var d=Math.tan(b.Ud*Math.PI/360);c=b.near*d;var f=b.zb*b.Ek*d;b.type==a.Mc?(d=f-b.hf/2,f+=b.hf/
2):(d=f+b.hf/2,f-=b.hf/2);d=-(b.near/b.Ek*d);f*=b.near/b.Ek;S.frustum(d,f,-c,c,b.near,b.far,b.wb);b.left=d;b.right=f;break;case a.Le:case a.Me:if(X.Ca())if(d=X.B(),(d=X.La(d,ya.qi))&&d.enable_hmd_stereo){c=Math.tan(ea.Kb(b.jd[0]));var d=Math.tan(ea.Kb(b.jd[1])),f=Math.tan(ea.Kb(b.jd[2])),g=Math.tan(ea.Kb(b.jd[3]));b.top=b.near*c;b.right=b.near*d;b.bottom=-b.near*f;b.left=-b.near*g;S.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.wb)}else c||(c=b.zb),S.perspective(ea.Kb(b.Ud),c,b.near,b.far,
b.wb);break;case a.pd:return;default:ea.q("Wrong camera type: "+b.type)}e||(I(b),Q(b))}function Q(a){S.copy(a.Nb,a.qg);a.qg[12]=0;a.qg[13]=0;a.qg[14]=0;a.qg[15]=1;S.multiply(a.wb,a.qg,a.qg);S.invert(a.qg,a.qg)}function I(a){S.copy(a.Nb,a.ld);S.multiply(a.wb,a.ld,a.ld);S.invert(a.ld,a.nx)}function Y(b,c,e,d,f){d||(d=new Float32Array(24));c||(c=b.near);e||(e=b.far);var g,l,k,p,h,u,w,E;switch(b.type){case a.pd:ea.q("Extraction from NONE camera is not possible");break;case a.Nd:case a.vh:g=c*Math.tan(b.Ud*
Math.PI/360);p=-g;l=g*b.zb;k=-l;h=e/c*g;E=-h;u=h*b.zb;w=-u;break;case a.se:case a.uh:k=b.top*b.zb;g=h=b.top;l=u=k;p=E=-b.top;k=w=-k;break;case a.ri:g=h=b.top;l=u=b.right;p=E=b.bottom;k=w=b.left;break;case a.Mc:case a.dd:h=c/b.near;g=c*Math.tan(b.Ud*Math.PI/360);p=-g;l=b.right*h;k=b.left*h;w=e/c;h=g*w;E=-h;u=l*w;w*=k;break;case a.Le:case a.Me:h=c/b.near;g=b.top*h;p=b.bottom*h;l=b.right*h;k=b.left*h;w=e/c;h=g*w;E=p*w;u=l*w;w*=k;break;default:ea.q("Wrong camera type: "+b.type)}d[0]=k;d[1]=p;d[2]=-c;
d[3]=l;d[4]=p;d[5]=-c;d[6]=l;d[7]=g;d[8]=-c;d[9]=k;d[10]=g;d[11]=-c;d[12]=w;d[13]=E;d[14]=-e;d[15]=w;d[16]=h;d[17]=-e;d[18]=u;d[19]=h;d[20]=-e;d[21]=u;d[22]=E;d[23]=-e;f&&(c=Ra,S.invert(b.Nb,c),ea.eo(d,c,d,0));return d}function ia(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Eh){var e=b.csm_num;a.Eh=Array(e);for(var d=0;d<e;d++)a.Eh[d]=new Float32Array(3);a.qq=new Float32Array(e)}for(e=0;e<c;e++){var d=0==e?a.near:u(b,a,e-1),f=u(b,a,e),d=Y(a,d,f,Na),d=ja.FU(d);a.Eh[e].set(d.G);a.qq[e]=d.Xa;a.bu[e]=
E.length(d.G);a.bo[e]=aa(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,e)}}else a.bo[0]=b.first_cascade_blur_radius}function u(a,b,c){var e=a.csm_num,d=ea.V(a.csm_first_cascade_border,b.near,b.far);a=ea.V(a.csm_last_cascade_border,b.near,b.far);return ea.V(aa(d,a,e,c),b.near,b.far)}function aa(a,b,c,e){switch(e){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,e/(c-1))}return a}function ca(a,b){b||(b=new Float32Array(3));E.copy(L.F(a.k.n),b);return b}var ja=r("__boundings");
r("__config");var wa=r("__constraints"),pa=r("__container"),S=r("__mat4"),fa=r("__math"),oa=r("__obj_util"),xa=r("__print"),la=r("__quat"),X=r("__scenes"),ya=r("__subscene"),na=r("__transform"),L=r("__tsr"),ea=r("__util"),E=r("__vec3"),za=r("__vec4");a.pd=10;a.Nd=20;a.se=30;a.vh=40;a.uh=50;a.ri=60;a.Mc=70;a.dd=80;a.Le=90;a.Me=100;a.xg=0;a.Ib=2;a.nd=3;a.bd=4;var ra=ea.Kb(.5),ka=new Float32Array(2),va=new Float32Array(2),ma=new Float32Array(3),Ka=new Float32Array(3),Ga=new Float32Array(3),Ca=new Float32Array(4),
ta=new Float32Array(4),Ba=new Float32Array(4),sa=new Float32Array(4),Ra=new Float32Array(16),Na=new Float32Array(24),Da=new Float32Array(6);a.dR=function(c,e){var f=e.k,g=c.data;switch(g.type){case "PERSP":var l=k(a.Nd);if(g.angle_y)var p=ea.df(g.angle_y);A(l,p,g.clip_start,g.clip_end);break;case "ORTHO":l=k(a.se),A(l,g.ortho_scale/2,g.clip_start,g.clip_end)}l.name=e.name;p=e.I;p[0].ba.push(l);for(var u=1;u<p.length;u++){var w=n(l,!1);p[u].ba.push(w)}f.tb=h(g.b4w_move_style);f.dof_distance=g.dof_distance;
l=g.dof_object;f.dof_object=l?l.nb:null;f.dof_front_start=g.b4w_dof_front_start;f.dof_front_end=g.b4w_dof_front_end;f.dof_rear_start=g.b4w_dof_rear_start;f.dof_rear_end=g.b4w_dof_rear_end;f.dof_power=g.b4w_dof_power;f.dof_bokeh=g.b4w_dof_bokeh;f.dof_bokeh_intensity=g.b4w_dof_bokeh_intensity;f.Bd=g.b4w_dof_foreground_blur;f.Qk=g.b4w_trans_velocity;f.Pk=g.b4w_rot_velocity;f.Rk=g.b4w_zoom_velocity;l=e.k.tb;p=c.data;u=null;l!=a.Ib&&l!=a.nd||!p.b4w_use_horizontal_clamping||(u={left:p.b4w_rotation_left_limit,
right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},l==a.nd&&(u.left*=-1,u.right*=-1));l=u;p=e.k.tb;u=c.data;w=null;p!=a.Ib&&p!=a.nd||!u.b4w_use_vertical_clamping?p==a.bd&&u.b4w_use_zooming&&(u.b4w_hover_angle_min<=u.b4w_hover_angle_max?(w={down:u.b4w_hover_angle_min,up:u.b4w_hover_angle_max},w.down*=-1,w.up*=-1):xa.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(w={down:u.b4w_rotation_down_limit,up:u.b4w_rotation_up_limit,camera_space:"LOCAL"==
u.b4w_vertical_clamping_type},p==a.Ib&&(w.down*=-1,w.up*=-1));var p=w,u=e.k.tb,w=c.data,E=null;u==a.Ib&&w.b4w_use_target_distance_limits&&w.b4w_distance_min<=w.b4w_distance_max?E={min:w.b4w_distance_min,max:w.b4w_distance_max}:u===a.bd&&w.b4w_use_zooming&&(w.b4w_distance_min<=w.b4w_distance_max?E={min:w.b4w_distance_min,max:w.b4w_distance_max}:xa.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));u=E;w=c.data;E=null;e.k.tb==a.bd&&w.b4w_use_horizontal_clamping&&w.b4w_horizontal_translation_min<=
w.b4w_horizontal_translation_max&&(E={min:w.b4w_horizontal_translation_min,max:w.b4w_horizontal_translation_max});var w=E,E=c.data,v=null;e.k.tb==a.bd&&E.b4w_use_vertical_clamping&&E.b4w_vertical_translation_min<=E.b4w_vertical_translation_max&&(v={min:E.b4w_vertical_translation_min,max:E.b4w_vertical_translation_max});var E=v,v=c.data,I=null;e.k.tb==a.Ib&&v.b4w_use_pivot_limits&&(I={min_z:v.b4w_pivot_z_min,max_z:v.b4w_pivot_z_max});v=I;switch(f.tb){case a.nd:f=L.F(e.k.n);m(e,f,null,l,p);break;case a.Ib:f=
L.F(e.k.n);d(e,f,g.b4w_target,l,p,u,v,g.b4w_use_panning);break;case a.bd:f=L.F(e.k.n),l=t(e,c.data.b4w_hover_zero_level,Ka),b(e,f,l,u,p,w,E,g.b4w_enable_hover_hor_rotation)}J(e);q(e)};a.BL=m;a.DL=d;a.CL=b;a.Jn=q;a.Ec=n;a.$R=x;a.e6=h;a.gd=k;a.Q1=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.pc);case "DEPTH":return Boolean(a.Re);case "SCREEN":return!Boolean(a.pc)&&!Boolean(a.Re);default:ea.q("Wrong attachment type: "+b)}};a.vw=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.pc=
c;break;case "DEPTH":a.Re=c;break;case "SCREEN":a.pc=null;a.Re=null;break;default:ea.q("Wrong attachment type: "+b)}};a.x3=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.pc;case "DEPTH":return a.Re;case "SCREEN":return null;default:ea.q("Wrong attachment type: "+b)}};a.Ev=function(b,c){(b.type!=a.Nd||c!=a.Mc&&c!=a.dd&&c!=a.Le&&c!=a.Me)&&ea.q("make_stereo(): wrong camera type");b.type=c;f(b,6,.065)};a.$X=f;a.Bn=y;a.FA=g;a.Du=function(a,b){y(a,b);b[0]=ea.si(b[0]+Math.PI);b[1]*=-1;return b};
a.yw=A;a.NX=function(b,c,e,d,f,g,l){switch(b.type){case a.ri:b.left=c;b.right=e;b.bottom=d;b.top=f;b.near=g;b.far=l;break;default:xa.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.Tl=function(a){return a.k.tb};a.hY=N;a.M7=H;a.TC=function(a,b,c){var e=ma;e[0]=0;e[1]=0;e[2]=-1;E.transformQuat(e,c,e);e[0]+=b[0];e[1]+=b[1];e[2]+=b[2];var d=Ka;d[0]=0;d[1]=1;d[2]=0;E.transformQuat(d,c,d);H(a,b,e,d)};a.Bw=O;a.TX=D;a.xZ=P;a.wZ=function(b){var c=b.k;J(b);ba(b);switch(c.tb){case a.Ib:var e=
L.F(c.n);wa.uX(e,L.R(c.n),c.pivot);for(var d=0;d<b.I.length;d++)for(var g=b.I[d].ba,l=0;l<g.length;l++){var k=g[l];k.type!=a.Mc&&k.type!=a.dd||f(k,E.dist(e,c.pivot),k.hf)}wa.Jj(b,c.lf);break;case a.nd:b.ic||wa.Jj(b,c.lf)}K(b)};a.GD=K;a.kL=M;a.xL=F;a.fv=c;a.ev=C;a.IX=v;a.XX=e;a.OX=R;a.gY=p;a.GZ=ba;a.Wr=B;a.pw=V;a.Xr=U;a.H5=function(b){switch(b.type){case a.Nd:case a.se:case a.Mc:case a.dd:return!0;default:return!1}};a.NH=function(b){switch(b.type){case a.Nd:case a.vh:case a.Mc:case a.dd:return ea.Kb(b.Ud);
default:return xa.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.yk=ga;a.DX=function(b,c,e,d,f){var g=1/Math.max(f,d);switch(b.type){case a.Nd:case a.vh:f/=2;d/=2;e=-(e-f)/f*Math.tan(ea.Kb(b.Ud)/2);c=(c-d)/d*Math.tan(ea.Kb(b.Ud)/2)*b.zb;d=b.near*(e+g);f=b.near*(c+g);e=b.near*(e-g);c=b.near*(c-g);S.frustum(c,f,e,d,b.near,b.far,b.wb);break;case a.se:case a.uh:b.right=b.top*b.zb;e=-e/f;c/=d;d=b.top+(e+g)*(b.top+b.top);f=-b.right+(c+g)*(b.right+b.right);e=b.top+(e-g)*(b.top+b.top);
c=-b.right+(c-g)*(b.right+b.right);S.ortho(c,f,e,d,b.near,b.far,b.wb);break;case a.ri:e=-e/f,c/=d,d=b.top+(e+g)*(b.top-b.bottom),f=b.left+(c+g)*(b.right-b.left),e=b.top+(e-g)*(b.top-b.bottom),c=b.left+(c-g)*(b.right-b.left),S.ortho(c,f,e,d,b.near,b.far,b.wb)}S.copy(b.Nb,b.ld);S.multiply(b.wb,b.ld,b.ld);ea.un(b.ld,b.Ih)};a.qz=Q;a.XF=I;a.CT=Y;a.sQ=function(a){a=a.k;var b=ja.Pd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.O=b;var c=ja.nz(1,ea.yf([0,0,0]));a.wa=c;a.Hp=ja.GF(1,b);
a.Jp=ja.IF(1,b);a.Ip=ja.HF(1,b)};a.Nn=function(b){return oa.xa(b)&&b.k&&b.k.tb==a.xg};a.Ea=function(b){return oa.xa(b)&&b.k&&b.k.tb==a.Ib};a.tc=function(b){return oa.xa(b)&&b.k&&b.k.tb==a.nd};a.$a=function(b){return oa.xa(b)&&b.k&&b.k.tb==a.bd};a.sv=function(b){return oa.xa(b)&&b.k&&b.I[0].ba[0].type==a.se};a.FD=ia;a.US=u;a.hC=function(b,c,e){b=b.I[0].ba[0];switch(b.type){case a.Nd:case a.vh:case a.se:case a.uh:case a.Mc:case a.dd:case a.Le:case a.Me:var d=Ba;d.set(c);d[3]=1;za.transformMat4(d,b.ld,
d);c=-d[1]/d[3];e[0]=(d[0]/d[3]+1)/2*b.width;e[1]=(c+1)/2*b.height;pa.h_(e[0],e[1],e,b);2<e.length&&(e[2]=(d[2]/Math.abs(d[3])+1)/2);return e;default:return xa.error("Non-compatible camera"),e}};a.yU=function(a){return a.I[0].ba[0]};a.Dn=function(b,c){switch(b.type){case a.Nd:case a.vh:case a.Mc:case a.dd:var e=Math.tan(ea.Kb(b.Ud)/2);switch(c){case "LEFT":return-e*b.zb;case "RIGHT":return e*b.zb;case "TOP":return e;case "BOTTOM":return-e}break;case a.se:case a.uh:switch(c){case "LEFT":return-b.top*
b.zb;case "RIGHT":return b.top*b.zb;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.ri:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Le:case a.Me:switch(c){case "LEFT":return-Math.tan(ea.Kb(Math.min(b.jd[1],b.jd[3])));case "RIGHT":return Math.tan(ea.Kb(Math.min(b.jd[1],b.jd[3])));case "TOP":return Math.tan(ea.Kb(Math.min(b.jd[0],b.jd[2])));case "BOTTOM":return-Math.tan(ea.Kb(Math.min(b.jd[0],b.jd[2])))}break;
default:ea.q("Unknown camera type")}};a.xV=function(b){switch(b.type){case a.se:case a.uh:case a.ri:return!0;default:return!1}};a.DU=function(b,c){switch(b.type){case a.Nd:case a.vh:case a.Mc:case a.dd:var e=ea.Kb(b.Ud);return c?e*b.zb:e;default:return 0}};a.ds=function(a,b,c){a=a.k;L.ff(b,a.n);E.copy(c,a.pivot)};a.Aw=function(a,b){var c=a.k,e=E.subtract(b,c.Tb,ma),e=E.add(e,L.F(c.n),e);na.Uc(a,e);E.copy(b,c.Tb)};a.aY=function(a,b){var c=a.k,e=E.subtract(b,c.pivot,ma),e=E.add(e,L.F(c.n),e);na.Uc(a,
e);E.copy(b,c.pivot)};a.bI=ca;a.NC=function(c,e){c.k.tb=e;c.k.lb=null;c.k.ka=null;c.k.sb=null;c.k.yc=null;c.k.zc=null;q(c);switch(e){case a.bd:var d=L.F(c.k.n),f=t(c,0,Ka);b(c,d,f,null,null,null,null,c.k.Gh);break;case a.Ib:d=ca(c,ma),f=ea.kc(L.R(c.k.n),ea.Zc,Ka),f=E.scaleAndAdd(d,f,10,f),E.copy(f,c.k.pivot)}};a.Hs=function(a){a=a.k;a.tb=0;E.set(0,0,0,a.pivot);E.set(0,0,0,a.Tb);a.Hk=!1;a.use_panning=!1;a.lb=null;a.ka=null;a.sb=null;a.yc=null;a.zc=null;a.ae=null;a.Gh=!0};a.IC=function(a,b){for(var c=
0;c<a.length;c++){var e=a[c];70!=e.type&&80!=e.type&&90!=e.type&&100!=e.type||f(e,e.Ek,b)}};a.MC=function(a,b,c){var e=X.B();a=oa.ja(a,e).ba;for(e=0;e<a.length;e++){var d=a[e];if(90==d.type||100==d.type)90==d.type&&za.copy(b,d.jd),100==d.type&&za.copy(c,d.jd),d.lc||ga(d),I(d),Q(d)}}};b4w.module.__constraints=function(a,r){function m(a){var b={};b.type=a;return b}function d(a,c){a.ic&&a.ic.Fa&&b(a.ic.Fa,a);if(c.Fa){var d=c.Fa;-1==d.Pe.indexOf(a)?d.Pe.push(a):A.q("Descendant object override is forbidden")}a.ic=c}function b(a,b){var c=a.Pe.indexOf(b);-1!=c?a.Pe.splice(c,1):A.q("No descendant object")}function t(a,b,d){switch(b.type){case 1:var f=g.R(a.k.n),m=b.Fa.k.n;d=g.R(b.Fa.k.n);b.le?(y.copy(b.le,f),y.multiply(d,f,f)):y.copy(d,f);var q=g.Vc(b.offset,m,D);g.ff(q,a.k.n);g.Hf(b.Yr*
g.Xd(b.Fa.k.n),a.k.n);break;case 9:q=g.F(a.k.n);f=g.R(a.k.n);m=b.Fa.k.n;d=g.R(b.Fa.k.n);y.multiply(y.invert(b.qm,b.qm),f,f);y.multiply(d,f,f);g.Vc(b.offset,m,q);y.copy(d,b.qm);break;case 10:q=g.F(a.k.n);f=g.R(a.k.n);m=b.Fa.k.n;d=g.R(b.Fa.k.n);y.multiply(y.invert(b.qm,b.qm),f,f);y.multiply(d,f,f);g.Vc(b.offset,m,q);y.copy(d,b.qm);q=g.R(a.k.n);f=y.multiply(g.R(b.Fa.k.n),b.le,F);f=h.FA(f,H);q=h.FA(q,O);h.Wr(a,A.rl(q[0],f[0]+b.BR,f[0]+b.AR),A.rl(q[1],f[1]+b.zR,f[1]+b.CR));break;case 13:var q=g.F(a.k.n),
f=g.R(a.k.n),m=b.Fa.k.n,t=g.F(m),M=b.uY,r=D,w=F;g.Vc(b.offset,m,r);A.Qw(r,q,d,M,q);m=D;N.sub(t,q,m);N.normalize(m,m);var ga=f,q=c,t=q.subarray(0,3),r=q.subarray(3,6),Q=q.subarray(6,9);N.copy(m,Q);N.negate(Q,Q);N.normalize(Q,Q);Boolean(.999999<Math.abs(N.dot(m,A.$c)))?(m=k.fromQuat(y.normalize(ga,w),l),N.copy(m.subarray(0,3),t)):N.cross(A.$c,Q,t);N.normalize(t,t);N.cross(Q,t,r);N.normalize(r,r);y.fromMat3(q,w);y.normalize(w,w);A.SL(w,f,d,.16*M,f);break;case 2:f=g.R(a.k.n);d=C;x.Cu(b.Fa,b.pl,!0,d);
g.multiply(b.Fa.k.n,d,d);f[0]=d[4];f[1]=d[5];f[2]=d[6];f[3]=d[7];b.le&&(y.copy(b.le,f),y.multiply(f,b.le,f));g.Hf(b.Yr*d[3],a.k.n);q=g.F(a.k.n);g.Vc(b.offset,d,q);break;case 3:q=g.F(a.k.n);f=g.R(a.k.n);d=g.F(b.Fa.k.n);z(q,f,d);break;case 4:q=g.F(a.k.n);f=g.R(a.k.n);d=b.target;z(q,f,d);break;case 5:q=g.F(a.k.n);f=g.R(a.k.n);d=g.F(b.Fa.k.n);z(q,f,d);f=N.dist(q,d);if(f=f>b.Mg?f-b.Mg:f<b.xq?f-b.xq:0)N.sub(d,q,D),N.normalize(D,D),N.scale(D,f,D),N.add(q,D,q);break;case 6:q=g.F(a.k.n);f=g.R(a.k.n);d=b.target;
z(q,f,d);f=N.dist(q,d);if(f=f>b.Mg?f-b.Mg:f<b.xq?f-b.xq:0)N.sub(d,q,D),N.normalize(D,D),N.scale(D,f,D),N.add(q,D,q);break;case 7:m=b.Fa.k.n;q=g.F(a.k.n);g.Vc(b.offset,m,q);break;case 8:t=g.F(b.Fa.k.n);q=g.F(a.k.n);N.add(t,b.offset,q);break;case 14:f=g.R(a.k.n);m=b.Fa.k.n;d=g.R(b.Fa.k.n);b.le?(y.copy(b.le,f),y.multiply(d,f,f)):y.copy(d,f);q=g.F(a.k.n);g.Vc(b.offset,m,q);break;case 11:g.multiply(b.Fa.k.n,b.dx,a.k.n);break;case 12:q=b.dx;d=C;x.Cu(b.Fa,b.pl,!0,d);g.multiply(b.Fa.k.n,d,d);g.multiply(d,
q,a.k.n);break;case 15:f=b.Fa,d=h.yU(f),q=g.F(a.k.n),m=h.Dn(d,"LEFT"),t=h.Dn(d,"RIGHT"),M=h.Dn(d,"TOP"),w=h.Dn(d,"BOTTOM"),r="heights"==b.hor_units?M-w:t-m,b.yJ?(m=h.Dn(d,"LEFT"),q[0]=m+r*b.oB):(t=h.Dn(d,"RIGHT"),q[0]=t-r*b.oB),m="heights"==b.vert_units?M-w:t-m,q[1]=b.yM?M-m*b.tD:w+m*b.tD,h.xV(d)?q[2]=-b.distance:(q[2]=-1,N.normalize(q,q),N.scale(q,b.distance/Math.abs(q[2]),q)),g.wd(q,f.k.n,q),N.add(g.F(f.k.n),q,q),q=g.R(a.k.n),f=g.R(f.k.n),b.le?(y.copy(b.le,q),y.multiply(f,q,q)):y.copy(f,q)}"CAMERA"==
a.k.type&&(q=a.k.lf,10==b.type&&(d=g.R(b.Fa.k.n),q=N.transformQuat(q,d,v)),h.GD(a),n(a,q))}function q(a,b){switch(b.type){case 1:var c=b.target.k.n,d=C;g.invert(a.k.n,d);g.multiply(d,c,d);x.CX(a,b.pl,d)}a.OB=!0}function z(a,b,c){var d=D;A.kc(b,A.Zc,d);N.normalize(d,d);var f=P;N.subtract(c,a,f);N.normalize(f,f);a=A.CC(d,f,M);y.multiply(a,b,b);y.normalize(b,b)}function n(a,b,c){var d=a.k,f=g.R(d.n),l=A.kc(f,A.$c,D);N.normalize(l,l);if(.999999<Math.abs(N.dot(b,l)))l=y.identity(F);else{var k=N.cross(b,
l,P);N.normalize(k,k);d.tb==h.Ib?d.Hk&&N.negate(k,k):(d=A.kc(f,A.Wk,K),0<N.dot(d,b)&&N.negate(k,k));d=A.kc(f,A.li,K);N.normalize(d,d);var n=A.V(N.dot(d,k),-1,1),l=-.999999>=n?y.setAxisAngle(l,Math.acos(n),F):y.rotationTo(d,k,F);y.normalize(l,l)}y.multiply(l,f,f);c&&(c=A.kc(f,A.mi,D),0>N.dot(b,c)&&y.rotateZ(f,Math.PI,f));h.GD(a)}var x=r("__armature"),h=r("__camera"),k=r("__mat3"),f=r("__print"),y=r("__quat"),g=r("__tsr"),A=r("__util"),N=r("__vec3");a.F_=1;a.E_=2;a.J_=3;a.K_=4;a.z_=5;a.A_=6;a.G_=7;
a.y_=8;a.D_=9;a.C_=10;a.w_=11;a.x_=12;a.B_=13;a.H_=14;a.I_=15;a.t_=1;var H=new Float32Array(2),O=new Float32Array(2),D=new Float32Array(3),P=new Float32Array(3),K=new Float32Array(3),M=new Float32Array(4),F=new Float32Array(4),c=new Float32Array(9),l=new Float32Array(9),C=g.create(),v=new Float32Array(3);a.pF=function(a,b,c,f,g){var l=m(1);l.Fa=b;l.offset=new Float32Array(c);l.le=f?new Float32Array(f):null;l.Yr=g;d(a,l);t(a,l,0)};a.bQ=function(a,b,c,f,g,l){var k=m(2);k.Fa=b;k.pl=c;k.offset=new Float32Array(f);
k.le=g?new Float32Array(g):null;k.Yr=l;d(a,k);t(a,k,0)};a.$P=function(a,b,c,f){var l=m(9),k=g.R(a.k.n),h=g.R(b.k.n);l.Fa=b;l.offset=new Float32Array(c);l.qm=new Float32Array(h);f&&(y.copy(f,k),y.multiply(h,k,k));d(a,l);t(a,l,0)};a.ZP=function(a,b,c,f,l,k,h,n){var v=m(10),w=g.R(a.k.n),C=g.R(b.k.n);v.Fa=b;v.offset=new Float32Array(c);v.qm=new Float32Array(C);v.AR=A.si(l);v.BR=A.si(k);v.CR=A.Bg(h,-Math.PI,Math.PI);v.zR=A.Bg(n,-Math.PI,Math.PI);f?(v.le=new Float32Array(f),y.copy(f,w),y.multiply(C,w,w)):
v.le=y.create();d(a,v);t(a,v,0)};a.YP=function(a,b,c,f){var g=m(13);g.Fa=b;g.offset=new Float32Array(c);g.uY=f;d(a,g);t(a,g,0)};a.fQ=function(a,b,c,f){var g=m(14);g.Fa=b;g.offset=new Float32Array(c);g.Yr=1;g.le=f?new Float32Array(f):null;d(a,g);t(a,g,0)};a.I6=b;a.hQ=function(a,b){var c=m(3);c.Fa=b;d(a,c);t(a,c,0)};a.iQ=function(a,b){var c=m(4);c.target=new Float32Array(b);d(a,c);t(a,c,0)};a.UP=function(a,b,c,f){var g=m(5);g.Fa=b;g.xq=c;g.Mg=f;d(a,g);t(a,g,0)};a.VP=function(a,b,c,f){var g=m(6);g.target=
new Float32Array(b);g.xq=c;g.Mg=f;d(a,g);t(a,g,0)};a.eQ=function(a,b){var c=m(7);c.Fa=b;c.offset=new Float32Array([0,0,.5]);d(a,c);t(a,c,0)};a.SP=function(a,b,c){var f=m(8);f.Fa=b;f.offset=new Float32Array(c);d(a,f);t(a,f,0)};a.QP=function(a,b,c){var f=m(11);f.Fa=b;f.dx=new Float32Array(c);d(a,f);t(a,f,0)};a.RP=function(a,b,c,f){var g=m(12);g.Fa=b;g.pl=c;g.dx=new Float32Array(f);d(a,g);t(a,g,0)};a.$y=function(a,b,c){var g=m(15);g.Fa=b;if(A.Oh(c.left))g.yJ=!0,g.oB=c.left;else if(A.Oh(c.right))g.yJ=
!1,g.oB=c.right;else{f.error("append_stiff_viewport: Wrong positioning params");return}if(A.Oh(c.top))g.yM=!0,g.tD=c.top;else if(A.Oh(c.bottom))g.yM=!1,g.tD=c.bottom;else{f.error("append_stiff_viewport: Wrong positioning params");return}A.Oh(c.distance)?(g.distance=c.distance,g.le=A.Oh(c.rotation)?new Float32Array(c.rotation):null,g.hor_units=A.Oh(c.hor_units)?c.hor_units:"widths",g.vert_units=A.Oh(c.vert_units)?c.vert_units:"heights",d(a,g),t(a,g,0)):f.error("append_stiff_viewport: Wrong positioning params")};
a.yZ=function(a,b){a.ic&&t(a,a.ic,b)};a.cQ=function(a,b,c,d,f){var g=m(1);g.pl=c;g.target=b;g.offset=new Float32Array(d);g.le=f?new Float32Array(f):null;g.Yr=1;b=g.target;c=g.pl;d=a.k.Dg[c];f=b.Gz;for(var l=0;l<f;l++){var k=f[l];if(k[0]==a&&k[1]==c){f.splice(l,1);break}}b.Gz.push([a,c]);d.ic=g;q(a,g)};a.qZ=function(a,b){var c=a.k.Dg[b];c.ic&&q(a,c.ic)};a.uX=z;a.Jj=n;a.oR=function(a){return a.ic?!0:!1};a.remove=function(a){a.ic.Fa&&b(a.ic.Fa,a);a.ic=null};a.L4=function(a){return a.ic?a.ic.type:null};
a.bg=function(a){a=a.ic;return!a||11!=a.type&&12!=a.type?!1:!0};a.Eu=function(a){if((a=a.ic)&&11==a.type)return a.Fa.k.n;if(a&&12==a.type){var b=C;x.Cu(a.Fa,a.pl,!0,b);g.multiply(a.Fa.k.n,b,b);return b}return null};a.$f=function(a){a=a.ic;return!a||11!=a.type&&12!=a.type?null:a.dx}};b4w.module.__container=function(a,r){var m,d,b,t,q;function z(a,b){m=a;d=b}function n(){var a=c.getBoundingClientRect();z(a.left,a.top)}function x(){return K.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function h(b,d,f){if(!b||!d){b=a.Lx;d=a.Kx;var h=C;h.style.width=a.Lx+"px";h.style.height=a.Kx+"px"}var h=c,n=l;!1!==f&&(h.style.width=b+"px",h.style.height=d+"px",n&&(n.style.width=b+"px",n.style.height=d+"px"));n&&(n.width=b,n.height=d,g.rs());f=Math.floor(b*K.canvas_resolution_factor);d=Math.floor(d*
K.canvas_resolution_factor);x()&&(f*=window.devicePixelRatio,d*=window.devicePixelRatio);if(n=H.Jh())n=n.s,f=Math.floor(f*n.jo),d=Math.floor(d*n.jo);h.width=f;h.height=d;var n=Math.min(F.drawingBufferWidth,M.yB,M.DB[0]),v=Math.min(F.drawingBufferHeight,M.yB,M.DB[1]);if(f>n||d>v)N.warn("Canvas size exceeds platform limits, downscaling"),n=Math.min(n/f,v/d),f*=n,d*=n,h.width=f,h.height=d;H.AL(f,d,f/b);H.Ca()&&D.D(H.B().vj);y.CZ(h.width,h.height);y.Vg()&&(k.update(),H.update(O.Wq(),0),k.RM())}var k=
r("__anchors"),f=r("__config"),y=r("__data"),g=r("__hud"),A=r("__input"),N=r("__print"),H=r("__scenes"),O=r("__time"),D=r("__transform"),P=r("__util"),K=f.A,M=f.zi,F=null,c=null,l=null,C=null,v=!1;t=b=0;q=1;m=d=0;a.Lx=320;a.Kx=240;a.If=function(a){F=a};a.Cn=function(){return c};a.WH=function(){return l};a.We=function(){return C};a.Tg=function(a,b){a&&a.parentNode?(c=a,l=b,C=a.parentNode):P.q("canvas container is not available")};a.lv=function(a,b){b=b||"LAST";switch(b){case "FIRST":C.insertBefore(a,
C.firstElementChild);break;case "JUST_BEFORE_CANVAS":C.insertBefore(a,c);break;case "JUST_AFTER_CANVAS":c.nextElementSibling?C.insertBefore(a,c.nextElementSibling):C.appendChild(a,c);break;case "LAST":C.appendChild(a,c);break;default:N.error(b+" invalid stack order")}};a.II=function(){return b};a.HI=function(){return t};a.VK=z;a.HM=n;a.lY=function(a,c,d){b=a;t=c;q=d;n()};a.wA=function(){v=!0};a.Pt=function(a,b,c){c||(c=new Float32Array(2));var f=c;v&&(n(),v=!1);f[0]=a-m;a=c;v&&(n(),v=!1);a[1]=b-d;
return c};a.Kt=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*q;d[1]=c*q;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.h_=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/q;d[1]=c/q;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.gJ=function(b){return b&&b.parentNode?b.parentNode==C?!0:a.gJ(b.parentNode):!1};a.uV=x;a.PT=function(a){var b=document.getElementsByTagName("script");a=P.$i(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=h;a.tk=function(a){var b=C,d=c,f=b.clientWidth,
b=b.clientHeight;if(a||f!=d.clientWidth||b!=d.clientHeight)(a="HMD"===K.stereo&&A.LI())&&a.isPresenting||h(f,b,!0)};a.reset=function(){C=l=c=F=null}};b4w.module.__anchors=function(a,r){function m(){p=!0;A.We().addEventListener("mouseup",function(){function a(){return"visible"==c.style.visibility&&!p&&!h}if(!ba&&!e){var b=R;if(b)if("visible"==b.lastElementChild.style.visibility)d(),R=null;else if(1==b.style.opacity){var c=b.lastElementChild,b=b.firstElementChild,f=c.firstElementChild,g=f.innerHTML;c.style.visibility="visible";var l=Math.min(parseInt(c.style.width)||200,z(g)-24),k=n(g,l),p=!0,h=!0;b.style.display="none";ba=!0;M.bn(0,l,200,function(b){b==
l&&(p=!1,h||(ba=!1),a&&(f.style.visibility="visible"));c.style.width=b+"px"});M.bn(0,k,200,function(b){b==k&&(h=!1,p||(ba=!1),a&&(f.style.visibility="visible"));c.style.height=b+"px"})}}})}function d(){var a=R.lastElementChild;R.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function t(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function q(a,c,f){var g=document.createElement("div"),l=document.createElement("span");f&&(g.style.width=f+"px");t(g);b(l);l.innerHTML=a;g.style.visibility="hidden";l.style.visibility="hidden";g.appendChild(l);c.appendChild(g);c.addEventListener("mousedown",function(){ba||c==R||1!=c.style.opacity||e||(R&&"visible"==R.lastElementChild.style.visibility&&d(),R=c)})}function z(a){var c=document.createElement("div"),e=document.createElement("span");e.innerHTML=a;b(e);t(c);c.appendChild(e);document.body.appendChild(c);
a=c.offsetWidth+1;document.body.removeChild(c);return a}function n(a,c){var e=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);t(e);e.style.width=c+"px";e.style.display="inline-block";e.appendChild(d);document.body.appendChild(e);d=e.offsetHeight-16;document.body.removeChild(e);return d}function x(){for(var a=0,b=0;b<v.length;b++)v[b].pn&&a++;J=new Float32Array(3*a)}function h(a,b){return b.depth-a.depth}function k(a,b,c){a=a.element;C.aJ&&(b=Math.floor(b),c=Math.floor(c));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}var f=r("__batch"),y=r("__camera"),g=r("__config"),A=r("__container"),N=r("__objects"),H=r("__obj_util"),O=r("__print"),D=r("__renderer"),P=r("__scenes"),K=r("__subscene"),M=r("__time"),F=r("__transform"),c=r("__tsr"),l=r("__vec3"),C=g.A,v=[],e=!1,R=null,p=!1,ba=!1,J=new Float32Array(0),B=new Uint8Array(16),
V=new Float32Array(2),U=new Float32Array(3),Z=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<v.length;c++)if(v[c].da==a){c=!0;break a}c=!1}if(!c){c=a.anchor.pn&&Boolean(P.La(P.Jh(),K.Rm));c={type:a.anchor.type,da:a,x:0,y:0,depth:0,jl:"out",pn:c,element:null,Vn:null,OP:a.anchor.mW,Mj:a.anchor.Mj};switch(c.type){case "ANNOTATION":var e=c.da;a=A.We();var d=N.Hu(e),e=e.name,f=document.createElement("div"),g=f.cloneNode(),l=document.createElement("span"),k="";f.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
g.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";f.style.visibility="hidden";d&&(k=d.description||k,e=d.title||e);l.innerHTML=e;l.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(l);l.style.whiteSpace="nowrap";g.appendChild(l);f.appendChild(g);k&&q(k,f,c.OP);a.appendChild(f);c.element=f;break;case "ELEMENT":if(c.element=document.getElementById(a.anchor.Mj),c.element)for(d=0;d<v.length;d++)"ELEMENT"==v[d].type&&v[d].Mj==a.anchor.Mj&&(O.warn("Anchor with the id '"+a.anchor.Mj+"' already exists, making the new anchor generic."),c.type="GENERIC");else O.warn("Anchor HTML element with the id '"+a.anchor.Mj+"' was not found, making it generic."),c.type="GENERIC"}v.push(c);x();
p||m()}};a.remove=function(a){for(var b=0;b<v.length;b++){var c=v[b];if(c.da==a){"ANNOTATION"==c.type&&(a=c,A.We().removeChild(a.element));v.splice(b,1);x();break}}};a.update=function(a){for(var b=0,e=v.length;e--;){var d=v[e];d.pn&&J.set(c.F(d.da.k.n),3*b++);var g,l=d,p=U;g=P.Sl(P.Jh());g=p=y.hC(g,c.F(l.da.k.n),p);l=g[0];p=g[1];g=g[2];if(a||l!=d.x||p!=d.y||g!=d.depth){switch(d.type){case "ANNOTATION":var n=l,m=p;k(d,n,m);break;case "ELEMENT":m=d.element.getBoundingClientRect(),n=l-m.width/2,m=p-
m.height/2,k(d,n,m)}d.x=l;d.y=p;d.depth=g;d.Vn&&d.Vn(l,p,d.jl,d.da,d.element)}}v.sort(h);for(e=0;e<v.length;e++)d=v[e],"GENERIC"!=d.type&&(d.element.style.zIndex=R==d.element?v.length:e);0<b&&(a=P.La(P.Jh(),K.Rm),b=a.Qa[0].ra[0],f.kZ(b.za,J),K.Oc(a,b))};a.RM=function(){for(var a=A.We(),b=v.length;b--;){var c=v[b],e=c.da,f=e.k,g=c.x,k=c.y,p=c.depth,h=P.Sl(P.Jh()),n=F.Bf(e,U),h=F.Bf(h,Z),n=l.dist(n,h);(p=0>g||0>k||0>p||1<p||P.hB(e)||g>=a.clientWidth||k>=a.clientHeight)||(p=f.af,p=!(n<f.Xg?0:p==H.jp||
n<p));f=p?"out":"visible";c.pn&&"out"!=f&&(f=c,p=P.La(P.Jh(),K.Rm).p,n=A.Kt(f.x,f.y,V,p),D.oC(p.Ve,n[0],p.height-n[1],2,2,B),f=1020==B[5]+B[6]+B[9]+B[10]?"visible":"out"==f.jl||0==B[5]+B[6]+B[9]+B[10]?"covered":f.jl);if(f!=c.jl){switch(c.type){case "ANNOTATION":case "ELEMENT":var m=c.element;if(!m)break;"out"==f?(m.style.visibility="hidden",m.children.length&&(m.children[0].style.visibility="hidden")):"visible"==f?(m.style.visibility="visible",m.children.length&&(m.children[0].style.visibility="visible"),
m.style.opacity=1):(m.style.visibility="visible",m.style.opacity=.1,m.children.length&&(m.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<m.children.length&&"visible"==m.lastElementChild.style.visibility&&(d(),m==R&&(R=null)))}c.jl=f;c.Vn&&c.Vn(g,k,c.jl,e,m)}}};a.E1=function(a,b){for(var c=0;c<v.length;c++)v[c].da==a&&(v[c].Vn=b)};a.F2=function(a){for(var b=0;b<v.length;b++)v[b].da==a&&(v[b].Vn=null)};a.sa=function(){for(var a=0;a<v.length;a++){var b=v[a];"ANNOTATION"==b.type&&A.We().removeChild(b.element)}v.length=
0};a.mV=function(a){for(var b=0;b<v.length;b++)if(v[b].da==a)return!0;return!1};a.N3=function(a){for(var b=0;b<v.length;b++)if(v[b].da==a)return v[b].Mj;return!1};a.pause=function(){e=!0};a.cj=function(){e=!1};a.HW=function(a,b){for(var c=-1,e=0;e<v.length;e++){var d;if(d="visible"==v[e].jl){var f=v[e];if(f.element){d=Math.round(f.element.offsetWidth)||0;var g=Math.round(f.element.offsetHeight)||0}else g=d=0;var l=f.x,f=f.y;d=a>=l&&a<=l+d&&b<f&&b>=f-g?!0:!1}if(d)if(0>c)var k=v[e].depth,c=e;else v[e].depth<
k&&(c=e,k=v[e].depth)}return 0>c?null:v[c].da}};b4w.module.__objects=function(a,r){function m(a){var b=a.I;a=a.k;for(var c=0;c<b.length;c++){var e=b[c].xb;e.s.outline&&a.dh&&R.oX(e)}}function d(a){a.k.dh=0;a=ja.indexOf(a);-1!=a&&ja.splice(a,1)}function b(a){if(a.vn)for(var b=a.I,c=0;c<b.length;c++)R.JM(b[c].xb,a)}function t(a,b){for(var c=a.I,e=b.I,d=0;d<c.length;d++){for(var f=!1,g=0;g<e.length;g++)if(c[d].xb==e[g].xb){f=!0;break}f||q(b,c[d].xb)&&F.Bp(b,c[d].xb)}}function q(a,b){return!b.dF&&"SPEAKER"==a.type||!b.HP&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function z(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.Ty||a.parent&&a.parent.Ty)return!0;switch(a.type){case "MESH":var e=a.b4w_do_not_batch,d=a.b4w_collision,f=a.b4w_vehicle,g=a.b4w_floating,l=a.b4w_character,k=c.$U(a),p=K.TF(a),h=0<a.data.b4w_shape_keys.length,u=a.b4w_dynamic_geometry;if(!(e=y.UF(a,b)||e||d||f||h||g||k||l||p||u))a:{e=a.data;for(d=0;d<e.materials.length;d++)if(f=e.materials[d],f.b4w_water||f.b4w_lens_flares||n(f.node_tree)){e=!0;break a}e=!1}return e;case "EMPTY":return e=
K.TF(a),d=a.b4w_do_not_batch,f=Boolean(a.b4w_anchor),y.UF(a,b)||e||d||f;default:return!0}}function n(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var e=c.convert_from,d=c.convert_to,f=c.outputs[0];if(!(!f.is_linked||"WORLD"==e&&"CAMERA"==d||"CAMERA"==e&&"WORLD"==d||"OBJECT"==e&&"OBJECT"==d))return!0}if("NORMAL_MAP"==c.type&&(e=c.space,f=c.outputs[0],f.is_linked&&("OBJECT"==e||"BLENDER_OBJECT"==e))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(f=c.outputs[1],e=c.outputs[3],c.outputs[0].is_linked||f.is_linked||e.is_linked))return!0}return!1}function x(a,b){var c=a.animation_data,e=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.s.type==y.Ky||c.s.type==y.Jy&&"ARMATURE"==b.type||c.s.type==y.AO&&"LAMP"==b.type||c.s.type==y.zO&&"WORLD"==b.type)&&b.Jg.push(y.bJ(null,c)));e&&e.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Jg.push(y.bJ(null,e.action));"MESH"==b.type&&b.Jg.push.apply(b.Jg,y.qU(a))}function h(a,b,c){b=Y[b]||
[];for(var e=[],d=0;d<b.length;d++){var f=b[d];if(f.k.Qe==c||-1==c)for(var g=f.I,l=0;l<g.length;l++)g[l].xb==a&&e.push(f)}return e}function k(a,b,c,e,d){for(var f=null,g=0;g<b.length;g++){var l=b[g];if(!((c?l.mm:l.name)!=a||l.k.Qe!=e&&-1!=e||d&&!l.Dj||(f=l,F.Ki(f))))break}return f}function f(a){Y.ALL.push(a);Y[a.type]||(Y[a.type]=[]);Y[a.type].push(a);var b=a.k.Dd;if(null!=b)for(var c=0;c<ca.length;c++){var e=ca[c];e.k.Dd==b&&e.Tr.push(a)}}var y=r("__animation"),g=r("__batch"),A=r("__boundings"),
N=r("__camera"),H=r("__config"),O=r("__constraints"),D=r("__geometry"),P=r("__lights"),K=r("__nla"),M=r("__nodemat"),F=r("__obj_util"),c=r("__particles"),l=r("__physics"),C=r("__print"),v=r("__primitives"),e=r("__quat"),R=r("__scenes"),p=r("__sfx"),ba=r("__transform"),J=r("__textures"),B=r("__tsr"),V=r("__util"),U=r("__vec3"),Z=r("__armature"),w=r("__anchors"),ga=r("__renderer"),Q=H.A,I=H.Tc,Y={ALL:[]},ia=new Float32Array(24),u=0,aa=0,ca=[],ja=[],wa=new Float32Array(3),pa=new Float32Array(4);a.Ux=
0;a.Tx=1;a.Kc=2;a.Jc=-1;a.update=function(a){for(var b=0;b<ja.length;b++){var c=ja[b],e=c,f=a,g=0,l=e.bK;0==l.Yw&&(l.Yw=f);f-=l.Yw;if(l.qC&&f/l.Gf>=l.qC)d(e);else{f%=l.Gf;if(f<l.WB)switch(l=f/(l.WB/5),f=Math.floor(l),f){case 0:g=(l-f)/2;break;case 1:g=(l-f)/2+.5;break;case 2:g=1;break;case 3:g=1-(l-f)/2;break;case 4:g=.5-(l-f)/2}e.k.dh=g}c.k.dh&&m(c)}if(a=Y.ARMATURE)for(b=0;b<a.length;b++)c=a[b],c.OB&&(ba.D(c),c.OB=!1)};a.nL=function(a,b){a.k.dh=b;m(a)};a.dn=function(a,b,c,e){var d=a.bK;d.Yw=0;d.WB=
b;d.Gf=c;d.qC=e;-1==ja.indexOf(a)&&ja.push(a)};a.Nt=d;a.Mk=function(a,b){b.pj=a.uuid;b.Dj=!0;x(a,b);a.Ty=b.Ra=z(a,b);a.IP=!0;b.Xe=a.b4w_vehicle;b.dg=a.b4w_character;b.am=a.b4w_floating;b.Im=a.b4w_collision;b.$b=a.b4w_collision_id;b.Ut=a.b4w_correct_bounding_offset;var c=a.game;b.eh={Hr:c.physics_type,ys:c.use_ghost,ZM:c.use_sleep,Rh:c.mass,eN:c.velocity_min,dN:c.velocity_max,cH:c.damping,MK:c.rotation_damping,WV:c.lock_location_x,XV:c.lock_location_y,YV:c.lock_location_z,ZV:c.lock_rotation_x,$V:c.lock_rotation_y,
aW:c.lock_rotation_z,fq:c.collision_margin,dq:c.collision_group,gq:c.collision_mask,JD:c.use_collision_bounds,Qt:c.collision_bounds_type,us:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.kf={name:c.name,cf:c.part,QY:c.suspension_rest_length,iD:c.suspension_compression,kD:c.suspension_stiffness,jD:c.suspension_damping,UD:c.wheel_friction,AC:c.roll_influence,AB:c.max_suspension_travel_cm,Lq:c.force_max,Rp:c.brake_max,Eo:c.steering_max,Tn:c.max_speed_angle,vq:c.delta_tach_angle,ms:c.speed_ratio,
ns:c.steering_ratio,fr:c.inverse_control,Jl:c.floating_factor,Nm:c.water_lin_damp,Om:c.water_rot_damp,jM:c.synchronize_position};if(c=a.b4w_floating_settings)b.wn={name:c.name,cf:c.part,Jl:c.floating_factor,Nm:c.water_lin_damp,Om:c.water_rot_damp,jM:c.synchronize_position};if(c=a.b4w_character_settings)b.fG={m_:c.walk_speed,vX:c.run_speed,JY:c.step_height,DV:c.jump_strength,o_:c.waterline};for(c=0;c<a.constraints.length;c++){var e=a.constraints[c];"RIGID_BODY_JOINT"==e.type&&b.cC.push({target:e.target.nb,
JW:e.pivot_type,KW:e.pivot_x,LW:e.pivot_y,MW:e.pivot_z,Ga:e.axis_x,Ha:e.axis_y,Ia:e.axis_z,ZZ:e.use_limit_x,$Z:e.use_limit_y,a_:e.use_limit_z,VZ:e.use_angular_limit_x,WZ:e.use_angular_limit_y,XZ:e.use_angular_limit_z,NV:e.limit_max_x,OV:e.limit_max_y,PV:e.limit_max_z,QV:e.limit_min_x,RV:e.limit_min_y,SV:e.limit_min_z,HV:e.limit_angle_max_x,IV:e.limit_angle_max_y,JV:e.limit_angle_max_z,KV:e.limit_angle_min_x,LV:e.limit_angle_min_y,MV:e.limit_angle_min_z})}c=b.k=F.pq("MESH"===b.type?b.Ra?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.nb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Er=a.parent_bone),a.pinverse_tsr&&(b.ew=B.create(),B.copy(a.pinverse_tsr,b.ew))):a.dg_parent&&(b.parent=a.dg_parent.nb,b.ok=!0);var e=a.location,d=a.scale[0];V.jC(a.rotation_quaternion,pa);ba.Uc(b,e);ba.Zh(b,pa);ba.Hf(b,d);b.ws=a.b4w_use_default_animation;b.hl=y.Yy(a.b4w_anim_behavior);a.b4w_object_tags&&(b.Jv={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,N1:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.qx={LP:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":Z.Mk(a,b);e=c.Dg;d=y.XQ(e);a.b4w_animation_mixing?(c.ke=new Float32Array(d.Cb),c.Be=new Float32Array(d.Cb),c.oe=new Float32Array(d.trans),c.Ee=new Float32Array(d.trans)):(c.ke=d.Cb,c.Be=d.Cb,c.oe=d.trans,c.Ee=d.trans);for(var l in e){var k=e[l];1==k.Lt.length&&Z.rZ(k,!0,d.trans,d.Cb)}c.Mr=d;c.Ue=0;c.ti=a.b4w_animation_mixing;break;case "MESH":c.qn=a.b4w_do_not_render;
c.ll=g.CQ(a.data.b4w_boundings.bb);c.vk=I.outlining_overview_mode||a.b4w_selectable;c.Xv=a.b4w_selectable;c.Tc=I.outlining_overview_mode||a.b4w_outlining;c.Wv=a.b4w_outlining;c.Yv=I.outlining_overview_mode||a.b4w_outline_on_select;c.Cg=a.b4w_billboard;c.Lp=a.b4w_pres_glob_orientation;c.Np="BASIC";c.Mp="SPHERICAL"==a.b4w_billboard_geometry;l=c.Th;l.jk=a.b4w_outline_settings.outline_duration;l.kk=a.b4w_outline_settings.outline_period;l.lk=a.b4w_outline_settings.outline_relapses;c.vk&&(c.Gj=V.FH(u),
u++);for(l=0;l<a.data.b4w_vertex_anim.length;l++)e=a.data.b4w_vertex_anim[l],b.Xc.push({name:e.name,va:e.frame_start,Za:e.frame_end,F1:e.averaging,G1:e.averaging_interval,MP:e.allow_nla});b.k.Xc=b.Xc.length?!0:!1;"MESH"!=a.type&&V.q("Wrong object type: "+a.name);l=b.k;if(a.data.b4w_shape_keys.length)for(l.Ge=!0,e=0;e<a.data.b4w_shape_keys.length;e++)d={},d.value=a.data.b4w_shape_keys[e].value,d.name=a.data.b4w_shape_keys[e].name,l.ai.push(d);else l.Ge=!1;c.Ce=a.b4w_shadow_cast;c.ce=a.b4w_shadow_receive;
c.me=a.b4w_shadow_cast_only&&c.Ce;c.be=a.b4w_reflexible;c.Gd=a.b4w_reflexible_only&&c.be;c.Fd=a.b4w_reflective;c.gh=a.b4w_reflection_type;if(!c.Fd)for(l=a.data.materials,e=0;e<l.length;e++)d=l[e],d.use_nodes&&-1!=d.node_tree.Sy.indexOf("BSDF_GLOSSY")&&(c.Fd=!0,c.gh="CUBE");c.Gg=a.b4w_caustics;if(c.nf=a.b4w_wind_bending)c.Qm=a.b4w_wind_bending_angle,l=g.p_(a.b4w_wind_bending_angle,c.ll,a.scale[0]),c.oh=l,c.ph=a.b4w_wind_bending_freq,c.Lg=a.b4w_detail_bending_freq,c.Kg=a.b4w_detail_bending_amp,c.Fg=
a.b4w_branch_bending_amp,c.Ri=a.b4w_main_bend_stiffness_col,l=a.b4w_detail_bend_colors,c.we.nB=l.leaves_stiffness_col,c.we.mB=l.leaves_phase_col,c.we.XB=l.overall_stiffness_col;c.Mh=a.b4w_hidden_on_load;c.Vf=a.b4w_dynamic_geometry;"MESH"!==a.type&&V.q("Wrong object");l=a.data.materials[0];c.Ml=l.physics.friction;c.Gl=l.physics.elasticity;c.Xg=0;c.af=F.jp;c.Yg=a.b4w_lod_transition;c.dw=a.pass_index;break;case "LINE":c.O=A.Pd();c.aa=A.Hg();c.Ta=A.Pd();c.pb=A.Hg();break;case "CAMERA":N.dR(a,b);N.sQ(b);
break;case "LAMP":P.EV(a,b);break;case "SPEAKER":b.W=p.nS();c=!1;for(l=0;l<b.I.length;l++)if(b.I[l].xb.Nc){c=!0;break}c&&p.Mk(a,b);break;case "EMPTY":l=A.Pd(),c.O=l,l=A.Dh(),c.wa=l,a.field&&(b.vn={type:a.field.type,cM:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,pn:a.b4w_anchor.detect_visibility,Mj:a.b4w_anchor.element_id,mW:a.b4w_anchor.max_width})}f(b)};a.RZ=function(a,b){b.pj=a.uuid;b.Dj=!0;x(a,b);a.Ty=b.Ra=z(a,b);a.IP=!0;b.k=F.pq(b.type);b.ws=a.b4w_use_default_animation;
b.hl=y.Yy(a.b4w_anim_behavior);f(b)};a.EZ=function(a,b){var c=b.k;if(b.parent){!b.ok&&b.eh.us&&b.parent.eh.us&&(b.Im=!1);for(var d=!1,g=0;g<b.I.length;g++)if(b.I[g].xb.wc){d=!0;break}if(g=d)g=b.eh,g=b.Xe||b.am||l.dg(b)||b.Im&&!g.ys&&0<g.Rh&&("DYNAMIC"==g.Hr||"RIGID_BODY"==g.Hr);if(g)g=b.ok?B.copy(c.n,B.create()):c.n,B.multiply(b.parent.k.n,g,c.n),ba.Uc(b,B.F(c.n)),ba.Hf(b,B.Xd(c.n)),ba.Zh(b,B.R(c.n));else if(b.ok||!b.Er)if(g=B.copy(c.n,B.create()),b.qx&&"CAMERA"==b.parent.type){g={distance:b.qx.distance,
rotation:B.R(g)};switch(b.qx.LP){case "TOP_LEFT":g.top=0;g.left=0;break;case "TOP":g.top=0;g.left=.5;break;case "TOP_RIGHT":g.top=0;g.right=0;break;case "LEFT":g.top=.5;g.left=0;break;case "CENTER":g.top=.5;g.left=.5;break;case "RIGHT":g.top=.5;g.right=0;break;case "BOTTOM_LEFT":g.bottom=0;g.left=0;break;case "BOTTOM":g.bottom=0;g.left=.5;break;case "BOTTOM_RIGHT":g.bottom=0,g.right=0}O.$y(b,b.parent,g)}else O.QP(b,b.parent,g);else g=B.copy(c.n,B.create()),O.RP(b,b.parent,b.Er,g)}if("ARMATURE"==b.type)for(d=
a.pose.bones,g=0;g<d.length;g++){var k=d[g],p=k.constraints;if(p)for(var h=0;h<p.length;h++){var u=p[h];"COPY_TRANSFORMS"!=u.type||u.subtarget||u.mute||O.cQ(b,u.target.nb,k.name,V.RE,V.Xm)}}if("MESH"==b.type)var w=y.UH(a);if(w){p=w.nb;g=p.k.Mr;d=b.k;k=a.data;b.zt=p;k=k.vertex_groups;if(k.length){var p=p.k.Dg,h=0,u={},E;for(E in p){var n=V.Cd("name",E,k);n&&(u[E]={hN:n.index,Cj:p[E].Cj,eA:h++})}d.wi=u;E=h;k=y.iI();d.Zg=E;E>2*k?(d.$j=!1,C.error('too many bones for "'+a.name+'" / '+d.Zg+" bones (max "+
k+" with blending, "+2*k+" without blending). Skinning will be disabled.")):d.$j=!0}E=y.ET(g.trans,g.Cb,c.wi);w.b4w_animation_mixing?(c.ke=new Float32Array(E.Cb),c.Be=new Float32Array(E.Cb),c.oe=new Float32Array(E.trans),c.Ee=new Float32Array(E.trans)):(c.ke=E.Cb,c.Be=E.Cb,c.oe=E.trans,c.Ee=E.trans);c.Dp=new Float32Array(4);c.Cp=e.create();c.Mr=E;c.Ue=0}if(c.Fd)if(c=b.k,"CUBE"==c.gh)c.Qd=aa++;else if("PLANE"==c.gh){a:{w=a.constraints;for(E=0;E<w.length;E++)if(g=w[E],"LOCKED_TRACK"==g.type&&"REFLECTION PLANE"==
g.name){if(g.target.nb){w=g.target.nb;break a}C.warn('Reflection plane target "'+g.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}w=null}w||(w=V.qs("%reflection%"),w=F.oq(w,"EMPTY"),E=F.pq("EMPTY"),w.k=E,t(b,w),O.pF(w,b,[0,0,0],null,1),f(w));E=null;for(g=0;g<ca.length;g++)if(ca[g]==w){E=g;break}null==E&&(E=ca.length,ca.push(w));w.k.Dd=E;c.Dd=E;w.Tr.push(b)}};a.zZ=b;a.t2=t;a.nR=q;a.FZ=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=
c.k.type&&"CAMERA"!=c.k.type||ba.D(c);c.ws&&y.$J(c)&&(y.xt(c),c.ha.length&&y.play(c,null,y.Zk))}};a.Hu=function(a){return V.P(a.Jv)};a.sa=function(){aa=u=0;ca.length=0;ja.length=0;Y={ALL:[]}};a.copy=function(a,b,c){var e=b,d=F.Ki(a);b=d?F.GH(d.name,b):b;if(k(b,Y.ALL,!1,-1)){for(var d=1,l;;){l="."+(3>String(d).length?("000"+String(d)).slice(-3):String(d));if(!k(b+l,Y.ALL,!1,-1))break;d++}C.error('Object "'+b+'" already exists. Name was replaced by "'+b+l+'".');e+=l;b+=l}e=F.oq(b,a.type,e);e.Dj=a.Dj;
e.Ra=a.Ra;e.hr=a.hr;e.ws=a.ws;e.Jg=a.Jg;e.k=F.Bz(a.k);e.Jv=F.Tt(a.Jv);t(a,e);e.st=F.Iz(a.st);e.parent=F.Iz(a.parent);e.ok=a.ok;e.Er=a.Er;e.Xc=F.Iz(a.Xc);e.hl=a.hl;!a.C||a.Xe||a.dg||a.am||(e.Im=a.Im,e.C=null);e.$b=a.$b;e.Ut=a.Ut;e.eh=F.Tt(a.eh);b=[];for(d=0;d<a.I.length;d++){l=e.I[d];var p=a.I[d].U;if(c){for(var h=l.U,w=0;w<p.length;w++)if(!p[w].Zf){var n=F.Tt(p[w]);n.Ba=D.JR(p[w].Ba);h.push(n);b.push(p[w].Ba)}for(w=0;w<p.length;w++)if(p[w].Zf){n=F.Tt(p[w]);h.push(n);for(var E=0;E<b.length;E++)b[E]==
p[w].Ba&&(n.Ba=h[E].Ba)}for(w=0;w<h.length;w++)h[w].Ba&&D.KM(h[w].Ba),Q.Wy&&ga.wQ(h[w]),h[w].hk=e.pj,g.mZ(h[w]);J.oY(h)}else l.U=p;for(w=0;w<l.U.length;w++)for(p=l.U[w].ya,h=0;h<p.length;h++)J.iv(p[h])}c||(e.k.Ro=!1);F.DC(e,!1);f(e);e.k.nv=!0;e.k.ov=c;e.k.Gj=V.FH(u);u++;return e};a.sZ=function(a){for(var b=a.k,c=a.I[0].U,e,d,f,l,k,p,h,u,w,n,m,I,C=[],q=0;q<c.length;q++){var y=c[q];if("MAIN"==y.type){var F=D.Zq("a_position"),F=D.Ou(y.Ba.mc,F),x=y.Ba.kd.a_position.offset;e=l=F[x];d=k=F[x+1];f=p=F[x+
2]}}for(q=0;q<c.length;q++)if(y=c[q],y.Ba&&y.pb&&y.Ta){var F=D.Zq("a_position"),F=D.Ou(y.Ba.mc,F),x=y.Ba.kd.a_position.offset,t=y.Ba.kd.a_position.length+x;h=n=F[x];u=m=F[x+1];w=I=F[x+2];for(var aa=x;aa<t;aa+=3){var x=F[aa],M=F[aa+1],B=F[aa+2];h=Math.max(x,h);u=Math.max(M,u);w=Math.max(B,w);n=Math.min(x,n);m=Math.min(M,m);I=Math.min(B,I)}y.O.max_x=h.toFixed(3);y.O.max_y=u.toFixed(3);y.O.max_z=w.toFixed(3);y.O.min_x=n.toFixed(3);y.O.min_y=m.toFixed(3);y.O.min_z=I.toFixed(3);A.ql(y.O,b.n,y.Ta);A.sH(y.Ta,
ia);for(F=C.length=0;F<ia.length;F++)C.push(ia[F]);y.pb=A.Vt(C,!0);y.aa=A.SQ(y.pb,b.n);y.wa=A.mq(y.aa);y.kb=A.mq(y.pb);y.Nf=A.gB(y.aa,y.wa);"MAIN"==y.type&&(e=Math.max(h,e),d=Math.max(u,d),f=Math.max(w,f),l=Math.min(n,l),k=Math.min(m,k),p=Math.min(I,p))}C={max_x:parseFloat(e.toFixed(3)),max_y:parseFloat(d.toFixed(3)),max_z:parseFloat(f.toFixed(3)),min_x:parseFloat(l.toFixed(3)),min_y:parseFloat(k.toFixed(3)),min_z:parseFloat(p.toFixed(3))};n=e-l;u=d-k;h=f-p;l=.5*(e+l);w=.5*(d+k);m=.5*(f+p);var R=
l,Y=m;k=Math.max(n,Math.max(u,h))/2;p=Math.max(n,h)/2;var ga=[l/(n?n:1),w/(u?u:1),m/(h?h:1)];I=.5;if(b.Cg)x=Math.max(Math.abs(C.max_x),Math.abs(C.min_x)),M=Math.max(Math.abs(C.max_y),Math.abs(C.min_y)),B=Math.max(Math.abs(C.max_z),Math.abs(C.min_z)),f=Math.sqrt(x*x+M*M+B*B),q=Math.sqrt(x*x+M*M),C.max_x=C.max_y=C.max_z=f,C.min_x=C.min_y=C.min_z=-f,p=q,k=f,x=new Float32Array([0,0,0]),e=new Float32Array([k,k,k]),f=new Float32Array([0,0,0]);else{for(q=0;q<c.length;q++)if(y=c[q],"MAIN"==y.type)for(F=D.Zq("a_position"),
F=D.Ou(y.Ba.mc,F),t=c[q].Ba.kd,x=t.a_position.offset,t=t.a_position.length+x,aa=x;aa<t;aa+=3){var x=F[aa],M=F[aa+1],B=F[aa+2],r=Math.sqrt((l-x)*(l-x)+(w-M)*(w-M)+(m-B)*(m-B));if(r>k){var y=l-k*(x-l)/r,H=w-k*(M-w)/r,r=m-k*(B-m)/r;l=(y+x)/2;w=(H+M)/2;m=(r+B)/2;k=Math.sqrt((l-x)*(l-x)+(w-M)*(w-M)+(m-B)*(m-B))}H=Math.sqrt((R-x)*(R-x)+(Y-B)*(Y-B));H>p&&(y=R-p*(x-R)/H,r=Y-p*(B-Y)/H,R=(y+x)/2,Y=(r+B)/2,p=Math.sqrt((R-x)*(R-x)+(Y-B)*(Y-B)));x/=n?n:1;M/=u?u:1;B/=h?h:1;r=Math.sqrt((ga[0]-x)*(ga[0]-x)+(ga[1]-
M)*(ga[1]-M)+(ga[2]-B)*(ga[2]-B));r>I&&(y=ga[0]-I*(x-ga[0])/r,H=ga[1]-I*(M-ga[1])/r,r=ga[2]-I*(B-ga[2])/r,ga[0]=(y+x)/2,ga[1]=(H+M)/2,ga[2]=(r+B)/2,I=Math.sqrt((ga[0]-x)*(ga[0]-x)+(ga[1]-M)*(ga[1]-M)+(ga[2]-B)*(ga[2]-B)))}q=n?n*ga[0]:e;d=u?u*ga[1]:d;f=h?h*ga[2]:f;e=I*n;F=I*u;t=I*h;x=new Float32Array([l,w,m]);e=new Float32Array([e,F,t]);f=new Float32Array([q,d,f]);p=parseFloat(p.toFixed(3))}b.O=C;g.SX(b,p,p,C);C=A.nz(k,x);b.wa=C;C=A.Kp([e[0],0,0],[0,e[1],0],[0,0,e[2]],f);b.aa=C;ba.D(a);if(Q.debug_view)for(q=
0;q<c.length;q++)if("DEBUG_VIEW"===c[q].type&&c[q].Di){a=v.Au(1,C.G);D.QK(a,[C.Ga[0],C.Ha[1],C.Ia[2]],C.G);D.Xw(a,1,!0);a.pa.a_polyindex=D.su(a);g.lZ(c[q],a);break}};a.rc=h;a.wI=function(a,b,c){b=Y[b]||[];for(var e=[],d=0;d<b.length;d++){var f=b[d];if((f.k.Qe==c||-1==c)&&f.Dj)for(var g=f.I,l=0;l<g.length;l++)g[l].xb==a&&e.push(f)}return e};a.Rl=function(a){var b=Y.ALL;if(-1==a)return b;for(var c=[],e=0;e<b.length;e++){var d=b[e];d.k.Qe==a&&c.push(d)}return c};a.Fu=function(a){var b=Y.MESH;if(b)for(var c=
0;c<b.length;c++){var e=b[c];if(l.dg(e))for(var d=e.I,f=0;f<d.length;f++)if(d[f].xb==a)return e}return null};a.xY=function(a){var b=h(a,"LAMP",-1);if(b.length==a.s.j6){for(var c=[],e=0;e<b.length;e++){var d=b[e],d=F.ja(d,a);c[d.fm]=e}for(e=0;e<c.length-1;e++)for(d=e+1;d<c.length;d++){var f=b[c[e]].Rc,g=b[c[d]].Rc;if(g.Hm&&g.Jm&&(!f.Hm||!f.Jm)||!f.Hm&&(g.Hm||!f.Jm&&g.Jm))f=c[e],c[e]=c[d],c[d]=f}for(e=0;e<c.length;e++)d=b[c[e]],F.ja(d,a).fm=e,R.LM(b[c[e]],a)}};a.Uv=function(a,b,c,e){for(var d=0;d<a.I.length;d++)for(var f=
a.I[d].U,g=0;g<f.length;g++){var l=f[g];l.Ba.Tf=b;l.Tf=b;l.yb.Tf=c;""!==l.fk&&(l=M.lI(l.fk))&&(l.pG=e)}};a.xI=function(){var a=[],b=Y.MESH;if(b)for(var c=0;c<b.length;c++){var e=b[c];e.k.vk&&e.Dj&&a.push(e)}return a};a.v4=function(){var a=[],b=Y.MESH;if(b)for(var c=0;c<b.length;c++){var e=b[c];e.k.Tc&&e.Dj&&a.push(e)}return a};a.qc=function(b,c,e,d){var f=null,g=Y.ALL;switch(b){case a.Ux:f=k(c,g,!0,e,d);break;case a.Tx:a:{for(b=0;b<g.length;b++)if(f=g[b],f.mm==e&&(f.k.Qe==d||-1==d)){var l=F.Ki(f);
if(l&&l.mm==c)break a}f=null}break;case a.Kc:a:{for(d=0;d<g.length;d++){b=g[d];for(var f=c.length-1,l=b,p=!0;0<=f&&p;)p=l&&l.mm==c[f]&&(l.k.Qe==e||-1==e),l&&(l=F.Ki(l)),f--;if(p&&!l){f=b;break a}}f=null}}return f};a.Pu=function(a,b){return k("%meta_world%"+a,Y.WORLD,!0,b)};a.Ir=function(b,c){var e=R.Jh();if(!e)return C.error("No active scene"),null;var d=w.HW(b,c);if(d)return d;d=R.IW(e,b,c);if(!d)return null;for(var e=h(e,"MESH",-1),f=0;f<e.length;f++){var g=e[f].k,l=g.Gj;if(l&&3>Math.abs(255*l[0]-
d[0])&&3>Math.abs(255*l[1]-d[1])&&3>Math.abs(255*l[2]-d[2]))return g.Tc&&g.Yv&&(I.outlining_overview_mode?a.dn(e[f],I.jk,I.kk,I.lk):(d=g.Th,a.dn(e[f],d.jk,d.kk,d.lk))),e[f]}return null};a.zL=function(a,c){for(var e=h(a,"EMPTY",-1),d=0;d<e.length;d++){var f=e[d];if(f.vn&&"WIND"===f.vn.type){var g=f;break}}if(!g)return C.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(e=V.Kb(c.wind_dir),U.set(Math.sin(e),-Math.cos(e),0,wa),V.hA(wa,V.$c,pa),ba.Zh(g,pa));"number"==typeof c.wind_strength&&
(g.vn.cM=c.wind_strength);b(g)};a.Ur=function(a){O.oR(a)&&O.remove(a);var b=Y.ALL,c=Y[a.type],e=b.indexOf(a);a=c.indexOf(a);-1!=e&&b.splice(e,1);-1!=a&&c.splice(a,1)};a.yW=f;a.zW=function(a){return Y[a.type]&&-1<Y[a.type].indexOf(a)}};b4w.module.__geometry=function(a,r){function m(){return{length:0,frames:1,Fc:0,Dm:0,offset:0,Aq:0}}function d(a,b){for(var c=b.a_tbn_quat,e=b.a_position,d=c.length,f=e.length,g=1;g<a.ib.length;g++)for(var l=a.ib[g].Af,k=a.ib[g].dr,l=l.a_position,p=0;p<f;p++)e[p]+=k*l[p];e=ja;for(g=0;g<d;g+=4){f=c.subarray(g,g+4);e.set(Y.Xm);for(p=1;p<a.ib.length;p++)l=a.ib[p].Af,k=a.ib[p].dr,k=Q.slerp(Y.Xm,l.a_tbn_quat,k,wa),Q.normalize(k,k),Q.multiply(k,e,e);Q.multiply(e,f,f)}}function b(a){return 65536<a.Ja?w.$H()?
!1:!0:!1}function t(a){return 0<a.ma.length?!0:!1}function q(a,b,c){if(!t(a))return a;c||ga.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ja*(b||1)+", will use drawArrays","color: #aa0");b=a.ma;c=a.Ja;var e=a.pa,d=a.Z,f;for(f in e){var g=e[f],l=P(g,c);e[f]=z(b,g,l)}for(e=0;e<d.length;e++){var k=d[e];for(f in k)g=k[f],l=P(g,c),k[f]=z(b,g,l)}for(e=0;e<a.ib.length;e++){f=a.ib[e].Af;for(var p in f)g=f[p],l=P(g,c),f[p]=z(b,g,l)}a.Ja=b.length;a.ma=new Uint16Array(0);return a}
function z(a,b,c){if(0==b.length)return new Float32Array(0);for(var e=new Float32Array(a.length*c),d=0;d<a.length;d++)for(var f=a[d],g=0;g<c;g++)e[c*d+g]=b[c*f+g];return e}function n(){return{ie:null,mc:e(),Ul:0,count:0,kd:{},Gm:0,mn:0,on:0,Ld:[],cg:null,ib:null,Yl:1,Tf:!0}}function x(a,b){var c=a.kd[b];if(c){var e=V(b);return J(a.mc,e).subarray(c.offset,c.offset+c.length)}Y.q("extract_array() failed; invalid name: "+b)}function h(b,c){var e;switch(c){case a.Tm:case a.dp:e=S.STATIC_DRAW;break;case a.Os:e=
S.DYNAMIC_DRAW;break;default:Y.q("Wrong draw_mode")}b.Gm=e}function k(a,b,c){function e(a,b){d[a]||(d[a]=0);d[a]+=b}var d={},f;for(f in a[0]){var g=a[0][f],l=V(f);e(l,g.length*a.length)}for(f in b)g=b[f],l=V(f),e(l,g.length);if(c){a=c.Oo.length;l=V("a_part_ts");e(l,4*a);l=V("a_part_r");e(l,4*a);b=c.rm;for(f in b)l=V(f),e(l,b[f].Fc*a);c=c.os;for(f in c)l=V(f),e(l,a)}return d}function f(a){a.ie?(a.cg||(a.cg=S.createBuffer()),S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.cg),S.bufferData(S.ELEMENT_ARRAY_BUFFER,
a.ie,a.Gm),a.mn=a.ie.byteLength):a.mn=0;for(var b=a.on=0;b<a.mc.length;b++){var c=a.mc[b].type,e=p(a.Ld,c);-1==e&&(a.Ld.push({Ok:null,type:c,$S:Y.jZ()}),e=a.Ld.length-1);c=a.Ld[e];c.Ok||(c.Ok=S.createBuffer());S.bindBuffer(S.ARRAY_BUFFER,c.Ok);S.bufferData(S.ARRAY_BUFFER,a.mc[b].hi,a.Gm);a.on+=a.mc[b].hi.byteLength}}function y(a,b){a.O=Z.ql(a.O,b);a.aa=Z.Op(a.aa,b);a.wa=Z.Pp(a.wa,b);a.yd=Z.kz(a.yd,b)}function g(a){for(var b=a[0],c=a[0],e=v("JOIN_"+a.length+"_SUBMESHES"),d=0,f=0;f<a.length;f++)d+=
a[f].ma.length;e.ma=new Uint32Array(d);var g=d=0;if(0<a[0].ib.length)for(var l=0;l<a[0].ib.length;l++){for(f=0;f<a.length;f++)d+=a[f].ib[l].Af.a_position.length,g+=a[f].ib[l].Af.a_tbn_quat.length;f={a_position:new Float32Array(d),a_tbn_quat:new Float32Array(g)};e.ib.push({dr:a[0].ib[l].dr,Af:f})}for(f=d=0;f<a.length;f++)d+=a[f].Ja;e.Ja=d;for(var k in c.pa){for(f=d=0;f<a.length;f++)d+=a[f].pa[k].length;e.pa[k]=new Float32Array(d)}for(k in c.Z[0]){for(f=d=0;f<a.length;f++)d+=a[f].Z[0][k].length;for(f=
0;f<c.Z.length;f++)e.Z[f]=e.Z[f]||{},e.Z[f][k]=new Float32Array(d)}f=e.Kf;f.O=Z.sl(b.Kf.O);g=d=0;l=[];for(c=0;c<a.length;c++){var p=a[c],h=p.ma,u=p.Ja,w=p.pa;k=p.Kf.wa;Z.oA(f.O,p.Kf.O);Z.yT(f.wa,k);Z.sA(p.Kf.yd,l);for(k=0;k<h.length;k++)e.ma[d+k]=h[k]+g;var d=d+h.length,n;for(n in w){var h=w[n],m=g*P(h,u);e.pa[n].set(h,m)}for(k=0;k<p.Z.length;k++){var w=p.Z[k],I=e.Z[k];for(n in w)h=w[n],m=g*P(h,u),I[n].set(h,m)}g+=u}f.aa=Z.Vt(Y.yf(l),!0);if(0<e.ib.length)for(c=0;c<e.ib.length;c++)for(n=e.ib[c].Af,
k=d=f=0;k<a.length;k++)g=a[k].ib[c].Af,n.a_position.set(g.a_position,f),n.a_tbn_quat.set(g.a_tbn_quat,d),f+=g.a_position.length,d+=g.a_tbn_quat.length;a[0].Ef&&(e.Ef={Oo:b.Ef.Oo,Uw:b.Ef.Uw,YL:!0,os:b.Ef.os,rm:b.Ef.rm,nu:b.Ef.nu});return e}function A(a,b,c){b=b.Kf;for(var e=Z.Pd(),d=Z.Yt(),f=[],g=0;g<c.length;g++)Z.ql(a.Kf.O,c[g],e),Z.oA(b.O,e),Z.kz(a.Kf.yd,c[g],d),Z.sA(d,f);b.aa=Z.Vt(Y.yf(f),!0);b.yd=Z.SR(b.aa);b.wa=Z.mq(b.aa)}function N(a,b,e,d,f,g){var l=a.submeshes[b],k=l.base_length,p=v("SUBMESH_"+
a.name+"_"+a.materials[b].name);p.Ja=k;var h=!1;if(O(e,"a_texcoord")){var u=null,w=a.materials[b];b=a.submeshes[b];if(w.texture_slots.length)switch(w=w.texture_slots[0],w.texture_coords){case "UV":w=a.uv_textures.indexOf(w.uv_layer);0==w?u=new Float32Array(b.texcoord):1==w&&(u=new Float32Array(b.texcoord2));break;case "ORCO":for(var n=a.b4w_boundings.bb_src,u=new Float32Array(2*b.base_length),w=(n.max_x+n.min_x)/2,m=(n.max_y+n.min_y)/2,I=n.max_x-n.min_x,n=n.max_y-n.min_y,C=0,y=0;y<b.position.length;y+=
3)u[C++]=(b.position[y]-w)/I+.5,u[C++]=(b.position[y+1]-m)/n+.5}null===u&&(u=new Float32Array(2*b.base_length));b=u}else b=new Float32Array(0);if(O(e,"a_orco_tex_coord")){u=a.b4w_boundings.bb_src;w=new Float32Array(3*l.base_length);m=u.max_x-u.min_x;I=u.max_y-u.min_y;n=u.max_z-u.min_z;for(y=C=0;y<l.position.length;y+=3)0==m?w[C++]=.5:w[C++]=Y.V(parseFloat(((l.position[y]-u.min_x)/m).toFixed(5)),0,1),0==I?w[C++]=.5:w[C++]=Y.V(parseFloat(((l.position[y+1]-u.min_y)/I).toFixed(5)),0,1),0==n?w[C++]=.5:
w[C++]=Y.V(parseFloat(((l.position[y+2]-u.min_z)/n).toFixed(5)),0,1);u=w}else u=new Float32Array(0);w=l.group;if(O(e,"a_influence")&&d){m=new Float32Array(4*k);I=w.length/k;n=new Float32Array(I);for(C=0;C<I;C++){n[C]=-1;for(var Q in d)if(y=d[Q],y.hN===C){n[C]=y.eA;break}}var A=3<I?I:4;d=new Float32Array(A);Q=new Uint32Array(A);for(var C=new Float32Array(4),y=new Float32Array(A),A=new Uint32Array(A),F=new Float32Array(4),x=0;x<k;x++)d.set(y),Q.set(A),C.set(F),m.set(D(w,I,x,k,n,d,Q,C),4*x)}else m=new Float32Array(0);
d=m;f=f?Y.P(f):{};f.a_color={Ql:!0};f.a_color.src=O(e,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,eg:7}]:[];p.pa.a_texcoord=b;p.pa.a_influence=d;p.pa.a_orco_tex_coord=u;d=p.pa;Q=l.vertex_colors;b=l.color;u=a.name;w=[];for(m=0;m<Q.length;m++)w.push(Q[m].name);for(var t in f)if(m=f[t].src,m.length){for(n=I=0;n<m.length;n++)I+=Y.vm(m[n].eg);d[t]=new Float32Array(I*k);for(n=C=0;n<m.length;n++){var M=m[n].name,y=m[n].eg,A=Y.LK(y),aa=w.indexOf(M);-1==aa&&Y.q('vertex color "'+M+'" for mesh "'+
u+'" not found.');F=Q[aa].mask;x=Y.vm(F);(y&F)!==y&&ga.error("Wrong color extraction from "+M+" to "+t+".");for(var B=M=0;B<aa;B++)M+=Y.vm(Q[B].mask);aa=M*k;for(M=0;M<k;M++)for(B=0;3>B;B++)A[B]&&(d[t][M*I+(C+Y.ko(y,B))]=b[aa+M*x+Y.ko(F,B)]);C+=x}}else d[t]=new Float32Array(0);t=a.uv_textures;f=l.texcoord;d=l.texcoord2;Q=p.pa;if(g)for(var R in g){b=t.indexOf(R);if(0==b)var r=new Float32Array(f);else 1==b&&(r=new Float32Array(d));Q[g[R]]=r}p.ma=new Uint32Array(l.indices);R=l.position.length/k/3;r=O(e,
"a_tbn_quat")&&l.tbn_quat.length?!0:!1;t=O(e,"a_shade_tangs")&&l.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(h=!0);for(f=0;f<R;f++){g=H(l,k,r,t,f);if(h)if(d={},d.name=a.b4w_shape_keys[f].name,p.ib.push(d),0!=f){d.Af=g;d.dr=a.b4w_shape_keys[f].value;continue}else d.Af=H(l,k,r,t,f),d.dr=1;p.Z.push(g)}if(1<R&&!h){a=p.Z[0];g={};for(var N in a)g[N]=new Float32Array(a[N]);p.Z.push(g)}O(e,"a_polyindex")&&(q(p,1,!0),p.pa.a_polyindex=c(p));l=l.boundings;e=p.Kf;e.O=Z.Pd();e.O.max_x=l.bb.max_x;e.O.max_y=
l.bb.max_y;e.O.max_z=l.bb.max_z;e.O.min_x=l.bb.min_x;e.O.min_y=l.bb.min_y;e.O.min_z=l.bb.min_z;N=l.rbb;a=l.caxis_x;k=l.caxis_y;h=l.caxis_z;g=l.be_ax;e.aa=Z.Kp(a,k,h,l.be_cen);ia.scale(e.aa.Ga,g[0],e.aa.Ga);ia.scale(e.aa.Ha,g[1],e.aa.Ha);ia.scale(e.aa.Ia,g[2],e.aa.Ia);e.wa=Z.mq(e.aa);ia.copy(N.rbb_c,e.yd.G);ia.copy(a,e.yd.Ga);ia.copy(k,e.yd.Ha);ia.copy(h,e.yd.Ia);l=N.rbb_s;ia.scale(e.yd.Ga,l[0],e.yd.Ga);ia.scale(e.yd.Ha,l[1],e.yd.Ha);ia.scale(e.yd.Ia,l[2],e.yd.Ia);return p}function H(a,b,c,e,d){var f=
{},g=new Float32Array(3*b),l=new Float32Array(c?4*b:0),k=d*b*3;g.set(a.position.subarray(k,k+3*b),0);c&&(k=d*b*4,l.set(a.tbn_quat.subarray(k,k+4*b),0));e&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),f.a_shade_tangs=c);f.a_position=g;f.a_tbn_quat=l;return f}function O(a,b){return-1<a.indexOf(b)?!0:!1}function D(b,c,e,d,f,g,l,k){for(var p=!0,h=0;h<c;h++){var u=b[h*d+e];if(-1!==u){var w=f[h];-1!==w&&(g[h]=u,l[h]=w,p=!1)}}if(p)return k;K(g,l,a.Ny,!1);for(h=b=0;4>h;h++)b+=g[h];if(.01>
b)return k;for(h=0;4>h;h++)g[h]/=b;if(.01>Math.abs(g[0]-1))k[0]=l[0]+1;else for(h=0;4>h;h++)k[h]=l[h]+g[h];return k}function P(a,b){if(0==b)return 0;var c=a.length,e=c/b;e!=Math.floor(e)&&Y.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return e}function K(b,c,e,d){for(var f=b.length,g=f,l=!1,k=d?-1:1;1<g||l;){1<g&&(g=Math.floor(g/1.247330950103979));for(var l=!1,p=0;g+p<f;p++)if(e==a.Ny?0>k*(b[p]-b[p+g]):b[p]<b[p+g]&&d)l=b[p],b[p]=b[p+g],b[p+g]=l,l=c[p],
c[p]=c[p+g],c[p+g]=l,l=!0}}function M(a,b,c){var e=[],d=[];ia.subtract(b,a,e);ia.subtract(c,a,d);ia.normalize(e,e);ia.normalize(d,d);a=Y.V(ia.dot(e,d),-1,1);return Math.acos(a)}function F(a,b,c){if(t(b)){b=b.ma;for(var e=b.length/3,d=0;d<e;d++){var f=new Float32Array(9),g=b[3*d];f[0]=a[3*g];f[1]=a[3*g+1];f[2]=a[3*g+2];g=b[3*d+1];f[3]=a[3*g];f[4]=a[3*g+1];f[5]=a[3*g+2];g=b[3*d+2];f[6]=a[3*g];f[7]=a[3*g+1];f[8]=a[3*g+2];c[d]=f}}else for(d=0;d<a.length;d++)f=new Float32Array(9),f[0]=a[9*d],f[1]=a[9*
d+1],f[2]=a[9*d+2],f[3]=a[9*d+3],f[4]=a[9*d+4],f[5]=a[9*d+5],f[6]=a[9*d+6],f[7]=a[9*d+7],f[8]=a[9*d+8],c[d]=f;return c}function c(a){for(var b=new Float32Array(a.Ja),c=0;c<a.Ja;c++)b[c]=c%3/2;return b}function l(a,b,c){var e=ia.dist(a,b);a=ia.dist(a,c);b=ia.dist(b,c);c=(e+a+b)/2;return c*(c-e)*(c-a)*(c-b)}function C(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),e=0;e<a;e++)c.set(b,8*e);return c}function v(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ja:0,ma:null,Z:[],pa:b,ib:[],Kf:{O:Z.Pd(),aa:Z.Hg(),wa:Z.Dh(),yd:Z.Yt()},Ef:null}}function e(a){var b=[],c;for(c in a)b.push(R(c,a[c]));return b}function R(a,b){return{hi:new (B(a))(b),type:a}}function p(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function ba(a,b){var c=p(a,b);return-1==c?null:a[c].Ok}function J(a,b){var c=p(a,b);return-1==c?null:a[c].hi}function B(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function V(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function U(a,
b,c,e){var d=V(b);b=p(a,d);switch(d){case "float":a[b].hi.set(c,e);break;case "short":for(d=0;d<c.length;d++)a[b].hi[e+d]=Y.Hq(c[d]);break;case "unsigned_byte":for(d=0;d<c.length;d++)a[b].hi[e+d]=Y.hZ(c[d])}}var Z=r("__boundings"),w=r("__extensions"),ga=r("__print"),Q=r("__quat"),I=r("__tsr"),Y=r("__util"),ia=r("__vec3");new Float32Array(2);var u=new Float32Array(3),aa=new Float32Array(3),ca=new Float32Array(3),ja=new Float32Array(4),wa=new Float32Array(4),pa=new Float32Array(8);a.dp=10;a.Os=20;a.Ny=
0;a.V0=1;a.Tm=a.dp;var S=null;a.xP="float";a.Y0="short";a.Z0="unsigned_byte";a.If=function(a){S=a};a.fM=function(a,c,g){b(a)&&q(a);var l=a.ma,p=a.Ja,u=a.Z,w={},v;for(v in a.pa)v in g&&!g[v].Ql||(w[v]=a.pa[v]);g=n();0<a.ib.length&&d(a,u[0]);v=a.Ef;if(l.length){var C=l.length;if(65536>=p)var l=new Uint16Array(l),E=S.UNSIGNED_SHORT;else l=new Uint32Array(l),E=S.UNSIGNED_INT}else C=p,l=null;for(var y=k(u,w,v),y=e(y),Q={},A=0;A<y.length;A++)Q[y[A].type]=0;var F={},x;for(x in w){var t=w[x],M=t.length;if(M){var aa=
V(x),A=F[x]=m();A.length=M;A.Fc=P(t,p);A.offset=Q[aa];U(y,x,t,Q[aa]);Q[aa]+=M}}w=u.length;for(x in u[0])if(t=u[0][x],aa=V(x),M=t.length,t=P(t,p),M)for(A=F[x]=m(),A.length=M,A.frames=w,A.Fc=t,A.offset=Q[aa],1<w&&(A=F[x+"_next"]=m(),A.length=M,A.frames=w,A.Fc=t,A.offset=Q[aa]+M),A=0;A<w;A++)t=u[A][x],aa=V(x),U(y,x,t,Q[aa]),Q[aa]+=M;if(v){u=v.Oo;x=v.Uw;w=v.rm;M=v.os;u=v.Oo;x=v.Uw;var w=v.rm,M=v.os,aa=v.YL,p={a_part_ts:{data:[],Fc:4},a_part_r:{data:[],Fc:4}},B;for(B in w)p[B]={data:[],Fc:w[B].Fc};for(B in M)p[B]=
{data:[],Fc:1};for(t=0;t<u.length;t++){A=u[t];aa&&x&&!v.nu&&(A=I.multiply(x,u[t],pa));!aa&&v.nu&&ia.subtract(u[t],x,u[t]);p.a_part_ts.data.push(A[0],A[1],A[2],A[3]);p.a_part_r.data.push(A[4],A[5],A[6],A[7]);for(B in w)for(var A=w[B].Fc,R=0;R<A;R++)p[B].data.push(w[B].data[t*A+R]);for(B in M)p[B].data.push(M[B][0])}for(B in p)u=V(B),U(y,B,p[B].data,Q[u]),x=m(),x.Fc=p[B].Fc,x.offset=Q[u],x.Aq=1,x.length=p[B].data.length,F[B]=x,Q[u]+=x.length;g.Yl=v.Oo.length}g.count=C;g.ie=l;g.mc=y;g.Ul=E;g.kd=F;h(g,
c);f(g);g.ib=a.ib;return g};a.NY=d;a.wV=b;a.vV=t;a.Xw=q;a.vZ=function(a,b,c){h(a,b);a.count=c.length;a.ie=c;a.Ul=c instanceof Uint16Array?S.UNSIGNED_SHORT:S.UNSIGNED_INT};a.uZ=function(a,b){var c=a.kd,e=c.a_p_data,d=V("a_p_data");if(e)3!=e.Fc&&Y.q('invalid num_comp for "a_p_data"'),U(a.mc,"a_p_data",b,e.offset);else{e=p(a.mc,d);-1==e&&(a.mc.push(R(d,0)),e=a.mc.length-1);var d=a.mc[e].hi,g=new d.constructor(d.length+b.length);g.set(d);a.mc[e].hi=g;U(a.mc,"a_p_data",b,d.length);c=c.a_p_data=m();c.Fc=
3;c.offset=d.length;c.length=b.length}f(a)};a.b3=x;a.b6=function(a){a.Gm=S.STATIC_DRAW};a.fW=function(a){a.Gm=S.DYNAMIC_DRAW};a.KM=f;a.DR=function(a){a.cg&&S.deleteBuffer(a.cg);for(var b=0;b<a.Ld.length;b++)a.Ld[b].Ok&&S.deleteBuffer(a.Ld[b].Ok);a.Ld.length=0};a.TI=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Ww=function(a,b){for(var c=0;c<a.Z.length;c++){var e=a.Z[c].a_position;I.No(e,b,e,0);e=a.Z[c].a_tbn_quat;0<e.length&&I.CM(e,b,e,0);(e=a.Z[c].a_shade_tangs)&&0<e.length&&I.cZ(e,b,
e)}(c=a.pa.au_center_pos)&&c.length&&I.No(c,b,c,0);y(a.Kf,b)};a.MY=function(a,b){var c=a.pa.au_center_pos;if(c&&c.length){var e=new Float32Array(c);I.No(e,b,e,0);for(var d=0;d<a.Z.length;d++)for(var f=0;f<e.length;f++)a.Z[d].a_position[f]+=e[f]-c[f];c.set(e)}else Y.q('Attribute "au_center_pos" is missing in particle submesh');y(a.Kf,b)};a.LQ=y;a.LY=function(a,b){var c=a.Ja,e;for(e in b){var d=b[e].length;a.pa[e]=new Float32Array(d*c);for(var f=0;f<c;f++)for(var g=0;g<d;g++)a.pa[e][f*d+g]=b[e][g]}};
a.eM=g;a.eW=function(a,b,c){if(!a.Ja)return v("EMPTY");var e=c.length;65536<a.Ja*e&&!w.$H()&&q(a,e);var d=a.ma,f=a.Ja,g=a.pa,l=a.Z,k;for(k in b){var p=b[k].length,h=p*f;g[k]=new Float32Array(h);for(var u=0;u<f;u++)for(h=0;h<p;h++)g[k][u*p+h]=b[k][h]}b=v("CLONE_"+e+"_SUBMESHES");b.Ja=f*e;b.ma=new Uint32Array(d.length*e);for(u=0;u<e;u++)for(p=d.length*u,k=f*u,h=0;h<d.length;h++)b.ma[p+h]=d[h]+k;for(var n in g)for(d=g[n],h=d.length*e,p=P(d,f),b.pa[n]=new Float32Array(h),u=0;u<e;u++)k=f*p*u,b.pa[n].set(d,
k);for(n in l[0])for(u=0;u<l.length;u++)for(d=l[u][n],h=d.length*e,p=P(d,f),b.Z[u]=b.Z[u]||{},b.Z[u][n]=new Float32Array(h),h=0;h<e;h++)switch(g=c[h],k=f*p*h,n){case "a_position":I.No(d,g,b.Z[u][n],k);break;case "a_tbn_quat":I.CM(d,g,b.Z[u][n],k);break;case "a_shade_tangs":I.fZ(d,g,b.Z[u][n],k);break;default:Y.q("Wrong attribute name: "+n)}A(a,b,c);return b};a.VF=A;a.tA=N;a.DT=function(a){var b=a.Ja,c=a.Z[0].a_position,e=new Float32Array(12*b);a=new Uint32Array(4*a.ma.length);for(var d=new Float32Array(4*
b),f=0;f<b;f++){e[12*f]=c[3*f];e[12*f+1]=c[3*f+1];e[12*f+2]=c[3*f+2];e[12*f+3]=c[3*f];e[12*f+4]=c[3*f+1];e[12*f+5]=c[3*f+2];e[12*f+6]=c[3*f];e[12*f+7]=c[3*f+1];e[12*f+8]=c[3*f+2];e[12*f+9]=c[3*f];e[12*f+10]=c[3*f+1];e[12*f+11]=c[3*f+2];a[6*f]=4*f+2;a[6*f+1]=4*f+1;a[6*f+2]=4*f;a[6*f+3]=4*f+2;a[6*f+4]=4*f;a[6*f+5]=4*f+3;var g=Math.random();d[4*f]=g;d[4*f+1]=g;d[4*f+2]=g;d[4*f+3]=g}c=v("HALO");c.Z[0]={};c.Ja=4*b;c.Z[0].a_position=e;c.pa.a_halo_bb_vertex=C(b);c.pa.a_random_vals=d;c.ma=a;return c};a.YU=
O;a.tH=function(a,b,c){for(var e=[],d=0;d<a.submeshes.length;d++){var f=N(a,d,b,null,c,null);f.Ja&&e.push(f)}return 0==e.length?v("EMPTY"):1==e.length?e[0]:g(e)};a.tZ=function(a,b,c,e){var d=a.ie,f=x(a,"a_position"),g=b.oW,l=b.pW;b=b.iT;for(var k=d,p=k.length/3,h=0;h<p;h++){var u=k[3*h],w=k[3*h+1],n=k[3*h+2],v=f[3*u+1],m=f[3*u+2],C=f[3*w+1],y=f[3*w+2],q=f[3*n+1],Q=f[3*n+2];g[3*h]=(f[3*u]+f[3*w]+f[3*n])/3;g[3*h+1]=(v+C+q)/3;g[3*h+2]=(m+y+Q)/3}I.No(g,c,l);c=l.length/3;for(f=0;f<c;f++)g=l[3*f]-e[0],
k=l[3*f+1]-e[1],p=l[3*f+2]-e[2],b[f]=g*g+k*k+p*p;e=d;d=b.length;if(!(2>d))for(l=d,f=!1;1<l||f;)for(1<l&&(l=Math.floor(l/1.247330950103979)),f=!1,c=0;l+c<d;c++)0>b[c]-b[c+l]&&(f=b[c],b[c]=b[c+l],b[c+l]=f,f=e,g=c,k=c+l,p=f[3*g],h=f[3*g+1],u=f[3*g+2],f[3*g]=f[3*k],f[3*g+1]=f[3*k+1],f[3*g+2]=f[3*k+2],f[3*k]=p,f[3*k+1]=h,f[3*k+2]=u,f=!0);d=e;S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.cg);S.bufferData(S.ELEMENT_ARRAY_BUFFER,d,S.DYNAMIC_DRAW)};a.yY=K;a.WQ=function(a,b,c){for(var e=b.length/3,d=a.length/3,f=[],
g=Array(3),l=Array(3),k=Array(3),p=0;p<d;p++){for(var h=a[3*p],u=a[3*p+1],w=a[3*p+2],n=0;3>n;n++)g[n]=b[3*h+n],l[n]=b[3*u+n],k[n]=b[3*w+n];if(c)var n=M(g,l,k),v=M(l,k,g),m=Math.PI-n-v;else m=v=n=1;var I=f,C;C=g;var y=k,q=[],Q=[],A=[];ia.subtract(l,C,q);ia.subtract(y,C,Q);ia.cross(q,Q,A);ia.normalize(A,A);C=A;for(y=0;3>y;y++)q=3*u+y,Q=3*w+y,I[3*h+y]=n*C[y],I[q]=v*C[y],I[Q]=m*C[y]}if(c)for(var x in c)for(p=c[x],a=0;3>a;a++){b=3*p[0]+a;for(d=1;d<p.length;d++)g=3*p[d]+a,f[b]+=f[g];for(d=1;d<p.length;d++)g=
3*p[d]+a,f[g]=f[b]}for(p=0;p<e;p++){c=p;x=f;a=new Float32Array(3);for(b=0;3>b;b++)d=3*c+b,a[b]=x[d];ia.normalize(a,a);for(b=0;3>b;b++)d=3*c+b,x[d]=a[b]}return f};a.ZQ=function(a,b,c){for(var e={},d=b.length/3,f=0;f<d;f++){var g=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);e[g]=[]}d=a.length;for(f=0;f<d;f++)b=a[f],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in e&&e[g].push(b);return e};a.zA=function(a,b,c,e){var d;d=null;d=[];d=F(a.Z[0].a_position,a,d);if(c){var f;f=null;f=[];for(var g=
a.Z[0].a_tbn_quat,k=g.length/4,p=new Float32Array(3*k),h=0;h<k;h++){var w=ja;w[0]=g[4*h];w[1]=g[4*h+1];w[2]=g[4*h+2];w[3]=g[4*h+3];w=ia.transformQuat(Y.mi,w,u);p[3*h]=w[0];p[3*h+1]=w[1];p[3*h+2]=w[2]}f=F(p,a,f)}k=d.length;p=new Float32Array(k);for(a=0;a<k;a++)h=d[a],u.set(h.subarray(0,3)),aa.set(h.subarray(3,6)),ca.set(h.subarray(6)),p[a]=Math.sqrt(l(u,aa,ca));g=new Float32Array(k);g[0]=p[0];for(a=1;a<k;a++)g[a]=g[a-1]+p[a];k=g[p.length-1];p=[];for(a=0;a<b;a++){var h=k*Y.og(e),h=Y.Et(g,h,0,g.length-
1),n=h=c?f[h]:d[h],v=e;(h=u)||(h=new Float32Array(3));var w=n[0],m=n[1],I=n[2],C=n[3],y=n[4],q=n[5],A=n[6],x=n[7],t=n[8],n=Y.og(v),v=Y.og(v);1<n+v&&(n=1-n,v=1-v);var M=1-n-v,m=M*m+n*y+v*x,I=M*I+n*q+v*t;h[0]=M*w+n*C+v*A;h[1]=m;h[2]=I;c?(p[a]=new Float32Array(4),ia.normalize(h,h),h=Q.rotationTo(Y.mi,h,ja),p[a][0]=h[0],p[a][1]=h[1],p[a][2]=h[2],p[a][3]=h[3]):(p[a]=new Float32Array(3),p[a][0]=h[0],p[a][1]=h[1],p[a][2]=h[2])}return p};a.su=c;a.A8=l;a.EH=C;a.QK=function(a,b,c){a=a.Z[0].a_position;for(var e=
0;e<a.length;e+=3)a[e]=(a[e]-c[0])*b[0]+c[0],a[e+1]=(a[e+1]-c[1])*b[1]+c[1],a[e+2]=(a[e+2]-c[2])*b[2]+c[2]};a.nQ=function(a,b,c){var e=a.I[0].U;a=a.k.ai;for(var d=1;d<a.length;d++)a[d].name==b&&(a[d].value=c);for(d=0;d<e.length;d++)if(!e[d].Zf&&e[d].Ge&&!e[d].Di){b=e[d].Ba;var f=V("a_position");c=ba(b.Ld,f);f=J(b.mc,f);S.bindBuffer(S.ARRAY_BUFFER,c);var g=b.kd.a_position;c=e[d];var l=a;if(g){for(var k=g.offset,g=g.length+k,p=c.Ba.ib[0].Af.a_position,h=k;h<g;h++)f[h]=p[h-k];for(h=1;h<c.Ba.ib.length;h++){var p=
c.Ba.ib[h].Af.a_position,u=l[h].value;if(u)for(var w=k;w<g;w++)f[w]+=u*p[w-k]}S.bufferSubData(S.ARRAY_BUFFER,Y.tj*k,f.subarray(k))}f=V("a_tbn_quat");c=ba(b.Ld,f);f=J(b.mc,f);S.bindBuffer(S.ARRAY_BUFFER,c);k=b.kd.a_tbn_quat;b=e[d];c=f;f=a;if(k){l=k.offset;k=k.length+l;g=b.Ba.ib[0].Af.a_tbn_quat;h=ja;for(p=l;p<k;p+=4){h[0]=0;h[1]=0;h[2]=0;for(u=h[3]=1;u<b.Ba.ib.length;u++){var w=b.Ba.ib[u].Af.a_tbn_quat,n=f[u].value;if(n){var v=wa;v[0]=w[p-l];v[1]=w[p+1-l];v[2]=w[p+2-l];v[3]=w[p+3-l];w=Q.slerp(Y.Xm,
v,n,wa);Q.multiply(w,h,h)}}u=wa;u[0]=g[p-l];u[1]=g[p-l+1];u[2]=g[p-l+2];u[3]=g[p-l+3];w=0<u[3];Q.multiply(h,u,u);(0<u[3]&&!w||0>u[3]&&w)&&Q.scale(u,-1,u);c[p]=Y.Hq(u[0]);c[p+1]=Y.Hq(u[1]);c[p+2]=Y.Hq(u[2]);c[p+3]=Y.Hq(u[3])}S.bufferSubData(S.ARRAY_BUFFER,Y.tj*l,c.subarray(l))}}};a.wR=function(a){return a.k.Ge};a.F4=function(a){var b=[];if(a.k)for(var c=1;c<a.k.ai.length;c++)b.push(a.k.ai[c].name);return b};a.E4=function(a,b){if(a.k)for(var c=1;c<a.k.ai.length;c++)if(b==a.k.ai[c].name)return a.k.ai[c].value;
return 0};a.aV=function(a,b){var c=a.k.ai;if(c)for(var e=1;e<c.length;e++)if(c[e].name==b)return!0;return!1};a.g5=function(a){return a&&a.k&&a.k.Vf?!0:!1};a.L2=function(b,c,d){var g=b.Ba;if(g){for(var l=d?c.length/3/2:c.length/3-1,k=new Float32Array(12*l),p=new Float32Array(12*l),h=new Uint16Array(6*l),u=0;u<l;u++){if(d)var w=6*u,n=6*u+3;else w=3*u,n=3*(u+1);var v=c[w],m=c[w+1],w=c[w+2],I=c[n],C=c[n+1],n=c[n+2],y=I-v,q=C-m,Q=n-w;k[12*u]=v;k[12*u+1]=m;k[12*u+2]=w;p[12*u]=y;p[12*u+1]=q;p[12*u+2]=Q;
k[12*u+3]=I;k[12*u+4]=C;k[12*u+5]=n;p[12*u+3]=-y;p[12*u+4]=-q;p[12*u+5]=-Q;k[12*u+6]=v;k[12*u+7]=m;k[12*u+8]=w;p[12*u+6]=-y;p[12*u+7]=-q;p[12*u+8]=-Q;k[12*u+9]=I;k[12*u+10]=C;k[12*u+11]=n;p[12*u+9]=y;p[12*u+10]=q;p[12*u+11]=Q;h[6*u]=4*u;h[6*u+1]=4*u+1;h[6*u+2]=4*u+2;h[6*u+3]=4*u;h[6*u+4]=4*u+3;h[6*u+5]=4*u+1}d=0;for(var A in g.kd)c=g.kd[A],d+=k.length/3*c.Fc;c={};c["float"]=d;d=g.mc=e(c);a.vZ(g,b.Fh,h);b=0;for(A in g.kd)switch(c=g.kd[A],A){case "a_position":U(d,A,k,b);c.offset=b;c.length=k.length;
b+=c.length;break;case "a_direction":U(d,A,p,b);c.offset=b;c.length=p.length;b+=c.length;break;default:c.offset=b,c.length=k.length/3*c.Fc,h=new Float32Array(c.length),U(d,A,h,b),b+=c.length}f(g)}};a.JR=function(a){var b=n();if(a.ie)switch(a.Ul){case S.UNSIGNED_SHORT:b.ie=new Uint16Array(a.ie);break;case S.UNSIGNED_INT:b.ie=new Uint32Array(a.ie)}else b.ie=null;for(var c=a.mc,e=[],d=0;d<c.length;d++){var f=c[d].hi,g=c[d].type;e.push({hi:new f.constructor(f),type:g})}b.mc=e;b.Ul=a.Ul;b.count=a.count;
b.kd=Y.P(a.kd);b.Gm=a.Gm;b.mn=a.mn;b.on=a.on;b.cg=null;b.jv=Y.P(a.jv);b.ib=Y.P(a.ib);b.Yl=a.Yl;b.Tf=a.Tf;return b};a.Df=v;a.reset=function(){S=null};a.C5=e;a.yX=p;a.O4=ba;a.Ou=J;a.H3=B;a.Zq=V;a.FI=function(a){switch(V(a)){case "float":return Y.tj;case "short":return Y.pp;case "unsigned_byte":return Y.Ex;default:return Y.tj}};a.IU=function(a){switch(V(a)){case "float":return S.FLOAT;case "short":return S.SHORT;case "unsigned_byte":return S.UNSIGNED_BYTE;default:return S.FLOAT}};a.bN=U};b4w.module.__nla=function(a,r){function m(){return{type:"CLIP",va:0,Za:0,dj:!1,paused:!1,Rf:"",zp:"",xc:0,Xn:null,wj:0,cl:0,rH:0,qH:0,XM:!1,scale:1,repeat:1,hF:0}}function d(a,b,c){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var g=0;g<f.length;g++)f[g].Xn=c,b.push(f[g])}a=a.nodes;for(g=0;g<a.length;g++)if(f=a[g],f.node_group){var k=f.node_group.node_tree;if(k){var e=c.slice();e.push(f.name);d(k,b,e)}}}function b(a,b){var c=Math.round(a)-b.va;b.oj&&(c%=b.Qj,0>c&&(c+=b.Qj));return b.Sb+
c}function t(a,b){var c=(b-K)*O.rd()+a.Sb;c>a.va?(c-=a.va,a.ve&&(c%=a.Za-a.va+1),c+=a.va):c=a.va;return c}function q(a,b){a=D.V(a,b.va,b.Za);var c=a==b.Za?b.hF:b.wj+(a-b.va)/b.scale%(b.cl-b.wj);b.XM&&(c=b.cl-c+b.wj);return c}function z(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],g=f.strips;if(g)for(var e=0;e<g.length;e++){var k=g[e],p=m();p.type=k.type;p.va=k.frame_start;p.Za=k.frame_end;p.xc=b;p.wj=k.action_frame_start;p.cl=k.action_frame_end;p.XM=k.use_reverse;p.scale=k.scale;p.repeat=k.repeat;
k.action&&(p.Rf=k.action.name,p.zp=k.action.uuid,p.Xn=f.Xn);c.push(p)}}return c}function n(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function x(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function h(a,b){var c=A.B();if(c.qa){var d=t(c.qa,b);c.qa.Sb-=d-a;c.qa.yn=!0}}var k=r("__animation");r("__config");var f=r("__objects"),y=r("__obj_util"),g=r("__print"),A=r("__scenes"),N=r("__sfx"),H=r("__textures"),O=r("__time"),D=r("__util"),P=[],K=-1;a.Mk=function(a,b){var c,f=null;for(c=b.I.length-1;0<=c;c--){var g=b.I[c];if(g.xb.b4w_use_nla&&(f=g,g.xb.dF))break}if(c=f){c.ZJ=!0;var h=0;if((f=a.animation_data)&&f.nla_tracks.length){var e=f.nla_tracks;if(y.Zl(b)||y.xa(b)||y.Yd(b)||y.Kn(b)||y.qv(b)||
y.kr(b)||y.jB(b))e=z(e,h),e.length&&(b.ig=b.ig.concat(e),h++)}n(a)&&(e=a.data.animation_data.nla_tracks,e=z(e,h),e.length&&(b.ig=b.ig.concat(e),h++));if(y.Yd(b))for(g=a.data.materials,f=0;f<g.length;f++){var q=g[f];if(q.use_nodes&&q.node_tree&&(e=[],d(q.node_tree,e,[q.name]),e=z(e,h),e.length)){for(var q=h,p=e,A=k.nU(),x=[],t=0,r=0;r<p.length;r++){var H=p[r];""!=H.zp?H=D.Cd("uuid",H.zp,A):(H=H.Rf,H=D.Cd("name",H,A)||D.Cd("name",H+"_B4W_BAKED",A));if(H){var H=H.fcurves,N=[],w;for(w in H)N.push(w);
x.push(N)}}for(r=0;r<x.length;r++){A=!1;for(H=0;H<r;H++)if(D.qQ(x[r],x[H])){p[r].xc=p[H].xc;A=!0;break}A||(p[r].xc=h+t++)}h=q+t;b.ig=b.ig.concat(e)}}if(!y.jB(b)){for(f=0;f<a.particle_systems.length;f++)g=a.particle_systems[f],w=g.settings,"EMITTER"==w.type&&w.b4w_allow_nla&&(w=m(),w.type="CLIP",w.va=c.xb.frame_start,w.Za=c.xb.frame_end+1,w.Rf=g.name,w.xc=h,w.wj=w.va,w.cl=w.Za,b.ig.push(w),h++);c=h+1;for(f=0;f<b.Xc.length;f++)g=b.Xc[f],g.MP&&(h=c,w=m(),w.type="CLIP",w.va=g.va,w.Za=g.Za,w.Rf=g.name,
w.xc=h,w.wj=w.va,w.cl=w.Za,b.ig.push(w))}}};a.KZ=function(a,b,c){a.qa||(a.qa={va:a.frame_start,Za:a.frame_end,Sb:0,pr:-1,Or:a.frame_end,Pr:a.frame_start,So:null,ve:b,eb:[],ya:[],RK:a.name,ak:!1,yn:!1,zC:!0},P.push(a.qa));b=a.qa;for(var d=f.wI(a,"ALL",c),k=0;k<d.length;k++){var h=d[k];if(h.ig.length){b.eb[c]||(b.eb[c]=[]);for(var e=0;e<h.I.length;e++){var n=h.I[e];n.xb==a&&n.ZJ&&b.eb[c].push(h)}for(var e=h.ig,n=b,p=h.name,y=0;y<e.length;y++){var q=e[y];n.va>q.Za||n.Za<q.va?(g.warn("NLA: Strip is out of scene range: "+
(p+" ["+q.va+":"+q.Za+"]")),e.splice(y,1),y--):q.Rf||"CLIP"!=q.type||(g.warn('NLA: no action in strip for object "'+p+'".'),e.splice(y,1),y--)}h=h.ig;e=b;for(n=0;n<h.length;n++){for(var p=h[n],y=e.va,q=e.Za+1,A=0;A<h.length;A++){var x=h[A];p.xc==x.xc&&(x.Za<=p.va&&(y=p.va),x.va>=p.Za&&(q=Math.min(q,x.va)))}p.rH=y;p.qH=q;p.hF=0===p.repeat%1?p.cl:p.wj+p.repeat%1*(p.cl-p.wj)}}}a=a.s.Wo;for(k=0;k<a.length;k++)d=a[k].s,d.Nk&&(d.Sa||d.td)&&d.Fs==c&&(h=m(),h.type="VIDEO",d.oj?(h.va=0,h.Za=b.Za):(h.va=D.V(d.va,
0,b.Za),h.Za=D.V(d.va+d.Qj,0,b.Za)),h.Rf=a[k].name,b.ya.push(d))};a.start=function(){K=0};a.RU=function(){return K};a.Y3=function(a){return a.qa?a.qa.Sb:null};a.i7=function(a,b){return a.qa?(a.qa.Sb=b,!0):!1};a.update=function(a,d){if(!(0>K)){0==K&&(K=a);for(var c=0;c<P.length;c++){var f=P[c];f.ak&&(f.Sb-=O.rd()*d);var g=t(f,a);if((!f.ak||f.yn)&&g>=f.Or)if(f.ve){var g=f,n=a;g.So&&g.So();h(g.Pr,n);g.zC=!0;g=t(g,n)}else{var n=f,e=g;n.ak=!0;n.Sb-=e-n.Or;n.So&&n.So()}if(!f.ak||f.yn){for(var n=f,e=g,m=
0;m<n.eb.length;m++){var p=n.eb[m];if(p)for(var y=0;y<p.length;y++){for(var A=p[y],x=A.ig,r=0;r<x.length;r++){var z=x[r];"SOUND"==z.type&&e<n.pr-1E-6&&(z.dj=!1)}for(r=0;r<x.length;r++)switch(z=x[r],z.type){case "CLIP":if(z.rH<=e&&e<z.qH&&!z.dj){var m=A,Z=z,w=Z.Xn;""!=Z.zp?k.kQ(m,w,Z.zp,Z.xc):k.apply(m,w,Z.Rf,Z.xc);k.cs(m,k.yx,Z.xc);w=q(Z.va,Z);k.no(m,w,Z.xc);for(m=0;m<x.length;m++)x[m]!=z&&x[m].xc==z.xc&&(x[m].dj=!1);z.dj=!0}z.dj&&(Z=A,w=q(e,z),1E-6<Math.abs(w-k.YH(Z,z.xc))&&k.no(Z,w,z.xc));break;
case "SOUND":if((e<n.pr-1E-6||n.pr<z.va)&&z.va<=e&&e<z.Za&&!z.dj){var Z=A,ga=z,w=(ga.va-e)/O.rd(),ga=(ga.Za-ga.va)/O.rd();N.play(Z,w,ga);z.dj=!0}n.pr<z.Za&&z.Za<=e&&z.dj&&(z.dj=!1)}}}n=a;e=f;p=g;for(y=0;y<e.ya.length;y++)if(A=e.ya[y],A.Sa||A.td){x=H.iN(A);r=A;z=D.V(b(p,r),r.Sb,r.Sb+H.jN(r)-1);r.td&&(z=H.f_(r,z),z==r.$r&&z--);r=z;z=H.kN(A);Z=m=!1;if(e.yn||e.zC)Z=!0;e.ak||(w=b(p,A),w=A.Sb<=w&&w<=A.Sb+H.jN(A),ga=H.lN(A),A.oj&&r==z&&(Z=!0),ga||x==r||(Z=!0),w&&!ga?H.mK(A):w&&ga?m=!0:!w&&ga&&(A.Sa&&x<r?
m=!0:H.$B(A)));Z?(H.LX(A,r),A.td&&(A.xk=H.tw(A,n))):m&&H.mN(A)&&(A.Sa?H.QM(A):(x=H.tw(A,n),x!=A.xk&&(A.ej=r,H.PM(A)),A.xk=x))}f.pr=g}f.yn=!1;f.zC=!1}}};a.sa=function(a){if(0==a)P.length=0,K=-1;else for(var b=0;b<P.length;b++)P[b].eb[a]=null};a.TF=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||n(a)||x(a)?!0:!1};a.no=h;a.Uq=function(a){var b=A.B();return b.qa?t(b.qa,a):-1};a.aM=function(){var a=A.B();if(a.qa){a.qa.ak=!0;for(var a=a.qa.ya,b=0;b<a.length;b++)H.$B(a[b])}};a.PW=function(){var a=
A.B();a.qa&&(a.qa.ak=!1,a.qa.So=null)};a.Z3=function(){var a=A.B();return a.qa?a.qa.va:-1};a.eI=function(){var a=A.B();return a.qa?a.qa.Za:-1};a.Yj=function(){var a=A.B();return a.qa?!a.qa.ak:!1};a.Y1=function(){var a=A.B();return a.qa?a.b4w_use_nla:!1};a.X1=function(){var a=A.B();return a.qa?0<a.b4w_logic_nodes.length:!1};a.A7=function(a,b){var c=A.B();if(c.qa)c.qa.Pr=a,c.qa.Or=b;else return!1};a.PC=function(a){var b=A.B();b.qa&&(b.qa.Or=a)};a.YX=function(a){var b=A.B();b.qa&&(b.qa.Pr=a)};a.N6=function(){var a=
A.B();if(a.qa)a=a.qa,a.Pr=a.va,a.Or=a.Za;else return!1};a.c7=function(a){var b=A.B();if(b.qa)b.qa.ve=a;else return!1};a.f2=function(){var a=A.B();a.qa&&(a.qa.So=null)};a.lL=function(a){var b=A.B().qa;b&&(b.Sb=-(a-K)*O.rd()+b.Pr,b.yn=!0)};a.eI=function(){var a=A.B().qa;return a?a.Za:null}};b4w.module.__scenes=function(a,r){function m(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.Qf||!c.Qf.length)return c}return null}function d(){sb||Ma.q("No active scene available");return sb}function b(a,b,c){if(!Aa.ju||!t(a,b,c))return null;c=a.b4w_shadow_settings;var e={};c.csm_resolution>kb.Bc?(e.csm_resolution=kb.Bc,Ha.error("Shadow map texture has unsupported size. Changed to "+kb.Bc+".")):e.csm_resolution=c.csm_resolution;Aa.KQ=c.blur_samples;e.tY=c.soft_shadows;a=G.Lu(b,Aa.ssao&&a.b4w_enable_ssao);
e.self_shadow_polygon_offset=c.self_shadow_polygon_offset;e.self_shadow_normal_offset=c.self_shadow_normal_offset;e.enable_csm=c.b4w_enable_csm&&1==a.length;e.Wg=[];e.WL=[];e.$p=[];e.Zp=[];for(b=0;b<a.length;b++)e.Wg.push(a[b].Rc.type),e.WL.push(a[b].Rc.zo),e.$p.push(a[b].Rc.$p),e.Zp.push(a[b].Rc.Zp),"SPOT"!=e.Wg[b]&&"POINT"!=e.Wg[b]||!e.enable_csm||(Ha.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),e.enable_csm=!1);e.enable_csm?(e.csm_num=c.csm_num,e.csm_first_cascade_border=
c.csm_first_cascade_border,e.first_cascade_blur_radius=c.first_cascade_blur_radius,e.csm_last_cascade_border=c.csm_last_cascade_border,e.last_cascade_blur_radius=c.last_cascade_blur_radius,e.fade_last_cascade=c.fade_last_cascade,e.blend_between_cascades=c.blend_between_cascades):(e.csm_num=1,e.csm_first_cascade_border=c.csm_first_cascade_border,e.first_cascade_blur_radius=c.first_cascade_blur_radius,e.csm_last_cascade_border=c.csm_last_cascade_border,e.last_cascade_blur_radius=c.last_cascade_blur_radius,
e.fade_last_cascade=!1,e.blend_between_cascades=!1);return e}function t(a,b,c){if(0!=b.length&&Aa.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var e=!1,d=!1;a=Aa.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(e=!0);f.b4w_shadow_receive&&(d=!0);if((a||e)&&d)return!0}return!1}function q(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Rc.type)return!0;return!1}function z(a){if(!Aa.Ak)return!1;a=wa(a);
for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function n(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,e=0;e<c.length;e++)if(G.jG(a[b],c[e].settings))return!0;return!1}function x(a){for(var b=wa(a),c=[],e=0;e<b.length;e++){var d=b[e];if(d.b4w_water){for(var f={},g=0;g<a.length;g++)for(var l=a[g],k=l.data.materials,p=0;p<k.length;p++)k[p]==d&&(f.Uk=l.location[2]);f.xe=d.b4w_water_fog_color.slice(0);f.xe.push(d.b4w_water_fog_density);
d.b4w_water_dynamic?(f.Cq=!0,f.waves_height=d.b4w_waves_height,f.waves_length=d.b4w_waves_length,f.dst_noise_scale0=d.b4w_water_dst_noise_scale0,f.dst_noise_scale1=d.b4w_water_dst_noise_scale1,f.dst_noise_freq0=d.b4w_water_dst_noise_freq0,f.dst_noise_freq1=d.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=d.b4w_water_dir_min_shore_fac,f.dir_freq=d.b4w_water_dir_freq,f.dir_noise_scale=d.b4w_water_dir_noise_scale,f.dir_noise_freq=d.b4w_water_dir_noise_freq,f.dir_min_noise_fac=d.b4w_water_dir_min_noise_fac,
f.dst_min_fac=d.b4w_water_dst_min_fac,f.waves_hor_fac=d.b4w_water_waves_hor_fac):(f.Cq=!1,f.waves_height=0,f.waves_length=0);f.Gg=d.b4w_water_enable_caust;f.fR=d.b4w_water_caust_scale;f.eR=d.b4w_water_caust_brightness;f.gR=new Float32Array([.3,.7]);f.Bk=null;d=d.texture_slots;for(g=0;g<d.length;g++)l=d[g].texture,!0===l.b4w_shore_dist_map&&"FILE"==l.image.source&&(f.Bk=l.image,f.YC=l.image.size[0],f.zB=l.b4w_max_shore_dist,l=l.b4w_shore_boundings,f.so=[(l[0]+l[1])/2,(l[2]+l[3])/2],f.uo=[l[0]-l[1],
l[2]-l[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.Cq)for(e=0;e<c.length;e++)c[e].Cq&&(f=c[e]);return f}return null}function h(a){function b(a){if(a){a=a.nodes;for(var e=0;e<a.length;e++){var d=a[e];"GROUP"==d.type&&d.node_group&&b(d.node_group.node_tree);"GROUP"==d.type&&"B4W_REFRACTION"==d.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=wa(a);for(var e=0;e<a.length;e++){var d=a[e];d.b4w_refractive&&(c.refractions=!0);d.node_tree&&b(d.node_tree)}return c}function k(a,b,c){if(Aa.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var e=0,d=!1,f=0;f<b.length;f++){var g=b[f];g.k.Fd&&"CUBE"==g.k.gh&&e++;if(g.Tr.length){for(var l=null,k=0;k<a.length;k++)if(a[k]==g){l=k;break}null==l&&a.push(g)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(g=0;g<b.length;g++)if(l=b[g].game_settings.alpha_blend,"OPAQUE"!=l&&"CLIP"!=l){b=!0;break a}b=!1}else b=void 0;b&&(d=!0)}return{DK:a,WJ:e,Bi:[],Zz:[],Uh:[],fw:[],RI:d}}function f(a,b){var c=a.b4w_sky_settings,e={};e.GK=c.render_sky||c.procedural_skydome;
e.procedural_skydome=c.procedural_skydome;e.use_as_environment_lighting=c.use_as_environment_lighting;e.wo=c.color;e.rayleigh_brightness=c.rayleigh_brightness;e.mie_brightness=c.mie_brightness;e.spot_brightness=c.spot_brightness;e.scatter_strength=c.scatter_strength;e.rayleigh_strength=c.rayleigh_strength;e.mie_strength=c.mie_strength;e.rayleigh_collection_power=c.rayleigh_collection_power;e.mie_collection_power=c.mie_collection_power;e.mie_distribution=c.mie_distribution;e.be=c.reflexible;e.Gd=c.reflexible_only;
!b&&c.procedural_skydome&&Ha.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return e}function y(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.bV=a.hemisphere;b.JQ=a.blur_depth;b.RF=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.wX=a.samples;return b}function g(a){if(!(Aa.bloom&&a.b4w_enable_bloom&&a.s.kj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function A(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function N(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function H(a){var b={};a=a.b4w_god_rays_settings;b.bB=a.intensity;b.Sn=a.max_ray_length;b.Go=a.steps_per_pass;return b}function O(a){var b={};b.aj=a.b4w_outline_color;b.Cr=a.b4w_outline_factor;return b}
function D(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function P(a,b){var c=a.light_settings,e={};e.Og=c.environment_energy;e.xs=c.use_environment_light;e.nA=c.environment_color;e.he=a.horizon_color.slice(0);e.pe=a.zenith_color.slice(0);e.As=a.use_sky_paper;e.zs=a.use_sky_blend;e.Bs=a.use_sky_real;e.Pw=null;
e.xo=null;e.ru=null;c=!0;if(e.xs&&"SKY_TEXTURE"==e.nA&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var d=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&!a.texture_slots[f].texture.b4w_use_as_skydome){d=a.texture_slots[f];break}d?e.ru=d:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;d=a.texture_slots[f];e.Pw=d;f=Math.min(kb.Si,Oa.YQ(d.texture.image.size[0]/3));e.xo={WY:f,OF:d.blend_factor,
WI:d.horizon_factor,sN:d.zenith_up_factor,rN:d.zenith_down_factor,color:d.color,Da:d.default_value,invert:d.invert,YM:d.use_rgb_to_intensity,PF:d.blend_type,TM:d.use_map_blend,UM:d.use_map_horizon,WM:d.use_map_zenith_up,VM:d.use_map_zenith_down};break}e.xs=e.xs?c:!1;return e}function K(a){var b=a.fog_settings,c={};c.YZ=b.use_fog;c.bB=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.IT=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.xe=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.Yf=new Float32Array([c.bB,c.depth,c.start,c.height]);return c}function M(a,b){if(!Aa.hd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,e=!1,d=0;d<b.length;d++){for(var f=b[d],g=f.data.materials,l=0;l<g.length;l++)g[l].b4w_terrain&&(c=!0);f=f.particle_systems;for(l=0;l<f.length;l++)g=f[l].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(e=!0);if(c&&e)return!0}return!1}function F(a,b){if(Ya.outlining_overview_mode)return!0;if(Aa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.vk)return!0;return!1}else return!1}function c(a,b){if(Ya.outlining_overview_mode)return!0;if(Aa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.Tc)return!0;return!1}else return!1}function l(a,b){if(Aa.Ni)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var e=b[c].data.materials,
d=0;d<e.length;d++)if(Na.iG(e[d]))return!0;return!1}else return!1}function C(a,b){if(Aa.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function v(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,e=0;e<c.length;e++){var d=c[e],f=d.game_settings.alpha_blend;if(d.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function e(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var e=b[c].nb;if(e.anchor&&e.anchor.pn)return!0}return!1}}function R(a,b,c){var e=ta.ah(a,b);ta.fi(a,e,function(a,b,e){if(e.Dc){switch(e.from){case "COLOR":case "CUBEMAP":var d=b.p.pc;break;case "DEPTH":d=b.p.Re;break;case "SCREEN":d=null;break;case W.md:return;default:Ma.q("Wrong slink")}switch(e.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:d||Ma.q("Connection of SCREEN is forbidden"),d.Ie&&Ma.q("Batch texture can't use renderbuffer"),qa.mG(c.yb,e.to)&&ka.zj(c,d,e.to)}}});for(a=0;a<b.Ya.length;a++){var e=b.Ya[a],d=b.ei[a];switch(e.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:d.Ie&&Ma.q("Batch texture can't use renderbuffer"),qa.mG(c.yb,e.to)&&ka.zj(c,d,e.to)}}}function p(a){if(a&&a.s&&a.s.Wa){var b=ha.ec(a.s.Wa,W.zg);b&&ja(a,b)}}function ba(a,
b,c,e,d,f){for(var g=b.k,l=G.ja(b,d).U,k=0;k<l.length;k++){var p=l[k];if(!(p.me||p.Gd||"MAIN"!=p.type&&"NODES_GLOW"!=p.type&&"PARTICLES"!=p.type&&"LINE"!=p.type)&&("OPAQUE"==p.Db&&"OPAQUE"==e||"BLEND"==p.Db&&"BLEND"==e||"XRAY"==p.Db&&"XRAY"==e||"NODES_GLOW"==p.type&&"GLOW"==e)){if(!f&&(J(p,a,b,c,e,d),!ka.Wc(p)))if("DEBUG"===Va.type())ka.yt(p,"error.glslv","error.glslf"),ka.Wc(p);else continue;var h=W.Nh(p,g);W.Oc(a,h);R(c,a,p);B(p)}}}function J(a,b,c,e,d,f){var g=c.k,l=f.s,k=G.ja(c,f),p="NO_SHADOWS";
c=S(f,[W.cd]);if(c.length&&a.ce){switch(d){case "OPAQUE":p="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":p="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":p="NO_SHADOWS";break;case "SHADOW":p="SHADOW_MASK_GENERATION";break;default:Ma.q("Wrong subscene type")}for(var h=0;h<c.length;h++)ka.xF(a,f.s.ud)}h="NO_SOFT_SHADOWS";if(l.ud&&l.ud.tY)switch(Aa.KQ){case "16x":h="POISSON_X_16";break;case "8x":h="POISSON_X_8";break;case "4x":h="POISSON_X_4"}c=a.hb;qa.ga(c,"SHADOW_USAGE",
p);qa.ga(c,"POISSON_DISK_NUM",h);a.hd&&(h=ha.ec(e,W.oi))&&V(a,h,g);h=b.p;h.type==ma.se||h.type==ma.uh||h.type==ma.ri?qa.ga(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):qa.ga(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=d||a.Tj){d=b.Tv;qa.ga(c,"NUM_LIGHTS",d);qa.ga(c,"NUM_LFACTORS",0==d%2?d/2:Math.floor(d/2)+1);qa.ga(c,"REFLECTION_PASS","REFL_PASS_NONE");qa.ga(c,"SSAO_ONLY",0);if(d=l.Ic)qa.ga(c,"WATER_EFFECTS",1),qa.ga(c,"WAVES_HEIGHT",qa.M(d.waves_height)),qa.ga(c,"WAVES_LENGTH",qa.M(d.waves_length)),
qa.ga(c,"WATER_LEVEL",qa.M(d.Uk));if(b.Gg&&a.Gg){qa.ga(c,"CAUSTICS",1);if(h=l.ud){g=h.Wg;for(h=p=0;h<g.length;h++)"SUN"==g[h]&&(p=h);qa.ga(c,"SUN_NUM",p)}qa.ga(c,"CAUST_SCALE",qa.M(b.ZF));qa.ga(c,"CAUST_SPEED",qa.M(b.$F,2));qa.ga(c,"CAUST_BRIGHT",qa.M(b.YF))}b=k.Bi;k=k.Uh;if(-1!==a.Kd.indexOf("u_mirrormap"))qa.ga(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Fd&&b)b=b.p.pc,ka.zj(a,b,"u_cube_reflection"),qa.ga(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Fd&&k)for(h=0;h<k.length;h++)b=k[h].p.pc,ka.zj(a,
b,"u_plane_reflection"),qa.ga(c,"REFLECTION_TYPE","REFL_PLANE");else qa.ga(c,"REFLECTION_TYPE","REFL_NONE");(k=ha.ec(e,W.zg))?a.lu?(b=k.p.pc,ka.zj(a,b,"u_sky")):k.procedural_skydome&&(a.ue=k.ue,qa.ga(c,"PROCEDURAL_FOG",1)):qa.ga(c,"PROCEDURAL_FOG",0);b=l.Zo;b.xs&&(qa.ga(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.nA?(b.ru?(k=b.ru.texture,b=Oa.fe(b.ru),ka.zj(a,b,"u_sky_texture",k.name)):k&&(b=k.p.pc,ka.zj(a,b,"u_sky_texture")),qa.ga(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.nA&&qa.ga(c,"SKY_COLOR",1));
b=l.qN;b.YZ&&(qa.ga(c,"USE_FOG",1),qa.ga(c,"FOG_TYPE",b.IT));a.qk&&a.Jb?(Aa.ju&&qa.ga(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.Tj||"NODES_GLOW"==a.type?(qa.ga(c,"REFRACTIVE",1),l.refractions?qa.ga(c,"USE_REFRACTION",1):qa.ga(c,"USE_REFRACTION",0)):l.refractions?qa.ga(c,"REFRACTIVE",1):qa.ga(c,"REFRACTIVE",0),(l.GJ.refractions||l.refractions)&&qa.ga(c,"HAS_REFRACT_TEXTURE",1)):(qa.ga(c,"REFRACTIVE",0),qa.ga(c,"USE_REFRACTION",0),qa.ga(c,"USE_REFRACTION_CORRECTION",0));a.rj&&(Aa.Ak&&a.Gs&&
ha.ec(e,W.dE)?qa.ga(c,"SHORE_SMOOTHING",1):qa.ga(c,"SHORE_SMOOTHING",0),a.water_dynamic&&d&&d.waves_height?qa.ga(c,"DYNAMIC",1):qa.ga(c,"DYNAMIC",0));"PARTICLES"==a.type&&(qa.ga(c,"SIZE_RAMP_LENGTH",a.gb.U7),qa.ga(c,"COLOR_RAMP_LENGTH",a.gb.wG));if(!a.Zf)for(a=a.ya,e=0;e<a.length;e++)if(b=a[e],"SCENE"==b.source)for(l=0;l<Ta.length;l++)for(c=Ta[l],k=Ta[l].Qf,d=0;d<k.length;d++)k[d]==b&&ta.r(Nb,c,f,null)}}function B(a){8<a.ya.length&&Ha.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.sd.join(", ")+'"')}function V(a,b,c){a.ge=b.ge;var e=b.ge[0],d=b.ge[1],f=b.ge[2];c=c.O;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.ge[2]=f;b=b.p;ma.yw(b,f/2,-d,-e,f/2);ma.yk(b);e=a.$q||0;e=0==e?c:Math.max(e,c);a.$q=e}function U(a,b,c,e,d,f){for(var g=b.k,l=G.ja(b,d).U,k=0;k<l.length;k++){var p=l[k];if(("MAIN"==p.type||"PARTICLES"==p.type||"LINE"==p.type)&&"REFLECT"==p.Db&&p.Jb==e){if(a.type==W.Md||a.type==W.sf){var h;a:{var u=d.s.Xh.Uh;for(h=0;h<u.length;h++)for(var w=0;w<
u[h].length;w++)if(u[h][w]==a)break a;u=d.s.Xh.fw;for(h=0;h<u.length;h++)for(w=0;w<u[h].length;w++)if(u[h][w]==a)break a;h=null}if(h==g.Dd)continue}else if(h=ra(d,a),h==g.Qd)continue;if(!f&&(J(p,a,b,c,"REFLECT",d),h=p.hb,qa.ga(h,"WATER_EFFECTS",0),a.type==W.Md||a.type==W.sf?qa.ga(h,"REFLECTION_PASS","REFL_PASS_PLANE"):qa.ga(h,"REFLECTION_PASS","REFL_PASS_CUBE"),qa.ga(h,"TEXTURE_NORM",0),!ka.Wc(p)))if("DEBUG"===Va.type())ka.yt(p,"error.glslv","error.glslf"),ka.Wc(p);else continue;p=W.Nh(p,g);W.Oc(a,
p)}}}function Z(a){ca(a);var b=fa(a,W.Ob),c=!0,e=a.s.ud;ta.oa(a.s.Wa,function(d,f){f.type===W.cd&&(ga(f,a,b.p,e,c),c=!1)})}function w(a){ta.oa(a.s.Wa,function(a,b){b.type===W.Vm&&(b.mA=1)})}function ga(a,b,c,e,d){if(0!=a.Qa.length){var f=a.p,g=ua.fc(c.n,ob);ua.ff(g,f.n);ua.copy(c.mf,f.es);if("SUN"===e.Wg[a.kh]||"HEMI"===e.Wg[a.kh]){g=sc;va.r_(g);for(var l=0;l<a.Qa.length;l++)for(var k=a.Qa[l].ra,p=0;p<k.length;p++){var h=k[p].bf;0==l&&0==p?va.hn(h.Ta,g):va.oA(g,h.Ta)}g=va.sH(g,Nc);Ma.eo(g,f.Nb,g);
if(e.enable_csm){b=Ua.copy(c.Eh[a.Yz],ob);e=Ra.invert(c.Nb,ic);Ma.eo(b,e,b);Ma.eo(b,f.Nb,b);a=c.qq[a.Yz];if(d)for(Hb=0,ec=-Infinity,d=2;d<g.length;d+=3)Hb=Math.min(Hb,g[d]),ec=Math.max(ec,g[d]);d=sc;d.max_x=b[0]+a;d.max_y=b[1]+a;d.max_z=ec;d.min_x=b[0]-a;d.min_y=b[1]-a;d.min_z=Hb}else{c=d=sc;e=Vc;e.set(g);g=dc/9;l=Ra.identity(ic);Ra.rotate(l,g,Ma.Zc,l);p=k=-1;for(h=0;10>h;h++){var u=va.EF(e,Qc),w=(u.max_x-u.min_x)*(u.max_y-u.min_y);if(-1==k||w<k)k=w,p=h,va.hn(u,c);Ma.eo(e,l,e)}c=p*g;0<c&&(g=Ra.identity(ic),
Ra.rotate(g,c,Ma.Zc,g),Ra.multiply(g,f.Nb,f.Nb),ua.Ji(f.Nb,f.mf));c=d.max_x-d.min_x;g=d.max_y-d.min_y;c&&g&&(e=Math.abs(c-g)/2,2<c/g?(d.max_y+=e,d.min_y-=e):2<g/c&&(d.max_x+=e,d.min_x-=e));d.max_x+=.005;d.max_y+=.005;d.max_z+=.005;d.min_x-=.005;d.min_y-=.005;d.min_z-=.005;Q(a,b.s.Wa)}ma.NX(f,d.min_x,d.max_x,d.min_y,d.max_y,-d.max_z,-d.min_z);ma.yk(f);Ma.un(f.ld,f.Ih)}else"SPOT"!==e.Wg[a.kh]&&"POINT"!==e.Wg[a.kh]||ma.yk(f,f.zb)}}function Q(a,b){for(var c=a.p,e=ha.NU(b,a),d=0;d<e.length;d++){var f=
e[d];if(f.type==W.Ob||f.type==W.tf||f.type==W.Lc||f.type==W.Pf)if(Aa.Dv)f.LD.set(c.mf,9*a.kh);else{var g=ua.F(c.mf),l=ua.R(c.mf);nb.set(g[0],g[1],g[2],ua.Xd(c.mf),db);f.ix.set(db,4*a.kh);f.hx.set(l,4*a.kh)}}}function I(a,b,c,e,d){for(var f=b.k,g=G.ja(b,e).U,l=0;l<g.length;l++){var k=g[l];if("COLOR_ID"==k.type&&(a.type==W.pf&&"COLOR_ID"==k.Db||a.type==W.ni&&"COLOR_ID_XRAY"==k.Db)){if(!d&&(J(k,a,b,c,"COLOR_ID",e),ka.ef(k,"USE_OUTLINE",0),!ka.Wc(k)))continue;k=W.Nh(k,f);W.Oc(a,k)}}}function Y(a,b,c,
e,d){if(!e&&(d.hd&&(e=ha.ec(c,W.oi))&&V(d,e,b),!ka.Wc(d)))if("DEBUG"===Va.type())ka.yt(d,"error.glslv","error.glslf"),ka.Wc(d);else return;b=W.Nh(d,b);W.Oc(a,b);R(c,a,d);B(d)}function ia(a,b){u(a,b);for(var c=0;c<a.Pe.length;c++)a.Pe[c].parent==a&&ia(a.Pe[c],b)}function u(a,b){a.k.Mh=b;if(G.qv(a))for(var c=0;c<a.I.length;c++)for(var e=a.I[c],d=S(e.xb,jb),f=0;f<d.length;f++){var g=d[f],l=a.k,k=a.Rc,p=e.fm,h=k.Hm&&!l.Mh?1:0;g.rr[4*p+3]=h;h=k.Jm&&!l.Mh?1:0;g.qr[4*p+3]=h;g.Aa=!0}}function aa(a,b){for(var c=
S(b,jb),e=a.Rc,d=a.k,f=G.ja(a,b),g=ua.F(d.n),d=ua.R(d.n),l=0;l<c.length;l++){var k=c[l],p=k,h=a.k,u=a.Rc,w=f.fm,n=ua.F(a.k.n),E=u.hq;p.qB.set(u.direction,3*w);db[0]=n[0];db[1]=n[1];db[2]=n[2];db[3]=u.Hm&&!h.Mh?1:0;p.rr.set(db,4*w);db[0]=E[0];db[1]=E[1];db[2]=E[2];db[3]=u.Jm&&!h.Mh?1:0;p.qr.set(db,4*w);p.Aa=!0;switch(e.type){case "SUN":k.iM.set(d);k.hM=e.hq;k.type===W.zg?(k.Ov=e.SJ,Ua.copy(e.direction,k.hD),ja(b,k)):Ua.copy(e.direction,k.hD);break;case "HEMI":case "POINT":case "SPOT":break;default:Ha.error("Unknown light type: "+
e.type+'".')}k=k.Qa;for(p=0;p<k.length;p++)for(h=k[p].ra,u=0;u<h.length;u++)w=h[u].za,w.em&&ka.PX(w,a)}c=fa(b,W.Ob).p;f=f.WC;e=b.s.ud;for(l=0;l<f.length;l++)k=f[l],ma.TC(k.p,g,d),ga(k,b,c,e,!0),Q(k,b.s.Wa)}function ca(a){var b=Da.rc(a,"LAMP",Da.Jc),b=G.Lu(b,Aa.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var e=b[c],d=e.k,f=ua.fc(d.n,ob),d=ua.Wd(d.n,Bb),g=0;g<e.I.length;g++){var l=e.I[g],k=l.WC;if(l.xb==a)for(l=0;l<k.length;l++)ma.TC(k[l].p,f,d)}}function ja(a,b){da.hw(b);Sa.sn(b);
if(b.Ov)for(var c=S(a,ab),e=0;e<c.length;e++)for(var d=c[e].Qa,f=0;f<d.length;f++)for(var g=d[f].ra,l=0;l<g.length;l++){var k=g[l];k.ac&&(k=k.za,ka.jR(k)&&Sa.pZ(k))}}function wa(a){for(var b=[],c=0;c<a.length;c++)for(var e=a[c].data,d=0;d<e.materials.length;d++){var f=e.materials[d];-1==b.indexOf(f)&&b.push(f)}return b}function pa(a,b,c){for(var e=a.s,d=G.ja(a.vj,a).ba,f=0;f<d.length;f++){var g=d[f];ma.yk(g,b/c);e.ud&&ma.FD(g,e.ud)}e.ud&&(e.Pv=!0,fa(a,W.tf).Aa=!0,fa(a,W.Lc).Aa=!0);var l=e.Wa;ha.gZ(l,
function(e,d,f){if(e.rs){var g=e.ym*b,k=e.zm*c;if(d)for(d=0;d<f.Ya.length;d++)f.Ya[d]==e&&Oa.resize(e.jb,g,k);else switch(Oa.On(e.jb)&&Oa.resize(e.jb,g,k),e=f.p,e.width=g,e.height=k,f.type){case W.ep:oa(a,{dof_power:f.p.dof_power});break;case W.gp:la(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case W.$o:xa(a,{bloom_blur:f.fn});break;case W.Vm:f=ha.Bb(l,f,W.dc);g=ha.Bb(l,f,W.dc);k=ha.Bb(l,g,W.dc);e=ha.Bb(l,k,W.dc);ha.Id(f,1/b,1/c);ha.Id(g,
1/b,1/c);ha.Id(k,1/b,1/c);ha.Id(e,1/b,1/c);break;default:ha.Id(f,1/b,1/c)}}})}function S(a,b){for(var c=[],e=0;e<b.length;e++){var d=b[e];ta.oa(a.s.Wa,function(a,b){b.type==d&&c.push(b)})}return c}function fa(a,b){return ha.ec(a.s.Wa,b)}function oa(a,b){var c=fa(a,W.ep);if(!c)return Ha.error("DOF is not enabled on the scene. Check camera settings"),0;var e=c.p.dof_bokeh,d=e?S(a,[W.Fx]):[],f=a.s.Wa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,e))for(var g=0;g<d.length;g++)d[g].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,e))for(g=0;g<d.length;g++)d[g].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,e))for(g=0;g<d.length;g++)d[g].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,e))for(g=0;g<d.length;g++)d[g].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,e))for(g=0;g<d.length;g++)d[g].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,e))for(g=0;g<d.length;g++)d[g].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(c.p.dof_bokeh_intensity=b.dof_bokeh_intensity,e&&(d=ha.KA(f,c,W.dc),d[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,d[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,d[0]=ha.Bb(f,d[0],W.dc),d[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(e){e=b.dof_power;c.p.dof_power=e;var e=
e/2,g=c.p.width,l=c.p.height,k=[1/g,0],p=[1/g*.5,1/l*.866],h=[-1/g*.5,1/l*.866],d=ha.KA(f,c,W.dc);ha.Hc(d[0],e);ha.Id(d[0],h[0],h[1]);ha.Hc(d[1],e);ha.Id(d[1],p[0],p[1]);d[0]=ha.Bb(f,d[0],W.dc);ha.Hc(d[0],e);ha.Id(d[0],k[0],k[1]);c.p.Bd&&(d[0]=ha.Bb(f,d[0],W.Fx),d[0]=ha.Bb(f,d[0],W.dc),ha.Id(d[0],1/g,1/l),d[0]=ha.Bb(f,d[0],W.dc),ha.Id(d[0],1/g,1/l))}else c.p.dof_power=b.dof_power,d=ha.Bb(f,c,W.dc),f=ha.Bb(f,d,W.dc),ha.Hc(d,c.p.dof_power),ha.Id(d,1/c.p.width,1/c.p.height),ha.Hc(f,c.p.dof_power),ha.Id(f,
1/c.p.width,1/c.p.height)}function xa(a,b){var c=fa(a,W.dt),e=fa(a,W.$o);if(!c||!e)return Ha.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.Gt=b.key,c.Aa=!0);"number"==typeof b.edge_lum&&(c.Ft=b.edge_lum,c.Aa=!0);if("number"==typeof b.blur){var d=a.s.Wa,c=ha.Bb(d,e,W.ap),d=ha.Bb(d,c,W.ap);e.fn=b.blur;ha.Hc(c,b.blur);ha.Id(c,1/e.p.width,1/e.p.height);ha.Hc(d,b.blur);ha.Id(d,1/e.p.width,1/e.p.height)}}function la(a,b){var c=fa(a,W.gp);if(!c)return Ha.error("Glow is not enabled on the scene"),
null;for(var e=a.s.Wa,d=ha.KU(e,c),f=0;f<d.length;++f){var g=d[f];if(g.type==W.dc&&"GLOW_MASK_LARGE"==g.Db)var l=g;if(g.type==W.dc&&"GLOW_MASK_SMALL"==g.Db)var k=g}d=ha.Bb(e,l,W.dc);e=ha.Bb(e,k,W.dc);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.Aa=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.Aa=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ha.Hc(k,b.small_glow_mask_width),
ha.Id(k,1/c.p.width,1/c.p.height),k.Aa=!0,ha.Hc(e,b.small_glow_mask_width),ha.Id(e,1/c.p.width,1/c.p.height),e.Aa=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ha.Hc(l,b.large_glow_mask_width),ha.Id(l,1/c.p.width,1/c.p.height),l.Aa=!0,ha.Hc(d,b.large_glow_mask_width),ha.Id(d,1/c.p.width,1/c.p.height),d.Aa=!0)}function X(a,b,c){var e=a.s,d=e.Ic;if(!d.Cq)return d.Uk;var f=d.waves_height,g=d.waves_length,l=d.Uk,k=Ua.length(e.sj)||1;a=fa(a,W.Ob).time;a*=
k;var p=Xb;p[0]=20/g*(b-.25*a);p[1]=20/g*(c-.25*a);k=Ma.aG(p);p[0]=17/g*(c+.1*a);p[1]=17/g*(b+.1*a);var p=Ma.aG(p),k=k+p-1,h=d.dst_noise_scale0,p=d.dst_noise_scale1,u=d.dst_noise_freq0,w=d.dst_noise_freq1,n=Xb;n[0]=h*(b+u*a);n[1]=h*(c+u*a);h=Ma.aD(n);n[0]=p*(c-w*a);n[1]=p*(b-w*a);p=Ma.aD(n);p*=f*h;if(d.Bk)if(w=(b-d.so[0])/d.uo[0],n=(d.so[1]+c)/d.uo[1],w+=.5,n+=.5,1<w||0>w||1<n||0>n)d=p;else{var e=Ma.RH(e.XC,d.YC,w,n),n=d.dir_freq,E=d.dir_noise_scale,m=d.dir_noise_freq,h=d.dir_min_noise_fac,w=d.dst_min_fac,
u=g/d.zB/Math.PI;c=[E/g*(b+m*a),E/g*(c+m*a)];b=Math.sqrt(e);d=f*Math.max(e,d.dir_min_shore_fac)*Math.sin(b/u+n*a)*Math.max(Ma.aD(c),h);f=Math.max(b,w);d=d*(1-f)+p*f;k*=e}else d=p;return l+(d+.05*k)}function ya(a,b){a.gr&&a.type==W.dc&&b.ac!=a.ac&&(a.ac=b.ac);b.ac||a.type!=W.Vm||(a.mA=0)}function na(a,b,c,e){var d=ta.Va(a,b);ma.vw(d.p,c,e);d.cz=!0;ta.Ik(a,b,function(b,d,f){f.Dc&&f.from==c&&ha.xR(f)&&L(a,b,f.to,e)});ta.fi(a,b,function(b,d,f){f.Dc&&f.from==c&&f.from==f.to&&na(a,b,c,e)})}function L(a,
b,c,e){a=ta.Va(a,b).Qa;for(b=0;b<a.length;b++)for(var d=a[b].ra,f=0;f<d.length;f++)ka.mX(d[f].za,e,c)}function ea(a){var b=fa(a,W.oi);if(b){var c=b.p,e=a.vj.k;a=ua.fc(e.n,ob);var d=nd;d[0]=0;d[1]=0;d[2]=-b.ge[2]/2;b=ua.Wd(e.n,Bb);Ua.transformQuat(d,b,d);d[0]+=a[0];d[1]+=a[1];d[2]=0;zc.identity(b);ma.TC(c,d,b)}}function E(a,b){ta.oa(a,function(c,e){if(e.type==W.sh){e.Ya[0]&&e.ei[0]||Ma.q("Wrong MOTION_BLUR subscene");var d=e.Ya[0],f=e.ei[0];e.ei[0]=e.p.pc;ta.Ik(a,c,function(b,c,e){e.Dc&&L(a,b,e.to,
f)});na(a,c,d.from,f);L(a,c,d.to,e.ei[0]);e.LJ=Math.exp(-b/e.mb_factor)}})}function za(a){return a.s.sj}function ra(a,b){if(!a.s.Xh)return null;for(var c=a.s.Xh.Bi,e=0;e<c.length;e++)if(c[e]==b)return e;c=a.s.Xh.Zz;for(e=0;e<c.length;e++)if(c[e]==b)return e;return null}var ka=r("__batch"),va=r("__boundings"),ma=r("__camera"),Ka=r("__config"),Ga=r("__container"),Ca=r("__debug"),ta=r("__graph"),Ba=r("__hud"),sa=r("__input"),Ra=r("__mat4"),Na=r("__nodemat"),Da=r("__objects"),G=r("__obj_util"),T=r("__physics"),
da=r("__prerender"),Ab=r("__primitives"),Ha=r("__print"),zc=r("__quat"),Sa=r("__renderer"),ha=r("__scenegraph"),Ea=r("__sfx"),qa=r("__shaders"),W=r("__subscene"),Oa=r("__textures"),ua=r("__tsr"),Ma=r("__util"),Ua=r("__vec3"),nb=r("__vec4"),Va=r("__version"),Aa=Ka.A,kb=Ka.zi,Ya=Ka.Tc,La=Ka.mo,hb=[W.oi,W.cd,W.Ob,W.Lc,W.Pf,W.ee,W.Md,W.md,W.sf,W.Ke,W.pf,W.ni,W.tf,W.yg,W.rf];a.U0=hb;var jb=[W.Ob,W.Lc,W.Pf,W.ee,W.Md,W.md,W.uj,W.Ys,W.zg,W.sf,W.Ke,W.dt,W.tf,W.cd,W.pf,W.ni,W.yg],ab=[W.Ob,W.lt,W.Lc,W.Pf,W.ee,
W.Md,W.md,W.sf,W.Ke],vb=[W.cd,W.Ob,W.Lc,W.Pf,W.ee,W.Md,W.md,W.sf,W.Ke,W.pf,W.ni,W.tf,W.uj,W.yg,W.rf],gb=[W.Ob,W.Lc,W.Pf,W.ee,W.Md,W.md,W.sf,W.Ke],mb=null,sb=null,Ta=[],Nb=null,dc=Math.PI/2,Xb=new Float32Array(2),ob=new Float32Array(3),nd=new Float32Array(3),Bb=new Float32Array(4),db=new Float32Array(4),ic=new Float32Array(16),Nc=new Float32Array(24),Vc=new Float32Array(24),sc=va.Pd(),Qc=va.Pd(),Hb=0,ec=-Infinity;a.y2=function(){return{}};a.uw=function(a){sb=a;Ea.BX(a)};a.WW=function(a,b){var c=a.s,
e=ha.mS(c.Wa);if(a==b){pa(a,Ga.II(),Ga.HI());for(var d=0;d<e.length;d++)a.s.um.push(e[d])}else for(d=a.Qf[0],pa(a,d.gj,d.gj),d=0;d<e.length;d++)b.s.um.push(e[d]);e=S(a,vb);for(d=0;d<e.length;d++)e[d].sj.set(c.sj);for(d=0;d<c.um.length;d++)c.um[d].type==W.cd&&Sa.sn(c.um[d])};a.Jh=function(){mb||(mb=m(Ta));return mb};a.uu=m;a.B=d;a.Ca=function(){return sb?!0:!1};a.Sl=function(a){return a.vj};a.Sq=function(){return Ta};a.MA=function(){if(1==Ta.length)return Ta;for(var a=0;a<Ta.length;a++){var b=Ta[a].s.Wa;
ta.oa(b,function(b,c){for(var e=c.Qa,d=0;d<e.length;d++)for(var f=e[d].ra,g=0;g<f.length;g++){for(var l=f[g],k=l.za.ya,p=null,h=0;h<k.length;h++)if("SCENE"==k[h].source&&k[h].hs==Ta[a].name&&c.type!=W.Hx){Ha.error('Texture-scene loop detected. A scene is rendered to texture "'+k[h].name+'" yet this texture belongs to the same scene.');ta.ah(Nb,Ta[a]);p=l.za;break}p&&(p.ya=[],p.Kd=[],ka.oZ(p,null),ka.Wc(p),W.Oc(c,l))}})}for(var c=[],a=0;a<Ta.length;a++)if(b=Ta[a],!b.Qf.length){b=ta.ah(Nb,b);ta.vT(Nb,
b);b=ta.Vw(Nb,b,ta.Ms);b=ta.uD(b);ta.oa(b,function(a,b){c.push(b)});break}return c};a.WP=function(a,d,p,u,w){a.Qf=a.Qf||[];a.qa=null;var E=a.s,m=G.ja(a.vj,a),I=a.vj.k;E.Wo=[];var Q=a.world;E.FV=p.length;E.kj=q(p);E.Lw=f(Q,E.kj);E.Zo=P(Q,E.Lw);E.qN=K(Q);if(Q=!a.Qf.length)a:{if("HMD"==Aa.stereo){if(m.ba[0].type!=ma.Nd){Ha.warn("Head-mounted display stereo is disabled for the non-perspective camera");Aa.stereo="NONE";Q=!1;break a}if(!sa.uz(sa.Je)){Ha.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Aa.stereo="NONE";Q=!1;break a}}Q="HMD"==Aa.stereo}E.dv=Q;if(Q=!a.Qf.length)m.ba[0].type!=ma.Nd&&"ANAGLYPH"==Aa.stereo?(Ha.warn("Anaglyph stereo is disabled for the non-perspective camera"),Aa.stereo="NONE",Q=!1):Q="ANAGLYPH"==Aa.stereo;E.anaglyph_use=Q;E.NP=!E.dv&&!E.anaglyph_use&&e(a,w);E.Xh=k(a,d,u);E.IQ=g(a);E.nW=A(a);E.hR=N(a);E.VU=H(a);E.BW=O(a);E.Sj=D(a);E.dof=Aa.dof&&(0<I.dof_distance||I.dof_object);E.motion_blur=Aa.motion_blur&&a.b4w_enable_motion_blur;E.compositing=Aa.compositing&&a.b4w_enable_color_correction;
E.antialiasing=Aa.antialiasing&&1==Aa.Cc&&"NONE"!=a.b4w_antialiasing_quality;E.ssao=Aa.ssao&&a.b4w_enable_ssao;E.god_rays=Aa.god_rays&&a.b4w_enable_god_rays&&E.kj;E.dT=Aa.ju;E.Ru=a.b4w_glow_settings.render_glow_over_blend;E.IY=y(a);w=h(u);E.GJ=w;E.refractions=C(a,w);E.ud=b(a,p,u);E.Ic=x(u);E.qh=v(u);E.sY=n(u);E.Ak=z(u);E.hd=M(a,u);E.LR=F(a,u);E.outline=c(a,u);E.Ni=l(a,u);switch(a.b4w_reflection_quality){case "LOW":E.Ci=La.ZG;E.fh=La.jK;break;case "MEDIUM":E.Ci=La.XS;E.fh=La.OW;break;case "HIGH":E.Ci=
La.WS;E.fh=La.NW;break;default:E.Ci=La.ZG,E.fh=La.jK}Ga.uV()?(Ha.log("%cENABLE HIDPI MODE","color: #00a"),E.eF="AA_QUALITY_LOW",E.jo=1,Aa.Cc=1):1<Aa.Cc?(Ha.log("%cENABLE MSAA RENDERING: "+Aa.Cc+"x","color: #00a"),E.jo=1):(E.eF="AA_QUALITY_"+a.b4w_antialiasing_quality,E.jo="MEDIUM"===a.b4w_antialiasing_quality&&Aa.quality===Ka.Wm||"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Ka.Yk?1.33:"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Ka.Wm||"NONE"===a.b4w_antialiasing_quality&&Aa.quality===Ka.Wm?
2:1);p=a.Qf.sort(function(a,b){return b.gj-a.gj});E.Wa=ha.lS(E,m,I,p);E.um=[];E.Pv=!1;E.MB=!1;E.NB=!1;E.sj=new Float32Array(3);Ta.push(a);Nb||(Nb=ta.create());ta.J(Nb,a);for(E=0;E<d.length;E++)G.DC(d[E],!0,a);a=Ga.We();Ga.resize(a.clientWidth,a.clientHeight,!0)};a.XP=function(a,b,c){for(var e=0;e<b.length;e++){var d=b[e].s;d&&d.cm&&(d.Fs=c,a.s.Wo.push(b[e]))}};a.JA=function(a){return a.s.Wa};a.HH=function(a,b){ta.oa(b,function(c,e){var d=null;switch(e.type){case W.dc:d=ka.Sz(e.gw);break;case W.lt:d=
ka.rS(e);break;case W.Oy:d=ka.sS(e);break;case W.dE:d=ka.YR();break;case W.uj:ha.Bb(b,e,W.Ym)||ha.Bb(b,e,W.rf)||ha.Bb(b,e,W.Lc)||ha.Bb(b,e,W.uj);d=ka.bS(e.dK,e.rj,e.Go);break;case W.Ys:ha.Bb(b,e,W.Ym)||ha.Bb(b,e,W.rf)||ha.Bb(b,e,W.Lc);ha.Bb(b,e,W.uj);d=ka.cS();break;case W.sh:d=ka.gS();break;case W.Fx:d=ka.VR(e.tG);break;case W.ep:var d=ka.ZR(e),f=e.p.dof_power;if(e.p.dof_bokeh){var f=f/2,g=ha.KA(b,e,W.dc);ha.Hc(g[0],f);ha.Hc(g[1],f);g[0]=ha.Bb(b,g[0],W.dc);ha.Hc(g[0],f)}else{var g=ha.Bb(b,e,W.dc),
l=ha.Bb(b,g,W.dc);ha.Hc(g,f);ha.Hc(l,f)}break;case W.Vm:var d=ka.hS(),f=ha.Bb(b,e,W.dc),g=ha.Bb(b,f,W.dc),l=ha.Bb(b,g,W.dc),k=ha.Bb(b,l,W.dc);ha.Hc(g,e.hz);ha.Hc(f,e.hz);ha.Hc(k,e.rA*e.Cr);ha.Hc(l,e.rA*e.Cr);break;case W.gp:d=ka.aS();break;case W.Gx:d=ka.WR();break;case W.XD:d=ka.QR(e);break;case W.My:case W.jt:case W.qp:case W.kt:d=ka.pS(e.type);break;case W.qi:d=ka.tS(e.Db);break;case W.zg:d=ka.XR(a,e);break;case W.LUMINANCE:d=ka.dS();break;case W.uN:d=ka.RR();break;case W.dt:d=ka.eS();break;case W.ap:d=
ka.TR();break;case W.$o:d=ha.Bb(b,e,W.ap);f=ha.Bb(b,d,W.ap);ha.Hc(d,e.fn);ha.Hc(f,e.fn);d=ka.UR();break;case W.yP:d=ka.RS();break;case W.Rm:d=ka.PR();break;case W.mp:d=ka.iS()}d&&(f=W.Nh(d,G.pq("NONE")),W.Oc(e,f),R(b,e,d),B(d))})};a.cn=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var e=a.s.Wa,d=b.k;!ha.ec(e,W.cd)&&d.ce&&(d.ce=!1);d=S(a,hb);c&&b.Im&&T.cn(b,a);for(var f=0;f<d.length;f++){var g=d[f],l=b,k=e,p=a,h=c;switch(g.type){case W.Ob:ba(g,l,k,"OPAQUE",p,h);break;case W.Lc:ba(g,
l,k,"BLEND",p,h);break;case W.Pf:ba(g,l,k,"XRAY",p,h);break;case W.ee:ba(g,l,k,"GLOW",p,h);break;case W.Md:case W.md:U(g,l,k,!1,p,h);break;case W.sf:case W.Ke:U(g,l,k,!0,p,h);break;case W.tf:for(var u=G.ja(l,p).U,w=0;w<u.length;w++){var n=u[w];if("SHADOW"==n.type&&"RECEIVE"==n.Db&&n.ce){if(!h&&(J(n,g,l,k,"SHADOW",p),!ka.Wc(n)))continue;var E=W.Nh(n,l.k);W.Oc(g,E);R(k,g,n);B(n)}}break;case W.cd:u=!1;w=l.k;l=G.ja(l,p).U;n=ha.ec(k,W.oi);for(E=0;E<l.length;E++){var m=l[E];if("SHADOW"==m.type&&"CAST"==
m.Db){u=!0;if(!h){var v=g.Tv;ka.ef(m,"NUM_LIGHTS",v);ka.ef(m,"NUM_LFACTORS",0==v%2?v/2:Math.floor(v/2)+1);qa.ga(m.hb,"SHADOW_USAGE","SHADOW_CASTING");m.hd&&n&&V(m,n,w);ka.ef(m,"SHADOW_TEX_RES",qa.M(p.s.ud.csm_resolution));if(!ka.Wc(m))continue}m=W.Nh(m,w);W.Oc(g,m)}}u&&(l=p.s.ud,h=ha.ec(k,W.Ob),ga(g,p,h.p,l,!0));break;case W.pf:I(g,l,k,p,h);break;case W.ni:I(g,l,k,p,h);break;case W.yg:u=l.k;w=G.ja(l,p).U;for(n=0;n<w.length;n++)if(E=w[n],"COLOR_ID"==E.type&&"OUTLINE"==E.Db){if(!h&&(J(E,g,l,k,"COLOR_ID",
p),ka.ef(E,"USE_OUTLINE",1),!ka.Wc(E)))continue;E=W.Nh(E,u);W.Oc(g,E)}break;case W.oi:k=l.k;l=G.ja(l,p).U;for(p=0;p<l.length;p++)if(u=l[p],"GRASS_MAP"==u.type){if(!h&&!ka.Wc(u))if("DEBUG"===Va.type())ka.yt(u,"error.glslv","error.glslf"),ka.Wc(u);else continue;u=W.Nh(u,k);W.Oc(g,u);u=g.p;m=k.Ta;w=g.ge[0];n=g.ge[1];E=g.ge[2];0==w&&0==n?(w=m.min_z,n=m.max_z):(w=Math.min(w,m.min_z),n=Math.max(n,m.max_z));m=1E-4*(n-w);w-=m;n+=m;g.ge[0]=w;g.ge[1]=n;ma.yw(u,E/2,-n,-w,E/2);ma.yk(u)}break;case W.rf:for(u=
l.k,l=G.ja(l,p).U,p=0;p<l.length;p++)w=l[p],"DEBUG_VIEW"==w.type&&Y(g,u,k,h,w)}}break;case "LAMP":aa(b,a),Da.xY(a)}G.DC(b,!0,a)};a.HD=p;a.EC=function(a){a.s.Pv=!0};a.MZ=function(a,b){ta.oa(b,function(b,c){if(c.type===W.cd){var e=ua.fc(a.n,ob);ua.ff(e,c.p.n);ua.copy(a.mf,c.p.es)}})};a.N8=Q;a.tU=function(a,b){for(var c=a.s.ud,e=new Float32Array(c.csm_num),d=0;d<c.csm_num;d++)e[d]=ma.US(c,b,d);return e};a.h1=Y;a.cG=ia;a.Wp=u;a.hB=function(a){return a.k.Mh};a.fX=function(a){for(var b=0;b<a.I.length;b++)for(var c=
S(a.I[b].xb,hb),b=0;b<c.length;b++)for(var e=c[b].Qa,d=0;d<e.length;d++)for(var f=e[d].ra,g=f.length-1;0<=g;g--){var l=f[g];l.bf==a.k&&(l.za&&ka.qG(l.za),f.splice(g,1))}};a.AZ=function(a,b){for(var c=a.Rc,e=G.ja(a,b).fm,d=S(b,jb),f=0;f<d.length;f++){var g=d[f];g.qr.set(c.hq,4*e);g.Aa=!0}};a.LM=aa;a.OZ=function(a){a=a.I;for(var b=0;b<a.length;b++)p(a[b].xb)};a.sa=function(){for(var a=0;a<Ta.length;a++){var b=Ta[a];ta.oa(b.s.Wa,function(a,b){if(b.type!=W.Zm){var c=b.p;Sa.gX(c.Ve,c.pc,c.Re,c.width,c.height);
for(var c=b.Qa,e=0;e<c.length;e++)for(var d=c[e].ra,f=0;f<d.length;f++){var g=d[f].za;g&&ka.qG(g)}}});b.s.Wa=[];b.s.um=[]}sb=mb=null;Ta.length=0;Nb=null};a.EJ=function(a,b,c){a=ma.CT(a,a.near,a.far,null,!0);var e=Ab.gU(a);a=G.pq("DYNAMIC");a.Ta=a.O={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.kb=a.wa=va.EQ();var d=a.kb.Xa;a.pb=a.aa=va.Kp([d,0,0],[0,d,0],[0,0,d],a.kb.G);a.Ro=!1;c=ka.oS(e,c);c=W.Nh(c,a);W.Oc(b,c)};a.B4=function(a){return[a.frame_start,a.frame_end]};a.AL=
function(a,b,c){Ga.lY(a,b,c);sb&&pa(sb,a,b)};a.N7=pa;a.fD=S;a.La=fa;a.aI=function(a){a=fa(a,W.Ob);var b=a.he,c=a.pe,e=[],d=[];e[0]=b[0];e[1]=b[1];e[2]=b[2];d[0]=c[0];d[1]=c[1];d[2]=c[2];return[a.Og,e,d]};a.HC=function(a,b,c,e){a=S(a,jb);for(var d=0;d<a.length;d++){var f=a[d];f.he.set(c);f.pe.set(e);f.Og=b;f.Aa=!0}};a.zI=function(a){if(a=fa(a,W.zg)){var b={};b.color=Array(3);Ua.copy(a.wo,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.rL=function(a,b){var c=fa(a,W.zg);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.wo.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.Aa=!0,c.Ov=!0,ja(a,c))};a.BU=function(a){return S(a,ab)[0].Yf[0]};a.zU=function(a){return S(a,ab)[0].Yf[1]};a.CU=function(a){return S(a,ab)[0].Yf[2]};
a.AU=function(a){return S(a,ab)[0].Yf[3]};a.eL=function(a,b){for(var c=S(a,ab),e=0;e<c.length;e++){var d=c[e];d.Yf[0]=b;d.Aa=!0}};a.cL=function(a,b){for(var c=S(a,ab),e=0;e<c.length;e++){var d=c[e];d.Yf[1]=b;d.Aa=!0}};a.fL=function(a,b){for(var c=S(a,ab),e=0;e<c.length;e++){var d=c[e];d.Yf[2]=b;d.Aa=!0}};a.dL=function(a,b){for(var c=S(a,ab),e=0;e<c.length;e++){var d=c[e];d.Yf[3]=b;d.Aa=!0}};a.dI=function(a,b){var c=b||[],e=S(a,ab)[0].xe;c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];return c};a.LC=function(a,
b){for(var c=S(a,ab),e=0;e<c.length;e++){var d=c[e];d.xe.set(b);d.Aa=!0}};a.BI=function(a){var b=fa(a,W.lt);a=fa(a,W.Oy);if(!b)return null;var c=b.Qa[0].ra[0].za,e={};e.ssao_quality=ka.EA(c,"SSAO_QUALITY")[1];e.ssao_hemisphere=b.ssao_hemisphere;e.ssao_blur_depth=a.ssao_blur_depth;e.RF=a.ssao_blur_discard_value;e.radius_increase=b.Co;e.influence=b.Bo;e.dist_factor=b.Ao;e.ssao_only=b.ssao_only;e.ssao_white=ka.EA(c,"SSAO_WHITE")[1];return e};a.tL=function(a,b){var c=fa(a,W.lt),e=fa(a,W.Oy);if(!c)return Ha.error("SSAO is not enabled on the scene"),
0;var d=c.Qa[0].ra[0],f=d.za;"string"==typeof b.ssao_quality&&(ka.ef(f,"SSAO_QUALITY",b.ssao_quality),ka.Wc(f),W.Oc(c,d));"number"==typeof b.ssao_hemisphere&&(ka.ef(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),ka.Wc(f),W.Oc(c,d));"number"==typeof b.ssao_blur_depth&&(ka.ef(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ka.Wc(f),W.Oc(c,d));"number"==typeof b.ssao_white&&(ka.ef(f,"SSAO_WHITE",b.ssao_white),ka.Wc(f),W.Oc(c,d));"number"==typeof b.ssao_blur_discard_value&&(e.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.Co&&(c.Co=b.Co);"number"==typeof b.Bo&&(c.Bo=b.Bo);"number"==typeof b.Ao&&(c.Ao=b.Ao);if("number"==typeof b.ssao_only){c=fa(a,W.Ob);c.ssao_only=b.ssao_only;for(var d=c.Qa,g=0;g<d.length;g++)for(var l=d[g].ra,k=0;k<l.length;k++)f=l[k].za,ka.ef(f,"SSAO_ONLY",b.ssao_only),ka.Wc(f),W.Oc(c,l[k])}c.Aa=!0;e.Aa=!0};a.ZH=function(a){a=fa(a,W.ep);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;
b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.bL=oa;a.gI=function(a){var b=S(a,[W.uj]);a=fa(a,W.Ys);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Sn;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ka.EA(b[0].Qa[0].ra[0].za,"STEPS_PER_PASS")[1];return c};a.hL=function(a,b){var c=S(a,[W.uj]),e=fa(a,W.Ys);if(!c||!e)return Ha.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(e.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var d=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].Sn=d,c[f].mw=d/c[f].Go/(f+1),c[f].Aa=!0;if("number"==typeof b.god_rays_steps)for(var g=qa.M(b.god_rays_steps,1),d=c[0].Sn,f=0;f<c.length;f++){c[f].Go=g;c[f].mw=d/g/(f+1);c[f].Aa=!0;var l=c[f].Qa[0].ra[0],k=l.za;ka.ef(k,"STEPS_PER_PASS",g);ka.Wc(k);W.Oc(c[f],l)}e.Aa=!0};a.TH=function(a){var b=fa(a,W.dt);a=fa(a,
W.$o);if(!b||!a)return null;var c={};c.key=b.Gt;c.edge_lum=b.Ft;c.blur=a.fn;return c};a.UK=xa;a.fI=function(a){a=fa(a,W.gp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.gL=la;a.NI=function(a){var b=za(a);a=Ua.length(b);if(0==a)return null;var b=Ma.df(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};
a.xX=function(a){a.s.MB=!0};a.KI=X;a.JI=function(a,b){var c=a.s.Ic,e=fa(a,W.Ob);e&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,e.ji&&(b.water_fog_density=e.ji[3],c=b.water_fog_color=[],c[0]=e.ji[0],c[1]=e.ji[1],c[2]=e.ji[2]))};a.yL=function(a,b){var c=a.s.Ic;if(!c)return Ha.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);
"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);
"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Cq=b.water_dynamic);for(var e=S(a,gb),d=0;d<e.length;d++){var f=e[d];"number"==typeof b.water_fog_density&&c.xe&&(f.ji[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.xe&&f.ji.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.QD=b.waves_height);"number"==typeof b.waves_length&&(f.RD=b.waves_length);f.Aa=!0}};a.yI=
function(a,b,c){var e=a.s.Ic;if(!e.Bk)return 100;var d=e.zB;a=e.Uk;var f=(b[0]-e.so[0])/e.uo[0],g=(e.so[1]+b[1])/e.uo[1],f=f+.5,g=g+.5;if(1<f||0>f||1<g||0>g)b=1;else return e=d*Ma.RH(sb.s.XC,e.YC,f,g),b=(a-b[2])*c,b=Math.sqrt(e*e+b*b)};a.update=function(a,b){for(var c=d().vj.k,e=0;e<Ta.length;e++){var f=Ta[e],g=f.s.Wa,l=f.s;if(l.Ic)var k=ua.F(c.n),p=k[2]-X(f,k[0],k[1]);for(k=0;k<l.Wo.length;k++){var h=l.Wo[k].s,u=h.Sa,n=h.td;if(!(f.b4w_use_nla&&h.Nk||!u&&!n)&&Oa.lN(h)){var m=Oa.iN(h),v=Oa.kN(h);u&&
Aa.is_mobile_device&&(v-=5);var I=Oa.g_(h);m>=I&&h.oj||m<v?(Oa.KK(h),n&&(h.xk=Oa.tw(h,a))):m>=I&&!h.oj?Oa.$B(h):Oa.mN(h)&&(u?Oa.QM(h):(u=Oa.tw(h,a),u!=h.xk&&(Oa.PM(h),h.ej++),h.xk=u))}}ta.oa(g,function(b,c){-1<vb.indexOf(c.type)&&(c.time=a);l.Ic&&(c.tz=p)})}for(e=0;e<Ta.length;e++)if(f=Ta[e],l=f.s,g=l.Wa,c=l.um,c.length)for(l.Pv&&(Z(f),l.Pv=!1),l.MB&&(ea(f),l.MB=!1),l.NB&&(w(f),l.NB=!1),l.motion_blur&&E(g,b),f=ha.ec(g,W.yg),k=0;k<c.length;k++)g=c[k],da.hw(g),f&&ya(g,f),Sa.sn(g);Aa.show_hud_debug_info&&
Ba.pY(Ta,b)};a.oX=function(a){a.s.NB=!0};a.BA=function(a){var b=[];ta.oa(a.s.Wa,function(a,c){b.push(c)});return b};a.VH=function(){var a=fa(sb,W.Lc),b=sb;return a||b.s.Ic?a.tz:null};a.OM=function(a){ta.oa(a.s.Wa,function(a,b){b.Aa=!0})};a.FX=function(a,b){a.debug_view_mode=b;a.ac=b!=Ca.Qs;a.Jb=b==Ca.Rs;a.Aa=!0;for(var c=d(),e=0;e<gb.length;e++){var f=fa(c,gb[e]);f&&(f.kA=b==Ca.fp)}};a.EX=function(a,b){a.debug_colors_seed=b;a.Aa=!0};a.ZX=function(a,b){a.eH=b;a.Aa=!0};a.jY=function(a,b){for(var c=
a.Qa,e=0;e<c.length;e++)for(var d=c[e].ra,f=0;f<d.length;f++){var g=d[f].za;Ua.copy(b,g.wireframe_edge_color);g.Aa=!0}};a.JM=function(a,b){var c=b.vn,e=a.s.sj;if(c&&"WIND"==c.type&&e){Ua.transformQuat(Ma.$c,ua.R(b.k.n),e);Ua.normalize(e,e);Ua.scale(e,c.cM,e);for(var c=S(a,vb),d=0;d<c.length;d++)c[d].sj.set(e);return!0}return!1};a.IW=function(a,b,c){var e=fa(a,W.pf);if(e){var d=Ga.Cn();ma.DX(e.p,b,c,d.clientWidth,d.clientHeight);da.hw(e);e.ac&&Sa.sn(e);if(a=fa(a,W.ni))Ra.copy(e.p.wb,a.p.wb),Ra.copy(e.p.ld,
a.p.ld),Ma.un(a.p.ld,a.p.Ih),da.hw(a),a.ac&&Sa.sn(a);if(e.ac||a&&a.ac)return Sa.oC(a?a.p.Ve:e.p.Ve,0,0)}else Ha.error("Object Selection is not available on the scene");return null};a.mL=function(a){var b=d();if(b=fa(b,W.Vm))b.aj.set(a),b.Aa=!0};a.c5=za;a.Hu=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.IM=function(a,b){var c=ob;Ua.negate(b,c);for(var e=0;6>e;e++){var d=a.Al[e],f=a.rq[e],g=a.p;Ra.translate(Ma.GN[e],
c,d);Ra.multiply(g.wb,d,g.ld);Ma.un(g.ld,f)}};a.MM=function(a,b,c){Ma.aZ(b,c,Ma.$c,a.p.lc)};a.uQ=function(a,b,c){var e=a.s.ud,d=a.s.Xh;c=G.Lu(c,Aa.ssao&&a.b4w_enable_ssao);if(d)for(var f=0;f<b.length;f++){var g=b[f],l=G.ja(g,a);if(-1!=g.k.Dd){var k=d.Uh,p=d.fw,g=g.k.Dd;p.length?l.Uh=p[g]:k.length&&(l.Uh=k[g])}else-1!=g.k.Qd&&(k=d.Bi,p=d.Zz,g=g.k.Qd,p.length?l.Bi=p[g]:k.length&&(l.Bi=k[g]))}for(f=0;f<c.length;f++)if(l=G.ja(c[f],a),e)for(b=S(a,[W.cd]),d=0;d<b.length;d++)f==b[d].kh&&l.WC.push(b[d])};
a.FJ=function(a,b){return a.timeline_markers[b]};a.zw=function(a){var b=d();if(b=fa(b,W.qi))a.distortion_coefs&&(b.El[0]=a.distortion_coefs[0],b.El[1]=a.distortion_coefs[1],b.Aa=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Aa=!0),a.base_line_factor&&(b.El[2]=
a.base_line_factor,b.Aa=!0),a.inter_lens_factor&&(b.El[3]=a.inter_lens_factor,b.Aa=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Aa=!0)};a.NJ=function(b,c){for(var e=Ta,d=0;d<e.length;d++)ha.tW(a.JA(e[d]),b,c)};a.J8=function(a){for(var b=Da.rc(a,"LAMP",Da.Jc),c=S(a,hb),e=0;e<c.length;e++)for(var d=c[e],f=d.Qa,g=0;g<f.length;g++)for(var l=f[g].ra,k=0;k<l.length;k++){var p=l[k],h=p.za;"MAIN"==h.type&&(ka.nZ(h,b,a),ka.Wc(h),W.Oc(d,p))}};a.A6=function(a){for(var b=0;b<Ta.length;b++)ta.oa(Ta[b].s.Wa,
function(b,c){for(var e=c.Qa,d=0;d<e.length;d++)for(var f=e[d].ra,g=0;g<f.length;g++){var l=f[g];l.za==a&&W.Oc(c,l)}})}};b4w.module.__hud=function(a,r){function m(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var d=0,f=0,k=0;n.oa(a.s.Wa,function(a,h){if(h.type!=x.Zm){for(var n=Math.round(h.p.width)+"x"+Math.round(h.p.height),m=0,y=0;y<h.Qa.length;y++)m+=h.Qa[y].ra.length;y=h.tq;if(h.type==x.md||h.type==x.Ke)m*=6;var q=h.ac,t=q?h.xf:0;h.Td||(h.xf=0);var c=
q?" (\u2713)":" (\u2715)",l=x.gD(h);b(c,l,h.Tv,n,y,"of",m,"  ",t.toFixed(3));h.tq=0;q&&(d+=m,f+=y,k+=t)}});return[d,f,k]}b("No INFO")}function b(){for(var a=80+20*f[0],b=arguments[0],d=1;d<arguments.length;d++){for(var n="",m=0;m<h[d]-String(arguments[d]).length;m++)n+=" ";b+=n+arguments[d]}f[0]++;k.fillText(b,30,a)}function t(a,b,d){b*=a.nc;d.x=a.x+b;d.y=a.y;d.nc=a.nc-2*b;d.Gb=a.Gb}function q(a){return a.x+a.nc/2}function z(a){var b=k,d={x:0,y:0,nc:0,Gb:0},f=b.canvas.width,b=b.canvas.height;d.x=
0;d.y=0;d.nc=f;d.Gb=b;t(d,.01,d);f=.02*d.Gb;d.x=d.x;d.y+=f;d.nc=d.nc;d.Gb-=2*f;f=d.nc/8;d.x+=f*a;d.y=d.y;d.nc=f;d.Gb=d.Gb;t(d,.02,d);return d}var n=r("__graph");r("__print");var x=r("__subscene"),h=[5,30,4,10,5,3,5],k=null,f=[0,0];a.Tg=function(a){a=a.getContext("2d");m(a);return k=a};a.rs=function(){k&&m(k)};a.reset=function(){var a=k;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),f[0]=0,f[1]=0)};a.pY=function(a,g){var h=
k;if(h){h.textAlign="left";h.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/g).toFixed(2));f[0]++;for(var n=h=0,m=0,q=0;q<a.length;q++){var x=d(a[q]),h=h+x[0],n=n+x[1],m=m+x[2];f[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",n,"of",h,"  ",m.toFixed(3))}};a.print=function(){var a=k;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.z6=function(a,b,d,f,h,n,m){var x=k;if(x){b=z(b);var t=b.Gb/5;b.x=b.x;b.y+=4*t;b.nc=
b.nc;b.Gb=t;x.textAlign="center";x.fillStyle="#00FF00";k.fillText(a,q(b),b.y-10);x.strokeStyle="#00FF00";x.lineWidth=.5;x.beginPath();x.moveTo(b.x,b.y);x.lineTo(b.x+b.nc,b.y);x.lineTo(b.x+b.nc,b.y+b.Gb);x.lineTo(b.x,b.y+b.Gb);x.closePath();x.stroke();if(!n&&!m)for(n=1E6,m=-1E6,a=0;a<d.length;a++)n=Math.min(n,d[a]),m=Math.max(m,d[a]);x.textAlign="right";k.fillText(String(n),b.x-10,b.y+b.Gb);k.fillText(String(m),b.x-10,b.y);x.textAlign="center";k.fillText(String(f),b.x,b.y+b.Gb+15);k.fillText(String(h),
b.x+b.nc,b.y+b.Gb+15);x.strokeStyle="#FF0000";x.lineWidth=1.5;x.beginPath();f=b.nc/(d.length-1);m=b.Gb/(m-n);for(a=0;a<d.length;a++)h=b.x+f*a,t=b.y+b.Gb-(d[a]-n)*m,0==a?x.moveTo(h,t):x.lineTo(h,t);x.stroke()}};a.M2=function(a,b,d,f,h,n,m){var x=k;if(x)for(x.textAlign="center",x.fillStyle="#00FF00",x.font="bold 12px Courier",d=z(d),k.fillText(b?"["+a+"]":a,q(d),d.y),0<=n&&k.fillText(n?"[M]":"[ ]",q(d)-15,d.y+30),0<=m&&k.fillText(m?"[S]":"[ ]",q(d)+15,d.y+30),a={x:0,y:0,nc:0,Gb:0},b=0;b<f.length;b++){n=
f[b];var t="VOLUME"==n[0];if(t){m=d.y+350;var r=d.nc,F=a;F.x=d.x;F.y=m;F.nc=r;F.Gb=250}else{m=d.y+50+50*b;var r=d.nc,F=d.Gb,c=a;c.x=d.x;c.y=m;c.nc=r;c.Gb=F}m=x;var r=a,c=b==h,l=n[0],F=n[1],C=n[2],v=n[3],e=(v-C)/n[4],e=1>e?Math.floor(1/e-1E-5).toFixed(0).length:0;n=n[5]?Math.log(F/C)/Math.log(v/C):(F-C)/(v-C);m.textAlign="center";c?m.fillText("["+l+"]",q(r),r.y):m.fillText(l,q(r),r.y);m.strokeStyle="#00FF00";m.lineWidth=t?3:1;t?(m.textAlign="right",m.fillText(v.toFixed(e),q(r)-10,r.y+15),m.textAlign=
"right",m.fillText(C.toFixed(e),q(r)-10,r.y+r.Gb-15)):(m.textAlign="right",m.fillText(C.toFixed(e),r.x+28,r.y+15),m.textAlign="left",m.fillText(v.toFixed(e),r.x+r.nc-28,r.y+15));m.beginPath();if(t){var R=r.y+15+(r.Gb-30)*(1-n);m.moveTo(q(r),r.y+15);m.lineTo(q(r),r.y+r.Gb-15);m.moveTo(q(r)-5,r.y+15);m.lineTo(q(r)+5,r.y+15);m.moveTo(q(r)-5,r.y+r.Gb-15);m.lineTo(q(r)+5,r.y+r.Gb-15);m.moveTo(q(r)-5,R);m.lineTo(q(r)+5,R)}else{var p=r.x+30+(r.nc-60)*n;m.moveTo(r.x+30,r.y+15);m.lineTo(r.x+r.nc-30,r.y+15);
m.moveTo(r.x+30,r.y+15-5);m.lineTo(r.x+30,r.y+15+5);m.moveTo(r.x+r.nc-30,r.y+15-5);m.lineTo(r.x+r.nc-30,r.y+15+5);m.moveTo(p,r.y+15-5);m.lineTo(p,r.y+15+5)}m.stroke();"EQ_Q"==l?(n=Math.log(1+1/(2*F*F)+Math.sqrt((2+1/(F*F))*(2+1/(F*F))/4-1))/Math.log(2),t?(m.textAlign="left",m.fillText(F.toFixed(e),q(r)+10,R),m.textAlign="left",m.fillText("("+n.toFixed(e+1)+")",q(r)+10,R+10)):(m.textAlign="right",m.fillText(F.toFixed(e),p,r.y+30),m.textAlign="left",m.fillText("("+n.toFixed(e+1)+")",p,r.y+30))):t?(m.textAlign=
"left",m.fillText(F.toFixed(e),q(r)+10,R)):(m.textAlign="center",m.fillText(F.toFixed(e),p,r.y+30))}}};b4w.module.__subscene=function(a,r){function m(a,b){a.Tv=b;a.qB=new Float32Array(3*b);a.rr=new Float32Array(4*b);a.qr=new Float32Array(4*b)}function d(a){a={type:a,Db:"",Jb:!1,dK:!1,cz:!1,Ov:!1,tq:0,xf:0,Bl:[],debug_view_mode:0,debug_colors_seed:0,eH:1,kA:!1,time:0,p:null,Al:null,rq:[],Qa:[],Ya:[],ei:[],sj:new Float32Array(3),ge:new Float32Array(3),xe:new Float32Array(4),Yf:new Float32Array(4),ue:new Float32Array(16),Nw:0,Og:0,Tv:0,qB:null,rr:null,qr:null,T5:null,he:new Float32Array(3),pe:new Float32Array(3),
Ow:new Float32Array(4),hM:new Float32Array(3),hD:new Float32Array([0,0,1]),iM:new Float32Array(4),Mw:new Float32Array(3),Cr:0,mA:0,gr:!1,aj:new Float32Array(3),rj:!1,tz:0,ji:null,QD:0,RD:0,Uk:0,Ic:null,Gg:!1,ZF:0,$F:new Float32Array(2),YF:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,wo:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,Co:0,Bo:0,Ao:0,XL:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Sn:0,mw:0,Go:0,Yz:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,ix:null,hx:null,LD:null,pm:null,uc:!1,CH:"",Gt:0,fn:0,Ft:0,hz:0,rA:0,mb_decay_threshold:0,mb_factor:0,LJ:0,gw:"",tG:"",AV:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,rD:new Float32Array(2),Eb:new Float32Array(2),
El:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,kh:0,LB:!0,ML:!1,RL:!1,NL:!1,OL:!1,QL:!1,PL:!1,LL:"",zs:!1,As:!1,Bs:!1,ac:!0,Td:!0,vb:!0,Ab:!0,Rd:!0,Aa:!0,rg:1};a.Eb[0]=1;a.Eb[1]=1;a.El[2]=.5;a.El[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function t(a,d){return-b(a.Ag,d.Ag)||b(a.kg,d.kg)||b(a.yb.VC,d.yb.VC)}var q=r("__camera"),z=r("__config"),n=r("__util"),x=r("__boundings"),h=z.Tc;a.Ob=0;a.Lc=1;a.Pf=2;a.Md=3;a.md=4;a.sf=5;a.Ke=6;a.ee=7;a.cd=
8;a.tf=9;a.oi=10;a.dc=11;a.ap=12;a.gp=13;a.Ym=14;a.pf=15;a.ni=16;a.rf=17;a.Rm=18;a.dE=19;a.lt=20;a.Oy=21;a.XD=22;a.qp=23;a.jt=24;a.My=25;a.kt=26;a.Gx=27;a.sh=28;a.Fx=29;a.ep=30;a.yg=31;a.Vm=32;a.uj=33;a.Ys=34;a.zg=35;a.Hx=36;a.qi=37;a.LUMINANCE=38;a.uN=39;a.dt=40;a.$o=41;a.yP=42;a.Zm=43;a.mp=44;a.KS=function(a,b,h,g){var A=d(8);A.Yz=a;A.self_shadow_polygon_offset=h.self_shadow_polygon_offset;A.kh=b;switch(h.Wg[b]){case "SPOT":case "POINT":A.p=q.gd(q.Nd);a=n.df(h.WL[b]);q.yw(A.p,a,h.$p[b],h.Zp[b]);
break;default:A.p=q.gd(q.ri)}m(A,g);return A};a.KR=function(a){var b=a.p;a.p=null;var d=n.P(a);a.p=b;d.p=q.Ec(b,!0);return d};a.DS=function(){var a=d(10);a.p=q.gd(q.uh);return a};a.zd=function(a){var b=d(11);b.vb=!1;b.Ab=!1;b.Rd=!1;b.uc=!0;b.p=q.gd(q.pd);b.gw=a;switch(a){case "NONE":b.Eb[0]=1;b.Eb[1]=1;break;case "GRAYSCALE":b.Eb[0]=1;b.Eb[1]=1;break;case "X_BLUR":b.Eb[0]=1;b.Eb[1]=0;break;case "Y_BLUR":b.Eb[0]=0;b.Eb[1]=1;break;case "X_GLOW_BLUR":b.Eb[0]=1;b.Eb[1]=0;break;case "Y_GLOW_BLUR":b.Eb[0]=
0;b.Eb[1]=1;break;case "X_DOF_BLUR":b.Eb[0]=1;b.Eb[1]=1;break;case "Y_DOF_BLUR":b.Eb[0]=1;b.Eb[1]=1;break;case "X_ALPHA_BLUR":b.Eb[0]=1;b.Eb[1]=0;b.rg=3;break;case "Y_ALPHA_BLUR":b.Eb[0]=0;b.Eb[1]=1;b.rg=3;break;case "X_EXTEND":b.Eb[0]=1;b.Eb[1]=0;break;case "Y_EXTEND":b.Eb[0]=0;b.Eb[1]=1;break;default:n.q("Wrong postprocessing effect: "+a)}return b};a.PG=function(a){var b=d(12);b.vb=!1;b.Ab=!1;b.Rd=!1;b.p=q.gd(q.pd);b.gw=a;b.uc=!0;switch(a){case "X_BLUR":b.Eb[0]=1;b.Eb[1]=0;break;case "Y_BLUR":b.Eb[0]=
0;b.Eb[1]=1;break;default:n.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.BS=function(a,b){var h=d(13);h.vb=!1;h.Ab=!1;h.Rd=!1;h.small_glow_mask_coeff=b.Sj.small_glow_mask_coeff;h.large_glow_mask_coeff=b.Sj.large_glow_mask_coeff;h.small_glow_mask_width=b.Sj.small_glow_mask_width;h.large_glow_mask_width=b.Sj.large_glow_mask_width;h.p=a;h.uc=!0;return h};a.yl=function(a,b,h,g,q,x,t,r,z){var P=d(a);0==a?(P.vb=!0,P.Ab=h,P.Jb=!1):1==a?(P.vb=!1,P.Ab=!1,P.Jb=!0):2==a?(P.vb=!1,P.Ab=!0,P.Jb=
!0):3==a||4==a?(P.vb=!0,P.Ab=!0,P.Jb=!1):5==a||6==a?(P.vb=!1,P.Ab=!1,P.Jb=!0):7==a?(P.vb=!0,P.Ab=!1,P.Jb=!0):n.q("wrong main subscene type");P.Jb&&r&&(P.self_shadow_normal_offset=r.self_shadow_normal_offset);P.p=b;if(a=t.xo)P.Ow.set([a.OF,a.WI,a.sN,a.rN]),P.Mw.set(a.color),P.Nw=a.Da;P.he.set(t.he);P.pe.set(t.pe);P.Og=t.Og;P.xe=x.xe;P.Yf=x.Yf;g&&(P.Ic=g,g.xe&&(P.ji=new Float32Array(g.xe)),P.QD=g.waves_height,P.RD=g.waves_length,P.Uk=g.Uk,g.Gg&&z&&(P.Gg=!0,P.ZF=g.fR,P.YF=g.eR,P.$F.set(g.gR)));m(P,q);
return P};a.$t=function(){var a=d(14);a.uc=!0;a.p=q.gd(q.pd);return a};a.QG=function(a,b,h){var g=d(15);b&&(g.type=16,g.vb=!1,g.Ab=!0);g.Td=!1;g.p=a;m(g,h);return g};a.zS=function(a){var b=d(17);b.ac=!1;b.vb=!1;b.Ab=!1;b.p=a;return b};a.vS=function(a){var b=d(18);b.vb=!0;b.Ab=!1;b.p=a;return b};a.LS=function(a,b){var h=d(9);h.p=a;m(h,b);return h};a.AS=function(a){var b=d(19);b.vb=!1;b.Ab=!1;b.p=a;b.uc=!0;return b};a.NS=function(a,b,h){var g=d(20);g.vb=!1;g.Ab=!1;g.Rd=!1;g.p=a;g.xe=b.xe;g.ji=new Float32Array(b.xe);
g.Co=h.radius_increase;g.ssao_hemisphere=h.bV;g.Bo=h.influence;g.Ao=h.dist_factor;g.XL=h.wX;g.uc=!0;return g};a.OS=function(a,b){var h=d(21);h.vb=!1;h.Ab=!1;h.Rd=!1;h.p=a;h.ssao_blur_depth=b.JQ;h.ssao_blur_discard_value=b.RF;h.uc=!0;return h};a.uS=function(a){var b=d(22);b.vb=!1;b.Ab=!1;b.Rd=!1;b.rg=1/a.jo;b.CH=a.eF;b.p=q.gd(q.pd);b.uc=!0;return b};a.Wz=function(a,b){var h=d(a);h.vb=23==a||24==a?!0:!1;h.Ab=!1;h.Rd=!1;h.rg=1/b.jo;h.p=q.gd(q.pd);23==a&&(h.BV=new Float32Array(4));h.uc=!0;return h};a.yS=
function(a,b,h,g){var n=d(27);n.vb=!1;n.Ab=!1;n.Rd=!1;n.p=q.gd(q.pd);n.brightness=a;n.contrast=b;n.exposure=h;n.saturation=g;n.uc=!0;return n};a.GS=function(a,b){var h=d(28);h.vb=!1;h.Ab=!1;h.Rd=!1;h.p=q.gd(q.pd);h.cz=!0;h.mb_decay_threshold=a;h.mb_factor=b;h.uc=!0;return h};a.Tz=function(a,b){var h=d(29);h.vb=!1;h.Ab=!1;h.Rd=!1;h.p=a;h.rg=h.p.dof_power;h.tG=b;h.uc=!0;return h};a.RG=function(a){var b=d(30);b.vb=!1;b.Ab=!1;b.Rd=!1;b.p=a;b.rg=b.p.dof_power;b.uc=!0;return b};a.IS=function(a,b){var h=
d(31);h.Rd=!1;h.p=a;m(h,b);return h};a.HS=function(a){var b=d(32);h.outlining_overview_mode?b.aj.set(h.aj):b.aj.set(a.aj);b.Cr=a.Cr;b.rA=5;b.hz=3;b.Rd=!1;b.p=q.gd(q.pd);b.uc=!0;return b};a.Vz=function(a,b,h,g,n,q,x){var t=d(33);t.vb=!1;t.Ab=!1;t.Rd=!1;t.he=new Float32Array([1,1,1]);t.pe=new Float32Array([1,1,1]);t.Og=1;t.dK=g;t.rj=b;t.mw=n;t.Sn=h;t.Go=x;t.p=a;m(t,q);return t};a.CS=function(a,b){var h=d(34);h.vb=!1;h.Ab=!1;h.Rd=!1;h.p=q.gd(q.pd);h.god_rays_intensity=a;m(h,b);h.uc=!0;return h};a.MS=
function(a,b,h,g){var x=d(35);x.Td=!1;x.vb=!1;x.Ab=!1;x.Rd=!1;var t=q.gd(q.pd);t.width=g;t.height=g;x.p=t;x.Al=n.eU();m(x,b);x.he=new Float32Array([1,1,1]);x.pe=new Float32Array([1,1,1]);x.Og=1;x.wo.set(h.wo);x.procedural_skydome=h.procedural_skydome;x.use_as_environment_lighting=h.use_as_environment_lighting;x.rayleigh_brightness=h.rayleigh_brightness;x.mie_brightness=h.mie_brightness;x.spot_brightness=h.spot_brightness;x.scatter_strength=h.scatter_strength;x.rayleigh_strength=h.rayleigh_strength;
x.mie_strength=h.mie_strength;x.rayleigh_collection_power=h.rayleigh_collection_power;x.mie_collection_power=h.mie_collection_power;x.mie_distribution=h.mie_distribution;if(a){x.he.set(a.he);x.pe.set(a.pe);x.Og=a.Og;if(b=a.xo)x.Ow.set([b.OF,b.WI,b.sN,b.rN]),x.Mw.set(b.color),x.Nw=b.Da,x.ML=b.invert,x.RL=b.YM,x.NL=b.TM,x.OL=b.UM,x.QL=b.WM,x.PL=b.VM,x.LL=b.PF;x.zs=a.zs;x.As=a.As;x.Bs=a.Bs}return x};a.Uz=function(){var a=d(36);a.vb=!1;a.Ab=!1;a.p=q.gd(q.pd);a.uc=!0;return a};a.PS=function(a){var b=d(37);
b.vb=!1;b.Ab=!1;b.Db=a?"HMD":"ANAGLYPH";b.p=q.gd(q.pd);b.uc=!0;return b};a.ES=function(){var a=d(38);a.vb=!1;a.Ab=!1;a.p=q.gd(q.pd);a.uc=!0;return a};a.wS=function(){var a=d(39);a.vb=!1;a.Ab=!1;a.p=q.gd(q.pd);a.uc=!0;return a};a.FS=function(a,b,h,g){var n=d(40);n.vb=!1;n.Ab=!1;n.Gt=a;n.Ft=b;n.p=g;m(n,h);n.uc=!0;return n};a.xS=function(a){var b=d(41);b.vb=!1;b.Ab=!1;b.p=q.gd(q.pd);b.fn=a;b.uc=!0;return b};a.A2=function(a){var b=d(42);b.vb=!1;b.Ab=!1;b.p=a;b.uc=!0;return b};a.SG=function(){var a=d(43);
a.Td=!1;return a};a.JS=function(){var a=d(44);a.uc=!0;return a};a.gD=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.gw.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Oc=function(a,b){for(var d=b.za,g=d.yb,h=0;h<a.Qa.length;h++){var n=a.Qa[h].ra,m=n.indexOf(b);
-1!=m&&(n.splice(m,1),n.length||a.Qa.splice(h,1))}h=a.Jb?d.kg:0;a:{n=a.Qa;for(m=0;m<n.length;m++){var q=n[m];if(q.yb==g&&h==q.kg){n=q;break a}}n=null}n?n.ra.push(b):(a.Qa.push({yb:g,ra:[b],Ag:d.Ag,kg:h,ac:!0}),a.LB=!0)};a.Nh=function(a,b){var d={ac:!0,lA:[!0,!0,!0,!0,!0,!0],bf:b,za:a,jv:null};if(a.of&&a.Ba.ie){var g=a.Ba.ie;d.jv={oW:new Float32Array(g.length),pW:new Float32Array(g.length),iT:new Float32Array(g.length/3),tN:new Float32Array(3),DQ:x.VQ(a.O)}}return d};a.wY=function(a){a.Qa.sort(t);
a.LB=!1}};b4w.module.__input=function(a,r){function m(a){var b=V.ku();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function d(a,b){if(!m(a))return null;var c={type:a,hh:!1,lg:[],bh:[],Ti:[],$d:[],Ui:[],Vi:[],mr:[],rJ:[],Pi:[],nj:[],mj:[],lj:[],element:b,Vh:!0,Vb:[],Nv:new Float32Array(2),sW:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Yo:null,ki:null,Of:null,orientation:ga.create(),position:I.create(),
Gi:new Float32Array(4),Hi:new Float32Array(4),Oi:0,Aj:0,uk:0,Pm:0,Uj:0,Bj:0,Nl:[],Rj:[0,0,0,0,0,0,0,0,0,0,0,0],DH:[0,0,0,0,0,0,0,0,0,0,0,0],zu:[]};c.Gi[0]=c.Gi[1]=c.Gi[2]=c.Gi[3]=45;c.Hi[0]=c.Hi[1]=c.Hi[2]=c.Hi[3]=45;30==a||40==a||50==a?(c.hh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Vh=!1)):10==a?c.hh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ia.is_mobile_device?q(c,u.webvr):(t(c),c.hh=!0));return c}function b(b,c){10==b||20==b?c=window:c||
(c=40==b?document:U.We());for(var e=0;e<la.length;e++)if(la[e].type==b&&la[e].element==c)return la[e];e=d(b,c);60!=b&&70!=b&&80!=b&&90!=b||e.zu.push(a.cy,a.dy,a.oy,a.vy,a.wy,a.xy,a.Ws,a.Xs,a.yy,a.zy,a.ey,a.fy,a.gy,a.hy,a.iy,a.jy,a.ky,a.ly,a.my,a.ny,a.py,a.qy,a.ry,a.sy,a.ty,a.uy,a.Ss,a.Ts,a.Us,a.Vs,a.Xx,a.Yx,a.Zx,a.$x,a.ay,a.by,a.Vx,a.Wx);e&&la.push(e);return e}function t(a){var b=u.nonwebvr;a.Pm=b.Pm;a.Uj=b.Uj;a.Bj=b.Bj;q(a,b);a.Oi=b.Oi;a.Aj=b.Aj;a.uk=b.uk;n(a)}function q(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function z(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function n(a){var b=a.Aj-a.Bj,c=a.Uj-b,e=a.Oi/2,d=(a.Pm-a.Oi)/2,b=Q.df(Math.atan(b/a.uk)),c=Q.df(Math.atan(c/a.uk)),e=Q.df(Math.atan(e/
a.uk)),d=Q.df(Math.atan(d/a.uk));c&&(a.Gi[0]=a.Hi[0]=Math.min(c,60));e&&(a.Gi[1]=a.Hi[3]=Math.min(e,60));b&&(a.Gi[2]=a.Hi[2]=Math.min(b,60));d&&(a.Gi[3]=a.Hi[1]=Math.min(d,60))}function x(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),e=null;c.length&&(e=c[0]);c=null;e&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==e.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Yo=e;a.ki=c}function h(a,b,c){switch(a.type){case 20:var e=
a.Of||a.Yo;e?(b=e.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,e=z(a,Math.tan(Q.Kb(b.downDegrees))),Q.df(Math.atan(e)),e=z(a,Math.tan(Q.Kb(b.upDegrees))),Q.df(Math.atan(e)),e=z(a,Math.tan(Q.Kb(b.leftDegrees))),Q.df(Math.atan(e)),a=z(a,Math.tan(Q.Kb(b.rightDegrees))),Q.df(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Gi:a.Hi,Y.copy(b,c));break;default:w.error("fov is undefined for device: ",a.type)}return c}
function k(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ia.is_mobile_device?1:0:2;case 23:var c=a.Of||a.Yo;if(c){var e=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.Of?c.offset[0]-e.offset[0]:c.eyeTranslation.x-e.eyeTranslation.x}return a.Oi}}function f(a,b){if(a.Of){var c=a.Of,e=c.capabilities,c=c.getPose();e.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],a.orientation[3]=
c.orientation[3]);e.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-wa&&(wa=b,navigator.getVRDisplays?a.Of||navigator.getVRDisplays().then(function(b){0<b.length&&(a.Of=b[0],a.hh=!0)},function(){w.N("WebVR displays are not found.");a.hh=!1}):navigator.getVRDevices?a.Yo||pa||navigator.getVRDevices().then(function(b){x(a,b);b.length&&(a.hh=!0);pa=!0},function(){w.N("WebVR devices are not found.");a.hh=!1;pa=!0}):ia.is_mobile_device||
w.N("HMD isn't supported."))}function y(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.Nl[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.Rj[c]=a.axes[c]}}function g(a){for(var b=0;b<a.Nl;b++)a.Nl[b]=0;for(b=0;b<a.Rj.length;b++)a.DH[b]=a.Rj[b],a.Rj[b]=0}function A(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function N(a){return null===a}function H(a,b,d,f){switch(b){case 120:d&&A(a.lg,d);if(f||a.bh.every(N)&&a.lg.every(N))a.lg.length=0,a.bh.length=0,b=a.Vb.indexOf(131),0<=b&&(a.Vb.splice(b,
1),a.element.removeEventListener("deviceorientation",D,!1));break;case 130:d&&A(a.bh,d);if(f||a.bh.every(N)&&a.lg.every(N))a.lg.length=0,a.bh.length=0,b=a.Vb.indexOf(131),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;case 40:d&&A(a.Ti,d);if(f||a.Ti.every(N))a.Ti.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("mousedown",F,!1));break;case 30:d&&A(a.$d,d);if(f||a.$d.every(N))a.$d.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,
1),a.element.removeEventListener("mousemove",K,!1));break;case 31:d&&A(a.$d,d);if(f||a.$d.every(N))a.$d.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("mousemove",M,!1));break;case 50:d&&A(a.Ui,d);if(f||a.Ui.every(N)){a.Ui.length=0;b=a.Vb.indexOf(b);0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("mouseout",c,!1),a.element.removeEventListener("mouseup",l,!1));break}break;case 60:d&&A(a.Vi,d);if(f||a.Vi.every(N))a.Vi.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,
1),a.element.removeEventListener("wheel",C,!1));break;case 80:d&&A(a.mr,d);if(f||a.mr.every(N))a.mr.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("keydown",v,!1));break;case 70:d&&A(a.Pi,d);if(f||a.Pi.every(N))a.Pi.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("keyup",e,!1));break;case 90:d&&A(a.nj,d);if(f||a.nj.every(N))a.nj.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("touchstart",R,!1));break;
case 100:d&&A(a.mj,d);if(f||a.mj.every(N))a.mj.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("touchmove",p,!1));break;case 110:if(d&&A(a.lj,d),f||a.lj.every(N))a.lj.length=0,b=a.Vb.indexOf(b),0<=b&&(a.Vb.splice(b,1),a.element.removeEventListener("touchend",ba,!1))}}function O(a,b){Q.TB(a,Q.Ry,b);var c="orientation"in window?Q.Kb(window.orientation):"orientation"in window.screen?Q.Kb(window.screen.orientation.angle):0,c=ga.setAxisAngle(Q.Zc,c,ca);ga.multiply(b,c,
b);return b}function D(a){var c=ja;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=Q.Kb(a.alpha),c[1]=Q.Kb(a.beta),c[2]=Q.Kb(a.gamma));a=b(10,a.currentTarget);for(var e=0;e<a.bh.length;e++){var d=a.bh[e];d&&(I.copy(c,fa),d(fa))}if(a.lg.length)for(c=O(c,aa),e=0;e<a.lg.length;e++)if(d=a.lg[e])ga.copy(c,oa),d(oa);for(e=0;e<a.lg.length;e++)a.lg[e]||a.lg.splice(e,1);for(e=0;e<a.bh.length;e++)a.bh[e]||a.bh.splice(e,1)}function P(a,b){switch(a.type){case 30:a.Nv[0]=b.clientX,a.Nv[1]=
b.clientY,a.sW=b.which}}function K(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);P(c,a);for(var e=0;e<c.$d.length;e++){var d=c.$d[e];d&&(S[0]=a.clientX,S[1]=a.clientY,d(S))}c.Vh&&a.preventDefault();for(e=0;e<c.$d.length;e++)c.$d[e]||c.$d.splice(e,1)}}function M(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);P(c,a);for(var e=0;e<c.$d.length;e++){var d=
c.$d[e];if(d){if("number"==typeof a.movementX)var f=a.movementX,g=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,g=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,g=a.mozMovementY):g=f=0;S[0]=f;S[1]=g;d(S)}}c.Vh&&a.preventDefault();for(e=0;e<c.$d.length;e++)c.$d[e]||c.$d.splice(e,1)}}function F(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);P(c,a);for(var e=0;e<c.Ti.length;e++){var d=
c.Ti[e];d&&d(a.which)}c.Vh&&a.preventDefault();for(e=0;e<c.Ti.length;e++)c.Ti[e]||c.Ti.splice(e,1)}}function c(a){!U.gJ(a.relatedTarget)&&a.which&&l(a)}function l(a){if(!xa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);P(c,a);for(var e=0;e<c.Ui.length;e++){var d=c.Ui[e];d&&d(a.which)}c.Vh&&a.preventDefault();for(e=0;e<c.Ui.length;e++)c.Ui[e]||c.Ui.splice(e,1)}}function C(a){for(var c=b(30,a.currentTarget),e=0;e<c.Vi.length;e++){var d=
c.Vi[e];d&&d(-a.deltaY)}c.Vh&&a.preventDefault();for(e=0;e<c.Vi.length;e++)c.Vi[e]||c.Vi.splice(e,1)}function v(a){for(var c=b(40,a.currentTarget),e=a.ctrlKey||a.altKey||a.metaKey?c.rJ:c.mr,d=0;d<e.length;d++){var f=e[d];f?f(a.keyCode):e.splice(d--,1)}c.Vh&&a.preventDefault()}function e(a){for(var c=b(40,a.currentTarget),e=0;e<c.Pi.length;e++){var d=c.Pi[e];d&&d(a.keyCode)}c.Vh&&a.preventDefault();for(e=0;e<c.Pi.length;e++)c.Pi[e]||c.Pi.splice(e,1)}function R(a){for(var c=b(50,a.currentTarget),e=
0;e<c.nj.length;e++){var d=c.nj[e];d&&d(a.targetTouches)}for(e=0;e<c.nj.length;e++)c.nj[e]||c.nj.splice(e,1)}function p(a){for(var c=b(50,a.currentTarget),e=0;e<c.mj.length;e++){var d=c.mj[e];d&&d(a.targetTouches)}c.Vh&&a.preventDefault();for(e=0;e<c.mj.length;e++)c.mj[e]||c.mj.splice(e,1)}function ba(a){for(var c=b(50,a.currentTarget),e=0;e<c.lj.length;e++){var d=c.lj[e];d&&d(a.targetTouches)}for(e=0;e<c.lj.length;e++)c.lj[e]||c.lj.splice(e,1)}function J(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function B(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var e=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof e&&e.apply(c)}var V=r("__compat"),U=r("__container"),Z=r("__config"),w=r("__print"),ga=r("__quat"),Q=r("__util"),I=r("__vec3"),Y=r("__vec4"),ia=Z.A,u=Z.cV;a.rh=10;a.Je=20;a.ad=30;a.cp=40;a.wg=50;a.Ns=60;a.Mx=70;a.Nx=80;a.Ox=90;a.fE=0;a.gE=1;a.eE=2;a.Hy=3;a.bt=0;a.$s=10;a.at=20;a.zN=21;a.AN=22;a.Dy=23;a.Cy=24;a.Ay=25;a.Fy=26;a.Gy=27;a.Ey=28;
a.By=29;a.pi=30;a.sE=31;a.Xk=40;a.kp=50;a.lp=60;a.ip=70;a.hp=80;a.jE=81;a.al=90;a.rp=100;a.$k=110;a.Zs=120;a.Um=130;a.cy=300;a.dy=301;a.oy=302;a.vy=303;a.wy=304;a.xy=305;a.Ws=306;a.Xs=307;a.yy=308;a.zy=309;a.ey=310;a.fy=311;a.gy=312;a.hy=313;a.iy=314;a.jy=315;a.ky=316;a.ly=317;a.my=318;a.ny=319;a.py=320;a.qy=321;a.ry=322;a.sy=323;a.ty=324;a.uy=325;a.Ss=326;a.Ts=327;a.Us=328;a.Vs=329;a.Xx=330;a.Yx=331;a.Zx=332;a.$x=333;a.ay=334;a.by=335;a.Vx=336;a.Wx=337;var aa=ga.create(),ca=ga.create(),ja=I.create(),
wa=-Infinity,pa=!1,S=new Float32Array(2);I.create();var fa=I.create(),oa=ga.create(),xa="ontouchstart"in document.documentElement,la=[];a.uz=m;a.ia=b;a.lD=function(a,b){a.Vh=b};a.vC=function(a){switch(a.type){case 20:if(a.hh)if(a.Of)a.Of.resetPose();else if(a.ki)for(var b=0;b<a.ki.length;b++)a.ki[b].resetSensor();break;default:w.error("reset_device() is undefined for device: ",a.type)}};a.Mi=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:I.copy(Q.Xm,c);if(a.Of)c[0]=a.orientation[0],c[1]=
a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.ki)for(b=0;b<a.ki.length;b++){var e=a.ki[b],e=e.getState&&e.getState()||e.getImmediateState&&e.getImmediateState();e.orientation&&(c[0]=e.orientation.x,c[1]=e.orientation.y,c[2]=e.orientation.z,c[3]=e.orientation.w)}ga.normalize(c,c);a=ga.setAxisAngle(Q.li,Math.PI/2,ca);ga.multiply(a,c,c);break a;default:w.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:I.copy(Q.Qy,c);if(a.Of)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.ki)for(b=0;b<a.ki.length;b++)e=a.ki[b],e=e.getState&&e.getState()||e.getImmediateState&&e.getImmediateState(),e.position&&(c[0]=e.position.x,c[1]=-e.position.z,c[2]=e.position.y);break a;default:w.error("position is undefined for device: ",a.type)}return c;case 21:return h(a,"left",c);case 22:return h(a,"right",c);case 30:case 31:return c[0]=a.Nv[0],c[1]=a.Nv[1],c}};a.Nu=k;a.GC=function(a,b,c){switch(a.type){case 20:if(3===k(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Oi=c;n(a);break;case 25:a.Aj=c;n(a);break;case 26:a.uk=c;n(a);break;case 27:a.Pm=c;n(a);break;case 28:a.Uj=c;n(a);break;case 29:a.Bj=c,n(a)}break;case 60:case 70:case 80:case 90:a.zu[b]=c}};a.HU=function(a,b){var c=b-300;return c<a.Nl.length?a.Nl[a.zu[c]-300]:!1};a.GU=function(a,b){return b-326<a.Rj.length?a.Rj[a.zu[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],c=0;c<la.length;c++){var e=la[c];switch(e.type){case 60:g(e);y(b[0],e);break;case 70:g(e);y(b[1],e);break;case 80:g(e);y(b[2],e);break;case 90:g(e);y(b[3],e);break;case 20:f(e,a)}}};a.xd=function(a,b,d){switch(b){case 120:a.lg.push(d);b=131;break;case 130:a.bh.push(d);b=131;break;case 40:a.Ti.push(d);break;case 30:case 31:a.$d.push(d);break;case 50:a.Ui.push(d);break;case 60:a.Vi.push(d);break;case 80:a.mr.push(d);break;case 81:a.rJ.push(d);b=80;break;case 70:a.Pi.push(d);
break;case 90:a.nj.push(d);break;case 100:a.mj.push(d);break;case 110:a.lj.push(d)}if(-1==a.Vb.indexOf(b)&&(a.Vb.push(b),a.hh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",F,!1);break;case 30:a.element.addEventListener("mousemove",K,!1);break;case 31:a.element.addEventListener("mousemove",M,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",c,!1),a.element.addEventListener("mouseup",
l,!1));break;case 60:a.element.addEventListener("wheel",C,!1);break;case 80:a.element.addEventListener("keydown",v,!1);break;case 70:a.element.addEventListener("keyup",e,!1);break;case 90:a.element.addEventListener("touchstart",R,!1);break;case 100:a.element.addEventListener("touchmove",p,!1);break;case 110:a.element.addEventListener("touchend",ba,!1);break;case 131:a.element.addEventListener("deviceorientation",D,!1)}};a.Ad=function(a,b,c){H(a,b,c,!1)};a.XU=O;a.sa=function(){for(var a=0;a<la.length;a++)for(var b=
la[a],c=0;c<b.Vb.length;c++)H(b,b.Vb[c],null,!0);la.length=0};a.pI=function(a){a=b(J(a));for(var c=0;c<a.Nl.length;c++)if(a.Nl[c])return c+300;return-1};a.jI=function(a){a=b(J(a));for(var c=0;c<a.Rj.length;c++)if(a.DH[c]-a.Rj[c])return c+326;return-1};a.cI=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.LI=function(){var a=b(20);return a&&a.Of};a.KP=function(a){a.element.addEventListener("mousedown",
function(){a.value||B(a)},!1)}};b4w.module.__physics=function(a,r){function m(a,b){for(var c=a.Pe,e=0;e<c.length;e++)c[e].eh.us&&b.push(c[e]),m(c[e],b)}function d(a,b,c){for(var e=a.wc.ra,d=0;d<e.length;d++)for(var f=e[d].C,g=0;g<f.Oe.length;g++){var l=f.Oe[g];"ANY"!=l.$b&&c!=l.$b||P(l,a,b)}}function b(a,b,c){if(B.mv(a))switch(b){case B.PN:var e=t(a);e.wc.pN=!0;B.fa(a,B.$O,Date.now()-performance.now(),ca.max_fps,ca.pz?ja.yH:0);break;case B.QN:U.Zd("URANIUM:",c.slice(1));break;case B.LN:U.error(c);break;case B.MN:J.tu.apply(this,
c.slice(1));break;case B.VN:var d=q(c.ea);if(d){a=c.trans;e=c.quat;b=c.Ph;var f=c.xh,d=d.C;d.du=c.time;I.$h(a,1,e,d.aA);ia.copy(b,d.Ph);ia.copy(f,d.xh)}break;case B.SN:(a=q(c.vz))&&I.$h(c.trans,1,c.quat,a.v.Nr[c.iC]);break;case B.NN:if(e=q(c[1]))a=c[4],e=e.Xf.Ht[c[2]],Q.Uc(e,c[3]),Q.Zh(e,a),Q.D(e);break;case B.WN:if(d=q(c[1]))d.v.speed=c[2];break;case B.HN:e=t(a);z(e,c.nl,c.ol,c.result,null,null,0);break;case B.JN:e=t(a);z(e,c.nl,c.ol,c.result,c.vl,c.coll_norm,c.coll_dist);break;case B.IN:if(d=q(c[1]))a=
d.C,a.ul&&a.ul(c[2]);break;case B.iE:case B.TN:e=t(a);if(a=e.wc.pk[c.id])if(e=q(c.gn),b==B.iE)b=a.callback,b(a.id,c.hit_fract,e,c.hit_time);else{b=c.hit_fract;var f=c.hit_time,d=c.hit_pos,g=a.callback;d?g(a.id,b,e,f,d,c.hit_norm):g(a.id,b,e,f)}break;case B.UN:F(id);break;case B.RN:a=S.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case B.ON:pa=c[1];break;case B.KN:a=
S.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:U.error("Wrong message: "+b)}}function t(a){for(var b=0;b<S.length;b++)if(S[b]==a)return fa[b]}function q(a){return oa[a]||null}function z(a,b,c,e,d,f,g){a=a.wc.ra;for(var l=0;l<a.length;l++)for(var k=a[l].C,h=0;h<k.Oe.length;h++){for(var p=k.Oe[h],u=p.nk,w=!1,m=0;m<u.length;m++){var v=u[m];if(v[0]===b&&v[1]===c){p.Dr[m]=e;w=!0;break}}w&&(u=n(p),d&&p.iz!=b&&(w=d,m=f,v=g,w[0]+=m[0]*v,w[1]+=m[1]*v,w[2]+=m[2]*v,m[0]*=-1,
m[1]*=-1,m[2]*=-1),p.callback(u,u?p.iz==b?q(c):q(b):null,d,f,g))}}function n(a){a=a.Dr;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function x(){X.body++;return X.body}function h(a){var b=la.indexOf(a);return-1==b?(la.push(a),la.length-1):b}function k(a,b){return{ea:a,type:b,Rh:0,pv:!1,Ck:!0,Xe:!1,dg:!1,sV:!1,St:null,$b:"",eq:0,p2:{},Oe:[],ul:null,du:0,aA:new Float32Array([0,0,0,1,0,0,0,1]),Ph:new Float32Array(3),xh:new Float32Array(3),Jt:new Float32Array(3),Sp:new Float32Array(4),xr:null}}
function f(a,b){switch(a){case "BOX":var c=b.O;break;case "CYLINDER":c=b.Jp;break;case "CONE":c=b.Ip;break;case "SPHERE":c=b.wa;break;case "CAPSULE":c=b.Hp}return c}function y(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.G&&(b.center=
a.G);"number"===typeof a.Xa&&(b.radius=a.Xa);"number"===typeof a.height&&(b.height=a.height);return b}function g(a,b,c,e,d){var f=I.F(a.k.n),g=I.invert(b.k.n,L),l=new Float32Array(3);I.Vc(f,g,l);switch(b.v.type){case 10:b=b.kf;a=a.k.O;B.fa(d,B.DO,c,l,b.QY,b.AC,(a.max_z-a.min_z)/2,e);break;case 20:B.fa(d,B.CO,c,l,a.j8)}}function A(a){return a.C&&a.C.St}function N(a,b,c,e,d,f,g,l,k,h){var p;X.ic++;p=X.ic.toString(16);var u=b.C.ea;B.fa(H(u),B.KO,p,a,l,u,c,e,d.C.ea,f,g,k,h);b.C.St=p}function H(a){for(var b=
0;b<fa.length;b++)for(var c=fa[b].wc.ra,e=0;e<c.length;e++)if(c[e].C.ea==a)return S[b];return null}function O(a){var b=a.C;if(b=b?0===b.Rh?!0:!0===b.pv?!0:!1===b.Ck?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=I.fc(a.k.n,ya),c=I.Wd(a.k.n,na),b=b[0]!=a.C.Jt[0]||b[1]!=a.C.Jt[1]||b[2]!=a.C.Jt[2]||c[0]!=a.C.Sp[0]||c[1]!=a.C.Sp[1]||c[2]!=a.C.Sp[2]||c[3]!=a.C.Sp[3];if(b){var b=a.C,e=a.k,c=B.kI(B.et);c.ea=b.ea;var d=I.fc(e.n,c.trans),e=I.Wd(e.n,c.quat);ia.copy(d,b.Jt);Z.copy(e,b.Sp);"DYNAMIC"==
b.type&&Z.identity(c.quat);B.fa(H(b.ea),B.et)}a=a.Pe;for(b=0;b<a.length;b++)O(a[b])}function D(a,b,c,e,d){d=d||new Float32Array(3);a=I.R(a.k.n);d[0]=b;d[1]=c;d[2]=e;ia.transformQuat(d,a,d)}function P(a,b,c){var e=a.nk,d=a.Dr,f=a.iz,g=[],l=a.$b;g||Y.q("At least one destination required");for(var k=0;k<b.wc.ra.length;k++){var h=b.wc.ra[k];if("ANY"==l||h.C.$b==l&&"NAVMESH"!=h.C.type)h=h.C.ea,g&&-1==g.indexOf(h)&&g.push(h)}for(b=0;b<g.length;b++)l=g[b],f<l&&!K(e,f,l)?(e.push([f,l]),d.push(!1)):f>l&&!K(e,
l,f)&&(e.push([l,f]),d.push(!1));B.fa(c,B.BO,f);B.fa(c,B.JO,e,a.Ah)}function K(a,b,c){for(var e=0;e<a.length;e++)if(a[e][0]==b&&a[e][1]==c)return!0;return!1}function M(a){a.C&&a.C.ul&&(a=a.C,B.fa(H(a.ea),B.WO,a.ea),a.ul=null)}function F(a){var b=l(a),e=c(a).wc;e.pk[a]&&(delete e.pk[a],e.nC.splice(e.nC.indexOf,1),B.fa(b,B.eP,a))}function c(a){for(var b=0;b<fa.length;b++){var c=fa[b];if(c.wc.pk[a])return c}return null}function l(a){for(var b=0;b<fa.length;b++)if(fa[b].wc.pk[a])return S[b];return null}
function C(a,b,c){if(b.Fo){a=a.C.ea;var e=b.tn*b.Lq,d=b.Qp*b.Rp,f=-b.Do*b.Eo*2*Math.PI/b.ns;b.fr&&(f*=-1);switch(b.type){case 10:B.fa(c,B.rP,a,e,d,f);break;case 20:B.fa(c,B.qP,a,e,d,f)}}}function v(a){return a.Xe&&"CHASSIS"==a.kf.cf}function e(a){return a.Xe&&"HULL"==a.kf.cf}function R(a){return"NAVMESH"==a.eh.Hr}function p(a){return a.am&&"MAIN_BODY"==a.wn.cf}var ba=r("__config"),J=r("__debug"),B=r("__ipc"),V=r("__obj_util"),U=r("__print"),Z=r("__quat"),w=r("__scenes"),ga=r("__subscene"),Q=r("__transform"),
I=r("__tsr"),Y=r("__util"),ia=r("__vec3"),u=r("__version"),aa=r("__navmesh"),ca=ba.C,ja=ba.A,wa=ba.Od,pa=0,S=[],fa=[],oa={},xa=[],la=["ANY"],X={body:0,ic:0,BK:0},ya=new Float32Array(3);new Float32Array(4);var na=new Float32Array(4);new Float32Array(16);var L=I.create(),ea=I.create();a.kV=function(a){a.wc={pN:!1,ra:[],pk:{},nC:[]};var c=ca.ts;wa.prevent_caching&&(c+=u.timestamp());U.log("%cLOAD PHYSICS","color: #0a0",ca.Cs?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ca.max_fps);
U.log("%cPHYSICS PATH","color: #0a0",c);var e=B.SS(c,!ca.Cs);B.xQ(e,b);S.push(e);fa.push(a);ca.ping&&setInterval(function(){B.fa(e,B.bP,performance.now())},1E3)};a.yR=function(a){return a.wc?a.wc.pN:!0};a.sa=function(){for(var a=0;a<S.length;a++)B.terminate(S[a]);S.length=0;fa.length=0;oa={};xa.length=0;la.length=0;for(var b in X)X[b]=0};a.cn=function(a,b){a.k||Y.q("No object render: "+a.name);var c;a:{for(var l=0;l<fa.length;l++)if(fa[l]==b){c=S[l];break a}c=void 0}var u=[];a.eh.us&&m(a,u);var w=
b.wc.ra;if(v(a)||e(a)||a.dg||p(a)||a.Im){var n=R(a),q;if(n){var Q=a,t=x(),r=k(t,"NAVMESH"),F=V.ja(Q,b).U;r.xr=null;for(var ga=0;ga<F.length;ga++){var z=F[ga];if("PHYSICS"==z.type){r.xr=aa.uW(z.Ba);break}}q=r}else{var M=a,H=c,D=M.k,ca=M.eh,ia=ca.Hr,J=x();if("CAMERA"==M.type)var K=ca.JD?ca.Qt:"BOX",ja=f(K,D),P=D.Ml,O=D.Gl,P=.5,O=0;else if("EMPTY"==M.type)K="EMPTY",ja=null,O=P=0;else{var K=ca.JD?ca.Qt:"BOX",ja=f(K,D),ba=I.Xd(D.n);if(1!=ba){var X=ja;switch(K){case "BOX":X.min_x*=ba;X.max_x*=ba;X.min_y*=
ba;X.max_y*=ba;X.min_z*=ba;X.max_z*=ba;break;case "CYLINDER":case "CONE":case "CAPSULE":X.height*=ba;X.Xa*=ba;break;case "SPHERE":X.Xa*=ba}}P=D.Ml;O=D.Gl}var wa=I.F(D.n),pa=I.R(D.n),la=ca.ys,ya=ca.ZM,nb=ca.Rh,Va=ca.eN,Aa=ca.dN,kb=ca.cH,Ya=ca.MK,La=M.$b,hb=h(La),jb=ca.fq,ab=ca.dq,vb=ca.gq,gb=D.wa.Xa,mb=y(ja),sb=M.Ut,Ta;var Nb=K;if(u.length){var dc=[],Xb={};Xb.quat=new Float32Array([0,0,0,1]);Xb.trans=new Float32Array(3);Xb.worker_bounding=mb;Xb.bounding_type=Nb;dc.push(Xb);var ob=I.invert(D.n,L),nd=
na;Z.invert(I.R(D.n),nd);for(var Bb=0;Bb<u.length;Bb++){var db={},ic=u[Bb],Nc=ic.eh.Qt,Vc=new Float32Array(4),sc=new Float32Array(3),Qc=I.R(ic.k.n);I.Vc(I.F(ic.k.n),ob,sc);Z.multiply(nd,Qc,Vc);db.trans=sc;db.quat=Vc;db.bounding_type=Nc;db.worker_bounding=y(f(Nc,ic.k));dc.push(db)}Ta=dc}else Ta=[];B.fa(H,B.GO,J,wa,pa,ia,la,ya,nb,Va,Aa,kb,Ya,hb,jb,ab,vb,K,mb,gb,P,O,Ta,sb);oa[J]=M;xa.push(M);var Hb=k(J,"BOUNDING");Hb.type=ia;Hb.Rh=nb;Hb.pv=la;Hb.$b=La;Hb.eq=hb;q=Hb}var ec=q;a.C=ec;var wb={za:null,C:ec};
n||(w.push(wb),d(b,c,ec.$b))}else for(var Wa=V.ja(a,b).U,Fa=0;Fa<Wa.length;Fa++){var xb=Wa[Fa],Rc;if(Rc="PHYSICS"==xb.type){var Vb;a:{for(var Ac=b.wc.ra,dd=0;dd<Ac.length;dd++){var tc=Ac[dd].za;if(tc&&tc.id==xb.id){Vb=!0;break a}}Vb=!1}Rc=!Vb}if(Rc)if(xb.Jf.Ja)if(xb.rj&&b.s.Ic){var Yb=xb,Wc=b,ed=c,Zb=Wc.s.Ic;B.fa(ed,B.PO,Zb.Uk);if(Yb.n_){var bb={};bb.dst_noise_scale0=Yb.dst_noise_scale0;bb.dst_noise_scale1=Yb.dst_noise_scale1;bb.dst_noise_freq0=Yb.dst_noise_freq0;bb.dst_noise_freq1=Yb.dst_noise_freq1;
bb.dir_min_shore_fac=Yb.dir_min_shore_fac;bb.dir_freq=Yb.dir_freq;bb.dir_noise_scale=Yb.dir_noise_scale;bb.dir_noise_freq=Yb.dir_noise_freq;bb.dir_min_noise_fac=Yb.dir_min_noise_fac;bb.dst_min_fac=Yb.dst_min_fac;bb.waves_hor_fac=Yb.waves_hor_fac;var ud=Zb.waves_height,Fc=Zb.waves_length;Zb.Bk?B.fa(ed,B.FE,bb,Zb.uo[0],Zb.uo[1],Zb.so[0],Zb.so[1],Zb.zB,ud,Fc,Zb.YC,Wc.s.XC):B.fa(ed,B.FE,bb,0,0,0,0,0,ud,Fc,0,null)}}else{var fd;if(xb.ys){var Xc=a,Bc=xb,jc=c,Pb=x(),Ob=Bc.Jf,kc=Ob.Z[0].a_position,Gc=Ob.ma||
null,Ib=Bc.$b,lc=h(Ib);B.fa(jc,B.MO,Pb,kc,Gc,I.F(Xc.k.n),lc,Bc.fq,Bc.dq,Bc.gq);var qb=k(Pb,"STATIC_MESH");qb.pv=!0;qb.$b=Ib;qb.eq=lc;fd=qb}else{var cb=a,$b=xb,Yc=c,Cb=x(),Qb=$b.Jf,eb=Qb.Z[0].a_position,pb=Qb.ma||null,Hc=I.F(cb.k.n),mc=$b.Ml,Ic=$b.Gl,Jb=$b.$b,nc=h(Jb);B.fa(Yc,B.OO,Cb,eb,pb,Hc,mc,Ic,nc,$b.fq,$b.dq,$b.gq);var ac=k(Cb,"STATIC_MESH");ac.$b=Jb;ac.eq=nc;fd=ac}ec=fd;a.C=ec;wb={za:xb,C:ec};w.push(wb);d(b,c,ec.$b)}else U.error("Object "+a.name+" has collision material with no assigned vertices")}if(v(a)||
e(a)){var Za=a,bc=c,Kb=Za.C.ea;v(Za)?(Za.v.type=10,B.fa(bc,B.HO,Kb,Za.v.iD,Za.v.kD,Za.v.jD,Za.v.UD,Za.v.AB)):e(Za)&&(Za.v.type=20,B.fa(bc,B.FO,Kb,Za.v.Jl,Za.v.Nm,Za.v.Om));if(Za.v.tm){var rb=Za.v.tm;switch(Za.v.type){case 10:g(rb[0],Za,Kb,!0,bc);g(rb[1],Za,Kb,!0,bc);g(rb[2],Za,Kb,!1,bc);g(rb[3],Za,Kb,!1,bc);break;case 20:for(var oc=0;oc<rb.length;oc++)g(rb[oc],Za,Kb,!1,bc)}}C(a,a.v,c)}else if(a.dg){var tb=c,Lb=a.k,Rb=a.C,uc=Lb.O.max_z-Lb.O.min_z,Jc=Rb.ea,Ia=a.fG,fc=Ia.m_,Db=Ia.vX,Eb=Ia.JY,Cc=Ia.DV,
Sb=Ia.o_,ib=Y.hT(a);B.fa(tb,B.IO,Jc,ib,uc,fc,Db,Eb,Cc,Sb);Rb.dg=!0}else if(p(a)){var fb=a,Ja=c,Wb=fb.C.ea;B.fa(Ja,B.LO,Wb,fb.Xf.Jl,fb.Xf.Nm,fb.Xf.Om);if(fb.Xf.Ht)for(var Fb=fb.Xf.Ht,Pa=0;Pa<Fb.length;Pa++){var Qa=Fb[Pa],lb=I.F(Qa.k.n),Oc=I.invert(fb.k.n,L),Kc=new Float32Array(3);I.Vc(lb,Oc,Kc);B.fa(Ja,B.EO,Wb,Kc,Qa.SF)}fb.C.sV=!0}for(Fa=0;Fa<xa.length;Fa++)if(a=xa[Fa],a.C){var ub=a;if(!A(ub))for(var Dc=0;Dc<ub.cC.length;Dc++){var Tb=ub.cC[Dc],cc=Tb.target,gd=Tb.JW;if(cc.C){var Zc=new Float32Array([Tb.KW,
Tb.LW,Tb.MW]),Sc,$c=new Float32Array([Tb.Ga,Tb.Ha,Tb.Ia]);Sc=Y.Oj($c,new Float32Array(4));var yb=I.identity(L),yb=I.ff(Zc,yb),yb=I.zk(Sc,yb),zb=I.multiply(ub.k.n,yb,L),vc=I.invert(cc.k.n,ea),hd=I.multiply(vc,zb,vc),Xa=Tb,$a={};$a.use_limit_x=Xa.ZZ;$a.use_limit_y=Xa.$Z;$a.use_limit_z=Xa.a_;$a.use_angular_limit_x=Xa.VZ;$a.use_angular_limit_y=Xa.WZ;$a.use_angular_limit_z=Xa.XZ;$a.limit_max_x=Xa.NV;$a.limit_min_x=Xa.QV;$a.limit_max_y=Xa.OV;$a.limit_min_y=Xa.RV;$a.limit_max_z=Xa.PV;$a.limit_min_z=Xa.SV;
$a.limit_angle_max_x=Xa.HV;$a.limit_angle_min_x=Xa.KV;$a.limit_angle_max_y=Xa.IV;$a.limit_angle_min_y=Xa.LV;$a.limit_angle_max_z=Xa.JV;$a.limit_angle_min_z=Xa.MV;N(gd,ub,Zc,Sc,cc,I.F(hd),I.R(hd),$a,null,null)}}}};a.NT=q;a.update=function(a,b){for(var c=0;c<S.length;c++){var e=S[c],d=a;e&&B.kJ(e)&&B.fa(e,B.sP,d,b);for(var f=0;f<xa.length;f++){var g=xa[f],l=g.C;if(l.Ck&&l.du){var k=B.kJ(e)?d-l.du:performance.now()/1E3-l.du,k=Math.min(k,10/ca.max_fps),k=k-1/ca.max_fps;ja.vW&&(k=0);var h=L;I.lV(l.aA,
k,l.Ph,l.xh,L);Q.fj(g,h);Q.D(g);O(g);if(g.v)for(var l=g,k=l.v.tm,h=l.k.n,p=L,u=0;u<k.length;u++){var n=k[u];I.multiply(h,l.v.Nr[u],p);Q.fj(n,p);Q.D(n)}g.v&&g.v.Fo&&(p=g,k=p.v,l=k.Fo)&&(u=p.v.ZL,I.multiply(p.k.n,p.v.$L,l.k.n),h=ya,I.wd(u,p.k.n,h),p=na,Z.setAxisAngle(h,-k.Do*k.Eo*2*Math.PI,p),k=I.R(l.k.n),Z.multiply(p,k,k),Q.D(l));g.v&&g.v.bD&&(p=g,k=p.v,l=k.bD)&&(u=p.v.UL,I.multiply(p.k.n,p.v.VL,l.k.n),h=ya,I.wd(u,p.k.n,h),p=na,u=Math.abs(k.speed)*k.ms,u>k.Tn&&(u=k.Tn),Z.setAxisAngle(h,-u,p),k=I.R(l.k.n),
Z.multiply(p,k,k),Z.normalize(k,k),Q.D(l));g.v&&g.v.mD&&(h=g,l=h.v,g=l.mD)&&(p=h.v.kM,I.multiply(h.k.n,h.v.lM,g.k.n),k=ya,I.wd(p,h.k.n,k),h=na,Z.setAxisAngle(k,-Math.abs(l.tn)*l.vq,h),l=I.R(g.k.n),Z.multiply(h,l,l),Z.normalize(l,l),Q.D(g))}}B.TW(e);e=fa[c];(d=e.s.Ic)&&0<d.waves_height&&(e=w.La(e,ga.Ob),d=ia.length(e.sj)||1,B.fa(S[c],B.pP,e.time*d))}};a.mU=function(){return fa[0]};a.pause=function(){for(var a=0;a<S.length;a++)B.fa(S[a],B.aP)};a.cj=function(){for(var a=0;a<S.length;a++)B.fa(S[a],B.fP)};
a.oH=function(a){(a=a.C)||Y.q("No object physics");if(!a.Ck){var b=a.ea,c=H(b);a.Ck=!0;B.fa(c,B.ZO,b)}};a.jA=function(a){(a=a.C)||Y.q("No object physics");if(a.Ck){var b=a.ea,c=H(b);a.Ck=!1;B.fa(c,B.YO,b)}};a.qw=function(a){return Boolean(a.wc)};a.na=function(a){return Boolean(a.C)};a.SI=function(a){return(a=a.C)&&a.Ck&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Rh&&0==a.pv?!0:!1};a.VA=function(a){return(a=a.C)&&a.Ck?!0:!1};a.iL=function(a,b){var c=a.C.ea;B.fa(H(c),B.oP,c,b)};a.ZU=A;a.qF=N;a.rG=
function(a){a=a.C;B.fa(H(body_a),B.dP,a.St);a.St=null};a.uK=function(b,c,e,d,f,g){c=I.$h(c,1,e,L);f=I.$h(f,1,g,ea);I.invert(c,c);I.multiply(f,c,c);Q.Xq(d,f);I.multiply(f,c,c);Q.fj(b,c);Q.D(b);a.Dw(b,I.F(b.k.n),I.R(b.k.n))};a.Dw=function(a,b,c){var e=a.C,d=B.kI(B.et),f=I.fc(a.k.n,d.trans);a=I.Wd(a.k.n,d.quat);I.$h(f,1,a,e.aA);d.ea=e.ea;ia.copy(b,d.trans);Z.copy(c,d.quat);B.fa(H(e.ea),B.et)};a.H=O;a.uF=function(a,b,c,e){var d=ya;D(a,b,c,e,d);a=a.C.ea;b=Math.abs(0);c=Math.abs(0);e=Math.abs(0);var f=
Math.abs(d[0]),g=Math.abs(d[1]),l=Math.abs(d[2]);d[0]=f?d[0]/f*Math.max(f,b):0;d[1]=g?d[1]/g*Math.max(g,c):0;d[2]=l?d[2]/l*Math.max(l,e):0;B.fa(H(a),B.HE,a,d[0],d[1],d[2])};a.vF=function(a,b,c,e){a=a.C.ea;B.fa(H(a),B.HE,a,b,c,e)};a.bz=function(a,b,c,e,d){var f=ya;d?(f[0]=b,f[1]=c,f[2]=e):D(a,b,c,e,f);a=a.C.ea;B.fa(H(a),B.QO,a,f[0],f[1],f[2])};a.tF=function(a,b,c,e){var d=ya;D(a,b,c,e,d);a=a.C.ea;B.fa(H(a),B.SO,a,d[0],d[1],d[2])};a.FC=function(a,b,c){a=a.C.ea;B.fa(H(a),B.iP,a,b,c)};a.ww=function(a,
b){var c=a.C.ea;B.fa(H(c),B.jP,c,b)};a.$K=function(a,b){var c=a.C.ea;B.fa(H(c),B.nP,c,b)};a.ZK=function(a,b){var c=a.C.ea;B.fa(H(c),B.lP,c,b)};a.WK=function(a,b){var c=a.C.ea;B.fa(H(c),B.gP,c,b)};a.dG=function(a){a=a.C.ea;B.fa(H(a),B.UO,a)};a.eG=function(a,b,c){a=a.C.ea;B.fa(H(a),B.VO,a,b,c)};a.xw=function(a,b,c){a=a.C.ea;B.fa(H(a),B.kP,a,b,c)};a.XK=function(a,b){var c=a.C.ea;B.fa(H(c),B.hP,c,b)};a.YK=function(a,b){var c=a.C.ea;B.fa(H(c),B.mP,c,b)};a.Zy=function(a,b,c,e){var d=a.C;if(!d.xr){for(var f=
d.ea,g=0;g<d.Oe.length;g++)if(a=d.Oe[g],a.$b==b&&a.callback==c)return;a={iz:f,Ah:e||!1,$b:b,callback:c,nk:[],Dr:[]};d.Oe.push(a);b=H(f);P(a,t(b),b)}};a.rC=function(a,b,c){a=a.C;for(var e=H(a.ea),d=t(e),f=0;f<a.Oe.length;f++){var g=a.Oe[f];if(g.$b==b&&g.callback==c){if(n(g)){var l=ia.set(0,0,0,ya);g.callback(!1,null,l,l,0)}a.Oe.splice(f,1);f--;for(var l=e,g=g.nk,k=d.wc.ra,h=0;h<k.length;h++)for(var p=k[h].C,u=0;u<p.Oe.length;u++)for(var w=p.Oe[u],m=0;m<w.nk.length;m++)for(var v=w.nk[m],I=0;I<g.length;I++){var C=
g[I];v[0]==C[0]&&v[1]==C[1]&&(g.splice(I,1),I--)}g.length&&B.fa(l,B.GE,g)}}};a.az=function(a,b){a.C&&a.C.ul&&M(a);var c=a.C;B.fa(H(c.ea),B.RO,c.ea);c.ul=b};a.zz=M;a.wt=function(a,b,c,e,d,f,g,l,k){var p;X.BK++;p=X.BK;a={id:p,ea:a?a.C.ea:0,from:new Float32Array(b),to:new Float32Array(c),$b:e,eq:h(e),BF:f,RQ:g,Ah:l,gv:k,callback:d};b=H(a.ea)||S[0];c=t(b).wc;p=a.id;c.pk[p]=a;c.nC.push(a);B.fa(b,B.NO,a.id,a.ea,a.from,a.to,a.eq,a.BF,a.RQ,a.Ah,a.gv);return p};a.sC=F;a.bG=function(a,b,e){var d=l(a),f=c(a).wc.pk[a];
f&&!f.BF&&(f.from.set(b),f.to.set(e),B.fa(d,B.TO,a,b,e))};a.lJ=function(a){return c(a).wc.pk[a]?!0:!1};a.Uo=function(a,b){var c=a.v;c.tn=b;C(a,c,H(a.C.ea))};a.To=function(a,b){var c=a.v;c.Do=b;C(a,c,H(a.C.ea))};a.MD=function(a,b){var c=a.v;c.Qp=b;C(a,c,H(a.C.ea))};a.Ye=v;a.Ze=e;a.O5=R;a.pV=function(a){if(!a.Xe)return!1;a=a.kf.cf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.oV=function(a){return a.Xe?"BOB"==a.kf.cf?!0:!1:!1};a.tV=function(a){return a.am?
"BOB"==a.wn.cf?!0:!1:!1};a.nJ=function(a){return a.Xe&&"STEERING_WHEEL"==a.kf.cf?!0:!1};a.mJ=function(a){return a.Xe&&"SPEEDOMETER"==a.kf.cf?!0:!1};a.oJ=function(a){return a.Xe&&"TACHOMETER"==a.kf.cf?!0:!1};a.GI=function(a){return a.v.speed};a.q_=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.dg=function(a){return a.dg};a.I5=p;a.EU=function(){return pa};a.aT=function(){for(var a=0;a<S.length;a++)B.fa(S[a],
B.XO)};a.Ur=function(a){if("BOUNDING"==a.C.type){var b=xa.indexOf(a);-1==b&&U.error("Object "+a.name+" doesn't have bounding physics");delete oa[c];xa.splice(b,1)}for(var c=a.C.ea,b=H(c),e=t(b),d=c,f=e.wc.ra,g=[],l=0;l<f.length;l++)for(var k=f[l].C,h=0;h<k.Oe.length;h++)for(var p=k.Oe[h],u=0;u<p.nk.length;u++){var w=p.nk[u],m=p.Dr[u];if(w[0]==d||w[1]==d)p.nk.splice(u,1),p.Dr.splice(u,1),u--,m&&!n(p)&&(m=ia.set(0,0,0,ya),p.callback(!1,null,m,m,0)),g.push(w)}g.length&&B.fa(b,B.GE,g);a.C&&a.C.ul&&M(a);
a=e.wc.ra;for(e=0;e<a.length;e++)a[e].C.ea==c&&(a.splice(e,1),e--);B.fa(b,B.cP,c)}};b4w.module.__ipc=function(a,r){function m(a,b,c){for(var d=0;d<y.length;d+=2)y[d+1]==a&&(f[d+Number(!b)]=c)}function d(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var g=c[f];switch(g.constructor){case Float32Array:d+=g.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.PN=0;var t=a.HN=1,q=a.JN=2;a.IN=3;a.LN=4;a.MN=5;a.NN=6;a.QN=7;var z=a.SN=8,n=a.iE=9,x=a.TN=10;a.UN=11;var h=a.VN=12;a.WN=13;a.RN=14;a.ON=15;a.KN=16;a.$O=100;a.BO=101;a.CO=102;a.DO=103;a.EO=104;a.GO=105;a.FO=106;
a.HO=107;a.IO=108;a.JO=109;a.KO=110;a.LO=111;a.MO=112;a.OO=113;a.PO=114;a.cP=115;a.QO=116;a.RO=117;a.SO=118;a.UO=119;a.VO=120;a.WO=121;a.YO=122;a.ZO=123;a.aP=124;a.NO=125;a.eP=126;a.TO=127;a.GE=128;a.dP=129;a.fP=130;a.gP=131;a.hP=132;a.iP=133;a.jP=134;a.kP=135;a.lP=136;a.mP=137;a.nP=138;a.oP=139;a.HE=140;var k=a.et=141;a.pP=142;a.FE=143;a.qP=144;a.rP=145;a.bP=146;a.XO=147;a.sP=148;var f=b4w.worker_listeners,y=b4w.worker_namespaces,g={Ff:h,ea:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Ph:new Float32Array(3),xh:new Float32Array(3),len:0},A={Ff:z,vz:0,iC:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},N={Ff:n,id:0,gn:0,hit_fract:0,hit_time:0,len:0},H={Ff:x,id:0,gn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},O={Ff:t,nl:0,ol:0,result:0,len:0},D={Ff:q,nl:0,ol:0,result:0,vl:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},P={Ff:k,ea:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},K=[g,A,N,H,O,D,
P];a.SS=function(a,d){var c={rv:a?!0:!1,Vk:null,zh:[],Wf:""};if(d)if(c.Vk={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");m(c.Wf,c.rv,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");m(c.Wf,c.rv,null)},postMessage:function(a){var b;a:{for(b=0;b<y.length;b+=2)if(y[b+1]==c.Wf){b=f[b+Number(!!c.rv)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<y.length;a+=2)if(y[a+1]==c.Wf){f.splice(a,2);y.splice(a,2);break}}},c.rv){var g=
r("__util"),k=r("__container"),h=b4w.get_namespace(r),g=g.qs(h+"_worker");y.push(h);y.push(g);f.push(null);f.push(null);c.Wf=g;(k=k.PT(a))?b?k.addEventListener("load",function(){b4w.require("__bindings",c.Wf)},!1):(b4w.sa("__bindings",c.Wf),b4w.sa("__ipc",c.Wf),b4w.require("__bindings",c.Wf)):(k=document.createElement("script"),k.src=a,k.defer="defer",k.async="async",k.addEventListener("load",function(){b=!1;b4w.require("__bindings",c.Wf)},!1),document.head.appendChild(k))}else c.Wf=b4w.get_namespace(r);
else c.Vk=a?new Worker(a):self;return c};a.xQ=function(a,b){function c(d){if(d.constructor==ArrayBuffer)d=new Float32Array(d);else if(d[0].constructor==ArrayBuffer){for(var f=0;f<d.length;f++)c(d[f]);return}f=d[0]|0;switch(f){case h:var m=g;m.ea=d[1]|0;m.time=d[2];m.trans[0]=d[3];m.trans[1]=d[4];m.trans[2]=d[5];m.quat[0]=d[6];m.quat[1]=d[7];m.quat[2]=d[8];m.quat[3]=d[9];m.Ph[0]=d[10];m.Ph[1]=d[11];m.Ph[2]=d[12];m.xh[0]=d[13];m.xh[1]=d[14];m.xh[2]=d[15];break;case z:m=A;m.vz=d[1]|0;m.iC=d[2]|0;m.trans[0]=
d[3];m.trans[1]=d[4];m.trans[2]=d[5];m.quat[0]=d[6];m.quat[1]=d[7];m.quat[2]=d[8];m.quat[3]=d[9];break;case n:m=N;m.id=d[1]|0;m.gn=d[2]|0;m.hit_fract=d[3];m.hit_time=d[4];break;case x:m=H;m.id=d[1]|0;m.gn=d[2]|0;m.hit_fract=d[3];m.hit_time=d[4];m.hit_pos[0]=d[5];m.hit_pos[1]=d[6];m.hit_pos[2]=d[7];m.hit_norm[0]=d[8];m.hit_norm[1]=d[9];m.hit_norm[2]=d[10];break;case t:m=O;m.nl=d[1]|0;m.ol=d[2]|0;m.result=!!d[3];break;case q:m=D;m.nl=d[1]|0;m.ol=d[2]|0;m.result=!!d[3];m.vl[0]=d[4];m.vl[1]=d[5];m.vl[2]=
d[6];m.coll_norm[0]=d[7];m.coll_norm[1]=d[8];m.coll_norm[2]=d[9];m.coll_dist=d[10];break;case k:m=P;m.ea=d[1]|0;m.trans[0]=d[2];m.trans[1]=d[3];m.trans[2]=d[4];m.quat[0]=d[5];m.quat[1]=d[6];m.quat[2]=d[7];m.quat[3]=d[8];break;default:m=d}b(a,f,m)}d(K);a.Vk.addEventListener("message",function(a){c(a.data)},!1)};a.sa=function(){};a.fa=function(a,b){if(a)switch(b){case h:var c=g,d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.ea;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=
c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Ph[0];d[11]=c.Ph[1];d[12]=c.Ph[2];d[13]=c.xh[0];d[14]=c.xh[1];d[15]=c.xh[2];a.zh.push(d.buffer);break;case z:c=A;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.vz;d[2]=c.iC;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.zh.push(d.buffer);break;case n:c=N;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.id;d[2]=c.gn;d[3]=c.hit_fract;d[4]=c.hit_time;a.zh.push(d.buffer);break;case x:c=H;d=new Float32Array(c.len);
d[0]=c.Ff;d[1]=c.id;d[2]=c.gn;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.zh.push(d.buffer);break;case t:c=O;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.nl;d[2]=c.ol;d[3]=c.result;a.zh.push(d.buffer);break;case q:c=D;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.nl;d[2]=c.ol;d[3]=c.result;d[4]=c.vl[0];d[5]=c.vl[1];d[6]=c.vl[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.zh.push(d.buffer);break;case k:c=P;d=new Float32Array(c.len);d[0]=c.Ff;d[1]=c.ea;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.zh.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.Vk.postMessage(d)}};a.TW=function(a){a&&a.zh.length&&(a.Vk.postMessage(a.zh),a.zh.length=0)};a.kI=function(a){switch(a){case h:return g;case z:return A;case n:return N;case x:return H;case t:return O;case q:return D;case k:return P;
default:return null}};a.terminate=function(a){a.Vk.terminate();a.Vk=null};a.mv=function(a){return!!a.Vk};a.kJ=function(a){return!!a.Wf}};b4w.module.__transform=function(a,r){function m(a,b){f.bg(a)?O.ff(b,f.$f(a)):O.ff(b,a.k.n)}function d(a,b){var d=a.k;if(f.bg(a)){O.zk(b,d.n);var g=f.Eu(a),g=O.invert(g,c);O.multiply(g,d.n,f.$f(a))}else O.zk(b,d.n)}function b(a,b){f.bg(a)?O.zk(b,f.$f(a)):O.zk(b,a.k.n)}function t(a,b){O.Wd(a.k.n,b);return b}function q(a,b){f.bg(a)?O.Wd(f.$f(a),b):O.Wd(a.k.n,b);return b}function z(a,b){f.bg(a)?O.copy(b,f.$f(a)):O.copy(b,a.k.n)}function n(a,b){f.bg(a)?O.copy(f.$f(a),b):O.copy(a.k.n,b);return b}function x(a){var b=
a.k,d=a.I,l=a.type;"CAMERA"==l&&k.GD(a);f.yZ(a,C);"CAMERA"==l&&k.wZ(a);var n=O.fc(b.n,K),m=O.Wd(b.n,F);h.ql(b.O,b.n,b.Ta);h.Pp(b.wa,b.n,b.kb);if(b.Ro)for(var q=0;q<d.length;q++)for(var t=d[q].U,r=0;r<t.length;r++){var w=t[r];h.ql(w.O,b.n,w.Ta);h.Pp(w.wa,b.n,w.kb);w.Nf&&h.Op(w.aa,b.n,w.pb)}else b.Nf&&h.Op(b.aa,b.n,b.pb);switch(l){case "MESH":a.RJ&&O.invert(a.k.n,a.k.xx);if(t=a.zt)O.invert(t.k.n,c),O.multiply(c,b.n,c),O.TU(c,b.Dp),O.Wd(c,b.Cp);b.Mq=!0;break;case "CAMERA":for(q=0;q<d.length;q++)k.xZ(a,
d[q]);break;case "SPEAKER":H.AY(a,C,v);break;case "LAMP":y.BZ(a)}for(q=0;q<d.length;q++)if(r=d[q],r.mv){t=r.xb;w=t.s;switch(l){case "MESH":b.Ce&&N.EC(t);w=r.Bi;null!=b.Qd&&w&&N.IM(w,n);break;case "EMPTY":g.zZ(a);break;case "CAMERA":N.xX(t);if(w.ud){w.ud.enable_csm&&N.EC(t);var ga=A.ja(a,t).ba[0];N.MZ(ga,w.Wa)}N.B()==t&&N.Sl(t)==a&&H.UV(t,n,m,C,v);break;case "LAMP":N.LM(a,t)}w=r.Uh;ga=a.Tr;if(ga.length)for(r=0;r<w.length;r++){var Q=w[r].p;N.MM(w[r],n,m);A.NM(ga,Q.lc);k.hY(Q,N.Sl(t));D.un(Q.ld,Q.Ih)}}b=
a.Pe;for(q=0;q<b.length;q++)x(b[q]);a=a.Gz;for(q=0;q<a.length;q++)b=a[q],t=b[0],f.qZ(t,b[1])}var h=r("__boundings"),k=r("__camera"),f=r("__constraints"),y=r("__lights"),g=r("__objects"),A=r("__obj_util"),N=r("__scenes"),H=r("__sfx"),O=r("__tsr"),D=r("__util"),P=r("__vec3"),K=new Float32Array(3),M=new Float32Array(3),F=new Float32Array(4);new Float32Array(9);var c=O.create(),l=O.create(),C=0,v=0;a.QE=0;a.$m=1;a.update=function(a){C=a;v++};a.Uc=function(a,b){var d=a.k;if(f.bg(a)){O.ff(b,d.n);var g=
f.Eu(a),g=O.invert(g,c);O.multiply(g,d.n,f.$f(a))}else O.ff(b,d.n)};a.Ew=m;a.Bf=function(a,b){O.fc(a.k.n,b);return b};a.EI=function(a,b){f.bg(a)?O.fc(f.$f(a),b):O.fc(a.k.n,b);return b};a.Zh=d;a.Cw=b;a.En=t;a.tI=q;a.QC=function(a,b){var c=D.Oj(b,F);d(a,c)};a.RC=function(a,c){var d=D.Oj(c,F);b(a,d)};a.rI=function(a,b){t(a,F);return b=D.lw(euler,b)};a.sI=function(a,b){q(a,F);return b=D.lw(euler,b)};a.Hf=function(a,b){var c=a.k;if(f.bg(a)){var c=f.$f(a),d=O.Xd(f.Eu(a));O.Hf(b/d,c)}else O.Hf(b,c.n)};a.SC=
function(a,b){var c=a.k;f.bg(a)?O.Hf(b,f.$f(a)):O.Hf(b,c.n)};a.Xd=function(a){return O.Xd(a.k.n)};a.vI=function(a){return f.bg(a)?O.Xd(f.$f(a)):O.Xd(a.k.n)};a.fj=function(a,b){O.copy(b,a.k.n);if(f.bg(a)){var d=f.Eu(a),d=O.invert(d,c);O.multiply(d,a.k.n,f.$f(a))}};a.Fw=z;a.Xq=function(a,b){return O.copy(a.k.n,b)};a.Yq=n;a.Ju=function(a){var b=a.k;a=b.ll;var c=O.Xd(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.Iu=function(a,b,c){b?(a=a.k,P.copy(a.kb.G,
c)):(a=a.k,b=a.ll,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,O.Vc(c,a.n,c));return c};a.$g=function(a,b,d,f){var g=n(a,c),l=K;l[0]=b;l[1]=d;l[2]=f;O.Vc(l,g,l);m(a,l)};a.BC=function(a,b){var d=n(a,c),f=O.zk(b,O.identity(l));O.multiply(d,f,f);z(a,f)};a.D=x;a.distance=function(a,b){var c=O.fc(a.k.n,K),d=O.fc(b.k.n,M);return P.dist(c,d)};a.Zn=function(a,b){var c=O.fc(a.k.n,K);return P.dist(c,b)};a.nI=function(a){return{max_x:a.k.Ta.max_x,min_x:a.k.Ta.min_x,max_y:a.k.Ta.max_y,
min_y:a.k.Ta.min_y,max_z:a.k.Ta.max_z,min_z:a.k.Ta.min_z}}};b4w.module.__sfx=function(a,r){function m(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return D.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function d(a,c,d){var e=a.W;if("NONE"!=e.behavior){var f=e.loop,g=e.pitch;if(e.src&&(f||0<=d)){e.dz=Math.floor(5E4*Math.random());var l=J.currentTime+c,l=
Math.max(0,l);e.gf=l;e.state=20;var k=B.Nc;"POSITIONAL"==e.behavior&&"none"==k.zq&&(e.behavior="BACKGROUND_SOUND");b(a,B.Nc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){c=J.createBufferSource();c.buffer=e.src;c.playbackRate.value=g;if(f){e.bc&&e.bc.disconnect();e.Jd&&e.Jd.disconnect();c.loop=!0;c.loopStart=e.DJ;if(c.loopEnd=e.Cv)d=J.createBufferSource(),d.buffer=e.src,d.playbackRate.value=g,e.Jd=d,d.connect(e.Ed);c.start(l);e.duration=0}else f=c.buffer?c.buffer.duration:0,d>f?(f=
l+d+e.zf,c.loop=!0,c.start(l),c.stop(f),e.duration=d):(c.loop=!1,c.start(l),e.duration=f);c.connect(e.Ed);e.bc=c;q(e);z(e);n(e)}else"BACKGROUND_MUSIC"==e.behavior&&(K.Ot(e.ez),K.Ot(e.fz),d=function(){var b=a.W,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.bc=b.bc||J.createMediaElementSource(c),b.bc.connect(b.Ed),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():e.ez=K.wL(d,1E3*c),e.duration=f?0:H(a));x(e,l)}}}function b(a,b){var e=a.W;if(!e.Ed){var d=M.F(a.k.n),f=M.R(a.k.n);if(C.Kv){var g=
J.createBiquadFilter();g.type="peaking"}else g=null;var l=J.createGain();switch(e.behavior){case "POSITIONAL":var k=J.createPanner();"string"!=typeof k.panningModel?(k.panningModel=k.EQUALPOWER,k.distanceModel=k.INVERSE_DISTANCE):(k.panningModel="equalpower",k.distanceModel=b.zq);k.setPosition(d[0],d[1],d[2]);c.copy(d,e.lB);d=v;F.kc(f,F.Zc,d);k.setOrientation(d[0],d[1],d[2]);k.refDistance=e.yq;k.maxDistance=e.Mg;k.rolloffFactor=e.Fp;k.coneInnerAngle=e.xG;k.coneOuterAngle=e.yG;k.coneOuterGain=e.zG;
var h=J.createGain();h.gain.value=N(e);g?(k.connect(g),g.connect(h)):k.connect(h);h.connect(l);e.Ed=k;if(e.Mm){var p=J.createGain();l.connect(p);p.connect(b.Ed)}else p=null,l.connect(b.Ed);break;case "BACKGROUND_SOUND":k=null;h=J.createGain();h.gain.value=N(e);g?(e.Ed=g,g.connect(h)):e.Ed=h;h.connect(l);e.Mm?(p=J.createGain(),l.connect(p),p.connect(b.Ed)):(p=null,l.connect(b.Ed));break;case "BACKGROUND_MUSIC":p=k=null,h=J.createGain(),h.gain.value=N(e),g?(e.Ed=g,g.connect(h)):e.Ed=h,h.connect(l),
l.connect(b.Ed)}e.YB=k;e.Qg=g;e.An=h;e.Pj=l;e.mC=p}}function t(a){var b=a.W,c=b.duration,b=b.hH+b.iH*Math.random();d(a,b,c)}function q(a){var b=a.Jd||a.bc;F.Oh(b.onended)&&(b.onended=function(){a.state=50})}function z(a){a.Mm&&a.mC.gain.cancelScheduledValues(a.gf);a.co&&(a.bc.playbackRate.cancelScheduledValues(a.gf),a.Jd&&a.Jd.playbackRate.cancelScheduledValues(a.gf));a.Es=a.gf}function n(a){if(a.Mm||a.co){var b=a.mC,c=a.bc,e=c.buffer?c.buffer.duration:0;if(e){var d=a.gf;U[0]=a.dz;for(var f=0;5>f;){var g=
a.pitch+a.co*F.og(U);if(d>=a.Es){if(a.Mm){var l=1-F.V(a.Mm,0,1)*Math.random();b.gain.setValueAtTime(l,d)}a.co&&(c.playbackRate.setValueAtTime(g,d),a.Jd&&a.Jd.playbackRate.setValueAtTime(g,d));f++}d+=e/g}a.Es=d-.001}}}function x(a,b){if(a.Il||a.zf){var c=a.Pj;c.gain.cancelScheduledValues(b);a.Il?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Il)):c.gain.setValueAtTime(1,b);a.zf&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.zf))}}
function h(a){"SPEAKER"!=a.type&&F.q("Wrong object type");var b=a.W;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Pj,e=J.currentTime;b.zf&&(c.gain.setValueAtTime(c.gain.value,e),c.gain.linearRampToValueAtTime(0,e+b.zf));"BACKGROUND_MUSIC"==b.behavior?b.src&&(K.Ot(b.ez),K.Ot(b.fz),b.fz=K.wL(function(){var b=a.W.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.zf)):(c=b.bc,b.duration<c.buffer.duration?b.zf&&20==b.state?c.stop(e+b.zf):20==b.state&&(c.stop(0),c.disconnect()):
c.disconnect(),b.gf=0,b.ZB=0,b.oz=0);b.state=30}}function k(a){a=a.W;if(20==a.state){var b=J.currentTime;a.ZB=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.oz=b>a.gf?f(a,b):0,a.bc.onended=function(){},a.bc.stop(0),a.bc.disconnect(),z(a));a.state=40}}function f(a,b){U[0]=a.dz;for(var c=a.bc.buffer.duration,e=a.gf,d;e<b;)d=a.pitch+a.co*F.og(U),e+=c/d;return(c/d-(e-b))*d}function y(a){var b=a.W;if(40==b.state){var c=J.currentTime;b.gf+=c-b.ZB;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();
else{a=a.W;var e=J.createBufferSource();e.loop=a.bc.loop;e.loopStart=a.bc.loopStart;e.loopEnd=a.bc.loopEnd;e.buffer=a.bc.buffer;e.playbackRate.value=a.bc.playbackRate.value;e.connect(a.Ed);a.bc=e;a.Jd&&(e=J.createBufferSource(),e.loop=a.Jd.loop,e.buffer=a.Jd.buffer,e.playbackRate.value=a.Jd.playbackRate.value,e.connect(a.Ed),a.Jd=e);b.Es=c;c=b.bc;q(b);c.start(b.gf,b.oz);n(b)}x(b,b.gf);b.state=20}}function g(a,b,e){var d=1,d=b.kT;if(0<d){var f=b.BY;if(0!=c.dot(a.lx,a.lx)||0!=c.dot(b.gm,b.gm)){var g=
c.subtract(a.lB,b.Qh,v),l=c.length(g);b=c.dot(g,b.gm)/l;g=c.dot(g,a.lx)/l;g=-g;l=f/d;b=Math.min(-b,l);g=Math.min(g,l);d=(f-d*b)/(f-d*g);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=F.vc(d,a.wJ,e,.3);a.bc.playbackRate.value=d;a.wJ=d}}}function A(a){a=a.W;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function N(a){return a.muted?0:a.volume}function H(a){a=a.W;return(a=a.src)?a.duration:0}var O=r("__config"),D=r("__print"),P=r("__quat"),K=r("__time"),M=r("__tsr"),F=r("__util"),
c=r("__vec3"),l=O.A,C=O.W,v=new Float32Array(3),e=new Float32Array(3);new Float32Array(3);var R=P.create(),p=[],ba=[],J=null,B=null,V=[],U=[1],Z=null;a.aE=10;a.zx=20;a.$D=30;a.nS=function(){return{pj:-1,Pg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,Fp:1,yq:1,Mg:1E4,xG:360,yG:360,zG:1,autoplay:!1,ve:!1,loop:!1,DJ:0,Cv:0,hH:0,iH:0,Mm:0,co:0,Il:0,zf:0,gf:0,ZB:0,oz:0,duration:0,Es:0,dz:1,src:null,state:10,lB:new Float32Array(3),lx:new Float32Array(3),qu:!1,wJ:1,ez:-1,fz:-1,Fl:0,Ed:null,bc:null,Jd:null,
YB:null,Qg:null,An:null,Pj:null,mC:null,Lk:0}};a.Tg=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(p.push("ogg"),p.push("ogv"),p.push("oga")),""!=a.canPlayType("audio/mpeg")&&p.push("mp3"),""!=a.canPlayType("audio/mp4")&&(p.push("mp4"),p.push("m4v"),p.push("m4a")),""!=a.canPlayType("audio/webm")&&p.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(ba.push("ogv"),ba.push("ogg"),ba.push("oga")),""!=b.canPlayType("video/mp4")&&
(ba.push("m4v"),ba.push("mp4")),""!=b.canPlayType("video/webm")&&ba.push("webm"),""!=b.canPlayType("video/mpeg")&&ba.push("mp3"))};a.yQ=function(a){C.SD&&!J&&(J=m())&&D.log("%cINIT WEBAUDIO: "+J.sampleRate+"Hz","color: #00a");if(J){var b={Qh:new Float32Array(3),gm:new Float32Array(3),Lk:0},c=J.createGain(),e=J.createGain();b.An=c;b.Pj=e;c.connect(e);e.connect(J.destination);if(a.b4w_enable_dynamic_compressor){var e=J.createDynamicsCompressor(),d=a.b4w_dynamic_compressor_settings;e.threshold.value=
d.threshold;e.knee.value=d.knee;e.ratio.value=d.ratio;e.attack.value=d.attack;e.release.value=d.release;e.connect(c);b.lq=e;b.Ed=e}else b.lq=null,b.Ed=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.zq="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.zq="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.zq="exponential";break;case "NONE":b.zq="none";break;default:F.q("Wrong audio distance model")}b.kT=a.audio_doppler_factor;b.BY=a.audio_doppler_speed;b.muted=!1;
b.volume=a.audio_volume;c.gain.value=N(b);b.Fl=0}else b=null;a.Nc=b};a.BX=function(a){B=a};a.eT=function(a){a||(a="ogg");return-1<p.indexOf(a)?a:-1<p.indexOf("m4a")?"m4a":-1<p.indexOf("oga")?"oga":""};a.gT=function(a){a||(a="webm");return-1<ba.indexOf(a)?a:-1<ba.indexOf("m4v")?"m4v":-1<ba.indexOf("webm")?"webm":""};a.Mk=function(a,b){var c=a.data,e=b.W;e.pj=a.data.sound.uuid;e.Pg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":e.behavior=J?c.b4w_behavior:"NONE";
break;case "BACKGROUND_MUSIC":var d;J?(window.MediaElementAudioSourceNode?d=!0:(D.warn("MediaElementAudioSourceNode not found"),d=!1),d=d&&!l.nG?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):d="NONE";e.behavior=d;break;default:F.q("Wrong speaker behavior")}c.sound||(e.behavior="NONE");e.qu=c.b4w_enable_doppler;e.muted=c.muted;e.volume=c.volume;e.pitch=c.pitch;e.Fp=c.attenuation;e.yq=c.distance_reference;e.Mg=c.distance_max||1E4;e.xG=c.cone_angle_inner;e.yG=c.cone_angle_outer;e.zG=c.cone_volume_outer;e.autoplay=
c.b4w_auto_play;e.ve=c.b4w_cyclic_play;e.loop=c.b4w_loop;e.DJ=c.b4w_loop_start;e.Cv=c.b4w_loop_end;e.hH=c.b4w_delay;e.iH=c.b4w_delay_random;e.Mm=c.b4w_volume_random;e.co=c.b4w_pitch_random;e.Il=c.b4w_fade_in;e.zf=c.b4w_fade_out;V.push(b)};a.TL=function(b){"SPEAKER"!=b.type&&F.q("Wrong object type");switch(b.W.behavior){case "POSITIONAL":return a.zx;case "BACKGROUND_SOUND":return a.zx;case "BACKGROUND_MUSIC":return a.$D;case "NONE":return a.aE;default:F.q("Wrong speaker behavior")}};a.PZ=function(a,
b){var c=a.W;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:F.q("Wrong speaker behavior")}};a.lK=function(){var a=J.createBufferSource();a.buffer=J.createBuffer(1,22050,22050);a.connect(J.destination);a.start(0)};a.bT=function(a,b,c){J?J.decodeAudioData(a,b,c):c()};a.zY=function(a){h(a);a.W=null;V.splice(V.indexOf(a),1)};a.sa=function(){for(var a=0;a<V.length;a++){var b=V[a].W;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():
(b.bc&&b.bc.disconnect(),b.Jd&&b.Jd.disconnect())}B&&B.Nc&&(a=B.Nc,a.Qh[0]=0,a.Qh[1]=0,a.Qh[2]=0,a.gm[0]=0,a.gm[1]=0,a.gm[2]=0);B=null;V.splice(0);Z=null};a.update=function(a){if(J&&0!=V.length){for(var b=0;b<V.length;b++){var c=V[b],e=c.W,d=e.bc,f=J.currentTime;!e.loop&&20==e.state&&e.duration&&e.gf+e.duration<f&&("BACKGROUND_MUSIC"==e.behavior||d&&!F.Oh(d.onended))&&(e.state=50);e.ve&&50==e.state&&t(c);20==e.state&&3>e.Es-f&&n(e)}Z&&Z.hj.length&&(-1==Z.Dc||a>Z.kF+Z.nH[Z.Dc])&&(b=Z,-1<b.Dc&&h(b.hj[b.Dc]),
-1==b.Dc&&b.random?c=Math.round(Math.random()*(b.hj.length-1)):b.random?(c=1+Math.round(Math.random()*(b.hj.length-2)),c=(b.Dc+c)%b.hj.length):c=(b.Dc+1)%b.hj.length,t(b.hj[c]),b.Dc=c,b.kF=a)}};a.play=d;a.kK=t;a.stop=h;a.yV=function(a){return 20==a.W.state};a.W7=k;a.X7=y;a.a6=function(a,b){var c=a.W,e=c.Jd;if(A(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&e){var d=J.currentTime+b;c.bc.stop(d);e.start(d,c.Cv)}};a.QW=function(a,b){var c=a.W;c.pitch=b;!A(a)||"POSITIONAL"!=c.behavior&&
"BACKGROUND_SOUND"!=c.behavior||(c.bc.playbackRate.value=b,c.Jd&&(c.Jd.playbackRate.value=b),z(c),n(c))};a.x4=function(a){return a.W.pitch};a.ve=function(a,b){a.W.ve=Boolean(b)};a.nV=function(a){return a.W.autoplay};a.qV=function(a){return a.W.ve};a.UV=function(a,b,d,f,l){if(a=a.Nc){var k=v;k[0]=0;k[1]=0;k[2]=-1;c.transformQuat(k,d,k);e[0]=0;e[1]=1;e[2]=0;c.transformQuat(e,d,e);d=J.listener;d.setPosition(b[0],b[1],b[2]);d.setOrientation(k[0],k[1],k[2],e[0],e[1],e[2]);if(f&&a.Lk!=l){if(a.sB)a.sB=!1,
c.copy(b,a.Qh);else for(d=a.gm,d[0]=(b[0]-a.Qh[0])/f,d[1]=(b[1]-a.Qh[1])/f,d[2]=(b[2]-a.Qh[2])/f,c.copy(b,a.Qh),b=0;b<V.length;b++)d=V[b],k=d.W,A(d)&&"POSITIONAL"==k.behavior&&k.qu&&g(k,a,f);a.Lk=l}else c.copy(b,a.Qh)}};a.sB=function(){var a=B.Nc;a&&(a.sB=!0)};a.AY=function(a,b,d){var f=a.W;if(A(a)&&"POSITIONAL"==f.behavior){var l=M.fc(a.k.n,v);a=M.Wd(a.k.n,R);var k=f.YB;k.setPosition(l[0],l[1],l[2]);F.kc(a,F.Zc,e);k.setOrientation(e[0],e[1],e[2]);f.qu&&(a=f.lB,b&&f.Lk!=d?(f.Dm?(c.copy(l,a),f.Dm=
!1):(k=f.lx,k[0]=(l[0]-a[0])/b,k[1]=(l[1]-a[1])/b,k[2]=(l[2]-a[2])/b,c.copy(l,a),g(f,B.Nc,b)),f.Lk=d):c.copy(l,a))}};a.Y7=function(a){var b=a.W;A(a)&&"POSITIONAL"==b.behavior&&b.qu&&(b.Dm=!0)};a.OA=function(a){return a.W.behavior};a.P1=function(){for(var a=0;a<V.length;a++)if(A(V[a]))return!0;return!1};a.o7=function(a){var b=B.Nc;b&&(b.volume=a,J&&(b.An.gain.value=N(b)))};a.e4=function(){var a=B.Nc;return a?a.volume:0};a.iY=function(a,b){var c=a.W;c.volume=b;A(a)&&(c.An.gain.value=N(c))};a.a5=function(a){return a.W.volume};
a.jc=function(a,b){a.W.muted=Boolean(b);A(a)&&(a.W.An.gain.value=N(a.W))};a.N5=function(a){return a.W.muted};a.f6=function(a){var b=B.Nc;b&&(b.muted=Boolean(a),J&&(b.An.gain.value=N(b)))};a.M5=function(){var a=B.Nc;return a?a.muted:!1};a.QU=function(){return V};a.pause=function(){for(var a=0;a<V.length;a++)k(V[a])};a.cj=function(){for(var a=0;a<V.length;a++)y(V[a])};a.a7=function(a,b){if(a.Nc&&a.Nc.lq){var c=a.Nc.lq;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=
b.attack;c.release.value=b.release}};a.G3=function(a){if(!a.Nc||!a.Nc.lq)return null;a=a.Nc.lq;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.N2=function(a,b,c){if(A(a)){a=a.W;var e=a.Pj,d=J.currentTime;e.gain.setValueAtTime(e.gain.value,d);e.gain.linearRampToValueAtTime(b,d+c);a.Fl=c}};a.C8=function(a){if(A(a)){a=a.W;var b=a.Pj,c=J.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Fl);
a.Fl=0}};a.O2=function(a,b){if(J){var c=B.Nc,e=c.Pj,d=J.currentTime;e.gain.setValueAtTime(e.gain.value,d);e.gain.linearRampToValueAtTime(a,d+b);c.Fl=b}};a.D8=function(){if(J){var a=B.Nc,b=a.Pj,c=J.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Fl);a.Fl=0}};a.x1=function(a,b,c){Z={Dc:-1,kF:0,random:c,hj:[],nH:[]};for(c=0;c<a.length;c++){var e=a[c],d=H(e);0==d?D.warn("Ignoring speaker with zero duration: "+e.name):(h(e),e.W.ve=!1,Z.hj.push(e),Z.nH.push(d+b))}};
a.L3=H;a.k2=function(){if(Z)for(var a=Z.hj,b=0;b<a.length;b++)h(a[b]);Z=null};a.A4=function(a){return(a=a.W)&&"POSITIONAL"==a.behavior?{dist_ref:a.yq,dist_max:a.Mg,attenuation:a.Fp}:null};a.z7=function(a,b){var c=a.W;if(c&&"POSITIONAL"==c.behavior){c.yq=b.dist_ref;c.Mg=b.dist_max;c.Fp=b.attenuation;var e=c.YB;e&&(e.refDistance=c.yq,e.maxDistance=c.Mg,e.rolloffFactor=c.Fp)}};a.f7=function(a,b){var c=a.W;c&&c.Qg&&(c.Qg.frequency.value=b.freq,c.Qg.Q.value=b.Q,c.Qg.gain.value=b.gain)};a.S3=function(a){return(a=
a.W)&&a.Qg?{freq:a.Qg.frequency.value,Q:a.Qg.Q.value,gain:a.Qg.gain.value}:null};a.Q3=function(a,b,c,e){a=a.W;if(!a||!a.Qg)return null;a.Qg.getFrequencyResponse(b,c,e)};a.reset=function(){p.length=0;ba.length=0;J=null}};b4w.module.__time=function(a,r){function m(){return-1!==d.il.xu?d.il.xu:h}var d=r("__config");r("__print");var b=0,t=0,q=[],z=0,n=0,x=[],h=-1;a.vL=function(a){b=a;t=performance.now();for(a=0;a<q.length;a++){var d=q[a];b>d.pA&&(q.splice(a,1),a--,d.callback())}for(a=0;a<x.length;a++){var d=x[a],h=1-(d.pA-b)/d.duration,h=Math.min(h,1);d.callback(d.from+h*(d.to-d.from));1==h&&(x.splice(a,1),a--)}};a.Wq=function(){return b};a.wL=function(a,d){var h;z++;h=z;q.push({id:h,callback:a,pA:b+(performance.now()-
t+d)/1E3});return h};a.Ot=function(a){for(var b=0;b<q.length;b++)if(q[b].id==a){q.splice(b,1);break}};a.Mt=function(a){for(var b=x.length;b--;)if(x[b].id==a){x.splice(b,1);break}};a.bn=function(a,d,h,g){h/=1E3;var m;n++;m=n;x.push({id:m,callback:g,from:a,to:d,pA:b+h,duration:h});g(a);return m};a.reset=function(){t=b=0;q.length=0;n=z=x.length=0};a.rd=m;a.MX=function(a){h=a};a.Uq=function(a){return a*m()}};"object"==typeof module&&module.qA&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function r(){var a=m,d=a.getDate(),d=10>d?"0"+String(d):String(d),q=a.getMonth()+1,q=10>q?"0"+String(q):String(q),r=String(a.getFullYear()),n=a.getHours(),n=10>n?"0"+String(n):String(n),x=a.getMinutes(),x=10>x?"0"+String(x):String(x),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+q+"."+r+" "+n+":"+x+":"+a}var m=new Date(2017,3,22,23,34,3),d=[16,12,1];a.version=function(){return d};a.ND=function(){for(var a="",m=0;m<d.length;m++)a=1==m?a+(10>d[m]?"0"+
d[m]:d[m]):a+d[m],m!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.dH=function(){return m};a.cA=r;a.timestamp=function(){var a=r(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.qA&&b4w.module.__version(exports);b4w.module.__navmesh=function(a,r){function m(a,c){function e(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var d=a.Tk,f=c.Tk,g=[],l=0;l<d.length;l++)0<=b(f,d[l])&&g.push(d[l]);if(2>g.length)return[];0<=b(g,d[0])&&0<=b(g,d[d.length-1])&&e(d);0<=b(g,f[0])&&0<=b(g,f[f.length-1])&&e(f);g=[];for(l=0;l<d.length;l++)0<=b(f,d[l])&&g.push(d[l]);return g}function d(a){function b(a){for(var c=a.hg,e=0;e<c.length;e++){var d=c[e];void 0==d.island&&(d.island=a.island,b(d))}}a=a.RW;for(var c=[],e=0,d=0;d<a.length;d++){var f=
a[d];void 0==f.island&&(f.island=e++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[d])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function t(a){function b(a,c){for(var e=0;e<a.length;e++)if(c===a[e])return e}for(var c={},e=a.Vo,f=0;f<e.length;f++)e[f][0]=parseFloat(e[f][0].toFixed(2)),e[f][1]=parseFloat(e[f][1].toFixed(2)),e[f][2]=parseFloat(e[f][2].toFixed(2));c.Vo=a.Vo;a=d(a);c.kB=[];for(f=0;f<a.length;f++){for(var e=
[],g=a[f],l=0;l<g.length;l++){for(var k=[],h=g[l],p=0;p<h.hg.length;p++)k.push(b(g,h.hg[p]));for(var n=[],p=0;p<h.hg.length;p++)n.push(m(h,h.hg[p]));h.fd[0]=parseFloat(h.fd[0].toFixed(2));h.fd[1]=parseFloat(h.fd[1].toFixed(2));h.fd[2]=parseFloat(h.fd[2].toFixed(2));e.push({id:b(g,h),hg:k,Tk:h.Tk,fd:h.fd,Sc:h.Sc,SW:n,uA:0,Oq:0,Gb:0,OR:1,PD:!1,closed:!1,parent:null})}c.kB.push(e)}return c}function q(a,b,c,e,d){function f(a,b){D.subtract(a,b,K);return D.dot(K,K)}function g(a,b){for(var c=[],e=0;e<b.hg.length;e++)c.push(a[b.hg[e]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.uA=0;c.Oq=0;c.Gb=0;c.OR=1;c.PD=!1;c.closed=!1;c.parent=null}})(a);var l=N.FQ(function(a){return a.uA});for(N.LF(l,b);0<l.content.length;){var k=N.GQ(l);if(k===c){a=k;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}k.closed=!0;for(var h=g(a,k),p=0,n=h.length;p<n;p++){var m=h[p];if(!m.closed){var v=k.Oq+D.dist(m.fd,k.fd),q=m.PD;if(!q||v<m.Oq)m.PD=!0,m.parent=k,m.Gb=m.Gb||f(m.fd,d)+f(m.fd,e),m.Oq=v,m.uA=m.Oq+m.Gb,q?N.HQ(l,
m):N.LF(l,m)}}}return[]}function z(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function n(a,b,c,e){b=D.subtract(b,a,K);a=D.subtract(c,a,M);a=D.cross(b,a,K);return O.sign(D.dot(e,a))}function x(a,b){D.subtract(a,b,K);return 1E-5>D.dot(K,K)}function h(a,b,c){var d=D.subtract(b.right,b.left,K),f=c.Sc,g=b.Sc;c=Math.acos(D.dot(f,g));f=O.sign(D.dot(d,D.cross(f,g,M)));c*=-f;f=H.identity(e);H.translate(f,b.left,f);H.rotate(f,c,d,f);H.translate(f,D.scale(b.left,-1,M),f);H.multiply(a,f,a)}function k(a,b,e,
d,f,g,k,p,n){for(var u=H.identity(C),m=f;m<e;m++)if(a[m].iJ&&(m>f||!m)){var v,q=b,x=d;v=a[m].left;var y=a[m].right,A=g,t=u,r=D.create(),B=D.transformMat4(v,t,F);B[3]=1;t=D.transformMat4(y,t,K);t=D.subtract(t,B,c);q=D.subtract(x,q,K);A=D.cross(A,q,l);.01>Math.abs(D.dot(A,t))?x=.5:(D.normalize(A,A),A[3]=-D.dot(A,x),x=-P.dot(A,B)/P.dot(A,t));y=D.subtract(y,v,K);v=D.scaleAndAdd(v,y,x,r);z(k,v);p&&z(n,a[m].Sc);m&&h(u,a[m],a[m-1])}}function f(a,b){function c(b,e){A=y=C=e;l=g=f=b;D.copy(b,m);D.copy(b,u);
D.copy(a[C].Sc,q)}var e=[],d=[],f,g,l,m,u,q,C=0,y=0,A=0;f=a[0].right;g=a[0].left;l=a[0].right;m=D.copy(g,R);u=D.copy(l,p);q=D.copy(a[0].Sc,B);z(e,f);b&&z(d,a[0].Sc);for(var t=H.identity(v),r=1;r<a.length;r++){var F=a[r].left,M=a[r].right,N=D.transformMat4(F,t,ba),K=D.transformMat4(M,t,J);a[r].iJ&&h(t,a[r],a[r-1]);if(0>=n(f,u,K,q)){var P=x(f,l);if(P||0<n(f,m,K,q))l=M,D.copy(K,u),A=r;else{(F=x(m,f))||k(a,m,y,f,C,q,e,b,d);t=H.identity(t);c(g,y);r=C;F||(z(e,f),b&&z(d,a[r].Sc));continue}}0<=n(f,m,N,q)&&
((P=x(f,g))||0>n(f,u,N,q)?(g=F,D.copy(N,m),y=r):((F=x(u,f))||k(a,u,A,f,C,q,e,b,d),t=H.identity(t),c(l,A),r=C,F||(z(e,f),b&&z(d,a[r].Sc))))}t=a.length-1;r=a[t].left;(F=x(f,r))||k(a,m,t,f,C,q,e,b,d);F&&C||z(e,r);return b?(z(d,a[t].Sc),{positions:new Float32Array(e),normals:new Float32Array(d)}):{positions:new Float32Array(e),normals:null}}function y(a,b,c,e,d){for(var f=null,g=Number.MAX_VALUE,l=0;l<a.length;l++){var k=a[l],h=d(c,k.fd,k.Tk,b,g);h<g&&(f=k,g=h)}return 0<e&&g>e?null:f}function g(a,b,c,
e,d){a.push({left:b,right:c,iJ:e,Sc:d})}var A=r("__geometry"),N=r("__math"),H=r("__mat4"),O=r("__util"),D=r("__vec3"),P=r("__vec4"),K=D.create(),M=D.create(),F=P.create(),c=P.create(),l=P.create(),C=H.create(),v=H.create(),e=H.create(),R=D.create(),p=D.create(),ba=D.create(),J=D.create(),B=D.create();a.uW=function(a){var b=A.Ou(a.mc,A.xP),c=a.ie;a=[];for(var e=0;e<c.length;e+=3)a.push({ma:new Uint32Array([c[e],c[e+1],c[e+2]]),fd:new Float32Array(3),Sc:new Float32Array(3)});c=[];for(e=0;e<b.length;e+=
3){var d=new Float32Array(3);d[0]=b[e];d[1]=b[e+1];d[2]=b[e+2];c.push(d)}for(b=0;b<a.length;b++)e=a[b],D.add(c[e.ma[0]],c[e.ma[1]],K),D.add(K,c[e.ma[2]],K),D.scale(K,1/3,e.fd);for(b=0;b<a.length;b++){var e=a[b],d=D.subtract(c[e.ma[1]],c[e.ma[0]],K),f=D.subtract(c[e.ma[2]],c[e.ma[0]],M),d=D.cross(d,f,K);D.normalize(d,d);D.copy(d,e.Sc)}for(var g={},b=[],e=[],l,k,h=Math.pow(10,4),d=0,f=c.length;d<f;d++)l=c[d],k=Math.round(l[0]*h)+"_"+Math.round(l[1]*h)+"_"+Math.round(l[2]*h),void 0===g[k]?(g[k]=d,b.push(l),
e[d]=b.length-1):e[d]=e[g[k]];g=[];d=0;for(f=a.length;d<f;d++)for(l=a[d],l.ma[0]=e[l.ma[0]],l.ma[1]=e[l.ma[1]],l.ma[2]=e[l.ma[2]],l=[l.ma[0],l.ma[1],l.ma[2]],k=0;3>k;k++)if(l[k]==l[(k+1)%3]){g.push(d);break}for(d=g.length-1;0<=d;d--)a.splice(g[d],1);c.length=0;for(d in b)c.push(b[d]);e=[];for(b=d=0;b<a.length;b++)f=a[b],e.push({id:d++,Tk:f.ma,fd:f.fd,Sc:f.Sc,hg:[]});a={RW:e,Vo:c};c={};for(b=0;b<e.length;b++)for(d=0;3>d;d++)f=e[b].Tk[d],g=e[b].Tk[(d+1)%3],f=f>g?g+"-"+f:f+"-"+g,f in c||(c[f]=[]),c[f].push(e[b]);
e=Object.keys(c);b=0;for(g=e.length;b<g;b++)for(f=e[b],d=0;d<c[f].length;d++)for(l=d+1;l<c[f].length;l++)c[f][d].hg.push(c[f][l]),c[f][l].hg.push(c[f][d]);return t(a)};a.PJ=function(a,b,c){for(var e=null,d=Number.MAX_VALUE,f=a.kB,g=0;g<f.length;g++)for(var l=0;l<f[g].length;l++){var k=f[g][l];D.subtract(k.fd,b,K);k=c(b,k.fd,k.Tk,a.Vo,d);k<d&&(e=g,d=k)}return e};a.zV=function(a,b,c){for(var e=[],d=0;d<b.length;d++)e.push(c[b[d]]);b=!1;c=-1;for(var d=e.length,f=d-1;++c<d;f=c)(e[c][1]<=a[1]&&a[1]<e[f][1]||
e[f][1]<=a[1]&&a[1]<e[c][1])&&a[0]<(e[f][0]-e[c][0])*(a[1]-e[c][1])/(e[f][1]-e[c][1])+e[c][0]&&(b=!b);return b?!0:!1};a.OJ=function(a,b,c,e){var d;d=a.kB[e.island];var l=a.Vo,k=y(d,l,b,e.allowed_distance,e.distance_to_closest);d=k?(l=y(d,l,c,e.allowed_distance,e.distance_to_farthest))?q(d,k,l,b,c):null:null;if(d&&d.length)if(e.do_not_pull_string)if(c=d,e.return_normals){b=new Float32Array(3*c.length);for(d=0;d<c.length;d++)b.set(c[d].fd,3*d);c={positions:b,normals:null}}else{b=new Float32Array(3*
c.length);a=new Float32Array(3*c.length);for(d=0;d<c.length;d++)b.set(c[d].fd,3*d),a.set(c[d].Sc,3*d);c={positions:b,normals:a}}else{a=a.Vo;e=e.return_normals;k=[];g(k,b,b,!1,d[0]&&d[0].Sc||O.$c);for(b=0;b<d.length;b++){var h=d[b];if(l=d[b+1]){var p=.999>Math.abs(D.dot(h.Sc,l.Sc));a:{for(var u=0;u<h.hg.length;u++)if(h.hg[u]===l.id){h=h.SW[u];break a}h=void 0}g(k,a[h[0]],a[h[1]],p,l.Sc)}}g(k,c,c,!1,k[k.length-1].Sc);c=f(k,e)}else c=null;return c}};b4w.module.__prerender=function(a,r){function m(a,d){var f=a.bf;f.Pn=!1;if(f.Mh)return!1;var m=d.p,t=d.type==n.cd?m.Bv:x.fc(m.n,y);if("STATIC"==f.type&&f.Ln)var r=f.sr,z=f.ur;else r=f.kb.G,z=f.kb.Xa;var K=f.Xg,M=f.af,t=k.dist(r,t);if(!(t<K?0:M==q.jp||t<M+f.Yg*z))return!1;f.Pn=!0;M=a.za;if(d.type==n.rf)return d.debug_view_mode==b.Ps?M.Di:!M.Di;if(d.type==n.yg&&0==f.dh)return!1;f.Ro?(z=M.kb,K=M.pb,f=M.Nf):(z=f.kb,K=f.pb,f=f.Nf);if(M=!M.Lj)m=m.Ih,M=z.G,h.CY(M,m,z.Xa)?M=!0:f?(M=K.G,M=h.rT(M,m,K.Ga,K.Ha,
K.Ia)):M=!1;return M?!1:!0}function d(a){var b=a.gb;if(b&&b.QJ){a=a.Ba;t.fW(a);var d=a.kd,f=d.a_position.offset;t.bN(a.mc,"a_position",b.fC,f);f=d.a_tbn_quat.offset;t.bN(a.mc,"a_tbn_quat",b.pD,f);t.KM(a)}}r("__config");var b=r("__debug"),t=r("__geometry"),q=r("__obj_util"),z=r("__renderer"),n=r("__subscene"),x=r("__tsr"),h=r("__util"),k=r("__vec3"),f=[n.Ob,n.Lc,n.Md,n.md,n.sf,n.Ke,n.ee,n.Pf,n.cd,n.tf,n.yg,n.rf,n.pf,n.ni],y=new Float32Array(3);a.hw=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,
k=a.type==n.md||a.type==n.Ke,h=a.Qa,q=0;q<h.length;q++){for(var x=h[q],y=x.ra,t=!1,r=0;r<y.length;r++){var F=y[r],c=F.za;if(k)for(var l=0;6>l;l++)a.p.Ih=a.rq[l],F.lA[l]=m(F,a),F.lA[l]&&(t=b=!0,d(c));else F.ac=m(F,a),F.ac&&(t=b=!0,d(c));a.Aa&&(c.yb.yr=!0)}x.ac=t}a.Aa=!1;switch(a.type){case n.rf:break;default:a.type==n.Ob||a.type==n.tf||a.type==n.ee||a.type==n.Md||a.type==n.md||b?a.ac=!0:(a.ac&&z.clear(a),a.ac=!1)}}else if(a.Aa){h=a.Qa;for(q=0;q<h.length;q++)for(y=h[q].ra,r=0;r<y.length;r++)F=y[r],
c=F.za,c.yb.yr=!0;a.Aa=!1}a.LB&&n.wY(a)}};b4w.module.__primitives=function(a,r){function m(a,b,d,m){for(var g=[],q=[],x=[],t=[],r=2*d/(a-1),D=2*m/(b-1),P=0;P<a;P++)for(var K=-d+P*r,M=0;M<b;M++)if(q.push(K,-m+M*D,0),t.push(0,0,0,1),x.push(P/(a-1),M/(b-1)),P&&M){var F=P*b+M,c=F-1,l=(P-1)*b+M,C=l-1;g.push(F,c,l);g.push(c,C,l)}a=n.Ig();a.a_position=new Float32Array(q);a.a_tbn_quat=new Float32Array(t);t=z.Df("GRID_PLANE");t.Z[0]=a;t.pa.a_texcoord=new Float32Array(x);t.ma=new Uint32Array(g);t.Ja=q.length/3;return t}function d(a){var b=a.length;
b%4&&n.q("Wrong array");for(var d=[],m=[],g=0;g<b;g+=4){var q=a[g+1],x=a[g+2],r=a[g+3];t(a[g],m);t(q,m);t(x,m);t(r,m);d.push(g,g+1,g+2);d.push(g,g+2,g+3)}a=n.Ig();a.a_position=new Float32Array(m);b=z.Df("FROM_QUADS");b.Z[0]=a;b.ma=new Uint32Array(d);b.Ja=m.length/3;return b}function b(a,b){var d=3*b;return[a[d],a[d+1],a[d+2]]}function t(a,b){b.push(a[0],a[1],a[2])}var q=r("__config"),z=r("__geometry");r("__print");var n=r("__util"),x=q.A;a.jU=function(){var a=z.Df("LINE"),b=n.Ig();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.Z[0]=b;a.ma=new Uint32Array(1);a.Ja=1;return a};a.v3=function(a,b){var d=m(2,2,a,b);d.name="PLANE";return d};a.u3=m;a.cU=function(a,b,d){function m(a,b){return 1==a%2&&(0==b||b==r-1)||1==b%2&&(0==a||a==t-1)?!0:!1}var g=d/=Math.pow(2,a-1),q=d,t=b+1,r=b+1;b=[];d=[];for(var O=[],D=0,P=0,K=-1,M=[],F=0;F<a;F++){for(var c=2*g/(t-1),l=2*q/(r-1),C=[],v=[],e=0,R=0;R<t;R++){for(var p=-g+R*c,ba=[],J=0;J<r;J++){var B=-q+J*l;if(p>-D&&p<D&&B>-P&&B<P)ba.push(-1),e++;else{for(var V=
null,U=0;U<M.length;U+=3)if(p==M[U]&&B==M[U+1]){V=M[U+2];break}U=null!==V?V:K+1;m(R,J)?(ba.push(-2),e++):(null==V&&(0==J||J==r-1||0==R||R==t-1?(V=F==a-1?c:2*c,C.push(p,B,U)):V=c,d.push(p,B,V),O.push(.707,0,0,.707),K++),ba.push(U));if(R&&J)if(1==R)if(m(R-1,J)){if(1<J){var B=U-1,V=v[R-1][J+1],Z=V-1;b.push(Z,B,U)}else V=v[R-1][J+1],Z=V-1;b.push(V,Z,U)}else m(R,J)||(B=U-1,V=v[R-1][J],b.push(V,B,U));else if(R==t-1){if(!m(R,J))if(J==r-1)B=U-1,V=v[R-1][J-1],Z=v[R-2][J],b.push(V,B,U),b.push(Z,V,U);else{var B=
U-1,V=v[R-1][J],Z=V-1,w=V+1;b.push(Z,B,U);b.push(V,Z,U);b.push(w,V,U);2==J&&(w=v[R-2][J-2],b.push(Z,w,B))}}else 1==J?m(R,J-1)?(B=v[R-1][J],V=v[R-1][J-1],b.push(B,V,U)):(B=ba[J-1],V=v[R-1][J],Z=v[R-2][J-1],b.push(V,B,U),b.push(V,Z,B)):J==r-1?m(R,J)||(B=ba[J-1],V=v[R-1][J-1],Z=v[R-2][J],b.push(V,B,U),b.push(Z,V,U)):-1!=v[R-1][J]&&-1!=v[R-1][J-1]&&-1!=ba[J-1]?(B=ba[J-1],V=v[R-1][J],Z=v[R-1][J-1],b.push(V,B,U),b.push(V,Z,B),J==r-2&&m(R,J+1)&&(w=v[R-1][J+1],b.push(w,V,U))):J==r-2&&m(R,J+1)&&(V=v[R-1][J],
w=v[R-1][J+1],b.push(w,V,U))}}v.push(ba)}M=C;D=g;P=q;g*=2;q*=2}if(2E4>D)for(a=-(2*D)/(t-1),d.push(-2E4,-2E4,a),d.push(-2E4,2E4,a),d.push(-D,-P,a),d.push(-D,P,a),d.push(2E4,-2E4,a),d.push(2E4,2E4,a),d.push(D,-P,a),d.push(D,P,a),U=K+1,b.push(U+1,U+2,U+3,U+1,U+0,U+2,U+2,U+4,U+6,U+2,U+0,U+4,U+1,U+7,U+5,U+1,U+3,U+7,U+7,U+4,U+5,U+6,U+4,U+7),R=0;8>R;R++)O.push(.707,0,0,.707);a=n.Ig();a.a_position=new Float32Array(d);a.a_tbn_quat=new Float32Array(O);g=z.Df("MULTIGRID_PLANE");g.Z[0]=a;g.ma=new Uint32Array(b);
g.Ja=d.length/3;x.nN&&(z.Xw(g,1,!0),a.a_polyindex=z.su(g));return g};a.t3=function(a){var b=a.length;b%3&&n.q("Wrong array");for(var d=[],m=[],g=0;g<b;g+=3){var q=a[g+1],x=a[g+2];t(a[g],m);t(q,m);t(x,m);d.push(g,g+1,g+2)}a=n.Ig();a.a_position=new Float32Array(m);b=z.Df("FROM_TRIANGLES");b.Z[0]=a;b.ma=new Uint32Array(d);b.Ja=m.length/3;return b};a.s3=d;a.gU=function(a){a=n.d_(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.Qc=function(){var a=z.Df("FULLSCREEN_TRI"),b=n.Ig();b.a_position=new Float32Array([0,0,1,0,0,1]);a.Z[0]=b;a.ma=new Uint32Array([0,1,2]);a.Ja=3;return a};a.hU=function(){var a=z.Df("FULLSCREEN_QUAD"),b=n.Ig();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.Z[0]=b;a.ma=new Uint32Array([0,2,1,1,2,3]);a.Ja=4;return a};a.bU=function(){var a=z.Df("BILLBOARD"),b=n.Ig();b.a_bb_vertex=z.EH(1);a.Z[0]=b;a.ma=new Uint32Array([0,
2,1,0,3,2]);a.Ja=4;return a};a.dU=function(){var a=z.Df("CUBEMAP_BOARD"),b=n.Ig();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.Z[0]=b;a.ma=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.Au=function(a,d){var f=z.Df("UV_SPHERE"),m,g,q=[],x=[],r=[];for(g=0;8>=g;g++)for(m=0;16>=m;m++){var O=m/16,D=g/8;x.push(-a*Math.cos(2*O*Math.PI)*Math.sin(D*Math.PI)+d[0],a*Math.cos(D*Math.PI)+d[1],a*Math.sin(2*O*Math.PI)*Math.sin(D*Math.PI)+d[2])}for(g=O=0;8>g;g++)for(m=0;16>m;m++){var D=b(x,17*g+m+1),
P=b(x,17*g+m),K=b(x,17*(g+1)+m),M=b(x,17*(g+1)+m+1);Math.abs(D[1])==a+d[1]?(t(D,q),t(K,q),t(M,q),r.push(O,O+1,O+2),O+=3):Math.abs(K[1])==a+d[1]?(t(D,q),t(P,q),t(K,q),r.push(O,O+1,O+2),O+=3):(t(D,q),t(P,q),t(K,q),t(M,q),r.push(O,O+1,O+2),r.push(O,O+2,O+3),O+=4)}m={};m.a_position=q;x=z.ZQ(r,x,q);x=z.WQ(r,q,x);m.a_tbn_quat=n.Rq(x);f.Z[0]=m;f.ma=r;f.Ja=q.length/3;return f};a.IH=function(a){var b=z.Df("INDEX"),d=n.Ig();d.a_index=new Float32Array(3*a);for(var m=new Uint16Array(3*a),g=0;g<3*a;g++)d.a_index[g]=
g,m[g]=g;b.Z[0]=d;b.ma=m;b.Ja=3*a;return b}};b4w.module.__scenegraph=function(a,r){function m(a,b){var c=[];p.sg(a,function(b,d,e){-1<c.indexOf(e)?p.lX(a,b,d,e,P(e)):c.push(e)});p.oa(a,function(a,d){for(var e=0;e<d.Ya.length;e++){var f=d.Ya[e];b||d.type!=J.Md&&d.type!=J.md&&d.type!=J.Pf||(f.jf=!0);-1<c.indexOf(f)?d.Ya[e]=P(f):c.push(f)}})}function d(a,c){p.oa(a,function(b,d){d.type==J.XD&&p.fi(a,b,function(a,b){if(b.type==J.sh)for(var c=0;c<b.Ya.length;c++){var d=b.Ya[c];d.Na=B.K;d.Ma=B.K}});c||p.fi(a,b,function(a,b,c){"DEPTH"==c.from&&(c.jf=
!0)})});p.oa(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],g=0;g<c.length;g++)if(c[g].Na==B.K){f=c[g];break}for(var l=c[0],g=0;g<c.length;g++)if(c[g].Ma==B.K){l=c[g];break}for(var k=c[0],g=0;g<c.length;g++)if(!c[g].jf){k=c[g];break}for(g=0;g<c.length;g++)c[g].Na=f.Na,c[g].Ma=l.Ma,c[g].jf=k.jf}})}function b(a,c,d){p.fi(a,c,function(c,e,f){f.Dc&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&d[f.from].push(f),b(a,c,d))});p.Ik(a,c,function(a,b,c){c.Dc&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=p.Va(a,c);if(c.type==J.sh)for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];d[f.from].push(f)}}function t(a){var b=[J.sh,J.My,J.kt,J.Md,J.md,J.mp],c=p.uD(a),d=[];p.oa(c,function(a,e){for(var f=0;f<e.Ya.length;f++){var g=e.Ya[f];-1<b.indexOf(e.type)&&(g.ex=!0);var l=h(d,g,q(g));g.jb=l;e.ei[f]=l}for(f=0;f<e.ei.length;f++)l=e.ei[f],x(d,l);p.Ik(c,a,function(f,g,l){-1<b.indexOf(e.type)&&(l.ex=!0);l.jb||((f=z(c,a,l.from))&&l.Dc&&!l.jb?n(d,f):f=h(d,
l,q(l)),l.jb=f)});p.fi(c,a,function(a,b,c){x(d,c.jb)});p.Ik(c,a,function(a,b,c){c.jb&&"NONE"==c.to&&x(d,c.jb)})})}function q(a){a=V.Bh(a);delete a.to;delete a.Dc;delete a.jb;return JSON.stringify(a)}function z(a,b,c){var d=null;p.fi(a,b,function(a,b,e){if(e.Dc&&e.from==e.to&&e.from==c&&e.jb)return d=e.jb,!0});p.Ik(a,b,function(a,b,e){if(e.Dc&&e.from==c&&e.jb)return d=e.jb,!0});return d}function n(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.qD===b&&d.Sr++}}function x(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.qD===b&&d.Sr&&d.Sr--}}function h(a,b,c){if(b.ao)return n(a,b.ao.jb),b.ao.jb;if(b.ex)return k(b);for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Sr){d=f;break}}if(d&&!Z.vH)return d.Sr++,d.qD;b=k(b);a.push({id:c,Sr:1,qD:b});return b}function k(a){var b=a.ym*a.size,c=a.zm*a.size;switch(a.from){case "COLOR":if(a.jf){var d=B.zl(a.dk?B.pt:B.ot,a.vs);B.resize(d,b,c)}else d=B.zl(B.th,a.vs),B.resize(d,b,c),B.JC(d,a.Na,a.Ma);return d;case "DEPTH":return a.jf?(d=B.zl(a.dk?B.nt:B.mt,a.vs),
B.resize(d,b,c)):(d=B.zl(B.bl,a.vs),B.resize(d,b,c),B.JC(d,a.Na,a.Ma)),d;case "CUBEMAP":return d=B.EG(b);case "SCREEN":case "NONE":return null;default:V.q("Wrong slink param: "+a.from)}}function f(a,b){var c=!1;p.sg(a,function(d,e,f){if(f&&(d=p.Va(a,d),e=p.Va(a,e),b(f,!1,d,e)))return c=!0});c||p.oa(a,function(a,c){for(var d=0;d<c.Ya.length;d++)if(b(c.Ya[d],!0,c,null))return!0})}function y(a){p.oa(a,function(b,c){if(c.type!=J.Zm){var d=c.p;p.Ik(a,b,function(a,b,c){c.Dc&&c.jb&&(v.vw(d,c.from,c.jb),
c.from==c.to&&b.p&&v.vw(b.p,c.from,c.jb))});for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];f.Dc&&f.from==f.to&&v.vw(d,f.from,c.ei[e])}!d.pc&&!d.Re||d.Ve||(d.Ve=ba.hX(d.pc,d.Re))}});p.oa(a,function(b,c){if(c.type==J.Ym||c.type==J.Hx){var d=F(a,c);c.p.Nq=d[0].p.Ve}})}function g(a){var b=null,c=0;p.oa(a,function(a,d){if(d.type==U.PY){if(c==U.OY)return b=d,!0;c++}});return b}function A(a,b){var c=p.ah(a,b),d=J.zd("NONE"),e=p.J(a,d),f=p.Vq(a)[0];p.sg(a,function(b,c){c==f&&p.bX(a,b,f,b,e)});var g=N(b,a);
p.sg(a,function(e,f,l){if(e==c){if(g){e=J.$t();p.J(a,e);f=D("COLOR","RESOLVE",1,1,1,!0);f.dk=!0;f.jf=!0;var k=D("DEPTH","RESOLVE",1,1,1,!0);k.dk=!0;k.jf=!0;p.r(a,b,e,f);p.r(a,b,e,k);b=e}p.r(a,b,d,D(U.qY,"u_color",l.size,l.ym,l.zm,l.rs));return!0}});p.ed(a,e,f,D("SCREEN","NONE",.5,.5,.5,!0))}function N(a,b){var c=!1,d=p.ah(b,a);p.mg(b,d)&&(c=p.Sg(b,d,0),d=p.Vd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=p.Va(b,c),c=N(d,b)):c="RESOLVE"==d.to);return c}function H(a,b,c,
d){var e=c.ba,f=b.dv,g=b.Xh.Uh,l=b.Xh.fw,k=p.Vw(a,p.MU(a,d),p.Ms),h=[],n=[],m=[],k=p.clone(k,function(b){var d;if(-1<ga.indexOf(b.type))n.push(b),d=b;else{d=J.KR(b);if(d.type==J.Md)for(var k=0;k<g.length;k++)if(g[k][0]==b){g[k]=[b,d];d.p.lc=b.p.lc;c.ba.push(d.p);break}if(b.type==J.sf)for(k=0;k<g.length;k++){if(l[k][0]==b){l[k]=[b,d];d.p=g[k][1].p;break}}else-1<e.indexOf(b.p)&&(f?(v.Ev(b.p,v.Le),v.Ev(d.p,v.Me)):(v.Ev(b.p,v.Mc),v.Ev(d.p,v.dd)),e.push(d.p));var w=p.ah(a,b);p.fi(a,w,function(a,b,c){-1<
ga.indexOf(b.type)&&h.push([b,d,c])});if(b.type!==J.sh)for(k=0;k<b.Ya.length;k++)d.Ya[k].ao=b.Ya[k];b=!0;for(k=0;k<p.In(a,w);k++){var q=p.Li(a,w,k),q=p.Va(a,q);-1==ga.indexOf(q.type)&&(b=!1)}b&&m.push(d)}return d},function(a){var b=P(a,!0);b.ao=a;return b});p.sg(k,function(a,b,c){p.Va(k,a).type===J.sh&&(c.ao=null)});for(var w=0;w<n.length;w++)p.pg(k,p.ah(k,n[w]));p.yz(k);b=J.PS(f);var w=p.J(a,b),q=J.Uz();p.J(a,q);var C=D("COLOR","COPY",1,1,1,!0);p.r(a,d,q,C);var x=D("COLOR","u_sampler_left",1,1,1,
!0);x.ex=!0;x.Na=B.K;x.Ma=B.K;p.r(a,q,b,x);d.uc||(d=J.Uz(),p.J(k,d),x=D("COLOR","COPY",1,1,1,!0),x.ao=C,C=p.Vq(k)[0],C=p.Va(k,C),p.r(k,C,d,x));d=D("COLOR","u_sampler_right",1,1,1,!0);d.Na=B.K;d.Ma=B.K;p.gQ(k,a,[p.Vq(k)[0],w,d]);for(w=0;w<h.length;w++)p.r(a,h[w][0],h[w][1],h[w][2]);d=D("SCREEN","NONE",0,0,0,!1);for(w=0;w<m.length;w++)p.r(a,q,m[w],d);f&&O(a,.5,1);return b}function O(a,b,c){var d=[];p.oa(a,function(b,c){if(-1==ga.indexOf(c.type)&&c.Ya.length&&K(a,c,J.qi))for(var e=0;e<c.Ya.length;e++){var f=
c.Ya[e];-1==d.indexOf(f)&&d.push(f)}});p.sg(a,function(b,c,e){b=p.Va(a,b);c=p.Va(a,c);-1==ga.indexOf(b.type)&&K(a,c,J.qi)&&-1==d.indexOf(e)&&d.push(e)});for(var e=0;e<d.length;e++)d[e].ym*=b,d[e].zm*=c}function D(a,b,c,d,e,f){return{from:a,to:b,size:c,ym:d,zm:e,rs:f,Dc:!0,jb:null,dk:!1,jf:!1,Na:B.re,Ma:B.re,ex:!1,vs:!1}}function P(a,b){if(b){var c=a.jb;a.jb=null}a.jb&&V.q("Failed to clone slink with attached texture");var d=V.Bh(a);b&&(a.jb=c,d.jb=c);return d}function K(a,b,d){if(b.type==d)return!0;
b=c(a,b);for(var e=0;e<b.length;e++)if(K(a,b[e],d))return!0;return!1}function M(a,b,c){if(b.type==c)return!0;b=F(a,b);for(var d=0;d<b.length;d++)if(M(a,b[d],c))return!0;return!1}function F(a,b){var c=p.ah(a,b);c==p.Iy&&V.q("Subscene not in graph");for(var d=[],e=p.In(a,c),f=0;f<e;f++){var g=p.Li(a,c,f);g!=c&&d.push(p.Va(a,g))}return d}function c(a,b){var c=p.ah(a,b);c==p.Iy&&V.q("Subscene not in graph");for(var d=[],e=p.mg(a,c),f=0;f<e;f++){var g=p.Sg(a,c,f);g!=c&&d.push(p.Va(a,g))}return d}function l(a){var b=
[],c=[];f(a,function(a){a.jb&&-1==b.indexOf(a.jb)&&(b.push(a.jb),c.push(a.jb,b.length-1))});return c}function C(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.rs){var d=a.ym,e=a.zm;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.ym,e=a.zm,c+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){c+=" ";if(a.jf)c+="RR";else{var d=a.Na,e=a.Ma,f="";d==B.K?f+="L":d==B.re&&(f+="N");e==B.K?f+="L":e==B.re&&(f+="N");c+=f}for(d=
0;d<b.length;d+=2)b[d]==a.jb&&(c+=" "+b[d+1])}return c+")\\n"}var v=r("__camera"),e=r("__config"),R=r("__debug"),p=r("__graph"),ba=r("__renderer"),J=r("__subscene"),B=r("__textures"),V=r("__util"),U=e.uq,Z=e.A,w=e.mo,ga=[J.oi,J.cd,J.md,J.Ke];a.xR=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.gZ=f;a.lS=function(a,b,e,f){function l(c){var d=v.Ec(Sa,!0);b.ba.push(d);d=J.yl(c,d,!1,K,
N,Ga,Ka,Ca,a.kj);p.J(k,d);c==J.Pf?(p.r(k,h[0],d,D("COLOR","COLOR",1,1,1,!0)),d.Ya.push(D("DEPTH","DEPTH",1,1,1,!0))):(c=da&&h[0].type==J.Ym?Bb:h[0],p.r(k,c,d,Ha),p.r(k,c,d,Ab));La&&(p.r(k,La,d,hb),p.r(k,La,d,jb));for(c=0;c<q.length;c++)p.r(k,q[c],d,C[c]);Wa&&p.r(k,Wa,d,Fa);if(x.length){var e=x.length;for(c=0;c<e;c++)p.r(k,x[c],d,r[c])}if(z.length)for(c=0;c<z.length;c++)p.r(k,z[c],d,M[c]);Hb&&p.r(k,Hb,d,ec);return d}var k=p.create(),h=[],n=[],q=[],C=[],x=[],r=[],z=[],M=[],N=a.FV,K=a.Ic,O=a.Ak,ga=a.sY,
L=a.ssao,ba=a.god_rays,E=a.Xh,za=a.GJ,ra=a.IQ,ka=a.motion_blur,va=a.compositing,ma=a.antialiasing,Ka=a.Zo,Ga=a.qN,Ca=a.ud,ta=a.nW,Ba=a.hR,sa=a.VU,Ra=a.BW,Na=a.dof,Da=a.dT,G=a.refractions,T=Boolean(f.length),da=1<Z.Cc,Ab=D("COLOR","COLOR",1,1,1,!0),Ha=D("DEPTH","DEPTH",1,1,1,!0);if(da){P(Ha);var zc=P(Ha);Ab.dk=!0;Ab.jf=!0;Ha.dk=!0;Ha.jf=!0}var Sa=b.ba[0];if(Ca){v.FD(Sa,Ca);for(var ha=0;ha<Ca.Wg.length;ha++)for(var Ea=Ca.csm_num,qa=0;qa<Ea;qa++){var W=J.KS(qa,ha,Ca,N);p.J(k,W);q.push(W);var Oa=Ca.csm_resolution,
ua=W.p;b.HL.push(ua);ua.width=Oa;ua.height=Oa;W.vb=!1;var Ma=D("DEPTH","u_shadow_map"+(0<ha?ha:qa),Oa,1,1,!1);Z.iq&&(Ma.Na=B.K,Ma.Ma=B.K,Ma.vs=!0);C.push(Ma);(R.pR()||Z.IL)&&W.Ya.push(D("COLOR","COLOR",Oa,1,1,!1))}}if(E&&E.WJ&&!T)for(qa=0;qa<E.WJ;qa++){ua=v.gd(v.Nd);ua.width=a.Ci;ua.height=a.Ci;v.yw(ua,90,.1,100);v.yk(ua,ua.zb);var Ua=J.yl(J.md,ua,!1,K,N,Ga,Ka,null,a.kj);Ua.Al=V.iU();for(ha=0;6>ha;ha++)Ua.rq.push(v.$R());p.J(k,Ua);var nb=D("CUBEMAP","u_cube_reflection",a.Ci,1,1,!1);nb.Na=B.K;nb.Ma=
B.K;M.push(nb);if(E.RI){var Va=J.yl(J.Ke,ua,!1,K,N,Ga,Ka,null,a.kj);Va.Al=Ua.Al;Va.rq=Ua.rq;p.J(k,Va);var Aa=D("DEPTH","DEPTH",a.Ci,1,1,!1),kb=D("COLOR","COLOR",a.Ci,1,1,!1);p.r(k,Ua,Va,Aa);p.r(k,Ua,Va,kb);z.push(Va);E.Zz.push(Va)}else{var Ya=D("DEPTH","DEPTH",a.Ci,1,1,!1);Ua.Ya.push(Ya);z.push(Ua)}E.Bi.push(Ua)}if(E&&0<E.DK.length&&!T)for(ha=0;ha<E.DK.length;ha++)ua=v.Ec(Sa,!0),ua.lc=new Float32Array(4),b.ba.push(ua),Ua=J.yl(J.Md,ua,!1,K,N,Ga,Ka,null,a.kj),p.J(k,Ua),nb=D("COLOR","u_plane_reflection",
1,a.fh,a.fh,!0),nb.Na=B.K,nb.Ma=B.K,r.push(nb),E.RI?(Va=J.yl(J.sf,ua,!1,K,N,Ga,Ka,null,a.kj),p.J(k,Va),Aa=D("DEPTH","DEPTH",1,a.fh,a.fh,!0),kb=D("COLOR","COLOR",1,a.fh,a.fh,!0),kb.Na=B.re,kb.Ma=B.re,p.r(k,Ua,Va,Aa),p.r(k,Ua,Va,kb),E.fw.push([Va]),x.push(Va)):(Ya=D("DEPTH","DEPTH",1,a.fh,a.fh,!0),Ua.Ya.push(Ya),x.push(Ua)),E.Uh.push([Ua]);if(a.hd){var La=J.DS();p.J(k,La);Oa=w.ar;La.p.width=Oa;La.p.height=Oa;var hb=D("DEPTH","u_grass_map_depth",Oa,1,1,!1);Z.cc||(hb.Na=B.K,hb.Ma=B.K);var jb=D("COLOR",
"u_grass_map_color",Oa,1,1,!1);jb.Na=B.K;jb.Ma=B.K}else jb=hb=La=null;if(Da&&Ca){var ab=v.Ec(Sa,!0);b.ba.push(ab);var vb=J.LS(ab,N);p.J(k,vb);vb.self_shadow_normal_offset=Ca.self_shadow_normal_offset;for(qa=0;qa<q.length;qa++)W=q[qa],p.r(k,W,vb,C[qa]);var gb=D("COLOR","u_color",1,1,1,!0),mb=D("DEPTH","u_depth",1,1,1,!0);if(L){var sb=v.Ec(Sa,!0);b.ba.push(sb);var Ta=a.IY,Nb=J.NS(sb,Ga,Ta);p.J(k,Nb);var dc=D("COLOR","u_ssao_mask",1,1,1,!0);p.r(k,vb,Nb,gb);p.r(k,vb,Nb,mb);var Xb=v.Ec(Sa,!0);b.ba.push(Xb);
var ob=J.OS(Xb,Ta);p.J(k,ob);var nd=D("COLOR","u_shadow_mask",1,1,1,!0);p.r(k,Nb,ob,dc);p.r(k,vb,ob,mb)}da?vb.Ya.push(D("DEPTH","DEPTH",1,1,1,!0)):vb.Ya.push(Ha);La&&(p.r(k,La,vb,hb),p.r(k,La,vb,jb))}else vb=null;var Bb=J.yl(J.Ob,Sa,!0,K,N,Ga,Ka,null,a.kj);p.J(k,Bb);if(da){var db=J.$t();p.J(k,db);n.push(db);var ic=D("COLOR","RESOLVE",1,1,1,!0);ic.dk=!0;ic.jf=!0;var Nc=D("DEPTH","RESOLVE",1,1,1,!0);Nc.dk=!0;Nc.jf=!0;p.r(k,Bb,db,ic);p.r(k,Bb,db,Nc)}else n.push(Bb);vb&&(dc?p.r(k,ob,Bb,nd):Ca?p.r(k,vb,
Bb,D("COLOR","u_shadow_mask",1,1,1,!0)):V.q("Internal error"));La&&(p.r(k,La,Bb,hb),p.r(k,La,Bb,jb));if(x.length)for(var Vc=x.length,ha=0;ha<Vc;ha++)p.r(k,x[ha],Bb,r[ha]);if(z.length)for(ha=0;ha<z.length;ha++)p.r(k,z[ha],Bb,M[ha]);h=n;n=[];if(!T&&a.LR){ua=v.Ec(Sa,!0);ua.width=1;ua.height=1;b.ba.push(ua);var sc=J.QG(ua,!1,N);p.J(k,sc);if(a.qh){ua=v.Ec(Sa,!0);ua.width=1;ua.height=1;b.ba.push(ua);var Qc=J.QG(ua,!0,N);p.J(k,Qc);p.r(k,sc,Qc,D("COLOR","COLOR",1,1,1,!1));p.r(k,sc,Qc,D("DEPTH","DEPTH",1,
1,1,!1))}}else sc=null;if(!za.refractions&&!G||T)Hb=null;else{if(da)Hb=db;else{var Hb=J.Uz();p.J(k,Hb);p.r(k,h[0],Hb,D("COLOR","COPY",1,1,1,!0))}var ec=D("COLOR","u_refractmap",1,1,1,!0)}if(Da&&(G||O||ga)){var wb=v.Ec(Sa,!0);b.ba.push(wb);var Wa=J.AS(wb);p.J(k,Wa);p.r(k,da?db:Bb,Wa,D("DEPTH","u_depth",1,1,1,!0));var Fa=D("COLOR","u_scene_depth",1,1,1,!0);Fa.Na=B.re;Fa.Ma=B.re}else Wa=null;if(a.Ru){var xb=l(J.Lc);n.push(xb);h=n;n=[]}if(a.Ni){var Rc=v.Ec(Sa,!0);b.ba.push(Rc);var Vb=J.yl(J.ee,Rc,!1,
K,N,Ga,Ka);p.J(k,Vb);Wa&&p.r(k,Wa,Vb,Fa);Hb&&p.r(k,Hb,Vb,ec);La&&(p.r(k,La,Vb,hb),p.r(k,La,Vb,jb));if(x.length)for(Vc=x.length,ha=0;ha<Vc;ha++)p.r(k,x[ha],Vb,r[ha]);if(z.length)for(ha=0;ha<z.length;ha++)p.r(k,z[ha],Vb,M[ha]);p.r(k,da?db:Bb,Vb,da?zc:Ha);var Ac=J.zd("X_GLOW_BLUR");Ac.Db="GLOW_MASK_SMALL";Ac.rg=a.Sj.small_glow_mask_width;var dd=D("COLOR","u_color",1,1,1,!0);dd.Na=B.K;dd.Ma=B.K;p.J(k,Ac);p.r(k,Vb,Ac,dd);var tc=J.zd("Y_GLOW_BLUR");tc.Db="GLOW_MASK_SMALL";tc.rg=a.Sj.small_glow_mask_width;
var Yb=D("COLOR","u_color",1,.5,.5,!0);Yb.Na=B.K;Yb.Ma=B.K;p.J(k,tc);p.r(k,Ac,tc,Yb);var Wc=J.zd("X_GLOW_BLUR");Wc.Db="GLOW_MASK_LARGE";Wc.rg=a.Sj.large_glow_mask_width;var ed=D("COLOR","u_color",1,.5,.5,!0);ed.Na=B.K;ed.Ma=B.K;p.J(k,Wc);p.r(k,tc,Wc,ed);var Zb=J.zd("Y_GLOW_BLUR");Zb.Db="GLOW_MASK_LARGE";Zb.rg=a.Sj.large_glow_mask_width;var bb=D("COLOR","u_color",1,.25,.25,!0);bb.Na=B.K;bb.Ma=B.K;p.J(k,Zb);p.r(k,Wc,Zb,bb);var ud=v.Ec(Sa,!0);b.ba.push(ud);var Fc=J.BS(ud,a);p.J(k,Fc);var fd=D("COLOR",
"u_src_color",1,1,1,!0);if(a.Ru)if(da){var Xc=J.$t();p.J(k,Xc);p.r(k,xb,Xc,ic);p.r(k,xb,Xc,Nc);p.r(k,Xc,Fc,fd)}else p.r(k,xb,Fc,fd);else p.r(k,da?db:Bb,Fc,fd);p.r(k,a.Ru?xb:Bb,Fc,Ha);var Bc=D("COLOR","u_glow_mask_small",1,.5,.5,!0);Bc.Na=B.K;Bc.Ma=B.K;p.r(k,tc,Fc,Bc);var jc=D("COLOR","u_glow_mask_large",1,.25,.25,!0);jc.Na=B.K;jc.Ma=B.K;p.r(k,Zb,Fc,jc);h=[Fc];n=[]}a.Ru||(xb=l(J.Lc),n.push(xb),h=n,n=[]);if(Z.debug_view){ua=v.Ec(Sa,!0);b.ba.push(ua);var Pb=J.zS(ua);n.push(Pb);p.J(k,Pb);p.r(k,h[0],Pb,
Ab);p.r(k,h[0],Pb,Ha);La&&(p.r(k,La,Pb,hb),p.r(k,La,Pb,jb));R.GX(Pb);h=n;n=[]}if(da){var Ob=J.$t();p.J(k,Ob);n.push(Ob);p.r(k,h[0],Ob,ic);p.r(k,h[0],Ob,Nc);h=n;n=[]}var kc=h.slice(0);if(!T&&a.NP){ua=v.Ec(Sa,!0);b.ba.push(ua);var Gc=J.vS(ua);p.J(k,Gc);p.r(k,h[0],Gc,da?zc:Ha)}if(ba&&Da&&!T){var Ib=sa.Sn,lc=sa.bB,qb=sa.Go,cb=h[0],$b=K?!0:!1,Yc=D("DEPTH","u_input",1,1,1,!0),Cb=D("COLOR","u_input",1,.25,.25,!0);Cb.Na=B.K;Cb.Ma=B.K;var Qb=Ib/qb,eb=v.Ec(Sa,!0);b.ba.push(eb);var pb=J.Vz(eb,$b,Ib,!0,Qb,N,
qb);p.J(k,pb);p.r(k,cb,pb,Yc);var Qb=Ib/qb*.5,Hc=v.Ec(Sa,!0);b.ba.push(Hc);var mc=J.Vz(Hc,$b,Ib,!1,Qb,N,qb);p.J(k,mc);p.r(k,pb,mc,Cb);var Qb=Ib/qb*.25,Ic=v.Ec(Sa,!0);b.ba.push(Ic);var Jb=J.Vz(Ic,$b,Ib,!1,Qb,N,qb);p.J(k,Jb);p.r(k,mc,Jb,Cb);var nc=J.CS(lc,N);n.push(nc);p.J(k,nc);p.r(k,cb,nc,D("COLOR","u_main",1,1,1,!0));p.r(k,Jb,nc,D("COLOR","u_god_rays",1,1,1,!0));h=n;n=[]}if(ra&&!T){var cb=h[0],ac=J.ES();p.J(k,ac);p.r(k,cb,ac,D("COLOR","u_input",1,1,1,!0));var Za=J.wS();p.J(k,Za);Za.p.width=Z.Dq?
2:1;Za.p.height=Z.Dq?2:1;var bc=D("COLOR","u_input",1,.25,.25,!0);bc.Na=B.K;bc.Ma=B.K;var Kb=D("COLOR","u_luminance",1,.25,.25,!0);Kb.Na=B.K;Kb.Ma=B.K;p.r(k,ac,Za,bc);var rb=ra.key,oc=ra.edge_lum,tb=v.Ec(Sa,!0);b.ba.push(tb);var Lb=J.FS(rb,oc,N,tb);p.J(k,Lb);p.r(k,cb,Lb,D("COLOR","u_main",1,1,1,!0));p.r(k,ac,Lb,Kb);p.r(k,Za,Lb,D("COLOR","u_average_lum",1,1,1,!1));var Rb=D("COLOR","u_color",1,.25,.25,!0);Rb.Na=B.K;Rb.Ma=B.K;Ac=J.PG("X_BLUR");p.J(k,Ac);p.r(k,Lb,Ac,Rb);tc=J.PG("Y_BLUR");p.J(k,tc);p.r(k,
Ac,tc,Rb);var uc=J.xS(ra.blur);p.J(k,uc);var Jc=D("COLOR","u_bloom",1,.25,.25,!0);Jc.Na=B.K;Jc.Ma=B.K;p.r(k,tc,uc,Jc);p.r(k,cb,uc,D("COLOR","u_main",1,1,1,!0));n.push(uc);h=n;n=[]}if(Na&&Da&&!T){var cb=h[0],Ia=v.Ec(Sa,!0);b.ba.push(Ia);if(e.dof_bokeh){var fc=D("COLOR","u_color",1,1,1,!0);fc.Na=B.K;fc.Ma=B.K;var Db=D("DEPTH","u_depth",1,1,1,!0),Eb=D("COLOR","u_color",1,.5,.5,!0);Eb.Na=B.re;Eb.Ma=B.re;Rb=D("COLOR","u_color",1,.5,.5,!0);Rb.Na=B.re;Rb.Ma=B.re;var Cc=D("COLOR","u_blurred1",1,.5,.5,!0);
Cc.Na=B.K;Cc.Ma=B.K;var Sb=D("COLOR","u_blurred2",1,.5,.5,!0);Sb.Na=B.K;Sb.Ma=B.K;var ib=kc[0];if(e.Bd){var fb=v.Ec(Sa,!0);b.ba.push(fb);var Ja=J.Tz(fb,"COC_FOREGROUND");fb.dof_distance=e.dof_distance;fb.dof_object=e.dof_object;fb.dof_front_start=e.dof_front_start;fb.dof_front_end=e.dof_front_end;fb.dof_rear_start=e.dof_rear_start;fb.dof_rear_end=e.dof_rear_end;fb.dof_power=e.dof_power;fb.dof_bokeh=e.dof_bokeh;fb.dof_bokeh_intensity=e.dof_bokeh_intensity;fb.Bd=e.Bd;fb.dof_on=!0;p.J(k,Ja);p.r(k,cb,
Ja,fc);p.r(k,ib,Ja,Db);var Wb=J.zd("X_ALPHA_BLUR");p.J(k,Wb);p.r(k,Ja,Wb,Eb);var Fb=J.zd("Y_ALPHA_BLUR");p.J(k,Fb);p.r(k,Wb,Fb,Rb);var Pa=v.Ec(Sa,!0),Qa=J.Tz(Pa,"COC_COMBINE");b.ba.push(Pa);Pa.dof_distance=e.dof_distance;Pa.dof_object=e.dof_object;Pa.dof_front_start=e.dof_front_start;Pa.dof_front_end=e.dof_front_end;Pa.dof_rear_start=e.dof_rear_start;Pa.dof_rear_end=e.dof_rear_end;Pa.dof_power=e.dof_power;Pa.dof_bokeh=e.dof_bokeh;Pa.dof_bokeh_intensity=e.dof_bokeh_intensity;Pa.Bd=e.Bd;Pa.dof_on=!0;
p.J(k,Qa);p.r(k,cb,Qa,fc);p.r(k,ib,Qa,Db);p.r(k,Fb,Qa,D("COLOR","u_coc_fg",1,.5,.5,!0))}else Pa=v.Ec(Sa,!0),b.ba.push(Pa),Qa=J.Tz(Pa,"COC_ALL"),Pa.dof_distance=e.dof_distance,Pa.dof_object=e.dof_object,Pa.dof_front_start=e.dof_front_start,Pa.dof_front_end=e.dof_front_end,Pa.dof_rear_start=e.dof_rear_start,Pa.dof_rear_end=e.dof_rear_end,Pa.dof_power=e.dof_power,Pa.dof_bokeh=e.dof_bokeh,Pa.dof_bokeh_intensity=e.dof_bokeh_intensity,Pa.Bd=e.Bd,Pa.dof_on=!0,p.J(k,Qa),p.r(k,cb,Qa,fc),p.r(k,ib,Qa,Db);var lb=
J.zd("X_DOF_BLUR");lb.p.dof_bokeh_intensity=e.dof_bokeh_intensity;p.J(k,lb);p.r(k,Qa,lb,Eb);var Oc=J.zd("Y_DOF_BLUR");Oc.p.dof_bokeh_intensity=e.dof_bokeh_intensity;p.J(k,Oc);p.r(k,lb,Oc,Rb);var Kc=J.zd("Y_DOF_BLUR");Kc.p.dof_bokeh_intensity=e.dof_bokeh_intensity;p.J(k,Kc);p.r(k,lb,Kc,Rb);var ub=J.RG(Ia);Ia.dof_distance=e.dof_distance;Ia.dof_object=e.dof_object;Ia.dof_front_start=e.dof_front_start;Ia.dof_front_end=e.dof_front_end;Ia.dof_rear_start=e.dof_rear_start;Ia.dof_rear_end=e.dof_rear_end;Ia.dof_power=
e.dof_power;Ia.dof_bokeh=e.dof_bokeh;Ia.dof_bokeh_intensity=e.dof_bokeh_intensity;Ia.Bd=e.Bd;Ia.dof_on=!0;n.push(ub);p.J(k,ub);p.r(k,cb,ub,D("COLOR","u_sharp",1,1,1,!0));p.r(k,Oc,ub,Cc);p.r(k,Kc,ub,Sb)}else{var Dc=D("COLOR","u_color",1,1,1,!0);Dc.Na=B.K;Dc.Ma=B.K;var Tb=D("COLOR","u_color",1,1,1,!0);Tb.Na=B.K;Tb.Ma=B.K;lb=J.zd("X_BLUR");p.J(k,lb);p.r(k,cb,lb,Dc);var cc=J.zd("Y_BLUR");p.J(k,cc);p.r(k,lb,cc,Tb);var gd=kc[0],ub=J.RG(Ia);Ia.dof_distance=e.dof_distance;Ia.dof_object=e.dof_object;Ia.dof_front_start=
e.dof_front_start;Ia.dof_front_end=e.dof_front_end;Ia.dof_rear_start=e.dof_rear_start;Ia.dof_rear_end=e.dof_rear_end;Ia.dof_power=e.dof_power;Ia.dof_bokeh=e.dof_bokeh;Ia.dof_bokeh_intensity=e.dof_bokeh_intensity;Ia.Bd=e.Bd;Ia.dof_on=!0;n.push(ub);p.J(k,ub);p.r(k,cb,ub,D("COLOR","u_sharp",1,1,1,!0));p.r(k,cc,ub,D("COLOR","u_blurred",1,1,1,!0));p.r(k,gd,ub,D("DEPTH","u_depth",1,1,1,!0))}h=n;n=[]}if(a.qh){var Zc=l(J.Pf);n.push(Zc);h=n;n=[]}if(ka&&!T){var Sc=h[0],$c=J.GS(ta.mb_decay_threshold,ta.mb_factor);
n.push($c);p.J(k,$c);p.r(k,Sc,$c,D("COLOR","u_mb_tex_curr",1,1,1,!0));$c.Ya.push(D("COLOR","u_mb_tex_accum",1,1,1,!0));h=n;n=[]}if(!T&&a.outline){var cb=h[0],yb=v.Ec(Sa,!0);b.ba.push(yb);var zb=J.IS(yb,N);p.J(k,zb);var vc=J.zd("X_EXTEND"),hd=D("COLOR","u_color",1,1,1,!0),Xa=D("COLOR","u_outline_mask",1,1,1,!0);vc.gr=!0;p.J(k,vc);p.r(k,zb,vc,hd);var $a=D("COLOR","u_color",1,.5,.5,!0);$a.Na=B.K;$a.Ma=B.K;var Ec=J.zd("Y_EXTEND");Ec.gr=!0;p.J(k,Ec);p.r(k,vc,Ec,$a);lb=J.zd("X_BLUR");lb.gr=!0;p.J(k,lb);
p.r(k,Ec,lb,$a);var gc=D("COLOR","u_color",1,.25,.25,!0);gc.Na=B.K;gc.Ma=B.K;var Mb=D("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Mb.Na=B.K;Mb.Ma=B.K;cc=J.zd("Y_BLUR");cc.gr=!0;p.J(k,cc);p.r(k,lb,cc,gc);var wc=J.HS(Ra);p.J(k,wc);p.r(k,cb,wc,D("COLOR","u_outline_src",1,1,1,!0));p.r(k,zb,wc,Xa);p.r(k,cc,wc,Mb);n.push(wc);h=n;n=[]}m(k,Da);if((a.anaglyph_use||a.dv)&&!T){var yd=H(k,a,b,h[0]);n.push(yd);h=n;n=[]}if(va&&!T){var cb=h[0],Tc=J.yS(Ba.brightness,Ba.contrast,Ba.exposure,Ba.saturation);p.J(k,
Tc);p.r(k,cb,Tc,D("COLOR","u_color",1,1,1,!0));n.push(Tc);h=n;n=[]}if(ma){cb=h[0];if(Z.smaa){var xc=D("COLOR","u_color",1,1,1,!0);xc.Na=B.K;xc.Ma=B.K;var pc=J.Wz(J.jt,a);p.J(k,pc);p.r(k,cb,pc,xc);var Lc=J.Wz(J.qp,a);p.J(k,Lc);p.r(k,pc,Lc,xc);var Uc=D("COLOR","u_search_tex",1,1,1,!1),hc=D("COLOR","u_area_tex",1,1,1,!1);Uc.Na=B.K;Uc.Ma=B.K;hc.Na=B.K;hc.Ma=B.K;Lc.Ya.push(Uc);Lc.Ya.push(hc);var qc=J.Wz(J.kt,a);p.J(k,qc);p.r(k,cb,qc,xc);var Ub=D("COLOR","u_blend",1,1,1,!0);Ub.Na=B.K;Ub.Ma=B.K;p.r(k,Lc,
qc,Ub);n.push(qc)}else{var Mc=J.uS(a);p.J(k,Mc);var jd=D("COLOR","u_color",1,1,1,!0);jd.Na=B.K;jd.Ma=B.K;p.r(k,cb,Mc,jd);n.push(Mc)}h=n;n=[]}var yc=p.ah(k,h[0]);if(h[0].type==J.sh||h[0].type==J.Ym)var od=!0;else od=!1,p.fi(k,yc,function(a,b,c){if(c.from==c.to)return od=!0});if(od){var kd=J.zd("NONE");p.J(k,kd);p.r(k,h[0],kd,D("COLOR","u_color",1,1,1,!0));n.push(kd);h=n;n=[]}n.push(h[0]);sc&&(Qc?n.push(Qc):n.push(sc));Gc&&n.push(Gc);Oa=w.cu;if(a.Lw.GK){var ld=a.Lw,vd=a.Zo,pd=vd.xo,Oa=pd?pd.WY:Oa,ad=
J.MS(vd,N,ld,Oa);p.J(k,ad);n.push(ad)}var rc=J.SG();p.J(k,rc);for(qa=0;qa<n.length;qa++){var bd=n[qa];switch(bd.type){case J.pf:case J.ni:p.r(k,bd,rc,D("COLOR","NONE",1,1,1,!1));p.r(k,bd,rc,D("DEPTH","NONE",1,1,1,!1));break;case J.zg:p.r(k,bd,rc,D("CUBEMAP","u_sky",Oa,1,1,!1));break;case J.Rm:p.r(k,bd,rc,D("COLOR","NONE",1,1,1,!0));break;default:if(T){var qd=f[0],cd=D("COLOR","OFFSCREEN",1,1,1,!0);cd.jb=qd;p.r(k,n[qa],rc,cd);for(ha=1;ha<f.length;ha++){var rd=f[ha],Gb=J.zd("NONE");p.J(k,Gb);p.r(k,
n[qa],Gb,D("COLOR","SCALE",1,1,1,!0));var wd=rd.gj/qd.gj,cd=D("COLOR","OFFSCREEN",1,wd,wd,!0);cd.jb=rd;p.r(k,Gb,rc,cd)}}else p.r(k,n[qa],rc,D("SCREEN","NONE",1,1,1,!0))}}db&&!c(k,db).length&&(p.pg(k,p.ah(k,db)),p.yz(k));m(k,Da);d(k,Da);if(U.enabled){var Pc=g(k);Pc&&A(k,Pc)}t(k);y(k);Ca&&p.oa(k,function(a,b){if(b.type==J.tf||b.type==J.Lc||b.type==J.Pf){for(var c=0,d=F(k,b),e=0,f=0;f<d.length;f++){var g=d[f];g.type==J.cd&&(e++,b.pm=b.pm||[],b.pm[0<g.kh?g.kh:c]=g.p.wb,c++)}b.ix&&b.hx||(Z.Dv?b.LD=new Float32Array(9*
e):(b.ix=new Float32Array(4*e),b.hx=new Float32Array(4*e)))}});return k};a.tW=O;a.Id=function(a,b,c){var d=a.rg;a.rD[0]=b*a.Eb[0]*d;a.rD[1]=c*a.Eb[1]*d};a.Hc=function(a,b){a.rg=b};a.jS=function(){var a=p.create(),b=J.JS(),c=v.gd(v.pd);c.width=512;c.height=512;b.p=c;p.J(a,b);b.Ya.push(D("COLOR","u_color",512,1,1,!1));c=J.SG();p.J(a,c);p.r(a,b,c,D("COLOR","NONE",512,1,1,!1));t(a);y(a);return a};a.OT=function(a){var b=null;p.oa(a,function(a,c){return c.p&&null===c.p.Ve?(b=c,!0):!1});return b};a.Bb=function(a,
b,c){a=F(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.KA=function(a,b,c){a=F(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.k5=K;a.n5=M;a.KU=F;a.NU=c;a.ec=function(a,b){var c=null;p.oa(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.YS=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=l(a);p.oa(a,function(a,d){var e=
b+="    ",f=J.gD(d);if(d.p){for(var f=f+"\\n",g=0;g<c.length;g+=2){var l=d.p.pc;c[g]==l&&(f=B.Mn(l)?f+("CR"+c[g+1]+" "):f+("C"+c[g+1]+" "))}for(g=0;g<c.length;g+=2)l=d.p.Re,c[g]==l&&(f=B.Mn(l)?f+("DR"+c[g+1]):f+("D"+c[g+1]))}d.Ya.length&&(f+="\\n-----\\n");for(g=0;g<d.Ya.length;g++)f+=C(d.Ya[g],c);g=d.type==J.Zm?"dotted":d.Td?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(g+",bold")+'"];\n')});p.sg(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+C(e,
c)+'" style="'+(e.Dc?"solid":"dotted")+'"];\n'});return b+="}"};a.mS=function(a){a=p.ZY(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.Td&&b.push(d)}return b}};b4w.module.__textures=function(a,r){function m(){return{type:0,source:"",hs:"",width:0,height:0,kq:1,anisotropic_filtering:"",gj:1024,Hl:!1,Sf:null,mb:0,rb:null,Ie:null,cm:!1,Fs:-1,Sa:null,mx:"",ck:0,Rg:0,va:0,Sb:0,Qj:0,gg:!1,ih:1,td:null,$r:0,Zr:0,ej:-1,bs:!1,xk:-1,Ds:!1,ID:!1,oj:!1,Nk:!1,repeat:!0,cr:"",Gn:"",Hn:"",YA:"",XA:"",hv:!1,Vl:"",mz:"",gk:0}}function d(a,b,c){a.Hn=b.uuid;a.Gn=b.filepath;a.YA=b.source;a.XA=b.name;a.cr=ia.$i(c+b.filepath);if(a.hv=b.wh)a.Vl=b.vp;X.push(a)}function b(a,b,c){var d=
-1<b.indexOf(".dds"),e=-1<b.indexOf(".pvr");a.hv=d||e;a.Vl=d?"dds":e?"pvr":"";a.Gn=b;a.cr=c}function t(b,c){var d=m();d.type=b;d.source="NONE";if(b==a.ot||b==a.mt||b==a.pt||b==a.nt)d.Ie=L.createRenderbuffer();else{var e=L.TEXTURE_2D,f=L.createTexture();L.bindTexture(e,f);L.texParameteri(e,L.TEXTURE_MAG_FILTER,L.LINEAR);L.texParameteri(e,L.TEXTURE_MIN_FILTER,L.LINEAR);L.texParameteri(e,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE);L.texParameteri(e,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE);var g=N(d),l=H(d),k=O(d),h=
b==a.bl?null:new Uint8Array([204,204,204,255]);L.texImage2D(e,0,l,1,1,0,g,k,h);pa.iq&&c&&L.texParameterf(e,L.TEXTURE_COMPARE_MODE,L.COMPARE_REF_TO_TEXTURE);L.bindTexture(e,null);d.mb=e;d.rb=f}return d}function q(a){"CANVAS"!=a.source&&ia.q("Wrong texture");var b=a.mb;L.bindTexture(b,a.rb);var c=N(a),d=H(a),e=O(a),f=a.Sf.canvas;L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!0);L.texImage2D(b,0,d,c,e,f);L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!1);a.Hl&&L.generateMipmap(b);L.bindTexture(b,null);a.width=f.width;a.height=
f.height}function z(a){var b=a.mb;L.bindTexture(b,a.rb);L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Sa.length?a.gg?h(a,a.Sa,a.width*a.ih,a.height*a.ih,!1):L.texImage2D(b,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,a.Sa):L.texImage2D(b,0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,a.Sa);L.bindTexture(b,null)}function n(a){var b=a.mb;L.bindTexture(b,a.rb);L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!0);a.gg?h(a,a.td[a.ej],a.width*a.ih,a.height*a.ih,!1):L.texImage2D(b,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,a.td[a.ej]);L.bindTexture(b,
null)}function x(){oa||(oa=document.createElement("canvas"));return oa}function h(a,b,c,d,e){e||(f(L.TEXTURE_2D),L.texImage2D(L.TEXTURE_2D,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,b));L.bindTexture(L.TEXTURE_2D,null);u.mT(a,c,d,la,xa)}function k(a,b,c,d){for(var e=0;6>e;e++){var f=d[e],g=x();g.width=c;g.height=c;var l=g.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(l.translate(0,c),l.scale(1,-1)):(l.translate(c,0),l.scale(-1,1));l.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,c,c);L.texImage2D(L["TEXTURE_CUBE_MAP_"+
f[0]],0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,g)}}function f(a){la||(la=L.createFramebuffer());L.bindTexture(a,null);xa||(xa=L.createTexture());L.bindTexture(a,xa);L.texParameteri(a,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE);L.texParameteri(a,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE);L.texParameteri(a,L.TEXTURE_MAG_FILTER,L.LINEAR);L.texParameteri(a,L.TEXTURE_MIN_FILTER,L.LINEAR)}function y(a,b,c){var d=a.source,e=a.rb,l=a.mb,p=a.Vl,n=a.Gn,m=1,q=1;L.bindTexture(l,e);a.repeat?(L.texParameteri(l,L.TEXTURE_WRAP_S,L.REPEAT),
L.texParameteri(l,L.TEXTURE_WRAP_T,L.REPEAT)):(L.texParameteri(l,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(l,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE));if(4==b.length){var v=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==d)if(v)L.texImage2D(l,0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(p){q=w.MI(b,p);v=ia.Xp(q.width)||ia.Xp(q.height);if(q.width>S.Bc||q.height>S.Bc){I.error('Image "'+n+'" has unsupported size: '+q.width+"x"+q.height+". Max available: "+
S.Bc+"x"+S.Bc+".");return}m=q.width;q=q.height;if(v||"pvr"==p)a.gg=!0,f(l),m=A(m*a.ih),q=A(q*a.ih);"dds"==p?w.SZ(L,Q.uI(),b,!0):"pvr"==p&&w.TZ(L,Q.qI(),b);a.gg&&(h(a,null,m,q,!0),L.bindTexture(l,e),L.generateMipmap(l));a.width=m;a.height=q;a.kq=w.sU(b,p)}else{L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!0);a.cm?pa.as?(m=b[0].width,q=b[0].height):(m=b.videoWidth,q=b.videoHeight):(m=b.width,q=b.height);a.width=m;a.height=q;if(m>S.Bc||m>S.Bc)I.warn('Image "'+n+'" has unsupported size: '+m+"x"+q+". Max available: "+
S.Bc+"x"+S.Bc+". Reduced image size will be used."),a.ih=Math.min(S.Bc/m,S.Bc/q),a.gg=!0;a.cm&&(c in na||(na[c]={}),na[c][a.mx]=a,pa.as?(a.td=b,a.$r=b.length,a.Rg=a.Zr*a.ck/b.length,b=b[0]):(a.Sa=b,a.Sa.loop=a.oj,a.Rg=b.duration?a.ck/b.duration:Y.rd(),fa.lH||(b.playbackRate=Y.rd()/a.Rg,fa.oG&&2<b.playbackRate&&(b.playbackRate=2)),g(a)));m=A(a.width*a.ih);q=A(a.height*a.ih);a.gg?(n=x(),e=n.getContext("2d"),n.width=m,n.height=q,e.drawImage(b,0,0,a.width,a.height,0,0,m,q),L.texImage2D(l,0,L.RGBA,L.RGBA,
L.UNSIGNED_BYTE,n)):pa.cc||!ia.Xp(a.width)&&!ia.Xp(a.height)?L.texImage2D(l,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,b):(h(a,b,m,q,!1),a.gg=!0);e=a.rb;a.cm||(L.bindTexture(l,e),L.generateMipmap(l),L.bindTexture(l,null));a.width=m;a.height=q}else if("ENVIRONMENT_MAP"==d)if(m=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],v){for(n=0;6>n;n++)L.texImage2D(L["TEXTURE_CUBE_MAP_"+m[n][0]],0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,b);a.width=3;a.height=
2}else{L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){I.error('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}q=b.width/3;q>S.Si?(I.warn('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*S.Si+"x"+2*S.Si+". Reduced image size will be used."),n=A(S.Si/q*q),a.gg=!0):(n=A(q),!pa.cc&&(3*n>S.Bc||2*n>S.Bc)&&(a.gg=!0));if(a.gg||pa.yC)k(b,q,n,m);else{p=
b;e=n;f(L.TEXTURE_2D);L.texImage2D(L.TEXTURE_2D,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,p);L.bindTexture(L.TEXTURE_2D,null);for(p=0;6>p;p++)L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,L.RGBA,e,e,0,L.RGBA,L.UNSIGNED_BYTE,null);L.bindTexture(a.mb,null);L.bindFramebuffer(L.FRAMEBUFFER,la);for(p=0;6>p;p++)u.lT(a,L.TEXTURE_CUBE_MAP_POSITIVE_X+p,e,q,xa,p);L.bindFramebuffer(L.FRAMEBUFFER,null);L.bindTexture(a.mb,a.rb);L.texParameteri(a.mb,L.TEXTURE_MIN_FILTER,ea[pa.Lo]);L.texParameteri(a.mb,L.TEXTURE_MAG_FILTER,
L.LINEAR)}ga.sR()&&(I.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),k(b,q,U.zE,m));a.width=3*n;a.height=2*n;L.generateMipmap(l)}else"NODE_TEX"==d&&(L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,!1),L.texImage2D(l,0,L.RGBA,b.width,b.height,0,L.RGBA,L.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);L.bindTexture(l,null)}function g(a){a.Sa.r6=function(){z(a)}}function A(a){return ia.Xp(a)?ia.V(Math.pow(2,parseInt(a).toString(2).length),2,S.Bc):a}function N(b){var c;
switch(b.type){case a.th:c=L.RGBA;break;case a.qt:c=L.RGB;break;case a.sp:c=L.RGBA;break;case a.tp:c=L.RGB;break;case a.bl:c=L.DEPTH_COMPONENT;break;default:ia.q("Wrong texture type")}return c}function H(b){var c;switch(b.type){case a.th:c=pa.cc?L.RGBA8:L.RGBA;break;case a.qt:c=pa.cc?L.RGB8:L.RGB;break;case a.sp:c=pa.cc?L.RGBA8:L.RGBA;break;case a.tp:c=pa.cc?L.RGB8:L.RGB;break;case a.bl:c=pa.cc?pa.Xy?L.DEPTH_COMPONENT16:L.DEPTH_COMPONENT24:L.DEPTH_COMPONENT;break;default:ia.q("Wrong texture type")}return c}
function O(b){var c;switch(b.type){case a.th:c=L.UNSIGNED_BYTE;break;case a.qt:c=L.UNSIGNED_BYTE;break;case a.sp:c=L.FLOAT;break;case a.tp:c=L.FLOAT;break;case a.bl:c=pa.Xy?L.UNSIGNED_SHORT:L.UNSIGNED_INT;break;default:ia.q("Wrong texture type")}return c}function D(a){return a&&a.Ie?!0:!1}function P(a){a.Sa?a.Sa.play():a.td&&(a.bs=!0);a.Ds=!1}function K(a){a.Sa?a.Sa.pause():a.td&&(a.bs=!1);a.Ds=!0}function M(a){a.Sa?a.Sa.currentTime=a.Sb/a.Rg:a.td&&(a.ej=c(a,a.Sb),n(a))}function F(a){return a.Sa?
!a.Sa.paused:a.td?a.bs:!1}function c(a,b){return Math.round(b*a.$r/a.ck)}function l(a,b){if(aa.Ra(a))return C(a,b);for(var c=a.Iv,d=0;d<c.length;d++){var e=C(c[d],b);if(e)return e}return null}function C(a,b){var c=a.I;if(c.length)for(var c=c[0].U,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type||"SKY"==e.type)for(var f=0;f<e.ya.length;f++)if(e.Eg[f]==b)return e.ya[f]}return null}function v(a,b,c){a=a.I;if(a.length){a=a[0].U;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++)e.Eg[f]==
b&&(J(e.ya[f]),e.ya[f]=c,B(c))}}}function e(a,b){var c=a.I;if(c.length)for(var c=c[0].U,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++){var g=e.ya[f],l=e.Eg[f];-1==b.indexOf(l)&&"NODE_TEX"!=g.source&&b.push(l)}}}function R(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),g=p(d,f,!0),l=ba(d,f,!0);if(g&&l)if("CONSTANT"==a)c.push.apply(c,g.color);else{var k=c,h=g,n=l;h==n?k.push.apply(k,h.color):(k.push(ca.zv(n.color[0],n.position,h.color[0],
h.position,f)),k.push(ca.zv(n.color[1],n.position,h.color[1],h.position,f)),k.push(ca.zv(n.color[2],n.position,h.color[2],h.position,f)),k.push(ca.zv(n.color[3],n.position,h.color[3],h.position,f)))}l&&!g&&c.push.apply(c,l.color);g&&!l&&c.push.apply(c,g.color)}}function p(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function ba(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-
b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function J(a){0<a.gk&&--a.gk;0>=a.gk&&(a.rb&&L.deleteTexture(a.rb),a=X.indexOf(a),-1!=a&&X.splice(a,1))}function B(a){a.gk+=1}function V(a,b){for(var c=0;c<X.length;c++){var d=X[c];if(d.cr==a&&d.type==b.type&&d.repeat==b.repeat&&d.anisotropic_filtering==b.anisotropic_filtering&&d.Nk==b.Nk)return d}return null}var U=r("__compat"),Z=r("__config"),w=r("__texcomp"),ga=r("__debug"),Q=r("__extensions"),I=r("__print"),Y=r("__time"),ia=r("__util"),
u=r("__renderer"),aa=r("__obj_util"),ca=r("__curve"),ja=r("__vec3"),wa=r("__scenes"),pa=Z.A,S=Z.zi,fa=Z.W,oa=null,xa=null,la=null;a.re=0;a.K=0;a.wP=0;a.uP=0;a.vP=0;a.tP=0;a.th=10;a.qt=20;a.sp=30;a.tp=40;a.bl=50;a.ot=60;a.mt=70;a.pt=80;a.nt=90;a.cE=128;a.wN=128;a.IE=128;var X=[],ya={},na={},L=null,ea;a.If=function(b){ea=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.re=b.NEAREST;a.K=b.LINEAR;a.wP=b.NEAREST_MIPMAP_NEAREST;a.uP=b.LINEAR_MIPMAP_NEAREST;
a.vP=b.NEAREST_MIPMAP_LINEAR;a.tP=b.LINEAR_MIPMAP_LINEAR;L=b};a.C3=function(a,b){return b in ya&&a in ya[b]?ya[b][a].Sf:null};a.K8=function(a,b){return b in ya&&a in ya[b]?(q(ya[b][a]),!0):!1};a.oF=d;a.zl=t;a.EG=function(b){var c=L.createTexture(),d=L.TEXTURE_CUBE_MAP;L.bindTexture(d,c);L.texParameteri(d,L.TEXTURE_MAG_FILTER,L.LINEAR);L.texParameteri(d,L.TEXTURE_MIN_FILTER,L.LINEAR);L.texParameteri(d,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE);L.texParameteri(d,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE);for(var e="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
f=0;6>f;f++)L.texImage2D(L[e[f]],0,L.RGBA,b,b,0,L.RGBA,L.UNSIGNED_BYTE,null);L.bindTexture(d,null);d=m();d.type=a.th;d.source="NONE";d.width=3*b;d.height=2*b;d.kq=1;d.rb=c;d.mb=L.TEXTURE_CUBE_MAP;return d};a.JC=function(a,b,c){if(!D(a)){var d=a.mb;L.bindTexture(d,a.rb);b&&L.texParameteri(d,L.TEXTURE_MIN_FILTER,b);c&&L.texParameteri(d,L.TEXTURE_MAG_FILTER,c);L.bindTexture(d,null)}};a.T3=function(b){if(D(b))return{min:a.re,cW:a.re};var c=b.mb;L.bindTexture(c,b.rb);b=L.getTexParameter(c,L.TEXTURE_MIN_FILTER);
var d=L.getTexParameter(c,L.TEXTURE_MAG_FILTER);L.bindTexture(c,null);return{min:b,cW:d}};a.resize=function(b,c,d){c=Math.max(c,pa.Dq?2:1);d=Math.max(d,pa.Dq?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.ot:L.bindRenderbuffer(L.RENDERBUFFER,b.Ie);L.renderbufferStorage(L.RENDERBUFFER,L.RGB565,c,d);L.bindRenderbuffer(L.RENDERBUFFER,null);break;case a.mt:L.bindRenderbuffer(L.RENDERBUFFER,b.Ie);L.renderbufferStorage(L.RENDERBUFFER,L.DEPTH_COMPONENT16,c,d);L.bindRenderbuffer(L.RENDERBUFFER,null);
break;case a.pt:L.bindRenderbuffer(L.RENDERBUFFER,b.Ie);L.renderbufferStorageMultisample(L.RENDERBUFFER,pa.Cc,L.RGBA8,c,d);L.bindRenderbuffer(L.RENDERBUFFER,null);break;case a.nt:L.bindRenderbuffer(L.RENDERBUFFER,b.Ie);L.renderbufferStorageMultisample(L.RENDERBUFFER,pa.Cc,L.DEPTH_COMPONENT24,c,d);L.bindRenderbuffer(L.RENDERBUFFER,null);break;default:var e=b.mb;L.bindTexture(e,b.rb);var f=N(b),g=H(b),l=O(b);L.texImage2D(e,0,g,c,d,0,f,l,null);L.bindTexture(e,null)}c>S.Bc||d>S.Bc?ia.q('Slink texture "'+
b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+S.Bc+"x"+S.Bc+"."):(b.width=c,b.height=d)}};a.QS=function(b,c,e,f,g){var l=b.type,k=b.image,h=m();h.mz=b.uuid;h.type=a.th;h.width=1;h.height=1;var p=b.b4w_anisotropic_filtering;"DEFAULT"===p&&(p=c);"OFF"!==p&&pa.anisotropic_filtering&&Q.QH()&&(p=parseFloat(p.split("x")[0]),h.anisotropic_filtering=p);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)h.repeat=!1;if(k&&("IMAGE"==l&&"MOVIE"==k.source&&(h.cm=!0,h.mx=b.name,h.va=b.frame_start,h.Sb=
b.frame_offset,h.Qj=b.frame_duration,h.ID=b.use_auto_refresh,h.oj=b.use_cyclic,h.ck=b.movie_length,h.Nk=b.b4w_nla_video,0!=h.Sb&&I.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),c=ia.$i(g+k.filepath),c=V(c,h))){b.s=c;return}c=new Uint8Array([204,204,204,255]);switch(l){case "IMAGE":var p=L.createTexture(),n=L.TEXTURE_2D;L.bindTexture(n,p);L.texImage2D(n,0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,c);break;case "NONE":p=L.createTexture();
n=L.TEXTURE_2D;L.bindTexture(n,p);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(e=ia.Cd("name",b.b4w_source_id,e)))h.gj=b.b4w_source_size,e.Qf=e.Qf||[],e.Qf.push(h),B(h),L.texImage2D(n,0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,c);else return;break;case "ENVIRONMENT_MAP":p=L.createTexture();n=L.TEXTURE_CUBE_MAP;L.bindTexture(n,p);e="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var u=0;6>u;u++)L.texImage2D(L["TEXTURE_CUBE_MAP_"+
e[u]],0,L.RGBA,1,1,0,L.RGBA,L.UNSIGNED_BYTE,c);break;case "BLEND":return;default:I.error('texture "'+b.name+'" has unsupported type "'+l+'"');return}h.rb=p;h.mb=n;h.anisotropic_filtering&&L.texParameterf(h.mb,Q.QH().TEXTURE_MAX_ANISOTROPY_EXT,h.anisotropic_filtering);"NONE"==l&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==l&&"MOVIE"==k.source?L.texParameteri(n,L.TEXTURE_MIN_FILTER,L.LINEAR):L.texParameteri(n,L.TEXTURE_MIN_FILTER,ea[pa.Lo]);L.texParameteri(n,L.TEXTURE_MAG_FILTER,
L.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==l?(l=b.b4w_source_id,e=b.b4w_source_size,h.Hl=b.b4w_enable_canvas_mipmapping,h.hs=l,h.source="CANVAS",c=document.createElement("canvas"),c.width=e,c.height=e,h.Sf=c.getContext("2d"),f in ya||(ya[f]={}),ya[f][l]=h,q(h)):"SCENE"==b.b4w_source_type&&"NONE"==l?(h.hs=b.b4w_source_id,h.source="SCENE"):(h.source=l,L.generateMipmap(n),L.bindTexture(n,null));k&&d(h,k,g);b.s=h};a.QM=z;a.PM=n;a.ss=y;a.YQ=A;a.On=function(a){return a&&(a.rb||a.Ie)?!0:!1};a.Mn=D;a.G5=
function(b){return b.type==a.sp||b.type==a.tp?!0:!1};a.SU=function(b){var c=0;switch(b.type){case a.th:case a.qt:c=4;break;case a.sp:case a.tp:c=16;break;case a.bl:c=3;break;case a.ot:case a.mt:c=2;break;case a.pt:c=4*pa.Cc;break;case a.nt:c=3*pa.Cc}return c};a.sa=function(){if(!pa.as)for(var a in na)for(var b in na[a])na[a][b].Sa.pause(),na[a][b].Sa.src="",na[a][b].Sa.load();X.length=0;ya={};na={}};a.pause=function(){for(var a in na)for(var b in na[a]){var c=na[a][b];F(c)&&K(c)}};a.reset=function(){for(var a in na)for(var b in na[a])M(na[a][b])};
a.play=function(a){for(var b in na)for(var c in na[b]){var d=na[b][c];a&&!d.Ds||P(d)}};a.X4=function(a,b){return b in na&&a in na[b]?na[b][a]:null};a.T8=function(a){return a.Nk};a.mK=P;a.$B=K;a.KK=M;a.LX=function(a,b){if(void 0 in na&&a in na[void 0]){var c=na[void 0][a];c.Sa?c.Sa.currentTime=b/c.Rg:c.td&&(c.ej=b,n(c))}};a.lN=F;a.mN=function(a){return a.Sa||a.td?a.Sa?2<=a.Sa.readyState:!0:0};a.iN=function(a){return a.Sa||a.td?a.Sa?Math.round(a.Sa.currentTime*a.Rg):a.ej:0};a.kN=function(a){return a.Sa||
a.td?a.Sa?a.Sb:c(a,a.Sb):0};a.g_=function(a){if(!a.Sa&&!a.td)return 0;var b=Math.min(a.Qj,a.ck-a.Sb);return a.Sa?a.Sb+b:c(a,a.Sb+b)};a.tw=function(a,b){return Math.round(b*a.Zr*(Y.rd()/a.Rg))};a.jN=function(a){return Math.min(a.Qj,a.ck-a.Sb)};a.f_=c;a.D3=function(a,b){var c=l(a,b);return c&&"CANVAS"==c.source?c.Sf:null};a.L8=function(a,b){var c=l(a,b);return c&&"CANVAS"==c.source?(q(c),!0):!1};a.J4=l;a.K4=function(a){var b=[];if(aa.Ra(a))e(a,b);else{a=a.Iv;for(var c=0;c<a.length;c++)e(a[c],b)}return b};
a.oY=function(a){for(var b={},c=0;c<a.length;c++){for(var d=a[c].ya,e=a[c].Kd,f=[],g=[],l=0;l<d.length;l++){var k=d[l],h=e[l];if("CANVAS"==k.source)if(h in b)k=b[h];else{var p=d[l],k=m();k.source="CANVAS";k.width=p.width;k.height=p.height;k.Hl=p.Hl;k.type=p.type;p=document.createElement("canvas");p.width=k.width;p.height=k.height;k.Sf=p.getContext("2d");k.mb=L.TEXTURE_2D;k.rb=L.createTexture();L.bindTexture(L.TEXTURE_2D,k.rb);k.Hl?L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MIN_FILTER,ea[pa.Lo]):L.texParameteri(L.TEXTURE_2D,
L.TEXTURE_MIN_FILTER,L.LINEAR);L.texParameteri(L.TEXTURE_2D,L.TEXTURE_MAG_FILTER,L.LINEAR);L.bindTexture(L.TEXTURE_2D,null);p=k;p.Sf.drawImage(d[l].Sf.canvas,0,0);q(p);b[h]=k}f.push(k);g.push(h)}a[c].ya=f}};a.BT=function(a,b){for(var c=[],d=0;d<a.length;d++)R(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ia.V(255*a,0,255)}))};a.TQ=R;a.FT=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var g=a[f].data.value,l=[],k=g.curve_mapping.curves_data,
h=g.curve_mapping.curve_extend,n=g.curve_mapping.curves_handle_types,g=0;g<k.length;g++){for(var u=h[g],m=k[g],w=[],q=n[g],v=0;v<m.length;v++)w.push([new Float32Array(3),new Float32Array(m[v].concat(0)),new Float32Array(3)]);ca.rz(w[0],null,w[1],q[0],q[0]);for(v=1;v<w.length-1;v++)ca.rz(w[v],w[v-1],w[v+1],q[v],q[v]);ca.rz(w[w.length-1],w[w.length-2],null,q[w.length-1],q[w.length-1]);if(2<w.length){if("AUTO"==q[0]){ja.subtract(w[0][2],w[0][1],c);v=ja.length(c);ja.copy(w[1][0],d);d[0]<w[0][1][0]&&(d[0]=
w[0][1][0]);ja.subtract(d,w[0][1],d);var C=ja.length(d);1E-8<C&&(ja.scale(d,v/C,d),ja.add(w[0][1],d,w[0][2]),ja.subtract(w[0][1],d,w[0][0]))}m=w.length-1;"AUTO"==q[0]&&(ja.subtract(w[m][0],w[m][1],c),v=ja.length(c),ja.copy(w[m-1][2],d),d[0]>w[m][1][0]&&(d[0]=w[m][1][0]),ja.subtract(d,w[m][1],d),C=ja.length(d),1E-8<C&&(ja.scale(d,v/C,d),ja.add(w[m][1],d,w[m][0]),ja.subtract(w[m][1],d,w[m][2])))}for(m=0;m<w.length-1;m++)ca.NR(w[m][1],w[m][2],w[m+1][0],w[m+1][1]);m=[];3>=k.length?(v=Math.round(-b/2),
q=Math.round(b/2)):(v=0,q=b);for(;v<q;v++){var C=v/(q-1),x=p(w,C,!1),y=ba(w,C,!1);x&&y?m.push(ca.JF(C,x[1],x[2],y[0],y[1],.001)):y&&!x?"EXTRAPOLATED"==u?(C=y[1][0]==y[2][0]?y[1][1]:ca.AJ(C,y[1],y[2]),m.push(C)):m.push(y[1][1]):x&&!y&&("EXTRAPOLATED"==u?(C=x[0][0]==x[1][0]?x[1][1]:ca.AJ(C,x[0],x[1]),m.push(C)):m.push(x[1][1]))}l.push(m)}e.push(l)}c=[];for(v=0;v<e.length;v++)for(l=e[v],g=0;g<l[0].length;g++)3>=l.length?(d=ia.V(127.5*(l[0][g]+1),0,255),f=ia.V(127.5*(l[1][g]+1),0,255),k=ia.V(127.5*(l[2][g]+
1),0,255),m=255):(d=ia.V(255*l[0][g],0,255),f=ia.V(255*l[1][g],0,255),k=ia.V(255*l[2][g],0,255),m=ia.V(255*l[3][g],0,255)),c.push(d,f,k,m);return new Uint8Array(c)};a.DG=function(b,c){var d=t(a.th,!1);d.source="NODE_TEX";d.repeat=!1;y(d,{width:c,height:b.length/(4*c),data:b});return d};a.O1=function(a,c,d,e,f){var g=ia.$i(f);if("WORLD"!=a.type){var l=V(g,c);if(!l){l=m();l.type=c.type;l.source=c.source;l.hs=c.hs;l.width=c.width;l.height=c.height;l.kq=c.kq;l.gj=c.gj;l.Hl=c.Hl;l.Sf=c.Sf;l.mb=c.mb;l.rb=
c.rb;l.Ie=c.Ie;l.cm=c.cm;l.Fs=c.Fs;l.Sa=c.Sa;l.mx=c.mx;l.ck=c.ck;l.Rg=c.Rg;l.va=c.va;l.Sb=c.Sb;l.Qj=c.Qj;l.gg=c.gg;l.ih=c.ih;l.td=c.td;l.$r=c.$r;l.Zr=c.Zr;l.ej=c.ej;l.bs=c.bs;l.xk=c.xk;l.Ds=c.Ds;l.ID=c.ID;l.oj=c.oj;l.Nk=c.Nk;l.repeat=c.repeat;l.Gn=c.Gn;l.cr=c.cr;l.Hn=c.Hn;l.YA=c.YA;l.XA=c.XA;l.hv=c.hv;l.Vl=c.Vl;var k=l;L.bindTexture(c.mb,c.rb);var h=L.getTexParameter(c.mb,L.TEXTURE_MAG_FILTER),p=L.getTexParameter(c.mb,L.TEXTURE_MIN_FILTER),n=L.getTexParameter(c.mb,L.TEXTURE_WRAP_S);c=L.getTexParameter(c.mb,
L.TEXTURE_WRAP_T);k.rb=L.createTexture();L.bindTexture(k.mb,k.rb);L.texParameteri(k.mb,L.TEXTURE_MAG_FILTER,h);L.texParameteri(k.mb,L.TEXTURE_MIN_FILTER,p);L.texParameteri(k.mb,L.TEXTURE_WRAP_S,n);L.texParameteri(k.mb,L.TEXTURE_WRAP_T,c);L.bindTexture(k.mb,null);b(l,f,g);X.push(l);y(l,e,0)}e=l;if(aa.Ra(a))v(a,d,e);else for(a=a.Iv,f=0;f<a.length;f++)v(a[f],d,e)}else l=c,b(l,f),y(l,e,0),wa.OZ(a)};a.pC=J;a.iv=B;a.fe=function(a){return a.texture.s};a.pX=function(){L=null};a.hI=function(){return X}};b4w.module.__texcomp=function(a,r){function m(a,b,d,g){var m=new Int32Array(d,0,31),r,z,O,D,P,K;if(542327876!=m[0])return q.error("Invalid magic number in DDS header"),0;if(!m[20]&4)return q.error("Unsupported format, must contain a FourCC code"),0;r=m[21];switch(r){case n:z=8;O=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case x:z=16;O=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case h:z=16;O=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return q.error("Unsupported FourCC code:",t(r)),null}K=
1;m[2]&131072&&!1!==g&&(K=Math.max(1,m[7]));D=m[4];P=m[3];m=m[1]+4;if(b)for(r=0;r<K;++r)g=Math.max(4,D)/4*Math.max(4,P)/4*z,b=new Uint8Array(d,m,g),a.compressedTexImage2D(a.TEXTURE_2D,r,O,D,P,0,b),m+=g,D=Math.max(.5*D,1),P=Math.max(.5*P,1);else if(r==n){Math.max(4,D);Math.max(4,P);d=b=new Uint16Array(d);z=m/2;O=D;var M=P,m=new Uint16Array(4);b=new Uint16Array(O*M);for(var F=0,c=0,l=c=F=r=0,C=0,v=0,e=0,R=O/4,M=M/4,p=0;p<M;p++)for(var ba=0;ba<R;ba++)r=z+4*(p*R+ba),m[0]=d[r],m[1]=d[r+1],F=m[0]&31,c=
m[0]&2016,l=m[0]&63488,C=m[1]&31,v=m[1]&2016,e=m[1]&63488,m[2]=5*F+3*C>>3|5*c+3*v>>3&2016|5*l+3*e>>3&63488,m[3]=5*C+3*F>>3|5*v+3*c>>3&2016|5*e+3*l>>3&63488,F=d[r+2],c=4*p*O+4*ba,b[c]=m[F&3],b[c+1]=m[F>>2&3],b[c+2]=m[F>>4&3],b[c+3]=m[F>>6&3],c+=O,b[c]=m[F>>8&3],b[c+1]=m[F>>10&3],b[c+2]=m[F>>12&3],b[c+3]=m[F>>14],F=d[r+3],c+=O,b[c]=m[F&3],b[c+1]=m[F>>2&3],b[c+2]=m[F>>4&3],b[c+3]=m[F>>6&3],c+=O,b[c]=m[F>>8&3],b[c+1]=m[F>>10&3],b[c+2]=m[F>>12&3],b[c+3]=m[F>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,D,P,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);g&&a.generateMipmap(a.TEXTURE_2D)}else return q.error("No manual decoder for",t(r),"and no native support"),0;return K}function d(a,b,d,g,h){var n=new XMLHttpRequest;n.open("GET",d,!0);n.responseType="arraybuffer";n.onload=function(){if(200==n.status){a.bindTexture(a.TEXTURE_2D,g);var d=m(a,b,n.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<d?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}h&&h(g)};n.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function t(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var q=r("__print"),z=r("__util"),n=b("DXT1"),x=b("DXT3"),h=b("DXT5");a.SZ=m;a.TZ=function(a,b,d){var g=new Uint32Array(d,0,13);if(55727696==g[0]){var h=g[7],n=g[6],m=g[11],q=52+g[12];switch(g[2]){case 0:var x=2,t=1;break;case 1:x=2;t=3;break;case 2:x=4;t=0;break;case 3:x=4;t=2;break;default:z.q("Unsupported PVR V3 format.")}}else if(559044176==
g[11]){h=g[2];n=g[1];m=g[3];q=g[0];m++;var r=g[4]&255,g=0<g[10];25==r?(x=4,t=g?2:0):24==r?(x=2,t=g?3:1):z.q("Unsupported PVR V2 format.")}else z.q("Unsupported PVR version.");r=2==x?8:4;g=4;switch(t){case 0:var M=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:M=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:M=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:M=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=r*g*x/8;for(x=0;x<m;x++){var t=Math.max(h>>x,1),F=Math.max(n>>x,1),c=t/r,l=F/g;2>c&&(c=2);2>l&&(l=2);c=
c*l*b;l=new Uint8Array(d,q,c);a.compressedTexImage2D(a.TEXTURE_2D,x,M,t,F,0,l);q+=c}};a.MI=function(a,b){switch(b){case "dds":var d=new Int32Array(a,0,31);return{width:d[4],height:d[3]};case "pvr":d=new Uint32Array(a,0,13);if(55727696==d[0])var g=d[7],d=d[6];else g=d[2],d=d[1];return{width:g,height:d}}};a.sU=function(a,b){var d=1;if("dds"==b){var g=new Int32Array(a,0,31),m=g[21];switch(m){case n:d=6;break;case x:case h:d=4;break;default:q.error("Unsupported FourCC code:",t(m))}}else if("pvr"==b)if(g=
new Uint32Array(a,0,13),55727696==g[0])switch(g[2]){case 0:d=12;break;case 1:d=16;break;case 2:d=6;break;case 3:d=8}else m=g[4]&255,g=0<g[10],25==m?d=g?8:6:24==m&&(d=g?16:12);return d};a.X5=function(a,b,h,g){var n=a.createTexture();d(a,b,h,n,g);return n}};b4w.module.__curve=function(a,r){function m(a,b,d,f,n){var g=f.length;n||(n=new Float32Array(g));for(var m=g+a,q=new Float32Array(m),t=1;t<=m-1;t++)q[t-1]=b>=d[t-1]&&b<d[t+1-1]?1:0;for(var r=2;r<=a;r++)for(t=1;t<=m-r;t++)q[t-1]=(0!=q[t-1]?(b-d[t-1])*q[t-1]/(d[t+r-1-1]-d[t-1]):0)+(0!=q[t+1-1]?(d[t+r-1]-b)*q[t+1-1]/(d[t+r-1]-d[t+1-1]):0);b==d[m-1]&&(q[g-1]=1);a=0;for(t=1;t<=g;t++)a+=q[t-1]*f[t-1];for(t=1;t<=g;t++)n[t-1]=0!=a?q[t-1]*f[t-1]/a:0;return n}function d(a){a=a.xv;return a[a.length-1]}function b(a){a=
a.$G;return a[a.length-1]}function t(a,b,d,f,n,g,m,r){var z=a+(b-a)/2,O=q(z,f,n,g,m)-d;r=r?r:.01;return Math.abs(O)<r?z:0<O?t(a,z,d,f,n,g,m,r):t(z,b,d,f,n,g,m,r)}function q(a,b,d,f,n){var g=1-a;return b*g*g*g+3*d*g*g*a+3*f*g*a*a+n*a*a*a}r("__print");var z=r("__util"),n=r("__vec3");a.qS=function(a){var b={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var f=a.order_u;b.ik=f;a=a.points;var n=a.length/5,g=[],q=n+f,n=n+2;g[0]=0;for(var t=2;t<=q;t++)g[t-1]=t>f&&t<n?g[t-
2]+1:g[t-2];b.xv=g;"2D"==d.dimensions?b.Xj=!1:"3D"==d.dimensions?b.Xj=!0:z.q("Wrong curve dimensions");f=[];g=[];for(d=0;d<a.length;d+=5)f.push(a[d]),f.push(a[d+1]),f.push(a[d+2]),b.Xj&&f.push(a[d+3]),g.push(a[d+4]);b.Lz=f;b.TD=g;a=[];for(var d=b.Lz,f=b.Xj?4:3,g=b.TD,q=b.xv,n=b.ik,t=d.length/f,r=t+n,O=0,D=q[r-1]/999,P=0;1E3>P;P++){5E-6>q[r-1]-O&&(O=q[r-1]);for(var K=m(n,O,q,g),M=0;M<f;M++)for(var F=a[f*P+M]=0;F<t;F++)a[f*P+M]+=K[F]*d[f*F+M];O+=D}f=b.Xj?4:3;g=new Float32Array(1E3);g[0]=0;for(d=1;1E3>
d;d+=1)q=a[(d-1)*f],n=a[(d-1)*f+1],t=a[(d-1)*f+2],r=a[d*f],O=a[d*f+1],D=a[d*f+2],g[d]=g[d-1]+Math.sqrt((r-q)*(r-q)+(O-n)*(O-n)+(D-t)*(D-t));b.$G=g;return b};a.GY=function(a,b,k){k||(k=[]);var f=b,n=Math.max(f,0);b=n=Math.min(f,d(a));var f=a.Lz,n=a.Xj?4:3,g=a.TD,q=a.xv,t=a.ik;a=f.length/n;var r=a+t;5E-6>q[r-1]-b&&(b=q[r-1]);r=new Float32Array(a);m(t,b,q,g,r);for(b=0;b<n;b++)for(g=k[b]=0;g<a;g++)k[b]+=r[g]*f[n*g+b]};a.DY=function(a,b,d){d||(d=[]);var f=a.Lz,n=a.Xj?4:3,g=a.TD,m=a.xv,q=a.ik;a=f.length/
n;var t=a+q;5E-6>m[t-1]-b&&(b=m[t-1]);var t=new Float32Array(a),r=b;b=t;var z=g.length;b||(b=new Float32Array(z));var P=new Float32Array(z),K=new Float32Array(z),M=P,F=K;M||(M=new Float32Array(z));F||(F=new Float32Array(z));for(var c=z+q,l=new Float32Array(c),C=new Float32Array(c),v=1;v<=c-1;v++)l[v-1]=r>=m[v-1]&&r<m[v+1-1]?1:0;r==m[c-1]&&(l[z-1]=1);for(var e=2;e<=q;e++)for(v=1;v<=c-e;v++){var R=0!=l[v-1]?l[v-1]/(m[v+e-1-1]-m[v-1]):0,p=0!=l[v+1-1]?-l[v+1-1]/(m[v+e-1]-m[v+1-1]):0,ba=0!=C[v-1]?(r-m[v-
1])*C[v-1]/(m[v+e-1-1]-m[v-1]):0,J=0!=C[v+1-1]?(m[v+e-1]-r)*C[v+1-1]/(m[v+e-1]-m[v+1-1]):0;l[v-1]=(0!=l[v-1]?(r-m[v-1])*l[v-1]/(m[v+e-1-1]-m[v-1]):0)+(0!=l[v+1-1]?(m[v+e-1]-r)*l[v+1-1]/(m[v+e-1]-m[v+1-1]):0);C[v-1]=R+p+ba+J}for(v=1;v<=z;v++)M[v-1]=l[v-1],F[v-1]=C[v-1];m=0;for(q=1;q<=z;q++)m+=P[q-1]*g[q-1];r=0;for(q=1;q<=z;q++)r+=K[q-1]*g[q-1];for(q=1;q<=z;q++)b[q-1]=0!=m?K[q-1]*g[q-1]/m+P[q-1]*g[q-1]*r/(m*m):0;for(g=0;g<n;g++)for(m=d[g]=0;m<a;m++)d[g]+=t[m]*f[n*m+g]};a.Z7=d;a.FY=b;a.EY=function(a,
h){if(0>=h)return 0;var k=d(a);if(h>=b(a))return k;var f=a.$G,n=z.Et(f,h,0,f.length-1);return k*(n+(h-f[n])/(f[n+1]-f[n]))/1E3};a.zv=function(a,b,d,f,n){return d+(n-f)*(a-d)/(b-f)};a.AJ=function(a,b,d){var f=b[0];b=b[1];d=(d[1]-b)/(d[0]-f);return d*a+(b-d*f)};a.JF=function(a,b,d,f,n,g){return q(t(0,1,a,b[0],d[0],f[0],n[0],g),b[1],d[1],f[1],n[1])};a.rz=function(a,b,d,f,m){var g=new Float32Array(3),q=new Float32Array(3),t=new Float32Array(3),r=new Float32Array(3),z=new Float32Array(3),D=new Float32Array(3);
n.copy(a[1],q);null==b?(n.copy(d[1],t),g[0]=2*q[0]-t[0],g[1]=2*q[1]-t[1]):n.copy(b[1],g);null==d?(n.copy(b[1],g),t[0]=2*q[0]-g[0],t[1]=2*q[1]-g[1]):n.copy(d[1],t);n.subtract(q,g,r);n.subtract(t,q,z);b=n.length(r);d=n.length(z);0==b&&(b=1);0==d&&(d=1);if("AUTO"==f||"AUTO"==m)D[0]=z[0]/d+r[0]/b,D[1]=z[1]/d+r[1]/b,g=2.5614*n.length(D),0!=g&&("AUTO"==f&&n.scaleAndAdd(q,D,-(b/g),a[0]),"AUTO"==m&&n.scaleAndAdd(q,D,d/g,a[2]));"VECTOR"==f&&n.scaleAndAdd(q,r,-1/3,a[0]);"VECTOR"==m&&n.scaleAndAdd(q,z,1/3,a[2])};
a.NR=function(a,b,d,f){var n=[],g=[],m,q,t;n[0]=a[0]-b[0];n[1]=a[1]-b[1];g[0]=f[0]-d[0];g[1]=f[1]-d[1];t=f[0]-a[0];m=Math.abs(n[0]);q=Math.abs(g[0]);0!=m+q&&m+q>t&&(m=t/(m+q),b[0]=a[0]-m*n[0],b[1]=a[1]-m*n[1],d[0]=f[0]-m*g[0],d[1]=f[1]-m*g[1])}};b4w.module.__shaders=function(a,r){function m(a,b,c){var e=a.Ei;"string"==typeof c?(a=d(a,c))&&(c=a[1]):c=String(c);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=c;break}}function d(a,b){for(var c=a.Ei,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in V)){var d=g(p.shaders_path,a),e=g(p.shaders_path,b),d=N(d),e=N(e),f;for(f in e)d[f]=e[f];e=[];for(f in d)e.push([f,d[f]]);V[c]=e}return V[c]}function t(a,b){return a+b}function q(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(t,0)}function z(a,b){var c=y(a.type),d=y(b.type),e=a.kl,f=b.kl;return c>d?-1:c<d?1:e>f?-1:e<f?1:0}function n(a){if(e.cc){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ga}else b=Q;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],kl:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return h(a,Y,R.Gv)}function x(a,b,c){a=a.split(";").map(function(a){return(a=a.match(w))&&{type:a[2],kl:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return h(a,b,c)}function h(a,b,c){function d(){for(var c=0;n<a.length;){var e=a[n];if(3!=y(e.type))break;c+=f(e.type)*e.kl;n++}h=p+c;if(h>ca)return!1;k(b,p,c,0,3);return!0}function e(){for(var c=ca-h,d=c,g=c;n<a.length;){var l=a[n];if(2!=y(l.type))break;l=f(l.type)*l.kl;if(l<=d)d-=l;else if(l<=g)g-=l;else return!1;n++}g=c-g;k(b,h,c-d,0,2);k(b,ca-g,g,2,2);return!0}function g(){for(;n<a.length;){for(var d=a[n],d=f(d.type)*d.kl,e=-1,l=c+1,p=-1,h=0;4>h;h++){var m=I;
m[0]=0;m[1]=1;var u;u=b;for(var q=h,w=d,v=m;aa<u.length&&15===u[aa];)aa++;for(;0<ca&&15===u[ca];)ca--;if(ca-aa<w)u=!1;else{for(var q=1<<q,C=0,t=-1,x=u.length+1,r=!1,y=aa;y<=ca;y++)y<ca&&!(u[y]&q)?r||(C=y,r=!0):(r&&(r=y-C,r>=w&&r<x&&(x=r,t=C)),r=!1);0>t?u=!1:(v[0]=t,v[1]=x,u=!0)}u&&m[1]<l&&(p=m[0],l=m[1],e=h)}if(0>e)return!1;k(b,p,d,e,1);n++}return!0}if(!a.length)return!0;for(var l=0;l<c;l++)b[l]=0;ca=c;a.sort(z);var h=0,p=0,n=0;return function(){for(;n<a.length;){var c=a[n];if(4!=y(c.type))break;
p+=f(c.type)*c.kl;n++}if(p>ca)return!1;aa=p;k(b,0,p,0,4);return!0}()&&d()&&e()&&g()}function k(a,b,c,d,e){for(var f=0,g=0;g<e;g++)f|=1<<d+g;for(g=0;g<c;g++)a[b+g]|=f}function f(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function y(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=
1}return b}function g(a,b){var c=a+b;if(J[c])return J[c];if(B){var d=B[b];if(!d)return null;d=r("__gpp_parser").t6.parse(d)}else if(d=r("shader_texts")[b],!d)return null;return J[c]=d}function A(a,b){for(var c={},d=b.Ei||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.jg.length;f++)c["USE_NODE_"+b.jg[f].id]=["1"];e.cc?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=
["texture"],c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=e.iq?["sampler2DShadow"]:["sampler2D"];for(var g in c)c[g][0].constructor!=String&&C.warn("Warning! The value of a directive '"+g+"' is not of type string.");
return c}function N(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=g(p.shaders_path,p.GL+a.o),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var e=0;e<a.length;e++)c(a[e],b,d);else if(a instanceof Object&&a){b&&b(a);for(e in a)c(a[e],b,d);d&&d(a)}}var d={};c(a,b);return d}function H(a,b,c){function d(b){b=b.d;for(var c=0;c<b.length;c++){var e=b[c];switch(e.a){case "cond":a:for(var e=e.d,m=0;m<e.length;m++){var r=e[m];switch(r.a){case "if":case "elif":if(f(r.g)){d(r.h);break a}break;
case "else":d(r.h);break a;case "ifdef":r.c in w&&d(r.h);break;case "ifndef":r.c in w||d(r.h)}}break;case "include":e=e.o;m=g(p.shaders_path,p.GL+e);x.push("include/"+e);d(m);x.pop();break;case "var":break;case "define":w[e.c]=e.b;break;case "error":v.q("Shader error: #error "+e.b.join(" "));break;case "line":break;case "pragma":q.push("#pragma "+e.c+" "+e.b.join(" "));break;case "undef":delete w[e.c];break;case "warning":C.warn("Shader warning: #warning "+e.b.join(" "));break;case "extension":e=
n(e.b,w,t,!1);q.push("#extension "+e.join(" "));break;case "version":e=n(e.b,w,t,!1),q.push("#version "+e.join(" "));case "#":break;case "node":y[e.c]=e;break;case "nodes_global":e=u;for(m=0;m<e.length;m++){var r=e[m],B=y[r.id];if(B)for(var F=0,A=0;A<B.l.length;A++){var z=B.l[A];if("node_param"==z.a){var J;if("PARTICLE_INFO"==r.id&&z.e)if(1==w.PARTICLE_BATCH)switch(J=!1,F){case 0:J=M(r.Qb,"PART_INFO_IND")||M(r.Qb,"PART_INFO_AGE")||M(r.Qb,"PART_INFO_LT")||M(r.Qb,"PART_INFO_SIZE");break;case 1:J=M(r.Qb,
"PART_INFO_LOC");break;case 2:J=M(r.Qb,"PART_INFO_VEL");break;case 3:J=M(r.Qb,"PART_INFO_A_VEL");break;case 4:J=M(r.Qb,"PART_INFO_IND")}else J=!1;else J=!0;J&&(z=z.f.join(" ")+" ","vert"==a?z+=r.ii[F]:"frag"==a&&(z+=r.qb[F],null!==r.aw[F]&&(z+="="+r.aw[F])),z+=";",h(k(z)));F++}}}break;case "nodes_main":e=u;for(m=0;m<e.length;m++)if(r=e[m],B=y[r.id]){F={};H=D=R=0;A=B;z=r;J=A;for(var Q={},K=0;K<J.m.length;K++){var aa=J.m[K];Q[aa.c]=[aa.b.join("")]}J=Q;for(Q=0;Q<z.Qb.length;Q++)K=z.Qb[Q][0],K in J&&
(J[K]=[z.Qb[Q][1]]);for(Q=K=0;Q<A.l.length;Q++)aa=A.l[Q],"node_out"==aa.a&&(J["USE_OUT_"+aa.c]=[-1<I.indexOf(z.fb[K])|0],K++);A=J;z=r;J=B.l;Q=F;K=A;for(aa=0;aa<J.length;aa++){var N=J[aa];switch(N.a){case "node_in":var P=z.L[R];if(null!==z.aB[R]){if(("MATERIAL_BEGIN"==z.id&&3===R||!K.MATERIAL_EXT&&("MATERIAL_BEGIN"==z.id&&4===R||"MATERIAL_END"==z.id&&3===R||"MATERIAL_END"==z.id&&4===R||"MATERIAL_END"==z.id&&5===R)||"TEXTURE_COLOR"==z.id||"TEXTURE_NORMAL"==z.id)&&N.e){Q[N.c]=z.aB[R];R++;continue}var ca=
N.f.join(" ")+" ",ca=ca+(P+"="+z.aB[R]+";");h(k(ca))}Q[N.c]=P;R++;break;case "node_out":P=z.fb[D];if(!N.e||-1<I.indexOf(P))ca=N.f.join(" ")+" ",ca+=P+";",h(k(ca)),Q[N.c]=P;D++;break;case "node_param":"vert"==a?P=z.ii[H]:"frag"==a&&(P=z.qb[H]),Q[N.c]=P,H++}}q.push("{");l(r,B.j,F,A);q.push("}")}break;case "txt":h(e.b);break;default:v.q("Unknown element type: "+e.a)}}}function f(a,b){var c;c=n(a,w,t,!0,b);for(var d=[],e=0;e<c.length;e++)if(c[e]instanceof Object)switch(c[e].a){case "conditional_expr":var g=
d.pop(),l=d.pop();d.pop()?d.push(l):d.push(g);break;case "logical_or_expr":for(var l=d.pop(),k=0;k<c[e].i-1;k++)g=d.pop(),l=l||g;d.push(l);break;case "logical_and_expr":l=d.pop();for(k=0;k<c[e].i-1;k++)g=d.pop(),l=l&&g;d.push(l);break;case "logical_bitor_expr":l=d.pop();for(k=0;k<c[e].i-1;k++)l|=d.pop();d.push(l);break;case "logical_bitxor_expr":l=d.pop();for(k=0;k<c[e].i-1;k++)l^=d.pop();d.push(l);break;case "logical_bitand_expr":l=d.pop();for(k=0;k<c[e].i-1;k++)l&=d.pop();d.push(l);break;case "equal_expr":g=
d.pop();l=d.pop();d.push(l==g);break;case "non_equal_expr":g=d.pop();l=d.pop();d.push(l!=g);break;case "le_expr":g=d.pop();l=d.pop();d.push(l<=g);break;case "ge_expr":g=d.pop();l=d.pop();d.push(l>=g);break;case "l_expr":g=d.pop();l=d.pop();d.push(l<g);break;case "g_expr":g=d.pop();l=d.pop();d.push(l>g);break;case "left_shift_expr":l=d.pop();g=d.pop();d.push(l<<g);break;case "right_shift_expr":l=d.pop();g=d.pop();d.push(l>>g);break;case "add_expr":l=d.pop();g=d.pop();d.push(l+g);break;case "sub_expr":l=
d.pop();g=d.pop();d.push(l-g);break;case "mul_expr":l=d.pop();g=d.pop();d.push(l*g);break;case "div_expr":l=d.pop();g=d.pop();d.push(l/g);break;case "mod_expr":l=d.pop();g=d.pop();d.push(l%g);break;case "pre_inc_expr":case "post_inc_expr":g=d.pop();d.push(++g);break;case "pre_dec_expr":case "post_dec_expr":g=d.pop();d.push(--g);break;case "positive_expr":g=d.pop();d.push(+g);break;case "negative_expr":g=d.pop();d.push(-g);break;case "one_compl_expr":g=d.pop();d.push(~g);break;case "logic_negative_expr":g=
d.pop();d.push(!g);break;default:v.q("Unknown operation type: "+c[e].a)}else g=c[e],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(g)?(d.push(0),0!=g.indexOf("USE_NODE_")&&(l=x[x.length-1],l in r||(r[l]=[]),-1==r[l].indexOf(g)&&(r[l].push(g),C.error("Undefined directive '"+g+"' in shader '"+l+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[e]));1==d.length?c=d[0]:(v.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function l(a,b,c,d){for(var e=0;e<b.length;e++){var g=
b[e];switch(g.a){case "node_cond":a:for(var k=a,g=g.d,p=c,n=d,m=0;m<g.length;m++){var u=g[m];switch(u.a){case "node_if":case "node_elif":if(f(u.g,n)){l(k,u.j,p,n);break a}break;case "node_else":l(k,u.j,p,n);break a;case "node_ifdef":(u.c in w||u.c in n)&&l(k,u.j,p,n);break;case "node_ifndef":u.c in w||u.c in n||l(k,u.j,p,n)}}break;case "txt":k=[];for(p=0;p<g.b.length;p++)n=g.b[p],n in c?k.push(c[n]):k.push(n);h(k,d)}}}function k(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function h(b,c){var d=
b;e.cc||"frag"!=a||(d=d.join(" "),z&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),z=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),z=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=n(b,w,t,!1,c),q.push(d.join(" ")))}function n(a,b,c,d,e){var f=[];m(a,b,c,d,f,e);return f}function m(a,b,c,d,e,f){for(var g=0;g<a.length;g++){var l=a[g];if(f&&l in f)l=f[l];else if(l in b)l=b[l];else{e.push(l);continue}0==
l.length&&d?e.push(0):m(l,b,c,d,e,f)}}var u=c.jg,q=[],w=A(a,c),t={},x=[c[a]],r={},y={},I=[],B;for(B in u)for(var F in u[B].L)I.push(u[B].L[F]);var z=!1;d(b);var R=0,D=0,H=0;return q.join("\n")}function O(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function D(a){wa.deleteProgram(a.Wh);wa.deleteShader(a.rx);wa.deleteShader(a.yu);delete ba[a.VC]}function P(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return K(a);case 2:return"vec2("+K(a[0])+","+K(a[1])+")";case 3:return"vec3("+
K(a[0])+","+K(a[1])+","+K(a[2])+")";case 4:return"vec4("+K(a[0])+","+K(a[1])+","+K(a[2])+","+K(a[3])+")";case 9:return"mat3("+K(a[0])+","+K(a[1])+","+K(a[2])+","+K(a[3])+","+K(a[4])+","+K(a[5])+","+K(a[6])+","+K(a[7])+","+K(a[8])+")";case 16:return"mat4("+K(a[0])+","+K(a[1])+","+K(a[2])+","+K(a[3])+","+K(a[4])+","+K(a[5])+","+K(a[6])+","+K(a[7])+","+K(a[8])+","+K(a[9])+","+K(a[10])+","+K(a[11])+","+K(a[12])+","+K(a[13])+","+K(a[14])+","+K(a[15])+")";default:v.q("Wrong glsl value dimension")}}function K(a){return a%
1?String(a):String(a)+".0"}function M(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var F=r("__assets"),c=r("__config"),l=r("__debug"),C=r("__print"),v=r("__util"),e=c.A,R=c.zi,p=c.Ae,ba={},J={},B=null,V={},U="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.Py=0;a.CN=1;a.BN=2;a.FN=4;a.EN=8;a.DN=16;a.xN=32;var Z=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,w=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ga=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,Q=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
I=new Int16Array(2),Y=null,ia=null,u=null,aa=0,ca=0,ja=[],wa=null,pa=!1;a.If=function(a){wa=a};a.ga=m;a.wU=d;a.HX=function(a){a.Ei=v.Bh(b(a.tg,a.Te));m(a,"PRECISION",c.A.precision);"highp"==c.A.precision?m(a,"EPSILON",P(1E-6)):m(a,"EPSILON",P(1E-4));m(a,"CONSTANTS_HACK",e.UC|0);m(a,"SRGB",e.srgb_type);m(a,"COMPARED_MODE",e.iq|0)};a.Z4=function(a){return a.tg};a.W3=function(a){return a.Te};a.rU=function(a){var b=JSON.stringify(a.tg)+JSON.stringify(a.Te)+JSON.stringify(a.Ei)+JSON.stringify(a.jg),c=
ba[b];if(c)return c;var d=a.Te,f=g(p.shaders_path,a.tg),d=g(p.shaders_path,d);if(!f||!d)return null;var f=H("vert",f,a),d=H("frag",d,a),c=0,k=q(d,Z);a.rM=k;k>R.BB&&(c|=1);Y||(Y=new Uint32Array(R.Gv));ia||(ia=new Uint32Array(R.Fv));u||(u=new Uint32Array(R.vr));x(d,ia,R.Fv)||(c|=2);x(f,u,R.vr)||(c|=4);k=e.cc?(f.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(f.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.zF=k;k>R.CB&&(c|=8);n(d)||(c|=16);a.status=
c;if(0===a.status){var c=wa,h=O(c,f,c.VERTEX_SHADER),m=O(c,d,c.FRAGMENT_SHADER),k=c.createProgram();c.attachShader(k,h);c.attachShader(k,m);c.linkProgram(k);for(var h={rx:h,yu:m,Wh:k,attributes:{},Fm:{},Gr:v.Kj(),aC:v.Kj(),bC:{},yr:!0,Qv:!1,EM:v.Kj(),DM:v.Kj(),hb:v.Bh(a),VC:b,Tf:!0},w=c.getProgramParameter(k,c.ACTIVE_ATTRIBUTES),m=0;m<w;m++){var C=c.getActiveAttrib(k,m).name;h.attributes[C]=c.getAttribLocation(k,C)}w=c.getProgramParameter(k,c.ACTIVE_UNIFORMS);for(m=0;m<w;m++)C=c.getActiveUniform(k,
m).name.split("[0]").join(""),h.Fm[C]=c.getUniformLocation(k,C);ba[b]=c=h;k=!wa.getShaderParameter(c.yu,wa.COMPILE_STATUS);h=!wa.getShaderParameter(c.rx,wa.COMPILE_STATUS);m=!wa.getProgramParameter(c.Wh,wa.LINK_STATUS);k?l.HK(c.yu,b,d):h?l.HK(c.rx,b,f):m&&l.nX(c.Wh,b,f,d);if(k||h||m)a.status|=32,c=null}else c=null;return c};a.VV=function(){pa=!1;if(b4w.module_check("shader_texts"))pa=!0;else{for(var a=[],b=F.Cx,c=0;c<U.length;c++){var d=v.$i(p.shaders_path+U[c]);a.push({id:U[c],type:b,url:d})}b=function(a,
b){B||(B={});B[b]=a};a.length?F.Td(a,b,function(){pa=!0}):C.error("Shaders have not been found.")}};a.lG=function(){return pa};a.C2=function(){return ja};a.XH=function(){return ba};a.sa=function(){for(var a in ba)D(ba[a]);for(var b in J)delete J[b];for(var c in ja)delete ja[c];u=ia=Y=null;V={}};a.FR=D;a.D2=function(a){var b=a.Ei;C.log("Shader: "+a.tg+" "+a.Te+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)C.log("  "+b[a][0],b[a][1])};a.M=P;a.mG=function(a,b){return b in a.Fm?!0:!1};
a.reset=function(){wa=null}};b4w.module.__assets=function(a,r){function m(){return A.fJ()?r(A.Ae.It).data:null}function d(){var a={rt:null,JP:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.rt=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=m();b&&a.rt in b&&(a.status=200,b[a.rt]&&(a.response=a.JP(b[a.rt])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=M.lW)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.Is:t(e,"arraybuffer");break;case a.Sm:t(e,"json");break;case a.Cx:t(e,"text");break;case a.Ax:q(e);break;case a.Js:z(e);break;case a.Bx:n(e);break;case a.Ls:x(e);break;
case a.Ks:h(e);break;default:D.q("Wrong asset type: "+e.type)}}}function t(b,c){var e=b.url.split("?t=")[0];if(e in C)"json"==c?b.Yb(D.P(C[e]),b.id,b.type,b.url,b.Hb):b.Yb(C[e],b.id,b.type,b.url,b.Hb);else{var f=m(),g=f&&b.url in f?new d:new XMLHttpRequest,f=null;if("GET"==b.Yh)g.open("GET",b.url,!0);else if("POST"==b.Yh)switch(g.open("POST",b.url,!0),b.fo){case a.ZD:f="text/plain";break;case a.YD:f="application/json"}if(b.mk)for(var l in b.mk)"Content-Type"==l?f=b.mk[l]:g.setRequestHeader(l,b.mk[l]);
f&&g.setRequestHeader("Content-Type",f);"text"==c?(g.overrideMimeType("text/plain"),g.responseType="text"):"json"==c?(g.overrideMimeType("application/json"),g.responseType="text"):g.responseType=c;g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState){if(200==g.status||0==g.status){var a=g.response;if(a){if("json"==c&&"string"==typeof a)try{a=JSON.parse(a,b.CV)}catch(d){H.error(d+" (parsing JSON "+b.url+")");b.Yb(null,b.id,b.type,b.url,b.Hb);return}b.Ug&&(C[e]="json"==c?D.P(a):a);b.Yb(a,
b.id,b.type,b.url,b.Hb)}else H.error("empty responce when trying to get "+b.url),b.Yb(null,b.id,b.type,b.url,b.Hb)}else H.error(g.status+" when trying to get "+b.url),b.Yb(null,b.id,b.type,b.url,b.Hb);b.state=30}};g.addEventListener("progress",function(a){a.lengthComputable&&b.tK(a.loaded/a.total)},!1);g.send(b.sm)}}function q(a){var b=a.url.split("?t=")[0];if(b in R)a.Yb(R[b],a.id,a.type,a.url,a.Hb),a.state=30;else{"GET"!=a.Yh&&D.q("Unsupported request type for audio buffer");var c=(b=m())&&a.url in
b?new d:new XMLHttpRequest;c.open("GET",a.url,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(40!=a.state&&4==c.readyState)if(200==c.status||0==c.status){var b=c.response;b?O.bT(b,function(b){a.Yb(b,a.id,a.type,a.url,a.Hb);a.state=30;a.Ug&&(R[a.url.split("?t=")[0]]=b)},function(){a.Yb(null,a.id,a.type,a.url,a.Hb);H.error("failed to decode "+a.url);a.state=30}):(a.Yb(null,a.id,a.type,a.url,a.Hb),H.error("empty responce when trying to get "+a.url),a.state=30)}else a.Yb(null,a.id,
a.type,a.url,a.Hb),H.error(c.status+" when trying to get "+a.url),a.state=30};c.send(a.sm)}}function z(a){var b=a.url.split("?t=")[0];if(b in v)a.Yb(v[b],a.id,a.type,a.url,a.Hb),a.state=30;else{"GET"!=a.Yh&&D.q("Unsupported request type for image element");var c=document.createElement("img");K.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.Yb(c,a.id,a.type,a.url,a.Hb),a.state=30,a.Ug&&(v[a.url.split("?t=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(a.Yb(null,
a.id,a.type,a.url,a.Hb),H.error("could not load image: "+a.url),a.state=30)},!1);if((b=m())&&a.url in b)if(b[a.url]){var d=f(a.url);c.src="data:"+d+";base64,"+b[a.url]}else N.ir()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function n(a){var b=a.url.split("?t=")[0];if(b in e)a.Yb(e[b],a.id,a.type,a.url,a.Hb),a.state=30;else{"GET"!=a.Yh&&D.q("Unsupported request type for audio element");var c=document.createElement("audio");
K.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.Yb(c,a.id,a.type,a.url,a.Hb),a.state=30,a.Ug&&(e[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.Yb(null,a.id,a.type,a.url,a.Hb),H.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.Yb(null,a.id,a.type,a.url,a.Hb),H.error("could not load sound: "+a.url),a.state=30)},!1);if((b=m())&&a.url in b)if(b[a.url]){var d=
y(a.url);c.src="data:"+d+";base64,"+b[a.url];40!=a.state&&(a.Yb(c,a.id,a.type,a.url,a.Hb),a.state=30)}else N.ir()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,K.is_mobile_device&&c.load();K.FB&&(c.autoplay=!0,c.pause());setTimeout(function(){c.vY=1},5E3)}}function x(a){function b(){40!=a.state&&(a.Yb(null,a.id,a.type,a.url),H.error("could not load video: "+a.url,a.Hb),a.state=30)}var c=a.url.split("?t=")[0];
if(c in v)a.Yb(v[c],a.id,a.type,a.url,a.Hb),a.state=30;else{"GET"!=a.Yh&&D.q("Unsupported request type for video element");var d=document.createElement("video");d.muted=!0;K.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.Yb(d,a.id,a.type,a.url,a.Hb),a.state=30,a.Ug&&(v[a.url.split("?t=")[0]]=d))},!1);d.addEventListener("error",b,!1);if((c=m())&&a.url in c)if(c[a.url]){var e=g(a.url);d.src="data:"+e+";base64,"+
c[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.Yb(d,a.id,a.type,a.url,a.Hb);a.state=30},!1)}else N.ir()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),d.dispatchEvent(c);else d.src=a.url,K.is_mobile_device&&d.load();K.FB&&(d.autoplay=!0,d.pause());setTimeout(function(){d.vY=1},1E4)}}function h(b){function c(a){b.Yb(a,b.id,b.type,b.url,b.Hb);b.state=30;b.Ug&&(v[b.url.split("?t=")[0]]=a)}var e=b.url.split("?t=")[0];if(e in
v)b.Yb(v[e],b.id,b.type,b.url,b.Hb),b.state=30;else{"GET"!=b.Yh&&D.q("Unsupported request type for seq video element");var f=(e=m())&&b.url in e?new d:new XMLHttpRequest;if(null==b.fo&&null==b.sm)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.fo){case a.ZD:f.setRequestHeader("Content-type","text/plain");break;case a.YD:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?k(a,c):(b.Yb(null,b.id,b.type,b.url,b.Hb),H.error("empty responce when trying to get "+b.url),b.state=30)}else b.Yb(null,b.id,b.type,b.url,b.Hb),H.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.tK(a.loaded/a.total)},!1);f.send(b.sm)}}function k(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],QF:[],Rg:c[4]},g=20,l=0;l<e;l++){var k=c[g/4],h=new Blob([d.subarray(g+4,g+4+k)],
{type:"image/jpg"}),n=document.createElement("img");n.src=window.URL.createObjectURL(h);f.images.push(n);f.QF.push(h);g+=k+8-k%4}n.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.QF;b(f)}}function f(a){var b="image";switch(D.IA(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function y(a){var b="audio";switch(D.IA(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function g(a){var b="video";switch(D.IA(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var A=r("__config"),N=r("__compat"),H=r("__print"),O=r("__sfx"),D=r("__util"),P=r("__version"),K=A.A,M=A.Od;a.Is=10;a.Sm=20;a.Cx=30;a.Ax=40;a.Js=50;a.Bx=60;a.Ls=70;a.Ks=80;a.YD=a.Sm;a.ZD=a.Cx;var F=[],c=0,l={},C={},v={},e={},R={};a.Cm=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.I4=function(a){if(l[a])return l[a];var b=M.prevent_caching?a+P.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return l[a]=b;D.q("Error XHR: responce is empty, GET "+a)}else D.q("Error XHR: "+c.status+", GET "+a)};a.sa=function(){for(var a=0;a<F.length;a++)F[a].state=40;F=[];c=0;l={}};a.Td=function(a,d,e,f,g){for(var l=0;l<a.length;l++){var k=a[l],k={id:k.id,type:k.type,url:k.url,
Ug:k.Ug,Yh:k.Yh?k.Yh:"GET",fo:k.fo?k.fo:null,mk:k.mk?k.mk:null,sm:k.sm?k.sm:null,Hb:k.Hb?k.Hb:null,state:10,Yb:d||function(){},eK:e||function(){},tK:f||function(){},CV:g||null,fK:c};if(M.prevent_caching){var h=m();h&&k.url in h||(k.url+=P.timestamp())}F.push(k)}b(F);c++};a.update=function(){b(F);for(var a=F,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.fK===a[c].fK?30!==f.state&&(d=!1):(d&&(a[e-1].eK(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].eK(),a.splice(c))}};
a.tR=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.HR=function(){C={};v={};e={};R={}}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__data=function(a,r){function m(a,b){Va[b.id]=null;Aa[b.id]=null}function d(a,b,c,d){a instanceof ArrayBuffer&&(a=L.MI(a,d));d=a.width;a=a.height;sa.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(kb)&&c&&sa.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.Pg)||Ea.q("Nothing requested");la.Td([{id:d,type:la.Sm,url:d,Ug:b.Zj}],function(d,f,g,l){if(d){sa.log("%cLOAD METADATA","color: #616",l);f=Ea.bM(d.b4w_format_version);
switch(Ea.fN(f,ua.hm)){case -1:f[0]<ua.hm[0]?Ea.q("JSON version is too old relative to B4W engine: "+Ea.Sk(f)+", required: "+Ea.Sk(ua.hm)+". Reexport scene with the latest B4W addon to fix it."):sa.warn("JSON version is a bit old relative to B4W engine: "+Ea.Sk(f)+", required: "+Ea.Sk(ua.hm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ua.hm[0]?Ea.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
sa.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ua.uB=f;for(var k in d)a[k]=d[k];b.Lb&&(Ya=G.uu(a.scenes));(d=a.binaries[0].binfile)?b.MF=d:(ra.Kw(b,"load_binaries"),ra.Kw(b,"prepare_bindata"));ua.is_mobile_device||ra.Kw(b,"mobile_media_start");ua.antialiasing&&ua.smaa||ra.Kw(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Lb&&"PRIMARY"==k.type||
"ALL"==k.type)&&sa.zT(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Lb&&"PRIMARY"==k.type||"ALL"==k.type)&&sa.AT(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.Zj&&D(a);e(b,c)}else ra.fF(b)},null,function(a){f(b,c,a)})}function t(a,b,c,d,e,f){(d=pa(b.Pg)+b.MF)||Ea.q("Binary data is missing");la.Td([{id:d,
type:la.Is,url:d,Ug:b.Zj}],function(d,f,g,l){d?(sa.log("%cLOAD BINARY","color: #616",l),a.bin_data=d,d=n(d),f=Ea.bM(a.b4w_format_version),d[0]!=f[0]&&Ea.q("BIN version does not match to JSON version: "+Ea.Sk(d)+", required: "+Ea.Sk(ua.hm)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&sa.warn("BIN version does not match to JSON version: "+ +Ea.Sk(d)+", required: "+Ea.Sk(ua.hm)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):ra.fF(b)},null,function(a){f(b,
c,a)})}function q(a,b,c,d,e){da.lG()&&e(b,c)}function z(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],g=a.objects,l=a.meshes;a=a.actions;var k=Ea.rR();n(d);for(var h=["indices"],m=["position","texcoord","texcoord2","shade_tangs"],p=["normal","tangent"],u=["group"],q=["color"],w=0;w<l.length;w++)for(var v=l[w].submeshes,C=0;C<v.length;C++){for(var t in v[C]){var r=v[C][t][1];if(-1!=h.indexOf(t)){var y=v[C][t][0]*Ea.hE+f["int"]+12,I=v[C],F=t,A=d;if(k)var z=new Uint32Array(A,y,r);else for(var z=new Uint32Array(r),
A=new DataView(A),B=0;B<r;B++)z[B]=A.getUint32(y+B*Ea.hE,!0);I[F]=z}else if(-1!=m.indexOf(t))y=v[C][t][0]*Ea.tj+f["float"]+12,v[C][t]=x(d,y,r,k);else if(-1!=p.indexOf(t)){y=v[C][t][0]*Ea.pp+f["short"]+12;I=v[C];F=t;A=d;z=new Float32Array(r);A=new DataView(A);for(B=0;B<r;B++)z[B]=A.getInt16(y+B*Ea.pp,!0)/32767;I[F]=z}else if(-1!=u.indexOf(t)){y=v[C][t][0]*Ea.pp+f.ushort+12;I=v[C];F=t;A=d;z=new Float32Array(r);A=new DataView(A);for(B=0;B<r;B++)z[B]=A.getUint16(y+B*Ea.pp,!0)/65535;I[F]=z}else if(-1!=
q.indexOf(t)){y=v[C][t][0]*Ea.Ex+f.uchar+12;I=v[C];F=t;A=d;z=new Float32Array(r);A=new DataView(A);for(B=0;B<r;B++)z[B]=A.getUint8(y+B*Ea.Ex,!0)/255;I[F]=z}}r=v[C];if(l[w].b4w_shape_keys.length)for(y=r.base_length,I=r.normal.length/y/3,r.tbn_quat=Ea.Rq(r.normal.subarray(0,3*y),r.tangent.subarray(0,4*y),new Float32Array(r.normal.length/3*4)),F=1;F<I;F++)for(A=F*y,z=0;z<y;z++){var R=r.normal.subarray(3*z,3*(z+1)),B=qa.add(r.normal.subarray(3*(A+z),3*(A+z+1)),R,hb);if(r.tangent.length){var M=r.tangent.subarray(4*
z,4*(z+1)),D=W.add(r.tangent.subarray(4*(A+z),4*(A+z+1)),M,jb),R=Ea.DI(R,M,ab),B=Ea.DI(B,D,vb);Ra.invert(R,ab);B=Ra.multiply(B,R,ab)}else B=Ra.rotationTo(R,B,ab);r.tbn_quat.set(B,4*(A+z))}else r.tbn_quat=Ea.Rq(r.normal,r.tangent)}for(t=0;t<g.length;t++)for(l=g[t].particle_systems,h=0;h<l.length;h++)m=l[h],m.transforms=x(d,m.transforms[0]*Ea.tj+f["float"]+12,m.transforms[1],k);for(g=0;g<a.length;g++){t=a[g];l=t.fcurves;h=t.frame_range;p=h[0];u=h[1];q=xa.pU(p,u);h=null;0>q&&(q=0);var v=w=!1,E;for(E in l)w|=
-1<E.indexOf("rotation_euler"),v|=-1<E.indexOf("rotation_quaternion");m=[];for(E in l)if(w&&v&&-1<E.indexOf("rotation_euler"))delete l[E];else{var C=l[E],G;for(G in C)r=C[G],y=x(d,f["float"]+r.bin_data_pos[0]*Ea.tj+12,r.bin_data_pos[1],k),I=new Float32Array(q),null===h&&(h=new Int8Array(q)),xa.oQ(r,y,I,h,p,u),r.uf=I;-1<E.indexOf("rotation_euler")&&(xa.JT(l[E]),m.push(E))}for(p=0;p<m.length;p++)u=m[p],q=u.replace("euler","quaternion"),l[q]=l[u],delete l[u];t.FP=h}e(b,c)}function n(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function x(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*Ea.tj,!0)}return d}function h(a,b,d,e,g){var k=a.cameras,h=a.groups,n=a.materials,m=a.meshes,p=a.node_groups,u=a.objects,q=a.particles,w=a.scenes,v=a.speakers,C=a.lamps,t=a.textures,r=a.worlds;p||(sa.warn('"node_groups" datablock undefined. reexport main scene.'),p=a.node_groups=[]);
for(var x="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),I={},F=0;F<x.length;F++)for(var B=a[x[F]],z=0;z<B.length;z++){var R=B[z];I[R.uuid]=R}for(var M=0;M<w.length;M++){for(var E=w[M],H=E.objects,Q=0;Q<H.length;Q++)l(H,Q,I);E.camera&&l(E,"camera",I);E.world&&l(E,"world",I)}for(M=0;M<h.length;M++)for(var K=h[M].objects,Q=0;Q<K.length;Q++)l(K,Q,I);for(M=0;M<u.length;M++){var aa=u[M];aa.dupli_group&&
l(aa,"dupli_group",I);aa.parent&&l(aa,"parent",I);aa.dg_parent&&l(aa,"dg_parent",I);if(aa.animation_data){var P=aa.animation_data;P.action&&l(P,"action",I);if(P.nla_tracks)for(Q=0;Q<P.nla_tracks.length;Q++)for(var J=P.nla_tracks[Q],L=0;L<J.strips.length;L++)J.strips[L].action&&l(J.strips[L],"action",I)}switch(aa.type){case "MESH":aa.data||Ea.q("mesh not found for object "+aa.name);l(aa,"data",I);for(var ca=!1,Y=aa.modifiers,Q=0;Q<Y.length;Q++){var S=Y[Q];"ARMATURE"==S.type?(ca&&sa.warn('Object "'+
aa.name+'" has more than one armature modifiers. Only the first one will be used.'),ca=!0,l(S,"object",I)):"CURVE"==S.type&&l(S,"object",I)}var O=aa.particle_systems;if(O)for(Q=0;Q<O.length;Q++)l(O[Q],"settings",I);break;case "ARMATURE":l(aa,"data",I);for(var ga=aa.pose.bones,V=aa.data.bones,Q=0;Q<ga.length;Q++){var ja=ga[Q];ja.bone=V[ja.bone];var Z=ja.constraints;if(Z)for(L=0;L<Z.length;L++){var ia=Z[L];ia.target&&l(ia,"target",I)}for(var X=ja.parent_recursive,L=0;L<X.length;L++)X[L]=ga[X[L]]}break;
case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":l(aa,"data",I)}if(Z=aa.constraints)for(Q=0;Q<Z.length;Q++)ia=Z[Q],ia.target&&l(ia,"target",I);var W=aa.lod_levels;if(W)for(Q=0;Q<W.length;Q++){var wa=W[Q];wa.object&&l(wa,"object",I)}}for(M=0;M<m.length;M++)for(var ea=m[M].materials,Q=0;Q<ea.length;Q++)l(ea,Q,I);for(M=0;M<n.length;M++){for(var ba=n[M],fa=ba.texture_slots,Q=0;Q<fa.length;Q++)l(fa[Q],"texture",I);var na=ba.node_tree;na&&c(na,I)}for(M=0;M<p.length;M++)(na=p[M].node_tree)&&c(na,I);
for(M=0;M<t.length;M++){var da=t[M],ha=da.type;"IMAGE"!=ha&&"ENVIRONMENT_MAP"!=ha||l(da,"image",I)}for(M=0;M<k.length;M++){var la=k[M];la.dof_object&&l(la,"dof_object",I)}for(M=0;M<v.length;M++){var ka=v[M];ka.sound&&l(ka,"sound",I);if(ka.animation_data&&(P=ka.animation_data,P.action&&l(P,"action",I),P.nla_tracks))for(Q=0;Q<P.nla_tracks.length;Q++)for(J=P.nla_tracks[Q],L=0;L<J.strips.length;L++)J.strips[L].action&&l(J.strips[L],"action",I)}for(M=0;M<q.length;M++){for(var oa=q[M],fa=oa.texture_slots,
Q=0;Q<fa.length;Q++)l(fa[Q],"texture",I);oa.dupli_group&&l(oa,"dupli_group",I);oa.dupli_object&&l(oa,"dupli_object",I)}for(M=0;M<C.length;M++){var ma=C[M];if(ma.animation_data&&(P=ma.animation_data,P.action&&l(P,"action",I),P.nla_tracks))for(Q=0;Q<P.nla_tracks.length;Q++)for(J=P.nla_tracks[Q],L=0;L<J.strips.length;L++)J.strips[L].action&&l(J.strips[L],"action",I)}for(M=0;M<r.length;M++){var za=r[M];if(fa=za.texture_slots)for(Q=0;Q<fa.length;Q++)l(fa[Q],"texture",I);if(za.animation_data&&(P=za.animation_data,
P.action&&l(P,"action",I),P.nla_tracks))for(Q=0;Q<P.nla_tracks.length;Q++)for(J=P.nla_tracks[Q],L=0;L<J.strips.length;L++)J.strips[L].action&&l(J.strips[L],"action",I)}Na.mR(a);D(a);for(var ya=pa(b.Pg),ra=a.textures,ta=b.Lb?a.scenes[0].b4w_anisotropic_filtering:Ya.b4w_anisotropic_filtering,qa=0;qa<ra.length;qa++)b.Lb||"SCENE"!=ra[qa].b4w_source_type||(ra[qa].b4w_source_id=""),Ha.QS(ra[qa],ta,a.scenes,b.id,ya);for(var ua={},va=a.objects,Da=0;Da<va.length;Da++){var Ga=va[Da];if("MESH"===Ga.type&&!Ga.particle_systems.length)for(var Ka=
Ga.data,La=Ka.name,Ma=Ka.submeshes,Ra=Ka.materials,Oa=0;Oa<Ma.length;Oa++)0!==Ma[Oa].base_length||ua[La]||(Ra[Oa]&&sa.warn('material "'+Ra[Oa].name+'" is not assigned to any face (object "'+Ga.name+'").'),ua[La]=!0)}for(var Ja=a.meshes,Sa=0;Sa<Ja.length;Sa++){var Ta=Ja[Sa];Ta.materials.length||Ta.uv_textures.length&&sa.warn('mesh "'+Ta.name+'" has a UV map but has no exported material.')}a.materials.push(Na.fS());for(var Pa=a.meshes,Qa=Ea.Cd("name","DEFAULT",a.materials),Va=0;Va<Pa.length;Va++){var ab=
Pa[Va];0==ab.materials.length&&ab.materials.push(Qa)}for(var hb=a.actions,kb=b.id,gb=0;gb<hb.length;gb++){var mb=hb[gb];mb.GP=kb;xa.PP(mb)}for(var jb=a.scenes,ob=0;ob<jb.length;ob++){for(var vb=jb[ob],nb=[],sb=[],yb=jb[ob].objects,zb=0;zb<yb.length;zb++){var Ab=yb[zb];U(yb,Ab,null,nb,sb);var Xb=Ab.dupli_group;if(Xb)for(var Xa=Xb.objects,$a=0;$a<Xa.length;$a++)U(Xa,Xa[$a],Ab,nb,sb)}for(zb=0;zb<sb.length;zb++)for(var Ec=sb[zb],gc=[vb],Mb=0;Mb<gc.length;Mb++){for(var wc=gc[Mb].objects,dc=0;dc<wc.length;dc++){var Tc=
wc[dc].dupli_group;if(Tc){var xc=Tc.objects,pc=xc.indexOf(Ec);-1<pc&&xc.splice(pc,1)}}var pc=wc.indexOf(Ec);-1<pc&&wc.splice(pc,1)}for(zb=0;zb<nb.length;zb++)Ea.jQ(nb[zb][0],nb[zb][1])}!b.Lb&&1<a.scenes.length&&(a.scenes=[G.uu(a.scenes)],sa.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Lc=b.Lb?Ya:G.uu(a.scenes);zc.MX(Ya.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Ya),1),a.scenes.unshift(Ya));for(var Uc=0;Uc<a.scenes.length;Uc++){var hc=a.scenes[Uc];
hc.s={};hc.dF=hc==Lc;hc.HP=b.Lb;Ua.enabled&&hc.b4w_enable_physics&&(b.Lb||!Ba.qw(Ya)&&hc==G.uu(a))&&Ba.kV(hc)}for(var qc=0;qc<a.scenes.length;qc++){for(var Ub=a.scenes[qc],Mc=y(Ub),jd=0;jd<Mc.length;jd++){var yc=Mc[jd];Ca.nR(yc,Ub,a)&&(yc.qd||(yc.qd=[]),yc.qd.push(b.Lb?Ub:Ya))}for(var od=Mc,kd=0;kd<od.length;kd++){var ld=od[kd];if(ld.qd&&"WORLD"!=ld.type)for(var vd=ld.particle_systems,pd=0;pd<vd.length;pd++){var ad=vd[pd].settings;if("HAIR"==ad.type)if("OBJECT"==ad.render_type){var rc=ad.dupli_object;
rc.qd||(rc.qd=ld.qd.slice())}else if("GROUP"==ad.render_type)for(var bd=ad.dupli_group,qd=0;qd<bd.objects.length;qd++)rc=bd.objects[qd],rc.qd||(rc.qd=ld.qd.slice())}}}for(var cd=a.scenes,rd=[],Gb=0;Gb<cd.length;Gb++)A(cd[Gb].objects,0,b.Lb,rd);Aa[b.id]=[];for(Gb=0;Gb<rd.length;Gb++)for(var wd=rd[Gb],Pc=0;Pc<wd.length;Pc++)for(var Jd=wd[Pc],zd=0;zd<Jd.length;zd++)Aa[b.id].push(Jd[zd]);for(var Ad=a.particles,Gb=0;Gb<Ad.length;Gb++){var sd=Ad[Gb].dupli_object;sd&&(sd.cF=!0,Aa[b.id].push(sd));var Kd=
Ad[Gb].dupli_group;if(Kd)for(var Ld=Kd.objects,Pc=0;Pc<Ld.length;Pc++)sd=Ld[Pc],sd.cF=!0,Aa[b.id].push(sd)}for(var Bd=Aa[b.id],Gb=Bd.length-1;0<=Gb;Gb--)Bd[Gb].qd||Bd.splice(Gb,1);for(var Md=Aa[b.id],qc=0;qc<Md.length;qc++)if(yc=Md[qc],!b.Lb&&yc.parent&&-1<Nb.indexOf(yc.parent.type)&&(yc.parent=""),"MESH"==yc.type){var Cd=Na.mQ(yc);Cd&&(a.meshes.push(Cd),yc.data=Cd)}for(var Dd=0;Dd<a.scenes.length;Dd++){var Nd=a.scenes[Dd],Ed=Nd.world;Ed.qd||(Ed.qd=[]);Ed.qd.push(b.Lb?Nd:Ya)}for(var Od=a.node_groups,
Pd=a.materials,md=0;md<Od.length;md++){var td=Od[md].node_tree;if(td){var xd=[];f(td,xd,!0);td.Sy=xd}}for(md=0;md<Pd.length;md++)if(td=Pd[md].node_tree)xd=[],f(td,xd,!1),td.Sy=xd;for(var Fd=0;Fd<a.scenes.length;Fd++){var Gd=a.scenes[Fd];if(Gd.b4w_use_logic_editor){var Qd=y(Gd);Na.tQ(Qd,Gd)}}for(var Hd=0;Hd<a.scenes.length;Hd++){var Rd=a.scenes[Hd],Id=b.Lb?Rd:Ya;Boolean(N(b.id,Id,"SPEAKER").length)&&!Id.Nc&&T.yQ(Id)}g(b,d)}function k(a,b){for(var c=pa(b.Pg),d=[],e=[],f=0;f<a.speakers.length;f++){var g=
a.speakers[f],l=g.sound.uuid;if(-1==e.indexOf(l)){e.push(l);switch(g.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var k=la.Ax;break;case "BACKGROUND_MUSIC":k=la.Bx}g=Ea.$i(c+g.sound.filepath);la.Cm(g);ba(d,l,k,g,b.Zj)}}d.length&&la.Td(d,function(){},function(){})}function f(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],g=e.type;if("GROUP"==g&&e.node_group){if(e=e.node_group.node_tree)if(c)f(e,b,!0);else for(e=e.Sy,g=0;g<e.length;g++){var l=e[g];-1==b.indexOf(l)&&b.push(l)}}else-1!=
Xb.indexOf(g)&&-1==b.indexOf(g)&&b.push(g)}}function y(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);g(a.objects,"ALL",b);return b}function g(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||c.push(e);(e=e.dupli_group)&&g(e.objects,b,c)}}function A(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],l=fa(g);e[l]=e[l]||[];(c||-1==Nb.indexOf(g.type))&&-1==e[l].indexOf(g)&&e[l].push(g);(g=g.dupli_group)&&A(g.objects,b+1,c,d)}}function N(a,b,
c){var d=[];a=Aa[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var g=0;g<f.qd.length;g++)b==f.qd[g]&&d.push(f)}return d}function H(a,b,c,d,e){var f=Aa[b.id],g=a.worlds;d=b.id;for(var l=0;l<f.length;l++){for(var k=f[l],h=ta.oq(k.name,k.type,k.origin_name),n=0;n<k.qd.length;n++)ta.Bp(h,k.qd[n]);k.nb=h;Ca.Mk(k,h);h.k.Qe=d;h.hr=k.cF||!1}for(d=0;d<g.length;d++){l=g[d];k="%meta_world%"+l.name;k=ta.oq(k,"WORLD",k);for(h=0;h<l.qd.length;h++)ta.Bp(k,l.qd[h]);l.nb=k;Ca.RZ(l,k)}d=Ca.Rl(b.id);
for(l=0;l<f.length;l++)k=f[l],h=k.nb,va.Mk(k,h);for(l=0;l<g.length;l++)k=g[l],va.Mk(k,k.nb);if(b.Lb)for(g=b.id,l=0;l<a.scenes.length;l++)for(var k=a.scenes[l],h=0,n=Ca.rc(k,"LAMP",g),m=0;m<n.length;m++)ta.ja(n[m],k).fm=h++;for(l=0;l<f.length;l++)k=f[l],h=k.nb,h.hr||(Ca.EZ(k,h),Sa.D(h));for(a=0;a<f.length;a++)if(g=f[a],l=g.nb,ta.Yd(l)||ta.Kn(l))if(k=g.lod_levels.length)for(h=l,l.k.Ln=!0,n=0;n<k;n++)if(m=g.lod_levels[n].object){m=m.nb;m.k.Ln=!0;m.k.Yg=l.k.Yg;h.k.af=g.lod_levels[n].distance;m.k.Xg=g.lod_levels[n].distance;
if(g.lod_levels[n+1])m.k.af=g.lod_levels[n+1].distance;else{m.k.af=ta.jp;break}h=m}else{h.k.af=g.lod_levels[n].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.zt)){var g=g.k,l=a.k.wi,k=[],p;for(p in l)h=l[p],k.push(4*h.eA,4*h.Cj);g.Hv.push(k);g.vo.push(a.k)}f=p=-1;a=xa.iI();for(g=0;g<d.length;g++)l=d[g],k=l.k,ta.Yd(l)&&k.$j&&(l=k.Zg,l>p&&(p=l),a>=l&&l>f&&(f=l));for(g=0;g<d.length;g++)l=d[g],k=l.k,ta.Yd(l)&&k.$j&&(k.Ll=!0,p<a?k.Zg=p:k.Zg<=a?k.Zg=f:(sa.warn('too many bones for "'+
l.name+'" / '+k.Zg+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.Zg=p,k.Ll=!1),k.Ll=k.Ll&&!Oa.BH);for(p=0;p<d.length;p++)if(f=d[p],f.Xe)if(a=f.kf,"CHASSIS"==a.cf){f.v={};f.v.Lq=a.Lq;f.v.Rp=a.Rp;f.v.iD=a.iD;f.v.kD=a.kD;f.v.jD=a.jD;f.v.UD=a.UD;f.v.AC=a.AC;f.v.AB=a.AB;f.v.tn=0;f.v.Qp=1;f.v.Do=0;f.v.speed=0;f.v.tm=[];f.v.Nr=[];f.v.Fo=null;l=(g=ta.Ki(f))?ta.GA(g,d):d;for(g=0;g<l.length;g++)k=l[g],k.Xe&&(h=k.kf,Ba.pV(k)&&a.name==h.name?(h=Ba.q_(k.kf.cf),
f.v.tm[h]=k,f.v.Nr[h]=new Float32Array(8)):Ba.nJ(k)&&a.name==h.name?(f.v.Fo=k,f.v.Eo=h.Eo,f.v.ns=h.ns,f.v.fr=h.fr,h=ha.invert(f.k.n,ha.create()),k=ha.multiply(h,k.k.n,h),f.v.$L=k,h=new Float32Array([1,0,0]),ha.wd(h,k,h),f.v.ZL=h):Ba.mJ(k)&&a.name==h.name?(f.v.bD=k,f.v.ms=h.ms,f.v.Tn=h.Tn,h=ha.invert(f.k.n,ha.create()),k=ha.multiply(h,k.k.n,h),f.v.VL=k,h=new Float32Array([1,0,0]),ha.wd(h,k,h),f.v.UL=h):Ba.oJ(k)&&a.name==h.name&&(f.v.mD=k,f.v.vq=h.vq,h=ha.invert(f.k.n,ha.create()),k=ha.multiply(h,k.k.n,
h),f.v.lM=k,h=new Float32Array([1,0,0]),ha.wd(h,k,h),f.v.kM=h));4!=f.v.tm.length&&Ea.q("Not enough wheels for chassis "+f.name)}else if("HULL"==a.cf)for(f.v={},f.v.tm=[],f.v.Nr=[],f.v.Lq=a.Lq,f.v.Rp=a.Rp,f.v.Jl=a.Jl,f.v.Nm=a.Nm,f.v.Om=a.Om,f.v.tn=0,f.v.Qp=1,f.v.Do=0,f.v.speed=0,f.v.Fo=null,l=(g=ta.Ki(f))?ta.GA(g,d):d,g=0;g<l.length;g++)k=l[g],k.Xe&&(h=k.kf,Ba.oV(k)&&a.name==h.name?(f.v.tm.push(k),f.v.Nr.push(new Float32Array(8))):Ba.nJ(k)&&a.name==h.name?(f.v.Fo=k,f.v.Eo=h.Eo,f.v.ns=h.ns,f.v.fr=h.fr,
h=ha.invert(f.k.n,ha.create()),k=ha.multiply(h,k.k.n,h),f.v.$L=k,h=new Float32Array([1,0,0]),ha.wd(h,k,h),f.v.ZL=h):Ba.mJ(k)&&a.name==h.name?(f.v.bD=k,f.v.ms=h.ms,f.v.Tn=h.Tn,h=ha.invert(f.k.n,ha.create()),k=ha.multiply(h,k.k.n,h),f.v.VL=k,h=new Float32Array([1,0,0]),ha.wd(h,k,h),f.v.UL=h):Ba.oJ(k)&&a.name==h.name&&(f.v.mD=k,f.v.vq=h.vq,h=ha.invert(f.k.n,ha.create()),k=ha.multiply(h,k.k.n,h),f.v.lM=k,h=new Float32Array([1,0,0]),ha.wd(h,k,h),f.v.kM=h));for(p=0;p<d.length;p++)if(f=d[p],f.am&&(a=f.wn,
"MAIN_BODY"==a.cf))for(f.Xf={},f.Xf.Jl=a.Jl,f.Xf.Nm=a.Nm,f.Xf.Om=a.Om,f.Xf.Ht=[],g=(g=ta.Ki(f))?ta.GA(g,d):d,l=0;l<g.length;l++)k=g[l],k.am&&(h=k.wn,Ba.tV(k)&&a.name==h.name&&(f.Xf.Ht.push(k),k.SF=k.wn.jM));e(b,c)}function O(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.vj=f.camera.nb}for(d=0;d<a.scenes.length;d++){var f=b.Lb?a.scenes[d]:Ya,g=b.Lb?Ca.rc(f,"LAMP",b.id):Ca.rc(f,"LAMP",0),l=Ca.rc(f,"ALL",b.id),k=N(b.id,f,"MESH"),h=N(b.id,f,"EMPTY");N(b.id,f,"WORLD");b.Lb&&G.WP(f,l,g,
k,h);for(var l=!1,n=0;n<h.length;n++)for(var m=h[n].nb,p=m.I,u=0;u<p.length;u++){var q=p[u].xb,w=G.JM(q,m);f.name==q.name&&(l=l||w)}b.Lb&&f.s.Ic&&!l&&sa.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');h=[];G.uw(f);X.lU(f,k,g,h);n=N(b.id,f,"LINE");X.kU(f,n);m=G.JA(f);if(b.Lb){l=f.s.Lw;n=f.world;if(l.GK||l.procedural_skydome)p=n.nb,X.aQ(f,l,p),X.Pz(p,m,f);G.HH(f,m);(l=f.s.Zo)&&l.xs&&X.TP(f,n.nb)}for(n=0;n<k.length;n++)X.Pz(k[n].nb,m,f);for(n=0;n<h.length;n++)X.Pz(h[n],
m,f),Ca.yW(h[n]);l=Ca.rc(f,"ALL",b.id);G.uQ(f,l,g);for(n=0;n<l.length;n++)m=l[n],m.k.Ge&&Ca.sZ(m),ta.uR(m)&&(m.RJ=!0)}G.XP(Ya,a.textures,b.id);b.Lb&&Ya.s.Wo.length&&(b.WA=!0);e(b,c)}function D(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c],e=Boolean("FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==ua.jq);d.wh=e;d.vp=e?"dds":""}if((Ma.dA||Ma.jw)&&ua.SM)for(a=0;a<b.length;a++){for(var d=b[a],f=d.texture_slots,c=0;c<f.length;c++){var e=f[c],g=e.texture;if("IMAGE"==g.type||
"ENVIRONMENT_MAP"==g.type){var l=g.image;l&&!l.wh&&(e=!g.b4w_disable_compression&&!e.use_map_normal&&"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&"MOVIE"!=l.source,P(l,e))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){f=d[c];e=!1;if("TEXTURE"==f.type){if((g=f.texture)&&(l=g.image)&&!l.wh&&(e=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{e=f.outputs;for(f=0;f<e.length;f++)if(g=e[f],g.is_linked&&"Normal"==g.identifier){e=!0;break a}e=!1}e=!e}}else"TEX_IMAGE"==
f.type?(l=f.image)&&!l.wh&&(e="MOVIE"!=l.source):"TEX_ENVIRONMENT"==f.type&&(e=!1);l&&!l.wh&&P(l,e)}}}function P(a,b){-1<a.filepath.indexOf(".dds")?(a.wh=!0,a.vp="dds"):(a.wh=b)?(a.vp=ua.jq,a.filepath="dds"==ua.jq?a.filepath+".dds":la.Cm(a.filepath)[0]+".pvr"):a.vp=""}function K(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},l={},k={},h={},n=0;n<d.length;n++){var m=d[n];g[m.uuid]=m;k[m.uuid]=m}for(n=0;n<f.length;n++)m=f[n],l[m.uuid]=m,h[m.uuid]=m;a=a.scenes;for(n=0;n<a.length;n++)M(a[n].objects,null,
h,k,null);for(var p in k)p in g||d.push(k[p]);for(p in h)p in l||f.push(h[p]);e(b,c)}function M(a,b,c,d,e){for(var f=[],g=0;g<a.length;g++){var l=a[g],k=c[l.uuid];if(l=k.proxy){b&&-1==f.indexOf(l.uuid)&&f.push(l.uuid);for(var h=c[l.uuid],n=h.constraints,l=0;l<n.length;l++){var m=Ea.Bh(n[l]);m.name+="_CLONE";k.constraints.push(m)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(h.animation_data=Ea.Bh(k.animation_data)),h.b4w_use_default_animation=k.b4w_use_default_animation,
h.b4w_auto_skel_anim=k.b4w_auto_skel_anim,h.b4w_anim_behavior=k.b4w_anim_behavior,h.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=0;g<f.length;g++)k=Ea.JU(a,f[g]),-1<k&&a.splice(k,1);f={};if(b)for(g=0;g<a.length;g++)l=a[g],k=c[l.uuid],n=Ea.Bh(k),h="origin_name"in k?k.origin_name:k.name,n.name=ta.GH(b.name,h),n.origin_name=h,n.dg_parent={uuid:b.uuid},F(n),c[n.uuid]=n,f[l.uuid]=n.uuid,l.uuid=n.uuid,e&&e[k.uuid]&&(n.b4w_cluster_data=e[k.uuid]);for(g=0;g<a.length;g++)l=a[g],k=c[l.uuid],k.dupli_group&&
(l=k.dupli_group,e=d[l.uuid],n=Ea.Bh(e),n.name=Ea.qs(e.name+"_CLONE"),n.uuid=ka.VI("Group"+n.name),d[n.uuid]=n,l.uuid=n.uuid,M(n.objects,k,c,d,k.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){l=a[g];k=c[l.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(sa.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);n=k.constraints;for(l=0;l<n.length;l++)b=n[l],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(d=
b.bones,l=0;l<d.length;l++)if(e=d[l].constraints)for(n=0;n<e.length;n++)b=e[n],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=k.modifiers;for(l=0;l<b.length;l++)d=b[l],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(l=0;l<k.length;l++)b=k[l],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var p in f)La[p]=f[p]}function F(a){a.uuid=ka.VI("Object"+a.name)}function c(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=
c[d];"TEXTURE"==e.type&&e.texture&&l(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in La&&(e.lamp.uuid=La[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&l(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||l(e,"image",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];C(f,"from_node",c);C(f,"to_node",c);v(f,"from_socket",f.from_node.outputs);v(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&l(c,"action",b),c.nla_tracks)for(d=
0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&l(e.strips[f],"action",b)}function l(a,b,c){(c=c[a[b].uuid])||sa.error("Dangling link found:",b,a);a[b]=c}function C(a,b,c){c=Ea.Cd("name",a[b].name,c);a[b]=c}function v(a,b,c){c=Ea.Cd("identifier",a[b].identifier,c);a[b]=c}function e(a,b,c,e,f,g){var l=[],k={};e=a.images;for(var h=Ha.hI(),n=pa(b.Pg),m=0;m<e.length;m++){var p=e[m],u=p.uuid;if(u){var q=Ea.$i(n+p.filepath),w=p.source;if("FILE"===w){var w=
p.wh?la.Is:la.Js,v=la.Cm(q),C=v[1].toLowerCase();if(!la.tR(C)){sa.error("image ",p," has unsupported format.");continue}Ma.EB&&ua.use_min50&&("dds"==v[1]?(q=la.Cm(v[0]),q=q[0]+".min50."+q[1]+".dds"):q=v[0]+".min50."+v[1])}else if("MOVIE"===w)if(ua.as)v=la.Cm(q),q=v[0]+".altconv.seq",w=la.Ks;else{v=la.Cm(q);C=v[1].toLowerCase();w=T.gT(C);if(""==w){sa.error("failed to load video file (unsupported format)",q);continue}q=w!=C?v[0]+".altconv."+w:v[0]+"."+v[1];w=la.Ls}else{sa.error('Image "'+p.name+'" has unsupported format "'+
w+'".');continue}if(!b.Zj)for((u in k)||(k[u]=[]),v=0;v<h.length;v++)C=h[v],C.Hn==u&&C.Vl==p.vp&&k[u].push(C);k[u].length&&l.push({id:u,type:w,url:q,Ug:b.Zj})}}if(l.length){var t=0;la.Td(l,function(e,f,h,n){if(e){var m=h;if(!b.Zj){f=k[f];for(m=0;m<f.length;m++){var p=f[m];if(h==la.Ks)p.Zr=e.Rg,Ha.ss(p,e.images,b.id);else if(Ha.ss(p,e,b.id),"ENVIRONMENT_MAP"==p.source)for(p=0;p<a.scenes.length;p++)G.HD(a.scenes[p])}m=f[0].Vl}h==la.Ls||h==la.Ks?(h==la.Ls?(h=e.videoWidth,e=e.videoHeight):(h=e.images[0].width,
e=e.images[0].height),sa.log("%cLOAD VIDEO "+h+"x"+e,"color: #"+(2048<h||2048<e?"a00":1024<h||1024<e?"aa0":"0a0"),n),-1==n.indexOf(kb)&&sa.warn("video",n,"is not from app root.")):d(e,n,!0,m)}n=++t/l.length;g(b,c,n)},function(){sa.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})}else f(b,c)}function R(a,b,c,d,e){a=G.MA();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var g=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(g=!1);va.KZ(f,g,b.id)}}e(b,c)}function p(a,b,c,d,e,f){a=pa(b.Pg);var g=[],l=
{};d=Ca.Rl(b.id);for(var k=0;k<d.length;k++){var h=d[k];if(ta.kr(h)&&T.TL(h)!=T.aE){var n=h.W.pj;"BACKGROUND_MUSIC"==T.OA(h)?(n=Ea.yA(),b.UA=!0):"NONE"!=T.OA(h)&&ua.$A&&(b.ZA=!0);if(!(n in l)){l[n]=[];var m=Ea.$i(a+h.W.Pg);switch(T.TL(h)){case T.zx:var p=la.Ax;break;case T.$D:p=la.Bx}ba(g,n,p,m,b.Zj)}l[n].push(h)}}if(g.length){var u=0;la.Td(g,function(a,d,e,k){if(a)for(sa.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(kb)&&sa.warn("sound",k,"is not from app root."),d=l[d],e=0;e<d.length;e++)T.PZ(d[e],
a);a=++u/g.length;f(b,c,a)},function(){sa.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function ba(a,b,c,d,e){var f=la.Cm(d),g=f[1].toLowerCase(),l=T.eT(g);""!=l?(d=l!=g?f[0]+".altconv."+l:f[0]+"."+f[1],a.push({id:b,type:c,url:d,Ug:e})):sa.error("failed to load audio file (unsupported format)",d)}function J(a,b,c){a=Ca.rc(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];ta.kr(d)&&(T.nV(d)||c)&&T.kK(d)}}function B(a,b){for(var c=a.s.Wo,d=0;d<c.length;d++){var e=c[d].s;a.b4w_use_nla&&
c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.Fs||(Ha.KK(e),Ha.mK(e))}}function V(a,b,c,d,e){va.start();sa.log("%cSTART NLA","color: #0a0");e(b,c)}function U(a,b,c,d,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,g=0;g<f;g++){var l=b.lod_levels[g],k=l.object;if(k){var h=Ea.bq(k);h.name=b.name+"_LOD_"+String(g+1);h.b4w_cluster_data=b.b4w_cluster_data;F(h);h.lod_levels=[];c&&(h.dg_parent=c);d.push([a,h]);e.push(k);l.object=h}}}function Z(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!Ba.yR(a.scenes[f])){d=
!1;break}d&&(e(b,c),sa.log("%cPHYSICS READY","color: #0a0"))}function w(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.Lb)var g=Ba.qw(f);else g=Ba.qw(Ya)||Ba.qw(f),f=Ya;if(Ua.enabled&&g)for(g=0;g<dc.length;g++)for(var l=Ca.rc(f,dc[g],b.id),k=0;k<l.length;k++){var h=l[k];h.k.Qe==b.id&&(Ba.cn(h,f),b.BJ&&Ba.na(h)&&Ba.jA(h))}}e(b,c)}function ga(a,b,c,e,f){var g={};e=[];for(var l=a.scenes,k=0;k<a.scenes.length;k++){var h=l[k];if(h.s.Ic){var n=h.s.Ic.Bk;if(n&&"FILE"===n.source){var h=
n.uuid,m=Ea.$i(pa(b.Pg)+n.filepath);e.push({id:h,type:n.wh?la.Is:la.Js,url:m});g[h]=n}}}e.length?la.Td(e,function(a,c,e,f){if(a){d(a,f,!0);e=[];f=Ha.hI();for(var k=0;k<f.length;k++){var h=f[k];h.uri===c&&e.push(h)}for(c=0;c<e.length;c++)Ha.ss(e[c],a,b.id);for(c=0;c<l.length;c++)if(e=l[c],e.s.Ic&&(f=e.s.Ic.Bk,f===n)){var h=a,m=document.createElement("canvas");f=n.size[0];k=n.size[1];m.width=f;m.height=k;m=m.getContext("2d");m.drawImage(h,0,0);h=m.getImageData(0,0,f,k).data;m=new Float32Array(4);m[0]=
1/16581375;m[1]=1/65025;m[2]=1/255;m[3]=1;f*=k;for(var k=new Float32Array(f),p=0;p<f;p++)k[p]=m[1]*h[4*p+2]+m[2]*h[4*p+3];e.s.XC=k}}else for(a=g[c],c=0;c<l.length;c++)e=l[c],f=e.s.Ic.Bk,f===a&&(e.s.Ic.Bk=null,sa.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,c)}):f(b,c)}function Q(a,b,c,e,f){e=a.scenes[0];a=[];for(var g=[Ab.jt,Ab.qp,Ab.kt,Ab.My],l=0;l<g.length;l++){var k=G.La(e,g[l]);k&&a.push(k)}if(a.length){e=[];l=la.Js;e.push({id:"SEARCH_TEXTURE",type:l,
Pg:ya.Ae.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:l,url:ya.Ae.smaa_area_texture_path});for(l=0;l<a.length;l++)if(g=a[l],g.type==Ab.qp){a=g.Ya;for(l=0;l<a.length;l++)if(g=a[l],"u_search_tex"==g.to)var h=g.jb;else if("u_area_tex"==g.to)var n=g.jb;break}e.length?la.Td(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?h:n,c.source="IMAGE",Ha.ss(c,a,b.id),Ha.JC(c,Ha.K,Ha.K))},function(){f(b,c)}):f(b,c)}else f(b,c)}function I(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];
b.Lb||(e=Ya);for(var f=Ca.rc(e,"LAMP",b.id),g=0;g<f.length;g++){var l=f[g];l.k.Qe==b.id&&d.Vy.push({xb:e,da:l})}f=Ca.rc(e,"ALL",b.id);for(g=0;g<f.length;g++)l=f[g],"LAMP"!=l.type&&l.k.Qe==b.id&&(b.BJ&&ta.Yd(l)&&G.Wp(l,!0),d.Vy.push({xb:e,da:l}))}}function Y(a,b,c,d,e,f){var g=d.Vy;e=d.XJ;if(g.length){a=g[e].da;var l=g[e].xb;e=ta.ja(a,l);G.cn(l,a,!1);!a.anchor||l.s.dv||l.s.anaglyph_use||oa.append(a);d=++d.XJ/g.length;g=e.Bi;if(-1!=a.k.Qd&&g){var k=qa.copy(a.k.kb.G,hb);G.IM(g,k)}g=a.Tr;if(g.length&&
l.s.Xh)for(l=ha.F(a.k.n),a=ha.R(a.k.n),e=e.Uh,k=0;k<e.length;k++)G.MM(e[k],l,a),ta.NM(g,e[k].p.lc)}else d=1;f(b,c,d)}function ia(a,b,c,d,e){if(b.Lb){d=G.Jh();G.HD(d);var f=G.MA();for(a=0;a<f.length;a++){var g=f[a];G.HD(g);G.WW(g,d)}G.uw(d)}else G.OM(Ya);d=Ca.Rl(b.id);Ca.FZ(d);for(f=0;f<d.length;f++)for(g=d[f],a=0;a<g.I.length;a++)for(var l=g.I[a].U,k=0;k<l.length;k++)null==l[k].yb&&l.splice(k--,1);e(b,c)}function u(a,b,c,d,e){if(b.Lb)for(a=G.MA(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&
ma.iV(f,b.id)}e(b,c)}function aa(a,b,c,d,e){if(b.Lb)for(d=0;d<a.scenes.length;d++)B(a.scenes[d],b.id),J(a.scenes[d],b.id,!1);else B(Ya,b.id),J(Ya,b.id,!1);e(b,c)}function ca(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ua.media_auto_activation&&(b.WA||b.UA||b.ZA)?gb||ja(a,e,b,c):e(b,c)}function ja(a,b,c,d){var e=ob.parentElement;sb=e.style.zIndex;e.style.zIndex="999";gb=document.createElement("div");gb.style.position="relative";gb.style.height="88px";gb.style.width="88px";var f=
Math.round(ob.offsetWidth/2-44);gb.style.top=Math.round(ob.offsetHeight/2-44).toString()+"px";gb.style.left=f.toString()+"px";gb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
gb.style.backgroundSize="88px";mb=document.createElement("div");mb.style.position="relative";mb.style.height=ob.offsetHeight.toString()+"px";mb.style.width=ob.offsetWidth.toString()+"px";mb.style.background="rgba(0, 0, 0, 0.5)";mb.style.zIndex="999";e.appendChild(mb);mb.appendChild(gb);gb.addEventListener("click",function(){c.WA&&(Ha.play(),Ha.pause(),Ha.reset());if(c.UA){if(c.Lb)for(var e=0;e<a.scenes.length;e++)J(a.scenes[e],c.id,!0);else J(Ya,c.id,!0);T.pause()}c.ZA&&T.lK();wa();b(c,d)},!1)}function wa(){if(gb){var a=
ob.parentElement;a.style.zIndex=sb;mb.removeChild(gb);a.removeChild(mb);gb=mb=null;sb=0}}function pa(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function S(a){xa.Ac(a)&&xa.remove(a);Ka.eX(a);Ca.Nt(a);na.Yp(a)&&na.Vr(a);Ba.na(a)&&Ba.Ur(a);G.fX(a);ta.kr(a)&&T.zY(a);oa.mV(a)&&oa.remove(a)}function fa(a){var b=xa.UH(a);return(a=b&&b.parent==a?null:a.parent||b)?1+fa(a):0}var oa=r("__anchors"),xa=r("__animation"),la=r("__assets"),X=r("__batch"),ya=r("__config"),na=r("__controls"),L=r("__texcomp"),
ea=r("__debug"),E=r("__extensions"),za=r("__input"),ra=r("__loader"),ka=r("__md5"),va=r("__nla"),ma=r("__logic_nodes"),Ka=r("__particles"),Ga=r("__nodemat"),Ca=r("__objects"),ta=r("__obj_util"),Ba=r("__physics"),sa=r("__print"),Ra=r("__quat"),Na=r("__reformer"),Da=r("__renderer"),G=r("__scenes"),T=r("__sfx"),da=r("__shaders"),Ab=r("__subscene"),Ha=r("__textures"),zc=r("__time"),Sa=r("__transform"),ha=r("__tsr"),Ea=r("__util"),qa=r("__vec3"),W=r("__vec4"),Oa=ya.il,ua=ya.A,Ma=ya.Od,Ua=ya.C,nb=ya.W,
Va=null,Aa=null,kb="",Ya=null,La={},hb=new Float32Array(3),jb=new Float32Array(4),ab=new Float32Array(4),vb=new Float32Array(4),gb=null,mb=null,sb=0,Ta=!1,Nb=["LAMP","CAMERA"],dc=["MESH","CAMERA","EMPTY"],Xb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],ob=null;a.Vg=function(a){return ra.Vg(a)};a.update=function(){ra.LZ(Va)};a.kY=function(a){ob=a};a.CZ=function(a,b){if(gb){mb.style.height=b.toString()+"px";mb.style.width=a.toString()+"px";var c=Math.round(a/2-44);gb.style.top=Math.round(b/2-44).toString()+"px";
gb.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,g){var l={load_main:{Mb:ra.ug,Pb:!1,L:[],Ub:!1,Wb:500,hc:!1,Zb:b},duplicate_objects:{Mb:ra.qe,Pb:!1,L:["load_main"],Ub:!1,Wb:50,hc:!1,Zb:K},load_binaries:{Mb:ra.ug,Pb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:t},wait_for_shaders:{Mb:ra.qe,Pb:!1,L:[],Ub:!1,Wb:50,hc:!0,Ej:q},prepare_bindata:{Mb:ra.qe,Pb:!1,L:["duplicate_objects","load_binaries"],Ub:!1,Wb:100,hc:!1,Zb:z},prepare_bpy_data:{Mb:ra.qe,Pb:!1,L:["duplicate_objects","prepare_bindata"],
Ub:!1,Wb:100,hc:!1,Zb:h},process_objects:{Mb:ra.qe,Pb:!1,L:["prepare_bpy_data"],Ub:!1,Wb:150,hc:!1,Zb:H},process_scenes:{Mb:ra.qe,Pb:!1,L:["process_objects","wait_for_shaders"],Ub:!1,Wb:300,hc:!1,Zb:O},load_smaa_textures:{Mb:ra.ug,Pb:!1,L:["process_scenes"],Ub:!1,Wb:30,hc:!0,Zb:Q},load_shoremap:{Mb:ra.ug,Pb:!1,L:["process_scenes"],Ub:!1,Wb:30,hc:!0,Zb:ga},load_images:{Mb:ra.ug,Pb:!0,L:["process_scenes"],Ub:!0,Wb:500,hc:!1,Zb:e},update_scenes_nla:{Mb:ra.qe,Pb:!1,L:["process_scenes","load_images"],
Ub:!1,Wb:50,hc:!1,Zb:R},wait_physics_workers:{Mb:ra.qe,Pb:!1,L:["load_shoremap"],Ub:!1,Wb:20,hc:!1,Ej:Z},add_physics_objects:{Mb:ra.qe,Pb:!1,L:["wait_physics_workers"],Ub:!1,Wb:50,hc:!1,Zb:w},add_objects:{Mb:ra.qe,Pb:!1,L:["add_physics_objects"],Ub:!1,Wb:600,hc:!1,Zb:I,Ej:Y,Tp:ia,Up:{Vy:[],XJ:0}},init_logic_nodes:{Mb:ra.qe,Pb:!1,L:["update_scenes_nla","add_objects"],Ub:!1,Wb:50,hc:!1,Zb:u},load_speakers:{Mb:ra.ug,Pb:!0,L:["add_objects"],Ub:!0,Wb:100,hc:!1,Zb:p},mobile_media_start:{Mb:ra.qe,Pb:!1,
L:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Ub:!0,Wb:5,hc:!1,Zb:ca,Ej:ca},synchronize_media:{Mb:ra.qe,Pb:!0,L:["mobile_media_start"],Ub:!0,Wb:50,hc:!1,Zb:aa},start_nla:{Mb:ra.qe,Pb:!0,L:["mobile_media_start"],Ub:!1,Wb:5,hc:!0,Zb:V}},k=ra.NA();k||(k=ra.OG(),Va={},Aa={},La={});Va[k.lh.length]={};return ra.TG(l,a,c,d,m,f||nb.AF,ua.do_not_load_resources,g,!1)};a.fx=function(a){var b=ra.NA();if(!b||!b.lh.length||a&&!ra.XY(b.lh[a]))sa.error("Unable to unload data!");else{if(0==
a)sa.log("%cUNLOAD ALL","color: #00a"),oa.sa(),xa.sa(),T.sa(),X.sa(),G.sa(),ra.sa(),na.sa(),Ba.sa(),Ca.sa(),Ea.sa(),Da.sa(),Ga.sa(),da.sa(),E.sa(),la.sa(),Ha.sa(),ma.sa(),Ka.sa(),za.sa(),ea.sa(),Aa=null,La={},Va=Ya=null,Ta=!1;else{sa.log("%cUNLOAD DATA "+a,"color: #00a");xa.cX(a);for(var b=Ca.Rl(Ca.Jc),c=0;c<b.length;c++){var d=b[c];ta.LA(d)!=a&&Ca.Uv(d,!1,!1,!1)}b=Ca.Rl(a);for(c=b.length-1;0<=c;c--)d=b[c],S(d),Ca.Ur(d);b=Ca.Rl(Ca.Jc);for(c=0;c<b.length;c++)Ca.Uv(b[c],!0,!0,!0)}va.sa(a);wa()}};a.VW=
S;a.aL=function(a){kb=a};a.jF=function(){Ta||ua.media_auto_activation||(Ha.play(),Ha.pause(),Ha.reset(),J(Ya,Ca.Jc,!0),T.pause(),ua.$A&&T.lK(),Ta=!0)};a.reset=function(){ob=null};a.nK=function(a,c,d){var f={load_main:{Mb:ra.ug,Pb:!1,L:[],Ub:!1,Wb:500,hc:!1,Zb:b},load_binaries:{Mb:ra.ug,Pb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:t},load_images:{Mb:ra.ug,Pb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:e},preload_sounds:{Mb:ra.ug,Pb:!1,L:["load_main"],Ub:!1,Wb:500,hc:!1,Zb:k}},g=ra.NA();g||(g=ra.OG(),Va=
{},Aa={},La={});Va[g.lh.length]={};return ra.TG(f,a,c,d,m,!1,ua.do_not_load_resources,!1,!0)};a.GM=function(){la.HR()}};b4w.module.__controls=function(a,r){function m(a,b){b||(b=y.We());return{type:a,value:0,Y:null,element:b,Ka:!1,key:0,$b:"",Ah:!1,Ez:null,Dz:function(){},Cz:null,uG:function(){},bi:null,from:new Float32Array(3),to:new Float32Array(3),eJ:!1,gv:!1,Qr:0,CK:function(){},axis:"",Mf:0,Mo:new Float32Array(3),kw:new Float32Array(4),threshold:0,wK:new Float32Array(4),Bt:0,At:0,NK:0,Ct:0,Gf:0,repeat:!1,pH:!1,Ol:0,callback:function(){}}}function d(a){function b(){return{Ij:new Float32Array(2),dm:!0,da:null,identifier:-1,
tv:!0}}a||(a=y.We());for(var d=0;d<R.length;d++){var e=R[d];if(a==e.element)return e}e={element:a,lr:!0,ye:0,uv:!0,Lv:0,Mv:0,im:0,jm:0,Kr:0,Lr:0,mh:new Float32Array(2),ne:new Float32Array(2),nh:new Float32Array(2),De:new Float32Array(2),$w:0,BD:0,zM:0,Se:new Uint8Array(256),wx:0,RA:null,Sh:b(),Em:Array(10),iB:!1,QI:O.create(),Wu:0,Vu:0,Uu:0,TA:0,SA:0,Tu:Infinity,VB:null,UB:null,KB:null,GB:null,IB:null,zD:null,yD:null,JB:null,HB:null,eC:null,Q5:null,AD:null,xD:null,wD:null,bj:{}};for(d=0;10>d;++d)e.Em[d]=
b();e.VB=function(a){e.iB||(g.XU(a,e.QI),e.iB=!0)};e.UB=function(a){a=M.copy(a,J);e.Uu=a[0];e.Vu=a[1];e.Wu=a[2];Infinity==e.Tu&&(e.Tu=a[0],e.SA=a[1],e.TA=a[2])};e.KB=function(a){e.wx+=a*F.rW};e.GB=function(a){var b=g.ia(g.ad,e.element),b=g.Mi(b,g.pi,p);e.Lv=b[0];e.Mv=b[1];e.im=b[0];e.jm=b[1];if(3==e.ye||0==e.ye)e.ye=1;e.which=a};e.IB=function(){var a=g.ia(g.ad,e.element),a=g.Mi(a,g.pi,p),a=y.Pt(a[0],a[1],p);e.Sh.dm=!1;e.Sh.Ij[0]=a[0];e.Sh.Ij[1]=a[1]};e.zD=function(a){for(var b=0;b<a.length;++b){for(var c=
a[b],d=null,f=null,g=0;g<e.Em.length;g++){var l=e.Em[g];if(l.identifier==c.identifier){l.tv&&(f=l);break}else!d&&l.tv&&(d=l,d.identifier=c.identifier)}if(c=f||d)d=y.Pt(a[b].clientX,a[b].clientY,p),c.dm=!1,c.tv=!1,c.Ij[0]=d[0],c.Ij[1]=d[1]}};e.yD=function(a){for(var b=0;b<e.Em.length;++b){for(var c=e.Em[b],d=!1,f=0;f<a.length;++f)if(a[f].identifier==c.identifier){d=!0;break}d||(c.dm=!0,c.tv=!0,c.da=null)}};e.JB=function(a){var b=g.ia(g.ad,e.element),b=g.Mi(b,g.pi,p);e.Lv=b[0];e.Mv=b[1];e.im=b[0];e.jm=
b[1];0<e.ye&&(e.ye=3);e.which=a};e.HB=function(a){if(!c.Fn||e.ye)e.im=a[0],e.jm=a[1]};e.eC=function(a){if(!c.Fn||e.ye)e.Kr+=a[0],e.Lr+=a[1]};e.qJ=function(a){2!=e.Se[a]&&(e.Se[a]=1,e.lr=!1)};e.sJ=function(){for(var a=0;a<e.Se.length;a++)0!=e.Se[a]&&(e.Se[a]=3,e.lr=!1)};e.tJ=function(a){e.lr=!1;e.Se[a]=3};e.AD=function(a){e.uv=!1;if(1==a.length)e.mh[0]=a[0].clientX,e.mh[1]=-1,e.nh[0]=a[0].clientY,e.nh[1]=-1;else if(1<a.length){e.$w=e.BD=h(a);e.mh[0]=a[0].clientX;e.mh[1]=a[1].clientX;e.nh[0]=a[0].clientY;
e.nh[1]=a[1].clientY;var b=a[0];a=a[1];e.zM=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}e.ne.set(e.mh);e.De.set(e.nh)};e.xD=function(a){1===a.length?(e.ne[0]=a[0].clientX,e.ne[1]=-1,e.De[0]=a[0].clientY,e.De[1]=-1):1<a.length&&(e.ne[0]=a[0].clientX,e.ne[1]=a[1].clientX,e.De[0]=a[0].clientY,e.De[1]=a[1].clientY,e.$w=h(a))};e.wD=function(a){0==a.length&&(e.uv=!0)};R.push(e);return e}function b(a,b){if(b in a.bj&&0<a.bj[b])a.bj[b]+=1;else switch(a.bj[b]=1,b){case "orientation_quat":var c=g.ia(g.rh);
c&&g.xd(c,g.Um,a.VB);break;case "orientation_angles":(c=g.ia(g.rh))&&g.xd(c,g.Um,a.UB);break;case "mouse_wheel":(c=g.ia(g.ad,a.element))&&g.xd(c,g.lp,a.KB);break;case "mouse_down_which":(c=g.ia(g.ad,a.element))&&g.xd(c,g.Xk,a.GB);break;case "mouse_select":(c=g.ia(g.ad,a.element))&&g.xd(c,g.Xk,a.IB);break;case "touch_select":if(c=g.ia(g.wg,a.element))g.xd(c,g.al,a.zD),g.xd(c,g.$k,a.yD);break;case "mouse_up_which":(c=g.ia(g.ad,a.element))&&g.xd(c,g.kp,a.JB);break;case "mouse_location":(c=g.ia(g.ad,
a.element))&&g.xd(c,g.pi,a.HB);break;case "mouse_pointerlock":(c=g.ia(g.ad,a.element))&&g.xd(c,g.sE,a.eC);break;case "keyboard_downed_keys":if(c=g.ia(g.cp,a.element))g.xd(c,g.hp,a.qJ),g.xd(c,g.jE,a.sJ),g.xd(c,g.ip,a.tJ);break;case "touch_start":(c=g.ia(g.wg,a.element))&&g.xd(c,g.al,a.AD);break;case "touch_move":(c=g.ia(g.wg,a.element))&&g.xd(c,g.rp,a.xD);break;case "touch_end":(c=g.ia(g.wg,a.element))&&g.xd(c,g.$k,a.wD)}}function t(a,b){if(!(!b in a.bj)&&0<a.bj[b]&&(--a.bj[b],!a.bj[b]))switch(b){case "orientation_quat":var c=
g.ia(g.rh);c&&g.Ad(c,g.Zs,a.VB);break;case "orientation_angles":(c=g.ia(g.rh))&&g.Ad(c,g.Um,a.UB);break;case "mouse_wheel":(c=g.ia(g.ad,a.element))&&g.Ad(c,g.lp,a.KB);break;case "mouse_down_which":(c=g.ia(g.ad,a.element))&&g.Ad(c,g.Xk,a.GB);break;case "mouse_select":(c=g.ia(g.ad,a.element))&&g.Ad(c,g.Xk,a.IB);break;case "touch_select":if(c=g.ia(g.wg,a.element))g.Ad(c,g.al,a.zD),g.Ad(c,g.$k,a.yD);break;case "mouse_up_which":(c=g.ia(g.ad,a.element))&&g.Ad(c,g.kp,a.JB);break;case "mouse_location":(c=
g.ia(g.ad,a.element))&&g.Ad(c,g.pi,a.HB);break;case "mouse_pointerlock":(c=g.ia(g.ad,a.element))&&g.Ad(c,g.sE,a.eC);break;case "keyboard_downed_keys":if(c=g.ia(g.cp,a.element))g.Ad(c,g.hp,a.qJ),g.Ad(c,g.jE,a.sJ),g.Ad(c,g.ip,a.tJ);break;case "touch_start":(c=g.ia(g.wg,a.element))&&g.Ad(c,g.al,a.AD);break;case "touch_move":(c=g.ia(g.wg,a.element))&&g.Ad(c,g.rp,a.xD);break;case "touch_end":(c=g.ia(g.wg,a.element))&&g.Ad(c,g.$k,a.wD)}}function q(a,b){a.value=Number(b)}function z(a){for(var b=a.wk,c=a.AX,
d=0;d<b.length;d++)c[d]=b[d].value;return a.bW(c)}function n(a,b){a=a||C;var c=a.jh;if(c){var d=a.xm;if(b){var f=c[b];if(f){for(var g=f.wk,k=0;k<g.length;k++){var h=g[k],m;m=v.indexOf(h);m=-1<m?e[m]:[];1==m.length?(x(h),h=v.indexOf(h),-1<h?(v.splice(h,1),e.splice(h,1)):K.q("Sensors cache is corrupted")):1<m.length&&m.splice(m.indexOf(f),1)}delete c[b];k=d.indexOf(f);-1<k?d.splice(k,1):K.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=l.indexOf(a),-1<c?l.splice(c,1):N.error("Wrong object"))}}else{d=
[];for(b in c)d.push(b);for(k=0;k<d.length;k++)n(a,d[k])}V=!0}}function x(a){switch(a.type){case 90:H.rC(a.Ez,a.$b,a.Dz);a.Ka=!0;break;case 100:H.zz(a.Cz);a.Ka=!0;break;case 110:H.sC(a.Qr);a.Ka=!0;break;case 140:a.Ka=!0;break;case 20:var b=d(a.element);t(b,"keyboard_downed_keys");a.Ka=!0;break;case 30:b=d(a.element);t(b,"mouse_wheel");a.Ka=!0;break;case 40:b=d(a.element);t(b,"mouse_down_which");t(b,"mouse_up_which");t(b,"mouse_location");a.Ka=!0;break;case 260:b=d(a.element);t(b,"mouse_pointerlock");
a.Ka=!0;break;case 50:b=d(a.element);t(b,"mouse_down_which");t(b,"mouse_up_which");a.Ka=!0;break;case 60:b=d(a.element);t(b,"touch_start");t(b,"touch_move");t(b,"touch_end");a.Ka=!0;break;case 70:b=d(a.element);t(b,"touch_start");t(b,"touch_move");a.Ka=!0;break;case 75:b=d(a.element);t(b,"touch_start");t(b,"touch_move");a.Ka=!0;break;case 80:b=d(a.element);t(b,"touch_start");t(b,"touch_end");a.Ka=!0;break;case 170:b=d(a.element);t(b,"mouse_select");t(b,"touch_select");t(b,"touch_start");t(b,"touch_end");
t(b,"mouse_down_which");t(b,"mouse_up_which");a.Ka=!0;break;case 180:case 190:b=d(a.element);t(b,"orientation_angles");a.Ka=!0;break;case 200:b=d(a.element);t(b,"orientation_quat");a.Ka=!0;break;case 210:case 220:a.Ka=!0}}function h(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function k(a){return 0==a?g.ia(g.Ns):1==a?g.ia(g.Mx):2==a?g.ia(g.Nx):g.ia(g.Ox)}var f=r("__config"),y=r("__container"),g=r("__input"),A=r("__objects"),N=r("__print"),H=r("__physics"),
O=r("__quat"),D=r("__time"),P=r("__tsr"),K=r("__util"),M=r("__vec3"),F=f.controls,c=f.A,l=[],C={},v=[],e=[],R=[],p=new Float32Array(2),ba=new Float32Array(2),J=M.create(),B=O.create(),V=!1,U=0;a.qf=10;a.ub=20;a.Jx=30;a.vg=40;a.bp=50;a.Ix=60;a.ht=0;a.gt=1;a.ft=2;a.Ly=3;var Z=1;a.update=function(b,e){for(var f=0;f<R.length;f++){var h=R[f];h.Sh.dm||(h.Sh.da=A.Ir(h.Sh.Ij[0],h.Sh.Ij[1]),h.Sh.dm=!0,h.RA=h.Sh.da);for(var n=0;10>n;++n){var m=h.Em[n];m.dm||(m.da=A.Ir(m.Ij[0],m.Ij[1]),m.dm=!0,h.RA=m.da)}}for(f=
0;f<v.length;f++)if(h=v[f],m=b,n=e)switch(h.type){case 120:var u=h.bi,t=P.fc(u.k.n,J),u=P.Wd(u.k.n,B),r=M.dist(h.Mo,t),x=h.wK;O.invert(h.kw,x);O.multiply(u,x,x);O.normalize(x,x);x=Math.abs(2*Math.acos(x[3]));r/=n;h.Bt=K.vc(r,h.Bt,n,.3);h.Y[0]=r;r=x/n;h.At=K.vc(r,h.At,n,.3);h.Y[1]=r;h.Bt>=h.threshold||h.At>=h.NK?q(h,1):q(h,0);M.copy(t,h.Mo);O.copy(u,h.kw);h.Mf=m;break;case 130:u=h.bi;t=P.fc(u.k.n,J);u=Math.abs(t[1]-h.Mo[1])/n;h.Ct=K.vc(u,h.Ct,n,.3);h.Y=u;h.Ct>=h.threshold?q(h,1):q(h,0);M.copy(t,h.Mo);
h.Mf=m;break;case 140:!h.Ka&&0<=h.Gf&&m-h.Mf>=h.Gf&&(q(h,1),h.repeat?h.Mf=m:h.Gf=-h.Gf);break;case 150:h.Mf||(h.Mf=m);q(h,m-h.Mf);h.Mf=m;break;case 160:q(h,m);break;case 180:m=d(h.element);h.Y[0]=m.Wu-m.TA;h.Y[1]=m.Vu-m.SA;h.Y[2]=m.Uu-m.Tu;break;case 190:m=d(h.element);h.Y[0]=m.Wu;h.Y[1]=m.Vu;h.Y[2]=m.Uu;break;case 200:m=d(h.element);O.copy(m.QI,h.Y);break;case 210:n=g.ia(g.Je);g.Mi(n,g.$s,h.Y);break;case 220:n=g.ia(g.Je);g.Mi(n,g.at,h.Y);break;case 240:n=k(h.Ol);h.value=g.HU(n,h.key);break;case 250:n=
k(h.Ol);h.value=g.GU(n,h.key);break;case 230:q(h,h.callback());break;case 30:m=d(h.element);q(h,m.wx);break;case 40:m=d(h.element);if(!c.Fn||1==m.ye||2==m.ye)switch(t=m.im-m.Lv,u=m.jm-m.Mv,h.Y.coords[0]=m.im,h.Y.coords[1]=m.jm,h.axis){case "X":q(h,t);break;case "Y":q(h,u);break;case "XY":n=Math.sqrt(t*t+u*u),q(h,n)}break;case 260:m=d(h.element);c.Fn||(t=m.Kr,u=m.Lr,r=K.vc(t,0,n,.1*Z),n=K.vc(u,0,n,.1*Z),.01<Math.abs(t)||.01<Math.abs(u)?(m.Kr-=r,m.Lr-=n,h.Y.coords[0]=r,h.Y.coords[1]=n):(h.Y.coords[0]=
0,h.Y.coords[1]=0),q(h,Math.sqrt(t*t+u*u)));break;case 50:m=d(h.element);q(h,0<m.ye|0);h.Y.which=m.which;h.Y.coords[0]=m.im;h.Y.coords[1]=m.jm;break;case 170:m=d(h.element);q(h,0);if(h.pH)m.RA==h.bi&&q(h,1);else if(m.ye&&m.Sh.da==h.bi)q(h,1);else if(!m.uv)for(n=0;10>n;++n)if(m.Em[n].da==h.bi){q(h,1);break}break;case 20:m=d(h.element);h.Y=m.Se[h.key];1==h.Y||m.Se[0]&&16==h.key?q(h,1):h.Y||q(h,0);break;case 60:m=d(h.element);if(-1==m.ne[1]&&-1==m.De[1]){t=m.ne[0]-m.mh[0];u=m.De[0]-m.nh[0];n=Math.sqrt(t*
t+u*u);if(-1!=m.mh[1]&&-1!=m.nh[1]){var r=m.ne[0]-m.mh[1],x=m.De[0]-m.nh[1],y=Math.sqrt(r*r+x*x);y<n&&(t=r,u=x,n=y)}h.Y.gesture=a.ht}else n=p,n[0]=(m.ne[0]+m.ne[1])/2,n[1]=(m.De[0]+m.De[1])/2,u=ba,u[0]=(m.mh[0]+m.mh[1])/2,u[1]=(m.nh[0]+m.nh[1])/2,t=n[0]-u[0],u=n[1]-u[1],n=Math.sqrt(t*t+u*u),h.Y.gesture=a.ft;h.Y.coords[0]=m.ne[0];h.Y.coords[1]=m.De[0];switch(h.axis){case "X":q(h,t);break;case "Y":q(h,u);break;case "XY":q(h,n)}break;case 70:m=d(h.element);n=m.$w-m.BD;h.Y=a.gt;q(h,n);break;case 75:m=
d(h.element);-1!=m.ne[1]&&(n=Math.atan2(m.De[0]-m.De[1],m.ne[0]-m.ne[1]),h.Y=a.Ly,q(h,n-m.zM));break;case 80:m=d(h.element),h.Y.coords[0]=m.ne[0],h.Y.coords[1]=m.De[0],m.uv?q(h,0):q(h,1)}for(f=0;f<l.length;f++)for(m=l[f],h=m.xm,n=0;n<h.length;n++)if(t=h[n],t.Lk!=U){t.Lk=U;x=t;u=0;switch(x.type){case a.qf:u=(r=z(x))?1:0;break;case a.ub:u=x.Qi;(r=z(x))?(u=1,x.Qi=1):1==u?(u=-1,x.Qi=-1):u=0;break;case a.Jx:u=x.Qi;(r=z(x))&&-1==u?(u=1,x.Qi=1):r||1!=u?u=0:(u=-1,x.Qi=-1);break;case a.vg:u=x.Qi;(r=z(x))&&
-1==u?(u=1,x.Qi=1):r||1!=u?u=0:(u=0,x.Qi=-1);break;case a.bp:r=z(x);x.xJ!=r?(u=1,x.xJ=r):u=0;break;case a.Ix:r=x.wk;x=x.GV;for(y=0;y<r.length;y++){var F=r[y].value;u||F==x[y]||(u=1);x[y]=F}break;default:K.q("Wrong sensor manifold type: "+x.type)}if(u&&(r=m==C?null:m,V=!1,t.callback(r,t.id,u,t.bR),V)){f=-1;break}}for(f=0;f<l.length;f++)for(m=l[f],h=m.xm,n=0;n<h.length;n++)for(t=h[n],m=t.wk,t=0;t<m.length;t++)switch(u=m[t],u.type){case 30:q(u,0);break;case 40:q(u,0);break;case 60:q(u,0);break;case 70:q(u,
0);break;case 75:q(u,0);break;case 80:q(u,0);break;case 140:q(u,0)}for(f=0;f<R.length;f++){h=R[f];if(!h.lr){for(n=0;n<h.Se.length;n++)1==h.Se[n]?h.Se[n]=2:3==h.Se[n]&&(h.Se[n]=0);h.lr=!0}1==h.ye?h.ye=2:3==h.ye&&(h.ye=0);h.wx=0;h.Lv=h.im;h.Mv=h.jm;h.Se[0]=0;h.mh.set(h.ne);h.nh.set(h.De);h.BD=h.$w;h.TA=h.Wu;h.SA=h.Vu;h.Tu=h.Uu;h.iB=!1}U++};a.Oz=function(a){var b=m(10);q(b,a);return b};a.Pc=function(a){var b=m(20,document);b.key=a;b.Ka=!0;return b};a.Xt=function(a,b){var c=m(240,document);b=b||g.cI();
c.Ol=b;c.key=a;c.Ka=!0;return c};a.jn=function(a,b){var c=m(250,document);b=void 0==b?g.cI():b;c.Ol=b;c.key=a;c.Ka=!0;return c};a.Nz=function(a,b,c){if(!a||!H.na(a))return N.error("Wrong collision object"),null;var d=m(90);d.Ez=a;d.$b=b;d.Ah=c;d.Y={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.Dz=function(a,b,c,e,f){q(d,a);a=d.Y;a.coll_obj=b;d.Ah&&(a.coll_pos.set(c),a.coll_norm.set(e),a.coll_dist=f)};d.Ka=!0;return d};a.CG=function(a){if(!a||
!a.C)return N.error("Wrong collision impulse object"),null;var b=m(100);b.Cz=a;b.uG=function(a){q(b,a)};b.Ka=!0;return b};a.NG=function(a,b,c,d,e,f,g){var l=m(110);l.bi=a;l.from=b;l.to=c;l.$b=d;l.eJ=e;l.Ah=f;l.gv=g;l.Y={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Qr:0};l.CK=function(a,b,c,d,e,f){l.eJ?q(l,-1==b?0:1):q(l,b);l.Y.hit_fract=b;l.Y.obj_hit=c;l.Y.hit_time=d;l.Ah&&(l.Y.hit_pos.set(e),l.Y.hit_norm.set(f))};l.Ka=!0;return l};a.nq=function(a){a=
m(50,a);a.Ka=!0;a.Y={coords:new Float32Array(2),which:null};return a};a.Rz=function(a){a=m(30,a);a.Ka=!0;return a};a.ln=function(a,b){var c=m(40,b);c.axis=a||"XY";c.Y={coords:new Float32Array(2)};c.Ka=!0;return c};a.au=function(a,b){var c=m(60,b);c.axis=a||"XY";c.Y={coords:new Float32Array(2),gesture:0};c.Ka=!0;return c};a.Xz=function(a){a=m(70,a);a.Y=0;a.Ka=!0;return a};a.XG=function(a){a=m(75,a);a.Y=0;a.Ka=!0;return a};a.WG=function(a){a=m(80,a);a.Y={coords:new Float32Array(2)};a.Ka=!0;return a};
a.KG=function(a,b,c){if(!a)return N.error("Wrong collision object"),null;var d=m(120);d.bi=a;var e=P.F(a.k.n);a=P.R(a.k.n);d.wK=new Float32Array(4);d.Mo=new Float32Array(e);d.kw=new Float32Array(a);d.Bt=0;d.At=0;d.threshold=b||.1;d.NK=c||.1;d.Mf=0;d.Y=new Float32Array([0,0]);return d};a.YG=function(a,b){if(!a)return N.error("Wrong collision object"),null;var c=m(130);c.bi=a;var d=P.R(a.k.n);c.Mo=new Float32Array(P.F(a.k.n));c.kw=new Float32Array(d);c.Ct=0;c.threshold=b||1;c.Mf=0;c.Y=0;return c};a.VG=
function(a,b){var c=m(140);c.Gf=a;c.repeat=b;c.Ka=!0;return c};a.JK=function(a,b,c,d){a=a||C;a=a.jh;if(!a||!a[b])return N.error("reset_timer_sensor(): wrong object"),null;b=a[b].wk[c];if(!b)return N.error("reset_timer_sensor(): sensor not found"),null;b.Mf=D.Wq();b.Gf=d};a.Wt=function(){var a=m(150);a.Mf=0;return a};a.GG=function(){var a=m(180,window);a.Y=new Float32Array(3);g.ia(g.rh)?q(a,1):q(a,0);a.Ka=!0;return a};a.FG=function(){var a=m(190,window);a.Y=new Float32Array(3);g.ia(g.rh)?q(a,1):q(a,
0);a.Ka=!0;return a};a.HG=function(){var a=m(200,window);a.Y=O.create();g.ia(g.rh)?q(a,1):q(a,0);a.Ka=!0;return a};a.JG=function(){var a=m(210,window);a.Y=O.create();g.ia(g.Je)?q(a,1):q(a,0);a.Ka=!0;return a};a.IG=function(){var a=m(220,window);a.Y=M.create();g.ia(g.Je)?q(a,1):q(a,0);a.Ka=!0;return a};a.UG=function(){return m(160)};a.Zt=function(a,b){var c=m(170);c.bi=a;c.pH=b;c.Ka=!0;return c};a.Mz=function(a,b){var c=m(230);c.callback=a;q(c,b);return c};a.LG=function(a){a=m(260,a);a.Y={coords:new Float32Array(2)};
a.Ka=!0;return a};a.MG=function(a){a=m(270,a);a.Ka=!0;return a};a.zX=q;a.ag=function(a,b,c){a=a||C;a=a.jh;if(!a||!a[b])return N.error("get_sensor_value(): wrong object"),null;b=a[b].wk[c];return b?b.value:(N.error("get_sensor_value(): sensor not found"),null)};a.Kh=function(a,b,c){a=a||C;a=a.jh;if(!a||!a[b])return N.error("get_sensor_payload(): wrong object"),null;b=a[b].wk[c];return b?b.Y:(N.error("get_sensor_payload(): sensor not found"),null)};a.sa=function(){l=[];C={};for(var a=0;a<v.length;a++)x(v[a]);
v.length=0;e.length=0};a.Yp=function(a,b){a=a||C;if(!a.jh)return!1;if(b&&a.jh[b])return!0;if(!b)for(var c in a.jh)return!0;return!1};a.ua=function(a,c,f,k,h,m,p){a=a||C;a.xm=a.xm||[];a.jh=a.jh||{};var q=a.jh,t=a.xm;q[c]&&n(a,c);f={id:c,type:f,wk:k.slice(0),bW:h,AX:Array(k.length),callback:m,bR:p,Qi:-1,xJ:0,GV:Array(k.length),Lk:-1};q[c]=f;t.push(f);-1==l.indexOf(a)&&l.push(a);k=f.wk;for(a=0;a<k.length;a++){q=c=k[a];if(q.Ka){switch(q.type){case 90:H.Zy(q.Ez,q.$b,q.Dz,q.Ah);break;case 100:H.az(q.Cz,
q.uG);break;case 110:q.Qr=H.wt(q.bi,q.from,q.to,q.$b,q.CK,!1,!1,q.Ah,q.gv);q.Y.Qr=q.Qr;break;case 140:q.Mf=D.Wq();0>q.Gf&&(q.Gf=-q.Gf);break;case 20:t=d(q.element);b(t,"keyboard_downed_keys");break;case 30:t=d(q.element);b(t,"mouse_wheel");break;case 40:t=d(q.element);b(t,"mouse_down_which");b(t,"mouse_up_which");b(t,"mouse_location");break;case 260:t=d(q.element);b(t,"mouse_pointerlock");break;case 270:g.KP(q);break;case 50:t=d(q.element);b(t,"mouse_down_which");b(t,"mouse_up_which");break;case 60:t=
d(q.element);b(t,"touch_start");b(t,"touch_move");b(t,"touch_end");break;case 70:t=d(q.element);b(t,"touch_start");b(t,"touch_move");break;case 75:t=d(q.element);b(t,"touch_start");b(t,"touch_move");break;case 80:t=d(q.element);b(t,"touch_start");b(t,"touch_end");break;case 170:t=d(q.element);b(t,"mouse_select");b(t,"touch_select");b(t,"touch_start");b(t,"touch_end");b(t,"mouse_down_which");b(t,"mouse_up_which");break;case 180:case 190:t=d(q.element);b(t,"orientation_angles");break;case 200:t=d(q.element);
b(t,"orientation_quat");break;case 240:0==q.Ol?g.ia(g.Ns):1==q.Ol?g.ia(g.Mx):2==q.Ol?g.ia(g.Nx):g.ia(g.Ox)}q.Ka=!1}q=v.indexOf(c);-1==q?(v.push(c),e.push([f])):e[q].push(f)}V=!0};a.gu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.hu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.Vr=n;a.reset=function(){for(var a=0;a<l.length;a++){var b=l[a],c=b.jh,b=b.xm,d;for(d in c)delete c[d];b.length=0}for(a=0;a<v.length;a++)x(v[a]);l.length=
0;v.length=0;e.length=0};a.debug=function(){N.log(String(l.length)+" objects with manifolds",l);N.log(String(v.length)+" sensors",v);for(var a=[],b=[],c=0;c<v.length;c++){var d=v[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}N.log(String(a.length)+" collision sensors",a);N.log(String(b.length)+" ray sensors",b)};a.pL=function(a){Z=a}};b4w.module.__loader=function(a,r){function m(b,g,k,h){var c=D,l=N.create(),n;for(n in g){var m=d(g[n]);(h&&m.Ub||!b&&m.hc)&&f(m);N.J(l,m)}for(n in g)for(m=g[n],m.name=n,b=0;b<m.L.length;b++)N.r(l,g[m.L[b]],m,null);g=d({name:"out",Mb:a.yN,Zb:function(a,b,d,e,f){b.Lb&&(c.dD=!0);A(b)||(b.status=2);b.CJ(b.id,!0);f(b,d);H.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Wb:5});if(k)k=N.Vq(l);else{n=N.clone(l);do{k=N.Vq(n);m=[];for(b=0;b<k.length;b++){h=k[b];var e=N.Va(n,h);e.Pb&&m.push(h)}for(b=
0;b<m.length;b++)N.pg(n,m[b]);m.length&&N.yz(n)}while(m.length)}N.J(l,g);for(b=0;b<k.length;b++)h=k[b],e=N.Va(l,h),g.L.push(e.name),N.r(l,e,g,null);return l}function d(a){a.Pb=a.Pb||!1;a.Mb||0===a.Mb||(a.Mb=a.qe);a.L=a.L||[];a.$l=a.$l||!1;a.$C=a.$C||!1;a.Wb=a.Wb||0;a.Ub=a.Ub||!1;a.hc=a.hc||!1;a.status=0;a.Z5=0;a.tB=0;a.Up=a.Up||null;return a}function b(a,b){for(var d=[],f=[],c=0;c<b.length;c++){var g=b[c];N.Va(a.ci,g).$l&&(N.Ik(a.ci,g,function(c){var f=!0;N.fi(a.ci,c,function(a,b){if(!b.$l)return f=
!1,1});f&&-1==d.indexOf(c)&&-1==b.indexOf(c)&&d.push(c)}),f.push(c))}for(c=f.length-1;0<=c;c--)b.splice(f[c],1);return d}function t(a){function d(b,c){var e=N.Va(a.ci,b),f=N.Va(a.ci,c),g=f.Mb-e.Mb;0==g&&(g=e.Pb-f.Pb);return g}var f=[],g=a.ij,c=!1;do{var l=b(a,g);f.push.apply(f,g);0<l.length&&(c=!0);g=l}while(0<l.length);c&&f.sort(d);a.ij=f;return a.ij.length}function q(a,b,d){if(b.$C)return b.$l=!0,n(a,b),!1;if(!b.Zb&&!b.Ej&&!b.Tp)return n(a,b),!1;if(0==b.status&&(b.status++,b.Zb))return b.Zb(d,a,
b,b.Up,n,x),!0;if(1==b.status){if(b.Ej)return b.Ej(d,a,b,b.Up,n,x),!0;b.status++}return 2==b.status&&(b.status++,b.Tp)?(b.Tp(d,a,b,b.Up,n,x),!0):!1}function z(a){if(0==a.Tw)return 100;var b=0;N.oa(a.ci,function(d,f){a.do_not_load_resources&&f.Ub||(b+=f.tB*f.Wb)});return O.trunc(100*b/a.Tw)}function n(a,b){b.$l=!0;b.status=3;h(a,b,1)}function x(a,b,d){1>d?h(a,b,d):b.status++}function h(a,b,d){var f=D;if(b.Zb||b.Ej||b.Tp)if(b.tB=d,b=z(a),a.bH!=b||1==d)a.cD(b,performance.now()-a.wM),a.bH=b,f.vB=!0}function k(a,
b){var d=null;N.oa(a.ci,function(a,c){if(c.name==b)return d=c,1});return d}function f(a){a.$C=!0;a.tB=1}function y(a){a.cD=null;a.Fz=null;a.ci=null;a.ij=null}function g(){return 0==D.tt}function A(a){return a&&(3==a.status||4==a.status)}var N=r("__graph"),H=r("__print"),O=r("__util");a.qe=0;a.ug=1;a.yN=2;var D=null;a.NA=function(){return D};a.OG=function(){var a={lh:[],bA:0,tt:0,dD:!1,vB:!1};return D=a};a.TG=function(a,b,d,f,c,g,k,h,e){var n=D,p=n.lh.length,q={id:p,Lb:0==p,status:0,Pg:b,MF:"",CJ:d||
function(){},BJ:h||!1,V8:g,wM:0,bH:0,Tw:0,xC:!1,cD:f||function(){},Fz:c||function(){},ci:null,ij:null,WA:!1,UA:!1,ZA:!1,Zj:e};a=m(q.Lb,a,g,k);q.ci=a;b=[];d=N.PU(a);for(f=0;f<d.length;f++)b.push(d[f]);q.ij=b;N.oa(a,function(a,b){!(b.Zb||b.Ej||b.Tp)||q.do_not_load_resources&&b.Ub||(q.Tw+=b.Wb)});n.lh.push(q);n.tt++;return q.id};a.LZ=function(b){var d=D;if(d&&!g())if(d.vB)d.vB=!1;else{var f=performance.now();do{var k=d.lh[d.bA],c=b[k.id];if(!A(k))if(0==k.status&&(k.status=1,k.wM=performance.now(),k.cD(0,
0)),t(k)){var l=k,h=l.ij.length;do{var n=N.Va(l.ci,l.ij[0]),e=q(l,n,c);n.Mb==a.ug&&(l.xC=!0);n=l.ij.shift();l.ij.push(n);h--}while(!e&&0!=h)}else l=d,h=k,h.Fz(c,h),h.status=3,l.tt--,y(h);d.dD&&(d.bA=(d.bA+1)%d.lh.length);if(k.xC){k.xC=!1;break}}while(16>performance.now()-f)}};a.fF=function(a){var b=D;a.Fz(null,a);a.status=3;b.tt--;y(a);a.status=4;a.Lb&&(b.dD=!0);a.CJ(a.id,!1)};a.c8=x;a.Kw=function(a,b){var d=k(a,b);null!==d&&f(d)};a.$l=g;a.XY=A;a.Vg=function(a){var b=D;if(!b)return!1;a|=0;return b.lh[a]&&
(3==b.lh[a].status||2==b.lh[a].status)};a.WU=function(){H.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.sa=function(){D=null}};b4w.module.__md5=function(a){function r(a,n){var q=a[0],h=a[1],k=a[2],f=a[3],q=d(q,h,k,f,n[0],7,-680876936),f=d(f,q,h,k,n[1],12,-389564586),k=d(k,f,q,h,n[2],17,606105819),h=d(h,k,f,q,n[3],22,-1044525330),q=d(q,h,k,f,n[4],7,-176418897),f=d(f,q,h,k,n[5],12,1200080426),k=d(k,f,q,h,n[6],17,-1473231341),h=d(h,k,f,q,n[7],22,-45705983),q=d(q,h,k,f,n[8],7,1770035416),f=d(f,q,h,k,n[9],12,-1958414417),k=d(k,f,q,h,n[10],17,-42063),h=d(h,k,f,q,n[11],22,-1990404162),q=d(q,h,k,f,n[12],7,1804603682),f=d(f,q,h,k,
n[13],12,-40341101),k=d(k,f,q,h,n[14],17,-1502002290),h=d(h,k,f,q,n[15],22,1236535329),q=b(q,h,k,f,n[1],5,-165796510),f=b(f,q,h,k,n[6],9,-1069501632),k=b(k,f,q,h,n[11],14,643717713),h=b(h,k,f,q,n[0],20,-373897302),q=b(q,h,k,f,n[5],5,-701558691),f=b(f,q,h,k,n[10],9,38016083),k=b(k,f,q,h,n[15],14,-660478335),h=b(h,k,f,q,n[4],20,-405537848),q=b(q,h,k,f,n[9],5,568446438),f=b(f,q,h,k,n[14],9,-1019803690),k=b(k,f,q,h,n[3],14,-187363961),h=b(h,k,f,q,n[8],20,1163531501),q=b(q,h,k,f,n[13],5,-1444681467),f=
b(f,q,h,k,n[2],9,-51403784),k=b(k,f,q,h,n[7],14,1735328473),h=b(h,k,f,q,n[12],20,-1926607734),q=m(h^k^f,q,h,n[5],4,-378558),f=m(q^h^k,f,q,n[8],11,-2022574463),k=m(f^q^h,k,f,n[11],16,1839030562),h=m(k^f^q,h,k,n[14],23,-35309556),q=m(h^k^f,q,h,n[1],4,-1530992060),f=m(q^h^k,f,q,n[4],11,1272893353),k=m(f^q^h,k,f,n[7],16,-155497632),h=m(k^f^q,h,k,n[10],23,-1094730640),q=m(h^k^f,q,h,n[13],4,681279174),f=m(q^h^k,f,q,n[0],11,-358537222),k=m(f^q^h,k,f,n[3],16,-722521979),h=m(k^f^q,h,k,n[6],23,76029189),q=
m(h^k^f,q,h,n[9],4,-640364487),f=m(q^h^k,f,q,n[12],11,-421815835),k=m(f^q^h,k,f,n[15],16,530742520),h=m(k^f^q,h,k,n[2],23,-995338651),q=t(q,h,k,f,n[0],6,-198630844),f=t(f,q,h,k,n[7],10,1126891415),k=t(k,f,q,h,n[14],15,-1416354905),h=t(h,k,f,q,n[5],21,-57434055),q=t(q,h,k,f,n[12],6,1700485571),f=t(f,q,h,k,n[3],10,-1894986606),k=t(k,f,q,h,n[10],15,-1051523),h=t(h,k,f,q,n[1],21,-2054922799),q=t(q,h,k,f,n[8],6,1873313359),f=t(f,q,h,k,n[15],10,-30611744),k=t(k,f,q,h,n[6],15,-1560198380),h=t(h,k,f,q,n[13],
21,1309151649),q=t(q,h,k,f,n[4],6,-145523070),f=t(f,q,h,k,n[11],10,-1120210379),k=t(k,f,q,h,n[2],15,718787259),h=t(h,k,f,q,n[9],21,-343485551);a[0]=q+a[0]&4294967295;a[1]=h+a[1]&4294967295;a[2]=k+a[2]&4294967295;a[3]=f+a[3]&4294967295}function m(a,b,d,h,k,f){b=(b+a&4294967295)+(h+f&4294967295)&4294967295;return(b<<k|b>>>32-k)+d&4294967295}function d(a,b,d,h,k,f,q){return m(b&d|~b&h,a,b,k,f,q)}function b(a,b,d,h,k,f,q){return m(b&h|d&~h,a,b,k,f,q)}function t(a,b,d,h,k,f,q){return m(d^(b|~h),a,b,k,
f,q)}var q="0123456789abcdef".split("");a.VI=function(a){var b=a,d=b.length;a=[1732584193,-271733879,-1732584194,271733878];var h;for(h=64;h<=b.length;h+=64){for(var k=b.substring(h-64,h),f=[],m=void 0,m=0;64>m;m+=4)f[m>>2]=k.charCodeAt(m)+(k.charCodeAt(m+1)<<8)+(k.charCodeAt(m+2)<<16)+(k.charCodeAt(m+3)<<24);r(a,f)}b=b.substring(h-64);k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(h=0;h<b.length;h++)k[h>>2]|=b.charCodeAt(h)<<(h%4<<3);k[h>>2]|=128<<(h%4<<3);if(55<h)for(r(a,k),h=0;16>h;h++)k[h]=0;k[14]=8*
d;r(a,k);for(b=0;b<a.length;b++){d=a[b];h="";for(k=0;4>k;k++)h+=q[d>>8*k+4&15]+q[d>>8*k&15];a[b]=h}return a.join("")}};b4w.module.__logic_nodes=function(a,r){function m(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.sw;f++)if(K.ag(a,b,f))for(var g=0;g<c.rw.length;g++)if(c.rw[g]==f){e.km==c.sM?(N.Yj(e.qa)&&(c.state=-1),d.Lf.Cf||(c.state=1,c.fs=c.Av[g])):(c.state=1,c.fs=c.Av[g]);return}c.state=0}}}function d(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.sw;f++)if(K.ag(a,b,f)&&f==c.TK){if(N.Yj(e.qa)&&e.km==c.sM)c.state=-1;else if(!d.Lf.Cf||c.S.no_wait)c.state=
1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Oa:a.slot_idx_order,fs:a.slot_idx_jump,va:a.frame_range[0],Za:a.frame_range[1],VT:a.frame_range_mask?a.frame_range_mask[0]:!0,UT:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,sw:-1,TK:-1,DW:a.param_name,AW:a.operation,jc:a.mute,Bq:a.object,da:null,gc:null,oc:null,eb:{},Rf:a.anim_name,xc:y.Zk,FW:a.parse_json_vars,EW:a.parse_json_paths,Gc:a.objects_paths,VJ:a.nodes_paths,Fb:a.floats,S:a.bools,T:a.variables,jj:a.strings,
wB:a.materials_names,FL:a.shader_nd_type,te:a.common_usage_names,uT:a.encode_json_vars,tT:a.encode_json_paths,sM:b,sK:I[a.type]?I[a.type]:n,iw:!1,Zw:0,rw:null,TV:a.links,Av:[]}}function t(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function q(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function z(a,b,c){switch(b.state){case 2:c.la=a.Oa}}function n(a,b,c){switch(b.state){case 1:O.error("Unknown node type: "+a.type);break;case 2:c.la=a.Oa}}function x(a){return H.qc(H.Kc,a.Bq||[],0)}function h(a,c){var d=a.b4w_logic_nodes,
e=c.je;c.state=1;for(var f=0;f<d.length;f++){var g={X:[],Lf:{xb:a,la:0,Cf:!1,sD:f,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(g);for(var l=e[e.length-1],k=d[f],h=0;h<k.length;h++){var m=b(k[h],l);l.X.push(m)}for(k=0;k<l.X.length;k++)m=l.X[k],m.jc||m.sK(m,c,g.Lf,0,0)}var d=a.timeline_markers,n;for(n in d)c.gs.push(d[n]);c.gs.sort(function(a,b){return a-b});c.state=2;Y.push(c)}function k(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function f(a){switch(typeof a){case "string":return k(a,1);case "number":return k(a,0);default:return k(a,1)}}var y=r("__animation"),g=r("__assets"),A=r("__camera"),N=r("__nla"),H=r("__objects"),O=r("__print"),D=r("__scenes"),P=r("__config"),K=r("__controls"),M=r("__batch"),F=r("__geometry"),c=r("__mat3"),l=r("__mat4"),C=r("__physics"),v=r("__quat"),e=r("__sfx"),R=r("__time"),p=r("__transform"),ba=r("__tsr"),J=r("__util"),B=r("__vec3"),V=new Float32Array(4);new Float32Array(4);var U=new Float32Array(3),
Z=new Float32Array(3),w=new Float32Array(2),ga=new Float32Array(9),Q=new Float32Array(16);a.xO=0;a.yO=1;a.rO=0;a.qO=1;a.sO=2;a.tO=3;a.pO=4;a.uE=0;a.wE=1;a.vE=2;a.xE=3;a.yE=4;a.tE=5;a.wO=0;a.vO=1;a.uO=2;a.iO=0;a.jO=1;a.gO=2;a.hO=3;a.kO=0;a.lO=1;var I={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.la=a.Oa}},HIDE:function(a,b,c){switch(b.state){case 1:a.da=x(a);a.da||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);break;case 2:D.Wp(a.da,!0),c.la=a.Oa}},SHOW:function(a,
b,c){switch(b.state){case 1:a.da=x(a);a.da||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);break;case 2:D.Wp(a.da,!1),c.la=a.Oa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.T.vd;b=b.u;var e=c.u,f;a:{f=a.DW;var g=a.Fb.ptp,l=a.S.hsh,h=P.get("url_params");if(h&&f in h)f=Number(h[f]);else{if(l=l?location.hash:location.search)for(l=l.slice(1).split("&"),h=0;h<l.length;h++){var m=l[h].split("=");if(1<m.length&&m[0]==f){f=k(m[1],g);break a}}f=0}}q(d,b,e,f);c.la=a.Oa}},
SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.je[c.sD];var d=H.xI();a.rw=[];a.Av=[];for(var e in a.Gc){var f=H.qc(H.Kc,a.Gc[e],0),g=d.indexOf(f);if(-1==g){O.error("logic script error: non-selectable object:",a.Gc[e][a.Gc[e].length-1]);break a}a.rw.push(g);a.Av.push(a.TV[e])}a.state=-1;a.sw=d.length;e=[];for(g=0;g<d.length;g++)e.push(K.Zt(d[g],!1));K.ua(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,K.vg,e,K.hu,m(),[a,b,c])}break;case 2:if(-1==a.state){b=b.je[c.sD].X;for(f=0;f<b.length;f++)d=
b[f],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.la=a.state?a.fs:a.Oa,a.state=-1}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.je[c.sD];var e=x(a),f=H.xI(),g=f.indexOf(e);if(-1==g)O.error("logic script error: non-selectable object:",a.Bq[a.Bq.length-1]);else{a.state=-1;a.sw=f.length;a.TK=g;for(var g=[],l=0;l<f.length;l++)g.push(K.Zt(f[l],!1));K.ua(e,"LOGIC_NODES_SELECT_"+a.label,K.vg,g,K.hu,d(),[a,b,c])}break;case 2:if(0==a.state||1==a.state){c.la=a.state?a.fs:
a.Oa;a.state=-1;break}a.S.not_wait&&(c.la=a.Oa)}},PLAY:function(a,b,c,d){switch(b.state){case 1:N.aM();a.state=-1;a.S.not_wait||(a.S.not_wait=!1);break;case 2:switch(a.state){case -1:if(N.Yj(b.qa))if(b.$z==b.km&&c.Cf)break;else{var e=b.km;if(e){e.Lf.la=e.X[e.Lf.la].Oa;e.X[e.Lf.la].state=-1;for(var e=b.km.X,f=0;f<e.length;f++){var g=e[f];"PLAY"==g.type&&(g.state=-1)}}}c.Cf=!a.S.not_wait;b.km=b.$z;a.state=0;a.VT&&(N.YX(a.va),N.lL(d));if(a.UT)N.PC(a.Za);else{d=N.Uq(d);var e=-1,l;for(l in b.gs)if(d<b.gs[l]){e=
l;break}0<=e?N.PC(b.gs[e]):N.PC(N.eI())}N.PW();a.S.not_wait&&(c.la=a.Oa,a.state=-1,c.Cf=!1);break;case 0:N.Yj()||(c.la=a.Oa,a.state=-1,c.Cf=!1);break;case 1:c.la=a.Oa;a.state=-1;b.km=null;c.Cf=!1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.S.url?k(t(a.T.url,b.u,c.u),1):a.jj.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.T.v1[1]?a.Fb.inp1:k(t(a.T.v1,b.u,c.u),0),e=-1==a.T.v2[1]?a.Fb.inp2:
k(t(a.T.v2,b.u,c.u),0),f=0;switch(a.AW){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;case "DIV":0==e&&J.q("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}q(a.T.vd,b.u,c.u,f);c.la=a.Oa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.S.str?1:0,e=a.S.str?a.jj:a.Fb,f=-1==a.T.v1[1]?e.inp1:k(t(a.T.v1,b.u,c.u),d);b=-1==a.T.v2[1]?e.inp2:k(t(a.T.v2,b.u,c.u),d);d=!1;switch(a.te.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0);break;
case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.la=d?a.fs:a.Oa}},REGSTORE:function(a,b,c){switch(b.state){case 2:q([a.S.gl||a.T.vd[0],a.T.vd[1]],b.u,c.u,(1==a.te.variable_type?a.jj:a.Fb).inp1),c.la=a.Oa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.da=a.S.env?H.Pu(a.Bq[0],0):x(a);a.da||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);break;case 2:switch(0!=a.state||y.Yj(a.da,a.xc)||(a.state=1),a.state){case -1:for(var d in b.je){var e=
b.je[d].Lf.la;-1!=e&&(e=b.je[d].X[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.da==a.da&&(e.state=1))}b=a.te.param_anim_behavior;if(""==a.Rf)y.xt(a.da),y.cs(a.da,b,y.Zk);else{a:{d=a.da;for(var e=a.Rf,f=-1,g=0;8>g;g++){var l=d.ha[g];if(l&&l.ui&&y.dM(l.ui)==y.dM(e))if(-1!=f)f=g;else{d=-1;break a}}d=f}-1==d?(a.xc=y.rY(a.da,a.Rf),y.apply(a.da,null,a.Rf,a.xc)):a.xc=d;y.cs(a.da,b,a.xc)}a.S.not_wait||(c.Cf=!0);y.play(a.da,null,a.xc);a.state=0;a.S.not_wait&&(c.la=a.Oa,a.state=-1);break;case 0:break;case 1:a.S.not_wait||
(c.Cf=!1);c.la=a.Oa;a.state=-1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:z,SEND_REQ:function(a,b,c){function d(a,e,f,g,l){a=JSON.stringify(a);q(l[0].T.dst,b.u,c.u,a);l[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.S.url?k(t(a.T.url,b.u,c.u),1):a.jj.url,f={};a.S.ct&&(f["Content-Type"]=a.jj.ct);"GET"==a.te.request_type?g.Td([{id:e,type:g.Sm,url:e,mk:f,Hb:[a,c.u]}],d,null,null,null):"POST"==a.te.request_type&&g.Td([{id:e,type:g.Sm,url:e,mk:f,
Yh:"POST",fo:g.Sm,sm:k(t(a.T.dst1,b.u,c.u),1),Hb:[a,c.u]}],d,null,null,null);break;case 1:a.state=-1,c.la=a.Oa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.eb["id"+b]=H.qc(H.Kc,a.Gc["id"+b],0),a.eb["id"+b]||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);break;case 2:M.hV(a.eb.id0,a.wB.id0,a.eb.id1,a.wB.id1),c.la=a.Oa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Gc.id0&&(a.eb.id0=H.qc(H.Kc,a.Gc.id0,0),a.Gc.id0||(O.error("Logic script error: object not found. Node: ",
a.name),a.jc=!0),a.VJ.id0.unshift(a.wB.id0));break;case 2:var d=a.eb.id0,e=a.VJ.id0,f=e[0],g=M.LT(d,f,"MAIN");c.la=a.Oa;if(null===g){O.error('Material "'+f+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.FL){var l=M.mI(g.Wi,e);M.UX(d,f,l,a.S.id0?k(t(a.T.id0,b.u,c.u),0):a.Fb.id0,a.S.id1?k(t(a.T.id1,b.u,c.u),0):a.Fb.id1,a.S.id2?k(t(a.T.id2,b.u,c.u),0):a.Fb.id2)}"ShaderNodeValue"==a.FL&&(l=M.mI(g.Xi,e),M.VX(d,f,l,a.S.id0?k(t(a.T.id0,b.u,c.u),0):a.Fb.id0))}},DELAY:function(a,
b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.Zw=0,c.Cf=!0):0==a.state&&(a.Zw+=e,(a.S.dl?k(t(a.T.dl,b.u,c.u),0):a.Fb.dl)<a.Zw&&(a.state=-1,c.la=a.Oa,c.Cf=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.eb.id0=H.qc(H.Kc,a.Gc.id0,0);b||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);c=a.te.sk;F.wR(b)?F.aV(b,c)||(O.error("Wrong key name:",c),a.jc=!0):(O.error("No shape keys in object:",b.name),a.jc=!0);break;case 2:F.nQ(a.eb.id0,a.te.sk,a.S.skv?k(t(a.T.skv,
b.u,c.u),0):a.Fb.skv),c.la=a.Oa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.eb.id0=H.qc(H.Kc,a.Gc.id0,0);d||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);d&&d.k&&d.k.Tc||(O.error("Can't evaluate 'Outline' logic node: wrong object"),a.jc=!0);break;case 2:d=a.eb.id0;switch(a.te.outline_operation){case "PLAY":b=d.k.Th;H.dn(d,b.jk,b.kk,b.lk);break;case "STOP":H.Nt(d);break;case "INTENSITY":d.k.dh=a.S["in"]?k(t(a.T["in"],b.u,c.u),0):a.Fb["in"]}c.la=a.Oa}},MOVE_CAMERA:function(a,
b,d){function e(a,b,c,d){switch(A.Tl(a)){case A.Ib:A.ds(a,b,c);break;case A.nd:case A.xg:p.fj(a,d);break;case A.bd:B.sub(c,b,U),B.normalize(U,U),A.Aw(a,c),c=b=0,Z[0]=U[0],Z[1]=0,Z[2]=U[2],b=B.dot(Z,U),c=Math.acos(b/(B.length(Z)*B.length(U))),b=U[2]?Math.atan(U[0]/U[2]):0<U[0]?0:Math.PI,0<U[2]&&0<U[0]?w[1]=-(Math.PI+w[1]):0<U[2]&&0>U[0]?w[1]=-(Math.PI+w[1]):0>U[2]&&0>U[0]?(w[0]+=Math.PI,b=-(Math.PI-b)):0>U[2]&&0<U[0]&&(w[0]+=Math.PI,b-=Math.PI),A.Xr(a,b+Math.PI,-c,!0,!0)}p.D(a);C.H(a)}function f(a,
b,d,e){l.lookAt(b,d,J.$c,Q);l.invert(Q,Q);c.fromMat4(Q,ga);v.fromMat3(ga,V);v.normalize(V,V);ba.$h(b,ba.Xd(a.k.n),V,e)}switch(b.state){case 1:d=null;d=a.eb.ca=H.qc(H.Kc,a.Gc.id0,0);d||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);a.eb.tr=H.qc(H.Kc,a.Gc.id1,0);a.eb.tr||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);a.eb.ta=H.qc(H.Kc,a.Gc.id2,0);a.eb.ta||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);a.state=-1;a.oc={BM:new Float32Array(3),
AM:new Float32Array(3),dB:new Float32Array(3),oD:new Float32Array(3),nM:new Float32Array(3),cB:new Float32Array(3),Kk:new Float32Array(8),gi:new Float32Array(8),er:new Float32Array(8)};break;case 2:var g=a.eb.ca,h=ba.F(a.eb.tr.k.n),m=ba.F(a.eb.ta.k.n);switch(a.state){case -1:b=a.S.dur?k(t(a.T.dur,b.u,d.u),0):a.Fb.dur;if(0==b){f(g,h,m,a.oc.gi);e(g,h,m,a.oc.gi);d.la=a.Oa;break}B.copy(ba.F(g.k.n),a.oc.BM);var n=A.Tl(g);n==A.bd?B.copy(g.k.Tb,a.oc.oD):n==A.xg||n==A.nd?(ba.copy(g.k.n,a.oc.Kk),f(g,h,m,a.oc.gi)):
B.copy(g.k.pivot,a.oc.oD);B.copy(h,a.oc.AM);B.copy(m,a.oc.nM);a.state=0;var q=R.bn(0,1,1E3*b,function(b){D.Ca()&&(n==A.xg||n==A.nd?ba.eB(a.oc.Kk,a.oc.gi,J.Am(b),a.oc.er):(a.oc.cB=B.lerp(a.oc.oD,a.oc.nM,J.Am(b),a.oc.cB),a.oc.dB=B.lerp(a.oc.BM,a.oc.AM,J.Am(b),a.oc.dB)),e(g,a.oc.dB,a.oc.cB,a.oc.er),1==b&&(a.state=1))});break;case 1:R.Mt(q),a.state=-1,d.la=a.Oa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d=null,d=a.eb.ca=H.qc(H.Kc,a.Gc.id0,0);d||(O.error("Logic script error: object not found. Node: ",
a.name),a.jc=!0);b=d.k;a.cR={Hk:b.Hk,use_panning:b.use_panning,lb:b.lb,ka:b.ka,sb:b.sb,yc:b.yc,zc:b.zc,ae:b.ae,Gh:b.Gh};break;case 2:var d=a.eb.ca,e=d.k,f=a.cR;A.Hs(d);switch(a.te.camera_move_style){case 0:e.tb=A.xg;break;case 2:e.tb=A.nd;var g=ba.F(e.n);A.BL(d,g,null,f.lb,f.ka);break;case 3:e.tb=A.bd;var g=ba.F(e.n),l=U;a.S.pvo?(l=H.qc(H.Kc,a.Gc.id1,0),l=ba.F(l.k.n)):(l[0]=a.S.pvx?k(t(a.T.pvx,b.u,c.u),0):a.Fb.pvx,l[1]=a.S.pvy?k(t(a.T.pvy,b.u,c.u),0):a.Fb.pvy,l[2]=a.S.pvz?k(t(a.T.pvz,b.u,c.u),0):
a.Fb.pvz);A.CL(d,g,l,f.sb,f.ka,f.yc,f.zc,f.Gh);break;case 1:e.tb=A.Ib,g=ba.F(e.n),l=U,a.S.pvo?(l=H.qc(H.Kc,a.Gc.id1,0),l=ba.F(l.k.n)):(l[0]=a.S.pvx?k(t(a.T.pvx,b.u,c.u),0):a.Fb.pvx,l[1]=a.S.pvy?k(t(a.T.pvy,b.u,c.u),0):a.Fb.pvy,l[2]=a.S.pvz?k(t(a.T.pvz,b.u,c.u),0):a.Fb.pvz),A.DL(d,g,l,f.lb,f.ka,f.K2,f.ae,f.use_panning)}Z[0]=a.S.vtr?k(t(a.T.vtr,b.u,c.u),0):a.Fb.vtr;Z[1]=a.S.vro?k(t(a.T.vro,b.u,c.u),0):a.Fb.vro;Z[2]=a.S.vzo?k(t(a.T.vzo,b.u,c.u),0):a.Fb.vzo;Z[0]=J.V(Z[0],0,Infinity);Z[1]=J.V(Z[1],0,Infinity);
Z[2]=J.V(Z[2],0,.99);e.Qk=Z[0];e.Pk=Z[1];e.Rk=Z[2];p.D(d);C.H(d);A.Jn(d);c.la=a.Oa}},MOVE_TO:function(a,b,c){function d(a,b){p.fj(a,b);p.D(a);C.H(a)}switch(b.state){case 1:a.eb.ob=H.qc(H.Kc,a.Gc.id0,0);a.eb.ob||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);a.eb.de=H.qc(H.Kc,a.Gc.id1,0);a.eb.de||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);a.state=-1;a.gc={kH:new Float32Array(8),gA:new Float32Array(8),dJ:new Float32Array(8)};break;case 2:var e=
a.eb.ob;ba.copy(a.eb.ob.k.n,a.gc.kH);ba.copy(a.eb.de.k.n,a.gc.gA);switch(a.state){case -1:b=a.S.dur?k(t(a.T.dur,b.u,c.u),0):a.Fb.dur;if(0==b){d(e,a.gc.gA);c.la=a.Oa;break}a.state=0;var f=R.bn(0,1,1E3*b,function(b){D.Ca()&&(a.gc.D5=ba.eB(a.gc.kH,a.gc.gA,J.Am(b),a.gc.dJ),d(e,a.gc.dJ),1==b&&(a.state=1))});break;case 1:R.Mt(f),a.state=-1,c.la=a.Oa}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?p.fj(a,b):p.Fw(a,b);p.D(a);C.H(a)}switch(b.state){case 1:a.eb.ob=H.qc(H.Kc,a.Gc.id0,0);a.eb.ob||
(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);a.state=-1;a.gc={Rw:0,Kk:new Float32Array(8),gi:new Float32Array(8),er:new Float32Array(8)};break;case 2:var e=a.eb.ob;switch(a.state){case -1:Z[0]=a.S.trx?k(t(a.T.trx,b.u,c.u),0):a.Fb.trx;Z[1]=a.S["try"]?k(t(a.T["try"],b.u,c.u),0):a.Fb["try"];Z[2]=a.S.trz?k(t(a.T.trz,b.u,c.u),0):a.Fb.trz;U[0]=a.S.rox?k(t(a.T.rox,b.u,c.u),0)*Math.PI/180:a.Fb.rox;U[1]=a.S.roy?k(t(a.T.roy,b.u,c.u),0)*Math.PI/180:a.Fb.roy;U[2]=a.S.roz?k(t(a.T.roz,
b.u,c.u),0)*Math.PI/180:a.Fb.roz;var f=a.S.sc?t(a.T.sc,b.u,c.u):a.Fb.sc;J.Oj(U,V);ba.$h(Z,f,V,a.gc.gi);a.gc.Rw=a.te.space_type;switch(a.gc.Rw){case 0:p.Xq(e,a.gc.Kk);break;case 1:p.Yq(e,a.gc.Kk);break;case 2:p.Yq(e,a.gc.Kk),ba.multiply(a.gc.Kk,a.gc.gi,a.gc.gi)}b=a.S.dur?k(t(a.T.dur,b.u,c.u),0):a.Fb.dur;if(0==b){d(e,a.gc.gi,a.gc.Rw);c.la=a.Oa;break}a.state=0;f=R.bn(0,1,1E3*b,function(b){D.Ca()&&(ba.eB(a.gc.Kk,a.gc.gi,J.Am(b),a.gc.er),d(e,a.gc.er,a.gc.Rw),1==b&&(a.state=1))});break;case 1:R.Mt(f),a.state=
-1,c.la=a.Oa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.da=H.qc(H.Kc,a.Gc.id0,0);a.da||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);void 0==a.S.not_wait&&(a.S.not_wait=!0);break;case 2:switch(e.yV(a.da)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.je){var f=b.je[d].Lf.la;-1!=f&&(f=b.je[d].X[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.da==a.da&&(f.state=1))}a.S.not_wait||(c.Cf=!0);e.kK(a.da);a.state=0;break;case 0:a.S.not_wait&&(c.la=a.Oa,a.state=
-1);break;case 1:a.S.not_wait||(c.Cf=!1);c.la=a.Oa;a.state=-1;break;default:J.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.da=H.qc(H.Kc,a.Gc.id0,0);a.da||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);break;case 2:e.stop(a.da),c.la=a.Oa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.da=a.S.env?H.Pu(a.Bq[0],0):x(a);a.da||(O.error("Logic script error: object not found. Node: ",a.name),a.jc=!0);break;case 2:y.stop(a.da,
y.Zk),a.S.rst&&y.KC(a.da,y.Zk),c.la=a.Oa}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.S.rst&&N.lL(d),N.aM(),c.la=a.Oa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.T)d[a.T[e][1]]=t(a.T[e],b.u,c.u);O.log(a.te.msg,JSON.stringify(d));c.la=a.Oa}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.S.id0?k(t(a.T.id0,b.u,c.u),1):a.jj.id0,e=a.S.id1?k(t(a.T.id1,b.u,c.u),1):a.jj.id1,f=0;switch(a.te.string_operation){case 0:f=d+e;break;case 1:f=d.indexOf(e);break;
case 2:f=d.replace(e,a.S.id2?k(t(a.T.id2,b.u,c.u),1):a.jj.id2);break;case 3:var g=a.T,f=d.substring(0,d.indexOf(e));q(g.dst1,b.u,c.u,d.substring(d.indexOf(e)+1,d.length));""==t(g.dst,b.u,c.u)&&(f=t(g.dst1,b.u,c.u),q(g.dst1,b.u,c.u,""));break;case 4:switch(a.te.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}q(a.T.dst,b.u,c.u,f);c.la=a.Oa}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=a.S.nla?
k(N.Uq(d),0):k(R.Uq(d),0),q(a.T.vd,b.u,c.u,d),c.la=a.Oa}},JSON:function(a,b,c){function d(a,b,c,e){for(var g=0;g<b.length;g++){for(var l=b[g].split("."),k=a,h=c[g],m=0;m<l.length&&(k=k[l[m]],void 0!==k&&null!==k);m++);k=f(k);e[h]=k}}function e(a,b,c,d){d||(d={});for(var g=0;g<b.length;g++){var l=b[g].split("."),k=d,h=c[g];if(!(!h in a)){for(var m=0;m<l.length-1;m++)void 0===k[l[m]]&&(k[l[m]]=isNaN(l[m+1])?{}:[]),k=k[l[m]];k[l[l.length-1]]=f(a[h])}}}switch(b.state){case 2:switch(a.te.json_operation){case "PARSE":try{var g=
JSON.parse(k(t(a.T.jsn,b.u,c.u),1));d(g,a.EW,a.FW,c.u)}catch(l){O.error("logic script error: non valid JSON string")}break;case "ENCODE":g={},e(c.u,a.tT,a.uT,g),g=k(JSON.stringify(g),1),q(a.T.jsn,b.u,c.u,g)}c.la=a.Oa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.S.cb?k(t(a.T.cb,b.u,c.u),1):a.jj.cb,e=[],g=0,l="id"+g,h=a.te.js_cb_params;l in h;)l=0==h[l]?H.qc(H.Kc,a.Gc[l],0):t(a.T[l],b.u,c.u),e.push(l),g++,l="id"+g;h=[];g=0;for(l="out"+g;l in a.T;)l=t(a.T[l],b.u,c.u),h.push(l),g++,
l="out"+g;g=1;if(d in ia){if(g=!ia[d](e,h))for(d=0;d<h.length;d++)l="out"+d,l in a.T&&q(a.T[l],b.u,c.u,f(h[d]))}else O.error("logic script error: no custom callback with id "+d);g&&(c.la=a.Oa)}},EMPTY:z},Y=[],ia={};a.iV=function(a,b){var c={Qe:b,RK:a.name,state:0,km:null,xb:a,$z:null,je:[],gs:[],u:{}};a.c1=c;h(a,c)};a.update=function(a,b){var c=N.RU();if(!(0>=c))for(var d=0;d<Y.length;d++)for(var e=d,f=a,g=b,l=c,k=Y[e],h=0;h<Y[e].je.length;h++){k.$z=Y[e].je[h];var m=Y[e].je[h],n=k,p=f,q=g,v=l,C=m.X;
if(C.length){for(var t=0;t<C.length;t++)C[t].iw=!1;for(t=0;t<C.length;t++){if(0<=m.Lf.la)var r=C[m.Lf.la];else break;if(r.iw)break;if(r.jc)if("ENTRYPOINT"==r.type)break;else m.Lf.la=r.Oa,r.iw=!0;else r.sK(r,n,m.Lf,p,q,v),r.iw=!0}}}};a.g1=function(a,b){ia[a]=b};a.H6=function(a){delete ia[a]};a.T6=function(a,b){for(var c=0;c<Y.length;c++)if(Y[c].RK==a){for(var c=Y[c],d=0;d<c.je.length;d++){var e=c.je[d].X[0];if(e.name==b){e.S.js&&(e.jc=!1);c.je[d].Lf.la=0;break}}break}};a.sa=function(){Y.length=0;ia=
{}}};b4w.module.__reformer=function(a,r){function m(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function d(a){if(a=a.nla_tracks)for(var d=0;d<a.length;d++)for(var c=a[d],f=0;f<c.strips.length;f++){var g=c.strips[f];"action"in g||(g.action=null,b("strip",g,"action"));"action_frame_start"in g||(g.action_frame_start=0,b("strip",g,"action_frame_start"));"action_frame_end"in g||(g.action_frame_end=g.frame_end-g.frame_start,b("strip",g,"action_frame_end"));"repeat"in g||(g.repeat=1,b("strip",g,"repeat"));
"use_reverse"in g||(g.use_reverse=!1,b("strip",g,"use_reverse"));"scale"in g||(g.scale=1,b("strip",g,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={eD:[],IK:"undefined",type:a});D[c].eD.push(b.name)}function t(a,b,c){c=c+">>"+a;c in D||(D[c]={eD:[],IK:"deprecated",type:a});D[c].eD.push(b.name)}function q(a){k.warn(a)}function z(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var f=y.Bh(a);a.materials=c;a.submeshes=d;f.name=b;f.materials=a.materials.slice(0);
f.submeshes=[];for(c=0;c<d.length;c++){var g=y.bq(d[c]);f.submeshes.push(g)}return f}var n=r("__boundings"),x=r("__curve"),h=r("__mat4"),k=r("__print"),f=r("__quat"),y=r("__util"),g=r("__vec3"),A=r("__mat3"),N=r("__logic_nodes"),H=r("__animation"),O=[5,4],D={},P=A.create(),K=f.create();a.kG=function(a){return-1!=y.fN(a,O)};a.mR=function(a){D={};var f=a.worlds;if(0==f.length){k.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var c={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};f.push(c)}for(var f=a.worlds,g=0;g<f.length;g++){c=f[g];"use_sky_blend"in c||(b("world",c,"use_sky_blend"),c.use_sky_blend=!1);"use_sky_paper"in c||(b("world",c,"use_sky_paper"),
c.use_sky_paper=!1);"use_sky_real"in c||(b("world",c,"use_sky_real"),c.use_sky_real=!1);"b4w_sky_settings"in c&&"rayleigh_brightness"in c.b4w_sky_settings||(b("world",c,"rayleigh_brightness"),c.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
c||(b("world",c,"fog_settings"),c.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in c&&(c.fog_settings.use_custom_color=!0,c.fog_settings.color=c.b4w_fog_color),"b4w_fog_density"in c&&0<c.b4w_fog_density&&(c.fog_settings.depth=1/c.b4w_fog_density));"render_sky"in c.b4w_sky_settings||(b("world",c,"render_sky"),c.b4w_sky_settings.render_sky=!1);for(var h=c.texture_slots,n=0;n<h.length;n++){var e=h[n];"blend_type"in
e||(e.blend_type="MIX",b("world_texture_slot",e,"blend_type"));"use_map_blend"in e||(e.use_map_blend=!1,b("world_texture_slot",e,"use_map_blend"));"use_map_horizon"in e||(e.use_map_horizon=!0,b("world_texture_slot",e,"use_map_horizon"));"use_map_zenith_up"in e||(e.use_map_zenith_up=!1,b("world_texture_slot",e,"use_map_zenith_up"));"use_rgb_to_intensity"in e||(e.use_rgb_to_intensity=!1,b("world_texture_slot",e,"use_rgb_to_intensity"));"invert"in e||(e.invert=!1,b("world_texture_slot",e,"invert"));
"color"in e||(e.color=[1,0,1],b("world_texture_slot",e,"color"));"blend_factor"in e||(e.blend_factor=0,b("world_texture_slot",e,"blend_factor"));"horizon_factor"in e||(e.horizon_factor=1,b("world_texture_slot",e,"horizon_factor"));"zenith_up_factor"in e||(e.zenith_up_factor=0,b("world_texture_slot",e,"zenith_up_factor"));"zenith_down_factor"in e||(e.zenith_down_factor=0,b("world_texture_slot",e,"zenith_down_factor"));"default_value"in e||(e.default_value=1,b("world_texture_slot",e,"default_value"))}"b4w_use_default_animation"in
c||(b("world",c,"b4w_use_default_animation"),c.b4w_use_default_animation=!1);"b4w_anim_behavior"in c||(b("world",c,"b4w_anim_behavior"),c.b4w_anim_behavior="CYCLIC")}n=a.scenes;for(g=0;g<n.length;g++)h=n[g],e=h.world,"timeline_markers"in h||(h.timeline_markers=null,b("scene",h,"timeline_markers")),"b4w_reflection_quality"in h||(h.b4w_reflection_quality="MEDIUM",b("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,b("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,b("scene",h,
"fps")),"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,b("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],b("scene",h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(t("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in h||(h.b4w_enable_bloom=!1,b("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,b("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=!1,b("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",b("scene",h,"b4w_antialiasing_quality")),
"b4w_tags"in h||(h.b4w_tags={title:"",description:""},b("scene",h,"b4w_tags")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection="AUTO",b("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",b("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in h||(h.b4w_enable_glow_materials="AUTO",b("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility="AUTO",b("scene",h,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],b("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor="b4w_glow_factor"in h?h.b4w_glow_factor:1,b("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(b("scene",h,"b4w_shadow_settings"),f=e.b4w_shadow_settings,h.b4w_shadow_settings=f?f:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),f=h.b4w_shadow_settings,"csm_resolution"in f||(b("scene",h,"b4w_shadow_settings.csm_resolution"),f.csm_resolution=2048),"blur_samples"in f||(b("scene",h,"b4w_shadow_settings.blur_samples"),f.blur_samples="16x"),"soft_shadows"in f||(b("scene",h,"b4w_shadow_settings.soft_shadows"),f.soft_shadows=!0),"self_shadow_polygon_offset"in f||(b("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),f.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in f||(b("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),f.self_shadow_normal_offset=.01),"b4w_enable_csm"in f||(b("scene",h,"b4w_shadow_settings.b4w_enable_csm"),f.b4w_enable_csm=!1),"csm_num"in f||(b("scene",h,"b4w_shadow_settings.csm_num"),f.csm_num=1),"csm_first_cascade_border"in f||(b("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),f.csm_first_cascade_border=10),"first_cascade_blur_radius"in f||(b("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),
f.first_cascade_blur_radius=3),"csm_last_cascade_border"in f||(b("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),f.csm_last_cascade_border=100),"last_cascade_blur_radius"in f||(b("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),f.last_cascade_blur_radius=1.5),"fade_last_cascade"in f||(b("scene",h,"b4w_shadow_settings.fade_last_cascade"),f.fade_last_cascade=!0),"blend_between_cascades"in f||(b("scene",h,"b4w_shadow_settings.blend_between_cascades"),f.blend_between_cascades=!0),"b4w_ssao_settings"in
h||(b("scene",h,"b4w_ssao_settings"),f=e.b4w_ssao_settings,h.b4w_ssao_settings=f?f:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),f=h.b4w_ssao_settings,"dist_factor"in f||(b("scene",h,"b4w_ssao_settings.dist_factor"),f.dist_factor=0),"samples"in f||(b("scene",h,"b4w_ssao_settings.samples"),f.samples=16),"hemisphere"in f||(b("scene",h,"b4w_ssao_settings.hemisphere"),f.hemisphere=!1),"blur_depth"in f||(b("scene",h,"b4w_ssao_settings.blur_depth"),f.blur_depth=!1),"blur_discard_value"in
f||(b("scene",h,"b4w_ssao_settings.blur_discard_value"),f.blur_discard_value=1),"b4w_bloom_settings"in h||(b("scene",h,"b4w_bloom_settings"),f=e.b4w_bloom_settings,h.b4w_bloom_settings=f?f:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=.2),"blur"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in h||(b("scene",h,"b4w_motion_blur_settings"),f=e.b4w_motion_blur_settings,h.b4w_motion_blur_settings=f?f:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in h||(b("scene",h,"b4w_color_correction_settings"),f=e.b4w_color_correction_settings,h.b4w_color_correction_settings=f?f:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in h||(b("scene",h,"b4w_god_rays_settings"),f=e.b4w_god_rays_settings,h.b4w_god_rays_settings=f?f:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(b("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in h||(b("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},f=h.b4w_glow_settings,"b4w_render_glow_over_blend"in e&&(f.render_glow_over_blend=e.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in e&&(f.small_glow_mask_coeff=e.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in e&&(f.large_glow_mask_coeff=e.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
e&&(f.small_glow_mask_width=e.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in e&&(f.large_glow_mask_width=e.b4w_large_glow_mask_width)),e=h.b4w_render_shadows,"AUTO"!=e&&"OFF"!=e&&"ON"!=e&&(h.b4w_render_shadows=e?"ON":"OFF"),e=h.b4w_render_reflections,"OFF"!=e&&"ON"!=e&&(h.b4w_render_reflections=e?"ON":"OFF"),e=h.b4w_render_refractions,"AUTO"!=e&&"OFF"!=e&&"ON"!=e&&(h.b4w_render_refractions=e?"ON":"OFF"),"b4w_render_dynamic_grass"in h||(b("scene",h,"b4w_render_dynamic_grass"),h.b4w_render_dynamic_grass=
"AUTO"),h.b4w_nla_script&&t("scene",h,"b4w_nla_script"),"audio_distance_model"in h||(b("scene",h,"audio_distance_model"),h.audio_distance_model="INVERSE_CLAMPED");h=a.meshes;for(g=0;g<h.length;g++){e=h[g];e.b4w_boundings||(b("mesh",e,"b4w_boundings"),e.b4w_boundings={},f=e.b4w_boundings,f.bb=e.b4w_bounding_box?e.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},f.bb_src=e.b4w_bounding_box_source?e.b4w_bounding_box_source:e.b4w_bounding_box,f.bs_cen=e.b4w_bounding_sphere_center?e.b4w_bounding_sphere_center:
[0,0,0],f.bc_cen=e.b4w_bounding_cylinder_center?e.b4w_bounding_cylinder_center:[0,0,0],f.be_cen=e.b4w_bounding_ellipsoid_center?e.b4w_bounding_ellipsoid_center:[0,0,0],e.b4w_bounding_ellipsoid_axes?f.be_ax=e.b4w_bounding_ellipsoid_axes:(n=f.bb,f.be_ax=[(n.max_x-n.min_x)/2,(n.max_y-n.min_y)/2,(n.max_z-n.min_z)/2]),e.b4w_rotated_bounding_box?f.rbb=e.b4w_rotated_bounding_box:(n=f.bb,f.rbb={rbb_c:[(n.max_x+n.min_x)/2,(n.max_y+n.min_y)/2,(n.max_z+n.min_z)/2],rbb_s:[1,1,1]}),f.caxis_x=e.b4w_cov_axis_x?
e.b4w_cov_axis_x:[1,0,0],f.caxis_y=e.b4w_cov_axis_y?e.b4w_cov_axis_y:[0,1,0],f.caxis_z=e.b4w_cov_axis_z?e.b4w_cov_axis_z:[0,0,1]);e.uv_textures||(b("mesh",e,"uv_textures"),e.uv_textures=[]);"b4w_shape_keys"in e||(e.b4w_shape_keys=[],b("mesh",e,"b4w_shape_keys"));f=!0;for(c=0;c<e.submeshes.length;c++){var r=e.submeshes[c];"boundings"in r||(f=!1,r.boundings={be_ax:e.b4w_bounding_ellipsoid_axes,be_cen:e.b4w_bounding_ellipsoid_center,bb:{max_x:e.b4w_bounding_box.max_x,max_y:e.b4w_bounding_box.max_y,max_z:e.b4w_bounding_box.max_z,
min_x:e.b4w_bounding_box.min_x,min_y:e.b4w_bounding_box.min_y,min_z:e.b4w_bounding_box.min_z}});"be_ax"in r.boundings||(r.boundings.be_ax=e.b4w_bounding_ellipsoid_axes);"be_cen"in r.boundings||(r.boundings.be_cen=e.b4w_bounding_ellipsoid_center);"bb"in r.boundings||(r.boundings.bb=e.b4w_bounding_box);"rbb"in r.boundings||(n=e.b4w_bounding_box,r.boundings.rbb={rbb_c:[(n.max_x+n.min_x)/2,(n.max_y+n.min_y)/2,(n.max_z+n.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in r.boundings||(r.boundings.caxis_x=[1,0,0]);
"caxis_y"in r.boundings||(r.boundings.caxis_y=[0,1,0]);"caxis_z"in r.boundings||(r.boundings.caxis_z=[0,0,1])}f||b("mesh",e,"submesh_bd");n=e;f=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];c=null;for(r=0;r<f.length;r++)n[f[r]]&&(c?(n[f[r]]=!1,k.warn('WARNING property "'+f[r]+'" of object "'+n.name+'" has been set to "false". Foreground property "'+c+'" already exists.')):c=f[r]);for(n=0;n<e.b4w_vertex_anim.length;n++)f=e.b4w_vertex_anim[n],
"allow_nla"in f||(b('mesh["b4w_vertex_anim"]',e,"allow_nla"),f.allow_nla=!0)}n=a.cameras;for(g=0;g<n.length;g++)h=n[g],h.type||(h.type="PERSP",b("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,t("camera",h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,b("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,b("camera",h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=1,b("camera",h,"b4w_rot_velocity")),
"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,b("camera",h,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in h||(h.b4w_use_target_distance_limits=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_target_distance_limits")),"b4w_use_zooming"in h||(h.b4w_use_zooming=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_zooming")),"b4w_distance_min"in h||(h.b4w_distance_min=1,b("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,b("camera",h,"b4w_distance_max")),
"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=-100,b("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,b("camera",h,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,b("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,b("camera",h,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
h||(h.b4w_use_horizontal_clamping=!1,b("camera",h,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,b("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=Math.PI,b("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",b("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=!1,b("camera",h,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=-Math.PI/2,b("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,b("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in h||(h.b4w_vertical_clamping_type="LOCAL",b("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,b("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=Math.PI/6,b("camera",h,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in h||(h.b4w_enable_hover_hor_rotation=!0,b("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,b("camera",h,"b4w_use_panning")),"b4w_use_pivot_limits"in h||(h.b4w_use_pivot_limits=!1,h.b4w_pivot_z_min=0,h.b4w_pivot_z_max=10,b("camera",h,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in h||(h.b4w_dof_bokeh=!1,b("camera",h,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in h||(h.b4w_dof_bokeh_intensity=.3,b("camera",h,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in h||(h.b4w_dof_foreground_blur=!1,b("camera",h,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in h||(h.b4w_dof_front_start=0,b("camera",h,"b4w_dof_front_start")),"b4w_dof_front_end"in h||(h.b4w_dof_front_end=h.b4w_dof_front,b("camera",h,"b4w_dof_front_end")),"b4w_dof_rear_start"in h||(h.b4w_dof_rear_start=0,b("camera",h,"b4w_dof_rear_start")),"b4w_dof_rear_end"in h||(h.b4w_dof_rear_end=h.b4w_dof_rear,b("camera",h,"b4w_dof_rear_end"));n=a.lamps;for(g=0;g<n.length;g++)h=
n[g],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,b("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,b("lamp",h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,b("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,b("lamp",h,"use_specular")),"clip_start"in h||(h.clip_start=.1,b("lamp",h,"clip_start")),"clip_end"in h||(h.clip_end=30,b("lamp",h,"clip_end")),"POINT"!=h.type&&"SPOT"!=h.type||"use_sphere"in h||(h.use_sphere=
!1,b("lamp",h,"use_sphere"));n=a.speakers;for(g=0;g<n.length;g++)h=n[g],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in h||(h.b4w_auto_play=!1,b("speaker",h,"b4w_auto_play")),"b4w_enable_doppler"in h||(h.b4w_enable_doppler=!1,b("speaker",h,"b4w_enable_doppler")),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),
"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_start"in h||(h.b4w_loop_start=0,b("speaker",h,"b4w_loop_start")),"b4w_loop_end"in h||(h.b4w_loop_end=0,b("speaker",h,"b4w_loop_end")),h.animation_data&&d(h.animation_data);n=a.textures;for(g=0;g<n.length;g++)h=n[g],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering="OFF",b("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,b("texture",h,
"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],b("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=[1,1],b("texture",h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,b("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,b("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in h||(h.b4w_shore_dist_map=!1,b("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in
h||(h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=100,b("texture",h,"b4w_max_shore_dist")),"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,b("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",b("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",b("texture",h,"b4w_source_id")),"b4w_source_size"in h||(h.b4w_source_size=1024,b("texture",h,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,b("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in h||(h.b4w_nla_video=!1,b("texture",h,"b4w_nla_video"));n=a.images;for(g=0;g<n.length;g++)h=n[g],"colorspace_settings_name"in h||(h.colorspace_settings_name="sRGB",b("image",h,"colorspace_settings_name"));f=a.materials;for(g=0;g<f.length;g++){c=f[g];"ALPHA_ANTIALIASING"==c.game_settings.alpha_blend&&(c.game_settings.alpha_blend="CLIP");"use_tangent_shading"in c||(c.use_tangent_shading=
!1,b("material",c,"use_tangent_shading"));"b4w_node_mat_type"in c&&t("material",c,"b4w_node_mat_type");"b4w_skydome"in c&&t("material",c,"b4w_skydome");"b4w_procedural_skydome"in c&&t("material",c,"b4w_procedural_skydome");"b4w_lens_flares"in c||(c.b4w_lens_flares=!1,b("material",c,"b4w_lens_flares"));"LENS_FLARES"===c.name&&(c.b4w_lens_flares||k.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),c.b4w_lens_flares=!0);c.b4w_water&&("b4w_water_shore_smoothing"in
c||(c.b4w_water_shore_smoothing=!1,b("material",c,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in c||(c.b4w_water_dynamic=!1,b("material",c,"b4w_water_dynamic")),"b4w_waves_height"in c||(c.b4w_waves_height=1,b("material",c,"b4w_waves_height")),"b4w_waves_length"in c||(c.b4w_waves_length=1,b("material",c,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in c||(c.b4w_water_dst_noise_scale0=.05,b("material",c,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in c||(c.b4w_water_dst_noise_scale1=
.03,b("material",c,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in c||(c.b4w_water_dst_noise_freq0=1.3,b("material",c,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in c||(c.b4w_water_dst_noise_freq1=1,b("material",c,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in c||(c.b4w_water_dir_min_shore_fac=.4,b("material",c,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in c||(c.b4w_water_dir_freq=.5,b("material",c,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
c||(c.b4w_water_dir_noise_scale=.05,b("material",c,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in c||(c.b4w_water_dir_noise_freq=.07,b("material",c,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in c||(c.b4w_water_dir_min_noise_fac=.5,b("material",c,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in c||(c.b4w_water_dst_min_fac=.2,b("material",c,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in c||(c.b4w_water_waves_hor_fac=5,b("material",c,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in c||(c.b4w_water_absorb_factor=6,b("material",c,"b4w_water_absorb_factor")),"b4w_water_fog_color"in c||(c.b4w_water_fog_color=[.5,.7,.7],b("material",c,"b4w_water_fog_color")),"b4w_foam_factor"in c||(c.b4w_foam_factor=5,b("material",c,"b4w_foam_factor")),"b4w_generated_mesh"in c||(c.b4w_generated_mesh=!1,b("material",c,"b4w_generated_mesh")),"b4w_water_num_cascads"in c||(c.b4w_water_num_cascads=5,b("material",c,"b4w_water_num_cascads")),"b4w_water_subdivs"in c||(c.b4w_water_subdivs=
64,b("material",c,"b4w_water_subdivs")),"b4w_water_detailed_dist"in c||(c.b4w_water_detailed_dist=1E3,b("material",c,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in c||(c.b4w_water_enable_caust=!1,b("material",c,"b4w_water_enable_caust")),"b4w_water_caust_scale"in c||(c.b4w_water_caust_scale=.25,b("material",c,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in c||(c.b4w_water_caust_brightness=.5,b("material",c,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in c||(c.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in c||(c.b4w_dynamic_grass_color="");"diffuse_intensity"in c||(c.diffuse_intensity=1,b("material",c,"diffuse_intensity"));"b4w_use_ghost"in c||(c.b4w_use_ghost=!1);"b4w_collision_margin"in c||(c.b4w_collision_margin=.04,b("material",c,"b4w_collision_margin"));"b4w_collision_group"in c||(c.b4w_collision_group=128,b("material",c,"b4w_collision_group"));"b4w_collision_mask"in c||(c.b4w_collision_mask=127,b("material",c,"b4w_collision_mask"));"b4w_do_not_render"in c||(c.b4w_do_not_render=
!1,b("material",c,"b4w_do_not_render"));"HALO"!=c.type||"b4w_halo_sky_stars"in c||(c.b4w_halo_sky_stars=!1,b("material",c,"b4w_halo_sky_stars"));"HALO"!=c.type||"b4w_halo_stars_blend_height"in c||(c.b4w_halo_stars_blend_height=10,b("material",c,"b4w_halo_stars_blend_height"));"HALO"!=c.type||"b4w_halo_stars_min_height"in c||(c.b4w_halo_stars_min_height=0,b("material",c,"b4w_halo_stars_min_height"));"specular_shader"in c||(c.specular_shader="COOKTORR",b("material",c,"specular_shader"));"diffuse_shader"in
c||(c.diffuse_shader="LAMBERT",b("material",c,"diffuse_shader"));"roughness"in c||(c.roughness=.5,b("material",c,"roughness"));"diffuse_fresnel"in c||(c.diffuse_fresnel=.1,b("material",c,"diffuse_fresnel"));"diffuse_fresnel_factor"in c||(c.diffuse_fresnel_factor=.5,b("material",c,"diffuse_fresnel_factor"));"specular_slope"in c||(c.specular_slope=.2,b("material",c,"specular_slope"));"specular_toon_size"in c||(c.specular_toon_size=.5,b("material",c,"specular_toon_size"));"specular_toon_smooth"in c||
(c.specular_toon_smooth=.1,b("material",c,"specular_toon_smooth"));"specular_alpha"in c||(c.specular_alpha=1,b("material",c,"specular_alpha"));"b4w_wettable"in c||(c.b4w_wettable=!1,b("material",c,"b4w_wettable"));"b4w_refractive"in c||(c.b4w_refractive=!1,b("material",c,"b4w_refractive"));"b4w_refr_bump"in c||(c.b4w_refr_bump=0,b("material",c,"b4w_refr_bump"));"b4w_shallow_water_col"in c||(c.b4w_shallow_water_col=[0,.8,.3],b("material",c,"b4w_shallow_water_col"));"b4w_shore_water_col"in c||(c.b4w_shore_water_col=
[0,.9,.2],b("material",c,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in c||(c.b4w_shallow_water_col_fac=1,b("material",c,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in c||(c.b4w_shore_water_col_fac=.5,b("material",c,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in c||(c.b4w_water_sss_strength=5.9,b("material",c,"b4w_water_sss_strength"));"b4w_water_sss_width"in c||(c.b4w_water_sss_width=.45,b("material",c,"b4w_water_sss_width"));"b4w_render_above_all"in c||(c.b4w_render_above_all=
!1,b("material",c,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in c||(c.b4w_water_norm_uv_velocity=.05,b("material",c,"b4w_water_norm_uv_velocity"));"specular_ior"in c||(c.specular_ior=1,b("material",c,"specular_ior"));"darkness"in c||(c.darkness=0,b("material",c,"darkness"));"diffuse_toon_size"in c||(c.diffuse_toon_size=0,b("material",c,"diffuse_toon_size"));"diffuse_toon_smooth"in c||(c.diffuse_toon_smooth=0,b("material",c,"diffuse_toon_smooth"));"pass_index"in c||(c.pass_index=0,b("material",
c,"pass_index"));h=c.texture_slots;for(n=0;n<h.length;n++)e=h[n],"blend_type"in e||(e.blend_type="MIX",b("texture_slot",e,"blend_type"));if(c.node_tree){h=c.node_tree.nodes;for(n=0;n<h.length;n++)m(h[n]);c.node_tree.animation_data&&d(c.node_tree.animation_data)}}e=a.node_groups;for(g=0;g<e.length;g++)for(h=e[g].node_tree.nodes,n=0;n<h.length;n++)m(h[n]);h=a.objects;for(g=0;g<h.length;g++){e=h[g];switch(e.type){case "MESH":"b4w_dynamic_geometry"in e||(e.b4w_dynamic_geometry=!1);"b4w_reflexible"in e||
(e.b4w_reflexible=!1);"b4w_reflexible_only"in e||(e.b4w_reflexible_only=!1);"b4w_reflective"in e||(e.b4w_reflective=!1);"b4w_reflection_type"in e||(e.b4w_reflection_type="PLANE",b("object",e,"b4w_reflection_type"));"b4w_wind_bending"in e||(e.b4w_wind_bending=!1,b("object",e,"b4w_wind_bending"));"b4w_wind_bending_angle"in e||(e.b4w_wind_bending_angle=10,e.b4w_wind_bending_freq=.25,b("object",e,"wind bending params"));"b4w_detail_bending_amp"in e||(e.b4w_detail_bending_amp=.1,e.b4w_branch_bending_amp=
.3,b("object",e,"detail bending params"));"b4w_detail_bending_freq"in e||(e.b4w_detail_bending_freq=1,b("object",e,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in e||(e.b4w_main_bend_stiffness_col="",b("object",e,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in e||(e.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",e,"b4w_detail_bend_colors"));"b4w_caustics"in e||(e.b4w_caustics=!1);"vertex_groups"in e&&e.vertex_groups.length&&
e.data&&0==e.data.vertex_groups.length&&(e.data.vertex_groups=e.vertex_groups,delete e.vertex_groups,b("object",e,"vertex_groups"));"b4w_vertex_anim"in e&&e.b4w_vertex_anim.length&&e.data&&0==e.data.b4w_vertex_anim.length&&(e.data.b4w_vertex_anim=e.b4w_vertex_anim,delete e.b4w_vertex_anim,b("object",e,"b4w_vertex_anim"));"b4w_do_not_render"in e||(e.b4w_do_not_render=!1);"b4w_hidden_on_load"in e||(e.b4w_hidden_on_load=!1);"use_ghost"in e.game||(e.game.use_ghost=!1);"use_sleep"in e.game||(e.game.use_sleep=
!1);"velocity_min"in e.game||(e.game.velocity_min=0);"velocity_max"in e.game||(e.game.velocity_max=0);"collision_group"in e.game||(e.game.collision_group=1);"collision_mask"in e.game||(e.game.collision_mask=255);n=e;f=n.game;c=f.collision_bounds_type;f.use_collision_bounds&&"BOX"!=c&&"CYLINDER"!=c&&"CONE"!=c&&"SPHERE"!=c&&"CAPSULE"!=c&&"EMPTY"!=c&&(k.error("Wrong collision bounds type "+c+". Disable physics for object "+n.name),n.b4w_collision=!1,n.b4w_floating=!1,n.b4w_vehicle=!1,n.b4w_character=
!1);"b4w_vehicle_settings"in e?e.b4w_vehicle_settings&&("steering_ratio"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.steering_ratio=10),"steering_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.steering_max=1),"inverse_control"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.inverse_control=!1),"force_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.force_max=1500),"brake_max"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.brake_max=100),"speed_ratio"in e.b4w_vehicle_settings||
(e.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.floating_factor=3),"floating_factor"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in e.b4w_vehicle_settings||
(e.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in e.b4w_vehicle_settings||(e.b4w_vehicle_settings.water_rot_damp=.9)):(e.b4w_vehicle_settings=null,b("object",e,"b4w_vehicle_settings"));"b4w_floating_settings"in e?e.b4w_floating_settings&&("floating_factor"in e.b4w_floating_settings||(e.b4w_floating_settings.floating_factor=3),"water_lin_damp"in e.b4w_floating_settings||(e.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in e.b4w_floating_settings||(e.b4w_floating_settings.water_rot_damp=
.8)):(e.b4w_floating_settings=null,b("object",e,"b4w_floating_settings"));"b4w_character_settings"in e?e.b4w_character_settings&&("walk_speed"in e.b4w_character_settings||(e.b4w_character_settings.walk_speed=4),"run_speed"in e.b4w_character_settings||(e.b4w_character_settings.run_speed=8),"step_height"in e.b4w_character_settings||(e.b4w_character_settings.step_height=.25),"jump_strength"in e.b4w_character_settings||(e.b4w_character_settings.jump_strength=5),"waterline"in e.b4w_character_settings||
(e.b4w_character_settings.waterline=0)):(e.b4w_character_settings=null,b("object",e,"b4w_character_settings"));"b4w_selectable"in e||(e.b4w_selectable=!1,b("object",e,"b4w_selectable"));"b4w_outlining"in e||(e.b4w_outlining=!1,b("object",e,"b4w_outlining"));"b4w_outline_on_select"in e||(e.b4w_outline_on_select=!1,b("object",e,"b4w_outline_on_select"));"b4w_billboard"in e||(e.b4w_billboard=!1,b("object",e,"b4w_billboard"));"b4w_billboard_geometry"in e||(e.b4w_billboard_geometry="SPHERICAL",b("object",
e,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in e||(e.b4w_pres_glob_orientation=!1,b("object",e,"b4w_pres_glob_orientation"));"b4w_outline_settings"in e||("b4w_glow_settings"in e?e.b4w_outline_settings=e.b4w_glow_settings:(e.b4w_outline_settings={},e.b4w_outline_settings.outline_duration=1,e.b4w_outline_settings.outline_period=1,e.b4w_outline_settings.outline_relapses=0),b("object",e,"b4w_outline_settings"));"b4w_lod_transition"in e||(e.b4w_lod_transition=.01,b("object",e,"b4w_lod_transition"));
"lod_levels"in e||(e.lod_levels=[],b("object",e,"lod_levels"));"b4w_animation_mixing"in e||(e.b4w_animation_mixing=!1,b("object",e,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in e||(e.b4w_anchor=null,b("object",e,"b4w_anchor")),!e.b4w_anchor||"max_width"in e.b4w_anchor||(e.b4w_anchor.max_width=250)}"collision_margin"in e.game||(e.game.collision_margin=.04,b("object",e,"collision_margin"));"b4w_anim_behavior"in e||(e.b4w_anim_behavior=e.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
e,"b4w_anim_behavior"));if(!("rotation_quaternion"in e)){n=[0,0,0,1];y.Oj(e.rotation_euler,n);var f=n,c=n[0],r=n[1],p=n[2];f[0]=n[3];f[1]=c;f[2]=r;f[3]=p;e.rotation_quaternion=n;b("object",e,"rotation_quaternion")}"webgl_do_not_batch"in e&&(e.b4w_do_not_batch=e.webgl_do_not_batch)&&t("object",e,"webgl_do_not_batch");"b4w_shadow_cast_only"in e||(e.b4w_shadow_cast_only=!1,b("object",e,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in e||(e.b4w_correct_bounding_offset="AUTO",b("object",e,"b4w_correct_bounding_offset"));
f=e.particle_systems;for(n=0;n<f.length;n++)c=f[n],r=c.settings,"use_rotation_dupli"in r||(r.use_rotation_dupli=!1,b("particle_settings",r,"use_rotation_dupli")),"use_whole_group"in r||(r.use_whole_group=!1,b("particle_settings",r,"use_whole_group")),c.transforms||(c.transforms=new Float32Array,b("particle_system",c,"transforms")),"b4w_billboard_align"in r||(r.b4w_billboard_align="VIEW",b("particle_settings",r,"b4w_billboard_align")),"b4w_dynamic_grass"in r||(r.b4w_dynamic_grass=!1,b("object",r,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in r||(r.b4w_dynamic_grass_scale_threshold=.01,b("object",r,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in r||(r.b4w_initial_rand_rotation=!1,b("particle_settings",r,"b4w_initial_rand_rotation")),"b4w_rotation_type"in r||(r.b4w_rotation_type="Z",b("particle_settings",r,"b4w_rotation_type")),"b4w_rand_rotation_strength"in r||(r.b4w_rand_rotation_strength=1,b("particle_settings",r,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in r||(r.b4w_hair_billboard=
!1,b("particle_settings",r,"b4w_hair_billboard")),"b4w_hair_billboard_type"in r||(r.b4w_hair_billboard_type="BASIC",b("particle_settings",r,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in r||(r.b4w_hair_billboard_jitter_amp=0,b("particle_settings",r,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in r||(r.b4w_hair_billboard_jitter_freq=0,b("particle_settings",r,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in r||(r.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",r,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in r||(r.b4w_wind_bend_inheritance="PARENT",b("particle_settings",r,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in r||(r.b4w_shadow_inheritance="PARENT",b("particle_settings",r,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in r||(r.b4w_reflection_inheritance="PARENT",b("particle_settings",r,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in r||(r.b4w_vcol_from_name="",b("particle_settings",r,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in r||(r.b4w_vcol_to_name="",b("particle_settings",r,"b4w_vcol_to_name")),"b4w_coordinate_system"in r||(r.b4w_coordinate_system="LOCAL",b("particle_settings",r,"b4w_coordinate_system")),"b4w_allow_nla"in r||(r.b4w_allow_nla=!0,b("particle_settings",r,"b4w_allow_nla")),"b4w_enable_soft_particles"in r||(r.b4w_enable_soft_particles=!1,b("particle_settings",r,"b4w_enable_soft_particles")),"b4w_particles_softness"in r||(r.b4w_particles_softness=1,b("particle_settings",r,"b4w_particles_softness")),
"billboard_tilt"in r||(r.billboard_tilt=0,b("particle_settings",r,"billboard_tilt")),"billboard_tilt_random"in r||(r.billboard_tilt_random=0,b("particle_settings",r,"billboard_tilt_random")),"use_rotations"in r||(r.use_rotations=!1,b("particle_settings",r,"use_rotations"));"constraints"in e||(e.constraints=[],b("object",e,"constraints"));f=e.modifiers;for(n=0;n<f.length;n++){a:{c=f[n];switch(c.type){case "ARRAY":if(!("fit_type"in c)){k.error("WARNING Incomplete modifier "+String(c.type)+' for "'+
e.name+'", reexport "'+a.b4w_filepath_blend+'" scene');c=!1;break a}}c=!0}c||(f.splice(n,1),n--)}"animation_data"in e||(e.animation_data={action:null,nla_tracks:[]},b("object",e,"animation_data"));e.animation_data&&("action"in e.animation_data||(e.animation_data.action=null,q("no action in animation data "+e.name)),"nla_tracks"in e.animation_data||(e.animation_data.nla_tracks=[],q("no NLA in animation data "+e.name)),d(e.animation_data));"b4w_collision_id"in e||(e.b4w_collision_id="",b("object",e,
"b4w_collision_id"));"b4w_viewport_alignment"in e||(e.b4w_viewport_alignment=null,b("object",e,"b4w_viewport_alignment"));"pinverse_tsr"in e||(e.pinverse_tsr=null,b("object",e,"pinverse_tsr"));"b4w_cluster_data"in e||(e.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",e,"b4w_cluster_data"));"pass_index"in e||(e.pass_index=0,b("object",e,"pass_index"));(0>e.scale[0]||0>e.scale[1]||0>e.scale[2])&&q('negative scale for object "'+e.name+'", can lead to some errors');n=
e.scale;0==n[0]&&0==n[1]&&0==n[2]?n=!0:(f=Math.abs((n[1]-n[2])/n[1]),n=.005>Math.abs((n[0]-n[1])/n[0])&&.005>f);n||q("non-uniform scale for object "+e.name)}for(var x in D)g=D[x],n=x.match(/.*?(?=>>|$)/i)[0],k.warn('Property "'+String(n)+'" is '+g.IK+' for "'+g.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.iR=function(a,b){"num_channels"in a||(a.num_channels=1,q('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.mQ=function(a){var b;a:{b=
a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=z(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var k=a[c];switch(k.type){case "ARRAY":for(var d=b,m=k,e=0,q=0,p=0,r=new Float32Array(16),k=[],t=1;t<m.count;t++){m.use_constant_offset&&(e+=m.constant_offset_displace[0],q+=m.constant_offset_displace[1],p+=m.constant_offset_displace[2]);if(m.use_relative_offset)var B=d.b4w_bounding_box,e=e+(B.max_x-B.min_x)*m.relative_offset_displace[0],
q=q+(B.max_y-B.min_y)*m.relative_offset_displace[1],p=p+(B.max_z-B.min_z)*m.relative_offset_displace[2];y.$Y(e,q,p,r);for(var D=B=z(d),H=r,N=A.fromMat4(H,P),N=f.fromMat3(N,K),w=0;w<D.submeshes.length;w++){var O=D.submeshes[w];y.eo(O.position,H,O.position,0);y.zK(O.tbn_quat,N,O.tbn_quat,0)}k.push(B)}for(t=0;t<k.length;t++)for(m=d,e=k[t],q=0;q<m.submeshes.length;q++){p=m.submeshes[q];r=e.submeshes[q];B=p.base_length;D=p.indices.length;p.base_length+=r.base_length;for(var Q in p)if("base_length"!=Q&&
"boundings"!=Q)if("indices"==Q)for(p[Q]=y.iZ(p[Q],r[Q]),H=D;H<p.indices.length;H++)p.indices[H]+=B;else"vertex_colors"!=Q&&(p[Q]=y.QT(p[Q],r[Q]))}break;case "CURVE":for(d=b,t=x.qS(k.object),m=new Float32Array(16),q=t.Xj?4:3,e=new Float32Array(q),q=new Float32Array(q),p=new Float32Array(3),r=new Float32Array(4),B=new Float32Array(4),D=new Float32Array(3),H=new Float32Array(3),N=new Float32Array(3),new Float32Array(4),new Float32Array(4),w=0;w<d.submeshes.length;w++){var I=d.submeshes[w],O=I.position,
I=I.tbn_quat,Y;a:{Y=k.deform_axis;switch(Y){case "POS_X":case "NEG_X":Y=0;break a;case "POS_Y":case "NEG_Y":Y=1;break a;case "POS_Z":case "NEG_Z":Y=2;break a;default:y.q("Wrong deform axis value "+Y)}Y=void 0}D[0]=0;D[1]=0;D[2]=0;D[Y]=1;for(var ia=x.FY(t),u=0;u<O.length/3;u++){N[0]=O[3*u];N[1]=O[3*u+1];N[2]=O[3*u+2];var aa=N[Y],ca=x.EY(t,aa);x.GY(t,ca,e);p[0]=e[0];p[1]=e[1];p[2]=e[2];x.DY(t,ca,q);H[0]=q[0];H[1]=0;H[2]=q[2];g.normalize(H,H);f.rotationTo(D,H,r);0>aa?(e[0]=H[0],e[1]=H[1],e[2]=H[2],g.scale(e,
aa,e),g.add(p,e,p)):aa>ia&&(e[0]=H[0],e[1]=H[1],e[2]=H[2],g.scale(e,aa-ia,e),g.add(p,e,p));h.fromRotationTranslation(r,p,m);t.Xj&&(f.setAxisAngle(D,e[3],B),g.transformQuat(N,B,N));N[Y]=0;g.transformMat4(N,m,N);O[3*u]=N[0];O[3*u+1]=N[1];O[3*u+2]=N[2];I.length&&(K[0]=I[4*u],K[1]=I[4*u+1],K[2]=I[4*u+2],K[3]=I[4*u+3],f.multiply(K,r,K),I[4*u]=K[0],I[4*u+1]=K[1],I[4*u+2]=K[2],I[4*u+3]=K[3])}}}n.aX(b)}return b};a.fS=function(){return{name:"DEFAULT",uuid:y.yA(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,
.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,
b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],
b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.tQ=function(a,b){function c(b,c){for(var d in b){var e=b[d],f=e[0];if(1<e.length)for(var g=1;g<e.length;g++)f+="*"+e[g];for(g=0;g<a.length;g++)if(e=a[g],e.name==f)for(var l in c)e[l]=c[l]}}for(var d=b.b4w_logic_nodes,f=0;f<d.length;f++)for(var g=d[f],e=0;e<g.length;e++){var h=g[e],k={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in k)n in h&&(h[k[n]]=h[n]);for(var m in h.variables)"boolean"!=
typeof h.variables[m][0]&&(h.variables[m]=[!1,h.variables[m]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(h.type)&&("variable1"in h&&(h.variables.v1=[!1,h.variable1]),"variable2"in h&&(h.variables.v2=[!1,h.variable2]),"variabled"in h&&(h.variables.vd=[!1,h.variabled]));switch(h.type){case "SELECT":for(var r=0;r<a.length;r++)k=a[r],k.name==h.object&&(k.b4w_selectable=!0);h.bools||(h.bools={});h.bools.not_wait||(h.bools.not_wait=!1);q('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(h.objects_paths,
{b4w_selectable:!0});if(h.links instanceof Array){q('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var k={},t=0;for(r in h.objects_paths)k[r]=h.links[t],t++;h.links=k}break;case "SELECT_PLAY":q('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');h.mute=!0;break;case "SELECT_PLAY_ANIM":q('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(h.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(h.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(h.objects_paths,{b4w_do_not_batch:!0});switch(h.common_usage_names.space_type){case "WORLD":h.common_usage_names.space_type=N.wO;break;case "PARENT":h.common_usage_names.space_type=N.vO;break;case "LOCAL":h.common_usage_names.space_type=N.uO}break;case "OUTLINE":c(h.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":h.condition&&(h.common_usage_names.condition=
h.condition);if("cnd"in h.floats)h.common_usage_names.condition=h.floats.cnd;else switch(h.common_usage_names.condition){case "GEQUAL":h.common_usage_names.condition=N.uE;break;case "LEQUAL":h.common_usage_names.condition=N.wE;break;case "GREATER":h.common_usage_names.condition=N.vE;break;case "LESS":h.common_usage_names.condition=N.xE;break;case "NOTEQUAL":h.common_usage_names.condition=N.yE;break;case "EQUAL":h.common_usage_names.condition=N.tE}void 0!=h.number1&&(h.input1=h.number1);void 0!=h.number2&&
(h.input2=h.number2);h.bools||(h.bools={});void 0===h.bools.str&&(h.bools.str=!1,h.floats.inp1=h.input1,h.floats.inp2=h.input2);break;case "SEND_REQ":h.bools||(h.bools={});h.strings||(h.strings={});void 0===h.bools.ct&&(h.bools.ct=!1);void 0!=h.url&&(h.bools.url=!1,h.strings.url=h.url);break;case "MATH":void 0!=h.number1&&(h.input1=h.number1);void 0!=h.number2&&(h.input2=h.number2);void 0!=h.input1&&(h.floats.inp1=h.input1);void 0!=h.input2&&(h.floats.inp2=h.input2);break;case "REGSTORE":h.floats||
(h.floats={});h.strings||(h.strings={});void 0!=h.number1&&(h.input1=h.number1);if(void 0!=h.input1)switch(typeof h.input1){case "number":h.floats.inp1=h.input1;h.common_usage_names.variable_type="NUMBER";break;default:h.strings.inp1=h.input1,h.common_usage_names.variable_type="STRING"}switch(h.common_usage_names.variable_type){case "NUMBER":h.common_usage_names.variable_type=N.xO;break;case "STRING":h.common_usage_names.variable_type=N.yO}break;case "PAGEPARAM":h.bools||(h.bools={});void 0===h.bools.hsh&&
(h.bools.hsh=!1);h.floats||(h.floats={});void 0===h.floats.ptp&&(h.floats.ptp=0);break;case "PLAY_ANIM":c(h.objects_paths,{b4w_do_not_batch:!0});h.bools||(h.bools={});void 0===h.bools.env&&(h.bools.env=!1);(k=h.common_usage_names.param_anim_behavior)||(k="FINISH_STOP");h.common_usage_names.param_anim_behavior=H.Yy(k);break;case "STOP_ANIM":h.bools||(h.bools={});void 0===h.bools.env&&(h.bools.env=!1);break;case "STRING":switch(h.common_usage_names.string_operation){case "JOIN":h.common_usage_names.string_operation=
N.rO;break;case "FIND":h.common_usage_names.string_operation=N.qO;break;case "REPLACE":h.common_usage_names.string_operation=N.sO;break;case "SPLIT":h.common_usage_names.string_operation=N.tO;break;case "COMPARE":h.common_usage_names.string_operation=N.pO}if("cnd"in h.floats)h.common_usage_names.condition=h.floats.cnd;else switch(h.common_usage_names.condition){case "GEQUAL":h.common_usage_names.condition=N.uE;break;case "LEQUAL":h.common_usage_names.condition=N.wE;break;case "GREATER":h.common_usage_names.condition=
N.vE;break;case "LESS":h.common_usage_names.condition=N.xE;break;case "NOTEQUAL":h.common_usage_names.condition=N.yE;break;case "EQUAL":h.common_usage_names.condition=N.tE}break;case "REDIRECT":void 0!=h.url&&(h.bools.url=!1,h.strings.url=h.url);break;case "SET_CAMERA_MOVE_STYLE":switch(h.common_usage_names.camera_move_style){case "STATIC":h.common_usage_names.camera_move_style=N.iO;break;case "TARGET":h.common_usage_names.camera_move_style=N.jO;break;case "EYE":h.common_usage_names.camera_move_style=
N.gO;break;case "HOVER":h.common_usage_names.camera_move_style=N.hO}break;case "ENTRYPOINT":h.bools||(h.bools={});void 0===h.bools.js&&(h.bools.js=!1);h.bools.js&&(h.mute=!0);break;case "JS_CALLBACK":for(n in h=h.common_usage_names.js_cb_params,h)switch(h[n]){case "OBJECT":h[n]=N.kO;break;case "VARIABLE":h[n]=N.lO}}}}};b4w.module.camera=function(a,r){function m(a,b){h.Rb("camera.set_pivot","camera.target_set_trans_pivot");d.Ea(a)?(A.copy(b,a.k.pivot),f.D(a),x.H(a)):h.error("set_pivot(): Wrong object or camera move style")}var d=r("__camera");r("__config");var b=r("__constraints"),t=r("__container"),q=r("__mat4"),z=r("__math"),n=r("__obj_util"),x=r("__physics"),h=r("__print"),k=r("__scenes"),f=r("__transform"),y=r("__tsr"),g=r("__util"),A=r("__vec3"),N=r("__vec4"),H=r("__quat"),O=new Float32Array(2),D=new Float32Array(3),
P=new Float32Array(3);new Float32Array(4);var K=H.create();new Float32Array(9);var M={},F={};a.xg=d.xg;a.Ib=d.Ib;a.nd=d.nd;a.bd=d.bd;a.h8=function(a,b){if(n.xa(a)){d.Hs(a);a.k.tb=d.xg;if(b){var g=b.pos||y.F(a.k.n);b.look_at?d.Bw(a,g,b.look_at):f.Uc(a,g)}f.D(a);x.H(a);d.Jn(a)}else h.error("static_setup(): Wrong camera object")};a.f8=function(a,b,g){d.Nn(a)?(b=b||y.F(a.k.n),g?d.Bw(a,b,g):f.Uc(a,b),f.D(a),x.H(a)):h.error("static_set_look_at(): Wrong camera object or camera move style")};a.g8=function(a,
b){d.Nn(a)?(f.Zh(a,b),f.D(a),x.H(a)):h.error("static_set_rotation(): Wrong camera object or camera move style")};a.e8=function(a,b){if(!d.Nn(a))return h.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return f.En(a,b)};a.g3=function(a,b){n.xa(a)?b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right)?h.error("eye_setup(): Wrong horizontal limits object."):b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||
"number"!=typeof b.vert_rot_lim.up)?h.error("eye_setup(): Wrong vertical limits object."):(d.Hs(a),a.k.tb=d.nd,b&&d.BL(a,b.pos||y.F(a.k.n),b.look_at,b.horiz_rot_lim,b.vert_rot_lim),f.D(a),x.H(a),d.Jn(a)):h.error("eye_setup(): Wrong camera object")};a.f3=function(a,g,k){d.tc(a)?(g=g||y.F(a.k.n),k?d.TX(a,g,k):f.Uc(a,g),b.Jj(a,a.k.lf,!0),f.D(a),x.H(a)):h.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Gq=function(a,b,g){var k,e;d.tc(a)?(d.Wr(a,b,g,k||!1,e||!1),f.D(a),x.H(a)):
h.error("eye_rotate(): Wrong camera object or camera move style")};a.HT=function(a,b){d.tc(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.xL(a,b),f.D(a),x.H(a)):h.error("eye_set_vertical_limits(): Incorrect limits object."):h.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.e3=function(a,b,f){if(!d.tc(a))return h.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.ka?(b=b||{},f?(b.down=a.ka.rn,b.up=a.ka.Qo):(b.down=
a.ka.down,b.up=a.ka.up),b.camera_space=f||!1,b):null};a.GT=function(a,b){d.tc(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.kL(a,b),f.D(a),x.H(a)):h.error("eye_set_horizontal_limits(): Incorrect limits object."):h.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.d3=function(a,b,f){if(!d.tc(a))return h.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.lb?(b=b||{},f?(b.left=a.lb.Rn,b.right=a.lb.lo):(b.left=
a.lb.left,b.right=a.lb.right),b.camera_space=f||!1,b):null};a.r8=function(a,b){if(n.xa(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){h.error("target_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);
b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.Jr&&("number"!=typeof b.Jr.min_y||"number"!=typeof b.Jr.max_y||b.Jr.min_y>b.Jr.max_y)?h.error("target_setup(): Wrong pivot limits object"):(d.Hs(a),a.k.tb=d.Ib,d.DL(a,b.pos||y.F(a.k.n),b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Jr,b.use_panning||!1),f.D(a),x.H(a),d.Jn(a))}else h.error("target_setup(): Wrong vertical limits object");else h.error("target_setup(): Wrong horizontal limits object");else h.error("target_setup(): Wrong camera object")};
a.ps=function(a,b,g){var k,e;d.Ea(a)?(d.pw(a,b,g,k||!1,e||!1),f.D(a),x.H(a)):h.error("target_rotate(): Wrong camera object or camera move style")};a.q8=function(a,b,g){d.Ea(a)?(b=b||y.F(a.k.n),g=g||a.k.pivot,d.ds(a,b,g),f.D(a),x.H(a)):h.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.p8=function(a,b){d.Ea(a)?(d.aY(a,b),f.D(a),x.H(a)):h.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.TY=function(a,b){if(d.Ea(a)){var g=f.Zn(a,a.k.pivot),
k=Math.max(0,b);f.$g(a,0,0,k-g);f.D(a);x.H(a)}else h.error("target_set_distance(): Wrong camera object or camera move style")};a.nD=function(a){return d.Ea(a)?f.Zn(a,a.k.pivot):(h.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.t8=function(a,b){if(d.Ea(a)){var g=f.Iu(b,!1,D),m=f.Ju(b),e=k.B(),e=n.ja(a,e).ba[0],e=d.NH(e)/2,m=m/Math.sin(e),e=f.Zn(a,g);d.ds(a,y.F(a.k.n),g);f.D(a);f.$g(a,0,0,m-e);f.D(a);x.H(a)}else h.error("target_zoom_object(): Wrong camera object or camera move style")};
a.RY=function(a,b){if(!d.Ea(a))return h.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);A.copy(a.k.pivot,b);return b};a.oM=function(a,b){if(d.Ea(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){h.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}d.IX(a,b);f.D(a);x.H(a)}else h.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.k8=
function(a,b){if(!d.Ea(a))return h.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var f=a.k;return f.sb?(b=b||{},b.min=f.sb.min,b.max=f.sb.max,b):null};a.VY=function(a,b){d.Ea(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.xL(a,b),f.D(a),x.H(a)):h.error("target_set_vertical_limits(): Wrong limits object"):h.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.n8=function(a,b,f){if(!d.Ea(a))return h.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.ka?(b=b||{},f?(b.down=a.ka.rn,b.up=a.ka.Qo):(b.down=a.ka.down,b.up=a.ka.up),b.camera_space=f||!1,b):null};a.UY=function(a,b){d.Ea(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.kL(a,b),f.D(a),x.H(a)):h.error("target_set_horizontal_limits(): Wrong limits object"):h.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.l8=function(a,b,f){if(!d.Ea(a))return h.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.lb?(b=b||{},f?(b.left=a.lb.Rn,b.right=a.lb.lo):(b.left=a.lb.left,b.right=a.lb.right),b.camera_space=f||!1,b):null};a.o8=function(a,b){d.Ea(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?h.error("target_set_pivot_limits(): Wrong limits object"):(d.XX(a,b),f.D(a),x.H(a)):h.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.m8=function(a,b){if(!d.Ea(a))return h.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var f=a.k;return f.ae?(b=b||{},b.min_z=f.ae.min_z,b.max_z=f.ae.max_z,b):null};a.SY=function(a,b,g){if(d.Ea(a)){var k=a.k;k.use_panning&&(D[0]=b,D[1]=-g,D[2]=0,y.wd(D,k.n,D),A.add(k.pivot,D,k.pivot),b=y.F(k.n),A.add(b,D,b),f.D(a),x.H(a))}else h.error("target_pan_pivot(): wrong object")};a.s8=function(a,b){if(!d.Ea(a))return h.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.z5=function(b,h){a.gV(b,{pos:h.pos,pivot:h.pivot});var k="undefined"==
typeof h.dist_interval?0:Math.max(h.dist_interval,0),n="undefined"==typeof h.angle_interval?0:Math.max(h.angle_interval,0),e="undefined"==typeof h.t?.5:g.V(h.t,0,1),m=a.YI(b,M);m.min=Math.max(m.min-e*k,0);m.max+=(1-e)*k;k=a.ZI(b,F);k.down=g.V(k.down+e*n,-Math.PI/2,0);k.up=g.V(k.up-(1-e)*n,-Math.PI/2,0);d.ev(b,m);d.fv(b,k);f.D(b);x.H(b);d.Jn(b)};a.gV=function(a,b){if(n.xa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){h.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up)?h.error("hover_setup(): Wrong hover angle limits object"):b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max)?h.error("hover_setup(): Wrong horizontal translation limits object"):
b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max)?h.error("hover_setup(): Wrong vertical translation limits object"):(d.Hs(a),a.k.tb=d.bd,d.CL(a,b.pos||y.F(a.k.n),b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1),f.D(a),x.H(a),d.Jn(a))}else h.error("hover_setup(): Wrong camera object")};a.$I=function(a,b,g){var k,e;d.$a(a)?(d.Xr(a,b,g,k||!1,e||!1),f.D(a),x.H(a)):
h.error("hover_rotate(): Wrong camera object or camera move style")};a.y5=function(a,b){d.$a(a)?(d.Aw(a,b),f.D(a),x.H(a)):h.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.w5=function(a,b){if(!d.$a(a))return h.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);A.copy(a.k.Tb,b);return b};a.dV=function(a){return d.$a(a)?f.Zn(a,a.k.Tb):(h.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.fv=
function(a,b){d.$a(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?h.error("hover_set_vertical_limits(): Wrong limits object"):(d.fv(a,b),f.D(a),x.H(a)):h.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.ZI=function(a,b){if(!d.$a(a))return h.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var f=a.k;b=b||{};b.down=f.ka.down;b.up=f.ka.up;return b};a.ev=function(a,b){d.$a(a)?"number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max?h.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),d.ev(a,b),f.D(a),x.H(a)):h.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.YI=function(a,b){if(!d.$a(a))return h.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var f=a.k;b=b||{};b.min=f.sb.min;b.max=f.sb.max;return b};a.fV=function(a,b){d.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?
h.error("hover_set_vert_trans_limits(): Wrong limits object"):(d.gY(a,b),f.D(a),x.H(a)):h.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.x5=function(a,b){if(!d.$a(a))return h.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var f=a.k;return f.zc?(b=b||{},b.min=f.zc.min,b.max=f.zc.max,b):null};a.eV=function(a,b){d.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?h.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(d.OX(a,b),f.D(a),x.H(a)):h.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.v5=function(a,b){if(!d.$a(a))return h.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var f=a.k;return f.yc?(b=b||{},b.min=f.yc.min,b.max=f.yc.max,b):null};a.A5=function(a,b){if(!d.$a(a))return h.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Gh=b};a.Nn=d.Nn;a.Ea=d.Ea;a.tc=d.tc;a.$a=d.$a;a.NC=function(a,b){if(!n.xa(a))return h.error("set_move_style(): Wrong camera object"),
!1;if(b!=d.xg&&b!=d.nd&&b!=d.Ib&&b!=d.bd)return h.error("set_move_style(): Wrong move style"),!1;d.NC(a,b);f.D(a);x.H(a);return!0};a.Tl=function(a){return n.xa(a)?d.Tl(a):(h.error("get_move_style(): Wrong camera object"),null)};a.Uc=function(a,b){if(n.xa(a)){var g=a.k;if(d.Ea(a)){var k=y.F(g.n),k=A.subtract(b,k,D);A.add(k,g.pivot,g.pivot)}else d.$a(a)&&(k=y.F(g.n),k=A.subtract(b,k,D),A.add(k,g.Tb,g.Tb));f.Uc(a,b);f.D(a);x.H(a)}else h.error("set_translation(): Wrong camera object")};a.Bf=function(a,
b){if(!n.xa(a))return h.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return f.Bf(a,b)};a.O6=function(a,b,g,k,e){n.xa(a)?(k=k||!1,e=e||!1,d.Ea(a)?d.pw(a,b,g,k,e):d.tc(a)?d.Wr(a,b,g,k,e):d.$a(a)?d.Xr(a,b,g,k,e):d.Nn(a)?h.warn("rotate_camera(): not supported for STATIC cameras"):h.error("rotate_camera(): Wrong camera move style"),f.D(a),x.H(a)):h.error("rotate_camera(): Wrong camera object")};a.eY=function(a,b){if(n.xa(a)){var d=a.k;"number"==typeof b.trans&&(d.Qk=g.V(b.trans,
0,Infinity));"number"==typeof b.rot&&(d.Pk=g.V(b.rot,0,Infinity));"number"==typeof b.zoom&&(d.Rk=g.V(b.zoom,0,.99))}else h.error("set_velocities(): Wrong camera object")};a.Lh=function(a,b){if(!n.xa(a))return h.error("get_velocities(): Wrong camera object"),null;var d=a.k;b=b||{};b.trans=d.Qk;b.rot=d.Pk;b.zoom=d.Rk;return b};a.L5=function(a){return n.xa(a)?0<=g.kc(y.R(a.k.n),g.Zc,D)[1]:(h.error("is_look_up(): Wrong camera object"),!1)};a.Bn=function(a,b){if(!n.xa(a))return h.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);d.Bn(a,b);return b};a.Du=function(a,b){if(!n.xa(a))return h.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);d.Du(a,b);return b};a.A3=function(a,b){b=b||new Float32Array(2);var f=A.normalize(a,D),f=g.CC(g.Zc,f,K);g.Kz(f,!0);d.FA(f,b);return b};a.uL=function(a,b){if(n.xa(a))for(var f=k.B(),f=n.ja(a,f).ba,g=0;g<f.length;g++){var e=f[g];e.type!=d.Mc&&e.type!=d.dd&&e.type!=d.Le&&e.type!=d.Me||d.$X(e,b,e.hf)}else h.error("set_stereo_distance(): Wrong camera object")};
a.CI=function(a){if(!n.xa(a))return h.error("get_stereo_distance(): Wrong camera object"),0;var b=k.B();a=n.ja(a,b).ba;for(b=0;b<a.length;b++){var f=a[b];if(f.type==d.Mc||f.type==d.dd)return f.Ek}return 0};a.IC=function(a,b){if(n.xa(a)){var f=k.B(),f=n.ja(a,f).ba;d.IC(f,b)}else h.error("set_eye_distance(): Wrong camera object")};a.P3=function(a){if(!n.xa(a))return h.error("get_eye_distance(): Wrong camera object"),0;var b=k.B();a=n.ja(a,b).ba;for(b=0;b<a.length;b++){var f=a[b];if(f.type==d.Mc||f.type==
d.dd||f.type==d.Le||f.type==d.Me)return f.hf}return 0};a.L7=function(a,b){n.xa(a)?(A.copy(b,a.k.lf),f.D(a),x.H(a)):h.error("set_vertical_axis(): Wrong camera object")};a.V4=function(a,b){if(n.xa(a))return b||(b=A.create()),A.copy(a.k.lf,b),b;h.error("get_vertical_axis(): Wrong camera object")};a.z8=function(a,b,f,g){if(n.xa(a)){var e=k.B();a=n.ja(a,e).ba;for(e=0;e<a.length;e++){var m=a[e];m.lc||d.yk(m,m.zb);var p=D;p[0]=-b;p[1]=-f;p[2]=0;q.translate(m.wb,p,m.wb);q.rotateZ(m.wb,g,m.wb);d.XF(m);d.qz(m)}}else h.error("translate_view(): Wrong camera object")};
a.Y4=function(a,b){if(!n.xa(a))return h.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);g.kc(y.R(a.k.n),g.Zc,b);return b};a.DU=function(a){if(!n.xa(a))return h.error("get_fov(): Wrong camera object"),0;var b=k.B();a=n.ja(a,b).ba;return g.Kb(a[0].Ud)};a.h7=function(a,b){if(n.xa(a))for(var f=k.B(),f=n.ja(a,f).ba,m=0;m<f.length;m++){var e=f[m];e.Ud=g.df(b);e.lc||d.yk(e,e.zb);d.XF(e);d.qz(e)}else h.error("set_fov(): Wrong camera object")};a.MC=function(a,b,f){var g;if(!(g=
n.xa(a)))a:{if(n.xa(a)){g=k.B();g=n.ja(a,g).ba;for(var e=0;e<g.length;e++){var m=g[e];if(m.type==d.Le||m.type==d.Me){g=!0;break a}}}else h.error("is_hmd_camera(): Wrong camera object");g=!1}g?b&&f&&d.MC(a,b,f):h.error("set_hmd_fov(): Wrong camera object")};a.Jj=function(a,d,g){n.xa(a)?(d=d||a.k.lf,b.Jj(a,d,g||!1),f.D(a),x.H(a)):h.error("correct_up(): Wrong camera object")};a.x7=function(a,b){if(n.xa(a)&&d.sv(a)){var f=a.k;if(d.Ea(a)){var g=y.F(f.n),g=A.dist(g,f.pivot);f.Wj=b/2*f.Vj/g}else d.$a(a)?
(g=y.F(f.n),g=A.distance(g,f.Tb),f.Wj=b/2*f.Vj/g):(f=k.B(),n.ja(a,f).ba[0].top=b/2);d.GZ(a)}else h.error("set_ortho_scale(): Wrong camera object")};a.s4=function(a){if(!n.xa(a)||!d.sv(a))return h.error("get_ortho_scale(): Wrong camera object"),0;var b=k.B();return 2*n.ja(a,b).ba[0].top};a.sv=function(a){return n.xa(a)?d.sv(a):(h.error("is_ortho_camera(): Wrong camera object"),!1)};a.K1=function(a,b,m,q){if(!n.xa(a))return h.error("calc_ray(): Wrong camera object"),null;var e=k.B(),r=n.ja(a,e).ba[0];
q&&3==q.length?h.N('dest parameter in the function "calc_ray" should be type of parametric line.'):q=q||new Float32Array(6);switch(r.type){case d.Nd:case d.vh:case d.Mc:case d.dd:var p=Math.tan(r.Ud*Math.PI/360),x=p*r.zb,e=D;b=t.Kt(b,m,O,r);e[0]=(2*b[0]/r.width-1)*x;e[1]=(1-2*b[1]/r.height)*p;e[2]=-1;y.wd(e,a.k.n,e);A.normalize(e,e);3==q.length?A.copy(e,q):(a=f.Bf(a,P),z.oL(q,a),z.OC(q,e));return q;case d.se:return e=D,b=t.Kt(b,m,O,r),e[0]=(2*b[0]/r.width-1)*r.top*r.zb,e[1]=(1-2*b[1]/r.height)*r.top,
e[2]=0,y.Vc(e,a.k.n,e),A.copy(e,q),A.transformQuat(g.Zc,y.R(a.k.n),e),z.OC(q,e),q;default:return h.error("calc_ray(): Non-compatible camera"),q}};a.hC=function(a,b,f){if(!n.xa(a))return h.error("project_point(): Wrong camera object"),null;f=f||new Float32Array(2);return d.hC(a,b,f)};a.f5=function(a){return(d.Ea(a)||d.$a(a))&&null!==a.k.sb};a.p5=function(a){return(d.tc(a)||d.Ea(a)||d.$a(a))&&null!==a.k.ka};a.o5=function(a){h.Rb("has_vertical_limits","has_vertical_rot_limits");return d.Ea(a)||d.tc(a)?
null!==a.k.ka:(h.error("has_vertical_limits(): Wrong camera object"),!1)};a.i5=function(a){return(d.Ea(a)||d.tc(a))&&null!==a.k.lb};a.h5=function(a){h.Rb("has_horizontal_limits","has_horizontal_rot_limits");return d.Ea(a)||d.tc(a)?null!==a.k.lb:(h.error("has_horizontal_limits(): Wrong camera object"),!1)};a.q5=function(a){return d.$a(a)&&null!==a.k.zc};a.j5=function(a){return d.$a(a)&&null!==a.k.yc};a.d6=function(a,b,g){h.Rb("move_pivot","target_pan_pivot");if(d.Ea(a)){var k=a.k;if(k.use_panning){var e=
y.F(k.n),n=A.subtract(e,k.pivot,P);D[0]=b;D[1]=0;D[2]=g;A.scale(D,A.len(n),D);y.wd(D,k.n,D);A.add(k.pivot,D,k.pivot);A.add(e,D,e);f.D(a);x.H(a)}}else h.error("move_pivot(): wrong object")};a.K7=function(a,b){h.Rb("set_velocity_params","set_velocities");if(n.xa(a)){var d=a.k;d.Qk=g.V(b[0],0,Infinity);d.Pk=g.V(b[1],0,Infinity);d.Rk=g.V(b[2],0,.99)}else h.error("set_velocity_params(): Wrong camera object")};a.U4=function(a,b){h.Rb("get_velocity_params","get_velocities");if(!n.xa(a))return h.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var d=a.k;b[0]=d.Qk;b[1]=d.Pk;b[2]=d.Rk;return b};a.i2=function(a){h.N('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');n.xa(a)?d.Ea(a)||d.tc(a)?a.k.lb=null:d.$a(a)&&(a.k.yc=null):h.error("clear_horizontal_limits(): Wrong camera object")};a.m2=function(a){h.N('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');
n.xa(a)?d.Ea(a)||d.tc(a)?a.k.ka=null:d.$a(a)&&(a.k.zc=null):h.error("clear_vertical_limits(): Wrong camera object")};a.j2=function(){h.N("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.Bw=function(a,g,k,n){h.Hh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);n=n||a.k.lf;d.Bw(a,g,k);b.Jj(a,n,!0);f.D(a);x.H(a)};a.Wr=function(a,b,g,k,e){h.Hh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);d.tc(a)?(d.Wr(a,
b,g,k,e),f.D(a),x.H(a)):h.error("rotate_eye_camera(): wrong object")};a.pw=function(a,b,g,k,e){h.Hh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);d.Ea(a)?(d.pw(a,b,g,k,e),f.D(a),x.H(a)):h.error("rotate_target_camera(): wrong object")};a.ds=function(a,b,g){h.Rb("camera.set_trans_pivot","camera.target_set_trans_pivot");d.Ea(a)?(d.ds(a,b,g),f.D(a),x.H(a)):h.error("set_trans_pivot(): Wrong object or camera move style")};a.W8=function(a,b){h.Rb("camera.zoom_object","camera.target_zoom_object");
if(d.Ea(a)){f.Iu(b,!1,D);m(a,D);f.D(a);var g=f.Ju(b),q=k.B(),q=n.ja(a,q).ba[0],q=d.NH(q)/2,g=g/Math.sin(q),q=f.Zn(a,D);f.$g(a,0,0,g-q);f.D(a);x.H(a)}else h.error("zoom_object(): wrong object")};a.y7=m;a.Xr=function(a,b,g,k,e){h.Rb("camera.rotate_hover_camera","camera.hover_rotate");d.$a(a)?(d.Xr(a,b,g,k,e),f.D(a),x.H(a)):h.error("rotate_hover_camera(): wrong object")};a.d4=function(a,b){h.Rb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!d.$a(a))return h.error("get_hover_cam_pivot(): wrong object"),
null;b||(b=new Float32Array(3));A.copy(a.k.Tb,b);return b};a.bI=function(a,b){h.Rb("camera.get_eye","camera.get_translation");return n.xa(a)?d.bI(a,b):(h.error("get_eye(): Wrong object"),null)};a.w4=function(a,b){h.Rb("camera.get_pivot","camera.target_get_pivot");if(!d.Ea(a))return h.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));A.copy(a.k.pivot,b);return b};a.u5=function(a,b){h.Rb("camera.hover_cam_set_translation","camera.set_translation");if(d.$a(a)){var g=
a.k,k=A.subtract(b,y.F(g.n),D);A.add(k,g.Tb,g.Tb);f.Uc(a,b);f.D(a);x.H(a)}else h.error("hover_cam_set_translation(): wrong object")};a.Aw=function(a,b){h.Rb("camera.set_hover_pivot","camera.hover_set_pivot_translation");d.$a(a)?(d.Aw(a,b),f.D(a),x.H(a)):h.error("set_hover_pivot(): Wrong object or camera move style")};a.c4=function(a,b){h.Rb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!d.$a(a))return h.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);
b[0]=a.k.ka.down;b[1]=a.k.ka.up;return b};a.z3=function(a,b){h.Hh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!d.$a(a)&&!d.Ea(a))return h.error("get_cam_dist_limits(): wrong object"),null;if(a.k.sb)b=b||new Float32Array(2),b[0]=a.k.sb.max,b[1]=a.k.sb.min;else return null;return b};a.y1=function(b,g,k,n){h.Hh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);
if(d.Ea(b)){var e=M;e.down=g;e.up=k;e.camera_space=n==f.$m;a.VY(b,e)}else d.tc(b)?(e=M,e.down=g,e.up=k,e.camera_space=n==f.$m,a.HT(b,e)):d.$a(b)?(e=M,e.min=g,e.max=k,a.fV(b,e)):h.error("apply_vertical_limits(): wrong object")};a.u1=function(b,d,f){h.Rb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");M.down=d;M.up=f;a.fv(b,M)};a.q1=function(b,f,g){h.Hh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(d.Ea(b)){var k=M;
k.min=f;k.max=g;a.oM(b,k)}else d.$a(b)?(k=M,k.min=f,k.max=g,a.ev(b,k)):h.error("apply_distance_limits(): wrong object")};a.g2=function(b){h.Rb("camera.clear_distance_limits","camera.target_set_distance_limits");a.oM(b,null)};a.W4=function(a,b){h.Hh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!d.Ea(a)&&!d.tc(a)&&!d.$a(a))return h.error("get_vertical_limits(): wrong object"),null;var f=a.k;b=b||new Float32Array(2);
if(d.tc(a)||d.Ea(a)){if(f.ka)return b[0]=f.ka.down,b[1]=f.ka.up,b}else if(d.$a(a)&&f.zc)return b[0]=f.zc.min,b[1]=f.zc.max,b;return null};a.t1=function(b,g,k,n){h.Hh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(d.Ea(b)){var e=M;e.left=g;e.right=k;e.camera_space=n==f.$m;a.UY(b,e)}else d.tc(b)?(e=M,e.left=g,e.right=k,e.camera_space=n==f.$m,a.GT(b,e)):d.$a(b)?(e=M,e.min=g,e.max=k,a.eV(b,e)):h.error("apply_horizontal_limits(): wrong object")};
a.b4=function(a,b){h.Hh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!d.Ea(a)&&!d.tc(a)&&!d.$a(a))return h.error("get_horizontal_limits(): wrong object"),null;var f=a.k;b=b||new Float32Array(2);if(d.tc(a)||d.Ea(a)){if(f.lb)return b[0]=f.lb.left,b[1]=f.lb.right,b}else if(d.$a(a)&&f.yc)return b[0]=f.yc.min,b[1]=f.yc.max,b;return null};a.a4=function(a,b){if(!n.xa(a))return h.error("get_frustum_planes(): Wrong camera object"),
null;var d=k.B(),d=n.ja(a,d).ba[0].Ih;N.copy(d.left,b.left);N.copy(d.right,b.right);N.copy(d.top,b.top);N.copy(d.bottom,b.bottom);N.copy(d.near,b.near);N.copy(d.far,b.far);return b}};b4w.module.config=function(a,r){var m=r("__config"),d=r("__compat"),b=r("__debug"),t=r("__data"),q=r("__print");a.op=m.op;a.Yk=m.Yk;a.Wm=m.Wm;a.JE=m.JE;a.np=m.np;a.set=m.set;a.get=m.get;a.reset=m.reset;a.wC=m.wC;a.H4=m.Bu;a.Bu=m.Bu;a.en=function(a){t.Vg()?q.error("Cannot change quality profile after a scene is loaded."):(m.set("quality",a),b.Gu()&&(m.en(),d.jL(b.Gu(),!1)))}};b4w.module.constraints=function(a,r){var m=r("__camera"),d=r("__constraints"),b=r("__obj_util"),t=r("__physics"),q=r("__print"),z=r("__transform");a.n1=function(a,b,h,k,f){f=f||1;b instanceof Array&&2==b.length?d.bQ(a,b[0],b[1],h,k,f):d.pF(a,b,h,k,f);z.D(a);t.H(a)};a.l1=function(a,b,h,k){d.$P(a,b,h,k);z.D(a);t.H(a)};a.m1=function(a,b,h,k,f,r,g,A){m.tc(a)?(f=f||-Math.PI/2,r=r||Math.PI/2,g=g||Math.PI/2,A=A||-Math.PI/2,d.ZP(a,b,h,k,f,r,g,A),z.D(a),t.H(a)):q.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.k1=function(a,b,h,k){if(m.tc(a)){if(!k||0>k)k=.25;d.YP(a,b,h,k);z.D(a);t.H(a)}else q.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.dQ=function(a,b){d.eQ(a,b);z.D(a);t.H(a)};a.f1=function(a,b,h){d.SP(a,b,h);z.D(a);t.H(a)};a.o1=function(a,b,h,k){d.fQ(a,b,h,k);z.D(a);t.H(a)};a.p1=function(a,b){3==b.length?d.iQ(a,b):d.hQ(a,b);z.D(a);t.H(a)};a.i1=function(a,b,h,k){3==b.length?d.VP(a,b,h,k):d.UP(a,b,h,k);z.D(a);t.H(a)};a.$y=function(a,b,h){d.$y(a,b,h);
z.D(a);t.H(a)};a.remove=function(a){a.ic&&d.remove(a)};a.oI=function(a){q.Rb("constraints.get_parent","objects.get_parent");return b.oI(a)}};b4w.module.container=function(a,r){var m=r("__container"),d=r("__print");a.Cn=m.Cn;a.WH=m.WH;a.We=m.We;a.lv=function(a,r){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&r&&m.lv(a,r)};a.VK=m.VK;a.HM=m.HM;a.Pt=m.Pt;a.wA=m.wA;a.resize=function(a,r,q){a&&r||d.warn("Wrong canvas container dimensions: "+a+"x"+r+". Zero dimensions aren't allowed. Resized to: "+m.Lx+"x"+m.Kx+".");m.resize(a,r,q)};a.tk=function(a){m.tk(a||!1)}};b4w.module.controls=function(a,r){var m=r("__controls"),d=r("__print");a.qf=m.qf;a.ub=m.ub;a.Jx=m.Jx;a.vg=m.vg;a.bp=m.bp;a.Ix=m.Ix;a.Z_=8;a.M0=9;a.h0=13;a.I0=16;a.c0=17;a.X_=18;a.E0=19;a.a0=20;a.j0=27;a.K0=32;a.nE=37;a.qE=38;a.oE=39;a.mE=40;a.N_=49;a.O_=50;a.P_=51;a.Q_=52;a.R_=53;a.S_=54;a.T_=55;a.U_=56;a.V_=57;a.kE=65;a.Y_=66;a.XN=67;a.lE=68;a.g0=69;a.YN=70;a.l0=71;a.n0=72;a.o0=73;a.p0=74;a.ZN=75;a.$N=76;a.q0=77;a.s0=78;a.D0=79;a.bO=80;a.G0=81;a.cO=82;a.pE=83;a.eO=84;a.N0=85;a.O0=86;a.rE=87;a.P0=
88;a.Q0=89;a.R0=90;a.t0=96;a.u0=97;a.v0=98;a.w0=99;a.x0=100;a.y0=101;a.z0=102;a.A0=103;a.B0=104;a.C0=105;a.r0=106;a.W_=107;a.L0=109;a.e0=110;a.f0=111;a.H0=186;a.i0=187;a.b0=188;a.d0=189;a.F0=190;a.k0=191;a.m0=192;a.aO=219;a.$_=220;a.dO=221;a.J0=222;a.ht=m.ht;a.gt=m.gt;a.ft=m.ft;a.Ly=m.Ly;a.gu=m.gu;a.hu=m.hu;a.Xt=m.Xt;a.jn=m.jn;a.Oz=m.Oz;a.Pc=m.Pc;a.Nz=function(a,d,q){return m.Nz(a,d||"ANY",q||!1)};a.CG=m.CG;a.NG=function(a,d,q,r,n,x,h){return m.NG(a,d,q,r||"ANY",n||!1,x||!1,h||!1)};a.nq=m.nq;a.Rz=
m.Rz;a.ln=m.ln;a.LG=m.LG;a.MG=m.MG;a.au=m.au;a.Xz=m.Xz;a.XG=m.XG;a.WG=m.WG;a.KG=m.KG;a.YG=m.YG;a.FG=m.FG;a.HG=m.HG;a.GG=m.GG;a.JG=m.JG;a.IG=m.IG;a.VG=function(a,d){return m.VG(a,d||!1)};a.JK=m.JK;a.Wt=m.Wt;a.UG=m.UG;a.Zt=function(a,d){return m.Zt(a,d||!1)};a.Mz=function(a,d){return m.Mz(a,d||0)};a.b7=function(a,d){m.zX(a,d)};a.J3=function(a){return a.value};a.ag=m.ag;a.Kh=m.Kh;a.ua=function(a,d,q,r,n,x,h){n=n||m.gu;m.ua(a,d,q,r,n,x,void 0===h?null:h)};a.kn=function(a,d,q,r,n){var x;r=m.Pc(r);m.ua(a,
d,q,[r],m.gu,n,void 0===x?null:x)};a.d2=function(a){return m.Yp(a,null)};a.Yp=m.Yp;a.Vr=m.Vr;a.reset=m.reset;a.D6=function(){d.N("controls.register_keyboard_events() deprecated")};a.E6=function(){d.N("controls.register_mouse_events() deprecated")};a.G6=function(){d.N("controls.register_wheel_events() deprecated")};a.F6=function(){d.N("controls.register_touch_events() deprecated")};a.C6=function(){d.N("controls.register_device_orientation() deprecated")};a.F8=function(){d.N("controls.unregister_keyboard_events() deprecated")};
a.G8=function(){d.N("controls.unregister_mouse_events() deprecated")};a.I8=function(){d.N("controls.unregister_wheel_events() deprecated")};a.H8=function(){d.N("controls.unregister_touch_events() deprecated")};a.E8=function(){d.N("controls.unregister_device_orientation() deprecated")};a.pL=m.pL};b4w.module.data=function(a,r){var m=r("__data"),d=r("__loader");r("__print");a.load=m.load;a.fx=function(a){m.fx(a|0)};a.aL=m.aL;a.Vg=m.Vg;a.J5=d.$l;a.W5=m.load;a.sa=a.fx;a.jF=m.jF;a.nK=m.nK;a.GM=m.GM};b4w.module.debug=function(a,r){function m(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;O.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.xA.ALL_OPS-a.xA.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.xA,e=c.l_,f=t(c.TS),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";O.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);O.groupCollapsed("directives");for(var g=c.hb.Ei.slice().sort(),f=0;f<g.length;f++){var h=g[f];O.Zd(h[0],h[1])}O.groupEnd();O.groupCollapsed("node elements");g=c.hb.jg;for(f=0;f<g.length;f++)O.Zd(g[f]);O.groupEnd();O.groupCollapsed("vert source");O.Zd(c.j_);O.groupEnd();O.groupCollapsed("vert translated source");O.Zd(c.k_);O.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];O.groupCollapsed("vert ops stats");for(var k in e)-1==f.indexOf(k)&&O.Zd(k,e[k]);
O.groupEnd();O.groupCollapsed("vert assembly");O.Zd(c.i_);O.groupEnd();O.groupCollapsed("frag source");O.Zd(c.$T);O.groupEnd();O.groupCollapsed("frag translated source");O.Zd(c.aU);O.groupEnd();O.groupCollapsed("frag ops stats");for(k in d)-1==f.indexOf(k)&&O.Zd(k,d[k]);O.groupEnd();O.groupCollapsed("frag assembly");O.Zd(c.RT);O.groupEnd();O.groupEnd()}}function t(a){for(var b=[],c=P.Sq(),d=0;d<c.length;d++)for(var e=c[d],f=A.rc(e,"MESH",A.Jc),g=0;g<f.length;g++){var h=N.ja(f[g],e);if(h&&h.U.length)for(var h=
h.U,k=0;k<h.length;k++){var l=h[k];if(l.yb==a)for(var m=0;m<l.sd.length;m++){var n=l.sd[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function q(a,b){function c(){R.push(c);p=b;return a.apply(a,arguments)}return c}function z(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var n=r("__config"),x=r("__compat"),h=r("__controls"),k=r("__container"),
f=r("__debug"),y=r("__extensions"),g=r("__loader"),A=r("__objects"),N=r("__obj_util"),H=r("__physics"),O=r("__print"),D=r("__renderer"),P=r("__scenes"),K=r("__scenegraph"),M=r("__sfx"),F=r("__shaders"),c=r("__subscene"),l=r("__textures"),C=r("__util"),v=r("__vec3"),e=n.A,R=[],p="",ba=!0,J=new Float32Array(2);a.Qs=f.Qs;a.Sx=f.Sx;a.Rs=f.Rs;a.Rx=f.Rx;a.Ps=f.Ps;a.Qx=f.Qx;a.Px=f.Px;a.fp=f.fp;a.w6=function(){H.aT()};a.v6=function(a){O.log("O",H.NT(a));for(var b=H.mU().wc.ra,c=0;c<b.length;c++){var d=b[c];
d.C.ea==a&&O.log("B",d)}};a.U8=function(){for(var a=P.B(),b=A.rc(a,"MESH",A.Jc),a=[P.La(a,c.Ob),P.La(a,c.Lc),P.La(a,c.ee)],d=0;d<a.length;d++){var e=a[d],f=subs.Qa;if(f.length){O.group(e.type,"DYNAMIC");for(var g=0;g<b.length;g++){var h=b[g],k=h.k;if("DYNAMIC"==k.type)for(var l=!1,m=0;m<f.length;m++){for(var n=f[m].ra,p=0;p<n.length;p++){var q=n[p];if(q.ac&&q.bf==k){O.Zd(h.name,h);l=!0;break}}if(l)break}}O.groupEnd();O.groupCollapsed(e.type,"STATIC");for(g=0;g<b.length;g++)if(h=b[g],k=h.k,"DYNAMIC"!=
k.type)for(l=!1,m=0;m<f.length;m++){n=f[m].ra;for(p=0;p<n.length;p++)if(q=n[p],q.ac&&q.bf==k){O.Zd(h.name,h);l=!0;break}if(l)break}O.groupEnd()}}};a.o6=function(a){for(var b=P.B(),c=A.rc(b,"MESH",A.Jc),d=0;d<c.length;d++){var e=c[d];if(e.name==a){O.log("Object",e);for(var f=P.BA(b),g=0;g<f.length;g++){for(var h=f[g],k=[],l=h.Qa,m=0;m<l.length;m++)for(var n=l[m].ra,p=0;p<n.length;p++)n[p].bf==e.k&&k.push(n[p]);O.log("Subscene "+h.type,k)}}}};a.p6=function(){var a=P.B();console.log("Armatures: "+A.rc(a,
"ARMATURE",A.Jc).length);console.log("Cameras: "+A.rc(a,"CAMERA",A.Jc).length);console.log("Curves: "+A.rc(a,"CURVE",A.Jc).length);console.log("Empties: "+A.rc(a,"EMPTY",A.Jc).length);console.log("Lamps: "+A.rc(a,"LAMP",A.Jc).length);console.log("Meshes: "+A.rc(a,"MESH",A.Jc).length);console.log("Speakers: "+A.rc(a,"SPEAKER",A.Jc).length)};a.Ar=function(){for(var a=0,b=P.B(),b=[P.La(b,c.Ob),P.La(b,c.Lc),P.La(b,c.ee)],d=0;d<b.length;d++){var e=b[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=
e[f].ra,h=0;h<g.length;h++){var k=g[h].za;k&&(a+=k.Ar)}}return a};a.lm=function(){for(var a=0,b=P.B(),b=[P.La(b,c.Ob),P.La(b,c.Lc),P.La(b,c.ee)],d=0;d<b.length;d++){var e=b[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var k=g[h].za;k&&(a+=k.lm)}}return a};a.i6=function(){for(var a=P.B(),b=P.fD(a,[c.Ob,c.Lc,c.ee,c.Md,c.sf]),d=0,e=0;e<b.length;e++)for(var f=b[e],f=f.Qa,g=0;g<f.length;g++)d+=f[g].ra.length;a=P.fD(a,[c.md,c.Ke]);for(e=0;e<a.length;e++)for(f=a[e],f=f.Qa,
g=0;g<f.length;g++)d+=6*f[g].ra.length;return d};a.l6=function(){return C.Tq(F.XH())};a.w3=function(){for(var a=P.B(),b=P.BA(a),a={},d=0;d<b.length;d++){var e=b[d];if(e.type!=c.Zm&&e.type!=c.rf)for(var f=e.Qa,g=0;g<f.length;g++)for(var h=f[g].ra,k=0;k<h.length;k++){var l=h[k].za,m=h[k].bf;l&&(e.type!=c.pf&&e.type!=c.yg||m.Xv||m.Wv)&&(a[l.id]=l)}}var d=b=0,n;for(n in a)e=a[n].Ba,e.mn&&(d+=e.mn/1048576),b+=e.on/1048576;return{vbo_memory:b,ibo_memory:d}};a.m6=function(){for(var a=[],b=0,d=P.B(),d=[P.La(d,
c.Ob),P.La(d,c.Lc),P.La(d,c.ee)],e=0;e<d.length;e++){var f=d[e];if(f)for(var f=f.Qa,g=0;g<f.length;g++)for(var h=f[g].ra,k=0;k<h.length;k++){var l=h[k].za;if(l)for(var l=l.ya,m=0;m<l.length;m++){var n=l[m];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var p=n.rb;-1===a.indexOf(p)&&(a.push(p),n=n.width*n.height*4/1048576/n.kq,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.k6=function(){for(var a=[],b=0,d=P.B(),d=P.BA(d),e=0;e<d.length;e++){var f=d[e];if(f.type!=c.Zm){var g=f.p,h=[g.pc,
g.Re];h.push.apply(h,f.ei);for(f=0;f<h.length;f++){var k=h[f];l.On(k)&&-1==a.indexOf(k)&&(a.push(k),b+=g.width*g.height*l.SU(k))}}}return{number:a.length,memory:b/1024/1024}};a.dW=function(){var a=P.B();(a=P.La(a,c.Ob))&&P.EJ(a.p,a,[1,1,0])};a.gW=function(){var a=P.B(),b=P.La(a,c.Ob),a=P.fD(a,[c.cd]);if(b)for(var d=0;d<a.length;d++){var e=a[d],f;switch(d){case 0:f=[1,0,0];break;case 1:f=[0,1,0];break;case 2:f=[0,0,1];break;default:f=[1,0,1]}P.EJ(e.p,b,f)}};a.V6=function(){for(var a=P.Sq(),b=0;b<a.length;b++)O.log("\n"+
K.YS(P.JA(a[b])))};a.W6=function(){};a.Y5=function(){O.log("\n"+g.WU())};a.q2=h.debug;a.n6=function(a,b){return v.dist(m_tsr.F(a.k.n),m_tsr.F(b.k.n))};a.MJ=f.MJ;a.tu=f.tu;a.rK=f.rK;a.dC=f.dC;a.i3=function(a,b){function c(){f.tu("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.B1=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,
0,-1]);if(!C.Fj(a,C.RE))throw"Wrong VEC3_IDENT";if(!C.Fj(b,C.Xm))throw"Wrong QUAT4_IDENT";if(!C.Fj(c,C.li))throw"Wrong AXIS_X";if(!C.Fj(d,C.mi))throw"Wrong AXIS_Y";if(!C.Fj(e,C.$c))throw"Wrong AXIS_Z";if(!C.Fj(f,C.Dx))throw"Wrong AXIS_MX";if(!C.Fj(g,C.Wk))throw"Wrong AXIS_MY";if(!C.Fj(h,C.Zc))throw"Wrong AXIS_MZ";};a.g6=function(){for(var a=M.QU(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==M.OA(c)&&M.jc(c,!0)}};a.gG=function(a){f.gG(a)};a.d7=function(a){var b=P.B();if(b=P.La(b,c.rf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case f.Qs:case f.Sx:case f.Rs:case f.Rx:case f.Ps:case f.Qx:case f.Px:case f.fp:P.FX(b,a.debug_view_mode);break;default:O.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&P.EX(b,a.debug_colors_seed);"number"==typeof a.kX&&P.ZX(b,a.kX);"object"==typeof a.wireframe_edge_color&&P.jY(b,C.yf(a.wireframe_edge_color))}else O.error("Debugging is not available on the scene.")};a.O3=function(){return O.xU()};a.b5=function(){return O.UU()};
a.sG=function(){return O.sG()};a.d1=function(a){var c=F.XH(),e=0,g;for(g in c)a&&-1===g.indexOf(a)||e++;var e="of "+e+" analyzing...",h={};for(g in c)if(!a||-1!==g.indexOf(a)){var k=c[g],l;var n=k.rx;l=k.yu;var p=y.uU();if(p){var q=p.getTranslatedShaderSource(n),p=p.getTranslatedShaderSource(l);if(x.ku())var q=q.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),r=d("/analyze_shader/vert_gles",q),t=d("/analyze_shader/frag_gles",p);else q=q.replace("#version","#version 400 //"),
p=p.replace("#version","#version 400 //"),r=d("/analyze_shader/vert",q),t=d("/analyze_shader/frag",p);var v=m(r),A=m(t);l={j_:f.Gu().getShaderSource(n),k_:q,i_:r,l_:v,$T:f.Gu().getShaderSource(l),aU:p,RT:t,xA:A}}else O.error("WEBGL_debug_shaders extension not found"),l=void 0;q=k.hb;n=q.tg+" + "+q.Te;l.TS=k;l.hb=q;k=h[n]=h[n]||[];k.push(l);O.Zd(e)}for(n in h)O.group("%c"+n,"color: #800"),k=h[n],b(k),O.groupEnd()};a.uH=f.uH;a.qM=function(b){if(F.lG())if(y.HA()){var d=e.gl_debug;e.gl_debug=!0;var g=
K.jS();P.HH(null,g);for(var h=K.ec(g,c.mp),k=h.p,g=0;5>g;g++)D.sn(h);e.gl_debug=d;window.setTimeout(function(){f.XW(h);var a=h.xf;b(a,k.width*k.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.qM(b)},100)};a.WF=f.WF;a.JL=f.JL;a.qK=f.qK;a.d8=function(a){R=[];ba=!0;a=r(a);for(var b in a)"function"===typeof a[b]&&(a[b]=q(a[b],b))};a.V1=function(){return ba};a.test=function(a,b){try{return b(),!0}catch(c){return ba=!1,console.error(a+" test was failed. ",c),!1}};
a.y6=function(a){var b=k.II(),c=k.HI(),d=b/2,e=c/2;k.resize(b,c,!1);b=P.B().s.Wa;(c=K.OT(b))||C.q("Couldn't find onscreen subscene");b=c.p;d=k.Kt(d,e,J,c.p);d[1]=b.height-d[1];d=D.oC(b.Ve,d[0],d[1]);z(a,d,1)};a.X2=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+p;};a.Y2=z;a.W2=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.V2=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
r(a);for(var b in a)-1==R.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.q6=function(a){if(!Boolean(a))throw"Wrong result. Function: "+p;}};b4w.module.input=function(a,r){function m(a){var d=b.ia(b.Je);if(!d||!d.hh)return!1;if(g)return!0;var c=b.Mi(d,b.zN,f),k=b.Mi(d,b.AN,y);t.MC(a,c,k);if(c=b.Nu(d,H))k=h.B(),a=n.ja(a,k).ba,t.IC(a,c);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.Nu(b.bt)!==b.Hy&&(a.distortion_coefs=[d.distortion_coefs[0],d.distortion_coefs[1]],a.chromatic_aberration_coefs=[d.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]],
d.Yo||(d.Aj&&d.Uj&&d.Bj?a.base_line_factor=(d.Aj-d.Bj)/d.Uj:d.Bj||(a.base_line_factor=d.Aj/d.Uj)),d.Oi&&d.Pm&&!d.Yo&&(a.inter_lens_factor=d.Oi/d.Pm),A.enabled||(c=1+d.distortion_coefs[0]+d.distortion_coefs[1],h.NJ(c,c)));h.zw(a);z.tk(!0);b.vC(d);return g=!0}function d(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=r("__input"),t=r("__camera"),q=r("__config"),z=r("__container"),
n=r("__obj_util"),x=r("__print"),h=r("__scenes"),k=r("__vec4"),f=k.create(),y=k.create(),g=!1,A=q.uq,N=q.A;a.gy=b.gy;a.hy=b.hy;a.jy=b.jy;a.iy=b.iy;a.vy=b.vy;a.cy=b.cy;a.dy=b.dy;a.oy=b.oy;a.xy=b.xy;a.Xs=b.Xs;a.wy=b.wy;a.Ws=b.Ws;a.yy=b.yy;a.zy=b.zy;a.ey=b.ey;a.fy=b.fy;a.ky=b.ky;a.ly=b.ly;a.my=b.my;a.ny=b.ny;a.py=b.py;a.qy=b.qy;a.ry=b.ry;a.sy=b.sy;a.ty=b.ty;a.uy=b.uy;a.Ss=b.Ss;a.Ts=b.Ts;a.Us=b.Us;a.Vs=b.Vs;a.Xx=b.Xx;a.Yx=b.Yx;a.Zx=b.Zx;a.$x=b.$x;a.ay=b.ay;a.by=b.by;a.Vx=b.Vx;a.Wx=b.Wx;a.$s=b.$s;a.at=
b.at;a.bt=b.bt;a.fE=b.fE;a.gE=b.gE;a.eE=b.eE;a.Hy=b.Hy;var H=b.Dy;a.Dy=H;a.Cy=b.Cy;a.Ay=b.Ay;a.Fy=b.Fy;a.Gy=b.Gy;a.Ey=b.Ey;a.By=b.By;a.pi=b.pi;a.Xk=b.Xk;a.kp=b.kp;a.lp=b.lp;a.ip=b.ip;a.hp=b.hp;a.al=b.al;a.rp=b.rp;a.$k=b.$k;a.Zs=b.Zs;a.Um=b.Um;var O={};O[b.Je]=[b.$s,b.at];O[b.ad]=[b.pi];var D={};D[b.Je]=[b.bt];var P={};P[b.ad]=[b.pi,b.Xk,b.kp,b.lp];P[b.cp]=[b.ip,b.hp];P[b.wg]=[b.al,b.rp,b.$k];P[b.rh]=[b.Zs,b.Um];var K={};K[b.Je]=[b.Cy,b.Dy,b.Ay,b.Fy,b.Gy,b.Ey,b.By];a.rh=b.rh;a.Je=b.Je;a.ad=b.ad;a.cp=
b.cp;a.wg=b.wg;a.uz=b.uz;a.ia=b.ia;a.lD=function(a,d){a&&b.lD(a,d)};a.B6=function(){x.N("input.register_device() deprecated")};a.vC=function(a){a&&a.type==b.Je?b.vC(a):x.error("reset_device is undefined for device.")};a.Mi=function(a,d,c){if(a&&a.type in O&&0<=O[a.type].indexOf(d))return b.Mi(a,d,c);x.error("device hasn't param: ",d)};a.Nu=function(a,d){if(a&&a.type in D&&0<=D[a.type].indexOf(d))return b.Nu(a,d);x.error("device hasn't param: ",d)};a.xd=function(a,d,c){c=c||null;if(a&&a.type in P&&
0<=P[a.type].indexOf(d))return b.xd(a,d,c);x.error("device hasn't param: ",d)};a.Ad=function(a,d,c){c=c||null;if(a&&a.type in P&&0<=P[a.type].indexOf(d))return b.Ad(a,d,c);x.error("device hasn't param: ",d)};a.GC=function(a,d,c){if(a&&a.type in K&&0<=K[a.type].indexOf(d))return b.GC(a,d,c);x.error("device hasn't config: ",d)};a.M6=function(){if(h.Ca()){var a=h.Sl(h.B());if(a&&(m(a),a=b.ia(b.Je))){var d=a.Of;d&&!d.isPresenting&&(d.capabilities.canPresent?(a=z.Cn(),d.requestPresent([{source:a}]).then(function(){if(!N.is_mobile_device){var a=
d.getEyeParameters("left"),b=d.getEyeParameters("right");z.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){x.error("HMD fullscreen request failed.")})):x.error("HMD fullscreen request failed."))}}};a.U2=m;a.J2=function(){var a=b.ia(b.Je);if(!(g||a&&a.hh))return!1;h.zw({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);h.NJ(a,a);z.tk(!0);return!0};a.j7=function(a,f,c){d();switch(a){case 0:a=b.Ns;break;case 1:a=b.Mx;break;
case 2:a=b.Nx;break;case 3:a=b.Ox;break;default:a=b.Ns}a=b.ia(a);b.GC(a,f,c)};a.pI=b.pI;a.jI=b.jI;a.qR=d};b4w.module.main=function(a,r){function m(){}function d(){}function b(){}function t(){window.performance||(J.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(J.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});ga.vL(0)}function q(a,b){for(var c=null,d=b?la:xa,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,u)}catch(g){}if(c)break}c&&D.fT(c);return c}function z(a,b,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();J.error("WebGL context lost");x()},!1);c.If(e);var f=c.Ku();f&&J.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));B.If(e);l.If(e);w.If(e);Z.If(e);F.If(e);P.If(e);M.kY(a);P.Tg(a,b);V.AL(a.width,a.height,1);U.Tg();d=g();k()}function n(){m=function(){}}function x(){h()||(pa=performance.now()/1E3,U.pause(),ba.pause(),w.pause(),A.pause())}function h(){return S<pa}function k(){var a="HMD"===aa.stereo&&
C.LI();a?a.requestAnimationFrame(k):ya(k);var b=performance.now()/1E3;wa||(wa=b);var c=b-wa;if(!(c<1/aa.max_fps)){for(var e=ga.Wq(),f=0;f<fa.length;f++)fa[f](e,c);h()||(S>wa&&(c-=S-Math.max(pa,wa)),e+=c,ga.vL(e),F.update(),H.update(),M.update(),y(e,c),d(c));wa=b;a&&a.isPresenting&&a.submitFrame()}}function f(a,b,c){if(ca)if(ca.YY)ca.YY(a,b,c);else{c=atob(ca.toDataURL(b,c).split(",")[1]);for(var d=new Uint8Array(c.length),e=0;e<c.length;e++)d[e]=c.charCodeAt(e);a(new Blob([d],{type:b||"image/png"}))}}
function y(a,b){if(M.Vg()&&(v.reset(),Q.update(b),R.update(a,b),e.update(a,b),U.update(a,b),b&&N.update(b),M.Vg()&&(ba.update(a,b),M.Vg()&&(C.update(a),K.update(a,b),M.Vg()&&(A.update(!1),p.update(a,b),ia.update(),m(b,a),M.Vg()))))){V.update(a,b);A.RM();var c=oa.callback;c&&(oa.vJ&&URL.revokeObjectURL(oa.gz),f(function(a){oa.gz=URL.createObjectURL(a);c(oa.gz)},oa.format,oa.quality),oa.callback=null,oa.format="image/png",oa.quality=1)}}function g(){var a=60,c=0,d=aa.yH,e=aa.ST;return function(f){f<
1/aa.max_fps||(a=I.vc(1/f,a,f,d),f=ba.EU(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var A=r("__anchors"),N=r("__animation"),H=r("__assets"),O=r("__config"),D=r("__compat"),P=r("__container"),K=r("__controls"),M=r("__data"),F=r("__debug"),c=r("__extensions"),l=r("__geometry"),C=r("__input"),v=r("__hud"),e=r("__nla"),R=r("__logic_nodes"),p=r("__objects"),ba=r("__physics"),J=r("__print"),B=r("__renderer"),V=r("__scenes"),U=r("__sfx"),Z=r("__shaders"),w=r("__textures"),ga=r("__time"),Q=r("__transform"),I=
r("__util"),Y=r("__version"),ia=r("__particles"),u=O.context,aa=O.A,ca=null,ja=null,wa=0,pa=0,S=0,fa=[],oa={callback:null,format:"image/png",quality:1,gz:"",vJ:!1,aH:!1},xa=["webgl","experimental-webgl"],la=["webgl2","experimental-webgl2"],X=null,ya=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/aa.max_fps)}}();a.Tg=function(a,
b){O.WX();J.fY(aa.console_verbose);var c=Y.ND()+" "+Y.type()+" ("+Y.cA()+")";J.log("%cINIT ENGINE","color: #00a",c);J.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;t();ca=a;b?(v.Tg(b),ja=b):(O.A.show_hud_debug_info=!1,O.W.Kv=!1);D.lQ();D.xz("Chrome")||D.xz("Firefox")||(aa.cc=!1);c=q(a,aa.cc);!c&&aa.cc&&(aa.cc=!1,c=q(a,!1));if(!c)return null;J.log("%cINIT WEBGL "+(aa.cc?"2":"1"),"color: #00a");X=c;z(ca,ja,c);O.en();D.jL(c,!0);Z.VV();aa.Fn&&(a.style["touch-action"]=
"none");J.log("%cSET PRECISION:","color: #00a",aa.precision);return c};a.resize=function(a,b,c){J.Rb("main.resize","container.resize");P.resize(a,b,c)};a.KX=function(a){b=a};a.h2=function(){b=function(){}};a.B7=function(a){m=a};a.l2=function(){n()};a.d5=function(){J.Rb("main.global_timeline","time.get_timeline");return ga.Wq()};a.pause=x;a.cj=function(){h()&&(S=performance.now()/1E3,U.cj(),ba.cj(),w.play(!0),A.cj())};a.jr=h;a.reset=function(){M.fx(0);M.reset();c.reset();B.reset();l.reset();w.pX();
Z.reset();F.reset();P.reset();M.reset();P.reset();ga.reset();U.reset();ja=ca=null;S=pa=wa=0;b=function(){};d=function(){};m=function(){};fa.length=0;X=null};a.M1=function(a,b,c,d){oa.aH="undefined"===typeof d?d:!0;oa.vJ=oa.aH;oa.callback=a;oa.format=b||oa.format;oa.quality=c||oa.quality};a.E3=function(){J.Rb("main.get_canvas_elem","container.get_canvas");return ca};a.ku=function(){return D.ku()};a.Ap=function(a){for(var b=0;b<fa.length;b++)if(fa[b]==a)return;fa.push(a)};a.dX=function(a){for(var b=
0;b<fa.length;b++)if(fa[b]==a){fa.splice(b,1);break}};a.Ku=function(){var a=c.Ku();return a?{vendor:X.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:X.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.physics=function(a,r){function m(a,b,d,k){return q.jT(a,k[d[0]],k[d[1]],k[d[2]])}function d(a,b,d,k,f){b=Math.abs(a[2]-b[2]);return b<f&&z.zV(a,d,k)?b:Number.MAX_VALUE}r("__config");var b=r("__physics"),t=r("__print"),q=r("__util"),z=r("__navmesh");r("__vec3");new Float32Array(3);a.vN=0;a.v_=1;a.u_=2;a.bE=3;a.oH=function(a){b.na(a)?b.oH(a):t.N("No physics for object "+a.name)};a.jA=function(a){b.na(a)?b.jA(a):t.N("No physics for object "+a.name)};a.m5=function(a){return b.na(a)};a.VA=function(a){return b.VA(a)};
a.SI=function(a){return b.SI(a)};a.iL=function(a,d){b.na(a)?b.iL(a,d):t.N("No physics for object "+a.name)};a.Dw=function(a,d,h){b.na(a)?b.Dw(a,d,h):t.N("No physics for object "+a.name)};a.H=function(a){b.na(a)?b.H(a):t.N("No physics for object "+a.name)};a.uF=function(a,d,h,k){b.na(a)?b.uF(a,d,h,k):t.N("No physics for object "+a.name)};a.vF=function(a,d,h,k){b.na(a)?b.vF(a,d,h,k):t.N("No physics for object "+a.name)};a.bz=function(a,d,h,k){b.na(a)?b.bz(a,d,h,k,!1):t.N("No physics for object "+a.name)};
a.s1=function(a,d,h,k){b.na(a)?b.bz(a,d,h,k,!0):t.N("No physics for object "+a.name)};a.tF=function(a,d,h,k){b.na(a)?b.tF(a,d,h,k):t.N("No physics for object "+a.name)};a.Uo=function(a,d){b.na(a)?(b.Ye(a)||b.Ze(a)||t.error("Wrong object"),b.Uo(a,q.V(d,-1,1))):t.N("No physics for object "+a.name)};a.S8=function(a,d,h){if(b.na(a)){b.Ye(a)||b.Ze(a)||t.error("Wrong object");d=q.V(d,0,1);var k=a.v.tn;-1==h||1==h?k=Math.max(-1,Math.min(k+h*d,1)):0==h&&0<=k?(k-=d,k=Math.max(0,k)):0==h&&0>k?(k+=d,k=Math.min(0,
k)):t.error("Wrong steering direction");b.Uo(a,q.V(k,-1,1))}else t.N("No physics for object "+a.name)};a.To=function(a,d){b.na(a)?(b.Ye(a)||b.Ze(a)||t.error("Wrong object"),b.To(a,q.V(d,-1,1))):t.N("No physics for object "+a.name)};a.Q8=function(a,d,h){if(b.na(a)){b.Ye(a)||b.Ze(a)||t.error("Wrong object");d=q.V(d,0,1);var k=a.v.Do;-1==h||1==h?k=Math.max(-1,Math.min(k+h*d,1)):0==h&&0<=k?(k-=d,k=Math.max(0,k)):0==h&&0>k?(k+=d,k=Math.min(0,k)):t.error("Wrong steering direction");b.To(a,q.V(k,-1,1))}else t.N("No physics for object "+
a.name)};a.MD=function(a,d){b.na(a)?(b.Ye(a)||b.Ze(a)||t.error("Wrong object"),b.MD(a,q.V(d,0,1))):t.N("No physics for object "+a.name)};a.P8=function(a,d){if(b.na(a)){b.Ye(a)||b.Ze(a)||t.error("Wrong object");d=q.V(d,-1,1);var h=a.v.Qp;b.MD(a,q.V(h+h*d,0,1))}else t.N("No physics for object "+a.name)};a.Ye=function(a){return b.Ye(a)};a.Ze=function(a){return b.Ze(a)};a.Q4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.kf.name;t.error("Wrong object");
return null};a.T4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.v.tn;t.error("Wrong object");return null};a.S4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.v.Do;t.error("Wrong object")};a.P4=function(a){if(!b.na(a))return t.N("No physics for object "+a.name),null;if(b.Ye(a)||b.Ze(a))return a.v.Qp;t.error("Wrong object")};a.GI=function(a){if(!b.na(a))return t.N("No physics for object "+
a.name),null;if(b.Ye(a)||b.Ze(a))return b.GI(a);t.error("Wrong object")};a.dg=function(a){return b.dg(a)};a.FC=function(a,d,h){b.na(a)?b.FC(a,d,h):t.N("No physics for object "+a.name)};a.ww=function(a,d){b.na(a)?b.ww(a,d):t.N("No physics for object "+a.name)};a.$K=function(a,d){b.na(a)?b.$K(a,d):t.N("No physics for object "+a.name)};a.ZK=function(a,d){b.na(a)?b.ZK(a,d):t.N("No physics for object "+a.name)};a.WK=function(a,d){b.na(a)?b.WK(a,d):t.N("No physics for object "+a.name)};a.dG=function(a){b.na(a)?
b.dG(a):t.N("No physics for object "+a.name)};a.eG=function(a,d,h){b.na(a)?b.eG(a,d,h):t.N("No physics for object "+a.name)};a.xw=function(a,d,h){b.na(a)?b.xw(a,d,h):t.N("No physics for object "+a.name)};a.YK=function(a,d){b.na(a)?b.YK(a,d):t.N("No physics for object "+a.name)};a.XK=function(a,d){b.na(a)?b.XK(a,d):t.N("No physics for object "+a.name)};a.Zy=function(a,d,h,k){b.na(a)?b.Zy(a,d||"ANY",h,k||!1):t.N("No physics for object "+a.name)};a.rC=function(a,d,h){b.na(a)?b.rC(a,d||"ANY",h):t.N("No physics for object "+
a.name)};a.az=function(a,d){b.na(a)?b.az(a,d):t.N("No physics for object "+a.name)};a.zz=function(a){b.na(a)?b.zz(a):t.N("No physics for object "+a.name)};a.wt=function(a,d,h,k,f,m){a=a||null;if(null==a||b.na(a))return b.wt(a,d,h,k||"ANY",f,m||!1,!1,!1,!1);t.N("No physics for object "+a.name)};a.j1=function(a,d,h,k,f,m,g,q,r){a=a||null;if(null==a||b.na(a))return b.wt(a,d,h,k||"ANY",f,m||!1,g||!1,q||!1,r||!1);t.N("No physics for object "+a.name)};a.sC=function(a){b.lJ(a)?b.sC(a):t.error("Wrong ray test ID")};
a.bG=function(a,d,h){b.lJ(a)?b.bG(a,d,h):t.error("Wrong ray test ID")};a.qF=function(a,d,h,k,f,m,g,q,r,z){b.na(d)&&b.na(f)?b.qF(a,d,h,k,f,m,g,q,r,z):t.error("Wrong objects")};a.rG=function(a){b.na(a)&&b.ZU(a)?b.rG(a):t.error("Wrong object")};a.uK=function(a,d,h,k,f,m){b.na(a)&&b.na(k)?b.uK(a,d,h,k,f,m):t.error("Wrong objects")};a.PJ=function(a,d,h){h||(h=m);if(b.na(a)){var k=a.C.xr;return k?z.PJ(k,d,h):(t.error(a.name+" is not a navigation mesh object"),null)}t.N("No physics for object "+a.name)};
a.OJ=function(a,q,h,k){if(b.na(a)){var f=a.C.xr;if(!f)return t.error(a.name+" is not a navigation mesh object"),null;k=k||{};a={};a.do_not_pull_string=Boolean(k.do_not_pull_string);a.distance_to_closest=k.distance_to_closest||m;a.distance_to_farthest=k.distance_to_farthest||d;a.island=k.island||0;a.allowed_distance=k.allowed_distance||Number.MAX_VALUE;a.return_normals=k.return_normals||!1;return z.OJ(f,q,h,a)}t.N("No physics for object "+a.name)}};b4w.module.scenes=function(a,r){function m(){var a=t.Cn();return n.Ir(a.clientWidth/2,a.clientHeight/2)}var d=r("__batch"),b=r("__camera"),t=r("__container"),q=r("__data"),z=r("__graph"),n=r("__objects"),x=r("__obj_util"),h=r("__print"),k=r("__scenes"),f=r("__subscene"),y=r("__util");a.Jc=n.Jc;a.uw=function(a){var b=k.Sq();k.uw(y.Cd("name",a,b))};a.B=function(){return k.Ca()?k.B().name:""};a.C4=function(){for(var a=k.Sq(),b=[],d=0;d<a.length;d++)b.push(a[d].name);return b};a.AA=function(){if(k.Ca())return k.Sl(k.B());
h.error("No active scene");return!1};a.m4=function(a,b){var d=n.qc(n.Ux,a,b|0,!0);if(d)return d;h.error("get object "+a+": not found")};a.k4=function(a,b,d){if(a=n.qc(n.Tx,a,b,d|0))return a;h.error("get object "+b+": not found")};a.l4=function(a,b){var d=n.qc(n.Kc,a,b|0);if(d)return d;h.error("get object "+a+": not found")};a.Pu=function(a,b){var d=n.Pu(a,b|0);if(d)return d;h.error("get object "+a+": not found")};a.LA=function(a){return x.LA(a)};a.Ir=function(a,b){var d=k.Jh();return d?(d=k.La(d,
f.qi))&&d.enable_hmd_stereo?(h.N("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),m()):n.Ir(a,b):(h.error("No active scene"),null)};a.x6=m;a.s6=function(a){return a&&a.k&&a.k.Tc};a.nL=function(a,b){a&&a.k&&a.k.Tc?n.nL(a,b):h.error("set_outline_intensity(): wrong object")};a.u4=function(a){if(a&&a.k&&a.k.Tc)return a.k.dh;h.error("get_outline_intensity(): wrong object")};a.dn=function(a,b,d,f){a&&a.k&&a.k.Tc?n.dn(a,b,d,f):h.error("apply_outline_anim(): wrong object")};
a.w1=function(a){if(a&&a.k&&a.k.Tc){var b=a.k.Th;n.dn(a,b.jk,b.kk,b.lk)}else h.error("apply_outline_anim_def(): wrong object")};a.Nt=function(a){a&&a.k&&a.k.Tc?n.Nt(a):h.error("clear_outline_anim(): wrong object")};a.mL=k.mL;a.t4=function(a){var b=k.B();if(b=k.La(b,f.Vm))return a=a||new Float32Array(3),a.set(b.aj),a};a.zw=function(a){k.Ca()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),k.zw(a)):h.error("No active scene")};a.D4=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B(),b=k.La(a,f.cd);if(!b)return null;var d=a.s.ud,m=k.La(a,f.Ob),n=k.La(a,f.tf),q={};q.csm_resolution=d.csm_resolution;q.self_shadow_polygon_offset=b.self_shadow_polygon_offset;
n&&(q.self_shadow_normal_offset=n.self_shadow_normal_offset);q.enable_csm=d.enable_csm;q.csm_num=d.csm_num;q.csm_first_cascade_border=d.csm_first_cascade_border;q.first_cascade_blur_radius=d.first_cascade_blur_radius;q.csm_last_cascade_border=d.csm_last_cascade_border;q.last_cascade_blur_radius=d.last_cascade_blur_radius;q.fade_last_cascade=d.fade_last_cascade;q.blend_between_cascades=d.blend_between_cascades;d.enable_csm?(q.csm_borders=k.tU(a,m.p),q.blur_radii=new Float32Array(d.csm_num),q.blur_radii.set(m.p.bo.subarray(0,
d.csm_num))):(q.csm_borders=null,q.blur_radii=null);return q};a.G7=function(a){if(k.Ca()){var m=k.B();"number"==typeof a.self_shadow_polygon_offset&&z.oa(m.s.Wa,function(b,d){d.type==f.cd&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var n=k.La(m,f.tf);n&&("number"==typeof a.self_shadow_normal_offset&&(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius));var q=k.La(m,f.Lc);q&&("number"==typeof a.self_shadow_normal_offset&&
(q.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(q.pcf_blur_radius=a.pcf_blur_radius),q.Aa=!0);q=m.s.ud;"number"==typeof a.csm_first_cascade_border&&(q.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(q.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(q.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(q.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(n){for(var r=n.Qa,t=0;t<r.length;t++)for(var y=r[t].ra,K=0;K<y.length;K++){var M=y[K];if(M.bf.ce){var F=M.za;d.xF(F,q);d.Wc(F);f.Oc(n,M)}}n.Aa=!0}n=x.ja(m.vj,m).ba;for(t=0;t<n.length;t++)b.FD(n[t],q);k.EC(m)}else h.error("No active scene")};a.aI=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.aI(a)};a.HC=function(a,b,d){if(k.Ca()){var m=k.B(),n=k.La(m,f.Ob);k.HC(m,a||0==a?parseFloat(a):n.Og,b||0==b?b:n.he,d||0==d?d:n.pe)}else h.error("No active scene")};
a.dI=function(a){if(!k.Ca())return h.error("No active scene"),!1;var b=k.B();return k.dI(b,a)};a.LC=function(a){if(k.Ca()){var b=k.B();k.LC(b,a)}else h.error("No active scene")};a.X3=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B(),b={};b.Kq=k.BU(a);b.fog_depth=k.zU(a);b.fog_start=k.CU(a);b.fog_height=k.AU(a);return b};a.g7=function(a){if(k.Ca()){var b=k.B();"number"==typeof a.Kq&&k.eL(b,a.Kq);"number"==typeof a.fog_depth&&k.cL(b,a.fog_depth);"number"==typeof a.fog_start&&k.fL(b,
a.fog_start);"number"==typeof a.fog_height&&k.dL(b,a.fog_height)}else h.error("No active scene")};a.BI=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.BI(a)};a.tL=function(a){if(k.Ca()){var b=k.B();k.tL(b,a)}else h.error("No active scene")};a.F3=function(){if(!k.Ca())return h.error("No active scene"),null;var a=k.B(),a=k.La(a,f.Gx);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.Z6=
function(a){if(k.Ca()){var b=k.B();if(b=k.La(b,f.Gx))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Aa=!0}else h.error("No active scene")};a.zI=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.zI(a)};a.rL=function(a){if(k.Ca()){var b=k.B();k.rL(b,a)}else h.error("No active scene")};a.ZH=function(){if(!k.Ca())return h.error("No active scene"),
!1;var a=k.B();return k.La(a,f.ep)?k.ZH(a):null};a.bL=function(a){if(k.Ca()){var b=k.B();k.bL(b,a)}else h.error("No active scene")};a.gI=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.La(a,f.uj)?k.gI(a):null};a.hL=function(a){if(k.Ca()){var b=k.B();k.hL(b,a)}else h.error("No active scene")};a.TH=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.La(a,f.$o)?k.TH(a):null};a.UK=function(a){if(k.Ca()){var b=k.B();k.UK(b,a)}else h.error("No active scene")};
a.fI=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.La(a,f.gp)?k.fI(a):null};a.gL=function(a){if(k.Ca()){var b=k.B();k.gL(b,a)}else h.error("No active scene")};a.NI=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.NI(a)};a.zL=function(a){if(k.Ca()){var b=k.B();n.zL(b,a)}else h.error("No active scene")};a.KI=function(a,b){if(!k.Ca())return h.error("No active scene"),0;var d=k.B();return d.s.Ic?k.KI(d,a,b):(h.error("No water parameters on the active scene"),
0)};a.yL=function(a){if(k.Ca()){var b=k.B();k.yL(b,a)}else h.error("No active scene")};a.JI=function(a){if(k.Ca()){var b=k.B();k.JI(b,a)}else h.error("No active scene")};a.M8=function(){if(k.Ca()){var a=k.B();k.OM(a)}else h.error("No active scene")};a.t5=function(a,b){b=b||!1;!x.Yd(a)&&!x.Kn(a)||x.Ra(a)?b?k.Wp(a,!0):k.cG(a,!0):h.error("show/hide is only supported for dynamic objects.")};a.S7=function(a,b){b=b||!1;!x.Yd(a)&&!x.Kn(a)||x.Ra(a)?b?k.Wp(a,!1):k.cG(a,!1):h.error("show/hide is only supported for dynamic objects.")};
a.hB=function(a){if(x.rV(a)||x.Kn(a)||x.qv(a))return k.hB(a);h.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.Pn=function(a){return a.k.Pn};a.Z1=function(a){h.Rb("scenes.check_object","scenes.check_object_by_name");return k.Ca()?n.zW(a,k.B()):(h.error("No active scene"),!1)};a.c2=function(a,b){return n.qc(n.Ux,a,b|0,!0)?!0:!1};a.a2=function(a,b,d){return n.qc(n.Tx,a,b,d|0)?!0:!1};a.b2=function(a,b){return n.qc(n.Kc,a,b|0)?!0:!1};a.Rl=function(a,b){var d=k.B();
a||(a="ALL");b||0===b||(b=n.Jc);return n.wI(d,a,b)};a.p4=function(a){return a?a.mm:(h.error("Wrong object name"),"")};a.q4=function(a){if(!a)return h.error("Wrong object name"),null;for(var b=[];a;)b.push(a.mm),a=x.Ki(a);return b.reverse()};a.r4=function(a){return a&&a.type?a.type:(h.error("Wrong object"),"UNDEFINED")};a.o4=function(a){h.Rb("scenes.get_object_dg_parent","objects.get_dg_parent");return x.Ki(a)};a.n4=function(a){return a.Pe.slice(0)};a.Fu=function(){return n.Fu(k.B())};a.yI=function(a,
b){b||0===b||(b=1);if(!k.Ca())return h.error("No active scene"),!1;var d=k.B();return k.yI(d,a,b)};a.VH=function(){return k.VH()};a.M4=function(a){return x.Yd(a)?a.k.type:null};a.Hu=function(){if(!k.Ca())return h.error("No active scene"),!1;var a=k.B();return k.Hu(a)};a.cn=function(a,b){if(a.k.nv){if(b)var d=k.Sq(),d=y.Cd("name",b,d);else d=k.B();k.cn(d,a,!0)}else h.error('object "'+a.name+'" has been created not by coping.')};a.Ur=function(a){(x.Yd(a)||x.Kn(a))&&x.Ra(a)?(n.Uv(a,a.k.ov,!1,!1),q.VW(a),
n.Uv(a,!0,!0,!0),n.Ur(a)):h.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.FJ=function(a){var b=k.B();if(b.timeline_markers&&a in b.timeline_markers)return k.FJ(b,a);h.error('"'+a+'" marker not found.');return 0};a.h4=function(){var a=k.B();return(a=k.La(a,f.sh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.s7=function(a){var b=k.B();(b=k.La(b,f.sh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),
"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):h.error("The motion blur subscene doesn't exist.")};a.L1=function(){var a=k.B();return Boolean(k.La(a,f.pf))}};b4w.module.transform=function(a,r){var m=r("__obj_util"),d=r("__physics"),b=r("__print"),t=r("__quat"),q=r("__transform"),z=r("__tsr"),n=r("__util"),x=z.create(),h=new Float32Array(3),k=new Float32Array(4);a.$m=q.$m;a.QE=q.QE;a.Uc=function(a,k,g,n){m.Ra(a)?(h[0]=k,h[1]=g,h[2]=n,q.Uc(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Ew=function(a,k,g,n){m.Ra(a)?(h[0]=k,h[1]=g,h[2]=n,q.Ew(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.dY=function(a,
h){m.Ra(a)?(q.Uc(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.J7=function(a,h){m.Ra(a)?(q.Ew(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.I7=function(a,k,g,r,t){m.Ra(a)?(h[0]=k,h[1]=g,h[2]=r,n.Vc(h,1,z.R(t.k.n),z.F(t.k.n),h),q.Uc(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Bf=function(a,b){b||(b=new Float32Array(3));q.Bf(a,b);return b};a.EI=function(a,b){b||(b=new Float32Array(3));q.EI(a,b);return b};
a.Zh=function(a,h,g,n,r){m.Ra(a)?(k[0]=h,k[1]=g,k[2]=n,k[3]=r,q.Zh(a,k),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Cw=function(a,h,g,n,r){m.Ra(a)?(k[0]=h,k[1]=g,k[2]=n,k[3]=r,q.Cw(a,k),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.F7=function(a,h){m.Ra(a)?(q.Zh(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.E7=function(a,h){m.Ra(a)?(q.Cw(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.En=
function(a,b){b||(b=new Float32Array(4));q.En(a,b);return b};a.tI=function(a,b){b||(b=new Float32Array(4));q.tI(a,b);return b};a.QC=function(a,k,g,n){m.Ra(a)?(h[0]=k,h[1]=g,h[2]=n,q.QC(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rI=function(a,b){b||(b=new Float32Array(3));q.rI(a,b);return b};a.sI=function(a,b){b||(b=new Float32Array(3));q.sI(a,b);return b};a.RC=function(a,k,g,n){m.Ra(a)?(h[0]=k,h[1]=g,h[2]=n,q.RC(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.D7=function(a,h){m.Ra(a)?(q.QC(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.C7=function(a,h){m.Ra(a)?(q.RC(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Hf=function(a,d){m.Ra(a)?(q.Hf(a,d),q.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.SC=function(a,d){m.Ra(a)?(q.SC(a,d),q.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Xd=function(a){return q.Xd(a)};a.vI=function(a){return q.vI(a)};
a.P2=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var h=0;h<a.Pe.length;h++)if(!m.Ra(a.Pe[h])){b.error('Wrong object: "'+a.Pe[h].name+'" is not dynamic.');return}q.Uc(a,[0,0,0]);q.Zh(a,[0,0,0,1]);q.Hf(a,1);q.D(a);d.H(a)}};a.Ju=function(a){return m.Yd(a)?q.Ju(a):(b.error("Wrong object: "+a.name),0)};a.Iu=function(a,d,g){if(!m.Yd(a))return b.error("Wrong object: "+a.name),null;g||(g=new Float32Array(3));return q.Iu(a,d,g)};a.$g=function(a,h,g,k){m.Ra(a)?(q.$g(a,h,g,k),q.D(a),
d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.P6=function(a,h){if(m.Ra(a)){var g=t.setAxisAngle(n.li,h,k);q.BC(a,g);q.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Q6=function(a,h){if(m.Ra(a)){var g=t.setAxisAngle(n.Wk,h,k);q.BC(a,g);q.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.S6=function(a,h){if(m.Ra(a)){var g=t.setAxisAngle(n.$c,h,k);q.BC(a,g);q.D(a);d.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.nI=function(a){return q.nI(a)};a.fj=function(a,h){m.Ra(a)?(q.fj(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Fw=function(a,h){m.Ra(a)?(q.Fw(a,h),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Xq=function(a,b){b||(b=new Float32Array(8));q.Xq(a,b);return b};a.Yq=function(a,b){b||(b=new Float32Array(8));q.Yq(a,b);return b};a.distance=function(a,b){return q.distance(a,b)};a.q7=function(a,h){m.Ra(a)?(z.Ji(h,x),q.fj(a,x),q.D(a),d.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.r7=function(a,h){m.Ra(a)?(z.Ji(h,x),q.Fw(a,x),q.D(a),d.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.f4=function(a,b){b||(b=new Float32Array(16));q.Xq(a,x);z.xM(x,b);return b};a.g4=function(a,b){b||(b=new Float32Array(16));q.Yq(a,x);z.xM(x,b);return b}};b4w.module.util=function(a,r){var m=r("__compat"),d=r("__obj_util"),b=r("__print"),t=r("__quat"),q=r("__util"),z=r("__vec3"),n=new Float32Array(6);a.li=new Float32Array([1,0,0]);a.mi=new Float32Array([0,1,0]);a.$c=new Float32Array([0,0,1]);a.Dx=new Float32Array([-1,0,0]);a.Wk=new Float32Array([0,-1,0]);a.Zc=new Float32Array([0,0,-1]);a.SE=q.SE;a.ZE=q.ZE;a.$E=q.$E;a.UE=q.UE;a.WE=q.WE;a.bF=q.bF;a.TE=q.TE;a.YE=q.YE;a.Ry=q.Ry;a.VE=q.VE;a.XE=q.XE;a.aF=q.aF;a.yf=function(a){return q.yf(a||0)};a.assert=
q.assert;a.uJ=q.uJ;a.Cd=q.Cd;a.xB=function(a){return q.xB(a)};a.Oj=function(a,b){b||(b=new Float32Array(4));return q.Oj(a,b)};a.TB=function(a,b,d){d||(d=t.create());return q.TB(a,b,d)};a.yK=function(a,b,d){d||(d=z.create());return q.yK(a,b,d)};a.lw=function(a,b){b||(b=new Float32Array(3));return q.lw(a,b)};a.sign=q.sign;a.V=q.V;a.kc=q.kc;a.e5=function(a,b){return q.kC(a,q.Zc,q.$c,q.mi,b)};a.sz=function(a,b){return q.sz(a,b)};a.kC=function(a,d,k,f,m){return 0!=z.dot(k,f)?(b.error("Wrong in-plane direction"),
null):q.kC(a,d,k,f,m)};a.UI=q.UI;a.vc=q.vc;a.Qw=q.Qw;a.bk=q.bk;a.Kz=q.Kz;a.xK=q.xK;a.AK=q.AK;a.XI=q.XI;a.rB=function(a,d,k,f,m){b.Rb("util.line_plane_intersect","math.line_plane_intersect");n[0]=k[0];n[1]=k[1];n[2]=k[2];n[3]=f[0];n[4]=f[1];n[5]=f[2];return q.rB(a,d,n,m)};a.Yd=function(a){b.Rb("util.is_mesh","objects.is_mesh");return d.Yd(a)};a.Zl=function(a){b.Rb("util.is_armature","objects.is_armature");return d.Zl(a)};a.si=q.si;a.Bg=q.Bg;a.Am=q.Am;a.lerp=q.lerp;a.Kb=q.Kb;a.df=q.df;a.hA=q.hA;a.ir=
m.ir;a.Rq=q.Rq};b4w.module.preloader=function(a,r){var m=r("container"),d,b,t,q,z,n,x,h,k=null;a.kS=function(){var a="#000",h="#5276cf",g="#fff",k="#fff",n;for(n in void 0)switch(n){case "container_color":a=(void 0).container_color;break;case "bar_color":h=(void 0).bar_color;break;case "frame_color":g=(void 0).frame_color;break;case "font_color":k=(void 0).font_color}n=document.createElement("div");var r=n.cloneNode(),x=n.cloneNode(),z=n.cloneNode(),P=m.We();x.appendChild(r);x.appendChild(z);n.appendChild(x);P.appendChild(n);
n.style.cssText="background-color: "+a+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";x.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+g+";";r.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+h+";height: 100%;";z.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
k+";";d=r;b=z;t=n;q="DEFAULT"};a.z2=function(a){var h=null,g=null,m="#bf9221",n="#000",r;for(r in a)switch(r){case "canvas_container_id":h=a.canvas_container_id;break;case "background_container_id":g=a.background_container_id;break;case "bg_color":n=a.bg_color;break;case "bar_color":m=a.bar_color}a=document.createElement("div");r=document.createElement("div");a.id="simple_preloader_container";var x=document.createElement("div"),D=document.createElement("div"),g=document.getElementById(g);k=document.getElementById(h);
a.style.cssText="z-index: 4;background-color: "+n+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";x.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+m+";border-radius: 0px;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
r.appendChild(x);r.appendChild(D);a.appendChild(r);document.body.appendChild(a);q="SIMPLE";t=a;d=x;b=D;z=g};a.x2=function(a){var d=null,g=null,h="rgba(0,0,0,0)",m="",r="",x="rgba(0,0,0,0)",D;for(D in a)switch(D){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":g=a.background_container_id;break;case "frame_bg_color":h=a.frame_bg_color;break;case "bg_color":x=a.bg_color;break;case "frame_class":m=a.frame_class;break;case "anim_elem_class":r=a.anim_elem_class}a=
document.createElement("div");D=document.createElement("div");var P=document.createElement("div"),K=document.createElement("div"),g=document.getElementById(g);k=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+x+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+h+";";P.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";
K.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";P.className=r;D.appendChild(P);D.className=m;D.appendChild(K);a.appendChild(D);k.appendChild(a);q="ROTATION";t=a;n=P;b=K;z=g};a.u2=function(a){var m=a.preloader_width,m=m/(m-a.img_width),g=document.getElementById(a.preloader_bar_id),n=document.getElementById(a.fill_band_id),r=document.getElementById(a.preloader_caption_id),H=document.getElementById(a.preloader_container_id),
O=document.getElementById(a.background_container_id);k=document.getElementById(a.canvas_container_id);q="ADVANCED";d=g;x=n;h=m;b=r;t=H;z=O};a.JZ=function(a){b.innerHTML=a+"%";"SIMPLE"==q?d.style.width=a+"%":"ADVANCED"==q?(d.style.width=a/h+"%",x.style.width=100-a+"%"):"ROTATION"==q?n.style.transform="rotate("+a+"deg)":"DEFAULT"==q&&(d.style.width=a+"%");100==a&&(t.parentNode.removeChild(t),z&&z.parentNode.removeChild(z))}};"object"==typeof module&&module.qA&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,r){r("__print");var m=r("__version");a.version=m.version;a.ND=m.ND;a.type=m.type;a.dH=m.dH;a.cA=m.cA};"object"==typeof module&&module.qA&&b4w.module.version(exports);b4w.register("project_ow_app",function(a,r){function m(a,f){f?(n.kS(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},z.load(h+"project_ow.json",b,d)):console.log("b4w init failure")}function d(a){n.JZ(a)}function b(a,b){b?t.sT():console.log("b4w load failure")}var t=r("app"),q=r("config"),z=r("data"),n=r("preloader"),x="DEBUG"==r("version").type(),h=q.Bu("project_ow");a.Tg=function(){t.Tg({canvas_container_id:"main_canvas_container",callback:m,show_fps:x,console_verbose:x,
autoresize:!0})}});b4w.require("project_ow_app").Tg();
