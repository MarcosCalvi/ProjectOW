var b4w="object"===typeof b4w?b4w:function(a){var g={};a.module=g;var q={};a.ua=function(a,b){var w=g[a];w&&(w.In=null);q[b||"__b4w_default"]=null};a.register=function(a,b){g[a]||(g[a]=b)};a.require=function(a,b){if(!g[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";q[b]||(q[b]=function(a){return function(b){var c=g[b];if(!c)throw Error('Module "'+b+'" not found');c.In||(c.In={});c.In[a]||(c.In[a]={},c(c.In[a],q[a]));return c.In[a]}}(b));return q[b](a)};a.module_check=function(a){return g[a]?
!0:!1};a.get_namespace=function(a){for(var b in q)if(q[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.particles=function(a,g){var q=g("__particles"),c=g("__print");a.hM=function(a,w,t){q.Fo(a)?q.hM(a,w,t):c.error('"',a.name,'" has no particle systems')};a.dM=function(a,w,t){q.Fo(a)?q.dM(a,w,t):c.error('"',a.name,'" has no particle systems')};a.UL=function(a,w,t){q.Fo(a)?(t=Math.min(t,1),t=Math.max(t,0),q.UL(a,w,t)):c.error('"',a.name,'" has no particle systems')}};b4w.module.__particles=function(a,g){function q(){m.q("_rand() undefined")}function c(a,b,c,f,q,m){var h=a.$u,k=a.Zg,l=a.time;a=a.hL;for(var n=0;n<h.length;n+=4){var d=h[n];if(l>a&&l>=d&&d>a||l<a&&(d>a||l>=d))for(d=0;8>d;d++)k[8*n+d]=f[d],z[d]=f[d];else for(d=0;8>d;d++)z[d]=k[8*n+d];d=M;d[0]=b[3*n];d[1]=b[3*n+1];d[2]=b[3*n+2];p.Wc(d,z,d);q[3*n]=d[0];q[3*n+1]=d[1];q[3*n+2]=d[2];var B=e;B[0]=c[4*n];B[1]=c[4*n+1];B[2]=c[4*n+2];B[3]=c[4*n+3];p.u_(B,z,B);m[4*n]=B[0];m[4*n+1]=B[1];m[4*n+2]=B[2];m[4*n+3]=
B[3];for(d=1;4>d;d++)q[3*(n+d)]=q[3*n],q[3*(n+d)+1]=q[3*n+1],q[3*(n+d)+2]=q[3*n+2],m[4*(n+d)]=B[0],m[4*(n+d)+1]=B[1],m[4*(n+d)+2]=B[2],m[4*(n+d)+3]=B[3]}}function b(a){a?(m.VZ(a),q=function(){return m.hY()}):q=function(){return Math.random()}}var w=g("__config"),t=g("__batch"),D=g("__geometry"),l=g("__textures"),r=g("__time"),p=g("__tsr"),m=g("__util"),f=g("__vec3"),n=w.B,e=new Float32Array(4),z=new Float32Array(8),M=new Float32Array(3),E=[];a.update=function(){for(var a=0;a<E.length;a++)for(var b=
E[a],e=b.I,f=0;f<e.length;f++)for(var q=b,m=e[f].X,h=0;h<m.length;h++){var k=m[h],n=k.gb;n&&n.Yx&&!k.kg&&(c(n,n.positions,n.hN,q.k.n,n.bD,n.jE),n.IK=!0)}};a.Fo=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].X,e=0;e<c.length;e++)if(c[e].gb)return!0;return!1};a.QK=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].X,e=0;e<c.length;e++){var f=c[e].gb;if(f&&"EMITTER"==f.Nw)return!0}return!1};a.GR=function(a){return 0<a.particle_systems.length};a.FR=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.YV=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.lW=function(a,b,c){var e=a.gb={name:b.name,Nw:b.settings.type,time:0,hL:-1,Yx:!1,va:0,$a:0,nN:0,lC:0,rK:0,Ce:0,ei:0,LC:0,HJ:0,gm:0,If:0,fO:0,size:0,eG:0,dG:0,tH:0,sH:new Float32Array(16),IK:!1,positions:null,bD:null,hN:null,jE:null,$u:null,$A:null,Zg:null,VK:null,lN:0,mN:0};e.va=b.settings.frame_start;
e.$a=b.settings.frame_end;e.nN=(e.$a-e.va)/r.qd();e.lC=b.settings.lifetime;e.rK=e.lC/r.qd();e.Ce=b.settings.b4w_cyclic?1:0;e.ei=b.settings.mass;e.LC=b.settings.normal_factor;e.HJ=9.81*b.settings.effector_weights.gravity;e.gm=b.settings.b4w_fade_in/r.qd();e.If=b.settings.b4w_fade_out/r.qd();e.fO=b.settings.effector_weights.wind;e.Yx="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,q,h;a.Rr?(f=c.halo.size,q=c.halo.hardness,30>q?(q=.5,h=.9):40>q?(q=.1,h=1):50>q?(q=0,h=.8):(q=0,h=.5)):(f=b.settings.particle_size,
h=q=1);e.size=f;e.eG=q;e.dG=h;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(t.nf(a,"NODES",1),t.nf(a,"PARTICLE_BATCH",1),a.nk=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&n.nu&&(b=b[0].texture,f=[],l.MR(b.color_ramp,l.zF,f),f=new Uint8Array(f.map(function(a){return m.V(255*a,0,255)})),f=l.AH(f,l.zF),t.Qj(a,f,"u_color_ramp_tex",b.name),t.nf(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)q=c[f/4],a[f]=q.position,a[f+1]=q.color[0],a[f+2]=q.color[1],a[f+3]=q.color[2];e.tH=c.length}e.sH.set(a)};a.bV=function(a,e,n,l){var p=a.gb,t=l.n;l=n.settings.count;var h=n.settings.frame_start/r.qd(),k=n.settings.frame_end/r.qd(),J=n.settings.lifetime/r.qd(),y=n.settings.lifetime_random,d=n.settings.emit_from,
B=n.settings.factor_random;if(n.settings.use_rotations)var u=n.settings.angular_velocity_mode,z=n.settings.angular_velocity_factor;else u="NONE",z=0;var K=n.settings.b4w_randomize_emission,G=n.settings.b4w_cyclic;p.lN=n.settings.billboard_tilt;p.mN=n.settings.billboard_tilt_random;b(n.seed);var T;e=D.lI(e,["a_position","a_tbn_quat"],null);switch(d){case "VERT":var P=e.aa[0].a_position;T=e.aa[0].a_tbn_quat;n=P.length/3;e=[];for(d=0;d<l;d++){var w=Math.round((n-1)*q());e.push(w);e.push(w);e.push(w);
e.push(w)}n=[];for(d=0;d<e.length;d++)n.push(P[3*e[d]]),n.push(P[3*e[d]+1]),n.push(P[3*e[d]+2]);P=new Float32Array(n);n=[];for(d=0;d<e.length;d++)n.push(T[4*e[d]]),n.push(T[4*e[d]+1]),n.push(T[4*e[d]+2]),n.push(T[4*e[d]+3]);T=new Float32Array(n);break;case "FACE":P=[];T=[];d=[];m.$v(0,d);n=D.vB(e,l,!1,d);m.$v(0,d);e=D.vB(e,l,!0,d);for(d=0;d<n.length;d++)P.push(n[d][0],n[d][1],n[d][2]),P.push(n[d][0],n[d][1],n[d][2]),P.push(n[d][0],n[d][1],n[d][2]),P.push(n[d][0],n[d][1],n[d][2]),T.push(e[d][0],e[d][1],
e[d][2],e[d][3]),T.push(e[d][0],e[d][1],e[d][2],e[d][3]),T.push(e[d][0],e[d][1],e[d][2],e[d][3]),T.push(e[d][0],e[d][1],e[d][2],e[d][3]);P=new Float32Array(P);T=new Float32Array(T);break;case "VOLUME":m.q("Particle emission from volume is not supported");break;default:m.q("Wrong emit from option")}T=[P,T];P=T[0];T=T[1];p.positions=new Float32Array(P);p.hN=new Float32Array(T);p.bD=new Float32Array(P.length);p.jE=new Float32Array(T.length);e=[];k=(k-h)/l;for(n=0;n<l;n++)d=K?k*n+10*k*(.5-q()):k*n,G||
(d+=h),e.push(d),e.push(d),e.push(d),e.push(d);h=new Float32Array(e);p.$u=new Float32Array(h);p.$A=new Float32Array(h);if(p.Yx){p.Zg=new Float32Array(8*h.length);for(K=0;K<8*h.length;K++)for(G=0;8>G;G++)p.Zg[8*K+G]=t[G];c(p,P,T,t,P,T)}t=D.Nf("EMITTER_PARTICLES");K=m.Ug();K.a_position=P;K.a_tbn_quat=T;t.aa[0]=K;a.Th=D.Et;a=[];for(K=0;K<l;K++)a.push(4*K,4*K+2,4*K+1,4*K,4*K+3,4*K+2);a=new Uint16Array(a);t.ma=a;t.qa.a_p_bb_vertex=D.wI(l);t.Ja=P.length/3;a=[];y*=J;for(K=0;K<l;K++)G=y*q(),a.push(J-G),a.push(J-
G),a.push(J-G),a.push(J-G);J=t.qa;y=[];for(K=0;K<l;K++)G=Math.random(),y.push(a[4*K],h[4*K],G),y.push(a[4*K+1],h[4*K+1],G),y.push(a[4*K+2],h[4*K+2],G),y.push(a[4*K+3],h[4*K+3],G);y=new Float32Array(y);J.a_p_data=y;J=t.qa;y=[];for(a=0;a<l;a++){h=[q()-.5,q()-.5,q()-.5];f.normalize(h,h);y.push(B*h[0]);y.push(B*h[1]);y.push(B*h[2]);switch(u){case "NONE":y.push(0);break;case "SPIN":case "VELOCITY":y.push(z);break;case "RAND":y.push(2*z*(q()-.5));break;default:m.q("Undefined velocity factor")}h=y.slice(-4);
for(K=0;12>K;K++)y.push(h[K%4])}l=new Float32Array(y);J.a_p_vels=l;p.VK=new Float32Array(t.qa.a_p_data);return t};a.nZ=function(a,b,e){a=a.I;for(var c=0;c<a.length;c++)for(var f=a[c].X,n=0;n<f.length;n++){var h=f[n].gb;h&&h.name==b&&!f[n].kg&&(h.hL=h.time,h.time=e)}};a.bY=function(a){for(var b=a.Ja,e=a.aa[0].a_position,c=[],f=[],n=0;n<b;n++)f.push(e[3*n]),c.push(e[3*n+1]),f.push(e[3*n+2]);c=new Float32Array(c);f=new Float32Array(f);a.qa.a_lf_dist=c;a.qa.a_lf_bb_vertex=f;return a};a.hM=function(a,
b,e){a=a.I;for(var c=0;c<a.length;c++)for(var f=a[c].X,n=0;n<f.length;n++){var h=f[n].gb;h&&h.name==b&&(h.size=e)}};a.dM=function(a,b,e){a=a.I;for(var c=0;c<a.length;c++)for(var f=a[c].X,n=0;n<f.length;n++){var h=f[n].gb;h&&h.name==b&&(h.LC=e)}};a.UL=function(a,b,e){a=a.I;for(var c=0;c<a.length;c++)for(var f=a[c].X,n=0;n<f.length;n++){var h=f[n],k=h.gb;if(k&&k.name==b){var q=k.$u;if(1==e)var m=q;else if(0==e)for(var m=k.$A,d=0;d<m.length;d+=4)m[d]=1E4,m[d+1]=m[d],m[d+2]=m[d],m[d+3]=m[d];else for(var B=
4/e,m=k.$A,u=0,d=0;d<m.length;d+=4)d>=u?(m[d]=q[d],u+=B):m[d]=1E4,m[d+1]=m[d],m[d+2]=m[d],m[d+3]=m[d];h=h.Ca;if(h.jd.a_p_data){k=k.VK;for(d=0;d<k.length;d+=3)k[d+1]=m[Math.round(d/3)];D.L_(h,k)}}}};a.f0=function(a,b,e){a=a.I;for(var c=0;c<a.length;c++)for(var f=a[c].X,n=0;n<f.length;n++){var h=f[n].gb;if(h&&h.Yx)for(var k=0;k<8*h.$u.length;k++)h.Zg[8*k]=b[0],h.Zg[8*k+1]=b[1],h.Zg[8*k+2]=b[2],h.Zg[8*k+3]=b[3],h.Zg[8*k+4]=e[0],h.Zg[8*k+5]=e[1],h.Zg[8*k+6]=e[2],h.Zg[8*k+7]=e[3]}};a.Z_=function(a,b,e){for(var c=
[],f=0;f<e;f++)c.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.qa.a_tbn_quat=new Float32Array(c);if(b.ws){c=[];for(f=0;f<e;f++)c.push(f,f,f,f);a.qa[b.ws.name]=new Float32Array(c)}};a.Y_=function(a){-1==E.indexOf(a)&&E.push(a)};a.mY=function(a){a=E.indexOf(a);-1!=a&&E.splice(a,1)};a.ua=function(){E.length=0}};b4w.module.__config=function(a,g){function q(){return b4w.module_check(a.Ie.Bu)}function c(){for(var c=a.Ie,q=null,l=document.getElementsByTagName("script"),r=0;r<l.length;r++){for(var p=l[r].src,m=0;m<c.hK.length;m++)if(0<=p.indexOf(c.hK[m])){q=p;break}if(null!==q)break}q||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),q=document.location.href);c=q.indexOf("?");0<=c&&(q=q.substring(0,c));return q.substring(0,q.lastIndexOf("/"))}var b=g("__print"),
w=g("__util");a.eq=1;a.wl=2;a.Dn=3;a.AF=4;a.dq=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.yH=w.T(a.context);a.B={alpha_sort:!0,alpha_sort_threshold:.1,Lm:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,qI:1,OU:5,background_color:[0,0,0,0],canvas_resolution_factor:1,rp:3,allow_cors:!1,pI:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,g4:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,eO:!1,yr:!0,Ow:!0,gd:!0,water_dynamic:!0,Xk:!0,zx:!0,JN:!0,precision:"highp",quality:a.wl,nu:!0,EX:!1,OD:!1,cB:!1,YN:!1,is_mobile_device:!1,WB:!1,qA:!1,Q9:!1,Qs:!1,allow_hidpi:!1,zM:!1,BC:!1,enable_selectable:!0,enable_outlining:!0,$i:!0,no:!1,nI:!1,qC:[0,0],ur:!1,nL:!0,Bx:!1,url_params:null,gc:!0,Fc:4,Yq:!1,FL:!1,GL:!1,sD:!1,kH:!1,TJ:!1,media_auto_activation:!0,BK:4,rw:!1,gl_debug:!1,eH:!1,cG:!1,Jz:!1,Zq:"dds",L9:"16x",srgb_type:"SRGB_SIMPLE",Lz:!1};a.ZH=w.T(a.B);
a.Fl={ov:-1,tI:!1,im:1};a.controls={zX:1/120};a.Rd={path:"",OX:"B4W_ASSETS_PATH=__JS__/../../../deploy/assets\/",fY:"B4W_PROJ_ASSETS_PATH=__JS__/../assets\/",rX:15,prevent_caching:!0,AC:!1,YA:!1,Yw:!1};a.qG=w.T(a.Rd);a.Ie={shaders_path:"",zZ:"../shaders/",xM:"include/",K9:"postprocessing/",Bu:"built_in_data",hK:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js project_ow.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.bW={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{aj:.064,Rj:.035,Qk:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],wn:.11,ok:.062,Sj:.004}};a.C={enabled:!0,max_fps:60,jt:"",j0:"B4W_URANIUM_PATH=uranium.js",eA:!1,ping:!1,st:!0};a.$K=w.T(a.C);a.Vo={Qr:1024,Uu:256,QH:32,RT:128,QT:256,bL:.25,WX:.5,VX:1};a.JL=w.T(a.Vo);a.Y={ME:!0,yw:!1,uG:!1,lH:!1,cI:!1};a.vM=w.T(a.Y);a.Uc={outlining_overview_mode:!1,oj:[1,.4,.05],Fk:.2,Gk:3.8,Hk:1};
a.kr={enabled:!1,d_:0,c_:0,DZ:"COLOR"};a.XH=w.T(a.kr);a.Mi={pX:8,tw:64,xC:8,uw:8,yC:15,CK:0,ms:128,ej:1024,uC:4096,Ec:4096,zC:[4096,4096]};a.xH=w.T(a.Mi);a.Ln=function(){var b=a.B,c=a.C,q=a.Vo;switch(b.quality){case a.Dn:b.shadows=!0;b.Xk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.yr=!0;b.Ow=!0;b.gd=!0;q.Qr=2048;q.Uu=512;b.rp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.zx=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.$i=!0;b.Fc=16;b.srgb_type="SRGB_PROPER";c.max_fps=120;break;case a.wl:b.shadows=!0;b.Xk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.yr=!0;b.Ow=!0;b.gd=!0;q.Qr=1024;q.Uu=256;b.rp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.zx=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.$i=!0;b.srgb_type="SRGB_SIMPLE";
b.Fc=4;c.max_fps=60;break;case a.eq:b.shadows=!1;b.Xk=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.yr=!1;b.Ow=!1;b.gd=!1;q.Qr=512;q.Uu=256;b.rp=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.zx=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.$i=!1;b.srgb_type="SRGB_SIMPLE";b.Fc=1;c.max_fps=60;break;case a.dq:w.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(c,q){switch(c){case "allow_cors":a.B.allow_cors=q;break;case "allow_hidpi":a.B.allow_hidpi=q;break;case "alpha":a.context.alpha=q;break;case "alpha_sort":a.B.alpha_sort=q;break;case "alpha_sort_threshold":a.B.alpha_sort_threshold=q;break;case "anaglyph_use":b.rU();a.B.stereo=q?"ANAGLYPH":a.B.stereo;break;case "animation_framerate":a.Fl.ov=q;break;case "anisotropic_filtering":a.B.anisotropic_filtering=q;break;case "antialiasing":a.B.antialiasing=q;break;case "assets_dir":case "assets_path":a.Rd.path=
q;break;case "assets_dds_available":a.Rd.YA=q;break;case "assets_pvr_available":a.Rd.Yw=q;break;case "assets_min50_available":a.Rd.AC=q;break;case "audio":a.Y.ME=q;break;case "background_color":a.B.background_color=q;break;case "bloom":a.B.bloom=q;break;case "built_in_module_name":a.Ie.Bu=q;break;case "canvas_resolution_factor":a.B.canvas_resolution_factor=q;break;case "console_verbose":a.B.console_verbose=q;break;case "compositing":a.B.compositing=q;break;case "dof":a.B.dof=q;break;case "do_not_load_resources":a.B.do_not_load_resources=
q;break;case "god_rays":a.B.god_rays=q;break;case "stereo":a.B.stereo=q;break;case "max_fps":a.B.max_fps=q;break;case "max_fps_physics":a.C.max_fps=q;break;case "media_auto_activation":a.B.media_auto_activation=q;break;case "motion_blur":a.B.motion_blur=q;break;case "physics_enabled":a.C.enabled=q;break;case "physics_uranium_path":a.C.jt=q;break;case "physics_calc_fps":a.C.eA=q;break;case "physics_use_workers":a.C.st=q;break;case "precision":a.B.precision=q;break;case "prevent_caching":a.Rd.prevent_caching=
q;break;case "quality":a.B.quality=q;break;case "reflections":a.B.reflections=q;break;case "refractions":a.B.refractions=q;break;case "sfx_mix_mode":a.Y.yw=q;break;case "shaders_dir":case "shaders_path":a.Ie.shaders_path=q;break;case "shadows":a.B.shadows=q;break;case "show_hud_debug_info":a.B.show_hud_debug_info=q;break;case "smaa":a.B.smaa=q;break;case "smaa_search_texture_path":a.Ie.smaa_search_texture_path=q;break;case "smaa_area_texture_path":a.Ie.smaa_area_texture_path=q;break;case "ssao":a.B.ssao=
q;break;case "debug_view":a.B.debug_view=q;break;case "enable_selectable":a.B.enable_selectable=q;break;case "enable_outlining":a.B.enable_outlining=q;break;case "outlining_overview_mode":a.Uc.outlining_overview_mode=q;break;case "glow_materials":a.B.$i=q;break;case "url_params":a.B.url_params=q;break;case "use_min50":a.B.use_min50=q;break;case "gl_debug":a.B.gl_debug=q;break;case "srgb_type":a.B.srgb_type=q;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.B.allow_cors;
case "allow_hidpi":return a.B.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.B.alpha_sort;case "alpha_sort_threshold":return a.B.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.B.stereo;case "animation_framerate":return a.Fl.ov;case "anisotropic_filtering":return a.B.anisotropic_filtering;case "antialiasing":return a.B.antialiasing;case "assets_dir":case "assets_path":return a.Rd.path;case "assets_dds_available":return a.Rd.YA;case "assets_pvr_available":return a.Rd.Yw;
case "assets_min50_available":return a.Rd.AC;case "audio":return a.Y.ME;case "background_color":return a.B.background_color;case "bloom":return a.B.bloom;case "built_in_module_name":return a.Ie.Bu;case "canvas_resolution_factor":return a.B.canvas_resolution_factor;case "console_verbose":return a.B.console_verbose;case "compositing":return a.B.compositing;case "dof":return a.B.dof;case "do_not_load_resources":return a.B.do_not_load_resources;case "is_mobile_device":return a.B.is_mobile_device;case "god_rays":return a.B.god_rays;
case "stereo":return a.B.stereo;case "max_fps":return a.B.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.B.media_auto_activation;case "motion_blur":return a.B.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.jt;case "physics_calc_fps":return a.C.eA;case "physics_use_workers":return a.C.st;case "precision":return a.B.precision;case "prevent_caching":return a.Rd.prevent_caching;case "quality":return a.B.quality;case "reflections":return a.B.reflections;
case "refractions":return a.B.refractions;case "sfx_mix_mode":return a.Y.yw;case "shaders_dir":case "shaders_path":return a.Ie.shaders_path;case "shadows":return a.B.shadows;case "show_hud_debug_info":return a.B.show_hud_debug_info;case "smaa":return a.B.smaa;case "smaa_search_texture_path":return a.Ie.smaa_search_texture_path;case "smaa_area_texture_path":return a.Ie.smaa_area_texture_path;case "ssao":return a.B.ssao;case "debug_view":return a.B.debug_view;case "enable_selectable":return a.B.enable_selectable;
case "enable_outlining":return a.B.enable_outlining;case "outlining_overview_mode":return a.Uc.outlining_overview_mode;case "glow_materials":return a.B.$i;case "url_params":return a.B.url_params;case "use_min50":return a.B.use_min50;case "gl_debug":return a.B.gl_debug;case "srgb_type":return a.B.srgb_type;default:b.error("Unknown config property: "+c)}};a.reset=function(){for(var b in a.yH)a.context[b]=a.yH[b];for(b in a.ZH)a.B[b]=a.ZH[b];for(b in a.qG)a.Rd[b]=a.qG[b];for(b in a.$K)a.C[b]=a.$K[b];
for(b in a.JL)a.Vo[b]=a.JL[b];for(b in a.vM)a.Y[b]=a.vM[b];for(b in a.XH)a.kr[b]=a.XH[b]};a.qD=function(){for(var b in a.xH)a.Mi[b]=a.xH[b]};a.YJ=q;a.hZ=function(){var b=a.Ie,w=a.C;q()||""!=b.shaders_path||(b.shaders_path=c()+"/"+b.zZ);w.enabled&&""==w.jt&&(w.jt=c()+"/"+w.j0.replace("B4W_URANIUM_PATH=",""))};a.tv=function(b){var q=a.Rd;if(q.path)return q.path;var l=q.OX,r="B4W_ASSETS_PATH=";b&&(l=q.fY,r="B4W_PROJ_ASSETS_PATH=",l=l.replace("__NAME__",b));l=l.replace(r,"");return l=l.replace("__JS__",
c())}};b4w.module.__print=function(a){function g(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var q=1;q<a.length;q++)c.push(a[q]);return c}function q(){t++;var a=g(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in l||(l[a]=a,q([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var w=!1,t=0,D=0,l={};a.qZ=function(a){w=a};a.ce=function(){console.log.apply(console,arguments)};a.log=function(){if(w){var a=g(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=q;a.P=c;a.Sb=b;a.Vh=function(a,q){switch(1<q.length){case !0:c(a+"() is deprecated, use "+q.slice(0,-1).join("(), ")+"() or "+q[q.length-1]+"() instead.");break;case !1:b(a,q[0])}};a.rU=function(){c('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){D++;var a=g(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=g(arguments,"B4W INFO");console.info.apply(console,a)};a.uU=function(){t++;
var a=g(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.vU=function(){D++;var a=g(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){w&&console.time.apply(console,arguments)};a.timeEnd=function(){w&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.SV=function(){return D};a.tV=function(){return t};a.pH=function(){t=D=0}};b4w.module.print=b4w.module.__print;b4w.module.__util=function(a,g){function q(a){return 0<a?1:0>a?-1:0}function c(a,b,d){var e=a[0],c=a[1];a=a[2];var R=Math.cos(e/2),aa=Math.cos(c/2),ja=Math.cos(a/2),h=Math.sin(e/2),c=Math.sin(c/2),v=Math.sin(a/2);if(-1<T.indexOf(b))var u=Math.cos((e+a)/2),L=Math.sin((e+a)/2),q=Math.cos((e-a)/2),k=Math.sin((e-a)/2),x=Math.cos((a-e)/2),f=Math.sin((a-e)/2);switch(b){case xa:d[0]=aa*L;d[1]=c*q;d[2]=c*k;d[3]=aa*u;break;case ia:d[0]=c*k;d[1]=aa*L;d[2]=c*q;d[3]=aa*u;break;case va:d[0]=c*q;d[1]=c*k;d[2]=
aa*L;d[3]=aa*u;break;case 3:d[0]=aa*L;d[1]=c*f;d[2]=c*x;d[3]=aa*u;break;case na:d[0]=c*x;d[1]=aa*L;d[2]=c*f;d[3]=aa*u;break;case Oa:d[0]=c*f;d[1]=c*x;d[2]=aa*L;d[3]=aa*u;break;case 6:d[0]=h*aa*ja+R*c*v;d[1]=R*c*ja-h*aa*v;d[2]=R*aa*v+h*c*ja;d[3]=R*aa*ja-h*c*v;break;case 7:d[0]=R*aa*v+h*c*ja;d[1]=h*aa*ja+R*c*v;d[2]=R*c*ja-h*aa*v;d[3]=R*aa*ja-h*c*v;break;case 8:d[0]=R*c*ja-h*aa*v;d[1]=R*aa*v+h*c*ja;d[2]=h*aa*ja+R*c*v;d[3]=R*aa*ja-h*c*v;break;case 9:d[0]=h*aa*ja-R*c*v;d[1]=R*aa*v-h*c*ja;d[2]=R*c*ja+h*
aa*v;d[3]=R*aa*ja+h*c*v;break;case 10:d[0]=R*c*ja+h*aa*v;d[1]=h*aa*ja-R*c*v;d[2]=R*aa*v-h*c*ja;d[3]=R*aa*ja+h*c*v;break;case 11:d[0]=R*aa*v-h*c*ja,d[1]=R*c*ja+h*aa*v,d[2]=h*aa*ja-R*c*v,d[3]=R*aa*ja+h*c*v}return d}function b(a,b,d){var c=a[0],e=a[1],R=a[2];a=a[3];switch(b){case xa:d[0]=Math.atan2(c*e+R*a,e*a-c*R);d[1]=Math.acos(1-2*(e*e+R*R));d[2]=Math.atan2(c*e-R*a,c*R+e*a);break;case ia:d[0]=Math.atan2(c*a+e*R,R*a-c*e);d[1]=Math.acos(1-2*(c*c+R*R));d[2]=Math.atan2(e*R-c*a,c*e+R*a);break;case va:d[0]=
Math.atan2(c*R+e*a,c*a-e*R);d[1]=Math.acos(1-2*(c*c+e*e));d[2]=Math.atan2(c*R-e*a,c*a+e*R);break;case 3:d[0]=Math.atan2(c*R-e*a,c*e+R*a);d[1]=Math.acos(1-2*(e*e+R*R));d[2]=Math.atan2(c*R+e*a,R*a-c*e);break;case na:d[0]=Math.atan2(c*e-R*a,c*a+e*R);d[1]=Math.acos(1-2*(c*c+R*R));d[2]=Math.atan2(c*e+R*a,c*a-e*R);break;case Oa:d[0]=Math.atan2(e*R-c*a,c*R+e*a);d[1]=Math.acos(1-2*(c*c+e*e));d[2]=Math.atan2(c*a+e*R,e*a-c*R);break;case 6:d[0]=Math.atan2(2*(c*a-e*R),1-2*(c*c+e*e));d[1]=Math.asin(2*(c*R+e*a));
d[2]=Math.atan2(2*(R*a-c*e),1-2*(e*e+R*R));break;case 7:b=c*e+R*a;.499999<b?(d[0]=0,d[1]=Math.PI/2,d[2]=2*Math.atan2(c,a)):-.499999>b?(d[0]=0,d[1]=-Math.PI/2,d[2]=-2*Math.atan2(c,a)):(d[0]=Math.atan2(2*(e*a-c*R),1-2*(e*e+R*R)),d[1]=Math.asin(2*(c*e+R*a)),d[2]=Math.atan2(2*(c*a-e*R),1-2*(c*c+R*R)));break;case 8:d[0]=Math.atan2(2*(R*a-c*e),1-2*(c*c+R*R));d[1]=Math.asin(2*(c*a+e*R));d[2]=Math.atan2(2*(e*a-c*R),1-2*(c*c+e*e));break;case 9:d[0]=Math.atan2(2*(c*a+e*R),1-2*(c*c+R*R));d[1]=Math.asin(2*(R*
a-c*e));d[2]=Math.atan2(2*(c*R+e*a),1-2*(e*e+R*R));break;case 10:d[0]=Math.atan2(2*(c*R+e*a),1-2*(c*c+e*e));d[1]=Math.asin(2*(c*a-e*R));d[2]=Math.atan2(2*(c*e+R*a),1-2*(c*c+R*R));break;case 11:b=e*a-c*R,.499999<b?(d[0]=0,d[1]=Math.PI/2,d[2]=-2*Math.atan2(R,a)):-.499999>b?(d[0]=0,d[1]=-Math.PI/2,d[2]=2*Math.atan2(R,a)):(d[0]=Math.atan2(2*(c*e+R*a),1-2*(e*e+R*R)),d[1]=Math.asin(2*(e*a-c*R)),d[2]=Math.atan2(2*(c*a+e*R),1-2*(c*c+e*e)))}return d}function w(a,b,d){var c=b.length,e=P;e[0]=a[0];e[1]=a[1];
e[2]=a[2];u.normalize(e,e);c?(a=Z,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],b=u.cross(a,e,ka),u.normalize(b,b),u.cross(e,b,a),c=Y,c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=e[0],c[4]=e[1],c[5]=e[2],c[6]=b[0],c[7]=b[1],c[8]=b[2],B.fromMat3(c,d),d[3]=0<d[3]?d[3]+3.1E-5:d[3]-3.1E-5,(0<d[3]&&0>a[3]||0>d[3]&&0<a[3])&&B.scale(d,-1,d),B.normalize(d,d)):B.rotationTo(pa,e,d);return d}function t(a,b){b||(b=new Float32Array(4));h.fromMat4(a,Y);var d=Y[0],c=Y[3],e=Y[6],R=Y[1],aa=Y[4],ja=Y[7],v=Y[2],u=Y[5],L=Y[8],d=Math.sqrt(d*
d+c*c+e*e)||1,R=Math.sqrt(R*R+aa*aa+ja*ja)||1,v=Math.sqrt(v*v+u*u+L*L)||1;Y[0]/=d;Y[3]/=d;Y[6]/=d;Y[1]/=R;Y[4]/=R;Y[7]/=R;Y[2]/=v;Y[5]/=v;Y[8]/=v;B.fromMat3(Y,b);B.normalize(b,b);return b}function D(a){var b=a[0],d=a[1],c=a[2],e=a[3],R=Math.sqrt(b*b+d*d+c*c),R=1/R;a[0]=b*R;a[1]=d*R;a[2]=c*R;a[3]=e*R}function l(a,b){var d=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var c in a)d=l(a[c],d);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(c=
0;c<a.length;c++)d=r(a[c],d);break;case Array:for(c=0;c<a.length;c++)d=l(a[c],d);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:d=r(0,d);break;default:E("Wrong object constructor")}else d=r(0,d);return d;case "number":return r(a,d);case "boolean":return r(a|0,d);case "string":return p(a,d);case "function":case "undefined":return r(0,d)}}function r(a,b){var d=b;S[0]=a;d=(d<<5)-d+ga[0];d&=d;d=(d<<5)-d+ga[1];return d&d}function p(a,
b){for(var d=b,c=0;c<a.length;c++)d=(d<<5)-d+a.charCodeAt(c),d&=d;return d}function m(a){return(34*a+1)*a%289}function f(a){return a-Math.floor(a)}function n(a){return e((34*a+5)*a)}function e(a){return a-289*Math.floor(a/289)}function z(a){return a-7*Math.floor(a/7)}function M(a,b,d){a<b&&(a=b);a>d&&(a=d);return a}function E(a){a&&y.error.apply(y,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function F(a,b,d){a-=b;d-=b;return b+(a-Math.floor(a/d)*d)}function A(a){return F(a,0,2*Math.PI)}function O(a,b){if(a&&b){var d=a instanceof Array;if(d!=b instanceof Array)return!1;var c=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(c!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(d){if(a.length!=b.length)return!1;for(d=0;d<a.length;d++)if(!H(a[d],b[d]))return!1}else if(c){if(a.length!=b.length)return!1;for(d=0;d<a.length;d++)if(a[d]!=b[d])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!H(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function H(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return O(a,b);default:return!0}}function I(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var d=[],c=0;c<a.length;c++){var e=a[c];""!=e&&"."!=e&&(".."!=e||!b&&!d.length||d.length&&".."==d[d.length-1]?
d.push(e):d.length&&d.pop())}a=d.join("/");for(c=0;c<b;c++)a="/"+a;return a||"."}function C(){var a=[{}];a.length=0;return a}var h=g("__mat3"),k=g("__mat4"),J=g("__math"),y=g("__print"),d=g("__tsr"),B=g("__quat"),u=g("__vec3"),ba=g("__vec4"),K=0,G={},T=[xa,ia,va,na,Oa],P=new Float32Array(3),X=new Float32Array(3),x=new Float32Array(3),ka=new Float32Array(3),ca=new Float32Array(3),Q=new Float32Array(3),W=new Float32Array(3),ha=new Float32Array(3),v=new Float32Array(4),Z=new Float32Array(4),Y=new Float32Array(9),
V=new Float32Array(16),ta=new Float32Array(16),oa=B.create(),S=new Float64Array(1),ga=new Uint32Array(S.buffer),za=new Float32Array([0,0,0]),ua=new Float32Array([0,0,0,1]),la=new Float32Array([0,0,0,1,0,0,0,1]),da=new Float32Array([1,1,1]),ya=new Float32Array([1,0,0]),pa=new Float32Array([0,1,0]),N=new Float32Array([0,0,1]),ea=new Float32Array([-1,0,0]),L=new Float32Array([0,-1,0]),Aa=new Float32Array([0,0,-1]),xa=0,ia=1,va=2,na=4,Oa=5,Ca=Math.floor(44488.07041494893),qa=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.IF=za;a.En=ua;a.x2=la;a.Dz=da;a.Gg=ya;a.Eh=pa;a.nc=N;a.wy=ea;a.Re=L;a.Mc=Aa;a.JF=xa;a.QF=ia;a.RF=va;a.LF=3;a.NF=na;a.TF=Oa;a.KF=6;a.PF=7;a.Ez=8;a.MF=9;a.OF=10;a.SF=11;a.AO=qa;a.xy=1;a.fq=2;a.Jj=4;a.ZE=
4;a.bi=function(a){return"undefined"!=typeof a};a.mK=function(a,b,d){for(var c=[],e=d.length,R=0;R<e;R++){var aa=d[R];aa[a]==b&&c.push(aa)}return c};a.Hf=function(a){return new Float32Array(a)};a.MU=function(a,b){var d=a.length,c=new Float32Array(d+b.length);c.set(a);c.set(b,d);return c};a.y_=function(a,b){var d=a.length,c=new Uint32Array(d+b.length);c.set(a);c.set(b,d);return c};a.lS=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.iR=function(a,b){var d=
[],c={},e=b.length,R,aa;for(R=0;R<e;R++)c[b[R]]=!0;e=a.length;for(R=0;R<e;R++)aa=a[R],aa in c&&d.push(aa);return d};a.sign=q;a.I7=function(a,b,d){for(var c=d.length,e=0;e<c;e++)if(d[e][a]==b)return!0;return!1};a.Ed=function(a,b,d){for(var c=0;c<d.length;c++){var e=d[c];if(e[a]===b)return e}return null};a.G7=function(a,b,d,c,e){for(var R=0;R<e.length;R++){var aa=e[R];if(aa[a]==b&&aa[d]==c)return aa}return null};a.FV=function(a,b){for(var d=0;d<a.length;d++)if(a[d].uuid==b)return d;return-1};a.cR=function(a,
b){for(var d=0;d<a.length;d++)if(a[d]==b)return;a.push(b)};a.F3=function(a){for(var b=0;b<a.length-1;b++)for(var d=a[b],c=b+1;c<a.length;c++)if(d==a[c])return!1;return!0};a.p_=function(a,b,d,c){c||(c=new Float32Array(16));k.identity(c);c[12]=a;c[13]=b;c[14]=d};var ma=1;a.hY=function(){ma=(69069*ma+5)%Math.pow(2,32);return Math.round(ma/65536)%32768/32767};a.VZ=function(a){ma=a};a.zg=function(a){var b=a[0]%Ca*48271-3399*Math.floor(a[0]/Ca);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.$v=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.fk=function(a,b){var d=P;d[0]=a[2];d[1]=a[1];d[2]=a[0];c(d,11,b);return b};a.OC=c;a.qL=b;a.sU=function(a){var b=h.create(),d=Math.cos(a[0]),c=Math.cos(a[1]),e=Math.cos(a[2]),R=Math.sin(a[0]),aa=Math.sin(a[1]);a=Math.sin(a[2]);var ja=d*e,v=d*a,u=R*e,L=R*a;b[0]=c*e;b[1]=c*a;b[2]=-aa;b[3]=aa*u-v;b[4]=aa*L+ja;b[5]=c*R;b[6]=aa*ja+L;b[7]=aa*v-u;b[8]=c*d;return b};a.ax=function(a,d){var c=b(a,11,P);d[0]=c[2];d[1]=c[1];d[2]=c[0];return d};a.ec=function(a,b,
d){d||(d=new Float32Array(3));u.transformQuat(b,a,d);return d};a.bB=function(a,b,d){d||(d=new Float32Array(4));a=u.normalize(a,P);var c=u.dot(b,a);a=u.cross(b,a,x);c=Math.acos(c);d[0]=a[0]*Math.sin(c/2);d[1]=a[1]*Math.sin(c/2);d[2]=a[2]*Math.sin(c/2);d[3]=Math.cos(c/2);return d};a.q_=function(a,b,d,c){c||(c=new Float32Array(4));u.transformQuat(d,b,c);c[3]=-u.dot(a,c)};a.bU=function(a){var b=d.R(a.k.n),c=P;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;u.transformQuat(c,b,c);x[0]=0;x[1]=0;x[2]=
-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;u.transformQuat(c,b,c);x[0]=0;x[1]=0;x[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,u.transformQuat(c,b,c),x[0]=0,x[1]=1,x[2]=0}c[1]=0;u.normalize(c,c);a=u.dot(c,x);return Math.acos(a)*(0<-c[0]*x[2]?-1:1)};a.HG=function(a,b,d,c){if(0!=d){c=c||[];for(var e=0;e<a.length;e++)c[e]=(1-d)*a[e]+d*b[e]}};a.z_=function(){K++;return K.toString(10)};a.gt=function(a){G[a]||(G[a]=0);var b=a+G[a];G[a]++;return b};a.Ug=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.Hr=function(a,b,d){b=b||C();var c=b.length,e=a.length/3;d=d||new Float32Array(4*e);for(var R=0;R<e;++R){var aa=P;aa[0]=a[3*R];aa[1]=a[3*R+1];aa[2]=a[3*R+2];var ja;c?(ja=Z,ja[0]=b[4*R],ja[1]=b[4*R+1],ja[2]=b[4*R+2],ja[3]=b[4*R+3]):ja=b;w(aa,ja,d.subarray(4*R,4*(R+1)))}return d};a.wJ=w;a.Ph=function(a){return JSON.parse(JSON.stringify(a))};a.T=function(b){if(!(b instanceof Object))return b;var d;d=b.constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:d=
new d(b);break;case Array:d=new d(b.length);for(var c=0;c<b.length;c++)d[c]=a.T(b[c]);break;default:for(c in d=new d,b)d[c]=a.T(b[c])}return d};a.Rq=function(a){var b=a instanceof Array?[]:{},d;for(d in a)if(a[d]instanceof Object){var c=a[d].constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[d]=new c(a[d]);break;case Array:b[d]=a[d].slice(0);break;default:b[d]=a[d]}}else b[d]=a[d];return b};a.tC=
t;a.AK=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.zK=function(a){v[0]=.577350269189626;v[1]=.577350269189626;v[2]=.577350269189626;v[3]=0;ba.transformMat4(v,a,v);return ba.length(v)};a.co=function(a,b){var d=b.left,c=b.right,e=b.top,R=b.bottom,aa=b.near,ja=b.far;d[0]=a[3]+a[0];d[1]=a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];c[0]=a[3]-a[0];c[1]=a[7]-a[4];c[2]=a[11]-a[8];c[3]=a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];R[0]=a[3]+
a[1];R[1]=a[7]+a[5];R[2]=a[11]+a[9];R[3]=a[15]+a[13];aa[0]=a[3]+a[2];aa[1]=a[7]+a[6];aa[2]=a[11]+a[10];aa[3]=a[15]+a[14];ja[0]=a[3]-a[2];ja[1]=a[7]-a[6];ja[2]=a[11]-a[10];ja[3]=a[15]-a[14];D(d);D(c);D(e);D(R);D(aa);D(ja)};a.QZ=function(a,b,d){return d<-J.yg(a,b.near)||d<-J.yg(a,b.left)||d<-J.yg(a,b.right)||d<-J.yg(a,b.top)||d<-J.yg(a,b.bottom)||d<-J.yg(a,b.far)?!0:!1};a.lU=function(a,b,d,c,e){var R=u.dot(d,b.far),aa=u.dot(c,b.far),ja=u.dot(e,b.far),R=Math.sqrt(R*R+aa*aa+ja*ja);if(R<-J.yg(a,b.near)||
R<-J.yg(a,b.far))return!0;R=u.dot(d,b.left);aa=u.dot(c,b.left);ja=u.dot(e,b.left);if(Math.sqrt(R*R+aa*aa+ja*ja)<-J.yg(a,b.left))return!0;R=u.dot(d,b.right);aa=u.dot(c,b.right);ja=u.dot(e,b.right);if(Math.sqrt(R*R+aa*aa+ja*ja)<-J.yg(a,b.right))return!0;R=u.dot(d,b.top);aa=u.dot(c,b.top);ja=u.dot(e,b.top);if(Math.sqrt(R*R+aa*aa+ja*ja)<-J.yg(a,b.top))return!0;R=u.dot(d,b.bottom);aa=u.dot(c,b.bottom);ja=u.dot(e,b.bottom);return Math.sqrt(R*R+aa*aa+ja*ja)<-J.yg(a,b.bottom)?!0:!1};a.No=function(a,b,d,c){c||
(c=0);for(var e=a.length,R=0;R<e;R+=3){var aa=a[R],ja=a[R+1],h=a[R+2];d[c+R]=b[0]*aa+b[4]*ja+b[8]*h+b[12];d[c+R+1]=b[1]*aa+b[5]*ja+b[9]*h+b[13];d[c+R+2]=b[2]*aa+b[6]*ja+b[10]*h+b[14]}};a.H$=function(a,b,d,c){c||(c=0);for(var e=a.length,R=0;R<e;R+=3){var aa=a[R],ja=a[R+1],h=a[R+2];d[c+R]=b[0]*aa+b[4]*ja+b[8]*h;d[c+R+1]=b[1]*aa+b[5]*ja+b[9]*h;d[c+R+2]=b[2]*aa+b[6]*ja+b[10]*h}return d};a.rL=function(a,b,d,c){c=c||0;for(var e=a.length,R=0;R<e;R+=4){oa[0]=a[R];oa[1]=a[R+1];oa[2]=a[R+2];oa[3]=a[R+3];var aa=
0<oa[3];B.multiply(b,oa,oa);(aa&&0>oa[3]||!aa&&0<oa[3])&&ba.scale(oa,-1,oa);d[c+R]=oa[0];d[c+R+1]=oa[1];d[c+R+2]=oa[2];d[c+R+3]=oa[3]}};a.s0=function(a,b,d){d||(d=new Float32Array(3));v[0]=a[0];v[1]=a[1];v[2]=a[2];v[3]=0;ba.transformMat4(v,b,v);d[0]=v[0];d[1]=v[1];d[2]=v[2]};a.U4=function(a,b){var d=a.length;d||E("flatten(): Wrong or empty array");var c=a[0].length;c||E("flatten(): Wrong or empty subarray");b||(b=new Float32Array(d*c));for(var e=0;e<d;e++)for(var R=0;R<c;R++)b[e*c+R]=a[e][R];return b};
a.t0=function(a){for(var b=[],d=0;d<a.length;d+=3){var c=new Float32Array([a[d],a[d+1],a[d+2]]);b[d/3]=c}return b};a.xu=function(b,d,c,e){if(e<c)return c;var h=c+Math.floor((e-c)/2);return b[h]>d?a.xu(b,d,c,h-1):b[h]<d?a.xu(b,d,h+1,e):h};a.Wj=function(a,b){for(var d=0;d<a.length;d++)if(a[d]!=b[d])return!1;return!0};a.P3=function(a,b,d){for(var c=0;c<a.length;c++)if(Math.abs(a[c]-b[c])>d)return!1;return!0};a.N8=function(a,b,d){d||(d=new Float32Array(16));for(var c=0;12>c;c++)d[c]=a[c]*b;d[12]=a[12];
d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.t_=function(a,b,d,c,e){e||(e=new Float32Array(16));b=k.fromRotationTranslation(d,c,V);k.multiply(b,a,e);return e};a.Wc=function(a,b,d,c,e){e||(e=new Float32Array(3));d=k.fromRotationTranslation(d,c,V);1!==b&&(c=k.identity(ta),b=u.set(b,b,b,P),k.scale(c,b,c),k.multiply(d,c,d));u.transformMat4(a,d,e);return e};a.r$=function(a,b,d,c,e){e||(e=new Float32Array(4));b=k.fromRotationTranslation(d,c,V);ba.transformMat4(a,b,e);return e};a.v7=function(a,b,d,c,
e){e||(e=new Float32Array(3));b=k.fromRotationTranslation(d,c,V);k.invert(b,b);u.transformMat4(a,b,e);return e};a.p$=function(a,b,d){d||(d=new Float32Array(16));k.fromRotationTranslation(b,a,d);a=a[3];for(b=0;12>b;b++)d[b]*=a;return d};a.U7=function(b,d,c){a.AK(b,d);d[3]=a.zK(b);t(b,c)};a.a3=function(a){for(var b=[],d=0;d<a.length;d++)b.push(a[d]);return JSON.stringify(b)};a.DY=function(a,b,d,c){c||(c=new Float32Array(3));var e=P;u.subtract(b,a,e);u.transformQuat(e,d,e);u.subtract(b,e,c)};a.aV=function(){var a=
P;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),d=new Float32Array(16),c=new Float32Array(16),e=new Float32Array(16),R=new Float32Array(16),aa=new Float32Array(16);k.lookAt(a,[-1,0,0],[0,-1,0],b);k.scale(b,[-1,1,1],b);k.scale(b,[-1,1,-1],d);k.lookAt(a,[0,-1,0],[0,0,-1],c);k.scale(c,[1,1,-1],c);k.scale(c,[1,-1,-1],e);k.lookAt(a,[0,0,-1],[0,-1,0],R);k.scale(R,[-1,1,1],R);k.scale(R,[-1,1,-1],aa);return[b,d,c,e,R,aa]};a.eV=function(){var a=P;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),d=new Float32Array(16),
c=new Float32Array(16),e=new Float32Array(16),R=new Float32Array(16),aa=new Float32Array(16);k.lookAt(a,[1,0,0],[0,-1,0],b);k.scale(b,[-1,1,-1],d);k.lookAt(a,[0,1,0],[0,0,1],c);k.scale(c,[1,-1,-1],e);k.lookAt(a,[0,0,1],[0,-1,0],R);k.scale(R,[-1,1,-1],aa);return[b,d,c,e,R,aa]};a.TR=function(a){return l(a,0)};a.MJ=l;a.i7=p;a.mX=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.pL=
function(a,b){b||(b=a);var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<d?(b[3]=2*Math.acos(a[3]),d=1/Math.sqrt(d),b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Cb=function(a){return a*Math.PI/180};a.re=function(a){return 180*a/Math.PI};a.VD=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],d=Math.floor(a[0]+b),c=Math.floor(a[1]+b),e=.211324865405187*d+.211324865405187*c,b=a[0]-d+e;a=a[1]-c+e;var R=
b>a?1:0,aa=1-R,e=b+.211324865405187-R,ja=a+.211324865405187-aa,h=b+-.577350269189626,v=a+-.577350269189626,d=d%289,c=c%289,u=m(m(c)+d),aa=m(m(c+aa)+d+R),L=m(m(c+1)+d+1),d=Math.max(.5-(b*b+a*a),0),c=Math.max(.5-(e*e+ja*ja),0),R=Math.max(.5-(h*h+v*v),0),q=2*f(.024390243902439*u)-1,k=2*f(.024390243902439*aa)-1,x=2*f(.024390243902439*L)-1,u=Math.abs(q)-.5,aa=Math.abs(k)-.5,L=Math.abs(x)-.5,q=q-Math.floor(q+.5),k=k-Math.floor(k+.5),x=x-Math.floor(x+.5),d=d*d*d*d*(1.79284291400159-.85373472095314*(q*q+
u*u)),c=c*c*c*c*(1.79284291400159-.85373472095314*(k*k+aa*aa)),R=R*R*R*R*(1.79284291400159-.85373472095314*(x*x+L*L));return 130*(d*(q*b+u*a)+c*(k*e+aa*ja)+R*(x*h+L*v))};a.XG=function(a){var b=1/7,d=b/2,c=e(Math.floor(a[0])),h=e(Math.floor(a[1])),R=f(a[0]);a=f(a[1]);var aa=R-.5,ja=R-1.5,R=a-.5;a-=1.5;var v=n(c),u=n(c+1),L=v,c=u,v=n(v+h),u=n(u+h),L=n(L+h+1),c=n(c+h+1),h=aa+.7*(z(v)*b+d),q=ja+.7*(z(u)*b+d),aa=aa+.7*(z(L)*b+d),ja=ja+.7*(z(c)*b+d),v=R+.7*(z(Math.floor(v*b))*b+d),R=R+.7*(z(Math.floor(u*
b))*b+d),L=a+.7*(z(Math.floor(L*b))*b+d),b=a+.7*(z(Math.floor(c*b))*b+d);return Math.min(h*h+v*v,q*q+R*R,aa*aa+L*L,ja*ja+b*b)};a.$w=function(a,b,d,c,e){e||(e=new Float32Array(4));a=u.transformQuat(b,a,P);b=d[0];var R=d[1];d=d[2];var aa=Y;aa[0]=R*R+d*d;aa[1]=-R*b;aa[2]=-d*b;aa[3]=-b*R;aa[4]=b*b+d*d;aa[5]=-d*R;aa[6]=-b*d;aa[7]=-R*d;aa[8]=b*b+R*R;u.transformMat3(a,aa,a);u.normalize(a,a);B.rotationTo(c,a,e);return e};a.jA=function(a,b){b||(b=new Float32Array(4));var d=v,c=Z,d=B.setAxisAngle([0,0,1],Math.PI,
B.create()),c=B.setAxisAngle([1,0,0],Math.PI/2,B.create());B.multiply(d,c,d);B.multiply(a,d,b);return b};a.ua=function(){K=0;G={}};a.V=M;a.Zb=function(a,b,d,c){d=Math.exp(-d/c);return(1-d)*a+d*b};a.Ix=function(a,b,d,c,e){e||(e=new Float32Array(a.length));d=Math.exp(-d/c);for(c=0;c<e.length;c++)e[c]=(1-d)*a[c]+d*b[c];return e};a.JM=function(a,b,d,c,e){e||(e=new Float32Array(a.length));B.slerp(a,b,Math.exp(-d/c),e)};a.bC=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?
!0:!1};a.wk=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.AA=function(a,b){var d=h.fromQuat(a,Y),c=P;c[0]=d[6];c[1]=d[7];c[2]=d[8];c=u.cross(N,c,c);u.normalize(c,c);var e=d[4];!b&&0<e&&(c[0]*=-1,c[1]*=-1,c[2]*=-1);x[0]=d[0];x[1]=d[1];x[2]=d[2];u.normalize(x,x);d=Z;B.rotationTo(x,c,d);B.multiply(d,a,a)};a.JI=function(a,b,d,c){d=d*b-.5;var e=c*b-.5;c=d-Math.floor(d);var R=e-Math.floor(e);d=Math.floor(d);var e=Math.floor(e),
aa=b-1,ja=a[e*b+d],h=a[e*b+Math.min(d+1,aa)],v=a[Math.min(e+1,aa)*b+d];a=a[Math.min(e+1,aa)*b+Math.min(d+1,aa)];return(ja*(1-c)+h*c)*(1-R)+(v*(1-c)+a*c)*R};a.Zm=function(a){for(var b=0,d=0;3>d;d++)0<(a&1<<d)&&b++;return b};a.CL=function(a){for(var b=[0,0,0],d=0;3>d;d++)0<(a&1<<d)&&(b[2-d]=1);return b};a.To=function(a,b){var d=0;(1==b||2==b)&&0<(a&4)&&d++;2==b&&0<(a&2)&&d++;return d};a.uB=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==
a?b:b&3|8).toString(16)})};a.Kr=function(a){var b=0,d;for(d in a)a.hasOwnProperty(d)&&b++;return b};a.Po=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*a.length);return a[b]};a.SB=function(a,b,d){d||(d=new Float32Array(3));d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=0;u.normalize(d,d)};a.r_=function(a,b,d){var c=a[0],e=a[1];a=a[2];var R=b[0],aa=b[1],ja=b[2];b=b[3];var h=aa*a-ja*e,v=ja*c-R*a,u=R*e-aa*c,L=aa*u-ja*v,ja=ja*h-R*u,R=R*v-aa*h;d[0]=c+2*h*b+2*L;d[1]=e+2*v*b+2*ja;d[2]=a+2*u*b+2*
R};a.assert=function(a){a||E("Assertion failed")};a.q=E;a.Ng=F;a.Fi=A;a.CB=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.ZZ=function(a,b){for(var d in a){var c=!0,e=a[d],R=b[d];switch(typeof e){case "number":case "string":case "boolean":c=e==R;break;case "object":c=O(e,R)}if(!c)return!1}return!0};a.fD=function(a,b){var d=a[0],c=a[2],e=a[3];b[0]=a[1];b[1]=c;b[2]=e;b[3]=d};a.xI=function(a){a+=1;132651<a&&y.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var d=Math.floor(a/51);return new Float32Array([b/
51,d/51,a%51/51])};a.nC=function(a,b,d,c){v.set(a);v[3]=b;a=Z;P[0]=d[3];P[1]=d[4];P[2]=d[5];a.set(P);a[3]=0;a=ba.dot(v,a);if(0==a)return null;b=Z;u.copy(d,P);b.set(P);b[3]=1;a=-ba.dot(v,b)/a;c[0]=d[0]+a*d[3];c[1]=d[1]+a*d[4];c[2]=d[2]+a*d[5];return c};a.LV=function(a,b,d,c){var e=b[0]-a[0],R=d[0]-a[0],aa=b[1]-a[1],ja=d[1]-a[1];b=b[2]-a[2];a=d[2]-a[2];c[0]=aa*a-b*ja;c[1]=R*b-e*a;c[2]=e*ja-aa*R;return c};a.T3=function(a,b){for(var d=0;d<a.length;d++)b[d]=a[d];return b};a.xD=function(a,b,d){var c=P,
e=u.dot(a,b);-.9999999>e?(u.cross(ya,a,c),1E-6>u.length(c)&&u.cross(pa,a,c),u.normalize(c,c),B.setAxisAngle(c,Math.PI,d)):(u.cross(a,b,c),d.set(c),d[3]=1+e,B.normalize(d,d));return d};a.Ol=function(a,b,d){if(b==d)return d-a;a=A(a);b=A(b);d=A(d);b=2*Math.PI-b;d=A(d+b);a=A(a+b);return a>d?(d-=a,a=2*Math.PI-a,-d>a?a:d):0};a.fn=function(a,b,d){isFinite(b)&&isFinite(d)&&(a=M(a,b,d));return a*a*(3-2*a)};a.lerp=function(a,b,d){return b+a*(d-b)};a.jR=function(a,b){for(var d=0;d<a.length;d++)for(var c=0;c<
b.length;c++)if(b[c]==a[d])return!0;return!1};a.d4=function(a){for(var b=Array(a),d=0;d<a;d++)b[d]=0;return b};a.XN=function(a,b){for(var d=Math.max(a.length,b.length),c=0;c<d;c++){var e=q((c>=a.length?0:a[c])-(c>=b.length?0:b[c]));if(e)return e}return 0};a.ql=function(a){return a.join(".")};a.UM=function(a){return a.split(".").map(function(a){return a|0})};a.W9=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.K7=function(a,b){b[0]=Math.pow(a[0],1/
2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.nj=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=I(b[1]),b.join("://")):I(a)};a.Mq=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.kU=function(a,b,d,c){c[0]=a[0];c[1]=b[0];c[2]=d[0];c[3]=a[1];c[4]=b[1];c[5]=d[1];c[6]=a[2];c[7]=b[2];c[8]=d[2];return c};a.ak=C;a.xr=function(a){a=Math.round(32767.5*(a+1)-32768);return M(a?a:0,-32768,32767)};a.M9=function(a){return M((a+32768)/32767.5-1,-1,1)};a.x_=function(a){return M(Math.round(255*
a),0,255)};a.u$=function(a){return M(a/255,0,1)};a.eU=function(a,b,d,c){var e=u.subtract(d,b,P),R=u.subtract(c,d,X),aa=u.subtract(b,c,x);b=u.subtract(a,b,ka);d=u.subtract(a,d,ca);a=u.subtract(a,c,Q);c=u.cross(e,R,W);if(0<=u.dot(u.cross(c,e,ha),b)&&0<=u.dot(u.cross(c,R,ha),d)&&0<=u.dot(u.cross(c,aa,ha),a))return aa=u.length(c),R=u.dot(c,b),Math.abs(R/aa);e=u.scale(e,M(u.dot(e,b)/u.length(e),0,1),ha);b=u.length(u.subtract(b,e,ha));R=u.scale(R,M(u.dot(R,d)/u.length(R),0,1),ha);R=u.length(u.subtract(d,
R,ha));aa=u.scale(aa,M(u.dot(aa,a)/u.length(aa),0,1),ha);aa=u.length(u.subtract(a,aa,ha));return Math.min(Math.min(b,R),aa)}};b4w.module.__vec3=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array,q=Math.random;a.create=function(){var a=new g(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new g(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,q){var t=new g(3);t[0]=a;t[1]=b;t[2]=q;return t};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,q,t){t[0]=a;t[1]=b;t[2]=q;return t};a.add=function(a,b,q){q[0]=a[0]+b[0];q[1]=a[1]+b[1];q[2]=a[2]+b[2];
return q};a.subtract=function(a,b,q){q[0]=a[0]-b[0];q[1]=a[1]-b[1];q[2]=a[2]-b[2];return q};a.sub=a.subtract;a.multiply=function(a,b,q){q[0]=a[0]*b[0];q[1]=a[1]*b[1];q[2]=a[2]*b[2];return q};a.mul=a.multiply;a.divide=function(a,b,q){q[0]=a[0]/b[0];q[1]=a[1]/b[1];q[2]=a[2]/b[2];return q};a.div=a.divide;a.min=function(a,b,q){q[0]=Math.min(a[0],b[0]);q[1]=Math.min(a[1],b[1]);q[2]=Math.min(a[2],b[2]);return q};a.max=function(a,b,q){q[0]=Math.max(a[0],b[0]);q[1]=Math.max(a[1],b[1]);q[2]=Math.max(a[2],
b[2]);return q};a.scale=function(a,b,q){q[0]=a[0]*b;q[1]=a[1]*b;q[2]=a[2]*b;return q};a.scaleAndAdd=function(a,b,q,t){t[0]=a[0]+b[0]*q;t[1]=a[1]+b[1]*q;t[2]=a[2]+b[2]*q;return t};a.distance=function(a,b){var q=b[0]-a[0],t=b[1]-a[1],g=b[2]-a[2];return Math.sqrt(q*q+t*t+g*g)};a.dist=a.distance;a.squaredDistance=function(a,b){var q=b[0]-a[0],t=b[1]-a[1],g=b[2]-a[2];return q*q+t*t+g*g};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],q=a[1];a=a[2];return Math.sqrt(b*b+q*q+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],q=a[1];a=a[2];return b*b+q*q+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var q=a[0],t=a[1],g=a[2],q=q*q+t*t+g*g;0<q&&(q=1/Math.sqrt(q),b[0]=a[0]*q,b[1]=a[1]*q,b[2]=a[2]*q);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,q){var t=a[0],g=a[1];a=a[2];var l=b[0],r=b[1];b=b[2];
q[0]=g*b-a*r;q[1]=a*l-t*b;q[2]=t*r-g*l;return q};a.lerp=function(a,b,q,t){var g=a[0],l=a[1];a=a[2];t[0]=g+q*(b[0]-g);t[1]=l+q*(b[1]-l);t[2]=a+q*(b[2]-a);return t};a.j7=function(a,b,q,t,g,l){var r=g*g,p=r*(2*g-3)+1,m=r*(g-2)+g,f=r*(g-1);g=r*(3-2*g);l[0]=a[0]*p+b[0]*m+q[0]*f+t[0]*g;l[1]=a[1]*p+b[1]*m+q[1]*f+t[1]*g;l[2]=a[2]*p+b[2]*m+q[2]*f+t[2]*g;return l};a.DG=function(a,b,q,t,g,l){var r=1-g,p=r*r,m=g*g,f=p*r,p=3*g*p,r=3*m*r;g*=m;l[0]=a[0]*f+b[0]*p+q[0]*r+t[0]*g;l[1]=a[1]*f+b[1]*p+q[1]*r+t[1]*g;l[2]=
a[2]*f+b[2]*p+q[2]*r+t[2]*g;return l};a.random=function(a,b){a=a||1;var w=2*q()*Math.PI,t=2*q()-1,g=Math.sqrt(1-t*t)*a;b[0]=Math.cos(w)*g;b[1]=Math.sin(w)*g;b[2]=t*a;return b};a.transformMat4=function(a,b,q){var t=a[0],g=a[1];a=a[2];var l=b[3]*t+b[7]*g+b[11]*a+b[15],l=l||1;q[0]=(b[0]*t+b[4]*g+b[8]*a+b[12])/l;q[1]=(b[1]*t+b[5]*g+b[9]*a+b[13])/l;q[2]=(b[2]*t+b[6]*g+b[10]*a+b[14])/l;return q};a.transformMat3=function(a,b,q){var t=a[0],g=a[1];a=a[2];q[0]=t*b[0]+g*b[3]+a*b[6];q[1]=t*b[1]+g*b[4]+a*b[7];
q[2]=t*b[2]+g*b[5]+a*b[8];return q};a.transformQuat=function(a,b,q){var t=a[0],g=a[1],l=a[2];a=b[0];var r=b[1],p=b[2];b=b[3];var m=b*t+r*l-p*g,f=b*g+p*t-a*l,n=b*l+a*g-r*t,t=-a*t-r*g-p*l;q[0]=m*b+t*-a+f*-p-n*-r;q[1]=f*b+t*-r+n*-a-m*-p;q[2]=n*b+t*-p+m*-r-f*-a;return q};a.rotateX=function(a,b,q,t){var g=[],l=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];l[0]=g[0];l[1]=g[1]*Math.cos(q)-g[2]*Math.sin(q);l[2]=g[1]*Math.sin(q)+g[2]*Math.cos(q);t[0]=l[0]+b[0];t[1]=l[1]+b[1];t[2]=l[2]+b[2];return t};a.rotateY=
function(a,b,q,t){var g=[],l=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];l[0]=g[2]*Math.sin(q)+g[0]*Math.cos(q);l[1]=g[1];l[2]=g[2]*Math.cos(q)-g[0]*Math.sin(q);t[0]=l[0]+b[0];t[1]=l[1]+b[1];t[2]=l[2]+b[2];return t};a.rotateZ=function(a,b,q,t){var g=[],l=[];g[0]=a[0]-b[0];g[1]=a[1]-b[1];g[2]=a[2]-b[2];l[0]=g[0]*Math.cos(q)-g[1]*Math.sin(q);l[1]=g[0]*Math.sin(q)+g[1]*Math.cos(q);l[2]=g[2];t[0]=l[0]+b[0];t[1]=l[1]+b[1];t[2]=l[2]+b[2];return t};a.forEach=function(){var c=a.create();return function(a,
q,t,g,l,r){q||(q=3);t||(t=0);for(g=g?Math.min(g*q+t,a.length):a.length;t<g;t+=q)c[0]=a[t],c[1]=a[t+1],c[2]=a[t+2],l(c,r,c),a[t]=c[0],a[t+1]=c[1],a[t+2]=c[2];return a}}();a.G2=function(c,b){var q=a.fromValues(c[0],c[1],c[2]),t=a.fromValues(b[0],b[1],b[2]);a.normalize(q,q);a.normalize(t,t);q=a.dot(q,t);return 1<q?0:Math.acos(q)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array,q=Math.random;a.create=function(){var a=new g(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new g(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,q,t){var D=new g(4);D[0]=a;D[1]=b;D[2]=q;D[3]=t;return D};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,q,t,g){g[0]=a;g[1]=b;g[2]=q;g[3]=t;return g};a.add=function(a,b,q){q[0]=
a[0]+b[0];q[1]=a[1]+b[1];q[2]=a[2]+b[2];q[3]=a[3]+b[3];return q};a.subtract=function(a,b,q){q[0]=a[0]-b[0];q[1]=a[1]-b[1];q[2]=a[2]-b[2];q[3]=a[3]-b[3];return q};a.sub=a.subtract;a.multiply=function(a,b,q){q[0]=a[0]*b[0];q[1]=a[1]*b[1];q[2]=a[2]*b[2];q[3]=a[3]*b[3];return q};a.mul=a.multiply;a.divide=function(a,b,q){q[0]=a[0]/b[0];q[1]=a[1]/b[1];q[2]=a[2]/b[2];q[3]=a[3]/b[3];return q};a.div=a.divide;a.min=function(a,b,q){q[0]=Math.min(a[0],b[0]);q[1]=Math.min(a[1],b[1]);q[2]=Math.min(a[2],b[2]);q[3]=
Math.min(a[3],b[3]);return q};a.max=function(a,b,q){q[0]=Math.max(a[0],b[0]);q[1]=Math.max(a[1],b[1]);q[2]=Math.max(a[2],b[2]);q[3]=Math.max(a[3],b[3]);return q};a.scale=function(a,b,q){q[0]=a[0]*b;q[1]=a[1]*b;q[2]=a[2]*b;q[3]=a[3]*b;return q};a.scaleAndAdd=function(a,b,q,t){t[0]=a[0]+b[0]*q;t[1]=a[1]+b[1]*q;t[2]=a[2]+b[2]*q;t[3]=a[3]+b[3]*q;return t};a.distance=function(a,b){var q=b[0]-a[0],t=b[1]-a[1],g=b[2]-a[2],l=b[3]-a[3];return Math.sqrt(q*q+t*t+g*g+l*l)};a.dist=a.distance;a.squaredDistance=
function(a,b){var q=b[0]-a[0],t=b[1]-a[1],g=b[2]-a[2],l=b[3]-a[3];return q*q+t*t+g*g+l*l};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],q=a[1],t=a[2];a=a[3];return Math.sqrt(b*b+q*q+t*t+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],q=a[1],t=a[2];a=a[3];return b*b+q*q+t*t+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var q=a[0],t=a[1],g=a[2],l=a[3],r=q*q+t*t+g*g+l*l;0<r&&(r=1/Math.sqrt(r),b[0]=q*r,b[1]=t*r,b[2]=g*r,b[3]=l*r);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,q,t){var g=a[0],l=a[1],r=a[2];a=a[3];t[0]=g+q*(b[0]-g);t[1]=l+q*(b[1]-l);t[2]=r+q*(b[2]-r);t[3]=a+q*(b[3]-a);return t};a.random=function(c,b){c=c||1;b[0]=q();b[1]=q();b[2]=q();b[3]=q();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,q){var t=a[0],g=a[1],l=
a[2];a=a[3];q[0]=b[0]*t+b[4]*g+b[8]*l+b[12]*a;q[1]=b[1]*t+b[5]*g+b[9]*l+b[13]*a;q[2]=b[2]*t+b[6]*g+b[10]*l+b[14]*a;q[3]=b[3]*t+b[7]*g+b[11]*l+b[15]*a;return q};a.transformQuat=function(a,b,q){var t=a[0],g=a[1],l=a[2],r=b[0],p=b[1],m=b[2];b=b[3];var f=b*t+p*l-m*g,n=b*g+m*t-r*l,e=b*l+r*g-p*t,t=-r*t-p*g-m*l;q[0]=f*b+t*-r+n*-m-e*-p;q[1]=n*b+t*-p+e*-r-f*-m;q[2]=e*b+t*-m+f*-p-n*-r;q[3]=a[3];return q};a.forEach=function(){var c=a.create();return function(a,q,t,g,l,r){q||(q=4);t||(t=0);for(g=g?Math.min(g*
q+t,a.length):a.length;t<g;t+=q)c[0]=a[t],c[1]=a[t+1],c[2]=a[t+2],c[3]=a[t+3],l(c,r,c),a[t]=c[0],a[t+1]=c[1],a[t+2]=c[2],a[t+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,g){var q=g("__vec3"),c=g("__vec4"),b=g("__mat3"),w="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new w(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=q.create(),c=q.fromValues(1,0,0),l=q.fromValues(0,1,0);return function(r,p,m){var f=q.dot(r,p);if(-.9999999>f)return q.cross(c,r,b),1E-6>q.length(b)&&q.cross(l,r,b),q.normalize(b,b),a.setAxisAngle(b,Math.PI,m),m;if(.9999999<f)return m[0]=0,m[1]=0,m[2]=0,m[3]=1,m;q.cross(r,
p,b);m[0]=b[0];m[1]=b[1];m[2]=b[2];m[3]=1+f;return a.normalize(m,m)}}();a.setAxes=function(){var c=b.create();return function(b,q,r,p){c[0]=q[0];c[3]=q[1];c[6]=q[2];c[1]=r[0];c[4]=r[1];c[7]=r[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,p),p)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var q=Math.sin(b);c[0]=q*a[0];c[1]=q*a[1];c[2]=q*a[2];c[3]=Math.cos(b);
return c};a.add=c.add;a.multiply=function(a,b,c){var q=a[0],p=a[1],m=a[2];a=a[3];var f=b[0],n=b[1],e=b[2];b=b[3];c[0]=q*b+a*f+p*e-m*n;c[1]=p*b+a*n+m*f-q*e;c[2]=m*b+a*e+q*n-p*f;c[3]=a*b-q*f-p*n-m*e;return c};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,c){b*=.5;var q=a[0],p=a[1],m=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);c[0]=q*b+a*f;c[1]=p*b+m*f;c[2]=m*b-p*f;c[3]=a*b-q*f;return c};a.rotateY=function(a,b,c){b*=.5;var q=a[0],p=a[1],m=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);c[0]=q*
b-m*f;c[1]=p*b+a*f;c[2]=m*b+q*f;c[3]=a*b-p*f;return c};a.rotateZ=function(a,b,c){b*=.5;var q=a[0],p=a[1],m=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);c[0]=q*b+p*f;c[1]=p*b-q*f;c[2]=m*b+a*f;c[3]=a*b-m*f;return c};a.calculateW=function(a,b){var c=a[0],q=a[1],p=a[2];b[0]=c;b[1]=q;b[2]=p;b[3]=Math.sqrt(Math.abs(1-c*c-q*q-p*p));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,c,q){var p=a[0],m=a[1],f=a[2];a=a[3];var n=b[0],e=b[1],z=b[2];b=b[3];var g,E,F;E=p*n+m*e+f*z+a*b;0>E&&(E=-E,n=-n,e=-e,
z=-z,b=-b);1E-6<1-E?(g=Math.acos(E),F=Math.sin(g),E=Math.sin((1-c)*g)/F,c=Math.sin(c*g)/F):E=1-c;q[0]=E*p+c*n;q[1]=E*m+c*e;q[2]=E*f+c*z;q[3]=E*a+c*b;return q};a.V9=function(){var b=a.create(),c=a.create();return function(q,r,p,m,f,n){a.slerp(q,m,f,b);a.slerp(r,p,f,c);a.slerp(b,c,2*f*(1-f),n);return n}}();a.invert=function(a,b){var c=a[0],q=a[1],p=a[2],m=a[3],f=c*c+q*q+p*p+m*m,f=f?1/f:0;b[0]=-c*f;b[1]=-q*f;b[2]=-p*f;b[3]=m*f;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var q=0;a[4]>a[0]&&(q=1);a[8]>a[3*q+q]&&(q=2);var p=(q+1)%3,m=(q+2)%3,c=Math.sqrt(a[3*q+q]-a[3*p+p]-a[3*m+m]+1);b[q]=.5*c;c=.5/c;b[3]=(a[3*p+m]-a[3*m+p])*c;b[p]=(a[3*p+q]+a[3*q+p])*c;b[m]=(a[3*m+q]+a[3*q+m])*c}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new g(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],g=a[2],t=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=g;c[7]=t}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=a[4],r=a[5],p=a[6],m=a[7],f=a[8],n=f*l-r*m,e=-f*D+r*p,z=
m*D-l*p,M=b*n+g*e+t*z;if(!M)return null;M=1/M;c[0]=n*M;c[1]=(-f*g+t*m)*M;c[2]=(r*g-t*l)*M;c[3]=e*M;c[4]=(f*b-t*p)*M;c[5]=(-r*b+t*D)*M;c[6]=z*M;c[7]=(-m*b+g*p)*M;c[8]=(l*b-g*D)*M;return c};a.adjoint=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=a[4],r=a[5],p=a[6],m=a[7],f=a[8];c[0]=l*f-r*m;c[1]=t*m-g*f;c[2]=g*r-t*l;c[3]=r*p-D*f;c[4]=b*f-t*p;c[5]=t*D-b*r;c[6]=D*m-l*p;c[7]=g*p-b*m;c[8]=b*l-g*D;return c};a.determinant=function(a){var c=a[3],b=a[4],g=a[5],t=a[6],D=a[7],l=a[8];return a[0]*(l*b-g*D)+a[1]*
(-l*c+g*t)+a[2]*(D*c-b*t)};a.multiply=function(a,c,b){var g=a[0],t=a[1],D=a[2],l=a[3],r=a[4],p=a[5],m=a[6],f=a[7];a=a[8];var n=c[0],e=c[1],z=c[2],M=c[3],E=c[4],F=c[5],A=c[6],O=c[7];c=c[8];b[0]=n*g+e*l+z*m;b[1]=n*t+e*r+z*f;b[2]=n*D+e*p+z*a;b[3]=M*g+E*l+F*m;b[4]=M*t+E*r+F*f;b[5]=M*D+E*p+F*a;b[6]=A*g+O*l+c*m;b[7]=A*t+O*r+c*f;b[8]=A*D+O*p+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var g=a[0],t=a[1],D=a[2],l=a[3],r=a[4],p=a[5],m=a[6],f=a[7];a=a[8];var n=c[0];c=c[1];b[0]=g;b[1]=t;b[2]=D;
b[3]=l;b[4]=r;b[5]=p;b[6]=n*g+c*l+m;b[7]=n*t+c*r+f;b[8]=n*D+c*p+a;return b};a.rotate=function(a,c,b){var g=a[0],t=a[1],D=a[2],l=a[3],r=a[4],p=a[5],m=a[6],f=a[7];a=a[8];var n=Math.sin(c);c=Math.cos(c);b[0]=c*g+n*l;b[1]=c*t+n*r;b[2]=c*D+n*p;b[3]=c*l-n*g;b[4]=c*r-n*t;b[5]=c*p-n*D;b[6]=m;b[7]=f;b[8]=a;return b};a.scale=function(a,c,b){var g=c[0];c=c[1];b[0]=g*a[0];b[1]=g*a[1];b[2]=g*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.VU=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.TU=function(a,c){var b=Math.sin(a),g=Math.cos(a);c[0]=g;c[1]=b;c[2]=0;c[3]=-b;c[4]=g;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.UU=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=b+b,r=g+g,p=t+t,b=b*l,m=g*l,g=g*r,f=t*l,n=
t*r,t=t*p,l=D*l,r=D*r,D=D*p;c[0]=1-g-t;c[3]=m-D;c[6]=f+r;c[1]=m+D;c[4]=1-b-t;c[7]=n-l;c[2]=f-r;c[5]=n+l;c[8]=1-b-g;return c};a.normalFromMat4=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=a[4],r=a[5],p=a[6],m=a[7],f=a[8],n=a[9],e=a[10],z=a[11],M=a[12],E=a[13],F=a[14],A=a[15],O=b*r-g*l,H=b*p-t*l,I=b*m-D*l,C=g*p-t*r,h=g*m-D*r,k=t*m-D*p,J=f*E-n*M,y=f*F-e*M,f=f*A-z*M,d=n*F-e*E,n=n*A-z*E,e=e*A-z*F,z=O*e-H*n+I*d+C*f-h*y+k*J;if(!z)return null;z=1/z;c[0]=(r*e-p*n+m*d)*z;c[1]=(p*f-l*e-m*y)*z;c[2]=(l*n-r*
f+m*J)*z;c[3]=(t*n-g*e-D*d)*z;c[4]=(b*e-t*f+D*y)*z;c[5]=(g*f-b*n-D*J)*z;c[6]=(E*k-F*h+A*C)*z;c[7]=(F*I-M*k-A*H)*z;c[8]=(M*h-E*I+A*O)*z;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.SU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new g(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],g=a[2],t=a[3],D=a[6],l=a[7],r=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=g;c[9]=D;c[11]=a[14];c[12]=t;c[13]=
l;c[14]=r}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=a[4],r=a[5],p=a[6],m=a[7],f=a[8],n=a[9],e=a[10],z=a[11],M=a[12],E=a[13],F=a[14],A=a[15],O=b*r-g*l,H=b*p-t*l,I=b*m-D*l,C=g*p-t*r,h=g*m-D*r,k=t*m-D*p,J=f*E-n*M,y=f*F-e*M,d=f*A-z*M,B=n*F-e*E,u=n*A-z*E,ba=e*A-z*F,K=O*ba-H*u+I*B+C*d-h*y+k*J;if(!K)return null;
K=1/K;c[0]=(r*ba-p*u+m*B)*K;c[1]=(t*u-g*ba-D*B)*K;c[2]=(E*k-F*h+A*C)*K;c[3]=(e*h-n*k-z*C)*K;c[4]=(p*d-l*ba-m*y)*K;c[5]=(b*ba-t*d+D*y)*K;c[6]=(F*I-M*k-A*H)*K;c[7]=(f*k-e*I+z*H)*K;c[8]=(l*u-r*d+m*J)*K;c[9]=(g*d-b*u-D*J)*K;c[10]=(M*h-E*I+A*O)*K;c[11]=(n*I-f*h-z*O)*K;c[12]=(r*y-l*B-p*J)*K;c[13]=(b*B-g*y+t*J)*K;c[14]=(E*H-M*C-F*O)*K;c[15]=(f*C-n*H+e*O)*K;return c};a.adjoint=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=a[4],r=a[5],p=a[6],m=a[7],f=a[8],n=a[9],e=a[10],z=a[11],M=a[12],E=a[13],F=a[14],A=
a[15];c[0]=r*(e*A-z*F)-n*(p*A-m*F)+E*(p*z-m*e);c[1]=-(g*(e*A-z*F)-n*(t*A-D*F)+E*(t*z-D*e));c[2]=g*(p*A-m*F)-r*(t*A-D*F)+E*(t*m-D*p);c[3]=-(g*(p*z-m*e)-r*(t*z-D*e)+n*(t*m-D*p));c[4]=-(l*(e*A-z*F)-f*(p*A-m*F)+M*(p*z-m*e));c[5]=b*(e*A-z*F)-f*(t*A-D*F)+M*(t*z-D*e);c[6]=-(b*(p*A-m*F)-l*(t*A-D*F)+M*(t*m-D*p));c[7]=b*(p*z-m*e)-l*(t*z-D*e)+f*(t*m-D*p);c[8]=l*(n*A-z*E)-f*(r*A-m*E)+M*(r*z-m*n);c[9]=-(b*(n*A-z*E)-f*(g*A-D*E)+M*(g*z-D*n));c[10]=b*(r*A-m*E)-l*(g*A-D*E)+M*(g*m-D*r);c[11]=-(b*(r*z-m*n)-l*(g*z-D*
n)+f*(g*m-D*r));c[12]=-(l*(n*F-e*E)-f*(r*F-p*E)+M*(r*e-p*n));c[13]=b*(n*F-e*E)-f*(g*F-t*E)+M*(g*e-t*n);c[14]=-(b*(r*F-p*E)-l*(g*F-t*E)+M*(g*p-t*r));c[15]=b*(r*e-p*n)-l*(g*e-t*n)+f*(g*p-t*r);return c};a.determinant=function(a){var c=a[0],b=a[1],g=a[2],t=a[3],D=a[4],l=a[5],r=a[6],p=a[7],m=a[8],f=a[9],n=a[10],e=a[11],z=a[12],M=a[13],E=a[14];a=a[15];return(c*l-b*D)*(n*a-e*E)-(c*r-g*D)*(f*a-e*M)+(c*p-t*D)*(f*E-n*M)+(b*r-g*l)*(m*a-e*z)-(b*p-t*l)*(m*E-n*z)+(g*p-t*r)*(m*M-f*z)};a.multiply=function(a,c,b){var g=
a[0],t=a[1],D=a[2],l=a[3],r=a[4],p=a[5],m=a[6],f=a[7],n=a[8],e=a[9],z=a[10],M=a[11],E=a[12],F=a[13],A=a[14];a=a[15];var O=c[0],H=c[1],I=c[2],C=c[3];b[0]=O*g+H*r+I*n+C*E;b[1]=O*t+H*p+I*e+C*F;b[2]=O*D+H*m+I*z+C*A;b[3]=O*l+H*f+I*M+C*a;O=c[4];H=c[5];I=c[6];C=c[7];b[4]=O*g+H*r+I*n+C*E;b[5]=O*t+H*p+I*e+C*F;b[6]=O*D+H*m+I*z+C*A;b[7]=O*l+H*f+I*M+C*a;O=c[8];H=c[9];I=c[10];C=c[11];b[8]=O*g+H*r+I*n+C*E;b[9]=O*t+H*p+I*e+C*F;b[10]=O*D+H*m+I*z+C*A;b[11]=O*l+H*f+I*M+C*a;O=c[12];H=c[13];I=c[14];C=c[15];b[12]=O*g+
H*r+I*n+C*E;b[13]=O*t+H*p+I*e+C*F;b[14]=O*D+H*m+I*z+C*A;b[15]=O*l+H*f+I*M+C*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var g=c[0],t=c[1];c=c[2];var D,l,r,p,m,f,n,e,z,M,E,F;a===b?(b[12]=a[0]*g+a[4]*t+a[8]*c+a[12],b[13]=a[1]*g+a[5]*t+a[9]*c+a[13],b[14]=a[2]*g+a[6]*t+a[10]*c+a[14],b[15]=a[3]*g+a[7]*t+a[11]*c+a[15]):(D=a[0],l=a[1],r=a[2],p=a[3],m=a[4],f=a[5],n=a[6],e=a[7],z=a[8],M=a[9],E=a[10],F=a[11],b[0]=D,b[1]=l,b[2]=r,b[3]=p,b[4]=m,b[5]=f,b[6]=n,b[7]=e,b[8]=z,b[9]=M,b[10]=E,b[11]=F,
b[12]=D*g+m*t+z*c+a[12],b[13]=l*g+f*t+M*c+a[13],b[14]=r*g+n*t+E*c+a[14],b[15]=p*g+e*t+F*c+a[15]);return b};a.scale=function(a,c,b){var g=c[0],t=c[1];c=c[2];b[0]=a[0]*g;b[1]=a[1]*g;b[2]=a[2]*g;b[3]=a[3]*g;b[4]=a[4]*t;b[5]=a[5]*t;b[6]=a[6]*t;b[7]=a[7]*t;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,g){var t=b[0],D=b[1];b=b[2];var l=Math.sqrt(t*t+D*D+b*b),r,p,m,f,n,e,z,M,E,F,A,O,H,I,C,h,k,J,y,d;if(1E-7>Math.abs(l))return null;
l=1/l;t*=l;D*=l;b*=l;r=Math.sin(c);p=Math.cos(c);m=1-p;c=a[0];l=a[1];f=a[2];n=a[3];e=a[4];z=a[5];M=a[6];E=a[7];F=a[8];A=a[9];O=a[10];H=a[11];I=t*t*m+p;C=D*t*m+b*r;h=b*t*m-D*r;k=t*D*m-b*r;J=D*D*m+p;y=b*D*m+t*r;d=t*b*m+D*r;t=D*b*m-t*r;D=b*b*m+p;g[0]=c*I+e*C+F*h;g[1]=l*I+z*C+A*h;g[2]=f*I+M*C+O*h;g[3]=n*I+E*C+H*h;g[4]=c*k+e*J+F*y;g[5]=l*k+z*J+A*y;g[6]=f*k+M*J+O*y;g[7]=n*k+E*J+H*y;g[8]=c*d+e*t+F*D;g[9]=l*d+z*t+A*D;g[10]=f*d+M*t+O*D;g[11]=n*d+E*t+H*D;a!==g&&(g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]);
return g};a.rotateX=function(a,c,b){var g=Math.sin(c);c=Math.cos(c);var t=a[4],D=a[5],l=a[6],r=a[7],p=a[8],m=a[9],f=a[10],n=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=t*c+p*g;b[5]=D*c+m*g;b[6]=l*c+f*g;b[7]=r*c+n*g;b[8]=p*c-t*g;b[9]=m*c-D*g;b[10]=f*c-l*g;b[11]=n*c-r*g;return b};a.rotateY=function(a,c,b){var g=Math.sin(c);c=Math.cos(c);var t=a[0],D=a[1],l=a[2],r=a[3],p=a[8],m=a[9],f=a[10],n=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=t*c-p*g;b[1]=D*c-m*g;b[2]=l*c-f*g;b[3]=r*c-n*g;b[8]=t*g+p*c;b[9]=D*g+m*c;b[10]=l*g+f*c;b[11]=r*g+n*c;return b};a.rotateZ=function(a,c,b){var g=Math.sin(c);c=Math.cos(c);var t=a[0],D=a[1],l=a[2],r=a[3],p=a[4],m=a[5],f=a[6],n=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=t*c+p*g;b[1]=D*c+m*g;b[2]=l*c+f*g;b[3]=r*c+n*g;b[4]=p*c-t*g;b[5]=m*c-D*g;b[6]=f*c-l*g;b[7]=n*c-r*g;return b};
a.VU=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.UU=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.TU=function(a,c,b){var g=c[0],t=c[1];c=c[2];var D=Math.sqrt(g*g+t*t+c*c),l;if(1E-7>Math.abs(D))return null;D=1/D;g*=D;t*=D;c*=D;D=Math.sin(a);a=Math.cos(a);l=1-a;b[0]=g*g*l+a;b[1]=t*g*l+c*
D;b[2]=c*g*l-t*D;b[3]=0;b[4]=g*t*l-c*D;b[5]=t*t*l+a;b[6]=c*t*l+g*D;b[7]=0;b[8]=g*c*l+t*D;b[9]=t*c*l-g*D;b[10]=c*c*l+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.X4=function(a,c){var b=Math.sin(a),g=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=g;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=g;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.Y4=function(a,c){var b=Math.sin(a),g=Math.cos(a);c[0]=g;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=g;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.Z4=function(a,c){var b=Math.sin(a),g=Math.cos(a);c[0]=g;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=g;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var g=a[0],t=a[1],D=a[2],l=a[3],r=g+g,p=t+t,m=D+D;a=g*r;var f=g*p,g=g*m,n=t*p,t=t*m,D=D*m,r=l*r,p=l*p,l=l*m;b[0]=1-(n+D);b[1]=f+l;b[2]=g-p;b[3]=0;b[4]=f-l;b[5]=1-(a+D);b[6]=t+r;b[7]=0;b[8]=g+p;b[9]=t-r;b[10]=1-(a+n);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.V4=function(a,c,b,g){var t=a[0],D=a[1],l=a[2],r=a[3],p=t+t,m=D+D,f=l+l;a=t*p;var n=t*m,t=t*f,e=D*m,D=D*f,l=l*f,p=r*p,m=r*m,r=r*f,f=b[0],z=b[1];b=b[2];g[0]=(1-(e+l))*f;g[1]=(n+r)*f;g[2]=(t-m)*f;g[3]=0;g[4]=(n-r)*z;g[5]=(1-(a+l))*z;g[6]=(D+p)*z;g[7]=0;g[8]=(t+m)*b;g[9]=(D-p)*b;g[10]=(1-(a+e))*b;g[11]=0;g[12]=c[0];g[13]=c[1];g[14]=c[2];g[15]=1;return g};a.W4=function(a,c,b,g,t){var D=a[0],l=a[1],r=a[2],p=a[3],m=D+D,f=l+l,n=r+r;a=D*m;var e=D*f,D=D*n,z=l*f,l=l*n,r=r*n,m=p*m,f=p*f,p=
p*n,n=b[0],M=b[1];b=b[2];var E=g[0],F=g[1];g=g[2];t[0]=(1-(z+r))*n;t[1]=(e+p)*n;t[2]=(D-f)*n;t[3]=0;t[4]=(e-p)*M;t[5]=(1-(a+r))*M;t[6]=(l+m)*M;t[7]=0;t[8]=(D+f)*b;t[9]=(l-m)*b;t[10]=(1-(a+z))*b;t[11]=0;t[12]=c[0]+E-(t[0]*E+t[4]*F+t[8]*g);t[13]=c[1]+F-(t[1]*E+t[5]*F+t[9]*g);t[14]=c[2]+g-(t[2]*E+t[6]*F+t[10]*g);t[15]=1;return t};a.fromQuat=function(a,c){var b=a[0],g=a[1],t=a[2],D=a[3],l=b+b,r=g+g,p=t+t,b=b*l,m=g*l,g=g*r,f=t*l,n=t*r,t=t*p,l=D*l,r=D*r,D=D*p;c[0]=1-g-t;c[1]=m+D;c[2]=f-r;c[3]=0;c[4]=m-
D;c[5]=1-b-t;c[6]=n+l;c[7]=0;c[8]=f+r;c[9]=n-l;c[10]=1-b-g;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,g,t,D,l){var r=1/(c-a),p=1/(g-b),m=1/(t-D);l[0]=2*t*r;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=2*t*p;l[6]=0;l[7]=0;l[8]=(c+a)*r;l[9]=(g+b)*p;l[10]=(D+t)*m;l[11]=-1;l[12]=0;l[13]=0;l[14]=D*t*2*m;l[15]=0;return l};a.perspective=function(a,c,b,g,t){a=1/Math.tan(a/2);var D=1/(b-g);t[0]=a/c;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=a;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=(g+b)*D;t[11]=-1;t[12]=
0;t[13]=0;t[14]=2*g*b*D;t[15]=0;return t};a.n8=function(a,c,b,g){var t=Math.tan(a.upDegrees*Math.PI/180),D=Math.tan(a.downDegrees*Math.PI/180),l=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var r=2/(l+a),p=2/(t+D);g[0]=r;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=p;g[6]=0;g[7]=0;g[8]=-((l-a)*r*.5);g[9]=(t-D)*p*.5;g[10]=b/(c-b);g[11]=-1;g[12]=0;g[13]=0;g[14]=b*c/(c-b);g[15]=0;return g};a.ortho=function(a,c,b,g,t,D,l){var r=1/(a-c),p=1/(b-g),m=1/(t-D);l[0]=-2*r;l[1]=0;l[2]=0;l[3]=
0;l[4]=0;l[5]=-2*p;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=2*m;l[11]=0;l[12]=(a+c)*r;l[13]=(g+b)*p;l[14]=(D+t)*m;l[15]=1;return l};a.lookAt=function(g,c,b,w){var t,D,l,r,p,m,f,n,e=g[0],z=g[1];g=g[2];l=b[0];r=b[1];D=b[2];f=c[0];b=c[1];t=c[2];if(1E-7>Math.abs(e-f)&&1E-7>Math.abs(z-b)&&1E-7>Math.abs(g-t))return a.identity(w);c=e-f;b=z-b;f=g-t;n=1/Math.sqrt(c*c+b*b+f*f);c*=n;b*=n;f*=n;t=r*f-D*b;D=D*c-l*f;l=l*b-r*c;(n=Math.sqrt(t*t+D*D+l*l))?(n=1/n,t*=n,D*=n,l*=n):l=D=t=0;r=b*l-f*D;p=f*t-c*l;m=c*D-b*t;(n=Math.sqrt(r*
r+p*p+m*m))?(n=1/n,r*=n,p*=n,m*=n):m=p=r=0;w[0]=t;w[1]=r;w[2]=c;w[3]=0;w[4]=D;w[5]=p;w[6]=b;w[7]=0;w[8]=l;w[9]=m;w[10]=f;w[11]=0;w[12]=-(t*e+D*z+l*g);w[13]=-(r*e+p*z+m*g);w[14]=-(c*e+b*z+f*g);w[15]=1;return w};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.SU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__math=function(a,g){function q(a,b){for(var c=a[1],f=1,m=2;m<a.length;m++)4!=m&&8!=m&&Math.abs(a[m])>Math.abs(c)&&(c=a[m],f=m);for(var p=Math.floor(f/3),f=f%3,c=.5*Math.atan(2*c/(a[3*p+p]-a[3*f+f])),m=0;m<b.length;m++)b[m]=0==m||4==m||8==m?1:0;b[f+3*p]=-Math.sin(c);b[p+3*f]=Math.sin(c);b[p+3*p]=Math.cos(c);b[f+3*f]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var c=a.content[b];0<b;){var f=(b+1>>1)-1,m=a.content[f];if(a.$m(c)<a.$m(m))a.content[f]=
c,a.content[b]=m,b=f;else break}}function w(a,b){for(var c=a.content.length,f=a.content[b],m=a.$m(f);;){var p=b+1<<1,l=p-1,g=null;if(l<c){var q=a.$m(a.content[l]);q<m&&(g=l)}p<c&&a.$m(a.content[p])<(null===g?m:q)&&(g=p);if(null!==g)a.content[b]=a.content[g],a.content[g]=f,b=g;else break}}var t=g("__mat3"),D=g("__vec3"),l=new Float32Array(3),r=new Float32Array(9),p=new Float32Array(9),m=new Float32Array(9),f=new Float32Array(9);a.o6=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.p6=function(a,b){b=b||new Float32Array(3);return D.copy(a,b)};a.gM=function(a,b){D.copy(b,a)};a.ID=function(a,b){D.normalize(b,l);a[3]=l[0];a[4]=l[1];a[5]=l[2]};a.l3=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b};a.UR=function(a,b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return D.scale(b,3/a.length,b)};a.NR=function(a,b,c){for(var f=0;f<c.length;f++)c[f]=0;for(f=0;f<a.length;f+=3){var m=a[f]-b[0],
p=a[f+1]-b[1],l=a[f+2]-b[2];c[0]+=m*m;c[1]+=m*p;c[2]+=m*l;c[4]+=p*p;c[5]+=p*l;c[8]+=l*l}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(f=0;f<c.length;f++)c[f]*=3/a.length;return c};a.IU=function(a,b){var l=t.copy(a,r);if(5E-4>c(l))return t.identity(b);var g=q(l,p),E=t.transpose(g,m);t.multiply(l,E,f);t.multiply(g,f,l);for(var F=t.copy(g,b),A=1;5E-4<=c(l)&&100>A;)g=q(l,p),E=t.transpose(g,m),t.multiply(l,E,f),t.multiply(g,f,l),t.multiply(g,F,F),A++;return F};a.yg=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.yR=function(a){return{content:[],$m:a}};a.FG=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.zR=function(a){var b=a.content[0],c=a.content.pop();0<a.content.length&&(a.content[0]=c,w(a,0));return b};a.j3=function(a,c){var f=a.content.indexOf(c),m=a.content.pop();f!==a.content.length-1&&(a.content[f]=m,a.$m(m)<a.$m(c)?b(f):w(f))};a.AR=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__tsr=function(a,g){function q(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function w(a,b,c,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=b;e[4]=c[0];e[5]=c[1];e[6]=c[2];e[7]=c[3];return e}function t(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function D(a,b,c){var e=b[0],f=b[1],m=b[2],n=b[3],h=b[4],k=b[5],p=b[6];
b=b[7];var l=a[0]*n,d=a[1]*n,B=a[2]*n;a=b*l+k*B-p*d;var n=b*d+p*l-h*B,u=b*B+h*d-k*l,l=-h*l-k*d-p*B;c[0]=a*b+l*-h+n*-p-u*-k;c[1]=n*b+l*-k+u*-h-a*-p;c[2]=u*b+l*-p+a*-k-n*-h;c[0]+=e;c[1]+=f;c[2]+=m;return c}var l=g("__mat4"),r=g("__quat"),p=g("__util"),m=g("__vec3"),f=Math.sin(-Math.PI/4),n=-f,e=new Float32Array(3),z=new Float32Array(4);new Float32Array(4);var M=new Float32Array(16);a.create=q;a.clone=function(a){var c=q();b(a,c);return c};a.a5=function(a,b,c,e,f,m,n,h){var k=q();k[0]=a;k[1]=b;k[2]=
c;k[3]=e;k[4]=f;k[5]=m;k[6]=n;k[7]=h;return k};a.Vl=c;a.O3=function(a){var e=c();b(a,e);return e};a.b5=function(a,b,e,f,m,n,p,h){var k=c();k[0]=a;k[1]=b;k[2]=e;k[3]=f;k[4]=m;k[5]=n;k[6]=p;k[7]=h;return k};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.oi=w;a.of=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Sf=function(a,b){b[3]=a;return b};a.oZ=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.Wk=function(a,b){b[4]=a[0];b[5]=a[1];
b[6]=a[2];b[7]=a[3];return b};a.G=function(a){return a.subarray(0,3)};a.jc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.$d=function(a){return a[3]};a.QV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.R=function(a){return a.subarray(4,8)};a.Zd=t;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var e=a[0],f=a[1],m=a[2];z[0]=a[4];z[1]=a[5];z[2]=a[6];z[3]=a[7];r.invert(z,z);var n=z[0],h=z[1],k=z[2],p=z[3],e=e*c,f=f*c,l=m*c,m=p*e+h*l-k*f,d=p*f+k*e-n*l,B=p*l+n*f-h*e,e=-n*e-h*f-
k*l;b[0]=-(m*p+e*-n+d*-k-B*-h);b[1]=-(d*p+e*-h+B*-n-m*-k);b[2]=-(B*p+e*-k+m*-h-d*-n);b[3]=c;b[4]=n;b[5]=h;b[6]=k;b[7]=p;return b};a.pN=function(a,b){var c=a[3];l.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var e=0;12>e;e++)b[e]*=c};a.Wi=function(a,b){var c=p.AK(a,e),f=p.zK(a),m=p.tC(a,z);w(c,f,m,b)};a.multiply=function(a,b,c){D(b,a,c);c[3]=a[3]*b[3];var e=a[4],f=a[5],m=a[6];a=a[7];var n=b[4],h=b[5],k=b[6];b=b[7];c[4]=e*b+a*n+f*k-m*h;c[5]=f*b+a*h+m*n-e*k;c[6]=m*b+a*k+e*h-f*n;c[7]=
a*b-e*n-f*h-m*k;return c};a.t_=function(a,b,c){var e=b[3];b=l.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),M);for(var f=0;12>f;f++)b[f]*=e;l.multiply(b,a,c);return c};a.Wc=D;a.q$=function(a,b,c){var e=b[3],f=a[0]-b[0],m=a[1]-b[1],n=a[2]-b[2];a=b[4];var h=b[5],k=b[6];b=b[7];var p=a*a+h*h+k*k+b*b,p=p?1/p:0;a=-a*p;h=-h*p;k=-k*p;b*=p;var p=b*f+h*n-k*m,l=b*m+k*f-a*n,d=b*n+a*m-h*f,f=-a*f-h*m-k*n;c[0]=p*b+f*-a+l*-k-d*-h;c[1]=l*b+f*-h+d*-a-p*-k;c[2]=d*b+f*-k+p*-h-l*-a;c[0]/=e;c[1]/=e;c[2]/=e;return c};
a.tp=function(a,b,c,e){e||(e=0);var f=a.length,m=b[0],n=b[1],h=b[2],k=b[3],p=b[4],l=b[5],d=b[6];b=b[7];for(var B=0;B<f;B+=3){var u=a[B]*k,g=a[B+1]*k,K=a[B+2]*k,G=b*u+l*K-d*g,T=b*g+d*u-p*K,P=b*K+p*g-l*u,u=-p*u-l*g-d*K;c[e+B]=G*b+u*-p+T*-d-P*-l;c[e+B+1]=T*b+u*-l+P*-p-G*-d;c[e+B+2]=P*b+u*-d+G*-l-T*-p;c[e+B]+=m;c[e+B+1]+=n;c[e+B+2]+=h}};a.s_=function(a,b,c){var e=0,e=0,f=a.length,m=b[3],n=b[4],h=b[5],k=b[6];b=b[7];for(var p=0;p<f;p+=3){var l=a[p]*m,d=a[p+1]*m,B=a[p+2]*m,u=b*l+h*B-k*d,g=b*d+k*l-n*B,K=
b*B+n*d-h*l,l=-n*l-h*d-k*B;c[e+p]=u*b+l*-n+g*-k-K*-h;c[e+p+1]=g*b+l*-h+K*-n-u*-k;c[e+p+2]=K*b+l*-k+u*-h-g*-n}};a.xd=function(a,b,c){var e=b[3],f=b[4],m=b[5],n=b[6];b=b[7];var h=a[0]*e,k=a[1]*e,p=a[2]*e;a=b*h+m*p-n*k;var e=b*k+n*h-f*p,l=b*p+f*k-m*h,h=-f*h-m*k-n*p;c[0]=a*b+h*-f+e*-n-l*-m;c[1]=e*b+h*-m+l*-f-a*-n;c[2]=l*b+h*-n+a*-m-e*-f};a.v_=function(a,b,c,e){e||(e=0);var f=a.length,m=b[3],n=b[4],h=b[5],k=b[6];b=b[7];for(var p=0;p<f;p+=4){var l=a[p]*m,d=a[p+1]*m,B=a[p+2]*m,u=b*l+h*B-k*d,g=b*d+k*l-n*
B,K=b*B+n*d-h*l,l=-n*l-h*d-k*B;c[e+p]=u*b+l*-n+g*-k-K*-h;c[e+p+1]=g*b+l*-h+K*-n-u*-k;c[e+p+2]=K*b+l*-k+u*-h-g*-n;c[e+p+3]=a[p+3]}};a.u_=function(a,b,c){b=t(b,z);r.multiply(b,a,c)};a.uN=function(a,b,c,e){e=e||0;b=t(b,z);p.rL(a,b,c,e)};a.translate=function(a,b,c){var e=a[3],f=a[4],m=a[5],n=a[6],h=a[7],k=b[0]*e,p=b[1]*e,l=b[2]*e;b=h*k+m*l-n*p;var e=h*p+n*k-f*l,d=h*l+f*p-m*k,k=-f*k-m*p-n*l;c[0]=a[0]+b*h+k*-f+e*-n-d*-m;c[1]=a[1]+e*h+k*-m+d*-f-b*-n;c[2]=a[2]+d*h+k*-n+b*-m-e*-f;c[3]=a[3];c[4]=a[4];c[5]=
a[5];c[6]=a[6];c[7]=a[7];return c};a.aC=function(a,b,c,e){m.lerp(a.subarray(0,3),b.subarray(0,3),c,e.subarray(0,3));var f=a[3];e[3]=f+c*(b[3]-f);r.slerp(a.subarray(4,8),b.subarray(4,8),c,e.subarray(4,8));return e};a.M4=function(a,b,c,e){var f=a.subarray(0,3),m=b.subarray(0,3),n=e.subarray(0,3);n[0]=m[0]*(c+1)-f[0]*c;n[1]=m[1]*(c+1)-f[1]*c;n[2]=m[2]*(c+1)-f[2]*c;e[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);f=e.subarray(4,8);f[0]=b[0]*(c+1)-a[0]*c;f[1]=b[1]*(c+1)-a[1]*c;f[2]=b[2]*(c+1)-
a[2]*c;f[3]=b[3]*(c+1)-a[3]*c;r.normalize(f,f);return e};a.oW=function(a,b,c,e,f){f[0]=a[0]+b*c[0];f[1]=a[1]+b*c[1];f[2]=a[2]+b*c[2];f[3]=a[3];c=e[0];var m=e[1];e=e[2];var n=a[4],h=a[5],k=a[6],p=a[7];f[4]=.5*(c*p+m*k-e*h);f[5]=.5*(m*p+e*n-c*k);f[6]=.5*(e*p+c*h-m*n);f[7]=.5*(-c*n-m*h-e*k);f[4]=a[4]+f[4]*b;f[5]=a[5]+f[5]*b;f[6]=a[6]+f[6]*b;f[7]=a[7]+f[7]*b;a=f[4];b=f[5];c=f[6];m=f[7];a=a*a+b*b+c*c+m*m;0<a&&(a=1/Math.sqrt(a),f[4]*=a,f[5]*=a,f[6]*=a,f[7]*=a)};a.o$=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];var c=a[4],e=a[5],m=a[6],p=a[7];b[4]=c*n+p*f;b[5]=e*n+m*f;b[6]=m*n-e*f;b[7]=p*n-c*f};a.n$=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__batch=function(a,g){function q(a){a={type:a,vb:"",id:0,Sq:-1,Dk:"",Wu:-1,Wn:-1,ir:0,Ff:0,$l:[],ya:[],Md:[],Qg:[],td:[],Yj:[],Fj:null,Zc:{},zb:null,hb:{Eg:null,bf:null,Si:[],ug:[],status:da.Cz,PU:0,u0:0,tG:0,jN:0},Bk:"",vq:[],Ca:null,Pe:L.ak(),Oe:!1,Ri:!1,Xu:!1,rs:0,Pm:0,jw:0,kw:0,gd:!1,Hv:0,Pr:0,me:new Float32Array(3),Be:new Float32Array(16),Mg:!1,Lb:!1,Ua:!1,Dh:!1,$b:!1,Ne:!1,gg:!1,Ke:!1,te:!1,ie:!1,ge:!1,Id:!1,Hd:!1,bv:!1,Th:ea.An,wf:!1,kg:!1,ck:!1,Sg:!1,jf:ta.$p,kh:0,lh:0,Td:-1,Fd:-1,
Mv:!1,Qv:0,Nv:0,Rv:0,Sv:0,Pv:new Float32Array(3),Ov:new Float32Array(3),Rr:!1,Nj:0,ek:0,bm:1,Qo:0,fp:0,Zs:1,Io:0,am:0,Cl:1,Gw:0,ns:0,vg:0,dx:0,Vd:new Float32Array(2),$k:new Float32Array(3),si:new Float32Array(3),gn:new Float32Array(3),fg:new Float32Array(4),Vi:new Float32Array(4),Im:null,xo:null,es:null,ds:null,nk:!1,wireframe_edge_color:Aa.create(),Hj:!1,water_dynamic:!1,wt:!1,ky:!1,ly:0,my:0,jy:0,Gp:.1,Yo:0,$o:0,ho:0,nv:new Float32Array(2),mv:new Float32Array(2),zr:new Float32Array(2),Xo:new Float32Array(3),
Zo:new Float32Array(3),mj:null,Nk:!1,gb:null,mw:0,Dl:null,ws:null,lj:[],kj:[],He:[],jj:[],S:null,Ta:null,wa:null,kb:null,pb:null,ba:null,Yf:!1,dg:!0,VJ:0,Go:new Float32Array(3)};a.fg[3]=1;a.Ua=!0;a.mw=1;return a}function c(a){var b=q(a.type);b.vb=a.vb;b.id=a.id;b.Sq=a.Sq;b.Dk=a.Dk;b.Wu=a.Wu;b.Wn=a.Wn;b.ir=a.ir;b.Ff=a.Ff;b.$l=[];b.ya=a.ya.slice();b.Md=a.Md.slice();b.Qg=a.Qg.slice();b.td=a.td.slice();b.Yj=a.Yj.slice();b.Fj=L.T(a.Fj);b.Zc=L.T(a.Zc);b.zb=a.zb;b.hb=L.T(a.hb);b.Bk=a.Bk;b.vq=ua.DS(a.vq);
b.Ca=a.Ca;b.Oe=a.Oe;b.Ri=a.Ri;b.Xu=a.Xu;b.rs=a.rs;b.Pm=a.Pm;b.jw=a.jw;b.kw=a.kw;b.Hv=a.Hv;b.Pr=a.Pr;b.me=a.me;b.Be=a.Be;b.Mg=a.Mg;b.Lb=a.Lb;b.Ua=a.Ua;b.Dh=a.Dh;b.$b=a.$b;b.Ne=a.Ne;b.gg=a.gg;b.Ke=a.Ke;b.te=a.te;b.ie=a.ie;b.ge=a.ge;b.Id=a.Id;b.Hd=a.Hd;b.gd=a.gd;b.bv=a.bv;b.Th=a.Th;b.wf=a.wf;b.kg=a.kg;b.ck=a.ck;b.Sg=a.Sg;b.jf=a.jf;b.kh=a.kh;b.lh=a.lh;b.Td=a.Td;b.Fd=a.Fd;b.Mv=a.Mv;b.Qv=a.Qv;b.Nv=a.Nv;b.Rv=a.Rv;b.Sv=a.Sv;Aa.copy(a.Pv,b.Pv);Aa.copy(a.Ov,b.Ov);b.Rr=a.Rr;b.Nj=a.Nj;b.ek=a.ek;b.bm=a.bm;b.Qo=
a.Qo;b.fp=a.fp;b.Zs=a.Zs;b.Io=a.Io;b.am=a.am;b.Cl=a.Cl;b.Gw=a.Gw;b.ns=a.ns;b.vg=a.vg;b.dx=a.dx;b.Vd[0]=a.Vd[0];b.Vd[1]=a.Vd[1];Aa.copy(a.$k,b.$k);Aa.copy(a.si,b.si);Aa.copy(a.gn,b.gn);xa.copy(a.fg,b.fg);xa.copy(a.Vi,b.Vi);b.Im=L.T(a.Im);a.xo&&(b.xo=new Float32Array(a.xo),b.es=new Float32Array(a.es),b.ds=new Float32Array(a.ds));b.nk=a.nk;Aa.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.Hj=a.Hj;b.water_dynamic=a.water_dynamic;b.wt=a.wt;b.ky=a.ky;b.ly=a.ly;b.my=a.my;b.jy=a.jy;b.Gp=a.Gp;b.Yo=
a.Yo;b.$o=a.$o;b.ho=a.ho;b.nv.set(a.nv);b.mv.set(a.mv);b.zr.set(a.zr);Aa.copy(a.Xo,b.Xo);Aa.copy(a.Zo,b.Zo);b.mj=L.T(a.mj);b.Nk=a.Nk;b.gb=L.T(a.gb);b.mw=a.mw;a.Dl&&(b.Dl=new Float32Array(a.Dl));b.ws=L.T(a.ws);b.lj=L.T(a.lj);b.kj=L.T(a.kj);b.He=L.T(a.He);b.jj=L.T(a.jj);b.S=Q.Ql(a.S);b.Ta=Q.Ql(a.Ta);b.ba=Q.Qq(a.ba);b.pb=Q.Qq(a.pb);b.wa=Q.Rl(a.wa);b.kb=Q.Rl(a.kb);b.Yf=a.Yf;b.dg=a.dg;b.Go=a.Go;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.vb=a.Lb?a.Dh?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.vb=a.te?"CAST":"RECEIVE";break;case "COLOR_ID":a.vb=a.Dh?"COLOR_ID_XRAY":"COLOR_ID"}}function w(a,b,d){var c=[],e=l(d,b,!b.Zn,!1),h=a.data,f=h.materials,v=Array(f.length),k=Array(f.length),x=[],m=la.ic(d,ya.Pb),n=!1;m&&(n=m.hs.length?!0:!1);for(var G=0;G<e.length;G++)for(var p=e[G],K=0;K<f.length;K++){var Q=f[K];if(!ea.LJ(h,K))if("PHYSICS"==p&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)x.push(ea.pB(h,K,[],b.Ji,{},null));else if(!Q.b4w_lens_flares||n){var g=q(p);
"MAIN"==p?v[K]=g:"DEBUG_VIEW"==p&&(k[K]=g);g.Sq=a.b4w_cluster_data.cluster_id;if(u(g,Q)){"SHADOW"==p&&v[K]&&(g.Ne=v[K].Ne);g.Th=b.Oe||b.gg?ea.Et:ea.An;C(g,b);for(var S=g,ca=a.particle_systems,V=0;V<ca.length;V++){var P=ca[V].settings.b4w_vcol_from_name,Z=ca[V].settings.b4w_vcol_to_name;""!==P&&""!==Z&&(S.Zc[P]={om:!1,src:[{name:P,pg:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==g.type)g.Dk=a.uuid;g.ck=a.b4w_do_not_cull;"MAIN"==g.type&&(g.Sg=a.b4w_caustics);y(g,"DISABLE_FOG",("COLOR_ID"!=p&&"SHADOW"!=p&&
a.b4w_disable_fogging)|0);var T=ea.pB(h,K,g.Yj,b.Ji,g.Zc,g.Fj);!Q.use_tangent_shading||"a_shade_tangs"in T.aa[0]||(y(g,"CALC_TBN",1),J(g,"a_tbn_quat"));Q.b4w_lens_flares&&(T=oa.bY(T));ba(g);c.push({za:g,kf:b,wu:b,Uf:T,qg:[Q.name],Jd:[a]})}}}if(x.length){g=q("PHYSICS");g.vb="NAVMESH";g.Dk=a.uuid;for(var T=ea.XM(x),ga=[],G=0;G<f.length;G++)ga.push(f[G].name);ba(g);c.push({za:g,kf:b,wu:b,Uf:T,qg:ga,Jd:[a]})}for(G=0;G<k.length;G++)k[G]&&(k[G].Wn=v[G].id,ba(k[G]));var ka=a.particle_systems;if(0<ka.length&&
c.length){for(var z=!1,t=!1,G=0;G<ka.length;G++){var W=ka[G],X=W.settings;X.use_render_emitter&&(z=!0);"HAIR"!=X.type||"OBJECT"!=X.render_type&&"GROUP"!=X.render_type&&W.transforms.length||(t=!0);if(z&&t)break}var I=c[0].za.Zc,Y;if(t){var pa;if(1<f.length){for(var A={},M=0;M<ka.length;M++){var E=ka[M].settings;if("HAIR"==E.type&&("OBJECT"==E.render_type||"GROUP"==E.render_type)){var ua=E.b4w_vcol_from_name,Oa=E.b4w_vcol_to_name;""!==ua&&""!==Oa&&(A[ua]=L.T(I[ua]))}}"a_bending_col_main"in I&&(A.a_bending_col_main=
L.T(I.a_bending_col_main));"a_bending_col_detail"in I&&(A.a_bending_col_detail=L.T(I.a_bending_col_detail));pa=ea.lI(h,[],A)}else pa=c[0].Uf;Y=pa}else Y=null;for(var qa=Y,F=a.nb,Ca=[],w=a.particle_systems,O=a.data,ma=0;ma<w.length;ma++){var xb=w[ma],Va=xb.settings;if(Va.count)if("EMITTER"==Va.type){if("DYNAMIC"==b.type){var bb=q("PARTICLES");bb.wa=b.wa;bb.S=b.S;bb.ba=b.ba;bb.kb=b.kb;bb.Ta=b.Ta;bb.pb=b.pb;var xa,H=O.materials,D=xb.settings.material-1;D>=H.length&&(ha.warn('Wrong material used for rendering particle system "'+
xb.name+'"'),D=0);xa=H[D];"HALO"===xb.settings.render_type&&"HALO"===xa.type&&(bb.Rr=!0);r(bb,xa);var va=bb,Ea=a,na=xb.settings;switch(na.b4w_billboard_align){case "VIEW":y(va,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":y(va,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":y(va,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":y(va,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:L.q("Wrong billboard align value")}y(va,"BILLBOARD",0);var wa=na.b4w_enable_soft_particles&&
ta.gH(Ea,na);y(va,"SOFT_PARTICLES",0<na.b4w_particles_softness&&wa&&ia.av?1:0);y(va,"SOFT_STRENGTH",da.O(na.b4w_particles_softness));da.ha(va.hb,"WORLD_SPACE","WORLD"==na.b4w_coordinate_system?1:0);bb.gg=!0;bb.ck=a.b4w_do_not_cull;bb.Dk=F.name+"_"+Va.uuid;oa.lW(bb,xb,xa);var Qa=oa.bV(bb,O,xb,F.k);oa.Z_(Qa,bb,Va.count);oa.Y_(F);C(bb,F.k);ba(bb);Ca.push({za:bb,kf:b,wu:b,Uf:Qa,qg:[xa.name],Jd:[a]})}}else if("HAIR"==Va.type){var Ja=L.$v(xb.seed),Ma=za.hH(ia.qC)&&!Va.b4w_initial_rand_rotation&&!Va.b4w_hair_billboard,
cb=4;Ma&&(cb=8);if(xb.transforms.length)var Ob=xb.transforms;else for(var Yb=ea.vB(qa,Va.count,!1,Ja),Ob=new Float32Array(Yb.length*cb),ib=0;ib<Yb.length;ib++){var Yc=.75+.5*L.zg(Ja);Ob[ib*cb]=Yb[ib][0];Ob[ib*cb+1]=Yb[ib][1];Ob[ib*cb+2]=Yb[ib][2];Ob[ib*cb+3]=Yc;Ma&&(Ob[ib*cb+4]=1,Ob[ib*cb+5]=0,Ob[ib*cb+6]=0,Ob[ib*cb+7]=0)}var Zb=la.ic(d,ya.Bi)?!0:!1;if("OBJECT"==Va.render_type){var mc=[l(d,Va.dupli_object.nb.k,!b.Zn,!0)],Qb=B(a,b,I,qa,[Va.dupli_object],mc,[Ob],Va,xb,Zb,Ja,!1);Ca.push.apply(Ca,Qb)}else if("GROUP"==
Va.render_type){for(var Pb=Va.dupli_group.objects,mc=[],ib=0;ib<Pb.length;ib++){var nc=l(d,Pb[ib].nb.k,!b.Zn,!0);mc.push(nc)}for(var Hc=!1,Ib=[],ib=0;ib<Pb.length;ib++)Ib.push(Pb[ib].nb);if(Va.use_whole_group){for(var oc,sb=Ob,db=Ib,cc=Ma,Zc=cb,Cb={},Rb=new Float32Array([0,0,0,1]),gb=0;gb<sb.length;gb+=Zc)for(var ob=0;ob<db.length;ob++){var Ic=Aa.create();Aa.scale(N.G(db[ob].k.n),N.$d(db[ob].k.n),Ic);var pc=Aa.clone([sb[gb],sb[gb+1],sb[gb+2]]);Cb[ob]||(Cb[ob]=new Float32Array(sb.length));cc&&(Cb[ob][gb+
4]=Rb[0]=sb[gb+4],Cb[ob][gb+5]=Rb[1]=sb[gb+5],Cb[ob][gb+6]=Rb[2]=sb[gb+6],Cb[ob][gb+7]=Rb[3]=sb[gb+7],L.fD(Rb,Rb),L.r_(Ic,Rb,Ic));Aa.add(pc,Ic,pc);Cb[ob][gb]=pc[0];Cb[ob][gb+1]=pc[1];Cb[ob][gb+2]=pc[2];Cb[ob][gb+3]=sb[gb+3]}oc=Cb;Hc=!0}else{var Jc;if(Va.use_group_count){for(var Jb=Ob,qc=Ib,dc=Va.dupli_weights,Ya=Ja,ec=Ma,Kb=cb,tb={},rc=[],ub=0;ub<qc.length;ub++)for(var Lb=qc[ub],Sb=Lb.Qm||Lb.name,yc=0;yc<dc.length;yc++){var Kc=dc[yc];Sb==Kc.name&&rc.push(Kc)}dc.length!=rc.length&&ha.error("dupli weights match failed");
for(ub=0;ub<Jb.length;ub+=Kb){for(var Ga,hc=rc,Db=[0],Eb=0;Eb<hc.length;Eb++)Db[Eb+1]=Db[Eb]+hc[Eb].count;for(var Fc=Db[Db.length-1]*L.zg(Ya),Tb=0,Eb=0;Eb<Db.length;Eb++)if(Fc>=Db[Eb]&&Fc<Db[Eb+1]){Tb=Eb;break}Ga=Tb;tb[Ga]=tb[Ga]||[];tb[Ga].push(Jb[ub],Jb[ub+1],Jb[ub+2],Jb[ub+3]);ec&&tb[Ga].push(Jb[ub+4],Jb[ub+5],Jb[ub+6],Jb[ub+7])}for(Ga in tb)tb[Ga]=new Float32Array(tb[Ga]);Jc=tb}else{for(var jb=Ob,hb=Ja,Ha=Ma,$b=cb,Fb=Ib.length,La={},Na=0;Na<jb.length;Na+=$b){var mb=Math.floor(Fb*L.zg(hb));La[mb]=
La[mb]||[];La[mb].push(jb[Na],jb[Na+1],jb[Na+2],jb[Na+3]);Ha&&La[mb].push(jb[Na+4],jb[Na+5],jb[Na+6],jb[Na+7])}for(mb in La)La[mb]=new Float32Array(La[mb]);Jc=La}oc=Jc}Qb=B(a,b,I,qa,Pb,mc,oc,Va,xb,Zb,Ja,Hc);Ca.push.apply(Ca,Qb)}"INSTANCE"==Va.b4w_wind_bend_inheritance&&F.k.vf&&ha.warn('Emitter object "'+F.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else L.q("Unknown particle settings type")}z?
c.push.apply(c,Ca):c=Ca}return c}function t(a){for(var b=[],d=[],c={},e=0;e<a.length;e++){var h=a[e].za,f=null;if(h.id in c){var v=c[h.id],u=d[v].za;K(h,function(a){K(u,function(b){L.ZZ(a,b)&&1!=a.VJ&&(f=d[v])})});if(!f){do h.id++;while(c[h.id])}}f||(f={za:h,TK:[],xG:[],ZM:[],Jd:[],vL:[],qg:[]},c[h.id]=d.length,d.push(f));if(a[e].Uf&&a[e].Uf.Ja){f.TK.push(a[e].kf);f.xG.push(a[e].wu);f.ZM.push(a[e].Uf);for(var k=0;k<a[e].Jd.length;k++)h=a[e].Jd[k],-1==f.vL.indexOf(h.uuid)&&(f.Jd.push(h),f.vL.push(h.uuid));
for(k=0;k<a[e].qg.length;k++)h=a[e].qg[k],-1==f.qg.indexOf(h)&&f.qg.push(h)}f.qg.sort()}for(e=0;e<d.length;e++){var h=d[e].za,x=d[e].TK,m=d[e].xG,n=d[e].ZM;a=ta.rA(m[0]);if("STATIC"==a.type)for(k=0;k<x.length;k++){var G=x[k],B=m[k],c=n[k],p=N.identity(wa);G.Og&&!G.Aq?(G=N.jc(G.n,Ca),N.of(G,p)):N.copy(G.n,p);B.Dm?c.Of||(B.Og?ea.a_(c,p):ea.Nx(c,p)):ea.Nx(c,p);if(B.Dm)y(h,"AU_QUALIFIER","GLSL_IN");else if(1<d[e].Jd.length){G={};if(B.vf||B.Og)G.au_center_pos=[p[0],p[1],p[2]];B.vf&&(G.au_wind_bending_amp=
[B.Bh],G.au_wind_bending_freq=[B.Ch],G.au_detail_bending_amp=[B.Wg],G.au_detail_bending_freq=[B.Xg],G.au_branch_bending_amp=[B.Rg]);ea.$Z(c,G);y(h,"AU_QUALIFIER","GLSL_IN")}else a.Kq.set(p.subarray(0,3)),B.Kq.set(p.subarray(0,3)),y(h,"AU_QUALIFIER","uniform")}if(0==n.length)c=ea.Nf(L.gt("%empty"));else if(1==n.length)c=n[0];else{c=[];for(k=0;k<n.length;k++)ea.zW(n[k])||c.push(k);if(c.length<n.length)for(k=0;k<c.length;k++)ea.Ox(n[c[k]]);c=ea.XM(n)}if(1<d[e].Jd.length){n=[];for(k=0;k<d[e].Jd.length;k++)Q.oB(d[e].Jd[k].nb.k.zG,
n);Q.yG(n,a.Ta);Q.Rn(a.Ta,a.S);a.pb=Q.Nu(L.Hf(n),!0);Q.xA(a.pb,a.ba);a.kb=Q.br(a.pb);Q.zA(a.kb,a.wa)}a.Yf=Q.cC(a.ba,a.wa);"STATIC"==a.type&&a.uo&&(k=d[e].Jd[0].b4w_cluster_data,k.cluster_center&&k.cluster_radius?(a.ks.set(k.cluster_center),a.ls=k.cluster_radius):(a.ks.set(a.kb.F),a.ls=a.kb.Xa));"PARTICLES"!=h.type&&(k=c.Vf,h.S=Q.Ql(k.S),h.ba=Q.Qq(k.ba),h.wa=a.wa.Xa<k.wa.Xa?"STATIC"==a.type?Q.Rl(a.kb):Q.Rl(a.wa):Q.Rl(k.wa),"STATIC"==a.type?(h.pb=h.ba,h.Ta=h.S,h.kb=h.wa):(k=a.n,h.pb=Q.Dq(h.ba,k),h.kb=
Q.Eq(h.wa,k),h.Ta=Q.Nl(h.S,k)),h.Yf=Q.cC(h.ba,h.wa));b.push({za:h,k:a,Uf:c,qg:d[e].qg,Jd:d[e].Jd})}return b}function D(a,b,d,c){a.yq=Q.CG(b,c);a.wq=Q.AG(d,c);a.xq=Q.BG(b,c)}function l(a,b,d,c){var e=[];c||(b.Rk&&la.ic(a,ya.xf)||b.Uc&&la.ic(a,ya.Kg))&&e.push("COLOR_ID");d&&(e.push("MAIN"),e.push("NODES_GLOW"),la.ic(a,ya.zf)&&e.push("DEBUG_VIEW"),la.ic(a,ya.Bf)&&e.push("SHADOW"),la.ic(a,ya.Bi)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.te||b.Id)for(a=null,b.te&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),b.Id&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?L.iR(a,b):b),b=a,a=0;a<b.length;a++)d=e.indexOf(b[a]),-1!==d&&e.splice(d,1);return e}function r(a,b){var d;switch(a.type){case "MAIN":if(b.b4w_do_not_render)d=!1;else{if(b.use_nodes&&"HALO"!=b.type)E(a,b,"MAIN");else{f(a,b);d=b.game_settings.alpha_blend;a.Dh=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.vg=b.offset_z;a.si.set([1,1,1]);var c=b.texture_slots;xa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.fg);if(b.b4w_lens_flares){T(a,"lens_flares.glslv","lens_flares.glslf");J(a,"a_position");J(a,"a_texcoord");var h=pa.le(c[0]),u=c[0].texture;P(a,h,"u_sampler",u.name)}else{T(a,"main.glslv","main_stack.glslf");b.use_shadeless||(d=V.HA(b.uuid,b.name,{Ne:b.use_shadeless,mr:b.diffuse_shader,$s:b.specular_shader,rn:b.use_tangent_shading}),a.hb.ug=V.Ju(d));var k=n("use_map_color_diffuse",c),x=n("use_map_color_spec",c),G=n("use_map_normal",c),B=n("use_map_mirror",c),l=n("use_stencil",c);d=k[0];
x=x[0];G=G[0];B=B[0];k=k[1];c=l[0]&&n("use_rgb_to_intensity",c)[0];if(d){u=d.texture;switch(d.blend_type){case "MIX":y(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":y(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}h=pa.le(d);P(a,h,"u_colormap0",u.name);a.am=d.diffuse_color_factor;a.Cl=d.use_map_alpha?d.alpha_factor:0;a.si.set(d.scale)}l=d&&d==x;x&&(l||(u=x.texture,h=pa.le(x),P(a,h,"u_specmap0",u.name)),a.fp=x.specular_color_factor);if(G&&(u=G.texture,J(a,"a_tbn_quat"),
h=pa.le(G),P(a,h,"u_normalmap0",u.name),a.Gw=G.normal_factor,u.b4w_use_map_parallax&&ia.Ow)){var h=da.O(u.b4w_parallax_steps),K=da.O(u.b4w_parallax_lod_dist);y(a,"PARALLAX",1);y(a,"PARALLAX_STEPS",h);y(a,"PARALLAX_LOD_DIST",K);a.Io=u.b4w_parallax_scale}B&&(u=B.texture,h=pa.le(B),P(a,h,"u_mirrormap",u.name),a.ns=B.mirror_factor);if(B=d&&k&&c?1:0)h=pa.le(k),u=k.texture,P(a,h,"u_colormap1",u.name),h=pa.le(c),u=c.texture,P(a,h,"u_stencil0",u.name);(u=d||x||G)&&a.si.set(u.scale);y(a,"TEXTURE_SPEC",void 0==
x?0:1);y(a,"ALPHA_AS_SPEC",l?1:0);y(a,"TEXTURE_STENCIL_ALPHA_MASK",B);J(a,"a_position");J(a,"a_tbn_quat");(d||x||G)&&J(a,"a_texcoord");if(b.b4w_water){a.Hj=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Lb?(ha.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.wt=!1):a.wt="REFLECT"!=a.vb?b.b4w_water_shore_smoothing:!1;T(a,"water.glslv","water.glslf");B=V.HA(b.uuid,b.name,{Ne:!1,mr:b.diffuse_shader,$s:b.specular_shader,rn:b.use_tangent_shading});
a.hb.ug=V.Ju(B);J(a,"a_position");ia.eO?(J(a,"a_polyindex"),a.Ua=!0,Aa.set(0,0,0,a.wireframe_edge_color),v.JB()?y(a,"DEBUG_WIREFRAME",1):y(a,"DEBUG_WIREFRAME",2)):y(a,"DEBUG_WIREFRAME",0);l=b.texture_slots;B=n("use_map_normal",l);h=n("use_map_mirror",l)[0];B.length&&(K=pa.le(B[0]),u=B[0].texture,P(a,K,"u_normalmap0",u.name),a.Gp=b.b4w_water_norm_uv_velocity);y(a,"NUM_NORMALMAPS",B.length);a.mj=Array(B.length);for(u=0;u<B.length;u++)a.mj[u]=new Float32Array(2),a.mj[u].set([B[u].scale[0],B[u].scale[1]]);
h&&(K=pa.le(h),u=h.texture,P(a,K,"u_mirrormap",u.name),a.ns=h.mirror_factor);h=null;if(ia.yr)for(u=0;u<l.length;u++){var Q=l[u];if(!0===Q.texture.b4w_water_foam){h=Q;break}}h&&(y(a,"FOAM",1),K=pa.le(h),u=h.texture,P(a,K,"u_foam",u.name),a.ho=b.b4w_foam_factor,a.nv.set(u.b4w_foam_uv_freq),a.mv.set(u.b4w_foam_uv_magnitude),a.zr[0]=h.scale[0],a.zr[1]=h.scale[1]);for(u=0;u<l.length;u++)if(Q=l[u],!0===Q.texture.b4w_shore_dist_map){var g=Q;break}g&&ia.nu&&(l=pa.le(g),u=g.texture,P(a,l,"u_shore_dist_map",
u.name),y(a,"SHORE_PARAMS",1),g=Q.texture.b4w_shore_boundings,y(a,"MAX_SHORE_DIST",da.O(Q.texture.b4w_max_shore_dist)),y(a,"SHORE_MAP_SIZE_X",da.O(g[0]-g[1])),y(a,"SHORE_MAP_SIZE_Y",da.O(g[2]-g[3])),y(a,"SHORE_MAP_CENTER_X",da.O((g[0]+g[1])/2)),y(a,"SHORE_MAP_CENTER_Y",da.O((g[2]+g[3])/2)));b.b4w_generated_mesh?(y(a,"GENERATED_MESH",1),a.ky=!0,a.ly=b.b4w_water_num_cascads,a.my=b.b4w_water_subdivs,a.jy=b.b4w_water_detailed_dist):(J(a,"a_tbn_quat"),(h||B.length)&&J(a,"a_texcoord"),y(a,"GENERATED_MESH",
0));if(b.b4w_water_dynamic){var Q=da.O(b.b4w_water_dst_noise_scale0),g=da.O(b.b4w_water_dst_noise_scale1),B=da.O(b.b4w_water_dst_noise_freq0),l=da.O(b.b4w_water_dst_noise_freq1),u=da.O(b.b4w_water_dir_min_shore_fac),h=da.O(b.b4w_water_dir_freq),K=da.O(b.b4w_water_dir_noise_scale),S=da.O(b.b4w_water_dir_noise_freq),ca=da.O(b.b4w_water_dir_min_noise_fac),Z=da.O(b.b4w_water_dst_min_fac),ga=da.O(b.b4w_water_waves_hor_fac);y(a,"DST_NOISE_SCALE_0",Q);y(a,"DST_NOISE_SCALE_1",g);y(a,"DST_NOISE_FREQ_0",B);
y(a,"DST_NOISE_FREQ_1",l);y(a,"DIR_MIN_SHR_FAC",u);y(a,"DIR_FREQ",h);y(a,"DIR_NOISE_SCALE",K);y(a,"DIR_NOISE_FREQ",S);y(a,"DIR_MIN_NOISE_FAC",ca);y(a,"DST_MIN_FAC",Z);y(a,"WAVES_HOR_FAC",ga)}z(a,b);M(a,b);a.Xo.set(b.b4w_shallow_water_col);a.Zo.set(b.b4w_shore_water_col);a.Yo=b.b4w_shallow_water_col_fac;a.$o=b.b4w_shore_water_col_fac;y(a,"ABSORB",da.O(b.b4w_water_absorb_factor));y(a,"SSS_STRENGTH",da.O(b.b4w_water_sss_strength));y(a,"SSS_WIDTH",da.O(b.b4w_water_sss_width))}"HALO"===b.type&&(T(a,"halo.glslv",
"halo.glslf"),p(a,b),a.Yj=["a_position"]);b.use_tangent_shading&&(y(a,"USE_TBN_SHADING",1),J(a,"a_shade_tangs"));y(a,"TEXCOORD",0);y(a,"NORMAL_TEXCOORD",0);d&&m(a,d,"TEXTURE_COLOR0_CO");k&&m(a,k,"TEXTURE_COLOR1_CO");c&&m(a,c,"TEXTURE_STENCIL_ALPHA_MASK_CO");x&&m(a,x,"TEXTURE_SPEC_CO");G&&m(a,G,"TEXTURE_NORM_CO");y(a,"SHADELESS",b.use_shadeless?1:0);a.Ne=b.use_shadeless}d=b.game_settings.alpha_blend;y(a,"ALPHA","OPAQUE"===d?0:1);y(a,"ALPHA_CLIP","CLIP"===d?1:0);y(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);b.use_vertex_color_paint?(y(a,"VERTEX_COLOR",1),J(a,"a_color")):y(a,"VERTEX_COLOR",0);a.Nj=b.ambient;a.bm=b.diffuse_intensity;a.ek=b.emit;a.gn.set(b.specular_color);a.Zs=b.specular_alpha;z(a,b);M(a,b);b.b4w_wettable?y(a,"WETTABLE",1):y(a,"WETTABLE",0);e(a,b);b.b4w_refractive&&!a.Lb?(ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.Nk=!1):a.Nk=b.b4w_refractive;a.dx=b.b4w_refr_bump}d=!0}break;case "NODES_GLOW":d=E(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||
b.b4w_do_not_render||"HALO"===b.type)d=!1;else if(f(a,b),a.Lb)d=!1;else{x=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==x?E(a,b,"SHADOW"):T(a,"shadow.glslv","shadow.glslf");xa.set(0,0,0,b.alpha,a.fg);J(a,"a_position");J(a,"a_tbn_quat");y(a,"ALPHA","OPAQUE"===x?0:1);a.si.set([1,1,1]);if((d=n("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===x){switch(d.blend_type){case "MIX":y(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":y(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.si.set(d.scale);
y(a,"TEXTURE_COLOR",1);J(a,"a_texcoord");x=pa.le(d);d=d.texture;"IMAGE"!=x.source&&"ENVIRONMENT_MAP"!=x.source&&"CANVAS"!=x.source&&"NONE"!=x.source||P(a,x,"u_colormap0",d.name)}else y(a,"TEXTURE_COLOR",0);d=!0}break;case "PHYSICS":b.b4w_collision?(a.ot=b.b4w_use_ghost,a.cc=b.b4w_collision_id,a.Vq=b.b4w_collision_margin,a.Tq=b.b4w_collision_group,a.Wq=b.b4w_collision_mask,a.km=b.physics.friction,a.em=b.physics.elasticity,d=!0):b.b4w_water?(a.Hj=!0,a.D0=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,d=!0):d=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)d=!1;else{f(a,b);a.wf=!1;a.Ua=!0;a.Lb=!1;x=b.game_settings.alpha_blend;a.Dh=b.b4w_render_above_all&&"OPAQUE"!=x&&"CLIP"!=x;b.use_nodes&&"CLIP"==x?E(a,b,"COLOR_ID"):T(a,"color_id.glslv","color_id.glslf");xa.set(0,0,0,b.alpha,a.fg);J(a,"a_position");y(a,"ALPHA","OPAQUE"===x?0:1);a.si.set([1,1,1]);d=n("use_map_color_diffuse",b.texture_slots)[0];x="CLIP"===x?1:0;y(a,"ALPHA_CLIP",x);if(d&&x){switch(d.blend_type){case "MIX":y(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":y(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.si.set(d.scale);y(a,"TEXTURE_COLOR",1);J(a,"a_texcoord");x=pa.le(d);d=d.texture;"IMAGE"!=x.source&&"ENVIRONMENT_MAP"!=x.source&&"CANVAS"!=x.source&&"NONE"!=x.source||P(a,x,"u_colormap0",d.name)}else y(a,"TEXTURE_COLOR",0);d=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?d=!1:(f(a,b),a.Lb=!1,a.wf=!1,a.Ua=!0,T(a,"grass_map.glslv","grass_map.glslf"),J(a,"a_position"),d=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,x=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.Zc.a_grass_size={om:!0,src:[]},d?(a.Zc.a_grass_size.src.push({name:d,pg:4}),y(a,"DYNAMIC_GRASS_SIZE",1)):y(a,"DYNAMIC_GRASS_SIZE",0),a.Zc.a_grass_color={om:!0,src:[]},x?(a.Zc.a_grass_color.src.push({name:x,pg:7}),y(a,"DYNAMIC_GRASS_COLOR",1)):y(a,"DYNAMIC_GRASS_COLOR",0),y(a,"GRASS_TEXTURE_SIZE",da.O(na.Qr)),d=!0);break;case "DEBUG_VIEW":d=I(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)d=!1;else{d=b.texture_slots;if(a.Rr)T(a,"particle_system.glslv","particle_system_stack.glslf"),
y(a,"HALO_PARTICLES",1),p(a,b);else{x={Ne:!1,mr:b.diffuse_shader,$s:b.specular_shader,rn:b.use_tangent_shading};if(b.use_nodes){T(a,"particle_system.glslv","particle_system.glslf");E(a,b,"PARTICLES");d=!0;break a}T(a,"particle_system.glslv","particle_system_stack.glslf");x=V.HA(b.uuid,b.name,x);a.hb.ug=V.Ju(x);if(d=n("use_map_color_diffuse",d)[0]){y(a,"TEXTURE_COLOR",1);switch(d.blend_type){case "MIX":y(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":y(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.am=d.diffuse_color_factor;a.Cl=d.use_map_alpha?d.alpha_factor:0;x=pa.le(d);P(a,x,"default"+String(a.ya.length),d.texture.name)}}xa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.fg);a.Nj=b.ambient;a.bm=b.diffuse_intensity;a.ek=b.emit;a.gn.set(b.specular_color);a.Zs=b.specular_alpha;J(a,"a_position");J(a,"a_tbn_quat");d=b.game_settings.alpha_blend;y(a,"ALPHA","OPAQUE"===d?0:1);y(a,"ALPHA_CLIP","CLIP"===d?1:0);y(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);z(a,b);M(a,b);f(a,b);d=b.game_settings.alpha_blend;a.Dh=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.vg=b.offset_z;d=!0}break;default:L.q("Wrong batch type: "+a.type)}return d}function p(a,b){var d=b.halo;y(a,"NUM_RINGS",d.ring_count);y(a,"NUM_LINES",d.line_count);y(a,"NUM_STARS",d.star_tip_count);y(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.Qv=d.size;a.Nv=d.hardness/20;a.Pv.set(d.b4w_halo_rings_color);a.Ov.set(d.b4w_halo_lines_color);a.Rv=1/b.b4w_halo_stars_blend_height;a.Sv=b.b4w_halo_stars_min_height;
a.Mv=!0}function m(a,b,d){switch(b.texture_coords){case "UV":case "ORCO":y(a,d,"TEXTURE_COORDS_UV_ORCO");y(a,"TEXCOORD",1);break;case "NORMAL":y(a,d,"TEXTURE_COORDS_NORMAL");y(a,"NORMAL_TEXCOORD",1);break;default:y(a,d,"TEXTURE_COORDS_NONE")}}function f(a,b){var d=b.game_settings,c=d.alpha_blend;switch(c){case "ALPHA_SORT":a.Lb=!0;a.wf=!0;a.Ua=!0;a.Mg=!1;break;case "ALPHA":a.Lb=!0;a.wf=!1;a.Ua=!0;a.Mg=!1;break;case "CLIP":a.Lb=!1;a.wf=!1;a.Ua=!0;a.Mg=!0;break;case "ADD":a.Lb=!0;a.wf=!1;a.Ua=!1;a.Mg=
!1;break;case "OPAQUE":a.Lb=!1;a.wf=!1;a.Ua=!0;a.Mg=!1;break;default:L.q("Unknown alpha blend mode: "+c)}a.$b=d.use_backface_culling}function n(a,b){for(var d=[],c=b.length,e=0;e<c;e++){var h=b[e];1==h[a]&&h.texture&&h.texture.s&&d.push(h)}return d}function e(a,b){var d=b.raytrace_transparency;a.Vi[0]=d.fresnel;a.Vi[1]=1-d.fresnel_factor/5;d=b.raytrace_mirror;a.Qo=d.reflect_factor;a.Vi[2]=d.fresnel;a.Vi[3]=1-d.fresnel_factor/5}function z(a,b){var d,c=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":d=
b.specular_hardness;break;case "WARDISO":d=b.specular_slope;break;case "TOON":d=b.specular_toon_size;c=b.specular_toon_smooth;break;case "BLINN":d=b.specular_ior;c=b.specular_hardness;break;default:ha.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),d=b.specular_hardness}a.$k[0]=b.specular_intensity;a.$k[1]=d;a.$k[2]=c}function M(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Vd[0]=0;a.Vd[1]=0;break;case "OREN_NAYAR":a.Vd[0]=b.roughness;a.Vd[1]=0;break;case "FRESNEL":a.Vd[0]=
b.diffuse_fresnel;a.Vd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Vd[0]=b.darkness;a.Vd[1]=0;break;case "TOON":a.Vd[0]=b.diffuse_toon_size;a.Vd[1]=b.diffuse_toon_smooth;break;default:ha.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Vd[0]=0,a.Vd[1]=0}}function E(a,b,d){if(!b.use_nodes||b.b4w_do_not_render)return!1;var c;switch(d){case "MAIN":T(a,"main.glslv","main.glslf");c=!1;break;case "GLOW":T(a,"main.glslv","main.glslf");c=!0;break;case "SHADOW":T(a,
"shadow.glslv","shadow.glslf");c=!1;break;case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf"),c=!1}var h=b.node_tree;d=V.HS(h,b.uuid,!1,b.name,d);if(!d.Wa)return ha.error('Failed to create node graph for material "'+b.name+'", disable nodes'),H(a,b),!0;a.Bk=d.id;a.nk=!0;y(a,"NODES",1);y(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);J(a,"a_position");b.use_orco_tex_coord&&J(a,"a_orco_tex_coord");f(a,b);a.vg=b.offset_z;var u=b.game_settings.alpha_blend;c?(y(a,"ALPHA",1),y(a,"ALPHA_CLIP",
0)):(y(a,"ALPHA","OPAQUE"===u?0:1),y(a,"ALPHA_CLIP","CLIP"===u?1:0));a.Dh=b.b4w_render_above_all&&"OPAQUE"!=u&&"CLIP"!=u;a.ek=b.emit;a.Nj=b.ambient;e(a,b);b.b4w_wettable?y(a,"WETTABLE",1):y(a,"WETTABLE",0);var k=null,x=!1;Z.pa(d.Wa,function(d,c){switch(c.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=c.data.name,h=c.data.value;a.Fj||(a.Fj={});a.Fj[h]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=c.data.name;a.Zc[e]={om:!0,
src:[{name:c.data.value}]};h=0;if("GEOMETRY_VC"==c.type)h=7;else for(var f=0;f<c.fb.length;f++){var u="RGB".indexOf(c.fb[f].identifier);-1<u&&(h|=1<<2-u)}a.Zc[e].src[0].pg=h;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":J(a,"a_tbn_quat");break;case "TEX_COORD_OB":y(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":y(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":c.data.value.rn&&(y(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&J(a,"a_shade_tangs"));
J(a,"a_tbn_quat");x=!0;break;case "BSDF_BEGIN":x=!0;J(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":e=c.data.name;h=c.data.aA;f=c.data.value;P(a,f,e,h);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":y(a,"CALC_TBN_SPACE",1);J(a,"a_tbn_quat");c.data&&(e=c.data.name,h=c.data.aA,f=c.data.value,P(a,f,e,h));break;case "NORMAL_MAP":J(a,"a_tbn_quat");switch(Number(c.Rb[0][1])){case V.iP:y(a,"CALC_TBN_SPACE",1);break;case V.hP:case V.gP:y(a,"USE_MODEL_TSR",1)}break;case "LAMP":c.data&&
(a.Im=c.data);break;case "B4W_REFRACTION":a.Lb?a.Nk=!0:(a.Nk=!1,ha.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));y(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":k||(k=c.data.jb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&c.data&&(a.ws=c.data);break;case "VECT_TRANSFORM":switch(Number(c.Rb[1][1])){case V.yQ:y(a,"USE_MODEL_TSR_INVERSE",1);break;case V.xQ:y(a,"USE_VIEW_TSR",1);break;case V.wQ:y(a,"USE_MODEL_TSR",1);break;case V.vQ:y(a,"USE_MODEL_TSR",
1);y(a,"USE_VIEW_TSR",1);break;case V.uQ:y(a,"USE_VIEW_TSR_INVERSE",1);break;case V.tQ:y(a,"USE_MODEL_TSR_INVERSE",1),y(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":y(a,"USE_MODEL_TSR",1);a.Go[1]=b.pass_index;a.Go[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":y(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":y(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":J(a,"a_tbn_quat"),v.JB()?y(a,"USE_DERIVATIVES_EXT",1):ha.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});k&&P(a,k,"u_nodes_texture");x||(a.Ne=!0);c=a.hb.ug=V.Ju(d.Wa);F(h,a);h=a.kj;d=a.jj;for(u=0;u<c.length;u++){var L=c[u];switch(L.id){case "VALUE":var m=L.Pw[0];if(m)for(var B=0;B<h.length;B+=2)if(h[B]==m){L.Rb.push(["VALUE_IND",h[B+1]]);break}break;case "RGB":if(m=L.Pw[0])for(B=0;B<d.length;B+=2)if(d[B]==m){L.Rb.push(["RGB_IND",d[B+1]]);break}}}y(a,"NUM_VALUES",a.lj.length);y(a,"NUM_RGBS",a.He.length);return!0}function F(a,b){var d=[],c=[],e=[],h=[];A(a,"",d,c,e,h);b.lj=d;b.kj=
c;b.He=e;b.jj=h}function A(a,b,d,c,e,h){for(var f=0;f<a.nodes.length;f++){var u=a.nodes[f];if("VALUE"==u.type){var v=O(b,u.name);d.push(u.outputs[0].default_value);c.push(v,c.length/2)}else"RGB"==u.type?(v=O(b,u.name),u=u.outputs[0].default_value.slice(0,3),e.push(u[0],u[1],u[2]),h.push(v,h.length/2)):"GROUP"==u.type&&A(u.node_group.node_tree,O(b,u.name),d,c,e,h)}}function O(a,b){var d;return d=(a?a+"%join%":"")+b}function H(a,b){switch(a.type){case "SHADOW":T(a,"shadow.glslv","shadow.glslf");break;
case "COLOR_ID":T(a,"color_id.glslv","color_id.glslf");break;default:T(a,"main.glslv","main_stack.glslf")}y(a,"SHADELESS",1);J(a,"a_position");J(a,"a_tbn_quat");xa.set(1,0,1,1,a.fg);if(b){var d=b.game_settings.alpha_blend;y(a,"ALPHA","OPAQUE"===d?0:1);y(a,"ALPHA_CLIP","CLIP"===d?1:0);y(a,"VERTEX_COLOR",0);a.vg=b.offset_z;f(a,b)}return!0}function I(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;T(a,"debug_view.glslv","debug_view.glslf");J(a,"a_position");J(a,"a_tbn_quat");J(a,"a_polyindex");
a.Ua=!0;Aa.set(0,0,0,a.wireframe_edge_color);return!0}function C(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.Dm?y(a,"AU_QUALIFIER","GLSL_IN"):y(a,"AU_QUALIFIER","uniform"),y(a,"STATIC_BATCH",0)):(y(a,"AU_QUALIFIER","GLSL_IN"),y(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(v.JB()?y(a,"WIREFRAME_QUALITY",1):y(a,"WIREFRAME_QUALITY",0),a.Ri?(y(a,"DEBUG_SPHERE",1),a.Xu?y(a,"DEBUG_SPHERE_DYNAMIC",1):y(a,"DEBUG_SPHERE_DYNAMIC",0)):y(a,"DEBUG_SPHERE",0),y(a,"ALPHA",1));b.Oe&&(a.Oe=b.Oe);b.vf?(""!==b.dj?
(a.Zc.a_bending_col_main={om:!0,src:[{name:b.dj,pg:4}]},J(a,"a_bending_col_main"),""!==b.De.jC&&""!==b.De.iC&&""!==b.De.TC?(a.Zc.a_bending_col_detail={om:!0,src:[{name:b.De.jC,pg:4},{name:b.De.iC,pg:2},{name:b.De.TC,pg:1}]},J(a,"a_bending_col_detail"),J(a,"a_tbn_quat"),y(a,"DETAIL_BEND",1)):y(a,"DETAIL_BEND",0),y(a,"MAIN_BEND_COL",1)):y(a,"MAIN_BEND_COL",0),b.Jl?y(a,"BEND_CENTER_ONLY",1):y(a,"BEND_CENTER_ONLY",0),y(a,"WIND_BEND",1)):y(a,"WIND_BEND",0);y(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.Aq|0);
b.Og?y(a,"BILLBOARD",1):y(a,"BILLBOARD",0);b.Og&&b.Dm?y(a,"HAIR_BILLBOARD",1):y(a,"HAIR_BILLBOARD",0);b.Bq?y(a,"BILLBOARD_SPHERICAL",1):y(a,"BILLBOARD_SPHERICAL",0);switch(b.Cq){case "RANDOM":y(a,"BILLBOARD_RANDOM",1);y(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":y(a,"BILLBOARD_RANDOM",0);y(a,"BILLBOARD_JITTERED",1);break;default:y(a,"BILLBOARD_RANDOM",0),y(a,"BILLBOARD_JITTERED",0)}b.gd&&ia.nu?y(a,"DYNAMIC_GRASS",1):y(a,"DYNAMIC_GRASS",0);a.gd=b.gd;"PARTICLES"!=a.type&&(a.gg=b.gg);a.Ke=b.Ke;
a.te=b.te;a.ie=b.ie&&!a.Ne&&!(a.Lb&&ia.cB);a.ge=b.ge;a.Id=b.Id;a.Hd=b.Hd;a.Go[0]=b.Sw;a.jf=b.jf;a.kh=b.kh;a.lh=b.lh;a.Td=b.Td;a.Fd=b.Fd;b.uk?(J(a,"a_influence"),y(a,"SKINNED",1),ia.Bx?(y(a,"DISABLE_TANGENT_SKINNING",1),y(a,"FRAMES_BLENDING",0)):(y(a,"DISABLE_TANGENT_SKINNING",0),b.jm?y(a,"FRAMES_BLENDING",1):y(a,"FRAMES_BLENDING",0)),y(a,"MAX_BONES",b.mh)):(y(a,"SKINNED",0),y(a,"FRAMES_BLENDING",0),y(a,"DISABLE_TANGENT_SKINNING",0));b.Yc?(y(a,"VERTEX_ANIM",1),ia.YN?y(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):y(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):y(a,"VERTEX_ANIM",0);b.uk&&b.Yc&&L.q("Skinning and vertex animation are mutually exlusive")}}function h(a,b,d){if(b.length){for(var c=ta.Bv(b,ia.ssao&&d.b4w_enable_ssao),e=a.hb,h=a.Im,f=0,u=0;u<a.hb.ug.length;u++){var v=a.hb.ug[u];if("LIGHTING_LAMP"==v.id){var x=b[f++%b.length],L=x.tb,m=ta.ja(x,d);if("SPOT"==L.type||"POINT"==L.type)var B=Math.cos(L.jn/2);if("SPOT"==L.type)var n=L.bt*(1-B);x=c.indexOf(x);v.Rb=[["LAMP_TYPE",L.type],["LAMP_IND",
m.Jm],["LAMP_SPOT_SIZE",da.O(B||.01)],["LAMP_SPOT_BLEND",da.O(n||.01)],["LAMP_LIGHT_DIST",da.O(L.distance)],["LAMP_USE_SPHERE",L.EE?1:0],["LAMP_SHADOW_MAP_IND",x]]}else if("LAMP"==v.id&&h)for(var m=v.Rb[0][1],G=0;G<b.length;G++)if(x=b[G],h[x.Ej]==m){L=x.tb;if("SPOT"==L.type||"POINT"==L.type)B=Math.cos(L.jn/2);"SPOT"==L.type&&(n=L.bt*(1-B));v.Rb.push(["LAMP_TYPE",L.type],["LAMP_SPOT_SIZE",da.O(B||.01)],["LAMP_SPOT_BLEND",da.O(n||.01)],["LAMP_LIGHT_DIST",da.O(L.distance)],["LAMP_USE_SPHERE",L.EE?1:
0])}}if(h){d=0;for(var p in h)d++;a.xo=new Float32Array(3*d);a.es=new Float32Array(3*d);a.ds=new Float32Array(3*d);da.ha(e,"NUM_LAMP_LIGHTS",d);for(u=0;u<b.length;u++)k(a,b[u])}}}function k(a,b){if(b.Ej in a.Im){var d=a.Im[b.Ej];a.xo.set(N.G(b.k.n),3*d);a.es.set(b.tb.direction,3*d);a.ds.set(b.tb.Xq,3*d)}}function J(a,b){var d=a.Yj;-1==d.indexOf(b)&&d.push(b);a.Yj=d.sort()}function y(a,b,d){da.ha(a.hb,b,d)}function d(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.vb?a.Ca=ea.YM(b,ea.An,[]):(0<b.ib.length&&
ea.b_(b,b.aa[0]),a.Uf=b);else{var d=a.Th;a.Mv&&"PARTICLES"!=a.type&&(b=ea.yU(b));a.ky&&(b=S.ZU(a.ly,a.my,a.jy));d=ea.YM(b,d,a.Zc);a.Ca=d;a.gg||a.wf||a.Oe||(d.oe=null,d.tc.length=0);d=b.aa.length;a.rs=b.Ja*d;var c;a:switch(a.Th){case ea.An:case ea.Np:case ea.Et:c=!0;break a;default:c=!1}c?ea.yW(b)?a.Pm=b.ma.length/3*d:a.Pm=b.Ja/3*d:a.Pm=0}}function B(a,b,d,c,e,h,f,v,x,k,m,B){var n=a.nb,G=[],p=v.b4w_dynamic_grass;if(!k&&p)return G;for(var l="INSTANCE"==v.b4w_wind_bend_inheritance,K="INSTANCE"==v.b4w_shadow_inheritance,
Q="INSTANCE"==v.b4w_reflection_inheritance,g=[],S=[],ca=0;ca<e.length;ca++){var V=e[ca].nb.k,P=ta.rA(b);P.Og=v.b4w_hair_billboard;P.Cq=v.b4w_hair_billboard_type;P.Bq="SPHERICAL"==v.b4w_hair_billboard_geometry;P.gd=p;P.Dm=!0;l?(P.vf=V.vf,P.xn=V.xn,P.Ch=V.Ch,P.Xg=V.Xg,P.dj=V.dj,P.Wg=V.Wg,P.Rg=V.Rg,P.Bh=V.Bh,P.De=V.De,P.Jl=!1):(P.vf=n.k.vf,P.xn=n.k.xn,P.Ch=n.k.Ch,P.Xg=n.k.Xg,P.dj=n.k.dj,P.Wg=n.k.Wg,P.Rg=n.k.Rg,P.Bh=n.k.Bh,P.De=n.k.De,P.Jl=!0);K?(P.Ke=V.Ke,P.te=V.te,P.ie=V.ie):(P.Ke=n.k.Ke,P.te=n.k.te,
P.ie=n.k.ie);Q?(P.ge=V.ge,P.Id=V.Id,P.Hd=V.Hd,P.Td=V.Td,P.Fd=V.Fd,P.th=V.th):(P.ge=n.k.ge,P.Id=n.k.Id,P.Hd=n.k.Hd,P.Td=n.k.Td,P.Fd=n.k.Fd,P.th=n.k.th);g.push(P);var Z=f[ca];Z||(Z=new Float32Array);B&&L.$v(x.seed,m);var T=new Float32Array(3),da=new Float32Array([0,0,0,1]),J=[],ka=za.hH(ia.qC)&&!v.b4w_initial_rand_rotation&&!v.b4w_hair_billboard,z=4;ka&&(z=8);for(var r=0;r<Z.length;r+=z){T[0]=Z[r];T[1]=Z[r+1];T[2]=Z[r+2];var t=Z[r+3]*N.$d(V.n);if(v.b4w_initial_rand_rotation){switch(v.b4w_rotation_type){case "XYZ":var W=
new Float32Array([L.zg(m),L.zg(m),L.zg(m)]);Aa.normalize(W,W);break;case "Z":W=new Float32Array([0,0,1]);break;default:L.q("Unsupported random rotation type: "+v.b4w_rotation_type)}ga.setAxisAngle(W,v.b4w_rand_rotation_strength*(2*Math.PI*L.zg(m)-Math.PI),da)}else ka&&(da.set(Z.subarray(r+4,r+8)),L.fD(da,da),v.use_whole_group||(v.use_rotation_dupli?ga.multiply(da,N.R(V.n),da):ga.multiply(da,Oa,da)));var ya=N.oi(T,t,da,N.create());J.push(ya)}S.push(J)}for(var X={},I=0,ca=0;ca<e.length;ca++)for(var Y=
e[ca].data.materials,r=0;r<Y.length;r++)Y[r].name in X?X[Y[r].name]++:(X[Y[r].name]=1,I++);for(var I=I?I:1,pa={},ca=0;ca<e.length;ca++){var A=e[ca],M=h[ca],P=g[ca],E={};P.vf&&(E.au_wind_bending_amp=[P.Bh],E.au_wind_bending_freq=[P.Ch],E.au_detail_bending_freq=[P.Xg],E.au_detail_bending_amp=[P.Wg],E.au_branch_bending_amp=[P.Rg],P.Bh=0,P.Ch=0,P.Xg=0,P.Wg=0,P.Rg=0);J=S[ca];if(J.length){for(var ua=A.data,Y=ua.materials,oa=Array(Y.length),la=Array(Y.length),r=0;r<Y.length;r++)if(!ea.LJ(ua,r))for(var xb=
0;xb<M.length;xb++){var Va=M[xb],qa=q(Va),F=Y[r];"MAIN"==Va?oa[r]=qa:"DEBUG_VIEW"==Va&&(la[r]=qa);qa.Sq=a.b4w_cluster_data.cluster_id;if(u(qa,F)){"SHADOW"==Va&&oa[r]&&(qa.Ne=oa[r].Ne);qa.Th=ea.An;C(qa,P);qa.Dk=v.uuid;qa.ck=a.b4w_do_not_cull||v.b4w_dynamic_grass;"MAIN"==qa.type&&(qa.Sg=a.b4w_caustics);y(qa,"DISABLE_FOG",("COLOR_ID"!=Va&&"SHADOW"!=Va&&a.b4w_disable_fogging)|0);"JITTERED"==v.b4w_hair_billboard_type&&(qa.jw=v.b4w_hair_billboard_jitter_amp,qa.kw=v.b4w_hair_billboard_jitter_freq);p&&(qa.Hv=
v.b4w_dynamic_grass_scale_threshold);l||(delete qa.Zc.a_bending_col_main,delete qa.Zc.a_bending_col_detail);var Ca=ea.pB(ua,r,qa.Yj,b.Ji,qa.Zc,qa.Fj),w=n.k.n,O=!0;if(1<X[F.name]){var ma=0,xa;for(xa in Ca.aa)ma++;O=Ca.ma.length*J.length*ma*X[F.name]>2E5*I}var H=ia.cG&&O&&"PHYSICS"!=qa.type;if(H){qa.VJ=v.use_whole_group?2:1;var D=L.T(Ca);ea.PG(Ca,D,J);D.Of={vp:J,Lx:w,QM:"STATIC"==b.type,et:E,Vm:{},dv:p};if(P.vf&&P.Jl){var va=Aa.fromValues(0,0,0);N.Wc(va,n.k.n,va);for(var Ea=[],na=0;na<J.length;na++)Ea.push(va[0],
va[1],va[2]);D.Of.Vm.a_emitter_center={Ic:3,data:Ea}}ea.PG(Ca,Ca,J);"STATIC"==b.type&&ea.ER(D.Vf,w)}else{var wa=D=ea.jX(Ca,E,J),Qa=J;wa.qa.au_center_pos=new Float32Array(3*wa.Ja);for(var Ja=Qa.length,Ma=wa.Ja/Ja,Zb=0;Zb<Ja;Zb++)for(var mc=Qa[Zb],Qb=3*Ma*Zb,Pb=0;Pb<Ma;Pb++)wa.qa.au_center_pos[Qb+3*Pb]=mc[0],wa.qa.au_center_pos[Qb+3*Pb+1]=mc[1],wa.qa.au_center_pos[Qb+3*Pb+2]=mc[2];D=wa;if(P.vf&&P.Jl){var nc=D,Hc=n.k.n;nc.qa.a_emitter_center=new Float32Array(3*nc.Ja);var Ib=Aa.fromValues(0,0,0);N.Wc(Ib,
Hc,Ib);for(var oc=0;oc<nc.Ja;oc++)nc.qa.a_emitter_center[3*oc]=Ib[0],nc.qa.a_emitter_center[3*oc+1]=Ib[1],nc.qa.a_emitter_center[3*oc+2]=Ib[2];D=nc}}var sb=v.b4w_vcol_from_name,db=v.b4w_vcol_to_name,cc=qa,Zc=d,Cb=!l,Rb=ua,gb=[];if(""!==sb&&""!==db){var ob,Ic=db,pc=cc.Zc,Jc=[],Jb=void 0;for(Jb in pc)for(var qc=pc[Jb].src,dc=0,Ya=0;Ya<qc.length;Ya++){var ec=qc[Ya].pg;Ic==qc[Ya].name&&Jc.push(Jb,ec,dc);dc+=L.Zm(ec)}ob=Jc;if(0<ob.length)for(var Kb=0;Kb<ob.length;Kb+=3)gb.push({vr:sb,fv:7,Qw:ob[Kb],Rw:ob[Kb+
1],cv:ob[Kb+2]});else ea.WV(cc.Yj,"a_color")&&db==Rb.active_vcol_name&&gb.push({vr:sb,fv:7,Qw:"a_color",Rw:7,cv:0})}Cb&&("a_bending_col_main"in Zc&&gb.push({vr:"a_bending_col_main",fv:4,Qw:"a_bending_col_main",Rw:4,cv:0}),"a_bending_col_detail"in Zc&&gb.push({vr:"a_bending_col_detail",fv:7,Qw:"a_bending_col_detail",Rw:7,cv:0}));for(var tb=D,rc=J,ub=c,Lb=gb,Sb=qa.Zc,yc=H,Kc=!1,Ga=0;Ga<Lb.length;Ga++){var hc=Lb[Ga].vr,Db=ub.qa[hc];if(Db&&0<Db.length){Kc=!0;break}}if(yc)var Eb=tb.Of.Vm;if(Kc){var Fc,
Tb=n.k.S,jb=ub.aa[0].a_position,hb=rc,Ha=pa,$b=new Float32Array(3),Fb=new Float32Array(3),La=new Uint32Array(hb.length);if(!("verts_indices"in Ha)){Ha.Ki=new Float32Array(3);Ha.Ii=new Float32Array(3);Ha.IE=new Uint32Array(jb.length/3);Ha.ss=new Uint32Array(jb.length/3);Ha.Ki[0]=(Tb.max_x-Tb.min_x)/20;Ha.Ki[1]=(Tb.max_y-Tb.min_y)/20;Ha.Ki[2]=(Tb.max_z-Tb.min_z)/20;Ha.Ii[0]=Tb.min_x;Ha.Ii[1]=Tb.min_y;Ha.Ii[2]=Tb.min_z;for(var Na=0;Na<jb.length/3;Na++){var mb=L.trunc((jb[3*Na]-Ha.Ii[0])/Ha.Ki[0]),Pc=
L.trunc((jb[3*Na+1]-Ha.Ii[1])/Ha.Ki[1]),Lc=L.trunc((jb[3*Na+2]-Ha.Ii[2])/Ha.Ki[2]),mb=L.V(mb,0,19),Pc=L.V(Pc,0,19),Lc=L.V(Lc,0,19);Ha.IE[Na]=Na;Ha.ss[Na]=Lc*Math.pow(20,2)+20*Pc+mb}ea.LZ(Ha.ss,Ha.IE,ea.Az,!0);Ha.sn=new Uint32Array(Math.pow(20,3));for(Na=0;Na<Ha.ss.length;Na++)Ha.sn[Ha.ss[Na]]++;delete Ha.ss;for(Na=1;Na<Ha.sn.length;Na++)Ha.sn[Na]+=Ha.sn[Na-1]}for(var vb=0;vb<hb.length;vb++){$b[0]=hb[vb][0];$b[1]=hb[vb][1];$b[2]=hb[vb][2];for(var Gc=1E10,Ub=-1,fc=L.trunc(($b[0]-Ha.Ii[0])/Ha.Ki[0]),
gd=L.trunc(($b[1]-Ha.Ii[1])/Ha.Ki[1]),$c=L.trunc(($b[2]-Ha.Ii[2])/Ha.Ki[2]),fc=L.V(fc,0,19),gd=L.V(gd,0,19),$c=L.V($c,0,19),Sc=$c*Math.pow(20,2)+20*gd+fc,ad=Ha.sn[Sc],yb=0==Sc?0:Ha.sn[Sc-1];yb<ad;yb++){var zb=Ha.IE[yb];Fb[0]=jb[3*zb];Fb[1]=jb[3*zb+1];Fb[2]=jb[3*zb+2];Aa.sub(Fb,$b,Fb);var zc=Aa.sqrLen(Fb);zc<=Gc&&(Gc=zc,Ub=zb)}if(-1==Ub)for(yb=0;yb<jb.length/3;yb++)Fb[0]=jb[3*yb],Fb[1]=jb[3*yb+1],Fb[2]=jb[3*yb+2],Aa.sub(Fb,$b,Fb),zc=Aa.sqrLen(Fb),zc<=Gc&&(Gc=zc,Ub=yb);La[vb]=Ub}Fc=La;for(var hd=tb.Ja/
rc.length,Ga=0;Ga<Lb.length;Ga++){var Wa=Lb[Ga].Qw,Za=Lb[Ga].Rw,hc=Lb[Ga].vr,Tc=Lb[Ga].fv,Db=ub.qa[hc];switch(Wa){case "a_bending_col_main":var ic=1;break;case "a_bending_col_detail":ic=3;break;case "a_color":ic=3;break;default:for(var Mb=ic=0;Mb<Sb[Wa].src.length;Mb++)ic+=L.Zm(Sb[Wa].src[Mb].pg)}if(Db&&0<Db.length){var Ac=L.Zm(Tc),jd=L.Zm(Za),Uc=Tc&Za,Bc=L.CL(Uc);Uc!=Za&&ha.error("Wrong color extraction from "+hc+" to "+Wa+".");if(yc)for(Eb[Wa]={Ic:ic,data:[]},Mb=0;Mb<rc.length;Mb++)for(sc=Fc[Mb],
Mc=sc*Ac,Vb=0;Vb<Bc.length;Vb++)Bc[Vb]&&(Nc=L.To(Tc,Vb),Eb[Wa].data.push(Db[Mc+Nc]));else{if("a_bending_col_main"==Wa||"a_bending_col_detail"==Wa)tb.qa[Wa]=new Float32Array(tb.Ja*jd);for(Mb=0;Mb<rc.length;Mb++){var sc=Fc[Mb],Mc=sc*Ac,Vc=Mb*hd*ic;if(-1!=sc)for(var jc=0;jc<hd;jc++)for(var tc=jc*ic,Vb=0;Vb<Bc.length;Vb++)if(Bc[Vb]){var Nc=L.To(Tc,Vb);tb.qa[Wa][Vc+tc+(Lb[Ga].cv+L.To(Za,Vb))]=Db[Mc+Nc]}}}}else tb.qa[Wa]=new Float32Array(0)}}D=tb;y(qa,"USE_INSTANCED_PARTCLS",D.Of?1:0);ba(qa);G.push({za:qa,
kf:b,wu:P,Uf:D,qg:[F.name],Jd:[a]})}}for(r=0;r<la.length;r++)la[r]&&(la[r].Wn=oa[r].id,ba(la[r]))}}return G}function u(a,b){var d=!0;"NODES_GLOW"==a.type&&(d=V.fH(b));return d=d&&r(a,b)}function ba(a){K(a,function(a){a.id=0;a.id=L.TR(a)})}function K(a,b){for(var d=null,c=null,e=[],h=0;h<a.ya.length;h++){var u=a.ya[h],f=u.cg;f&&(d||(d={}),d[h]=f,u.cg=null);if(f=u.Sa)c||(c={}),c[h]=f,u.Sa=null;e.push(u.Ck);u.Ck=0}var u=a.S,f=a.ba,v=a.wa,L=a.Ta,x=a.pb,k=a.kb;a.S=null;a.ba=null;a.wa=null;a.Ta=null;a.pb=
null;a.kb=null;var m=a.Pe;a.Pe=null;b(a);a.Pe=m;a.S=u;a.ba=f;a.wa=v;a.Ta=L;a.pb=x;a.kb=k;if(d)for(h in d)a.ya[h].cg=d[h];if(c)for(h in c)a.ya[h].Sa=c[h];for(h=0;h<a.ya.length;h++)a.ya[h].Ck=e[h]}function G(a,b,c,e){var h=q("DEBUG_VIEW");T(h,"debug_view.glslv","debug_view.glslf");h.Ri=!0;h.Ua=!0;h.Dk=b;h.Xu=c;C(h,a);ba(h);if(e.Yf){c?(c=e.ba,N.of(e.ba.F,wa)):(c=e.pb,N.of(c.F,wa));var u=Aa.create();a=S.rv(1,u);b=Aa.fromValues(Aa.length(c.Ga),Aa.length(c.Ha),Aa.length(c.Ia));ea.HL(a,b,u);var u=Aa.normalize(c.Ga,
Ca),f=Aa.normalize(c.Ha,qa);c=Aa.normalize(c.Ia,ma);!b[0]&&b[1]&&b[2]?Aa.cross(f,c,u):!b[1]&&b[0]&&b[2]?Aa.cross(c,u,f):!b[2]&&b[0]&&b[1]&&Aa.cross(u,f,c);b=L.kU(u,f,c,Qa);Y.invert(b,b);b=ga.fromMat3(b,Ea);N.Wk(b,wa);N.Sf(1,wa);ea.Nx(a,wa)}else c?(b=e.wa,a=S.rv(b.Xa,b.F)):(b=e.kb,a=S.rv(b.Xa,Aa.create()),N.identity(wa),N.of(b.F,wa),ea.Nx(a,wa));h.S=Q.Ql(e.S);h.ba=Q.Qq(e.ba);h.wa=Q.Rl(e.wa);h.Ta=Q.Ql(e.Ta);h.pb=Q.Qq(e.pb);h.kb=Q.Rl(e.kb);ea.Ox(a,1,!0);a.qa.a_polyindex=ea.iv(a);d(h,a);return h}function T(a,
b,d){a.hb.Eg=b;a.hb.bf=d;da.SY(a.hb)}function P(a,b,d,c){c=c||"";-1==a.Md.indexOf(d)&&(a.ya.push(b),a.Md.push(d),a.Qg.push(c),pa.Yv(b));a.zb&&ua.sG(a)}function X(a){a.hb||L.q("No shaders info for batch "+a.name);a.zb=da.nV(a.hb);var b=a.hb;if(b.status===da.Cz){var d=a.zb.attributes,c=a.Ca.jd,e;for(e in d)c[e]||L.q('missing data for "'+e+'" attribute')}b.status&da.wO&&ha.error("Texture limit exceeded for shader - "+b.bf+', materials: "'+a.td.join(", ")+'". Maximum texture count: '+va.xC+", actual texture count: "+
b.jN);b.status&da.vO&&ha.error("Fragment uniform limit exceeded for shader - "+b.bf+', materials: "'+a.td.join(", ")+'". Maximum fragment uniform count: '+va.tw+", actual fragment uniform count: "+b.PU);b.status&da.zO&&ha.error("Vertex uniform limit exceeded for shader - "+b.Eg+', materials: "'+a.td.join(", ")+'". Maximum vertex uniform count: '+va.ms+", actual vertex uniform count: "+b.u0);b.status&da.yO&&ha.error("Vertex attribute limit exceeded for shader - "+b.Eg+', materials: "'+a.td.join(", ")+
'". Maximum attribute count: '+va.yC+", actual attribute count: "+b.tG);b.status&da.xO&&("MAIN"!=a.type||a.nk||ha.error("Varying limit exceeded for shader - "+a.hb.bf+', materials: "'+a.td.join(", ")+'"'),"MAIN"==a.type&&a.nk||"NODES_GLOW"==a.type)&&(c=d=0,a.Fj&&(d=L.Kr(a.Fj)),a.Zc&&(c=L.Kr(a.Zc)),ha.error("Varying limit exceeded for node shader - "+a.hb.bf+", uv: "+d+", vc: "+c+', materials: "'+a.td.join(", ")+'"'));b.status&da.qO&&ha.error("Shader compilation/linking error: "+b.Eg+", "+b.bf+', materials: "'+
a.td.join(", ")+'"');return a.hb.status===da.Cz?(ua.oR(a.zb),ua.kR(a),ua.sG(a),!0):!1}function x(a,b,d){a=a.I[0].X;for(var c=0;c<a.length;c++)if(a[c].type==d&&!a[c].kg&&-1!=a[c].td.indexOf(b))return a[c];return null}function ka(a,b,d){a=a.I[0].X;for(var c=0;c<a.length;c++)if(a[c].type==d&&a[c].kg&&-1!=a[c].td.indexOf(b))return a[c];return null}function ca(a,b){a.fg.set(b.fg);a.bm=b.bm;a.gn.set(b.gn);a.fp=b.fp;a.$k.set(b.$k);a.ek=b.ek;a.Nj=b.Nj;a.am=b.am;a.Cl=b.Cl;a.Qo=b.Qo;a.Vi.set(b.Vi);a.Io=b.Io;
a.Xo.set(b.Xo);a.Yo=b.Yo;a.Zo.set(b.Zo);a.$o=b.$o;a.ho=b.ho;a.Gp=b.Gp}var Q=g("__boundings"),W=g("__config"),ha=g("__print"),v=g("__extensions"),Z=g("__graph"),Y=g("__mat3"),V=g("__nodemat"),ta=g("__obj_util"),oa=g("__particles"),S=g("__primitives"),ga=g("__quat"),za=g("__reformer"),ua=g("__renderer"),la=g("__scenegraph"),da=g("__shaders"),ya=g("__subscene"),pa=g("__textures"),N=g("__tsr"),ea=g("__geometry"),L=g("__util"),Aa=g("__vec3"),xa=g("__vec4"),ia=W.B,va=W.Mi,na=W.Vo,Oa=new Float32Array([0,
0,-Math.sqrt(.5),Math.sqrt(.5)]),Ca=new Float32Array(3),qa=new Float32Array(3),ma=new Float32Array(3),Ea=new Float32Array(4),wa=N.create(),Qa=Y.create();a.L0=Ja;var Ja="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Ma={};a.tR=function(a){return Ma[a]||null};a.uR=function(a,b){Ma[a]=b};a.hV=function(a,c,e,u){var f;f=a.s.Wa;for(var v=[],x=0;x<c.length;x++){var k=c[x],m=k.nb,n=m.k;if(!m.Yr){var B=ta.Ra(m),m=m.k,p=k.data.b4w_boundings,l=p.bs_rad,K=p.bs_cen,g=p.bc_rad,
S=p.caxis_x,P=p.caxis_y,ca=p.caxis_z,V=p.be_ax,Z=p.be_cen,T=p.rbb.rbb_c,da=p.rbb.rbb_s,p=Q.Ql(m.Il);m.Og&&(l=Math.max(Math.abs(p.max_x),Math.abs(p.min_x)),K=Math.max(Math.abs(p.max_y),Math.abs(p.min_y)),da=Math.max(Math.abs(p.max_z),Math.abs(p.min_z)),da=Math.sqrt(l*l+K*K+da*da),g=Math.sqrt(l*l+K*K),p.max_x=p.max_y=p.max_z=da,p.min_x=p.min_y=p.min_z=-da,l=da,K=[0,0,0],S=[1,0,0],P=[0,1,0],ca=[0,0,1],V=[da,da,da],Z=[0,0,0],T=[0,0,0],da=[da,da,da]);Q.Rn(p,m.S);Q.Nl(m.S,m.n,m.Ta);m.wa=Q.cA(l,L.Hf(K));
Q.Eq(m.wa,m.n,m.kb);m.ba=B?Q.zq(S,P,ca,Z):Q.zq([1,0,0],[0,1,0],[0,0,1],Z);Aa.scale(m.ba.Ga,V[0],m.ba.Ga);Aa.scale(m.ba.Ha,V[1],m.ba.Ha);Aa.scale(m.ba.Ia,V[2],m.ba.Ia);Q.Dq(m.ba,m.n,m.pb);B?D(m,g,g,m.S):(m.Ad=Q.CY(T,S,P,ca,da),Q.$z(m.Ad,m.n,m.zG));v.push.apply(v,w(k,n,f))}}f=t(v);for(v=0;v<f.length;v++)if(x=f[v].za,x.td=f[v].qg,d(x,f[v].Uf),h(x,e,a),"STATIC"==f[v].k.type&&"COLOR_ID"!=x.type){if(k=L.gt("%meta%"+x.type+"%"+x.td.join("%")+"%"),B=ta.dr(k,"MESH"),ta.wX(B,f[v].k),ta.qq(B,a),ta.ou(B,a,x),
u.push(B),"MAIN"==x.type)for(n=0;n<f[v].Jd.length;n++)k=f[v].Jd[n].nb,k.ww.push(B)}else k=f[v].Jd[0].nb,ta.ou(k,a,x);if(ia.debug_view){for(v=0;v<f.length;v++)if(e=f[v].k,"DYNAMIC"==e.type&&(k=f[v].Jd[0].nb,x=f[v].za,"MAIN"==x.type)){n=ta.ja(k,a);B=n.X;m=!1;for(n=0;n<B.length;n++)B[n].Ri&&(m=!0);m||(e=G(e,k.name,!0,x),ta.ou(k,a,e))}for(v=0;v<u.length;v++)k=u[v],e=k.k,n=ta.ja(k,a),x=n.X[0],"MAIN"==x.type&&(e=G(e,k.name,!1,x),ta.ou(k,a,e));for(v=0;v<f.length;v++)x=f[v].za,"DEBUG_VIEW"==x.type&&(x.Wu=
v)}for(v=0;v<c.length;v++)for(n=ta.ja(c[v].nb,a),B=n.X,n=0;n<B.length;n++)b(B[n]);for(v=0;v<u.length;v++)for(n=ta.ja(u[v],a),B=n.X,n=0;n<B.length;n++)b(B[n])};a.VQ=function(a,e,h){var v=a.s.Ip,f=q("MAIN");T(f,"sky.glslv","sky.glslf");if(e.procedural_skydome)y(f,"PROCEDURAL_SKYDOME",1),f.bv=!0;else{var u=v.ep,x=la.ic(a.s.Wa,ya.Lg).p.wc;P(f,x,"u_sky");u&&(y(f,"WO_SKYTEX",1),u.invert&&y(f,"MTEX_NEGATIVE",1),u.PN&&y(f,"MTEX_RGBTOINT",1),y(f,"BLENDTYPE",u.JG),u.KN&&y(f,"WOMAP_BLEND",1),u.LN&&y(f,"WOMAP_HORIZ",
1),u.NN&&y(f,"WOMAP_ZENUP",1),u.MN&&y(f,"WOMAP_ZENDOWN",1));v.pt&&y(f,"WO_SKYBLEND",1);v.qt&&y(f,"WO_SKYPAPER",1);v.rt&&y(f,"WO_SKYREAL",1)}e.ge&&(f.ge=!0,e.Id&&(f.Id=!0));f.vg=99999;J(f,"a_position");e=S.dV();d(f,e);b(f);h=ta.ja(h,a);f.ck=!0;f.ba=Q.Tg();f.pb=Q.Tg();f.S=Q.Sd();f.Ta=Q.Sd();f.wa=Q.Rh();f.kb=Q.Rh();ba(f);h.X.push(f);la.ic(a.s.Wa,ya.zf)&&(a=c(f),a.type="DEBUG_VIEW",a.vb="",I(a),y(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),e.qa.a_polyindex=ea.iv(e),d(a,e),a.Wn=f.id,ba(a),h.X.push(a))};a.EA=function(a,
b,d){d=ta.ja(a,d).X;var e=[];la.ic(b,ya.bd);var h=la.ic(b,ya.Pd),f=la.ic(b,ya.ld),v=la.ic(b,ya.Kg);b=la.ic(b,ya.xf);for(var u=0;u<d.length;u++){var x=d[u],k=null;"SHADOW"==x.type&&"RECEIVE"==x.vb&&x.Ke&&(k=c(x),k.vb="CAST");"MAIN"!=x.type&&"PARTICLES"!=x.type||!h&&!f||!x.ge||(k=c(x),k.vb="REFLECT",k.Nk=!1,k.wf&&(k.wf=!1,k.Ua=!1),k.gb=x.gb);"COLOR_ID"==x.type&&v&&a.k.Uc&&(b&&a.k.Rk?(k=c(x),k.vb="OUTLINE"):x.vb="OUTLINE");k&&(k.kg=!0,ba(k),e.push(k))}d.push.apply(d,e)};a.dZ=D;a.F0=function(a,b,d){b?
b=d*(b.max_z-b.min_z):(b=1,L.q("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(L.Cb(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.vR=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.F_=H;a.E_=h;a.$Y=k;a.rG=function(a,b){y(a,"CSM_SECTION1",0);y(a,"CSM_SECTION2",0);y(a,"CSM_SECTION3",0);y(a,"NUM_CAST_LAMPS",0);if(b){y(a,"NUM_CAST_LAMPS",b.jh.length);ia.rw&&y(a,"MAC_OS_SHADOW_HACK",1);for(var d=1;d<b.csm_num;d++)y(a,"CSM_SECTION"+
String(d),1);y(a,"SHADOW_TEX_RES",da.O(b.csm_resolution));y(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);y(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else y(a,"SHADOW_TEX_RES",0),y(a,"CSM_FADE_LAST_CASCADE",0),y(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.nf=y;a.yB=function(a,b){return da.sV(a.hb,b)};a.C_=d;a.D_=ba;a.ru=T;a.Qj=P;a.uY=function(a,b,d){d=a.Md.indexOf(d);-1<d&&(a.ya[d]=b)};a.iT=function(a,b){var c=q("MAIN");c.Lb=!0;xa.set(b[0],b[1],b[2],.5,c.fg);c.Th=ea.Np;d(c,a);T(c,
"main.glslv","main_stack.glslf");y(c,"SHADELESS",1);X(c);return c};a.Xc=X;a.gV=function(a,c){for(var e=0;e<c.length;e++){var h=c[e].nb,f=q("LINE");T(f,"line.glslv","line.glslf");f.Lb=!0;f.ck=!0;var v=S.fV();d(f,v);b(f);f.S=Q.Sd();f.Ta=Q.Sd();f.ba=Q.Tg();f.pb=Q.Tg();f.kb=Q.Rh();f.wa=Q.Rh();ta.qq(h,a);ta.ja(h,a).X.push(f);X(f)}};a.dS=function(a){return a.zb.xs.length?a.zb.YC.u_cube_fog?!0:!1:!1};a.TS=function(){var a=q("DEPTH_PACK");a.$b=!0;a.Ua=!1;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv",
"postprocessing/depth_pack.glslf");X(a);return a};a.LA=function(a){var b=q("POSTPROCESSING");T(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":y(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":y(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":y(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":y(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":y(b,
"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":y(b,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":y(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":y(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:L.q("Wrong postprocessing effect: "+a)}b.$b=!0;b.Ua=!1;a=S.Sc();d(b,a);X(b);return b};a.lT=function(a){var b=q("SSAO");b.Ua=!1;b.$b=!0;var c=S.Sc();d(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");
y(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.PM);y(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=pa.Yl(pa.Hh,!1);c.source="NODE_TEX";pa.it(c,a,0);P(b,c,"u_ssao_special_tex");X(b);return b};a.mT=function(a){var b=q("SSAO_BLUR");b.Ua=!1;b.$b=!0;var c=S.Sc();d(b,c);T(b,
"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");y(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);X(b);return b};a.QS=function(a){var b=q("COC");b.Ua=!1;b.$b=!0;var c=S.Sc();d(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");y(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":y(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":y(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":y(b,"COC_TYPE","COC_COMBINE")}X(b);return b};a.US=function(a){var b=q("DOF");
b.Ua=!1;b.$b=!0;var c=S.Sc();d(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");a.p.dof_bokeh?y(b,"DOF_TYPE","DOF_BOKEH"):(y(b,"DOF_TYPE","DOF_SIMPLE"),y(b,"DEPTH_RGBA",1));X(b);return b};a.cT=function(){var a=q("OUTLINE");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");X(a);return a};a.WS=function(){var a=q("GLOW_COMBINE");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");
X(a);return a};a.XS=function(a,b,c){var e=q("GOD_RAYS");e.Ua=!1;e.$b=!0;var h=S.YU();d(e,h);T(e,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");y(e,"DEPTH_RGBA",a?1:0);y(e,"WATER_EFFECTS",b?1:0);y(e,"STEPS_PER_PASS",da.O(c,1));X(e);return e};a.YS=function(){var a=q("GOD_RAYS_COM");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");y(a,"SAFARI_CANVAS_ALPHA_HACK",ia.FL?1:0);X(a);return a};a.SS=function(a,b){var c=q("SKY");
c.Ua=!1;c.$b=!0;var e=S.$U();d(c,e);if(b.procedural_skydome)T(c,"skybox.glslv","proc_skybox.glslf"),y(c,"WATER_EFFECTS",1);else{T(c,"skybox.glslv","tex_skybox.glslf");if(a){e=a.s.Ip;if(e.Hx){var h=e.Hx.texture,f=pa.le(e.Hx);P(c,f,"u_sky_texture",h.name)}e.ep&&y(c,"WO_SKYTEX",1)}b.DM&&y(c,"MTEX_NEGATIVE",1);b.IM&&y(c,"MTEX_RGBTOINT",1);y(c,"BLENDTYPE",b.CM);b.EM&&y(c,"WOMAP_BLEND",1);b.FM&&y(c,"WOMAP_HORIZ",1);b.HM&&y(c,"WOMAP_ZENUP",1);b.GM&&y(c,"WOMAP_ZENDOWN",1);b.pt&&y(c,"WO_SKYBLEND",1);b.qt&&
y(c,"WO_SKYPAPER",1);b.rt&&y(c,"WO_SKYREAL",1)}c.ba=Q.Tg();c.pb=Q.Tg();c.S=Q.Sd();c.Ta=Q.Sd();c.wa=Q.Rh();c.kb=Q.Rh();X(c);return c};a.NQ=function(a,b){var d=la.ic(a.s.Wa,ya.Lg);d&&(d=d.Qa[0].sa[0].za,ta.ja(b,a).X.push(d))};a.LS=function(a){var b=q("ANTIALIASING");b.Ua=!1;b.$b=!0;var c=S.Sc();d(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ia.nL?(y(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),y(b,"AA_QUALITY",a.uI)):y(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");X(b);return b};
a.jT=function(a){var b=q("SMAA"),c=S.Sc();d(b,c);T(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");y(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");y(b,"SMAA_PASS",a);y(b,"SMAA_PREDICATION",0);y(b,"SMAA_REPROJECTION",0);X(b);b.Ua=!1;b.$b=!0;return b};a.RS=function(){var a=q("COMPOSITING");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");X(a);return a};a.bT=function(){var a=q("MOTION_BLUR");a.$b=!0;a.Ua=!1;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv",
"postprocessing/motion_blur.glslf");X(a);return a};a.nT=function(a){var b=q("STEREO");b.$b=!0;b.Ua=!1;var c=S.Sc();d(b,c);T(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");y(b,"ANAGLYPH","ANAGLYPH"===a?1:0);X(b);return b};a.ZS=function(){var a=q("LUMINANCE");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");X(a);return a};a.MS=function(){var a=q("LUMINANCE");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv",
"postprocessing/luminance_av.glslf");X(a);return a};a.$S=function(){var a=q("LUMINANCE_X_BLUR");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");X(a);return a};a.OS=function(){var a=q("POSTPROCESSING");a.$b=!0;a.Ua=!1;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");X(a);return a};a.PS=function(){var a=q("BLOOM");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv",
"postprocessing/bloom_combine.glslf");X(a);return a};a.LT=function(){var a=q("VELOCITY");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");X(a);return a};a.KS=function(){var a=q("ANCHOR_VISIBILITY");a.Ua=!0;a.$b=!0;a.Th=ea.Np;T(a,"anchors.glslv","anchors.glslf");var b=S.AI(1);d(a,b);y(a,"ANCHOR_NUM",1);X(a);a.Dl=new Float32Array(3);return a};a.dT=function(){var a=q("PERFORMANCE");a.Ua=!1;a.$b=!0;var b=S.Sc();d(a,b);T(a,"postprocessing/postprocessing.glslv",
"postprocessing/performance.glslf");X(a);return a};a.B_=function(a,b){var c=b.length/3;if(c!=a.Dl.length/3){var e=S.AI(c);d(a,e);y(a,"ANCHOR_NUM",c);X(a)}a.Dl=b};a.G5=function(a){if(!a.I.length)return null;a=a.I[0];return a.X.length?a.X[0]:null};a.HU=x;a.T4=ka;a.k9=ca;a.t3=function(a,b){for(var d=a.I[0].X,c=0;c<d.length;c++)if(d[c].type==b)return!0;return!1};a.nH=function(a){for(var b=a.ya,d=0;d<b.length;d++)pa.kD(b[d]);a.Ca.dg&&ea.yS(a.Ca);a.dg&&a.Pe.length&&ua.BS(a);a.zb.dg&&da.AS(a.zb);a.Bk&&(b=
V.eJ(a.Bk))&&b.mH&&V.zS(a.Bk)};a.fW=function(a,b,d,c){for(var e=["MAIN","SHADOW","COLOR_ID"],h=!1,f=0;f<e.length;f++){var v=e[f],u=x(a,b,v),k=x(d,c,v);if(u&&k){var h=!0,L=ka(d,c,v);"MAIN"==v&&(ca(k,u),L&&ca(L,u));for(v=0;v<k.Md.length;v++){var m=k.Md[v];if(-1!==Ja.indexOf(m)){var n=u.Md.indexOf(m);-1!==n&&(n=u.ya[n],pa.kD(k.ya[v]),k.ya[v]=n,pa.Yv(n),L&&(m=L.Md.indexOf(m),-1!==m&&(pa.kD(L.ya[m]),L.ya[m]=n,pa.Yv(n))))}}}}h||ha.error("Wrong objects for inheriting material!")};a.gZ=function(a,b,d,c){for(var e=
0;e<a.I.length;e++)for(var h=a.I[e].X,f=0;f<h.length;f++){var v=h[f];-1!=v.td.indexOf(b)&&v.lj&&(v.lj[d]=c)}};a.fZ=function(a,b,d,c,e,h){for(var f=0;f<a.I.length;f++)for(var v=a.I[f].X,u=0;u<v.length;u++){var k=v[u];-1!=k.td.indexOf(b)&&k.He&&(k.He[3*d]=c,k.He[3*d+1]=e,k.He[3*d+2]=h)}};a.b6=function(a,b){return a.lj[b]};a.a6=function(a,b,d){d[0]=a.He[3*b];d[1]=a.He[3*b+1];d[2]=a.He[3*b+2];return d};a.fJ=function(a,b){var d;d=b[1];for(var c=2;c<b.length;c++)d+="%join%"+b[c];for(c=0;c<a.length;c+=2)if(a[c]==
d)return a[c+1];return null};a.ua=function(){Ma={}}};b4w.module.__boundings=function(a,g){function q(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(){return{F:new Float32Array(3),Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function w(a,b){for(var c=a[0],e=a[1],h=a[2],f=a[0],k=a[1],m=a[2],n=3;n<a.length;n+=3)var x=a[n],p=a[n+1],l=a[n+2],c=Math.max(c,x),e=Math.max(e,p),h=Math.max(h,l),
f=Math.min(f,x),k=Math.min(k,p),m=Math.min(m,l);b.max_x=c;b.max_y=e;b.max_z=h;b.min_x=f;b.min_y=k;b.min_z=m;return b}function t(a,b){b||(b=new Float32Array(24));var c=a.max_x,e=a.max_y,h=a.max_z,f=a.min_x,k=a.min_y,m=a.min_z;b[0]=f;b[1]=k;b[2]=m;b[3]=c;b[4]=k;b[5]=m;b[6]=c;b[7]=e;b[8]=m;b[9]=f;b[10]=e;b[11]=m;b[12]=f;b[13]=k;b[14]=h;b[15]=c;b[16]=k;b[17]=h;b[18]=c;b[19]=e;b[20]=h;b[21]=f;b[22]=e;b[23]=h;return b}function D(){return{F:new Float32Array(3),Xa:0}}function l(a,b){b.F[0]=a.F[0];b.F[1]=
a.F[1];b.F[2]=a.F[2];b.Xa=a.Xa}function r(){return{Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),F:new Float32Array(3)}}function p(a,b){E.copy(a.Ga,b.Ga);E.copy(a.Ha,b.Ha);E.copy(a.Ia,b.Ia);E.copy(a.F,b.F);return b}function m(a){var b=r();p(a,b);return b}function f(a,b,c,e){return{Ga:new Float32Array(a),Ha:new Float32Array(b),Ia:new Float32Array(c),F:new Float32Array([e[0],e[1],e[2]])}}function n(a,b){var c=F.UR(a,h),c=b?F.NR(a,c,J):A.identity(J),c=F.IU(c,k);E.copy(a,H);E.transformMat3(H,
c,H);for(var e=H[0],m=e,n=H[1],p=n,l=H[2],g=l,x=0,q=0,ca=0,Q=0,r=0,z=0,v=3;v<a.length;v+=3)H[0]=a[v],H[1]=a[v+1],H[2]=a[v+2],E.transformMat3(H,c,H),x=H[0],q=H[1],ca=H[2],x>e&&(e=x),x<m&&(m=x),q>n&&(n=q),q<p&&(p=q),ca>l&&(l=ca),ca<g&&(g=ca);n-=p;l-=g;e=Math.max(e-m,1E-9);n=Math.max(n,1E-9);l=Math.max(l,1E-9);m=A.identity(J);m[0]=0!=e?1/e:1E8;m[4]=0!=n?1/n:1E8;m[8]=0!=l?1/l:1E8;A.transpose(c,y);H[0]=a[0];H[1]=a[1];H[2]=a[2];E.transformMat3(H,c,H);E.transformMat3(H,m,H);E.transformMat3(H,y,H);x=H[0];
q=H[0];ca=H[1];Q=H[1];r=H[2];z=H[2];for(v=3;v<a.length;v+=3)H[0]=a[v],H[1]=a[v+1],H[2]=a[v+2],E.transformMat3(H,c,H),E.transformMat3(H,m,H),E.transformMat3(H,y,H),x=Math.max(x,H[0]),q=Math.min(q,H[0]),ca=Math.max(ca,H[1]),Q=Math.min(Q,H[1]),r=Math.max(r,H[2]),z=Math.min(z,H[2]);v=Math.sqrt((x-q)*(x-q)+(ca-Q)*(ca-Q)+(r-z)*(r-z))/2;v=Math.min(v,1);C[0]=(x+q)/2;C[1]=(ca+Q)/2;C[2]=(r+z)/2;x=C;m=A.identity(J);m[0]=e;m[4]=n;m[8]=l;E.transformMat3(x,c,x);E.transformMat3(x,m,x);E.transformMat3(x,y,x);m=[c[0],
c[3],c[6]];q=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];E.scale(m,e*v,m);E.scale(q,n*v,q);E.scale(c,l*v,c);return f(m,q,c,x)}function e(a,b,c){E.add(b,c,a.F);E.scale(a.F,.5,a.F);a.Xa=E.distance(a.F,b);return a}var z=g("__tsr"),M=g("__util"),E=g("__vec3"),F=g("__math"),A=g("__mat3"),O=new Float32Array(24),H=new Float32Array(3),I=new Float32Array(3),C=new Float32Array(3),h=new Float32Array(3),k=new Float32Array(9),J=new Float32Array(9),y=new Float32Array(9);new Float32Array(9);a.Sd=q;a.Pu=c;a.Rn=b;a.i3=function(){return{max_x:1E12,
min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.H0=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Ql=function(a){var c=q();b(a,c);return c};a.OR=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.kB=function(a,b){var c=a.max_y,e=a.max_z,h=a.min_x,f=a.min_y,k=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,e);a.min_x=Math.min(b.min_x,h);a.min_y=Math.min(b.min_y,
f);a.min_z=Math.min(b.min_z,k)};a.yG=w;a.Nl=function(a,b,c){c||(c=q());a=t(a,O);z.tp(a,b,a);return w(a,c)};a.kI=t;a.O9=function(a,b,c){c||(c=q());var e=b.min_x,h=b.max_x,f=b.min_y,k=b.max_y,m=b.min_z;b=b.max_z;if(e>=a.max_x||h<=a.min_x||f>=a.max_y||k<=a.min_y||m>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,e);c.max_x=Math.min(a.max_x,h);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,k);c.min_z=Math.max(a.min_z,m);
c.max_z=Math.min(a.max_z,b);return c};a.c$=function(a,b,c){c||(c=q());var e=a.max_x-a.min_x,h=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*e;c.max_x=a.max_x+.5*(b-1)*e;c.min_y=a.min_y-.5*(b-1)*h;c.max_y=a.max_y+.5*(b-1)*h;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.Eq=function(a,b,c){c||(c=D());z.Wc(a.F,b,c.F);b=z.$d(b);c.Xa=a.Xa*(0>b?-b:b);return c};a.Dq=function(a,b,c){c||(c=r());z.Wc(a.F,b,c.F);E.copy(a.Ga,c.Ga);E.copy(a.Ha,c.Ha);E.copy(a.Ia,c.Ia);z.xd(c.Ga,
b,c.Ga);z.xd(c.Ha,b,c.Ha);z.xd(c.Ia,b,c.Ia);return c};a.$z=function(a,b,e){e||(e=c());z.Wc(a.F,b,e.F);E.copy(a.Ga,e.Ga);E.copy(a.Ha,e.Ha);E.copy(a.Ia,e.Ia);z.xd(e.Ga,b,e.Ga);z.xd(e.Ha,b,e.Ha);z.xd(e.Ia,b,e.Ia);return e};a.cA=function(a,b){var c=D();E.copy(b,c.F);c.Xa=a;return c};a.CY=function(a,b,e,h,f){var k=c();E.copy(a,k.F);E.copy(b,k.Ga);E.copy(e,k.Ha);E.copy(h,k.Ia);E.scale(k.Ga,f[0],k.Ga);E.scale(k.Ha,f[1],k.Ha);E.scale(k.Ia,f[2],k.Ia);return k};a.Rh=D;a.zA=l;a.Tg=r;a.xA=p;a.Qq=m;a.Rl=function(a){var b=
D();l(a,b);return b};a.zq=f;a.xR=function(){var a;a||(a=D());E.set(0,0,0,a.F);a.Xa=1E12;return a};a.tU=function(a,b){var c=E.subtract(b.F,a.F,E.create());0==E.length(c)&&E.set(1,0,0,c);var e=E.normalize(c,E.create()),c=E.scale(e,a.Xa,E.create());E.add(c,a.F,c);var h=E.scale(e,-a.Xa,E.create());E.add(h,a.F,h);var f=E.scale(e,b.Xa,E.create());E.add(f,b.F,f);var k=E.scale(e,-b.Xa,E.create());E.add(k,b.F,k);c=[c,h,f,k];e=E.normalize(e,E.create());h=c[0];f=c[0];for(k=1;k<c.length;k++){var m=E.dot(c[k],
e);m<E.dot(h,e)&&(h=c[k]);m>E.dot(f,e)&&(f=c[k])}e=[h,f];c=e[0];e=e[1];a.F=E.scale(E.add(c,e,E.create()),.5,E.create());a.Xa=E.length(E.subtract(e,c,E.create()))/2};a.oB=function(a,b){E.add(a.F,a.Ha,H);E.add(H,a.Ga,H);E.add(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.add(a.F,a.Ha,H);E.add(H,a.Ga,H);E.subtract(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.add(a.F,a.Ha,H);E.subtract(H,a.Ga,H);E.add(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.add(a.F,a.Ha,H);E.subtract(H,a.Ga,H);E.subtract(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.subtract(a.F,
a.Ha,H);E.add(H,a.Ga,H);E.add(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.subtract(a.F,a.Ha,H);E.add(H,a.Ga,H);E.subtract(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.subtract(a.F,a.Ha,H);E.subtract(H,a.Ga,H);E.add(H,a.Ia,H);b.push(H[0],H[1],H[2]);E.subtract(a.F,a.Ha,H);E.subtract(H,a.Ga,H);E.subtract(H,a.Ia,H);b.push(H[0],H[1],H[2])};a.Nu=n;a.NS=function(a){var b=c();E.copy(a.Ga,b.Ga);E.copy(a.Ha,b.Ha);E.copy(a.Ia,b.Ia);E.copy(a.F,b.F);return b};a.br=function(a){var b=D(),c=0,c=E.length(a.Ga),e=E.length(a.Ha),h=E.length(a.Ia),
c=c>e?c:e;b.F=a.F;b.Xa=h>c?h:c;return b};a.LR=function(a,b){var c=m(a),e=z.jc(b,h);E.subtract(c.F,e,c.F);return c};a.cC=function(a,b){var c=E.length(a.Ga),e=E.length(a.Ha),h=E.length(a.Ia);return.75*b.Xa*b.Xa*b.Xa>c*e*h};a.AG=function(a,b){var c=b.max_z,e=b.min_z,h=Math.max(0,c-e-2*a);return{Xa:a,height:h,F:new Float32Array([0,0,(c+e)/2])}};a.CG=function(a,b){var c=b.max_z,e=b.min_z,h=Math.max(0,c-e);return{Xa:a,height:h,F:new Float32Array([0,0,(c+e)/2])}};a.BG=function(a,b){var c=b.max_z,e=b.min_z,
h=Math.max(0,c-e);return{Xa:a,height:h,F:new Float32Array([0,0,(c+e)/2])}};a.u3=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.iY=function(a){for(var b=0,c=0,e=0,h=0,f=0,k=0,m=0,p=0,x=0,l=0,g=0,Q=0,q=0,J=0,v=0;v<a.submeshes.length;v++){var Z=a.submeshes[v];if(Z.position.length){b=h=Z.position[0];c=f=Z.position[1];e=k=Z.position[2];break}}for(v=0;v<a.submeshes.length;v++){for(var Z=a.submeshes[v],r=Z.position,m=
l=Z.position[0],p=g=Z.position[1],x=Q=Z.position[2],V=0;V<r.length/3;V++)var z=r[3*V],y=r[3*V+1],S=r[3*V+2],b=Math.max(z,b),c=Math.max(y,c),e=Math.max(S,e),h=Math.min(z,h),f=Math.min(y,f),k=Math.min(S,k),m=Math.max(z,m),p=Math.max(y,p),x=Math.max(S,x),l=Math.min(z,l),g=Math.min(y,g),Q=Math.min(S,Q),q=Math.max(Math.sqrt(z*z+y*y+S*S),q),J=Math.max(Math.sqrt(z*z+y*y),J);r=Z.boundings.bb;r.max_x=m;r.min_x=l;r.max_y=p;r.min_y=g;r.max_z=x;r.min_z=Q;r=O;r[0]=l;r[1]=g;r[2]=Q;r[3]=m;r[4]=g;r[5]=Q;r[6]=m;r[7]=
p;r[8]=Q;r[9]=l;r[10]=p;r[11]=Q;r[12]=l;r[13]=g;r[14]=x;r[15]=m;r[16]=g;r[17]=x;r[18]=m;r[19]=p;r[20]=x;r[21]=l;r[22]=p;r[23]=x;m=n(r,!1);Z.boundings.be_cen=m.F;Z.boundings.be_ax=[m.Ga[0],m.Ha[1],m.Ia[2]]}v=a.b4w_boundings.bb;v.max_x=b;v.min_x=h;v.max_y=c;v.min_y=f;v.max_z=e;v.min_z=k;v=a.b4w_boundings.bb_src;v.max_x=b;v.min_x=h;v.max_y=c;v.min_y=f;v.max_z=e;v.min_z=k;a.b4w_boundings.bs_rad=q;a.b4w_boundings.bc_rad=J;r=O;r[0]=h;r[1]=f;r[2]=k;r[3]=b;r[4]=f;r[5]=k;r[6]=b;r[7]=c;r[8]=k;r[9]=h;r[10]=
c;r[11]=k;r[12]=h;r[13]=f;r[14]=e;r[15]=b;r[16]=f;r[17]=e;r[18]=b;r[19]=c;r[20]=e;r[21]=h;r[22]=c;r[23]=e;m=n(r,!1);a.b4w_boundings.be_cen=m.F;a.b4w_boundings.be_ax=[m.Ga[0],m.Ha[1],m.Ia[2]]};a.BV=function(a){var b=a.subarray(0,3),c=a.subarray(6,9),h=a.subarray(12,15),f=a.subarray(18,21);a=E.subtract(c,b,H);E.normalize(a,a);var k=M.LV(b,c,h,I),k=E.cross(k,a,k);E.normalize(k,k);var m=E.create(),n=E.create();E.subtract(c,b,C);n[0]=E.dot(C,a);n[1]=E.dot(C,k);c=E.create();E.subtract(h,b,C);c[0]=E.dot(C,
a);c[1]=E.dot(C,k);h=E.create();E.subtract(f,b,C);h[0]=E.dot(C,a);h[1]=E.dot(C,k);f=D();h=[m,n,c,h];m=e(f,h[0],h[1]);for(f=2;f<h.length;f++)if(E.distance(m.F,h[f])>m.Xa){for(var p=m,m=h,n=h[f],c=f-1,p=e(p,n,m[0]),x=1;x<=c;x++)if(E.distance(p.F,m[x])>p.Xa){for(var l=p,p=m,g=n,Q=m[x],r=x-1,l=e(l,g,Q),q=0;q<=r;q++)if(E.distance(l.F,p[q])>l.Xa){var v=g,Z=Q,J=p[q],V=E.subtract(Z,J,C),V=E.squaredLength(V),z=E.subtract(v,J,C),y=E.squaredLength(z),z=E.subtract(v,Z,C),S=E.squaredLength(z),z=V*(y+S-V),ga=y*
(S+V-y),V=S*(V+y-S),y=z+ga+V;E.copy(v,l.F);E.scale(l.F,z/y,l.F);E.scaleAndAdd(l.F,Z,ga/y,l.F);E.scaleAndAdd(l.F,J,V/y,l.F);l.Xa=E.distance(l.F,v)}p=l}m=p}f=m;a=E.scale(a,f.F[0],C);E.scaleAndAdd(a,k,f.F[1],a);E.add(a,b,f.F);return f}};b4w.module.__extensions=function(a,g){function q(a){if(a in l)return l[a];var b=D.getExtension(a)||null;l[a]=b;w.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in l)return l[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=D;break;case "EXT_disjoint_timer_query":(b=D.getExtension("EXT_disjoint_timer_query")||null)||(b=D.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}l[a]=b;w.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=g("__config"),w=g("__print"),t=b.B,D=null,l={};a.Tf=function(a){D=a};a.nJ=function(){return q("WEBGL_compressed_texture_s3tc")||q("WEBKIT_WEBGL_compressed_texture_s3tc")||q("MOZ_WEBGL_compressed_texture_s3tc")};a.jJ=function(){return q("WEBKIT_WEBGL_compressed_texture_pvrtc")||q("WEBGL_compressed_texture_pvrtc")};a.rV=function(){return t.gc?c("WEBGL_depth_texture"):q("WEBGL_depth_texture")||q("WEBKIT_WEBGL_depth_texture")||
q("MOZ_WEBGL_depth_texture")};a.II=function(){return q("EXT_texture_filter_anisotropic")||q("WEBKIT_EXT_texture_filter_anisotropic")||q("MOZ_EXT_texture_filter_anisotropic")};a.qV=function(){return q("WEBGL_debug_shaders")};a.Av=function(){return q("WEBGL_debug_renderer_info")};a.TI=function(){return t.gc?c("OES_element_index_uint"):q("OES_element_index_uint")};a.JB=function(){return t.gc?c("OES_standard_derivatives"):q("OES_standard_derivatives")};a.BB=function(){var a=t.gc?c("EXT_disjoint_timer_query"):
q("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},DI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},EI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},CI:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return D.createQuery()},beginQuery:function(b){D.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){D.endQuery(a.TIME_ELAPSED_EXT)},DI:function(a){return D.getQueryParameter(a,D.QUERY_RESULT_AVAILABLE)},EI:function(a){return D.getQueryParameter(a,D.QUERY_RESULT)},CI:function(){return a.GPU_DISJOINT_EXT}}};a.HV=function(){if(t.gc)return c("ANGLE_instanced_arrays");var a=q("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,c,f,n,e){a.drawElementsInstancedANGLE(b,c,f,n,e)},vertexAttribDivisor:function(b,c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,
c,f,n){a.drawArraysInstancedANGLE(b,c,f,n)}}};a.KB=function(){if(t.gc)return c("OES_vertex_array_object");var a=q("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.ua=function(){l={}};a.reset=function(){D=null}};b4w.module.__graph=function(a,g){function q(a,b,d){d||(d=null);c(a,b)?B.q("Graph already has node with given ID"):a.N.push(b,d)}function c(a,b){for(var c=a.N,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,d,e){e||(e=null);c(a,b)&&c(a,d)?a.Pa.push(b,d,e):B.q("Wrong node IDs")}function w(a,b){c(a,b)||B.q("Node not found");for(var d=a.N,e=0;e<d.length;e+=2)d[e]==b&&(d.splice(e,2),e-=2)}function t(a,b,c,d){k(a,b,c)||B.q("Edge not found");a=a.Pa;for(var e=0,h=0;h<a.length;h+=3)if(a[h]==
b&&a[h+1]==c){if(-1==d)a.splice(h,3);else{if(d==e){a.splice(h,3);break}e++}h-=3}}function D(a){a=a.N;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function l(a,b){for(var c=a.N,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function r(a){var b=[],c={};p(a,c);for(var d=a.N,e=0;e<d.length;e+=2)0==I(a,d[e])&&m(a,d[e],c,b);return{N:b,Pa:a.Pa.slice(0)}}function p(a,b){for(var c=a.N,d=0;d<c.length;d+=2)b[c[d]]=!1}function m(a,b,c,d){if(!c[b]){c[b]=!0;for(var e=0;e<H(a,b);e++)m(a,
C(a,b,e),c,d);d.unshift(b,O(a,b))}}function f(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var e=0;e<H(a,b);e++){var k=C(a,b,e);f(a,k,c,d)}if(20==d||30==d)for(e=0;e<I(a,b);e++)k=h(a,b,e),f(a,k,c,d)}}function n(a){for(var b=a.Pa,d=0;d<b.length;d+=3){var e=b[d+1];c(a,b[d])&&c(a,e)||(b.splice(d,3),d-=3)}}function e(a){for(var b=[],c=a.N,d=0;d<c.length;d+=2){var e=c[d];H(a,e)||b.push(e)}return b}function z(a){var b=a.N;a=a.Pa;for(var c=[],d=[],e=[],h=0;h<b.length;h++)e[b[2*h]]=h,c.push(h,b[2*h+1]);
for(h=0;h<a.length;h+=3)d.push(e[a[h]],e[a[h+1]],a[h+2]);return{N:c,Pa:d}}function M(a,b,c){if(c.Qh==c.Ak){for(var d=0,e=0;d<c.Ak;d++)-1!=c.Ni[d]&&(a[e]=d,b[e]=c.Ni[d],e++);return!0}if(c.Ak>c.Do||c.bl>c.cl||c.op>c.qp||c.np>c.pp)return!1;for(var e=d=-1,f=!1;!f&&E(c,u,d,e);)if(d=u[0],e=u[1],F(c,d,e)){var k;k=c;f={};f.Fr=k.Fr;f.Gr=k.Gr;f.MC=k.MC;f.ev=k.ev;f.Ak=k.Ak;f.Do=k.Do;f.Ek=k.Ek;f.Qh=f.Jw=k.Qh;f.np=k.np;f.op=k.op;f.bl=k.bl;f.pp=k.pp;f.qp=k.qp;f.cl=k.cl;f.lq=-1;f.Ni=k.Ni;f.Ul=k.Ul;f.xm=k.xm;f.ym=
k.ym;f.Rm=k.Rm;f.Sm=k.Sm;f.yx=k.yx;k.yx[0]+=1;var f=k=f,m=d,n=e,p=f.Fr,l=f.Gr,g=f.Ak,v=f.Do,B=f.Ni,r=f.Ul,V=f.xm,q=f.ym,J=f.Rm,S=f.Sm;A(m<g);A(n<v);A(f.Qh<g);A(f.Qh<v);g=++f.Qh;f.lq=m;V[m]||(V[m]=g,f.np++,J[m]&&f.bl++);J[m]||(J[m]=g,f.op++,V[m]&&f.bl++);q[n]||(q[n]=g,f.pp++,S[n]&&f.cl++);S[n]||(S[n]=g,f.qp++,q[n]&&f.cl++);B[m]=n;r[n]=m;for(B=0;B<I(p,m);B++)r=h(p,m,B),V[r]||(V[r]=g,f.np++,J[r]&&f.bl++);for(B=0;B<H(p,m);B++)r=C(p,m,B),J[r]||(J[r]=g,f.op++,V[r]&&f.bl++);for(B=0;B<I(l,n);B++)r=h(l,n,
B),q[r]||(q[r]=g,f.pp++,S[r]&&f.cl++);for(B=0;B<H(l,n);B++)r=C(l,n,B),S[r]||(S[r]=g,f.qp++,q[r]&&f.cl++);f=M(a,b,k);A(1>=k.Qh-k.Jw);A(-1!=k.lq);r=k.Fr;m=k.Gr;n=k.Qh;p=k.lq;l=k.Ni;V=k.Ul;g=k.xm;q=k.ym;v=k.Rm;J=k.Sm;if(k.Jw<n){g[p]==n&&(g[p]=0);for(S=0;S<I(r,p);S++)B=h(r,p,S),g[B]==n&&(g[B]=0);v[p]==n&&(v[p]=0);for(S=0;S<H(r,p);S++)B=C(r,p,S),v[B]==n&&(v[B]=0);r=l[p];q[r]==n&&(q[r]=0);for(S=0;S<I(m,r);S++)B=h(m,r,S),q[B]==n&&(q[B]=0);J[r]==n&&(J[r]=0);for(S=0;S<H(m,r);S++)B=C(m,r,S),J[B]==n&&(J[B]=
0);l[p]=-1;V[r]=-1;k.Qh=k.Jw;k.lq=-1}}return f}function E(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var e=a.bl,h=a.cl,f=a.op,k=a.qp,m=a.np,n=a.pp,u=a.Qh,p=a.Ak,v=a.Do,l=a.Ni,g=a.Ul,B=a.xm,r=a.ym,q=a.Rm,S=a.Sm;if(e>u&&h>u)for(;c<p&&(-1!=l[c]||0==q[c]||0==B[c]);)c++,d=0;else if(f>u&&k>u)for(;c<p&&(-1!=l[c]||0==q[c]);)c++,d=0;else if(m>u&&n>u)for(;c<p&&(-1!=l[c]||0==B[c]);)c++,d=0;else if(0==c&&0!=a.Ek){for(B=0;B<p&&-1!=l[c=a.Ek[B]];)B++;B==p&&(c=p)}else for(;c<p&&-1!=l[c];)c++,d=0;if(e>u&&h>u)for(;d<v&&(-1!=
g[d]||0==S[d]||0==r[d]);)d++;else if(f>u&&k>u)for(;d<v&&(-1!=g[d]||0==S[d]);)d++;else if(m>u&&n>u)for(;d<v&&(-1!=g[d]||0==r[d]);)d++;else for(;d<v&&-1!=g[d];)d++;return c<p&&d<v?(b[0]=c,b[1]=d,!0):!1}function F(a,b,c){var d=a.Fr,e=a.Gr,f=a.Do,m=a.Ni,n=a.Ul,u=a.xm,p=a.ym,l=a.Rm,g=a.Sm;A(b<a.Ak);A(c<f);A(-1==m[b]);A(-1==n[c]);if(!(0,a.MC)(O(d,b),O(e,c)))return!1;for(var v=f=0,B=0,r=0,V=0,q=0,y=0;y<H(d,b);y++){var S=C(d,b,y);if(-1!=m[S]){var ga=m[S];if(!k(e,c,ga)||!J(a.ev,d,b,S,e,c,ga))return!1}else u[S]&&
B++,l[S]&&f++,u[S]||l[S]||V++}for(y=0;y<I(d,b);y++)if(S=h(d,b,y),-1!=m[S]){if(ga=m[S],!k(e,ga,c)||!J(a.ev,d,S,b,e,ga,c))return!1}else u[S]&&B++,l[S]&&f++,u[S]||l[S]||V++;for(y=0;y<H(e,c);y++)if(ga=C(e,c,y),-1!=n[ga]){if(S=n[ga],!k(d,b,S))return!1}else p[ga]&&r++,g[ga]&&v++,p[ga]||g[ga]||q++;for(y=0;y<I(e,c);y++)if(ga=h(e,c,y),-1!=n[ga]){if(S=n[ga],!k(d,S,b))return!1}else p[ga]&&r++,g[ga]&&v++,p[ga]||g[ga]||q++;return B<=r&&f<=v&&V<=q}function A(a){a||B.q("Assertion failed")}function O(a,b){for(var c=
a.N,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function H(a,b){for(var c=a.Pa,d=0,e=0;e<c.length;e+=3)c[e]==b&&d++;return d}function I(a,b){for(var c=a.Pa,d=0,e=0;e<c.length;e+=3)c[e+1]==b&&d++;return d}function C(a,b,c){a=a.Pa;for(var d=0,e=0;e<a.length;e+=3)if(a[e]==b){if(d==c)return a[e+1];d++}return-1}function h(a,b,c){a=a.Pa;for(var d=0,e=0;e<a.length;e+=3)if(a[e+1]==b){if(d==c)return a[e];d++}return-1}function k(a,b,c){a=a.Pa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;
return!1}function J(a,b,c,e,h,f,k){for(var m=y(b,c,e),n=y(h,f,k),u=0;u<m;u++){for(var p=!1,l=0;l<n;l++)if(a(d(b,c,e,u),d(h,f,k,l))){p=!0;break}if(!p)return!1}return!0}function y(a,b,c){var d=0;a=a.Pa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&d++;return d}function d(a,b,c,d){a=a.Pa;for(var e=0,h=0;h<a.length;h+=3)if(a[h]==b&&a[h+1]==c){if(e==d)return a[h+2];e++}return null}g("__print");var B=g("__util"),u=[-1,-1];a.vz=-1;a.g1=10;a.Ct=20;a.y2=30;a.create=function(){for(var a=arguments,b=[],c=
[],d=0;d<a.length;d++){var e=a[d];switch(e.length){case 2:b.push(e[0],e[1]);break;case 3:c.push(e[0],e[1],e[2]);break;default:B.q("Wrong graph constructor params")}}return{N:b,Pa:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.N.length),e=0;e<a.N.length;e+=2)d[e]=a.N[e],d[e+1]=b(a.N[e+1]);else d=B.T(a.N);if(c)for(b=Array(a.Pa.length),e=0;e<a.Pa.length;e+=3)b[e]=a.Pa[e],b[e+1]=a.Pa[e+1],b[e+2]=c(a.Pa[e+2]);else b=B.T(a.Pa);return a={N:d,Pa:b}};a.X3=function(a,b){for(var c=[],d=[],e=0;e<a.length;e++)c.push(a[e][0],
a[e][1]);for(e=0;e<b.length;e++)d.push(b[e][0],b[e][1],b[e][2]);return{N:c,Pa:d}};a.Pj=q;a.d7=c;a.dd=b;a.Ag=w;a.Ok=t;a.Ro=function(a,b,c,d){k(a,b,c)||B.q("Edge not found");a=a.Pa;for(var e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c&&a[e+2][0]==d[0]&&a[e+2][1]==d[1]){a.splice(e,3);break}};a.J=function(a,b){if(-1==l(a,b)){var c=D(a);q(a,c,b);return c}B.q("Non-unique attribute")};a.tY=function(a,b,c,d,e){a=a.Pa;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&a[h+2]==d&&(a[h+2]=e)};a.$Q=function(a,c,d){var e;
d=d||[];e=e||[];for(var h={},f=0;f<a.N.length;f+=2){var k=a.N[f],m=a.N[f+1],n=D(c);q(c,n,m);h[k]=n}for(f=0;f<a.Pa.length;f+=3)m=h[a.Pa[f]],n=h[a.Pa[f+1]],k=a.Pa[f+2],b(c,m,n,k);for(f=0;f<d.length;f+=3)m=h[d[f]],a=d[f+1],k=d[f+2],b(c,m,a,k);for(f=0;f<e.length;f+=3)d=e[f],n=h[e[f+1]],k=e[f+2],b(c,d,n,k)};a.nm=D;a.oh=l;a.r=function(a,c,d,e){c=l(a,c);d=l(a,d);-1!=c&&-1!=d?b(a,c,d,e):B.q("Attributes not found")};a.pa=function(a,b){for(var c=a.N,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.Dg=function(a,b){for(var c=
a.Pa,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.ui=function(a,b,c){for(var d=a.Pa,e=0;e<d.length;e+=3)if(d[e+1]==b){var h=d[e];if(c(h,O(a,h),d[e+2]))break}};a.fl=function(a,b,c){for(var d=a.Pa,e=0;e<d.length;e+=3)if(d[e]==b){var h=d[e+1];if(c(h,O(a,h),d[e+2]))break}};a.oE=r;a.o_=function(a){a=r(a).N;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.w7=function(){};a.Mx=function(a,b,d){c(a,b)||B.q("No such node");var e={};p(a,e);f(a,b,e,d);b=[];for(var h in e)e[h]&&(h=Number(h),b.push(h,
O(a,h)));a={N:b,Pa:a.Pa.slice(0)};n(a);return a};a.oA=n;a.MV=function(a){for(var b=[],c=a.N,d=0;d<c.length;d+=2){var e=c[d];I(a,e)||b.push(e)}return b};a.Lr=e;a.match=function(a,b,c,d){var e={};e.Fr=z(a);e.Gr=z(b);e.MC=c||function(a,b){return a==b};e.ev=d||function(a,b){return a==b};d=a.N.length/2;var h=b.N.length/2;e.Ak=d;e.Do=h;e.Ek=0;e.Qh=e.Jw=0;e.bl=e.np=e.op=0;e.cl=e.pp=e.qp=0;e.lq=-1;e.Ni=Array(d);e.Ul=Array(h);e.xm=Array(d);e.ym=Array(h);e.Rm=Array(d);e.Sm=Array(h);e.yx=[1];for(c=0;c<d;c++)e.Ni[c]=
-1,e.xm[c]=0,e.Rm[c]=0;for(c=0;c<h;c++)e.Ul[c]=-1,e.ym[c]=0,e.Sm[c]=0;h=Array(d);d=Array(d);if(M(h,d,e)){for(c=0;c<h.length;c++)h[c]=a.N[2*h[c]],d[c]=b.N[2*d[c]];return[h,d]}return null};a.IV=function(a,b){for(var c=a.N,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Va=O;a.xg=H;a.qo=I;a.eh=C;a.Yi=h;a.y5=y;a.Yd=d;a.replace=function(a,b,c){for(var d=a.Pa,e=D(a),h=0;h<b.length;h++){var f=b[h];w(a,f);for(var k=0;k<d.length;k+=3)d[k]==f&&(d[k]=e),d[k+1]==f&&(d[k+1]=e),d[k]==d[k+1]&&(d.splice(k,
3),k-=3)}q(a,e,c)};a.jY=function(a,b,c,d,e){k(a,b,c)||B.q("Edge not found");a=a.Pa;for(var h=0;h<a.length;h+=3)a[h]==b&&a[h+1]==c&&(a[h]=d,a[h+1]=e)};a.qU=function(a,b){function c(a,b){if(-1!=m.indexOf(a)){var d=m.slice(m.indexOf(a));if(-1!=h[d[d.length-1]].indexOf(d[0])){n.push([a,d[d.length-1]]);return}}m.push(a);for(d=0;d<b.length;d++)b[d]in h&&c(b[d],h[b[d]])}b||(b=e(a)[0]);var d=a.Pa;if(d.length&&-1!=d.indexOf(b)){for(var h={},f=0,k=0;k<d.length;k+=3)d[k+1]in h?h[d[k+1]].push(d[k]):h[d[k+1]]=
[d[k]],f++;var m=[],n=[];c(b,h[b]);for(k=0;k<n.length;k++)for(var u=f=0;u<d.length;u+=3)n[k][1]==d[u+1]&&n[k][0]==d[u]&&t(a,d[u],d[u+1],f),f++}};a.UT=function(a,b,c){var d=a.N;a=a.Pa;var e;e="digraph debug {\n    node [shape=box];\n";for(var h=0;h<d.length;h+=2){var f=d[h],k=d[h+1],k=b?b(f,k):String(f);e+="    ";e+=String(f)+' [label="'+k.replace(/\"/g,'\\"')+'"];\n'}for(h=0;h<a.length;h+=3)b=a[h],d=a[h+1],k=a[h+2],e+="    ",e+=String(b)+" -> "+String(d),c&&(e+=' [label="'+c(b,d,k)+'"]'),e+=";\n";
return e+="}"}};b4w.module.__nodemat=function(a,g){function q(a,b,d,h,f){var k=Oa.A(),k=l(b,f,k.uuid);if(k in wa)return wa[k];var v={Wa:null,id:k,mH:!0};d||(Ja={},Ma=0);if("SHADOW"!=f&&"COLOR_ID"!=f){b=L.create();for(var u=a.nodes,x=0;x<u.length;x++)if(null==ba(b,u[x],0,h,f))return wa[k]=null,v;if(d&&-1==B(a,b,"GROUP_OUTPUT","group"))return v;x=S(b);u=d?a.links:a.links.slice();if(!ga(b,u,x))return v;if(d)return v.Wa=b,v;for(x=0;x<u.length;x++){d=u[x];for(var g=z(d.from_node,b),Q=z(d.to_node,b),V=0;V<g.length;V++)for(var R=
0;R<Q.length;R++){var da=g[V],ca=Q[R],Z=L.Va(b,da),y=L.Va(b,ca);if(!ta(b,da,ca,Z,y,d))return wa[k]=null,v}}e(b);"GLOW"==f?x=B(a,b,"B4W_GLOW_OUTPUT","material",!0):(x=B(a,b,"OUTPUT","material",!1,!0),-1==x&&(x=B(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==x&&(b=p(),x=0);M(b);a=L.Mx(b,x,L.Ct);c(a,h);t(a,h);m(a);F(a);J(a);n(a,h,f);pa(a)}else h=q(a,b,d,h,"MAIN"),h=L.clone(h.Wa,function(a){var b=Ca.Rq(a);b.M=Ca.T(a.M);b.fb=Ca.T(a.fb);return b}),x=B(a,h,"OUTPUT","material",!1,!0),-1==x&&(x=B(a,h,"OUTPUT_MATERIAL",
"material",!1,!0)),r(h,x),a=L.Mx(h,x,L.Ct),m(a);v.Wa=a;return wa[k]=v}function c(a,c){var d=[];L.pa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({qs:a,node:b})});for(var e=0;e<d.length;++e){var h=d[e].qs,f=d[e].node,k=L.nm(a);L.Pj(a,k,f.data.nX);var v=L.nm(a);L.Pj(a,v,f.data.oX);L.dd(a,k,v,[4,2]);for(var m={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},n=L.qo(a,h),u=[],x=[],p=[],l={},g=0;g<n;g++){var B=L.Yi(a,h,
g);B in l||(l[B]=0);var Q=L.Yd(a,B,h,l[B]++);u.push([B,h,Q]);var S=m[Q[1]];if(S)switch(S[0]){case "MATERIAL_END":x.push([B,v,[Q[0],S[1]]]);break;case "LIGHTING_APPLY":p.push([B,[Q[0],S[1]]])}else x.push([B,k,Q])}b(a,f.data.value,k,v,p,c);for(g=0;g<u.length;g++)L.Ro(a,u[g][0],u[g][1],u[g][2]);for(g=0;g<x.length;g++)L.dd(a,x[g][0],x[g][1],x[g][2]);f=L.xg(a,h);k=[];m=[];n={};for(g=0;g<f;g++)u=L.eh(a,h,g),u in n||(n[u]=0),Q=L.Yd(a,h,u,n[u]++),k.push([h,u,Q]),m.push([v,u,Q]);for(g=0;g<k.length;g++)L.Ro(a,
k[g][0],k[g][1],k[g][2]);for(g=0;g<m.length;g++)L.dd(a,m[g][0],m[g][1],m[g][2]);L.Ag(a,h)}}function b(a,b,c,d,e,h){var f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=ba(a,f,0,h,null),v=k;w(a,c,k,"E");w(a,c,k,"A");w(a,c,k,"D");k=Oa.A();k=ia.Ub(k,"LAMP",ia.oc);if(!b.Ne)for(var m,n,u,x=0;x<k.length;x++){u=k[x].tb;f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=ba(a,f,0,h,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=ba(a,f,0,h,null);w(a,v,n,"color");w(a,v,n,"specular");w(a,m,n,"ldir");
w(a,c,n,"normal");w(a,c,n,"D");w(a,c,n,"S");w(a,m,n,"lcolorint");w(a,c,m,"shadow_factor");v="SPECULAR_"+b.$s;f={name:v,type:v,use_tangent_shading:b.rn};v=ba(a,f,0,h,null);w(a,m,v,"ldir");w(a,m,v,"lfac");w(a,c,v,"normal");w(a,v,n,"sfactor");w(a,m,v,"norm_fac");w(a,c,v,"sp_params");v="HEMI"==u.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.mr;f={name:v,type:v,use_tangent_shading:b.rn};u=ba(a,f,0,h,null);w(a,m,u,"ldir");w(a,m,u,"lfac");w(a,c,u,"normal");w(a,m,u,"norm_fac");w(a,u,n,"lfactor");"DIFFUSE_LAMBERT"!=
v&&w(a,c,u,"dif_params");for(m=0;m<e.length;m++)L.dd(a,e[m][0],n,e[m][1]);v=n}w(a,v,d,"color");w(a,v,d,"specular")}function w(a,b,c,d){for(var e=L.Va(a,b),h=L.Va(a,c),f,k=0;k<h.M.length;k++)if(d==h.M[k].identifier){f=k;break}if(void 0!==f){for(var v,k=0;k<e.fb.length;k++)if(d==e.fb[k].identifier){v=k;break}void 0!==v&&L.dd(a,b,c,[v,f])}}function t(a,b){var c=[];L.pa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({qs:a,node:b})});for(var d=0;d<c.length;++d){var e=c[d].qs,h=c[d].node,f=L.nm(a);L.Pj(a,
f,h.data.HR);var k=L.nm(a);L.Pj(a,k,h.data.IR);L.dd(a,f,k,[4,2]);for(var v=L.qo(a,e),m=[],n=[],u={},x=0;x<v;x++){var p=L.Yi(a,e,x),l=L.Va(a,p);p in u||(u[p]=0);var g=L.Yd(a,p,e,u[p]++);m.push([p,e,g]);n.push([p,f,g]);if("BSDF_GLOSSY"==l.type||"BSDF_DIFFUSE"==l.type||"MIX_SHADER"==l.type||"EMISSION"==l.type){n.push([p,f,[1,1]]);n.push([p,f,[2,2]]);n.push([p,f,[3,3]]);n.push([p,f,[4,4]]);n.push([p,f,[5,5]]);n.push([p,f,[6,6]]);n.push([p,f,[7,7]]);n.push([p,f,[8,8]]);var B=[];L.pa(a,function(a,b){"MIX_SHADER"==
b.type&&B.push({qs:a,node:b})});for(g=0;g<B.length;++g)for(var p=B[g].qs,l=L.qo(a,p),Q=0;Q<l;Q++){var S=L.Yi(a,p,Q),V=L.Va(a,S),R=L.Yd(a,S,p,0);0==R[1]||"BSDF_GLOSSY"!=V.type&&"BSDF_DIFFUSE"!=V.type&&"MIX_SHADER"!=V.type&&"EMISSION"!=V.type||(V=1==R[1]?3:11,n.push([S,p,[1,V]]),n.push([S,p,[2,V+1]]),n.push([S,p,[3,V+2]]),n.push([S,p,[4,V+3]]),n.push([S,p,[5,V+4]]),n.push([S,p,[6,V+5]]),n.push([S,p,[7,V+6]]),n.push([S,p,[8,V+7]]))}}}D(a,h.data.value,f,k,b);for(x=0;x<m.length;x++)L.Ro(a,m[x][0],m[x][1],
m[x][2]);for(x=0;x<n.length;x++)L.dd(a,n[x][0],n[x][1],n[x][2]);h=L.xg(a,e);f=[];v=[];m={};for(x=0;x<h;x++)n=L.eh(a,e,x),n in m||(m[n]=0),g=L.Yd(a,e,n,m[n]++),f.push([e,n,g]),v.push([k,n,g]);for(x=0;x<f.length;x++)L.Ro(a,f[x][0],f[x][1],f[x][2]);for(x=0;x<v.length;x++)L.dd(a,v[x][0],v[x][1],v[x][2]);L.Ag(a,e)}}function D(a,b,c,d,e){var h=[],f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=ba(a,f,0,e,null),v=k;w(a,c,k,"E");w(a,c,k,"A");w(a,c,k,"D");for(var k=Oa.A(),k=ia.Ub(k,"LAMP",ia.oc),m,n,
u=0;u<k.length;u++){f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=ba(a,f,0,e,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=ba(a,f,0,e,null);w(a,v,n,"color");w(a,v,n,"specular");w(a,m,n,"ldir");w(a,c,n,"normal");w(a,c,n,"D");w(a,c,n,"S");w(a,m,n,"lcolorint");w(a,c,m,"shadow_factor");v=b.JR;f={name:v,type:v};v=ba(a,f,0,e,null);w(a,m,v,"ldir");w(a,m,v,"lfac");w(a,c,v,"normal");w(a,m,v,"norm_fac");w(a,c,v,"bsdf_params");w(a,v,n,"lfactor");w(a,v,n,"sfactor");for(v=0;v<h.length;v++)L.dd(a,h[v][0],
n,h[v][1]);v=n}w(a,c,d,"s_color");w(a,c,d,"metalness");w(a,c,d,"e_color");w(a,c,d,"emission");w(a,v,d,"color");w(a,v,d,"specular")}function l(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function r(a,b){L.Dg(a,function(c,d,e){var h=L.Va(a,d);d==b&&"Color"==h.M[e[1]].identifier&&L.Ro(a,c,d,e)})}function p(){var a=L.create(),b={data:null,Rb:[],qb:[],M:[{Ea:new Float32Array([0,0,0]),identifier:"Color",ab:!1,name:"Color"},{Ea:1,identifier:"Alpha",
ab:!1,name:"Alpha"}],fb:[],type:"OUTPUT",xi:[]};L.Pj(a,0,b);return a}function m(a){L.pa(a,function(b,c){for(var d=c.M,e=c.fb,h=0;h<d.length;h++)f(a,d[h],b,h,1);for(h=0;h<e.length;h++)f(a,e[h],b,h,0)})}function f(a,b,c,d,e){if(b.ab){var h=!0;L.Dg(a,function(a,b,f){if(!e&&a==c&&f[0]==d||e&&b==c&&f[1]==d)h=!1});h&&(b.ab=!1)}}function n(a,b,c){var d=[];L.Dg(a,function(e,h,f){var k=L.Va(a,e),v=L.Va(a,h),k=Ca.wk(k.fb[f[0]].Ea),v=Ca.wk(v.M[f[1]].Ea);if(k!=v){var m,n={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},x={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};k&&!v?m=u("vector_to_scalar","B4W_VECTOSCAL",[n],[x]):!k&&v&&(m=u("scalar_to_vector","B4W_SCALTOVEC",[x],[n]));ba(a,m,0,b,c);d.push([e,h,a.N[a.N.length-2],f])}});for(var e=0;e<d.length;++e)L.Ro(a,d[e][0],d[e][1],d[e][3]),L.dd(a,d[e][0],d[e][2],[d[e][3][0],0]),L.dd(a,d[e][2],d[e][1],[0,d[e][3][1]])}function e(a){var b=[];L.pa(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":L.Dg(a,function(e,h,f){var k=
L.Va(a,h);e==c&&"MATERIAL_EXT"==k.type&&"Translucency"==d.fb[f[0]].name&&b.push(e,h,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)L.dd(a,b[c],b[c+1],b[c+2])}function z(a,b){var c=[];L.pa(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;Ca.q("Node not found")}function M(a){var b=[];L.pa(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type)E(a,d,e);else if("REROUTE"==e.type){for(var h=
L.Yi(a,d,0),f=L.xg(a,d),k=[],v=[],m=[],n=0;n<f;n++){var u=L.eh(a,d,n),x=v.indexOf(u),p=0<=x?m[p]:0,l=L.Yd(a,d,u,p);if(l){var l=l[1],g=e.M[0].Ea,l=L.Va(a,u).M[l];switch(typeof g){case "number":if("object"==typeof l.Ea)for(var B=l.Ea,l=0;l<B.length;l++)B[l]=g;else"number"==typeof l.Ea&&(l.Ea=g);break;case "object":if("object"==typeof l.Ea)for(B=l.Ea,l=0;l<B.length;l++)B[l]=g[l];else"number"==typeof l.Ea&&(l.Ea=.35*g[0]+.45*g[1]+.2*g[2])}}g=e.fb;for(l=0;l<g.length;l++)g[l].Ea=e.M[0].Ea;-1!=x?m[x]+=1:
(v.push(u),m.push(1),k.push(d,u))}if(-1!=h)for(e=L.Yd(a,h,d,0)[0],n=0;n<v.length;n++)for(l=0;l<m[n];l++)f=L.Yd(a,d,v[n],l)[1],L.dd(a,h,v[n],[e,f]);for(n=0;n<k.length;n+=2)L.Ok(a,k[n],k[n+1],-1)}}}function E(a,b,c){var d;a:{d=a.Pa;for(var e=0;e<d.length;e+=3)if(d[e+1]==b&&1==d[e+2][1]){d=d[e];break a}d=-1}-1!=d&&(e=L.Va(a,d),c.data=e.data,L.Ok(a,d,b,-1),0==L.xg(a,d)&&(b=L.Yi(a,d,0),-1!=b&&L.Ok(a,b,d,-1),L.Ag(a,d)));c.M.splice(1,1)}function F(a){O(a);C(a);A(a)}function A(a){var b=[],c="",d="",e={};
L.pa(a,function(a,h){if("GEOMETRY_UV"==h.type||"UVMAP"==h.type||"TEX_COORD_UV"==h.type){b.push(a,h);var f=h.data.value;c?c==f||d||(d=f,e[d]=0):(c=f,e[c]=0);e[f]++}});for(var h in e)if(2>e[h]){for(var f=0;f<b.length;f+=2)b[f+1].data.value==h&&b.splice(f,2);delete e[h];c==h&&(c=d,d="");d==h&&(d="")}if(!(3>b.length)){var f={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},v={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};h=u("merged_uv","UV_MERGED",
[],[f,v]);h.uv_layer=c;ba(a,h,0,"",void 0);var m=a.N[a.N.length-2];h=a.N[a.N.length-1];if(d){v=u("merged_uv","UV_MERGED",[],[f,v]);v.uv_layer=d;ba(a,v,0,"",void 0);var n=a.N[a.N.length-2],v=a.N[a.N.length-1]}else v=null;for(var x=-1,p=null,f=0;f<b.length;f+=2){var l=b[f],g=b[f+1];k(g,b[1])?(x=m,p=h):v&&(x=n,p=v);for(var B=[],Q=L.xg(a,l),S={},V=0;V<Q;V++){var R=L.eh(a,l,V);R in S||(S[R]=0);var r=L.Yd(a,l,R,S[R]++);B.push(l,R,r);r=r.splice(0,r.length);switch(g.type){case "GEOMETRY_UV":r[0]=0;p.fb[0].ab=
!0;break;case "UVMAP":case "TEX_COORD_UV":r[0]=1,p.fb[1].ab=!0}L.dd(a,x,R,r)}for(var V=0;V<B.length;V+=3)L.Ok(a,B[V],B[V+1],0);L.Ag(a,l)}}}function O(a){var b=[];L.pa(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],k=!0,v=0;v<c.length;v++){var m=c[v];if(h(f,
m.Df)){k=[];v=L.xg(a,e);for(x=0;x<v;x++){var n=L.eh(a,e,x),u=L.Yd(a,e,n,0);k.push(e,n,u);L.dd(a,m.id,n,u)}for(var x=0;x<k.length;x+=3)L.Ok(a,k[x],k[x+1],0);L.Ag(a,e);k=!1;break}}k&&(m={id:e,Df:f},c.push(m))}}function H(a){for(var b={},c=0;c<a.N.length;c+=2){var d=a.N[c];b[d]={tq:{},$J:!1}}for(c=0;c<a.Pa.length;c+=3)b[a.Pa[c+1]].tq[a.Pa[c]]=!0;for(d in b)I(d,b);for(d in b)b[d]=Object.keys(b[d].tq).map(function(a){return parseInt(a)});return b}function I(a,b){var c=b[a];if(!c.$J){var d=Ca.T(c),e;for(e in c.tq){I(e,
b);var c=b[e],h;for(h in c.tq)d.tq[h]=!0}d.$J=!0;b[a]=d}}function C(a){var b=[];L.pa(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=H(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],k=b[e+1],v=!0,m=0;m<d.length;m++){var n=d[m];if(!(3<=n.Bo.length||!h(k,n.Df)||-1<c[f].indexOf(n.id)||-1<c[n.id].indexOf(f))){for(var u=!1,x=0;x<n.Bo.length;x++){var p=n.Bo[x].id;if(-1<c[f].indexOf(p)||-1<c[p].indexOf(f)){u=!0;break}}if(!u){for(var m=[],p=L.qo(a,f),l=
{},x=0;x<p;x++)u=L.Yi(a,f,x),u in l||(l[u]=0),v=L.Yd(a,u,f,l[u]++),m.push(u,f,v);for(var p=[],l=L.xg(a,f),g={},x=0;x<l;x++)u=L.eh(a,f,x),u in g||(g[u]=0),v=L.Yd(a,f,u,g[u]++),p.push(f,u,v);v=m.concat(p);for(x=0;x<v.length;x+=3)L.Ok(a,v[x],v[x+1],0);L.Ag(a,f);x={id:f,Df:k,iU:m,jU:p};n.Bo.push(x);v=!1;break}}}v&&(n={id:f,Df:k,Bo:[]},d.push(n))}for(e=0;e<d.length;e++){n=d[e];c=n.Bo.length;for(m=0;m<c;m++){k=n.Bo[m];x=k.Df;f=k.iU;k=k.jU;n.Df.M[m+1].ab=x.M[0].ab;n.Df.M[m+1].Ea=x.M[0].Ea;n.Df.fb[2*(m+1)].ab=
x.fb[0].ab;n.Df.fb[2*(m+1)].Ea=x.fb[0].Ea;n.Df.fb[2*(m+1)+1].ab=x.fb[1].ab;n.Df.fb[2*(m+1)+1].Ea=x.fb[1].Ea;for(x=0;x<f.length;x+=3)u=f[x],v=f[x+2],v[1]+=m+1,L.dd(a,u,n.id,v);for(x=0;x<k.length;x+=3)u=k[x+1],v=k[x+2],v[0]+=2*(m+1),L.dd(a,n.id,u,v);n.Df.Rb.push(["USE_uv"+(m+2),1])}L.Ag(a,n.id);L.Pj(a,n.id,n.Df)}}}function h(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.bA==b.data.value.bA&&a.data.value.po==b.data.value.po;default:return!1}}function k(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function J(a){var b=[],c=[];L.pa(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});y(a,b);d(a,c)}function y(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],h=!1,f=[],k=[],v=[[],
[],[]],m=L.xg(a,d),n=0;n<m;n++){var x=L.eh(a,d,n);if("SEPRGB"!=L.Va(a,x).type){h=!1;break}f.push(d,x);for(var u={},p=L.xg(a,x),h=0;h<p;h++){var l=L.eh(a,x,h);l in u||(u[l]=0);var g=L.Yd(a,x,l,u[l]++);f.push(x,l);v[g[0]].push(d,l,g)}k.push(x);h=!0}if(h){for(n=d=m=0;n<v.length;n++)v[n].length&&(m++,d|=1<<2-n);if(m){e.type+=m;e.fb=[];for(n=0;n<v.length;n++)if(v[n].length)for(e.fb.push({Ea:0,identifier:"RGB"[n],ab:!0,name:"RGB"[n]}),h=0;h<v[n].length;h+=3)v[n][h+2][0]=Ca.To(d,n);for(n=0;n<f.length;n+=
2)L.Ok(a,f[n],f[n+1],0);for(n=0;n<k.length;n++)L.Ag(a,k[n]);for(n=0;n<v.length;n++)for(h=0;h<v[n].length;h+=3)L.dd(a,v[n][h],v[n][h+1],v[n][h+2])}}}}function d(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,h=[],f=L.xg(a,d),k=0;k<f;k++){var v=L.eh(a,d,k);if("B4W_REFLECT"==L.Va(a,v).type){var m=L.Yd(a,d,v,0),n=L.Yd(a,d,v,1);m&&1==m[1]||n&&1==n[1]?e=!1:h.push(d,v)}else e=!1}for(k=0;k<h.length;k+=2)f=a,m=h[k],v=h[k+1],n=L.Va(f,v),n.type+="_WORLD",L.Ok(f,m,v,0),n.M.splice(0,1),m=L.Yi(f,v,0),m!=
L.vz&&(L.Yd(f,m,v,0)[1]=0);e&&L.Ag(a,d)}}function B(a,b,c,d,e,h){a=a.nodes;for(var f=null,k=0;k<a.length;k++){var v=a[k];e?"GROUP"==v.type&&v.node_tree_name==c&&(f=v):v.type==c&&(f=v)}return f?z(f,b)[0]:(h||va.error('No "'+c+'" node in node '+d),-1)}function u(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function ba(a,b,c,d,e){var h=b.name,f=b.type,k=[],m=[],n=[],u=[],p=null,l=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":m=
Z(b);n=Y(b);va.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":m=Z(b);n=Y(b);break;case "MIX_SHADER":m.push(Q(b,"Fac"));var g=Q(b,"Shader"),n=g.ab;m.push(g);(g=Q(b,"Shader_001"))||(g=Q(b,"Shader.001"));var B=g.ab;m.push(g);m.push(v("d_color1","d_color1",[0,0,0],n));m.push(v("d_roughness1","d_roughness1",0,n));m.push(v("s_color1","s_color1",[0,0,0],n));m.push(v("s_roughness1","s_roughness1",0,n));m.push(v("metalness1","metalness1",0,n));m.push(v("normal1","normal1",
[0,0,0],n));m.push(v("e_color1","e_color1",[0,0,0],n));m.push(v("emission1","emission1",0,n));m.push(v("d_color2","d_color2",[0,0,0],B));m.push(v("d_roughness2","d_roughness2",0,B));m.push(v("s_color2","s_color2",[0,0,0],B));m.push(v("s_roughness2","s_roughness2",0,B));m.push(v("metalness2","metalness2",0,B));m.push(v("normal2","normal2",[0,0,0],B));m.push(v("e_color2","e_color2",[0,0,0],B));m.push(v("emission2","emission2",0,B));n=W(b,"Shader");g=n.ab;n=[n,v("d_color","d_color",[0,0,0],g),v("d_roughness",
"d_roughness",0,g),v("s_color","s_color",[0,0,0],g),v("s_roughness","s_roughness",0,g),v("metalness","metalness",0,g),v("normal","normal",[0,0,0],g),v("e_color","e_color",[0,0,0],g),v("emission","emission",0,g)];break;case "OBJECT_INFO":var m=Z(b),n=[],g=W(b,"Location"),B=W(b,"Object Index"),S=W(b,"Material Index"),R=W(b,"Random");n.push(g);n.push(B);n.push(S);n.push(R);l.push(["USE_LOCATION_OUT",g.ab|0]);l.push(["USE_OBJ_IND_OUT",B.ab|0]);l.push(["USE_MAT_IND_OUT",S.ab|0]);l.push(["USE_RANDOM_OUT",
R.ab|0]);break;case "UVMAP":(g=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(p=P("param_"+f+"_a"),B=P("param_"+f+"_v"),k.push(V(p)),k.push(V(B)),u.push(V(B)),p={name:p,value:g});n=Y(b);break;case "UV_MERGED":p=P("param_UV_MERGED_a");B=P("param_UV_MERGED_v");k.push(V(p));k.push(V(B));n.push(W(b,"UV_geom"));n.push(W(b,"UV_cycles"));u.push(V(B));p={name:p,value:b.uv_layer};break;case "CAMERA":m=[];n=Y(b);break;case "COMBRGB":case "COMBHSV":m=Z(b);n=Y(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
f?(N(b,0,0)&&l.push(["READ_R",1]),N(b,1,0)&&l.push(["READ_G",1]),N(b,2,0)&&l.push(["READ_B",1]),N(b,3,0)&&l.push(["READ_A",1])):(N(b,0,-1)&&l.push(["READ_R",1]),N(b,1,-1)&&l.push(["READ_G",1]),N(b,2,-1)&&l.push(["READ_B",1]));m=Z(b);n=Y(b);p={value:b};break;case "PARTICLE_INFO":m=Z(b);n=Y(b);for(g=0;g<b.outputs.length;g++){B=b.outputs[g];S=B.identifier;R=V("v_param_PART_INFO_"+S.replace(" ",""));if(B.is_linked)switch(S){case "Size":l.push(["PART_INFO_SIZE",na.O(1)]);break;case "Age":l.push(["PART_INFO_AGE",
na.O(1)]);break;case "Lifetime":l.push(["PART_INFO_LT",na.O(1)]);break;case "Location":l.push(["PART_INFO_LOC",na.O(1)]);break;case "Index":var r=V("a_param_PART_INFO_"+B.identifier.replace(" ","")),p=r;l.push(["PART_INFO_IND",na.O(1)]);break;case "Velocity":l.push(["PART_INFO_VEL",na.O(1)]);break;case "Angular Velocity":l.push(["PART_INFO_A_VEL",na.O(1)])}"Age"!=S&&"Lifetime"!=S&&"Size"!=S&&(k.push(R),u.push(R))}r&&k.push(r);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!X(b))return!0;f=x(b,c);if(!f)return va.error("Geometry output is not supported"),
null;switch(f){case "GEOMETRY_UV":(g=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(p=P("param_GEOMETRY_UV_a"),B=P("param_GEOMETRY_UV_v"),k.push(V(p)),k.push(V(B)),u.push(V(B)),p={name:p,value:g});n.push(W(b,"UV"));break;case "GEOMETRY_VC":(g=b.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(p=P("param_GEOMETRY_VC_a"),B=P("param_GEOMETRY_VC_v"),k.push(V(p)),k.push(V(B)),u.push(V(B)),p={name:p,value:g});n.push(W(b,"Vertex Color"));break;case "GEOMETRY_NO":n.push(W(b,"Normal"));break;case "GEOMETRY_TRN":f=
"GEOMETRY_NO";n.push(W(b,"True Normal"));va.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":n.push(W(b,"Front/Back"));break;case "GEOMETRY_VW":n.push(W(b,"View"));break;case "GEOMETRY_GL":n.push(W(b,"Global")||W(b,"Position"));break;case "GEOMETRY_LO":n.push(W(b,"Local"));break;case "GEOMETRY_OR":g=P("param_GEOMETRY_OR_v");k.push(V(g));n.push(W(b,"Orco"));u.push(V(g));break;case "GEOMETRY_IN":n.push(W(b,"Incoming"));break;case "GEOMETRY_BF":n.push(W(b,"Backfacing"))}break;
case "TEX_COORD":if(!X(b))return!0;f=ka(b,c);switch(f){case "TEX_COORD_UV":(g=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(p=P("param_TEX_COORD_UV_a"),B=P("param_TEX_COORD_UV_v"),k.push(V(p)),k.push(V(B)),u.push(V(B)),p={name:p,value:b.uv_layer});n.push(W(b,"UV"));break;case "TEX_COORD_NO":n.push(W(b,"Normal"));break;case "TEX_COORD_GE":g=P("param_TEX_COORD_GE_v");k.push(V(g));n.push(W(b,"Generated"));u.push(V(g));break;case "TEX_COORD_OB":n.push(W(b,"Object"));break;case "TEX_COORD_CA":n.push(W(b,
"Camera"));break;case "TEX_COORD_WI":n.push(W(b,"Window"));break;case "TEX_COORD_RE":n.push(W(b,"Reflection"))}break;case "GROUP":g=b.node_tree_name;switch(g){case "B4W_LINEAR_TO_SRGB":if(!K(b,[1],[1])){p=G(b,d,e);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!K(b,[1],[1])){p=G(b,d,e);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!K(b,[1],[1])){p=G(b,d,e);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!K(b,[1,1],[1])){p=G(b,d,e);break}f=
"B4W_REFLECT";break;case "B4W_REFRACTION":if(!K(b,[1,0],[1])){p=G(b,d,e);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!K(b,[1,1,0,0,0],[1])){p=G(b,d,e);break}B=P("param_B4W_PARALLAX_texture");u.push(V(B));f="B4W_PARALLAX";break;case "B4W_CLAMP":if(!K(b,[1],[1])){p=G(b,d,e);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!K(b,[0,0,0,0,0],[0])){p=G(b,d,e);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!K(b,[],[0])){p=G(b,d,e);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!K(b,
[0,0,0],[0])){p=G(b,d,e);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:p=G(b,d,e)}m=Z(b);n=Y(b);"B4W_TRANSLUCENCY"==g&&(g=v("TranslucencyParams","TranslucencyParams",[0,0,0,0]),g.ab=n[0].ab,n.push(g));break;case "LAMP":p=b.lamp;if(!p)return va.error("There is no lamp in node: "+b.name),null;n.push(W(b,"Color"));n.push(W(b,"Light Vector"));n.push(W(b,"Distance"));n.push(W(b,"Visibility Factor"));p.uuid in Ja?l.push(["LAMP_INDEX",String(Ja[p.uuid])]):(Ja[p.uuid]=
Ma,l.push(["LAMP_INDEX",String(Ma++)]));p=Ja;break;case "LIGHTING_AMBIENT":m=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0)];n=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":n=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("dif_params","dif_params",[0,0],!0),v("sp_params","sp_params",[0,0],!0),v("shadow_factor","shadow_factor",0,!0),v("translucency_color",
"translucency_color",0,!0),v("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":m=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":m=[v("shadow_factor","shadow_factor",0,!0)];n=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("lcolorint","lcolorint",[0,0,0],!0),v("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":m=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac",
"norm_fac",0,!0)];n=[v("lfactor","lfactor",0,!0)];l.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":m=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("dif_params","dif_params",[0,0],!0)];n=[v("lfactor","lfactor",0,!0)];l.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":m=
[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("sp_params","sp_params",[0,0],!0)];n=[v("sfactor","sfactor",0,!0)];l.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":m=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("sp_params","sp_params",[0,0],!0)];n=[v("sfactor","sfactor",0,!0)];l.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":m=[v("ldir","ldir",[0,0,0],!0),v("lfac","lfac",[0,0],!0),v("normal","normal",[0,0,0],!0),v("norm_fac","norm_fac",0,!0),v("bsdf_params","bsdf_params",[0,0,0,0],!0)];n=[v("lfactor","lfactor",0,!0),v("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":m=[v("color","color",[0,0,0,0],!0),v("specular","specular",[0,0,0],!0),v("lfactor","lfactor",0,!0),v("sfactor","sfactor",0,!0),v("ldir","ldir",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("translucency_params",
"translucency_params",[0,0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("lcolorint","lcolorint",[0,0,0],!0),v("translucency_color","translucency_color",0,!0)];n=[v("color","color",[0,0,0,0],!0),v("specular","specular",[0,0,0],!0)];break;case "NORMAL":m=Z(b);n=Y(b);g=W(b,"Normal");u.push(V(P("param_NORMAL_Normal"),g.Ea,3));break;case "MAPPING":g=b.vector_type;f="MAPPING";m.push(Q(b,"Vector"));n.push(W(b,"Vector"));var B=Ca.Hf(b.rotation),S=Ca.Hf(b.scale),R=Ca.Hf(b.translation),r=Aa.create(),
da=Ca.sU(B);"TEXTURE"==g&&(S[0]=S[0]||1,S[1]=S[1]||1,S[2]=S[2]||1);var q=new Float32Array([S[0],0,0,0,S[1],0,0,0,S[2]]);Aa.multiply(da,q,r);r=Ca.mX(r,xa.create());switch(g){case "POINT":r[12]=R[0];r[13]=R[1];r[14]=R[2];break;case "TEXTURE":r[12]=R[0];r[13]=R[1];r[14]=R[2];r=xa.invert(r,r);break;case "NORMAL":xa.invert(r,r),xa.transpose(r,r)}switch(g){case "NORMAL":l.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":l.push(["MAPPING_TRS_MATRIX_DEF",1]);l.push(["MAPPING_TRS_MATRIX",na.O(r,16)]);break;case "POINT":0!==
qa.length(B)?(l.push(["MAPPING_TRS_MATRIX_DEF",1]),l.push(["MAPPING_TRS_MATRIX",na.O(r,16)])):(0!==qa.length(S)&&(l.push(["MAPPING_SCALE_DEF",1]),l.push(["MAPPING_SCALE",na.O(S,3)])),0!==qa.length(R)&&(l.push(["MAPPING_TRANS_DEF",1]),l.push(["MAPPING_TRANS",na.O(R,3)])));break;case "VECTOR":0!==qa.length(B)?(l.push(["MAPPING_TRS_MATRIX_DEF",1]),l.push(["MAPPING_TRS_MATRIX",na.O(r,16)])):0!==qa.length(S)&&(l.push(["MAPPING_SCALE_DEF",1]),l.push(["MAPPING_SCALE",na.O(S,3)]))}b.use_min&&(l.push(["MAPPING_MIN_CLIP_DEF",
1]),l.push(["MAPPING_MIN_CLIP",na.O(b.min,3)]));b.use_max&&(l.push(["MAPPING_MAX_CLIP_DEF",1]),l.push(["MAPPING_MAX_CLIP",na.O(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":p=[];g=[];B=[];S=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("dif_params","dif_params",[0,0],!0),v("sp_params","sp_params",[0,0],!0),v("shadow_factor","shadow_factor",0,!0)];R=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0),
v("normal","normal",[0,0,0],!0)];r=[W(b,"Color"),W(b,"Alpha"),W(b,"Normal")];da=[];q=Q(b,"Color");q.Ea.splice(3);B.push(q);m.push(q);q=Q(b,"Spec");q.Ea.splice(3);B.push(q);m.push(q);(q=Q(b,"DiffuseIntensity"))||(q=Q(b,"Refl"));q.Ea=b.diffuse_intensity;B.push(q);m.push(q);var J=Q(b,"Normal");J.Ea.splice(3);B.push(J);m.push(J);"MATERIAL_EXT"==f?((q=Q(b,"Emit"))||(q=v("Emit","Emit",0)),B.push(q),m.push(q),(q=Q(b,"Translucency"))?(q.Ea=0,q.name="Translucency",q.identifier="Translucency"):q=v("Translucency",
"Translucency",0),m.push(q),(q=Q(b,"Translucency"))?(q.Ea=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams"):q=v("TranslucencyParams","TranslucencyParams",[0,0,0,0]),m.push(q),n=Q(b,"Reflectivity"),q=Q(b,"Ray Mirror"),n?(q=n,n="Reflectivity"):q?n="Ray Mirror":(q=n,n="Reflectivity"),q||(q=v(n,n,0)),m.push(q),R.push(q),(q=Q(b,"SpecTra"))||(q=v("SpecTra","SpecTra",0)),m.push(q),R.push(q),(q=Q(b,"Alpha"))||(q=v("Alpha","Alpha",b.alpha)),m.push(q),R.push(q),r.push(W(b,"Diffuse")),
r.push(W(b,"Spec")),p.push(["MATERIAL_EXT",1]),g.push(["MATERIAL_EXT",1])):(B.push(v("emit_intensity","emit_intensity",0)),R.push(v("reflect_factor","reflect_factor",0)),R.push(v("specular_alpha","specular_alpha",0)),R.push(v("alpha_in","alpha_in",0)),r.push(v("diffuse_out","diffuse_out",0)),r.push(v("spec_out","spec_out",0)),p.push(["MATERIAL_EXT",0]),g.push(["MATERIAL_EXT",0]));da.push(V(P("param_MATERIAL_alpha"),b.alpha));da.push(V(P("param_MATERIAL_spec_alpha"),b.specular_alpha));n=r;p.push(["USE_MATERIAL_NORMAL",
J.ab|0]);b.use_diffuse&&(p.push(["USE_MATERIAL_DIFFUSE",1]),g.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&g.push(["USE_MATERIAL_SPECULAR",1]);var q=[],y=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":J=b.specular_hardness;break;case "WARDISO":J=b.specular_slope;break;case "TOON":J=b.specular_toon_size;y=b.specular_toon_smooth;break;case "BLINN":J=b.specular_ior;y=b.specular_hardness;break;default:va.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),J=b.specular_hardness}var ga,z;switch(b.diffuse_shader){case "LAMBERT":z=ga=0;break;case "OREN_NAYAR":ga=b.roughness;z=0;break;case "FRESNEL":ga=b.diffuse_fresnel;z=b.diffuse_fresnel_factor;break;case "MINNAERT":ga=b.darkness;z=0;break;case "TOON":ga=b.diffuse_toon_size;z=b.diffuse_toon_smooth;break;default:va.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),z=ga=0}q.push(V(P("param_MATERIAL_diffuse"),[ga,z],2));q.push(V(P("param_MATERIAL_spec"),[b.specular_intensity,
J,y],3));p.push(["SHADELESS_MAT",b.use_shadeless?1:0]);J={name:b.name,value:{$s:b.specular_shader,mr:b.diffuse_shader,Ne:b.use_shadeless,rn:b.use_tangent_shading}};p={name:b.name,value:{$s:b.specular_shader,mr:b.diffuse_shader,Ne:b.use_shadeless,rn:b.use_tangent_shading},nX:{name:"material_begin",type:"MATERIAL_BEGIN",M:B,fb:S,qb:q,data:J,Rb:p,xi:[]},oX:{name:"material_end",type:"MATERIAL_END",M:R,fb:r,qb:da,data:J,Rb:g,xi:[]}};break;case "BSDF_DIFFUSE":m=Z(b);l.push(["USE_NORMAL_IN",m[2].ab|0]);
n=W(b,"BSDF");g=n.ab;n=[n,v("d_color","d_color",[0,0,0],g),v("d_roughness","d_roughness",0,g),v("s_color","s_color",[0,0,0],g),v("s_roughness","s_roughness",0,g),v("metalness","metalness",0,g),v("normal","normal",[0,0,0],g),v("e_color","e_color",[0,0,0],g),v("emisson","emisson",0,g)];break;case "BSDF_GLOSSY":m=Z(b);l.push(["USE_NORMAL_IN",m[2].ab|0]);n=W(b,"BSDF");g=n.ab;n=[n,v("d_color","d_color",[0,0,0],g),v("d_roughness","d_roughness",0,g),v("s_color","s_color",[0,0,0],g),v("s_roughness","s_roughness",
0,g),v("metalness","metalness",1,g),v("normal","normal",[0,0,0],g),v("e_color","e_color",[0,0,0],g),v("emisson","emisson",0,g)];break;case "EMISSION":m=Z(b);n=W(b,"Emission");g=n.ab;n=[n,v("d_color","d_color",[0,0,0],g),v("d_roughness","d_roughness",0,g),v("s_color","s_color",[0,0,0],g),v("s_roughness","s_roughness",0,g),v("metalness","metalness",1,g),v("normal","normal",[0,0,0],g),v("e_color","e_color",[0,0,0],g),v("emisson","emisson",1,g)];break;case "MATH":switch(b.operation){case "ADD":f="MATH_ADD";
break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";break;case "ARCCOSINE":f="MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";break;
case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return va.error("Unsupported MATH operation: "+b.operation),null}l.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);m=Z(b);n=Y(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f=
"MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;case "DODGE":f="MIX_RGB_DODGE";break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return va.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}l.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);m=Z(b);n=Y(b);break;case "OUTPUT":m=Z(b);n=[];break;case "OUTPUT_MATERIAL":Z(b);m=Q(b,"Surface");n=m.ab;p=[m,v("d_color","d_color",[0,0,0],n),v("d_roughness","d_roughness",0,n),v("s_color","s_color",[0,0,0],n),v("s_roughness","s_roughness",0,n),v("metalness","metalness",0,n),v("normal","normal",
[0,0,0],n),v("e_color","e_color",[0,0,0],n),v("emission","emission",0,n)];g=[v("E","E",[0,0,0],!0),v("A","A",[0,0,0],!0),v("D","D",[0,0,0],!0),v("S","S",[0,0,0],!0),v("normal","normal",[0,0,0],!0),v("bsdf_params","bsdf_params",[0,0,0,0],!0),v("shadow_factor","shadow_factor",0,!0),v("s_color","s_color",[0,0,0],!0),v("metalness","metalness",0,!0),v("e_color","e_color",[0,0,0],!0),v("emission","emission",0,!0)];B=[v("color","color",[0,0,0],!0),v("specular","specular",[0,0,0],!0),v("normal","normal",
[0,0,0],!0),v("s_color","s_color",[0,0,0],!0),v("metalness","metalness",0,!0),v("e_color","e_color",[0,0,0],!0),v("emission","emission",0,!0)];S=[];m=p;n=S;p={name:b.name,value:{JR:"BSDF_COMPUTE"},HR:{name:"bsdf_begin",type:"BSDF_BEGIN",M:p,fb:g,qb:[],data:null,Rb:[],xi:[]},IR:{name:"bsdf_end",type:"BSDF_END",M:B,fb:S,qb:[],data:null,Rb:[],xi:[]}};break;case "RGB":g=b.name;g={name:"-1",value:g};u.push(g);n.push(W(b,"Color"));break;case "SEPRGB":case "SEPHSV":m=Z(b);n=Y(b);break;case "TEX_ENVIRONMENT":(g=
b.image)?(f="TEXTURE_ENVIRONMENT","NONE"==b.color_space?l.push(["NON_COLOR",1]):l.push(["NON_COLOR",0]),m.push(Q(b,"Vector")),n.push(W(b,"Color")),B=P("param_TEXTURE_texture"),u.push(V(B)),p=ma.BH(128),p.source="ENVIRONMENT_MAP",ma.gG(p,g),p={name:B,value:p}):f="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(g=b.image){f="TEXTURE_COLOR";"NONE"==b.color_space?l.push(["NON_COLOR",1]):l.push(["NON_COLOR",0]);l.push(["CONVERT_UV",0]);for(B=0;4>B;++B)B?(q=v("Vector"+B,"Vector"+B,[0,0,0],!1),S=v("Color"+B,"Color"+
B,[0,0,0],!1),R=v("Alpha"+B,"Alpha"+B,0,!1)):(q=Q(b,"Vector"),S=W(b,"Color"),R=W(b,"Alpha")),m.push(q),n.push(S),n.push(R);B=P("param_TEXTURE_texture");u.push(V(B));p=ma.Yl(ma.Hh,!1);p.repeat="REPEAT"==b.extension;p.source="IMAGE";ma.gG(p,g);p={aA:b.name,name:B,value:p}}else f="TEXTURE_EMPTY";break;case "TEXTURE":f=ca(b);if("TEXTURE_EMPTY"==f)n.push(W(b,"Color")),n.push(W(b,"Normal")),n.push(W(b,"Value"));else if("TEXTURE_ENVIRONMENT"==f)m.push(Q(b,"Vector")),n.push(W(b,"Color")),n.push(W(b,"Value"));
else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==b.texture.type)return va.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==f&&(g=!1,(B=b.texture.image)&&"Non-Color"==B.colorspace_settings_name&&(g=!0),l.push(["NON_COLOR",Number(g)]),l.push(["CONVERT_UV",1]));for(B=0;4>B;++B)g="TEXTURE_COLOR"==f?"Color":"Normal",B?(q=v("Vector"+B,"Vector"+B,[0,0,0],!1),S=v(g+B,g+B,[0,0,0],!1),R=v("Value"+B,"Value"+B,0,!1)):(q=Q(b,"Vector"),S=W(b,g),R=W(b,"Value")),m.push(q),n.push(S),
n.push(R)}"TEXTURE_EMPTY"!=f&&(B=P("param_TEXTURE_texture"),u.push(V(B)),p=b.texture.s,p={aA:b.texture.name,name:B,value:p});break;case "VALTORGB":m=Z(b);n=Y(b);p={value:b};g=b.color_ramp.interpolation;"CONSTANT"!=g&&"LINEAR"!=g&&va.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";g=b.name;g={name:"-1",value:g};u.push(g);n.push(W(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";break;case "AVERAGE":f=
"VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return va.error("Unsupported VECT_MATH operation: "+b.operation),null}m=Z(b);n=Y(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":l.push(["VECTOR_TYPE",na.O(0)]);break;case "VECTOR":l.push(["VECTOR_TYPE",na.O(1)]);break;case "NORMAL":l.push(["VECTOR_TYPE",na.O(2)]);break;default:return va.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}m=b.convert_from;n=b.convert_to;g=0;if("WORLD"==m)if("WORLD"==n)g=0;else if("OBJECT"==n)g=1;else if("CAMERA"==n)g=2;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==m)if("WORLD"==n)g=3;else if("OBJECT"==n)g=4;else if("CAMERA"==n)g=5;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==m)if("WORLD"==n)g=6;else if("OBJECT"==n)g=7;else if("CAMERA"==n)g=8;else return va.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return va.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;l.push(["CONVERT_TYPE",na.O(g)]);m=Z(b);n=Y(b);break;case "NORMAL_MAP":g=0;switch(b.space){case "TANGENT":g=0;break;case "OBJECT":g=1;break;case "WORLD":g=2;break;case "BLENDER_OBJECT":g=3;break;case "BLENDER_WORLD":g=4;break;default:return va.error("Unsupported NORMAL_MAP space: "+b.space),null}l.push(["SPACE",na.O(g)]);m.push(Q(b,"Strength"));m.push(Q(b,"Color"));n.push(W(b,"Normal"));break;
case "FRESNEL":J=Q(b,"Normal");m.push(Q(b,"IOR"));m.push(J);n.push(W(b,"Fac"));l.push(["USE_FRESNEL_NORMAL",J.ab|0]);break;case "LAYER_WEIGHT":J=Q(b,"Normal");m.push(Q(b,"Blend"));m.push(J);n=Y(b);l.push(["USE_NORMAL_IN",J.ab|0]);break;case "BUMP":J=Q(b,"Normal"),l.push(["INVERT",b.invert?1:0]),l.push(["USE_NORMAL_IN",J.ab|0]),Z(b),Y(b);default:m=Z(b),n=Y(b)}f={name:h,type:f,xi:k,M:m,fb:n,qb:u,data:p,Rb:l};h=L.nm(a);L.Pj(a,L.nm(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{f=b.outputs;for(u=k=0;u<f.length;u++)if(f[u].is_linked&&k++>c){f=!0;break a}f=!1}f=!f}return f||null!=ba(a,b,++c,d,e)?h:null}function K(a,b,c){for(var d=a.inputs,e=a.outputs,h=a.node_tree_name,f=0;f<b.length;f++){var k=d[f],n=b[f];if(!k||k.default_value instanceof Array!=n)return va.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',h,'".Processing as general node group.'),!1}for(f=0;f<c.length;f++)if(b=e[f],d=c[f],!b||b.default_value instanceof Array!=d)return va.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',h,'".Processing as general node group.'),!1;return!0}function G(a,b,c){var d=a.node_group.node_tree,e={},f;for(f in d)if("links"==f||"nodes"==f){e[f]=[];for(var h=0;h<d[f].length;h++){e[f][h]={};for(var k in d[f][h])if("links"==f){e[f][h][k]={};for(var n in d[f][h][k])e[f][h][k][n]=T(d[f][h][k][n])}else e[f][h][k]=T(d[f][h][k])}}else e[f]=T(d[f]);d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)f=u("Group input","GROUP_INPUT",[],a.inputs),h=u("Group output",
"GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(R.quality==ea.eq||R.pI)?{from_node:f,from_socket:f.outputs[1],to_node:h,to_socket:h.inputs[0]}:{from_node:f,from_socket:f.outputs[0],to_node:h,to_socket:h.inputs[0]},e.nodes=[f,h],e.links=[k];d=a.name;f=e.nodes;h=e.links;for(k=0;k<f.length;k++)f[k].name=oa(f[k].type,d,f[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=oa(h[k].from_node.type,d,h[k].from_node.name),h[k].to_node.name=oa(h[k].to_node.type,d,h[k].to_node.name);
return{FX:q(e,a.node_group.uuid,!0,b,c).Wa,GX:e.links}}function T(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ca.Rq(a):a}function P(a){Ea[a]||(Ea[a]=0);var b=a+"_"+Ea[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ea[a]++;return b}function X(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function x(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ka(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function ca(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var h=b[f];if(h.is_linked)switch(h.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:Ca.q("Unknown texture output")}}if(c)return d&&
va.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function Q(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ha(e)}return null}function W(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ha(e)}return null}function ha(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=Ca.wk(a)?a.slice(0):a;return{name:b,identifier:c,ab:d,Ea:a}}function v(a,b,c,d){return{name:a,identifier:b,ab:d,Ea:c}}function Z(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ha(a.inputs[c]);d.Ea.length&&d.Ea.splice(3);b.push(d)}return b}function Y(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ha(a.outputs[c]);b.push(d)}return b}function V(a,b,c){b=null===b||void 0===b?null:na.O(b,c);return{name:a,value:b}}function ta(a,b,c,d,e,f){var h=
[],k=f.from_socket.identifier;f=f.to_socket.identifier;var n=d.fb;for(d=0;d<n.length;d++)if(n[d].identifier==k){h.push(d);break}e=e.M;for(d=0;d<e.length;d++)if(e[d].identifier==f){h.push(d);break}2==h.length&&L.dd(a,b,c,h);return!0}function oa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function S(a){var b=[];L.pa(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function ga(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.FX,f=c[d].data.GX;if(!e)return!1;
L.pa(e,function(b,c){L.Pj(a,L.nm(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);ya(c[d],b,a)}return!0}function za(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function ua(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],h=null,k=0;k<b.length;k++)if(f.from_socket.identifier==b[k].to_socket.identifier){h=b[k];break}h?(f.from_node=h.from_node,f.from_socket=h.from_socket):
d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function la(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function da(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],h,k=0;k<c.M.length;k++)if(f.from_socket.identifier==c.M[k].identifier){h=c.M[k].Ea;break}for(var k=f,n=b,v=h,m=z(k.to_node,n),u=0;u<m.length;u++)for(var x=L.Va(n,m[u]),p=0;p<x.M.length;p++){var g=x.M[p];if(g.identifier==k.to_socket.identifier){x=g.Ea instanceof
Object?0:1;if((v instanceof Object?0:1)==x)g.Ea=v;else switch(x){case 0:g=g.Ea;g[0]=g[1]=g[2]=v;break;case 1:g.Ea=(v[0]+v[1]+v[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function ya(a,b,c){for(var d=a.name,e=[],f=[],h=[],k=[],n=0;n<b.length;n++){var v=b[n];za(v.from_node,d,v,e,h,k);za(v.to_node,d,v,f,h,k)}f=ua(b,f,h);e=ua(b,k,e);la(b,f);da(b,c,a,f);if(e.length){var m;L.pa(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});da(b,c,m,e)}}function pa(a){var b=[],c=[];L.pa(a,
function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=ma.wU(b,ma.pO);for(var h=0;h<b.length;h++)b[h].Rb.push(["NODE_TEX_ROW",na.O((d+.5)/f)]),d++}if(c.length)for(e=ma.AU(c,ma.VE),h=0;h<c.length;h++)c[h].Rb.push(["NODE_TEX_ROW",na.O((d+.5)/f)]),d++;h=null;a&&e?(h=new Uint8Array(a.length+e.length),h.set(a),h.set(e,a.length)):h=a?a:e;a=h?ma.AH(h,ma.VE):null;for(h=0;h<b.length;h++)b[h].data.jb=a;
for(h=0;h<c.length;h++)c[h].data.jb=a}function N(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ea=g("__config");g("__debug");var L=g("__graph"),Aa=g("__mat3"),xa=g("__mat4"),ia=g("__objects"),va=g("__print"),na=g("__shaders"),Oa=g("__scenes"),Ca=g("__util"),qa=g("__vec3"),ma=g("__textures"),Ea={},wa={},Qa={},Ja={},Ma=0;new Float32Array(4);var R=ea.B;a.D2=0;a.yQ=1;a.xQ=2;a.wQ=3;a.C2=4;a.vQ=5;a.uQ=6;a.tQ=7;a.B2=8;a.iP=0;
a.hP=1;a.q2=2;a.gP=3;a.p2=4;a.eJ=function(a){return wa[a]};a.zS=function(a){delete wa[a]};a.HS=q;a.HA=function(a,c,d){var e=Oa.A();a=l(a,"MAIN",e.uuid);if(a in Qa)return Qa[a];var e=L.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},h=ba(e,f,0,c,null),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=ba(e,f,0,c,null);b(e,d,h,f,[[h,[8,10]],[h,[9,6]]],c);m(e);return Qa[a]=e};a.Ju=function(a){var b=[],c={};Ea={};var d=L.oE(a);L.pa(d,function(a,d){var e;e=[];for(var f=[],h=[],k=[],n=[],v=[],m=0;m<
d.M.length;m++){var x=d.M[m];if(x.ab)e.push(null),f.push(null);else{e.push(P("in_"+d.type+"_"+x.identifier.replace(/\./g,"")));var u=na.O(x.Ea,0);R.OD&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==x.identifier||"Color2"==x.identifier||"Fac"==x.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==x.identifier||"Value_001"==x.identifier||"Value.001"==x.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==x.identifier||"Vector.001"==x.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||
0<=d.type.indexOf("MATERIAL_BEGIN"))&&(x=u,x=x.replace(/(,)/g,"$1 "),x=x.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),x=x.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),u=x=x.replace(/\s+/g,""));f.push(u)}}for(m=0;m<d.fb.length;m++)x=d.fb[m],x.ab?h.push(null):h.push(P("out_"+d.type+"_"+x.identifier.replace(/\./g,"")));for(m=0;m<d.qb.length;m++)x=d.qb[m],k.push(x.name),n.push(x.value);for(m=0;m<d.xi.length;m++)v.push(d.xi[m].name);e={id:d.type,M:e,XB:f,fb:h,qb:k,Pw:n,xi:v,Rb:JSON.parse(JSON.stringify(d.Rb))};
b.push(e);c[a]=e});L.Dg(d,function(a,b,e){var f=L.Va(d,a);L.Va(d,b);var h=f.fb[e[0]];a=c[a].fb;b=c[b].M;f=a[e[0]]||P("out_"+f.type+"_"+h.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.fH=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.ua=function(){for(var a in wa)delete wa[a];for(a in Qa)delete Qa[a];for(var b in Ja)delete Ja[b];Ma=0}};b4w.module.__debug=function(a,g){function q(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function c(){var a=m.BB();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=y;return b&&b.debug_view_mode==a.Pp}function w(a,b,c){var d=m.BB(),e=0;if(d)for(c&&d.endQuery(),c=0;c<a.length;c++){var f=a[c],h=d.DI(f),k=I.getParameter(d.CI());h&&!k&&(e=d.EI(f)/1E6,b&&(e=A.Zb(e,b,1,10)),a.splice(c,1),c--)}else e=performance.now()-
a.pop(),b&&(e=A.Zb(e,b,1,10));return e}function t(a,b){D(a)||A.q("Structure assertion failed: invalid first object value");D(b)||A.q("Structure assertion failed: invalid second object value");l(a,b)||A.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||A.bC(a)||a instanceof Array)){for(var c in a)D(a[c])||A.q("Structure assertion failed: invalid value for key in the first object: "+c),c in b||A.q("Structure assertion failed: missing key in the first object: "+
c);for(c in b)D(b[c])||A.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||A.q("Structure assertion failed: missing key in the second object: "+c),l(a[c],b[c])||A.q("Structure assertion failed: incompatible types for key "+c)}}function D(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function l(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;
c=A.bC(a);d=A.bC(b);if(c&&!d||!c&&d)return!1}return!0}var r=g("__compat"),p=g("__config"),m=g("__extensions"),f=g("__graph"),n=g("__objects"),e=g("__print"),z=g("__scenes"),M=g("__subscene"),E=g("__textures"),F=g("__time"),A=g("__util"),O=p.B,H={},I=null,C={},h=[],k=-1,J=-1,y=null,d=null,B=!1,u={};a.Gt=0;a.My=1;a.Ht=2;a.Ly=3;a.Ft=4;a.Ky=5;a.Jy=6;a.Pp=7;a.Tf=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;
for(c in b){var d=b[c];d in a&&(H[a[d]]=d)}I=a};a.RY=function(a){y=a};a.w5=function(){return y};a.GU=function(a,b,c,d,e){u[a]||(u[a]={yZ:b,Ve:{}});c in u[a].Ve||(u[a].Ve[c]=d);e&&(u[a].Ve[c]=0)};a.QG=function(){var a=0,b;for(b in u)for(var c in u[b].Ve)a+=u[b].Ve[c];return a};a.AM=function(){var a={},b;for(b in u)for(var c in u[b].Ve){var d=u[b].Ve[c];if(d){var f=u[b].yZ;f in a||(a[f]={pE:0,Ve:{}});c in a[f].Ve||(a[f].Ve[c]=0);a[f].Ve[c]+=d;a[f].pE+=d}}for(f in a){e.groupCollapsed(f,a[f].pE);for(c in a[f].Ve)e.ce(c,
a[f].Ve[c]);e.groupEnd()}};a.iL=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),c=0,d=0,f=n.Ub(z.Yh(),"MESH",n.oc),h=0;h<f.length;h++)for(var k=0;k<f[h].I.length;k++)for(var m=0;m<f[h].I[k].X.length;m++){var u=A.Ph(f[h].I[k].X[m]),g=u.hb.Eg+"/"+u.hb.bf;u["shaders_info.directives"]=u.hb.Si;u["shaders_info.node_elements"]=u.hb.ug;delete u.hb;for(var p=0;p<b.length;p++)delete u[b[p]];
if(f[h].Ra)d++;else{c++;u.type in a||(a[u.type]={});g in a[u.type]||(a[u.type][g]={});for(var v in u)v in a[u.type][g]||(a[u.type][g][v]=[]),p=JSON.stringify(u[v]),-1==a[u.type][g][v].indexOf(p)&&a[u.type][g][v].push(p)}}e.group("Batches statistics:");e.ce("STATIC/DYNAMIC count:",c+"/"+d);e.group("STATIC batches diversity:");for(var l in a)for(g in a[l]){b=[];for(v in a[l][g])1<a[l][g][v].length&&b.push([v,a[l][g][v]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){e.groupCollapsed(l+" "+g);for(h=0;h<b.length;h++)e.ce(b[h][1].length,b[h][0],b[h][1]);e.groupEnd()}}e.groupEnd();e.groupEnd()};a.mA=function(a){if(O.gl_debug){var b=I.getError();b!=I.NO_ERROR&&(b in H?A.q("GL Error: "+b+", gl."+H[b]+" ("+a+")"):A.q("Unknown GL error: "+b+" ("+a+")"))}};a.fS=function(){if(O.gl_debug||O.eH)switch(I.checkFramebufferStatus(I.FRAMEBUFFER)){case I.FRAMEBUFFER_COMPLETE:break;case I.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case I.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case I.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case I.FRAMEBUFFER_UNSUPPORTED:e.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case I.h1:e.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:e.error("FRAMEBUFFER CHECK FAILED")}};a.kS=function(){if(-1!=
k)return k;I.bindFramebuffer(I.FRAMEBUFFER,I.createFramebuffer());var a=E.Yl(E.Al,!1);E.resize(a,1,1);I.framebufferTexture2D(I.FRAMEBUFFER,I.DEPTH_ATTACHMENT,a.mb,a.rb,0);I.checkFramebufferStatus(I.FRAMEBUFFER)!=I.FRAMEBUFFER_COMPLETE?(k=!0,e.warn("depth-only issue was found")):k=!1;I.bindFramebuffer(I.FRAMEBUFFER,null);return k};a.pS=function(){if(1==O.Fc)return!1;if(-1!=J)return J;I.bindRenderbuffer(I.RENDERBUFFER,I.createRenderbuffer());I.renderbufferStorageMultisample(I.RENDERBUFFER,O.Fc,I.RGBA8,
1,1);var a=I.getRenderbufferParameter(I.RENDERBUFFER,I.RENDERBUFFER_SAMPLES);a!=O.Fc?(J=!0,e.warn("multisample issue was found: requested "+O.Fc+", got "+a),I.getError()==I.INVALID_OPERATION&&e.warn("the error from multisample issue detected, ignoring")):J=!1;I.bindRenderbuffer(I.RENDERBUFFER,null);return J};a.mS=function(){return r.nA("Firefox")&&I.getError()==I.OUT_OF_MEMORY?(e.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.yL=function(a,b,c){O.gl_debug&&(c=q(c),e.error("shader compilation failed:\n"+
c+"\n"+I.getShaderInfoLog(a)+" ("+b+")"))};a.vY=function(a,b,c,d){O.gl_debug&&(c=q(c),d=q(d),e.error("shader linking failed:\n"+c+"\n\n\n"+d+"\n"+I.getProgramInfoLog(a)+" ("+b+")"))};a.oD=function(a){if(O.show_hud_debug_info||a.type==M.cq)a.fB||a.$l.push(c())};a.qY=function(a){"MAIN"==a.type&&b()&&a.$l.push(c())};a.pD=function(a){if((O.show_hud_debug_info||a.type==M.cq)&&!a.fB){var b=w(a.$l,a.Ff,!0);b&&(a.Ff=b)}};a.rY=function(a){if("MAIN"==a.type&&b()){var c=w(a.$l,a.Ff,!0);c&&(a.Ff=c)}};a.bK=b;
a.eY=function(a){var b=w(a.$l,a.Ff,!1);b&&(a.Ff=b)};a.H4=function(a){C[a]=a in C?C[a]+1:1};a.update=function(){for(var a in C)e.log(a,C[a]),C[a]=0};a.jv=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(A.wk(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}h.push(a)};a.EK=function(){for(var a=1,b=0;b<h.length;b++){var c=h[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],A.wk(a))for(var d=0;d<a.length;d++)c.push(a[d]);
else c.push(arguments[b]);h.push(c)};var ba=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.jL=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),f=0;f<h.length;f++){var k=h[f];a=k[0];if(!(a<d)){var n=String(k[1]);c[n]||(c[n]=ba[b++%ba.length]);a=["%c"+(a/1E3).toFixed(6),c[n],n];for(n=2;n<k.length;n++)a.push(k[n]);e.log.apply(this,a)}}h.splice(0)};a.$C=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-1E3*a),d=0;d<h.length;d++){var f=
h[d];a=f[0];if(!(a<c))for(var k=2;k<f.length;k++){var n=String(f[1]);3<f.length&&(n+="_"+String(k-2));b[n]||(b[n]=n+"\n");b[n]+=String(a)+" "+f[k]+"\n"}}a="";for(n in b)a+=b[n]+"\n\n";e.log(a);h.splice(0)};a.v3=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.dH=function(a){if(A.wk(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.b3=function(a,b){a.constructor!=b&&A.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.d3=t;a.e3=function(a){B?t(a,d):B=!0;d=null!=a&&"object"==typeof a?A.Rq(a):a};a.mI=function(a,
b,c,d,e){(a=a||null)||A.q("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&A.q("Max percentage must be less than 100");0>c&&A.q("Min percentage must be greater than 0");c>d&&A.q("Max percentage must be greater than min percentage");var f=F.Oj(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(F.Pn(f),e&&e())})};a.Z7=function(a){return f.UT(a,function(a,b){var c=b.type+"("+b.name+")",d=b.M,c=c+"\n\nINPUTS:";if(d.length)for(var e=0;e<d.length;e++)c+="\n"+d[e].identifier+": ",c=d[e].ab?
c+"linked":c+d[e].Ea;else c+="\n---";d=b.fb;c+="\n\nOUTPUTS:";if(d.length)for(e=0;e<d.length;e++)c+="\n"+d[e].identifier+": ",c=d[e].ab?c+("linked(default "+d[e].Ea+")"):c+"not used";else c+="\n---";e="";switch(b.type){case "GEOMETRY_UV":e="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":e="\ntexture: "+b.data.value.name+"\n("+b.data.value.oo+")"}""==e&&(e="\n---");return c=c+"\n\nDATA:"+e},function(b,c,d){b=f.Va(a,b);c=f.Va(a,c);return b.fb[d[0]].identifier+"\n==>\n"+
c.M[d[1]].identifier})};a.wv=function(){return I};a.ua=function(){y=null;u={}};a.reset=function(){I=null}};b4w.module.__compat=function(a,g){function q(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var w=g("__config"),t=g("__debug"),D=g("__extensions"),
l=g("__print"),r=g("__renderer"),p="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.qF=256;var m=w.Fl,f=w.B,n=w.kr,e=w.context,z=w.Mi,M=w.Y,E=w.C,F=w.Rd;a.$T=function(a){a.getError()==a.INVALID_ENUM&&l.warn("Possible Tegra invalid enum issue detected, ignoring")};a.bM=function(g,O){function H(a){O&&l.warn(a)}z.pX=g.getParameter(g.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
z.tw=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS);z.xC=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);z.uw=g.getParameter(g.MAX_VARYING_VECTORS);z.yC=g.getParameter(g.MAX_VERTEX_ATTRIBS);z.CK=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS);z.ms=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS);z.ej=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE);z.uC=g.getParameter(g.MAX_RENDERBUFFER_SIZE);z.Ec=g.getParameter(g.MAX_TEXTURE_SIZE);z.zC=g.getParameter(g.MAX_VIEWPORT_DIMS);f.gc&&!n.enabled&&(f.Yq=!0);f.gc?(f.Fc=
Math.min(f.Fc,g.getParameter(g.MAX_SAMPLES)),q("Firefox")&&(H("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),f.eH=!0),q("Windows")&&q("Chrome")&&(H("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),f.Fc=1)):f.Fc=1;q("Firefox")&&"NONE"!==f.stereo&&(H("Firefox and Stereo rendering detected, disable texture reusage"),f.nI=!0);if(f.gc&&t.pS()||q("Firefox"))H("Firefox detected, disabling multisample"),f.Fc=1;r.UY();var I=Boolean(D.rV());
q("Firefox/28.0")&&(q("Linux")||q("Macintosh"))&&(H("Firefox 28 detected, applying depth hack"),I=!1);q("Windows Phone")||(q("iPad")||q("iPhone")?(H("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),e.alpha||(f.background_color[3]=1),f.GL=!0,f.YN=!0,f.smaa=!1,f.ssao=!1,f.precision="highp",f.WB=!0,Boolean(D.jJ())&&F.Yw&&(f.Zq="pvr")):q("Mac OS X")&&q("Safari")&&
!q("Chrome")&&(H("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),f.FL=!0,M.uG=!0,M.lH=!0));q("Windows")&&(q("Chrome/40")||q("Firefox/33")||q("Firefox/34")||q("Firefox/35")||q("Firefox/36"))&&(H("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.qA=!0);q("Chrome")&&!c()&&w.YJ()&&(H('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
f.kH=!0);q("Mac OS X")&&(f.rw=!0,H("OS X detected, applying shadows hack."));c()&&(H("Mobile detected, applying various hacks for video textures."),f.is_mobile_device=!0,q("iPad")||q("iPhone")||q("Windows Phone")||(H("Mobile (not iOS) detected, disable playback rate for video textures."),M.cI=!0));(q("Firefox/35.0")||q("Firefox/36.0"))&&q("Windows")&&(H("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.zM=!0);if(q("iPhone")||b()||q("Edge"))H("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
f.Qs=!0;10>z.uw&&(H("Not enough varyings, disable shadows on blend objects"),f.cB=!0);q("Windows Phone")&&(H("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),f.debug_view=!1,f.precision="highp",f.$i=!1,f.ssao=!1,f.smaa=!1,f.shadows=!1,f.reflections=!1,f.refractions=!1,f.nL=!1);if(q("UCBrowser")||q("Chrome")&&q("Nexus")&&f.is_mobile_device)H("Mobile Nexus Chrome or UCBrowser detected, disable workers."),E.st=!1;var C=D.Av();if(C){var h=
g.getParameter(C.UNMASKED_VENDOR_WEBGL),C=g.getParameter(C.UNMASKED_RENDERER_WEBGL),k=/\b4\d{2}\b/;-1<h.indexOf("ARM")&&k.test(C)&&(H("ARM Mali-400 series detected, applying depth and frames blending hacks"),I=!1,m.tI=!0);-1<h.indexOf("ARM")&&-1<C.indexOf("Mali-T604")&&(H('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),f.precision="highp",f.shadows=!1);-1<h.indexOf("ARM")&&-1<C.indexOf("Mali-T760")&&(H('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),f.precision=
"highp",f.ssao=!1,f.Bx=!0,f.gc&&(f.Fc=1,H("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<h.indexOf("Qualcomm")&&-1<C.indexOf("Adreno")&&(H("Qualcomm Adreno detected, applying shader constants hack."),f.OD=!0,-1<C.indexOf("305")&&(H('Qualcomm Adreno305 detected, set "highp" precision.'),f.precision="highp"),-1<C.indexOf("330")&&(H('Qualcomm Adreno330 detected, set "highp" precision.'),f.precision="highp"),-1<C.indexOf("420")&&(H("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
z.Ec=4096,z.ej=4096));-1<h.indexOf("NVIDIA")&&-1<C.indexOf("Tegra 3")&&(H("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.pI=!0);q("Windows")&&q("Chrome")&&!q("Edge")&&(C.match(/NVIDIA GeForce 8..0/)||C.match(/NVIDIA GeForce 9..0/)||C.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(H("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),z.ej=a.qF,f.sD=!0);-1<C.indexOf("AMD")&&q("Windows")&&q("Chrome")&&
(f.Lz=!0);-1<C.indexOf("PowerVR")&&(H("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),f.sD=!0,f.Bx=!0,f.shadows=!1);h="";for(k=0;k<p.length;k++)if(-1<C.indexOf(p[k])){h=p[k];break}h&&(H("Architecture "+h+" detected. Blending between frames and shadows on blend objects will be disabled."),f.Bx=!0,f.cB=!0)}0==z.CK&&(H("Vertex textures are not allowed. Disabling vertex textures"),f.nu=!1);I||(f.yr=!1,f.gd=!1,f.water_dynamic=
!1,f.Xk=!1,f.zx=!1,f.smaa=!1);f.JN=Boolean(D.nJ())||"pvr"==f.Zq;f.av=I;if(g.getShaderPrecisionFormat)var J=g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT);g.getShaderPrecisionFormat&&0!==J.precision||(f.precision="mediump");if(b()&&q("Touch")||q("Edge"))H("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),f.no=!0;if(b()||q("Edge"))f.TJ=!0;c()&&q("Firefox")&&(l.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
f.BC=!0,z.Ec=4096,z.ej=4096);q("Edge")&&(H("Microsoft Edge detected, set up new minimal texture size."),f.ur=!0)};a.nA=q;a.$e=c;a.eR=function(){q("Firefox/35.0")&&q("Windows")&&(l.warn("Windows/Firefox 35 detected, forcing context's alpha"),w.context.alpha=!0)};a.Zr=b};b4w.module.__renderer=function(a,g){function q(a){for(var c=a.p,d=a.Qa,n=null,m=M.jc(c.n,ba),g=0;g<d.length;g++){var l=d[g];if(l.dc){var B=l.zb,l=l.sa;if(B.ji!=n){k.useProgram(B.ji);for(var n=a,v=c,r=B,q=r.vN,V=q.length;V--;){var J=q[V];J.jo(k,J.hf,n,v)}if(r.ps&&!r.Ew)for(r.XC.length||t(r),r=r.XC,V=r.length;V--;)J=r[V],J.jo(k,J.hf,n,v);n=B.ji}for(v=0;v<l.length;v++)if(q=l[v],q.dc){r=q.kf;V=q.za;p.qY(V);p.bK()&&"DEBUG_VIEW"==V.type&&(V.ir=E.Zb(D.tR(V.Wn),V.ir,1,15));if(T.alpha_sort&&V.wf){var J=r,
q=q.Zv,y=m,S=V.Ca,ga=A.dist(y,q.kO),z=T.alpha_sort_threshold*Math.min(q.wR,1);if(ga>z||J.Cr)f.K_(S,q,J.n,y),A.copy(y,q.kO),J.Cr=!1}J=a;q=V;y=B;z=y.wN;for(S=z.length;S--;)ga=z[S],ga.jo(k,ga.hf,r,q);if(y.ps&&!y.Ew){y.xs.length||t(y);z=y.xs;for(S=z.length;S--;)ga=z[S],ga.jo(k,ga.hf,r,q);y.ps=!1}k.depthMask(q.Ua);q.$b?k.enable(k.CULL_FACE):k.disable(k.CULL_FACE);S=q.ya;ga=k;for(z=0;z<S.length;z++){var C=S[z];ga.activeTexture(ga.TEXTURE0+z);ga.bindTexture(C.mb,C.rb)}if(J.type==e.Lg){r=J;y=y.mn;S=r.p.wc.rb;
ga=r.Zl;for(z=0;6>z;z++)if(C=b(z),T.qA?(k.bindTexture(k.TEXTURE_CUBE_MAP,S),k.texImage2D(C,0,k.RGBA,1,1,0,k.RGBA,k.UNSIGNED_BYTE,h)):(k.uniformMatrix4fv(y.u_cube_view_matrix,!1,ga[z]),k.uniform4fv(y.u_sky_tex_fac,r.Gx),k.uniform3fv(y.u_sky_tex_color,r.Ex),k.uniform1f(y.u_sky_tex_dvar,r.Fx),k.uniform3fv(y.u_horizon_color,r.ne),k.uniform3fv(y.u_zenith_color,r.we),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,C,S,0),u(q,0)),r.Cw&&3!=z){var C=r,I=z,da=G;T.qA?da.set(h):(k.readPixels(191,191,
1,1,k.RGBA,k.UNSIGNED_BYTE,da),255!=da[0]&&255!=da[1]&&255!=da[2]||k.readPixels(191,220,1,1,k.RGBA,k.UNSIGNED_BYTE,da));var ya=da[0],K=da[1],da=da[2],ya=ya/255,K=K/255,da=da/255;2===I?(C.Be[3]=ya,C.Be[7]=K,C.Be[11]=da):2>I?(C.Be[4*I]=ya,C.Be[4*I+1]=K,C.Be[4*I+2]=da):(C.Be[4*(I-2)]=ya,C.Be[4*(I-2)+1]=K,C.Be[4*(I-2)+2]=da)}J.jr+=6}else u(q,r.ay),J.jr++;p.rY(V);p.bK()&&"MAIN"==V.type&&D.uR(V.id,V.Ff)}}}}function c(a){if(a){var b=(a.wb?k.COLOR_BUFFER_BIT:0)|(a.Bb?k.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case e.je:a=
C;break;case e.bd:a=O;break;case e.Bf:a=H;break;case e.xf:case e.Ai:case e.yn:a=I;break;case e.Kg:case e.gq:case e.cu:a=C;break;default:a=T.background_color}}else b=k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT,a=T.background_color;k.colorMask(!0,!0,!0,!0);k.depthMask(!0);k.clearColor(a[0],a[1],a[2],a[3]);k.clear(b)}function b(a){switch(a){case 0:return k.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return k.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return k.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return k.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return k.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return k.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function w(a){var b=m.KB(),c=a.vq,d=a.Ca,e=d.jd;a.Pe.length=0;var f=1,h;for(h in e)f=Math.max(f,e[h].frames);for(e=0;e<f;e++){h=b.createVertexArray();B(h);d.ng&&k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,d.ng);for(var n=0;n<d.Nd.length;n++){k.bindBuffer(k.ARRAY_BUFFER,d.Nd[n].ml);for(var v=0;v<c.length;v++){var u=c[v];u.UN==d.Nd[n].type&&(k.enableVertexAttribArray(u.hf),k.vertexAttribPointer(u.hf,u.Ic,u.Fv,u.Fv==k.FLOAT?
!1:!0,u.kn,u.wG+u.rI*e),y(u.hf,u.qr))}}B(null);a.Pe.push(h)}}function t(a){var b=a.mn,c=a.wN,d=a.xs,e=a.vN,f=a.XC;c.length=0;d.length=0;e.length=0;f.length=0;for(var h in b){var k=!1,n=null,m=null;switch(h){case "u_proj_matrix":n=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.xb)};k=!0;break;case "u_view_refl_matrix":n=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.fy)};k=!0;break;case "u_view_tsr":case "u_view_tsr_frag":n=function(a,b,c,d){d.rc?a.uniformMatrix3fv(b,!1,d.Hs):a.uniformMatrix3fv(b,!1,d.uf)};
k=!0;break;case "u_view_tsr_inverse":n=function(a,b,c,d){d.rc?a.uniformMatrix3fv(b,!1,d.cx):a.uniformMatrix3fv(b,!1,d.gy)};k=!0;break;case "u_shadow_cast_billboard_view_tsr":n=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.Vs)};k=!0;break;case "u_view_proj_prev":n=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.cD)};k=!0;break;case "u_view_proj_matrix":n=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.kd)};k=!0;break;case "u_view_proj_inverse":n=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ey)};k=!0;break;case "u_sky_vp_inverse":n=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Bg)};k=!0;break;case "u_camera_eye":case "u_camera_eye_frag":n=function(a,b,c,d){a.uniform3fv(b,M.jc(d.n,ba))};k=!0;break;case "u_camera_quat":n=function(a,b,c,d){a.uniform4fv(b,M.Zd(d.n,K))};k=!0;break;case "u_view_max_depth":n=function(a,b,c,d){a.uniform1f(b,d.far)};k=!0;break;case "u_camera_range":n=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":n=function(a,b,c,d){a.uniform4fv(b,d.Tu)};break;case "u_height":n=function(a,
b,c,d){a.uniform1f(b,d.height)};k=!0;break;case "u_pcf_blur_radii":n=function(a,b,c,d){a.uniform4fv(b,d.Ko)};break;case "u_dof_dist":n=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};k=!0;break;case "u_dof_front_start":n=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};k=!0;break;case "u_dof_front_end":n=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};k=!0;break;case "u_dof_rear_start":n=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};k=!0;break;case "u_dof_rear_end":n=
function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};k=!0;break;case "u_dof_bokeh_intensity":n=function(a,b,c,d){a.uniform1f(b,d.dof_bokeh_intensity)};k=!0;break;case "u_camera_direction":n=function(a,b,c,d){a.uniform3fv(b,d.direction)};k=!0;break;case "u_cam_water_depth":n=function(a,b,c){a.uniform1f(b,c.kA)};k=!0;break;case "u_waves_height":n=function(a,b,c){a.uniform1f(b,c.KE)};break;case "u_waves_length":n=function(a,b,c){a.uniform1f(b,c.LE)};break;case "u_fog_color_density":n=function(a,b,c){a.uniform4fv(b,
c.Ee)};break;case "u_fog_params":n=function(a,b,c){a.uniform4fv(b,c.jg)};break;case "u_underwater_fog_color_density":n=function(a,b,c){a.uniform4fv(b,c.yi)};break;case "u_bloom_key":n=function(a,b,c){a.uniform1f(b,c.zu)};break;case "u_bloom_edge_lum":n=function(a,b,c){a.uniform1f(b,c.yu)};break;case "u_time":n=function(a,b,c){a.uniform1f(b,c.time)};k=!0;break;case "u_wind":n=function(a,b,c){a.uniform3fv(b,c.Ij)};k=!0;break;case "u_sky_tex_dvar":n=function(a,b,c){a.uniform1f(b,c.Fx)};break;case "u_sky_tex_fac":n=
function(a,b,c){a.uniform4fv(b,c.Gx)};break;case "u_sky_tex_color":n=function(a,b,c){a.uniform3fv(b,c.Ex)};break;case "u_horizon_color":n=function(a,b,c){a.uniform3fv(b,c.ne)};break;case "u_zenith_color":n=function(a,b,c){a.uniform3fv(b,c.we)};break;case "u_environment_energy":n=function(a,b,c){a.uniform1f(b,c.$g)};break;case "u_sky_color":n=function(a,b,c){a.uniform3fv(b,c.dp)};break;case "u_rayleigh_brightness":n=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":n=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":n=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":n=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":n=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":n=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":n=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":n=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":n=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":n=function(a,b,c){a.uniform4fv(b,c.hs)};break;case "u_light_directions":n=function(a,b,c){a.uniform3fv(b,c.mC)};break;case "u_light_color_intensities":n=function(a,b,c){a.uniform4fv(b,c.gs)};break;case "u_sun_quaternion":n=function(a,b,c){a.uniform4fv(b,c.aN)};break;case "u_sun_intensity":n=function(a,b,c){a.uniform3fv(b,c.$M)};
break;case "u_sun_direction":n=function(a,b,c){a.uniform3fv(b,c.bE)};break;case "u_debug_view_mode":n=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":n=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":n=function(a,b,c){a.uniform1f(b,c.WH)};break;case "u_subpixel_jitter":n=function(a,b,c){a.uniform2fv(b,c.EW)};k=!0;break;case "u_subsample_indices":n=function(a,b,c){a.uniform4fv(b,c.FW)};k=!0;break;case "u_radial_blur_step":n=
function(a,b,c){a.uniform1f(b,c.bx)};break;case "u_god_rays_intensity":n=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":n=function(a,b,c){a.uniform1f(b,c.ip)};break;case "u_ssao_blur_discard_value":n=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};k=!0;break;case "u_ssao_influence":n=function(a,b,c){a.uniform1f(b,c.hp)};break;case "u_ssao_dist_factor":n=function(a,b,c){a.uniform1f(b,c.gp)};break;case "u_texel_size":n=function(a,b,c){a.uniform2fv(b,
c.lE)};k=!0;break;case "u_normal_offset":n=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":n=function(a,b,c){a.uniform4fv(b,c.$x)};k=!0;break;case "u_v_light_r":n=function(a,b,c){a.uniform4fv(b,c.Zx)};k=!0;break;case "u_v_light_tsr":n=function(a,b,c){a.uniformMatrix3fv(b,!1,c.FE)};k=!0;break;case "u_p_light_matrix0":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Tm[0])};k=!0;break;case "u_p_light_matrix1":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Tm[1])};k=!0;
break;case "u_p_light_matrix2":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Tm[2])};k=!0;break;case "u_p_light_matrix3":n=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Tm[3])};k=!0;break;case "u_outline_color":n=function(a,b,c){a.uniform3fv(b,c.oj)};break;case "u_draw_outline":n=function(a,b,c){a.uniform1f(b,c.hB)};k=!0;break;case "u_glow_mask_small_coeff":n=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};k=!0;break;case "u_glow_mask_large_coeff":n=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
k=!0;break;case "u_brightness":n=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":n=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":n=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":n=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":n=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":n=function(a,b,c){a.uniform4fv(b,c.cm)};break;case "u_chromatic_aberration_coefs":n=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":n=function(a,b,c){a.uniform1f(b,c.DK)};k=!0;break;case "u_motion_blur_decay_threshold":n=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};k=!0;break;case "u_model_tsr":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};k=!0;break;case "u_model_tsr_inverse":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.oy)};k=!0;break;case "u_transb":m=function(a,b,c){a.uniform4fv(b,c.ve)};k=!0;break;case "u_transa":m=function(a,b,c){a.uniform4fv(b,
c.Me)};k=!0;break;case "u_arm_rel_trans":m=function(a,b,c){a.uniform4fv(b,c.sq)};k=!0;break;case "u_arm_rel_quat":m=function(a,b,c){a.uniform4fv(b,c.rq)};k=!0;break;case "u_quat":m=function(a,b,c){a.uniform4fv(b,M.Zd(c.n,K))};k=!0;break;case "u_quatsb":m=function(a,b,c){a.uniform4fv(b,c.qe)};k=!0;break;case "u_quatsa":m=function(a,b,c){a.uniform4fv(b,c.Je)};k=!0;break;case "u_frame_factor":m=function(a,b,c){a.uniform1f(b,c.cf)};k=!0;break;case "au_center_pos":m=function(a,b,c){a.uniform3fv(b,c.Kq)};
k=!0;break;case "au_wind_bending_amp":m=function(a,b,c){a.uniform1f(b,c.Bh)};k=!0;break;case "au_wind_bending_freq":m=function(a,b,c){a.uniform1f(b,c.Ch)};k=!0;break;case "au_detail_bending_freq":m=function(a,b,c){a.uniform1f(b,c.Xg)};k=!0;break;case "au_detail_bending_amp":m=function(a,b,c){a.uniform1f(b,c.Wg)};k=!0;break;case "au_branch_bending_amp":m=function(a,b,c){a.uniform1f(b,c.Rg)};k=!0;break;case "u_node_values":m=function(a,b,c,d){a.uniform1fv(b,d.lj)};k=!0;break;case "u_node_rgbs":m=function(a,
b,c,d){a.uniform3fv(b,d.He)};k=!0;break;case "u_diffuse_color":m=function(a,b,c,d){a.uniform4fv(b,d.fg)};k=!0;break;case "u_diffuse_intensity":m=function(a,b,c,d){a.uniform1f(b,d.bm)};k=!0;break;case "u_diffuse_params":m=function(a,b,c,d){a.uniform2fv(b,d.Vd)};k=!0;break;case "u_emit":m=function(a,b,c,d){a.uniform1f(b,d.ek)};k=!0;break;case "u_ambient":m=function(a,b,c,d){a.uniform1f(b,d.Nj)};k=!0;break;case "u_specular_color":m=function(a,b,c,d){a.uniform3fv(b,d.gn)};k=!0;break;case "u_specular_alpha":m=
function(a,b,c,d){a.uniform1f(b,d.Zs)};k=!0;break;case "u_specular_params":m=function(a,b,c,d){a.uniform3fv(b,d.$k)};k=!0;break;case "u_reflect_factor":m=function(a,b,c,d){a.uniform1f(b,d.Qo)};k=!0;break;case "u_mirror_factor":m=function(a,b,c,d){a.uniform1f(b,d.ns)};k=!0;break;case "u_grass_map_dim":m=function(a,b,c,d){a.uniform3fv(b,d.me)};k=!0;break;case "u_grass_size":m=function(a,b,c,d){a.uniform1f(b,d.Pr)};k=!0;break;case "u_scale_threshold":m=function(a,b,c,d){a.uniform1f(b,d.Hv)};k=!0;break;
case "u_cube_fog":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Be)};break;case "u_jitter_amp":m=function(a,b,c,d){a.uniform1f(b,d.jw)};k=!0;break;case "u_jitter_freq":m=function(a,b,c,d){a.uniform1f(b,d.kw)};k=!0;break;case "u_wireframe_edge_color":m=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":m=function(a,b,c,d){a.uniform1f(b,d.Sq)};k=!0;break;case "u_batch_debug_id_color":m=function(a,b,c,d){a.uniform1f(b,d.Wu)};k=!0;break;case "u_batch_debug_main_render_time":m=
function(a,b,c,d){a.uniform1f(b,d.ir)};k=!0;break;case "u_refr_bump":m=function(a,b,c,d){a.uniform1f(b,d.dx)};k=!0;break;case "u_line_width":m=function(a,b,c,d){a.uniform1f(b,d.mw)};k=!0;break;case "u_lamp_light_positions":m=function(a,b,c,d){a.uniform3fv(b,d.xo)};break;case "u_lamp_light_directions":m=function(a,b,c,d){a.uniform3fv(b,d.es)};break;case "u_lamp_light_color_intensities":m=function(a,b,c,d){a.uniform3fv(b,d.ds)};break;case "u_halo_size":m=function(a,b,c,d){a.uniform1f(b,d.Qv)};k=!0;
break;case "u_halo_hardness":m=function(a,b,c,d){a.uniform1f(b,d.Nv)};k=!0;break;case "u_halo_rings_color":m=function(a,b,c,d){a.uniform3fv(b,d.Pv)};k=!0;break;case "u_halo_lines_color":m=function(a,b,c,d){a.uniform3fv(b,d.Ov)};k=!0;break;case "u_halo_stars_blend":m=function(a,b,c,d){a.uniform1f(b,d.Rv)};k=!0;break;case "u_halo_stars_height":m=function(a,b,c,d){a.uniform1f(b,d.Sv)};k=!0;break;case "u_fresnel_params":m=function(a,b,c,d){a.uniform4fv(b,d.Vi)};k=!0;break;case "u_texture_scale":m=function(a,
b,c,d){a.uniform3fv(b,d.si)};k=!0;break;case "u_parallax_scale":m=function(a,b,c,d){a.uniform1f(b,d.Io)};k=!0;break;case "u_color_id":m=function(a,b,c){a.uniform3fv(b,c.Xj)};k=!0;break;case "u_line_points":m=function(a,b,c,d){a.uniform3fv(b,d.L7)};k=!0;break;case "u_diffuse_color_factor":m=function(a,b,c,d){a.uniform1f(b,d.am)};k=!0;break;case "u_alpha_factor":m=function(a,b,c,d){a.uniform1f(b,d.Cl)};k=!0;break;case "u_specular_color_factor":m=function(a,b,c,d){a.uniform1f(b,d.fp)};k=!0;break;case "u_normal_factor":m=
function(a,b,c,d){a.uniform1f(b,d.Gw)};k=!0;break;case "u_normalmap0_scale":m=function(a,b,c,d){a.uniform2fv(b,d.mj[0])};k=!0;break;case "u_normalmap1_scale":m=function(a,b,c,d){a.uniform2fv(b,d.mj[1])};k=!0;break;case "u_normalmap2_scale":m=function(a,b,c,d){a.uniform2fv(b,d.mj[2])};k=!0;break;case "u_normalmap3_scale":m=function(a,b,c,d){a.uniform2fv(b,d.mj[3])};k=!0;break;case "u_foam_factor":m=function(a,b,c,d){a.uniform1f(b,d.ho)};k=!0;break;case "u_foam_uv_freq":m=function(a,b,c,d){a.uniform2fv(b,
d.nv)};k=!0;break;case "u_foam_mag":m=function(a,b,c,d){a.uniform2fv(b,d.mv)};k=!0;break;case "u_foam_scale":m=function(a,b,c,d){a.uniform2fv(b,d.zr)};k=!0;break;case "u_water_norm_uv_velocity":m=function(a,b,c,d){a.uniform1f(b,d.Gp)};k=!0;break;case "u_shallow_water_col":m=function(a,b,c,d){a.uniform3fv(b,d.Xo)};k=!0;break;case "u_shore_water_col":m=function(a,b,c,d){a.uniform3fv(b,d.Zo)};k=!0;break;case "u_water_shallow_col_fac":m=function(a,b,c,d){a.uniform1f(b,d.Yo)};k=!0;break;case "u_water_shore_col_fac":m=
function(a,b,c,d){a.uniform1f(b,d.$o)};k=!0;break;case "u_p_length":m=function(a,b,c,d){a.uniform1f(b,d.gb.nN)};k=!0;break;case "u_p_cyclic":m=function(a,b,c,d){a.uniform1i(b,d.gb.Ce)};k=!0;break;case "u_p_max_lifetime":m=function(a,b,c,d){a.uniform1f(b,d.gb.rK)};k=!0;break;case "u_p_fade_in":m=function(a,b,c,d){a.uniform1f(b,d.gb.gm)};k=!0;break;case "u_p_fade_out":m=function(a,b,c,d){a.uniform1f(b,d.gb.If)};k=!0;break;case "u_p_size":m=function(a,b,c,d){a.uniform1f(b,d.gb.size)};k=!0;break;case "u_p_alpha_start":m=
function(a,b,c,d){a.uniform1f(b,d.gb.eG)};k=!0;break;case "u_p_alpha_end":m=function(a,b,c,d){a.uniform1f(b,d.gb.dG)};k=!0;break;case "u_p_nfactor":m=function(a,b,c,d){a.uniform1f(b,d.gb.LC)};k=!0;break;case "u_p_gravity":m=function(a,b,c,d){a.uniform1f(b,d.gb.HJ)};k=!0;break;case "u_p_mass":m=function(a,b,c,d){a.uniform1f(b,d.gb.ei)};k=!0;break;case "u_p_color_ramp":m=function(a,b,c,d){a.uniform4fv(b,d.gb.sH)};k=!0;break;case "u_p_wind_fac":m=function(a,b,c,d){a.uniform1f(b,d.gb.fO)};k=!0;break;
case "u_p_time":m=function(a,b,c,d){a.uniform1f(b,d.gb.time)};k=!0;break;case "u_p_tilt":m=function(a,b,c,d){a.uniform1f(b,d.gb.lN)};k=!0;break;case "u_p_tilt_rand":m=function(a,b,c,d){a.uniform1f(b,d.gb.mN)};k=!0;break;case "u_position":m=function(a,b,c,d){a.uniform3fv(b,d.Dl)};k=!0;break;case "u_va_frame_factor":m=function(a,b,c){a.uniform1f(b,c.by)};k=!0;break;case "u_refl_plane":m=function(a,b,c){a.uniform4fv(b,c.rc)};k=!0;break;case "u_outline_intensity":m=function(a,b,c){a.uniform1f(b,c.qh)};
k=!0;break;case "u_obj_info":m=function(a,b,c,d){a.uniform3fv(b,d.Go)},k=!0}m&&(m={name:h,jo:m,hf:b[h]},k?c.push(m):d.push(m));n&&(m={name:h,jo:n,hf:b[h]},k?e.push(m):f.push(m))}if(d.length||f.length){a=a.YC;for(var u in a)delete a[u];for(u=0;u<d.length;u++)m=d[u],a[m.name]=m;for(u=0;u<f.length;u++)m=f[u],a[m.name]=m}else a.Ew=!0}var D=g("__batch"),l=g("__camera"),r=g("__config"),p=g("__debug"),m=g("__extensions"),f=g("__geometry"),n=g("__quat"),e=g("__subscene"),z=g("__textures"),M=g("__tsr"),E=
g("__util"),F=g("__version"),f=g("__geometry"),A=g("__vec3"),O=[1,1,1,1],H=[1,1,1,1],I=[0,0,0,1],C=[0,0,0,0],h=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var k=null,J=null,y=null,d=null,B=null,u=null,ba=new Float32Array(3),K=n.create(),G=new Uint8Array(4),T=r.B;a.Tf=function(a){var b=T.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);k=a};a.ao=function(a){if(a.dc)if(a.type==e.Fn){p.oD(a);var d=a.p;k.bindFramebuffer(k.READ_FRAMEBUFFER,d.Dr);k.bindFramebuffer(k.DRAW_FRAMEBUFFER,d.df);var f=0;d.wc&&(f|=k.COLOR_BUFFER_BIT);d.Ze&&(f|=k.DEPTH_BUFFER_BIT);k.blitFramebuffer(0,0,d.width,d.height,0,0,d.width,d.height,f,k.NEAREST);p.pD(a);p.mA("draw resolve")}else if(a.type==e.Cy)p.oD(a),d=a.p,k.bindFramebuffer(k.FRAMEBUFFER,
d.Dr),k.bindTexture(k.TEXTURE_2D,d.wc.rb),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,d.width,d.height,0),p.pD(a),p.mA("draw copy");else{p.oD(a);d=a.p;k.bindFramebuffer(k.FRAMEBUFFER,d.df);a.Rz&&(f=d.wc,k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,f.mb,f.rb,0));k.viewport(0,0,d.width,d.height);a.type!=e.ld&&a.type!=e.Se&&c(a);a.Lb?k.enable(k.BLEND):k.disable(k.BLEND);a.Ud?k.enable(k.DEPTH_TEST):k.disable(k.DEPTH_TEST);switch(a.type){case e.bd:k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);k.cullFace(k.BACK);break;case e.Pd:case e.Af:k.disable(k.POLYGON_OFFSET_FILL);k.cullFace(k.FRONT);break;case e.zf:k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(-4,-4);k.cullFace(k.BACK);break;case e.je:if(1<T.Fc||T.GL){k.enable(k.POLYGON_OFFSET_FILL);k.polygonOffset(-2,-2);break}default:k.disable(k.POLYGON_OFFSET_FILL),k.cullFace(k.BACK)}if(a.type==e.ld||a.type==e.Se)for(var d=a.p,f=d.wc.rb,h=0;6>h;h++){var n=b(h);d.Ob=a.Zl[h];M.Wi(d.Ob,d.uf);l.fA(d);k.framebufferTexture2D(k.FRAMEBUFFER,
k.COLOR_ATTACHMENT0,n,f,0);c(a);for(var n=a.Qa,m=0;m<n.length;m++)for(var u=0;u<n[m].sa.length;u++){var g=n[m].sa[u];g.dc=g.gB[h]}q(a)}else q(a);p.pD(a);p.mA("draw subscene: "+e.aE(a))}};a.clear=function(a){k.bindFramebuffer(k.FRAMEBUFFER,a.p.df);c(a)};a.kR=function(a){var b=a.vq;b.length=0;var c=a.Ca,d=c.jd,e=a.zb.attributes,h;for(h in e){var k=d[h],n=f.Or(h),m=f.EV(h),u=f.yJ(h);b.push({UN:n,Fv:m,hf:e[h],wG:k.offset*u,rI:1<k.frames?k.length*u:0,Ic:k.Ic,kn:k.kn*u,qr:k.qr})}if("DEBUG"==F.type())for(h in d)n=
f.Or(h),b=f.IY(c.Nd,n),b=c.Nd[b],k=a.hb.Eg+" | "+a.hb.bf,n=d[h].length*d[h].frames*f.yJ(h),p.GU(b.VT,k,h,n,h in e);T.Jz&&w(a)};a.pR=w;a.BS=function(a){for(var b=m.KB(),c=0;c<a.Pe.length;c++)b.deleteVertexArray(a.Pe[c]);a.Pe.length=0};a.DS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.oR=t;a.sG=function(a){var b=a.zb,c=a.ya;a=a.Md;k.useProgram(b.ji);for(var d=0;d<c.length;d++)k.uniform1i(b.mn[a[d]],d)};a.jD=function(a,b,c,d,e,f){d||(d=1);e||(e=1);f||(f=new Uint8Array(4*d*e));
f.length!=4*d*e&&E.q("read_pixels(): Wrong storage");k.bindFramebuffer(k.FRAMEBUFFER,a);k.readPixels(b,c,d,e,k.RGBA,k.UNSIGNED_BYTE,f);k.bindFramebuffer(k.FRAMEBUFFER,null);return f};a.G_=function(a){var b=a.zb;b.Ew||(k.useProgram(b.ji),b.xs.length||t(b),b=b.YC.u_cube_fog,b.jo(k,b.hf,null,a))};a.pY=function(a,b){var c=k.createFramebuffer();k.bindFramebuffer(k.FRAMEBUFFER,c);if(z.vo(a)){var d=a.Qe;k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.RENDERBUFFER,d)}else if(z.wo(a)){var e=
a,d=e.rb,e=e.mb==k.TEXTURE_CUBE_MAP?k.TEXTURE_CUBE_MAP_NEGATIVE_Z:e.mb;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,e,d,0)}z.vo(b)?(d=b.Qe,k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,d)):z.wo(b)&&(e=b,d=e.rb,e=e.mb,k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,e,d,0));p.fS();k.bindFramebuffer(k.FRAMEBUFFER,null);return c};a.oY=function(a,b,c,d,e){null==a?(k.bindFramebuffer(k.FRAMEBUFFER,a),k.viewport(0,0,d,e),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)):
(z.vo(b)?k.deleteRenderbuffer(b.Qe):z.wo(b)&&k.deleteTexture(b.rb),z.vo(c)?k.deleteRenderbuffer(c.Qe):z.wo(c)&&k.deleteTexture(c.rb),k.deleteFramebuffer(a))};a.s7=function(){};a.gU=function(a,b,c,d,e,f){a=a.rb;k.viewport(0,0,c,c);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,b,a,0);b=D.LA("FLIP_CUBEMAP_COORDS");a=b.zb;k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,e);var h=e=0;c!=d&&(e=1/(6*d),h=1/(4*d));k.uniform1i(a.mn.u_tex_number,f);k.uniform2fv(a.mn.u_delta,[e,h]);k.useProgram(a.ji);
u(b,0);k.bindTexture(k.TEXTURE_2D,null)};a.hU=function(a,b,c,d,e){k.bindFramebuffer(k.FRAMEBUFFER,d);d=a.rb;a=a.mb;k.bindTexture(a,d);k.viewport(0,0,b,c);k.texImage2D(a,0,k.RGBA,b,c,0,k.RGBA,k.UNSIGNED_BYTE,null);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,a,d,0);b=D.LA("NONE");c=b.zb;k.activeTexture(k.TEXTURE0);k.bindTexture(a,e);k.useProgram(c.ji);u(b,0);k.bindFramebuffer(k.FRAMEBUFFER,null);k.bindTexture(a,null)};a.ua=function(){};a.UY=function(){var a=m.HV(),b=m.KB();T.cG=a?!0:!1;
T.Jz=b?!0:!1;a?(J=function(b,c,d,e){a.drawElementsInstanced(k.TRIANGLES,b,c,d,e)},y=function(b,c){a.vertexAttribDivisor(b,c)},d=function(b,c,d){a.drawArraysInstanced(k.TRIANGLES,b,c,d)}):(J=function(a,b,c){k.drawElements(k.TRIANGLES,a,b,c)},y=function(){},d=function(a,b){k.drawArrays(k.TRIANGLES,a,b)});b?(B=function(a){b.bindVertexArray(a)},u=function(a,b){var c=a.Ca;B(a.Pe[b]);c.ng?J(c.count,c.vm,0,c.zm):d(0,c.count,c.zm);B(null)}):u=function(a,b){for(var c=a.Ca,e=a.vq,f=0;f<c.Nd.length;f++){k.bindBuffer(k.ARRAY_BUFFER,
c.Nd[f].ml);for(var h=0;h<e.length;h++){var n=e[h];n.UN==c.Nd[f].type&&(k.enableVertexAttribArray(n.hf),k.vertexAttribPointer(n.hf,n.Ic,n.Fv,n.Fv==k.FLOAT?!1:!0,n.kn,n.wG+n.rI*b),y(n.hf,n.qr))}}c.ng?(k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,c.ng),J(c.count,c.vm,0,c.zm)):d(0,c.count,c.zm);for(f=0;f<e.length;f++)n=e[f],k.disableVertexAttribArray(n.hf)}};a.reset=function(){B=d=y=J=k=null}};b4w.module.__camera=function(a,g){function q(a,b,c,d,e){pa.Vc(a,b);c&&A(a,b,c);I(a,d);C(a,e)}function c(a,b,c,e,f,h,k,n){var m=a.k;pa.Vc(a,b);m.pivot.set(c);A(a,b,c);I(a,e);C(a,f);y(a,h);d(a,k);m.use_panning=n}function b(a,b,c,d,e,f,k,n){var m=a.k;pa.Vc(a,b);m.Vb.set(c);A(a,b,c);J(a,d);h(a,e);B(a,f);u(a,k);m.Uh=n}function w(a,b,c){var d=a.k,e=N.G(d.n),f=N.R(d.n),d=Ea;d.set(ea.nc);d[3]=0;a=n(a,ia)[1];f=ea.ec(f,ea.Mc,na);ga.gM(Ma,e);ga.ID(Ma,f);if(!ea.nC(d,-b,Ma,c)||Math.abs(a)<xa)ua.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
c[0]=e[0],c[1]=0,c[2]=e[2];return c}function t(b){for(var c=b.k,d=0;d<b.I.length;d++){var e=b.I[d].da[0];if(e.type==a.ze)switch(c.ub){case a.Kb:var f=N.G(c.n);c.pk=L.dist(f,c.pivot);c.qk=e.top;break;case a.ad:f=N.G(c.n),c.pk=L.dist(f,c.Vb),c.qk=e.top}}}function D(a){a={type:a,name:"",BM:1,width:0,height:0,df:null,Dr:null,wc:null,Ze:null,Ab:0,Xd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,hd:Aa.create(),n:new Float32Array(9),Ob:new Float32Array(16),fy:new Float32Array(16),xb:new Float32Array(16),
kd:new Float32Array(16),ey:new Float32Array(16),cD:new Float32Array(16),Bg:new Float32Array(16),direction:new Float32Array(3),uf:N.Vl(),gy:N.Vl(),Hs:N.Vl(),cx:N.Vl(),Vs:N.Vl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dI:!1,Dd:!1,dof_on:!1,pw:new Float32Array(3),Wh:r(),al:0,qf:0,rc:null,Sh:null,gr:null,Tu:new Float32Array(4),Ko:new Float32Array(4)};a.hd[0]=a.hd[2]=45;a.hd[1]=a.hd[3]=55;return a}function l(a,b){var c=
D(a.type);c.name=a.name;c.BM=a.BM;c.width=a.width;c.height=a.height;b||(c.df=a.df,c.Dr=a.Dr,c.wc=a.wc,c.Ze=a.Ze);c.Ab=a.Ab;c.Xd=a.Xd;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;Aa.copy(a.hd,c.hd);N.copy(a.n,c.n);S.copy(a.Ob,c.Ob);S.copy(a.xb,c.xb);S.copy(a.kd,c.kd);S.copy(a.ey,c.ey);S.copy(a.cD,c.cD);S.copy(a.Bg,c.Bg);N.copy(a.uf,c.uf);N.copy(a.gy,c.gy);N.copy(a.Hs,c.Hs);N.copy(a.cx,c.cx);N.copy(a.Vs,c.Vs);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;
c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.dI=a.dI;c.Dd=a.Dd;c.dof_on=a.dof_on;L.copy(a.pw,c.pw);var d=a.Wh,e=c.Wh;Aa.copy(d.left,e.left);Aa.copy(d.right,e.right);Aa.copy(d.top,e.top);Aa.copy(d.bottom,e.bottom);Aa.copy(d.near,e.near);Aa.copy(d.far,e.far);c.al=a.al;c.qf=a.qf;a.rc&&(c.rc=Aa.clone(a.rc));if(a.Sh){d=a.Sh.length;c.Sh=Array(d);for(e=0;e<d;e++)c.Sh[e]=
L.clone(a.Sh[e]);c.gr=new Float32Array(a.gr)}Aa.copy(a.Tu,c.Tu);Aa.copy(a.Ko,c.Ko);return c}function r(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function p(b){switch(b){case "STATIC":return a.Jg;case "TARGET":return a.Kb;case "EYE":return a.md;case "HOVER":return a.ad;default:ea.q("Unknown move style")}}function m(b){var c=D(b);if(b==
a.od)return c;switch(b){case a.Qd:z(c,40,.1,1E3);break;case a.ze:z(c,2.5,.1,1E3);break;case a.Jh:break;case a.Ih:break;case a.Ei:break;case a.Pc:case a.cd:case a.Te:case a.Ue:ea.q("Stereo camera may only be created from perspective one");break;default:ea.q("Unknown camera type")}return c}function f(b,c,d){b.type!=a.Pc&&b.type!=a.cd&&b.type!=a.Te&&b.type!=a.Ue&&ea.q("set_stereo_params(): wrong camera type");if(b.type==a.Pc||b.type==a.cd)b.al=c;b.qf=d;ka(b,b.Ab);if(da.Da()&&(c=da.A(),b=c.s.wd))for(c=
za.ja(da.qm(c),c).da,d=0;d<c.length;d++)ha(c[d],b)}function n(a,b){return e(N.R(a.k.n),b)}function e(a,b){var c=ea.ec(a,ea.nc,na),d=ea.ec(a,ea.Re,Oa),e=-Math.asin(c[2]/L.length(c)),c=Math.abs(e)>Math.PI/4?L.scale(d,-ea.sign(e),Ca):L.scale(c,-ea.sign(d[2]),Ca),f=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(e=ea.sign(e)*Math.PI-e);d=f;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function z(b,c,d,e,f){switch(b.type){case a.Qd:case a.Pc:case a.cd:b.Xd=c;b.Ab=1;break;case a.ze:b.top=
c;b.Ab=1;break;case a.Jh:b.Xd=c;b.Ab=f/c;break;case a.Ih:b.top=c;b.Ab=f/c;break;case a.Te:case a.Ue:break;default:ua.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function M(b,c){var d=N.jc(c.k.n,na),e=N.Zd(c.k.n,qa),f=S.fromRotationTranslation(e,d,Qa);S.invert(f,b.Ob);if(da.Da())var f=da.A(),h=da.La(f,ya.Di);if(b.type==a.Pc||h&&h.enable_hmd_stereo&&b.type==a.Te)b.Ob[12]+=b.qf/2;else if(b.type==a.cd||h&&h.enable_hmd_stereo&&b.type==a.Ue)b.Ob[12]-=b.qf/2;if(b.rc){N.Wi(b.Ob,
b.Hs);N.invert(b.Hs,b.cx);var f=b.rc[0],h=b.rc[1],k=b.rc[2],n=b.rc[3],m=b.fy;m[0]=1-2*f*f;m[1]=-2*f*h;m[2]=-2*f*k;m[3]=0;m[4]=-2*f*h;m[5]=1-2*h*h;m[6]=-2*h*k;m[7]=0;m[8]=-2*f*k;m[9]=-2*h*k;m[10]=1-2*k*k;m[11]=0;m[12]=-2*f*n;m[13]=-2*h*n;m[14]=-2*k*n;m[15]=1;S.multiply(b.Ob,b.fy,b.Ob);ka(b,b.Ab,!0);f=Ea;h=Qa;S.invert(b.Ob,h);S.transpose(h,h);Aa.transformMat4(b.rc,h,f);h=wa;h[0]=(ea.sign(f[0])+b.xb[8])/b.xb[0];h[1]=(ea.sign(f[1])+b.xb[9])/b.xb[5];h[2]=-1;h[3]=(1+b.xb[10])/b.xb[14];Aa.scale(f,2/(f[0]*
h[0]+f[1]*h[1]+f[2]*h[2]+f[3]*h[3]),f);b.xb[2]=f[0];b.xb[6]=f[1];b.xb[10]=f[2]+1;b.xb[14]=f[3];L.transformMat4(d,b.fy,d)}N.Wi(b.Ob,b.uf);N.invert(b.uf,b.gy);Q(b);ca(b);N.oi(d,1,e,b.n)}function E(b,c,d,e){S.lookAt(c,d,e,b.Ob);d=da.A();d=da.La(d,ya.Di);da.Da()&&(d=da.A(),d=da.La(d,ya.Di));if(b.type==a.Pc||d&&d.enable_hmd_stereo&&b.type==a.Te)b.Ob[12]+=b.qf/2;else if(b.type==a.cd||d&&d.enable_hmd_stereo&&b.type==a.Ue)b.Ob[12]-=b.qf/2;N.Wi(b.Ob,b.uf);Q(b);ca(b);N.of(c,b.n)}function F(a,b,c){c=L.subtract(c,
b,na);L.length(c)&&(L.normalize(c,c),c=ea.xD(ea.Mc,c,qa),pa.ni(a,c));pa.Vc(a,b)}function A(a,b,c){var d=a.k,e=0>ea.ec(N.R(a.k.n),ea.Eh,na)[2];F(a,b,c);e?(b=L.copy(d.tf,na),L.negate(b,b),ta.$j(a,b,!0)):ta.$j(a,d.tf,!0)}function O(a,b){for(var c=a.k,d=b.da,e=N.Zd(c.n,qa),e=ea.ec(e,ea.Mc,na),f=N.jc(c.n,Oa),h=b.yM,k=0;k<h.length;k++){var n=h[k];L.copy(e,n.direction);N.jc(c.n,n.pw)}for(k=0;k<d.length;k++)n=d[k],M(n,a),L.copy(e,n.direction),ea.co(n.kd,n.Wh),n.dof_object&&n.dof_on&&(c=pa.sd(n.dof_object,
Ca),c=L.dist(f,c),n.dof_distance=c)}function H(b){var c=b.k;c.ub==a.Kb&&(c.el=0>ea.ec(N.R(b.k.n),ea.Eh,na)[2])}function I(b,c){var d=b.k;if(c){d.lb=d.lb||{};d.lb.left=c.left;d.lb.right=c.right;d.lb.yo=c.left;d.lb.Uo=c.right;d.lb.camera_space=Boolean(c.camera_space);var e=b.k;!(d=e.lb)||e.ub!=a.md&&e.ub!=a.Kb||(e=n(b,ia),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.yo-=e[0],d.Uo-=e[0]),d.left=ea.Fi(d.left),d.right=ea.Fi(d.right),d.yo=ea.Fi(d.yo),d.Uo=ea.Fi(d.Uo))}else d.lb=null}function C(a,b){var c=
a.k;b?(c.ka=c.ka||{},c.ka.down=b.down,c.ka.up=b.up,c.ka.$n=b.down,c.ka.xp=b.up,c.ka.camera_space=Boolean(b.camera_space),k(a)):c.ka=null}function h(a,b){var c=a.k;if(!b){var d=n(a,ia);b={down:d[1],up:d[1]}}c.ka=c.ka||{};c.ka.down=b.down;c.ka.up=b.up;k(a);c.sb&&c.ka&&x(a)}function k(b){var c=b.k,d=c.ka;if(d)switch(c.ub){case a.md:case a.Kb:b=n(b,ia);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.xp-=b[1],d.$n-=b[1]);d.up=ea.Ng(d.up,-Math.PI,Math.PI);d.down=ea.Ng(d.down,-Math.PI,Math.PI);d.xp=ea.Ng(d.xp,
-Math.PI,Math.PI);d.$n=ea.Ng(d.$n,-Math.PI,Math.PI);break;case a.ad:d.up=ea.Ng(d.up,-Math.PI,Math.PI),d.down=ea.Ng(d.down,-Math.PI,Math.PI),d.up=ea.V(d.up,-Math.PI/2,0),d.down=ea.V(d.down,-Math.PI/2,0)}}function J(a,b){var c=a.k;if(!b){var d=pa.Ho(a,c.Vb);b={min:d,max:d}}c.sb=c.sb||{};c.sb.min=b.min;c.sb.max=b.max;c.sb&&c.ka&&x(a)}function y(a,b){var c=a.k;b?(c.sb=c.sb||{},c.sb.min=b.min,c.sb.max=b.max):c.sb=null}function d(a,b){var c=a.k;b?(c.fe=c.fe||{},c.fe.min_z=b.min_z,c.fe.max_z=b.max_z):c.fe=
null}function B(a,b){var c=a.k;b?(c.Cc=c.Cc||{},c.Cc.min=b.min,c.Cc.max=b.max):c.Cc=null}function u(a,b){var c=a.k;b?(c.Dc=c.Dc||{},c.Dc.min=b.min,c.Dc.max=b.max):c.Dc=null}function ba(b){var c=b.k;if(za.xa(b))for(var d=b.I,e=0;e<d.length;e++){var f=d[e].da;if(f[0].type===a.ze){switch(c.ub){case a.Kb:var h=N.G(c.n),h=L.dist(h,c.pivot),h=h/c.pk*c.qk;break;case a.ad:h=N.G(c.n);h=L.distance(h,c.Vb);h=h/c.pk*c.qk;break;default:h=f[0].top}for(var k=0;k<f.length;k++){var n=f[k];n.top=h;ka(n,n.Ab)}O(b,d[e])}}}
function K(b){var c=b.k,d=c.ub;if(d===a.Kb||d===a.md){if(c.lb){var e=c.lb.left,f=c.lb.right,h=n(b,ia);(h=d==a.Kb?ea.Ol(h[0],e,f):ea.Ol(h[0],f,e))&&(d==a.Kb?T(b,h,0):G(b,h,0))}c.ka&&(e=c.ka.down,f=c.ka.up,h=n(b,ia),(h=d==a.Kb?ea.Ol(h[1],f,e):ea.Ol(h[1],e,f))&&(d==a.Kb?T(b,0,h):G(b,0,h)));if(d===a.Kb&&c.sb){var h=b.k,e=N.G(h.n),f=L.subtract(e,h.pivot,na),k=L.length(f);k>h.sb.max?(L.scale(f,h.sb.max/k,f),L.add(h.pivot,f,e)):k<h.sb.min&&(k=ea.ec(N.R(h.n),ea.Mc,Oa),L.scale(k,100*h.sb.min,k),L.add(f,k,
f),L.scale(f,-h.sb.min/L.length(f),f),L.add(h.pivot,f,e))}}d===a.Kb&&c.fe&&(c=b.k,h=c.pivot[2],e=ea.V(c.pivot[2],c.fe.min_z,c.fe.max_z),e!=h&&(h=L.set(0,0,e-h,na),L.add(c.pivot,h,c.pivot),c=N.G(c.n),L.add(c,h,c)));d===a.ad&&(d=b.k,d.Cc&&(h=ea.V(d.Vb[0],d.Cc.min,d.Cc.max)-d.Vb[0],d.Vb[0]+=h,c=N.G(d.n),c[0]+=h),d.Dc&&(h=ea.V(d.Vb[1],d.Dc.min,d.Dc.max)-d.Vb[1],d.Vb[1]+=h,c=N.G(d.n),c[1]+=h),d=b.k,c=n(b,ia)[1],(d=ea.Ol(c,d.ka.up,d.ka.down))&&P(b,0,d))}function G(a,b,c,d,e){var f=a.k,h=b,k=c;if(d||e)a=
n(a,va),d&&(h=b-a[0]),e&&(k=c-a[1]);if(h||k)b=la.identity(qa),h&&(h=la.setAxisAngle(f.tf,h,ma),la.multiply(b,h,b)),f=N.R(f.n),k&&(h=ea.ec(f,ea.Gg,na),k=la.setAxisAngle(h,k,ma),la.normalize(k,k),la.multiply(b,k,b)),la.multiply(b,f,f)}function T(a,b,c,d,e){var f=a.k,h=b,k=c;if(d||e){var m=n(a,va);d&&(h=b-m[0]);e&&(k=c-m[1])}X(a,a.k.pivot,h,k);a=n(a,va);a=ea.Ng(a[1],-Math.PI,Math.PI);f.el=Math.abs(a)>Math.PI/2}function P(a,b,c,d,e){var f=a.k,h=b,k=c;if(d||e){var m=n(a,va);d&&(h=b-m[0]);e&&(k=c-m[1])}f.Uh||
(h=0);X(a,f.Vb,h,k);k&&x(a)}function X(a,b,c,d){var e=a.k;if(c||d){a=la.identity(qa);c&&(c=la.setAxisAngle(ea.nc,c,ma),la.multiply(a,c,a));c=N.R(e.n);if(d){var f=ea.ec(c,ea.Gg,na);d=la.setAxisAngle(f,d,ma);la.normalize(d,d);la.multiply(a,d,a)}d=N.G(e.n);ea.DY(d,b,a,d);la.multiply(a,c,c)}}function x(a){var b=a.k,c=n(a,ia)[1],d=a.k;a=d.ka;d=d.sb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=N.G(b.n);d=ea.ec(N.R(b.n),ea.Mc,na);L.normalize(d,d);L.scale(d,c,d);
L.subtract(b.Vb,d,a)}function ka(b,c,d){switch(b.type){case a.Qd:c||ea.q("No aspect ratio"),b.Ab=c;case a.Jh:S.perspective(ea.Cb(b.Xd),b.Ab,b.near,b.far,b.xb);break;case a.ze:c||ea.q("No aspect ratio"),b.Ab=c;case a.Ih:c=b.top*b.Ab;S.ortho(-c,c,-b.top,b.top,b.near,b.far,b.xb);break;case a.Ei:S.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb);break;case a.Pc:case a.cd:c||ea.q("No aspect ratio");b.Ab=c;var e=Math.tan(b.Xd*Math.PI/360);c=b.near*e;var f=b.Ab*b.al*e;b.type==a.Pc?(e=f-b.qf/2,f+=b.qf/
2):(e=f+b.qf/2,f-=b.qf/2);e=-(b.near/b.al*e);f*=b.near/b.al;S.frustum(e,f,-c,c,b.near,b.far,b.xb);b.left=e;b.right=f;break;case a.Te:case a.Ue:if(da.Da())if(e=da.A(),(e=da.La(e,ya.Di))&&e.enable_hmd_stereo){c=Math.tan(ea.Cb(b.hd[0]));var e=Math.tan(ea.Cb(b.hd[1])),f=Math.tan(ea.Cb(b.hd[2])),h=Math.tan(ea.Cb(b.hd[3]));b.top=b.near*c;b.right=b.near*e;b.bottom=-b.near*f;b.left=-b.near*h;S.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb)}else c||(c=b.Ab),S.perspective(ea.Cb(b.Xd),c,b.near,b.far,
b.xb);break;case a.od:return;default:ea.q("Wrong camera type: "+b.type)}d||(Q(b),ca(b))}function ca(a){S.copy(a.Ob,a.Bg);a.Bg[12]=0;a.Bg[13]=0;a.Bg[14]=0;a.Bg[15]=1;S.multiply(a.xb,a.Bg,a.Bg);S.invert(a.Bg,a.Bg)}function Q(a){S.copy(a.Ob,a.kd);S.multiply(a.xb,a.kd,a.kd);S.invert(a.kd,a.ey)}function W(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var h,k,n,m,v,u,g,p;switch(b.type){case a.od:ea.q("Extraction from NONE camera is not possible");break;case a.Qd:case a.Jh:h=c*Math.tan(b.Xd*
Math.PI/360);m=-h;k=h*b.Ab;n=-k;v=d/c*h;p=-v;u=v*b.Ab;g=-u;break;case a.ze:case a.Ih:n=b.top*b.Ab;h=v=b.top;k=u=n;m=p=-b.top;n=g=-n;break;case a.Ei:h=v=b.top;k=u=b.right;m=p=b.bottom;n=g=b.left;break;case a.Pc:case a.cd:v=c/b.near;h=c*Math.tan(b.Xd*Math.PI/360);m=-h;k=b.right*v;n=b.left*v;g=d/c;v=h*g;p=-v;u=k*g;g*=n;break;case a.Te:case a.Ue:v=c/b.near;h=b.top*v;m=b.bottom*v;k=b.right*v;n=b.left*v;g=d/c;v=h*g;p=m*g;u=k*g;g*=n;break;default:ea.q("Wrong camera type: "+b.type)}e[0]=n;e[1]=m;e[2]=-c;
e[3]=k;e[4]=m;e[5]=-c;e[6]=k;e[7]=h;e[8]=-c;e[9]=n;e[10]=h;e[11]=-c;e[12]=g;e[13]=p;e[14]=-d;e[15]=g;e[16]=v;e[17]=-d;e[18]=u;e[19]=v;e[20]=-d;e[21]=u;e[22]=p;e[23]=-d;f&&(c=Qa,S.invert(b.Ob,c),ea.No(e,c,e,0));return e}function ha(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Sh){var d=b.csm_num;a.Sh=Array(d);for(var e=0;e<d;e++)a.Sh[e]=new Float32Array(3);a.gr=new Float32Array(d)}for(d=0;d<c;d++){var e=0==d?a.near:v(b,a,d-1),f=v(b,a,d),e=W(a,e,f,Ja),e=V.BV(e);a.Sh[d].set(e.F);a.gr[d]=e.Xa;a.Tu[d]=
L.length(e.F);a.Ko[d]=Z(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.Ko[0]=b.first_cascade_blur_radius}function v(a,b,c){var d=a.csm_num,e=ea.V(a.csm_first_cascade_border,b.near,b.far);a=ea.V(a.csm_last_cascade_border,b.near,b.far);return ea.V(Z(e,a,d,c),b.near,b.far)}function Z(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function Y(a,b){b||(b=new Float32Array(3));L.copy(N.G(a.k.n),b);return b}var V=g("__boundings");g("__config");
var ta=g("__constraints"),oa=g("__container"),S=g("__mat4"),ga=g("__math"),za=g("__obj_util"),ua=g("__print"),la=g("__quat"),da=g("__scenes"),ya=g("__subscene"),pa=g("__transform"),N=g("__tsr"),ea=g("__util"),L=g("__vec3"),Aa=g("__vec4");a.od=10;a.Qd=20;a.ze=30;a.Jh=40;a.Ih=50;a.Ei=60;a.Pc=70;a.cd=80;a.Te=90;a.Ue=100;a.Jg=0;a.Kb=2;a.md=3;a.ad=4;var xa=ea.Cb(.5),ia=new Float32Array(2),va=new Float32Array(2),na=new Float32Array(3),Oa=new Float32Array(3),Ca=new Float32Array(3),qa=new Float32Array(4),
ma=new Float32Array(4),Ea=new Float32Array(4),wa=new Float32Array(4),Qa=new Float32Array(16),Ja=new Float32Array(24),Ma=new Float32Array(6);a.XR=function(d,e){var f=e.k,h=d.data;switch(h.type){case "PERSP":var k=m(a.Qd);if(h.angle_y)var n=ea.re(h.angle_y);z(k,n,h.clip_start,h.clip_end);break;case "ORTHO":k=m(a.ze),z(k,h.ortho_scale/2,h.clip_start,h.clip_end)}k.name=e.name;n=e.I;n[0].da.push(k);for(var v=1;v<n.length;v++){var u=l(k,!1);n[v].da.push(u)}f.ub=p(h.b4w_move_style);f.dof_distance=h.dof_distance;
k=h.dof_object;f.dof_object=k?k.nb:null;f.dof_front_start=h.b4w_dof_front_start;f.dof_front_end=h.b4w_dof_front_end;f.dof_rear_start=h.b4w_dof_rear_start;f.dof_rear_end=h.b4w_dof_rear_end;f.dof_power=h.b4w_dof_power;f.dof_bokeh=h.b4w_dof_bokeh;f.dof_bokeh_intensity=h.b4w_dof_bokeh_intensity;f.Dd=h.b4w_dof_foreground_blur;f.ol=h.b4w_trans_velocity;f.nl=h.b4w_rot_velocity;f.pl=h.b4w_zoom_velocity;k=e.k.ub;n=d.data;v=null;k!=a.Kb&&k!=a.md||!n.b4w_use_horizontal_clamping||(v={left:n.b4w_rotation_left_limit,
right:n.b4w_rotation_right_limit,camera_space:"LOCAL"==n.b4w_horizontal_clamping_type},k==a.md&&(v.left*=-1,v.right*=-1));k=v;n=e.k.ub;v=d.data;u=null;n!=a.Kb&&n!=a.md||!v.b4w_use_vertical_clamping?n==a.ad&&v.b4w_use_zooming&&(v.b4w_hover_angle_min<=v.b4w_hover_angle_max?(u={down:v.b4w_hover_angle_min,up:v.b4w_hover_angle_max},u.down*=-1,u.up*=-1):ua.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(u={down:v.b4w_rotation_down_limit,up:v.b4w_rotation_up_limit,camera_space:"LOCAL"==
v.b4w_vertical_clamping_type},n==a.Kb&&(u.down*=-1,u.up*=-1));var n=u,v=e.k.ub,u=d.data,g=null;v==a.Kb&&u.b4w_use_target_distance_limits&&u.b4w_distance_min<=u.b4w_distance_max?g={min:u.b4w_distance_min,max:u.b4w_distance_max}:v===a.ad&&u.b4w_use_zooming&&(u.b4w_distance_min<=u.b4w_distance_max?g={min:u.b4w_distance_min,max:u.b4w_distance_max}:ua.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));v=g;u=d.data;g=null;e.k.ub==a.ad&&u.b4w_use_horizontal_clamping&&u.b4w_horizontal_translation_min<=
u.b4w_horizontal_translation_max&&(g={min:u.b4w_horizontal_translation_min,max:u.b4w_horizontal_translation_max});var u=g,g=d.data,L=null;e.k.ub==a.ad&&g.b4w_use_vertical_clamping&&g.b4w_vertical_translation_min<=g.b4w_vertical_translation_max&&(L={min:g.b4w_vertical_translation_min,max:g.b4w_vertical_translation_max});var g=L,L=d.data,x=null;e.k.ub==a.Kb&&L.b4w_use_pivot_limits&&(x={min_z:L.b4w_pivot_z_min,max_z:L.b4w_pivot_z_max});L=x;switch(f.ub){case a.md:f=N.G(e.k.n);q(e,f,null,k,n);break;case a.Kb:f=
N.G(e.k.n);c(e,f,h.b4w_target,k,n,v,L,h.b4w_use_panning);break;case a.ad:f=N.G(e.k.n),k=w(e,d.data.b4w_hover_zero_level,Oa),b(e,f,k,v,n,u,g,h.b4w_enable_hover_hor_rotation)}K(e);t(e)};a.wZ=q;a.uM=c;a.tM=b;a.ro=t;a.Hc=l;a.VS=r;a.W7=p;a.fd=m;a.s3=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.wc);case "DEPTH":return Boolean(a.Ze);case "SCREEN":return!Boolean(a.wc)&&!Boolean(a.Ze);default:ea.q("Wrong attachment type: "+b)}};a.lx=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.wc=
c;break;case "DEPTH":a.Ze=c;break;case "SCREEN":a.wc=null;a.Ze=null;break;default:ea.q("Wrong attachment type: "+b)}};a.h5=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.wc;case "DEPTH":return a.Ze;case "SCREEN":return null;default:ea.q("Wrong attachment type: "+b)}};a.sw=function(b,c){(b.type!=a.Qd||c!=a.Pc&&c!=a.cd&&c!=a.Te&&c!=a.Ue)&&ea.q("make_stereo(): wrong camera type");b.type=c;f(b,6,.065)};a.lZ=f;a.rm=n;a.zB=e;a.kk=function(a,b){n(a,b);b[0]=ea.Fi(b[0]+Math.PI);b[1]*=-1;return b};
a.nx=z;a.YY=function(b,c,d,e,f,h,k){switch(b.type){case a.Ei:b.left=c;b.right=d;b.bottom=e;b.top=f;b.near=h;b.far=k;break;default:ua.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.tm=function(a){return a.k.ub};a.sZ=M;a.I9=E;a.ND=function(a,b,c){var d=na;d[0]=0;d[1]=0;d[2]=-1;L.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=Oa;e[0]=0;e[1]=1;e[2]=0;L.transformQuat(e,c,e);E(a,b,d,e)};a.GD=F;a.eZ=A;a.O_=O;a.N_=function(b){var c=b.k;K(b);ba(b);switch(c.ub){case a.Kb:var d=
N.G(c.n);ta.EY(d,N.R(c.n),c.pivot);for(var e=0;e<b.I.length;e++)for(var h=b.I[e].da,k=0;k<h.length;k++){var n=h[k];n.type!=a.Pc&&n.type!=a.cd||f(n,L.dist(d,c.pivot),n.qf)}ta.$j(b,c.tf);break;case a.md:b.pc||ta.$j(b,c.tf)}H(b)};a.AE=H;a.cM=I;a.pM=C;a.Vv=h;a.Uv=J;a.TY=y;a.iZ=d;a.ZY=B;a.rZ=u;a.X_=ba;a.Ls=G;a.fx=T;a.Ms=P;a.y7=function(b){switch(b.type){case a.Qd:case a.ze:case a.Pc:case a.cd:return!0;default:return!1}};a.FI=function(b){switch(b.type){case a.Qd:case a.Jh:case a.Pc:case a.cd:return ea.Cb(b.Xd);
default:return ua.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.Vk=ka;a.NY=function(b,c,d,e,f){var h=1/Math.max(f,e);switch(b.type){case a.Qd:case a.Jh:f/=2;e/=2;d=-(d-f)/f*Math.tan(ea.Cb(b.Xd)/2);c=(c-e)/e*Math.tan(ea.Cb(b.Xd)/2)*b.Ab;e=b.near*(d+h);f=b.near*(c+h);d=b.near*(d-h);c=b.near*(c-h);S.frustum(c,f,d,e,b.near,b.far,b.xb);break;case a.ze:case a.Ih:b.right=b.top*b.Ab;d=-d/f;c/=e;e=b.top+(d+h)*(b.top+b.top);f=-b.right+(c+h)*(b.right+b.right);d=b.top+(d-h)*(b.top+b.top);
c=-b.right+(c-h)*(b.right+b.right);S.ortho(c,f,d,e,b.near,b.far,b.xb);break;case a.Ei:d=-d/f,c/=e,e=b.top+(d+h)*(b.top-b.bottom),f=b.left+(c+h)*(b.right-b.left),d=b.top+(d-h)*(b.top-b.bottom),c=b.left+(c-h)*(b.right-b.left),S.ortho(c,f,d,e,b.near,b.far,b.xb)}S.copy(b.Ob,b.kd);S.multiply(b.xb,b.kd,b.kd);ea.co(b.kd,b.Wh)};a.fA=ca;a.RG=Q;a.xU=W;a.lR=function(a){a=a.k;var b=V.Sd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.S=b;var c=V.cA(1,ea.Hf([0,0,0]));a.wa=c;a.wq=V.AG(1,b);a.yq=
V.CG(1,b);a.xq=V.BG(1,b)};a.Fm=function(b){return za.xa(b)&&b.k&&b.k.ub==a.Jg};a.Aa=function(b){return za.xa(b)&&b.k&&b.k.ub==a.Kb};a.kc=function(b){return za.xa(b)&&b.k&&b.k.ub==a.md};a.Za=function(b){return za.xa(b)&&b.k&&b.k.ub==a.ad};a.gw=function(b){return za.xa(b)&&b.k&&b.I[0].da[0].type==a.ze};a.zE=ha;a.OT=v;a.dD=function(b,c,d){b=b.I[0].da[0];switch(b.type){case a.Qd:case a.Jh:case a.ze:case a.Ih:case a.Pc:case a.cd:case a.Te:case a.Ue:var e=Ea;e.set(c);e[3]=1;Aa.transformMat4(e,b.kd,e);c=
-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;oa.x0(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return ua.error("Non-compatible camera"),d}};a.uV=function(a){return a.I[0].da[0]};a.lo=function(b,c){switch(b.type){case a.Qd:case a.Jh:case a.Pc:case a.cd:var d=Math.tan(ea.Cb(b.Xd)/2);switch(c){case "LEFT":return-d*b.Ab;case "RIGHT":return d*b.Ab;case "TOP":return d;case "BOTTOM":return-d}break;case a.ze:case a.Ih:switch(c){case "LEFT":return-b.top*b.Ab;
case "RIGHT":return b.top*b.Ab;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.Ei:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Te:case a.Ue:switch(c){case "LEFT":return-Math.tan(ea.Cb(Math.min(b.hd[1],b.hd[3])));case "RIGHT":return Math.tan(ea.Cb(Math.min(b.hd[1],b.hd[3])));case "TOP":return Math.tan(ea.Cb(Math.min(b.hd[0],b.hd[2])));case "BOTTOM":return-Math.tan(ea.Cb(Math.min(b.hd[0],b.hd[2])))}break;
default:ea.q("Unknown camera type")}};a.AW=function(b){switch(b.type){case a.ze:case a.Ih:case a.Ei:return!0;default:return!1}};a.zV=function(b,c){switch(b.type){case a.Qd:case a.Jh:case a.Pc:case a.cd:var d=ea.Cb(b.Xd);return c?d*b.Ab:d;default:return 0}};a.Ts=function(a,b,c){a=a.k;N.of(b,a.n);L.copy(c,a.pivot)};a.px=function(a,b){var c=a.k,d=L.subtract(b,c.Vb,na),d=L.add(d,N.G(c.n),d);pa.Vc(a,d);L.copy(b,c.Vb)};a.mZ=function(a,b){var c=a.k,d=L.subtract(b,c.pivot,na),d=L.add(d,N.G(c.n),d);pa.Vc(a,
d);L.copy(b,c.pivot)};a.VI=Y;a.HD=function(c,d){c.k.ub=d;c.k.lb=null;c.k.ka=null;c.k.sb=null;c.k.Cc=null;c.k.Dc=null;t(c);switch(d){case a.ad:var e=N.G(c.k.n),f=w(c,0,Oa);b(c,e,f,null,null,null,null,c.k.Uh);break;case a.Kb:e=Y(c,na),f=ea.ec(N.R(c.k.n),ea.Mc,Oa),f=L.scaleAndAdd(e,f,10,f),L.copy(f,c.k.pivot)}};a.xt=function(a){a=a.k;a.ub=0;L.set(0,0,0,a.pivot);L.set(0,0,0,a.Vb);a.el=!1;a.use_panning=!1;a.lb=null;a.ka=null;a.sb=null;a.Cc=null;a.Dc=null;a.fe=null;a.Uh=!0};a.BD=function(a,b){for(var c=
0;c<a.length;c++){var d=a[c];70!=d.type&&80!=d.type&&90!=d.type&&100!=d.type||f(d,d.al,b)}};a.FD=function(a,b,c){var d=da.A();a=za.ja(a,d).da;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&Aa.copy(b,e.hd),100==e.type&&Aa.copy(c,e.hd),e.rc||ka(e),Q(e),ca(e)}}};b4w.module.__constraints=function(a,g){function q(a){var b={};b.type=a;return b}function c(a,c){a.pc&&a.pc.Fa&&b(a.pc.Fa,a);if(c.Fa){var e=c.Fa;-1==e.Xe.indexOf(a)?e.Xe.push(a):z.q("Descendant object override is forbidden")}a.pc=c}function b(a,b){var c=a.Xe.indexOf(b);-1!=c?a.Xe.splice(c,1):z.q("No descendant object")}function w(a,b,c){switch(b.type){case 1:var f=e.R(a.k.n),g=b.Fa.k.n;c=e.R(b.Fa.k.n);b.se?(n.copy(b.se,f),n.multiply(c,f,f)):n.copy(c,f);var q=e.Wc(b.offset,g,A);e.of(q,a.k.n);e.Sf(b.Ns*
e.$d(b.Fa.k.n),a.k.n);break;case 9:q=e.G(a.k.n);f=e.R(a.k.n);g=b.Fa.k.n;c=e.R(b.Fa.k.n);n.multiply(n.invert(b.Um,b.Um),f,f);n.multiply(c,f,f);e.Wc(b.offset,g,q);n.copy(c,b.Um);break;case 10:q=e.G(a.k.n);f=e.R(a.k.n);g=b.Fa.k.n;c=e.R(b.Fa.k.n);n.multiply(n.invert(b.Um,b.Um),f,f);n.multiply(c,f,f);e.Wc(b.offset,g,q);n.copy(c,b.Um);q=e.R(a.k.n);f=n.multiply(e.R(b.Fa.k.n),b.se,C);f=p.zB(f,E);q=p.zB(q,F);p.Ls(a,z.Ol(q[0],f[0]+b.wS,f[0]+b.vS),z.Ol(q[1],f[1]+b.uS,f[1]+b.xS));break;case 13:var q=e.G(a.k.n),
f=e.R(a.k.n),g=b.Fa.k.n,t=e.G(g),I=b.HZ,w=A,x=C;e.Wc(b.offset,g,w);z.Ix(w,q,c,I,q);g=A;M.sub(t,q,g);M.normalize(g,g);var ka=f,q=h,t=q.subarray(0,3),w=q.subarray(3,6),ca=q.subarray(6,9);M.copy(g,ca);M.negate(ca,ca);M.normalize(ca,ca);Boolean(.999999<Math.abs(M.dot(g,z.nc)))?(g=m.fromQuat(n.normalize(ka,x),k),M.copy(g.subarray(0,3),t)):M.cross(z.nc,ca,t);M.normalize(t,t);M.cross(ca,t,w);M.normalize(w,w);n.fromMat3(q,x);n.normalize(x,x);z.JM(x,f,c,.16*I,f);break;case 2:f=e.R(a.k.n);c=J;r.uv(b.Fa,b.Ml,
!0,c);e.multiply(b.Fa.k.n,c,c);f[0]=c[4];f[1]=c[5];f[2]=c[6];f[3]=c[7];b.se&&(n.copy(b.se,f),n.multiply(f,b.se,f));e.Sf(b.Ns*c[3],a.k.n);q=e.G(a.k.n);e.Wc(b.offset,c,q);break;case 3:q=e.G(a.k.n);f=e.R(a.k.n);c=e.G(b.Fa.k.n);D(q,f,c);break;case 4:q=e.G(a.k.n);f=e.R(a.k.n);c=b.target;D(q,f,c);break;case 5:q=e.G(a.k.n);f=e.R(a.k.n);c=e.G(b.Fa.k.n);D(q,f,c);f=M.dist(q,c);if(f=f>b.Yg?f-b.Yg:f<b.nr?f-b.nr:0)M.sub(c,q,A),M.normalize(A,A),M.scale(A,f,A),M.add(q,A,q);break;case 6:q=e.G(a.k.n);f=e.R(a.k.n);
c=b.target;D(q,f,c);f=M.dist(q,c);if(f=f>b.Yg?f-b.Yg:f<b.nr?f-b.nr:0)M.sub(c,q,A),M.normalize(A,A),M.scale(A,f,A),M.add(q,A,q);break;case 7:g=b.Fa.k.n;q=e.G(a.k.n);e.Wc(b.offset,g,q);break;case 8:t=e.G(b.Fa.k.n);q=e.G(a.k.n);M.add(t,b.offset,q);break;case 14:f=e.R(a.k.n);g=b.Fa.k.n;c=e.R(b.Fa.k.n);b.se?(n.copy(b.se,f),n.multiply(c,f,f)):n.copy(c,f);q=e.G(a.k.n);e.Wc(b.offset,g,q);break;case 11:e.multiply(b.Fa.k.n,b.Vx,a.k.n);break;case 12:q=b.Vx;c=J;r.uv(b.Fa,b.Ml,!0,c);e.multiply(b.Fa.k.n,c,c);e.multiply(c,
q,a.k.n);break;case 15:f=b.Fa,c=p.uV(f),q=e.G(a.k.n),g=p.lo(c,"LEFT"),t=p.lo(c,"RIGHT"),I=p.lo(c,"TOP"),x=p.lo(c,"BOTTOM"),w="heights"==b.hor_units?I-x:t-g,b.qK?(g=p.lo(c,"LEFT"),q[0]=g+w*b.kC):(t=p.lo(c,"RIGHT"),q[0]=t-w*b.kC),g="heights"==b.vert_units?I-x:t-g,q[1]=b.qN?I-g*b.nE:x+g*b.nE,p.AW(c)?q[2]=-b.distance:(q[2]=-1,M.normalize(q,q),M.scale(q,b.distance/Math.abs(q[2]),q)),e.xd(q,f.k.n,q),M.add(e.G(f.k.n),q,q),q=e.R(a.k.n),f=e.R(f.k.n),b.se?(n.copy(b.se,q),n.multiply(f,q,q)):n.copy(f,q)}"CAMERA"==
a.k.type&&(q=a.k.tf,10==b.type&&(c=e.R(b.Fa.k.n),q=M.transformQuat(q,c,y)),p.AE(a),l(a,q))}function t(a,b){switch(b.type){case 1:var c=b.target.k.n,f=J;e.invert(a.k.n,f);e.multiply(f,c,f);r.MY(a,b.Ml,f)}a.KC=!0}function D(a,b,c){var e=A;z.ec(b,z.Mc,e);M.normalize(e,e);var f=O;M.subtract(c,a,f);M.normalize(f,f);a=z.xD(e,f,I);n.multiply(a,b,b);n.normalize(b,b)}function l(a,b,c){var f=a.k,h=e.R(f.n),k=z.ec(h,z.nc,A);M.normalize(k,k);if(.999999<Math.abs(M.dot(b,k)))k=n.identity(C);else{var m=M.cross(b,
k,O);M.normalize(m,m);f.ub==p.Kb?f.el&&M.negate(m,m):(f=z.ec(h,z.Re,H),0<M.dot(f,b)&&M.negate(m,m));f=z.ec(h,z.Gg,H);M.normalize(f,f);var g=z.V(M.dot(f,m),-1,1),k=-.999999>=g?n.setAxisAngle(k,Math.acos(g),C):n.rotationTo(f,m,C);n.normalize(k,k)}n.multiply(k,h,h);c&&(c=z.ec(h,z.Eh,A),0>M.dot(b,c)&&n.rotateZ(h,Math.PI,h));p.AE(a)}var r=g("__armature"),p=g("__camera"),m=g("__mat3"),f=g("__print"),n=g("__quat"),e=g("__tsr"),z=g("__util"),M=g("__vec3");a.W0=1;a.V0=2;a.$0=3;a.a1=4;a.Q0=5;a.R0=6;a.X0=7;
a.P0=8;a.U0=9;a.T0=10;a.N0=11;a.O0=12;a.S0=13;a.Y0=14;a.Z0=15;a.M0=1;var E=new Float32Array(2),F=new Float32Array(2),A=new Float32Array(3),O=new Float32Array(3),H=new Float32Array(3),I=new Float32Array(4),C=new Float32Array(4),h=new Float32Array(9),k=new Float32Array(9),J=e.create(),y=new Float32Array(3);a.iG=function(a,b,e,f,h){var k=q(1);k.Fa=b;k.offset=new Float32Array(e);k.se=f?new Float32Array(f):null;k.Ns=h;c(a,k);w(a,k,0)};a.WQ=function(a,b,e,f,h){var k=q(2);k.Fa=b;k.Ml=e;k.offset=new Float32Array(f);
k.se=null;k.Ns=h;c(a,k);w(a,k,0)};a.UQ=function(a,b,f,h){var k=q(9),m=e.R(a.k.n),g=e.R(b.k.n);k.Fa=b;k.offset=new Float32Array(f);k.Um=new Float32Array(g);h&&(n.copy(h,m),n.multiply(g,m,m));c(a,k);w(a,k,0)};a.TQ=function(a,b,f,h,k,m,g,p){var l=q(10),x=e.R(a.k.n),r=e.R(b.k.n);l.Fa=b;l.offset=new Float32Array(f);l.Um=new Float32Array(r);l.vS=z.Fi(k);l.wS=z.Fi(m);l.xS=z.Ng(g,-Math.PI,Math.PI);l.uS=z.Ng(p,-Math.PI,Math.PI);h?(l.se=new Float32Array(h),n.copy(h,x),n.multiply(r,x,x)):l.se=n.create();c(a,
l);w(a,l,0)};a.SQ=function(a,b,e,f){var h=q(13);h.Fa=b;h.offset=new Float32Array(e);h.HZ=f;c(a,h);w(a,h,0)};a.ZQ=function(a,b,e,f){var h=q(14);h.Fa=b;h.offset=new Float32Array(e);h.Ns=1;h.se=f?new Float32Array(f):null;c(a,h);w(a,h,0)};a.B8=b;a.aR=function(a,b){var e=q(3);e.Fa=b;c(a,e);w(a,e,0)};a.bR=function(a,b){var e=q(4);e.target=new Float32Array(b);c(a,e);w(a,e,0)};a.OQ=function(a,b,e,f){var h=q(5);h.Fa=b;h.nr=e;h.Yg=f;c(a,h);w(a,h,0)};a.PQ=function(a,b,e,f){var h=q(6);h.target=new Float32Array(b);
h.nr=e;h.Yg=f;c(a,h);w(a,h,0)};a.YQ=function(a,b,e){var f=q(7);f.Fa=b;f.offset=new Float32Array(e);c(a,f);w(a,f,0)};a.MQ=function(a,b){var e=q(8);e.Fa=b;e.offset=new Float32Array([0,0,0]);c(a,e);w(a,e,0)};a.KQ=function(a,b,e){var f=q(11);f.Fa=b;f.Vx=new Float32Array(e);c(a,f);w(a,f,0)};a.LQ=function(a,b,e,f){var h=q(12);h.Fa=b;h.Ml=e;h.Vx=new Float32Array(f);c(a,h);w(a,h,0)};a.Oz=function(a,b,e){var h=q(15);h.Fa=b;if(z.bi(e.left))h.qK=!0,h.kC=e.left;else if(z.bi(e.right))h.qK=!1,h.kC=e.right;else{f.error("append_stiff_viewport: Wrong positioning params");
return}if(z.bi(e.top))h.qN=!0,h.nE=e.top;else if(z.bi(e.bottom))h.qN=!1,h.nE=e.bottom;else{f.error("append_stiff_viewport: Wrong positioning params");return}z.bi(e.distance)?(h.distance=e.distance,h.se=z.bi(e.rotation)?new Float32Array(e.rotation):null,h.hor_units=z.bi(e.hor_units)?e.hor_units:"widths",h.vert_units=z.bi(e.vert_units)?e.vert_units:"heights",c(a,h),w(a,h,0)):f.error("append_stiff_viewport: Wrong positioning params")};a.P_=function(a,b){a.pc&&w(a,a.pc,b)};a.XQ=function(a,b,c,e,f){var h=
q(1);h.Ml=c;h.target=b;h.offset=new Float32Array(e);h.se=f?new Float32Array(f):null;h.Ns=1;b=h.target;c=h.Ml;e=a.k.Pg[c];f=b.wA;for(var k=0;k<f;k++){var n=f[k];if(n[0]==a&&n[1]==c){f.splice(k,1);break}}b.wA.push([a,c]);e.pc=h;t(a,h)};a.H_=function(a,b){var c=a.k.Pg[b];c.pc&&t(a,c.pc)};a.EY=D;a.$j=l;a.jS=function(a){return a.pc?!0:!1};a.remove=function(a){a.pc.Fa&&b(a.pc.Fa,a);a.pc=null};a.E6=function(a){return a.pc?a.pc.type:null};a.mg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?!1:!0};a.vv=
function(a){if((a=a.pc)&&11==a.type)return a.Fa.k.n;if(a&&12==a.type){var b=J;r.uv(a.Fa,a.Ml,!0,b);e.multiply(a.Fa.k.n,b,b);return b}return null};a.lg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?null:a.Vx}};b4w.module.__armature=function(a,g){function q(a){a=a.k;for(var b=a.cp,c=a.vw,f=0;f<b.length;f++){for(var n=b[f],m=c[f],g=0;g<m.length;g+=2)for(var p=m[g],l=m[g+1],q=0;4>q;q++)n.qe[p+q]=a.qe[l+q],n.Je[p+q]=a.Je[l+q],n.ve[p+q]=a.ve[l+q],n.Me[p+q]=a.Me[l+q];n.cf=a.cf}}function c(a,b,f,n){var m=a.xN,g=a.hl,l=a.Ux,q=a.ZK;q?(q=q.Ux,b?w.multiply(q,m,l):(b=p,w.invert(q,b),w.multiply(b,l,m))):b?w.copy(m,l):w.copy(l,m);m=r;w.invert(g,m);w.multiply(l,m,m);g=a.Tj;f[4*g]=m[0];f[4*g+1]=m[1];f[4*g+2]=m[2];f[4*
g+3]=m[3];n[4*g]=m[4];n[4*g+1]=m[5];n[4*g+2]=m[6];n[4*g+3]=m[7];a=a.aI;for(g=0;g<a.length;g++)l=a[g],l.pc||c(l,!0,f,n)}var b=g("__util"),w=g("__tsr"),t=g("__quat"),D=g("__mat4"),l=g("__vec3"),r=w.create(),p=w.create(),m=new Float32Array(4),f=new Float32Array(4),n=new Float32Array(4);a.kl=function(a,c){for(var f=a.data.bones,n=a.pose.bones,m={},g=0;g<n.length;g++){var p=n[g],q=p.bone,t=q.name,C=m[t]={Tj:0,ZN:-1,ZK:null,aI:[],Fu:[],pc:null,xE:w.create(),xN:w.create(),hl:w.create(),Ux:w.create(),Sx:w.create(),
yE:w.create(),Tx:!1,eN:new Float32Array(3)},t=new Float32Array(q.matrix_local),h=new Float32Array(16);D.invert(t,h);var p=new Float32Array(p.matrix_basis),k=C.eN;l.subtract(b.Hf(q.tail_local),b.Hf(q.head_local),k);b.s0(k,h,k);w.Wi(t,C.hl);w.Wi(p,C.Sx);w.copy(C.hl,C.Ux)}for(g=0;g<f.length;g++){t=f[g].name;p=b.Ed("name",t,n);C=m[t];q=p.parent_recursive;C.Fu.push(C);for(h=0;h<q.length;h++)p=q[h],p=p.name,p=m[p],C.Fu.push(p);q.length?(p=q[0],p=p.name,p=m[p],C.ZK=p,w.invert(p.hl,r),w.multiply(r,C.hl,C.xE),
p.aI.push(C)):w.copy(C.hl,C.xE);C.Tj=g;C.name=t;w.multiply(C.xE,C.Sx,C.xN)}c.k.Pg=m};a.uv=function(a,b,c,g){var l=a.k,q=l.cf;b=l.Pg[b];var O=b.Tj;a=b.hl;var H=l.ve,I=l.Me,C=l.qe,l=l.Je,h=H[4*O+1],k=H[4*O+2],J=H[4*O+3],y=I[4*O+1],d=I[4*O+2],B=I[4*O+3];m[0]=(1-q)*H[4*O]+q*I[4*O];m[1]=(1-q)*h+q*y;m[2]=(1-q)*k+q*d;m[3]=(1-q)*J+q*B;f[0]=C[4*O];f[1]=C[4*O+1];f[2]=C[4*O+2];f[3]=C[4*O+3];n[0]=l[4*O];n[1]=l[4*O+1];n[2]=l[4*O+2];n[3]=l[4*O+3];t.slerp(f,n,q,f);q=r;w.oZ(m,q);w.Wk(f,q);c?(c=p,w.translate(a,b.eN,
c),w.multiply(q,c,q)):w.multiply(q,a,q);w.copy(q,g)};a.MY=function(a,b,f){var n=a.k;b=n.Pg[b];var m=n.ve,g=n.qe;w.copy(f,b.Ux);c(b,!1,m,g);n.cf=0;q(a)};a.c0=q;a.I_=c;a.eS=function(a,b){return b in a.k.Pg}};b4w.module.__container=function(a,g){var q,c,b,w,t;function D(a,b){q=a;c=b}function l(){var a=h.getBoundingClientRect();D(a.left,a.top)}function r(){return H.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function p(b,c,f){if(!b||!c){b=a.Fy;c=a.Ey;var g=J;g.style.width=a.Fy+"px";g.style.height=a.Ey+"px"}var g=h,p=k;!1!==f&&(g.style.width=b+"px",g.style.height=c+"px",p&&(p.style.width=b+"px",p.style.height=c+"px"));p&&(p.width=b,p.height=c,e.ht());f=Math.floor(b*H.canvas_resolution_factor);c=Math.floor(c*
H.canvas_resolution_factor);r()&&(f*=window.devicePixelRatio,c*=window.devicePixelRatio);if(p=E.Yh())p=p.s,f=Math.floor(f*p.So),c=Math.floor(c*p.So);g.width=f;g.height=c;var p=Math.min(C.drawingBufferWidth,I.uC,I.zC[0]),l=Math.min(C.drawingBufferHeight,I.uC,I.zC[1]);if(f>p||c>l)M.warn("Canvas size exceeds platform limits, downscaling"),p=Math.min(p/f,l/c),f*=p,c*=p,g.width=f,g.height=c;E.sM(f,c,f/b);E.Da()&&A.D(E.A().Lj);n.T_(g.width,g.height);n.ih()&&(m.update(),E.update(F.lk(),0),m.IN())}var m=
g("__anchors"),f=g("__config"),n=g("__data"),e=g("__hud"),z=g("__input"),M=g("__print"),E=g("__scenes"),F=g("__time"),A=g("__transform"),O=g("__util"),H=f.B,I=f.Mi,C=null,h=null,k=null,J=null,y=!1;w=b=0;t=1;q=c=0;a.Fy=320;a.Ey=240;a.Tf=function(a){C=a};a.Xh=function(){return h};a.OI=function(){return k};a.Fe=function(){return J};a.fh=function(a,b){a&&a.parentNode?(h=a,k=b,J=a.parentNode):O.q("canvas container is not available")};a.aw=function(a,b){b=b||"LAST";switch(b){case "FIRST":J.insertBefore(a,
J.firstElementChild);break;case "JUST_BEFORE_CANVAS":J.insertBefore(a,h);break;case "JUST_AFTER_CANVAS":h.nextElementSibling?J.insertBefore(a,h.nextElementSibling):J.appendChild(a,h);break;case "LAST":J.appendChild(a,h);break;default:M.error(b+" invalid stack order")}};a.BJ=function(){return b};a.AJ=function(){return w};a.ML=D;a.zN=l;a.xZ=function(a,c,e){b=a;w=c;t=e;l()};a.sB=function(){y=!0};a.Nq=function(a,b,e){e||(e=new Float32Array(2));var f=e;y&&(l(),y=!1);f[0]=a-q;a=e;y&&(l(),y=!1);a[1]=b-c;
return e};a.Eu=function(a,c,e,f){e||(e=new Float32Array(2));e[0]=a*t;e[1]=c*t;f&&(a=f.width/b,e[0]*=a,e[1]*=a);return e};a.x0=function(a,c,e,f){e||(e=new Float32Array(2));e[0]=a/t;e[1]=c/t;f&&(a=f.width/b,e[0]/=a,e[1]/=a)};a.ZJ=function(b){return b&&b.parentNode?b.parentNode==J?!0:a.ZJ(b.parentNode):!1};a.xW=r;a.LU=function(a){var b=document.getElementsByTagName("script");a=O.nj(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=p;a.Pk=function(a){var b=J,c=h,e=b.clientWidth,
b=b.clientHeight;if(a||e!=c.clientWidth||b!=c.clientHeight)(a="HMD"===H.stereo&&z.EJ())&&a.isPresenting||p(e,b,!0)};a.reset=function(){J=k=h=C=null}};b4w.module.__anchors=function(a,g){function q(){u=!0;z.Fe().addEventListener("mouseup",function(){function a(){return"visible"==e.style.visibility&&!m&&!g}if(!ba&&!d){var b=B;if(b)if("visible"==b.lastElementChild.style.visibility)c(),B=null;else if(1==b.style.opacity){var e=b.lastElementChild,b=b.firstElementChild,f=e.firstElementChild,h=f.innerHTML;e.style.visibility="visible";var k=Math.min(parseInt(e.style.width)||200,D(h)-24),n=l(h,k),m=!0,g=!0;b.style.display="none";ba=!0;I.Oj(0,k,200,function(b){b==
k&&(m=!1,g||(ba=!1),a&&(f.style.visibility="visible"));e.style.width=b+"px"});I.Oj(0,n,200,function(b){b==n&&(g=!1,m||(ba=!1),a&&(f.style.visibility="visible"));e.style.height=b+"px"})}}})}function c(){var a=B.lastElementChild;B.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function w(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function t(a,e,f){var h=document.createElement("div"),k=document.createElement("span");f&&(h.style.width=f+"px");w(h);b(k);k.innerHTML=a;h.style.visibility="hidden";k.style.visibility="hidden";h.appendChild(k);e.appendChild(h);e.addEventListener("mousedown",function(){ba||e==B||1!=e.style.opacity||d||(B&&"visible"==B.lastElementChild.style.visibility&&c(),B=e)})}function D(a){var c=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);w(c);c.appendChild(d);document.body.appendChild(c);
a=c.offsetWidth+1;document.body.removeChild(c);return a}function l(a,c){var d=document.createElement("div"),e=document.createElement("span");e.innerHTML=a;b(e);w(d);d.style.width=c+"px";d.style.display="inline-block";d.appendChild(e);document.body.appendChild(d);e=d.offsetHeight-16;document.body.removeChild(d);return e}function r(){for(var a=0,b=0;b<y.length;b++)y[b].Yn&&a++;K=new Float32Array(3*a)}function p(a,b){return b.depth-a.depth}function m(a,b,c){a=a.element;J.TJ&&(b=Math.floor(b),c=Math.floor(c));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}var f=g("__batch"),n=g("__camera"),e=g("__config"),z=g("__container"),M=g("__objects"),E=g("__obj_util"),F=g("__print"),A=g("__renderer"),O=g("__scenes"),H=g("__subscene"),I=g("__time"),C=g("__transform"),h=g("__tsr"),k=g("__vec3"),J=e.B,y=[],d=!1,B=null,u=!1,ba=!1,K=new Float32Array(0),G=new Uint8Array(16),
T=new Float32Array(2),P=new Float32Array(3),X=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<y.length;c++)if(y[c].obj==a){c=!0;break a}c=!1}if(!c){c=a.anchor.Yn&&Boolean(O.La(O.Yh(),H.yn));c={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Gl:"out",Yn:c,element:null,Co:null,IQ:a.anchor.sX,dk:a.anchor.dk};switch(c.type){case "ANNOTATION":var d=c.obj;a=z.Fe();var e=M.xv(d),d=d.name,f=document.createElement("div"),h=f.cloneNode(),k=document.createElement("span"),n="";f.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
h.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";f.style.visibility="hidden";e&&(n=e.description||n,d=e.title||d);k.innerHTML=d;k.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(k);k.style.whiteSpace="nowrap";h.appendChild(k);f.appendChild(h);n&&t(n,f,c.IQ);a.appendChild(f);c.element=f;break;case "ELEMENT":if(c.element=document.getElementById(a.anchor.dk),c.element)for(e=0;e<y.length;e++)"ELEMENT"==y[e].type&&y[e].dk==a.anchor.dk&&(F.warn("Anchor with the id '"+a.anchor.dk+"' already exists, making the new anchor generic."),c.type="GENERIC");else F.warn("Anchor HTML element with the id '"+a.anchor.dk+"' was not found, making it generic."),c.type="GENERIC"}y.push(c);r();
u||q()}};a.remove=function(a){for(var b=0;b<y.length;b++){var c=y[b];if(c.obj==a){"ANNOTATION"==c.type&&(a=c,z.Fe().removeChild(a.element));y.splice(b,1);r();break}}};a.update=function(a){for(var b=0,c=y.length;c--;){var d=y[c];d.Yn&&K.set(h.G(d.obj.k.n),3*b++);var e,k=d,v=P;e=O.qm(O.Yh());e=v=n.dD(e,h.G(k.obj.k.n),v);k=e[0];v=e[1];e=e[2];if(a||k!=d.x||v!=d.y||e!=d.depth){switch(d.type){case "ANNOTATION":var g=k,l=v;m(d,g,l);break;case "ELEMENT":l=d.element.getBoundingClientRect(),g=k-l.width/2,l=
v-l.height/2,m(d,g,l)}d.x=k;d.y=v;d.depth=e;d.Co&&d.Co(k,v,d.Gl,d.obj,d.element)}}y.sort(p);for(c=0;c<y.length;c++)d=y[c],"GENERIC"!=d.type&&(d.element.style.zIndex=B==d.element?y.length:c);0<b&&(a=O.La(O.Yh(),H.yn),b=a.Qa[0].sa[0],f.B_(b.za,K),H.Rc(a,b))};a.IN=function(){for(var a=z.Fe(),b=y.length;b--;){var d=y[b],e=d.obj,f=e.k,h=d.x,n=d.y,m=d.depth,g=O.qm(O.Yh()),p=C.sd(e,P),g=C.sd(g,X),p=k.dist(p,g);(m=0>h||0>n||0>m||1<m||O.dC(e)||h>=a.clientWidth||n>=a.clientHeight)||(m=f.jf,m=!(p<f.kh?0:m==
E.$p||p<m));f=m?"out":"visible";d.Yn&&"out"!=f&&(f=d,m=O.La(O.Yh(),H.yn).p,p=z.Eu(f.x,f.y,T,m),A.jD(m.df,p[0],m.height-p[1],2,2,G),f=1020==G[5]+G[6]+G[9]+G[10]?"visible":"out"==f.Gl||0==G[5]+G[6]+G[9]+G[10]?"covered":f.Gl);if(f!=d.Gl){switch(d.type){case "ANNOTATION":case "ELEMENT":var l=d.element;if(!l)break;"out"==f?(l.style.visibility="hidden",l.children.length&&(l.children[0].style.visibility="hidden")):"visible"==f?(l.style.visibility="visible",l.children.length&&(l.children[0].style.visibility=
"visible"),l.style.opacity=1):(l.style.visibility="visible",l.style.opacity=.1,l.children.length&&(l.children[0].style.visibility="visible"),"ANNOTATION"==d.type&&1<l.children.length&&"visible"==l.lastElementChild.style.visibility&&(c(),l==B&&(B=null)))}d.Gl=f;d.Co&&d.Co(h,n,d.Gl,e,l)}}};a.f3=function(a,b){for(var c=0;c<y.length;c++)y[c].obj==a&&(y[c].Co=b)};a.h4=function(a){for(var b=0;b<y.length;b++)y[b].obj==a&&(y[b].Co=null)};a.ua=function(){for(var a=0;a<y.length;a++){var b=y[a];"ANNOTATION"==
b.type&&z.Fe().removeChild(b.element)}y.length=0};a.pW=function(a){for(var b=0;b<y.length;b++)if(y[b].obj==a)return!0;return!1};a.z5=function(a){for(var b=0;b<y.length;b++)if(y[b].obj==a)return y[b].dk;return!1};a.pause=function(){d=!0};a.qj=function(){d=!1};a.PX=function(a,b){for(var c=-1,d=0;d<y.length;d++){var e;if(e="visible"==y[d].Gl){var f=y[d];if(f.element){e=Math.round(f.element.offsetWidth)||0;var h=Math.round(f.element.offsetHeight)||0}else h=e=0;var k=f.x,f=f.y;e=a>=k&&a<=k+e&&b<f&&b>=
f-h?!0:!1}if(e)if(0>c)var n=y[d].depth,c=d;else y[d].depth<n&&(c=d,n=y[d].depth)}return 0>c?null:y[c].obj}};b4w.module.__objects=function(a,g){function q(a){var b=a.I;a=a.k;for(var c=0;c<b.length;c++){var d=b[c].yb;d.s.outline&&a.qh&&B.xY(d)}}function c(a){a.k.qh=0;a=V.indexOf(a);-1!=a&&V.splice(a,1)}function b(a){if(a.eo)for(var b=a.I,c=0;c<b.length;c++)B.BN(b[c].yb,a)}function w(a,b){for(var c=a.I,d=b.I,e=0;e<c.length;e++){for(var f=!1,h=0;h<d.length;h++)if(c[e].yb==d[h].yb){f=!0;break}f||t(b,c[e].yb)&&C.qq(b,c[e].yb)}}function t(a,b){return!b.VF&&"SPEAKER"==a.type||!b.BQ&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function D(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.Gz||a.parent&&a.parent.Gz)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,d=a.b4w_collision,e=a.b4w_vehicle,f=a.b4w_floating,k=a.b4w_character,m=h.YV(a),v=H.NG(a),g=0<a.data.b4w_shape_keys.length,p=a.b4w_dynamic_geometry;if(!(c=n.OG(a,b)||c||d||e||g||f||m||k||v||p))a:{c=a.data;for(d=0;d<c.materials.length;d++)if(e=c.materials[d],e.b4w_water||e.b4w_lens_flares||l(e.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
H.NG(a),d=a.b4w_do_not_batch,e=Boolean(a.b4w_anchor),n.OG(a,b)||c||d||e;default:return!0}}function l(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,e=c.convert_to,f=c.outputs[0];if(!(!f.is_linked||"WORLD"==d&&"CAMERA"==e||"CAMERA"==d&&"WORLD"==e||"OBJECT"==d&&"OBJECT"==e))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,f=c.outputs[0],f.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(f=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||f.is_linked||d.is_linked))return!0}return!1}function r(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.s.type==n.xz||c.s.type==n.wz&&"ARMATURE"==b.type||c.s.type==n.uP&&"LAMP"==b.type||c.s.type==n.tP&&"WORLD"==b.type)&&b.Vg.push(n.UJ(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Vg.push(n.UJ(null,d.action));"MESH"==b.type&&b.Vg.push.apply(b.Vg,n.mV(a))}function p(a,b,c){b=W[b]||
[];for(var d=[],e=0;e<b.length;e++){var f=b[e];if(f.k.Ye==c||-1==c)for(var h=f.I,k=0;k<h.length;k++)h[k].yb==a&&d.push(f)}return d}function m(a,b,c,d,e){for(var f=null,h=0;h<b.length;h++){var k=b[h];if(!((c?k.Qm:k.name)!=a||k.k.Ye!=d&&-1!=d||e&&!k.Uj||(f=k,C.Xi(f))))break}return f}function f(a){W.ALL.push(a);W[a.type]||(W[a.type]=[]);W[a.type].push(a);var b=a.k.Fd;if(null!=b)for(var c=0;c<Y.length;c++){var d=Y[c];d.k.Fd==b&&d.Js.push(a)}}var n=g("__animation"),e=g("__batch"),z=g("__boundings"),M=
g("__camera"),E=g("__config"),F=g("__constraints"),A=g("__geometry"),O=g("__lights"),H=g("__nla"),I=g("__nodemat"),C=g("__obj_util"),h=g("__particles"),k=g("__physics"),J=g("__print"),y=g("__primitives"),d=g("__quat"),B=g("__scenes"),u=g("__sfx"),ba=g("__transform"),K=g("__textures"),G=g("__tsr"),T=g("__util"),P=g("__vec3"),X=g("__armature"),x=g("__anchors"),ka=g("__renderer"),ca=E.B,Q=E.Uc,W={ALL:[]},ha=new Float32Array(24),v=0,Z=0,Y=[],V=[],ta=new Float32Array(3),oa=new Float32Array(4);a.Oy=0;a.Ny=
1;a.Nc=2;a.oc=-1;a.update=function(a){for(var b=0;b<V.length;b++){var d=V[b],e=d,f=a,h=0,k=e.UK;0==k.Px&&(k.Px=f);f-=k.Px;if(k.lD&&f/k.Rf>=k.lD)c(e);else{f%=k.Rf;if(f<k.RC)switch(k=f/(k.RC/5),f=Math.floor(k),f){case 0:h=(k-f)/2;break;case 1:h=(k-f)/2+.5;break;case 2:h=1;break;case 3:h=1-(k-f)/2;break;case 4:h=.5-(k-f)/2}e.k.qh=h}d.k.qh&&q(d)}if(a=W.ARMATURE)for(b=0;b<a.length;b++)d=a[b],d.KC&&(ba.D(d),d.KC=!1)};a.Wo=function(a,b){a.k.qh=b;q(a)};a.Kn=function(a,b,c,d){var e=a.UK;e.Px=0;e.RC=b;e.Rf=
c;e.lD=d;-1==V.indexOf(a)&&V.push(a)};a.Hu=c;a.kl=function(a,b){b.Ej=a.uuid;b.Uj=!0;r(a,b);a.Gz=b.Ra=D(a,b);a.CQ=!0;b.ef=a.b4w_vehicle;b.og=a.b4w_character;b.Cm=a.b4w_floating;b.pn=a.b4w_collision;b.cc=a.b4w_collision_id;b.Mu=a.b4w_correct_bounding_offset;var c=a.game;b.rh={ys:c.physics_type,ot:c.use_ghost,QN:c.use_sleep,ei:c.mass,WN:c.velocity_min,VN:c.velocity_max,UH:c.damping,DL:c.rotation_damping,aX:c.lock_location_x,bX:c.lock_location_y,cX:c.lock_location_z,dX:c.lock_rotation_x,eX:c.lock_rotation_y,
fX:c.lock_rotation_z,Vq:c.collision_margin,Tq:c.collision_group,Wq:c.collision_mask,DE:c.use_collision_bounds,Iu:c.collision_bounds_type,kt:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.sf={name:c.name,lf:c.part,e_:c.suspension_rest_length,cE:c.suspension_compression,eE:c.suspension_stiffness,dE:c.suspension_damping,OE:c.wheel_friction,uD:c.roll_influence,wC:c.max_suspension_travel_cm,Br:c.force_max,Gq:c.brake_max,kp:c.steering_max,Ao:c.max_speed_angle,lr:c.delta_tach_angle,at:c.speed_ratio,
dt:c.steering_ratio,Wr:c.inverse_control,hm:c.floating_factor,un:c.water_lin_damp,vn:c.water_rot_damp,bN:c.synchronize_position};if(c=a.b4w_floating_settings)b.fo={name:c.name,lf:c.part,hm:c.floating_factor,un:c.water_lin_damp,vn:c.water_rot_damp,bN:c.synchronize_position};if(c=a.b4w_character_settings)b.bH={C0:c.walk_speed,FY:c.run_speed,YZ:c.step_height,HW:c.jump_strength,E0:c.waterline};for(c=0;c<a.constraints.length;c++){var d=a.constraints[c];"RIGID_BODY_JOINT"==d.type&&b.ZC.push({target:d.target.nb,
RX:d.pivot_type,SX:d.pivot_x,TX:d.pivot_y,UX:d.pivot_z,Ga:d.axis_x,Ha:d.axis_y,Ia:d.axis_z,o0:d.use_limit_x,p0:d.use_limit_y,q0:d.use_limit_z,k0:d.use_angular_limit_x,l0:d.use_angular_limit_y,m0:d.use_angular_limit_z,RW:d.limit_max_x,SW:d.limit_max_y,TW:d.limit_max_z,UW:d.limit_min_x,VW:d.limit_min_y,WW:d.limit_min_z,LW:d.limit_angle_max_x,MW:d.limit_angle_max_y,NW:d.limit_angle_max_z,OW:d.limit_angle_min_x,PW:d.limit_angle_min_y,QW:d.limit_angle_min_z})}c=b.k=C.er("MESH"===b.type?b.Ra?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.nb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.vs=a.parent_bone),a.pinverse_tsr&&(b.Tw=G.create(),G.copy(a.pinverse_tsr,b.Tw))):a.dg_parent&&(b.parent=a.dg_parent.nb,b.Kk=!0);var d=a.location,h=a.scale[0];T.fD(a.rotation_quaternion,oa);ba.Vc(b,d);ba.ni(b,oa);ba.Sf(b,h);b.mt=a.b4w_use_default_animation;b.El=n.Mz(a.b4w_anim_behavior);a.b4w_object_tags&&(b.xw={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,o3:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.hy={FQ:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":X.kl(a,b);d=c.Pg;h=n.QR(d);a.b4w_animation_mixing?(c.qe=new Float32Array(h.Eb),c.Je=new Float32Array(h.Eb),c.ve=new Float32Array(h.trans),c.Me=new Float32Array(h.trans)):(c.qe=h.Eb,c.Je=h.Eb,c.ve=h.trans,c.Me=h.trans);for(var k in d){var m=d[k];1==m.Fu.length&&X.I_(m,!0,h.trans,h.Eb)}c.Cs=h;c.cf=0;c.Gi=a.b4w_animation_mixing;break;case "MESH":c.Zn=a.b4w_do_not_render;
c.Il=e.vR(a.data.b4w_boundings.bb);c.Rk=Q.outlining_overview_mode||a.b4w_selectable;c.Lw=a.b4w_selectable;c.Uc=Q.outlining_overview_mode||a.b4w_outlining;c.Kw=a.b4w_outlining;c.Mw=Q.outlining_overview_mode||a.b4w_outline_on_select;c.Og=a.b4w_billboard;c.Aq=a.b4w_pres_glob_orientation;c.Cq="BASIC";c.Bq="SPHERICAL"==a.b4w_billboard_geometry;k=c.gi;k.Fk=a.b4w_outline_settings.outline_duration;k.Gk=a.b4w_outline_settings.outline_period;k.Hk=a.b4w_outline_settings.outline_relapses;c.Rk&&(c.Xj=T.xI(v),
v++);for(k=0;k<a.data.b4w_vertex_anim.length;k++)d=a.data.b4w_vertex_anim[k],b.Yc.push({name:d.name,va:d.frame_start,$a:d.frame_end,g3:d.averaging,h3:d.averaging_interval,GQ:d.allow_nla});b.k.Yc=b.Yc.length?!0:!1;"MESH"!=a.type&&T.q("Wrong object type: "+a.name);k=b.k;if(a.data.b4w_shape_keys.length)for(k.Oe=!0,d=0;d<a.data.b4w_shape_keys.length;d++)h={},h.value=a.data.b4w_shape_keys[d].value,h.name=a.data.b4w_shape_keys[d].name,k.pi.push(h);else k.Oe=!1;c.Ke=a.b4w_shadow_cast;c.ie=a.b4w_shadow_receive;
c.te=a.b4w_shadow_cast_only&&c.Ke;c.ge=a.b4w_reflexible;c.Id=a.b4w_reflexible_only&&c.ge;c.Hd=a.b4w_reflective;c.th=a.b4w_reflection_type;if(!c.Hd)for(k=a.data.materials,d=0;d<k.length;d++)h=k[d],h.use_nodes&&-1!=h.node_tree.Fz.indexOf("BSDF_GLOSSY")&&(c.Hd=!0,c.th="CUBE");c.Sg=a.b4w_caustics;if(c.vf=a.b4w_wind_bending)c.xn=a.b4w_wind_bending_angle,k=e.F0(a.b4w_wind_bending_angle,c.Il,a.scale[0]),c.Bh=k,c.Ch=a.b4w_wind_bending_freq,c.Xg=a.b4w_detail_bending_freq,c.Wg=a.b4w_detail_bending_amp,c.Rg=
a.b4w_branch_bending_amp,c.dj=a.b4w_main_bend_stiffness_col,k=a.b4w_detail_bend_colors,c.De.jC=k.leaves_stiffness_col,c.De.iC=k.leaves_phase_col,c.De.TC=k.overall_stiffness_col;c.$h=a.b4w_hidden_on_load;c.gg=a.b4w_dynamic_geometry;"MESH"!==a.type&&T.q("Wrong object");k=a.data.materials[0];c.km=k.physics.friction;c.em=k.physics.elasticity;c.kh=0;c.jf=C.$p;c.lh=a.b4w_lod_transition;c.Sw=a.pass_index;break;case "LINE":c.S=z.Sd();c.ba=z.Tg();c.Ta=z.Sd();c.pb=z.Tg();break;case "CAMERA":M.XR(a,b);M.lR(b);
break;case "LAMP":O.IW(a,b);break;case "SPEAKER":b.Y=u.hT();c=!1;for(k=0;k<b.I.length;k++)if(b.I[k].yb.Qc){c=!0;break}c&&u.kl(a,b);break;case "EMPTY":k=z.Sd(),c.S=k,k=z.Rh(),c.wa=k,a.field&&(b.eo={type:a.field.type,VM:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Yn:a.b4w_anchor.detect_visibility,dk:a.b4w_anchor.element_id,sX:a.b4w_anchor.max_width})}f(b)};a.g0=function(a,b){b.Ej=a.uuid;b.Uj=!0;r(a,b);a.Gz=b.Ra=D(a,b);a.CQ=!0;b.k=C.er(b.type);b.mt=a.b4w_use_default_animation;
b.El=n.Mz(a.b4w_anim_behavior);f(b)};a.V_=function(a,b){var c=b.k;if(b.parent){!b.Kk&&b.rh.kt&&b.parent.rh.kt&&(b.pn=!1);for(var e=!1,h=0;h<b.I.length;h++)if(b.I[h].yb.Ac){e=!0;break}if(h=e)h=b.rh,h=b.ef||b.Cm||k.og(b)||b.pn&&!h.ot&&0<h.ei&&("DYNAMIC"==h.ys||"RIGID_BODY"==h.ys);if(h)h=b.Kk?G.copy(c.n,G.create()):c.n,G.multiply(b.parent.k.n,h,c.n),ba.Vc(b,G.G(c.n)),ba.Sf(b,G.$d(c.n)),ba.ni(b,G.R(c.n));else if(b.Kk||!b.vs)if(h=G.copy(c.n,G.create()),b.hy&&"CAMERA"==b.parent.type){h={distance:b.hy.distance,
rotation:G.R(h)};switch(b.hy.FQ){case "TOP_LEFT":h.top=0;h.left=0;break;case "TOP":h.top=0;h.left=.5;break;case "TOP_RIGHT":h.top=0;h.right=0;break;case "LEFT":h.top=.5;h.left=0;break;case "CENTER":h.top=.5;h.left=.5;break;case "RIGHT":h.top=.5;h.right=0;break;case "BOTTOM_LEFT":h.bottom=0;h.left=0;break;case "BOTTOM":h.bottom=0;h.left=.5;break;case "BOTTOM_RIGHT":h.bottom=0,h.right=0}F.Oz(b,b.parent,h)}else F.KQ(b,b.parent,h);else h=G.copy(c.n,G.create()),F.LQ(b,b.parent,b.vs,h)}if("ARMATURE"==b.type)for(e=
a.pose.bones,h=0;h<e.length;h++){var m=e[h],v=m.constraints;if(v)for(var g=0;g<v.length;g++){var p=v[g];"COPY_TRANSFORMS"!=p.type||p.subtarget||p.mute||F.XQ(b,p.target.nb,m.name,T.IF,T.En)}}if("MESH"==b.type)var l=n.MI(a);if(l){v=l.nb;h=v.k.Cs;e=b.k;m=a.data;b.su=v;m=m.vertex_groups;if(m.length){var v=v.k.Pg,g=0,p={},L;for(L in v){var u=T.Ed("name",L,m);u&&(p[L]={ZN:u.index,Tj:v[L].Tj,ZA:g++})}e.Ji=p;L=g;m=n.bJ();e.mh=L;L>2*m?(e.uk=!1,J.error('too many bones for "'+a.name+'" / '+e.mh+" bones (max "+
m+" with blending, "+2*m+" without blending). Skinning will be disabled.")):e.uk=!0}L=n.zU(h.trans,h.Eb,c.Ji);l.b4w_animation_mixing?(c.qe=new Float32Array(L.Eb),c.Je=new Float32Array(L.Eb),c.ve=new Float32Array(L.trans),c.Me=new Float32Array(L.trans)):(c.qe=L.Eb,c.Je=L.Eb,c.ve=L.trans,c.Me=L.trans);c.sq=new Float32Array(4);c.rq=d.create();c.Cs=L;c.cf=0}if(c.Hd)if(c=b.k,"CUBE"==c.th)c.Td=Z++;else if("PLANE"==c.th){a:{l=a.constraints;for(L=0;L<l.length;L++)if(h=l[L],"LOCKED_TRACK"==h.type&&"REFLECTION PLANE"==
h.name){if(h.target.nb){l=h.target.nb;break a}J.warn('Reflection plane target "'+h.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}l=null}l||(l=T.gt("%reflection%"),l=C.dr(l,"EMPTY"),L=C.er("EMPTY"),l.k=L,w(b,l),F.iG(l,b,[0,0,0],null,1),f(l));L=null;for(h=0;h<Y.length;h++)if(Y[h]==l){L=h;break}null==L&&(L=Y.length,Y.push(l));l.k.Fd=L;c.Fd=L;l.Js.push(b)}};a.Q_=b;a.V3=w;a.hS=t;a.W_=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=c.k.type&&
"CAMERA"!=c.k.type||ba.D(c);c.mt&&n.SK(c)&&(n.qu(c),c.ia.length&&n.play(c,null,n.xl))}};a.xv=function(a){return T.T(a.xw)};a.ua=function(){Z=v=0;Y.length=0;V.length=0;W={ALL:[]}};a.copy=function(a,b,c){var d=b,h=C.Xi(a);b=h?C.yI(h.name,b):b;if(m(b,W.ALL,!1,-1)){for(var h=1,k;;){k="."+(3>String(h).length?("000"+String(h)).slice(-3):String(h));if(!m(b+k,W.ALL,!1,-1))break;h++}J.error('Object "'+b+'" already exists. Name was replaced by "'+b+k+'".');d+=k;b+=k}d=C.dr(b,a.type,d);d.Uj=a.Uj;d.Ra=a.Ra;d.Yr=
a.Yr;d.mt=a.mt;d.Vg=a.Vg;d.k=C.rA(a.k);d.xw=C.Lu(a.xw);w(a,d);d.lu=C.yA(a.lu);d.parent=C.yA(a.parent);d.Kk=a.Kk;d.vs=a.vs;d.Yc=C.yA(a.Yc);d.El=a.El;!a.C||a.ef||a.og||a.Cm||(d.pn=a.pn,d.C=null);d.cc=a.cc;d.Mu=a.Mu;d.rh=C.Lu(a.rh);b=[];for(h=0;h<a.I.length;h++){k=d.I[h];var n=a.I[h].X;if(c){for(var g=k.X,l=0;l<n.length;l++)if(!n[l].kg){var p=C.Lu(n[l]);p.Ca=A.ES(n[l].Ca);g.push(p);b.push(n[l].Ca)}for(l=0;l<n.length;l++)if(n[l].kg){p=C.Lu(n[l]);g.push(p);for(var L=0;L<b.length;L++)b[L]==n[l].Ca&&(p.Ca=
g[L].Ca)}for(l=0;l<g.length;l++)g[l].Ca&&A.CN(g[l].Ca),ca.Jz&&ka.pR(g[l]),g[l].Dk=d.Ej,e.D_(g[l]);K.AZ(g)}else k.X=n;for(l=0;l<k.X.length;l++)for(n=k.X[l].ya,g=0;g<n.length;g++)K.Yv(n[g])}c||(d.k.zp=!1);C.yD(d,!1);f(d);d.k.cw=!0;d.k.dw=c;d.k.Xj=T.xI(v);v++;return d};a.J_=function(a){for(var b=a.k,c=a.I[0].X,d,f,h,k,n,m,v,g,l,p,u,x,q=[],r=0;r<c.length;r++){var B=c[r];if("MAIN"==B.type){var J=A.Or("a_position"),J=A.Dv(B.Ca.tc,J),Q=B.Ca.jd.a_position.offset;d=k=J[Q];f=n=J[Q+1];h=m=J[Q+2]}}for(r=0;r<
c.length;r++)if(B=c[r],B.Ca&&B.pb&&B.Ta){var J=A.Or("a_position"),J=A.Dv(B.Ca.tc,J),Q=B.Ca.jd.a_position.offset,t=B.Ca.jd.a_position.length+Q;v=p=J[Q];g=u=J[Q+1];l=x=J[Q+2];for(var Z=Q;Z<t;Z+=3){var Q=J[Z],C=J[Z+1],I=J[Z+2];v=Math.max(Q,v);g=Math.max(C,g);l=Math.max(I,l);p=Math.min(Q,p);u=Math.min(C,u);x=Math.min(I,x)}B.S.max_x=v.toFixed(3);B.S.max_y=g.toFixed(3);B.S.max_z=l.toFixed(3);B.S.min_x=p.toFixed(3);B.S.min_y=u.toFixed(3);B.S.min_z=x.toFixed(3);z.Nl(B.S,b.n,B.Ta);z.kI(B.Ta,ha);for(J=q.length=
0;J<ha.length;J++)q.push(ha[J]);B.pb=z.Nu(q,!0);B.ba=z.LR(B.pb,b.n);B.wa=z.br(B.ba);B.kb=z.br(B.pb);B.Yf=z.cC(B.ba,B.wa);"MAIN"==B.type&&(d=Math.max(v,d),f=Math.max(g,f),h=Math.max(l,h),k=Math.min(p,k),n=Math.min(u,n),m=Math.min(x,m))}q={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(f.toFixed(3)),max_z:parseFloat(h.toFixed(3)),min_x:parseFloat(k.toFixed(3)),min_y:parseFloat(n.toFixed(3)),min_z:parseFloat(m.toFixed(3))};p=d-k;g=f-n;v=h-m;k=.5*(d+k);l=.5*(f+n);u=.5*(h+m);var G=k,V=u;n=Math.max(p,
Math.max(g,v))/2;m=Math.max(p,v)/2;var W=[k/(p?p:1),l/(g?g:1),u/(v?v:1)];x=.5;if(b.Og)Q=Math.max(Math.abs(q.max_x),Math.abs(q.min_x)),C=Math.max(Math.abs(q.max_y),Math.abs(q.min_y)),I=Math.max(Math.abs(q.max_z),Math.abs(q.min_z)),h=Math.sqrt(Q*Q+C*C+I*I),r=Math.sqrt(Q*Q+C*C),q.max_x=q.max_y=q.max_z=h,q.min_x=q.min_y=q.min_z=-h,m=r,n=h,Q=new Float32Array([0,0,0]),d=new Float32Array([n,n,n]),h=new Float32Array([0,0,0]);else{for(r=0;r<c.length;r++)if(B=c[r],"MAIN"==B.type)for(J=A.Or("a_position"),J=
A.Dv(B.Ca.tc,J),t=c[r].Ca.jd,Q=t.a_position.offset,t=t.a_position.length+Q,Z=Q;Z<t;Z+=3){var Q=J[Z],C=J[Z+1],I=J[Z+2],M=Math.sqrt((k-Q)*(k-Q)+(l-C)*(l-C)+(u-I)*(u-I));if(M>n){var B=k-n*(Q-k)/M,E=l-n*(C-l)/M,M=u-n*(I-u)/M;k=(B+Q)/2;l=(E+C)/2;u=(M+I)/2;n=Math.sqrt((k-Q)*(k-Q)+(l-C)*(l-C)+(u-I)*(u-I))}E=Math.sqrt((G-Q)*(G-Q)+(V-I)*(V-I));E>m&&(B=G-m*(Q-G)/E,M=V-m*(I-V)/E,G=(B+Q)/2,V=(M+I)/2,m=Math.sqrt((G-Q)*(G-Q)+(V-I)*(V-I)));Q/=p?p:1;C/=g?g:1;I/=v?v:1;M=Math.sqrt((W[0]-Q)*(W[0]-Q)+(W[1]-C)*(W[1]-
C)+(W[2]-I)*(W[2]-I));M>x&&(B=W[0]-x*(Q-W[0])/M,E=W[1]-x*(C-W[1])/M,M=W[2]-x*(I-W[2])/M,W[0]=(B+Q)/2,W[1]=(E+C)/2,W[2]=(M+I)/2,x=Math.sqrt((W[0]-Q)*(W[0]-Q)+(W[1]-C)*(W[1]-C)+(W[2]-I)*(W[2]-I)))}r=p?p*W[0]:d;f=g?g*W[1]:f;h=v?v*W[2]:h;d=x*p;J=x*g;t=x*v;Q=new Float32Array([k,l,u]);d=new Float32Array([d,J,t]);h=new Float32Array([r,f,h]);m=parseFloat(m.toFixed(3))}b.S=q;e.dZ(b,m,m,q);q=z.cA(n,Q);b.wa=q;q=z.zq([d[0],0,0],[0,d[1],0],[0,0,d[2]],h);b.ba=q;ba.D(a);if(ca.debug_view)for(r=0;r<c.length;r++)if("DEBUG_VIEW"===
c[r].type&&c[r].Ri){a=y.rv(1,q.F);A.HL(a,[q.Ga[0],q.Ha[1],q.Ia[2]],q.F);A.Ox(a,1,!0);a.qa.a_polyindex=A.iv(a);e.C_(c[r],a);break}};a.Ub=p;a.pJ=function(a,b,c){b=W[b]||[];for(var d=[],e=0;e<b.length;e++){var f=b[e];if((f.k.Ye==c||-1==c)&&f.Uj)for(var h=f.I,k=0;k<h.length;k++)h[k].yb==a&&d.push(f)}return d};a.pm=function(a){var b=W.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.k.Ye==a&&c.push(e)}return c};a.sm=function(a){var b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];
if(k.og(d))for(var e=d.I,f=0;f<e.length;f++)if(e[f].yb==a)return d}return null};a.KZ=function(a){var b=p(a,"LAMP",-1);if(b.length==a.s.c8){for(var c=[],d=0;d<b.length;d++){var e=b[d],e=C.ja(e,a);c[e.Jm]=d}for(d=0;d<c.length-1;d++)for(e=d+1;e<c.length;e++){var f=b[c[d]].tb,h=b[c[e]].tb;if(h.on&&h.qn&&(!f.on||!f.qn)||!f.on&&(h.on||!f.qn&&h.qn))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)e=b[c[d]],C.ja(e,a).Jm=d,B.yp(b[c[d]],a)}};a.Iw=function(a,b,c,d){for(var e=0;e<a.I.length;e++)for(var f=a.I[e].X,
h=0;h<f.length;h++){var k=f[h];k.Ca.dg=b;k.dg=b;k.zb.dg=c;""!==k.Bk&&(k=I.eJ(k.Bk))&&(k.mH=d)}};a.qJ=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.Rk&&d.Uj&&a.push(d)}return a};a.l6=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.Uc&&d.Uj&&a.push(d)}return a};a.xc=function(b,c,d,e){var f=null,h=W.ALL;switch(b){case a.Oy:f=m(c,h,!0,d,e);break;case a.Ny:a:{for(b=0;b<h.length;b++)if(f=h[b],f.Qm==d&&(f.k.Ye==e||-1==e)){var k=C.Xi(f);if(k&&k.Qm==
c)break a}f=null}break;case a.Nc:a:{for(e=0;e<h.length;e++){b=h[e];for(var f=c.length-1,k=b,n=!0;0<=f&&n;)n=k&&k.Qm==c[f]&&(k.k.Ye==d||-1==d),k&&(k=C.Xi(k)),f--;if(n&&!k){f=b;break a}}f=null}}return f};a.Ev=function(a,b){return m("%meta_world%"+a,W.WORLD,!0,b)};a.Lo=function(b,c){var d=B.Yh();if(!d)return J.error("No active scene"),null;var e=x.PX(b,c);if(e)return e;e=B.QX(d,b,c);if(!e)return null;for(var d=p(d,"MESH",-1),f=0;f<d.length;f++){var h=d[f].k,k=h.Xj;if(k&&3>Math.abs(255*k[0]-e[0])&&3>
Math.abs(255*k[1]-e[1])&&3>Math.abs(255*k[2]-e[2]))return h.Uc&&h.Mw&&(Q.outlining_overview_mode?a.Kn(d[f],Q.Fk,Q.Gk,Q.Hk):(e=h.gi,a.Kn(d[f],e.Fk,e.Gk,e.Hk))),d[f]}return null};a.rM=function(a,c){for(var d=p(a,"EMPTY",-1),e=0;e<d.length;e++){var f=d[e];if(f.eo&&"WIND"===f.eo.type){var h=f;break}}if(!h)return J.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=T.Cb(c.wind_dir),P.set(Math.sin(d),-Math.cos(d),0,ta),T.bB(ta,T.nc,oa),ba.ni(h,oa));"number"==typeof c.wind_strength&&
(h.eo.VM=c.wind_strength);b(h)};a.Ks=function(a){F.jS(a)&&F.remove(a);var b=W.ALL,c=W[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.HX=f;a.IX=function(a){return W[a.type]&&-1<W[a.type].indexOf(a)}};b4w.module.__animation=function(a,g){function q(a,b){var c=a.ia[b];c&&c.rB&&c.wr&&(c.wr=!1,c.rB(a,b))}function c(a,b,c){c=a.ia[c];c.type=30;var d=b.va,e=b.$a-d+1;c.start=d;c.length=e;c.Ef=d;c.Hi=b.name;for(e=d=0;e<a.Yc.length;e++){var f=a.Yc[e];if(f==b)break;else d+=f.$a-f.va+1}c.RN=d}function b(a,b){a.type=50;a.Hi=b.name;a.start=b.va;a.length=b.$a-a.start;b.Ce||(a.length+=b.lC)}function w(a){return a.replace(/_B4W_BAKED$/,"")}function t(a,b){return{Eo:a,action:b}}function D(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.s.type&&b.push(t(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var f=e.node_group.node_tree;if(f){var h=c.slice();h.push(e.name);D(f,b,h)}}}}function l(a){return Q.be(a)&&a.k.Yc?!0:!1}function r(a,b,c){var d=a.ia;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.Ef=b,m(a,0,c,!0))}else if(e=d[c])e.Ef=b,m(a,0,c,!0)}function p(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function m(a,b,c,d){A(a,b,c,d);q(a,c);a.k.Gi&&(I(a,b),H(a,
b))}function f(a,b,c,d){var f=c.frame_range;if(f[0]>f[1])return v.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var k=c.s,m=a.ia[d];m.Hi=c.name;m.Hz=f;m.$F=k.aL;m.YF=k.EG;m.Li.set(k.Li);m.start=f[0];m.length=f[1]-f[0];m.Ef=f[0];switch(k.type){case 10:if(Q.Am(a)){m.type=10;var g=n(a,b,c);if(!g){for(var g=a.k.Pg,f=[],l=[],p=c.s.NC,u=0;u<p;u++){for(var L in g){var x=g[L],q=x.Sx,r=c.s.Zz[L];r?za.copy(r.subarray(8*u,8*u+8),q):za.identity(q);x.Tx=!1}x=C(g);f.push(x.trans);
l.push(x.Eb)}g={trans:f,Eb:l};e(a,b,c,g)}m.trans=g.trans;m.Eb=g.Eb;b=g;m=a.k;g=m.cp;f=a.ia[d];L=f.TD;a:{l=m.Ax;for(p=0;p<l.length;p+=2)if(c==l[p]){l=l[p+1];break a}l=null}if(l)f.TD=l;else{for(f=0;f<g.length;f++){l=g[f].Ji;p=[];u=[];x=b.trans;q=b.Eb;for(r=0;r<x.length;r++){var B=h(x[r],q[r],l);p.push(B.trans);u.push(B.Eb)}L.push({trans:p,Eb:u})}m.Ax.push(c,L)}m.Gi&&(c=m.wp,d>c[1]?(b=c[1],c[1]=d,c[0]=b):d>c[0]&&d<c[1]&&(c[0]=d),z(a))}break;case 40:Q.as(a)&&(m.volume=k.qb.volume||null,m.pitch=k.qb.pitch||
null,m.type=40);break;case 70:Q.hh(a)&&(m.color=k.qb.color||null,m.Gf=k.qb.energy||null,m.type=70);break;case 60:if("MESH"==a.type){m.type=60;L=n(a,b,c);if(!L){L=[];f=[];l=[];p=[];u=[];x=c.s;q=b?b[0]:null;for(g in x.qb){r=b;B=g.match(/"(.*?)"/)[1];if(r&&1<r.length){for(var J=r[1],y=2;y<r.length;y++)J=J+"%join%"+r[y];J+="%join%"+B}else J=B;r=J;for(B=0;B<a.I.length;B++)for(J=a.I[B].X,y=0;y<J.length;y++){var da=J[y];if(!q||-1!=da.td.indexOf(q)){var t=da.jj,ca=E(g,r,x,f,L,da.kj),t=E(g,r,x,p,l,t);(ca||
t)&&u.push(da)}}}L={r0:L,values:f,AY:l,BY:p,Fw:u};e(a,b,c,L)}m.kj=L.r0;m.MK=L.values;m.jj=L.AY;m.LK=L.BY;m.Fw=L.Fw}break;case 20:if(g=k.qb.tsr){m.type=20;L=n(a,b,c);if(!L){L=c.s.NC;f=[];l=[];for(p=0;p<L;p++)f.push(g.subarray(8*p,8*p+4)),l.push(g.subarray(8*p+4,8*p+8));L={trans:f,Eb:l};e(a,b,c,L)}m.trans=L.trans;m.Eb=L.Eb;W.Fo(a)&&W.f0(a,m.trans[0],m.Eb[0])}else return v.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:Q.fC(a)&&(m.Gf=k.qb["light_settings.environment_energy"]||
null,m.ne=k.qb.horizon_color||null,m.we=k.qb.zenith_color||null,m.Ar=k.qb["mist_settings.intensity"]||null,m.fog_depth=k.qb["mist_settings.depth"]||null,m.fog_start=k.qb["mist_settings.start"]||null,m.fog_height=k.qb["mist_settings.height"]||null,m.oI=k.qb.b4w_fog_color||null,m.type=80)}Q.Am(a)&&10!=k.type&&M(a,d);return!0}function n(a,b,c){a=a.lu;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}function e(a,b,c,d){a.lu.push(c,b?b.join("%join%"):
null,d)}function z(a){var b=a.k.wp;if(-1!=b[0]&&-1!=b[1]){var c=a.ia;a=c[b[1]].Ef;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.Ef;d=Math.floor(a);b.Ef=d+e}}function M(a,b){var c=a.k.wp,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.ia;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function E(a,b,c,d,e,f){if(!f)return!1;for(var h=!1,k=0;k<f.length;k+=2)b==f[k]&&(e.push(f[k+1]),d.push(new Float32Array(c.qb[a])),h=!0);return h}function F(a){a=a.s;for(var b in a.qb)if(-1!=
b.indexOf("nodes"))return!0;return!1}function A(a,b,c,d){if((c=a.ia[c])&&null!=c.type&&(c.play||d)){var e=a.k,f=c.Ef,h=c.start,k=c.length,f=f+c.speed*b*S.qd(),n=c.type,m=c.speed;if(0<=m&&f>=h+k||0>m&&f<h)switch(d||(c.wr=!0),c.behavior){case 10:f=0<=m?(f-h)%k+h:h+k-1E-6;break;case 20:f=0<=m?h:h+k-1E-6;c.play=!1;break;case 30:f=0<=m?h+k-1E-6:h,c.play=!1}c.Ef=f;switch(n){case 10:if(!e.Gi){d=O(c);b=d[0];var g=d[1];d=d[2];e.qe=c.Eb[b];e.Je=c.Eb[g];e.ve=c.trans[b];e.Me=c.trans[g];e.cf=d;d=e.cp;c=c.TD;for(var v=
0;v<d.length;v++){var l=d[v],p=c[v];l.qe=p.Eb[b];l.Je=p.Eb[g];l.ve=p.trans[b];l.Me=p.trans[g];l.cf=e.cf}ga.D(a)}break;case 20:d=O(c);var e=N,g=d[0],v=d[1],l=d[2],p=c.trans,u=p[g][1],f=p[g][2],h=p[v][1],k=p[v][2];e[0]=(1-l)*p[g][0]+l*p[v][0];e[1]=(1-l)*u+l*h;e[2]=(1-l)*f+l*k;g=L;f=d[0];v=d[1];l=d[2];p=c.Eb;u=Aa;u[0]=p[f][0];u[1]=p[f][1];u[2]=p[f][2];u[3]=p[f][3];f=xa;f[0]=p[v][0];f[1]=p[v][1];f[2]=p[v][2];f[3]=p[v][3];Z.slerp(u,f,l,g);v=d[2];l=c.trans;d=(1-v)*l[d[0]][3]+v*l[d[1]][3];a.parent&&a.Tw&&
(v=ia,za.oi(e,d,g,v),za.multiply(a.Tw,v,v),za.jc(v,e),za.Zd(v,g),d=za.$d(v));c.wE&&(v=ea,ga.sd(a,v),ua.Ix(e,v,b,c.wE,e));c.gD&&(v=Aa,ga.Lf(a,v),ua.JM(g,v,b,c.gD,g));f=c.Li;f[0]&&ga.wx(a,e);f[1]&&ga.tx(a,g);f[2]&&ga.LD(a,d);ga.D(a);ha.H(a);break;case 30:d=c.Ef-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.RN;pa[0]=a+c;pa[1]=b+c;pa[2]=d;d=pa;e.ay=d[0];e.by=d[2];break;case 40:d=O(c);b=d[0];e=d[1];d=d[2];c.volume&&ta.tZ(a,(1-d)*c.volume[b]+
d*c.volume[e]);c.pitch&&ta.YX(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-h)/S.qd():f/S.qd();W.nZ(a,c.Hi,b);break;case 60:d=O(c);b=d[0];e=d[1];d=d[2];p=c.MK;u=c.kj;a=c.LK;g=c.jj;v=c.Fw;for(c=0;c<u.length;c++)for(f=p[c],l=u[c],h=(1-d)*f[b]+d*f[e],f=0;f<v.length;f++)v[f].lj[l]=h;for(c=0;c<g.length;c++)for(p=a[c],l=g[c],p=la.lerp(p.subarray(3*b,3*b+3),p.subarray(3*e,3*e+3),d,N),f=0;f<v.length;f++)v[f].He[3*l]=p[0],v[f].He[3*l+1]=p[1],v[f].He[3*l+2]=p[2];break;case 70:d=O(c);b=
d[0];e=d[1];d=d[2];f=c.Li;(k=c.Gf)&&f[0]&&ca.Ss(a.tb,(1-d)*k[b]+d*k[e]);(c=c.color)&&f[1]&&(N[0]=(1-d)*c[3*b]+d*c[3*e],N[1]=(1-d)*c[3*b+1]+d*c[3*e+1],N[2]=(1-d)*c[3*b+2]+d*c[3*e+2],ca.qx(a.tb,N));h=a.I;for(c=0;c<h.length;c++)V.R_(a,h[c].yb);break;case 80:d=O(c);b=d[0];e=d[1];d=d[2];f=c.Li;h=a.I;m=V.La(h[0].yb,oa.Pb);k=c.Gf;k=f[0]?(1-d)*k[b]+d*k[e]:m.Gf;n=c.ne;f[1]?(N[0]=(1-d)*n[3*b]+d*n[3*e],N[1]=(1-d)*n[3*b+1]+d*n[3*e+1],N[2]=(1-d)*n[3*b+2]+d*n[3*e+2],n=N):n=m.ne;var x=c.we;f[2]?(ea[0]=(1-d)*x[3*
b]+d*x[3*e],ea[1]=(1-d)*x[3*b+1]+d*x[3*e+1],ea[2]=(1-d)*x[3*b+2]+d*x[3*e+2],m=ea):m=m.we;x=c.Ar;f[3]&&(g=(1-d)*x[b]+d*x[e]);x=c.fog_depth;f[4]&&(v=(1-d)*x[b]+d*x[e]);x=c.fog_start;f[5]&&(l=(1-d)*x[b]+d*x[e]);x=c.fog_height;f[6]&&(p=(1-d)*x[b]+d*x[e]);c=c.oI;f[7]&&(L[0]=(1-d)*c[3*b]+d*c[3*e],L[1]=(1-d)*c[3*b+1]+d*c[3*e+1],L[2]=(1-d)*c[3*b+2]+d*c[3*e+2],u=L);for(c=0;c<h.length;c++)b=a.I[c].yb,(f[0]||f[1]||f[2])&&V.mx(b,k,n,m),f[3]&&V.XL(b,g),f[4]&&V.VL(b,v),f[5]&&V.YL(b,l),f[6]&&V.WL(b,p),f[7]&&V.ED(b,
u);break;default:ua.q("Unknown animation type:"+n)}}}function O(a){var b=a.Hz[0],c=a.Hz[1]-b,b=a.Ef-b;0>b&&(b=0);b>=c&&(b=c);b/=a.$F;c=Math.floor(b);a=a.YF[c]?b-c:0;b=Math.ceil(c+a);pa[0]=c;pa[1]=b;pa[2]=a;return pa}function H(a,b){var c=a.k,d=c.Mh,e=c.wp,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var h=a.ia[f];if(h.play||0==b){var k=O(h),n=k[0],m=k[1];c.cf=k[2];var k=h.Eb[n],v=h.Eb[m],n=h.trans[n],m=h.trans[m]}else d=1}else d=1;e=a.ia[e];if(e.play||0==b){var f=O(e),g=f[0],l=f[1];c.cf=f[2]}else if(-1!=f&&
h.play)d=0;else return;f=e.Eb[g];h=e.Eb[l];g=e.trans[g];l=e.trans[l];if(1==d)c.qe.set(f),c.Je.set(h),c.ve.set(g),c.Me.set(l);else if(0==d)c.qe.set(k),c.Je.set(v),c.ve.set(n),c.Me.set(m);else{for(e=0;e<k.length;e+=4){for(var p=L,u=Aa,q=0;4>q;q++)p[q]=k[e+q],u[q]=f[e+q];Z.slerp(p,u,d,p);for(q=0;4>q;q++)c.qe[e+q]=p[q];for(q=0;4>q;q++)p[q]=v[e+q],u[q]=h[e+q];Z.slerp(p,u,d,p);for(q=0;4>q;q++)c.Je[e+q]=p[q]}ua.HG(n,g,d,c.ve);ua.HG(m,l,d,c.Me)}ga.D(a);x.c0(a)}}function I(a,b){var c=a.k,d=c.Mh,e=c.nq;if(0!=
e){var d=c.mq-d,f=e*b;ua.sign(d)==ua.sign(e)&&Math.abs(f)<Math.abs(d)?c.Mh+=f:(c.Mh=c.mq,c.nq=0)}}function C(a){var b=[],c=[],d=new Float32Array(4),e=new Float32Array(4),f;for(f in a){var h=a[f],k=d,n=e,m=h.Fu,v=m[m.length-1],g=v.yE;v.Tx||za.identity(g);for(v=m.length-1;0<=v;v--){var l=m[v],p=l.yE;if(l.Tx)g=p;else{var u=l.hl,L=l.Sx;za.invert(u,ia);za.multiply(L,ia,ia);za.multiply(u,ia,ia);za.multiply(g,ia,p);g=p;l.Tx=!0}}m=l.yE;k[0]=m[0];k[1]=m[1];k[2]=m[2];k[3]=m[3];n[0]=m[4];n[1]=m[5];n[2]=m[6];
n[3]=m[7];Z.normalize(n,n);h=h.Tj;for(k=0;4>k;k++)n=4*h+k,b[n]=d[k],c[n]=e[k]}return{trans:b,Eb:c}}function h(a,b,c){var d=[],e=[];new Float32Array(4);new Float32Array(4);for(var f in c)for(var h=c[f],k=h.Tj,h=h.ZA,n=0;4>n;n++){var m=4*h+n,v=4*k+n;d[m]=a[v];e[m]=b[v]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,Eb:e}}function k(a){var b=a.s,c;if(b.Zz)c=10;else if(b.qb)if("volume"in b.qb||"pitch"in b.qb)c=40;else if(F(a))c=60;else{var d;a:{if(a.s.qb){d=a.fcurves;for(var e in d)if("color"==
e&&!d[e][3]){d=!0;break a}if("energy"==e){d=!0;break a}}d=!1}if(d)c=70;else if(d=a.s.qb,"light_settings.environment_energy"in d||"horizon_color"in d||"zenith_color"in d||"mist_settings.intensity"in d||"mist_settings.depth"in d||"mist_settings.start"in d||"mist_settings.height"in d||"b4w_fog_color"in d)c=80;else{a:{if(a.s.qb)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function F(a){if(a=a.s.qb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;
return!1}function J(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function y(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function d(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==
c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function B(a,b,c,d,e,f,h){var k=a+(b-a)/2,n=u(k,d,e,f,h)-c;return.02>Math.abs(n)?k:0<n?B(a,k,c,d,e,f,h):B(k,b,c,d,e,f,h)}function u(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function ba(a,b){var c={type:null,Hi:null,Hz:null,$F:0,YF:null,Li:new Int8Array(8),Eb:null,trans:null,TD:[],play:!1,behavior:20,Ef:0,start:0,length:0,wE:0,gD:0,wr:!1,RN:null,speed:1,volume:null,pitch:null,color:null,Gf:null,we:null,ne:null,Ar:null,fog_depth:null,fog_start:null,
fog_height:null,oI:null,MK:[],kj:[],LK:[],jj:[],Fw:null};if(!a.ia.length)for(var d=0;8>d;d++)a.ia.push(null);a.ia[b]=c;-1==va.indexOf(a)&&va.push(a)}function K(a,b){ga.D(a);ha.H(a);m(a,0,b,!0)}function G(a,d,e,h){h=h||0;if(Q.be(a)){var k=T(a,e);if(k)return ba(a,h),c(a,k,h),K(a,h),!0;if((k=P(a,e))&&"EMITTER"==k.Nw){ba(a,h);d=k.name;e=h;for(var k=a.I,n=0;n<k.length;n++)for(var m=k[n].X,g=0;g<m.length;g++){var l=m[g].gb;l&&l.name==d&&b(a.ia[e],l)}K(a,h);return!0}}if(k=ua.Ed("name",e,na)||ua.Ed("name",
e+"_B4W_BAKED",na)){ba(a,h);if(f(a,d,k,h))return K(a,h),!0;a.ia[h]=null}v.error('Unsupported object: "'+a.name+'" or animation name: "'+e+'"');return!1}function T(a,b){for(var c=0;c<a.Yc.length;c++){var d=a.Yc[c];if(d.name===b)return d}return null}function P(a,b){for(var c=a.I,d=0;d<c.length;d++)for(var e=c[d].X,f=0;f<e.length;f++){var h=e[f].gb;if(h&&h.name===b)return h}return null}function X(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}
var x=g("__armature"),ka=g("__config"),ca=g("__lights"),Q=g("__obj_util"),W=g("__particles"),ha=g("__physics"),v=g("__print"),Z=g("__quat"),Y=g("__reformer"),V=g("__scenes"),ta=g("__sfx"),oa=g("__subscene"),S=g("__time"),ga=g("__transform"),za=g("__tsr"),ua=g("__util"),la=g("__vec3"),da=ka.Fl,ya=ka.Mi;a.$O=1E-6;a.sF=0;a.wz=10;a.xz=20;a.vF=30;a.uF=40;a.tF=50;a.rF=60;a.uP=70;a.tP=80;a.nd=0;a.BF=1;a.CF=2;a.DF=3;a.EF=4;a.FF=5;a.GF=6;a.bu=7;a.xl=-1;a.py=10;a.qy=20;a.ry=30;var pa=Array(3),N=new Float32Array(3),
ea=new Float32Array(3),L=new Float32Array(4),Aa=new Float32Array(4),xa=new Float32Array(4),ia=za.create();new Float32Array(16);var va=[],na=[];a.bJ=function(){return ua.trunc((ya.ms-50)/4)};a.sI=function(a){return a/S.qd()};a.update=function(a){for(var b=0;b<va.length;b++){for(var c=va[b],d=0;8>d;d++)A(c,a,d);c.k.Gi&&(I(c,a),H(c,a))}for(b=0;b<va.length;b++)for(c=va[b],d=0;8>d&&c.ia.length;d++)q(c,d)};a.jV=function(){return na};a.GI=function(a){var b=[];if(l(a))for(var c=0;c<a.Yc.length;c++)b.push(a.Yc[c].name);
for(var d=[],c=0;c<na.length;c++){var e=na[c],f=e.s;20==f.type?d.push(e):60==e.s.type&&"MESH"==a.type?d.push(e):10==f.type&&"ARMATURE"==a.type?d.push(e):40==f.type&&"SPEAKER"==a.type?d.push(e):80==f.type&&"WORLD"==a.type&&d.push(e)}for(c=0;c<d.length;c++)b.push(w(d[c].name));if(W.Fo(a)&&W.QK(a))for(a=a.I,c=0;c<a.length;c++)for(d=a[c].X,e=0;e<d.length;e++)(f=d[e].gb)&&b.push(f.name);return b};a.WM=w;a.HI=function(a,b){var c=a.ia[b];return c?c.type:0};a.qu=function(a){for(var d=0,e=a.I,h=0;h<e.length;h++)for(var k=
e[h].X,n=0;n<k.length;n++){var m=k[n].gb;m&&"EMITTER"==m.Nw&&!k[n].kg&&(ba(a,d),b(a.ia[d],m),K(a,d),a.ia[d].behavior=m.Ce?10:a.El,d++)}e=a.Vg.slice();for(h=0;h<e.length;h++)n=e[h],k=n.Eo,n=n.action,ba(a,d),f(a,k,n,d)?(K(a,d),a.ia[d].behavior=a.El,d++):a.ia[d]=null;l(a)&&(ba(a,d),c(a,a.Yc[0],d),K(a,d),a.ia[d].behavior=a.El)};a.Mz=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ua.q("Wrong animation behavior")}};a.mV=function(a){var b=
[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.node_tree;e&&D(e,b,[d.name])}return b};a.UJ=t;a.play=function(a,b,c){p(a.ia,c,function(a){a.play=!0;a.rB=b?b:null;a.wr=!1});a.k.Gi&&z(a)};a.stop=function(a,b){p(a.ia,b,function(a){a.play=!1;a.rB=null;a.wr=!1})};a.Pf=function(a,b){var c=a.ia;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.cn=r;a.DD=function(a,b){b=b||0;p(a.ia,b,function(c){r(a,c.start,b)})};a.RI=function(a,b){var c=a.ia[b];
return c&&c.Ef?c.Ef:0};a.tW=function(a,b){var c=a.ia[b];return c&&10==c.behavior};a.bn=function(a,b,c){p(a.ia,c,function(a){a.behavior=b})};a.KI=function(a,b){var c=a.ia[b];return c&&c.behavior};a.lG=function(a,b,c,d){p(a.ia,d,function(a){a.wE=b||0;a.gD=c||0})};a.wL=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.ia[c]=null;else a.ia[b]=null;a.k.Gi&&M(a,b)};a.U_=m;a.SK=function(a){if("ARMATURE"==a.type||a.su||"WORLD"==a.type)return!0;for(var b=0;b<a.Vg.length;b++){var c=a.Vg[b].action.s.type;if(20==
c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return W.Fo(a)&&W.QK(a)||"MESH"==a.type&&a.Yc.length?!0:!1};a.OG=function(a,b){if("ARMATURE"==b.type||X(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.Vg.length;c++){var d=b.Vg[c].action.s.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return W.GR(a)&&W.FR(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.yc=function(a){return Boolean(a.ia.length)};a.QR=C;a.zU=h;a.JQ=function(a){function b(a,
c){for(var d=0;d<c;d++){var e=a.subarray(8*d+4,8*d+8);Z.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function e(a,b,c,d,k){if(-1<c.search(f)){a=b;c=c.split('"')[1];var n=h}else 8==k?(c="tsr",n=h):n=1<k?new Float32Array(k):0;if(!a[c]){k=a;b=c;if("object"==typeof n&&n.length)for(var m=n.length,v=new Float32Array(d*m),g=0;g<d;g++)for(var l=0;l<m;l++)v[g*m+l]=n[l];
else if("number"==typeof n)for(v=new Float32Array(d),g=0;g<d;g++)v[g]=n;else ua.q("Wrong storage default value");k[b]=v}return a[c]}var f=new RegExp(/pose.bones\[\".+\"\]/g),h=za.create(),n=a.s={type:0,NC:0,aL:0,qb:null,Zz:null,EG:null,Li:new Int8Array(8)};n.aL=1/da.im;var m=a.fcurves,v={},g={},l=0,p;for(p in m){var u=m[p],L;for(L in u){var x=u[L],q=x.Cf;Y.cS(x,a);x=x.num_channels;l||(l=q.length);for(var x=e(v,g,p,l,x),r=x.length/l,B=c(p,L|0),Q=0;Q<l;Q++)x[Q*r+B]=q[Q]}}if(ua.Kr(v)){for(var z in v)"tsr"==
z&&b(v[z],l);n.qb=v}if(ua.Kr(g)){for(var t in g)b(g[t],l);n.Zz=g}n.NC=l;n.EG=a.zQ;"tsr"in v&&J(m,n.Li);("color"in v||"energy"in v)&&y(m,n.Li);("light_settings.environment_energy"in v||"horizon_color"in v||"zenith_color"in v||"mist_settings.intensity"in v||"mist_settings.depth"in v||"mist_settings.start"in v||"mist_settings.height"in v||"b4w_fog_color"in v)&&d(m,n.Li);k(a);na.push(a)};a.lV=function(a,b){return(b-a)*da.im+1};a.hR=function(a,b,c,d,e,f){var h=new Float32Array(2),k=new Float32Array(2),
n=new Float32Array(2),m=new Float32Array(2),v=b[1],g=b[2],l=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var p=0,L=0,x=null;e<=f;e++)if(e<v)for(var q=0;q<da.im;q++)c[p++]=g;else if(e>l)for(q=0;q<da.im;q++)c[p++]=a;else{var r=b[L],J=3;0===r&&(J+=2);0===x&&(J+=2);var Q=2===r?0:1;if(b[L+1]==b[L+J+1])x=r,L+=J;else{q=0;e==b[L+1]&&(Q&&(d[p]=1),c[p]=b[L+2],p++,q++);if(e==l)for(;q<da.im;q++)c[p++]=a;else for(h[0]=b[L+1],h[1]=b[L+2],0!==r?(k[0]=0,k[1]=0):0===x?(k[0]=b[L+5],k[1]=b[L+6]):(k[0]=b[L+
3],k[1]=b[L+4]),0!==r?(n[0]=0,n[1]=0):(n[0]=b[L+J+3],n[1]=b[L+J+4]),m[0]=b[L+J+1],m[1]=b[L+J+2];q<da.im;q++){var y=e+q/da.im;switch(r){case 0:var z=h,t=k,ca=n,C=m,Z=[],I=[],ga=void 0,G=void 0,V=void 0,ga=void 0;Z[0]=z[0]-t[0];Z[1]=z[1]-t[1];I[0]=C[0]-ca[0];I[1]=C[1]-ca[1];V=C[0]-z[0];ga=Math.abs(Z[0]);G=Math.abs(I[0]);0!=ga+G&&ga+G>V&&(ga=V/(ga+G),t[0]=z[0]-ga*Z[0],t[1]=z[1]-ga*Z[1],ca[0]=C[0]-ga*I[0],ca[1]=C[1]-ga*I[1]);Q&&(d[p]=1);c[p]=u(B(0,1,y,h[0],k[0],n[0],m[0]),h[1],k[1],n[1],m[1]);p++;break;
case 1:Q&&(d[p]=1);z=h[0];t=h[1];ca=(m[1]-t)/(m[0]-z);c[p]=ca*y+(t-ca*z);p++;break;case 2:Q&&(d[p]=1);c[p]=b[L+2];p++;break;default:ua.q("Unknown keyframe interpolation mode: "+r)}}e+1==b[L+J+1]&&(x=r,L+=J)}}};a.apply=G;a.dR=function(a,b,c,d){d=d||0;var e=ua.Ed("uuid",c,na);if(e){ba(a,d);if(f(a,b,e,d)){K(a,d);return}a.ia[d]=null}v.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.SN=function(a,b){var c=ua.Ed("name",b,na)||ua.Ed("name",b+"_B4W_BAKED",na);if(c){if(0==c.s.type)return!1}else if(!(P(a,
b)||Q.be(a)&&T(a,b)))return!1;return!0};a.Cv=function(a,b){for(var c=a.ia,d=0;d<c.length;d++){var e=c[d];if(e&&w(e.Hi)==w(b))return d}return-1};a.kV=function(a,b){var c=a.ia[b];return c&&c.Hi?w(c.Hi):null};a.remove=function(a){a.ia.length=0;a=va.indexOf(a);-1!=a&&va.splice(a,1)};a.kY=function(a){for(var b=na.length-1;0<=b;b--)na[b].AQ==a&&na.splice(b,1)};a.mG=function(a,b){if(!a.ia.length)return G(a,b,0)?0:-1;for(var c=0;c<a.ia.length;c++)if(!a.ia[c])return G(a,b,c)?c:-1};a.iM=function(a,b,c){a.k.nq=
(b-a.k.Mh)/c;a.k.mq=b};a.kM=function(a,b,c){p(a.ia,c,function(a){a.speed=b})};a.tJ=function(a,b){return a.ia[b].speed};a.xB=function(a,b){return a.ia[b].start};a.sv=function(a,b){return a.ia[b].length};a.ua=function(){va.length=0;na.length=0};a.FU=function(a){var b=(a[0]||a[1]||a[2]).Cf.length,c=L,d=N,e=Boolean(a[0]);e||(a[0]={Cf:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={Cf:new Float32Array(b),num_channels:8});var h=Boolean(a[2]);h||(a[2]={Cf:new Float32Array(b),num_channels:8});
a[3]={Cf:new Float32Array(b),num_channels:8};for(var k=0;k<b;k++)d[0]=e?a[0].Cf[k]:0,d[1]=f?a[1].Cf[k]:0,d[2]=h?a[2].Cf[k]:0,ua.fk(d,c),a[0].Cf[k]=c[3],a[1].Cf[k]=c[0],a[2].Cf[k]=c[1],a[3].Cf[k]=c[2]};a.MI=X;a.EZ=function(a,b){for(var c=7,d=0,e=0;e<na.length;e++){var f=na[e];if(f.name==b){d=f.s.type;break}}0==d&&(T(a,b)?d=30:(e=P(a,b))&&"EMITTER"==e.Nw&&(d=50));for(e=0;8>e;e++)if(f=a.ia[e]){if(f.type==d)return e}else e<c&&(c=e);return c}};b4w.module.__lights=function(a,g){function q(a){w.scale(a.color,a.Gf,a.Xq)}g("__print");var c=g("__tsr"),b=g("__util"),w=g("__vec3"),t=new Float32Array(3);new Float32Array(3);a.IW=function(a,g){var r=a.data,p=g.tb={name:"",type:r.type,gL:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Xq:new Float32Array(3),YH:0,EE:!1,jn:0,bt:0,Pq:.1,Oq:30,BI:!1,KK:!1,fI:!1,on:!0,qn:!0,Gf:1,distance:25,Q4:"INVERSE_SQUARE"};p.name=g.name;p.on=r.use_diffuse;p.qn=r.use_specular;var m=b.ec(c.R(g.k.n),
b.nc,t);w.normalize(m,m);p.direction.set(m);p.color[0]=r.color[0];p.color[1]=r.color[1];p.color[2]=r.color[2];p.Gf=p.YH=r.energy;q(p);p.distance=r.distance;p.EE=r.use_sphere;p.Pq=r.clip_start;p.Oq=r.clip_end;if("POINT"===p.type||"SPOT"===p.type)p.distance=r.distance;"SPOT"===p.type?(p.bt=r.spot_blend,p.jn=r.spot_size):"POINT"===p.type&&(p.jn=Math.PI/2);p.BI=r.b4w_generate_shadows;p.fI=r.b4w_dynamic_intensity};a.qx=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];q(a)};a.bZ=function(a,
b){a.bt=b};a.aZ=function(a,b){a.distance=b};a.cZ=function(a,b){a.jn=b};a.Ss=function(a,b){a.Gf=b;q(a)};a.S_=function(a){var g=a.tb;if(g){b.ec(c.R(a.k.n),b.nc,g.direction);w.normalize(g.direction,g.direction);if("SUN"==g.type){a=Math.acos(w.dot(g.gL,b.Dz));var q=Math.acos(w.dot(g.direction,b.Dz));g.KK=Math.floor(a/.025)!=Math.floor(q/.025)?!0:!1}w.copy(g.direction,g.gL)}}};b4w.module.__obj_util=function(a,g){function q(a){a={type:a,Ye:0,n:l.Vl(),oy:l.Vl(),pivot:new Float32Array(3),Vb:new Float32Array(3),pk:0,qk:0,cw:!1,dw:!1,Xj:null,qh:0,el:!1,tf:p.create(),use_panning:!1,ub:0,ol:1,nl:1,pl:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Dd:!1,dof_object:null,lb:null,ka:null,sb:null,Dc:null,Cc:null,fe:null,Uh:!0,gi:{Fk:1,Gk:1,Hk:0},Td:-1,Fd:-1,rc:new Float32Array(4),km:0,em:0,uo:!1,ks:new Float32Array(3),
ls:0,jf:-1,kh:0,lh:0,Zn:!1,Ke:!1,ie:!1,te:!1,ge:!1,Id:!1,Hd:!1,th:"",vf:!1,gg:!1,gd:!1,$h:!1,Rk:!1,Lw:!1,Uc:!1,Kw:!1,Mw:!1,Dm:!1,Hm:!1,Cr:!1,xn:0,Bh:0,Ch:0,Xg:0,Wg:0,Rg:0,dj:"",De:{jC:"",iC:"",TC:""},Jl:!1,Kq:new Float32Array(3),Og:!1,Aq:!1,Cq:"",Bq:!1,cf:0,ay:0,by:0,mh:0,jm:!1,Yc:!1,Oe:!1,pi:[],uk:!1,Gi:!1,Mh:1,nq:0,mq:1,wp:new Int8Array([-1,-1]),cp:[],vw:[],Ax:[],qe:null,Je:null,ve:null,Me:null,Pg:null,Ji:null,Cs:null,sq:null,rq:null,Il:null,S:t.Sd(),Ta:t.Sd(),wa:t.Rh(),kb:t.Rh(),ba:t.Tg(),pb:t.Tg(),
Ad:t.Pu(),zG:t.Pu(),yq:null,wq:null,xq:null,zp:!0,Yf:!1,Sw:0};p.copy(r.nc,a.tf);return a}function c(a){if(!(a instanceof Object))return a;var b=null,f=null,m=null,g=null,p=null,l=null;a.ya&&(b=a.ya,a.ya=null);a.Md&&(f=a.Md,a.Md=null);a.Qg&&(m=a.Qg,a.Qg=null);a.ib&&(g=a.ib,a.ib=null);a.zb&&(p=a.zb,a.zb=null);a.Pe&&(l=a.Pe,a.Pe=null);var q;q=a.constructor;switch(q){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:q=
new q(a);break;case Array:q=new q(a.length);for(var t=0;t<a.length;t++)q[t]=c(a[t]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:q=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:q=null;break;case Function:q=a;break;default:for(t in q=new q,a)q[t]=c(a[t])}b&&(q.ya=b,a.ya=b);f&&(q.Md=f,a.Md=f);m&&(q.Qg=m,a.Qg=m);g&&(q.ib=g,a.ib=g);p&&(q.zb=p,a.zb=p);l&&(q.Pe=r.ak(),a.Pe=l);return q}function b(a,b){for(var c=a.I,f=0;f<c.length;f++){var m=c[f];if(m.yb==b)return m}return null}
function w(a){return a.Kk?a.parent:a.parent?w(a.parent):null}var t=g("__boundings"),D=g("__config"),l=g("__tsr"),r=g("__util"),p=g("__vec3"),m=g("__vec4"),f=D.B;new Float32Array(4);new Float32Array(4);new Float32Array(4);l.create();l.create();a.$p=-1;a.er=q;a.rA=function(a){var b=q(a.type);b.Ye=a.Ye;l.copy(a.n,b.n);l.copy(a.oy,b.oy);p.copy(a.pivot,b.pivot);p.copy(a.Vb,b.Vb);b.pk=a.pk;b.qk=a.qk;b.cw=a.cw;b.dw=a.dw;a.Xj&&(b.Xj=p.clone(a.Xj));b.qh=a.qh;b.el=a.el;p.copy(a.tf,b.tf);b.use_panning=a.use_panning;
b.ub=a.ub;b.ol=a.ol;b.nl=a.nl;b.pl=a.pl;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Dd=a.Dd;b.dof_object=a.dof_object;b.lb=r.T(a.lb);b.ka=r.T(a.ka);b.sb=r.T(a.sb);b.Dc=r.T(a.Dc);b.Cc=r.T(a.Cc);b.fe=a.fe;b.Uh=a.Uh;b.gi.Fk=a.gi.Fk;b.gi.Gk=a.gi.Gk;b.gi.Hk=a.gi.Hk;b.Td=a.Td;b.Fd=a.Fd;b.rc=a.rc;
b.km=a.km;b.em=a.em;b.uo=a.uo;p.copy(a.ks,b.ks);b.ls=a.ls;b.jf=a.jf;b.kh=a.kh;b.lh=a.lh;b.Zn=a.Zn;b.Ke=a.Ke;b.ie=a.ie;b.te=a.te;b.ge=a.ge;b.Id=a.Id;b.Hd=a.Hd;b.th=a.th;b.vf=a.vf;b.gg=a.gg;b.gd=a.gd;b.$h=a.$h;b.Rk=a.Rk;b.Lw=a.Lw;b.Uc=a.Uc;b.Kw=a.Kw;b.Mw=a.Mw;b.Dm=a.Dm;b.Hm=a.Hm;b.Cr=a.Cr;b.xn=a.xn;b.Bh=a.Bh;b.Ch=a.Ch;b.Xg=a.Xg;b.Wg=a.Wg;b.Rg=a.Rg;b.dj=a.dj;b.De=a.De;b.Jl=a.Jl;p.copy(a.Kq,b.Kq);b.Og=a.Og;b.Aq=a.Aq;b.Cq=a.Cq;b.Bq=a.Bq;b.cf=a.cf;b.ay=a.ay;b.by=a.by;b.mh=a.mh;b.jm=a.jm;b.Yc=a.Yc;b.Oe=
a.Oe;b.pi=r.T(a.pi);b.uk=a.uk;b.Gi=a.Gi;b.Mh=a.Mh;b.nq=a.nq;b.mq=a.mq;b.wp.set(a.wp);b.cp=r.T(a.cp);b.vw=r.T(a.vw);b.Ax=r.T(a.Ax);b.qe=r.T(a.qe);b.Je=r.T(a.Je);b.ve=r.T(a.ve);b.Me=r.T(a.Me);b.Pg=r.T(a.Pg);b.Ji=r.T(a.Ji);b.Cs=r.T(a.Cs);b.sq=r.T(a.sq);b.rq=r.T(a.rq);b.Il=r.T(a.Il);t.Rn(a.S,b.S);t.Rn(a.Ta,b.Ta);t.zA(a.wa,b.wa);t.zA(a.kb,b.kb);t.xA(a.ba,b.ba);t.xA(a.pb,b.pb);b.yq=r.T(a.yq);b.wq=r.T(a.wq);b.xq=r.T(a.xq);b.zp=a.zp;b.Yf=a.Yf;b.Sw=a.Sw;return b};a.dr=function(a,b,c){c||(c=a);return{name:a,
Ej:r.uB(),Qm:c,type:b,Uj:!1,Ra:!1,Yr:!1,mt:!1,k:null,pc:null,Y:null,tb:null,su:null,anchor:null,eo:null,xw:null,I:[],Yc:[],Xe:r.ak(),wA:r.ak(),ia:[],Js:[],tg:[],lu:[],wh:null,an:[],parent:null,Kk:!1,vs:"",hy:null,Tw:null,pn:!1,cc:"",Mu:"AUTO",ef:!1,og:!1,Cm:!1,MG:!1,C:null,v:null,ig:null,sf:null,fo:null,bH:null,ZC:[],rh:{ys:"NO_COLLISION",ot:!1,QN:!1,ei:0,WN:0,VN:0,UH:0,DL:0,aX:!1,bX:!1,cX:!1,dX:!1,eX:!1,fX:!1,Vq:0,Tq:0,Wq:0,DE:!1,Iu:"BOX",kt:!1},UK:{Px:0,RC:0,Rf:0,lD:0},El:0,Vg:[],KC:!1,JK:!1,ww:[]}};
a.yA=function(a){return a instanceof Array?a.slice():a};a.U3=function(a){for(var b=[],f=0;f<a.length;f++){var m=a[f],g={},p;for(p in m)m[p]==m.Ta?g.Ta=c(m.Ta):m[p]==m.pb?g.pb=c(m.pb):g[p]=m[p];b.push(g)}return b};a.Lu=c;a.Ra=function(a){return a.Ra};a.uW=function(a){return"MESH"==a.type&&a.Ra};a.qq=function(a,b){a.I.push({yb:b,bw:!1,X:[],hi:[],Pi:null,QD:[],Jm:0,RK:!1,da:[],yM:[]})};a.ou=function(a,c,f){b(a,c).X.push(f)};a.C8=function(a,b){for(var c=a.I,f=0;f<c.length;f++)if(c[f].yb==b){c.splice(f,
1);break}};a.ja=b;a.EN=function(a,b){for(var c=0;c<a.length;c++)m.copy(b,a[c].k.rc)};a.yD=function(a,b,c){for(var f=0;f<a.I.length;f++){var m=a.I[f];c&&m.yb!=c||(m.bw=b)}};a.Bv=function(a,b){for(var c=[],m=b?f.BK-1:f.BK,g=0;g<a.length;g++){var p=a[g];p.tb.BI&&c.length<m&&c.push(p)}return c.length?c:a[0]?[a[0]]:[]};a.wX=function(a,b){l.identity(b.n);b.Xj=null;a.k=b};a.gH=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,f=a.data.materials;if(0<=c&&c<f.length&&
("ADD"==f[c].game_settings.alpha_blend||"ALPHA"==f[c].game_settings.alpha_blend||"ALPHA_SORT"==f[c].game_settings.alpha_blend))return!0}return!1};a.oS=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].X,f=0;f<c.length;f++)for(var m=c[f].hb.Si,g=0;g<m.length;g++){var p=m[g];if("USE_MODEL_TSR_INVERSE"==p[0]&&"1"==p[1])return!0}return!1};a.yI=function(a,b){return a+"*"+b};a.hJ=function(a){return a.Kk?null:a.parent};a.Xi=w;a.AB=function(a,b){for(var c=[],f=0;f<b.length;f++){var m=b[f];w(m)==
a&&c.push(m)}return c};a.FB=function(a){return a.k.Ye};a.be=function(a){return"MESH"===a.type};a.Am=function(a){return"ARMATURE"===a.type};a.as=function(a){return"SPEAKER"===a.type};a.xa=function(a){return"CAMERA"===a.type};a.hh=function(a){return"LAMP"===a.type};a.so=function(a){return"EMPTY"===a.type};a.B7=function(a){return"LINE"===a.type};a.fC=function(a){return"WORLD"===a.type}};b4w.module.__physics=function(a,g){function q(a,b){for(var c=a.Xe,d=0;d<c.length;d++)c[d].rh.kt&&b.push(c[d]),q(c[d],b)}function c(a,b,c){for(var d=a.Ac.sa,e=0;e<d.length;e++)for(var f=d[e].C,h=0;h<f.We.length;h++){var k=f.We[h];"ANY"!=k.cc&&c!=k.cc||O(k,a,b)}}function b(a,b,c){if(G.bw(a))switch(b){case G.JO:var d=w(a);d.Ac.gO=!0;G.ga(a,G.UP,Date.now()-performance.now(),Y.max_fps,Y.eA?V.qI:0);break;case G.KO:P.ce("URANIUM:",c.slice(1));break;case G.FO:P.error(c);break;case G.GO:K.jv.apply(this,c.slice(1));
break;case G.PO:var e=t(c.ea);if(e){a=c.trans;d=c.quat;b=c.ci;var f=c.Lh,e=e.C;e.Vu=c.time;Q.oi(a,1,d,e.UA);ha.copy(b,e.ci);ha.copy(f,e.Lh)}break;case G.MO:(a=t(c.lA))&&Q.oi(c.trans,1,c.quat,a.v.Ds[c.eD]);break;case G.HO:if(d=t(c[1]))a=c[4],d=d.ig.Au[c[2]],ca.Vc(d,c[3]),ca.ni(d,a),ca.D(d);break;case G.QO:if(e=t(c[1]))e.v.speed=c[2];break;case G.BO:d=w(a);D(d,c.Kl,c.Ll,c.result,null,null,0);break;case G.DO:d=w(a);D(d,c.Kl,c.Ll,c.result,c.Tl,c.coll_norm,c.coll_dist);break;case G.CO:if(e=t(c[1]))a=e.C,
a.Sl&&a.Sl(c[2]);break;case G.$E:case G.NO:d=w(a);if(a=d.Ac.Lk[c.id])if(d=t(c.Nn),b==G.$E)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var f=c.hit_time,e=c.hit_pos,h=a.callback;e?h(a.id,b,d,f,e,c.hit_norm):h(a.id,b,d,f)}break;case G.OO:C(id);break;case G.LO:a=S.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case G.IO:oa=c[1];break;case G.EO:a=S.indexOf(a);
console.log("Worker: #"+String(a));console.log(c[1]);break;default:P.error("Wrong message: "+b)}}function w(a){for(var b=0;b<S.length;b++)if(S[b]==a)return ga[b]}function t(a){return za[a]||null}function D(a,b,c,d,e,f,h){a=a.Ac.sa;for(var k=0;k<a.length;k++)for(var m=a[k].C,n=0;n<m.We.length;n++){for(var g=m.We[n],v=g.Jk,p=!1,u=0;u<v.length;u++){var x=v[u];if(x[0]===b&&x[1]===c){g.us[u]=d;p=!0;break}}p&&(v=l(g),e&&g.Yz!=b&&(p=e,u=f,x=h,p[0]+=u[0]*x,p[1]+=u[1]*x,p[2]+=u[2]*x,u[0]*=-1,u[1]*=-1,u[2]*=
-1),g.callback(v,v?g.Yz==b?t(c):t(b):null,e,f,h))}}function l(a){a=a.us;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function r(){da.body++;return da.body}function p(a){var b=la.indexOf(a);return-1==b?(la.push(a),la.length-1):b}function m(a,b){return{ea:a,type:b,ei:0,ew:!1,Zk:!0,ef:!1,og:!1,vW:!1,Ku:null,cc:"",Uq:0,Q3:{},We:[],Sl:null,Vu:0,UA:new Float32Array([0,0,0,1,0,0,0,1]),ci:new Float32Array(3),Lh:new Float32Array(3),Cu:new Float32Array(3),Hq:new Float32Array(4),os:null}}function f(a,
b){switch(a){case "BOX":var c=b.S;break;case "CYLINDER":c=b.yq;break;case "CONE":c=b.xq;break;case "SPHERE":c=b.wa;break;case "CAPSULE":c=b.wq}return c}function n(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.F&&(b.center=a.F);
"number"===typeof a.Xa&&(b.radius=a.Xa);"number"===typeof a.height&&(b.height=a.height);return b}function e(a,b,c,d,e){var f=Q.G(a.k.n),h=Q.invert(b.k.n,N),k=new Float32Array(3);Q.Wc(f,h,k);switch(b.v.type){case 10:b=b.sf;a=a.k.S;G.ga(e,G.xP,c,k,b.e_,b.uD,(a.max_z-a.min_z)/2,d);break;case 20:G.ga(e,G.wP,c,k,a.d$)}}function z(a){return a.C&&a.C.Ku}function M(a,b,c,d,e,f,h,k,m,n){var g;da.pc++;g=da.pc.toString(16);var v=b.C.ea;G.ga(E(v),G.EP,g,a,k,v,c,d,e.C.ea,f,h,m,n);b.C.Ku=g}function E(a){for(var b=
0;b<ga.length;b++)for(var c=ga[b].Ac.sa,d=0;d<c.length;d++)if(c[d].C.ea==a)return S[b];return null}function F(a){var b=a.C;if(b=b?0===b.ei?!0:!0===b.ew?!0:!1===b.Zk?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=Q.jc(a.k.n,ya),c=Q.Zd(a.k.n,pa),b=b[0]!=a.C.Cu[0]||b[1]!=a.C.Cu[1]||b[2]!=a.C.Cu[2]||c[0]!=a.C.Hq[0]||c[1]!=a.C.Hq[1]||c[2]!=a.C.Hq[2]||c[3]!=a.C.Hq[3];if(b){var b=a.C,d=a.k,c=G.dJ(G.Yt);c.ea=b.ea;var e=Q.jc(d.n,c.trans),d=Q.Zd(d.n,c.quat);ha.copy(e,b.Cu);X.copy(d,b.Hq);"DYNAMIC"==
b.type&&X.identity(c.quat);G.ga(E(b.ea),G.Yt)}a=a.Xe;for(b=0;b<a.length;b++)F(a[b])}function A(a,b,c,d,e){e=e||new Float32Array(3);a=Q.R(a.k.n);e[0]=b;e[1]=c;e[2]=d;ha.transformQuat(e,a,e)}function O(a,b,c){var d=a.Jk,e=a.us,f=a.Yz,h=[],k=a.cc;h||W.q("At least one destination required");for(var m=0;m<b.Ac.sa.length;m++){var n=b.Ac.sa[m];if("ANY"==k||n.C.cc==k&&"NAVMESH"!=n.C.type)n=n.C.ea,h&&-1==h.indexOf(n)&&h.push(n)}for(b=0;b<h.length;b++)k=h[b],f<k&&!H(d,f,k)?(d.push([f,k]),e.push(!1)):f>k&&!H(d,
k,f)&&(d.push([k,f]),e.push(!1));G.ga(c,G.vP,f);G.ga(c,G.DP,d,a.Oh)}function H(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function I(a){a.C&&a.C.Sl&&(a=a.C,G.ga(E(a.ea),G.QP,a.ea),a.Sl=null)}function C(a){var b=k(a),c=h(a).Ac;c.Lk[a]&&(delete c.Lk[a],c.iD.splice(c.iD.indexOf,1),G.ga(b,G.ZP,a))}function h(a){for(var b=0;b<ga.length;b++){var c=ga[b];if(c.Ac.Lk[a])return c}return null}function k(a){for(var b=0;b<ga.length;b++)if(ga[b].Ac.Lk[a])return S[b];return null}
function J(a,b,c){if(b.lp){a=a.C.ea;var d=b.bo*b.Br,e=b.Fq*b.Gq,f=-b.jp*b.kp*2*Math.PI/b.dt;b.Wr&&(f*=-1);switch(b.type){case 10:G.ga(c,G.lQ,a,d,e,f);break;case 20:G.ga(c,G.kQ,a,d,e,f)}}}function y(a){return a.ef&&"CHASSIS"==a.sf.lf}function d(a){return a.ef&&"HULL"==a.sf.lf}function B(a){return"NAVMESH"==a.rh.ys}function u(a){return a.Cm&&"MAIN_BODY"==a.fo.lf}var ba=g("__config"),K=g("__debug"),G=g("__ipc"),T=g("__obj_util"),P=g("__print"),X=g("__quat"),x=g("__scenes"),ka=g("__subscene"),ca=g("__transform"),
Q=g("__tsr"),W=g("__util"),ha=g("__vec3"),v=g("__version"),Z=g("__navmesh"),Y=ba.C,V=ba.B,ta=ba.Rd,oa=0,S=[],ga=[],za={},ua=[],la=["ANY"],da={body:0,pc:0,sL:0},ya=new Float32Array(3);new Float32Array(4);var pa=new Float32Array(4);new Float32Array(16);var N=Q.create(),ea=Q.create();a.mW=function(a){a.Ac={gO:!1,sa:[],Lk:{},iD:[]};var c=Y.jt;ta.prevent_caching&&(c+=v.timestamp());P.log("%cLOAD PHYSICS","color: #0a0",Y.st?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+Y.max_fps);P.log("%cPHYSICS PATH",
"color: #0a0",c);var d=G.MT(c,!Y.st);G.qR(d,b);S.push(d);ga.push(a);Y.ping&&setInterval(function(){G.ga(d,G.WP,performance.now())},1E3)};a.tS=function(a){return a.Ac?a.Ac.gO:!0};a.ua=function(){for(var a=0;a<S.length;a++)G.terminate(S[a]);S.length=0;ga.length=0;za={};ua.length=0;la.length=0;for(var b in da)da[b]=0};a.Jn=function(a,b){a.k||W.q("No object render: "+a.name);var h;a:{for(var k=0;k<ga.length;k++)if(ga[k]==b){h=S[k];break a}h=void 0}var g=[];a.rh.kt&&q(a,g);var v=b.Ac.sa;if(y(a)||d(a)||
a.og||u(a)||a.pn){var l=B(a),x;if(l){var da=a,t=r(),ca=m(t,"NAVMESH"),C=T.ja(da,b).X;ca.os=null;for(var I=0;I<C.length;I++){var V=C[I];if("PHYSICS"==V.type){ca.os=Z.CX(V.Ca);break}}x=ca}else{var ya=a,ka=h,E=ya.k,A=ya.rh,K=A.ys,ha=r();if("CAMERA"==ya.type)var Y=A.DE?A.Iu:"BOX",F=f(Y,E),w=E.km,H=E.em,w=.5,H=0;else if("EMPTY"==ya.type)Y="EMPTY",F=null,H=w=0;else{var Y=A.DE?A.Iu:"BOX",F=f(Y,E),O=Q.$d(E.n);if(1!=O){var D=F;switch(Y){case "BOX":D.min_x*=O;D.max_x*=O;D.min_y*=O;D.max_y*=O;D.min_z*=O;D.max_z*=
O;break;case "CYLINDER":case "CONE":case "CAPSULE":D.height*=O;D.Xa*=O;break;case "SPHERE":D.Xa*=O}}w=E.km;H=E.em}var la=Q.G(E.n),ba=Q.R(E.n),ta=A.ot,oa=A.QN,pb=A.ei,Ta=A.WN,Ba=A.VN,$a=A.UH,Xa=A.DL,Ia=ya.cc,kb=p(Ia),eb=A.Vq,ab=A.Tq,qb=A.Wq,lb=E.wa.Xa,nb=n(F),wb=ya.Mu,Ua;var Nb=Y;if(g.length){var kc=[],Wb={};Wb.quat=new Float32Array([0,0,0,1]);Wb.trans=new Float32Array(3);Wb.worker_bounding=nb;Wb.bounding_type=Nb;kc.push(Wb);var rb=Q.invert(E.n,N),od=pa;X.invert(Q.R(E.n),od);for(var Ab=0;Ab<g.length;Ab++){var fb=
{},lc=g[Ab],Oc=lc.rh.Iu,Wc=new Float32Array(4),vc=new Float32Array(3),Rc=Q.R(lc.k.n);Q.Wc(Q.G(lc.k.n),rb,vc);X.multiply(od,Rc,Wc);fb.trans=vc;fb.quat=Wc;fb.bounding_type=Oc;fb.worker_bounding=n(f(Oc,lc.k));kc.push(fb)}Ua=kc}else Ua=[];G.ga(ka,G.AP,ha,la,ba,K,ta,oa,pb,Ta,Ba,$a,Xa,kb,eb,ab,qb,Y,nb,lb,w,H,Ua,wb);za[ha]=ya;ua.push(ya);var Hb=m(ha,"BOUNDING");Hb.type=K;Hb.ei=pb;Hb.ew=ta;Hb.cc=Ia;Hb.Uq=kb;x=Hb}var gc=x;a.C=gc;var xb={za:null,C:gc};l||(v.push(xb),c(b,h,gc.cc))}else for(var Va=T.ja(a,b).X,
bb=0;bb<Va.length;bb++){var Xb=Va[bb],pd;if(pd="PHYSICS"==Xb.type){var wc;a:{for(var Ec=b.Ac.sa,ed=0;ed<Ec.length;ed++){var xc=Ec[ed].za;if(xc&&xc.id==Xb.id){wc=!0;break a}}wc=!1}pd=!wc}if(pd)if(Xb.Uf.Ja)if(Xb.Hj&&b.s.Lc){var ac=Xb,Xc=b,fd=h,bc=Xc.s.Lc;G.ga(fd,G.JP,bc.sl);if(ac.D0){var cb={};cb.dst_noise_scale0=ac.dst_noise_scale0;cb.dst_noise_scale1=ac.dst_noise_scale1;cb.dst_noise_freq0=ac.dst_noise_freq0;cb.dst_noise_freq1=ac.dst_noise_freq1;cb.dir_min_shore_fac=ac.dir_min_shore_fac;cb.dir_freq=
ac.dir_freq;cb.dir_noise_scale=ac.dir_noise_scale;cb.dir_noise_freq=ac.dir_noise_freq;cb.dir_min_noise_fac=ac.dir_min_noise_fac;cb.dst_min_fac=ac.dst_min_fac;cb.waves_hor_fac=ac.waves_hor_fac;var Ob=bc.waves_height,Yb=bc.waves_length;bc.Yk?G.ga(fd,G.wF,cb,bc.bp[0],bc.bp[1],bc.ap[0],bc.ap[1],bc.vC,Ob,Yb,bc.SD,Xc.s.RD):G.ga(fd,G.wF,cb,0,0,0,0,0,Ob,Yb,0,null)}}else{var ib;if(Xb.ot){var Yc=a,Zb=Xb,mc=h,Qb=r(),Pb=Zb.Uf,nc=Pb.aa[0].a_position,Hc=Pb.ma||null,Ib=Zb.cc,oc=p(Ib);G.ga(mc,G.GP,Qb,nc,Hc,Q.G(Yc.k.n),
oc,Zb.Vq,Zb.Tq,Zb.Wq);var sb=m(Qb,"STATIC_MESH");sb.ew=!0;sb.cc=Ib;sb.Uq=oc;ib=sb}else{var db=a,cc=Xb,Zc=h,Cb=r(),Rb=cc.Uf,gb=Rb.aa[0].a_position,ob=Rb.ma||null,Ic=Q.G(db.k.n),pc=cc.km,Jc=cc.em,Jb=cc.cc,qc=p(Jb);G.ga(Zc,G.IP,Cb,gb,ob,Ic,pc,Jc,qc,cc.Vq,cc.Tq,cc.Wq);var dc=m(Cb,"STATIC_MESH");dc.cc=Jb;dc.Uq=qc;ib=dc}gc=ib;a.C=gc;xb={za:Xb,C:gc};v.push(xb);c(b,h,gc.cc)}else P.error("Object "+a.name+" has collision material with no assigned vertices")}if(y(a)||d(a)){var Ya=a,ec=h,Kb=Ya.C.ea;y(Ya)?(Ya.v.type=
10,G.ga(ec,G.BP,Kb,Ya.v.cE,Ya.v.eE,Ya.v.dE,Ya.v.OE,Ya.v.wC)):d(Ya)&&(Ya.v.type=20,G.ga(ec,G.zP,Kb,Ya.v.hm,Ya.v.un,Ya.v.vn));if(Ya.v.Xm){var tb=Ya.v.Xm;switch(Ya.v.type){case 10:e(tb[0],Ya,Kb,!0,ec);e(tb[1],Ya,Kb,!0,ec);e(tb[2],Ya,Kb,!1,ec);e(tb[3],Ya,Kb,!1,ec);break;case 20:for(var rc=0;rc<tb.length;rc++)e(tb[rc],Ya,Kb,!1,ec)}}J(a,a.v,h)}else if(a.og){var ub=h,Lb=a.k,Sb=a.C,yc=Lb.S.max_z-Lb.S.min_z,Kc=Sb.ea,Ga=a.bH,hc=Ga.C0,Db=Ga.FY,Eb=Ga.YZ,Fc=Ga.HW,Tb=Ga.E0,jb=W.bU(a);G.ga(ub,G.CP,Kc,jb,yc,hc,Db,
Eb,Fc,Tb);Sb.og=!0}else if(u(a)){var hb=a,Ha=h,$b=hb.C.ea;G.ga(Ha,G.FP,$b,hb.ig.hm,hb.ig.un,hb.ig.vn);if(hb.ig.Au)for(var Fb=hb.ig.Au,La=0;La<Fb.length;La++){var Na=Fb[La],mb=Q.G(Na.k.n),Pc=Q.invert(hb.k.n,N),Lc=new Float32Array(3);Q.Wc(mb,Pc,Lc);G.ga(Ha,G.yP,$b,Lc,Na.MG)}hb.C.vW=!0}for(bb=0;bb<ua.length;bb++)if(a=ua[bb],a.C){var vb=a;if(!z(vb))for(var Gc=0;Gc<vb.ZC.length;Gc++){var Ub=vb.ZC[Gc],fc=Ub.target,gd=Ub.RX;if(fc.C){var $c=new Float32Array([Ub.SX,Ub.TX,Ub.UX]),Sc,ad=new Float32Array([Ub.Ga,
Ub.Ha,Ub.Ia]);Sc=W.fk(ad,new Float32Array(4));var yb=Q.identity(N),yb=Q.of($c,yb),yb=Q.Wk(Sc,yb),zb=Q.multiply(vb.k.n,yb,N),zc=Q.invert(fc.k.n,ea),hd=Q.multiply(zc,zb,zc),Wa=Ub,Za={};Za.use_limit_x=Wa.o0;Za.use_limit_y=Wa.p0;Za.use_limit_z=Wa.q0;Za.use_angular_limit_x=Wa.k0;Za.use_angular_limit_y=Wa.l0;Za.use_angular_limit_z=Wa.m0;Za.limit_max_x=Wa.RW;Za.limit_min_x=Wa.UW;Za.limit_max_y=Wa.SW;Za.limit_min_y=Wa.VW;Za.limit_max_z=Wa.TW;Za.limit_min_z=Wa.WW;Za.limit_angle_max_x=Wa.LW;Za.limit_angle_min_x=
Wa.OW;Za.limit_angle_max_y=Wa.MW;Za.limit_angle_min_y=Wa.PW;Za.limit_angle_max_z=Wa.NW;Za.limit_angle_min_z=Wa.QW;M(gd,vb,$c,Sc,fc,Q.G(hd),Q.R(hd),Za,null,null)}}}};a.JU=t;a.update=function(a,b){for(var c=0;c<S.length;c++){var d=S[c],e=a;d&&G.cK(d)&&G.ga(d,G.mQ,e,b);for(var f=0;f<ua.length;f++){var h=ua[f],k=h.C;if(k.Zk&&k.Vu){var m=G.cK(d)?e-k.Vu:performance.now()/1E3-k.Vu,m=Math.min(m,10/Y.max_fps),m=m-1/Y.max_fps;V.EX&&(m=0);var n=N;Q.oW(k.UA,m,k.ci,k.Lh,N);ca.uj(h,n);ca.D(h);F(h);if(h.v)for(var k=
h,m=k.v.Xm,n=k.k.n,g=N,v=0;v<m.length;v++){var p=m[v];Q.multiply(n,k.v.Ds[v],g);ca.uj(p,g);ca.D(p)}h.v&&h.v.lp&&(g=h,m=g.v,k=m.lp)&&(v=g.v.RM,Q.multiply(g.k.n,g.v.SM,k.k.n),n=ya,Q.xd(v,g.k.n,n),g=pa,X.setAxisAngle(n,-m.jp*m.kp*2*Math.PI,g),m=Q.R(k.k.n),X.multiply(g,m,m),ca.D(k));h.v&&h.v.WD&&(g=h,m=g.v,k=m.WD)&&(v=g.v.MM,Q.multiply(g.k.n,g.v.NM,k.k.n),n=ya,Q.xd(v,g.k.n,n),g=pa,v=Math.abs(m.speed)*m.at,v>m.Ao&&(v=m.Ao),X.setAxisAngle(n,-v,g),m=Q.R(k.k.n),X.multiply(g,m,m),X.normalize(m,m),ca.D(k));
h.v&&h.v.gE&&(n=h,k=n.v,h=k.gE)&&(g=n.v.cN,Q.multiply(n.k.n,n.v.dN,h.k.n),m=ya,Q.xd(g,n.k.n,m),n=pa,X.setAxisAngle(m,-Math.abs(k.bo)*k.lr,n),k=Q.R(h.k.n),X.multiply(n,k,k),X.normalize(k,k),ca.D(h))}}G.aY(d);d=ga[c];(e=d.s.Lc)&&0<e.waves_height&&(d=x.La(d,ka.Pb),e=ha.length(d.Ij)||1,G.ga(S[c],G.jQ,d.time*e))}};a.iV=function(){return ga[0]};a.pause=function(){for(var a=0;a<S.length;a++)G.ga(S[a],G.VP)};a.qj=function(){for(var a=0;a<S.length;a++)G.ga(S[a],G.$P)};a.gI=function(a){(a=a.C)||W.q("No object physics");
if(!a.Zk){var b=a.ea,c=E(b);a.Zk=!0;G.ga(c,G.TP,b)}};a.eB=function(a){(a=a.C)||W.q("No object physics");if(a.Zk){var b=a.ea,c=E(b);a.Zk=!1;G.ga(c,G.SP,b)}};a.gx=function(a){return Boolean(a.Ac)};a.oa=function(a){return Boolean(a.C)};a.KJ=function(a){return(a=a.C)&&a.Zk&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.ei&&0==a.ew?!0:!1};a.QB=function(a){return(a=a.C)&&a.Zk?!0:!1};a.aM=function(a,b){var c=a.C.ea;G.ga(E(c),G.iQ,c,b)};a.XV=z;a.kG=M;a.oH=function(a){a=a.C;G.ga(E(body_a),G.YP,a.Ku);a.Ku=
null};a.mL=function(b,c,d,e,f,h){c=Q.oi(c,1,d,N);f=Q.oi(f,1,h,ea);Q.invert(c,c);Q.multiply(f,c,c);ca.Mr(e,f);Q.multiply(f,c,c);ca.uj(b,c);ca.D(b);a.Us(b,Q.G(b.k.n),Q.R(b.k.n))};a.Us=function(a,b,c){var d=a.C,e=G.dJ(G.Yt),f=Q.jc(a.k.n,e.trans);a=Q.Zd(a.k.n,e.quat);Q.oi(f,1,a,d.UA);e.ea=d.ea;ha.copy(b,e.trans);X.copy(c,e.quat);G.ga(E(d.ea),G.Yt)};a.H=F;a.oG=function(a,b,c,d){var e=ya;A(a,b,c,d,e);a=a.C.ea;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),h=Math.abs(e[1]),k=Math.abs(e[2]);
e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=h?e[1]/h*Math.max(h,c):0;e[2]=k?e[2]/k*Math.max(k,d):0;G.ga(E(a),G.yF,a,e[0],e[1],e[2])};a.pG=function(a,b,c,d){a=a.C.ea;G.ga(E(a),G.yF,a,b,c,d)};a.Qz=function(a,b,c,d,e){var f=ya;e?(f[0]=b,f[1]=c,f[2]=d):A(a,b,c,d,f);a=a.C.ea;G.ga(E(a),G.KP,a,f[0],f[1],f[2])};a.nG=function(a,b,c,d){var e=ya;A(a,b,c,d,e);a=a.C.ea;G.ga(E(a),G.MP,a,e[0],e[1],e[2])};a.Uk=function(a,b,c){a=a.C.ea;G.ga(E(a),G.cQ,a,b,c)};a.mi=function(a,b){var c=a.C.ea;G.ga(E(c),G.dQ,c,b)};a.RL=function(a,
b){var c=a.C.ea;G.ga(E(c),G.hQ,c,b)};a.QL=function(a,b){var c=a.C.ea;G.ga(E(c),G.fQ,c,b)};a.NL=function(a,b){var c=a.C.ea;G.ga(E(c),G.aQ,c,b)};a.Gu=function(a){a=a.C.ea;G.ga(E(a),G.OP,a)};a.aH=function(a,b,c){a=a.C.ea;G.ga(E(a),G.PP,a,b,c)};a.tj=function(a,b,c){a=a.C.ea;G.ga(E(a),G.eQ,a,b,c)};a.OL=function(a,b){var c=a.C.ea;G.ga(E(c),G.bQ,c,b)};a.PL=function(a,b){var c=a.C.ea;G.ga(E(c),G.gQ,c,b)};a.Nz=function(a,b,c,d){var e=a.C;if(!e.os){for(var f=e.ea,h=0;h<e.We.length;h++)if(a=e.We[h],a.cc==b&&
a.callback==c)return;a={Yz:f,Oh:d||!1,cc:b,callback:c,Jk:[],us:[]};e.We.push(a);b=E(f);O(a,w(b),b)}};a.mD=function(a,b,c){a=a.C;for(var d=E(a.ea),e=w(d),f=0;f<a.We.length;f++){var h=a.We[f];if(h.cc==b&&h.callback==c){if(l(h)){var k=ha.set(0,0,0,ya);h.callback(!1,null,k,k,0)}a.We.splice(f,1);f--;for(var k=d,h=h.Jk,m=e.Ac.sa,n=0;n<m.length;n++)for(var g=m[n].C,v=0;v<g.We.length;v++)for(var p=g.We[v],u=0;u<p.Jk.length;u++)for(var x=p.Jk[u],q=0;q<h.length;q++){var r=h[q];x[0]==r[0]&&x[1]==r[1]&&(h.splice(q,
1),q--)}h.length&&G.ga(k,G.xF,h)}}};a.Pz=function(a,b){a.C&&a.C.Sl&&I(a);var c=a.C;G.ga(E(c.ea),G.LP,c.ea);c.Sl=b};a.pA=I;a.pu=function(a,b,c,d,e,f,h,k,m){var n;da.sL++;n=da.sL;a={id:n,ea:a?a.C.ea:0,from:new Float32Array(b),to:new Float32Array(c),cc:d,Uq:p(d),vG:f,KR:h,Oh:k,Wv:m,callback:e};b=E(a.ea)||S[0];c=w(b).Ac;n=a.id;c.Lk[n]=a;c.iD.push(a);G.ga(b,G.HP,a.id,a.ea,a.from,a.to,a.Uq,a.vG,a.KR,a.Oh,a.Wv);return n};a.nD=C;a.YG=function(a,b,c){var d=k(a),e=h(a).Ac.Lk[a];e&&!e.vG&&(e.from.set(b),e.to.set(c),
G.ga(d,G.NP,a,b,c))};a.dK=function(a){return h(a).Ac.Lk[a]?!0:!1};a.Cp=function(a,b){var c=a.v;c.bo=b;J(a,c,E(a.C.ea))};a.Bp=function(a,b){var c=a.v;c.jp=b;J(a,c,E(a.C.ea))};a.GE=function(a,b){var c=a.v;c.Fq=b;J(a,c,E(a.C.ea))};a.ff=y;a.gf=d;a.F7=B;a.sW=function(a){if(!a.ef)return!1;a=a.sf.lf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.rW=function(a){return a.ef?"BOB"==a.sf.lf?!0:!1:!1};a.wW=function(a){return a.Cm?"BOB"==a.fo.lf?!0:!1:
!1};a.fK=function(a){return a.ef&&"STEERING_WHEEL"==a.sf.lf?!0:!1};a.eK=function(a){return a.ef&&"SPEEDOMETER"==a.sf.lf?!0:!1};a.gK=function(a){return a.ef&&"TACHOMETER"==a.sf.lf?!0:!1};a.zJ=function(a){return a.v.speed};a.G0=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.og=function(a){return a.og};a.z7=u;a.AV=function(){return oa};a.WT=function(){for(var a=0;a<S.length;a++)G.ga(S[a],G.RP)};
a.Ks=function(a){if("BOUNDING"==a.C.type){var b=ua.indexOf(a);-1==b&&P.error("Object "+a.name+" doesn't have bounding physics");delete za[c];ua.splice(b,1)}for(var c=a.C.ea,b=E(c),d=w(b),e=c,f=d.Ac.sa,h=[],k=0;k<f.length;k++)for(var m=f[k].C,n=0;n<m.We.length;n++)for(var g=m.We[n],v=0;v<g.Jk.length;v++){var p=g.Jk[v],u=g.us[v];if(p[0]==e||p[1]==e)g.Jk.splice(v,1),g.us.splice(v,1),v--,u&&!l(g)&&(u=ha.set(0,0,0,ya),g.callback(!1,null,u,u,0)),h.push(p)}h.length&&G.ga(b,G.xF,h);a.C&&a.C.Sl&&I(a);a=d.Ac.sa;
for(d=0;d<a.length;d++)a[d].C.ea==c&&(a.splice(d,1),d--);G.ga(b,G.XP,c)}};b4w.module.__ipc=function(a,g){function q(a,b,c){for(var e=0;e<n.length;e+=2)n[e+1]==a&&(f[e+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],e=0,f;for(f in c){var m=c[f];switch(m.constructor){case Float32Array:e+=m.length;break;case Number:e+=1}}--e;c.len=e}}var b=!0;a.JO=0;var w=a.BO=1,t=a.DO=2;a.CO=3;a.FO=4;a.GO=5;a.HO=6;a.KO=7;var D=a.MO=8,l=a.$E=9,r=a.NO=10;a.OO=11;var p=a.PO=12;a.QO=13;a.LO=14;a.IO=15;a.EO=16;a.UP=100;a.vP=101;a.wP=102;a.xP=103;a.yP=104;a.AP=105;a.zP=106;
a.BP=107;a.CP=108;a.DP=109;a.EP=110;a.FP=111;a.GP=112;a.IP=113;a.JP=114;a.XP=115;a.KP=116;a.LP=117;a.MP=118;a.OP=119;a.PP=120;a.QP=121;a.SP=122;a.TP=123;a.VP=124;a.HP=125;a.ZP=126;a.NP=127;a.xF=128;a.YP=129;a.$P=130;a.aQ=131;a.bQ=132;a.cQ=133;a.dQ=134;a.eQ=135;a.fQ=136;a.gQ=137;a.hQ=138;a.iQ=139;a.yF=140;var m=a.Yt=141;a.jQ=142;a.wF=143;a.kQ=144;a.lQ=145;a.WP=146;a.RP=147;a.mQ=148;var f=b4w.worker_listeners,n=b4w.worker_namespaces,e={Qf:p,ea:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
ci:new Float32Array(3),Lh:new Float32Array(3),len:0},z={Qf:D,lA:0,eD:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},M={Qf:l,id:0,Nn:0,hit_fract:0,hit_time:0,len:0},E={Qf:r,id:0,Nn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},F={Qf:w,Kl:0,Ll:0,result:0,len:0},A={Qf:t,Kl:0,Ll:0,result:0,Tl:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},O={Qf:m,ea:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},H=[e,z,M,E,F,A,
O];a.MT=function(a,c){var e={fw:a?!0:!1,tl:null,Nh:[],hg:""};if(c)if(e.tl={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");q(e.hg,e.fw,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");q(e.hg,e.fw,null)},postMessage:function(a){var b;a:{for(b=0;b<n.length;b+=2)if(n[b+1]==e.hg){b=f[b+Number(!!e.fw)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<n.length;a+=2)if(n[a+1]==e.hg){f.splice(a,2);n.splice(a,2);break}}},e.fw){var k=
g("__util"),m=g("__container"),p=b4w.get_namespace(g),k=k.gt(p+"_worker");n.push(p);n.push(k);f.push(null);f.push(null);e.hg=k;(m=m.LU(a))?b?m.addEventListener("load",function(){b4w.require("__bindings",e.hg)},!1):(b4w.ua("__bindings",e.hg),b4w.ua("__ipc",e.hg),b4w.require("__bindings",e.hg)):(m=document.createElement("script"),m.src=a,m.defer="defer",m.async="async",m.addEventListener("load",function(){b=!1;b4w.require("__bindings",e.hg)},!1),document.head.appendChild(m))}else e.hg=b4w.get_namespace(g);
else e.tl=a?new Worker(a):self;return e};a.qR=function(a,b){function f(c){if(c.constructor==ArrayBuffer)c=new Float32Array(c);else if(c[0].constructor==ArrayBuffer){for(var n=0;n<c.length;n++)f(c[n]);return}n=c[0]|0;switch(n){case p:var g=e;g.ea=c[1]|0;g.time=c[2];g.trans[0]=c[3];g.trans[1]=c[4];g.trans[2]=c[5];g.quat[0]=c[6];g.quat[1]=c[7];g.quat[2]=c[8];g.quat[3]=c[9];g.ci[0]=c[10];g.ci[1]=c[11];g.ci[2]=c[12];g.Lh[0]=c[13];g.Lh[1]=c[14];g.Lh[2]=c[15];break;case D:g=z;g.lA=c[1]|0;g.eD=c[2]|0;g.trans[0]=
c[3];g.trans[1]=c[4];g.trans[2]=c[5];g.quat[0]=c[6];g.quat[1]=c[7];g.quat[2]=c[8];g.quat[3]=c[9];break;case l:g=M;g.id=c[1]|0;g.Nn=c[2]|0;g.hit_fract=c[3];g.hit_time=c[4];break;case r:g=E;g.id=c[1]|0;g.Nn=c[2]|0;g.hit_fract=c[3];g.hit_time=c[4];g.hit_pos[0]=c[5];g.hit_pos[1]=c[6];g.hit_pos[2]=c[7];g.hit_norm[0]=c[8];g.hit_norm[1]=c[9];g.hit_norm[2]=c[10];break;case w:g=F;g.Kl=c[1]|0;g.Ll=c[2]|0;g.result=!!c[3];break;case t:g=A;g.Kl=c[1]|0;g.Ll=c[2]|0;g.result=!!c[3];g.Tl[0]=c[4];g.Tl[1]=c[5];g.Tl[2]=
c[6];g.coll_norm[0]=c[7];g.coll_norm[1]=c[8];g.coll_norm[2]=c[9];g.coll_dist=c[10];break;case m:g=O;g.ea=c[1]|0;g.trans[0]=c[2];g.trans[1]=c[3];g.trans[2]=c[4];g.quat[0]=c[5];g.quat[1]=c[6];g.quat[2]=c[7];g.quat[3]=c[8];break;default:g=c}b(a,n,g)}c(H);a.tl.addEventListener("message",function(a){f(a.data)},!1)};a.ua=function(){};a.ga=function(a,b){if(a)switch(b){case p:var c=e,f=new Float32Array(c.len);f[0]=c.Qf;f[1]=c.ea;f[2]=c.time;f[3]=c.trans[0];f[4]=c.trans[1];f[5]=c.trans[2];f[6]=c.quat[0];f[7]=
c.quat[1];f[8]=c.quat[2];f[9]=c.quat[3];f[10]=c.ci[0];f[11]=c.ci[1];f[12]=c.ci[2];f[13]=c.Lh[0];f[14]=c.Lh[1];f[15]=c.Lh[2];a.Nh.push(f.buffer);break;case D:c=z;f=new Float32Array(c.len);f[0]=c.Qf;f[1]=c.lA;f[2]=c.eD;f[3]=c.trans[0];f[4]=c.trans[1];f[5]=c.trans[2];f[6]=c.quat[0];f[7]=c.quat[1];f[8]=c.quat[2];f[9]=c.quat[3];a.Nh.push(f.buffer);break;case l:c=M;f=new Float32Array(c.len);f[0]=c.Qf;f[1]=c.id;f[2]=c.Nn;f[3]=c.hit_fract;f[4]=c.hit_time;a.Nh.push(f.buffer);break;case r:c=E;f=new Float32Array(c.len);
f[0]=c.Qf;f[1]=c.id;f[2]=c.Nn;f[3]=c.hit_fract;f[4]=c.hit_time;f[5]=c.hit_pos[0];f[6]=c.hit_pos[1];f[7]=c.hit_pos[2];f[8]=c.hit_norm[0];f[9]=c.hit_norm[1];f[10]=c.hit_norm[2];a.Nh.push(f.buffer);break;case w:c=F;f=new Float32Array(c.len);f[0]=c.Qf;f[1]=c.Kl;f[2]=c.Ll;f[3]=c.result;a.Nh.push(f.buffer);break;case t:c=A;f=new Float32Array(c.len);f[0]=c.Qf;f[1]=c.Kl;f[2]=c.Ll;f[3]=c.result;f[4]=c.Tl[0];f[5]=c.Tl[1];f[6]=c.Tl[2];f[7]=c.coll_norm[0];f[8]=c.coll_norm[1];f[9]=c.coll_norm[2];f[10]=c.coll_dist;
a.Nh.push(f.buffer);break;case m:c=O;f=new Float32Array(c.len);f[0]=c.Qf;f[1]=c.ea;f[2]=c.trans[0];f[3]=c.trans[1];f[4]=c.trans[2];f[5]=c.quat[0];f[6]=c.quat[1];f[7]=c.quat[2];f[8]=c.quat[3];a.Nh.push(f.buffer);break;default:f=[];for(c=1;c<arguments.length;c++)f.push(arguments[c]);a.tl.postMessage(f)}};a.aY=function(a){a&&a.Nh.length&&(a.tl.postMessage(a.Nh),a.Nh.length=0)};a.dJ=function(a){switch(a){case p:return e;case D:return z;case l:return M;case r:return E;case w:return F;case t:return A;case m:return O;
default:return null}};a.terminate=function(a){a.tl.terminate();a.tl=null};a.bw=function(a){return!!a.tl};a.cK=function(a){return!!a.hg}};b4w.module.__scenes=function(a,g){function q(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.ag||!c.ag.length)return c}return null}function c(){wb||Ka.q("No active scene available");return wb}function b(a,b,c){if(!Ba.av||!w(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>$a.Ec?(d.csm_resolution=$a.Ec,Fa.error("Shadow map texture has unsupported size. Changed to "+$a.Ec+".")):d.csm_resolution=c.csm_resolution;Ba.DR=c.blur_samples;d.GZ=c.soft_shadows;a=R.Bv(b,Ba.ssao&&a.b4w_enable_ssao);
d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.jh=[];d.OM=[];d.Pq=[];d.Oq=[];for(b=0;b<a.length;b++)d.jh.push(a[b].tb.type),d.OM.push(a[b].tb.jn),d.Pq.push(a[b].tb.Pq),d.Oq.push(a[b].tb.Oq),"SPOT"!=d.jh[b]&&"POINT"!=d.jh[b]||!d.enable_csm||(Fa.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=
c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,
d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function w(a,b,c){if(0!=b.length&&Ba.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=Ba.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function t(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].tb.type)return!0;return!1}function D(a){if(!Ba.Xk)return!1;a=ta(a);
for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function l(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(R.gH(a[b],c[d].settings))return!0;return!1}function r(a){for(var b=ta(a),c=[],d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},h=0;h<a.length;h++)for(var k=a[h],m=k.data.materials,n=0;n<m.length;n++)m[n]==e&&(f.sl=k.location[2]);f.Ee=e.b4w_water_fog_color.slice(0);f.Ee.push(e.b4w_water_fog_density);
e.b4w_water_dynamic?(f.sr=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,
f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.sr=!1,f.waves_height=0,f.waves_length=0);f.Sg=e.b4w_water_enable_caust;f.$R=e.b4w_water_caust_scale;f.ZR=e.b4w_water_caust_brightness;f.aS=new Float32Array([.3,.7]);f.Yk=null;e=e.texture_slots;for(h=0;h<e.length;h++)k=e[h].texture,!0===k.b4w_shore_dist_map&&"FILE"==k.image.source&&(f.Yk=k.image,f.SD=k.image.size[0],f.vC=k.b4w_max_shore_dist,k=k.b4w_shore_boundings,f.ap=[(k[0]+k[1])/2,(k[2]+k[3])/2],f.bp=[k[0]-k[1],
k[2]-k[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.sr)for(d=0;d<c.length;d++)c[d].sr&&(f=c[d]);return f}return null}function p(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=ta(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.refractions=!0);e.node_tree&&b(e.node_tree)}return c}function m(a,b,c){if(Ba.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var d=0,e=!1,f=0;f<b.length;f++){var h=b[f];h.k.Hd&&"CUBE"==h.k.th&&d++;if(h.Js.length){for(var k=null,m=0;m<a.length;m++)if(a[m]==h){k=m;break}null==k&&a.push(h)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(h=0;h<b.length;h++)if(k=b[h].game_settings.alpha_blend,"OPAQUE"!=k&&"CLIP"!=k){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{uL:a,OK:d,Pi:[],SA:[],hi:[],Uw:[],JJ:e}}function f(a,b){var c=a.b4w_sky_settings,d={};d.xL=c.render_sky||c.procedural_skydome;
d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.dp=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.ge=c.reflexible;d.Id=c.reflexible_only;
!b&&c.procedural_skydome&&Fa.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function n(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.aW=a.hemisphere;b.CR=a.blur_depth;b.LG=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.GY=a.samples;return b}function e(a){if(!(Ba.bloom&&a.b4w_enable_bloom&&a.s.zj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function z(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function M(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function E(a){var b={};a=a.b4w_god_rays_settings;b.YB=a.intensity;b.zo=a.max_ray_length;b.mp=a.steps_per_pass;return b}function F(a){var b={};b.oj=a.b4w_outline_color;b.ts=a.b4w_outline_factor;return b}
function A(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function O(a,b){var c=a.light_settings,d={};d.$g=c.environment_energy;d.nt=c.use_environment_light;d.jB=c.environment_color;d.ne=a.horizon_color.slice(0);d.we=a.zenith_color.slice(0);d.qt=a.use_sky_paper;d.pt=a.use_sky_blend;d.rt=a.use_sky_real;d.Hx=null;
d.ep=null;d.hv=null;c=!0;if(d.nt&&"SKY_TEXTURE"==d.jB&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&!a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];break}e?d.hv=e:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;e=a.texture_slots[f];d.Hx=e;f=Math.min($a.ej,Pa.RR(e.texture.image.size[0]/3));d.ep={l_:f,IG:e.blend_factor,
OJ:e.horizon_factor,jO:e.zenith_up_factor,iO:e.zenith_down_factor,color:e.color,Ea:e.default_value,invert:e.invert,PN:e.use_rgb_to_intensity,JG:e.blend_type,KN:e.use_map_blend,LN:e.use_map_horizon,NN:e.use_map_zenith_up,MN:e.use_map_zenith_down};break}d.nt=d.nt?c:!1;return d}function H(a){var b=a.fog_settings,c={};c.n0=b.use_fog;c.YB=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.EU=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Ee=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.jg=new Float32Array([c.YB,c.depth,c.start,c.height]);return c}function I(a,b){if(!Ba.gd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],h=f.data.materials,k=0;k<h.length;k++)h[k].b4w_terrain&&(c=!0);f=f.particle_systems;for(k=0;k<f.length;k++)h=f[k].settings,"HAIR"==h.type&&h.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function C(a,b){if(Xa.outlining_overview_mode)return!0;if(Ba.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.Rk)return!0;return!1}else return!1}function h(a,b){if(Xa.outlining_overview_mode)return!0;if(Ba.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].nb.k.Uc)return!0;return!1}else return!1}function k(a,b){if(Ba.$i)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,
e=0;e<d.length;e++)if(Ja.fH(d[e]))return!0;return!1}else return!1}function J(a,b){if(Ba.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function y(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function d(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].nb;if(d.anchor&&d.anchor.Yn)return!0}return!1}}function B(a,b,c){var d=ma.oh(a,b);ma.ui(a,d,function(a,b,d){if(d.Gc){switch(d.from){case "COLOR":case "CUBEMAP":var e=b.p.wc;break;case "DEPTH":e=b.p.Ze;break;case "SCREEN":e=null;break;case U.ld:return;default:Ka.q("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Ka.q("Connection of SCREEN is forbidden"),e.Qe&&Ka.q("Batch texture can't use renderbuffer"),ra.jH(c.zb,d.to)&&ia.Qj(c,e,d.to)}}});for(a=0;a<b.Ya.length;a++){var d=b.Ya[a],e=b.ti[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.Qe&&Ka.q("Batch texture can't use renderbuffer"),ra.jH(c.zb,d.to)&&ia.Qj(c,e,d.to)}}}function u(a){if(a&&a.s&&a.s.Wa){var b=fa.ic(a.s.Wa,U.Lg);b&&V(a,b)}}function ba(a,
b,c,d,e,f){for(var h=b.k,k=R.ja(b,e).X,m=0;m<k.length;m++){var n=k[m];if(!(n.te||n.Id||"MAIN"!=n.type&&"NODES_GLOW"!=n.type&&"PARTICLES"!=n.type&&"LINE"!=n.type)&&("OPAQUE"==n.vb&&"OPAQUE"==d||"BLEND"==n.vb&&"BLEND"==d||"XRAY"==n.vb&&"XRAY"==d||"NODES_GLOW"==n.type&&"GLOW"==d)){if(!f&&(K(n,a,b,c,d,e),!ia.Xc(n)))if("DEBUG"===Ta.type())ia.ru(n,"error.glslv","error.glslf"),ia.Xc(n);else continue;var g=U.ai(n,h);U.Rc(a,g);B(c,a,n);G(n)}}}function K(a,b,c,d,e,f){var h=c.k,k=f.s,m=R.ja(c,f),n="NO_SHADOWS";
c=S(f,[U.bd]);if(c.length&&a.ie){switch(e){case "OPAQUE":n="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":n="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":n="NO_SHADOWS";break;case "SHADOW":n="SHADOW_MASK_GENERATION";break;default:Ka.q("Wrong subscene type")}for(var g=0;g<c.length;g++)ia.rG(a,f.s.wd)}g="NO_SOFT_SHADOWS";if(k.wd&&k.wd.GZ)switch(Ba.DR){case "16x":g="POISSON_X_16";break;case "8x":g="POISSON_X_8";break;case "4x":g="POISSON_X_4"}c=a.hb;ra.ha(c,"SHADOW_USAGE",
n);ra.ha(c,"POISSON_DISK_NUM",g);a.gd&&(g=fa.ic(d,U.Bi))&&T(a,g,h);g=b.p;g.type==na.ze||g.type==na.Ih||g.type==na.Ei?ra.ha(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ra.ha(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.nk){e=b.Hw;ra.ha(c,"NUM_LIGHTS",e);ra.ha(c,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);ra.ha(c,"REFLECTION_PASS","REFL_PASS_NONE");ra.ha(c,"SSAO_ONLY",0);if(e=k.Lc)ra.ha(c,"WATER_EFFECTS",1),ra.ha(c,"WAVES_HEIGHT",ra.O(e.waves_height)),ra.ha(c,"WAVES_LENGTH",ra.O(e.waves_length)),
ra.ha(c,"WATER_LEVEL",ra.O(e.sl));if(b.Sg&&a.Sg){ra.ha(c,"CAUSTICS",1);if(g=k.wd){h=g.jh;for(g=n=0;g<h.length;g++)"SUN"==h[g]&&(n=g);ra.ha(c,"SUN_NUM",n)}ra.ha(c,"CAUST_SCALE",ra.O(b.VG));ra.ha(c,"CAUST_SPEED",ra.O(b.WG,2));ra.ha(c,"CAUST_BRIGHT",ra.O(b.UG))}b=m.Pi;m=m.hi;if(-1!==a.Md.indexOf("u_mirrormap"))ra.ha(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Hd&&b)b=b.p.wc,ia.Qj(a,b,"u_cube_reflection"),ra.ha(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Hd&&m)for(g=0;g<m.length;g++)b=m[g].p.wc,ia.Qj(a,
b,"u_plane_reflection"),ra.ha(c,"REFLECTION_TYPE","REFL_PLANE");else ra.ha(c,"REFLECTION_TYPE","REFL_NONE");(m=fa.ic(d,U.Lg))?a.bv?(b=m.p.wc,ia.Qj(a,b,"u_sky")):m.procedural_skydome&&(a.Be=m.Be,ra.ha(c,"PROCEDURAL_FOG",1)):ra.ha(c,"PROCEDURAL_FOG",0);b=k.Ip;b.nt&&(ra.ha(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.jB?(b.hv?(m=b.hv.texture,b=Pa.le(b.hv),ia.Qj(a,b,"u_sky_texture",m.name)):m&&(b=m.p.wc,ia.Qj(a,b,"u_sky_texture")),ra.ha(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.jB&&ra.ha(c,"SKY_COLOR",1));
b=k.hO;b.n0&&(ra.ha(c,"USE_FOG",1),ra.ha(c,"FOG_TYPE",b.EU));a.Nk&&a.Lb?(Ba.av&&ra.ha(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.nk||"NODES_GLOW"==a.type?(ra.ha(c,"REFRACTIVE",1),k.refractions?ra.ha(c,"USE_REFRACTION",1):ra.ha(c,"USE_REFRACTION",0)):k.refractions?ra.ha(c,"REFRACTIVE",1):ra.ha(c,"REFRACTIVE",0),(k.yK.refractions||k.refractions)&&ra.ha(c,"HAS_REFRACT_TEXTURE",1)):(ra.ha(c,"REFRACTIVE",0),ra.ha(c,"USE_REFRACTION",0),ra.ha(c,"USE_REFRACTION_CORRECTION",0));a.Hj&&(Ba.Xk&&a.wt&&
fa.ic(d,U.WE)?ra.ha(c,"SHORE_SMOOTHING",1):ra.ha(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ra.ha(c,"DYNAMIC",1):ra.ha(c,"DYNAMIC",0));"PARTICLES"==a.type&&(ra.ha(c,"SIZE_RAMP_LENGTH",a.gb.P9),ra.ha(c,"COLOR_RAMP_LENGTH",a.gb.tH));if(!a.kg)for(a=a.ya,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(k=0;k<Ua.length;k++)for(c=Ua[k],m=Ua[k].ag,e=0;e<m.length;e++)m[e]==b&&ma.r(Nb,c,f,null)}}function G(a){8<a.ya.length&&Fa.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.td.join(", ")+'"')}function T(a,b,c){a.me=b.me;var d=b.me[0],e=b.me[1],f=b.me[2];c=c.S;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.me[2]=f;b=b.p;na.nx(b,f/2,-e,-d,f/2);na.Vk(b);d=a.Pr||0;d=0==d?c:Math.max(d,c);a.Pr=d}function P(a,b,c,d,e,f){for(var h=b.k,k=R.ja(b,e).X,m=0;m<k.length;m++){var n=k[m];if(("MAIN"==n.type||"PARTICLES"==n.type||"LINE"==n.type)&&"REFLECT"==n.vb&&n.Lb==d){if(a.type==U.Pd||a.type==U.Af){var g;a:{var v=e.s.ki.hi;for(g=0;g<v.length;g++)for(var p=0;p<
v[g].length;p++)if(v[g][p]==a)break a;v=e.s.ki.Uw;for(g=0;g<v.length;g++)for(p=0;p<v[g].length;p++)if(v[g][p]==a)break a;g=null}if(g==h.Fd)continue}else if(g=xa(e,a),g==h.Td)continue;if(!f&&(K(n,a,b,c,"REFLECT",e),g=n.hb,ra.ha(g,"WATER_EFFECTS",0),a.type==U.Pd||a.type==U.Af?ra.ha(g,"REFLECTION_PASS","REFL_PASS_PLANE"):ra.ha(g,"REFLECTION_PASS","REFL_PASS_CUBE"),ra.ha(g,"TEXTURE_NORM",0),!ia.Xc(n)))if("DEBUG"===Ta.type())ia.ru(n,"error.glslv","error.glslf"),ia.Xc(n);else continue;n=U.ai(n,h);U.Rc(a,
n)}}}function X(a){Y(a);var b=ga(a,U.Pb),c=!0,d=a.s.wd;ma.pa(a.s.Wa,function(e,f){f.type===U.bd&&(ka(f,a,b.p,d,c),c=!1)})}function x(a){ma.pa(a.s.Wa,function(a,b){b.type===U.Cn&&(b.hB=1)})}function ka(a,b,c,d,e){if(0!=a.Qa.length){var f=a.p,h=sa.jc(c.n,rb);sa.of(h,f.n);sa.copy(c.uf,f.Vs);if("SUN"===d.jh[a.xh]||"HEMI"===d.jh[a.xh]){h=vc;va.H0(h);for(var k=0;k<a.Qa.length;k++)for(var m=a.Qa[k].sa,n=0;n<m.length;n++){var g=m[n].kf;0==k&&0==n?va.Rn(g.Ta,h):va.kB(h,g.Ta)}h=va.kI(h,Oc);Ka.No(h,f.Ob,h);
if(d.enable_csm){b=Sa.copy(c.Sh[a.RA],rb);d=Qa.invert(c.Ob,lc);Ka.No(b,d,b);Ka.No(b,f.Ob,b);a=c.gr[a.RA];if(e)for(Hb=0,gc=-Infinity,e=2;e<h.length;e+=3)Hb=Math.min(Hb,h[e]),gc=Math.max(gc,h[e]);e=vc;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=gc;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=Hb}else{c=e=vc;d=Wc;d.set(h);h=kc/9;k=Qa.identity(lc);Qa.rotate(k,h,Ka.Mc,k);n=m=-1;for(g=0;10>g;g++){var v=va.yG(d,Rc),p=(v.max_x-v.min_x)*(v.max_y-v.min_y);if(-1==m||p<m)m=p,n=g,va.Rn(v,c);Ka.No(d,k,d)}c=n*h;0<c&&(h=Qa.identity(lc),
Qa.rotate(h,c,Ka.Mc,h),Qa.multiply(h,f.Ob,f.Ob),sa.Wi(f.Ob,f.uf));c=e.max_x-e.min_x;h=e.max_y-e.min_y;c&&h&&(d=Math.abs(c-h)/2,2<c/h?(e.max_y+=d,e.min_y-=d):2<h/c&&(e.max_x+=d,e.min_x-=d));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;ca(a,b.s.Wa)}na.YY(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);na.Vk(f);Ka.co(f.kd,f.Wh)}else"SPOT"!==d.jh[a.xh]&&"POINT"!==d.jh[a.xh]||na.Vk(f,f.Ab)}}function ca(a,b){for(var c=a.p,d=fa.KV(b,a),e=0;e<d.length;e++){var f=
d[e];if(f.type==U.Pb||f.type==U.Bf||f.type==U.Oc||f.type==U.$f)if(Ba.rw)f.FE.set(c.uf,9*a.xh);else{var h=sa.G(c.uf),k=sa.R(c.uf);pb.set(h[0],h[1],h[2],sa.$d(c.uf),fb);f.$x.set(fb,4*a.xh);f.Zx.set(k,4*a.xh)}}}function Q(a,b,c,d,e){for(var f=b.k,h=R.ja(b,d).X,k=0;k<h.length;k++){var m=h[k];if("COLOR_ID"==m.type&&(a.type==U.xf&&"COLOR_ID"==m.vb||a.type==U.Ai&&"COLOR_ID_XRAY"==m.vb)){if(!e&&(K(m,a,b,c,"COLOR_ID",d),ia.nf(m,"USE_OUTLINE",0),!ia.Xc(m)))continue;m=U.ai(m,f);U.Rc(a,m)}}}function W(a,b,c,
d,e){if(!d&&(e.gd&&(d=fa.ic(c,U.Bi))&&T(e,d,b),!ia.Xc(e)))if("DEBUG"===Ta.type())ia.ru(e,"error.glslv","error.glslf"),ia.Xc(e);else return;b=U.ai(e,b);U.Rc(a,b);B(c,a,e);G(e)}function ha(a,b){v(a,b);for(var c=0;c<a.Xe.length;c++)a.Xe[c].parent==a&&ha(a.Xe[c],b)}function v(a,b){a.k.$h=b;if(R.hh(a))for(var c=0;c<a.I.length;c++)for(var d=a.I[c],e=S(d.yb,eb),f=0;f<e.length;f++){var h=e[f],k=a.k,m=a.tb,n=d.Jm,g=m.on&&!k.$h?1:0;h.hs[4*n+3]=g;g=m.qn&&!k.$h?1:0;h.gs[4*n+3]=g;h.Ba=!0}}function Z(a,b){for(var c=
S(b,eb),d=a.tb,e=a.k,f=R.ja(a,b),h=sa.G(e.n),e=sa.R(e.n),k=0;k<c.length;k++){var m=c[k],n=m,g=a.k,v=a.tb,p=f.Jm,l=sa.G(a.k.n),u=v.Xq;n.mC.set(v.direction,3*p);fb[0]=l[0];fb[1]=l[1];fb[2]=l[2];fb[3]=v.on&&!g.$h?1:0;n.hs.set(fb,4*p);fb[0]=u[0];fb[1]=u[1];fb[2]=u[2];fb[3]=v.qn&&!g.$h?1:0;n.gs.set(fb,4*p);n.Ba=!0;switch(d.type){case "SUN":m.aN.set(e);m.$M=d.Xq;m.type===U.Lg?(m.Cw=d.KK,Sa.copy(d.direction,m.bE),V(b,m)):Sa.copy(d.direction,m.bE);break;case "HEMI":case "POINT":case "SPOT":break;default:Fa.error("Unknown light type: "+
d.type+'".')}m=m.Qa;for(n=0;n<m.length;n++)for(g=m[n].sa,v=0;v<g.length;v++)p=g[v].za,p.Im&&ia.$Y(p,a)}c=ga(b,U.Pb).p;f=f.QD;d=b.s.wd;for(k=0;k<f.length;k++)m=f[k],na.ND(m.p,h,e),ka(m,b,c,d,!0),ca(m,b.s.Wa)}function Y(a){var b=Ma.Ub(a,"LAMP",Ma.oc),b=R.Bv(b,Ba.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.k,f=sa.jc(e.n,rb),e=sa.Zd(e.n,Ab),h=0;h<d.I.length;h++){var k=d.I[h],m=k.QD;if(k.yb==a)for(k=0;k<m.length;k++)na.ND(m[k].p,f,e)}}function V(a,b){ja.Ww(b);Ra.ao(b);
if(b.Cw)for(var c=S(a,ab),d=0;d<c.length;d++)for(var e=c[d].Qa,f=0;f<e.length;f++)for(var h=e[f].sa,k=0;k<h.length;k++){var m=h[k];m.dc&&(m=m.za,ia.dS(m)&&Ra.G_(m))}}function ta(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function oa(a,b,c){for(var d=a.s,e=R.ja(a.Lj,a).da,f=0;f<e.length;f++){var h=e[f];na.Vk(h,b/c);d.wd&&na.zE(h,d.wd)}d.wd&&(d.Dw=!0,ga(a,U.Bf).Ba=!0,ga(a,U.Oc).Ba=!0);var k=d.Wa;fa.w_(k,
function(d,e,f){if(d.ht){var h=d.dn*b,m=d.en*c;if(e)for(e=0;e<f.Ya.length;e++)f.Ya[e]==d&&Pa.resize(d.jb,h,m);else switch(Pa.wo(d.jb)&&Pa.resize(d.jb,h,m),d=f.p,d.width=h,d.height=m,f.type){case U.Op:za(a,{dof_power:f.p.dof_power});break;case U.Qp:la(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case U.Jp:ua(a,{bloom_blur:f.Mn});break;case U.Cn:f=fa.Db(k,f,U.hc);h=fa.Db(k,f,U.hc);m=fa.Db(k,h,U.hc);d=fa.Db(k,m,U.hc);fa.Kd(f,1/b,1/c);fa.Kd(h,
1/b,1/c);fa.Kd(m,1/b,1/c);fa.Kd(d,1/b,1/c);break;default:fa.Kd(f,1/b,1/c)}}})}function S(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];ma.pa(a.s.Wa,function(a,b){b.type==e&&c.push(b)})}return c}function ga(a,b){return fa.ic(a.s.Wa,b)}function za(a,b){var c=ga(a,U.Op);if(!c)return Fa.error("DOF is not enabled on the scene. Check camera settings"),0;var d=c.p.dof_bokeh,e=d?S(a,[U.Ay]):[],f=a.s.Wa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,d))for(var h=0;h<e.length;h++)e[h].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,d))for(h=0;h<e.length;h++)e[h].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,d))for(h=0;h<e.length;h++)e[h].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,d))for(h=0;h<e.length;h++)e[h].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,d))for(h=0;h<e.length;h++)e[h].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,d))for(h=0;h<e.length;h++)e[h].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(c.p.dof_bokeh_intensity=b.dof_bokeh_intensity,d&&(e=fa.EB(f,c,U.hc),e[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,e[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,e[0]=fa.Db(f,e[0],U.hc),e[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(d){d=b.dof_power;c.p.dof_power=d;var d=
d/2,h=c.p.width,k=c.p.height,m=[1/h,0],n=[1/h*.5,1/k*.866],g=[-1/h*.5,1/k*.866],e=fa.EB(f,c,U.hc);fa.Kc(e[0],d);fa.Kd(e[0],g[0],g[1]);fa.Kc(e[1],d);fa.Kd(e[1],n[0],n[1]);e[0]=fa.Db(f,e[0],U.hc);fa.Kc(e[0],d);fa.Kd(e[0],m[0],m[1]);c.p.Dd&&(e[0]=fa.Db(f,e[0],U.Ay),e[0]=fa.Db(f,e[0],U.hc),fa.Kd(e[0],1/h,1/k),e[0]=fa.Db(f,e[0],U.hc),fa.Kd(e[0],1/h,1/k))}else c.p.dof_power=b.dof_power,e=fa.Db(f,c,U.hc),f=fa.Db(f,e,U.hc),fa.Kc(e,c.p.dof_power),fa.Kd(e,1/c.p.width,1/c.p.height),fa.Kc(f,c.p.dof_power),fa.Kd(f,
1/c.p.width,1/c.p.height)}function ua(a,b){var c=ga(a,U.Xt),d=ga(a,U.Jp);if(!c||!d)return Fa.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.zu=b.key,c.Ba=!0);"number"==typeof b.edge_lum&&(c.yu=b.edge_lum,c.Ba=!0);if("number"==typeof b.blur){var e=a.s.Wa,c=fa.Db(e,d,U.Kp),e=fa.Db(e,c,U.Kp);d.Mn=b.blur;fa.Kc(c,b.blur);fa.Kd(c,1/d.p.width,1/d.p.height);fa.Kc(e,b.blur);fa.Kd(e,1/d.p.width,1/d.p.height)}}function la(a,b){var c=ga(a,U.Qp);if(!c)return Fa.error("Glow is not enabled on the scene"),
null;for(var d=a.s.Wa,e=fa.GV(d,c),f=0;f<e.length;++f){var h=e[f];if(h.type==U.hc&&"GLOW_MASK_LARGE"==h.vb)var k=h;if(h.type==U.hc&&"GLOW_MASK_SMALL"==h.vb)var m=h}e=fa.Db(d,k,U.hc);d=fa.Db(d,m,U.hc);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.Ba=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.Ba=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,fa.Kc(m,b.small_glow_mask_width),
fa.Kd(m,1/c.p.width,1/c.p.height),m.Ba=!0,fa.Kc(d,b.small_glow_mask_width),fa.Kd(d,1/c.p.width,1/c.p.height),d.Ba=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,fa.Kc(k,b.large_glow_mask_width),fa.Kd(k,1/c.p.width,1/c.p.height),k.Ba=!0,fa.Kc(e,b.large_glow_mask_width),fa.Kd(e,1/c.p.width,1/c.p.height),e.Ba=!0)}function da(a,b,c){var d=a.s,e=d.Lc;if(!e.sr)return e.sl;var f=e.waves_height,h=e.waves_length,k=e.sl,m=Sa.length(d.Ij)||1;a=ga(a,U.Pb).time;
a*=m;var n=Wb;n[0]=20/h*(b-.25*a);n[1]=20/h*(c-.25*a);m=Ka.XG(n);n[0]=17/h*(c+.1*a);n[1]=17/h*(b+.1*a);var n=Ka.XG(n),m=m+n-1,g=e.dst_noise_scale0,n=e.dst_noise_scale1,v=e.dst_noise_freq0,p=e.dst_noise_freq1,l=Wb;l[0]=g*(b+v*a);l[1]=g*(c+v*a);g=Ka.VD(l);l[0]=n*(c-p*a);l[1]=n*(b-p*a);n=Ka.VD(l);n*=f*g;if(e.Yk)if(p=(b-e.ap[0])/e.bp[0],l=(e.ap[1]+c)/e.bp[1],p+=.5,l+=.5,1<p||0>p||1<l||0>l)e=n;else{var d=Ka.JI(d.RD,e.SD,p,l),l=e.dir_freq,u=e.dir_noise_scale,x=e.dir_noise_freq,g=e.dir_min_noise_fac,p=e.dst_min_fac,
v=h/e.vC/Math.PI;c=[u/h*(b+x*a),u/h*(c+x*a)];b=Math.sqrt(d);e=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(b/v+l*a)*Math.max(Ka.VD(c),g);f=Math.max(b,p);e=e*(1-f)+n*f;m*=d}else e=n;return k+(e+.05*m)}function ya(a,b){a.Xr&&a.type==U.hc&&b.dc!=a.dc&&(a.dc=b.dc);b.dc||a.type!=U.Cn||(a.hB=0)}function pa(a,b,c,d){var e=ma.Va(a,b);na.lx(e.p,c,d);e.Rz=!0;ma.fl(a,b,function(b,e,f){f.Gc&&f.from==c&&fa.sS(f)&&N(a,b,f.to,d)});ma.ui(a,b,function(b,e,f){f.Gc&&f.from==c&&f.from==f.to&&pa(a,b,c,d)})}function N(a,
b,c,d){a=ma.Va(a,b).Qa;for(b=0;b<a.length;b++)for(var e=a[b].sa,f=0;f<e.length;f++)ia.uY(e[f].za,d,c)}function ea(a){var b=ga(a,U.Bi);if(b){var c=b.p,d=a.Lj.k;a=sa.jc(d.n,rb);var e=od;e[0]=0;e[1]=0;e[2]=-b.me[2]/2;b=sa.Zd(d.n,Ab);Sa.transformQuat(e,b,e);e[0]+=a[0];e[1]+=a[1];e[2]=0;Dc.identity(b);na.ND(c,e,b)}}function L(a,b){ma.pa(a,function(c,d){if(d.type==U.Gh){d.Ya[0]&&d.ti[0]||Ka.q("Wrong MOTION_BLUR subscene");var e=d.Ya[0],f=d.ti[0];d.ti[0]=d.p.wc;ma.fl(a,c,function(b,c,d){d.Gc&&N(a,b,d.to,
f)});pa(a,c,e.from,f);N(a,c,e.to,d.ti[0]);d.DK=Math.exp(-b/d.mb_factor)}})}function Aa(a){return a.s.Ij}function xa(a,b){if(!a.s.ki)return null;for(var c=a.s.ki.Pi,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.s.ki.SA;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var ia=g("__batch"),va=g("__boundings"),na=g("__camera"),Oa=g("__config"),Ca=g("__container"),qa=g("__debug"),ma=g("__graph"),Ea=g("__hud"),wa=g("__input"),Qa=g("__mat4"),Ja=g("__nodemat"),Ma=g("__objects"),R=g("__obj_util"),aa=g("__physics"),
ja=g("__prerender"),Bb=g("__primitives"),Fa=g("__print"),Dc=g("__quat"),Ra=g("__renderer"),fa=g("__scenegraph"),Da=g("__sfx"),ra=g("__shaders"),U=g("__subscene"),Pa=g("__textures"),sa=g("__tsr"),Ka=g("__util"),Sa=g("__vec3"),pb=g("__vec4"),Ta=g("__version"),Ba=Oa.B,$a=Oa.Mi,Xa=Oa.Uc,Ia=Oa.Vo,kb=[U.Bi,U.bd,U.Pb,U.Oc,U.$f,U.je,U.Pd,U.ld,U.Af,U.Se,U.xf,U.Ai,U.Bf,U.Kg,U.zf];a.u2=kb;var eb=[U.Pb,U.Oc,U.$f,U.je,U.Pd,U.ld,U.Kj,U.Pt,U.Lg,U.Af,U.Se,U.Xt,U.Bf,U.bd,U.xf,U.Ai,U.Kg],ab=[U.Pb,U.eu,U.Oc,U.$f,U.je,
U.Pd,U.ld,U.Af,U.Se],qb=[U.bd,U.Pb,U.Oc,U.$f,U.je,U.Pd,U.ld,U.Af,U.Se,U.xf,U.Ai,U.Bf,U.Kj,U.Kg,U.zf],lb=[U.Pb,U.Oc,U.$f,U.je,U.Pd,U.ld,U.Af,U.Se],nb=null,wb=null,Ua=[],Nb=null,kc=Math.PI/2,Wb=new Float32Array(2),rb=new Float32Array(3),od=new Float32Array(3),Ab=new Float32Array(4),fb=new Float32Array(4),lc=new Float32Array(16),Oc=new Float32Array(24),Wc=new Float32Array(24),vc=va.Sd(),Rc=va.Sd(),Hb=0,gc=-Infinity;a.a4=function(){return{}};a.kx=function(a){wb=a;Da.LY(a)};a.dY=function(a,b){var c=a.s,
d=fa.gT(c.Wa);if(a==b){oa(a,Ca.BJ(),Ca.AJ());for(var e=0;e<d.length;e++)a.s.Ym.push(d[e])}else for(e=a.ag[0],oa(a,e.vj,e.vj),e=0;e<d.length;e++)b.s.Ym.push(d[e]);d=S(a,qb);for(e=0;e<d.length;e++)d[e].Ij.set(c.Ij);for(e=0;e<c.Ym.length;e++)c.Ym[e].type==U.bd&&Ra.ao(c.Ym[e])};a.Yh=function(){nb||(nb=q(Ua));return nb};a.kv=q;a.A=c;a.Da=function(){return wb?!0:!1};a.qm=function(a){return a.Lj};a.Ir=function(){return Ua};a.GB=function(){if(1==Ua.length)return Ua;for(var a=0;a<Ua.length;a++){var b=Ua[a].s.Wa;
ma.pa(b,function(b,c){for(var d=c.Qa,e=0;e<d.length;e++)for(var f=d[e].sa,h=0;h<f.length;h++){for(var k=f[h],m=k.za.ya,n=null,g=0;g<m.length;g++)if("SCENE"==m[g].source&&m[g].Ys==Ua[a].name&&c.type!=U.Cy){Fa.error('Texture-scene loop detected. A scene is rendered to texture "'+m[g].name+'" yet this texture belongs to the same scene.');ma.oh(Nb,Ua[a]);n=k.za;break}n&&(n.ya=[],n.Md=[],ia.F_(n,null),ia.Xc(n),U.Rc(c,k))}})}for(var c=[],a=0;a<Ua.length;a++)if(b=Ua[a],!b.ag.length){b=ma.oh(Nb,b);ma.qU(Nb,
b);b=ma.Mx(Nb,b,ma.Ct);b=ma.oE(b);ma.pa(b,function(a,b){c.push(b)});break}return c};a.QQ=function(a,c,g,v,u){a.ag=a.ag||[];a.ra=null;var x=a.s,q=R.ja(a.Lj,a),B=a.Lj.k;x.Fp=[];var Q=a.world;x.JW=g.length;x.zj=t(g);x.Dx=f(Q,x.zj);x.Ip=O(Q,x.Dx);x.hO=H(Q);if(Q=!a.ag.length)a:{if("HMD"==Ba.stereo){if(q.da[0].type!=na.Qd){Fa.warn("Head-mounted display stereo is disabled for the non-perspective camera");Ba.stereo="NONE";Q=!1;break a}if(!wa.Du(wa.yd)){Fa.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Ba.stereo="NONE";Q=!1;break a}}Q="HMD"==Ba.stereo}x.Tv=Q;if(Q=!a.ag.length)q.da[0].type!=na.Qd&&"ANAGLYPH"==Ba.stereo?(Fa.warn("Anaglyph stereo is disabled for the non-perspective camera"),Ba.stereo="NONE",Q=!1):Q="ANAGLYPH"==Ba.stereo;x.anaglyph_use=Q;x.HQ=!x.Tv&&!x.anaglyph_use&&d(a,u);x.ki=m(a,c,v);x.BR=e(a);x.tX=z(a);x.bS=M(a);x.TV=E(a);x.KX=F(a);x.mk=A(a);x.dof=Ba.dof&&(0<B.dof_distance||B.dof_object);x.motion_blur=Ba.motion_blur&&a.b4w_enable_motion_blur;x.compositing=Ba.compositing&&a.b4w_enable_color_correction;
x.antialiasing=Ba.antialiasing&&1==Ba.Fc&&"NONE"!=a.b4w_antialiasing_quality;x.ssao=Ba.ssao&&a.b4w_enable_ssao;x.god_rays=Ba.god_rays&&a.b4w_enable_god_rays&&x.zj;x.YT=Ba.av;x.Gv=a.b4w_glow_settings.render_glow_over_blend;x.WZ=n(a);u=p(v);x.yK=u;x.refractions=J(a,u);x.wd=b(a,g,v);x.Lc=r(v);x.Dh=y(v);x.FZ=l(v);x.Xk=D(v);x.gd=I(a,v);x.GS=C(a,v);x.outline=h(a,v);x.$i=k(a,v);switch(a.b4w_reflection_quality){case "LOW":x.Qi=Ia.QH;x.sh=Ia.bL;break;case "MEDIUM":x.Qi=Ia.RT;x.sh=Ia.WX;break;case "HIGH":x.Qi=
Ia.QT;x.sh=Ia.VX;break;default:x.Qi=Ia.QH,x.sh=Ia.bL}Ca.xW()?(Fa.log("%cENABLE HIDPI MODE","color: #00a"),x.WF="AA_QUALITY_LOW",x.So=1,Ba.Fc=1):1<Ba.Fc?(Fa.log("%cENABLE MSAA RENDERING: "+Ba.Fc+"x","color: #00a"),x.So=1):(x.WF="AA_QUALITY_"+a.b4w_antialiasing_quality,x.So="MEDIUM"===a.b4w_antialiasing_quality&&Ba.quality===Oa.Dn||"HIGH"===a.b4w_antialiasing_quality&&Ba.quality===Oa.wl?1.33:"HIGH"===a.b4w_antialiasing_quality&&Ba.quality===Oa.Dn||"NONE"===a.b4w_antialiasing_quality&&Ba.quality===Oa.Dn?
2:1);g=a.ag.sort(function(a,b){return b.vj-a.vj});x.Wa=fa.fT(x,q,B,g);x.Ym=[];x.Dw=!1;x.IC=!1;x.JC=!1;x.Ij=new Float32Array(3);Ua.push(a);Nb||(Nb=ma.create());ma.J(Nb,a);for(x=0;x<c.length;x++)R.yD(c[x],!0,a);a=Ca.Fe();Ca.resize(a.clientWidth,a.clientHeight,!0)};a.RQ=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d].s;e&&e.Em&&(e.vt=c,a.s.Fp.push(b[d]))}};a.DB=function(a){return a.s.Wa};a.zI=function(a,b){ma.pa(b,function(c,d){var e=null;switch(d.type){case U.hc:e=ia.LA(d.Vw);break;case U.eu:e=
ia.lT(d);break;case U.Bz:e=ia.mT(d);break;case U.WE:e=ia.TS();break;case U.Kj:fa.Db(b,d,U.Fn)||fa.Db(b,d,U.zf)||fa.Db(b,d,U.Oc)||fa.Db(b,d,U.Kj);e=ia.XS(d.WK,d.Hj,d.mp);break;case U.Pt:fa.Db(b,d,U.Fn)||fa.Db(b,d,U.zf)||fa.Db(b,d,U.Oc);fa.Db(b,d,U.Kj);e=ia.YS();break;case U.Gh:e=ia.bT();break;case U.Ay:e=ia.QS(d.qH);break;case U.Op:var e=ia.US(d),f=d.p.dof_power;if(d.p.dof_bokeh){var f=f/2,h=fa.EB(b,d,U.hc);fa.Kc(h[0],f);fa.Kc(h[1],f);h[0]=fa.Db(b,h[0],U.hc);fa.Kc(h[0],f)}else{var h=fa.Db(b,d,U.hc),
k=fa.Db(b,h,U.hc);fa.Kc(h,f);fa.Kc(k,f)}break;case U.Cn:var e=ia.cT(),f=fa.Db(b,d,U.hc),h=fa.Db(b,f,U.hc),k=fa.Db(b,h,U.hc),m=fa.Db(b,k,U.hc);fa.Kc(h,d.Xz);fa.Kc(f,d.Xz);fa.Kc(m,d.nB*d.ts);fa.Kc(k,d.nB*d.ts);break;case U.Qp:e=ia.WS();break;case U.By:e=ia.RS();break;case U.PE:e=ia.LS(d);break;case U.zz:case U.cu:case U.gq:case U.du:e=ia.jT(d.type);break;case U.Di:e=ia.nT(d.vb);break;case U.Lg:e=ia.SS(a,d);break;case U.LUMINANCE:e=ia.ZS();break;case U.lO:e=ia.MS();break;case U.Xt:e=ia.$S();break;case U.Kp:e=
ia.OS();break;case U.Jp:e=fa.Db(b,d,U.Kp);f=fa.Db(b,e,U.Kp);fa.Kc(e,d.Mn);fa.Kc(f,d.Mn);e=ia.PS();break;case U.sQ:e=ia.LT();break;case U.yn:e=ia.KS();break;case U.cq:e=ia.dT()}e&&(f=U.ai(e,R.er("NONE")),U.Rc(d,f),B(b,d,e),G(e))})};a.Jn=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var d=a.s.Wa,e=b.k;!fa.ic(d,U.bd)&&e.ie&&(e.ie=!1);e=S(a,kb);c&&b.pn&&aa.Jn(b,a);for(var f=0;f<e.length;f++){var h=e[f],k=b,m=d,n=a,g=c;switch(h.type){case U.Pb:ba(h,k,m,"OPAQUE",n,g);break;case U.Oc:ba(h,
k,m,"BLEND",n,g);break;case U.$f:ba(h,k,m,"XRAY",n,g);break;case U.je:ba(h,k,m,"GLOW",n,g);break;case U.Pd:case U.ld:P(h,k,m,!1,n,g);break;case U.Af:case U.Se:P(h,k,m,!0,n,g);break;case U.Bf:for(var v=R.ja(k,n).X,p=0;p<v.length;p++){var l=v[p];if("SHADOW"==l.type&&"RECEIVE"==l.vb&&l.ie){if(!g&&(K(l,h,k,m,"SHADOW",n),!ia.Xc(l)))continue;var u=U.ai(l,k.k);U.Rc(h,u);B(m,h,l);G(l)}}break;case U.bd:v=!1;p=k.k;k=R.ja(k,n).X;l=fa.ic(m,U.Bi);for(u=0;u<k.length;u++){var x=k[u];if("SHADOW"==x.type&&"CAST"==
x.vb){v=!0;if(!g){var q=h.Hw;ia.nf(x,"NUM_LIGHTS",q);ia.nf(x,"NUM_LFACTORS",0==q%2?q/2:Math.floor(q/2)+1);ra.ha(x.hb,"SHADOW_USAGE","SHADOW_CASTING");x.gd&&l&&T(x,l,p);ia.nf(x,"SHADOW_TEX_RES",ra.O(n.s.wd.csm_resolution));if(!ia.Xc(x))continue}x=U.ai(x,p);U.Rc(h,x)}}v&&(k=n.s.wd,g=fa.ic(m,U.Pb),ka(h,n,g.p,k,!0));break;case U.xf:Q(h,k,m,n,g);break;case U.Ai:Q(h,k,m,n,g);break;case U.Kg:v=k.k;p=R.ja(k,n).X;for(l=0;l<p.length;l++)if(u=p[l],"COLOR_ID"==u.type&&"OUTLINE"==u.vb){if(!g&&(K(u,h,k,m,"COLOR_ID",
n),ia.nf(u,"USE_OUTLINE",1),!ia.Xc(u)))continue;u=U.ai(u,v);U.Rc(h,u)}break;case U.Bi:m=k.k;k=R.ja(k,n).X;for(n=0;n<k.length;n++)if(v=k[n],"GRASS_MAP"==v.type){if(!g&&!ia.Xc(v))if("DEBUG"===Ta.type())ia.ru(v,"error.glslv","error.glslf"),ia.Xc(v);else continue;v=U.ai(v,m);U.Rc(h,v);v=h.p;x=m.Ta;p=h.me[0];l=h.me[1];u=h.me[2];0==p&&0==l?(p=x.min_z,l=x.max_z):(p=Math.min(p,x.min_z),l=Math.max(l,x.max_z));x=1E-4*(l-p);p-=x;l+=x;h.me[0]=p;h.me[1]=l;na.nx(v,u/2,-l,-p,u/2);na.Vk(v)}break;case U.zf:for(v=
k.k,k=R.ja(k,n).X,n=0;n<k.length;n++)p=k[n],"DEBUG_VIEW"==p.type&&W(h,v,m,g,p)}}break;case "LAMP":Z(b,a),Ma.KZ(a)}R.yD(b,!0,a)};a.BE=u;a.zD=function(a){a.s.Dw=!0};a.b0=function(a,b){ma.pa(b,function(b,c){if(c.type===U.bd){var d=sa.jc(a.n,rb);sa.of(d,c.p.n);sa.copy(a.uf,c.p.Vs)}})};a.G$=ca;a.pV=function(a,b){for(var c=a.s.wd,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=na.OT(c,b,e);return d};a.J2=W;a.ZG=ha;a.Lq=v;a.dC=function(a){return a.k.$h};a.nY=function(a){for(var b=0;b<a.I.length;b++)for(var c=
S(a.I[b].yb,kb),b=0;b<c.length;b++)for(var d=c[b].Qa,e=0;e<d.length;e++)for(var f=d[e].sa,h=f.length-1;0<=h;h--){var k=f[h];k.kf==a.k&&(k.za&&ia.nH(k.za),f.splice(h,1))}};a.R_=function(a,b){for(var c=a.tb,d=R.ja(a,b).Jm,e=S(b,eb),f=0;f<e.length;f++){var h=e[f];h.gs.set(c.Xq,4*d);h.Ba=!0}};a.yp=Z;a.d0=function(a){a=a.I;for(var b=0;b<a.length;b++)u(a[b].yb)};a.ua=function(){for(var a=0;a<Ua.length;a++){var b=Ua[a];ma.pa(b.s.Wa,function(a,b){if(b.type!=U.Gn){var c=b.p;Ra.oY(c.df,c.wc,c.Ze,c.width,c.height);
for(var c=b.Qa,d=0;d<c.length;d++)for(var e=c[d].sa,f=0;f<e.length;f++){var h=e[f].za;h&&ia.nH(h)}}});b.s.Wa=[];b.s.Ym=[]}wb=nb=null;Ua.length=0;Nb=null};a.wK=function(a,b,c){a=na.xU(a,a.near,a.far,null,!0);var d=Bb.cV(a);a=R.er("DYNAMIC");a.Ta=a.S={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.kb=a.wa=va.xR();var e=a.kb.Xa;a.pb=a.ba=va.zq([e,0,0],[0,e,0],[0,0,e],a.kb.F);a.zp=!1;c=ia.iT(d,c);c=U.ai(c,a);U.Rc(b,c)};a.t6=function(a){return[a.frame_start,a.frame_end]};a.sM=
function(a,b,c){Ca.xZ(a,b,c);wb&&oa(wb,a,b)};a.J9=oa;a.$D=S;a.La=ga;a.UI=function(a){a=ga(a,U.Pb);var b=a.ne,c=a.we,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.$g,d,e]};a.mx=function(a,b,c,d){a=S(a,eb);for(var e=0;e<a.length;e++){var f=a[e];f.ne.set(c);f.we.set(d);f.$g=b;f.Ba=!0}};a.sJ=function(a){if(a=ga(a,U.Lg)){var b={};b.color=Array(3);Sa.copy(a.dp,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.jM=function(a,b){var c=ga(a,U.Lg);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.dp.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.Ba=!0,c.Cw=!0,V(a,c))};a.xV=function(a){return S(a,ab)[0].jg[0]};a.vV=function(a){return S(a,ab)[0].jg[1]};a.yV=function(a){return S(a,ab)[0].jg[2]};
a.wV=function(a){return S(a,ab)[0].jg[3]};a.XL=function(a,b){for(var c=S(a,ab),d=0;d<c.length;d++){var e=c[d];e.jg[0]=b;e.Ba=!0}};a.VL=function(a,b){for(var c=S(a,ab),d=0;d<c.length;d++){var e=c[d];e.jg[1]=b;e.Ba=!0}};a.YL=function(a,b){for(var c=S(a,ab),d=0;d<c.length;d++){var e=c[d];e.jg[2]=b;e.Ba=!0}};a.WL=function(a,b){for(var c=S(a,ab),d=0;d<c.length;d++){var e=c[d];e.jg[3]=b;e.Ba=!0}};a.XI=function(a,b){var c=b||[],d=S(a,ab)[0].Ee;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.ED=function(a,
b){for(var c=S(a,ab),d=0;d<c.length;d++){var e=c[d];e.Ee.set(b);e.Ba=!0}};a.uJ=function(a){var b=ga(a,U.eu);a=ga(a,U.Bz);if(!b)return null;var c=b.Qa[0].sa[0].za,d={};d.ssao_quality=ia.yB(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.LG=a.ssao_blur_discard_value;d.radius_increase=b.ip;d.influence=b.hp;d.dist_factor=b.gp;d.ssao_only=b.ssao_only;d.ssao_white=ia.yB(c,"SSAO_WHITE")[1];return d};a.lM=function(a,b){var c=ga(a,U.eu),d=ga(a,U.Bz);if(!c)return Fa.error("SSAO is not enabled on the scene"),
0;var e=c.Qa[0].sa[0],f=e.za;"string"==typeof b.ssao_quality&&(ia.nf(f,"SSAO_QUALITY",b.ssao_quality),ia.Xc(f),U.Rc(c,e));"number"==typeof b.ssao_hemisphere&&(ia.nf(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),ia.Xc(f),U.Rc(c,e));"number"==typeof b.ssao_blur_depth&&(ia.nf(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ia.Xc(f),U.Rc(c,e));"number"==typeof b.ssao_white&&(ia.nf(f,"SSAO_WHITE",b.ssao_white),ia.Xc(f),U.Rc(c,e));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.ip&&(c.ip=b.ip);"number"==typeof b.hp&&(c.hp=b.hp);"number"==typeof b.gp&&(c.gp=b.gp);if("number"==typeof b.ssao_only){c=ga(a,U.Pb);c.ssao_only=b.ssao_only;for(var e=c.Qa,h=0;h<e.length;h++)for(var k=e[h].sa,m=0;m<k.length;m++)f=k[m].za,ia.nf(f,"SSAO_ONLY",b.ssao_only),ia.Xc(f),U.Rc(c,k[m])}c.Ba=!0;d.Ba=!0};a.SI=function(a){a=ga(a,U.Op);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;
b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.TL=za;a.$I=function(a){var b=S(a,[U.Kj]);a=ga(a,U.Pt);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].zo;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ia.yB(b[0].Qa[0].sa[0].za,"STEPS_PER_PASS")[1];return c};a.$L=function(a,b){var c=S(a,[U.Kj]),d=ga(a,U.Pt);if(!c||!d)return Fa.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].zo=e,c[f].bx=e/c[f].mp/(f+1),c[f].Ba=!0;if("number"==typeof b.god_rays_steps)for(var h=ra.O(b.god_rays_steps,1),e=c[0].zo,f=0;f<c.length;f++){c[f].mp=h;c[f].bx=e/h/(f+1);c[f].Ba=!0;var k=c[f].Qa[0].sa[0],m=k.za;ia.nf(m,"STEPS_PER_PASS",h);ia.Xc(m);U.Rc(c[f],k)}d.Ba=!0};a.LI=function(a){var b=ga(a,U.Xt);a=ga(a,
U.Jp);if(!b||!a)return null;var c={};c.key=b.zu;c.edge_lum=b.yu;c.blur=a.Mn;return c};a.LL=ua;a.ZI=function(a){a=ga(a,U.Qp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.ZL=la;a.GJ=function(a){var b=Aa(a);a=Sa.length(b);if(0==a)return null;var b=Ka.re(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};
a.HY=function(a){a.s.IC=!0};a.DJ=da;a.CJ=function(a,b){var c=a.s.Lc,d=ga(a,U.Pb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.yi&&(b.water_fog_density=d.yi[3],c=b.water_fog_color=[],c[0]=d.yi[0],c[1]=d.yi[1],c[2]=d.yi[2]))};a.qM=function(a,b){var c=a.s.Lc;if(!c)return Fa.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);
"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);
"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.sr=b.water_dynamic);for(var d=S(a,lb),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.Ee&&(f.yi[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Ee&&f.yi.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.KE=b.waves_height);"number"==typeof b.waves_length&&(f.LE=b.waves_length);f.Ba=!0}};a.rJ=
function(a,b,c){var d=a.s.Lc;if(!d.Yk)return 100;var e=d.vC;a=d.sl;var f=(b[0]-d.ap[0])/d.bp[0],h=(d.ap[1]+b[1])/d.bp[1],f=f+.5,h=h+.5;if(1<f||0>f||1<h||0>h)b=1;else return d=e*Ka.JI(wb.s.RD,d.SD,f,h),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,b){for(var d=c().Lj.k,e=0;e<Ua.length;e++){var f=Ua[e],h=f.s.Wa,k=f.s;if(k.Lc)var m=sa.G(d.n),n=m[2]-da(f,m[0],m[1]);for(m=0;m<k.Fp.length;m++){var g=k.Fp[m].s,v=g.Sa,p=g.ud;if(!(f.b4w_use_nla&&g.ll||!v&&!p)&&Pa.cO(g)){var l=Pa.$N(g),u=Pa.bO(g);
v&&Ba.is_mobile_device&&(u-=5);var q=Pa.w0(g);l>=q&&g.Dj||l<u?(Pa.BL(g),p&&(g.Tk=Pa.jx(g,a))):l>=q&&!g.Dj?Pa.WC(g):Pa.dO(g)&&(v?Pa.HN(g):(v=Pa.jx(g,a),v!=g.Tk&&(Pa.GN(g),g.sj++),g.Tk=v))}}ma.pa(h,function(b,c){-1<qb.indexOf(c.type)&&(c.time=a);k.Lc&&(c.kA=n)})}for(e=0;e<Ua.length;e++)if(f=Ua[e],k=f.s,h=k.Wa,d=k.Ym,d.length)for(k.Dw&&(X(f),k.Dw=!1),k.IC&&(ea(f),k.IC=!1),k.JC&&(x(f),k.JC=!1),k.motion_blur&&L(h,b),f=fa.ic(h,U.Kg),m=0;m<d.length;m++)h=d[m],ja.Ww(h),f&&ya(h,f),Ra.ao(h);Ba.show_hud_debug_info&&
Ea.CZ(Ua,b)};a.xY=function(a){a.s.JC=!0};a.wB=function(a){var b=[];ma.pa(a.s.Wa,function(a,c){b.push(c)});return b};a.NI=function(){var a=ga(wb,U.Oc),b=wb;return a||b.s.Lc?a.kA:null};a.FN=function(a){ma.pa(a.s.Wa,function(a,b){b.Ba=!0})};a.QY=function(a,b){a.debug_view_mode=b;a.dc=b!=qa.Gt;a.Lb=b==qa.Ht;a.Ba=!0;for(var d=c(),e=0;e<lb.length;e++){var f=ga(d,lb[e]);f&&(f.fB=b==qa.Pp)}};a.PY=function(a,b){a.debug_colors_seed=b;a.Ba=!0};a.kZ=function(a,b){a.WH=b;a.Ba=!0};a.uZ=function(a,b){for(var c=
a.Qa,d=0;d<c.length;d++)for(var e=c[d].sa,f=0;f<e.length;f++){var h=e[f].za;Sa.copy(b,h.wireframe_edge_color);h.Ba=!0}};a.BN=function(a,b){var c=b.eo,d=a.s.Ij;if(c&&"WIND"==c.type&&d){Sa.transformQuat(Ka.nc,sa.R(b.k.n),d);Sa.normalize(d,d);Sa.scale(d,c.VM,d);for(var c=S(a,qb),e=0;e<c.length;e++)c[e].Ij.set(d);return!0}return!1};a.QX=function(a,b,c){var d=ga(a,U.xf);if(d){var e=Ca.Xh();na.NY(d.p,b,c,e.clientWidth,e.clientHeight);ja.Ww(d);d.dc&&Ra.ao(d);if(a=ga(a,U.Ai))Qa.copy(d.p.xb,a.p.xb),Qa.copy(d.p.kd,
a.p.kd),Ka.co(a.p.kd,a.p.Wh),ja.Ww(a),a.dc&&Ra.ao(a);if(d.dc||a&&a.dc)return Ra.jD(a?a.p.df:d.p.df,0,0)}else Fa.error("Object Selection is not available on the scene");return null};a.fM=function(a){var b=c();if(b=ga(b,U.Cn))b.oj.set(a),b.Ba=!0};a.U6=Aa;a.xv=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.AN=function(a,b){var c=rb;Sa.negate(b,c);for(var d=0;6>d;d++){var e=a.Zl[d],f=a.hr[d],h=a.p;Qa.translate(Ka.AO[d],
c,e);Qa.multiply(h.xb,e,h.kd);Ka.co(h.kd,f)}};a.DN=function(a,b,c){Ka.q_(b,c,Ka.nc,a.p.rc)};a.nR=function(a,b,c){var d=a.s.wd,e=a.s.ki;c=R.Bv(c,Ba.ssao&&a.b4w_enable_ssao);if(e)for(var f=0;f<b.length;f++){var h=b[f],k=R.ja(h,a);if(-1!=h.k.Fd){var m=e.hi,n=e.Uw,h=h.k.Fd;n.length?k.hi=n[h]:m.length&&(k.hi=m[h])}else-1!=h.k.Td&&(m=e.Pi,n=e.SA,h=h.k.Td,n.length?k.Pi=n[h]:m.length&&(k.Pi=m[h]))}for(f=0;f<c.length;f++)if(k=R.ja(c[f],a),d)for(b=S(a,[U.bd]),e=0;e<b.length;e++)f==b[e].xh&&k.QD.push(b[e])};
a.xK=function(a,b){return a.timeline_markers[b]};a.ox=function(a){var b=c();if(b=ga(b,U.Di))a.distortion_coefs&&(b.cm[0]=a.distortion_coefs[0],b.cm[1]=a.distortion_coefs[1],b.Ba=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Ba=!0),a.base_line_factor&&(b.cm[2]=
a.base_line_factor,b.Ba=!0),a.inter_lens_factor&&(b.cm[3]=a.inter_lens_factor,b.Ba=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Ba=!0)};a.FK=function(b,c){for(var d=Ua,e=0;e<d.length;e++)fa.BX(a.DB(d[e]),b,c)};a.A_=function(a){for(var b=Ma.Ub(a,"LAMP",Ma.oc),c=S(a,kb),d=0;d<c.length;d++)for(var e=c[d],f=e.Qa,h=0;h<f.length;h++)for(var k=f[h].sa,m=0;m<k.length;m++){var n=k[m],g=n.za;"MAIN"==g.type&&(ia.E_(g,b,a),ia.Xc(g),U.Rc(e,n))}};a.t8=function(a){for(var b=0;b<Ua.length;b++)ma.pa(Ua[b].s.Wa,
function(b,c){for(var d=c.Qa,e=0;e<d.length;e++)for(var f=d[e].sa,h=0;h<f.length;h++){var k=f[h];k.za==a&&U.Rc(c,k)}})}};b4w.module.__hud=function(a,g){function q(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var c=0,f=0,m=0;l.pa(a.s.Wa,function(a,n){if(n.type!=r.Gn){for(var g=Math.round(n.p.width)+"x"+Math.round(n.p.height),p=0,l=0;l<n.Qa.length;l++)p+=n.Qa[l].sa.length;l=n.jr;if(n.type==r.ld||n.type==r.Se)p*=6;var q=n.dc,t=q?n.Ff:0;n.Wd||(n.Ff=0);var h=
q?" (\u2713)":" (\u2715)",k=r.aE(n);b(h,k,n.Hw,g,l,"of",p,"  ",t.toFixed(3));n.jr=0;q&&(c+=p,f+=l,m+=t)}});return[c,f,m]}b("No INFO")}function b(){for(var a=80+20*f[0],b=arguments[0],c=1;c<arguments.length;c++){for(var g="",l=0;l<p[c]-String(arguments[c]).length;l++)g+=" ";b+=g+arguments[c]}f[0]++;m.fillText(b,30,a)}function w(a,b,c){b*=a.uc;c.x=a.x+b;c.y=a.y;c.uc=a.uc-2*b;c.Ib=a.Ib}function t(a){return a.x+a.uc/2}function D(a){var b=m,c={x:0,y:0,uc:0,Ib:0},f=b.canvas.width,b=b.canvas.height;c.x=
0;c.y=0;c.uc=f;c.Ib=b;w(c,.01,c);f=.02*c.Ib;c.x=c.x;c.y+=f;c.uc=c.uc;c.Ib-=2*f;f=c.uc/8;c.x+=f*a;c.y=c.y;c.uc=f;c.Ib=c.Ib;w(c,.02,c);return c}var l=g("__graph");g("__print");var r=g("__subscene"),p=[5,30,4,10,5,3,5],m=null,f=[0,0];a.fh=function(a){a=a.getContext("2d");q(a);return m=a};a.ht=function(){m&&q(m)};a.reset=function(){var a=m;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),f[0]=0,f[1]=0)};a.CZ=function(a,e){var g=
m;if(g){g.textAlign="left";g.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/e).toFixed(2));f[0]++;for(var p=g=0,l=0,q=0;q<a.length;q++){var r=c(a[q]),g=g+r[0],p=p+r[1],l=l+r[2];f[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",p,"of",g,"  ",l.toFixed(3))}};a.print=function(){var a=m;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.s8=function(a,b,c,f,g,p,l){var q=m;if(q){b=D(b);var r=b.Ib/5;b.x=b.x;b.y+=4*r;b.uc=
b.uc;b.Ib=r;q.textAlign="center";q.fillStyle="#00FF00";m.fillText(a,t(b),b.y-10);q.strokeStyle="#00FF00";q.lineWidth=.5;q.beginPath();q.moveTo(b.x,b.y);q.lineTo(b.x+b.uc,b.y);q.lineTo(b.x+b.uc,b.y+b.Ib);q.lineTo(b.x,b.y+b.Ib);q.closePath();q.stroke();if(!p&&!l)for(p=1E6,l=-1E6,a=0;a<c.length;a++)p=Math.min(p,c[a]),l=Math.max(l,c[a]);q.textAlign="right";m.fillText(String(p),b.x-10,b.y+b.Ib);m.fillText(String(l),b.x-10,b.y);q.textAlign="center";m.fillText(String(f),b.x,b.y+b.Ib+15);m.fillText(String(g),
b.x+b.uc,b.y+b.Ib+15);q.strokeStyle="#FF0000";q.lineWidth=1.5;q.beginPath();f=b.uc/(c.length-1);l=b.Ib/(l-p);for(a=0;a<c.length;a++)g=b.x+f*a,r=b.y+b.Ib-(c[a]-p)*l,0==a?q.moveTo(g,r):q.lineTo(g,r);q.stroke()}};a.s4=function(a,b,c,f,g,p,l){var q=m;if(q)for(q.textAlign="center",q.fillStyle="#00FF00",q.font="bold 12px Courier",c=D(c),m.fillText(b?"["+a+"]":a,t(c),c.y),0<=p&&m.fillText(p?"[M]":"[ ]",t(c)-15,c.y+30),0<=l&&m.fillText(l?"[S]":"[ ]",t(c)+15,c.y+30),a={x:0,y:0,uc:0,Ib:0},b=0;b<f.length;b++){p=
f[b];var r="VOLUME"==p[0];if(r){l=c.y+350;var I=c.uc,C=a;C.x=c.x;C.y=l;C.uc=I;C.Ib=250}else{l=c.y+50+50*b;var I=c.uc,C=c.Ib,h=a;h.x=c.x;h.y=l;h.uc=I;h.Ib=C}l=q;var I=a,h=b==g,k=p[0],C=p[1],J=p[2],y=p[3],d=(y-J)/p[4],d=1>d?Math.floor(1/d-1E-5).toFixed(0).length:0;p=p[5]?Math.log(C/J)/Math.log(y/J):(C-J)/(y-J);l.textAlign="center";h?l.fillText("["+k+"]",t(I),I.y):l.fillText(k,t(I),I.y);l.strokeStyle="#00FF00";l.lineWidth=r?3:1;r?(l.textAlign="right",l.fillText(y.toFixed(d),t(I)-10,I.y+15),l.textAlign=
"right",l.fillText(J.toFixed(d),t(I)-10,I.y+I.Ib-15)):(l.textAlign="right",l.fillText(J.toFixed(d),I.x+28,I.y+15),l.textAlign="left",l.fillText(y.toFixed(d),I.x+I.uc-28,I.y+15));l.beginPath();if(r){var B=I.y+15+(I.Ib-30)*(1-p);l.moveTo(t(I),I.y+15);l.lineTo(t(I),I.y+I.Ib-15);l.moveTo(t(I)-5,I.y+15);l.lineTo(t(I)+5,I.y+15);l.moveTo(t(I)-5,I.y+I.Ib-15);l.lineTo(t(I)+5,I.y+I.Ib-15);l.moveTo(t(I)-5,B);l.lineTo(t(I)+5,B)}else{var u=I.x+30+(I.uc-60)*p;l.moveTo(I.x+30,I.y+15);l.lineTo(I.x+I.uc-30,I.y+15);
l.moveTo(I.x+30,I.y+15-5);l.lineTo(I.x+30,I.y+15+5);l.moveTo(I.x+I.uc-30,I.y+15-5);l.lineTo(I.x+I.uc-30,I.y+15+5);l.moveTo(u,I.y+15-5);l.lineTo(u,I.y+15+5)}l.stroke();"EQ_Q"==k?(p=Math.log(1+1/(2*C*C)+Math.sqrt((2+1/(C*C))*(2+1/(C*C))/4-1))/Math.log(2),r?(l.textAlign="left",l.fillText(C.toFixed(d),t(I)+10,B),l.textAlign="left",l.fillText("("+p.toFixed(d+1)+")",t(I)+10,B+10)):(l.textAlign="right",l.fillText(C.toFixed(d),u,I.y+30),l.textAlign="left",l.fillText("("+p.toFixed(d+1)+")",u,I.y+30))):r?(l.textAlign=
"left",l.fillText(C.toFixed(d),t(I)+10,B)):(l.textAlign="center",l.fillText(C.toFixed(d),u,I.y+30))}}};b4w.module.__subscene=function(a,g){function q(a,b){a.Hw=b;a.mC=new Float32Array(3*b);a.hs=new Float32Array(4*b);a.gs=new Float32Array(4*b)}function c(a){a={type:a,vb:"",Lb:!1,WK:!1,Rz:!1,Cw:!1,jr:0,Ff:0,$l:[],debug_view_mode:0,debug_colors_seed:0,WH:1,fB:!1,time:0,p:null,Zl:null,hr:[],Qa:[],Ya:[],ti:[],Ij:new Float32Array(3),me:new Float32Array(3),Ee:new Float32Array(4),jg:new Float32Array(4),Be:new Float32Array(16),Fx:0,$g:0,Hw:0,mC:null,hs:null,gs:null,J7:null,ne:new Float32Array(3),we:new Float32Array(3),
Gx:new Float32Array(4),$M:new Float32Array(3),bE:new Float32Array([0,0,1]),aN:new Float32Array(4),Ex:new Float32Array(3),ts:0,hB:0,Xr:!1,oj:new Float32Array(3),Hj:!1,kA:0,yi:null,KE:0,LE:0,sl:0,Lc:null,Sg:!1,VG:0,WG:new Float32Array(2),UG:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,dp:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,ip:0,hp:0,gp:0,PM:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,zo:0,bx:0,mp:0,RA:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,$x:null,Zx:null,FE:null,Tm:null,zc:!1,uI:"",zu:0,Mn:0,yu:0,Xz:0,nB:0,mb_decay_threshold:0,mb_factor:0,DK:0,Vw:"",qH:"",EW:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,lE:new Float32Array(2),Fb:new Float32Array(2),
cm:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,xh:0,HC:!0,DM:!1,IM:!1,EM:!1,FM:!1,HM:!1,GM:!1,CM:"",pt:!1,qt:!1,rt:!1,dc:!0,Wd:!0,wb:!0,Bb:!0,Ud:!0,Ba:!0,Cg:1};a.Fb[0]=1;a.Fb[1]=1;a.cm[2]=.5;a.cm[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function w(a,c){return-b(a.Mg,c.Mg)||b(a.vg,c.vg)||b(a.zb.PD,c.zb.PD)}var t=g("__camera"),D=g("__config"),l=g("__util"),r=g("__boundings"),p=D.Uc;a.Pb=0;a.Oc=1;a.$f=2;a.Pd=3;a.ld=4;a.Af=5;a.Se=6;a.je=7;a.bd=
8;a.Bf=9;a.Bi=10;a.hc=11;a.Kp=12;a.Qp=13;a.Fn=14;a.xf=15;a.Ai=16;a.zf=17;a.yn=18;a.WE=19;a.eu=20;a.Bz=21;a.PE=22;a.gq=23;a.cu=24;a.zz=25;a.du=26;a.By=27;a.Gh=28;a.Ay=29;a.Op=30;a.Kg=31;a.Cn=32;a.Kj=33;a.Pt=34;a.Lg=35;a.Cy=36;a.Di=37;a.LUMINANCE=38;a.lO=39;a.Xt=40;a.Jp=41;a.sQ=42;a.Gn=43;a.cq=44;a.ET=function(a,b,g,e){var p=c(8);p.RA=a;p.self_shadow_polygon_offset=g.self_shadow_polygon_offset;p.xh=b;switch(g.jh[b]){case "SPOT":case "POINT":p.p=t.fd(t.Qd);a=l.re(g.OM[b]);t.nx(p.p,a,g.Pq[b],g.Oq[b]);
break;default:p.p=t.fd(t.Ei)}q(p,e);return p};a.FS=function(a){var b=a.p;a.p=null;var c=l.T(a);a.p=b;c.p=t.Hc(b,!0);return c};a.xT=function(){var a=c(10);a.p=t.fd(t.Ih);return a};a.Bd=function(a){var b=c(11);b.wb=!1;b.Bb=!1;b.Ud=!1;b.zc=!0;b.p=t.fd(t.od);b.Vw=a;switch(a){case "NONE":b.Fb[0]=1;b.Fb[1]=1;break;case "GRAYSCALE":b.Fb[0]=1;b.Fb[1]=1;break;case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=0;b.Fb[1]=1;break;case "X_GLOW_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_GLOW_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;case "X_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "Y_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "X_ALPHA_BLUR":b.Fb[0]=1;b.Fb[1]=0;b.Cg=3;break;case "Y_ALPHA_BLUR":b.Fb[0]=0;b.Fb[1]=1;b.Cg=3;break;case "X_EXTEND":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_EXTEND":b.Fb[0]=0;b.Fb[1]=1;break;default:l.q("Wrong postprocessing effect: "+a)}return b};a.HH=function(a){var b=c(12);b.wb=!1;b.Bb=!1;b.Ud=!1;b.p=t.fd(t.od);b.Vw=a;b.zc=!0;switch(a){case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;default:l.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.vT=function(a,b){var g=c(13);g.wb=!1;g.Bb=!1;g.Ud=!1;g.small_glow_mask_coeff=b.mk.small_glow_mask_coeff;g.large_glow_mask_coeff=b.mk.large_glow_mask_coeff;g.small_glow_mask_width=b.mk.small_glow_mask_width;g.large_glow_mask_width=b.mk.large_glow_mask_width;g.p=a;g.zc=!0;return g};a.Xl=function(a,b,g,e,p,r,t,w,A){var O=c(a);0==a?(O.wb=!0,O.Bb=g,O.Lb=!1):1==a?(O.wb=!1,O.Bb=!1,O.Lb=!0):2==a?(O.wb=!1,O.Bb=!0,O.Lb=
!0):3==a||4==a?(O.wb=!0,O.Bb=!0,O.Lb=!1):5==a||6==a?(O.wb=!1,O.Bb=!1,O.Lb=!0):7==a?(O.wb=!0,O.Bb=!1,O.Lb=!0):l.q("wrong main subscene type");O.Lb&&w&&(O.self_shadow_normal_offset=w.self_shadow_normal_offset);O.p=b;if(a=t.ep)O.Gx.set([a.IG,a.OJ,a.jO,a.iO]),O.Ex.set(a.color),O.Fx=a.Ea;O.ne.set(t.ne);O.we.set(t.we);O.$g=t.$g;O.Ee=r.Ee;O.jg=r.jg;e&&(O.Lc=e,e.Ee&&(O.yi=new Float32Array(e.Ee)),O.KE=e.waves_height,O.LE=e.waves_length,O.sl=e.sl,e.Sg&&A&&(O.Sg=!0,O.VG=e.$R,O.UG=e.ZR,O.WG.set(e.aS)));q(O,p);
return O};a.Ru=function(){var a=c(14);a.zc=!0;a.p=t.fd(t.od);return a};a.IH=function(a,b,g){var e=c(15);b&&(e.type=16,e.wb=!1,e.Bb=!0);e.Wd=!1;e.p=a;q(e,g);return e};a.tT=function(a){var b=c(17);b.dc=!1;b.wb=!1;b.Bb=!1;b.p=a;return b};a.pT=function(a){var b=c(18);b.wb=!0;b.Bb=!1;b.p=a;return b};a.FT=function(a,b){var g=c(9);g.p=a;q(g,b);return g};a.uT=function(a){var b=c(19);b.wb=!1;b.Bb=!1;b.p=a;b.zc=!0;return b};a.HT=function(a,b,g){var e=c(20);e.wb=!1;e.Bb=!1;e.Ud=!1;e.p=a;e.Ee=b.Ee;e.yi=new Float32Array(b.Ee);
e.ip=g.radius_increase;e.ssao_hemisphere=g.aW;e.hp=g.influence;e.gp=g.dist_factor;e.PM=g.GY;e.zc=!0;return e};a.IT=function(a,b){var g=c(21);g.wb=!1;g.Bb=!1;g.Ud=!1;g.p=a;g.ssao_blur_depth=b.CR;g.ssao_blur_discard_value=b.LG;g.zc=!0;return g};a.oT=function(a){var b=c(22);b.wb=!1;b.Bb=!1;b.Ud=!1;b.Cg=1/a.So;b.uI=a.WF;b.p=t.fd(t.od);b.zc=!0;return b};a.PA=function(a,b){var g=c(a);g.wb=23==a||24==a?!0:!1;g.Bb=!1;g.Ud=!1;g.Cg=1/b.So;g.p=t.fd(t.od);23==a&&(g.FW=new Float32Array(4));g.zc=!0;return g};a.sT=
function(a,b,g,e){var p=c(27);p.wb=!1;p.Bb=!1;p.Ud=!1;p.p=t.fd(t.od);p.brightness=a;p.contrast=b;p.exposure=g;p.saturation=e;p.zc=!0;return p};a.AT=function(a,b){var g=c(28);g.wb=!1;g.Bb=!1;g.Ud=!1;g.p=t.fd(t.od);g.Rz=!0;g.mb_decay_threshold=a;g.mb_factor=b;g.zc=!0;return g};a.MA=function(a,b){var g=c(29);g.wb=!1;g.Bb=!1;g.Ud=!1;g.p=a;g.Cg=g.p.dof_power;g.qH=b;g.zc=!0;return g};a.JH=function(a){var b=c(30);b.wb=!1;b.Bb=!1;b.Ud=!1;b.p=a;b.Cg=b.p.dof_power;b.zc=!0;return b};a.CT=function(a,b){var g=
c(31);g.Ud=!1;g.p=a;q(g,b);return g};a.BT=function(a){var b=c(32);p.outlining_overview_mode?b.oj.set(p.oj):b.oj.set(a.oj);b.ts=a.ts;b.nB=5;b.Xz=3;b.Ud=!1;b.p=t.fd(t.od);b.zc=!0;return b};a.OA=function(a,b,g,e,p,l,r){var t=c(33);t.wb=!1;t.Bb=!1;t.Ud=!1;t.ne=new Float32Array([1,1,1]);t.we=new Float32Array([1,1,1]);t.$g=1;t.WK=e;t.Hj=b;t.bx=p;t.zo=g;t.mp=r;t.p=a;q(t,l);return t};a.wT=function(a,b){var g=c(34);g.wb=!1;g.Bb=!1;g.Ud=!1;g.p=t.fd(t.od);g.god_rays_intensity=a;q(g,b);g.zc=!0;return g};a.GT=
function(a,b,g,e){var p=c(35);p.Wd=!1;p.wb=!1;p.Bb=!1;p.Ud=!1;var r=t.fd(t.od);r.width=e;r.height=e;p.p=r;p.Zl=l.aV();q(p,b);p.ne=new Float32Array([1,1,1]);p.we=new Float32Array([1,1,1]);p.$g=1;p.dp.set(g.dp);p.procedural_skydome=g.procedural_skydome;p.use_as_environment_lighting=g.use_as_environment_lighting;p.rayleigh_brightness=g.rayleigh_brightness;p.mie_brightness=g.mie_brightness;p.spot_brightness=g.spot_brightness;p.scatter_strength=g.scatter_strength;p.rayleigh_strength=g.rayleigh_strength;
p.mie_strength=g.mie_strength;p.rayleigh_collection_power=g.rayleigh_collection_power;p.mie_collection_power=g.mie_collection_power;p.mie_distribution=g.mie_distribution;if(a){p.ne.set(a.ne);p.we.set(a.we);p.$g=a.$g;if(b=a.ep)p.Gx.set([b.IG,b.OJ,b.jO,b.iO]),p.Ex.set(b.color),p.Fx=b.Ea,p.DM=b.invert,p.IM=b.PN,p.EM=b.KN,p.FM=b.LN,p.HM=b.NN,p.GM=b.MN,p.CM=b.JG;p.pt=a.pt;p.qt=a.qt;p.rt=a.rt}return p};a.NA=function(){var a=c(36);a.wb=!1;a.Bb=!1;a.p=t.fd(t.od);a.zc=!0;return a};a.JT=function(a){var b=c(37);
b.wb=!1;b.Bb=!1;b.vb=a?"HMD":"ANAGLYPH";b.p=t.fd(t.od);b.zc=!0;return b};a.yT=function(){var a=c(38);a.wb=!1;a.Bb=!1;a.p=t.fd(t.od);a.zc=!0;return a};a.qT=function(){var a=c(39);a.wb=!1;a.Bb=!1;a.p=t.fd(t.od);a.zc=!0;return a};a.zT=function(a,b,g,e){var p=c(40);p.wb=!1;p.Bb=!1;p.zu=a;p.yu=b;p.p=e;q(p,g);p.zc=!0;return p};a.rT=function(a){var b=c(41);b.wb=!1;b.Bb=!1;b.p=t.fd(t.od);b.Mn=a;b.zc=!0;return b};a.c4=function(a){var b=c(42);b.wb=!1;b.Bb=!1;b.p=a;b.zc=!0;return b};a.KH=function(){var a=c(43);
a.Wd=!1;return a};a.DT=function(){var a=c(44);a.zc=!0;return a};a.aE=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.Vw.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Rc=function(a,b){for(var c=b.za,e=c.zb,g=0;g<a.Qa.length;g++){var p=a.Qa[g].sa,l=p.indexOf(b);
-1!=l&&(p.splice(l,1),p.length||a.Qa.splice(g,1))}g=a.Lb?c.vg:0;a:{p=a.Qa;for(l=0;l<p.length;l++){var q=p[l];if(q.zb==e&&g==q.vg){p=q;break a}}p=null}p?p.sa.push(b):(a.Qa.push({zb:e,sa:[b],Mg:c.Mg,vg:g,dc:!0}),a.HC=!0)};a.ai=function(a,b){var c={dc:!0,gB:[!0,!0,!0,!0,!0,!0],kf:b,za:a,Zv:null};if(a.wf&&a.Ca.oe){var e=a.Ca.oe;c.Zv={uX:new Float32Array(e.length),vX:new Float32Array(e.length),dU:new Float32Array(e.length/3),kO:new Float32Array(3),wR:r.OR(a.S)}}return c};a.JZ=function(a){a.Qa.sort(w);
a.HC=!1}};b4w.module.__input=function(a,g){function q(a){var b=T.$e();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!q(a))return null;var c={type:a,uh:!1,wg:[],ph:[],fj:[],ee:[],gj:[],hj:[],cs:[],jK:[],bj:[],Cj:[],Bj:[],Aj:[],element:b,ii:!0,Xb:[],Bw:new Float32Array(2),AX:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Hp:null,zi:null,Zf:null,orientation:ka.create(),position:Q.create(),
Ti:new Float32Array(4),Ui:new Float32Array(4),aj:0,Rj:0,Qk:0,wn:0,ok:0,Sj:0,lm:[],jk:[0,0,0,0,0,0,0,0,0,0,0,0],vI:[0,0,0,0,0,0,0,0,0,0,0,0],qv:[]};c.Ti[0]=c.Ti[1]=c.Ti[2]=c.Ti[3]=45;c.Ui[0]=c.Ui[1]=c.Ui[2]=c.Ui[3]=45;30==a||40==a||50==a?(c.uh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.ii=!1)):10==a?c.uh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ha.is_mobile_device?t(c,v.webvr):(w(c),c.uh=!0));return c}function b(b,d){10==b||20==b?d=window:d||
(d=40==b?document:P.Fe());for(var e=0;e<la.length;e++)if(la[e].type==b&&la[e].element==d)return la[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.qv.push(a.Xy,a.It,a.bz,a.iz,a.jz,a.kz,a.Ot,a.Wp,a.lz,a.mz,a.Yy,a.Zy,a.Jt,a.Kt,a.Lt,a.Vp,a.Mt,a.Nt,a.$y,a.az,a.cz,a.dz,a.ez,a.fz,a.gz,a.hz,a.Rp,a.Sp,a.Tp,a.Up,a.Ry,a.Sy,a.Ty,a.Uy,a.Vy,a.Wy,a.Py,a.Qy);e&&la.push(e);return e}function w(a){var b=v.nonwebvr;a.wn=b.wn;a.ok=b.ok;a.Sj=b.Sj;t(a,b);a.aj=b.aj;a.Rj=b.Rj;a.Qk=b.Qk;l(a)}function t(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function D(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function l(a){var b=a.Rj-a.Sj,c=a.ok-b,d=a.aj/2,e=(a.wn-a.aj)/2,b=ca.re(Math.atan(b/a.Qk)),c=ca.re(Math.atan(c/a.Qk)),d=ca.re(Math.atan(d/
a.Qk)),e=ca.re(Math.atan(e/a.Qk));c&&(a.Ti[0]=a.Ui[0]=Math.min(c,60));d&&(a.Ti[1]=a.Ui[3]=Math.min(d,60));b&&(a.Ti[2]=a.Ui[2]=Math.min(b,60));e&&(a.Ti[3]=a.Ui[1]=Math.min(e,60))}function r(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Hp=d;a.zi=c}function p(a,b,c){switch(a.type){case 20:var d=
a.Zf||a.Hp;d?(b=d.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,d=D(a,Math.tan(ca.Cb(b.downDegrees))),ca.re(Math.atan(d)),d=D(a,Math.tan(ca.Cb(b.upDegrees))),ca.re(Math.atan(d)),d=D(a,Math.tan(ca.Cb(b.leftDegrees))),ca.re(Math.atan(d)),a=D(a,Math.tan(ca.Cb(b.rightDegrees))),ca.re(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Ti:a.Ui,W.copy(b,c));break;default:x.error("fov is undefined for device: ",a.type)}return c}
function m(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ha.is_mobile_device?1:0:2;case 23:var c=a.Zf||a.Hp;if(c){var d=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.Zf?c.offset[0]-d.offset[0]:c.eyeTranslation.x-d.eyeTranslation.x}return a.aj}}function f(a,b){if(a.Zf){var c=a.Zf,d=c.capabilities,c=c.getPose();d.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],a.orientation[3]=
c.orientation[3]);d.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-ta&&(ta=b,navigator.getVRDisplays?a.Zf||navigator.getVRDisplays().then(function(b){0<b.length&&(a.Zf=b[0],a.uh=!0)},function(){x.P("WebVR displays are not found.");a.uh=!1}):navigator.getVRDevices?a.Hp||oa||navigator.getVRDevices().then(function(b){r(a,b);b.length&&(a.uh=!0);oa=!0},function(){x.P("WebVR devices are not found.");a.uh=!1;oa=!0}):ha.is_mobile_device||
x.P("HMD isn't supported."))}function n(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.lm[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.jk[c]=a.axes[c]}}function e(a){for(var b=0;b<a.lm;b++)a.lm[b]=0;for(b=0;b<a.jk.length;b++)a.vI[b]=a.jk[b],a.jk[b]=0}function z(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function M(a){return null===a}function E(a,b,c,e){switch(b){case 120:c&&z(a.wg,c);if(e||a.ph.every(M)&&a.wg.every(M))a.wg.length=0,a.ph.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("deviceorientation",A,!1));break;case 130:c&&z(a.ph,c);if(e||a.ph.every(M)&&a.wg.every(M))a.wg.length=0,a.ph.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("deviceorientation",A,!1));break;case 40:c&&z(a.fj,c);if(e||a.fj.every(M))a.fj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousedown",C,!1));break;case 30:c&&z(a.ee,c);if(e||a.ee.every(M))a.ee.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("mousemove",H,!1));break;case 31:c&&z(a.ee,c);if(e||a.ee.every(M))a.ee.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousemove",I,!1));break;case 50:c&&z(a.gj,c);if(e||a.gj.every(M)){a.gj.length=0;b=a.Xb.indexOf(b);0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mouseout",h,!1),a.element.removeEventListener("mouseup",k,!1));break}break;case 60:c&&z(a.hj,c);if(e||a.hj.every(M))a.hj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("wheel",J,!1));break;case 80:c&&z(a.cs,c);if(e||a.cs.every(M))a.cs.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keydown",y,!1));break;case 70:c&&z(a.bj,c);if(e||a.bj.every(M))a.bj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keyup",d,!1));break;case 90:c&&z(a.Cj,c);if(e||a.Cj.every(M))a.Cj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchstart",B,!1));break;
case 100:c&&z(a.Bj,c);if(e||a.Bj.every(M))a.Bj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchmove",u,!1));break;case 110:if(c&&z(a.Aj,c),e||a.Aj.every(M))a.Aj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchend",ba,!1))}}function F(a,b){ca.OC(a,ca.Ez,b);var c="orientation"in window?ca.Cb(window.orientation):"orientation"in window.screen?ca.Cb(window.screen.orientation.angle):0,c=ka.setAxisAngle(ca.Mc,c,Y);ka.multiply(b,
c,b);return b}function A(a){var c=V;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=ca.Cb(a.alpha),c[1]=ca.Cb(a.beta),c[2]=ca.Cb(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.ph.length;d++){var e=a.ph[d];e&&(Q.copy(c,ga),e(ga))}if(a.wg.length)for(c=F(c,Z),d=0;d<a.wg.length;d++)if(e=a.wg[d])ka.copy(c,za),e(za);for(d=0;d<a.wg.length;d++)a.wg[d]||a.wg.splice(d,1);for(d=0;d<a.ph.length;d++)a.ph[d]||a.ph.splice(d,1)}function O(a,b){switch(a.type){case 30:a.Bw[0]=b.clientX,a.Bw[1]=
b.clientY,a.AX=b.which}}function H(a){if(!ua||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var d=0;d<c.ee.length;d++){var e=c.ee[d];e&&(S[0]=a.clientX,S[1]=a.clientY,e(S))}c.ii&&a.preventDefault();for(d=0;d<c.ee.length;d++)c.ee[d]||c.ee.splice(d,1)}}function I(a){if(!ua||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var d=0;d<c.ee.length;d++){var e=
c.ee[d];if(e){if("number"==typeof a.movementX)var f=a.movementX,h=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,h=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,h=a.mozMovementY):h=f=0;S[0]=f;S[1]=h;e(S)}}c.ii&&a.preventDefault();for(d=0;d<c.ee.length;d++)c.ee[d]||c.ee.splice(d,1)}}function C(a){if(!ua||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var d=0;d<c.fj.length;d++){var e=
c.fj[d];e&&e(a.which)}c.ii&&a.preventDefault();for(d=0;d<c.fj.length;d++)c.fj[d]||c.fj.splice(d,1)}}function h(a){!P.ZJ(a.relatedTarget)&&a.which&&k(a)}function k(a){if(!ua||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);O(c,a);for(var d=0;d<c.gj.length;d++){var e=c.gj[d];e&&e(a.which)}c.ii&&a.preventDefault();for(d=0;d<c.gj.length;d++)c.gj[d]||c.gj.splice(d,1)}}function J(a){for(var c=b(30,a.currentTarget),d=0;d<c.hj.length;d++){var e=
c.hj[d];e&&e(-a.deltaY)}c.ii&&a.preventDefault();for(d=0;d<c.hj.length;d++)c.hj[d]||c.hj.splice(d,1)}function y(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.jK:c.cs,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.ii&&a.preventDefault()}function d(a){for(var c=b(40,a.currentTarget),d=0;d<c.bj.length;d++){var e=c.bj[d];e&&e(a.keyCode)}c.ii&&a.preventDefault();for(d=0;d<c.bj.length;d++)c.bj[d]||c.bj.splice(d,1)}function B(a){for(var c=b(50,a.currentTarget),d=
0;d<c.Cj.length;d++){var e=c.Cj[d];e&&e(a.targetTouches)}for(d=0;d<c.Cj.length;d++)c.Cj[d]||c.Cj.splice(d,1)}function u(a){for(var c=b(50,a.currentTarget),d=0;d<c.Bj.length;d++){var e=c.Bj[d];e&&e(a.targetTouches)}c.ii&&a.preventDefault();for(d=0;d<c.Bj.length;d++)c.Bj[d]||c.Bj.splice(d,1)}function ba(a){for(var c=b(50,a.currentTarget),d=0;d<c.Aj.length;d++){var e=c.Aj[d];e&&e(a.targetTouches)}for(d=0;d<c.Aj.length;d++)c.Aj[d]||c.Aj.splice(d,1)}function K(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function G(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}var T=g("__compat"),P=g("__container"),X=g("__config"),x=g("__print"),ka=g("__quat"),ca=g("__util"),Q=g("__vec3"),W=g("__vec4"),ha=X.B,v=X.bW;a.Fh=10;a.yd=20;a.$c=30;a.Mp=40;a.Ig=50;a.Dt=60;a.Gy=70;a.Hy=80;a.Iy=90;a.uz=0;a.YE=1;a.XE=2;a.Xp=3;a.ul=0;a.Rt=10;a.St=20;a.tO=21;a.uO=22;a.qz=23;a.pz=24;a.nz=25;a.sz=26;a.tz=27;a.rz=
28;a.oz=29;a.Ci=30;a.jF=31;a.vl=40;a.aq=50;a.bq=60;a.Zp=70;a.Yp=80;a.aF=81;a.zl=90;a.hq=100;a.yl=110;a.Qt=120;a.Bn=130;a.Xy=300;a.It=301;a.bz=302;a.iz=303;a.jz=304;a.kz=305;a.Ot=306;a.Wp=307;a.lz=308;a.mz=309;a.Yy=310;a.Zy=311;a.Jt=312;a.Kt=313;a.Lt=314;a.Vp=315;a.Mt=316;a.Nt=317;a.$y=318;a.az=319;a.cz=320;a.dz=321;a.ez=322;a.fz=323;a.gz=324;a.hz=325;a.Rp=326;a.Sp=327;a.Tp=328;a.Up=329;a.Ry=330;a.Sy=331;a.Ty=332;a.Uy=333;a.Vy=334;a.Wy=335;a.Py=336;a.Qy=337;var Z=ka.create(),Y=ka.create(),V=Q.create(),
ta=-Infinity,oa=!1,S=new Float32Array(2);Q.create();var ga=Q.create(),za=ka.create(),ua="ontouchstart"in document.documentElement,la=[];a.Du=q;a.fa=b;a.fE=function(a,b){a.ii=b};a.ex=function(a){switch(a.type){case 20:if(a.uh)if(a.Zf)a.Zf.resetPose();else if(a.zi)for(var b=0;b<a.zi.length;b++)a.zi[b].resetSensor();break;default:x.error("reset_device() is undefined for device: ",a.type)}};a.Zi=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:Q.copy(ca.En,c);if(a.Zf)c[0]=a.orientation[0],c[1]=
a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.zi)for(b=0;b<a.zi.length;b++){var d=a.zi[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,c[2]=d.orientation.z,c[3]=d.orientation.w)}ka.normalize(c,c);a=ka.setAxisAngle(ca.Gg,Math.PI/2,Y);ka.multiply(a,c,c);break a;default:x.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:Q.copy(ca.Dz,c);if(a.Zf)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.zi)for(b=0;b<a.zi.length;b++)d=a.zi[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);break a;default:x.error("position is undefined for device: ",a.type)}return c;case 21:return p(a,"left",c);case 22:return p(a,"right",c);case 30:case 31:return c[0]=a.Bw[0],c[1]=a.Bw[1],c}};a.um=m;a.AD=function(a,b,c){switch(a.type){case 20:if(3===m(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.aj=c;l(a);break;case 25:a.Rj=c;l(a);break;case 26:a.Qk=c;l(a);break;case 27:a.wn=c;l(a);break;case 28:a.ok=c;l(a);break;case 29:a.Sj=c,l(a)}break;case 60:case 70:case 80:case 90:a.qv[b]=c}};a.DV=function(a,b){var c=b-300;return c<a.lm.length?a.lm[a.qv[c]-300]:!1};a.CV=function(a,b){return b-326<a.jk.length?a.jk[a.qv[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],c=0;c<la.length;c++){var d=la[c];switch(d.type){case 60:e(d);n(b[0],d);break;case 70:e(d);n(b[1],d);break;case 80:e(d);n(b[2],d);break;case 90:e(d);n(b[3],d);break;case 20:f(d,a)}}};a.zd=function(a,b,c){switch(b){case 120:a.wg.push(c);b=131;break;case 130:a.ph.push(c);b=131;break;case 40:a.fj.push(c);break;case 30:case 31:a.ee.push(c);break;case 50:a.gj.push(c);break;case 60:a.hj.push(c);break;case 80:a.cs.push(c);break;case 81:a.jK.push(c);b=80;break;case 70:a.bj.push(c);
break;case 90:a.Cj.push(c);break;case 100:a.Bj.push(c);break;case 110:a.Aj.push(c)}if(-1==a.Xb.indexOf(b)&&(a.Xb.push(b),a.uh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",C,!1);break;case 30:a.element.addEventListener("mousemove",H,!1);break;case 31:a.element.addEventListener("mousemove",I,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",h,!1),a.element.addEventListener("mouseup",
k,!1));break;case 60:a.element.addEventListener("wheel",J,!1);break;case 80:a.element.addEventListener("keydown",y,!1);break;case 70:a.element.addEventListener("keyup",d,!1);break;case 90:a.element.addEventListener("touchstart",B,!1);break;case 100:a.element.addEventListener("touchmove",u,!1);break;case 110:a.element.addEventListener("touchend",ba,!1);break;case 131:a.element.addEventListener("deviceorientation",A,!1)}};a.Cd=function(a,b,c){E(a,b,c,!1)};a.VV=F;a.ua=function(){for(var a=0;a<la.length;a++)for(var b=
la[a],c=0;c<b.Xb.length;c++)E(b,b.Xb[c],null,!0);la.length=0};a.iJ=function(a){a=b(K(a));for(var c=0;c<a.lm.length;c++)if(a.lm[c])return c+300;return-1};a.cJ=function(a){a=b(K(a));for(var c=0;c<a.jk.length;c++)if(a.vI[c]-a.jk[c])return c+326;return-1};a.WI=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.EJ=function(){var a=b(20);return a&&a.Zf};a.EQ=function(a){a.element.addEventListener("mousedown",
function(){a.value||G(a)},!1)}};b4w.module.__prerender=function(a,g){function q(a,c){var f=a.kf;f.Hm=!1;if(f.$h)return!1;var g=c.p,q=c.type==l.bd?g.pw:r.jc(g.n,n);if("STATIC"==f.type&&f.uo)var A=f.ks,w=f.ls;else A=f.kb.F,w=f.kb.Xa;var H=f.kh,I=f.jf,q=m.dist(A,q);if(!(q<H?0:I==t.$p||q<I+f.lh*w))return!1;f.Hm=!0;I=a.za;if(c.type==l.zf)return c.debug_view_mode==b.Ft?I.Ri:!I.Ri;if(c.type==l.Kg&&0==f.qh)return!1;f.zp?(w=I.kb,H=I.pb,f=I.Yf):(w=f.kb,H=f.pb,f=f.Yf);if(I=!I.ck)g=g.Wh,I=w.F,p.QZ(I,g,w.Xa)?I=!0:f?(I=H.F,I=p.lU(I,g,H.Ga,H.Ha,
H.Ia)):I=!1;return I?!1:!0}function c(a){var b=a.gb;if(b&&b.IK){a=a.Ca;w.kX(a);var c=a.jd,f=c.a_position.offset;w.TN(a.tc,"a_position",b.bD,f);f=c.a_tbn_quat.offset;w.TN(a.tc,"a_tbn_quat",b.jE,f);w.CN(a)}}g("__config");var b=g("__debug"),w=g("__geometry"),t=g("__obj_util"),D=g("__renderer"),l=g("__subscene"),r=g("__tsr"),p=g("__util"),m=g("__vec3"),f=[l.Pb,l.Oc,l.Pd,l.ld,l.Af,l.Se,l.je,l.$f,l.bd,l.Bf,l.Kg,l.zf,l.xf,l.Ai],n=new Float32Array(3);a.Ww=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,
m=a.type==l.ld||a.type==l.Se,g=a.Qa,n=0;n<g.length;n++){for(var p=g[n],r=p.sa,t=!1,I=0;I<r.length;I++){var C=r[I],h=C.za;if(m)for(var k=0;6>k;k++)a.p.Wh=a.hr[k],C.gB[k]=q(C,a),C.gB[k]&&(t=b=!0,c(h));else C.dc=q(C,a),C.dc&&(t=b=!0,c(h));a.Ba&&(h.zb.ps=!0)}p.dc=t}a.Ba=!1;switch(a.type){case l.zf:break;default:a.type==l.Pb||a.type==l.Bf||a.type==l.je||a.type==l.Pd||a.type==l.ld||b?a.dc=!0:(a.dc&&D.clear(a),a.dc=!1)}}else if(a.Ba){g=a.Qa;for(n=0;n<g.length;n++)for(r=g[n].sa,I=0;I<r.length;I++)C=r[I],
h=C.za,h.zb.ps=!0;a.Ba=!1}a.HC&&l.JZ(a)}};b4w.module.__geometry=function(a,g){function q(){return{length:0,frames:1,Ic:0,kn:0,offset:0,qr:0}}function c(a,b){for(var c=b.a_tbn_quat,d=b.a_position,e=c.length,f=d.length,h=1;h<a.ib.length;h++)for(var k=a.ib[h].Jf,m=a.ib[h].Ur,k=k.a_position,g=0;g<f;g++)d[g]+=m*k[g];d=V;for(h=0;h<e;h+=4){f=c.subarray(h,h+4);d.set(W.En);for(g=1;g<a.ib.length;g++)k=a.ib[g].Jf,m=a.ib[g].Ur,m=ca.slerp(W.En,k.a_tbn_quat,m,ta),ca.normalize(m,m),ca.multiply(m,d,d);ca.multiply(d,f,f)}}function b(a){return 65536<a.Ja?
x.TI()?!1:!0:!1}function w(a){return 0<a.ma.length?!0:!1}function t(a,b,c){if(!w(a))return a;c||ka.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ja*(b||1)+", will use drawArrays","color: #aa0");b=a.ma;c=a.Ja;var d=a.qa,e=a.aa,f;for(f in d){var h=d[f],k=O(h,c);d[f]=D(b,h,k)}for(d=0;d<e.length;d++){var m=e[d];for(f in m)h=m[f],k=O(h,c),m[f]=D(b,h,k)}for(d=0;d<a.ib.length;d++){f=a.ib[d].Jf;for(var g in f)h=f[g],k=O(h,c),f[g]=D(b,h,k)}a.Ja=b.length;a.ma=new Uint16Array(0);return a}
function D(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),e=0;e<a.length;e++)for(var f=a[e],h=0;h<c;h++)d[c*e+h]=b[c*f+h];return d}function l(){return{oe:null,tc:d(),vm:0,count:0,jd:{},nn:0,Vn:0,Xn:0,Nd:[],ng:null,ib:null,zm:1,dg:!0}}function r(a,b){var c=a.jd[b];if(c){var d=T(b);return K(a.tc,d).subarray(c.offset,c.offset+c.length)}W.q("extract_array() failed; invalid name: "+b)}function p(b,c){var d;switch(c){case a.An:case a.Np:d=S.STATIC_DRAW;break;case a.Et:d=
S.DYNAMIC_DRAW;break;default:W.q("Wrong draw_mode")}b.nn=d}function m(a,b,c){function d(a,b){e[a]||(e[a]=0);e[a]+=b}var e={},f;for(f in a[0]){var h=a[0][f],k=T(f);d(k,h.length*a.length)}for(f in b)h=b[f],k=T(f),d(k,h.length);if(c){a=c.vp.length;k=T("a_part_ts");d(k,4*a);k=T("a_part_r");d(k,4*a);b=c.Vm;for(f in b)k=T(f),d(k,b[f].Ic*a);c=c.et;for(f in c)k=T(f),d(k,a)}return e}function f(a){a.oe?(a.ng||(a.ng=S.createBuffer()),S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.ng),S.bufferData(S.ELEMENT_ARRAY_BUFFER,
a.oe,a.nn),a.Vn=a.oe.byteLength):a.Vn=0;for(var b=a.Xn=0;b<a.tc.length;b++){var c=a.tc[b].type,d=u(a.Nd,c);-1==d&&(a.Nd.push({ml:null,type:c,VT:W.z_()}),d=a.Nd.length-1);c=a.Nd[d];c.ml||(c.ml=S.createBuffer());S.bindBuffer(S.ARRAY_BUFFER,c.ml);S.bufferData(S.ARRAY_BUFFER,a.tc[b].wi,a.nn);a.Xn+=a.tc[b].wi.byteLength}}function n(a,b){a.S=X.Nl(a.S,b);a.ba=X.Dq(a.ba,b);a.wa=X.Eq(a.wa,b);a.Ad=X.$z(a.Ad,b)}function e(a){for(var b=a[0],c=a[0],d=y("JOIN_"+a.length+"_SUBMESHES"),e=0,f=0;f<a.length;f++)e+=
a[f].ma.length;d.ma=new Uint32Array(e);var h=e=0;if(0<a[0].ib.length)for(var k=0;k<a[0].ib.length;k++){for(f=0;f<a.length;f++)e+=a[f].ib[k].Jf.a_position.length,h+=a[f].ib[k].Jf.a_tbn_quat.length;f={a_position:new Float32Array(e),a_tbn_quat:new Float32Array(h)};d.ib.push({Ur:a[0].ib[k].Ur,Jf:f})}for(f=e=0;f<a.length;f++)e+=a[f].Ja;d.Ja=e;for(var m in c.qa){for(f=e=0;f<a.length;f++)e+=a[f].qa[m].length;d.qa[m]=new Float32Array(e)}for(m in c.aa[0]){for(f=e=0;f<a.length;f++)e+=a[f].aa[0][m].length;for(f=
0;f<c.aa.length;f++)d.aa[f]=d.aa[f]||{},d.aa[f][m]=new Float32Array(e)}f=d.Vf;f.S=X.Ql(b.Vf.S);h=e=0;k=[];for(c=0;c<a.length;c++){var g=a[c],n=g.ma,v=g.Ja,p=g.qa;m=g.Vf.wa;X.kB(f.S,g.Vf.S);X.tU(f.wa,m);X.oB(g.Vf.Ad,k);for(m=0;m<n.length;m++)d.ma[e+m]=n[m]+h;var e=e+n.length,l;for(l in p){var n=p[l],u=h*O(n,v);d.qa[l].set(n,u)}for(m=0;m<g.aa.length;m++){var p=g.aa[m],x=d.aa[m];for(l in p)n=p[l],u=h*O(n,v),x[l].set(n,u)}h+=v}f.ba=X.Nu(W.Hf(k),!0);if(0<d.ib.length)for(c=0;c<d.ib.length;c++)for(l=d.ib[c].Jf,
m=e=f=0;m<a.length;m++)h=a[m].ib[c].Jf,l.a_position.set(h.a_position,f),l.a_tbn_quat.set(h.a_tbn_quat,e),f+=h.a_position.length,e+=h.a_tbn_quat.length;a[0].Of&&(d.Of={vp:b.Of.vp,Lx:b.Of.Lx,QM:!0,et:b.Of.et,Vm:b.Of.Vm,dv:b.Of.dv});return d}function z(a,b,c){b=b.Vf;for(var d=X.Sd(),e=X.Pu(),f=[],h=0;h<c.length;h++)X.Nl(a.Vf.S,c[h],d),X.kB(b.S,d),X.$z(a.Vf.Ad,c[h],e),X.oB(e,f);b.ba=X.Nu(W.Hf(f),!0);b.Ad=X.NS(b.ba);b.wa=X.br(b.ba)}function M(a,b,c,d,e,f){var k=a.submeshes[b],m=k.base_length,g=y("SUBMESH_"+
a.name+"_"+a.materials[b].name);g.Ja=m;var n=!1;if(F(c,"a_texcoord")){var v=null,p=a.materials[b];b=a.submeshes[b];if(p.texture_slots.length)switch(p=p.texture_slots[0],p.texture_coords){case "UV":p=a.uv_textures.indexOf(p.uv_layer);0==p?v=new Float32Array(b.texcoord):1==p&&(v=new Float32Array(b.texcoord2));break;case "ORCO":for(var l=a.b4w_boundings.bb_src,v=new Float32Array(2*b.base_length),p=(l.max_x+l.min_x)/2,u=(l.max_y+l.min_y)/2,x=l.max_x-l.min_x,l=l.max_y-l.min_y,q=0,r=0;r<b.position.length;r+=
3)v[q++]=(b.position[r]-p)/x+.5,v[q++]=(b.position[r+1]-u)/l+.5}null===v&&(v=new Float32Array(2*b.base_length));b=v}else b=new Float32Array(0);if(F(c,"a_orco_tex_coord")){v=a.b4w_boundings.bb_src;p=new Float32Array(3*k.base_length);u=v.max_x-v.min_x;x=v.max_y-v.min_y;l=v.max_z-v.min_z;for(r=q=0;r<k.position.length;r+=3)0==u?p[q++]=.5:p[q++]=W.V(parseFloat(((k.position[r]-v.min_x)/u).toFixed(5)),0,1),0==x?p[q++]=.5:p[q++]=W.V(parseFloat(((k.position[r+1]-v.min_y)/x).toFixed(5)),0,1),0==l?p[q++]=.5:
p[q++]=W.V(parseFloat(((k.position[r+2]-v.min_z)/l).toFixed(5)),0,1);v=p}else v=new Float32Array(0);p=k.group;if(F(c,"a_influence")&&d){u=new Float32Array(4*m);x=p.length/m;l=new Float32Array(x);for(q=0;q<x;q++){l[q]=-1;for(var B in d)if(r=d[B],r.ZN===q){l[q]=r.ZA;break}}var Q=3<x?x:4;d=new Float32Array(Q);B=new Uint32Array(Q);for(var q=new Float32Array(4),r=new Float32Array(Q),Q=new Uint32Array(Q),J=new Float32Array(4),ca=0;ca<m;ca++)d.set(r),B.set(Q),q.set(J),u.set(A(p,x,ca,m,l,d,B,q),4*ca)}else u=
new Float32Array(0);d=u;e=e?W.T(e):{};e.a_color={om:!0};e.a_color.src=F(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,pg:7}]:[];g.qa.a_texcoord=b;g.qa.a_influence=d;g.qa.a_orco_tex_coord=v;d=g.qa;B=k.vertex_colors;b=k.color;v=a.name;p=[];for(u=0;u<B.length;u++)p.push(B[u].name);for(var Z in e)if(u=e[Z].src,u.length){for(l=x=0;l<u.length;l++)x+=W.Zm(u[l].pg);d[Z]=new Float32Array(x*m);for(l=q=0;l<u.length;l++){var C=u[l].name,r=u[l].pg,Q=W.CL(r),z=p.indexOf(C);-1==z&&W.q('vertex color "'+
C+'" for mesh "'+v+'" not found.');J=B[z].mask;ca=W.Zm(J);(r&J)!==r&&ka.error("Wrong color extraction from "+C+" to "+Z+".");for(var I=C=0;I<z;I++)C+=W.Zm(B[I].mask);z=C*m;for(C=0;C<m;C++)for(I=0;3>I;I++)Q[I]&&(d[Z][C*x+(q+W.To(r,I))]=b[z+C*ca+W.To(J,I)]);q+=ca}}else d[Z]=new Float32Array(0);Z=a.uv_textures;e=k.texcoord;d=k.texcoord2;B=g.qa;if(f)for(var G in f){b=Z.indexOf(G);if(0==b)var V=new Float32Array(e);else 1==b&&(V=new Float32Array(d));B[f[G]]=V}g.ma=new Uint32Array(k.indices);G=k.position.length/
m/3;V=F(c,"a_tbn_quat")&&k.tbn_quat.length?!0:!1;Z=F(c,"a_shade_tangs")&&k.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(n=!0);for(e=0;e<G;e++){f=E(k,m,V,Z,e);if(n)if(d={},d.name=a.b4w_shape_keys[e].name,g.ib.push(d),0!=e){d.Jf=f;d.Ur=a.b4w_shape_keys[e].value;continue}else d.Jf=E(k,m,V,Z,e),d.Ur=1;g.aa.push(f)}if(1<G&&!n){a=g.aa[0];f={};for(var S in a)f[S]=new Float32Array(a[S]);g.aa.push(f)}F(c,"a_polyindex")&&(t(g,1,!0),g.qa.a_polyindex=h(g));k=k.boundings;c=g.Vf;c.S=X.Sd();c.S.max_x=k.bb.max_x;
c.S.max_y=k.bb.max_y;c.S.max_z=k.bb.max_z;c.S.min_x=k.bb.min_x;c.S.min_y=k.bb.min_y;c.S.min_z=k.bb.min_z;S=k.rbb;a=k.caxis_x;m=k.caxis_y;n=k.caxis_z;f=k.be_ax;c.ba=X.zq(a,m,n,k.be_cen);ha.scale(c.ba.Ga,f[0],c.ba.Ga);ha.scale(c.ba.Ha,f[1],c.ba.Ha);ha.scale(c.ba.Ia,f[2],c.ba.Ia);c.wa=X.br(c.ba);ha.copy(S.rbb_c,c.Ad.F);ha.copy(a,c.Ad.Ga);ha.copy(m,c.Ad.Ha);ha.copy(n,c.Ad.Ia);k=S.rbb_s;ha.scale(c.Ad.Ga,k[0],c.Ad.Ga);ha.scale(c.Ad.Ha,k[1],c.Ad.Ha);ha.scale(c.Ad.Ia,k[2],c.Ad.Ia);return g}function E(a,b,
c,d,e){var f={},h=new Float32Array(3*b),k=new Float32Array(c?4*b:0),m=e*b*3;h.set(a.position.subarray(m,m+3*b),0);c&&(m=e*b*4,k.set(a.tbn_quat.subarray(m,m+4*b),0));d&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),f.a_shade_tangs=c);f.a_position=h;f.a_tbn_quat=k;return f}function F(a,b){return-1<a.indexOf(b)?!0:!1}function A(b,c,d,e,f,h,k,m){for(var g=!0,n=0;n<c;n++){var v=b[n*e+d];if(-1!==v){var p=f[n];-1!==p&&(h[n]=v,k[n]=p,g=!1)}}if(g)return m;H(h,k,a.Az,!1);for(n=b=0;4>n;n++)b+=
h[n];if(.01>b)return m;for(n=0;4>n;n++)h[n]/=b;if(.01>Math.abs(h[0]-1))m[0]=k[0]+1;else for(n=0;4>n;n++)m[n]=k[n]+h[n];return m}function O(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&W.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function H(b,c,d,e){for(var f=b.length,h=f,k=!1,m=e?-1:1;1<h||k;){1<h&&(h=Math.floor(h/1.247330950103979));for(var k=!1,g=0;h+g<f;g++)if(d==a.Az?0>m*(b[g]-b[g+h]):b[g]<b[g+h]&&e)k=b[g],b[g]=b[g+h],b[g+
h]=k,k=c[g],c[g]=c[g+h],c[g+h]=k,k=!0}}function I(a,b,c){var d=[],e=[];ha.subtract(b,a,d);ha.subtract(c,a,e);ha.normalize(d,d);ha.normalize(e,e);a=W.V(ha.dot(d,e),-1,1);return Math.acos(a)}function C(a,b,c){if(w(b)){b=b.ma;for(var d=b.length/3,e=0;e<d;e++){var f=new Float32Array(9),h=b[3*e];f[0]=a[3*h];f[1]=a[3*h+1];f[2]=a[3*h+2];h=b[3*e+1];f[3]=a[3*h];f[4]=a[3*h+1];f[5]=a[3*h+2];h=b[3*e+2];f[6]=a[3*h];f[7]=a[3*h+1];f[8]=a[3*h+2];c[e]=f}}else for(e=0;e<a.length;e++)f=new Float32Array(9),f[0]=a[9*
e],f[1]=a[9*e+1],f[2]=a[9*e+2],f[3]=a[9*e+3],f[4]=a[9*e+4],f[5]=a[9*e+5],f[6]=a[9*e+6],f[7]=a[9*e+7],f[8]=a[9*e+8],c[e]=f;return c}function h(a){for(var b=new Float32Array(a.Ja),c=0;c<a.Ja;c++)b[c]=c%3/2;return b}function k(a,b,c){var d=ha.dist(a,b);a=ha.dist(a,c);b=ha.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function J(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function y(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ja:0,ma:null,aa:[],qa:b,ib:[],Vf:{S:X.Sd(),ba:X.Tg(),wa:X.Rh(),Ad:X.Pu()},Of:null}}function d(a){var b=[],c;for(c in a)b.push(B(c,a[c]));return b}function B(a,b){return{wi:new (G(a))(b),type:a}}function u(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function ba(a,b){var c=u(a,b);return-1==c?null:a[c].ml}function K(a,b){var c=u(a,b);return-1==c?null:a[c].wi}function G(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function T(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function P(a,
b,c,d){var e=T(b);b=u(a,e);switch(e){case "float":a[b].wi.set(c,d);break;case "short":for(e=0;e<c.length;e++)a[b].wi[d+e]=W.xr(c[e]);break;case "unsigned_byte":for(e=0;e<c.length;e++)a[b].wi[d+e]=W.x_(c[e])}}var X=g("__boundings"),x=g("__extensions"),ka=g("__print"),ca=g("__quat"),Q=g("__tsr"),W=g("__util"),ha=g("__vec3");new Float32Array(2);var v=new Float32Array(3),Z=new Float32Array(3),Y=new Float32Array(3),V=new Float32Array(4),ta=new Float32Array(4),oa=new Float32Array(8);a.Np=10;a.Et=20;a.Az=
0;a.w2=1;a.An=a.Np;var S=null;a.rQ="float";a.z2="short";a.A2="unsigned_byte";a.Tf=function(a){S=a};a.YM=function(a,e,h){b(a)&&t(a);var k=a.ma,g=a.Ja,n=a.aa,v={},u;for(u in a.qa)u in h&&!h[u].om||(v[u]=a.qa[u]);h=l();0<a.ib.length&&c(a,n[0]);u=a.Of;if(k.length){var x=k.length;if(65536>=g)var k=new Uint16Array(k),r=S.UNSIGNED_SHORT;else k=new Uint32Array(k),r=S.UNSIGNED_INT}else x=g,k=null;for(var B=m(n,v,u),B=d(B),J={},y=0;y<B.length;y++)J[B[y].type]=0;var ca={},Z;for(Z in v){var C=v[Z],z=C.length;
if(z){var I=T(Z),y=ca[Z]=q();y.length=z;y.Ic=O(C,g);y.offset=J[I];P(B,Z,C,J[I]);J[I]+=z}}v=n.length;for(Z in n[0])if(C=n[0][Z],I=T(Z),z=C.length,C=O(C,g),z)for(y=ca[Z]=q(),y.length=z,y.frames=v,y.Ic=C,y.offset=J[I],1<v&&(y=ca[Z+"_next"]=q(),y.length=z,y.frames=v,y.Ic=C,y.offset=J[I]+z),y=0;y<v;y++)C=n[y][Z],I=T(Z),P(B,Z,C,J[I]),J[I]+=z;if(u){n=u.vp;Z=u.Lx;v=u.Vm;z=u.et;n=u.vp;Z=u.Lx;var v=u.Vm,z=u.et,I=u.QM,g={a_part_ts:{data:[],Ic:4},a_part_r:{data:[],Ic:4}},G;for(G in v)g[G]={data:[],Ic:v[G].Ic};
for(G in z)g[G]={data:[],Ic:1};for(C=0;C<n.length;C++){y=n[C];I&&Z&&!u.dv&&(y=Q.multiply(Z,n[C],oa));!I&&u.dv&&ha.subtract(n[C],Z,n[C]);g.a_part_ts.data.push(y[0],y[1],y[2],y[3]);g.a_part_r.data.push(y[4],y[5],y[6],y[7]);for(G in v)for(var y=v[G].Ic,V=0;V<y;V++)g[G].data.push(v[G].data[C*y+V]);for(G in z)g[G].data.push(z[G][0])}for(G in g)n=T(G),P(B,G,g[G].data,J[n]),Z=q(),Z.Ic=g[G].Ic,Z.offset=J[n],Z.qr=1,Z.length=g[G].data.length,ca[G]=Z,J[n]+=Z.length;h.zm=u.vp.length}h.count=x;h.oe=k;h.tc=B;h.vm=
r;h.jd=ca;p(h,e);f(h);h.ib=a.ib;return h};a.b_=c;a.zW=b;a.yW=w;a.Ox=t;a.M_=function(a,b,c){p(a,b);a.count=c.length;a.oe=c;a.vm=c instanceof Uint16Array?S.UNSIGNED_SHORT:S.UNSIGNED_INT};a.L_=function(a,b){var c=a.jd,d=c.a_p_data,e=T("a_p_data");if(d)3!=d.Ic&&W.q('invalid num_comp for "a_p_data"'),P(a.tc,"a_p_data",b,d.offset);else{d=u(a.tc,e);-1==d&&(a.tc.push(B(e,0)),d=a.tc.length-1);var e=a.tc[d].wi,h=new e.constructor(e.length+b.length);h.set(e);a.tc[d].wi=h;P(a.tc,"a_p_data",b,e.length);c=c.a_p_data=
q();c.Ic=3;c.offset=e.length;c.length=b.length}f(a)};a.L4=r;a.T7=function(a){a.nn=S.STATIC_DRAW};a.kX=function(a){a.nn=S.DYNAMIC_DRAW};a.CN=f;a.yS=function(a){a.ng&&S.deleteBuffer(a.ng);for(var b=0;b<a.Nd.length;b++)a.Nd[b].ml&&S.deleteBuffer(a.Nd[b].ml);a.Nd.length=0};a.LJ=function(a,b){return a.submeshes[b].base_length?!1:!0};a.Nx=function(a,b){for(var c=0;c<a.aa.length;c++){var d=a.aa[c].a_position;Q.tp(d,b,d,0);d=a.aa[c].a_tbn_quat;0<d.length&&Q.uN(d,b,d,0);(d=a.aa[c].a_shade_tangs)&&0<d.length&&
Q.s_(d,b,d)}(c=a.qa.au_center_pos)&&c.length&&Q.tp(c,b,c,0);n(a.Vf,b)};a.a_=function(a,b){var c=a.qa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);Q.tp(d,b,d,0);for(var e=0;e<a.aa.length;e++)for(var f=0;f<d.length;f++)a.aa[e].a_position[f]+=d[f]-c[f];c.set(d)}else W.q('Attribute "au_center_pos" is missing in particle submesh');n(a.Vf,b)};a.ER=n;a.$Z=function(a,b){var c=a.Ja,d;for(d in b){var e=b[d].length;a.qa[d]=new Float32Array(e*c);for(var f=0;f<c;f++)for(var h=0;h<e;h++)a.qa[d][f*e+
h]=b[d][h]}};a.XM=e;a.jX=function(a,b,c){if(!a.Ja)return y("EMPTY");var d=c.length;65536<a.Ja*d&&!x.TI()&&t(a,d);var e=a.ma,f=a.Ja,h=a.qa,k=a.aa,g;for(g in b){var m=b[g].length,n=m*f;h[g]=new Float32Array(n);for(var v=0;v<f;v++)for(n=0;n<m;n++)h[g][v*m+n]=b[g][n]}b=y("CLONE_"+d+"_SUBMESHES");b.Ja=f*d;b.ma=new Uint32Array(e.length*d);for(v=0;v<d;v++)for(m=e.length*v,g=f*v,n=0;n<e.length;n++)b.ma[m+n]=e[n]+g;for(var p in h)for(e=h[p],n=e.length*d,m=O(e,f),b.qa[p]=new Float32Array(n),v=0;v<d;v++)g=f*
m*v,b.qa[p].set(e,g);for(p in k[0])for(v=0;v<k.length;v++)for(e=k[v][p],n=e.length*d,m=O(e,f),b.aa[v]=b.aa[v]||{},b.aa[v][p]=new Float32Array(n),n=0;n<d;n++)switch(h=c[n],g=f*m*n,p){case "a_position":Q.tp(e,h,b.aa[v][p],g);break;case "a_tbn_quat":Q.uN(e,h,b.aa[v][p],g);break;case "a_shade_tangs":Q.v_(e,h,b.aa[v][p],g);break;default:W.q("Wrong attribute name: "+p)}z(a,b,c);return b};a.PG=z;a.pB=M;a.yU=function(a){var b=a.Ja,c=a.aa[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.ma.length);
for(var e=new Float32Array(4*b),f=0;f<b;f++){d[12*f]=c[3*f];d[12*f+1]=c[3*f+1];d[12*f+2]=c[3*f+2];d[12*f+3]=c[3*f];d[12*f+4]=c[3*f+1];d[12*f+5]=c[3*f+2];d[12*f+6]=c[3*f];d[12*f+7]=c[3*f+1];d[12*f+8]=c[3*f+2];d[12*f+9]=c[3*f];d[12*f+10]=c[3*f+1];d[12*f+11]=c[3*f+2];a[6*f]=4*f+2;a[6*f+1]=4*f+1;a[6*f+2]=4*f;a[6*f+3]=4*f+2;a[6*f+4]=4*f;a[6*f+5]=4*f+3;var h=Math.random();e[4*f]=h;e[4*f+1]=h;e[4*f+2]=h;e[4*f+3]=h}c=y("HALO");c.aa[0]={};c.Ja=4*b;c.aa[0].a_position=d;c.qa.a_halo_bb_vertex=J(b);c.qa.a_random_vals=
e;c.ma=a;return c};a.WV=F;a.lI=function(a,b,c){for(var d=[],f=0;f<a.submeshes.length;f++){var h=M(a,f,b,null,c,null);h.Ja&&d.push(h)}return 0==d.length?y("EMPTY"):1==d.length?d[0]:e(d)};a.K_=function(a,b,c,d){var e=a.oe,f=r(a,"a_position"),h=b.uX,k=b.vX;b=b.dU;for(var g=e,m=g.length/3,n=0;n<m;n++){var v=g[3*n],p=g[3*n+1],l=g[3*n+2],u=f[3*v+1],x=f[3*v+2],q=f[3*p+1],B=f[3*p+2],J=f[3*l+1],y=f[3*l+2];h[3*n]=(f[3*v]+f[3*p]+f[3*l])/3;h[3*n+1]=(u+q+J)/3;h[3*n+2]=(x+B+y)/3}Q.tp(h,c,k);c=k.length/3;for(f=
0;f<c;f++)h=k[3*f]-d[0],g=k[3*f+1]-d[1],m=k[3*f+2]-d[2],b[f]=h*h+g*g+m*m;d=e;e=b.length;if(!(2>e))for(k=e,f=!1;1<k||f;)for(1<k&&(k=Math.floor(k/1.247330950103979)),f=!1,c=0;k+c<e;c++)0>b[c]-b[c+k]&&(f=b[c],b[c]=b[c+k],b[c+k]=f,f=d,h=c,g=c+k,m=f[3*h],n=f[3*h+1],v=f[3*h+2],f[3*h]=f[3*g],f[3*h+1]=f[3*g+1],f[3*h+2]=f[3*g+2],f[3*g]=m,f[3*g+1]=n,f[3*g+2]=v,f=!0);e=d;S.bindBuffer(S.ELEMENT_ARRAY_BUFFER,a.ng);S.bufferData(S.ELEMENT_ARRAY_BUFFER,e,S.DYNAMIC_DRAW)};a.LZ=H;a.PR=function(a,b,c){for(var d=b.length/
3,e=a.length/3,f=[],h=Array(3),k=Array(3),g=Array(3),m=0;m<e;m++){for(var n=a[3*m],v=a[3*m+1],p=a[3*m+2],l=0;3>l;l++)h[l]=b[3*n+l],k[l]=b[3*v+l],g[l]=b[3*p+l];if(c)var l=I(h,k,g),u=I(k,g,h),x=Math.PI-l-u;else x=u=l=1;var q=f,r;r=h;var B=g,J=[],Q=[],y=[];ha.subtract(k,r,J);ha.subtract(B,r,Q);ha.cross(J,Q,y);ha.normalize(y,y);r=y;for(B=0;3>B;B++)J=3*v+B,Q=3*p+B,q[3*n+B]=l*r[B],q[J]=u*r[B],q[Q]=x*r[B]}if(c)for(var t in c)for(m=c[t],a=0;3>a;a++){b=3*m[0]+a;for(e=1;e<m.length;e++)h=3*m[e]+a,f[b]+=f[h];
for(e=1;e<m.length;e++)h=3*m[e]+a,f[h]=f[b]}for(m=0;m<d;m++){c=m;t=f;a=new Float32Array(3);for(b=0;3>b;b++)e=3*c+b,a[b]=t[e];ha.normalize(a,a);for(b=0;3>b;b++)e=3*c+b,t[e]=a[b]}return f};a.SR=function(a,b,c){for(var d={},e=b.length/3,f=0;f<e;f++){var h=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);d[h]=[]}e=a.length;for(f=0;f<e;f++)b=a[f],h=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),h in d&&d[h].push(b);return d};a.vB=function(a,b,c,d){var e;e=null;e=[];e=C(a.aa[0].a_position,a,e);if(c){var f;
f=null;f=[];for(var h=a.aa[0].a_tbn_quat,g=h.length/4,m=new Float32Array(3*g),n=0;n<g;n++){var p=V;p[0]=h[4*n];p[1]=h[4*n+1];p[2]=h[4*n+2];p[3]=h[4*n+3];p=ha.transformQuat(W.Eh,p,v);m[3*n]=p[0];m[3*n+1]=p[1];m[3*n+2]=p[2]}f=C(m,a,f)}g=e.length;m=new Float32Array(g);for(a=0;a<g;a++)n=e[a],v.set(n.subarray(0,3)),Z.set(n.subarray(3,6)),Y.set(n.subarray(6)),m[a]=Math.sqrt(k(v,Z,Y));h=new Float32Array(g);h[0]=m[0];for(a=1;a<g;a++)h[a]=h[a-1]+m[a];g=h[m.length-1];m=[];for(a=0;a<b;a++){var n=g*W.zg(d),n=
W.xu(h,n,0,h.length-1),l=n=c?f[n]:e[n],u=d;(n=v)||(n=new Float32Array(3));var p=l[0],x=l[1],q=l[2],r=l[3],B=l[4],J=l[5],Q=l[6],y=l[7],t=l[8],l=W.zg(u),u=W.zg(u);1<l+u&&(l=1-l,u=1-u);var z=1-l-u,x=z*x+l*B+u*y,q=z*q+l*J+u*t;n[0]=z*p+l*r+u*Q;n[1]=x;n[2]=q;c?(m[a]=new Float32Array(4),ha.normalize(n,n),n=ca.rotationTo(W.Eh,n,V),m[a][0]=n[0],m[a][1]=n[1],m[a][2]=n[2],m[a][3]=n[3]):(m[a]=new Float32Array(3),m[a][0]=n[0],m[a][1]=n[1],m[a][2]=n[2])}return m};a.iv=h;a.t$=k;a.wI=J;a.HL=function(a,b,c){a=a.aa[0].a_position;
for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.gR=function(a,b,c){var d=a.I[0].X;a=a.k.pi;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=c);for(e=0;e<d.length;e++)if(!d[e].kg&&d[e].Oe&&!d[e].Ri){b=d[e].Ca;var f=T("a_position");c=ba(b.Nd,f);f=K(b.tc,f);S.bindBuffer(S.ARRAY_BUFFER,c);var h=b.jd.a_position;c=d[e];var k=a;if(h){for(var m=h.offset,h=h.length+m,g=c.Ca.ib[0].Jf.a_position,n=m;n<h;n++)f[n]=g[n-m];for(n=1;n<c.Ca.ib.length;n++){var g=
c.Ca.ib[n].Jf.a_position,v=k[n].value;if(v)for(var p=m;p<h;p++)f[p]+=v*g[p-m]}S.bufferSubData(S.ARRAY_BUFFER,W.Jj*m,f.subarray(m))}f=T("a_tbn_quat");c=ba(b.Nd,f);f=K(b.tc,f);S.bindBuffer(S.ARRAY_BUFFER,c);m=b.jd.a_tbn_quat;b=d[e];c=f;f=a;if(m){k=m.offset;m=m.length+k;h=b.Ca.ib[0].Jf.a_tbn_quat;n=V;for(g=k;g<m;g+=4){n[0]=0;n[1]=0;n[2]=0;for(v=n[3]=1;v<b.Ca.ib.length;v++){var p=b.Ca.ib[v].Jf.a_tbn_quat,l=f[v].value;if(l){var u=ta;u[0]=p[g-k];u[1]=p[g+1-k];u[2]=p[g+2-k];u[3]=p[g+3-k];p=ca.slerp(W.En,
u,l,ta);ca.multiply(p,n,n)}}v=ta;v[0]=h[g-k];v[1]=h[g-k+1];v[2]=h[g-k+2];v[3]=h[g-k+3];p=0<v[3];ca.multiply(n,v,v);(0<v[3]&&!p||0>v[3]&&p)&&ca.scale(v,-1,v);c[g]=W.xr(v[0]);c[g+1]=W.xr(v[1]);c[g+2]=W.xr(v[2]);c[g+3]=W.xr(v[3])}S.bufferSubData(S.ARRAY_BUFFER,W.Jj*k,c.subarray(k))}}};a.rS=function(a){return a.k.Oe};a.x6=function(a){var b=[];if(a.k)for(var c=1;c<a.k.pi.length;c++)b.push(a.k.pi[c].name);return b};a.w6=function(a,b){if(a.k)for(var c=1;c<a.k.pi.length;c++)if(b==a.k.pi[c].name)return a.k.pi[c].value;
return 0};a.$V=function(a,b){var c=a.k.pi;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.Y6=function(a){return a&&a.k&&a.k.gg?!0:!1};a.r4=function(b,c,e){var h=b.Ca;if(h){for(var k=e?c.length/3/2:c.length/3-1,m=new Float32Array(12*k),g=new Float32Array(12*k),n=new Uint16Array(6*k),v=0;v<k;v++){if(e)var p=6*v,l=6*v+3;else p=3*v,l=3*(v+1);var u=c[p],x=c[p+1],p=c[p+2],q=c[l],r=c[l+1],l=c[l+2],B=q-u,J=r-x,Q=l-p;m[12*v]=u;m[12*v+1]=x;m[12*v+2]=p;g[12*v]=B;g[12*v+1]=J;g[12*v+2]=Q;
m[12*v+3]=q;m[12*v+4]=r;m[12*v+5]=l;g[12*v+3]=-B;g[12*v+4]=-J;g[12*v+5]=-Q;m[12*v+6]=u;m[12*v+7]=x;m[12*v+8]=p;g[12*v+6]=-B;g[12*v+7]=-J;g[12*v+8]=-Q;m[12*v+9]=q;m[12*v+10]=r;m[12*v+11]=l;g[12*v+9]=B;g[12*v+10]=J;g[12*v+11]=Q;n[6*v]=4*v;n[6*v+1]=4*v+1;n[6*v+2]=4*v+2;n[6*v+3]=4*v;n[6*v+4]=4*v+3;n[6*v+5]=4*v+1}e=0;for(var y in h.jd)c=h.jd[y],e+=m.length/3*c.Ic;c={};c["float"]=e;e=h.tc=d(c);a.M_(h,b.Th,n);b=0;for(y in h.jd)switch(c=h.jd[y],y){case "a_position":P(e,y,m,b);c.offset=b;c.length=m.length;
b+=c.length;break;case "a_direction":P(e,y,g,b);c.offset=b;c.length=g.length;b+=c.length;break;default:c.offset=b,c.length=m.length/3*c.Ic,n=new Float32Array(c.length),P(e,y,n,b),b+=c.length}f(h)}};a.ES=function(a){var b=l();if(a.oe)switch(a.vm){case S.UNSIGNED_SHORT:b.oe=new Uint16Array(a.oe);break;case S.UNSIGNED_INT:b.oe=new Uint32Array(a.oe)}else b.oe=null;for(var c=a.tc,d=[],e=0;e<c.length;e++){var f=c[e].wi,h=c[e].type;d.push({wi:new f.constructor(f),type:h})}b.tc=d;b.vm=a.vm;b.count=a.count;
b.jd=W.T(a.jd);b.nn=a.nn;b.Vn=a.Vn;b.Xn=a.Xn;b.ng=null;b.Zv=W.T(a.Zv);b.ib=W.T(a.ib);b.zm=a.zm;b.dg=a.dg;return b};a.Nf=y;a.reset=function(){S=null};a.t7=d;a.IY=u;a.H6=ba;a.Dv=K;a.s5=G;a.Or=T;a.yJ=function(a){switch(T(a)){case "float":return W.Jj;case "short":return W.fq;case "unsigned_byte":return W.xy;default:return W.Jj}};a.EV=function(a){switch(T(a)){case "float":return S.FLOAT;case "short":return S.SHORT;case "unsigned_byte":return S.UNSIGNED_BYTE;default:return S.FLOAT}};a.TN=P};b4w.module.__primitives=function(a,g){function q(a,b,c,g){for(var e=[],q=[],r=[],t=[],w=2*c/(a-1),A=2*g/(b-1),O=0;O<a;O++)for(var H=-c+O*w,I=0;I<b;I++)if(q.push(H,-g+I*A,0),t.push(0,0,0,1),r.push(O/(a-1),I/(b-1)),O&&I){var C=O*b+I,h=C-1,k=(O-1)*b+I,J=k-1;e.push(C,h,k);e.push(h,J,k)}a=l.Ug();a.a_position=new Float32Array(q);a.a_tbn_quat=new Float32Array(t);t=D.Nf("GRID_PLANE");t.aa[0]=a;t.qa.a_texcoord=new Float32Array(r);t.ma=new Uint32Array(e);t.Ja=q.length/3;return t}function c(a){var b=a.length;
b%4&&l.q("Wrong array");for(var c=[],g=[],e=0;e<b;e+=4){var q=a[e+1],r=a[e+2],t=a[e+3];w(a[e],g);w(q,g);w(r,g);w(t,g);c.push(e,e+1,e+2);c.push(e,e+2,e+3)}a=l.Ug();a.a_position=new Float32Array(g);b=D.Nf("FROM_QUADS");b.aa[0]=a;b.ma=new Uint32Array(c);b.Ja=g.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function w(a,b){b.push(a[0],a[1],a[2])}var t=g("__config"),D=g("__geometry");g("__print");var l=g("__util"),r=t.B;a.fV=function(){var a=D.Nf("LINE"),b=l.Ug();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.ma=new Uint32Array(1);a.Ja=1;return a};a.f5=function(a,b){var c=q(2,2,a,b);c.name="PLANE";return c};a.e5=q;a.ZU=function(a,b,c){function g(a,b){return 1==a%2&&(0==b||b==E-1)||1==b%2&&(0==a||a==t-1)?!0:!1}var e=c/=Math.pow(2,a-1),q=c,t=b+1,E=b+1;b=[];c=[];for(var w=[],A=0,O=0,H=-1,I=[],C=0;C<a;C++){for(var h=2*e/(t-1),k=2*q/(E-1),J=[],y=[],d=0,B=0;B<t;B++){for(var u=-e+B*h,ba=[],K=0;K<E;K++){var G=-q+K*k;if(u>-A&&u<A&&G>-O&&G<O)ba.push(-1),d++;else{for(var T=
null,P=0;P<I.length;P+=3)if(u==I[P]&&G==I[P+1]){T=I[P+2];break}P=null!==T?T:H+1;g(B,K)?(ba.push(-2),d++):(null==T&&(0==K||K==E-1||0==B||B==t-1?(T=C==a-1?h:2*h,J.push(u,G,P)):T=h,c.push(u,G,T),w.push(.707,0,0,.707),H++),ba.push(P));if(B&&K)if(1==B)if(g(B-1,K)){if(1<K){var G=P-1,T=y[B-1][K+1],X=T-1;b.push(X,G,P)}else T=y[B-1][K+1],X=T-1;b.push(T,X,P)}else g(B,K)||(G=P-1,T=y[B-1][K],b.push(T,G,P));else if(B==t-1){if(!g(B,K))if(K==E-1)G=P-1,T=y[B-1][K-1],X=y[B-2][K],b.push(T,G,P),b.push(X,T,P);else{var G=
P-1,T=y[B-1][K],X=T-1,x=T+1;b.push(X,G,P);b.push(T,X,P);b.push(x,T,P);2==K&&(x=y[B-2][K-2],b.push(X,x,G))}}else 1==K?g(B,K-1)?(G=y[B-1][K],T=y[B-1][K-1],b.push(G,T,P)):(G=ba[K-1],T=y[B-1][K],X=y[B-2][K-1],b.push(T,G,P),b.push(T,X,G)):K==E-1?g(B,K)||(G=ba[K-1],T=y[B-1][K-1],X=y[B-2][K],b.push(T,G,P),b.push(X,T,P)):-1!=y[B-1][K]&&-1!=y[B-1][K-1]&&-1!=ba[K-1]?(G=ba[K-1],T=y[B-1][K],X=y[B-1][K-1],b.push(T,G,P),b.push(T,X,G),K==E-2&&g(B,K+1)&&(x=y[B-1][K+1],b.push(x,T,P))):K==E-2&&g(B,K+1)&&(T=y[B-1][K],
x=y[B-1][K+1],b.push(x,T,P))}}y.push(ba)}I=J;A=e;O=q;e*=2;q*=2}if(2E4>A)for(a=-(2*A)/(t-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-A,-O,a),c.push(-A,O,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(A,-O,a),c.push(A,O,a),P=H+1,b.push(P+1,P+2,P+3,P+1,P+0,P+2,P+2,P+4,P+6,P+2,P+0,P+4,P+1,P+7,P+5,P+1,P+3,P+7,P+7,P+4,P+5,P+6,P+4,P+7),B=0;8>B;B++)w.push(.707,0,0,.707);a=l.Ug();a.a_position=new Float32Array(c);a.a_tbn_quat=new Float32Array(w);e=D.Nf("MULTIGRID_PLANE");e.aa[0]=a;e.ma=new Uint32Array(b);
e.Ja=c.length/3;r.eO&&(D.Ox(e,1,!0),a.a_polyindex=D.iv(e));return e};a.d5=function(a){var b=a.length;b%3&&l.q("Wrong array");for(var c=[],g=[],e=0;e<b;e+=3){var q=a[e+1],r=a[e+2];w(a[e],g);w(q,g);w(r,g);c.push(e,e+1,e+2)}a=l.Ug();a.a_position=new Float32Array(g);b=D.Nf("FROM_TRIANGLES");b.aa[0]=a;b.ma=new Uint32Array(c);b.Ja=g.length/3;return b};a.c5=c;a.cV=function(a){a=l.t0(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.Sc=function(){var a=D.Nf("FULLSCREEN_TRI"),b=l.Ug();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.ma=new Uint32Array([0,1,2]);a.Ja=3;return a};a.dV=function(){var a=D.Nf("FULLSCREEN_QUAD"),b=l.Ug();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.ma=new Uint32Array([0,2,1,1,2,3]);a.Ja=4;return a};a.YU=function(){var a=D.Nf("BILLBOARD"),b=l.Ug();b.a_bb_vertex=D.wI(1);a.aa[0]=b;a.ma=
new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.$U=function(){var a=D.Nf("CUBEMAP_BOARD"),b=l.Ug();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.ma=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.rv=function(a,c){var f=D.Nf("UV_SPHERE"),g,e,q=[],r=[],t=[];for(e=0;8>=e;e++)for(g=0;16>=g;g++){var F=g/16,A=e/8;r.push(-a*Math.cos(2*F*Math.PI)*Math.sin(A*Math.PI)+c[0],a*Math.cos(A*Math.PI)+c[1],a*Math.sin(2*F*Math.PI)*Math.sin(A*Math.PI)+c[2])}for(e=F=0;8>e;e++)for(g=0;16>g;g++){var A=
b(r,17*e+g+1),O=b(r,17*e+g),H=b(r,17*(e+1)+g),I=b(r,17*(e+1)+g+1);Math.abs(A[1])==a+c[1]?(w(A,q),w(H,q),w(I,q),t.push(F,F+1,F+2),F+=3):Math.abs(H[1])==a+c[1]?(w(A,q),w(O,q),w(H,q),t.push(F,F+1,F+2),F+=3):(w(A,q),w(O,q),w(H,q),w(I,q),t.push(F,F+1,F+2),t.push(F,F+2,F+3),F+=4)}g={};g.a_position=q;r=D.SR(t,r,q);r=D.PR(t,q,r);g.a_tbn_quat=l.Hr(r);f.aa[0]=g;f.ma=t;f.Ja=q.length/3;return f};a.AI=function(a){var b=D.Nf("INDEX"),c=l.Ug();c.a_index=new Float32Array(3*a);for(var g=new Uint16Array(3*a),e=0;e<
3*a;e++)c.a_index[e]=e,g[e]=e;b.aa[0]=c;b.ma=g;b.Ja=3*a;return b}};b4w.module.__scenegraph=function(a,g){function q(a,b){var c=[];u.Dg(a,function(b,d,e){-1<c.indexOf(e)?u.tY(a,b,d,e,O(e)):c.push(e)});u.pa(a,function(a,d){for(var e=0;e<d.Ya.length;e++){var f=d.Ya[e];b||d.type!=K.Pd&&d.type!=K.ld&&d.type!=K.$f||(f.rf=!0);-1<c.indexOf(f)?d.Ya[e]=O(f):c.push(f)}})}function c(a,c){u.pa(a,function(b,d){d.type==K.PE&&u.ui(a,b,function(a,b){if(b.type==K.Gh)for(var c=0;c<b.Ya.length;c++){var d=b.Ya[c];d.Na=G.L;d.Ma=G.L}});c||u.ui(a,b,function(a,b,c){"DEPTH"==c.from&&(c.rf=
!0)})});u.pa(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],h=0;h<c.length;h++)if(c[h].Na==G.L){f=c[h];break}for(var k=c[0],h=0;h<c.length;h++)if(c[h].Ma==G.L){k=c[h];break}for(var g=c[0],h=0;h<c.length;h++)if(!c[h].rf){g=c[h];break}for(h=0;h<c.length;h++)c[h].Na=f.Na,c[h].Ma=k.Ma,c[h].rf=g.rf}})}function b(a,c,d){u.ui(a,c,function(c,e,f){f.Gc&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&d[f.from].push(f),b(a,c,d))});u.fl(a,c,function(a,b,c){c.Gc&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=u.Va(a,c);if(c.type==K.Gh)for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];d[f.from].push(f)}}function w(a){var b=[K.Gh,K.zz,K.du,K.Pd,K.ld,K.cq],c=u.oE(a),d=[];u.pa(c,function(a,e){for(var f=0;f<e.Ya.length;f++){var h=e.Ya[f];-1<b.indexOf(e.type)&&(h.Wx=!0);var k=p(d,h,t(h));h.jb=k;e.ti[f]=k}for(f=0;f<e.ti.length;f++)k=e.ti[f],r(d,k);u.fl(c,a,function(f,h,k){-1<b.indexOf(e.type)&&(k.Wx=!0);k.jb||((f=D(c,a,k.from))&&k.Gc&&!k.jb?l(d,f):f=p(d,
k,t(k)),k.jb=f)});u.ui(c,a,function(a,b,c){r(d,c.jb)});u.fl(c,a,function(a,b,c){c.jb&&"NONE"==c.to&&r(d,c.jb)})})}function t(a){a=T.Ph(a);delete a.to;delete a.Gc;delete a.jb;return JSON.stringify(a)}function D(a,b,c){var d=null;u.ui(a,b,function(a,b,e){if(e.Gc&&e.from==e.to&&e.from==c&&e.jb)return d=e.jb,!0});u.fl(a,b,function(a,b,e){if(e.Gc&&e.from==c&&e.jb)return d=e.jb,!0});return d}function l(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.kE===b&&d.Is++}}function r(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.kE===b&&d.Is&&d.Is--}}function p(a,b,c){if(b.Jo)return l(a,b.Jo.jb),b.Jo.jb;if(b.Wx)return m(b);for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.Is){d=f;break}}if(d&&!X.nI)return d.Is++,d.kE;b=m(b);a.push({id:c,Is:1,kE:b});return b}function m(a){var b=a.dn*a.size,c=a.en*a.size;switch(a.from){case "COLOR":if(a.rf){var d=G.Yl(a.zk?G.iu:G.hu,a.lt);G.resize(d,b,c)}else d=G.Yl(G.Hh,a.lt),G.resize(d,b,c),G.CD(d,a.Na,a.Ma);return d;case "DEPTH":return a.rf?(d=G.Yl(a.zk?G.gu:G.fu,a.lt),
G.resize(d,b,c)):(d=G.Yl(G.Al,a.lt),G.resize(d,b,c),G.CD(d,a.Na,a.Ma)),d;case "CUBEMAP":return d=G.BH(b);case "SCREEN":case "NONE":return null;default:T.q("Wrong slink param: "+a.from)}}function f(a,b){var c=!1;u.Dg(a,function(d,e,f){if(f&&(d=u.Va(a,d),e=u.Va(a,e),b(f,!1,d,e)))return c=!0});c||u.pa(a,function(a,c){for(var d=0;d<c.Ya.length;d++)if(b(c.Ya[d],!0,c,null))return!0})}function n(a){u.pa(a,function(b,c){if(c.type!=K.Gn){var d=c.p;u.fl(a,b,function(a,b,c){c.Gc&&c.jb&&(y.lx(d,c.from,c.jb),
c.from==c.to&&b.p&&y.lx(b.p,c.from,c.jb))});for(var e=0;e<c.Ya.length;e++){var f=c.Ya[e];f.Gc&&f.from==f.to&&y.lx(d,f.from,c.ti[e])}!d.wc&&!d.Ze||d.df||(d.df=ba.pY(d.wc,d.Ze))}});u.pa(a,function(b,c){if(c.type==K.Fn||c.type==K.Cy){var d=C(a,c);c.p.Dr=d[0].p.df}})}function e(a){var b=null,c=0;u.pa(a,function(a,d){if(d.type==P.d_){if(c==P.c_)return b=d,!0;c++}});return b}function z(a,b){var c=u.oh(a,b),d=K.Bd("NONE"),e=u.J(a,d),f=u.Lr(a)[0];u.Dg(a,function(b,c){c==f&&u.jY(a,b,f,b,e)});var h=M(b,a);
u.Dg(a,function(e,f,k){if(e==c){if(h){e=K.Ru();u.J(a,e);f=A("COLOR","RESOLVE",1,1,1,!0);f.zk=!0;f.rf=!0;var g=A("DEPTH","RESOLVE",1,1,1,!0);g.zk=!0;g.rf=!0;u.r(a,b,e,f);u.r(a,b,e,g);b=e}u.r(a,b,d,A(P.DZ,"u_color",k.size,k.dn,k.en,k.ht));return!0}});u.dd(a,e,f,A("SCREEN","NONE",.5,.5,.5,!0))}function M(a,b){var c=!1,d=u.oh(b,a);u.xg(b,d)&&(c=u.eh(b,d,0),d=u.Yd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=u.Va(b,c),c=M(d,b)):c="RESOLVE"==d.to);return c}function E(a,b,c,
d){var e=c.da,f=b.Tv,h=b.ki.hi,k=b.ki.Uw,g=u.Mx(a,u.IV(a,d),u.Ct),m=[],n=[],l=[],g=u.clone(g,function(b){var d;if(-1<ka.indexOf(b.type))n.push(b),d=b;else{d=K.FS(b);if(d.type==K.Pd)for(var g=0;g<h.length;g++)if(h[g][0]==b){h[g]=[b,d];d.p.rc=b.p.rc;c.da.push(d.p);break}if(b.type==K.Af)for(g=0;g<h.length;g++){if(k[g][0]==b){k[g]=[b,d];d.p=h[g][1].p;break}}else-1<e.indexOf(b.p)&&(f?(y.sw(b.p,y.Te),y.sw(d.p,y.Ue)):(y.sw(b.p,y.Pc),y.sw(d.p,y.cd)),e.push(d.p));var p=u.oh(a,b);u.ui(a,p,function(a,b,c){-1<
ka.indexOf(b.type)&&m.push([b,d,c])});if(b.type!==K.Gh)for(g=0;g<b.Ya.length;g++)d.Ya[g].Jo=b.Ya[g];b=!0;for(g=0;g<u.qo(a,p);g++){var x=u.Yi(a,p,g),x=u.Va(a,x);-1==ka.indexOf(x.type)&&(b=!1)}b&&l.push(d)}return d},function(a){var b=O(a,!0);b.Jo=a;return b});u.Dg(g,function(a,b,c){u.Va(g,a).type===K.Gh&&(c.Jo=null)});for(var p=0;p<n.length;p++)u.Ag(g,u.oh(g,n[p]));u.oA(g);b=K.JT(f);var p=u.J(a,b),x=K.NA();u.J(a,x);var q=A("COLOR","COPY",1,1,1,!0);u.r(a,d,x,q);var r=A("COLOR","u_sampler_left",1,1,1,
!0);r.Wx=!0;r.Na=G.L;r.Ma=G.L;u.r(a,x,b,r);d.zc||(d=K.NA(),u.J(g,d),r=A("COLOR","COPY",1,1,1,!0),r.Jo=q,q=u.Lr(g)[0],q=u.Va(g,q),u.r(g,q,d,r));d=A("COLOR","u_sampler_right",1,1,1,!0);d.Na=G.L;d.Ma=G.L;u.$Q(g,a,[u.Lr(g)[0],p,d]);for(p=0;p<m.length;p++)u.r(a,m[p][0],m[p][1],m[p][2]);d=A("SCREEN","NONE",0,0,0,!1);for(p=0;p<l.length;p++)u.r(a,x,l[p],d);f&&F(a,.5,1);return b}function F(a,b,c){var d=[];u.pa(a,function(b,c){if(-1==ka.indexOf(c.type)&&c.Ya.length&&H(a,c,K.Di))for(var e=0;e<c.Ya.length;e++){var f=
c.Ya[e];-1==d.indexOf(f)&&d.push(f)}});u.Dg(a,function(b,c,e){b=u.Va(a,b);c=u.Va(a,c);-1==ka.indexOf(b.type)&&H(a,c,K.Di)&&-1==d.indexOf(e)&&d.push(e)});for(var e=0;e<d.length;e++)d[e].dn*=b,d[e].en*=c}function A(a,b,c,d,e,f){return{from:a,to:b,size:c,dn:d,en:e,ht:f,Gc:!0,jb:null,zk:!1,rf:!1,Na:G.ye,Ma:G.ye,Wx:!1,lt:!1}}function O(a,b){if(b){var c=a.jb;a.jb=null}a.jb&&T.q("Failed to clone slink with attached texture");var d=T.Ph(a);b&&(a.jb=c,d.jb=c);return d}function H(a,b,c){if(b.type==c)return!0;
b=h(a,b);for(var d=0;d<b.length;d++)if(H(a,b[d],c))return!0;return!1}function I(a,b,c){if(b.type==c)return!0;b=C(a,b);for(var d=0;d<b.length;d++)if(I(a,b[d],c))return!0;return!1}function C(a,b){var c=u.oh(a,b);c==u.vz&&T.q("Subscene not in graph");for(var d=[],e=u.qo(a,c),f=0;f<e;f++){var h=u.Yi(a,c,f);h!=c&&d.push(u.Va(a,h))}return d}function h(a,b){var c=u.oh(a,b);c==u.vz&&T.q("Subscene not in graph");for(var d=[],e=u.xg(a,c),f=0;f<e;f++){var h=u.eh(a,c,f);h!=c&&d.push(u.Va(a,h))}return d}function k(a){var b=
[],c=[];f(a,function(a){a.jb&&-1==b.indexOf(a.jb)&&(b.push(a.jb),c.push(a.jb,b.length-1))});return c}function J(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.ht){var d=a.dn,e=a.en;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.dn,e=a.en,c+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){c+=" ";if(a.rf)c+="RR";else{var d=a.Na,e=a.Ma,f="";d==G.L?f+="L":d==G.ye&&(f+="N");e==G.L?f+="L":e==G.ye&&(f+="N");c+=f}for(d=
0;d<b.length;d+=2)b[d]==a.jb&&(c+=" "+b[d+1])}return c+")\\n"}var y=g("__camera"),d=g("__config"),B=g("__debug"),u=g("__graph"),ba=g("__renderer"),K=g("__subscene"),G=g("__textures"),T=g("__util"),P=d.kr,X=d.B,x=d.Vo,ka=[K.Bi,K.bd,K.ld,K.Se];a.sS=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.w_=f;a.fT=function(a,b,d,f){function k(c){var d=y.Hc(Ra,!0);b.da.push(d);d=K.Xl(c,d,!1,F,
M,Ca,Oa,qa,a.zj);u.J(g,d);c==K.$f?(u.r(g,m[0],d,A("COLOR","COLOR",1,1,1,!0)),d.Ya.push(A("DEPTH","DEPTH",1,1,1,!0))):(c=ja&&m[0].type==K.Fn?Ab:m[0],u.r(g,c,d,Fa),u.r(g,c,d,Bb));Ia&&(u.r(g,Ia,d,kb),u.r(g,Ia,d,eb));for(c=0;c<p.length;c++)u.r(g,p[c],d,r[c]);Va&&u.r(g,Va,d,bb);if(J.length){var e=J.length;for(c=0;c<e;c++)u.r(g,J[c],d,t[c])}if(I.length)for(c=0;c<I.length;c++)u.r(g,I[c],d,ka[c]);Hb&&u.r(g,Hb,d,gc);return d}var g=u.create(),m=[],l=[],p=[],r=[],J=[],t=[],I=[],ka=[],M=a.JW,F=a.Lc,H=a.Xk,D=
a.FZ,N=a.ssao,ba=a.god_rays,L=a.ki,Aa=a.yK,xa=a.BR,ia=a.motion_blur,va=a.compositing,na=a.antialiasing,Oa=a.Ip,Ca=a.hO,qa=a.wd,ma=a.tX,Ea=a.bS,wa=a.TV,Qa=a.KX,Ja=a.dof,Ma=a.YT,R=a.refractions,aa=Boolean(f.length),ja=1<X.Fc,Bb=A("COLOR","COLOR",1,1,1,!0),Fa=A("DEPTH","DEPTH",1,1,1,!0);if(ja){O(Fa);var Dc=O(Fa);Bb.zk=!0;Bb.rf=!0;Fa.zk=!0;Fa.rf=!0}var Ra=b.da[0];if(qa){y.zE(Ra,qa);for(var fa=0;fa<qa.jh.length;fa++)for(var Da=qa.csm_num,ra=0;ra<Da;ra++){var U=K.ET(ra,fa,qa,M);u.J(g,U);p.push(U);var Pa=
qa.csm_resolution,sa=U.p;b.yM.push(sa);sa.width=Pa;sa.height=Pa;U.wb=!1;var Ka=A("DEPTH","u_shadow_map"+(0<fa?fa:ra),Pa,1,1,!1);X.Yq&&(Ka.Na=G.L,Ka.Ma=G.L,Ka.lt=!0);r.push(Ka);(B.kS()||X.zM)&&U.Ya.push(A("COLOR","COLOR",Pa,1,1,!1))}}if(L&&L.OK&&!aa)for(ra=0;ra<L.OK;ra++){sa=y.fd(y.Qd);sa.width=a.Qi;sa.height=a.Qi;y.nx(sa,90,.1,100);y.Vk(sa,sa.Ab);var Sa=K.Xl(K.ld,sa,!1,F,M,Ca,Oa,null,a.zj);Sa.Zl=T.eV();for(fa=0;6>fa;fa++)Sa.hr.push(y.VS());u.J(g,Sa);var pb=A("CUBEMAP","u_cube_reflection",a.Qi,1,1,
!1);pb.Na=G.L;pb.Ma=G.L;ka.push(pb);if(L.JJ){var Ta=K.Xl(K.Se,sa,!1,F,M,Ca,Oa,null,a.zj);Ta.Zl=Sa.Zl;Ta.hr=Sa.hr;u.J(g,Ta);var Ba=A("DEPTH","DEPTH",a.Qi,1,1,!1),$a=A("COLOR","COLOR",a.Qi,1,1,!1);u.r(g,Sa,Ta,Ba);u.r(g,Sa,Ta,$a);I.push(Ta);L.SA.push(Ta)}else{var Xa=A("DEPTH","DEPTH",a.Qi,1,1,!1);Sa.Ya.push(Xa);I.push(Sa)}L.Pi.push(Sa)}if(L&&0<L.uL.length&&!aa)for(fa=0;fa<L.uL.length;fa++)sa=y.Hc(Ra,!0),sa.rc=new Float32Array(4),b.da.push(sa),Sa=K.Xl(K.Pd,sa,!1,F,M,Ca,Oa,null,a.zj),u.J(g,Sa),pb=A("COLOR",
"u_plane_reflection",1,a.sh,a.sh,!0),pb.Na=G.L,pb.Ma=G.L,t.push(pb),L.JJ?(Ta=K.Xl(K.Af,sa,!1,F,M,Ca,Oa,null,a.zj),u.J(g,Ta),Ba=A("DEPTH","DEPTH",1,a.sh,a.sh,!0),$a=A("COLOR","COLOR",1,a.sh,a.sh,!0),$a.Na=G.ye,$a.Ma=G.ye,u.r(g,Sa,Ta,Ba),u.r(g,Sa,Ta,$a),L.Uw.push([Ta]),J.push(Ta)):(Xa=A("DEPTH","DEPTH",1,a.sh,a.sh,!0),Sa.Ya.push(Xa),J.push(Sa)),L.hi.push([Sa]);if(a.gd){var Ia=K.xT();u.J(g,Ia);Pa=x.Qr;Ia.p.width=Pa;Ia.p.height=Pa;var kb=A("DEPTH","u_grass_map_depth",Pa,1,1,!1);X.gc||(kb.Na=G.L,kb.Ma=
G.L);var eb=A("COLOR","u_grass_map_color",Pa,1,1,!1);eb.Na=G.L;eb.Ma=G.L}else eb=kb=Ia=null;if(Ma&&qa){var ab=y.Hc(Ra,!0);b.da.push(ab);var qb=K.FT(ab,M);u.J(g,qb);qb.self_shadow_normal_offset=qa.self_shadow_normal_offset;for(ra=0;ra<p.length;ra++)U=p[ra],u.r(g,U,qb,r[ra]);var lb=A("COLOR","u_color",1,1,1,!0),nb=A("DEPTH","u_depth",1,1,1,!0);if(N){var wb=y.Hc(Ra,!0);b.da.push(wb);var Ua=a.WZ,Nb=K.HT(wb,Ca,Ua);u.J(g,Nb);var kc=A("COLOR","u_ssao_mask",1,1,1,!0);u.r(g,qb,Nb,lb);u.r(g,qb,Nb,nb);var Wb=
y.Hc(Ra,!0);b.da.push(Wb);var rb=K.IT(Wb,Ua);u.J(g,rb);var od=A("COLOR","u_shadow_mask",1,1,1,!0);u.r(g,Nb,rb,kc);u.r(g,qb,rb,nb)}ja?qb.Ya.push(A("DEPTH","DEPTH",1,1,1,!0)):qb.Ya.push(Fa);Ia&&(u.r(g,Ia,qb,kb),u.r(g,Ia,qb,eb))}else qb=null;var Ab=K.Xl(K.Pb,Ra,!0,F,M,Ca,Oa,null,a.zj);u.J(g,Ab);if(ja){var fb=K.Ru();u.J(g,fb);l.push(fb);var lc=A("COLOR","RESOLVE",1,1,1,!0);lc.zk=!0;lc.rf=!0;var Oc=A("DEPTH","RESOLVE",1,1,1,!0);Oc.zk=!0;Oc.rf=!0;u.r(g,Ab,fb,lc);u.r(g,Ab,fb,Oc)}else l.push(Ab);qb&&(kc?
u.r(g,rb,Ab,od):qa?u.r(g,qb,Ab,A("COLOR","u_shadow_mask",1,1,1,!0)):T.q("Internal error"));Ia&&(u.r(g,Ia,Ab,kb),u.r(g,Ia,Ab,eb));if(J.length)for(var Wc=J.length,fa=0;fa<Wc;fa++)u.r(g,J[fa],Ab,t[fa]);if(I.length)for(fa=0;fa<I.length;fa++)u.r(g,I[fa],Ab,ka[fa]);m=l;l=[];if(!aa&&a.GS){sa=y.Hc(Ra,!0);sa.width=1;sa.height=1;b.da.push(sa);var vc=K.IH(sa,!1,M);u.J(g,vc);if(a.Dh){sa=y.Hc(Ra,!0);sa.width=1;sa.height=1;b.da.push(sa);var Rc=K.IH(sa,!0,M);u.J(g,Rc);u.r(g,vc,Rc,A("COLOR","COLOR",1,1,1,!1));u.r(g,
vc,Rc,A("DEPTH","DEPTH",1,1,1,!1))}}else vc=null;if(!Aa.refractions&&!R||aa)Hb=null;else{if(ja)Hb=fb;else{var Hb=K.NA();u.J(g,Hb);u.r(g,m[0],Hb,A("COLOR","COPY",1,1,1,!0))}var gc=A("COLOR","u_refractmap",1,1,1,!0)}if(Ma&&(R||H||D)){var xb=y.Hc(Ra,!0);b.da.push(xb);var Va=K.uT(xb);u.J(g,Va);u.r(g,ja?fb:Ab,Va,A("DEPTH","u_depth",1,1,1,!0));var bb=A("COLOR","u_scene_depth",1,1,1,!0);bb.Na=G.ye;bb.Ma=G.ye}else Va=null;if(a.Gv){var Xb=k(K.Oc);l.push(Xb);m=l;l=[]}if(a.$i){var pd=y.Hc(Ra,!0);b.da.push(pd);
var wc=K.Xl(K.je,pd,!1,F,M,Ca,Oa);u.J(g,wc);Va&&u.r(g,Va,wc,bb);Hb&&u.r(g,Hb,wc,gc);Ia&&(u.r(g,Ia,wc,kb),u.r(g,Ia,wc,eb));if(J.length)for(Wc=J.length,fa=0;fa<Wc;fa++)u.r(g,J[fa],wc,t[fa]);if(I.length)for(fa=0;fa<I.length;fa++)u.r(g,I[fa],wc,ka[fa]);u.r(g,ja?fb:Ab,wc,ja?Dc:Fa);var Ec=K.Bd("X_GLOW_BLUR");Ec.vb="GLOW_MASK_SMALL";Ec.Cg=a.mk.small_glow_mask_width;var ed=A("COLOR","u_color",1,1,1,!0);ed.Na=G.L;ed.Ma=G.L;u.J(g,Ec);u.r(g,wc,Ec,ed);var xc=K.Bd("Y_GLOW_BLUR");xc.vb="GLOW_MASK_SMALL";xc.Cg=
a.mk.small_glow_mask_width;var ac=A("COLOR","u_color",1,.5,.5,!0);ac.Na=G.L;ac.Ma=G.L;u.J(g,xc);u.r(g,Ec,xc,ac);var Xc=K.Bd("X_GLOW_BLUR");Xc.vb="GLOW_MASK_LARGE";Xc.Cg=a.mk.large_glow_mask_width;var fd=A("COLOR","u_color",1,.5,.5,!0);fd.Na=G.L;fd.Ma=G.L;u.J(g,Xc);u.r(g,xc,Xc,fd);var bc=K.Bd("Y_GLOW_BLUR");bc.vb="GLOW_MASK_LARGE";bc.Cg=a.mk.large_glow_mask_width;var cb=A("COLOR","u_color",1,.25,.25,!0);cb.Na=G.L;cb.Ma=G.L;u.J(g,bc);u.r(g,Xc,bc,cb);var Ob=y.Hc(Ra,!0);b.da.push(Ob);var Yb=K.vT(Ob,a);
u.J(g,Yb);var ib=A("COLOR","u_src_color",1,1,1,!0);if(a.Gv)if(ja){var Yc=K.Ru();u.J(g,Yc);u.r(g,Xb,Yc,lc);u.r(g,Xb,Yc,Oc);u.r(g,Yc,Yb,ib)}else u.r(g,Xb,Yb,ib);else u.r(g,ja?fb:Ab,Yb,ib);u.r(g,a.Gv?Xb:Ab,Yb,Fa);var Zb=A("COLOR","u_glow_mask_small",1,.5,.5,!0);Zb.Na=G.L;Zb.Ma=G.L;u.r(g,xc,Yb,Zb);var mc=A("COLOR","u_glow_mask_large",1,.25,.25,!0);mc.Na=G.L;mc.Ma=G.L;u.r(g,bc,Yb,mc);m=[Yb];l=[]}a.Gv||(Xb=k(K.Oc),l.push(Xb),m=l,l=[]);if(X.debug_view){sa=y.Hc(Ra,!0);b.da.push(sa);var Qb=K.tT(sa);l.push(Qb);
u.J(g,Qb);u.r(g,m[0],Qb,Bb);u.r(g,m[0],Qb,Fa);Ia&&(u.r(g,Ia,Qb,kb),u.r(g,Ia,Qb,eb));B.RY(Qb);m=l;l=[]}if(ja){var Pb=K.Ru();u.J(g,Pb);l.push(Pb);u.r(g,m[0],Pb,lc);u.r(g,m[0],Pb,Oc);m=l;l=[]}var nc=m.slice(0);if(!aa&&a.HQ){sa=y.Hc(Ra,!0);b.da.push(sa);var Hc=K.pT(sa);u.J(g,Hc);u.r(g,m[0],Hc,ja?Dc:Fa)}if(ba&&Ma&&!aa){var Ib=wa.zo,oc=wa.YB,sb=wa.mp,db=m[0],cc=F?!0:!1,Zc=A("DEPTH","u_input",1,1,1,!0),Cb=A("COLOR","u_input",1,.25,.25,!0);Cb.Na=G.L;Cb.Ma=G.L;var Rb=Ib/sb,gb=y.Hc(Ra,!0);b.da.push(gb);var ob=
K.OA(gb,cc,Ib,!0,Rb,M,sb);u.J(g,ob);u.r(g,db,ob,Zc);var Rb=Ib/sb*.5,Ic=y.Hc(Ra,!0);b.da.push(Ic);var pc=K.OA(Ic,cc,Ib,!1,Rb,M,sb);u.J(g,pc);u.r(g,ob,pc,Cb);var Rb=Ib/sb*.25,Jc=y.Hc(Ra,!0);b.da.push(Jc);var Jb=K.OA(Jc,cc,Ib,!1,Rb,M,sb);u.J(g,Jb);u.r(g,pc,Jb,Cb);var qc=K.wT(oc,M);l.push(qc);u.J(g,qc);u.r(g,db,qc,A("COLOR","u_main",1,1,1,!0));u.r(g,Jb,qc,A("COLOR","u_god_rays",1,1,1,!0));m=l;l=[]}if(xa&&!aa){var db=m[0],dc=K.yT();u.J(g,dc);u.r(g,db,dc,A("COLOR","u_input",1,1,1,!0));var Ya=K.qT();u.J(g,
Ya);Ya.p.width=X.ur?2:1;Ya.p.height=X.ur?2:1;var ec=A("COLOR","u_input",1,.25,.25,!0);ec.Na=G.L;ec.Ma=G.L;var Kb=A("COLOR","u_luminance",1,.25,.25,!0);Kb.Na=G.L;Kb.Ma=G.L;u.r(g,dc,Ya,ec);var tb=xa.key,rc=xa.edge_lum,ub=y.Hc(Ra,!0);b.da.push(ub);var Lb=K.zT(tb,rc,M,ub);u.J(g,Lb);u.r(g,db,Lb,A("COLOR","u_main",1,1,1,!0));u.r(g,dc,Lb,Kb);u.r(g,Ya,Lb,A("COLOR","u_average_lum",1,1,1,!1));var Sb=A("COLOR","u_color",1,.25,.25,!0);Sb.Na=G.L;Sb.Ma=G.L;Ec=K.HH("X_BLUR");u.J(g,Ec);u.r(g,Lb,Ec,Sb);xc=K.HH("Y_BLUR");
u.J(g,xc);u.r(g,Ec,xc,Sb);var yc=K.rT(xa.blur);u.J(g,yc);var Kc=A("COLOR","u_bloom",1,.25,.25,!0);Kc.Na=G.L;Kc.Ma=G.L;u.r(g,xc,yc,Kc);u.r(g,db,yc,A("COLOR","u_main",1,1,1,!0));l.push(yc);m=l;l=[]}if(Ja&&Ma&&!aa){var db=m[0],Ga=y.Hc(Ra,!0);b.da.push(Ga);if(d.dof_bokeh){var hc=A("COLOR","u_color",1,1,1,!0);hc.Na=G.L;hc.Ma=G.L;var Db=A("DEPTH","u_depth",1,1,1,!0),Eb=A("COLOR","u_color",1,.5,.5,!0);Eb.Na=G.ye;Eb.Ma=G.ye;Sb=A("COLOR","u_color",1,.5,.5,!0);Sb.Na=G.ye;Sb.Ma=G.ye;var Fc=A("COLOR","u_blurred1",
1,.5,.5,!0);Fc.Na=G.L;Fc.Ma=G.L;var Tb=A("COLOR","u_blurred2",1,.5,.5,!0);Tb.Na=G.L;Tb.Ma=G.L;var jb=nc[0];if(d.Dd){var hb=y.Hc(Ra,!0);b.da.push(hb);var Ha=K.MA(hb,"COC_FOREGROUND");hb.dof_distance=d.dof_distance;hb.dof_object=d.dof_object;hb.dof_front_start=d.dof_front_start;hb.dof_front_end=d.dof_front_end;hb.dof_rear_start=d.dof_rear_start;hb.dof_rear_end=d.dof_rear_end;hb.dof_power=d.dof_power;hb.dof_bokeh=d.dof_bokeh;hb.dof_bokeh_intensity=d.dof_bokeh_intensity;hb.Dd=d.Dd;hb.dof_on=!0;u.J(g,
Ha);u.r(g,db,Ha,hc);u.r(g,jb,Ha,Db);var $b=K.Bd("X_ALPHA_BLUR");u.J(g,$b);u.r(g,Ha,$b,Eb);var Fb=K.Bd("Y_ALPHA_BLUR");u.J(g,Fb);u.r(g,$b,Fb,Sb);var La=y.Hc(Ra,!0),Na=K.MA(La,"COC_COMBINE");b.da.push(La);La.dof_distance=d.dof_distance;La.dof_object=d.dof_object;La.dof_front_start=d.dof_front_start;La.dof_front_end=d.dof_front_end;La.dof_rear_start=d.dof_rear_start;La.dof_rear_end=d.dof_rear_end;La.dof_power=d.dof_power;La.dof_bokeh=d.dof_bokeh;La.dof_bokeh_intensity=d.dof_bokeh_intensity;La.Dd=d.Dd;
La.dof_on=!0;u.J(g,Na);u.r(g,db,Na,hc);u.r(g,jb,Na,Db);u.r(g,Fb,Na,A("COLOR","u_coc_fg",1,.5,.5,!0))}else La=y.Hc(Ra,!0),b.da.push(La),Na=K.MA(La,"COC_ALL"),La.dof_distance=d.dof_distance,La.dof_object=d.dof_object,La.dof_front_start=d.dof_front_start,La.dof_front_end=d.dof_front_end,La.dof_rear_start=d.dof_rear_start,La.dof_rear_end=d.dof_rear_end,La.dof_power=d.dof_power,La.dof_bokeh=d.dof_bokeh,La.dof_bokeh_intensity=d.dof_bokeh_intensity,La.Dd=d.Dd,La.dof_on=!0,u.J(g,Na),u.r(g,db,Na,hc),u.r(g,
jb,Na,Db);var mb=K.Bd("X_DOF_BLUR");mb.p.dof_bokeh_intensity=d.dof_bokeh_intensity;u.J(g,mb);u.r(g,Na,mb,Eb);var Pc=K.Bd("Y_DOF_BLUR");Pc.p.dof_bokeh_intensity=d.dof_bokeh_intensity;u.J(g,Pc);u.r(g,mb,Pc,Sb);var Lc=K.Bd("Y_DOF_BLUR");Lc.p.dof_bokeh_intensity=d.dof_bokeh_intensity;u.J(g,Lc);u.r(g,mb,Lc,Sb);var vb=K.JH(Ga);Ga.dof_distance=d.dof_distance;Ga.dof_object=d.dof_object;Ga.dof_front_start=d.dof_front_start;Ga.dof_front_end=d.dof_front_end;Ga.dof_rear_start=d.dof_rear_start;Ga.dof_rear_end=
d.dof_rear_end;Ga.dof_power=d.dof_power;Ga.dof_bokeh=d.dof_bokeh;Ga.dof_bokeh_intensity=d.dof_bokeh_intensity;Ga.Dd=d.Dd;Ga.dof_on=!0;l.push(vb);u.J(g,vb);u.r(g,db,vb,A("COLOR","u_sharp",1,1,1,!0));u.r(g,Pc,vb,Fc);u.r(g,Lc,vb,Tb)}else{var Gc=A("COLOR","u_color",1,1,1,!0);Gc.Na=G.L;Gc.Ma=G.L;var Ub=A("COLOR","u_color",1,1,1,!0);Ub.Na=G.L;Ub.Ma=G.L;mb=K.Bd("X_BLUR");u.J(g,mb);u.r(g,db,mb,Gc);var fc=K.Bd("Y_BLUR");u.J(g,fc);u.r(g,mb,fc,Ub);var gd=nc[0],vb=K.JH(Ga);Ga.dof_distance=d.dof_distance;Ga.dof_object=
d.dof_object;Ga.dof_front_start=d.dof_front_start;Ga.dof_front_end=d.dof_front_end;Ga.dof_rear_start=d.dof_rear_start;Ga.dof_rear_end=d.dof_rear_end;Ga.dof_power=d.dof_power;Ga.dof_bokeh=d.dof_bokeh;Ga.dof_bokeh_intensity=d.dof_bokeh_intensity;Ga.Dd=d.Dd;Ga.dof_on=!0;l.push(vb);u.J(g,vb);u.r(g,db,vb,A("COLOR","u_sharp",1,1,1,!0));u.r(g,fc,vb,A("COLOR","u_blurred",1,1,1,!0));u.r(g,gd,vb,A("DEPTH","u_depth",1,1,1,!0))}m=l;l=[]}if(a.Dh){var $c=k(K.$f);l.push($c);m=l;l=[]}if(ia&&!aa){var Sc=m[0],ad=K.AT(ma.mb_decay_threshold,
ma.mb_factor);l.push(ad);u.J(g,ad);u.r(g,Sc,ad,A("COLOR","u_mb_tex_curr",1,1,1,!0));ad.Ya.push(A("COLOR","u_mb_tex_accum",1,1,1,!0));m=l;l=[]}if(!aa&&a.outline){var db=m[0],yb=y.Hc(Ra,!0);b.da.push(yb);var zb=K.CT(yb,M);u.J(g,zb);var zc=K.Bd("X_EXTEND"),hd=A("COLOR","u_color",1,1,1,!0),Wa=A("COLOR","u_outline_mask",1,1,1,!0);zc.Xr=!0;u.J(g,zc);u.r(g,zb,zc,hd);var Za=A("COLOR","u_color",1,.5,.5,!0);Za.Na=G.L;Za.Ma=G.L;var Tc=K.Bd("Y_EXTEND");Tc.Xr=!0;u.J(g,Tc);u.r(g,zc,Tc,Za);mb=K.Bd("X_BLUR");mb.Xr=
!0;u.J(g,mb);u.r(g,Tc,mb,Za);var ic=A("COLOR","u_color",1,.25,.25,!0);ic.Na=G.L;ic.Ma=G.L;var Mb=A("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Mb.Na=G.L;Mb.Ma=G.L;fc=K.Bd("Y_BLUR");fc.Xr=!0;u.J(g,fc);u.r(g,mb,fc,ic);var Ac=K.BT(Qa);u.J(g,Ac);u.r(g,db,Ac,A("COLOR","u_outline_src",1,1,1,!0));u.r(g,zb,Ac,Wa);u.r(g,fc,Ac,Mb);l.push(Ac);m=l;l=[]}q(g,Ma);if((a.anaglyph_use||a.Tv)&&!aa){var jd=E(g,a,b,m[0]);l.push(jd);m=l;l=[]}if(va&&!aa){var db=m[0],Uc=K.sT(Ea.brightness,Ea.contrast,Ea.exposure,Ea.saturation);
u.J(g,Uc);u.r(g,db,Uc,A("COLOR","u_color",1,1,1,!0));l.push(Uc);m=l;l=[]}if(na){db=m[0];if(X.smaa){var Bc=A("COLOR","u_color",1,1,1,!0);Bc.Na=G.L;Bc.Ma=G.L;var sc=K.PA(K.cu,a);u.J(g,sc);u.r(g,db,sc,Bc);var Mc=K.PA(K.gq,a);u.J(g,Mc);u.r(g,sc,Mc,Bc);var Vc=A("COLOR","u_search_tex",1,1,1,!1),jc=A("COLOR","u_area_tex",1,1,1,!1);Vc.Na=G.L;Vc.Ma=G.L;jc.Na=G.L;jc.Ma=G.L;Mc.Ya.push(Vc);Mc.Ya.push(jc);var tc=K.PA(K.du,a);u.J(g,tc);u.r(g,db,tc,Bc);var Vb=A("COLOR","u_blend",1,1,1,!0);Vb.Na=G.L;Vb.Ma=G.L;u.r(g,
Mc,tc,Vb);l.push(tc)}else{var Nc=K.oT(a);u.J(g,Nc);var kd=A("COLOR","u_color",1,1,1,!0);kd.Na=G.L;kd.Ma=G.L;u.r(g,db,Nc,kd);l.push(Nc)}m=l;l=[]}var Cc=u.oh(g,m[0]);if(m[0].type==K.Gh||m[0].type==K.Fn)var qd=!0;else qd=!1,u.ui(g,Cc,function(a,b,c){if(c.from==c.to)return qd=!0});if(qd){var ld=K.Bd("NONE");u.J(g,ld);u.r(g,m[0],ld,A("COLOR","u_color",1,1,1,!0));l.push(ld);m=l;l=[]}l.push(m[0]);vc&&(Rc?l.push(Rc):l.push(vc));Hc&&l.push(Hc);Pa=x.Uu;if(a.Dx.xL){var md=a.Dx,wd=a.Ip,rd=wd.ep,Pa=rd?rd.l_:Pa,
bd=K.GT(wd,M,md,Pa);u.J(g,bd);l.push(bd)}var uc=K.KH();u.J(g,uc);for(ra=0;ra<l.length;ra++){var cd=l[ra];switch(cd.type){case K.xf:case K.Ai:u.r(g,cd,uc,A("COLOR","NONE",1,1,1,!1));u.r(g,cd,uc,A("DEPTH","NONE",1,1,1,!1));break;case K.Lg:u.r(g,cd,uc,A("CUBEMAP","u_sky",Pa,1,1,!1));break;case K.yn:u.r(g,cd,uc,A("COLOR","NONE",1,1,1,!0));break;default:if(aa){var sd=f[0],dd=A("COLOR","OFFSCREEN",1,1,1,!0);dd.jb=sd;u.r(g,l[ra],uc,dd);for(fa=1;fa<f.length;fa++){var td=f[fa],Gb=K.Bd("NONE");u.J(g,Gb);u.r(g,
l[ra],Gb,A("COLOR","SCALE",1,1,1,!0));var xd=td.vj/sd.vj,dd=A("COLOR","OFFSCREEN",1,xd,xd,!0);dd.jb=td;u.r(g,Gb,uc,dd)}}else u.r(g,l[ra],uc,A("SCREEN","NONE",1,1,1,!0))}}fb&&!h(g,fb).length&&(u.Ag(g,u.oh(g,fb)),u.oA(g));q(g,Ma);c(g,Ma);if(P.enabled){var Qc=e(g);Qc&&z(g,Qc)}w(g);n(g);qa&&u.pa(g,function(a,b){if(b.type==K.Bf||b.type==K.Oc||b.type==K.$f){for(var c=0,d=C(g,b),e=0,f=0;f<d.length;f++){var h=d[f];h.type==K.bd&&(e++,b.Tm=b.Tm||[],b.Tm[0<h.xh?h.xh:c]=h.p.xb,c++)}b.$x&&b.Zx||(X.rw?b.FE=new Float32Array(9*
e):(b.$x=new Float32Array(4*e),b.Zx=new Float32Array(4*e)))}});return g};a.BX=F;a.Kd=function(a,b,c){var d=a.Cg;a.lE[0]=b*a.Fb[0]*d;a.lE[1]=c*a.Fb[1]*d};a.Kc=function(a,b){a.Cg=b};a.eT=function(){var a=u.create(),b=K.DT(),c=y.fd(y.od);c.width=512;c.height=512;b.p=c;u.J(a,b);b.Ya.push(A("COLOR","u_color",512,1,1,!1));c=K.KH();u.J(a,c);u.r(a,b,c,A("COLOR","NONE",512,1,1,!1));w(a);n(a);return a};a.KU=function(a){var b=null;u.pa(a,function(a,c){return c.p&&null===c.p.df?(b=c,!0):!1});return b};a.Db=function(a,
b,c){a=C(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.EB=function(a,b,c){a=C(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.c7=H;a.e7=I;a.GV=C;a.KV=h;a.ic=function(a,b){var c=null;u.pa(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.TT=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=k(a);u.pa(a,function(a,d){var e=
b+="    ",f=K.aE(d);if(d.p){for(var f=f+"\\n",h=0;h<c.length;h+=2){var k=d.p.wc;c[h]==k&&(f=G.vo(k)?f+("CR"+c[h+1]+" "):f+("C"+c[h+1]+" "))}for(h=0;h<c.length;h+=2)k=d.p.Ze,c[h]==k&&(f=G.vo(k)?f+("DR"+c[h+1]):f+("D"+c[h+1]))}d.Ya.length&&(f+="\\n-----\\n");for(h=0;h<d.Ya.length;h++)f+=J(d.Ya[h],c);h=d.type==K.Gn?"dotted":d.Wd?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(h+",bold")+'"];\n')});u.Dg(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+J(e,
c)+'" style="'+(e.Gc?"solid":"dotted")+'"];\n'});return b+="}"};a.gT=function(a){a=u.o_(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.Wd&&b.push(d)}return b}};b4w.module.__textures=function(a,g){function q(){return{type:0,source:"",Ys:"",width:0,height:0,$q:1,anisotropic_filtering:"",vj:1024,fm:!1,cg:null,mb:0,rb:null,Qe:null,Em:!1,vt:-1,Sa:null,dy:"",yk:0,dh:0,va:0,Tb:0,ik:0,rg:!1,vh:1,ud:null,Ps:0,Os:0,sj:-1,Rs:!1,Tk:-1,tt:!1,CE:!1,Dj:!1,ll:!1,repeat:!0,Tr:"",oo:"",po:"",UB:"",TB:"",Xv:!1,wm:"",bA:"",Ck:0}}function c(a,b,c){a.po=b.uuid;a.oo=b.filepath;a.UB=b.source;a.TB=b.name;a.Tr=ha.nj(c+b.filepath);if(a.Xv=b.Kh)a.wm=b.kq;da.push(a)}function b(a,b,
c){var d=-1<b.indexOf(".dds"),e=-1<b.indexOf(".pvr");a.Xv=d||e;a.wm=d?"dds":e?"pvr":"";a.oo=b;a.Tr=c}function w(b,c){var d=q();d.type=b;d.source="NONE";if(b==a.hu||b==a.fu||b==a.iu||b==a.gu)d.Qe=N.createRenderbuffer();else{var e=N.TEXTURE_2D,f=N.createTexture();N.bindTexture(e,f);N.texParameteri(e,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(e,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(e,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(e,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);var h=M(d),k=E(d),
g=F(d),m=b==a.Al?null:new Uint8Array([204,204,204,255]);N.texImage2D(e,0,k,1,1,0,h,g,m);oa.Yq&&c&&N.texParameterf(e,N.TEXTURE_COMPARE_MODE,N.COMPARE_REF_TO_TEXTURE);N.bindTexture(e,null);d.mb=e;d.rb=f}return d}function t(a){"CANVAS"!=a.source&&ha.q("Wrong texture");var b=a.mb;N.bindTexture(b,a.rb);var c=M(a),d=E(a),e=F(a),f=a.cg.canvas;N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);N.texImage2D(b,0,d,c,e,f);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);a.fm&&N.generateMipmap(b);N.bindTexture(b,null);a.width=f.width;
a.height=f.height}function D(a){var b=a.mb;N.bindTexture(b,a.rb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Sa.length?a.rg?p(a,a.Sa,a.width*a.vh,a.height*a.vh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.Sa):N.texImage2D(b,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,a.Sa);N.bindTexture(b,null)}function l(a){var b=a.mb;N.bindTexture(b,a.rb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.rg?p(a,a.ud[a.sj],a.width*a.vh,a.height*a.vh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.ud[a.sj]);N.bindTexture(b,
null)}function r(){za||(za=document.createElement("canvas"));return za}function p(a,b,c,d,e){e||(f(N.TEXTURE_2D),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b));N.bindTexture(N.TEXTURE_2D,null);v.hU(a,c,d,la,ua)}function m(a,b,c,d){for(var e=0;6>e;e++){var f=d[e],h=r();h.width=c;h.height=c;var k=h.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(k.translate(0,c),k.scale(1,-1)):(k.translate(c,0),k.scale(-1,1));k.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,c,c);N.texImage2D(N["TEXTURE_CUBE_MAP_"+
f[0]],0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,h)}}function f(a){la||(la=N.createFramebuffer());N.bindTexture(a,null);ua||(ua=N.createTexture());N.bindTexture(a,ua);N.texParameteri(a,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(a,N.TEXTURE_MIN_FILTER,N.LINEAR)}function n(a,b,c){var d=a.source,h=a.rb,k=a.mb,g=a.wm,n=a.oo,l=1,u=1;N.bindTexture(k,h);a.repeat?(N.texParameteri(k,N.TEXTURE_WRAP_S,N.REPEAT),
N.texParameteri(k,N.TEXTURE_WRAP_T,N.REPEAT)):(N.texParameteri(k,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(k,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE));if(4==b.length){var q=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==d)if(q)N.texImage2D(k,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(g){u=x.FJ(b,g);q=ha.Mq(u.width)||ha.Mq(u.height);if(u.width>S.Ec||u.height>S.Ec){Q.error('Image "'+n+'" has unsupported size: '+u.width+"x"+u.height+". Max available: "+
S.Ec+"x"+S.Ec+".");return}l=u.width;u=u.height;if(q||"pvr"==g)a.rg=!0,f(k),l=z(l*a.vh),u=z(u*a.vh);"dds"==g?x.h0(N,ca.nJ(),b,!0):"pvr"==g&&x.i0(N,ca.jJ(),b);a.rg&&(p(a,null,l,u,!0),N.bindTexture(k,h),N.generateMipmap(k));a.width=l;a.height=u;a.$q=x.oV(b,g)}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.Em?oa.Qs?(l=b[0].width,u=b[0].height):(l=b.videoWidth,u=b.videoHeight):(l=b.width,u=b.height);a.width=l;a.height=u;if(l>S.Ec||l>S.Ec)Q.warn('Image "'+n+'" has unsupported size: '+l+"x"+u+". Max available: "+
S.Ec+"x"+S.Ec+". Reduced image size will be used."),a.vh=Math.min(S.Ec/l,S.Ec/u),a.rg=!0;a.Em&&(c in pa||(pa[c]={}),pa[c][a.dy]=a,oa.Qs?(a.ud=b,a.Ps=b.length,a.dh=a.Os*a.yk/b.length,b=b[0]):(a.Sa=b,a.Sa.loop=a.Dj,a.dh=b.duration?a.yk/b.duration:W.qd(),ga.cI||(b.playbackRate=W.qd()/a.dh,ga.lH&&2<b.playbackRate&&(b.playbackRate=2)),e(a)));l=z(a.width*a.vh);u=z(a.height*a.vh);a.rg?(n=r(),h=n.getContext("2d"),n.width=l,n.height=u,h.drawImage(b,0,0,a.width,a.height,0,0,l,u),N.texImage2D(k,0,N.RGBA,N.RGBA,
N.UNSIGNED_BYTE,n)):oa.gc||!ha.Mq(a.width)&&!ha.Mq(a.height)?N.texImage2D(k,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b):(p(a,b,l,u,!1),a.rg=!0);h=a.rb;a.Em||(N.bindTexture(k,h),N.generateMipmap(k),N.bindTexture(k,null));a.width=l;a.height=u}else if("ENVIRONMENT_MAP"==d)if(l=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],q){for(n=0;6>n;n++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+l[n][0]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b);a.width=3;a.height=
2}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){Q.error('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}u=b.width/3;u>S.ej?(Q.warn('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*S.ej+"x"+2*S.ej+". Reduced image size will be used."),n=z(S.ej/u*u),a.rg=!0):(n=z(u),!oa.gc&&(3*n>S.Ec||2*n>S.Ec)&&(a.rg=!0));if(a.rg||oa.sD)m(b,u,n,l);else{g=
b;h=n;f(N.TEXTURE_2D);N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,g);N.bindTexture(N.TEXTURE_2D,null);for(g=0;6>g;g++)N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,N.RGBA,h,h,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(a.mb,null);N.bindFramebuffer(N.FRAMEBUFFER,la);for(g=0;6>g;g++)v.gU(a,N.TEXTURE_CUBE_MAP_POSITIVE_X+g,h,u,ua,g);N.bindFramebuffer(N.FRAMEBUFFER,null);N.bindTexture(a.mb,a.rb);N.texParameteri(a.mb,N.TEXTURE_MIN_FILTER,ea[oa.rp]);N.texParameteri(a.mb,N.TEXTURE_MAG_FILTER,
N.LINEAR)}ka.mS()&&(Q.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),m(b,u,P.qF,l));a.width=3*n;a.height=2*n;N.generateMipmap(k)}else"NODE_TEX"==d&&(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),N.texImage2D(k,0,N.RGBA,b.width,b.height,0,N.RGBA,N.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);N.bindTexture(k,null)}function e(a){a.Sa.l8=function(){D(a)}}function z(a){return ha.Mq(a)?ha.V(Math.pow(2,parseInt(a).toString(2).length),2,S.Ec):a}function M(b){var c;
switch(b.type){case a.Hh:c=N.RGBA;break;case a.ju:c=N.RGB;break;case a.iq:c=N.RGBA;break;case a.jq:c=N.RGB;break;case a.Al:c=N.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}function E(b){var c;switch(b.type){case a.Hh:c=oa.gc?N.RGBA8:N.RGBA;break;case a.ju:c=oa.gc?N.RGB8:N.RGB;break;case a.iq:c=oa.gc?N.RGBA8:N.RGBA;break;case a.jq:c=oa.gc?N.RGB8:N.RGB;break;case a.Al:c=oa.gc?oa.Lz?N.DEPTH_COMPONENT16:N.DEPTH_COMPONENT24:N.DEPTH_COMPONENT;break;default:ha.q("Wrong texture type")}return c}
function F(b){var c;switch(b.type){case a.Hh:c=N.UNSIGNED_BYTE;break;case a.ju:c=N.UNSIGNED_BYTE;break;case a.iq:c=N.FLOAT;break;case a.jq:c=N.FLOAT;break;case a.Al:c=oa.Lz?N.UNSIGNED_SHORT:N.UNSIGNED_INT;break;default:ha.q("Wrong texture type")}return c}function A(a){return a&&a.Qe?!0:!1}function O(a){a.Sa?a.Sa.play():a.ud&&(a.Rs=!0);a.tt=!1}function H(a){a.Sa?a.Sa.pause():a.ud&&(a.Rs=!1);a.tt=!0}function I(a){a.Sa?a.Sa.currentTime=a.Tb/a.dh:a.ud&&(a.sj=h(a,a.Tb),l(a))}function C(a){return a.Sa?
!a.Sa.paused:a.ud?a.Rs:!1}function h(a,b){return Math.round(b*a.Ps/a.yk)}function k(a,b){if(Z.Ra(a))return J(a,b);for(var c=a.ww,d=0;d<c.length;d++){var e=J(c[d],b);if(e)return e}return null}function J(a,b){var c=a.I;if(c.length)for(var c=c[0].X,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type||"SKY"==e.type)for(var f=0;f<e.ya.length;f++)if(e.Qg[f]==b)return e.ya[f]}return null}function y(a,b,c){a=a.I;if(a.length){a=a[0].X;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++)e.Qg[f]==
b&&(K(e.ya[f]),e.ya[f]=c,G(c))}}}function d(a,b){var c=a.I;if(c.length)for(var c=c[0].X,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.ya.length;f++){var h=e.ya[f],k=e.Qg[f];-1==b.indexOf(k)&&"NODE_TEX"!=h.source&&b.push(k)}}}function B(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),h=u(d,f,!0),k=ba(d,f,!0);if(h&&k)if("CONSTANT"==a)c.push.apply(c,h.color);else{var g=c,m=h,n=k;m==n?g.push.apply(g,m.color):(g.push(Y.nw(n.color[0],n.position,m.color[0],
m.position,f)),g.push(Y.nw(n.color[1],n.position,m.color[1],m.position,f)),g.push(Y.nw(n.color[2],n.position,m.color[2],m.position,f)),g.push(Y.nw(n.color[3],n.position,m.color[3],m.position,f)))}k&&!h&&c.push.apply(c,k.color);h&&!k&&c.push.apply(c,h.color)}}function u(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function ba(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-
b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function K(a){0<a.Ck&&--a.Ck;0>=a.Ck&&(a.rb&&N.deleteTexture(a.rb),a=da.indexOf(a),-1!=a&&da.splice(a,1))}function G(a){a.Ck+=1}function T(a,b){for(var c=0;c<da.length;c++){var d=da[c];if(d.Tr==a&&d.type==b.type&&d.repeat==b.repeat&&d.anisotropic_filtering==b.anisotropic_filtering&&d.ll==b.ll)return d}return null}var P=g("__compat"),X=g("__config"),x=g("__texcomp"),ka=g("__debug"),ca=g("__extensions"),Q=g("__print"),W=g("__time"),
ha=g("__util"),v=g("__renderer"),Z=g("__obj_util"),Y=g("__curve"),V=g("__vec3"),ta=g("__scenes"),oa=X.B,S=X.Mi,ga=X.Y,za=null,ua=null,la=null;a.ye=0;a.L=0;a.qQ=0;a.oQ=0;a.pQ=0;a.nQ=0;a.Hh=10;a.ju=20;a.iq=30;a.jq=40;a.Al=50;a.hu=60;a.fu=70;a.iu=80;a.gu=90;a.VE=128;a.pO=128;a.zF=128;var da=[],ya={},pa={},N=null,ea;a.Tf=function(b){ea=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.ye=b.NEAREST;a.L=b.LINEAR;a.qQ=b.NEAREST_MIPMAP_NEAREST;a.oQ=b.LINEAR_MIPMAP_NEAREST;
a.pQ=b.NEAREST_MIPMAP_LINEAR;a.nQ=b.LINEAR_MIPMAP_LINEAR;N=b};a.m5=function(a,b){return b in ya&&a in ya[b]?ya[b][a].cg:null};a.C$=function(a,b){return b in ya&&a in ya[b]?(t(ya[b][a]),!0):!1};a.gG=c;a.Yl=w;a.BH=function(b){var c=N.createTexture(),d=N.TEXTURE_CUBE_MAP;N.bindTexture(d,c);N.texParameteri(d,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(d,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(d,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(d,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);for(var e="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
f=0;6>f;f++)N.texImage2D(N[e[f]],0,N.RGBA,b,b,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(d,null);d=q();d.type=a.Hh;d.source="NONE";d.width=3*b;d.height=2*b;d.$q=1;d.rb=c;d.mb=N.TEXTURE_CUBE_MAP;return d};a.CD=function(a,b,c){if(!A(a)){var d=a.mb;N.bindTexture(d,a.rb);b&&N.texParameteri(d,N.TEXTURE_MIN_FILTER,b);c&&N.texParameteri(d,N.TEXTURE_MAG_FILTER,c);N.bindTexture(d,null)}};a.E5=function(b){if(A(b))return{min:a.ye,hX:a.ye};var c=b.mb;N.bindTexture(c,b.rb);b=N.getTexParameter(c,N.TEXTURE_MIN_FILTER);
var d=N.getTexParameter(c,N.TEXTURE_MAG_FILTER);N.bindTexture(c,null);return{min:b,hX:d}};a.resize=function(b,c,d){c=Math.max(c,oa.ur?2:1);d=Math.max(d,oa.ur?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.hu:N.bindRenderbuffer(N.RENDERBUFFER,b.Qe);N.renderbufferStorage(N.RENDERBUFFER,N.RGB565,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.fu:N.bindRenderbuffer(N.RENDERBUFFER,b.Qe);N.renderbufferStorage(N.RENDERBUFFER,N.DEPTH_COMPONENT16,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);
break;case a.iu:N.bindRenderbuffer(N.RENDERBUFFER,b.Qe);N.renderbufferStorageMultisample(N.RENDERBUFFER,oa.Fc,N.RGBA8,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.gu:N.bindRenderbuffer(N.RENDERBUFFER,b.Qe);N.renderbufferStorageMultisample(N.RENDERBUFFER,oa.Fc,N.DEPTH_COMPONENT24,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);break;default:var e=b.mb;N.bindTexture(e,b.rb);var f=M(b),h=E(b),k=F(b);N.texImage2D(e,0,h,c,d,0,f,k,null);N.bindTexture(e,null)}c>S.Ec||d>S.Ec?ha.q('Slink texture "'+
b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+S.Ec+"x"+S.Ec+"."):(b.width=c,b.height=d)}};a.KT=function(b,d,e,f,h){var k=b.type,g=b.image,m=q();m.bA=b.uuid;m.type=a.Hh;m.width=1;m.height=1;var n=b.b4w_anisotropic_filtering;"DEFAULT"===n&&(n=d);"OFF"!==n&&oa.anisotropic_filtering&&ca.II()&&(n=parseFloat(n.split("x")[0]),m.anisotropic_filtering=n);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)m.repeat=!1;if(g&&("IMAGE"==k&&"MOVIE"==g.source&&(m.Em=!0,m.dy=b.name,m.va=b.frame_start,
m.Tb=b.frame_offset,m.ik=b.frame_duration,m.CE=b.use_auto_refresh,m.Dj=b.use_cyclic,m.yk=b.movie_length,m.ll=b.b4w_nla_video,0!=m.Tb&&Q.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),d=ha.nj(h+g.filepath),d=T(d,m))){b.s=d;return}d=new Uint8Array([204,204,204,255]);switch(k){case "IMAGE":var n=N.createTexture(),l=N.TEXTURE_2D;N.bindTexture(l,n);N.texImage2D(l,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d);break;case "NONE":n=N.createTexture();
l=N.TEXTURE_2D;N.bindTexture(l,n);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(e=ha.Ed("name",b.b4w_source_id,e)))m.vj=b.b4w_source_size,e.ag=e.ag||[],e.ag.push(m),G(m),N.texImage2D(l,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d);else return;break;case "ENVIRONMENT_MAP":n=N.createTexture();l=N.TEXTURE_CUBE_MAP;N.bindTexture(l,n);e="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var v=0;6>v;v++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+
e[v]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,d);break;case "BLEND":return;default:Q.error('texture "'+b.name+'" has unsupported type "'+k+'"');return}m.rb=n;m.mb=l;m.anisotropic_filtering&&N.texParameterf(m.mb,ca.II().TEXTURE_MAX_ANISOTROPY_EXT,m.anisotropic_filtering);"NONE"==k&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==k&&"MOVIE"==g.source?N.texParameteri(l,N.TEXTURE_MIN_FILTER,N.LINEAR):N.texParameteri(l,N.TEXTURE_MIN_FILTER,ea[oa.rp]);N.texParameteri(l,N.TEXTURE_MAG_FILTER,
N.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==k?(k=b.b4w_source_id,e=b.b4w_source_size,m.fm=b.b4w_enable_canvas_mipmapping,m.Ys=k,m.source="CANVAS",d=document.createElement("canvas"),d.width=e,d.height=e,m.cg=d.getContext("2d"),f in ya||(ya[f]={}),ya[f][k]=m,t(m)):"SCENE"==b.b4w_source_type&&"NONE"==k?(m.Ys=b.b4w_source_id,m.source="SCENE"):(m.source=k,N.generateMipmap(l),N.bindTexture(l,null));g&&c(m,g,h);b.s=m};a.HN=D;a.GN=l;a.it=n;a.RR=z;a.wo=function(a){return a&&(a.rb||a.Qe)?!0:!1};a.vo=A;a.x7=
function(b){return b.type==a.iq||b.type==a.jq?!0:!1};a.PV=function(b){var c=0;switch(b.type){case a.Hh:case a.ju:c=4;break;case a.iq:case a.jq:c=16;break;case a.Al:c=3;break;case a.hu:case a.fu:c=2;break;case a.iu:c=4*oa.Fc;break;case a.gu:c=3*oa.Fc}return c};a.ua=function(){if(!oa.Qs)for(var a in pa)for(var b in pa[a])pa[a][b].Sa.pause(),pa[a][b].Sa.src="",pa[a][b].Sa.load();da.length=0;ya={};pa={}};a.pause=function(){for(var a in pa)for(var b in pa[a]){var c=pa[a][b];C(c)&&H(c)}};a.reset=function(){for(var a in pa)for(var b in pa[a])I(pa[a][b])};
a.play=function(a){for(var b in pa)for(var c in pa[b]){var d=pa[b][c];a&&!d.tt||O(d)}};a.O6=function(a,b){return b in pa&&a in pa[b]?pa[b][a]:null};a.L$=function(a){return a.ll};a.eL=O;a.WC=H;a.BL=I;a.WY=function(a,b){if(void 0 in pa&&a in pa[void 0]){var c=pa[void 0][a];c.Sa?c.Sa.currentTime=b/c.dh:c.ud&&(c.sj=b,l(c))}};a.cO=C;a.dO=function(a){return a.Sa||a.ud?a.Sa?2<=a.Sa.readyState:!0:0};a.$N=function(a){return a.Sa||a.ud?a.Sa?Math.round(a.Sa.currentTime*a.dh):a.sj:0};a.bO=function(a){return a.Sa||
a.ud?a.Sa?a.Tb:h(a,a.Tb):0};a.w0=function(a){if(!a.Sa&&!a.ud)return 0;var b=Math.min(a.ik,a.yk-a.Tb);return a.Sa?a.Tb+b:h(a,a.Tb+b)};a.jx=function(a,b){return Math.round(b*a.Os*(W.qd()/a.dh))};a.aO=function(a){return Math.min(a.ik,a.yk-a.Tb)};a.v0=h;a.n5=function(a,b){var c=k(a,b);return c&&"CANVAS"==c.source?c.cg:null};a.D$=function(a,b){var c=k(a,b);return c&&"CANVAS"==c.source?(t(c),!0):!1};a.C6=k;a.D6=function(a){var b=[];if(Z.Ra(a))d(a,b);else{a=a.ww;for(var c=0;c<a.length;c++)d(a[c],b)}return b};
a.AZ=function(a){for(var b={},c=0;c<a.length;c++){for(var d=a[c].ya,e=a[c].Md,f=[],h=[],k=0;k<d.length;k++){var g=d[k],m=e[k];if("CANVAS"==g.source)if(m in b)g=b[m];else{var n=d[k],g=q();g.source="CANVAS";g.width=n.width;g.height=n.height;g.fm=n.fm;g.type=n.type;n=document.createElement("canvas");n.width=g.width;n.height=g.height;g.cg=n.getContext("2d");g.mb=N.TEXTURE_2D;g.rb=N.createTexture();N.bindTexture(N.TEXTURE_2D,g.rb);g.fm?N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,ea[oa.rp]):N.texParameteri(N.TEXTURE_2D,
N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR);N.bindTexture(N.TEXTURE_2D,null);n=g;n.cg.drawImage(d[k].cg.canvas,0,0);t(n);b[m]=g}f.push(g);h.push(m)}a[c].ya=f}};a.wU=function(a,b){for(var c=[],d=0;d<a.length;d++)B(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ha.V(255*a,0,255)}))};a.MR=B;a.AU=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var h=a[f].data.value,k=[],g=h.curve_mapping.curves_data,
m=h.curve_mapping.curve_extend,n=h.curve_mapping.curves_handle_types,h=0;h<g.length;h++){for(var l=m[h],v=g[h],p=[],x=n[h],q=0;q<v.length;q++)p.push([new Float32Array(3),new Float32Array(v[q].concat(0)),new Float32Array(3)]);Y.gA(p[0],null,p[1],x[0],x[0]);for(q=1;q<p.length-1;q++)Y.gA(p[q],p[q-1],p[q+1],x[q],x[q]);Y.gA(p[p.length-1],p[p.length-2],null,x[p.length-1],x[p.length-1]);if(2<p.length){if("AUTO"==x[0]){V.subtract(p[0][2],p[0][1],c);q=V.length(c);V.copy(p[1][0],d);d[0]<p[0][1][0]&&(d[0]=p[0][1][0]);
V.subtract(d,p[0][1],d);var r=V.length(d);1E-8<r&&(V.scale(d,q/r,d),V.add(p[0][1],d,p[0][2]),V.subtract(p[0][1],d,p[0][0]))}v=p.length-1;"AUTO"==x[0]&&(V.subtract(p[v][0],p[v][1],c),q=V.length(c),V.copy(p[v-1][2],d),d[0]>p[v][1][0]&&(d[0]=p[v][1][0]),V.subtract(d,p[v][1],d),r=V.length(d),1E-8<r&&(V.scale(d,q/r,d),V.add(p[v][1],d,p[v][0]),V.subtract(p[v][1],d,p[v][2])))}for(v=0;v<p.length-1;v++)Y.IS(p[v][1],p[v][2],p[v+1][0],p[v+1][1]);v=[];3>=g.length?(q=Math.round(-b/2),x=Math.round(b/2)):(q=0,x=
b);for(;q<x;q++){var r=q/(x-1),B=u(p,r,!1),J=ba(p,r,!1);B&&J?v.push(Y.DG(r,B[1],B[2],J[0],J[1],.001)):J&&!B?"EXTRAPOLATED"==l?(r=J[1][0]==J[2][0]?J[1][1]:Y.sK(r,J[1],J[2]),v.push(r)):v.push(J[1][1]):B&&!J&&("EXTRAPOLATED"==l?(r=B[0][0]==B[1][0]?B[1][1]:Y.sK(r,B[0],B[1]),v.push(r)):v.push(B[1][1]))}k.push(v)}e.push(k)}c=[];for(q=0;q<e.length;q++)for(k=e[q],h=0;h<k[0].length;h++)3>=k.length?(d=ha.V(127.5*(k[0][h]+1),0,255),f=ha.V(127.5*(k[1][h]+1),0,255),g=ha.V(127.5*(k[2][h]+1),0,255),v=255):(d=ha.V(255*
k[0][h],0,255),f=ha.V(255*k[1][h],0,255),g=ha.V(255*k[2][h],0,255),v=ha.V(255*k[3][h],0,255)),c.push(d,f,g,v);return new Uint8Array(c)};a.AH=function(b,c){var d=w(a.Hh,!1);d.source="NODE_TEX";d.repeat=!1;n(d,{width:c,height:b.length/(4*c),data:b});return d};a.p3=function(a,c,d,e,f){var h=ha.nj(f);if("WORLD"!=a.type){var k=T(h,c);if(!k){k=q();k.type=c.type;k.source=c.source;k.Ys=c.Ys;k.width=c.width;k.height=c.height;k.$q=c.$q;k.vj=c.vj;k.fm=c.fm;k.cg=c.cg;k.mb=c.mb;k.rb=c.rb;k.Qe=c.Qe;k.Em=c.Em;k.vt=
c.vt;k.Sa=c.Sa;k.dy=c.dy;k.yk=c.yk;k.dh=c.dh;k.va=c.va;k.Tb=c.Tb;k.ik=c.ik;k.rg=c.rg;k.vh=c.vh;k.ud=c.ud;k.Ps=c.Ps;k.Os=c.Os;k.sj=c.sj;k.Rs=c.Rs;k.Tk=c.Tk;k.tt=c.tt;k.CE=c.CE;k.Dj=c.Dj;k.ll=c.ll;k.repeat=c.repeat;k.oo=c.oo;k.Tr=c.Tr;k.po=c.po;k.UB=c.UB;k.TB=c.TB;k.Xv=c.Xv;k.wm=c.wm;var g=k;N.bindTexture(c.mb,c.rb);var m=N.getTexParameter(c.mb,N.TEXTURE_MAG_FILTER),l=N.getTexParameter(c.mb,N.TEXTURE_MIN_FILTER),v=N.getTexParameter(c.mb,N.TEXTURE_WRAP_S);c=N.getTexParameter(c.mb,N.TEXTURE_WRAP_T);g.rb=
N.createTexture();N.bindTexture(g.mb,g.rb);N.texParameteri(g.mb,N.TEXTURE_MAG_FILTER,m);N.texParameteri(g.mb,N.TEXTURE_MIN_FILTER,l);N.texParameteri(g.mb,N.TEXTURE_WRAP_S,v);N.texParameteri(g.mb,N.TEXTURE_WRAP_T,c);N.bindTexture(g.mb,null);b(k,f,h);da.push(k);n(k,e,0)}e=k;if(Z.Ra(a))y(a,d,e);else for(a=a.ww,f=0;f<a.length;f++)y(a[f],d,e)}else k=c,b(k,f),n(k,e,0),ta.d0(a)};a.kD=K;a.Yv=G;a.le=function(a){return a.texture.s};a.zY=function(){N=null};a.aJ=function(){return da}};b4w.module.__texcomp=function(a,g){function q(a,b,c,e){var g=new Int32Array(c,0,31),q,E,F,A,D,H;if(542327876!=g[0])return t.error("Invalid magic number in DDS header"),0;if(!g[20]&4)return t.error("Unsupported format, must contain a FourCC code"),0;q=g[21];switch(q){case l:E=8;F=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case r:E=16;F=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case p:E=16;F=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return t.error("Unsupported FourCC code:",w(q)),null}H=
1;g[2]&131072&&!1!==e&&(H=Math.max(1,g[7]));A=g[4];D=g[3];g=g[1]+4;if(b)for(q=0;q<H;++q)e=Math.max(4,A)/4*Math.max(4,D)/4*E,b=new Uint8Array(c,g,e),a.compressedTexImage2D(a.TEXTURE_2D,q,F,A,D,0,b),g+=e,A=Math.max(.5*A,1),D=Math.max(.5*D,1);else if(q==l){Math.max(4,A);Math.max(4,D);c=b=new Uint16Array(c);E=g/2;F=A;var I=D,g=new Uint16Array(4);b=new Uint16Array(F*I);for(var C=0,h=0,k=h=C=q=0,J=0,y=0,d=0,B=F/4,I=I/4,u=0;u<I;u++)for(var ba=0;ba<B;ba++)q=E+4*(u*B+ba),g[0]=c[q],g[1]=c[q+1],C=g[0]&31,h=
g[0]&2016,k=g[0]&63488,J=g[1]&31,y=g[1]&2016,d=g[1]&63488,g[2]=5*C+3*J>>3|5*h+3*y>>3&2016|5*k+3*d>>3&63488,g[3]=5*J+3*C>>3|5*y+3*h>>3&2016|5*d+3*k>>3&63488,C=c[q+2],h=4*u*F+4*ba,b[h]=g[C&3],b[h+1]=g[C>>2&3],b[h+2]=g[C>>4&3],b[h+3]=g[C>>6&3],h+=F,b[h]=g[C>>8&3],b[h+1]=g[C>>10&3],b[h+2]=g[C>>12&3],b[h+3]=g[C>>14],C=c[q+3],h+=F,b[h]=g[C&3],b[h+1]=g[C>>2&3],b[h+2]=g[C>>4&3],b[h+3]=g[C>>6&3],h+=F,b[h]=g[C>>8&3],b[h+1]=g[C>>10&3],b[h+2]=g[C>>12&3],b[h+3]=g[C>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,A,D,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);e&&a.generateMipmap(a.TEXTURE_2D)}else return t.error("No manual decoder for",w(q),"and no native support"),0;return H}function c(a,b,c,e,g){var l=new XMLHttpRequest;l.open("GET",c,!0);l.responseType="arraybuffer";l.onload=function(){if(200==l.status){a.bindTexture(a.TEXTURE_2D,e);var c=q(a,b,l.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}g&&g(e)};l.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function w(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var t=g("__print"),D=g("__util"),l=b("DXT1"),r=b("DXT3"),p=b("DXT5");a.h0=q;a.i0=function(a,b,c){var e=new Uint32Array(c,0,13);if(55727696==e[0]){var g=e[7],l=e[6],p=e[11],q=52+e[12];switch(e[2]){case 0:var r=2,t=1;break;case 1:r=2;t=3;break;case 2:r=4;t=0;break;case 3:r=4;t=2;break;default:D.q("Unsupported PVR V3 format.")}}else if(559044176==
e[11]){g=e[2];l=e[1];p=e[3];q=e[0];p++;var w=e[4]&255,e=0<e[10];25==w?(r=4,t=e?2:0):24==w?(r=2,t=e?3:1):D.q("Unsupported PVR V2 format.")}else D.q("Unsupported PVR version.");w=2==r?8:4;e=4;switch(t){case 0:var I=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:I=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:I=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:I=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=w*e*r/8;for(r=0;r<p;r++){var t=Math.max(g>>r,1),C=Math.max(l>>r,1),h=t/w,k=C/e;2>h&&(h=2);2>k&&(k=2);h=
h*k*b;k=new Uint8Array(c,q,h);a.compressedTexImage2D(a.TEXTURE_2D,r,I,t,C,0,k);q+=h}};a.FJ=function(a,b){switch(b){case "dds":var c=new Int32Array(a,0,31);return{width:c[4],height:c[3]};case "pvr":c=new Uint32Array(a,0,13);if(55727696==c[0])var e=c[7],c=c[6];else e=c[2],c=c[1];return{width:e,height:c}}};a.oV=function(a,b){var c=1;if("dds"==b){var e=new Int32Array(a,0,31),g=e[21];switch(g){case l:c=6;break;case r:case p:c=4;break;default:t.error("Unsupported FourCC code:",w(g))}}else if("pvr"==b)if(e=
new Uint32Array(a,0,13),55727696==e[0])switch(e[2]){case 0:c=12;break;case 1:c=16;break;case 2:c=6;break;case 3:c=8}else g=e[4]&255,e=0<e[10],25==g?c=e?8:6:24==g&&(c=e?16:12);return c};a.N7=function(a,b,g,e){var l=a.createTexture();c(a,b,g,l,e);return l}};b4w.module.__time=function(a,g){function q(){return-1!==c.Fl.ov?c.Fl.ov:p}var c=g("__config");g("__print");var b=0,w=0,t=[],D=0,l=0,r=[],p=-1;a.nM=function(a){b=a;w=performance.now();for(a=0;a<t.length;a++){var c=t[a];b>c.lB&&(t.splice(a,1),a--,c.callback())}for(a=0;a<r.length;a++){var c=r[a],g=1-(c.lB-b)/c.duration,g=Math.min(g,1);c.callback(c.from+g*(c.to-c.from));1==g&&(r.splice(a,1),a--)}};a.lk=function(){return b};a.vx=function(a,c){var g;D++;g=D;t.push({id:g,callback:a,lB:b+(performance.now()-
w+c)/1E3});return g};a.Qn=function(a){for(var b=0;b<t.length;b++)if(t[b].id==a){t.splice(b,1);break}};a.Pn=function(a){for(var b=r.length;b--;)if(r[b].id==a){r.splice(b,1);break}};a.Oj=function(a,c,g,e){g/=1E3;var p;l++;p=l;r.push({id:p,callback:e,from:a,to:c,lB:b+g,duration:g});e(a);return p};a.reset=function(){w=b=0;t.length=0;l=D=r.length=0};a.qd=q;a.XY=function(a){p=a};a.mo=function(a){return a*q()}};b4w.module.__curve=function(a,g){function q(a,b,c,f,g){var e=f.length;g||(g=new Float32Array(e));for(var l=e+a,q=new Float32Array(l),t=1;t<=l-1;t++)q[t-1]=b>=c[t-1]&&b<c[t+1-1]?1:0;for(var w=2;w<=a;w++)for(t=1;t<=l-w;t++)q[t-1]=(0!=q[t-1]?(b-c[t-1])*q[t-1]/(c[t+w-1-1]-c[t-1]):0)+(0!=q[t+1-1]?(c[t+w-1]-b)*q[t+1-1]/(c[t+w-1]-c[t+1-1]):0);b==c[l-1]&&(q[e-1]=1);a=0;for(t=1;t<=e;t++)a+=q[t-1]*f[t-1];for(t=1;t<=e;t++)g[t-1]=0!=a?q[t-1]*f[t-1]/a:0;return g}function c(a){a=a.lw;return a[a.length-1]}function b(a){a=
a.RH;return a[a.length-1]}function w(a,b,c,f,g,e,l,q){var E=a+(b-a)/2,F=t(E,f,g,e,l)-c;q=q?q:.01;return Math.abs(F)<q?E:0<F?w(a,E,c,f,g,e,l,q):w(E,b,c,f,g,e,l,q)}function t(a,b,c,f,g){var e=1-a;return b*e*e*e+3*c*e*e*a+3*f*e*a*a+g*a*a*a}g("__print");var D=g("__util"),l=g("__vec3");a.kT=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var f=a.order_u;b.Ek=f;a=a.points;var g=a.length/5,e=[],l=g+f,g=g+2;e[0]=0;for(var t=2;t<=l;t++)e[t-1]=t>f&&t<g?e[t-
2]+1:e[t-2];b.lw=e;"2D"==c.dimensions?b.rk=!1:"3D"==c.dimensions?b.rk=!0:D.q("Wrong curve dimensions");f=[];e=[];for(c=0;c<a.length;c+=5)f.push(a[c]),f.push(a[c+1]),f.push(a[c+2]),b.rk&&f.push(a[c+3]),e.push(a[c+4]);b.BA=f;b.NE=e;a=[];for(var c=b.BA,f=b.rk?4:3,e=b.NE,l=b.lw,g=b.Ek,t=c.length/f,w=t+g,F=0,A=l[w-1]/999,O=0;1E3>O;O++){5E-6>l[w-1]-F&&(F=l[w-1]);for(var H=q(g,F,l,e),I=0;I<f;I++)for(var C=a[f*O+I]=0;C<t;C++)a[f*O+I]+=H[C]*c[f*C+I];F+=A}f=b.rk?4:3;e=new Float32Array(1E3);e[0]=0;for(c=1;1E3>
c;c+=1)l=a[(c-1)*f],g=a[(c-1)*f+1],t=a[(c-1)*f+2],w=a[c*f],F=a[c*f+1],A=a[c*f+2],e[c]=e[c-1]+Math.sqrt((w-l)*(w-l)+(F-g)*(F-g)+(A-t)*(A-t));b.RH=e;return b};a.UZ=function(a,b,g){g||(g=[]);var f=b,n=Math.max(f,0);b=n=Math.min(f,c(a));var f=a.BA,n=a.rk?4:3,e=a.NE,l=a.lw,t=a.Ek;a=f.length/n;var w=a+t;5E-6>l[w-1]-b&&(b=l[w-1]);w=new Float32Array(a);q(t,b,l,e,w);for(b=0;b<n;b++)for(e=g[b]=0;e<a;e++)g[b]+=w[e]*f[n*e+b]};a.RZ=function(a,b,c){c||(c=[]);var f=a.BA,g=a.rk?4:3,e=a.NE,l=a.lw,q=a.Ek;a=f.length/
g;var t=a+q;5E-6>l[t-1]-b&&(b=l[t-1]);var t=new Float32Array(a),w=b;b=t;var A=e.length;b||(b=new Float32Array(A));var D=new Float32Array(A),H=new Float32Array(A),I=D,C=H;I||(I=new Float32Array(A));C||(C=new Float32Array(A));for(var h=A+q,k=new Float32Array(h),J=new Float32Array(h),y=1;y<=h-1;y++)k[y-1]=w>=l[y-1]&&w<l[y+1-1]?1:0;w==l[h-1]&&(k[A-1]=1);for(var d=2;d<=q;d++)for(y=1;y<=h-d;y++){var B=0!=k[y-1]?k[y-1]/(l[y+d-1-1]-l[y-1]):0,u=0!=k[y+1-1]?-k[y+1-1]/(l[y+d-1]-l[y+1-1]):0,ba=0!=J[y-1]?(w-l[y-
1])*J[y-1]/(l[y+d-1-1]-l[y-1]):0,K=0!=J[y+1-1]?(l[y+d-1]-w)*J[y+1-1]/(l[y+d-1]-l[y+1-1]):0;k[y-1]=(0!=k[y-1]?(w-l[y-1])*k[y-1]/(l[y+d-1-1]-l[y-1]):0)+(0!=k[y+1-1]?(l[y+d-1]-w)*k[y+1-1]/(l[y+d-1]-l[y+1-1]):0);J[y-1]=B+u+ba+K}for(y=1;y<=A;y++)I[y-1]=k[y-1],C[y-1]=J[y-1];l=0;for(q=1;q<=A;q++)l+=D[q-1]*e[q-1];w=0;for(q=1;q<=A;q++)w+=H[q-1]*e[q-1];for(q=1;q<=A;q++)b[q-1]=0!=l?H[q-1]*e[q-1]/l+D[q-1]*e[q-1]*w/(l*l):0;for(e=0;e<g;e++)for(l=c[e]=0;l<a;l++)c[e]+=t[l]*f[g*l+e]};a.U9=c;a.TZ=b;a.SZ=function(a,
g){if(0>=g)return 0;var m=c(a);if(g>=b(a))return m;var f=a.RH,l=D.xu(f,g,0,f.length-1);return m*(l+(g-f[l])/(f[l+1]-f[l]))/1E3};a.nw=function(a,b,c,f,g){return c+(g-f)*(a-c)/(b-f)};a.sK=function(a,b,c){var f=b[0];b=b[1];c=(c[1]-b)/(c[0]-f);return c*a+(b-c*f)};a.DG=function(a,b,c,f,g,e){return t(w(0,1,a,b[0],c[0],f[0],g[0],e),b[1],c[1],f[1],g[1])};a.gA=function(a,b,c,f,g){var e=new Float32Array(3),q=new Float32Array(3),t=new Float32Array(3),w=new Float32Array(3),D=new Float32Array(3),A=new Float32Array(3);
l.copy(a[1],q);null==b?(l.copy(c[1],t),e[0]=2*q[0]-t[0],e[1]=2*q[1]-t[1]):l.copy(b[1],e);null==c?(l.copy(b[1],e),t[0]=2*q[0]-e[0],t[1]=2*q[1]-e[1]):l.copy(c[1],t);l.subtract(q,e,w);l.subtract(t,q,D);b=l.length(w);c=l.length(D);0==b&&(b=1);0==c&&(c=1);if("AUTO"==f||"AUTO"==g)A[0]=D[0]/c+w[0]/b,A[1]=D[1]/c+w[1]/b,e=2.5614*l.length(A),0!=e&&("AUTO"==f&&l.scaleAndAdd(q,A,-(b/e),a[0]),"AUTO"==g&&l.scaleAndAdd(q,A,c/e,a[2]));"VECTOR"==f&&l.scaleAndAdd(q,w,-1/3,a[0]);"VECTOR"==g&&l.scaleAndAdd(q,D,1/3,a[2])};
a.IS=function(a,b,c,f){var g=[],e=[],l,q,t;g[0]=a[0]-b[0];g[1]=a[1]-b[1];e[0]=f[0]-c[0];e[1]=f[1]-c[1];t=f[0]-a[0];l=Math.abs(g[0]);q=Math.abs(e[0]);0!=l+q&&l+q>t&&(l=t/(l+q),b[0]=a[0]-l*g[0],b[1]=a[1]-l*g[1],c[0]=f[0]-l*e[0],c[1]=f[1]-l*e[1])}};b4w.module.__sfx=function(a,g){function q(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return A.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;A.warn("deprecated WebAudio implementation");return null}A.warn("WebAudio is not supported");return null}function c(a,c,d){var e=a.Y;if("NONE"!=e.behavior){var f=e.loop,h=e.pitch;if(e.src&&(f||0<=d)){e.Tz=Math.floor(5E4*Math.random());var g=K.currentTime+c,g=
Math.max(0,g);e.pf=g;e.state=20;var k=G.Qc;"POSITIONAL"==e.behavior&&"none"==k.pr&&(e.behavior="BACKGROUND_SOUND");b(a,G.Qc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){c=K.createBufferSource();c.buffer=e.src;c.playbackRate.value=h;if(f){e.fc&&e.fc.disconnect();e.Ld&&e.Ld.disconnect();c.loop=!0;c.loopStart=e.vK;if(c.loopEnd=e.qw)d=K.createBufferSource(),d.buffer=e.src,d.playbackRate.value=h,e.Ld=d,d.connect(e.Gd);c.start(g);e.duration=0}else f=c.buffer?c.buffer.duration:0,d>f?(f=
g+d+e.If,c.loop=!0,c.start(g),c.stop(f),e.duration=d):(c.loop=!1,c.start(g),e.duration=f);c.connect(e.Gd);e.fc=c;t(e);D(e);l(e)}else"BACKGROUND_MUSIC"==e.behavior&&(H.Qn(e.Uz),H.Qn(e.Vz),d=function(){var b=a.Y,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.fc=b.fc||K.createMediaElementSource(c),b.fc.connect(b.Gd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():e.Uz=H.vx(d,1E3*c),e.duration=f?0:E(a));r(e,g)}}}function b(a,b){var c=a.Y;if(!c.Gd){var d=I.G(a.k.n),e=I.R(a.k.n);if(J.yw){var f=
K.createBiquadFilter();f.type="peaking"}else f=null;var g=K.createGain();switch(c.behavior){case "POSITIONAL":var k=K.createPanner();"string"!=typeof k.panningModel?(k.panningModel=k.EQUALPOWER,k.distanceModel=k.INVERSE_DISTANCE):(k.panningModel="equalpower",k.distanceModel=b.pr);k.setPosition(d[0],d[1],d[2]);h.copy(d,c.hC);d=y;C.ec(e,C.Mc,d);k.setOrientation(d[0],d[1],d[2]);k.refDistance=c.or;k.maxDistance=c.Yg;k.rolloffFactor=c.uq;k.coneInnerAngle=c.uH;k.coneOuterAngle=c.vH;k.coneOuterGain=c.wH;
var m=K.createGain();m.gain.value=M(c);f?(k.connect(f),f.connect(m)):k.connect(m);m.connect(g);c.Gd=k;if(c.tn){var l=K.createGain();g.connect(l);l.connect(b.Gd)}else l=null,g.connect(b.Gd);break;case "BACKGROUND_SOUND":k=null;m=K.createGain();m.gain.value=M(c);f?(c.Gd=f,f.connect(m)):c.Gd=m;m.connect(g);c.tn?(l=K.createGain(),g.connect(l),l.connect(b.Gd)):(l=null,g.connect(b.Gd));break;case "BACKGROUND_MUSIC":l=k=null,m=K.createGain(),m.gain.value=M(c),f?(c.Gd=f,f.connect(m)):c.Gd=m,m.connect(g),
g.connect(b.Gd)}c.UC=k;c.bh=f;c.ko=m;c.hk=g;c.hD=l}}function w(a){var b=a.Y,d=b.duration,b=b.delay+b.$H*Math.random();c(a,b,d)}function t(a){var b=a.Ld||a.fc;C.bi(b.onended)&&(b.onended=function(){a.state=50})}function D(a){a.tn&&a.hD.gain.cancelScheduledValues(a.pf);a.Mo&&(a.fc.playbackRate.cancelScheduledValues(a.pf),a.Ld&&a.Ld.playbackRate.cancelScheduledValues(a.pf));a.ut=a.pf}function l(a){if(a.tn||a.Mo){var b=a.hD,c=a.fc,d=c.buffer?c.buffer.duration:0;if(d){var e=a.pf;P[0]=a.Tz;for(var f=0;5>
f;){var h=a.pitch+a.Mo*C.zg(P);if(e>=a.ut){if(a.tn){var g=1-C.V(a.tn,0,1)*Math.random();b.gain.setValueAtTime(g,e)}a.Mo&&(c.playbackRate.setValueAtTime(h,e),a.Ld&&a.Ld.playbackRate.setValueAtTime(h,e));f++}e+=d/h}a.ut=e-.001}}}function r(a,b){if(a.gm||a.If){var c=a.hk;c.gain.cancelScheduledValues(b);a.gm?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.gm)):c.gain.setValueAtTime(1,b);a.If&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+
a.If))}}function p(a){"SPEAKER"!=a.type&&C.q("Wrong object type");var b=a.Y;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.hk,d=K.currentTime;b.If&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.If));"BACKGROUND_MUSIC"==b.behavior?b.src&&(H.Qn(b.Uz),H.Qn(b.Vz),b.Vz=H.vx(function(){var b=a.Y.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.If)):(c=b.fc,b.duration<c.buffer.duration?b.If&&20==b.state?c.stop(d+b.If):20==b.state&&(c.stop(0),c.disconnect()):
c.disconnect(),b.pf=0,b.VC=0,b.dA=0);b.state=30}}function m(a){a=a.Y;if(20==a.state){var b=K.currentTime;a.VC=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.dA=b>a.pf?f(a,b):0,a.fc.onended=function(){},a.fc.stop(0),a.fc.disconnect(),D(a));a.state=40}}function f(a,b){P[0]=a.Tz;for(var c=a.fc.buffer.duration,d=a.pf,e;d<b;)e=a.pitch+a.Mo*C.zg(P),d+=c/e;return(c/e-(d-b))*e}function n(a){var b=a.Y;if(40==b.state){var c=K.currentTime;b.pf+=c-b.VC;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();
else{a=a.Y;var d=K.createBufferSource();d.loop=a.fc.loop;d.loopStart=a.fc.loopStart;d.loopEnd=a.fc.loopEnd;d.buffer=a.fc.buffer;d.playbackRate.value=a.fc.playbackRate.value;d.connect(a.Gd);a.fc=d;a.Ld&&(d=K.createBufferSource(),d.loop=a.Ld.loop,d.buffer=a.Ld.buffer,d.playbackRate.value=a.Ld.playbackRate.value,d.connect(a.Gd),a.Ld=d);b.ut=c;c=b.fc;t(b);c.start(b.pf,b.dA);l(b)}r(b,b.pf);b.state=20}}function e(a,b,c){var d=1,d=b.fU;if(0<d){var e=b.PZ;if(0!=h.dot(a.cy,a.cy)||0!=h.dot(b.Km,b.Km)){var f=
h.subtract(a.hC,b.di,y),g=h.length(f);b=h.dot(f,b.Km)/g;f=h.dot(f,a.cy)/g;f=-f;g=e/d;b=Math.min(-b,g);f=Math.min(f,g);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=C.Zb(d,a.oK,c,.3);a.fc.playbackRate.value=d;a.oK=d}}}function z(a){a=a.Y;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function M(a){return a.muted?0:a.volume}function E(a){a=a.Y;return(a=a.src)?a.duration:0}var F=g("__config"),A=g("__print"),O=g("__quat"),H=g("__time"),I=g("__tsr"),C=g("__util"),
h=g("__vec3"),k=F.B,J=F.Y,y=new Float32Array(3),d=new Float32Array(3);new Float32Array(3);var B=O.create(),u=[],ba=[],K=null,G=null,T=[],P=[1],X=null;a.TE=10;a.sy=20;a.SE=30;a.hT=function(){return{Ej:-1,ah:"",behavior:"NONE",muted:!1,volume:1,pitch:1,uq:1,or:1,Yg:1E4,uH:360,vH:360,wH:1,autoplay:!1,Ce:!1,loop:!1,vK:0,qw:0,delay:0,$H:0,tn:0,Mo:0,gm:0,If:0,pf:0,VC:0,dA:0,duration:0,ut:0,Tz:1,src:null,state:10,hC:new Float32Array(3),cy:new Float32Array(3),gv:!1,oK:1,Uz:-1,Vz:-1,dm:0,Gd:null,fc:null,Ld:null,
UC:null,bh:null,ko:null,hk:null,hD:null,jl:0}};a.fh=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(u.push("ogg"),u.push("ogv"),u.push("oga")),""!=a.canPlayType("audio/mpeg")&&u.push("mp3"),""!=a.canPlayType("audio/mp4")&&(u.push("mp4"),u.push("m4v"),u.push("m4a")),""!=a.canPlayType("audio/webm")&&u.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(ba.push("ogv"),ba.push("ogg"),ba.push("oga")),""!=b.canPlayType("video/mp4")&&
(ba.push("m4v"),ba.push("mp4")),""!=b.canPlayType("video/webm")&&ba.push("webm"),""!=b.canPlayType("video/mpeg")&&ba.push("mp3"))};a.rR=function(a){J.ME&&!K&&(K=q())&&A.log("%cINIT WEBAUDIO: "+K.sampleRate+"Hz","color: #00a");if(K){var b={di:new Float32Array(3),Km:new Float32Array(3),jl:0},c=K.createGain(),d=K.createGain();b.ko=c;b.hk=d;c.connect(d);d.connect(K.destination);if(a.b4w_enable_dynamic_compressor){var d=K.createDynamicsCompressor(),e=a.b4w_dynamic_compressor_settings;d.threshold.value=
e.threshold;d.knee.value=e.knee;d.ratio.value=e.ratio;d.attack.value=e.attack;d.release.value=e.release;d.connect(c);b.ar=d;b.Gd=d}else b.ar=null,b.Gd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.pr="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.pr="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.pr="exponential";break;case "NONE":b.pr="none";break;default:C.q("Wrong audio distance model")}b.fU=a.audio_doppler_factor;b.PZ=a.audio_doppler_speed;b.muted=!1;
b.volume=a.audio_volume;c.gain.value=M(b);b.dm=0}else b=null;a.Qc=b};a.LY=function(a){G=a};a.ZT=function(a){a||(a="ogg");return-1<u.indexOf(a)?a:-1<u.indexOf("m4a")?"m4a":-1<u.indexOf("oga")?"oga":""};a.aU=function(a){a||(a="webm");return-1<ba.indexOf(a)?a:-1<ba.indexOf("m4v")?"m4v":-1<ba.indexOf("webm")?"webm":""};a.kl=function(a,b){var c=a.data,d=b.Y;d.Ej=a.data.sound.uuid;d.ah=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=K?c.b4w_behavior:"NONE";
break;case "BACKGROUND_MUSIC":var e;K?(window.MediaElementAudioSourceNode?e=!0:(A.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!k.kH?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:C.q("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.gv=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.uq=c.attenuation;d.or=c.distance_reference;d.Yg=c.distance_max||1E4;d.uH=c.cone_angle_inner;d.vH=c.cone_angle_outer;d.wH=c.cone_volume_outer;d.autoplay=
c.b4w_auto_play;d.Ce=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.vK=c.b4w_loop_start;d.qw=c.b4w_loop_end;d.delay=c.b4w_delay;d.$H=c.b4w_delay_random;d.tn=c.b4w_volume_random;d.Mo=c.b4w_pitch_random;d.gm=c.b4w_fade_in;d.If=c.b4w_fade_out;T.push(b)};a.KM=function(b){"SPEAKER"!=b.type&&C.q("Wrong object type");switch(b.Y.behavior){case "POSITIONAL":return a.sy;case "BACKGROUND_SOUND":return a.sy;case "BACKGROUND_MUSIC":return a.SE;case "NONE":return a.TE;default:C.q("Wrong speaker behavior")}};a.e0=function(a,
b){var c=a.Y;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:C.q("Wrong speaker behavior")}};a.dL=function(){var a=K.createBufferSource();a.buffer=K.createBuffer(1,22050,22050);a.connect(K.destination);a.start(0)};a.XT=function(a,b,c){K?K.decodeAudioData(a,b,c):c()};a.MZ=function(a){p(a);a.Y=null;T.splice(T.indexOf(a),1)};a.ua=function(){for(var a=0;a<T.length;a++){var b=T[a].Y;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():
(b.fc&&b.fc.disconnect(),b.Ld&&b.Ld.disconnect())}G&&G.Qc&&(a=G.Qc,a.di[0]=0,a.di[1]=0,a.di[2]=0,a.Km[0]=0,a.Km[1]=0,a.Km[2]=0);G=null;T.splice(0);X=null};a.update=function(a){if(K&&0!=T.length){for(var b=0;b<T.length;b++){var c=T[b],d=c.Y,e=d.fc,f=K.currentTime;!d.loop&&20==d.state&&d.duration&&d.pf+d.duration<f&&("BACKGROUND_MUSIC"==d.behavior||e&&!C.bi(e.onended))&&(d.state=50);d.Ce&&50==d.state&&w(c);20==d.state&&3>d.ut-f&&l(d)}X&&X.wj.length&&(-1==X.Gc||a>X.bG+X.eI[X.Gc])&&(b=X,-1<b.Gc&&p(b.wj[b.Gc]),
-1==b.Gc&&b.random?c=Math.round(Math.random()*(b.wj.length-1)):b.random?(c=1+Math.round(Math.random()*(b.wj.length-2)),c=(b.Gc+c)%b.wj.length):c=(b.Gc+1)%b.wj.length,w(b.wj[c]),b.Gc=c,b.bG=a)}};a.play=c;a.cL=w;a.stop=p;a.BW=function(a){return 20==a.Y.state};a.R9=m;a.S9=n;a.Q7=function(a,b){var c=a.Y,d=c.Ld;if(z(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var e=K.currentTime+b;c.fc.stop(e);d.start(e,c.qw)}};a.YX=function(a,b){var c=a.Y;c.pitch=b;!z(a)||"POSITIONAL"!=c.behavior&&
"BACKGROUND_SOUND"!=c.behavior||(c.fc.playbackRate.value=b,c.Ld&&(c.Ld.playbackRate.value=b),D(c),l(c))};a.n6=function(a){return a.Y.pitch};a.Ce=function(a,b){a.Y.Ce=Boolean(b)};a.qW=function(a){return a.Y.autoplay};a.tW=function(a){return a.Y.Ce};a.YW=function(a,b,c,f,g){if(a=a.Qc){var k=y;k[0]=0;k[1]=0;k[2]=-1;h.transformQuat(k,c,k);d[0]=0;d[1]=1;d[2]=0;h.transformQuat(d,c,d);c=K.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(k[0],k[1],k[2],d[0],d[1],d[2]);if(f&&a.jl!=g){if(a.oC)a.oC=!1,
h.copy(b,a.di);else for(c=a.Km,c[0]=(b[0]-a.di[0])/f,c[1]=(b[1]-a.di[1])/f,c[2]=(b[2]-a.di[2])/f,h.copy(b,a.di),b=0;b<T.length;b++)c=T[b],k=c.Y,z(c)&&"POSITIONAL"==k.behavior&&k.gv&&e(k,a,f);a.jl=g}else h.copy(b,a.di)}};a.oC=function(){var a=G.Qc;a&&(a.oC=!0)};a.NZ=function(a,b,c){var f=a.Y;if(z(a)&&"POSITIONAL"==f.behavior){var g=I.jc(a.k.n,y);a=I.Zd(a.k.n,B);var k=f.UC;k.setPosition(g[0],g[1],g[2]);C.ec(a,C.Mc,d);k.setOrientation(d[0],d[1],d[2]);f.gv&&(a=f.hC,b&&f.jl!=c?(f.kn?(h.copy(g,a),f.kn=
!1):(k=f.cy,k[0]=(g[0]-a[0])/b,k[1]=(g[1]-a[1])/b,k[2]=(g[2]-a[2])/b,h.copy(g,a),e(f,G.Qc,b)),f.jl=c):h.copy(g,a))}};a.T9=function(a){var b=a.Y;z(a)&&"POSITIONAL"==b.behavior&&b.gv&&(b.kn=!0)};a.IB=function(a){return a.Y.behavior};a.r3=function(){for(var a=0;a<T.length;a++)if(z(T[a]))return!0;return!1};a.j9=function(a){var b=G.Qc;b&&(b.volume=a,K&&(b.ko.gain.value=M(b)))};a.W5=function(){var a=G.Qc;return a?a.volume:0};a.tZ=function(a,b){var c=a.Y;c.volume=b;z(a)&&(c.ko.gain.value=M(c))};a.S6=function(a){return a.Y.volume};
a.qc=function(a,b){a.Y.muted=Boolean(b);z(a)&&(a.Y.ko.gain.value=M(a.Y))};a.E7=function(a){return a.Y.muted};a.X7=function(a){var b=G.Qc;b&&(b.muted=Boolean(a),K&&(b.ko.gain.value=M(b)))};a.D7=function(){var a=G.Qc;return a?a.muted:!1};a.NV=function(){return T};a.pause=function(){for(var a=0;a<T.length;a++)m(T[a])};a.qj=function(){for(var a=0;a<T.length;a++)n(T[a])};a.X8=function(a,b){if(a.Qc&&a.Qc.ar){var c=a.Qc.ar;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=
b.attack;c.release.value=b.release}};a.r5=function(a){if(!a.Qc||!a.Qc.ar)return null;a=a.Qc.ar;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.t4=function(a,b,c){if(z(a)){a=a.Y;var d=a.hk,e=K.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.dm=c}};a.v$=function(a){if(z(a)){a=a.Y;var b=a.hk,c=K.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.dm);
a.dm=0}};a.u4=function(a,b){if(K){var c=G.Qc,d=c.hk,e=K.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.dm=b}};a.w$=function(){if(K){var a=G.Qc,b=a.hk,c=K.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.dm);a.dm=0}};a.Y2=function(a,b,c){X={Gc:-1,bG:0,random:c,wj:[],eI:[]};for(c=0;c<a.length;c++){var d=a[c],e=E(d);0==e?A.warn("Ignoring speaker with zero duration: "+d.name):(p(d),d.Y.Ce=!1,X.wj.push(d),X.eI.push(e+b))}};
a.x5=E;a.L3=function(){if(X)for(var a=X.wj,b=0;b<a.length;b++)p(a[b]);X=null};a.r6=function(a){return(a=a.Y)&&"POSITIONAL"==a.behavior?{dist_ref:a.or,dist_max:a.Yg,attenuation:a.uq}:null};a.w9=function(a,b){var c=a.Y;if(c&&"POSITIONAL"==c.behavior){c.or=b.dist_ref;c.Yg=b.dist_max;c.uq=b.attenuation;var d=c.UC;d&&(d.refDistance=c.or,d.maxDistance=c.Yg,d.rolloffFactor=c.uq)}};a.c9=function(a,b){var c=a.Y;c&&c.bh&&(c.bh.frequency.value=b.freq,c.bh.Q.value=b.Q,c.bh.gain.value=b.gain)};a.D5=function(a){return(a=
a.Y)&&a.bh?{freq:a.bh.frequency.value,Q:a.bh.Q.value,gain:a.bh.gain.value}:null};a.C5=function(a,b,c,d){a=a.Y;if(!a||!a.bh)return null;a.bh.getFrequencyResponse(b,c,d)};a.reset=function(){u.length=0;ba.length=0;K=null}};b4w.module.__shaders=function(a,g){function q(a,b,d){var e=a.Si;"string"==typeof d?(a=c(a,d))&&(d=a[1]):d=String(d);for(a=0;a<e.length;a++)if(e[a][0]==b){e[a][1]=d;break}}function c(a,b){for(var c=a.Si,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in T)){var d=e(u.shaders_path,a),f=e(u.shaders_path,b),d=M(d),f=M(f),h;for(h in f)d[h]=f[h];f=[];for(h in d)f.push([h,d[h]]);T[c]=f}return T[c]}function w(a,b){return a+b}function t(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(w,0)}function D(a,b){var c=n(a.type),d=n(b.type),e=a.Hl,f=b.Hl;return c>d?-1:c<d?1:e>f?-1:e<f?1:0}function l(a){if(d.gc){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ka}else b=ca;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],Hl:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return p(a,W,B.uw)}function r(a,b,c){a=a.split(";").map(function(a){return(a=a.match(x))&&{type:a[2],Hl:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return p(a,b,c)}function p(a,b,c){function d(){for(var c=0;v<a.length;){var e=a[v];if(3!=n(e.type))break;c+=f(e.type)*e.Hl;v++}k=l+c;if(k>Y)return!1;m(b,l,c,0,3);return!0}function e(){for(var c=Y-k,d=c,h=c;v<a.length;){var g=a[v];if(2!=n(g.type))break;g=f(g.type)*g.Hl;if(g<=d)d-=g;else if(g<=h)h-=g;else return!1;v++}h=c-h;m(b,k,c-d,0,2);m(b,Y-h,h,2,2);return!0}function h(){for(;v<a.length;){for(var d=a[v],d=f(d.type)*d.Hl,e=-1,g=c+1,k=-1,l=0;4>l;l++){var n=Q;n[0]=
0;n[1]=1;var p;p=b;for(var u=l,q=d,r=n;Z<p.length&&15===p[Z];)Z++;for(;0<Y&&15===p[Y];)Y--;if(Y-Z<q)p=!1;else{for(var u=1<<u,x=0,B=-1,J=p.length+1,t=!1,y=Z;y<=Y;y++)y<Y&&!(p[y]&u)?t||(x=y,t=!0):(t&&(t=y-x,t>=q&&t<J&&(J=t,B=x)),t=!1);0>B?p=!1:(r[0]=B,r[1]=J,p=!0)}p&&n[1]<g&&(k=n[0],g=n[1],e=l)}if(0>e)return!1;m(b,k,d,e,1);v++}return!0}if(!a.length)return!0;for(var g=0;g<c;g++)b[g]=0;Y=c;a.sort(D);var k=0,l=0,v=0;return function(){for(;v<a.length;){var c=a[v];if(4!=n(c.type))break;l+=f(c.type)*c.Hl;
v++}if(l>Y)return!1;Z=l;m(b,0,l,0,4);return!0}()&&d()&&e()&&h()}function m(a,b,c,d,e){for(var f=0,h=0;h<e;h++)f|=1<<d+h;for(h=0;h<c;h++)a[b+h]|=f}function f(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function n(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}function e(a,
b){var c=a+b;if(K[c])return K[c];if(G){var d=G[b];if(!d)return null;d=g("__gpp_parser").m8.parse(d)}else if(d=g("shader_texts")[b],!d)return null;return K[c]=d}function z(a,b){for(var c={},e=b.Si||[],f=0;f<e.length;f++)c[e[f][0]]=[e[f][1]];for(f=0;f<b.ug.length;f++)c["USE_NODE_"+b.ug[f].id]=["1"];d.gc?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],c.GLSL_TEXTURE_PROJ=
["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=d.Yq?["sampler2DShadow"]:["sampler2D"];for(var h in c)c[h][0].constructor!=String&&J.warn("Warning! The value of a directive '"+h+"' is not of type string.");return c}function M(a){function b(a){"var"==
a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=e(u.shaders_path,u.xM+a.o),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var e=0;e<a.length;e++)c(a[e],b,d);else if(a instanceof Object&&a){b&&b(a);for(e in a)c(a[e],b,d);d&&d(a)}}var d={};c(a,b);return d}function E(a,b,c){function f(b){b=b.d;for(var c=0;c<b.length;c++){var d=b[c];switch(d.a){case "cond":a:for(var d=d.d,n=0;n<d.length;n++){var B=d[n];switch(B.a){case "if":case "elif":if(h(B.g)){f(B.h);break a}break;case "else":f(B.h);break a;case "ifdef":B.c in
q&&f(B.h);break;case "ifndef":B.c in q||f(B.h)}}break;case "include":d=d.o;n=e(u.shaders_path,u.xM+d);x.push("include/"+d);f(n);x.pop();break;case "var":break;case "define":q[d.c]=d.b;break;case "error":y.q("Shader error: #error "+d.b.join(" "));break;case "line":break;case "pragma":p.push("#pragma "+d.c+" "+d.b.join(" "));break;case "undef":delete q[d.c];break;case "warning":J.warn("Shader warning: #warning "+d.b.join(" "));break;case "extension":d=l(d.b,q,r,!1);p.push("#extension "+d.join(" "));
break;case "version":d=l(d.b,q,r,!1),p.push("#version "+d.join(" "));case "#":break;case "node":t[d.c]=d;break;case "nodes_global":d=v;for(n=0;n<d.length;n++){var B=d[n],G=t[B.id];if(G)for(var Q=0,K=0;K<G.l.length;K++){var z=G.l[K];if("node_param"==z.a){var P;if("PARTICLE_INFO"==B.id&&z.e)if(1==q.PARTICLE_BATCH)switch(P=!1,Q){case 0:P=I(B.Rb,"PART_INFO_IND")||I(B.Rb,"PART_INFO_AGE")||I(B.Rb,"PART_INFO_LT")||I(B.Rb,"PART_INFO_SIZE");break;case 1:P=I(B.Rb,"PART_INFO_LOC");break;case 2:P=I(B.Rb,"PART_INFO_VEL");
break;case 3:P=I(B.Rb,"PART_INFO_A_VEL");break;case 4:P=I(B.Rb,"PART_INFO_IND")}else P=!1;else P=!0;P&&(z=z.f.join(" ")+" ","vert"==a?z+=B.xi[Q]:"frag"==a&&(z+=B.qb[Q],null!==B.Pw[Q]&&(z+="="+B.Pw[Q])),z+=";",m(k(z)));Q++}}}break;case "nodes_main":d=v;for(n=0;n<d.length;n++)if(B=d[n],G=t[B.id]){Q={};V=T=w=0;K=G;z=B;P=K;for(var A={},Z=0;Z<P.m.length;Z++){var E=P.m[Z];A[E.c]=[E.b.join("")]}P=A;for(A=0;A<z.Rb.length;A++)Z=z.Rb[A][0],Z in P&&(P[Z]=[z.Rb[A][1]]);for(A=Z=0;A<K.l.length;A++)E=K.l[A],"node_out"==
E.a&&(P["USE_OUT_"+E.c]=[-1<C.indexOf(z.fb[Z])|0],Z++);K=P;z=B;P=G.l;A=Q;Z=K;for(E=0;E<P.length;E++){var D=P[E];switch(D.a){case "node_in":var M=z.M[w];if(null!==z.XB[w]){if(("MATERIAL_BEGIN"==z.id&&3===w||!Z.MATERIAL_EXT&&("MATERIAL_BEGIN"==z.id&&4===w||"MATERIAL_END"==z.id&&3===w||"MATERIAL_END"==z.id&&4===w||"MATERIAL_END"==z.id&&5===w)||"TEXTURE_COLOR"==z.id||"TEXTURE_NORMAL"==z.id)&&D.e){A[D.c]=z.XB[w];w++;continue}var H=D.f.join(" ")+" ",H=H+(M+"="+z.XB[w]+";");m(k(H))}A[D.c]=M;w++;break;case "node_out":M=
z.fb[T];if(!D.e||-1<C.indexOf(M))H=D.f.join(" ")+" ",H+=M+";",m(k(H)),A[D.c]=M;T++;break;case "node_param":"vert"==a?M=z.xi[V]:"frag"==a&&(M=z.qb[V]),A[D.c]=M,V++}}p.push("{");g(B,G.j,Q,K);p.push("}")}break;case "txt":m(d.b);break;default:y.q("Unknown element type: "+d.a)}}}function h(a,b){var c;c=l(a,q,r,!0,b);for(var d=[],e=0;e<c.length;e++)if(c[e]instanceof Object)switch(c[e].a){case "conditional_expr":var f=d.pop(),g=d.pop();d.pop()?d.push(g):d.push(f);break;case "logical_or_expr":for(var g=d.pop(),
k=0;k<c[e].i-1;k++)f=d.pop(),g=g||f;d.push(g);break;case "logical_and_expr":g=d.pop();for(k=0;k<c[e].i-1;k++)f=d.pop(),g=g&&f;d.push(g);break;case "logical_bitor_expr":g=d.pop();for(k=0;k<c[e].i-1;k++)g|=d.pop();d.push(g);break;case "logical_bitxor_expr":g=d.pop();for(k=0;k<c[e].i-1;k++)g^=d.pop();d.push(g);break;case "logical_bitand_expr":g=d.pop();for(k=0;k<c[e].i-1;k++)g&=d.pop();d.push(g);break;case "equal_expr":f=d.pop();g=d.pop();d.push(g==f);break;case "non_equal_expr":f=d.pop();g=d.pop();
d.push(g!=f);break;case "le_expr":f=d.pop();g=d.pop();d.push(g<=f);break;case "ge_expr":f=d.pop();g=d.pop();d.push(g>=f);break;case "l_expr":f=d.pop();g=d.pop();d.push(g<f);break;case "g_expr":f=d.pop();g=d.pop();d.push(g>f);break;case "left_shift_expr":g=d.pop();f=d.pop();d.push(g<<f);break;case "right_shift_expr":g=d.pop();f=d.pop();d.push(g>>f);break;case "add_expr":g=d.pop();f=d.pop();d.push(g+f);break;case "sub_expr":g=d.pop();f=d.pop();d.push(g-f);break;case "mul_expr":g=d.pop();f=d.pop();d.push(g*
f);break;case "div_expr":g=d.pop();f=d.pop();d.push(g/f);break;case "mod_expr":g=d.pop();f=d.pop();d.push(g%f);break;case "pre_inc_expr":case "post_inc_expr":f=d.pop();d.push(++f);break;case "pre_dec_expr":case "post_dec_expr":f=d.pop();d.push(--f);break;case "positive_expr":f=d.pop();d.push(+f);break;case "negative_expr":f=d.pop();d.push(-f);break;case "one_compl_expr":f=d.pop();d.push(~f);break;case "logic_negative_expr":f=d.pop();d.push(!f);break;default:y.q("Unknown operation type: "+c[e].a)}else f=
c[e],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(f)?(d.push(0),0!=f.indexOf("USE_NODE_")&&(g=x[x.length-1],g in B||(B[g]=[]),-1==B[g].indexOf(f)&&(B[g].push(f),J.error("Undefined directive '"+f+"' in shader '"+g+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[e]));1==d.length?c=d[0]:(y.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function g(a,b,c,d){for(var e=0;e<b.length;e++){var f=b[e];switch(f.a){case "node_cond":a:for(var k=a,f=f.d,l=c,n=d,v=0;v<f.length;v++){var p=
f[v];switch(p.a){case "node_if":case "node_elif":if(h(p.g,n)){g(k,p.j,l,n);break a}break;case "node_else":g(k,p.j,l,n);break a;case "node_ifdef":(p.c in q||p.c in n)&&g(k,p.j,l,n);break;case "node_ifndef":p.c in q||p.c in n||g(k,p.j,l,n)}}break;case "txt":k=[];for(l=0;l<f.b.length;l++)n=f.b[l],n in c?k.push(c[n]):k.push(n);m(k,d)}}}function k(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function m(b,c){var e=b;d.gc||"frag"!=a||(e=e.join(" "),K&&(e.match(/[^;]*;/)?(e=e.replace(/[^;]*;/,""),K=!1):
e=""),e=e.replace(/GLSL_OUT [^;]*;/g,""),e.match(/GLSL_OUT(?:$| [^;]*)/)&&(e=e.replace(/GLSL_OUT(?:$| [^;]*)/,""),K=!0),e=e.replace(/ {2,}/g," "),e=(e=e.trim())?e.split(" "):[]);b=e;b.length&&(e=l(b,q,r,!1,c),p.push(e.join(" ")))}function l(a,b,c,d,e){var f=[];n(a,b,c,d,f,e);return f}function n(a,b,c,d,e,f){for(var h=0;h<a.length;h++){var g=a[h];if(f&&g in f)g=f[g];else if(g in b)g=b[g];else{e.push(g);continue}0==g.length&&d?e.push(0):n(g,b,c,d,e,f)}}var v=c.ug,p=[],q=z(a,c),r={},x=[c[a]],B={},t=
{},C=[],G;for(G in v)for(var Q in v[G].M)C.push(v[G].M[Q]);var K=!1;f(b);var w=0,T=0,V=0;return p.join("\n")}function F(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function A(a){ta.deleteProgram(a.ji);ta.deleteShader(a.iy);ta.deleteShader(a.pv);delete ba[a.PD]}function O(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return H(a);case 2:return"vec2("+H(a[0])+","+H(a[1])+")";case 3:return"vec3("+H(a[0])+","+H(a[1])+","+H(a[2])+")";case 4:return"vec4("+H(a[0])+
","+H(a[1])+","+H(a[2])+","+H(a[3])+")";case 9:return"mat3("+H(a[0])+","+H(a[1])+","+H(a[2])+","+H(a[3])+","+H(a[4])+","+H(a[5])+","+H(a[6])+","+H(a[7])+","+H(a[8])+")";case 16:return"mat4("+H(a[0])+","+H(a[1])+","+H(a[2])+","+H(a[3])+","+H(a[4])+","+H(a[5])+","+H(a[6])+","+H(a[7])+","+H(a[8])+","+H(a[9])+","+H(a[10])+","+H(a[11])+","+H(a[12])+","+H(a[13])+","+H(a[14])+","+H(a[15])+")";default:y.q("Wrong glsl value dimension")}}function H(a){return a%1?String(a):String(a)+".0"}function I(a,b){for(var c=
0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var C=g("__assets"),h=g("__config"),k=g("__debug"),J=g("__print"),y=g("__util"),d=h.B,B=h.Mi,u=h.Ie,ba={},K={},G=null,T={},P="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.Cz=0;a.wO=1;a.vO=2;a.zO=4;a.yO=8;a.xO=16;a.qO=32;var X=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,x=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ka=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,ca=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
Q=new Int16Array(2),W=null,ha=null,v=null,Z=0,Y=0,V=[],ta=null,oa=!1;a.Tf=function(a){ta=a};a.ha=q;a.sV=c;a.SY=function(a){a.Si=y.Ph(b(a.Eg,a.bf));q(a,"PRECISION",h.B.precision);"highp"==h.B.precision?q(a,"EPSILON",O(1E-6)):q(a,"EPSILON",O(1E-4));q(a,"CONSTANTS_HACK",d.OD|0);q(a,"SRGB",d.srgb_type);q(a,"COMPARED_MODE",d.Yq|0)};a.Q6=function(a){return a.Eg};a.H5=function(a){return a.bf};a.nV=function(a){var b=JSON.stringify(a.Eg)+JSON.stringify(a.bf)+JSON.stringify(a.Si)+JSON.stringify(a.ug),c=ba[b];
if(c)return c;var f=a.bf,h=e(u.shaders_path,a.Eg),f=e(u.shaders_path,f);if(!h||!f)return null;var h=E("vert",h,a),f=E("frag",f,a),c=0,g=t(f,X);a.jN=g;g>B.xC&&(c|=1);W||(W=new Uint32Array(B.uw));ha||(ha=new Uint32Array(B.tw));v||(v=new Uint32Array(B.ms));r(f,ha,B.tw)||(c|=2);r(h,v,B.ms)||(c|=4);g=d.gc?(h.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(h.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.tG=g;g>B.yC&&(c|=8);l(f)||(c|=16);a.status=c;if(0===
a.status){var c=ta,m=F(c,h,c.VERTEX_SHADER),n=F(c,f,c.FRAGMENT_SHADER),g=c.createProgram();c.attachShader(g,m);c.attachShader(g,n);c.linkProgram(g);for(var m={iy:m,pv:n,ji:g,attributes:{},mn:{},xs:y.ak(),XC:y.ak(),YC:{},ps:!0,Ew:!1,wN:y.ak(),vN:y.ak(),hb:y.Ph(a),PD:b,dg:!0},p=c.getProgramParameter(g,c.ACTIVE_ATTRIBUTES),n=0;n<p;n++){var q=c.getActiveAttrib(g,n).name;m.attributes[q]=c.getAttribLocation(g,q)}p=c.getProgramParameter(g,c.ACTIVE_UNIFORMS);for(n=0;n<p;n++)q=c.getActiveUniform(g,n).name.split("[0]").join(""),
m.mn[q]=c.getUniformLocation(g,q);ba[b]=c=m;g=!ta.getShaderParameter(c.pv,ta.COMPILE_STATUS);m=!ta.getShaderParameter(c.iy,ta.COMPILE_STATUS);n=!ta.getProgramParameter(c.ji,ta.LINK_STATUS);g?k.yL(c.pv,b,f):m?k.yL(c.iy,b,h):n&&k.vY(c.ji,b,h,f);if(g||m||n)a.status|=32,c=null}else c=null;return c};a.ZW=function(){oa=!1;if(b4w.module_check("shader_texts"))oa=!0;else{for(var a=[],b=C.vy,c=0;c<P.length;c++){var d=y.nj(u.shaders_path+P[c]);a.push({id:P[c],type:b,url:d})}b=function(a,b){G||(G={});G[b]=a};
a.length?C.Wd(a,b,function(){oa=!0}):J.error("Shaders have not been found.")}};a.iH=function(){return oa};a.e4=function(){return V};a.QI=function(){return ba};a.ua=function(){for(var a in ba)A(ba[a]);for(var b in K)delete K[b];for(var c in V)delete V[c];v=ha=W=null;T={}};a.AS=A;a.f4=function(a){var b=a.Si;J.log("Shader: "+a.Eg+" "+a.bf+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)J.log("  "+b[a][0],b[a][1])};a.O=O;a.jH=function(a,b){return b in a.mn?!0:!1};a.reset=function(){ta=null}};b4w.module.__assets=function(a,g){function q(){return z.YJ()?g(z.Ie.Bu).data:null}function c(){var a={ku:null,DQ:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.ku=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=q();b&&a.ku in b&&(a.status=200,b[a.ku]&&(a.response=a.DQ(b[a.ku])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=I.rX)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.yt:w(e,"arraybuffer");break;case a.zn:w(e,"json");break;case a.vy:w(e,"text");break;case a.ty:t(e);break;case a.zt:D(e);break;case a.uy:l(e);break;case a.Bt:r(e);break;
case a.At:p(e);break;default:A.q("Wrong asset type: "+e.type)}}}function w(b,d){var e=b.url.split("?t=")[0];if(e in J)"json"==d?b.ac(A.T(J[e]),b.id,b.type,b.url,b.Jb):b.ac(J[e],b.id,b.type,b.url,b.Jb);else{var f=q(),h=f&&b.url in f?new c:new XMLHttpRequest,f=null;if("GET"==b.li)h.open("GET",b.url,!0);else if("POST"==b.li)switch(h.open("POST",b.url,!0),b.Oo){case a.RE:f="text/plain";break;case a.QE:f="application/json"}if(b.Ik)for(var g in b.Ik)"Content-Type"==g?f=b.Ik[g]:h.setRequestHeader(g,b.Ik[g]);
f&&h.setRequestHeader("Content-Type",f);"text"==d?(h.overrideMimeType("text/plain"),h.responseType="text"):"json"==d?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=d;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a,b.GW)}catch(c){E.error(c+" (parsing JSON "+b.url+")");b.ac(null,b.id,b.type,b.url,b.Jb);return}b.gh&&(J[e]="json"==d?A.T(a):a);b.ac(a,
b.id,b.type,b.url,b.Jb)}else E.error("empty responce when trying to get "+b.url),b.ac(null,b.id,b.type,b.url,b.Jb)}else E.error(h.status+" when trying to get "+b.url),b.ac(null,b.id,b.type,b.url,b.Jb);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.lL(a.loaded/a.total)},!1);h.send(b.Wm)}}function t(a){var b=a.url.split("?t=")[0];if(b in B)a.ac(B[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.li&&A.q("Unsupported request type for audio buffer");var d=(b=q())&&a.url in
b?new c:new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?F.XT(b,function(b){a.ac(b,a.id,a.type,a.url,a.Jb);a.state=30;a.gh&&(B[a.url.split("?t=")[0]]=b)},function(){a.ac(null,a.id,a.type,a.url,a.Jb);E.error("failed to decode "+a.url);a.state=30}):(a.ac(null,a.id,a.type,a.url,a.Jb),E.error("empty responce when trying to get "+a.url),a.state=30)}else a.ac(null,a.id,
a.type,a.url,a.Jb),E.error(d.status+" when trying to get "+a.url),a.state=30};d.send(a.Wm)}}function D(a){var b=a.url.split("?t=")[0];if(b in y)a.ac(y[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.li&&A.q("Unsupported request type for image element");var c=document.createElement("img");H.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30,a.gh&&(y[a.url.split("?t=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(a.ac(null,
a.id,a.type,a.url,a.Jb),E.error("could not load image: "+a.url),a.state=30)},!1);if((b=q())&&a.url in b)if(b[a.url]){var d=f(a.url);c.src="data:"+d+";base64,"+b[a.url]}else M.Zr()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function l(a){var b=a.url.split("?t=")[0];if(b in d)a.ac(d[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.li&&A.q("Unsupported request type for audio element");var c=document.createElement("audio");
H.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30,a.gh&&(d[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.ac(null,a.id,a.type,a.url,a.Jb),E.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.ac(null,a.id,a.type,a.url,a.Jb),E.error("could not load sound: "+a.url),a.state=30)},!1);if((b=q())&&a.url in b)if(b[a.url]){var e=
n(a.url);c.src="data:"+e+";base64,"+b[a.url];40!=a.state&&(a.ac(c,a.id,a.type,a.url,a.Jb),a.state=30)}else M.Zr()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,H.is_mobile_device&&c.load();H.BC&&(c.autoplay=!0,c.pause());setTimeout(function(){c.IZ=1},5E3)}}function r(a){function b(){40!=a.state&&(a.ac(null,a.id,a.type,a.url),E.error("could not load video: "+a.url,a.Jb),a.state=30)}var c=a.url.split("?t=")[0];
if(c in y)a.ac(y[c],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.li&&A.q("Unsupported request type for video element");var d=document.createElement("video");d.muted=!0;H.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){d.removeEventListener("error",b,!1);40!=a.state&&(a.ac(d,a.id,a.type,a.url,a.Jb),a.state=30,a.gh&&(y[a.url.split("?t=")[0]]=d))},!1);d.addEventListener("error",b,!1);if((c=q())&&a.url in c)if(c[a.url]){var f=e(a.url);d.src="data:"+f+";base64,"+
c[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.ac(d,a.id,a.type,a.url,a.Jb);a.state=30},!1)}else M.Zr()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),d.dispatchEvent(c);else d.src=a.url,H.is_mobile_device&&d.load();H.BC&&(d.autoplay=!0,d.pause());setTimeout(function(){d.IZ=1},1E4)}}function p(b){function d(a){b.ac(a,b.id,b.type,b.url,b.Jb);b.state=30;b.gh&&(y[b.url.split("?t=")[0]]=a)}var e=b.url.split("?t=")[0];if(e in
y)b.ac(y[e],b.id,b.type,b.url,b.Jb),b.state=30;else{"GET"!=b.li&&A.q("Unsupported request type for seq video element");var f=(e=q())&&b.url in e?new c:new XMLHttpRequest;if(null==b.Oo&&null==b.Wm)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.Oo){case a.RE:f.setRequestHeader("Content-type","text/plain");break;case a.QE:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?m(a,d):(b.ac(null,b.id,b.type,b.url,b.Jb),E.error("empty responce when trying to get "+b.url),b.state=30)}else b.ac(null,b.id,b.type,b.url,b.Jb),E.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.lL(a.loaded/a.total)},!1);f.send(b.Wm)}}function m(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],KG:[],dh:c[4]},h=20,g=0;g<e;g++){var k=c[h/4],m=new Blob([d.subarray(h+4,h+4+k)],
{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(m);f.images.push(l);f.KG.push(m);h+=k+8-k%4}l.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.KG;b(f)}}function f(a){var b="image";switch(A.CB(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function n(a){var b="audio";switch(A.CB(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function e(a){var b="video";switch(A.CB(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var z=g("__config"),M=g("__compat"),E=g("__print"),F=g("__sfx"),A=g("__util"),O=g("__version"),H=z.B,I=z.Rd;a.yt=10;a.zn=20;a.vy=30;a.ty=40;a.zt=50;a.uy=60;a.Bt=70;a.At=80;a.QE=a.zn;a.RE=a.vy;var C=[],h=0,k={},J={},y={},d={},B={};a.hn=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.B6=function(a){if(k[a])return k[a];var b=I.prevent_caching?a+O.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return k[a]=b;A.q("Error XHR: responce is empty, GET "+a)}else A.q("Error XHR: "+c.status+", GET "+a)};a.ua=function(){for(var a=0;a<C.length;a++)C[a].state=40;C=[];h=0;k={}};a.Wd=function(a,c,d,e,f){for(var g=0;g<a.length;g++){var k=a[g],k={id:k.id,type:k.type,url:k.url,
gh:k.gh,li:k.li?k.li:"GET",Oo:k.Oo?k.Oo:null,Ik:k.Ik?k.Ik:null,Wm:k.Wm?k.Wm:null,Jb:k.Jb?k.Jb:null,state:10,ac:c||function(){},XK:d||function(){},lL:e||function(){},GW:f||null,YK:h};if(I.prevent_caching){var m=q();m&&k.url in m||(k.url+=O.timestamp())}C.push(k)}b(C);h++};a.update=function(){b(C);for(var a=C,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.YK===a[c].YK?30!==f.state&&(d=!1):(d&&(a[e-1].XK(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].XK(),a.splice(c))}};
a.nS=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.CS=function(){J={};y={};d={};B={}}};"object"==typeof module&&module.mB&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function g(){var a=q,c=a.getDate(),c=10>c?"0"+String(c):String(c),g=a.getMonth()+1,g=10>g?"0"+String(g):String(g),D=String(a.getFullYear()),l=a.getHours(),l=10>l?"0"+String(l):String(l),r=a.getMinutes(),r=10>r?"0"+String(r):String(r),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return c+"."+g+"."+D+" "+l+":"+r+":"+a}var q=new Date(2017,5,20,1,30,27),c=[16,12,1];a.version=function(){return c};a.HE=function(){for(var a="",g=0;g<c.length;g++)a=1==g?a+(10>c[g]?"0"+
c[g]:c[g]):a+c[g],g!=c.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.VH=function(){return q};a.XA=g;a.timestamp=function(){var a=g(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.mB&&b4w.module.__version(exports);b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__transform=function(a,g){function q(a,b){f.mg(a)?F.of(b,f.lg(a)):F.of(b,a.k.n)}function c(a,b){var c=a.k;if(f.mg(a)){F.Wk(b,c.n);var e=f.vv(a),e=F.invert(e,h);F.multiply(e,c.n,f.lg(a))}else F.Wk(b,c.n)}function b(a,b){f.mg(a)?F.Wk(b,f.lg(a)):F.Wk(b,a.k.n)}function w(a,b){F.Zd(a.k.n,b);return b}function t(a,b){f.mg(a)?F.Zd(f.lg(a),b):F.Zd(a.k.n,b);return b}function D(a,b){f.mg(a)?F.copy(b,f.lg(a)):F.copy(b,a.k.n)}function l(a,b){f.mg(a)?F.copy(f.lg(a),b):F.copy(a.k.n,b);return b}function r(a){var b=
a.k,c=a.I,g=a.type;"CAMERA"==g&&m.AE(a);f.P_(a,J);"CAMERA"==g&&m.N_(a);var k=F.jc(b.n,H),l=F.Zd(b.n,C);p.Nl(b.S,b.n,b.Ta);p.Eq(b.wa,b.n,b.kb);if(b.zp)for(var q=0;q<c.length;q++)for(var t=c[q].X,I=0;I<t.length;I++){var x=t[I];p.Nl(x.S,b.n,x.Ta);p.Eq(x.wa,b.n,x.kb);x.Yf&&p.Dq(x.ba,b.n,x.pb)}else b.Yf&&p.Dq(b.ba,b.n,b.pb);switch(g){case "MESH":a.JK&&F.invert(a.k.n,a.k.oy);if(t=a.su)F.invert(t.k.n,h),F.multiply(h,b.n,h),F.QV(h,b.sq),F.Zd(h,b.rq);b.Cr=!0;break;case "CAMERA":for(q=0;q<c.length;q++)m.O_(a,
c[q]);break;case "SPEAKER":E.NZ(a,J,y);break;case "LAMP":n.S_(a)}for(q=0;q<c.length;q++)if(I=c[q],I.bw){t=I.yb;x=t.s;switch(g){case "MESH":b.Ke&&M.zD(t);x=I.Pi;null!=b.Td&&x&&M.AN(x,k);break;case "EMPTY":e.Q_(a);break;case "CAMERA":M.HY(t);if(x.wd){x.wd.enable_csm&&M.zD(t);var w=z.ja(a,t).da[0];M.b0(w,x.Wa)}M.A()==t&&M.qm(t)==a&&E.YW(t,k,l,J,y);break;case "LAMP":M.yp(a,t)}x=I.hi;w=a.Js;if(w.length)for(I=0;I<x.length;I++){var D=x[I].p;M.DN(x[I],k,l);z.EN(w,D.rc);m.sZ(D,M.qm(t));A.co(D.kd,D.Wh)}}b=
a.Xe;for(q=0;q<b.length;q++)r(b[q]);a=a.wA;for(q=0;q<a.length;q++)b=a[q],t=b[0],f.H_(t,b[1])}var p=g("__boundings"),m=g("__camera"),f=g("__constraints"),n=g("__lights"),e=g("__objects"),z=g("__obj_util"),M=g("__scenes"),E=g("__sfx"),F=g("__tsr"),A=g("__util"),O=g("__vec3"),H=new Float32Array(3),I=new Float32Array(3),C=new Float32Array(4);new Float32Array(9);var h=F.create(),k=F.create(),J=0,y=0;a.HF=0;a.Hn=1;a.update=function(a){J=a;y++};a.Vc=function(a,b){var c=a.k;if(f.mg(a)){F.of(b,c.n);var e=
f.vv(a),e=F.invert(e,h);F.multiply(e,c.n,f.lg(a))}else F.of(b,c.n)};a.wx=q;a.sd=function(a,b){F.jc(a.k.n,b);return b};a.xJ=function(a,b){f.mg(a)?F.jc(f.lg(a),b):F.jc(a.k.n,b);return b};a.ni=c;a.tx=b;a.Lf=w;a.mJ=t;a.sx=function(a,b){var e=A.fk(b,C);c(a,e)};a.KD=function(a,c){var e=A.fk(c,C);b(a,e)};a.kJ=function(a,b){w(a,C);return b=A.ax(euler,b)};a.lJ=function(a,b){t(a,C);return b=A.ax(euler,b)};a.Sf=function(a,b){var c=a.k;if(f.mg(a)){var c=f.lg(a),e=F.$d(f.vv(a));F.Sf(b/e,c)}else F.Sf(b,c.n)};a.LD=
function(a,b){var c=a.k;f.mg(a)?F.Sf(b,f.lg(a)):F.Sf(b,c.n)};a.$d=function(a){return F.$d(a.k.n)};a.oJ=function(a){return f.mg(a)?F.$d(f.lg(a)):F.$d(a.k.n)};a.uj=function(a,b){F.copy(b,a.k.n);if(f.mg(a)){var c=f.vv(a),c=F.invert(c,h);F.multiply(c,a.k.n,f.lg(a))}};a.xx=D;a.Mr=function(a,b){return F.copy(a.k.n,b)};a.Nr=l;a.zv=function(a){var b=a.k;a=b.Il;var c=F.$d(b.n),b=c*(a.max_x-a.min_x),e=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+e*e+a*a)};a.yv=function(a,b,c){b?(a=a.k,O.copy(a.kb.F,
c)):(a=a.k,b=a.Il,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,F.Wc(c,a.n,c));return c};a.nh=function(a,b,c,e){var f=l(a,h),g=H;g[0]=b;g[1]=c;g[2]=e;F.Wc(g,f,g);q(a,g)};a.vD=function(a,b){var c=l(a,h),e=F.Wk(b,F.identity(k));F.multiply(c,e,e);D(a,e)};a.D=r;a.distance=function(a,b){var c=F.jc(a.k.n,H),e=F.jc(b.k.n,I);return O.dist(c,e)};a.Ho=function(a,b){var c=F.jc(a.k.n,H);return O.dist(c,b)};a.gJ=function(a){return{max_x:a.k.Ta.max_x,min_x:a.k.Ta.min_x,max_y:a.k.Ta.max_y,
min_y:a.k.Ta.min_y,max_z:a.k.Ta.max_z,min_z:a.k.Ta.min_z}}};b4w.module.__navmesh=function(a,g){function q(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.rl,f=c.rl,h=[],g=0;g<e.length;g++)0<=b(f,e[g])&&h.push(e[g]);if(2>h.length)return[];0<=b(h,e[0])&&0<=b(h,e[e.length-1])&&d(e);0<=b(h,f[0])&&0<=b(h,f[f.length-1])&&d(f);h=[];for(g=0;g<e.length;g++)0<=b(f,e[g])&&h.push(e[g]);return h}function c(a){function b(a){for(var c=a.sg,d=0;d<c.length;d++){var e=c[d];void 0==e.island&&(e.island=a.island,b(e))}}a=a.ZX;for(var c=[],d=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=d++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[e])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function w(a){function b(a,c){for(var d=0;d<a.length;d++)if(c===a[d])return d}for(var d={},e=a.Ep,f=0;f<e.length;f++)e[f][0]=parseFloat(e[f][0].toFixed(2)),e[f][1]=parseFloat(e[f][1].toFixed(2)),e[f][2]=parseFloat(e[f][2].toFixed(2));d.Ep=a.Ep;a=c(a);d.gC=[];for(f=0;f<a.length;f++){for(var e=
[],h=a[f],g=0;g<h.length;g++){for(var k=[],m=h[g],l=0;l<m.sg.length;l++)k.push(b(h,m.sg[l]));for(var n=[],l=0;l<m.sg.length;l++)n.push(q(m,m.sg[l]));m.ed[0]=parseFloat(m.ed[0].toFixed(2));m.ed[1]=parseFloat(m.ed[1].toFixed(2));m.ed[2]=parseFloat(m.ed[2].toFixed(2));e.push({id:b(h,m),sg:k,rl:m.rl,ed:m.ed,Tc:m.Tc,$X:n,qB:0,Er:0,Ib:0,JS:1,JE:!1,closed:!1,parent:null})}d.gC.push(e)}return d}function t(a,b,c,d,e){function f(a,b){A.subtract(a,b,H);return A.dot(H,H)}function h(a,b){for(var c=[],d=0;d<b.sg.length;d++)c.push(a[b.sg[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.qB=0;c.Er=0;c.Ib=0;c.JS=1;c.JE=!1;c.closed=!1;c.parent=null}})(a);var g=M.yR(function(a){return a.qB});for(M.FG(g,b);0<g.content.length;){var k=M.zR(g);if(k===c){a=k;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}k.closed=!0;for(var m=h(a,k),l=0,n=m.length;l<n;l++){var p=m[l];if(!p.closed){var q=k.Er+A.dist(p.ed,k.ed),u=p.JE;if(!u||q<p.Er)p.JE=!0,p.parent=k,p.Ib=p.Ib||f(p.ed,e)+f(p.ed,d),p.Er=q,p.qB=p.Er+p.Ib,u?M.AR(g,
p):M.FG(g,p)}}}return[]}function D(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function l(a,b,c,d){b=A.subtract(b,a,H);a=A.subtract(c,a,I);a=A.cross(b,a,H);return F.sign(A.dot(d,a))}function r(a,b){A.subtract(a,b,H);return 1E-5>A.dot(H,H)}function p(a,b,c){var e=A.subtract(b.right,b.left,H),f=c.Tc,h=b.Tc;c=Math.acos(A.dot(f,h));f=F.sign(A.dot(e,A.cross(f,h,I)));c*=-f;f=E.identity(d);E.translate(f,b.left,f);E.rotate(f,c,e,f);E.translate(f,A.scale(b.left,-1,I),f);E.multiply(a,f,a)}function m(a,b,c,
d,e,f,g,m,l){for(var n=E.identity(J),q=e;q<c;q++)if(a[q].aK&&(q>e||!q)){var u,r=b,B=d;u=a[q].left;var t=a[q].right,y=f,I=n,G=A.create(),z=A.transformMat4(u,I,C);z[3]=1;I=A.transformMat4(t,I,H);I=A.subtract(I,z,h);r=A.subtract(B,r,H);y=A.cross(y,r,k);.01>Math.abs(A.dot(y,I))?B=.5:(A.normalize(y,y),y[3]=-A.dot(y,B),B=-O.dot(y,z)/O.dot(y,I));t=A.subtract(t,u,H);u=A.scaleAndAdd(u,t,B,G);D(g,u);m&&D(l,a[q].Tc);q&&p(n,a[q],a[q-1])}}function f(a,b){function c(b,d){C=t=J=d;g=h=f=b;A.copy(b,k);A.copy(b,n);
A.copy(a[J].Tc,q)}var d=[],e=[],f,h,g,k,n,q,J=0,t=0,C=0;f=a[0].right;h=a[0].left;g=a[0].right;k=A.copy(h,B);n=A.copy(g,u);q=A.copy(a[0].Tc,G);D(d,f);b&&D(e,a[0].Tc);for(var I=E.identity(y),z=1;z<a.length;z++){var w=a[z].left,M=a[z].right,H=A.transformMat4(w,I,ba),F=A.transformMat4(M,I,K);a[z].aK&&p(I,a[z],a[z-1]);if(0>=l(f,n,F,q)){var O=r(f,g);if(O||0<l(f,k,F,q))g=M,A.copy(F,n),C=z;else{(w=r(k,f))||m(a,k,t,f,J,q,d,b,e);I=E.identity(I);c(h,t);z=J;w||(D(d,f),b&&D(e,a[z].Tc));continue}}0<=l(f,k,H,q)&&
((O=r(f,h))||0>l(f,n,H,q)?(h=w,A.copy(H,k),t=z):((w=r(n,f))||m(a,n,C,f,J,q,d,b,e),I=E.identity(I),c(g,C),z=J,w||(D(d,f),b&&D(e,a[z].Tc))))}I=a.length-1;z=a[I].left;(w=r(f,z))||m(a,k,I,f,J,q,d,b,e);w&&J||D(d,z);return b?(D(e,a[I].Tc),{positions:new Float32Array(d),normals:new Float32Array(e)}):{positions:new Float32Array(d),normals:null}}function n(a,b,c,d,e){for(var f=null,h=Number.MAX_VALUE,g=0;g<a.length;g++){var k=a[g],m=e(c,k.ed,k.rl,b,h);m<h&&(f=k,h=m)}return 0<d&&h>d?null:f}function e(a,b,c,
d,e){a.push({left:b,right:c,aK:d,Tc:e})}var z=g("__geometry"),M=g("__math"),E=g("__mat4"),F=g("__util"),A=g("__vec3"),O=g("__vec4"),H=A.create(),I=A.create(),C=O.create(),h=O.create(),k=O.create(),J=E.create(),y=E.create(),d=E.create(),B=A.create(),u=A.create(),ba=A.create(),K=A.create(),G=A.create();a.CX=function(a){var b=z.Dv(a.tc,z.rQ),c=a.oe;a=[];for(var d=0;d<c.length;d+=3)a.push({ma:new Uint32Array([c[d],c[d+1],c[d+2]]),ed:new Float32Array(3),Tc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var e=new Float32Array(3);e[0]=b[d];e[1]=b[d+1];e[2]=b[d+2];c.push(e)}for(b=0;b<a.length;b++)d=a[b],A.add(c[d.ma[0]],c[d.ma[1]],H),A.add(H,c[d.ma[2]],H),A.scale(H,1/3,d.ed);for(b=0;b<a.length;b++){var d=a[b],e=A.subtract(c[d.ma[1]],c[d.ma[0]],H),f=A.subtract(c[d.ma[2]],c[d.ma[0]],I),e=A.cross(e,f,H);A.normalize(e,e);A.copy(e,d.Tc)}for(var h={},b=[],d=[],g,k,m=Math.pow(10,4),e=0,f=c.length;e<f;e++)g=c[e],k=Math.round(g[0]*m)+"_"+Math.round(g[1]*m)+"_"+Math.round(g[2]*m),void 0===h[k]?(h[k]=e,b.push(g),
d[e]=b.length-1):d[e]=d[h[k]];h=[];e=0;for(f=a.length;e<f;e++)for(g=a[e],g.ma[0]=d[g.ma[0]],g.ma[1]=d[g.ma[1]],g.ma[2]=d[g.ma[2]],g=[g.ma[0],g.ma[1],g.ma[2]],k=0;3>k;k++)if(g[k]==g[(k+1)%3]){h.push(e);break}for(e=h.length-1;0<=e;e--)a.splice(h[e],1);c.length=0;for(e in b)c.push(b[e]);d=[];for(b=e=0;b<a.length;b++)f=a[b],d.push({id:e++,rl:f.ma,ed:f.ed,Tc:f.Tc,sg:[]});a={ZX:d,Ep:c};c={};for(b=0;b<d.length;b++)for(e=0;3>e;e++)f=d[b].rl[e],h=d[b].rl[(e+1)%3],f=f>h?h+"-"+f:f+"-"+h,f in c||(c[f]=[]),c[f].push(d[b]);
d=Object.keys(c);b=0;for(h=d.length;b<h;b++)for(f=d[b],e=0;e<c[f].length;e++)for(g=e+1;g<c[f].length;g++)c[f][e].sg.push(c[f][g]),c[f][g].sg.push(c[f][e]);return w(a)};a.HK=function(a,b,c){for(var d=null,e=Number.MAX_VALUE,f=a.gC,h=0;h<f.length;h++)for(var g=0;g<f[h].length;g++){var k=f[h][g];A.subtract(k.ed,b,H);k=c(b,k.ed,k.rl,a.Ep,e);k<e&&(d=h,e=k)}return d};a.DW=function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(c[b[e]]);b=!1;c=-1;for(var e=d.length,f=e-1;++c<e;f=c)(d[c][1]<=a[1]&&a[1]<d[f][1]||
d[f][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[f][0]-d[c][0])*(a[1]-d[c][1])/(d[f][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.GK=function(a,b,c,d){var h;h=a.gC[d.island];var g=a.Ep,k=n(h,g,b,d.allowed_distance,d.distance_to_closest);h=k?(g=n(h,g,c,d.allowed_distance,d.distance_to_farthest))?t(h,k,g,b,c):null:null;if(h&&h.length)if(d.do_not_pull_string)if(c=h,d.return_normals){b=new Float32Array(3*c.length);for(h=0;h<c.length;h++)b.set(c[h].ed,3*h);c={positions:b,normals:null}}else{b=new Float32Array(3*
c.length);a=new Float32Array(3*c.length);for(h=0;h<c.length;h++)b.set(c[h].ed,3*h),a.set(c[h].Tc,3*h);c={positions:b,normals:a}}else{a=a.Ep;d=d.return_normals;k=[];e(k,b,b,!1,h[0]&&h[0].Tc||F.nc);for(b=0;b<h.length;b++){var m=h[b];if(g=h[b+1]){var l=.999>Math.abs(A.dot(m.Tc,g.Tc));a:{for(var v=0;v<m.sg.length;v++)if(m.sg[v]===g.id){m=m.$X[v];break a}m=void 0}e(k,a[m[0]],a[m[1]],l,g.Tc)}}e(k,c,c,!1,k[k.length-1].Tc);c=f(k,d)}else c=null;return c}};b4w.module.__reformer=function(a,g){function q(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var e=a[c],f=0;f<e.strips.length;f++){var g=e.strips[f];"action"in g||(g.action=null,b("strip",g,"action"));"action_frame_start"in g||(g.action_frame_start=0,b("strip",g,"action_frame_start"));"action_frame_end"in g||(g.action_frame_end=g.frame_end-g.frame_start,b("strip",g,"action_frame_end"));"repeat"in g||(g.repeat=1,b("strip",g,"repeat"));
"use_reverse"in g||(g.use_reverse=!1,b("strip",g,"use_reverse"));"scale"in g||(g.scale=1,b("strip",g,"scale"))}}function b(a,b,c){c=c+">>"+a;c in A||(A[c]={ZD:[],zL:"undefined",type:a});A[c].ZD.push(b.name)}function w(a,b,c){c=c+">>"+a;c in A||(A[c]={ZD:[],zL:"deprecated",type:a});A[c].ZD.push(b.name)}function t(a){m.warn(a)}function D(a,b){b||(b=a.name+"_COPY");var c=a.materials,e=a.submeshes;a.materials=null;a.submeshes=null;var f=n.Ph(a);a.materials=c;a.submeshes=e;f.name=b;f.materials=a.materials.slice(0);
f.submeshes=[];for(c=0;c<e.length;c++){var g=n.Rq(e[c]);f.submeshes.push(g)}return f}var l=g("__boundings"),r=g("__curve"),p=g("__mat4"),m=g("__print"),f=g("__quat"),n=g("__util"),e=g("__vec3"),z=g("__mat3"),M=g("__logic_nodes"),E=g("__animation"),F=[5,4],A={},O=z.create(),H=f.create();a.hH=function(a){return-1!=n.XN(a,F)};a.gS=function(a){A={};var e=a.worlds;if(0==e.length){m.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};e.push(f)}for(var e=a.worlds,g=0;g<e.length;g++){f=e[g];"use_sky_blend"in f||(b("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(b("world",f,"use_sky_paper"),
f.use_sky_paper=!1);"use_sky_real"in f||(b("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in f.b4w_sky_settings||(b("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
f||(b("world",f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(b("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var l=f.texture_slots,p=0;p<l.length;p++){var d=l[p];"blend_type"in
d||(d.blend_type="MIX",b("world_texture_slot",d,"blend_type"));"use_map_blend"in d||(d.use_map_blend=!1,b("world_texture_slot",d,"use_map_blend"));"use_map_horizon"in d||(d.use_map_horizon=!0,b("world_texture_slot",d,"use_map_horizon"));"use_map_zenith_up"in d||(d.use_map_zenith_up=!1,b("world_texture_slot",d,"use_map_zenith_up"));"use_rgb_to_intensity"in d||(d.use_rgb_to_intensity=!1,b("world_texture_slot",d,"use_rgb_to_intensity"));"invert"in d||(d.invert=!1,b("world_texture_slot",d,"invert"));
"color"in d||(d.color=[1,0,1],b("world_texture_slot",d,"color"));"blend_factor"in d||(d.blend_factor=0,b("world_texture_slot",d,"blend_factor"));"horizon_factor"in d||(d.horizon_factor=1,b("world_texture_slot",d,"horizon_factor"));"zenith_up_factor"in d||(d.zenith_up_factor=0,b("world_texture_slot",d,"zenith_up_factor"));"zenith_down_factor"in d||(d.zenith_down_factor=0,b("world_texture_slot",d,"zenith_down_factor"));"default_value"in d||(d.default_value=1,b("world_texture_slot",d,"default_value"))}"b4w_use_default_animation"in
f||(b("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(b("world",f,"b4w_anim_behavior"),f.b4w_anim_behavior="CYCLIC")}p=a.scenes;for(g=0;g<p.length;g++)l=p[g],d=l.world,"timeline_markers"in l||(l.timeline_markers=null,b("scene",l,"timeline_markers")),"b4w_reflection_quality"in l||(l.b4w_reflection_quality="MEDIUM",b("scene",l,"b4w_reflection_quality")),"b4w_use_nla"in l||(l.b4w_use_nla=!1,b("scene",l,"b4w_use_nla")),"fps"in l||(l.fps=24,b("scene",l,
"fps")),"b4w_nla_cyclic"in l||(l.b4w_nla_cyclic=!1,b("scene",l,"b4w_nla_cyclic")),"b4w_logic_nodes"in l||(l.b4w_logic_nodes=[],b("scene",l,"b4w_logic_nodes")),"b4w_detect_collisions"in l&&(w("scene",l,"b4w_detect_collisions"),delete l.b4w_detect_collisions),"audio_doppler_speed"in l||(l.audio_doppler_speed=343.3),"audio_doppler_factor"in l||(l.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in l||(l.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",l,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in l||(l.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in l||(l.b4w_enable_bloom=!1,b("scene",l,"b4w_enable_bloom")),"b4w_enable_motion_blur"in l||(l.b4w_enable_motion_blur=!1,b("scene",l,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in l||(l.b4w_enable_color_correction=!1,b("scene",l,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in l||(l.b4w_antialiasing_quality="MEDIUM",b("scene",l,"b4w_antialiasing_quality")),
"b4w_tags"in l||(l.b4w_tags={title:"",description:""},b("scene",l,"b4w_tags")),"b4w_enable_object_selection"in l||(l.b4w_enable_object_selection="AUTO",b("scene",l,"b4w_enable_object_selection")),"b4w_enable_outlining"in l||(l.b4w_enable_outlining="AUTO",b("scene",l,"b4w_enable_outlining")),"b4w_enable_glow_materials"in l||(l.b4w_enable_glow_materials="AUTO",b("scene",l,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in l||(l.b4w_enable_anchors_visibility="AUTO",b("scene",l,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in l||(l.b4w_outline_color=[1,1,1],b("scene",l,"b4w_outline_color")),"b4w_outline_factor"in l||(l.b4w_outline_factor="b4w_glow_factor"in l?l.b4w_glow_factor:1,b("scene",l,"b4w_outline_factor")),"b4w_shadow_settings"in l||(b("scene",l,"b4w_shadow_settings"),e=d.b4w_shadow_settings,l.b4w_shadow_settings=e?e:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),e=l.b4w_shadow_settings,"csm_resolution"in e||(b("scene",l,"b4w_shadow_settings.csm_resolution"),e.csm_resolution=2048),"blur_samples"in e||(b("scene",l,"b4w_shadow_settings.blur_samples"),e.blur_samples="16x"),"soft_shadows"in e||(b("scene",l,"b4w_shadow_settings.soft_shadows"),e.soft_shadows=!0),"self_shadow_polygon_offset"in e||(b("scene",l,"b4w_shadow_settings.self_shadow_polygon_offset"),e.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in e||(b("scene",l,"b4w_shadow_settings.self_shadow_normal_offset"),e.self_shadow_normal_offset=.01),"b4w_enable_csm"in e||(b("scene",l,"b4w_shadow_settings.b4w_enable_csm"),e.b4w_enable_csm=!1),"csm_num"in e||(b("scene",l,"b4w_shadow_settings.csm_num"),e.csm_num=1),"csm_first_cascade_border"in e||(b("scene",l,"b4w_shadow_settings.csm_first_cascade_border"),e.csm_first_cascade_border=10),"first_cascade_blur_radius"in e||(b("scene",l,"b4w_shadow_settings.first_cascade_blur_radius"),
e.first_cascade_blur_radius=3),"csm_last_cascade_border"in e||(b("scene",l,"b4w_shadow_settings.csm_last_cascade_border"),e.csm_last_cascade_border=100),"last_cascade_blur_radius"in e||(b("scene",l,"b4w_shadow_settings.last_cascade_blur_radius"),e.last_cascade_blur_radius=1.5),"fade_last_cascade"in e||(b("scene",l,"b4w_shadow_settings.fade_last_cascade"),e.fade_last_cascade=!0),"blend_between_cascades"in e||(b("scene",l,"b4w_shadow_settings.blend_between_cascades"),e.blend_between_cascades=!0),"b4w_ssao_settings"in
l||(b("scene",l,"b4w_ssao_settings"),e=d.b4w_ssao_settings,l.b4w_ssao_settings=e?e:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),e=l.b4w_ssao_settings,"dist_factor"in e||(b("scene",l,"b4w_ssao_settings.dist_factor"),e.dist_factor=0),"samples"in e||(b("scene",l,"b4w_ssao_settings.samples"),e.samples=16),"hemisphere"in e||(b("scene",l,"b4w_ssao_settings.hemisphere"),e.hemisphere=!1),"blur_depth"in e||(b("scene",l,"b4w_ssao_settings.blur_depth"),e.blur_depth=!1),"blur_discard_value"in
e||(b("scene",l,"b4w_ssao_settings.blur_discard_value"),e.blur_discard_value=1),"b4w_bloom_settings"in l||(b("scene",l,"b4w_bloom_settings"),e=d.b4w_bloom_settings,l.b4w_bloom_settings=e?e:{key:.2,blur:4,edge_lum:1}),"key"in l.b4w_bloom_settings||(b("scene",l,"b4w_bloom_settings.key"),l.b4w_bloom_settings.key=.2),"blur"in l.b4w_bloom_settings||(b("scene",l,"b4w_bloom_settings.blur"),l.b4w_bloom_settings.blur=4),"edge_lum"in l.b4w_bloom_settings||(b("scene",l,"b4w_bloom_settings.edge_lum"),l.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in l||(b("scene",l,"b4w_motion_blur_settings"),e=d.b4w_motion_blur_settings,l.b4w_motion_blur_settings=e?e:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in l.b4w_motion_blur_settings||(b("scene",l,"b4w_motion_blur_settings.motion_blur_factor"),l.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in l.b4w_motion_blur_settings||(b("scene",l,"b4w_motion_blur_settings.motion_blur_decay_threshold"),l.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in l||(b("scene",l,"b4w_color_correction_settings"),e=d.b4w_color_correction_settings,l.b4w_color_correction_settings=e?e:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in l||(b("scene",l,"b4w_god_rays_settings"),e=d.b4w_god_rays_settings,l.b4w_god_rays_settings=e?e:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in l.b4w_god_rays_settings||(b("scene",l,"b4w_god_rays_settings.steps_per_pass"),l.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in l||(b("scene",l,"b4w_glow_settings"),l.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},e=l.b4w_glow_settings,"b4w_render_glow_over_blend"in d&&(e.render_glow_over_blend=d.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in d&&(e.small_glow_mask_coeff=d.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in d&&(e.large_glow_mask_coeff=d.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
d&&(e.small_glow_mask_width=d.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in d&&(e.large_glow_mask_width=d.b4w_large_glow_mask_width)),d=l.b4w_render_shadows,"AUTO"!=d&&"OFF"!=d&&"ON"!=d&&(l.b4w_render_shadows=d?"ON":"OFF"),d=l.b4w_render_reflections,"OFF"!=d&&"ON"!=d&&(l.b4w_render_reflections=d?"ON":"OFF"),d=l.b4w_render_refractions,"AUTO"!=d&&"OFF"!=d&&"ON"!=d&&(l.b4w_render_refractions=d?"ON":"OFF"),"b4w_render_dynamic_grass"in l||(b("scene",l,"b4w_render_dynamic_grass"),l.b4w_render_dynamic_grass=
"AUTO"),l.b4w_nla_script&&w("scene",l,"b4w_nla_script"),"audio_distance_model"in l||(b("scene",l,"audio_distance_model"),l.audio_distance_model="INVERSE_CLAMPED");l=a.meshes;for(g=0;g<l.length;g++){d=l[g];d.b4w_boundings||(b("mesh",d,"b4w_boundings"),d.b4w_boundings={},e=d.b4w_boundings,e.bb=d.b4w_bounding_box?d.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},e.bb_src=d.b4w_bounding_box_source?d.b4w_bounding_box_source:d.b4w_bounding_box,e.bs_cen=d.b4w_bounding_sphere_center?d.b4w_bounding_sphere_center:
[0,0,0],e.bc_cen=d.b4w_bounding_cylinder_center?d.b4w_bounding_cylinder_center:[0,0,0],e.be_cen=d.b4w_bounding_ellipsoid_center?d.b4w_bounding_ellipsoid_center:[0,0,0],d.b4w_bounding_ellipsoid_axes?e.be_ax=d.b4w_bounding_ellipsoid_axes:(p=e.bb,e.be_ax=[(p.max_x-p.min_x)/2,(p.max_y-p.min_y)/2,(p.max_z-p.min_z)/2]),d.b4w_rotated_bounding_box?e.rbb=d.b4w_rotated_bounding_box:(p=e.bb,e.rbb={rbb_c:[(p.max_x+p.min_x)/2,(p.max_y+p.min_y)/2,(p.max_z+p.min_z)/2],rbb_s:[1,1,1]}),e.caxis_x=d.b4w_cov_axis_x?
d.b4w_cov_axis_x:[1,0,0],e.caxis_y=d.b4w_cov_axis_y?d.b4w_cov_axis_y:[0,1,0],e.caxis_z=d.b4w_cov_axis_z?d.b4w_cov_axis_z:[0,0,1]);d.uv_textures||(b("mesh",d,"uv_textures"),d.uv_textures=[]);"b4w_shape_keys"in d||(d.b4w_shape_keys=[],b("mesh",d,"b4w_shape_keys"));e=!0;for(f=0;f<d.submeshes.length;f++){var r=d.submeshes[f];"boundings"in r||(e=!1,r.boundings={be_ax:d.b4w_bounding_ellipsoid_axes,be_cen:d.b4w_bounding_ellipsoid_center,bb:{max_x:d.b4w_bounding_box.max_x,max_y:d.b4w_bounding_box.max_y,max_z:d.b4w_bounding_box.max_z,
min_x:d.b4w_bounding_box.min_x,min_y:d.b4w_bounding_box.min_y,min_z:d.b4w_bounding_box.min_z}});"be_ax"in r.boundings||(r.boundings.be_ax=d.b4w_bounding_ellipsoid_axes);"be_cen"in r.boundings||(r.boundings.be_cen=d.b4w_bounding_ellipsoid_center);"bb"in r.boundings||(r.boundings.bb=d.b4w_bounding_box);"rbb"in r.boundings||(p=d.b4w_bounding_box,r.boundings.rbb={rbb_c:[(p.max_x+p.min_x)/2,(p.max_y+p.min_y)/2,(p.max_z+p.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in r.boundings||(r.boundings.caxis_x=[1,0,0]);
"caxis_y"in r.boundings||(r.boundings.caxis_y=[0,1,0]);"caxis_z"in r.boundings||(r.boundings.caxis_z=[0,0,1])}e||b("mesh",d,"submesh_bd");p=d;e=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];f=null;for(r=0;r<e.length;r++)p[e[r]]&&(f?(p[e[r]]=!1,m.warn('WARNING property "'+e[r]+'" of object "'+p.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=e[r]);for(p=0;p<d.b4w_vertex_anim.length;p++)e=d.b4w_vertex_anim[p],
"allow_nla"in e||(b('mesh["b4w_vertex_anim"]',d,"allow_nla"),e.allow_nla=!0)}p=a.cameras;for(g=0;g<p.length;g++)l=p[g],l.type||(l.type="PERSP",b("camera",l,"type")),"b4w_eye_target_dist"in l&&(delete l.b4w_eye_target_dist,w("camera",l,"b4w_eye_target_dist")),"b4w_hover_zero_level"in l||(l.b4w_hover_zero_level=0,b("camera",l,"b4w_hover_zero_level")),"b4w_trans_velocity"in l||(l.b4w_trans_velocity=1,b("camera",l,"b4w_trans_velocity")),"b4w_rot_velocity"in l||(l.b4w_rot_velocity=1,b("camera",l,"b4w_rot_velocity")),
"b4w_zoom_velocity"in l||(l.b4w_zoom_velocity=.1,b("camera",l,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in l||(l.b4w_use_target_distance_limits=l.b4w_use_distance_limits||!1,b("camera",l,"b4w_use_target_distance_limits")),"b4w_use_zooming"in l||(l.b4w_use_zooming=l.b4w_use_distance_limits||!1,b("camera",l,"b4w_use_zooming")),"b4w_distance_min"in l||(l.b4w_distance_min=1,b("camera",l,"b4w_distance_min")),"b4w_distance_max"in l||(l.b4w_distance_max=100,b("camera",l,"b4w_distance_max")),
"b4w_horizontal_translation_min"in l||(l.b4w_horizontal_translation_min=-100,b("camera",l,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in l||(l.b4w_horizontal_translation_max=100,b("camera",l,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in l||(l.b4w_vertical_translation_min=-100,b("camera",l,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in l||(l.b4w_vertical_translation_max=100,b("camera",l,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
l||(l.b4w_use_horizontal_clamping=!1,b("camera",l,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in l||(l.b4w_rotation_left_limit=-Math.PI,b("camera",l,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in l||(l.b4w_rotation_right_limit=Math.PI,b("camera",l,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in l||(l.b4w_horizontal_clamping_type="LOCAL",b("camera",l,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in l||(l.b4w_use_vertical_clamping=!1,b("camera",l,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in l||(l.b4w_rotation_down_limit=-Math.PI/2,b("camera",l,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in l||(l.b4w_rotation_up_limit=Math.PI/2,b("camera",l,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in l||(l.b4w_vertical_clamping_type="LOCAL",b("camera",l,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in l||(l.b4w_hover_angle_min=Math.PI/6,b("camera",l,"b4w_hover_angle_min")),"b4w_hover_angle_max"in l||(l.b4w_hover_angle_max=Math.PI/6,b("camera",l,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in l||(l.b4w_enable_hover_hor_rotation=!0,b("camera",l,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in l||(l.b4w_use_panning=!0,b("camera",l,"b4w_use_panning")),"b4w_use_pivot_limits"in l||(l.b4w_use_pivot_limits=!1,l.b4w_pivot_z_min=0,l.b4w_pivot_z_max=10,b("camera",l,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in l||(l.b4w_dof_bokeh=!1,b("camera",l,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in l||(l.b4w_dof_bokeh_intensity=.3,b("camera",l,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in l||(l.b4w_dof_foreground_blur=!1,b("camera",l,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in l||(l.b4w_dof_front_start=0,b("camera",l,"b4w_dof_front_start")),"b4w_dof_front_end"in l||(l.b4w_dof_front_end=l.b4w_dof_front,b("camera",l,"b4w_dof_front_end")),"b4w_dof_rear_start"in l||(l.b4w_dof_rear_start=0,b("camera",l,"b4w_dof_rear_start")),"b4w_dof_rear_end"in l||(l.b4w_dof_rear_end=l.b4w_dof_rear,b("camera",l,"b4w_dof_rear_end"));p=a.lamps;for(g=0;g<p.length;g++)l=
p[g],"b4w_generate_shadows"in l||(l.b4w_generate_shadows=!1,b("lamp",l,"b4w_generate_shadows")),"b4w_dynamic_intensity"in l||(l.b4w_dynamic_intensity=!1,b("lamp",l,"b4w_dynamic_intensity")),"use_diffuse"in l||(l.use_diffuse=!0,b("lamp",l,"use_diffuse")),"use_specular"in l||(l.use_specular=!0,b("lamp",l,"use_specular")),"clip_start"in l||(l.clip_start=.1,b("lamp",l,"clip_start")),"clip_end"in l||(l.clip_end=30,b("lamp",l,"clip_end")),"POINT"!=l.type&&"SPOT"!=l.type||"use_sphere"in l||(l.use_sphere=
!1,b("lamp",l,"use_sphere"));p=a.speakers;for(g=0;g<p.length;g++)l=p[g],"b4w_behavior"in l||(l.b4w_behavior=l.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in l||(l.b4w_auto_play=!1,b("speaker",l,"b4w_auto_play")),"b4w_enable_doppler"in l||(l.b4w_enable_doppler=!1,b("speaker",l,"b4w_enable_doppler")),"b4w_delay"in l||(l.b4w_delay=0),"b4w_delay_random"in l||(l.b4w_delay_random=0),"b4w_volume_random"in l||(l.b4w_volume_random=0),"b4w_pitch_random"in l||(l.b4w_pitch_random=0),
"b4w_fade_in"in l||(l.b4w_fade_in=0),"b4w_fade_out"in l||(l.b4w_fade_out=0),"b4w_loop"in l||(l.b4w_loop=!1),"b4w_loop_start"in l||(l.b4w_loop_start=0,b("speaker",l,"b4w_loop_start")),"b4w_loop_end"in l||(l.b4w_loop_end=0,b("speaker",l,"b4w_loop_end")),l.animation_data&&c(l.animation_data);p=a.textures;for(g=0;g<p.length;g++)l=p[g],"b4w_anisotropic_filtering"in l||(l.b4w_anisotropic_filtering="OFF",b("texture",l,"b4w_anisotropic_filtering")),"b4w_water_foam"in l||(l.b4w_water_foam=!1,b("texture",l,
"b4w_water_foam")),"b4w_foam_uv_freq"in l||(l.b4w_foam_uv_freq=[1,1],b("texture",l,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in l||(l.b4w_foam_uv_magnitude=[1,1],b("texture",l,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in l||(l.b4w_parallax_steps=5,b("material",l,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in l||(l.b4w_parallax_lod_dist=10,b("material",l,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in l||(l.b4w_shore_dist_map=!1,b("texture",l,"b4w_shore_dist_map")),"b4w_shore_boundings"in
l||(l.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",l,"b4w_shore_boundings")),"b4w_max_shore_dist"in l||(l.b4w_max_shore_dist=100,b("texture",l,"b4w_max_shore_dist")),"b4w_disable_compression"in l||(l.b4w_disable_compression=!1,b("texture",l,"b4w_disable_compression")),"b4w_source_type"in l||(l.b4w_source_type="",b("texture",l,"b4w_source_type")),"b4w_source_id"in l||(l.b4w_source_id="",b("texture",l,"b4w_source_id")),"b4w_source_size"in l||(l.b4w_source_size=1024,b("texture",l,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in l||(l.b4w_enable_canvas_mipmapping=!0,b("texture",l,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in l||(l.b4w_nla_video=!1,b("texture",l,"b4w_nla_video"));p=a.images;for(g=0;g<p.length;g++)l=p[g],"colorspace_settings_name"in l||(l.colorspace_settings_name="sRGB",b("image",l,"colorspace_settings_name"));e=a.materials;for(g=0;g<e.length;g++){f=e[g];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"use_tangent_shading"in f||(f.use_tangent_shading=
!1,b("material",f,"use_tangent_shading"));"b4w_node_mat_type"in f&&w("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&w("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&w("material",f,"b4w_procedural_skydome");"b4w_lens_flares"in f||(f.b4w_lens_flares=!1,b("material",f,"b4w_lens_flares"));"LENS_FLARES"===f.name&&(f.b4w_lens_flares||m.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),f.b4w_lens_flares=!0);f.b4w_water&&("b4w_water_shore_smoothing"in
f||(f.b4w_water_shore_smoothing=!1,b("material",f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in f||(f.b4w_water_dynamic=!1,b("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=1,b("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,b("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,b("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=
.03,b("material",f,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=1.3,b("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=1,b("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,b("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,b("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
f||(f.b4w_water_dir_noise_scale=.05,b("material",f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in f||(f.b4w_water_dir_noise_freq=.07,b("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in f||(f.b4w_water_dir_min_noise_fac=.5,b("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,b("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,b("material",f,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=6,b("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in f||(f.b4w_water_fog_color=[.5,.7,.7],b("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in f||(f.b4w_foam_factor=5,b("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,b("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,b("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=
64,b("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in f||(f.b4w_water_detailed_dist=1E3,b("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,b("material",f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,b("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,b("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color="");"diffuse_intensity"in f||(f.diffuse_intensity=1,b("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in f||(f.b4w_collision_margin=.04,b("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,b("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,b("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=
!1,b("material",f,"b4w_do_not_render"));"HALO"!=f.type||"b4w_halo_sky_stars"in f||(f.b4w_halo_sky_stars=!1,b("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=10,b("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,b("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",b("material",f,"specular_shader"));"diffuse_shader"in
f||(f.diffuse_shader="LAMBERT",b("material",f,"diffuse_shader"));"roughness"in f||(f.roughness=.5,b("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,b("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in f||(f.diffuse_fresnel_factor=.5,b("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,b("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,b("material",f,"specular_toon_size"));"specular_toon_smooth"in f||
(f.specular_toon_smooth=.1,b("material",f,"specular_toon_smooth"));"specular_alpha"in f||(f.specular_alpha=1,b("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,b("material",f,"b4w_wettable"));"b4w_refractive"in f||(f.b4w_refractive=!1,b("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,b("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],b("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=
[0,.9,.2],b("material",f,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in f||(f.b4w_shallow_water_col_fac=1,b("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,b("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,b("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,b("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=
!1,b("material",f,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in f||(f.b4w_water_norm_uv_velocity=.05,b("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,b("material",f,"specular_ior"));"darkness"in f||(f.darkness=0,b("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,b("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,b("material",f,"diffuse_toon_smooth"));"pass_index"in f||(f.pass_index=0,b("material",
f,"pass_index"));l=f.texture_slots;for(p=0;p<l.length;p++)d=l[p],"blend_type"in d||(d.blend_type="MIX",b("texture_slot",d,"blend_type"));if(f.node_tree){l=f.node_tree.nodes;for(p=0;p<l.length;p++)q(l[p]);f.node_tree.animation_data&&c(f.node_tree.animation_data)}}d=a.node_groups;for(g=0;g<d.length;g++)for(l=d[g].node_tree.nodes,p=0;p<l.length;p++)q(l[p]);l=a.objects;for(g=0;g<l.length;g++){d=l[g];switch(d.type){case "MESH":"b4w_dynamic_geometry"in d||(d.b4w_dynamic_geometry=!1);"b4w_reflexible"in d||
(d.b4w_reflexible=!1);"b4w_reflexible_only"in d||(d.b4w_reflexible_only=!1);"b4w_reflective"in d||(d.b4w_reflective=!1);"b4w_reflection_type"in d||(d.b4w_reflection_type="PLANE",b("object",d,"b4w_reflection_type"));"b4w_wind_bending"in d||(d.b4w_wind_bending=!1,b("object",d,"b4w_wind_bending"));"b4w_wind_bending_angle"in d||(d.b4w_wind_bending_angle=10,d.b4w_wind_bending_freq=.25,b("object",d,"wind bending params"));"b4w_detail_bending_amp"in d||(d.b4w_detail_bending_amp=.1,d.b4w_branch_bending_amp=
.3,b("object",d,"detail bending params"));"b4w_detail_bending_freq"in d||(d.b4w_detail_bending_freq=1,b("object",d,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in d||(d.b4w_main_bend_stiffness_col="",b("object",d,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in d||(d.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",d,"b4w_detail_bend_colors"));"b4w_caustics"in d||(d.b4w_caustics=!1);"vertex_groups"in d&&d.vertex_groups.length&&
d.data&&0==d.data.vertex_groups.length&&(d.data.vertex_groups=d.vertex_groups,delete d.vertex_groups,b("object",d,"vertex_groups"));"b4w_vertex_anim"in d&&d.b4w_vertex_anim.length&&d.data&&0==d.data.b4w_vertex_anim.length&&(d.data.b4w_vertex_anim=d.b4w_vertex_anim,delete d.b4w_vertex_anim,b("object",d,"b4w_vertex_anim"));"b4w_do_not_render"in d||(d.b4w_do_not_render=!1);"b4w_hidden_on_load"in d||(d.b4w_hidden_on_load=!1);"use_ghost"in d.game||(d.game.use_ghost=!1);"use_sleep"in d.game||(d.game.use_sleep=
!1);"velocity_min"in d.game||(d.game.velocity_min=0);"velocity_max"in d.game||(d.game.velocity_max=0);"collision_group"in d.game||(d.game.collision_group=1);"collision_mask"in d.game||(d.game.collision_mask=255);p=d;e=p.game;f=e.collision_bounds_type;e.use_collision_bounds&&"BOX"!=f&&"CYLINDER"!=f&&"CONE"!=f&&"SPHERE"!=f&&"CAPSULE"!=f&&"EMPTY"!=f&&(m.error("Wrong collision bounds type "+f+". Disable physics for object "+p.name),p.b4w_collision=!1,p.b4w_floating=!1,p.b4w_vehicle=!1,p.b4w_character=
!1);"b4w_vehicle_settings"in d?d.b4w_vehicle_settings&&("steering_ratio"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.steering_ratio=10),"steering_max"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.steering_max=1),"inverse_control"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.inverse_control=!1),"force_max"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.force_max=1500),"brake_max"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.brake_max=100),"speed_ratio"in d.b4w_vehicle_settings||
(d.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.floating_factor=3),"floating_factor"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in d.b4w_vehicle_settings||
(d.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in d.b4w_vehicle_settings||(d.b4w_vehicle_settings.water_rot_damp=.9)):(d.b4w_vehicle_settings=null,b("object",d,"b4w_vehicle_settings"));"b4w_floating_settings"in d?d.b4w_floating_settings&&("floating_factor"in d.b4w_floating_settings||(d.b4w_floating_settings.floating_factor=3),"water_lin_damp"in d.b4w_floating_settings||(d.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in d.b4w_floating_settings||(d.b4w_floating_settings.water_rot_damp=
.8)):(d.b4w_floating_settings=null,b("object",d,"b4w_floating_settings"));"b4w_character_settings"in d?d.b4w_character_settings&&("walk_speed"in d.b4w_character_settings||(d.b4w_character_settings.walk_speed=4),"run_speed"in d.b4w_character_settings||(d.b4w_character_settings.run_speed=8),"step_height"in d.b4w_character_settings||(d.b4w_character_settings.step_height=.25),"jump_strength"in d.b4w_character_settings||(d.b4w_character_settings.jump_strength=5),"waterline"in d.b4w_character_settings||
(d.b4w_character_settings.waterline=0)):(d.b4w_character_settings=null,b("object",d,"b4w_character_settings"));"b4w_selectable"in d||(d.b4w_selectable=!1,b("object",d,"b4w_selectable"));"b4w_outlining"in d||(d.b4w_outlining=!1,b("object",d,"b4w_outlining"));"b4w_outline_on_select"in d||(d.b4w_outline_on_select=!1,b("object",d,"b4w_outline_on_select"));"b4w_billboard"in d||(d.b4w_billboard=!1,b("object",d,"b4w_billboard"));"b4w_billboard_geometry"in d||(d.b4w_billboard_geometry="SPHERICAL",b("object",
d,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in d||(d.b4w_pres_glob_orientation=!1,b("object",d,"b4w_pres_glob_orientation"));"b4w_outline_settings"in d||("b4w_glow_settings"in d?d.b4w_outline_settings=d.b4w_glow_settings:(d.b4w_outline_settings={},d.b4w_outline_settings.outline_duration=1,d.b4w_outline_settings.outline_period=1,d.b4w_outline_settings.outline_relapses=0),b("object",d,"b4w_outline_settings"));"b4w_lod_transition"in d||(d.b4w_lod_transition=.01,b("object",d,"b4w_lod_transition"));
"lod_levels"in d||(d.lod_levels=[],b("object",d,"lod_levels"));"b4w_animation_mixing"in d||(d.b4w_animation_mixing=!1,b("object",d,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in d||(d.b4w_anchor=null,b("object",d,"b4w_anchor")),!d.b4w_anchor||"max_width"in d.b4w_anchor||(d.b4w_anchor.max_width=250)}"collision_margin"in d.game||(d.game.collision_margin=.04,b("object",d,"collision_margin"));"b4w_anim_behavior"in d||(d.b4w_anim_behavior=d.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
d,"b4w_anim_behavior"));if(!("rotation_quaternion"in d)){p=[0,0,0,1];n.fk(d.rotation_euler,p);var e=p,f=p[0],r=p[1],u=p[2];e[0]=p[3];e[1]=f;e[2]=r;e[3]=u;d.rotation_quaternion=p;b("object",d,"rotation_quaternion")}"webgl_do_not_batch"in d&&(d.b4w_do_not_batch=d.webgl_do_not_batch)&&w("object",d,"webgl_do_not_batch");"b4w_shadow_cast_only"in d||(d.b4w_shadow_cast_only=!1,b("object",d,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in d||(d.b4w_correct_bounding_offset="AUTO",b("object",d,"b4w_correct_bounding_offset"));
e=d.particle_systems;for(p=0;p<e.length;p++)f=e[p],r=f.settings,"use_rotation_dupli"in r||(r.use_rotation_dupli=!1,b("particle_settings",r,"use_rotation_dupli")),"use_whole_group"in r||(r.use_whole_group=!1,b("particle_settings",r,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,b("particle_system",f,"transforms")),"b4w_billboard_align"in r||(r.b4w_billboard_align="VIEW",b("particle_settings",r,"b4w_billboard_align")),"b4w_dynamic_grass"in r||(r.b4w_dynamic_grass=!1,b("object",r,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in r||(r.b4w_dynamic_grass_scale_threshold=.01,b("object",r,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in r||(r.b4w_initial_rand_rotation=!1,b("particle_settings",r,"b4w_initial_rand_rotation")),"b4w_rotation_type"in r||(r.b4w_rotation_type="Z",b("particle_settings",r,"b4w_rotation_type")),"b4w_rand_rotation_strength"in r||(r.b4w_rand_rotation_strength=1,b("particle_settings",r,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in r||(r.b4w_hair_billboard=
!1,b("particle_settings",r,"b4w_hair_billboard")),"b4w_hair_billboard_type"in r||(r.b4w_hair_billboard_type="BASIC",b("particle_settings",r,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in r||(r.b4w_hair_billboard_jitter_amp=0,b("particle_settings",r,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in r||(r.b4w_hair_billboard_jitter_freq=0,b("particle_settings",r,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in r||(r.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",r,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in r||(r.b4w_wind_bend_inheritance="PARENT",b("particle_settings",r,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in r||(r.b4w_shadow_inheritance="PARENT",b("particle_settings",r,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in r||(r.b4w_reflection_inheritance="PARENT",b("particle_settings",r,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in r||(r.b4w_vcol_from_name="",b("particle_settings",r,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in r||(r.b4w_vcol_to_name="",b("particle_settings",r,"b4w_vcol_to_name")),"b4w_coordinate_system"in r||(r.b4w_coordinate_system="LOCAL",b("particle_settings",r,"b4w_coordinate_system")),"b4w_allow_nla"in r||(r.b4w_allow_nla=!0,b("particle_settings",r,"b4w_allow_nla")),"b4w_enable_soft_particles"in r||(r.b4w_enable_soft_particles=!1,b("particle_settings",r,"b4w_enable_soft_particles")),"b4w_particles_softness"in r||(r.b4w_particles_softness=1,b("particle_settings",r,"b4w_particles_softness")),
"billboard_tilt"in r||(r.billboard_tilt=0,b("particle_settings",r,"billboard_tilt")),"billboard_tilt_random"in r||(r.billboard_tilt_random=0,b("particle_settings",r,"billboard_tilt_random")),"use_rotations"in r||(r.use_rotations=!1,b("particle_settings",r,"use_rotations"));"constraints"in d||(d.constraints=[],b("object",d,"constraints"));e=d.modifiers;for(p=0;p<e.length;p++){a:{f=e[p];switch(f.type){case "ARRAY":if(!("fit_type"in f)){m.error("WARNING Incomplete modifier "+String(f.type)+' for "'+
d.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=!0}f||(e.splice(p,1),p--)}"animation_data"in d||(d.animation_data={action:null,nla_tracks:[]},b("object",d,"animation_data"));d.animation_data&&("action"in d.animation_data||(d.animation_data.action=null,t("no action in animation data "+d.name)),"nla_tracks"in d.animation_data||(d.animation_data.nla_tracks=[],t("no NLA in animation data "+d.name)),c(d.animation_data));"b4w_collision_id"in d||(d.b4w_collision_id="",b("object",d,
"b4w_collision_id"));"b4w_viewport_alignment"in d||(d.b4w_viewport_alignment=null,b("object",d,"b4w_viewport_alignment"));"pinverse_tsr"in d||(d.pinverse_tsr=null,b("object",d,"pinverse_tsr"));"b4w_cluster_data"in d||(d.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",d,"b4w_cluster_data"));"pass_index"in d||(d.pass_index=0,b("object",d,"pass_index"));(0>d.scale[0]||0>d.scale[1]||0>d.scale[2])&&t('negative scale for object "'+d.name+'", can lead to some errors');p=
d.scale;0==p[0]&&0==p[1]&&0==p[2]?p=!0:(e=Math.abs((p[1]-p[2])/p[1]),p=.005>Math.abs((p[0]-p[1])/p[0])&&.005>e);p||t("non-uniform scale for object "+d.name)}for(var z in A)g=A[z],p=z.match(/.*?(?=>>|$)/i)[0],m.warn('Property "'+String(p)+'" is '+g.zL+' for "'+g.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.cS=function(a,b){"num_channels"in a||(a.num_channels=1,t('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.fR=function(a){var b;a:{b=
a.modifiers;for(var c=0;c<b.length;c++){var g=b[c].type;if("ARRAY"==g||"CURVE"==g){b=!0;break a}}b=!1}if(!b)return null;b=D(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var m=a[c];switch(m.type){case "ARRAY":for(var g=b,q=m,d=0,t=0,u=0,w=new Float32Array(16),m=[],A=1;A<q.count;A++){q.use_constant_offset&&(d+=q.constant_offset_displace[0],t+=q.constant_offset_displace[1],u+=q.constant_offset_displace[2]);if(q.use_relative_offset)var G=g.b4w_bounding_box,d=d+(G.max_x-G.min_x)*q.relative_offset_displace[0],
t=t+(G.max_y-G.min_y)*q.relative_offset_displace[1],u=u+(G.max_z-G.min_z)*q.relative_offset_displace[2];n.p_(d,t,u,w);for(var E=G=D(g),M=w,F=z.fromMat4(M,O),F=f.fromMat3(F,H),x=0;x<E.submeshes.length;x++){var ka=E.submeshes[x];n.No(ka.position,M,ka.position,0);n.rL(ka.tbn_quat,F,ka.tbn_quat,0)}m.push(G)}for(A=0;A<m.length;A++)for(q=g,d=m[A],t=0;t<q.submeshes.length;t++){u=q.submeshes[t];w=d.submeshes[t];G=u.base_length;E=u.indices.length;u.base_length+=w.base_length;for(var ca in u)if("base_length"!=
ca&&"boundings"!=ca)if("indices"==ca)for(u[ca]=n.y_(u[ca],w[ca]),M=E;M<u.indices.length;M++)u.indices[M]+=G;else"vertex_colors"!=ca&&(u[ca]=n.MU(u[ca],w[ca]))}break;case "CURVE":for(g=b,A=r.kT(m.object),q=new Float32Array(16),t=A.rk?4:3,d=new Float32Array(t),t=new Float32Array(t),u=new Float32Array(3),w=new Float32Array(4),G=new Float32Array(4),E=new Float32Array(3),M=new Float32Array(3),F=new Float32Array(3),new Float32Array(4),new Float32Array(4),x=0;x<g.submeshes.length;x++){var Q=g.submeshes[x],
ka=Q.position,Q=Q.tbn_quat,W;a:{W=m.deform_axis;switch(W){case "POS_X":case "NEG_X":W=0;break a;case "POS_Y":case "NEG_Y":W=1;break a;case "POS_Z":case "NEG_Z":W=2;break a;default:n.q("Wrong deform axis value "+W)}W=void 0}E[0]=0;E[1]=0;E[2]=0;E[W]=1;for(var ha=r.TZ(A),v=0;v<ka.length/3;v++){F[0]=ka[3*v];F[1]=ka[3*v+1];F[2]=ka[3*v+2];var Z=F[W],Y=r.SZ(A,Z);r.UZ(A,Y,d);u[0]=d[0];u[1]=d[1];u[2]=d[2];r.RZ(A,Y,t);M[0]=t[0];M[1]=0;M[2]=t[2];e.normalize(M,M);f.rotationTo(E,M,w);0>Z?(d[0]=M[0],d[1]=M[1],
d[2]=M[2],e.scale(d,Z,d),e.add(u,d,u)):Z>ha&&(d[0]=M[0],d[1]=M[1],d[2]=M[2],e.scale(d,Z-ha,d),e.add(u,d,u));p.fromRotationTranslation(w,u,q);A.rk&&(f.setAxisAngle(E,d[3],G),e.transformQuat(F,G,F));F[W]=0;e.transformMat4(F,q,F);ka[3*v]=F[0];ka[3*v+1]=F[1];ka[3*v+2]=F[2];Q.length&&(H[0]=Q[4*v],H[1]=Q[4*v+1],H[2]=Q[4*v+2],H[3]=Q[4*v+3],f.multiply(H,w,H),Q[4*v]=H[0],Q[4*v+1]=H[1],Q[4*v+2]=H[2],Q[4*v+3]=H[3])}}}l.iY(b)}return b};a.aT=function(){return{name:"DEFAULT",uuid:n.uB(),use_nodes:!1,diffuse_shader:"LAMBERT",
diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,
.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,
1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.mR=function(a,b){function c(b,d){for(var e in b){var f=b[e],g=f[0];if(1<f.length)for(var h=1;h<f.length;h++)g+="*"+f[h];for(h=0;h<a.length;h++)if(f=a[h],f.name==g)for(var k in d)f[k]=d[k]}}for(var e=b.b4w_logic_nodes,f=0;f<e.length;f++)for(var g=e[f],d=0;d<g.length;d++){var l=g[d],m={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in m)n in
l&&(l[m[n]]=l[n]);for(var p in l.variables)"boolean"!=typeof l.variables[p][0]&&(l.variables[p]=[!1,l.variables[p]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(l.type)&&("variable1"in l&&(l.variables.v1=[!1,l.variable1]),"variable2"in l&&(l.variables.v2=[!1,l.variable2]),"variabled"in l&&(l.variables.vd=[!1,l.variabled]));switch(l.type){case "SELECT":for(var q=0;q<a.length;q++)m=a[q],m.name==l.object&&(m.b4w_selectable=!0);l.bools||(l.bools={});l.bools.not_wait||(l.bools.not_wait=!1);t('Logic nodes type "SELECT" is deprecated');
break;case "SWITCH_SELECT":c(l.objects_paths,{b4w_selectable:!0});if(l.links instanceof Array){t('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var m={},r=0;for(q in l.objects_paths)m[q]=l.links[r],r++;l.links=m}break;case "SELECT_PLAY":t('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');l.mute=!0;break;case "SELECT_PLAY_ANIM":t('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');
break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(l.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(l.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(l.objects_paths,{b4w_do_not_batch:!0});switch(l.common_usage_names.space_type){case "WORLD":l.common_usage_names.space_type=M.qP;break;case "PARENT":l.common_usage_names.space_type=M.pP;break;case "LOCAL":l.common_usage_names.space_type=M.oP}break;case "OUTLINE":c(l.objects_paths,
{b4w_outlining:!0});break;case "CONDJUMP":l.condition&&(l.common_usage_names.condition=l.condition);if("cnd"in l.floats)l.common_usage_names.condition=l.floats.cnd;else switch(l.common_usage_names.condition){case "GEQUAL":l.common_usage_names.condition=M.lF;break;case "LEQUAL":l.common_usage_names.condition=M.nF;break;case "GREATER":l.common_usage_names.condition=M.mF;break;case "LESS":l.common_usage_names.condition=M.oF;break;case "NOTEQUAL":l.common_usage_names.condition=M.pF;break;case "EQUAL":l.common_usage_names.condition=
M.kF}void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);l.bools||(l.bools={});void 0===l.bools.str&&(l.bools.str=!1,l.floats.inp1=l.input1,l.floats.inp2=l.input2);break;case "SEND_REQ":l.bools||(l.bools={});l.strings||(l.strings={});void 0===l.bools.ct&&(l.bools.ct=!1);void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "MATH":void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);void 0!=l.input1&&(l.floats.inp1=l.input1);void 0!=l.input2&&
(l.floats.inp2=l.input2);break;case "REGSTORE":l.floats||(l.floats={});l.strings||(l.strings={});void 0!=l.number1&&(l.input1=l.number1);if(void 0!=l.input1)switch(typeof l.input1){case "number":l.floats.inp1=l.input1;l.common_usage_names.variable_type="NUMBER";break;default:l.strings.inp1=l.input1,l.common_usage_names.variable_type="STRING"}switch(l.common_usage_names.variable_type){case "NUMBER":l.common_usage_names.variable_type=M.rP;break;case "STRING":l.common_usage_names.variable_type=M.sP}break;
case "PAGEPARAM":l.bools||(l.bools={});void 0===l.bools.hsh&&(l.bools.hsh=!1);l.floats||(l.floats={});void 0===l.floats.ptp&&(l.floats.ptp=0);break;case "PLAY_ANIM":c(l.objects_paths,{b4w_do_not_batch:!0});l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);(m=l.common_usage_names.param_anim_behavior)||(m="FINISH_STOP");l.common_usage_names.param_anim_behavior=E.Mz(m);break;case "STOP_ANIM":l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);break;case "STRING":switch(l.common_usage_names.string_operation){case "JOIN":l.common_usage_names.string_operation=
M.lP;break;case "FIND":l.common_usage_names.string_operation=M.kP;break;case "REPLACE":l.common_usage_names.string_operation=M.mP;break;case "SPLIT":l.common_usage_names.string_operation=M.nP;break;case "COMPARE":l.common_usage_names.string_operation=M.jP}if("cnd"in l.floats)l.common_usage_names.condition=l.floats.cnd;else switch(l.common_usage_names.condition){case "GEQUAL":l.common_usage_names.condition=M.lF;break;case "LEQUAL":l.common_usage_names.condition=M.nF;break;case "GREATER":l.common_usage_names.condition=
M.mF;break;case "LESS":l.common_usage_names.condition=M.oF;break;case "NOTEQUAL":l.common_usage_names.condition=M.pF;break;case "EQUAL":l.common_usage_names.condition=M.kF}break;case "REDIRECT":void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "SET_CAMERA_MOVE_STYLE":switch(l.common_usage_names.camera_move_style){case "STATIC":l.common_usage_names.camera_move_style=M.cP;break;case "TARGET":l.common_usage_names.camera_move_style=M.dP;break;case "EYE":l.common_usage_names.camera_move_style=
M.aP;break;case "HOVER":l.common_usage_names.camera_move_style=M.bP}break;case "ENTRYPOINT":l.bools||(l.bools={});void 0===l.bools.js&&(l.bools.js=!1);l.bools.js&&(l.mute=!0);break;case "JS_CALLBACK":for(n in l=l.common_usage_names.js_cb_params,l)switch(l[n]){case "OBJECT":l[n]=M.eP;break;case "VARIABLE":l[n]=M.fP}}}}};b4w.module.__logic_nodes=function(a,g){function q(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.ix;f++)if(H.rd(a,b,f))for(var g=0;g<c.hx.length;g++)if(c.hx[g]==f){e.Om==c.kN?(M.Pf(e.ra)&&(c.state=-1),d.Wf.Mf||(c.state=1,c.Ws=c.ow[g])):(c.state=1,c.Ws=c.ow[g]);return}c.state=0}}}function c(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.ix;f++)if(H.rd(a,b,f)&&f==c.KL){if(M.Pf(e.ra)&&e.Om==c.kN)c.state=-1;else if(!d.Wf.Mf||c.U.no_wait)c.state=
1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Oa:a.slot_idx_order,Ws:a.slot_idx_jump,va:a.frame_range[0],$a:a.frame_range[1],RU:a.frame_range_mask?a.frame_range_mask[0]:!0,QU:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,ix:-1,KL:-1,LX:a.param_name,JX:a.operation,qc:a.mute,rr:a.object,obj:null,lc:null,vc:null,eb:{},bg:a.anim_name,Bc:n.xl,NX:a.parse_json_vars,MX:a.parse_json_paths,Jc:a.objects_paths,NK:a.nodes_paths,Hb:a.floats,U:a.bools,W:a.variables,yj:a.strings,
sC:a.materials_names,wM:a.shader_nd_type,Ae:a.common_usage_names,pU:a.encode_json_vars,oU:a.encode_json_paths,kN:b,kL:Q[a.type]?Q[a.type]:l,Xw:!1,Qx:0,hx:null,XW:a.links,ow:[]}}function w(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function t(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function D(a,b,c){switch(b.state){case 2:c.la=a.Oa}}function l(a,b,c){switch(b.state){case 1:F.error("Unknown node type: "+a.type);break;case 2:c.la=a.Oa}}function r(a){return E.xc(E.Nc,a.rr||[],0)}function p(a,c){var d=a.b4w_logic_nodes,
e=c.pe;c.state=1;for(var f=0;f<d.length;f++){var g={N:[],Wf:{yb:a,la:0,Mf:!1,mE:f,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(g);for(var h=e[e.length-1],k=d[f],l=0;l<k.length;l++){var m=b(k[l],h);h.N.push(m)}for(k=0;k<h.N.length;k++)m=h.N[k],m.qc||m.kL(m,c,g.Wf,0,0)}var d=a.timeline_markers,n;for(n in d)c.Xs.push(d[n]);c.Xs.sort(function(a,b){return a-b});c.state=2;W.push(c)}function m(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function f(a){switch(typeof a){case "string":return m(a,1);case "number":return m(a,0);default:return m(a,1)}}var n=g("__animation"),e=g("__assets"),z=g("__camera"),M=g("__nla"),E=g("__objects"),F=g("__print"),A=g("__scenes"),O=g("__config"),H=g("__controls"),I=g("__batch"),C=g("__geometry"),h=g("__mat3"),k=g("__mat4"),J=g("__physics"),y=g("__quat"),d=g("__sfx"),B=g("__time"),u=g("__transform"),ba=g("__tsr"),K=g("__util"),G=g("__vec3"),T=new Float32Array(4);new Float32Array(4);var P=new Float32Array(3),
X=new Float32Array(3),x=new Float32Array(2),ka=new Float32Array(9),ca=new Float32Array(16);a.rP=0;a.sP=1;a.lP=0;a.kP=1;a.mP=2;a.nP=3;a.jP=4;a.lF=0;a.nF=1;a.mF=2;a.oF=3;a.pF=4;a.kF=5;a.qP=0;a.pP=1;a.oP=2;a.cP=0;a.dP=1;a.aP=2;a.bP=3;a.eP=0;a.fP=1;var Q={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.la=a.Oa}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=r(a);a.obj||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:A.Lq(a.obj,!0),c.la=a.Oa}},SHOW:function(a,
b,c){switch(b.state){case 1:a.obj=r(a);a.obj||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:A.Lq(a.obj,!1),c.la=a.Oa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.W.vd;b=b.u;var e=c.u,f;a:{f=a.LX;var g=a.Hb.ptp,h=a.U.hsh,k=O.get("url_params");if(k&&f in k)f=Number(k[f]);else{if(h=h?location.hash:location.search)for(h=h.slice(1).split("&"),k=0;k<h.length;k++){var l=h[k].split("=");if(1<l.length&&l[0]==f){f=m(l[1],g);break a}}f=0}}t(d,b,e,f);c.la=
a.Oa}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.pe[c.mE];var d=E.qJ();a.hx=[];a.ow=[];for(var e in a.Jc){var f=E.xc(E.Nc,a.Jc[e],0),g=d.indexOf(f);if(-1==g){F.error("logic script error: non-selectable object:",a.Jc[e][a.Jc[e].length-1]);break a}a.hx.push(g);a.ow.push(a.XW[e])}a.state=-1;a.ix=d.length;e=[];for(g=0;g<d.length;g++)e.push(H.Qu(d[g],!1));H.K(f,"LOGIC_NODES_SWITCH_SELECT_"+a.label,H.Od,e,H.Zu,q(),[a,b,c])}break;case 2:if(-1==a.state){b=b.pe[c.mE].N;for(f=0;f<b.length;f++)d=
b[f],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.la=a.state?a.Ws:a.Oa,a.state=-1}},SELECT:function(a,b,d){switch(b.state){case 1:d=b.pe[d.mE];var e=r(a),f=E.qJ(),g=f.indexOf(e);if(-1==g)F.error("logic script error: non-selectable object:",a.rr[a.rr.length-1]);else{a.state=-1;a.ix=f.length;a.KL=g;for(var g=[],h=0;h<f.length;h++)g.push(H.Qu(f[h],!1));H.K(e,"LOGIC_NODES_SELECT_"+a.label,H.Od,g,H.Zu,c(),[a,b,d])}break;case 2:if(0==a.state||1==a.state){d.la=a.state?a.Ws:
a.Oa;a.state=-1;break}a.U.not_wait&&(d.la=a.Oa)}},PLAY:function(a,b,c,d){switch(b.state){case 1:M.TM();a.state=-1;a.U.not_wait||(a.U.not_wait=!1);break;case 2:switch(a.state){case -1:if(M.Pf(b.ra))if(b.TA==b.Om&&c.Mf)break;else{var e=b.Om;if(e){e.Wf.la=e.N[e.Wf.la].Oa;e.N[e.Wf.la].state=-1;for(var e=b.Om.N,f=0;f<e.length;f++){var g=e[f];"PLAY"==g.type&&(g.state=-1)}}}c.Mf=!a.U.not_wait;b.Om=b.TA;a.state=0;a.RU&&(M.jZ(a.va),M.eM(d));if(a.QU)M.JD(a.$a);else{d=M.mo(d);var e=-1,h;for(h in b.Xs)if(d<b.Xs[h]){e=
h;break}0<=e?M.JD(b.Xs[e]):M.JD(M.YI())}M.XX();a.U.not_wait&&(c.la=a.Oa,a.state=-1,c.Mf=!1);break;case 0:M.Pf()||(c.la=a.Oa,a.state=-1,c.Mf=!1);break;case 1:c.la=a.Oa;a.state=-1;b.Om=null;c.Mf=!1;break;default:K.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.U.url?m(w(a.W.url,b.u,c.u),1):a.yj.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.W.v1[1]?a.Hb.inp1:m(w(a.W.v1,b.u,c.u),0),e=-1==a.W.v2[1]?a.Hb.inp2:
m(w(a.W.v2,b.u,c.u),0),f=0;switch(a.JX){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;case "DIV":0==e&&K.q("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}t(a.W.vd,b.u,c.u,f);c.la=a.Oa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.U.str?1:0,e=a.U.str?a.yj:a.Hb,f=-1==a.W.v1[1]?e.inp1:m(w(a.W.v1,b.u,c.u),d);b=-1==a.W.v2[1]?e.inp2:m(w(a.W.v2,b.u,c.u),d);d=!1;switch(a.Ae.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0);break;
case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.la=d?a.Ws:a.Oa}},REGSTORE:function(a,b,c){switch(b.state){case 2:t([a.U.gl||a.W.vd[0],a.W.vd[1]],b.u,c.u,(1==a.Ae.variable_type?a.yj:a.Hb).inp1),c.la=a.Oa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.U.env?E.Ev(a.rr[0],0):r(a);a.obj||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:switch(0!=a.state||n.Pf(a.obj,a.Bc)||(a.state=1),a.state){case -1:for(var d in b.pe){var e=
b.pe[d].Wf.la;-1!=e&&(e=b.pe[d].N[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}b=a.Ae.param_anim_behavior;if(""==a.bg)n.qu(a.obj),n.bn(a.obj,b,n.xl);else{a:{d=a.obj;for(var e=a.bg,f=-1,g=0;8>g;g++){var h=d.ia[g];if(h&&h.Hi&&n.WM(h.Hi)==n.WM(e))if(-1!=f)f=g;else{d=-1;break a}}d=f}-1==d?(a.Bc=n.EZ(a.obj,a.bg),n.apply(a.obj,null,a.bg,a.Bc)):a.Bc=d;n.bn(a.obj,b,a.Bc)}a.U.not_wait||(c.Mf=!0);n.play(a.obj,null,a.Bc);a.state=0;a.U.not_wait&&(c.la=a.Oa,a.state=-1);break;case 0:break;
case 1:a.U.not_wait||(c.Mf=!1);c.la=a.Oa;a.state=-1;break;default:K.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:D,SEND_REQ:function(a,b,c){function d(a,e,f,g,h){a=JSON.stringify(a);t(h[0].W.dst,b.u,c.u,a);h[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var f=a.U.url?m(w(a.W.url,b.u,c.u),1):a.yj.url,g={};a.U.ct&&(g["Content-Type"]=a.yj.ct);"GET"==a.Ae.request_type?e.Wd([{id:f,type:e.zn,url:f,Ik:g,Jb:[a,c.u]}],d,null,null,null):"POST"==a.Ae.request_type&&e.Wd([{id:f,
type:e.zn,url:f,Ik:g,li:"POST",Oo:e.zn,Wm:m(w(a.W.dst1,b.u,c.u),1),Jb:[a,c.u]}],d,null,null,null);break;case 1:a.state=-1,c.la=a.Oa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.eb["id"+b]=E.xc(E.Nc,a.Jc["id"+b],0),a.eb["id"+b]||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:I.fW(a.eb.id0,a.sC.id0,a.eb.id1,a.sC.id1),c.la=a.Oa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Jc.id0&&(a.eb.id0=E.xc(E.Nc,a.Jc.id0,0),a.Jc.id0||
(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0),a.NK.id0.unshift(a.sC.id0));break;case 2:var d=a.eb.id0,e=a.NK.id0,f=e[0],g=I.HU(d,f,"MAIN");c.la=a.Oa;if(null===g){F.error('Material "'+f+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.wM){var h=I.fJ(g.jj,e);I.fZ(d,f,h,a.U.id0?m(w(a.W.id0,b.u,c.u),0):a.Hb.id0,a.U.id1?m(w(a.W.id1,b.u,c.u),0):a.Hb.id1,a.U.id2?m(w(a.W.id2,b.u,c.u),0):a.Hb.id2)}"ShaderNodeValue"==a.wM&&(h=I.fJ(g.kj,e),I.gZ(d,f,h,a.U.id0?
m(w(a.W.id0,b.u,c.u),0):a.Hb.id0))}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.Qx=0,c.Mf=!0):0==a.state&&(a.Qx+=e,(a.U.dl?m(w(a.W.dl,b.u,c.u),0):a.Hb.dl)<a.Qx&&(a.state=-1,c.la=a.Oa,c.Mf=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.eb.id0=E.xc(E.Nc,a.Jc.id0,0);b||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);c=a.Ae.sk;C.rS(b)?C.$V(b,c)||(F.error("Wrong key name:",c),a.qc=!0):(F.error("No shape keys in object:",b.name),
a.qc=!0);break;case 2:C.gR(a.eb.id0,a.Ae.sk,a.U.skv?m(w(a.W.skv,b.u,c.u),0):a.Hb.skv),c.la=a.Oa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.eb.id0=E.xc(E.Nc,a.Jc.id0,0);d||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);d&&d.k&&d.k.Uc||(F.error("Can't evaluate 'Outline' logic node: wrong object"),a.qc=!0);break;case 2:d=a.eb.id0;switch(a.Ae.outline_operation){case "PLAY":b=d.k.gi;E.Kn(d,b.Fk,b.Gk,b.Hk);break;case "STOP":E.Hu(d);break;case "INTENSITY":d.k.qh=a.U["in"]?
m(w(a.W["in"],b.u,c.u),0):a.Hb["in"]}c.la=a.Oa}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,e){switch(z.tm(a)){case z.Kb:z.Ts(a,b,c);break;case z.md:case z.Jg:u.uj(a,e);break;case z.ad:G.sub(c,b,P),G.normalize(P,P),z.px(a,c),c=b=0,X[0]=P[0],X[1]=0,X[2]=P[2],b=G.dot(X,P),c=Math.acos(b/(G.length(X)*G.length(P))),b=P[2]?Math.atan(P[0]/P[2]):0<P[0]?0:Math.PI,0<P[2]&&0<P[0]?x[1]=-(Math.PI+x[1]):0<P[2]&&0>P[0]?x[1]=-(Math.PI+x[1]):0>P[2]&&0>P[0]?(x[0]+=Math.PI,b=-(Math.PI-b)):0>P[2]&&0<P[0]&&(x[0]+=Math.PI,
b-=Math.PI),z.Ms(a,b+Math.PI,-c,!0,!0)}u.D(a);J.H(a)}function e(a,b,c,d){k.lookAt(b,c,K.nc,ca);k.invert(ca,ca);h.fromMat4(ca,ka);y.fromMat3(ka,T);y.normalize(T,T);ba.oi(b,ba.$d(a.k.n),T,d)}switch(b.state){case 1:c=null;c=a.eb.ca=E.xc(E.Nc,a.Jc.id0,0);c||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.eb.tr=E.xc(E.Nc,a.Jc.id1,0);a.eb.tr||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.eb.ta=E.xc(E.Nc,a.Jc.id2,0);a.eb.ta||(F.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0);a.state=-1;a.vc={tN:new Float32Array(3),sN:new Float32Array(3),$B:new Float32Array(3),iE:new Float32Array(3),fN:new Float32Array(3),ZB:new Float32Array(3),il:new Float32Array(8),vi:new Float32Array(8),Vr:new Float32Array(8)};break;case 2:var f=a.eb.ca,g=ba.G(a.eb.tr.k.n),l=ba.G(a.eb.ta.k.n);switch(a.state){case -1:b=a.U.dur?m(w(a.W.dur,b.u,c.u),0):a.Hb.dur;if(0==b){e(f,g,l,a.vc.vi);d(f,g,l,a.vc.vi);c.la=a.Oa;break}G.copy(ba.G(f.k.n),a.vc.tN);var n=z.tm(f);n==z.ad?G.copy(f.k.Vb,a.vc.iE):
n==z.Jg||n==z.md?(ba.copy(f.k.n,a.vc.il),e(f,g,l,a.vc.vi)):G.copy(f.k.pivot,a.vc.iE);G.copy(g,a.vc.sN);G.copy(l,a.vc.fN);a.state=0;var p=B.Oj(0,1,1E3*b,function(b){A.Da()&&(n==z.Jg||n==z.md?ba.aC(a.vc.il,a.vc.vi,K.fn(b),a.vc.Vr):(a.vc.ZB=G.lerp(a.vc.iE,a.vc.fN,K.fn(b),a.vc.ZB),a.vc.$B=G.lerp(a.vc.tN,a.vc.sN,K.fn(b),a.vc.$B)),d(f,a.vc.$B,a.vc.ZB,a.vc.Vr),1==b&&(a.state=1))});break;case 1:B.Pn(p),a.state=-1,c.la=a.Oa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d=null,d=a.eb.ca=
E.xc(E.Nc,a.Jc.id0,0);d||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);b=d.k;a.WR={el:b.el,use_panning:b.use_panning,lb:b.lb,ka:b.ka,sb:b.sb,Cc:b.Cc,Dc:b.Dc,fe:b.fe,Uh:b.Uh};break;case 2:var d=a.eb.ca,e=d.k,f=a.WR;z.xt(d);switch(a.Ae.camera_move_style){case 0:e.ub=z.Jg;break;case 2:e.ub=z.md;var g=ba.G(e.n);z.wZ(d,g,null,f.lb,f.ka);break;case 3:e.ub=z.ad;var g=ba.G(e.n),h=P;a.U.pvo?(h=E.xc(E.Nc,a.Jc.id1,0),h=ba.G(h.k.n)):(h[0]=a.U.pvx?m(w(a.W.pvx,b.u,c.u),0):a.Hb.pvx,h[1]=
a.U.pvy?m(w(a.W.pvy,b.u,c.u),0):a.Hb.pvy,h[2]=a.U.pvz?m(w(a.W.pvz,b.u,c.u),0):a.Hb.pvz);z.tM(d,g,h,f.sb,f.ka,f.Cc,f.Dc,f.Uh);break;case 1:e.ub=z.Kb,g=ba.G(e.n),h=P,a.U.pvo?(h=E.xc(E.Nc,a.Jc.id1,0),h=ba.G(h.k.n)):(h[0]=a.U.pvx?m(w(a.W.pvx,b.u,c.u),0):a.Hb.pvx,h[1]=a.U.pvy?m(w(a.W.pvy,b.u,c.u),0):a.Hb.pvy,h[2]=a.U.pvz?m(w(a.W.pvz,b.u,c.u),0):a.Hb.pvz),z.uM(d,g,h,f.lb,f.ka,f.q4,f.fe,f.use_panning)}X[0]=a.U.vtr?m(w(a.W.vtr,b.u,c.u),0):a.Hb.vtr;X[1]=a.U.vro?m(w(a.W.vro,b.u,c.u),0):a.Hb.vro;X[2]=a.U.vzo?
m(w(a.W.vzo,b.u,c.u),0):a.Hb.vzo;X[0]=K.V(X[0],0,Infinity);X[1]=K.V(X[1],0,Infinity);X[2]=K.V(X[2],0,.99);e.ol=X[0];e.nl=X[1];e.pl=X[2];u.D(d);J.H(d);z.ro(d);c.la=a.Oa}},MOVE_TO:function(a,b,c){function d(a,b){u.uj(a,b);u.D(a);J.H(a)}switch(b.state){case 1:a.eb.ob=E.xc(E.Nc,a.Jc.id0,0);a.eb.ob||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.eb.de=E.xc(E.Nc,a.Jc.id1,0);a.eb.de||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.lc={bI:new Float32Array(8),
aB:new Float32Array(8),WJ:new Float32Array(8)};break;case 2:var e=a.eb.ob;ba.copy(a.eb.ob.k.n,a.lc.bI);ba.copy(a.eb.de.k.n,a.lc.aB);switch(a.state){case -1:b=a.U.dur?m(w(a.W.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(e,a.lc.aB);c.la=a.Oa;break}a.state=0;var f=B.Oj(0,1,1E3*b,function(b){A.Da()&&(a.lc.u7=ba.aC(a.lc.bI,a.lc.aB,K.fn(b),a.lc.WJ),d(e,a.lc.WJ),1==b&&(a.state=1))});break;case 1:B.Pn(f),a.state=-1,c.la=a.Oa}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?u.uj(a,b):u.xx(a,b);u.D(a);J.H(a)}
switch(b.state){case 1:a.eb.ob=E.xc(E.Nc,a.Jc.id0,0);a.eb.ob||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.lc={Jx:0,il:new Float32Array(8),vi:new Float32Array(8),Vr:new Float32Array(8)};break;case 2:var e=a.eb.ob;switch(a.state){case -1:X[0]=a.U.trx?m(w(a.W.trx,b.u,c.u),0):a.Hb.trx;X[1]=a.U["try"]?m(w(a.W["try"],b.u,c.u),0):a.Hb["try"];X[2]=a.U.trz?m(w(a.W.trz,b.u,c.u),0):a.Hb.trz;P[0]=a.U.rox?m(w(a.W.rox,b.u,c.u),0)*Math.PI/180:a.Hb.rox;P[1]=a.U.roy?m(w(a.W.roy,
b.u,c.u),0)*Math.PI/180:a.Hb.roy;P[2]=a.U.roz?m(w(a.W.roz,b.u,c.u),0)*Math.PI/180:a.Hb.roz;var f=a.U.sc?w(a.W.sc,b.u,c.u):a.Hb.sc;K.fk(P,T);ba.oi(X,f,T,a.lc.vi);a.lc.Jx=a.Ae.space_type;switch(a.lc.Jx){case 0:u.Mr(e,a.lc.il);break;case 1:u.Nr(e,a.lc.il);break;case 2:u.Nr(e,a.lc.il),ba.multiply(a.lc.il,a.lc.vi,a.lc.vi)}b=a.U.dur?m(w(a.W.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(e,a.lc.vi,a.lc.Jx);c.la=a.Oa;break}a.state=0;f=B.Oj(0,1,1E3*b,function(b){A.Da()&&(ba.aC(a.lc.il,a.lc.vi,K.fn(b),a.lc.Vr),d(e,a.lc.Vr,
a.lc.Jx),1==b&&(a.state=1))});break;case 1:B.Pn(f),a.state=-1,c.la=a.Oa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=E.xc(E.Nc,a.Jc.id0,0);a.obj||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);void 0==a.U.not_wait&&(a.U.not_wait=!0);break;case 2:switch(d.BW(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var e in b.pe){var f=b.pe[e].Wf.la;-1!=f&&(f=b.pe[e].N[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.obj==a.obj&&(f.state=1))}a.U.not_wait||(c.Mf=!0);
d.cL(a.obj);a.state=0;break;case 0:a.U.not_wait&&(c.la=a.Oa,a.state=-1);break;case 1:a.U.not_wait||(c.Mf=!1);c.la=a.Oa;a.state=-1;break;default:K.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=E.xc(E.Nc,a.Jc.id0,0);a.obj||(F.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:d.stop(a.obj),c.la=a.Oa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.U.env?E.Ev(a.rr[0],0):r(a);a.obj||(F.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0);break;case 2:n.stop(a.obj,n.xl),a.U.rst&&n.DD(a.obj,n.xl),c.la=a.Oa}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.U.rst&&M.eM(d),M.TM(),c.la=a.Oa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.W)d[a.W[e][1]]=w(a.W[e],b.u,c.u);F.log(a.Ae.msg,JSON.stringify(d));c.la=a.Oa}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.U.id0?m(w(a.W.id0,b.u,c.u),1):a.yj.id0,e=a.U.id1?m(w(a.W.id1,b.u,c.u),1):a.yj.id1,f=0;switch(a.Ae.string_operation){case 0:f=
d+e;break;case 1:f=d.indexOf(e);break;case 2:f=d.replace(e,a.U.id2?m(w(a.W.id2,b.u,c.u),1):a.yj.id2);break;case 3:var g=a.W,f=d.substring(0,d.indexOf(e));t(g.dst1,b.u,c.u,d.substring(d.indexOf(e)+1,d.length));""==w(g.dst,b.u,c.u)&&(f=w(g.dst1,b.u,c.u),t(g.dst1,b.u,c.u,""));break;case 4:switch(a.Ae.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}t(a.W.dst,b.u,c.u,f);c.la=a.Oa}},GET_TIMELINE:function(a,
b,c,d){switch(b.state){case 2:d=a.U.nla?m(M.mo(d),0):m(B.mo(d),0),t(a.W.vd,b.u,c.u,d),c.la=a.Oa}},JSON:function(a,b,c){function d(a,b,c,e){for(var g=0;g<b.length;g++){for(var h=b[g].split("."),k=a,l=c[g],m=0;m<h.length&&(k=k[h[m]],void 0!==k&&null!==k);m++);k=f(k);e[l]=k}}function e(a,b,c,d){d||(d={});for(var g=0;g<b.length;g++){var h=b[g].split("."),k=d,l=c[g];if(!(!l in a)){for(var m=0;m<h.length-1;m++)void 0===k[h[m]]&&(k[h[m]]=isNaN(h[m+1])?{}:[]),k=k[h[m]];k[h[h.length-1]]=f(a[l])}}}switch(b.state){case 2:switch(a.Ae.json_operation){case "PARSE":try{var g=
JSON.parse(m(w(a.W.jsn,b.u,c.u),1));d(g,a.MX,a.NX,c.u)}catch(h){F.error("logic script error: non valid JSON string")}break;case "ENCODE":g={},e(c.u,a.oU,a.pU,g),g=m(JSON.stringify(g),1),t(a.W.jsn,b.u,c.u,g)}c.la=a.Oa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.U.cb?m(w(a.W.cb,b.u,c.u),1):a.yj.cb,e=[],g=0,h="id"+g,k=a.Ae.js_cb_params;h in k;)h=0==k[h]?E.xc(E.Nc,a.Jc[h],0):w(a.W[h],b.u,c.u),e.push(h),g++,h="id"+g;k=[];g=0;for(h="out"+g;h in a.W;)h=w(a.W[h],b.u,c.u),k.push(h),g++,
h="out"+g;g=1;if(d in ha){if(g=!ha[d](e,k))for(d=0;d<k.length;d++)h="out"+d,h in a.W&&t(a.W[h],b.u,c.u,f(k[d]))}else F.error("logic script error: no custom callback with id "+d);g&&(c.la=a.Oa)}},EMPTY:D},W=[],ha={};a.iW=function(a,b){var c={Ye:b,IL:a.name,state:0,Om:null,yb:a,TA:null,pe:[],Xs:[],u:{}};a.E2=c;p(a,c)};a.update=function(a,b){var c=M.OV();if(!(0>=c))for(var d=0;d<W.length;d++)for(var e=d,f=a,g=b,h=c,k=W[e],l=0;l<W[e].pe.length;l++){k.TA=W[e].pe[l];var m=W[e].pe[l],n=k,p=f,q=g,r=h,u=m.N;
if(u.length){for(var t=0;t<u.length;t++)u[t].Xw=!1;for(t=0;t<u.length;t++){if(0<=m.Wf.la)var x=u[m.Wf.la];else break;if(x.Xw)break;if(x.qc)if("ENTRYPOINT"==x.type)break;else m.Wf.la=x.Oa,x.Xw=!0;else x.kL(x,n,m.Wf,p,q,r),x.Xw=!0}}}};a.I2=function(a,b){ha[a]=b};a.A8=function(a){delete ha[a]};a.M8=function(a,b){for(var c=0;c<W.length;c++)if(W[c].IL==a){for(var c=W[c],d=0;d<c.pe.length;d++){var e=c.pe[d].N[0];if(e.name==b){e.U.js&&(e.qc=!1);c.pe[d].Wf.la=0;break}}break}};a.ua=function(){W.length=0;ha=
{}}};b4w.module.__nla=function(a,g){function q(){return{type:"CLIP",va:0,$a:0,rj:!1,paused:!1,bg:"",oq:"",Bc:0,Eo:null,Mj:0,Bl:0,jI:0,iI:0,ON:!1,scale:1,repeat:1,ZF:0}}function c(a,b,e){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var g=0;g<f.length;g++)f[g].Eo=e,b.push(f[g])}a=a.nodes;for(g=0;g<a.length;g++)if(f=a[g],f.node_group){var l=f.node_group.node_tree;if(l){var d=e.slice();d.push(f.name);c(l,b,d)}}}function b(a,b){var c=Math.round(a)-b.va;b.Dj&&(c%=b.ik,0>c&&(c+=b.ik));return b.Tb+
c}function w(a,b){var c=(b-H)*F.qd()+a.Tb;c>a.va?(c-=a.va,a.Ce&&(c%=a.$a-a.va+1),c+=a.va):c=a.va;return c}function t(a,b){a=A.V(a,b.va,b.$a);var c=a==b.$a?b.ZF:b.Mj+(a-b.va)/b.scale%(b.Bl-b.Mj);b.ON&&(c=b.Bl-c+b.Mj);return c}function D(a,b){for(var c=[],e=0;e<a.length;e++){var f=a[e],g=f.strips;if(g)for(var d=0;d<g.length;d++){var l=g[d],m=q();m.type=l.type;m.va=l.frame_start;m.$a=l.frame_end;m.Bc=b;m.Mj=l.action_frame_start;m.Bl=l.action_frame_end;m.ON=l.use_reverse;m.scale=l.scale;m.repeat=l.repeat;
l.action&&(m.bg=l.action.name,m.oq=l.action.uuid,m.Eo=f.Eo);c.push(m)}}return c}function l(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function r(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],e=c.node_tree;if(c=c.use_nodes&&e)a:{if(e.animation_data&&(c=e.animation_data.nla_tracks)&&c.length){c=!0;break a}e=e.nodes;for(c=0;c<e.length;c++);c=!1}if(c)return!0}return!1}
function p(a,b){var c=z.A();if(c.ra){var e=w(c.ra,b);c.ra.Tb-=e-a;c.ra.io=!0}}var m=g("__animation");g("__config");var f=g("__objects"),n=g("__obj_util"),e=g("__print"),z=g("__scenes"),M=g("__sfx"),E=g("__textures"),F=g("__time"),A=g("__util"),O=[],H=-1;a.kl=function(a,b){var e,f=null;for(e=b.I.length-1;0<=e;e--){var g=b.I[e];if(g.yb.b4w_use_nla&&(f=g,g.yb.VF))break}if(e=f){e.RK=!0;var p=0;if((f=a.animation_data)&&f.nla_tracks.length){var d=f.nla_tracks;if(n.Am(b)||n.xa(b)||n.be(b)||n.so(b)||n.hh(b)||
n.as(b)||n.fC(b))d=D(d,p),d.length&&(b.tg=b.tg.concat(d),p++)}l(a)&&(d=a.data.animation_data.nla_tracks,d=D(d,p),d.length&&(b.tg=b.tg.concat(d),p++));if(n.be(b))for(g=a.data.materials,f=0;f<g.length;f++){var r=g[f];if(r.use_nodes&&r.node_tree&&(d=[],c(r.node_tree,d,[r.name]),d=D(d,p),d.length)){for(var r=p,u=d,t=m.jV(),z=[],G=0,w=0;w<u.length;w++){var E=u[w];""!=E.oq?E=A.Ed("uuid",E.oq,t):(E=E.bg,E=A.Ed("name",E,t)||A.Ed("name",E+"_B4W_BAKED",t));if(E){var E=E.fcurves,M=[],x;for(x in E)M.push(x);
z.push(M)}}for(w=0;w<z.length;w++){t=!1;for(E=0;E<w;E++)if(A.jR(z[w],z[E])){u[w].Bc=u[E].Bc;t=!0;break}t||(u[w].Bc=p+G++)}p=r+G;b.tg=b.tg.concat(d)}}if(!n.fC(b)){for(f=0;f<a.particle_systems.length;f++)g=a.particle_systems[f],x=g.settings,"EMITTER"==x.type&&x.b4w_allow_nla&&(x=q(),x.type="CLIP",x.va=e.yb.frame_start,x.$a=e.yb.frame_end+1,x.bg=g.name,x.Bc=p,x.Mj=x.va,x.Bl=x.$a,b.tg.push(x),p++);e=p+1;for(f=0;f<b.Yc.length;f++)g=b.Yc[f],g.GQ&&(p=e,x=q(),x.type="CLIP",x.va=g.va,x.$a=g.$a,x.bg=g.name,
x.Bc=p,x.Mj=x.va,x.Bl=x.$a,b.tg.push(x))}}};a.$_=function(a,b,c){a.ra||(a.ra={va:a.frame_start,$a:a.frame_end,Tb:0,fs:-1,Es:a.frame_end,Fs:a.frame_start,Ap:null,Ce:b,eb:[],ya:[],IL:a.name,vk:!1,io:!1,tD:!0},O.push(a.ra));b=a.ra;for(var g=f.pJ(a,"ALL",c),l=0;l<g.length;l++){var m=g[l];if(m.tg.length){b.eb[c]||(b.eb[c]=[]);for(var d=0;d<m.I.length;d++){var n=m.I[d];n.yb==a&&n.RK&&b.eb[c].push(m)}for(var d=m.tg,n=b,p=m.name,r=0;r<d.length;r++){var t=d[r];n.va>t.$a||n.$a<t.va?(e.warn("NLA: Strip is out of scene range: "+
(p+" ["+t.va+":"+t.$a+"]")),d.splice(r,1),r--):t.bg||"CLIP"!=t.type||(e.warn('NLA: no action in strip for object "'+p+'".'),d.splice(r,1),r--)}m=m.tg;d=b;for(n=0;n<m.length;n++){for(var p=m[n],r=d.va,t=d.$a+1,z=0;z<m.length;z++){var w=m[z];p.Bc==w.Bc&&(w.$a<=p.va&&(r=p.va),w.va>=p.$a&&(t=Math.min(t,w.va)))}p.jI=r;p.iI=t;p.ZF=0===p.repeat%1?p.Bl:p.Mj+p.repeat%1*(p.Bl-p.Mj)}}}a=a.s.Fp;for(l=0;l<a.length;l++)g=a[l].s,g.ll&&(g.Sa||g.ud)&&g.vt==c&&(m=q(),m.type="VIDEO",g.Dj?(m.va=0,m.$a=b.$a):(m.va=A.V(g.va,
0,b.$a),m.$a=A.V(g.va+g.ik,0,b.$a)),m.bg=a[l].name,b.ya.push(g))};a.start=function(){H=0};a.OV=function(){return H};a.J5=function(a){return a.ra?a.ra.Tb:null};a.f9=function(a,b){return a.ra?(a.ra.Tb=b,!0):!1};a.update=function(a,c){if(!(0>H)){0==H&&(H=a);for(var e=0;e<O.length;e++){var f=O[e];f.vk&&(f.Tb-=F.qd()*c);var g=w(f,a);if((!f.vk||f.io)&&g>=f.Es)if(f.Ce){var g=f,l=a;g.Ap&&g.Ap();p(g.Fs,l);g.tD=!0;g=w(g,l)}else{var l=f,d=g;l.vk=!0;l.Tb-=d-l.Es;l.Ap&&l.Ap()}if(!f.vk||f.io){for(var l=f,d=g,n=
0;n<l.eb.length;n++){var q=l.eb[n];if(q)for(var r=0;r<q.length;r++){for(var z=q[r],G=z.tg,D=0;D<G.length;D++){var P=G[D];"SOUND"==P.type&&d<l.fs-1E-6&&(P.rj=!1)}for(D=0;D<G.length;D++)switch(P=G[D],P.type){case "CLIP":if(P.jI<=d&&d<P.iI&&!P.rj){var n=z,X=P,x=X.Eo;""!=X.oq?m.dR(n,x,X.oq,X.Bc):m.apply(n,x,X.bg,X.Bc);m.bn(n,m.ry,X.Bc);x=t(X.va,X);m.cn(n,x,X.Bc);for(n=0;n<G.length;n++)G[n]!=P&&G[n].Bc==P.Bc&&(G[n].rj=!1);P.rj=!0}P.rj&&(X=z,x=t(d,P),1E-6<Math.abs(x-m.RI(X,P.Bc))&&m.cn(X,x,P.Bc));break;
case "SOUND":if((d<l.fs-1E-6||l.fs<P.va)&&P.va<=d&&d<P.$a&&!P.rj){var X=z,ka=P,x=(ka.va-d)/F.qd(),ka=(ka.$a-ka.va)/F.qd();M.play(X,x,ka);P.rj=!0}l.fs<P.$a&&P.$a<=d&&P.rj&&(P.rj=!1)}}}l=a;d=f;q=g;for(r=0;r<d.ya.length;r++)if(z=d.ya[r],z.Sa||z.ud){G=E.$N(z);D=z;P=A.V(b(q,D),D.Tb,D.Tb+E.aO(D)-1);D.ud&&(P=E.v0(D,P),P==D.Ps&&P--);D=P;P=E.bO(z);X=n=!1;if(d.io||d.tD)X=!0;d.vk||(x=b(q,z),x=z.Tb<=x&&x<=z.Tb+E.aO(z),ka=E.cO(z),z.Dj&&D==P&&(X=!0),ka||G==D||(X=!0),x&&!ka?E.eL(z):x&&ka?n=!0:!x&&ka&&(z.Sa&&G<D?
n=!0:E.WC(z)));X?(E.WY(z,D),z.ud&&(z.Tk=E.jx(z,l))):n&&E.dO(z)&&(z.Sa?E.HN(z):(G=E.jx(z,l),G!=z.Tk&&(z.sj=D,E.GN(z)),z.Tk=G))}f.fs=g}f.io=!1;f.tD=!1}}};a.ua=function(a){if(0==a)O.length=0,H=-1;else for(var b=0;b<O.length;b++)O[b].eb[a]=null};a.NG=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||l(a)||r(a)?!0:!1};a.cn=p;a.mo=function(a){var b=z.A();return b.ra?w(b.ra,a):-1};a.TM=function(){var a=z.A();if(a.ra){a.ra.vk=!0;for(var a=a.ra.ya,b=0;b<a.length;b++)E.WC(a[b])}};a.XX=function(){var a=
z.A();a.ra&&(a.ra.vk=!1,a.ra.Ap=null)};a.K5=function(){var a=z.A();return a.ra?a.ra.va:-1};a.YI=function(){var a=z.A();return a.ra?a.ra.$a:-1};a.Pf=function(){var a=z.A();return a.ra?!a.ra.vk:!1};a.z3=function(){var a=z.A();return a.ra?a.b4w_use_nla:!1};a.y3=function(){var a=z.A();return a.ra?0<a.b4w_logic_nodes.length:!1};a.x9=function(a,b){var c=z.A();if(c.ra)c.ra.Fs=a,c.ra.Es=b;else return!1};a.JD=function(a){var b=z.A();b.ra&&(b.ra.Es=a)};a.jZ=function(a){var b=z.A();b.ra&&(b.ra.Fs=a)};a.G8=function(){var a=
z.A();if(a.ra)a=a.ra,a.Fs=a.va,a.Es=a.$a;else return!1};a.Z8=function(a){var b=z.A();if(b.ra)b.ra.Ce=a;else return!1};a.G3=function(){var a=z.A();a.ra&&(a.ra.Ap=null)};a.eM=function(a){var b=z.A().ra;b&&(b.Tb=-(a-H)*F.qd()+b.Fs,b.io=!0)};a.YI=function(){var a=z.A().ra;return a?a.$a:null}};b4w.module.__controls=function(a,g){function q(a,b){b||(b=n.Fe());return{type:a,value:0,Z:null,element:b,Ka:!1,key:0,cc:"",Oh:!1,uA:null,tA:function(){},sA:null,rH:function(){},qi:null,from:new Float32Array(3),to:new Float32Array(3),XJ:!1,Wv:!1,Gs:0,tL:function(){},axis:"",Xf:0,sp:new Float32Array(3),Zw:new Float32Array(4),threshold:0,oL:new Float32Array(4),uu:0,tu:0,EL:0,vu:0,Rf:0,repeat:!1,hI:!1,mm:0,callback:function(){}}}function c(a){function b(){return{Zj:new Float32Array(2),Gm:!0,obj:null,
identifier:-1,hw:!0}}a||(a=n.Fe());for(var c=0;c<B.length;c++){var d=B[c];if(a==d.element)return d}d={element:a,bs:!0,Ge:0,iw:!0,zw:0,Aw:0,Mm:0,Nm:0,As:0,Bs:0,zh:new Float32Array(2),ue:new Float32Array(2),Ah:new Float32Array(2),Le:new Float32Array(2),Rx:0,vE:0,rN:0,af:new Uint8Array(256),ny:0,LB:null,fi:b(),ln:Array(10),eC:!1,IJ:F.create(),Lv:0,Kv:0,Jv:0,OB:0,NB:0,Iv:Infinity,QC:null,PC:null,GC:null,CC:null,EC:null,tE:null,sE:null,FC:null,DC:null,aD:null,H7:null,uE:null,rE:null,qE:null,pj:{}};for(c=
0;10>c;++c)d.ln[c]=b();d.QC=function(a){d.eC||(e.VV(a,d.IJ),d.eC=!0)};d.PC=function(a){a=I.copy(a,K);d.Jv=a[0];d.Kv=a[1];d.Lv=a[2];Infinity==d.Iv&&(d.Iv=a[0],d.NB=a[1],d.OB=a[2])};d.GC=function(a){d.ny+=a*C.zX};d.CC=function(a){var b=e.fa(e.$c,d.element),b=e.Zi(b,e.Ci,u);d.zw=b[0];d.Aw=b[1];d.Mm=b[0];d.Nm=b[1];if(3==d.Ge||0==d.Ge)d.Ge=1;d.which=a};d.EC=function(){var a=e.fa(e.$c,d.element),a=e.Zi(a,e.Ci,u),a=n.Nq(a[0],a[1],u);d.fi.Gm=!1;d.fi.Zj[0]=a[0];d.fi.Zj[1]=a[1]};d.tE=function(a){for(var b=
0;b<a.length;++b){for(var c=a[b],e=null,f=null,g=0;g<d.ln.length;g++){var h=d.ln[g];if(h.identifier==c.identifier){h.hw&&(f=h);break}else!e&&h.hw&&(e=h,e.identifier=c.identifier)}if(c=f||e)e=n.Nq(a[b].clientX,a[b].clientY,u),c.Gm=!1,c.hw=!1,c.Zj[0]=e[0],c.Zj[1]=e[1]}};d.sE=function(a){for(var b=0;b<d.ln.length;++b){for(var c=d.ln[b],e=!1,f=0;f<a.length;++f)if(a[f].identifier==c.identifier){e=!0;break}e||(c.Gm=!0,c.hw=!0,c.obj=null)}};d.FC=function(a){var b=e.fa(e.$c,d.element),b=e.Zi(b,e.Ci,u);d.zw=
b[0];d.Aw=b[1];d.Mm=b[0];d.Nm=b[1];0<d.Ge&&(d.Ge=3);d.which=a};d.DC=function(a){if(!h.no||d.Ge)d.Mm=a[0],d.Nm=a[1]};d.aD=function(a){if(!h.no||d.Ge)d.As+=a[0],d.Bs+=a[1]};d.iK=function(a){2!=d.af[a]&&(d.af[a]=1,d.bs=!1)};d.kK=function(){for(var a=0;a<d.af.length;a++)0!=d.af[a]&&(d.af[a]=3,d.bs=!1)};d.lK=function(a){d.bs=!1;d.af[a]=3};d.uE=function(a){d.iw=!1;if(1==a.length)d.zh[0]=a[0].clientX,d.zh[1]=-1,d.Ah[0]=a[0].clientY,d.Ah[1]=-1;else if(1<a.length){d.Rx=d.vE=p(a);d.zh[0]=a[0].clientX;d.zh[1]=
a[1].clientX;d.Ah[0]=a[0].clientY;d.Ah[1]=a[1].clientY;var b=a[0];a=a[1];d.rN=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}d.ue.set(d.zh);d.Le.set(d.Ah)};d.rE=function(a){1===a.length?(d.ue[0]=a[0].clientX,d.ue[1]=-1,d.Le[0]=a[0].clientY,d.Le[1]=-1):1<a.length&&(d.ue[0]=a[0].clientX,d.ue[1]=a[1].clientX,d.Le[0]=a[0].clientY,d.Le[1]=a[1].clientY,d.Rx=p(a))};d.qE=function(a){0==a.length&&(d.iw=!0)};B.push(d);return d}function b(a,b){if(b in a.pj&&0<a.pj[b])a.pj[b]+=1;else switch(a.pj[b]=1,b){case "orientation_quat":var c=
e.fa(e.Fh);c&&e.zd(c,e.Bn,a.QC);break;case "orientation_angles":(c=e.fa(e.Fh))&&e.zd(c,e.Bn,a.PC);break;case "mouse_wheel":(c=e.fa(e.$c,a.element))&&e.zd(c,e.bq,a.GC);break;case "mouse_down_which":(c=e.fa(e.$c,a.element))&&e.zd(c,e.vl,a.CC);break;case "mouse_select":(c=e.fa(e.$c,a.element))&&e.zd(c,e.vl,a.EC);break;case "touch_select":if(c=e.fa(e.Ig,a.element))e.zd(c,e.zl,a.tE),e.zd(c,e.yl,a.sE);break;case "mouse_up_which":(c=e.fa(e.$c,a.element))&&e.zd(c,e.aq,a.FC);break;case "mouse_location":(c=
e.fa(e.$c,a.element))&&e.zd(c,e.Ci,a.DC);break;case "mouse_pointerlock":(c=e.fa(e.$c,a.element))&&e.zd(c,e.jF,a.aD);break;case "keyboard_downed_keys":if(c=e.fa(e.Mp,a.element))e.zd(c,e.Yp,a.iK),e.zd(c,e.aF,a.kK),e.zd(c,e.Zp,a.lK);break;case "touch_start":(c=e.fa(e.Ig,a.element))&&e.zd(c,e.zl,a.uE);break;case "touch_move":(c=e.fa(e.Ig,a.element))&&e.zd(c,e.hq,a.rE);break;case "touch_end":(c=e.fa(e.Ig,a.element))&&e.zd(c,e.yl,a.qE)}}function w(a,b){if(!(!b in a.pj)&&0<a.pj[b]&&(--a.pj[b],!a.pj[b]))switch(b){case "orientation_quat":var c=
e.fa(e.Fh);c&&e.Cd(c,e.Qt,a.QC);break;case "orientation_angles":(c=e.fa(e.Fh))&&e.Cd(c,e.Bn,a.PC);break;case "mouse_wheel":(c=e.fa(e.$c,a.element))&&e.Cd(c,e.bq,a.GC);break;case "mouse_down_which":(c=e.fa(e.$c,a.element))&&e.Cd(c,e.vl,a.CC);break;case "mouse_select":(c=e.fa(e.$c,a.element))&&e.Cd(c,e.vl,a.EC);break;case "touch_select":if(c=e.fa(e.Ig,a.element))e.Cd(c,e.zl,a.tE),e.Cd(c,e.yl,a.sE);break;case "mouse_up_which":(c=e.fa(e.$c,a.element))&&e.Cd(c,e.aq,a.FC);break;case "mouse_location":(c=
e.fa(e.$c,a.element))&&e.Cd(c,e.Ci,a.DC);break;case "mouse_pointerlock":(c=e.fa(e.$c,a.element))&&e.Cd(c,e.jF,a.aD);break;case "keyboard_downed_keys":if(c=e.fa(e.Mp,a.element))e.Cd(c,e.Yp,a.iK),e.Cd(c,e.aF,a.kK),e.Cd(c,e.Zp,a.lK);break;case "touch_start":(c=e.fa(e.Ig,a.element))&&e.Cd(c,e.zl,a.uE);break;case "touch_move":(c=e.fa(e.Ig,a.element))&&e.Cd(c,e.hq,a.rE);break;case "touch_end":(c=e.fa(e.Ig,a.element))&&e.Cd(c,e.yl,a.qE)}}function t(a,b){a.value=Number(b)}function D(a){for(var b=a.Sk,c=a.KY,
d=0;d<b.length;d++)c[d]=b[d].value;return a.gX(c)}function l(a,b){a=a||J;var c=a.wh;if(c){var e=a.an;if(b){var f=c[b];if(f){for(var g=f.Sk,h=0;h<g.length;h++){var m=g[h],n;n=y.indexOf(m);n=-1<n?d[n]:[];1==n.length?(r(m),m=y.indexOf(m),-1<m?(y.splice(m,1),d.splice(m,1)):H.q("Sensors cache is corrupted")):1<n.length&&n.splice(n.indexOf(f),1)}delete c[b];h=e.indexOf(f);-1<h?e.splice(h,1):H.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=k.indexOf(a),-1<c?k.splice(c,1):M.error("Wrong object"))}}else{e=
[];for(b in c)e.push(b);for(h=0;h<e.length;h++)l(a,e[h])}T=!0}}function r(a){switch(a.type){case 90:E.mD(a.uA,a.cc,a.tA);a.Ka=!0;break;case 100:E.pA(a.sA);a.Ka=!0;break;case 110:E.nD(a.Gs);a.Ka=!0;break;case 140:a.Ka=!0;break;case 20:var b=c(a.element);w(b,"keyboard_downed_keys");a.Ka=!0;break;case 30:b=c(a.element);w(b,"mouse_wheel");a.Ka=!0;break;case 40:b=c(a.element);w(b,"mouse_down_which");w(b,"mouse_up_which");w(b,"mouse_location");a.Ka=!0;break;case 260:b=c(a.element);w(b,"mouse_pointerlock");
a.Ka=!0;break;case 50:b=c(a.element);w(b,"mouse_down_which");w(b,"mouse_up_which");a.Ka=!0;break;case 60:b=c(a.element);w(b,"touch_start");w(b,"touch_move");w(b,"touch_end");a.Ka=!0;break;case 70:b=c(a.element);w(b,"touch_start");w(b,"touch_move");a.Ka=!0;break;case 75:b=c(a.element);w(b,"touch_start");w(b,"touch_move");a.Ka=!0;break;case 80:b=c(a.element);w(b,"touch_start");w(b,"touch_end");a.Ka=!0;break;case 170:b=c(a.element);w(b,"mouse_select");w(b,"touch_select");w(b,"touch_start");w(b,"touch_end");
w(b,"mouse_down_which");w(b,"mouse_up_which");a.Ka=!0;break;case 180:case 190:b=c(a.element);w(b,"orientation_angles");a.Ka=!0;break;case 200:b=c(a.element);w(b,"orientation_quat");a.Ka=!0;break;case 210:case 220:a.Ka=!0}}function p(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function m(a){return 0==a?e.fa(e.Dt):1==a?e.fa(e.Gy):2==a?e.fa(e.Hy):e.fa(e.Iy)}var f=g("__config"),n=g("__container"),e=g("__input"),z=g("__objects"),M=g("__print"),E=g("__physics"),
F=g("__quat"),A=g("__time"),O=g("__tsr"),H=g("__util"),I=g("__vec3"),C=f.controls,h=f.B,k=[],J={},y=[],d=[],B=[],u=new Float32Array(2),ba=new Float32Array(2),K=I.create(),G=F.create(),T=!1,P=0;a.yf=10;a.na=20;a.Hg=30;a.Od=40;a.Lp=50;a.Dy=60;a.au=0;a.$t=1;a.Zt=2;a.yz=3;var X=1;a.update=function(b,d){for(var f=0;f<B.length;f++){var g=B[f];g.fi.Gm||(g.fi.obj=z.Lo(g.fi.Zj[0],g.fi.Zj[1]),g.fi.Gm=!0,g.LB=g.fi.obj);for(var l=0;10>l;++l){var n=g.ln[l];n.Gm||(n.obj=z.Lo(n.Zj[0],n.Zj[1]),n.Gm=!0,g.LB=n.obj)}}for(f=
0;f<y.length;f++)if(g=y[f],n=b,l=d)switch(g.type){case 120:var p=g.qi,q=O.jc(p.k.n,K),p=O.Zd(p.k.n,G),r=I.dist(g.sp,q),w=g.oL;F.invert(g.Zw,w);F.multiply(p,w,w);F.normalize(w,w);w=Math.abs(2*Math.acos(w[3]));r/=l;g.uu=H.Zb(r,g.uu,l,.3);g.Z[0]=r;r=w/l;g.tu=H.Zb(r,g.tu,l,.3);g.Z[1]=r;g.uu>=g.threshold||g.tu>=g.EL?t(g,1):t(g,0);I.copy(q,g.sp);F.copy(p,g.Zw);g.Xf=n;break;case 130:p=g.qi;q=O.jc(p.k.n,K);p=Math.abs(q[1]-g.sp[1])/l;g.vu=H.Zb(p,g.vu,l,.3);g.Z=p;g.vu>=g.threshold?t(g,1):t(g,0);I.copy(q,g.sp);
g.Xf=n;break;case 140:!g.Ka&&0<=g.Rf&&n-g.Xf>=g.Rf&&(t(g,1),g.repeat?g.Xf=n:g.Rf=-g.Rf);break;case 150:g.Xf||(g.Xf=n);t(g,n-g.Xf);g.Xf=n;break;case 160:t(g,n);break;case 180:n=c(g.element);g.Z[0]=n.Lv-n.OB;g.Z[1]=n.Kv-n.NB;g.Z[2]=n.Jv-n.Iv;break;case 190:n=c(g.element);g.Z[0]=n.Lv;g.Z[1]=n.Kv;g.Z[2]=n.Jv;break;case 200:n=c(g.element);F.copy(n.IJ,g.Z);break;case 210:l=e.fa(e.yd);e.Zi(l,e.Rt,g.Z);break;case 220:l=e.fa(e.yd);e.Zi(l,e.St,g.Z);break;case 240:l=m(g.mm);g.value=e.DV(l,g.key);break;case 250:l=
m(g.mm);g.value=e.CV(l,g.key);break;case 230:t(g,g.callback());break;case 30:n=c(g.element);t(g,n.ny);break;case 40:n=c(g.element);if(!h.no||1==n.Ge||2==n.Ge)switch(q=n.Mm-n.zw,p=n.Nm-n.Aw,g.Z.coords[0]=n.Mm,g.Z.coords[1]=n.Nm,g.axis){case "X":t(g,q);break;case "Y":t(g,p);break;case "XY":l=Math.sqrt(q*q+p*p),t(g,l)}break;case 260:n=c(g.element);h.no||(q=n.As,p=n.Bs,r=H.Zb(q,0,l,.1*X),l=H.Zb(p,0,l,.1*X),.01<Math.abs(q)||.01<Math.abs(p)?(n.As-=r,n.Bs-=l,g.Z.coords[0]=r,g.Z.coords[1]=l):(g.Z.coords[0]=
0,g.Z.coords[1]=0),t(g,Math.sqrt(q*q+p*p)));break;case 50:n=c(g.element);t(g,0<n.Ge|0);g.Z.which=n.which;g.Z.coords[0]=n.Mm;g.Z.coords[1]=n.Nm;break;case 170:n=c(g.element);t(g,0);if(g.hI)n.LB==g.qi&&t(g,1);else if(n.Ge&&n.fi.obj==g.qi)t(g,1);else if(!n.iw)for(l=0;10>l;++l)if(n.ln[l].obj==g.qi){t(g,1);break}break;case 20:n=c(g.element);g.Z=n.af[g.key];1==g.Z||n.af[0]&&16==g.key?t(g,1):g.Z||t(g,0);break;case 60:n=c(g.element);if(-1==n.ue[1]&&-1==n.Le[1]){q=n.ue[0]-n.zh[0];p=n.Le[0]-n.Ah[0];l=Math.sqrt(q*
q+p*p);if(-1!=n.zh[1]&&-1!=n.Ah[1]){var r=n.ue[0]-n.zh[1],w=n.Le[0]-n.Ah[1],C=Math.sqrt(r*r+w*w);C<l&&(q=r,p=w,l=C)}g.Z.gesture=a.au}else l=u,l[0]=(n.ue[0]+n.ue[1])/2,l[1]=(n.Le[0]+n.Le[1])/2,p=ba,p[0]=(n.zh[0]+n.zh[1])/2,p[1]=(n.Ah[0]+n.Ah[1])/2,q=l[0]-p[0],p=l[1]-p[1],l=Math.sqrt(q*q+p*p),g.Z.gesture=a.Zt;g.Z.coords[0]=n.ue[0];g.Z.coords[1]=n.Le[0];switch(g.axis){case "X":t(g,q);break;case "Y":t(g,p);break;case "XY":t(g,l)}break;case 70:n=c(g.element);l=n.Rx-n.vE;g.Z=a.$t;t(g,l);break;case 75:n=
c(g.element);-1!=n.ue[1]&&(l=Math.atan2(n.Le[0]-n.Le[1],n.ue[0]-n.ue[1]),g.Z=a.yz,t(g,l-n.rN));break;case 80:n=c(g.element),g.Z.coords[0]=n.ue[0],g.Z.coords[1]=n.Le[0],n.iw?t(g,0):t(g,1)}for(f=0;f<k.length;f++)for(n=k[f],g=n.an,l=0;l<g.length;l++)if(q=g[l],q.jl!=P){q.jl=P;w=q;p=0;switch(w.type){case a.yf:p=(r=D(w))?1:0;break;case a.na:p=w.cj;(r=D(w))?(p=1,w.cj=1):1==p?(p=-1,w.cj=-1):p=0;break;case a.Hg:p=w.cj;(r=D(w))&&-1==p?(p=1,w.cj=1):r||1!=p?p=0:(p=-1,w.cj=-1);break;case a.Od:p=w.cj;(r=D(w))&&
-1==p?(p=1,w.cj=1):r||1!=p?p=0:(p=0,w.cj=-1);break;case a.Lp:r=D(w);w.pK!=r?(p=1,w.pK=r):p=0;break;case a.Dy:r=w.Sk;w=w.KW;for(C=0;C<r.length;C++){var A=r[C].value;p||A==w[C]||(p=1);w[C]=A}break;default:H.q("Wrong sensor manifold type: "+w.type)}if(p&&(r=n==J?null:n,T=!1,q.callback(r,q.id,p,q.VR),T)){f=-1;break}}for(f=0;f<k.length;f++)for(n=k[f],g=n.an,l=0;l<g.length;l++)for(q=g[l],n=q.Sk,q=0;q<n.length;q++)switch(p=n[q],p.type){case 30:t(p,0);break;case 40:t(p,0);break;case 60:t(p,0);break;case 70:t(p,
0);break;case 75:t(p,0);break;case 80:t(p,0);break;case 140:t(p,0)}for(f=0;f<B.length;f++){g=B[f];if(!g.bs){for(l=0;l<g.af.length;l++)1==g.af[l]?g.af[l]=2:3==g.af[l]&&(g.af[l]=0);g.bs=!0}1==g.Ge?g.Ge=2:3==g.Ge&&(g.Ge=0);g.ny=0;g.zw=g.Mm;g.Aw=g.Nm;g.af[0]=0;g.zh.set(g.ue);g.Ah.set(g.Le);g.vE=g.Rx;g.OB=g.Lv;g.NB=g.Kv;g.Iv=g.Jv;g.eC=!1}P++};a.DA=function(a){var b=q(10);t(b,a);return b};a.Gb=function(a){var b=q(20,document);b.key=a;b.Ka=!0;return b};a.cr=function(a,b){var c=q(240,document);b=b||e.WI();
c.mm=b;c.key=a;c.Ka=!0;return c};a.Oi=function(a,b){var c=q(250,document);b=void 0==b?e.WI():b;c.mm=b;c.key=a;c.Ka=!0;return c};a.Ou=function(a,b,c){if(!a||!E.oa(a))return M.error("Wrong collision object"),null;var d=q(90);d.uA=a;d.cc=b;d.Oh=c;d.Z={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.tA=function(a,b,c,e,f){t(d,a);a=d.Z;a.coll_obj=b;d.Oh&&(a.coll_pos.set(c),a.coll_norm.set(e),a.coll_dist=f)};d.Ka=!0;return d};a.zH=function(a){if(!a||
!a.C)return M.error("Wrong collision impulse object"),null;var b=q(100);b.sA=a;b.rH=function(a){t(b,a)};b.Ka=!0;return b};a.bk=function(a,b,c,d,e,f,g){var h=q(110);h.qi=a;h.from=b;h.to=c;h.cc=d;h.XJ=e;h.Oh=f;h.Wv=g;h.Z={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Gs:0};h.tL=function(a,b,c,d,e,f){h.XJ?t(h,-1==b?0:1):t(h,b);h.Z.hit_fract=b;h.Z.obj_hit=c;h.Z.hit_time=d;h.Oh&&(h.Z.hit_pos.set(e),h.Z.hit_norm.set(f))};h.Ka=!0;return h};a.Tn=function(a){a=
q(50,a);a.Ka=!0;a.Z={coords:new Float32Array(2),which:null};return a};a.IA=function(a){a=q(30,a);a.Ka=!0;return a};a.Wl=function(a,b){var c=q(40,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2)};c.Ka=!0;return c};a.fr=function(a,b){var c=q(60,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2),gesture:0};c.Ka=!0;return c};a.QA=function(a){a=q(70,a);a.Z=0;a.Ka=!0;return a};a.OH=function(a){a=q(75,a);a.Z=0;a.Ka=!0;return a};a.Su=function(a){a=q(80,a);a.Z={coords:new Float32Array(2)};a.Ka=!0;return a};
a.FH=function(a,b,c){if(!a)return M.error("Wrong collision object"),null;var d=q(120);d.qi=a;var e=O.G(a.k.n);a=O.R(a.k.n);d.oL=new Float32Array(4);d.sp=new Float32Array(e);d.Zw=new Float32Array(a);d.uu=0;d.tu=0;d.threshold=b||.1;d.EL=c||.1;d.Xf=0;d.Z=new Float32Array([0,0]);return d};a.PH=function(a,b){if(!a)return M.error("Wrong collision object"),null;var c=q(130);c.qi=a;var d=O.R(a.k.n);c.sp=new Float32Array(O.G(a.k.n));c.Zw=new Float32Array(d);c.vu=0;c.threshold=b||1;c.Xf=0;c.Z=0;return c};a.NH=
function(a,b){var c=q(140);c.Rf=a;c.repeat=b;c.Ka=!0;return c};a.AL=function(a,b,c,d){a=a||J;a=a.wh;if(!a||!a[b])return M.error("reset_timer_sensor(): wrong object"),null;b=a[b].Sk[c];if(!b)return M.error("reset_timer_sensor(): sensor not found"),null;b.Xf=A.lk();b.Rf=d};a.eg=function(){var a=q(150);a.Xf=0;return a};a.DH=function(){var a=q(180,window);a.Z=new Float32Array(3);e.fa(e.Fh)?t(a,1):t(a,0);a.Ka=!0;return a};a.CH=function(){var a=q(190,window);a.Z=new Float32Array(3);e.fa(e.Fh)?t(a,1):t(a,
0);a.Ka=!0;return a};a.FA=function(){var a=q(200,window);a.Z=F.create();e.fa(e.Fh)?t(a,1):t(a,0);a.Ka=!0;return a};a.GA=function(){var a=q(210,window);a.Z=F.create();e.fa(e.yd)?t(a,1):t(a,0);a.Ka=!0;return a};a.EH=function(){var a=q(220,window);a.Z=I.create();e.fa(e.yd)?t(a,1):t(a,0);a.Ka=!0;return a};a.MH=function(){return q(160)};a.Qu=function(a,b){var c=q(170);c.qi=a;c.hI=b;c.Ka=!0;return c};a.CA=function(a,b){var c=q(230);c.callback=a;t(c,b);return c};a.JA=function(a){a=q(260,a);a.Z={coords:new Float32Array(2)};
a.Ka=!0;return a};a.KA=function(a){a=q(270,a);a.Ka=!0;return a};a.JY=t;a.rd=function(a,b,c){a=a||J;a=a.wh;if(!a||!a[b])return M.error("get_sensor_value(): wrong object"),null;b=a[b].Sk[c];return b?b.value:(M.error("get_sensor_value(): sensor not found"),null)};a.ae=function(a,b,c){a=a||J;a=a.wh;if(!a||!a[b])return M.error("get_sensor_payload(): wrong object"),null;b=a[b].Sk[c];return b?b.Z:(M.error("get_sensor_payload(): sensor not found"),null)};a.ua=function(){k=[];J={};for(var a=0;a<y.length;a++)r(y[a]);
y.length=0;d.length=0};a.Pl=function(a,b){a=a||J;if(!a.wh)return!1;if(b&&a.wh[b])return!0;if(!b)for(var c in a.wh)return!0;return!1};a.K=function(a,f,g,h,m,n,p){a=a||J;a.an=a.an||[];a.wh=a.wh||{};var q=a.wh,r=a.an;q[f]&&l(a,f);g={id:f,type:g,Sk:h.slice(0),gX:m,KY:Array(h.length),callback:n,VR:p,cj:-1,pK:0,KW:Array(h.length),jl:-1};q[f]=g;r.push(g);-1==k.indexOf(a)&&k.push(a);h=g.Sk;for(a=0;a<h.length;a++){q=f=h[a];if(q.Ka){switch(q.type){case 90:E.Nz(q.uA,q.cc,q.tA,q.Oh);break;case 100:E.Pz(q.sA,
q.rH);break;case 110:q.Gs=E.pu(q.qi,q.from,q.to,q.cc,q.tL,!1,!1,q.Oh,q.Wv);q.Z.Gs=q.Gs;break;case 140:q.Xf=A.lk();0>q.Rf&&(q.Rf=-q.Rf);break;case 20:r=c(q.element);b(r,"keyboard_downed_keys");break;case 30:r=c(q.element);b(r,"mouse_wheel");break;case 40:r=c(q.element);b(r,"mouse_down_which");b(r,"mouse_up_which");b(r,"mouse_location");break;case 260:r=c(q.element);b(r,"mouse_pointerlock");break;case 270:e.EQ(q);break;case 50:r=c(q.element);b(r,"mouse_down_which");b(r,"mouse_up_which");break;case 60:r=
c(q.element);b(r,"touch_start");b(r,"touch_move");b(r,"touch_end");break;case 70:r=c(q.element);b(r,"touch_start");b(r,"touch_move");break;case 75:r=c(q.element);b(r,"touch_start");b(r,"touch_move");break;case 80:r=c(q.element);b(r,"touch_start");b(r,"touch_end");break;case 170:r=c(q.element);b(r,"mouse_select");b(r,"touch_select");b(r,"touch_start");b(r,"touch_end");b(r,"mouse_down_which");b(r,"mouse_up_which");break;case 180:case 190:r=c(q.element);b(r,"orientation_angles");break;case 200:r=c(q.element);
b(r,"orientation_quat");break;case 240:0==q.mm?e.fa(e.Dt):1==q.mm?e.fa(e.Gy):2==q.mm?e.fa(e.Hy):e.fa(e.Iy)}q.Ka=!1}q=y.indexOf(f);-1==q?(y.push(f),d.push([g])):d[q].push(g)}T=!0};a.Yu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.Zu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.he=l;a.reset=function(){for(var a=0;a<k.length;a++){var b=k[a],c=b.wh,b=b.an,e;for(e in c)delete c[e];b.length=0}for(a=0;a<y.length;a++)r(y[a]);k.length=
0;y.length=0;d.length=0};a.debug=function(){M.log(String(k.length)+" objects with manifolds",k);M.log(String(y.length)+" sensors",y);for(var a=[],b=[],c=0;c<y.length;c++){var d=y[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}M.log(String(a.length)+" collision sensors",a);M.log(String(b.length)+" ray sensors",b)};a.rx=function(a){X=a}};b4w.module.__data=function(a,g){function q(a,b){Ta[b.id]=null;Ba[b.id]=null}function c(a,b,c,d){a instanceof ArrayBuffer&&(a=N.FJ(a,d));d=a.width;a=a.height;wa.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf($a)&&c&&wa.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.ah)||Da.q("Nothing requested");la.Wd([{id:d,type:la.zn,url:d,gh:b.tk}],function(d,f,g,h){if(d){wa.log("%cLOAD METADATA","color: #616",h);f=Da.UM(d.b4w_format_version);
switch(Da.XN(f,sa.Lm)){case -1:f[0]<sa.Lm[0]?Da.q("JSON version is too old relative to B4W engine: "+Da.ql(f)+", required: "+Da.ql(sa.Lm)+". Reexport scene with the latest B4W addon to fix it."):wa.warn("JSON version is a bit old relative to B4W engine: "+Da.ql(f)+", required: "+Da.ql(sa.Lm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>sa.Lm[0]?Da.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
wa.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}sa.qC=f;for(var k in d)a[k]=d[k];b.Mb&&(Xa=R.kv(a.scenes));(d=a.binaries[0].binfile)?b.GG=d:(xa.Cx(b,"load_binaries"),xa.Cx(b,"prepare_bindata"));sa.is_mobile_device||xa.Cx(b,"mobile_media_start");sa.antialiasing&&sa.smaa||xa.Cx(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Mb&&"PRIMARY"==k.type||
"ALL"==k.type)&&wa.uU(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Mb&&"PRIMARY"==k.type||"ALL"==k.type)&&wa.vU(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.tk&&A(a);e(b,c)}else xa.XF(b)},null,function(a){f(b,c,a)})}function w(a,b,c,d,e,f){(d=oa(b.ah)+b.GG)||Da.q("Binary data is missing");la.Wd([{id:d,
type:la.yt,url:d,gh:b.tk}],function(d,f,g,h){d?(wa.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,d=l(d),f=Da.UM(a.b4w_format_version),d[0]!=f[0]&&Da.q("BIN version does not match to JSON version: "+Da.ql(d)+", required: "+Da.ql(sa.Lm)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&wa.warn("BIN version does not match to JSON version: "+ +Da.ql(d)+", required: "+Da.ql(sa.Lm)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):xa.XF(b)},null,function(a){f(b,
c,a)})}function t(a,b,c,d,e){ja.iH()&&e(b,c)}function D(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],g=a.objects,h=a.meshes;a=a.actions;var k=Da.lS();l(d);for(var m=["indices"],n=["position","texcoord","texcoord2","shade_tangs"],p=["normal","tangent"],q=["group"],u=["color"],v=0;v<h.length;v++)for(var t=h[v].submeshes,y=0;y<t.length;y++){for(var B in t[y]){var x=t[y][B][1];if(-1!=m.indexOf(B)){var z=t[y][B][0]*Da.ZE+f["int"]+12,w=t[y],G=B,J=d;if(k)var C=new Uint32Array(J,z,x);else for(var C=new Uint32Array(x),
J=new DataView(J),A=0;A<x;A++)C[A]=J.getUint32(z+A*Da.ZE,!0);w[G]=C}else if(-1!=n.indexOf(B))z=t[y][B][0]*Da.Jj+f["float"]+12,t[y][B]=r(d,z,x,k);else if(-1!=p.indexOf(B)){z=t[y][B][0]*Da.fq+f["short"]+12;w=t[y];G=B;J=d;C=new Float32Array(x);J=new DataView(J);for(A=0;A<x;A++)C[A]=J.getInt16(z+A*Da.fq,!0)/32767;w[G]=C}else if(-1!=q.indexOf(B)){z=t[y][B][0]*Da.fq+f.ushort+12;w=t[y];G=B;J=d;C=new Float32Array(x);J=new DataView(J);for(A=0;A<x;A++)C[A]=J.getUint16(z+A*Da.fq,!0)/65535;w[G]=C}else if(-1!=
u.indexOf(B)){z=t[y][B][0]*Da.xy+f.uchar+12;w=t[y];G=B;J=d;C=new Float32Array(x);J=new DataView(J);for(A=0;A<x;A++)C[A]=J.getUint8(z+A*Da.xy,!0)/255;w[G]=C}}x=t[y];if(h[v].b4w_shape_keys.length)for(z=x.base_length,w=x.normal.length/z/3,x.tbn_quat=Da.Hr(x.normal.subarray(0,3*z),x.tangent.subarray(0,4*z),new Float32Array(x.normal.length/3*4)),G=1;G<w;G++)for(J=G*z,C=0;C<z;C++){var E=x.normal.subarray(3*C,3*(C+1)),A=ra.add(x.normal.subarray(3*(J+C),3*(J+C+1)),E,kb);if(x.tangent.length){var I=x.tangent.subarray(4*
C,4*(C+1)),D=U.add(x.tangent.subarray(4*(J+C),4*(J+C+1)),I,eb),E=Da.wJ(E,I,ab),A=Da.wJ(A,D,qb);Qa.invert(E,ab);A=Qa.multiply(A,E,ab)}else A=Qa.rotationTo(E,A,ab);x.tbn_quat.set(A,4*(J+C))}else x.tbn_quat=Da.Hr(x.normal,x.tangent)}for(B=0;B<g.length;B++)for(h=g[B].particle_systems,m=0;m<h.length;m++)n=h[m],n.transforms=r(d,n.transforms[0]*Da.Jj+f["float"]+12,n.transforms[1],k);for(g=0;g<a.length;g++){B=a[g];h=B.fcurves;m=B.frame_range;p=m[0];q=m[1];u=ua.lV(p,q);m=null;0>u&&(u=0);var t=v=!1,M;for(M in h)v|=
-1<M.indexOf("rotation_euler"),t|=-1<M.indexOf("rotation_quaternion");n=[];for(M in h)if(v&&t&&-1<M.indexOf("rotation_euler"))delete h[M];else{var y=h[M],K;for(K in y)x=y[K],z=r(d,f["float"]+x.bin_data_pos[0]*Da.Jj+12,x.bin_data_pos[1],k),w=new Float32Array(u),null===m&&(m=new Int8Array(u)),ua.hR(x,z,w,m,p,q),x.Cf=w;-1<M.indexOf("rotation_euler")&&(ua.FU(h[M]),n.push(M))}for(p=0;p<n.length;p++)q=n[p],u=q.replace("euler","quaternion"),h[u]=h[q],delete h[q];B.zQ=m}e(b,c)}function l(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function r(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*Da.Jj,!0)}return d}function p(a,b,c,d,e){var g=a.cameras,l=a.groups,m=a.materials,p=a.meshes,q=a.node_groups,r=a.objects,u=a.particles,v=a.scenes,t=a.speakers,y=a.lamps,B=a.textures,x=a.worlds;q||(wa.warn('"node_groups" datablock undefined. reexport main scene.'),q=a.node_groups=[]);
for(var w="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),J={},G=0;G<w.length;G++)for(var C=a[w[G]],E=0;E<C.length;E++){var I=C[E];J[I.uuid]=I}for(var D=0;D<v.length;D++){for(var K=v[D],F=K.objects,H=0;H<F.length;H++)k(F,H,J);K.camera&&k(K,"camera",J);K.world&&k(K,"world",J)}for(D=0;D<l.length;D++)for(var O=l[D].objects,H=0;H<O.length;H++)k(O,H,J);for(D=0;D<r.length;D++){var L=r[D];L.dupli_group&&
k(L,"dupli_group",J);L.parent&&k(L,"parent",J);L.dg_parent&&k(L,"dg_parent",J);if(L.animation_data){var N=L.animation_data;N.action&&k(N,"action",J);if(N.nla_tracks)for(H=0;H<N.nla_tracks.length;H++)for(var T=N.nla_tracks[H],S=0;S<T.strips.length;S++)T.strips[S].action&&k(T.strips[S],"action",J)}switch(L.type){case "MESH":L.data||Da.q("mesh not found for object "+L.name);k(L,"data",J);for(var V=!1,Q=L.modifiers,H=0;H<Q.length;H++){var X=Q[H];"ARMATURE"==X.type?(V&&wa.warn('Object "'+L.name+'" has more than one armature modifiers. Only the first one will be used.'),
V=!0,k(X,"object",J)):"CURVE"==X.type&&k(X,"object",J)}var ba=L.particle_systems;if(ba)for(H=0;H<ba.length;H++)k(ba[H],"settings",J);break;case "ARMATURE":k(L,"data",J);for(var Z=L.pose.bones,W=L.data.bones,H=0;H<Z.length;H++){var U=Z[H];U.bone=W[U.bone];var ha=U.constraints;if(ha)for(S=0;S<ha.length;S++){var ca=ha[S];ca.target&&k(ca,"target",J)}for(var da=U.parent_recursive,S=0;S<da.length;S++)da[S]=Z[da[S]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":k(L,"data",J)}if(ha=L.constraints)for(H=
0;H<ha.length;H++)ca=ha[H],ca.target&&k(ca,"target",J);var ga=L.lod_levels;if(ga)for(H=0;H<ga.length;H++){var ea=ga[H];ea.object&&k(ea,"object",J)}}for(D=0;D<p.length;D++)for(var ta=p[D].materials,H=0;H<ta.length;H++)k(ta,H,J);for(D=0;D<m.length;D++){for(var Y=m[D],ka=Y.texture_slots,H=0;H<ka.length;H++)k(ka[H],"texture",J);var la=Y.node_tree;la&&h(la,J)}for(D=0;D<q.length;D++)(la=q[D].node_tree)&&h(la,J);for(D=0;D<B.length;D++){var pa=B[D],fa=pa.type;"IMAGE"!=fa&&"ENVIRONMENT_MAP"!=fa||k(pa,"image",
J)}for(D=0;D<g.length;D++){var ia=g[D];ia.dof_object&&k(ia,"dof_object",J)}for(D=0;D<t.length;D++){var qb=t[D];qb.sound&&k(qb,"sound",J);if(qb.animation_data&&(N=qb.animation_data,N.action&&k(N,"action",J),N.nla_tracks))for(H=0;H<N.nla_tracks.length;H++)for(T=N.nla_tracks[H],S=0;S<T.strips.length;S++)T.strips[S].action&&k(T.strips[S],"action",J)}for(D=0;D<u.length;D++){for(var za=u[D],ka=za.texture_slots,H=0;H<ka.length;H++)k(ka[H],"texture",J);za.dupli_group&&k(za,"dupli_group",J);za.dupli_object&&
k(za,"dupli_object",J)}for(D=0;D<y.length;D++){var va=y[D];if(va.animation_data&&(N=va.animation_data,N.action&&k(N,"action",J),N.nla_tracks))for(H=0;H<N.nla_tracks.length;H++)for(T=N.nla_tracks[H],S=0;S<T.strips.length;S++)T.strips[S].action&&k(T.strips[S],"action",J)}for(D=0;D<x.length;D++){var ya=x[D];if(ka=ya.texture_slots)for(H=0;H<ka.length;H++)k(ka[H],"texture",J);if(ya.animation_data&&(N=ya.animation_data,N.action&&k(N,"action",J),N.nla_tracks))for(H=0;H<N.nla_tracks.length;H++)for(T=N.nla_tracks[H],
S=0;S<T.strips.length;S++)T.strips[S].action&&k(T.strips[S],"action",J)}Ja.gS(a);A(a);for(var na=oa(b.ah),ja=a.textures,ma=b.Mb?a.scenes[0].b4w_anisotropic_filtering:Xa.b4w_anisotropic_filtering,Aa=0;Aa<ja.length;Aa++)b.Mb||"SCENE"!=ja[Aa].b4w_source_type||(ja[Aa].b4w_source_id=""),Fa.KT(ja[Aa],ma,a.scenes,b.id,na);for(var nb={},xa=a.objects,ra=0;ra<xa.length;ra++){var sa=xa[ra];if("MESH"===sa.type&&!sa.particle_systems.length)for(var Ca=sa.data,Oa=Ca.name,lb=Ca.submeshes,Ua=Ca.materials,Ia=0;Ia<
lb.length;Ia++)0!==lb[Ia].base_length||nb[Oa]||(Ua[Ia]&&wa.warn('material "'+Ua[Ia].name+'" is not assigned to any face (object "'+sa.name+'").'),nb[Oa]=!0)}for(var Ha=a.meshes,wb=0;wb<Ha.length;wb++){var Ka=Ha[wb];Ka.materials.length||Ka.uv_textures.length&&wa.warn('mesh "'+Ka.name+'" has a UV map but has no exported material.')}a.materials.push(Ja.aT());for(var La=a.meshes,Na=Da.Ed("name","DEFAULT",a.materials),Qa=0;Qa<La.length;Qa++){var Ma=La[Qa];0==Ma.materials.length&&Ma.materials.push(Na)}for(var Pa=
a.actions,Ra=b.id,Ta=0;Ta<Pa.length;Ta++){var ab=Pa[Ta];ab.AQ=Ra;ua.JQ(ab)}for(var rb=a.scenes,$a=0;$a<rb.length;$a++){for(var kb=rb[$a],eb=[],pb=[],yb=rb[$a].objects,zb=0;zb<yb.length;zb++){var Wb=yb[zb];P(yb,Wb,null,eb,pb);var Bb=Wb.dupli_group;if(Bb)for(var Wa=Bb.objects,Za=0;Za<Wa.length;Za++)P(Wa,Wa[Za],Wb,eb,pb)}for(zb=0;zb<pb.length;zb++)for(var kc=pb[zb],ic=[kb],Mb=0;Mb<ic.length;Mb++){for(var Ac=ic[Mb].objects,jd=0;jd<Ac.length;jd++){var Uc=Ac[jd].dupli_group;if(Uc){var Bc=Uc.objects,sc=
Bc.indexOf(kc);-1<sc&&Bc.splice(sc,1)}}var sc=Ac.indexOf(kc);-1<sc&&Ac.splice(sc,1)}for(zb=0;zb<eb.length;zb++)Da.cR(eb[zb][0],eb[zb][1])}!b.Mb&&1<a.scenes.length&&(a.scenes=[R.kv(a.scenes)],wa.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Mc=b.Mb?Xa:R.kv(a.scenes);Dc.XY(Xa.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Xa),1),a.scenes.unshift(Xa));for(var Vc=0;Vc<a.scenes.length;Vc++){var jc=a.scenes[Vc];jc.s={};jc.VF=jc==Mc;jc.BQ=b.Mb;Sa.enabled&&
jc.b4w_enable_physics&&(b.Mb||!Ea.gx(Xa)&&jc==R.kv(a))&&Ea.mW(jc)}for(var tc=0;tc<a.scenes.length;tc++){for(var Vb=a.scenes[tc],Nc=n(Vb),kd=0;kd<Nc.length;kd++){var Cc=Nc[kd];qa.hS(Cc,Vb,a)&&(Cc.pd||(Cc.pd=[]),Cc.pd.push(b.Mb?Vb:Xa))}for(var qd=Nc,ld=0;ld<qd.length;ld++){var md=qd[ld];if(md.pd&&"WORLD"!=md.type)for(var wd=md.particle_systems,rd=0;rd<wd.length;rd++){var bd=wd[rd].settings;if("HAIR"==bd.type)if("OBJECT"==bd.render_type){var uc=bd.dupli_object;uc.pd||(uc.pd=md.pd.slice())}else if("GROUP"==
bd.render_type)for(var cd=bd.dupli_group,sd=0;sd<cd.objects.length;sd++)uc=cd.objects[sd],uc.pd||(uc.pd=md.pd.slice())}}}for(var dd=a.scenes,td=[],Gb=0;Gb<dd.length;Gb++)z(dd[Gb].objects,0,b.Mb,td);Ba[b.id]=[];for(Gb=0;Gb<td.length;Gb++)for(var xd=td[Gb],Qc=0;Qc<xd.length;Qc++)for(var Jd=xd[Qc],zd=0;zd<Jd.length;zd++)Ba[b.id].push(Jd[zd]);for(var Ad=a.particles,Gb=0;Gb<Ad.length;Gb++){var ud=Ad[Gb].dupli_object;ud&&(ud.UF=!0,Ba[b.id].push(ud));var Kd=Ad[Gb].dupli_group;if(Kd)for(var Ld=Kd.objects,
Qc=0;Qc<Ld.length;Qc++)ud=Ld[Qc],ud.UF=!0,Ba[b.id].push(ud)}for(var Bd=Ba[b.id],Gb=Bd.length-1;0<=Gb;Gb--)Bd[Gb].pd||Bd.splice(Gb,1);for(var Md=Ba[b.id],tc=0;tc<Md.length;tc++)if(Cc=Md[tc],!b.Mb&&Cc.parent&&-1<Nb.indexOf(Cc.parent.type)&&(Cc.parent=""),"MESH"==Cc.type){var Cd=Ja.fR(Cc);Cd&&(a.meshes.push(Cd),Cc.data=Cd)}for(var Dd=0;Dd<a.scenes.length;Dd++){var Nd=a.scenes[Dd],Ed=Nd.world;Ed.pd||(Ed.pd=[]);Ed.pd.push(b.Mb?Nd:Xa)}for(var Od=a.node_groups,Pd=a.materials,nd=0;nd<Od.length;nd++){var vd=
Od[nd].node_tree;if(vd){var yd=[];f(vd,yd,!0);vd.Fz=yd}}for(nd=0;nd<Pd.length;nd++)if(vd=Pd[nd].node_tree)yd=[],f(vd,yd,!1),vd.Fz=yd;for(var Fd=0;Fd<a.scenes.length;Fd++){var Gd=a.scenes[Fd];if(Gd.b4w_use_logic_editor){var Qd=n(Gd);Ja.mR(Qd,Gd)}}for(var Hd=0;Hd<a.scenes.length;Hd++){var Rd=a.scenes[Hd],Id=b.Mb?Rd:Xa;Boolean(M(b.id,Id,"SPEAKER").length)&&!Id.Qc&&aa.rR(Id)}e(b,c)}function m(a,b){for(var c=oa(b.ah),d=[],e=[],f=0;f<a.speakers.length;f++){var g=a.speakers[f],h=g.sound.uuid;if(-1==e.indexOf(h)){e.push(h);
switch(g.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var k=la.ty;break;case "BACKGROUND_MUSIC":k=la.uy}g=Da.nj(c+g.sound.filepath);la.hn(g);ba(d,h,k,g,b.tk)}}d.length&&la.Wd(d,function(){},function(){})}function f(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],g=e.type;if("GROUP"==g&&e.node_group){if(e=e.node_group.node_tree)if(c)f(e,b,!0);else for(e=e.Fz,g=0;g<e.length;g++){var h=e[g];-1==b.indexOf(h)&&b.push(h)}}else-1!=Wb.indexOf(g)&&-1==b.indexOf(g)&&b.push(g)}}function n(a){var b=
[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);e(a.objects,"ALL",b);return b}function e(a,b,c){for(var d=0;d<a.length;d++){var f=a[d];"ALL"!=b&&b!=f.type||c.push(f);(f=f.dupli_group)&&e(f.objects,b,c)}}function z(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=ga(g);e[h]=e[h]||[];(c||-1==Nb.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&z(g.objects,b+1,c,d)}}function M(a,b,c){var d=[];a=Ba[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==
c||"ALL"==c)for(var g=0;g<f.pd.length;g++)b==f.pd[g]&&d.push(f)}return d}function E(a,b,c,d,e){var f=Ba[b.id],g=a.worlds;d=b.id;for(var h=0;h<f.length;h++){for(var k=f[h],l=ma.dr(k.name,k.type,k.origin_name),m=0;m<k.pd.length;m++)ma.qq(l,k.pd[m]);k.nb=l;qa.kl(k,l);l.k.Ye=d;l.Yr=k.UF||!1}for(d=0;d<g.length;d++){h=g[d];k="%meta_world%"+h.name;k=ma.dr(k,"WORLD",k);for(l=0;l<h.pd.length;l++)ma.qq(k,h.pd[l]);h.nb=k;qa.g0(h,k)}d=qa.pm(b.id);for(h=0;h<f.length;h++)k=f[h],l=k.nb,va.kl(k,l);for(h=0;h<g.length;h++)k=
g[h],va.kl(k,k.nb);if(b.Mb)for(g=b.id,h=0;h<a.scenes.length;h++)for(var k=a.scenes[h],l=0,m=qa.Ub(k,"LAMP",g),n=0;n<m.length;n++)ma.ja(m[n],k).Jm=l++;for(h=0;h<f.length;h++)k=f[h],l=k.nb,l.Yr||(qa.V_(k,l),Ra.D(l));for(a=0;a<f.length;a++)if(g=f[a],h=g.nb,ma.be(h)||ma.so(h))if(k=g.lod_levels.length)for(l=h,h.k.uo=!0,m=0;m<k;m++)if(n=g.lod_levels[m].object){n=n.nb;n.k.uo=!0;n.k.lh=h.k.lh;l.k.jf=g.lod_levels[m].distance;n.k.kh=g.lod_levels[m].distance;if(g.lod_levels[m+1])n.k.jf=g.lod_levels[m+1].distance;
else{n.k.jf=ma.$p;break}l=n}else{l.k.jf=g.lod_levels[m].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.su)){var g=g.k,h=a.k.Ji,k=[],p;for(p in h)l=h[p],k.push(4*l.ZA,4*l.Tj);g.vw.push(k);g.cp.push(a.k)}f=p=-1;a=ua.bJ();for(g=0;g<d.length;g++)h=d[g],k=h.k,ma.be(h)&&k.uk&&(h=k.mh,h>p&&(p=h),a>=h&&h>f&&(f=h));for(g=0;g<d.length;g++)h=d[g],k=h.k,ma.be(h)&&k.uk&&(k.jm=!0,p<a?k.mh=p:k.mh<=a?k.mh=f:(wa.warn('too many bones for "'+h.name+'" / '+k.mh+" bones (max "+a+" with blending, "+
2*a+" without blending). Blending between frames will be disabled."),k.mh=p,k.jm=!1),k.jm=k.jm&&!Pa.tI);for(p=0;p<d.length;p++)if(f=d[p],f.ef)if(a=f.sf,"CHASSIS"==a.lf){f.v={};f.v.Br=a.Br;f.v.Gq=a.Gq;f.v.cE=a.cE;f.v.eE=a.eE;f.v.dE=a.dE;f.v.OE=a.OE;f.v.uD=a.uD;f.v.wC=a.wC;f.v.bo=0;f.v.Fq=1;f.v.jp=0;f.v.speed=0;f.v.Xm=[];f.v.Ds=[];f.v.lp=null;h=(g=ma.Xi(f))?ma.AB(g,d):d;for(g=0;g<h.length;g++)k=h[g],k.ef&&(l=k.sf,Ea.sW(k)&&a.name==l.name?(l=Ea.G0(k.sf.lf),f.v.Xm[l]=k,f.v.Ds[l]=new Float32Array(8)):
Ea.fK(k)&&a.name==l.name?(f.v.lp=k,f.v.kp=l.kp,f.v.dt=l.dt,f.v.Wr=l.Wr,l=fa.invert(f.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),f.v.SM=k,l=new Float32Array([1,0,0]),fa.xd(l,k,l),f.v.RM=l):Ea.eK(k)&&a.name==l.name?(f.v.WD=k,f.v.at=l.at,f.v.Ao=l.Ao,l=fa.invert(f.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),f.v.NM=k,l=new Float32Array([1,0,0]),fa.xd(l,k,l),f.v.MM=l):Ea.gK(k)&&a.name==l.name&&(f.v.gE=k,f.v.lr=l.lr,l=fa.invert(f.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),f.v.dN=k,l=new Float32Array([1,0,0]),
fa.xd(l,k,l),f.v.cN=l));4!=f.v.Xm.length&&Da.q("Not enough wheels for chassis "+f.name)}else if("HULL"==a.lf)for(f.v={},f.v.Xm=[],f.v.Ds=[],f.v.Br=a.Br,f.v.Gq=a.Gq,f.v.hm=a.hm,f.v.un=a.un,f.v.vn=a.vn,f.v.bo=0,f.v.Fq=1,f.v.jp=0,f.v.speed=0,f.v.lp=null,h=(g=ma.Xi(f))?ma.AB(g,d):d,g=0;g<h.length;g++)k=h[g],k.ef&&(l=k.sf,Ea.rW(k)&&a.name==l.name?(f.v.Xm.push(k),f.v.Ds.push(new Float32Array(8))):Ea.fK(k)&&a.name==l.name?(f.v.lp=k,f.v.kp=l.kp,f.v.dt=l.dt,f.v.Wr=l.Wr,l=fa.invert(f.k.n,fa.create()),k=fa.multiply(l,
k.k.n,l),f.v.SM=k,l=new Float32Array([1,0,0]),fa.xd(l,k,l),f.v.RM=l):Ea.eK(k)&&a.name==l.name?(f.v.WD=k,f.v.at=l.at,f.v.Ao=l.Ao,l=fa.invert(f.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),f.v.NM=k,l=new Float32Array([1,0,0]),fa.xd(l,k,l),f.v.MM=l):Ea.gK(k)&&a.name==l.name&&(f.v.gE=k,f.v.lr=l.lr,l=fa.invert(f.k.n,fa.create()),k=fa.multiply(l,k.k.n,l),f.v.dN=k,l=new Float32Array([1,0,0]),fa.xd(l,k,l),f.v.cN=l));for(p=0;p<d.length;p++)if(f=d[p],f.Cm&&(a=f.fo,"MAIN_BODY"==a.lf))for(f.ig={},f.ig.hm=a.hm,f.ig.un=
a.un,f.ig.vn=a.vn,f.ig.Au=[],g=(g=ma.Xi(f))?ma.AB(g,d):d,h=0;h<g.length;h++)k=g[h],k.Cm&&(l=k.fo,Ea.wW(k)&&a.name==l.name&&(f.ig.Au.push(k),k.MG=k.fo.bN));e(b,c)}function F(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.Lj=f.camera.nb}for(d=0;d<a.scenes.length;d++){var f=b.Mb?a.scenes[d]:Xa,g=b.Mb?qa.Ub(f,"LAMP",b.id):qa.Ub(f,"LAMP",0),h=qa.Ub(f,"ALL",b.id),k=M(b.id,f,"MESH"),l=M(b.id,f,"EMPTY");M(b.id,f,"WORLD");b.Mb&&R.QQ(f,h,g,k,l);for(var h=!1,m=0;m<l.length;m++)for(var n=l[m].nb,
p=n.I,q=0;q<p.length;q++){var r=p[q].yb,u=R.BN(r,n);f.name==r.name&&(h=h||u)}b.Mb&&f.s.Lc&&!h&&wa.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');l=[];R.kx(f);da.hV(f,k,g,l);m=M(b.id,f,"LINE");da.gV(f,m);n=R.DB(f);if(b.Mb){h=f.s.Dx;m=f.world;if(h.xL||h.procedural_skydome)p=m.nb,da.VQ(f,h,p),da.EA(p,n,f);R.zI(f,n);(h=f.s.Ip)&&h.nt&&da.NQ(f,m.nb)}for(m=0;m<k.length;m++)da.EA(k[m].nb,n,f);for(m=0;m<l.length;m++)da.EA(l[m],n,f),qa.HX(l[m]);h=qa.Ub(f,"ALL",b.id);R.nR(f,h,
g);for(m=0;m<h.length;m++)n=h[m],n.k.Oe&&qa.J_(n),ma.oS(n)&&(n.JK=!0)}R.RQ(Xa,a.textures,b.id);b.Mb&&Xa.s.Fp.length&&(b.RB=!0);e(b,c)}function A(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c],e=Boolean("FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==sa.Zq);d.Kh=e;d.kq=e?"dds":""}if((Ka.YA||Ka.Yw)&&sa.JN)for(a=0;a<b.length;a++){for(var d=b[a],f=d.texture_slots,c=0;c<f.length;c++){var e=f[c],g=e.texture;if("IMAGE"==g.type||"ENVIRONMENT_MAP"==g.type){var h=g.image;h&&
!h.Kh&&(e=!g.b4w_disable_compression&&!e.use_map_normal&&"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&"MOVIE"!=h.source,O(h,e))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){f=d[c];e=!1;if("TEXTURE"==f.type){if((g=f.texture)&&(h=g.image)&&!h.Kh&&(e=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{e=f.outputs;for(f=0;f<e.length;f++)if(g=e[f],g.is_linked&&"Normal"==g.identifier){e=!0;break a}e=!1}e=!e}}else"TEX_IMAGE"==f.type?(h=f.image)&&!h.Kh&&(e="MOVIE"!=
h.source):"TEX_ENVIRONMENT"==f.type&&(e=!1);h&&!h.Kh&&O(h,e)}}}function O(a,b){-1<a.filepath.indexOf(".dds")?(a.Kh=!0,a.kq="dds"):(a.Kh=b)?(a.kq=sa.Zq,a.filepath="dds"==sa.Zq?a.filepath+".dds":la.hn(a.filepath)[0]+".pvr"):a.kq=""}function H(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},k={},l={},m=0;m<d.length;m++){var n=d[m];g[n.uuid]=n;k[n.uuid]=n}for(m=0;m<f.length;m++)n=f[m],h[n.uuid]=n,l[n.uuid]=n;a=a.scenes;for(m=0;m<a.length;m++)I(a[m].objects,null,l,k,null);for(var p in k)p in g||d.push(k[p]);
for(p in l)p in h||f.push(l[p]);e(b,c)}function I(a,b,c,d,e){for(var f=[],g=0;g<a.length;g++){var h=a[g],k=c[h.uuid];if(h=k.proxy){b&&-1==f.indexOf(h.uuid)&&f.push(h.uuid);for(var l=c[h.uuid],m=l.constraints,h=0;h<m.length;h++){var n=Da.Ph(m[h]);n.name+="_CLONE";k.constraints.push(n)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(l.animation_data=Da.Ph(k.animation_data)),l.b4w_use_default_animation=k.b4w_use_default_animation,l.b4w_auto_skel_anim=k.b4w_auto_skel_anim,
l.b4w_anim_behavior=k.b4w_anim_behavior,l.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=0;g<f.length;g++)k=Da.FV(a,f[g]),-1<k&&a.splice(k,1);f={};if(b)for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],m=Da.Ph(k),l="origin_name"in k?k.origin_name:k.name,m.name=ma.yI(b.name,l),m.origin_name=l,m.dg_parent={uuid:b.uuid},C(m),c[m.uuid]=m,f[h.uuid]=m.uuid,h.uuid=m.uuid,e&&e[k.uuid]&&(m.b4w_cluster_data=e[k.uuid]);for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],k.dupli_group&&(h=k.dupli_group,e=d[h.uuid],m=Da.Ph(e),
m.name=Da.gt(e.name+"_CLONE"),m.uuid=ia.NJ("Group"+m.name),d[m.uuid]=m,h.uuid=m.uuid,I(m.objects,k,c,d,k.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){h=a[g];k=c[h.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(wa.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);m=k.constraints;for(h=0;h<m.length;h++)b=m[h],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(d=b.bones,h=0;h<d.length;h++)if(e=
d[h].constraints)for(m=0;m<e.length;m++)b=e[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=k.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(h=0;h<k.length;h++)b=k[h],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var p in f)Ia[p]=f[p]}function C(a){a.uuid=ia.NJ("Object"+a.name)}function h(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&
k(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in Ia&&(e.lamp.uuid=Ia[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&k(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||k(e,"image",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];J(f,"from_node",c);J(f,"to_node",c);y(f,"from_socket",f.from_node.outputs);y(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&k(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=
c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&k(e.strips[f],"action",b)}function k(a,b,c){(c=c[a[b].uuid])||wa.error("Dangling link found:",b,a);a[b]=c}function J(a,b,c){c=Da.Ed("name",a[b].name,c);a[b]=c}function y(a,b,c){c=Da.Ed("identifier",a[b].identifier,c);a[b]=c}function d(a,b,d,e,f,g){var h=[],k={};e=a.images;for(var l=Fa.aJ(),m=oa(b.ah),n=0;n<e.length;n++){var p=e[n],q=p.uuid;if(q){var r=Da.nj(m+p.filepath),u=p.source;if("FILE"===u){var u=p.Kh?la.yt:la.zt,v=la.hn(r),t=v[1].toLowerCase();
if(!la.nS(t)){wa.error("image ",p," has unsupported format.");continue}Ka.AC&&sa.use_min50&&("dds"==v[1]?(r=la.hn(v[0]),r=r[0]+".min50."+r[1]+".dds"):r=v[0]+".min50."+v[1])}else if("MOVIE"===u)if(sa.Qs)v=la.hn(r),r=v[0]+".altconv.seq",u=la.At;else{v=la.hn(r);t=v[1].toLowerCase();u=aa.aU(t);if(""==u){wa.error("failed to load video file (unsupported format)",r);continue}r=u!=t?v[0]+".altconv."+u:v[0]+"."+v[1];u=la.Bt}else{wa.error('Image "'+p.name+'" has unsupported format "'+u+'".');continue}if(!b.tk)for((q in
k)||(k[q]=[]),v=0;v<l.length;v++)t=l[v],t.po==q&&t.wm==p.kq&&k[q].push(t);k[q].length&&h.push({id:q,type:u,url:r,gh:b.tk})}}if(h.length){var y=0;la.Wd(h,function(e,f,l,m){if(e){var n=l;if(!b.tk){f=k[f];for(n=0;n<f.length;n++){var p=f[n];if(l==la.At)p.Os=e.dh,Fa.it(p,e.images,b.id);else if(Fa.it(p,e,b.id),"ENVIRONMENT_MAP"==p.source)for(p=0;p<a.scenes.length;p++)R.BE(a.scenes[p])}n=f[0].wm}l==la.Bt||l==la.At?(l==la.Bt?(l=e.videoWidth,e=e.videoHeight):(l=e.images[0].width,e=e.images[0].height),wa.log("%cLOAD VIDEO "+
l+"x"+e,"color: #"+(2048<l||2048<e?"a00":1024<l||1024<e?"aa0":"0a0"),m),-1==m.indexOf($a)&&wa.warn("video",m,"is not from app root.")):c(e,m,!0,n)}m=++y/h.length;g(b,d,m)},function(){wa.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})}else f(b,d)}function B(a,b,c,d,e){a=R.GB();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var g=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(g=!1);va.$_(f,g,b.id)}}e(b,c)}function u(a,b,c,d,e,f){a=oa(b.ah);var g=[],h={};d=qa.pm(b.id);for(var k=0;k<d.length;k++){var l=
d[k];if(ma.as(l)&&aa.KM(l)!=aa.TE){var m=l.Y.Ej;"BACKGROUND_MUSIC"==aa.IB(l)?(m=Da.uB(),b.PB=!0):"NONE"!=aa.IB(l)&&sa.WB&&(b.VB=!0);if(!(m in h)){h[m]=[];var n=Da.nj(a+l.Y.ah);switch(aa.KM(l)){case aa.sy:var p=la.ty;break;case aa.SE:p=la.uy}ba(g,m,p,n,b.tk)}h[m].push(l)}}if(g.length){var q=0;la.Wd(g,function(a,d,e,k){if(a)for(wa.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf($a)&&wa.warn("sound",k,"is not from app root."),d=h[d],e=0;e<d.length;e++)aa.e0(d[e],a);a=++q/g.length;f(b,c,a)},function(){wa.log("%cLOADED ALL SOUNDS",
"color: #0aa");e(b,c)})}else e(b,c)}function ba(a,b,c,d,e){var f=la.hn(d),g=f[1].toLowerCase(),h=aa.ZT(g);""!=h?(d=h!=g?f[0]+".altconv."+h:f[0]+"."+f[1],a.push({id:b,type:c,url:d,gh:e})):wa.error("failed to load audio file (unsupported format)",d)}function K(a,b,c){a=qa.Ub(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];ma.as(d)&&(aa.qW(d)||c)&&aa.cL(d)}}function G(a,b){for(var c=a.s.Fp,d=0;d<c.length;d++){var e=c[d].s;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.vt||(Fa.BL(e),
Fa.eL(e))}}function T(a,b,c,d,e){va.start();wa.log("%cSTART NLA","color: #0a0");e(b,c)}function P(a,b,c,d,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,g=0;g<f;g++){var h=b.lod_levels[g],k=h.object;if(k){var l=Da.Rq(k);l.name=b.name+"_LOD_"+String(g+1);l.b4w_cluster_data=b.b4w_cluster_data;C(l);l.lod_levels=[];c&&(l.dg_parent=c);d.push([a,l]);e.push(k);h.object=l}}}function X(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!Ea.tS(a.scenes[f])){d=!1;break}d&&(e(b,c),wa.log("%cPHYSICS READY",
"color: #0a0"))}function x(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.Mb)var g=Ea.gx(f);else g=Ea.gx(Xa)||Ea.gx(f),f=Xa;if(Sa.enabled&&g)for(g=0;g<kc.length;g++)for(var h=qa.Ub(f,kc[g],b.id),k=0;k<h.length;k++){var l=h[k];l.k.Ye==b.id&&(Ea.Jn(l,f),b.tK&&Ea.oa(l)&&Ea.eB(l))}}e(b,c)}function ka(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var l=h[k];if(l.s.Lc){var m=l.s.Lc.Yk;if(m&&"FILE"===m.source){var l=m.uuid,n=Da.nj(oa(b.ah)+m.filepath);e.push({id:l,
type:m.Kh?la.yt:la.zt,url:n});g[l]=m}}}e.length?la.Wd(e,function(a,d,e,f){if(a){c(a,f,!0);e=[];f=Fa.aJ();for(var k=0;k<f.length;k++){var l=f[k];l.uri===d&&e.push(l)}for(d=0;d<e.length;d++)Fa.it(e[d],a,b.id);for(d=0;d<h.length;d++)if(e=h[d],e.s.Lc&&(f=e.s.Lc.Yk,f===m)){var l=a,n=document.createElement("canvas");f=m.size[0];k=m.size[1];n.width=f;n.height=k;n=n.getContext("2d");n.drawImage(l,0,0);l=n.getImageData(0,0,f,k).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=k;
for(var k=new Float32Array(f),p=0;p<f;p++)k[p]=n[1]*l[4*p+2]+n[2]*l[4*p+3];e.s.RD=k}}else for(a=g[d],d=0;d<h.length;d++)e=h[d],f=e.s.Lc.Yk,f===a&&(e.s.Lc.Yk=null,wa.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,d)}):f(b,d)}function ca(a,b,d,e,f){e=a.scenes[0];a=[];for(var g=[Bb.cu,Bb.gq,Bb.du,Bb.zz],h=0;h<g.length;h++){var k=R.La(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=la.zt;e.push({id:"SEARCH_TEXTURE",type:h,ah:ya.Ie.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",
type:h,url:ya.Ie.smaa_area_texture_path});for(h=0;h<a.length;h++)if(g=a[h],g.type==Bb.gq){a=g.Ya;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var l=g.jb;else if("u_area_tex"==g.to)var m=g.jb;break}e.length?la.Wd(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?l:m,d.source="IMAGE",Fa.it(d,a,b.id),Fa.CD(d,Fa.L,Fa.L))},function(){f(b,d)}):f(b,d)}else f(b,d)}function Q(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.Mb||(e=Xa);for(var f=qa.Ub(e,"LAMP",b.id),g=0;g<f.length;g++){var h=
f[g];h.k.Ye==b.id&&d.Iz.push({yb:e,obj:h})}f=qa.Ub(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&h.k.Ye==b.id&&(b.tK&&ma.be(h)&&R.Lq(h,!0),d.Iz.push({yb:e,obj:h}))}}function W(a,b,c,d,e,f){var g=d.Iz;e=d.PK;if(g.length){a=g[e].obj;var h=g[e].yb;e=ma.ja(a,h);R.Jn(h,a,!1);!a.anchor||h.s.Tv||h.s.anaglyph_use||za.append(a);d=++d.PK/g.length;g=e.Pi;if(-1!=a.k.Td&&g){var k=ra.copy(a.k.kb.F,kb);R.AN(g,k)}g=a.Js;if(g.length&&h.s.ki)for(h=fa.G(a.k.n),a=fa.R(a.k.n),e=e.hi,k=0;k<e.length;k++)R.DN(e[k],
h,a),ma.EN(g,e[k].p.rc)}else d=1;f(b,c,d)}function ha(a,b,c,d,e){if(b.Mb){d=R.Yh();R.BE(d);var f=R.GB();for(a=0;a<f.length;a++){var g=f[a];R.BE(g);R.dY(g,d)}R.kx(d)}else R.FN(Xa);d=qa.pm(b.id);qa.W_(d);for(f=0;f<d.length;f++)for(g=d[f],a=0;a<g.I.length;a++)for(var h=g.I[a].X,k=0;k<h.length;k++)null==h[k].zb&&h.splice(k--,1);e(b,c)}function v(a,b,c,d,e){if(b.Mb)for(a=R.GB(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&na.iW(f,b.id)}e(b,c)}function Z(a,b,c,d,e){if(b.Mb)for(d=0;d<a.scenes.length;d++)G(a.scenes[d],
b.id),K(a.scenes[d],b.id,!1);else G(Xa,b.id),K(Xa,b.id,!1);e(b,c)}function Y(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;sa.media_auto_activation&&(b.RB||b.PB||b.VB)?lb||V(a,e,b,c):e(b,c)}function V(a,b,c,d){var e=rb.parentElement;wb=e.style.zIndex;e.style.zIndex="999";lb=document.createElement("div");lb.style.position="relative";lb.style.height="88px";lb.style.width="88px";var f=Math.round(rb.offsetWidth/2-44);lb.style.top=Math.round(rb.offsetHeight/2-44).toString()+"px";lb.style.left=
f.toString()+"px";lb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
lb.style.backgroundSize="88px";nb=document.createElement("div");nb.style.position="relative";nb.style.height=rb.offsetHeight.toString()+"px";nb.style.width=rb.offsetWidth.toString()+"px";nb.style.background="rgba(0, 0, 0, 0.5)";nb.style.zIndex="999";e.appendChild(nb);nb.appendChild(lb);lb.addEventListener("click",function(){c.RB&&(Fa.play(),Fa.pause(),Fa.reset());if(c.PB){if(c.Mb)for(var e=0;e<a.scenes.length;e++)K(a.scenes[e],c.id,!0);else K(Xa,c.id,!0);aa.pause()}c.VB&&aa.dL();ta();b(c,d)},!1)}
function ta(){if(lb){var a=rb.parentElement;a.style.zIndex=wb;nb.removeChild(lb);a.removeChild(nb);lb=nb=null;wb=0}}function oa(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function S(a){ua.yc(a)&&ua.remove(a);Oa.mY(a);qa.Hu(a);pa.Pl(a)&&pa.he(a);Ea.oa(a)&&Ea.Ks(a);R.nY(a);ma.as(a)&&aa.MZ(a);za.pW(a)&&za.remove(a)}function ga(a){var b=ua.MI(a);return(a=b&&b.parent==a?null:a.parent||b)?1+ga(a):0}var za=g("__anchors"),ua=g("__animation"),la=g("__assets"),da=g("__batch"),ya=g("__config"),
pa=g("__controls"),N=g("__texcomp"),ea=g("__debug"),L=g("__extensions"),Aa=g("__input"),xa=g("__loader"),ia=g("__md5"),va=g("__nla"),na=g("__logic_nodes"),Oa=g("__particles"),Ca=g("__nodemat"),qa=g("__objects"),ma=g("__obj_util"),Ea=g("__physics"),wa=g("__print"),Qa=g("__quat"),Ja=g("__reformer"),Ma=g("__renderer"),R=g("__scenes"),aa=g("__sfx"),ja=g("__shaders"),Bb=g("__subscene"),Fa=g("__textures"),Dc=g("__time"),Ra=g("__transform"),fa=g("__tsr"),Da=g("__util"),ra=g("__vec3"),U=g("__vec4"),Pa=ya.Fl,
sa=ya.B,Ka=ya.Rd,Sa=ya.C,pb=ya.Y,Ta=null,Ba=null,$a="",Xa=null,Ia={},kb=new Float32Array(3),eb=new Float32Array(4),ab=new Float32Array(4),qb=new Float32Array(4),lb=null,nb=null,wb=0,Ua=!1,Nb=["LAMP","CAMERA"],kc=["MESH","CAMERA","EMPTY"],Wb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],rb=null;a.ih=function(a){return xa.ih(a)};a.update=function(){xa.a0(Ta)};a.vZ=function(a){rb=a};a.T_=function(a,b){if(lb){nb.style.height=b.toString()+"px";nb.style.width=a.toString()+"px";var c=Math.round(a/2-44);lb.style.top=
Math.round(b/2-44).toString()+"px";lb.style.left=c.toString()+"px"}};a.load=function(a,c,e,f,g){var h={load_main:{Nb:xa.Fg,Qb:!1,M:[],Wb:!1,Yb:500,mc:!1,bc:b},duplicate_objects:{Nb:xa.xe,Qb:!1,M:["load_main"],Wb:!1,Yb:50,mc:!1,bc:H},load_binaries:{Nb:xa.Fg,Qb:!1,M:["load_main"],Wb:!1,Yb:500,mc:!1,bc:w},wait_for_shaders:{Nb:xa.xe,Qb:!1,M:[],Wb:!1,Yb:50,mc:!0,Vj:t},prepare_bindata:{Nb:xa.xe,Qb:!1,M:["duplicate_objects","load_binaries"],Wb:!1,Yb:100,mc:!1,bc:D},prepare_bpy_data:{Nb:xa.xe,Qb:!1,M:["duplicate_objects",
"prepare_bindata"],Wb:!1,Yb:100,mc:!1,bc:p},process_objects:{Nb:xa.xe,Qb:!1,M:["prepare_bpy_data"],Wb:!1,Yb:150,mc:!1,bc:E},process_scenes:{Nb:xa.xe,Qb:!1,M:["process_objects","wait_for_shaders"],Wb:!1,Yb:300,mc:!1,bc:F},load_smaa_textures:{Nb:xa.Fg,Qb:!1,M:["process_scenes"],Wb:!1,Yb:30,mc:!0,bc:ca},load_shoremap:{Nb:xa.Fg,Qb:!1,M:["process_scenes"],Wb:!1,Yb:30,mc:!0,bc:ka},load_images:{Nb:xa.Fg,Qb:!0,M:["process_scenes"],Wb:!0,Yb:500,mc:!1,bc:d},update_scenes_nla:{Nb:xa.xe,Qb:!1,M:["process_scenes",
"load_images"],Wb:!1,Yb:50,mc:!1,bc:B},wait_physics_workers:{Nb:xa.xe,Qb:!1,M:["load_shoremap"],Wb:!1,Yb:20,mc:!1,Vj:X},add_physics_objects:{Nb:xa.xe,Qb:!1,M:["wait_physics_workers"],Wb:!1,Yb:50,mc:!1,bc:x},add_objects:{Nb:xa.xe,Qb:!1,M:["add_physics_objects"],Wb:!1,Yb:600,mc:!1,bc:Q,Vj:W,Iq:ha,Jq:{Iz:[],PK:0}},init_logic_nodes:{Nb:xa.xe,Qb:!1,M:["update_scenes_nla","add_objects"],Wb:!1,Yb:50,mc:!1,bc:v},load_speakers:{Nb:xa.Fg,Qb:!0,M:["add_objects"],Wb:!0,Yb:100,mc:!1,bc:u},mobile_media_start:{Nb:xa.xe,
Qb:!1,M:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Wb:!0,Yb:5,mc:!1,bc:Y,Vj:Y},synchronize_media:{Nb:xa.xe,Qb:!0,M:["mobile_media_start"],Wb:!0,Yb:50,mc:!1,bc:Z},start_nla:{Nb:xa.xe,Qb:!0,M:["mobile_media_start"],Wb:!1,Yb:5,mc:!0,bc:T}},k=xa.HB();k||(k=xa.GH(),Ta={},Ba={},Ia={});Ta[k.yh.length]={};return xa.LH(h,a,c,e,q,f||pb.uG,sa.do_not_load_resources,g,!1)};a.Xx=function(a){var b=xa.HB();if(!b||!b.yh.length||a&&!xa.m_(b.yh[a]))wa.error("Unable to unload data!");else{if(0==
a)wa.log("%cUNLOAD ALL","color: #00a"),za.ua(),ua.ua(),aa.ua(),da.ua(),R.ua(),xa.ua(),pa.ua(),Ea.ua(),qa.ua(),Da.ua(),Ma.ua(),Ca.ua(),ja.ua(),L.ua(),la.ua(),Fa.ua(),na.ua(),Oa.ua(),Aa.ua(),ea.ua(),Ba=null,Ia={},Ta=Xa=null,Ua=!1;else{wa.log("%cUNLOAD DATA "+a,"color: #00a");ua.kY(a);for(var b=qa.pm(qa.oc),c=0;c<b.length;c++){var d=b[c];ma.FB(d)!=a&&qa.Iw(d,!1,!1,!1)}b=qa.pm(a);for(c=b.length-1;0<=c;c--)d=b[c],S(d),qa.Ks(d);b=qa.pm(qa.oc);for(c=0;c<b.length;c++)qa.Iw(b[c],!0,!0,!0)}va.ua(a);ta()}};
a.cY=S;a.SL=function(a){$a=a};a.aG=function(){Ua||sa.media_auto_activation||(Fa.play(),Fa.pause(),Fa.reset(),K(Xa,qa.oc,!0),aa.pause(),sa.WB&&aa.dL(),Ua=!0)};a.reset=function(){rb=null};a.fL=function(a,c,e){var f={load_main:{Nb:xa.Fg,Qb:!1,M:[],Wb:!1,Yb:500,mc:!1,bc:b},load_binaries:{Nb:xa.Fg,Qb:!1,M:["load_main"],Wb:!1,Yb:500,mc:!1,bc:w},load_images:{Nb:xa.Fg,Qb:!1,M:["load_main"],Wb:!1,Yb:500,mc:!1,bc:d},preload_sounds:{Nb:xa.Fg,Qb:!1,M:["load_main"],Wb:!1,Yb:500,mc:!1,bc:m}},g=xa.HB();g||(g=xa.GH(),
Ta={},Ba={},Ia={});Ta[g.yh.length]={};return xa.LH(f,a,c,e,q,!1,sa.do_not_load_resources,!1,!0)};a.yN=function(){la.CS()}};b4w.module.__loader=function(a,g){function q(b,e,g,l){var h=A,k=M.create(),m;for(m in e){var n=c(e[m]);(l&&n.Wb||!b&&n.mc)&&f(n);M.J(k,n)}for(m in e)for(n=e[m],n.name=m,b=0;b<n.M.length;b++)M.r(k,e[n.M[b]],n,null);e=c({name:"out",Nb:a.rO,bc:function(a,b,c,d,e){b.Mb&&(h.YD=!0);z(b)||(b.status=2);b.uK(b.id,!0);e(b,c);E.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Yb:5});if(g)g=M.Lr(k);else{m=M.clone(k);do{g=M.Lr(m);n=[];for(b=0;b<g.length;b++){l=g[b];var d=M.Va(m,l);d.Qb&&n.push(l)}for(b=
0;b<n.length;b++)M.Ag(m,n[b]);n.length&&M.oA(m)}while(n.length)}M.J(k,e);for(b=0;b<g.length;b++)l=g[b],d=M.Va(k,l),e.M.push(d.name),M.r(k,d,e,null);return k}function c(a){a.Qb=a.Qb||!1;a.Nb||0===a.Nb||(a.Nb=a.xe);a.M=a.M||[];a.Bm=a.Bm||!1;a.UD=a.UD||!1;a.Yb=a.Yb||0;a.Wb=a.Wb||!1;a.mc=a.mc||!1;a.status=0;a.P7=0;a.pC=0;a.Jq=a.Jq||null;return a}function b(a,b){for(var c=[],e=[],f=0;f<b.length;f++){var g=b[f];M.Va(a.ri,g).Bm&&(M.fl(a.ri,g,function(e){var f=!0;M.ui(a.ri,e,function(a,b){if(!b.Bm)return f=
!1,1});f&&-1==c.indexOf(e)&&-1==b.indexOf(e)&&c.push(e)}),e.push(f))}for(f=e.length-1;0<=f;f--)b.splice(e[f],1);return c}function w(a){function c(b,e){var d=M.Va(a.ri,b),f=M.Va(a.ri,e),g=f.Nb-d.Nb;0==g&&(g=d.Qb-f.Qb);return g}var e=[],f=a.xj,g=!1;do{var k=b(a,f);e.push.apply(e,f);0<k.length&&(g=!0);f=k}while(0<k.length);g&&e.sort(c);a.xj=e;return a.xj.length}function t(a,b,c){if(b.UD)return b.Bm=!0,l(a,b),!1;if(!b.bc&&!b.Vj&&!b.Iq)return l(a,b),!1;if(0==b.status&&(b.status++,b.bc))return b.bc(c,a,
b,b.Jq,l,r),!0;if(1==b.status){if(b.Vj)return b.Vj(c,a,b,b.Jq,l,r),!0;b.status++}return 2==b.status&&(b.status++,b.Iq)?(b.Iq(c,a,b,b.Jq,l,r),!0):!1}function D(a){if(0==a.Kx)return 100;var b=0;M.pa(a.ri,function(c,e){a.do_not_load_resources&&e.Wb||(b+=e.pC*e.Yb)});return F.trunc(100*b/a.Kx)}function l(a,b){b.Bm=!0;b.status=3;p(a,b,1)}function r(a,b,c){1>c?p(a,b,c):b.status++}function p(a,b,c){var e=A;if(b.bc||b.Vj||b.Iq)if(b.pC=c,b=D(a),a.TH!=b||1==c)a.XD(b,performance.now()-a.oN),a.TH=b,e.rC=!0}function m(a,
b){var c=null;M.pa(a.ri,function(a,e){if(e.name==b)return c=e,1});return c}function f(a){a.UD=!0;a.pC=1}function n(a){a.XD=null;a.vA=null;a.ri=null;a.xj=null}function e(){return 0==A.mu}function z(a){return a&&(3==a.status||4==a.status)}var M=g("__graph"),E=g("__print"),F=g("__util");a.xe=0;a.Fg=1;a.rO=2;var A=null;a.HB=function(){return A};a.GH=function(){var a={yh:[],WA:0,mu:0,YD:!1,rC:!1};return A=a};a.LH=function(a,b,c,e,f,g,l,m,d){var n=A,p=n.yh.length,r={id:p,Mb:0==p,status:0,ah:b,GG:"",uK:c||
function(){},tK:m||!1,N$:g,oN:0,TH:0,Kx:0,rD:!1,XD:e||function(){},vA:f||function(){},ri:null,xj:null,RB:!1,PB:!1,VB:!1,tk:d};a=q(r.Mb,a,g,l);r.ri=a;b=[];c=M.MV(a);for(e=0;e<c.length;e++)b.push(c[e]);r.xj=b;M.pa(a,function(a,b){!(b.bc||b.Vj||b.Iq)||r.do_not_load_resources&&b.Wb||(r.Kx+=b.Yb)});n.yh.push(r);n.mu++;return r.id};a.a0=function(b){var c=A;if(c&&!e())if(c.rC)c.rC=!1;else{var f=performance.now();do{var g=c.yh[c.WA],h=b[g.id];if(!z(g))if(0==g.status&&(g.status=1,g.oN=performance.now(),g.XD(0,
0)),w(g)){var k=g,l=k.xj.length;do{var m=M.Va(k.ri,k.xj[0]),d=t(k,m,h);m.Nb==a.Fg&&(k.rD=!0);m=k.xj.shift();k.xj.push(m);l--}while(!d&&0!=l)}else k=c,l=g,l.vA(h,l),l.status=3,k.mu--,n(l);c.YD&&(c.WA=(c.WA+1)%c.yh.length);if(g.rD){g.rD=!1;break}}while(16>performance.now()-f)}};a.XF=function(a){var b=A;a.vA(null,a);a.status=3;b.mu--;n(a);a.status=4;a.Mb&&(b.YD=!0);a.uK(a.id,!1)};a.X9=r;a.Cx=function(a,b){var c=m(a,b);null!==c&&f(c)};a.Bm=e;a.m_=z;a.ih=function(a){var b=A;if(!b)return!1;a|=0;return b.yh[a]&&
(3==b.yh[a].status||2==b.yh[a].status)};a.UV=function(){E.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ua=function(){A=null}};b4w.module.__md5=function(a){function g(a,g){var r=a[0],p=a[1],m=a[2],f=a[3],r=c(r,p,m,f,g[0],7,-680876936),f=c(f,r,p,m,g[1],12,-389564586),m=c(m,f,r,p,g[2],17,606105819),p=c(p,m,f,r,g[3],22,-1044525330),r=c(r,p,m,f,g[4],7,-176418897),f=c(f,r,p,m,g[5],12,1200080426),m=c(m,f,r,p,g[6],17,-1473231341),p=c(p,m,f,r,g[7],22,-45705983),r=c(r,p,m,f,g[8],7,1770035416),f=c(f,r,p,m,g[9],12,-1958414417),m=c(m,f,r,p,g[10],17,-42063),p=c(p,m,f,r,g[11],22,-1990404162),r=c(r,p,m,f,g[12],7,1804603682),f=c(f,r,p,m,
g[13],12,-40341101),m=c(m,f,r,p,g[14],17,-1502002290),p=c(p,m,f,r,g[15],22,1236535329),r=b(r,p,m,f,g[1],5,-165796510),f=b(f,r,p,m,g[6],9,-1069501632),m=b(m,f,r,p,g[11],14,643717713),p=b(p,m,f,r,g[0],20,-373897302),r=b(r,p,m,f,g[5],5,-701558691),f=b(f,r,p,m,g[10],9,38016083),m=b(m,f,r,p,g[15],14,-660478335),p=b(p,m,f,r,g[4],20,-405537848),r=b(r,p,m,f,g[9],5,568446438),f=b(f,r,p,m,g[14],9,-1019803690),m=b(m,f,r,p,g[3],14,-187363961),p=b(p,m,f,r,g[8],20,1163531501),r=b(r,p,m,f,g[13],5,-1444681467),f=
b(f,r,p,m,g[2],9,-51403784),m=b(m,f,r,p,g[7],14,1735328473),p=b(p,m,f,r,g[12],20,-1926607734),r=q(p^m^f,r,p,g[5],4,-378558),f=q(r^p^m,f,r,g[8],11,-2022574463),m=q(f^r^p,m,f,g[11],16,1839030562),p=q(m^f^r,p,m,g[14],23,-35309556),r=q(p^m^f,r,p,g[1],4,-1530992060),f=q(r^p^m,f,r,g[4],11,1272893353),m=q(f^r^p,m,f,g[7],16,-155497632),p=q(m^f^r,p,m,g[10],23,-1094730640),r=q(p^m^f,r,p,g[13],4,681279174),f=q(r^p^m,f,r,g[0],11,-358537222),m=q(f^r^p,m,f,g[3],16,-722521979),p=q(m^f^r,p,m,g[6],23,76029189),r=
q(p^m^f,r,p,g[9],4,-640364487),f=q(r^p^m,f,r,g[12],11,-421815835),m=q(f^r^p,m,f,g[15],16,530742520),p=q(m^f^r,p,m,g[2],23,-995338651),r=w(r,p,m,f,g[0],6,-198630844),f=w(f,r,p,m,g[7],10,1126891415),m=w(m,f,r,p,g[14],15,-1416354905),p=w(p,m,f,r,g[5],21,-57434055),r=w(r,p,m,f,g[12],6,1700485571),f=w(f,r,p,m,g[3],10,-1894986606),m=w(m,f,r,p,g[10],15,-1051523),p=w(p,m,f,r,g[1],21,-2054922799),r=w(r,p,m,f,g[8],6,1873313359),f=w(f,r,p,m,g[15],10,-30611744),m=w(m,f,r,p,g[6],15,-1560198380),p=w(p,m,f,r,g[13],
21,1309151649),r=w(r,p,m,f,g[4],6,-145523070),f=w(f,r,p,m,g[11],10,-1120210379),m=w(m,f,r,p,g[2],15,718787259),p=w(p,m,f,r,g[9],21,-343485551);a[0]=r+a[0]&4294967295;a[1]=p+a[1]&4294967295;a[2]=m+a[2]&4294967295;a[3]=f+a[3]&4294967295}function q(a,b,c,g,m,f){b=(b+a&4294967295)+(g+f&4294967295)&4294967295;return(b<<m|b>>>32-m)+c&4294967295}function c(a,b,c,g,m,f,n){return q(b&c|~b&g,a,b,m,f,n)}function b(a,b,c,g,m,f,n){return q(b&g|c&~g,a,b,m,f,n)}function w(a,b,c,g,m,f,n){return q(c^(b|~g),a,b,m,
f,n)}var t="0123456789abcdef".split("");a.NJ=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var p;for(p=64;p<=b.length;p+=64){for(var m=b.substring(p-64,p),f=[],n=void 0,n=0;64>n;n+=4)f[n>>2]=m.charCodeAt(n)+(m.charCodeAt(n+1)<<8)+(m.charCodeAt(n+2)<<16)+(m.charCodeAt(n+3)<<24);g(a,f)}b=b.substring(p-64);m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(p=0;p<b.length;p++)m[p>>2]|=b.charCodeAt(p)<<(p%4<<3);m[p>>2]|=128<<(p%4<<3);if(55<p)for(g(a,m),p=0;16>p;p++)m[p]=0;m[14]=8*
c;g(a,m);for(b=0;b<a.length;b++){c=a[b];p="";for(m=0;4>m;m++)p+=t[c>>8*m+4&15]+t[c>>8*m&15];a[b]=p}return a.join("")}};b4w.module.scenes=function(a,g){function q(){var a=w.Xh();return l.Lo(a.clientWidth/2,a.clientHeight/2)}var c=g("__batch"),b=g("__camera"),w=g("__container"),t=g("__data"),D=g("__graph"),l=g("__objects"),r=g("__obj_util"),p=g("__print"),m=g("__scenes"),f=g("__subscene"),n=g("__util");a.oc=l.oc;a.kx=function(a){var b=m.Ir();m.kx(n.Ed("name",a,b))};a.A=function(){return m.Da()?m.A().name:""};a.u6=function(){for(var a=m.Ir(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.ke=function(){if(m.Da())return m.qm(m.A());
p.error("No active scene");return!1};a.JV=function(a){var b=l.xc(l.Oy,a,0,!0);if(b)return b;p.error("get object "+a+": not found")};a.Kf=function(a,b){var c=l.xc(l.Ny,a,b,0);if(c)return c;p.error("get object "+b+": not found")};a.c6=function(a,b){var c=l.xc(l.Nc,a,b|0);if(c)return c;p.error("get object "+a+": not found")};a.Ev=function(a,b){var c=l.Ev(a,b|0);if(c)return c;p.error("get object "+a+": not found")};a.FB=function(a){return r.FB(a)};a.Lo=function(a,b){var c=m.Yh();return c?(c=m.La(c,f.Di))&&
c.enable_hmd_stereo?(p.P("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),q()):l.Lo(a,b):(p.error("No active scene"),null)};a.q8=q;a.SC=function(a){return a&&a.k&&a.k.Uc};a.Wo=function(a,b){a&&a.k&&a.k.Uc?l.Wo(a,b):p.error("set_outline_intensity(): wrong object")};a.k6=function(a){if(a&&a.k&&a.k.Uc)return a.k.qh;p.error("get_outline_intensity(): wrong object")};a.Kn=function(a,b,c,f){a&&a.k&&a.k.Uc?l.Kn(a,b,c,f):p.error("apply_outline_anim(): wrong object")};
a.X2=function(a){if(a&&a.k&&a.k.Uc){var b=a.k.gi;l.Kn(a,b.Fk,b.Gk,b.Hk)}else p.error("apply_outline_anim_def(): wrong object")};a.Hu=function(a){a&&a.k&&a.k.Uc?l.Hu(a):p.error("clear_outline_anim(): wrong object")};a.fM=m.fM;a.j6=function(a){var b=m.A();if(b=m.La(b,f.Cn))return a=a||new Float32Array(3),a.set(b.oj),a};a.ox=function(a){m.Da()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),m.ox(a)):p.error("No active scene")};a.v6=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A(),b=m.La(a,f.bd);if(!b)return null;var c=a.s.wd,g=m.La(a,f.Pb),l=m.La(a,f.Bf),n={};n.csm_resolution=c.csm_resolution;n.self_shadow_polygon_offset=b.self_shadow_polygon_offset;
l&&(n.self_shadow_normal_offset=l.self_shadow_normal_offset);n.enable_csm=c.enable_csm;n.csm_num=c.csm_num;n.csm_first_cascade_border=c.csm_first_cascade_border;n.first_cascade_blur_radius=c.first_cascade_blur_radius;n.csm_last_cascade_border=c.csm_last_cascade_border;n.last_cascade_blur_radius=c.last_cascade_blur_radius;n.fade_last_cascade=c.fade_last_cascade;n.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(n.csm_borders=m.pV(a,g.p),n.blur_radii=new Float32Array(c.csm_num),n.blur_radii.set(g.p.Ko.subarray(0,
c.csm_num))):(n.csm_borders=null,n.blur_radii=null);return n};a.D9=function(a){if(m.Da()){var g=m.A();"number"==typeof a.self_shadow_polygon_offset&&D.pa(g.s.Wa,function(b,c){c.type==f.bd&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var l=m.La(g,f.Bf);l&&("number"==typeof a.self_shadow_normal_offset&&(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius));var n=m.La(g,f.Oc);n&&("number"==typeof a.self_shadow_normal_offset&&
(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius),n.Ba=!0);n=g.s.wd;"number"==typeof a.csm_first_cascade_border&&(n.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(n.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(n.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(n.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(l){for(var q=l.Qa,t=0;t<q.length;t++)for(var w=q[t].sa,H=0;H<w.length;H++){var I=w[H];if(I.kf.ie){var C=I.za;c.rG(C,n);c.Xc(C);f.Rc(l,I)}}l.Ba=!0}l=r.ja(g.Lj,g).da;for(t=0;t<l.length;t++)b.zE(l[t],n);m.zD(g)}else p.error("No active scene")};a.UI=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.UI(a)};a.mx=function(a,b,c){if(m.Da()){var g=m.A(),l=m.La(g,f.Pb);m.mx(g,a||0==a?parseFloat(a):l.$g,b||0==b?b:l.ne,c||0==c?c:l.we)}else p.error("No active scene")};
a.XI=function(a){if(!m.Da())return p.error("No active scene"),!1;var b=m.A();return m.XI(b,a)};a.ED=function(a){if(m.Da()){var b=m.A();m.ED(b,a)}else p.error("No active scene")};a.I5=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A(),b={};b.Ar=m.xV(a);b.fog_depth=m.vV(a);b.fog_start=m.yV(a);b.fog_height=m.wV(a);return b};a.d9=function(a){if(m.Da()){var b=m.A();"number"==typeof a.Ar&&m.XL(b,a.Ar);"number"==typeof a.fog_depth&&m.VL(b,a.fog_depth);"number"==typeof a.fog_start&&m.YL(b,
a.fog_start);"number"==typeof a.fog_height&&m.WL(b,a.fog_height)}else p.error("No active scene")};a.uJ=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.uJ(a)};a.lM=function(a){if(m.Da()){var b=m.A();m.lM(b,a)}else p.error("No active scene")};a.q5=function(){if(!m.Da())return p.error("No active scene"),null;var a=m.A(),a=m.La(a,f.By);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.W8=
function(a){if(m.Da()){var b=m.A();if(b=m.La(b,f.By))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Ba=!0}else p.error("No active scene")};a.sJ=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.sJ(a)};a.jM=function(a){if(m.Da()){var b=m.A();m.jM(b,a)}else p.error("No active scene")};a.SI=function(){if(!m.Da())return p.error("No active scene"),
!1;var a=m.A();return m.La(a,f.Op)?m.SI(a):null};a.TL=function(a){if(m.Da()){var b=m.A();m.TL(b,a)}else p.error("No active scene")};a.$I=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.La(a,f.Kj)?m.$I(a):null};a.$L=function(a){if(m.Da()){var b=m.A();m.$L(b,a)}else p.error("No active scene")};a.LI=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.La(a,f.Jp)?m.LI(a):null};a.LL=function(a){if(m.Da()){var b=m.A();m.LL(b,a)}else p.error("No active scene")};
a.ZI=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.La(a,f.Qp)?m.ZI(a):null};a.ZL=function(a){if(m.Da()){var b=m.A();m.ZL(b,a)}else p.error("No active scene")};a.GJ=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.GJ(a)};a.rM=function(a){if(m.Da()){var b=m.A();l.rM(b,a)}else p.error("No active scene")};a.DJ=function(a,b){if(!m.Da())return p.error("No active scene"),0;var c=m.A();return c.s.Lc?m.DJ(c,a,b):(p.error("No water parameters on the active scene"),
0)};a.qM=function(a){if(m.Da()){var b=m.A();m.qM(b,a)}else p.error("No active scene")};a.CJ=function(a){if(m.Da()){var b=m.A();m.CJ(b,a)}else p.error("No active scene")};a.F$=function(){if(m.Da()){var a=m.A();m.FN(a)}else p.error("No active scene")};a.k7=function(a,b){b=b||!1;!r.be(a)&&!r.so(a)||r.Ra(a)?b?m.Lq(a,!0):m.ZG(a,!0):p.error("show/hide is only supported for dynamic objects.")};a.N9=function(a,b){b=b||!1;!r.be(a)&&!r.so(a)||r.Ra(a)?b?m.Lq(a,!1):m.ZG(a,!1):p.error("show/hide is only supported for dynamic objects.")};
a.dC=function(a){if(r.uW(a)||r.so(a)||r.hh(a))return m.dC(a);p.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.Hm=function(a){return a.k.Hm};a.A3=function(a){p.Sb("scenes.check_object","scenes.check_object_by_name");return m.Da()?l.IX(a,m.A()):(p.error("No active scene"),!1)};a.D3=function(a,b){return l.xc(l.Oy,a,b|0,!0)?!0:!1};a.B3=function(a,b,c){return l.xc(l.Ny,a,b,c|0)?!0:!1};a.C3=function(a,b){return l.xc(l.Nc,a,b|0)?!0:!1};a.pm=function(a,b){var c=m.A();
a||(a="ALL");b||0===b||(b=l.oc);return l.pJ(c,a,b)};a.f6=function(a){return a?a.Qm:(p.error("Wrong object name"),"")};a.g6=function(a){if(!a)return p.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Qm),a=r.Xi(a);return b.reverse()};a.h6=function(a){return a&&a.type?a.type:(p.error("Wrong object"),"UNDEFINED")};a.e6=function(a){p.Sb("scenes.get_object_dg_parent","objects.get_dg_parent");return r.Xi(a)};a.d6=function(a){return a.Xe.slice(0)};a.sm=function(){return l.sm(m.A())};a.rJ=function(a,
b){b||0===b||(b=1);if(!m.Da())return p.error("No active scene"),!1;var c=m.A();return m.rJ(c,a,b)};a.NI=function(){return m.NI()};a.F6=function(a){return r.be(a)?a.k.type:null};a.xv=function(){if(!m.Da())return p.error("No active scene"),!1;var a=m.A();return m.xv(a)};a.Jn=function(a,b){if(a.k.cw){if(b)var c=m.Ir(),c=n.Ed("name",b,c);else c=m.A();m.Jn(c,a,!0)}else p.error('object "'+a.name+'" has been created not by coping.')};a.Ks=function(a){(r.be(a)||r.so(a))&&r.Ra(a)?(l.Iw(a,a.k.dw,!1,!1),t.cY(a),
l.Iw(a,!0,!0,!0),l.Ks(a)):p.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.xK=function(a){var b=m.A();if(b.timeline_markers&&a in b.timeline_markers)return m.xK(b,a);p.error('"'+a+'" marker not found.');return 0};a.Z5=function(){var a=m.A();return(a=m.La(a,f.Gh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.o9=function(a){var b=m.A();(b=m.La(b,f.Gh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),
"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):p.error("The motion blur subscene doesn't exist.")};a.n3=function(){var a=m.A();return Boolean(m.La(a,f.xf))}};b4w.module.container=function(a,g){var q=g("__container"),c=g("__print");a.Xh=q.Xh;a.OI=q.OI;a.Fe=q.Fe;a.aw=function(a,g){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&g&&q.aw(a,g)};a.ML=q.ML;a.zN=q.zN;a.Nq=q.Nq;a.sB=q.sB;a.resize=function(a,g,t){a&&g||c.warn("Wrong canvas container dimensions: "+a+"x"+g+". Zero dimensions aren't allowed. Resized to: "+q.Fy+"x"+q.Ey+".");q.resize(a,g,t)};a.Pk=function(a){q.Pk(a||!1)}};b4w.module.lights=function(a,g){function q(a){for(var c=l.A(),e=w.Ub(c,"LAMP",w.oc),g=0;g<e.length;g++){var q=e[g];if("SUN"==q.tb.type){var t=q;break}}if(!t)D.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=m.Cb(180-a.hor_position);a=m.Cb(90-a.vert_position);g=t.k;r.sx(t,[a,0,e]);e=new Float32Array(3);m.ec(p.R(g.n),m.nc,e);g=f.length(p.G(g.n));f.copy(e,n);f.scale(n,g,n);r.Vc(t,n);r.D(t);e=t.tb;if(e.fI){var z=c.world.light_settings.environment_energy,
g=c.world.horizon_color,q=c.world.zenith_color,C=Math.cos(Math.abs(a));a=Math.max(Math.min(3*C,1),0)*e.YH;z*=Math.max(C,.1);b.Ss(e,a);l.mx(c,z,g,q)}l.yp(t,c)}}function c(a){if(t.hh(a))return a.tb.type;D.error("get_light_type(): Wrong object");return!1}var b=g("__lights"),w=g("__objects"),t=g("__obj_util"),D=g("__print"),l=g("__scenes"),r=g("__transform"),p=g("__tsr"),m=g("__util"),f=g("__vec3"),n=new Float32Array(3),e,z=60;a.Q5=function(a){var b=l.A(),b=w.Ub(b,"LAMP",w.oc);if(!a)return b;for(var c=
[],e=0;e<b.length;e++){var f=b[e];f.tb.type===a&&c.push(f)}return c};a.A6=function(){for(var a=l.A(),a=w.Ub(a,"LAMP",w.oc),b=null,c=0;c<a.length;c++){var e=a[c];if("SUN"==e.tb.type){b=e;break}}return b?(b=b.tb.direction,a=m.re(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=m.re(Math.atan2(b[2],Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.E9=q;a.OY=function(){for(var a=l.A(),a=w.Ub(a,"LAMP",w.oc),b=0;b<a.length;b++){var c=a[b];if("SUN"==c.tb.type){var e=c;break}}e?
(e={hor_position:135},e.vert_position=-Math.cos(.75*Math.PI)*z,q(e)):D.error("There is no sun on the scene")};a.a9=function(a){(e=a.getDate())?1582==e&&10==a.S7&&4<a.ST&&15>a.ST&&D.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):D.error("There is no year 0 in the Julian system!")};a.n9=function(a){z=Math.min(Math.max(a,0),90)};a.U5=function(a){if(t.hh(a))var b=a.tb;else return D.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var e=
{light_type:a,light_color:new Float32Array(3),light_energy:b.Gf,light_spot_blend:b.bt,light_spot_size:b.jn,light_distance:b.distance};e.light_color.set(b.color);break;case "POINT":e={light_type:a,light_color:new Float32Array(3),light_energy:b.Gf,light_distance:b.distance};e.light_color.set(b.color);break;default:e={light_type:a,light_color:new Float32Array(3),light_energy:b.Gf},e.light_color.set(b.color)}return e?e:null};a.V5=c;a.i9=function(a,c){if(t.hh(a)){var e=a.tb,f=l.A(),g=!1;"number"==typeof c.light_energy&&
b.Ss(e,c.light_energy);"object"==typeof c.light_color&&b.qx(e,c.light_color);"number"==typeof c.light_spot_blend&&(b.bZ(e,c.light_spot_blend),g=!0);"number"==typeof c.light_spot_size&&(b.cZ(e,c.light_spot_size),g=!0);"number"==typeof c.light_distance&&(b.aZ(e,c.light_distance),g=!0);l.yp(a,f);g&&l.A_(f)}else D.error("set_light_params(): Wrong object")};a.T5=function(a){return t.hh(a)?a.tb.Gf:(D.error("get_light_energy(): Wrong object"),0)};a.Ss=function(a,c){if(t.hh(a)){var e=l.A();b.Ss(a.tb,c);l.yp(a,
e)}else D.error("set_light_energy(): Wrong object")};a.S5=function(a,b){if(!t.hh(a))return D.error("get_light_color(): Wrong object"),null;b=b||new Float32Array(3);b.set(a.tb.color);return b};a.qx=function(a,c){if(t.hh(a)){var e=l.A();b.qx(a.tb,c);l.yp(a,e)}else D.error("set_light_color(): Wrong object")}};b4w.module.fps=function(a,g){function q(a,b,c){var d=O.ke();E.gk(d,b,c);a&&(b=E.kk(d,ca),A.tj(a,b[0],b[1]))}function c(a,b,c,d){if(.01<Math.abs(K[0])||.01<Math.abs(K[1]))c=F.rd(a,b,0),b=H.Zb(K[0],0,c,.2*G),c=H.Zb(K[1],0,c,.2*G),K[0]-=b,K[1]-=c,d(a,-b*T,-c*T)}function b(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function w(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function t(a,b){if(w(a)&&!I.$e()){var d=F.JA(a),e=x?x:F.KA(a);x=e;F.K(b,"FPS_PLOCK",F.na,[d,e],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=F.ae(a,b,0),q(a,-b.coords[0]*T,-b.coords[1]*T))});F.K(null,"FPS_ACTIVATE_PLOCK",F.Hg,[e],function(a){return a[0]},function(b,c,d){0<d?ka.iB&&ka.iB(a):ka.dB&&ka.dB(a)})}else{if(I.$e())var d=
F.fr("XY",a),e=F.Su(a),f=4;else{var d=F.Wl("XY",a),e=F.Tn(a),f=2,g=O.ke(),k=F.eg(),l=F.Oi(h.Tp),m=F.Oi(h.Up);F.K(b,"FPS_CAM_ROT",F.na,[k,l,m],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=F.rd(a,b,0);c=F.rd(a,b,1);var e=F.rd(a,b,2);b=2.5*d;e=.05>Math.abs(e)?0:e;d=E.rm(g,ca);e=d[1]-e*b;c=-(.05>Math.abs(c)?0:c)*b;e=H.V(e,u,ba);E.gk(g,c,e,!1,!0);A.tj(a,d[0]+c+Math.PI,0)}})}var n=0,p=0;F.K(null,"FPS_DRAG_PRESS",F.Od,[e],function(a){return a[0]},function(a,b,c){1==
c&&(a=F.ae(a,b,0).coords,n=a[0],p=a[1])});F.K(null,"FPS_DRAG_MOVE",F.na,[d,e],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=F.ae(a,b,0).coords,K[0]+=(a[0]-n)*f,K[1]+=(a[1]-p)*f,n=a[0],p=a[1])});d=F.eg();F.K(b,"FPS_SMOOTH_DRAG",F.na,[d],null,c,q)}}function D(a){d.mU(d.sO);a.addEventListener("mousedown",function(){h.wY()},!1)}function l(a){var b=F.eg(),c=O.ke();F.K(a,"FPS_CHARECTER_VR_ROT",F.na,[b],null,function(a){var b=E.kk(c,ca)[0];A.tj(a,b,0)})}function r(){var a=d.iS()&&!I.$e(),b=h.fa(h.yd);
b&&(a=a&&h.um(b,h.ul)==h.Xp);return a}function p(a,c,d){function f(a){a=0<a?1:a;n=-(0>a?-1:a);a=p+q;var b=m+n;A.Uk(c,a,b);d&&d(a,b);k(a,b)}function g(a){a=0<a?1:a;q=-(0>a?-1:a);a=p+q;var b=m+n;A.Uk(c,a,b);d&&d(a,b);k(a,b)}function k(a,b){var c=l.Un.id;a||b?0==c&&e(l,1):e(l,0)}I.$e()&&b(a.parentElement?a.parentElement:a);var l=z(c),m=0,n=0,p=0,q=0;a=[F.Wt,h.Jt];var r=[F.Vt,h.Kt];I.$e()&&(a.push("B4W_DEFAULT_BTN_1"),r.push("B4W_DEFAULT_BTN_2"));M(1,a,function(a){p=a;a=p+q;var b=m+n;A.Uk(c,a,b);d&&d(a,
b);k(a,b)});M(1,r,g);M(1,[F.Ut,h.Vp],f);M(1,[F.Tt,h.Lt],function(a){m=a;a=p+q;var b=m+n;A.Uk(c,a,b);d&&d(a,b);k(a,b)});M(1,[F.hF,h.It],function(a){0<a&&A.Gu(c)});M(3,[h.Rp],f);M(3,[h.Sp],g);M(1,[F.gF,h.Wp],function(a){p+q+m+n?0<a?e(l,2):e(l,1):e(l,0)});M(1,[F.bF],function(a){0<a&&(a=X.Un.id,1==a||0==a?e(l,3):e(l,1))})}function m(a,b,c,d){a.N.push({id:b,Kz:c,TG:d,SG:null,hA:null})}function f(a){for(var b=[],c=0;c<a.N;c++){var d=a.N[c].id;if(0<=b.indexOf(d))return;b.push(d)}for(c=0;c<a.N;c++)for(var d=
a.N[c],e=0;e<d.Kz.length;e++)if(0>b.indexOf(d.Kz[e]))return}function n(a,b){for(var c=null,d=0;d<a.N.length;d++)if(a.N[d].id==b){c=a.N[d];break}return c}function e(a,b){if(!a.$W){var c=a.Un,d=c.id;if(0<=c.Kz.indexOf(b)){var e=!0;c.SG&&(e=c.SG(d,b));e&&(a.Un=n(a,b),c.TG&&c.TG(d,b),c.hA&&c.hA(d,b))}}}function z(a){function b(c,d){switch(d){case 0:case 1:A.mi(a,A.zy);break;case 2:A.mi(a,A.UE);break;case 3:A.mi(a,A.yy);break;case 4:A.mi(a,A.oO)}}var c=X={N:[],Un:null,$W:!1};m(c,0,[1,3,4],b);m(c,1,[2,
3,4,0],b);m(c,2,[1,3,4,0],b);m(c,3,[1],b);m(c,4,[1,2,0],b);f(c);c.Un=n(c,0);return X}function M(a,b,c){function d(){}function e(){return!1}for(var f=[],g=h.cH(),k=0;k<b.length;k++)if("number"==typeof b[k])if(300>b[k])f.push(F.Gb(b[k]));else if(326>b[k])for(var l=0;l<g.length;l++)f.push(F.cr(b[k],g[l]));else f.push(F.Oi(b[k]));else"string"==typeof b[k]&&((l=document.getElementById(b[k]))?f.push(F.Su(l)):B.error("Couldn't find element with "+b[k]+" ID."));b=F.Od;switch(a){case 1:b=F.Hg;e=function(a){for(var b=
0;b<a.length;b++)if(a[b])return!0;return!1};d=function(a,b,d){0<d?c(1):c(0)};break;case 2:b=F.Hg;e=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};d=function(a,b,d){0>d?c(1):c(0)};break;case 3:b=F.na,e=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},d=function(a,b,d,e){if(0<d)for(d=0;d<e;d++){var f=F.rd(a,b,d);if(.05<Math.abs(f)){c(f);break}}else c(0)}}F.K(null,"FPS_USER_CONTROL_ACTION_"+P.toString(),b,f,e,d,f.length);P++}var E=g("camera"),F=g("controls"),
A=g("physics"),O=g("scenes"),H=g("util"),I=g("main"),C=g("container"),h=g("input"),k=g("transform"),J=g("constraints"),y=g("vec3"),d=g("hmd"),B=g("__print"),u=(-Math.PI+.1)/2,ba=(Math.PI-.1)/2,K=new Float32Array(2),G=1,T=4E-4,P=0,X=null,x=null,ka={iB:null,dB:null},ca=new Float32Array(2),Q=new Float32Array(3),W=new Float32Array(3);new Float32Array(3);a.e1=0;a.f1=1;a.d1=2;a.c1=3;a.b1=4;a.J0=1;a.K0=2;a.I0=3;a.k3=M;a.A4=function(a,b,c){a=a||O.sm();b=b||C.Xh();if(a){c=c||null;var d=a,e=O.ke(),f=k.sd(e,
Q),g=k.sd(d,W);y.subtract(f,g,f);J.jG(e,d,f);e=E.kk(e,ca);A.tj(d,e[0],e[1]);d=b;e=a;r()?(D(d),l(e)):t(d,e);p(b,a,c)}};a.m4=function(a,b){a=a||O.sm();b=b||C.Fe();if(a){for(var c=0;c<P;c++)F.he(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;w(b)&&!I.$e()&&(F.he(c,"FPS_PLOCK"),F.he(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!w(b)||I.$e())F.he(c,"FPS_CAM_ROT"),F.he(c,"FPS_DRAG_PRESS"),F.he(c,"FPS_DRAG_MOVE"),F.he(c,"FPS_SMOOTH_DRAG");c=a;r()&&F.he(c,"FPS_CHARECTER_VR_ROT");c=b;if(I.$e()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),
e=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);e&&c.removeChild(e)}}};a.V8=function(a,b){n(X,a).hA=b};a.S8=function(a){F.rx(a);G=a};a.Q8=function(a){T=a/2E5};a.v9=function(a){ka.iB=a};a.u9=function(a){ka.dB=a};a.p5=function(){return X.Un.id}};b4w.module.camera=function(a,g){function q(a,b){p.Sb("camera.set_pivot","camera.target_set_trans_pivot");c.Aa(a)?(z.copy(b,a.k.pivot),f.D(a),r.H(a)):p.error("set_pivot(): Wrong object or camera move style")}var c=g("__camera");g("__config");var b=g("__constraints"),w=g("__container"),t=g("__mat4"),D=g("__math"),l=g("__obj_util"),r=g("__physics"),p=g("__print"),m=g("__scenes"),f=g("__transform"),n=g("__tsr"),e=g("__util"),z=g("__vec3"),M=g("__vec4"),E=g("__quat"),F=new Float32Array(2),A=new Float32Array(3),
O=new Float32Array(3);new Float32Array(4);var H=E.create();new Float32Array(9);var I={},C={};a.Jg=c.Jg;a.Kb=c.Kb;a.md=c.md;a.ad=c.ad;a.XZ=function(a){l.xa(a)?(c.xt(a),a.k.ub=c.Jg,f.D(a),r.H(a),c.ro(a)):p.error("static_setup(): Wrong camera object")};a.a$=function(a,b,e){c.Fm(a)?(b=b||n.G(a.k.n),e?c.GD(a,b,e):f.Vc(a,b),f.D(a),r.H(a)):p.error("static_set_look_at(): Wrong camera object or camera move style")};a.b$=function(a,b){c.Fm(a)?(f.ni(a,b),f.D(a),r.H(a)):p.error("static_set_rotation(): Wrong camera object or camera move style")};
a.Z9=function(a,b){if(!c.Fm(a))return p.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return f.Lf(a,b)};a.DU=function(a){l.xa(a)?(c.xt(a),a.k.ub=c.md,f.D(a),r.H(a),c.ro(a)):p.error("eye_setup(): Wrong camera object")};a.P4=function(a,e,g){c.kc(a)?(e=e||n.G(a.k.n),g?c.eZ(a,e,g):f.Vc(a,e),b.$j(a,a.k.tf,!0),f.D(a),r.H(a)):p.error("eye_set_look_at(): Wrong camera object or camera move style")};a.gk=function(a,b,e,g,d){c.kc(a)?(c.Ls(a,b,e,g||!1,
d||!1),f.D(a),r.H(a)):p.error("eye_rotate(): Wrong camera object or camera move style")};a.CU=function(a,b){c.kc(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.pM(a,b),f.D(a),r.H(a)):p.error("eye_set_vertical_limits(): Incorrect limits object."):p.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.O4=function(a,b,e){if(!c.kc(a))return p.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.ka?(b=b||{},e?(b.down=a.ka.$n,
b.up=a.ka.xp):(b.down=a.ka.down,b.up=a.ka.up),b.camera_space=e||!1,b):null};a.BU=function(a,b){c.kc(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.cM(a,b),f.D(a),r.H(a)):p.error("eye_set_horizontal_limits(): Incorrect limits object."):p.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.N4=function(a,b,e){if(!c.kc(a))return p.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.lb?(b=b||{},e?(b.left=a.lb.yo,
b.right=a.lb.Uo):(b.left=a.lb.left,b.right=a.lb.right),b.camera_space=e||!1,b):null};a.k_=function(a){if(l.xa(a))if(!(void 0).horiz_rot_lim||"number"==typeof(void 0).horiz_rot_lim.left&&"number"==typeof(void 0).horiz_rot_lim.right)if(!(void 0).vert_rot_lim||"number"==typeof(void 0).vert_rot_lim.down&&"number"==typeof(void 0).vert_rot_lim.up){if((void 0).dist_lim){if("number"!=typeof(void 0).dist_lim.min||"number"!=typeof(void 0).dist_lim.max||(void 0).dist_lim.min>(void 0).dist_lim.max){p.error("target_setup(): Wrong distance limits object");
return}(void 0).dist_lim.min=Math.max((void 0).dist_lim.min,0);(void 0).dist_lim.max=Math.max((void 0).dist_lim.max,0)}(void 0).zs&&("number"!=typeof(void 0).zs.min_y||"number"!=typeof(void 0).zs.max_y||(void 0).zs.min_y>(void 0).zs.max_y)?p.error("target_setup(): Wrong pivot limits object"):(c.xt(a),a.k.ub=c.Kb,c.uM(a,(void 0).pos||n.G(a.k.n),(void 0).pivot,(void 0).horiz_rot_lim,(void 0).vert_rot_lim,(void 0).dist_lim,(void 0).zs,(void 0).use_panning||!1),f.D(a),r.H(a),c.ro(a))}else p.error("target_setup(): Wrong vertical limits object");
else p.error("target_setup(): Wrong horizontal limits object");else p.error("target_setup(): Wrong camera object")};a.ft=function(a,b,e){var g,d;c.Aa(a)?(c.fx(a,b,e,g||!1,d||!1),f.D(a),r.H(a)):p.error("target_rotate(): Wrong camera object or camera move style")};a.k$=function(a,b,e){c.Aa(a)?(b=b||n.G(a.k.n),e=e||a.k.pivot,c.Ts(a,b,e),f.D(a),r.H(a)):p.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.j$=function(a,b){c.Aa(a)?(c.mZ(a,b),f.D(a),r.H(a)):p.error("target_set_pivot_translation(): Wrong camera object or camera move style")};
a.h_=function(a,b){if(c.Aa(a)){var e=f.Ho(a,a.k.pivot),g=Math.max(0,b);f.nh(a,0,0,g-e);f.D(a);r.H(a)}else p.error("target_set_distance(): Wrong camera object or camera move style")};a.hE=function(a){return c.Aa(a)?f.Ho(a,a.k.pivot):(p.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.m$=function(a,b){if(c.Aa(a)){var e=f.yv(b,!1,A),g=f.zv(b),d=m.A(),d=l.ja(a,d).da[0],d=c.FI(d)/2,g=g/Math.sin(d),d=f.Ho(a,e);c.Ts(a,n.G(a.k.n),e);f.D(a);f.nh(a,0,0,g-d);f.D(a);r.H(a)}else p.error("target_zoom_object(): Wrong camera object or camera move style")};
a.f_=function(a,b){if(!c.Aa(a))return p.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);z.copy(a.k.pivot,b);return b};a.gN=function(a,b){if(c.Aa(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){p.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}c.TY(a,b);f.D(a);r.H(a)}else p.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.e$=
function(a,b){if(!c.Aa(a))return p.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var e=a.k;return e.sb?(b=b||{},b.min=e.sb.min,b.max=e.sb.max,b):null};a.j_=function(a,b){c.Aa(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.pM(a,b),f.D(a),r.H(a)):p.error("target_set_vertical_limits(): Wrong limits object"):p.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.h$=function(a,b,e){if(!c.Aa(a))return p.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.ka?(b=b||{},e?(b.down=a.ka.$n,b.up=a.ka.xp):(b.down=a.ka.down,b.up=a.ka.up),b.camera_space=e||!1,b):null};a.i_=function(a,b){c.Aa(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.cM(a,b),f.D(a),r.H(a)):p.error("target_set_horizontal_limits(): Wrong limits object"):p.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.f$=function(a,b,e){if(!c.Aa(a))return p.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.lb?(b=b||{},e?(b.left=a.lb.yo,b.right=a.lb.Uo):(b.left=a.lb.left,b.right=a.lb.right),b.camera_space=e||!1,b):null};a.i$=function(a,b){c.Aa(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?p.error("target_set_pivot_limits(): Wrong limits object"):(c.iZ(a,b),f.D(a),r.H(a)):p.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.g$=function(a,b){if(!c.Aa(a))return p.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var e=a.k;return e.fe?(b=b||{},b.min_z=e.fe.min_z,b.max_z=e.fe.max_z,b):null};a.g_=function(a,b,e){if(c.Aa(a)){var g=a.k;g.use_panning&&(A[0]=b,A[1]=-e,A[2]=0,n.xd(A,g.n,A),z.add(g.pivot,A,g.pivot),b=n.G(g.n),z.add(b,A,b),f.D(a),r.H(a))}else p.error("target_pan_pivot(): wrong object")};a.l$=function(a,b){if(!c.Aa(a))return p.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.q7=function(b,g){a.SJ(b,{pos:g.pos,pivot:g.pivot});var l="undefined"==
typeof g.dist_interval?0:Math.max(g.dist_interval,0),m="undefined"==typeof g.angle_interval?0:Math.max(g.angle_interval,0),d="undefined"==typeof g.t?.5:e.V(g.t,0,1),n=a.PJ(b,I);n.min=Math.max(n.min-d*l,0);n.max+=(1-d)*l;l=a.QJ(b,C);l.down=e.V(l.down+d*m,-Math.PI/2,0);l.up=e.V(l.up-(1-d)*m,-Math.PI/2,0);c.Uv(b,n);c.Vv(b,l);f.D(b);r.H(b);c.ro(b)};a.SJ=function(a,b){if(l.xa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){p.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up)?p.error("hover_setup(): Wrong hover angle limits object"):b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max)?p.error("hover_setup(): Wrong horizontal translation limits object"):
b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max)?p.error("hover_setup(): Wrong vertical translation limits object"):(c.xt(a),a.k.ub=c.ad,c.tM(a,b.pos||n.G(a.k.n),b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1),f.D(a),r.H(a),c.ro(a))}else p.error("hover_setup(): Wrong camera object")};a.RJ=function(a,b,e){var g,d;c.Za(a)?(c.Ms(a,b,e,g||!1,d||!1),f.D(a),r.H(a)):
p.error("hover_rotate(): Wrong camera object or camera move style")};a.p7=function(a,b){c.Za(a)?(c.px(a,b),f.D(a),r.H(a)):p.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.n7=function(a,b){if(!c.Za(a))return p.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);z.copy(a.k.Vb,b);return b};a.cW=function(a){return c.Za(a)?f.Ho(a,a.k.Vb):(p.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.Vv=
function(a,b){c.Za(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?p.error("hover_set_vertical_limits(): Wrong limits object"):(c.Vv(a,b),f.D(a),r.H(a)):p.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.QJ=function(a,b){if(!c.Za(a))return p.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var e=a.k;b=b||{};b.down=e.ka.down;b.up=e.ka.up;return b};a.Uv=function(a,b){c.Za(a)?"number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max?p.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),c.Uv(a,b),f.D(a),r.H(a)):p.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.PJ=function(a,b){if(!c.Za(a))return p.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var e=a.k;b=b||{};b.min=e.sb.min;b.max=e.sb.max;return b};a.eW=function(a,b){c.Za(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?
p.error("hover_set_vert_trans_limits(): Wrong limits object"):(c.rZ(a,b),f.D(a),r.H(a)):p.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.o7=function(a,b){if(!c.Za(a))return p.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var e=a.k;return e.Dc?(b=b||{},b.min=e.Dc.min,b.max=e.Dc.max,b):null};a.dW=function(a,b){c.Za(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?p.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(c.ZY(a,b),f.D(a),r.H(a)):p.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.m7=function(a,b){if(!c.Za(a))return p.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var e=a.k;return e.Cc?(b=b||{},b.min=e.Cc.min,b.max=e.Cc.max,b):null};a.r7=function(a,b){if(!c.Za(a))return p.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Uh=b};a.Fm=c.Fm;a.Aa=c.Aa;a.kc=c.kc;a.Za=c.Za;a.HD=function(a,b){if(!l.xa(a))return p.error("set_move_style(): Wrong camera object"),
!1;if(b!=c.Jg&&b!=c.md&&b!=c.Kb&&b!=c.ad)return p.error("set_move_style(): Wrong move style"),!1;c.HD(a,b);f.D(a);r.H(a);return!0};a.tm=function(a){return l.xa(a)?c.tm(a):(p.error("get_move_style(): Wrong camera object"),null)};a.Vc=function(a,b){if(l.xa(a)){var e=a.k;if(c.Aa(a)){var g=n.G(e.n),g=z.subtract(b,g,A);z.add(g,e.pivot,e.pivot)}else c.Za(a)&&(g=n.G(e.n),g=z.subtract(b,g,A),z.add(g,e.Vb,e.Vb));f.Vc(a,b);f.D(a);r.H(a)}else p.error("set_translation(): Wrong camera object")};a.sd=function(a,
b){if(!l.xa(a))return p.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return f.sd(a,b)};a.I8=function(a,b,e,g,d){l.xa(a)?(g=g||!1,d=d||!1,c.Aa(a)?c.fx(a,b,e,g,d):c.kc(a)?c.Ls(a,b,e,g,d):c.Za(a)?c.Ms(a,b,e,g,d):c.Fm(a)?p.warn("rotate_camera(): not supported for STATIC cameras"):p.error("rotate_camera(): Wrong camera move style"),f.D(a),r.H(a)):p.error("rotate_camera(): Wrong camera object")};a.pZ=function(a,b){if(l.xa(a)){var c=a.k;"number"==typeof b.trans&&(c.ol=e.V(b.trans,
0,Infinity));"number"==typeof b.rot&&(c.nl=e.V(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.pl=e.V(b.zoom,0,.99))}else p.error("set_velocities(): Wrong camera object")};a.Zh=function(a,b){if(!l.xa(a))return p.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.ol;b.rot=c.nl;b.zoom=c.pl;return b};a.C7=function(a){return l.xa(a)?0<=e.ec(n.R(a.k.n),e.Mc,A)[1]:(p.error("is_look_up(): Wrong camera object"),!1)};a.rm=function(a,b){if(!l.xa(a))return p.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);c.rm(a,b);return b};a.kk=function(a,b){if(!l.xa(a))return p.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);c.kk(a,b);return b};a.k5=function(a,b){b=b||new Float32Array(2);var f=z.normalize(a,A),f=e.xD(e.Mc,f,H);e.AA(f,!0);c.zB(f,b);return b};a.mM=function(a,b){if(l.xa(a))for(var e=m.A(),e=l.ja(a,e).da,f=0;f<e.length;f++){var d=e[f];d.type!=c.Pc&&d.type!=c.cd&&d.type!=c.Te&&d.type!=c.Ue||c.lZ(d,b,d.qf)}else p.error("set_stereo_distance(): Wrong camera object")};
a.vJ=function(a){if(!l.xa(a))return p.error("get_stereo_distance(): Wrong camera object"),0;var b=m.A();a=l.ja(a,b).da;for(b=0;b<a.length;b++){var e=a[b];if(e.type==c.Pc||e.type==c.cd)return e.al}return 0};a.BD=function(a,b){if(l.xa(a)){var e=m.A(),e=l.ja(a,e).da;c.BD(e,b)}else p.error("set_eye_distance(): Wrong camera object")};a.B5=function(a){if(!l.xa(a))return p.error("get_eye_distance(): Wrong camera object"),0;var b=m.A();a=l.ja(a,b).da;for(b=0;b<a.length;b++){var e=a[b];if(e.type==c.Pc||e.type==
c.cd||e.type==c.Te||e.type==c.Ue)return e.qf}return 0};a.MD=function(a,b){l.xa(a)?(z.copy(b,a.k.tf),f.D(a),r.H(a)):p.error("set_vertical_axis(): Wrong camera object")};a.RV=function(a,b){if(l.xa(a))return b||(b=z.create()),z.copy(a.k.tf,b),b;p.error("get_vertical_axis(): Wrong camera object")};a.s$=function(a,b,e,f){if(l.xa(a)){var d=m.A();a=l.ja(a,d).da;for(d=0;d<a.length;d++){var g=a[d];g.rc||c.Vk(g,g.Ab);var n=A;n[0]=-b;n[1]=-e;n[2]=0;t.translate(g.xb,n,g.xb);t.rotateZ(g.xb,f,g.xb);c.RG(g);c.fA(g)}}else p.error("translate_view(): Wrong camera object")};
a.P6=function(a,b){if(!l.xa(a))return p.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);e.ec(n.R(a.k.n),e.Mc,b);return b};a.zV=function(a){if(!l.xa(a))return p.error("get_fov(): Wrong camera object"),0;var b=m.A();a=l.ja(a,b).da;return e.Cb(a[0].Xd)};a.e9=function(a,b){if(l.xa(a))for(var f=m.A(),f=l.ja(a,f).da,g=0;g<f.length;g++){var d=f[g];d.Xd=e.re(b);d.rc||c.Vk(d,d.Ab);c.RG(d);c.fA(d)}else p.error("set_fov(): Wrong camera object")};a.FD=function(a,b,e){var f;if(!(f=
l.xa(a)))a:{if(l.xa(a)){f=m.A();f=l.ja(a,f).da;for(var d=0;d<f.length;d++){var g=f[d];if(g.type==c.Te||g.type==c.Ue){f=!0;break a}}}else p.error("is_hmd_camera(): Wrong camera object");f=!1}f?b&&e&&c.FD(a,b,e):p.error("set_hmd_fov(): Wrong camera object")};a.$j=function(a,c,e){l.xa(a)?(c=c||a.k.tf,b.$j(a,c,e||!1),f.D(a),r.H(a)):p.error("correct_up(): Wrong camera object")};a.s9=function(a,b){if(l.xa(a)&&c.gw(a)){var e=a.k;if(c.Aa(a)){var f=n.G(e.n),f=z.dist(f,e.pivot);e.qk=b/2*e.pk/f}else c.Za(a)?
(f=n.G(e.n),f=z.distance(f,e.Vb),e.qk=b/2*e.pk/f):(e=m.A(),l.ja(a,e).da[0].top=b/2);c.X_(a)}else p.error("set_ortho_scale(): Wrong camera object")};a.i6=function(a){if(!l.xa(a)||!c.gw(a))return p.error("get_ortho_scale(): Wrong camera object"),0;var b=m.A();return 2*l.ja(a,b).da[0].top};a.gw=function(a){return l.xa(a)?c.gw(a):(p.error("is_ortho_camera(): Wrong camera object"),!1)};a.m3=function(a,b,g,q){if(!l.xa(a))return p.error("calc_ray(): Wrong camera object"),null;var d=m.A(),r=l.ja(a,d).da[0];
q&&3==q.length?p.P('dest parameter in the function "calc_ray" should be type of parametric line.'):q=q||new Float32Array(6);switch(r.type){case c.Qd:case c.Jh:case c.Pc:case c.cd:var u=Math.tan(r.Xd*Math.PI/360),t=u*r.Ab,d=A;b=w.Eu(b,g,F,r);d[0]=(2*b[0]/r.width-1)*t;d[1]=(1-2*b[1]/r.height)*u;d[2]=-1;n.xd(d,a.k.n,d);z.normalize(d,d);3==q.length?z.copy(d,q):(a=f.sd(a,O),D.gM(q,a),D.ID(q,d));return q;case c.ze:return d=A,b=w.Eu(b,g,F,r),d[0]=(2*b[0]/r.width-1)*r.top*r.Ab,d[1]=(1-2*b[1]/r.height)*r.top,
d[2]=0,n.Wc(d,a.k.n,d),z.copy(d,q),z.transformQuat(e.Mc,n.R(a.k.n),d),D.ID(q,d),q;default:return p.error("calc_ray(): Non-compatible camera"),q}};a.dD=function(a,b,e){if(!l.xa(a))return p.error("project_point(): Wrong camera object"),null;e=e||new Float32Array(2);return c.dD(a,b,e)};a.X6=function(a){return(c.Aa(a)||c.Za(a))&&null!==a.k.sb};a.g7=function(a){return(c.kc(a)||c.Aa(a)||c.Za(a))&&null!==a.k.ka};a.f7=function(a){p.Sb("has_vertical_limits","has_vertical_rot_limits");return c.Aa(a)||c.kc(a)?
null!==a.k.ka:(p.error("has_vertical_limits(): Wrong camera object"),!1)};a.a7=function(a){return(c.Aa(a)||c.kc(a))&&null!==a.k.lb};a.Z6=function(a){p.Sb("has_horizontal_limits","has_horizontal_rot_limits");return c.Aa(a)||c.kc(a)?null!==a.k.lb:(p.error("has_horizontal_limits(): Wrong camera object"),!1)};a.h7=function(a){return c.Za(a)&&null!==a.k.Dc};a.b7=function(a){return c.Za(a)&&null!==a.k.Cc};a.V7=function(a,b,e){p.Sb("move_pivot","target_pan_pivot");if(c.Aa(a)){var g=a.k;if(g.use_panning){var d=
n.G(g.n),l=z.subtract(d,g.pivot,O);A[0]=b;A[1]=0;A[2]=e;z.scale(A,z.len(l),A);n.xd(A,g.n,A);z.add(g.pivot,A,g.pivot);z.add(d,A,d);f.D(a);r.H(a)}}else p.error("move_pivot(): wrong object")};a.H9=function(a,b){p.Sb("set_velocity_params","set_velocities");if(l.xa(a)){var c=a.k;c.ol=e.V(b[0],0,Infinity);c.nl=e.V(b[1],0,Infinity);c.pl=e.V(b[2],0,.99)}else p.error("set_velocity_params(): Wrong camera object")};a.M6=function(a,b){p.Sb("get_velocity_params","get_velocities");if(!l.xa(a))return p.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var c=a.k;b[0]=c.ol;b[1]=c.nl;b[2]=c.pl;return b};a.J3=function(a){p.P('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');l.xa(a)?c.Aa(a)||c.kc(a)?a.k.lb=null:c.Za(a)&&(a.k.Cc=null):p.error("clear_horizontal_limits(): Wrong camera object")};a.N3=function(a){p.P('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');
l.xa(a)?c.Aa(a)||c.kc(a)?a.k.ka=null:c.Za(a)&&(a.k.Dc=null):p.error("clear_vertical_limits(): Wrong camera object")};a.K3=function(){p.P("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.GD=function(a,e,g,l){p.Vh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);l=l||a.k.tf;c.GD(a,e,g);b.$j(a,l,!0);f.D(a);r.H(a)};a.Ls=function(a,b,e,g,d){p.Vh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);c.kc(a)?(c.Ls(a,
b,e,g,d),f.D(a),r.H(a)):p.error("rotate_eye_camera(): wrong object")};a.fx=function(a,b,e,g,d){p.Vh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);c.Aa(a)?(c.fx(a,b,e,g,d),f.D(a),r.H(a)):p.error("rotate_target_camera(): wrong object")};a.Ts=function(a,b,e){p.Sb("camera.set_trans_pivot","camera.target_set_trans_pivot");c.Aa(a)?(c.Ts(a,b,e),f.D(a),r.H(a)):p.error("set_trans_pivot(): Wrong object or camera move style")};a.P$=function(a,b){p.Sb("camera.zoom_object","camera.target_zoom_object");
if(c.Aa(a)){f.yv(b,!1,A);q(a,A);f.D(a);var e=f.zv(b),g=m.A(),g=l.ja(a,g).da[0],g=c.FI(g)/2,e=e/Math.sin(g),g=f.Ho(a,A);f.nh(a,0,0,e-g);f.D(a);r.H(a)}else p.error("zoom_object(): wrong object")};a.t9=q;a.Ms=function(a,b,e,g,d){p.Sb("camera.rotate_hover_camera","camera.hover_rotate");c.Za(a)?(c.Ms(a,b,e,g,d),f.D(a),r.H(a)):p.error("rotate_hover_camera(): wrong object")};a.P5=function(a,b){p.Sb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!c.Za(a))return p.error("get_hover_cam_pivot(): wrong object"),
null;b||(b=new Float32Array(3));z.copy(a.k.Vb,b);return b};a.VI=function(a,b){p.Sb("camera.get_eye","camera.get_translation");return l.xa(a)?c.VI(a,b):(p.error("get_eye(): Wrong object"),null)};a.m6=function(a,b){p.Sb("camera.get_pivot","camera.target_get_pivot");if(!c.Aa(a))return p.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));z.copy(a.k.pivot,b);return b};a.l7=function(a,b){p.Sb("camera.hover_cam_set_translation","camera.set_translation");if(c.Za(a)){var e=
a.k,g=z.subtract(b,n.G(e.n),A);z.add(g,e.Vb,e.Vb);f.Vc(a,b);f.D(a);r.H(a)}else p.error("hover_cam_set_translation(): wrong object")};a.px=function(a,b){p.Sb("camera.set_hover_pivot","camera.hover_set_pivot_translation");c.Za(a)?(c.px(a,b),f.D(a),r.H(a)):p.error("set_hover_pivot(): Wrong object or camera move style")};a.O5=function(a,b){p.Sb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!c.Za(a))return p.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);
b[0]=a.k.ka.down;b[1]=a.k.ka.up;return b};a.j5=function(a,b){p.Vh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!c.Za(a)&&!c.Aa(a))return p.error("get_cam_dist_limits(): wrong object"),null;if(a.k.sb)b=b||new Float32Array(2),b[0]=a.k.sb.max,b[1]=a.k.sb.min;else return null;return b};a.Z2=function(b,e,g,l){p.Vh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);
if(c.Aa(b)){var d=I;d.down=e;d.up=g;d.camera_space=l==f.Hn;a.j_(b,d)}else c.kc(b)?(d=I,d.down=e,d.up=g,d.camera_space=l==f.Hn,a.CU(b,d)):c.Za(b)?(d=I,d.min=e,d.max=g,a.eW(b,d)):p.error("apply_vertical_limits(): wrong object")};a.W2=function(b,c,e){p.Sb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");I.down=c;I.up=e;a.Vv(b,I)};a.S2=function(b,e,f){p.Vh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(c.Aa(b)){var g=I;
g.min=e;g.max=f;a.gN(b,g)}else c.Za(b)?(g=I,g.min=e,g.max=f,a.Uv(b,g)):p.error("apply_distance_limits(): wrong object")};a.H3=function(b){p.Sb("camera.clear_distance_limits","camera.target_set_distance_limits");a.gN(b,null)};a.N6=function(a,b){p.Vh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!c.Aa(a)&&!c.kc(a)&&!c.Za(a))return p.error("get_vertical_limits(): wrong object"),null;var e=a.k;b=b||new Float32Array(2);
if(c.kc(a)||c.Aa(a)){if(e.ka)return b[0]=e.ka.down,b[1]=e.ka.up,b}else if(c.Za(a)&&e.Dc)return b[0]=e.Dc.min,b[1]=e.Dc.max,b;return null};a.V2=function(b,e,g,l){p.Vh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(c.Aa(b)){var d=I;d.left=e;d.right=g;d.camera_space=l==f.Hn;a.i_(b,d)}else c.kc(b)?(d=I,d.left=e,d.right=g,d.camera_space=l==f.Hn,a.BU(b,d)):c.Za(b)?(d=I,d.min=e,d.max=g,a.dW(b,d)):p.error("apply_horizontal_limits(): wrong object")};
a.N5=function(a,b){p.Vh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!c.Aa(a)&&!c.kc(a)&&!c.Za(a))return p.error("get_horizontal_limits(): wrong object"),null;var e=a.k;b=b||new Float32Array(2);if(c.kc(a)||c.Aa(a)){if(e.lb)return b[0]=e.lb.left,b[1]=e.lb.right,b}else if(c.Za(a)&&e.Cc)return b[0]=e.Cc.min,b[1]=e.Cc.max,b;return null};a.L5=function(a,b){if(!l.xa(a))return p.error("get_frustum_planes(): Wrong camera object"),
null;var c=m.A(),c=l.ja(a,c).da[0].Wh;M.copy(c.left,b.left);M.copy(c.right,b.right);M.copy(c.top,b.top);M.copy(c.bottom,b.bottom);M.copy(c.near,b.near);M.copy(c.far,b.far);return b}};b4w.module.controls=function(a,g){var q=g("__controls"),c=g("__print");a.yf=q.yf;a.na=q.na;a.Hg=q.Hg;a.Od=q.Od;a.Lp=q.Lp;a.Dy=q.Dy;a.RO=8;a.k2=9;a.G1=13;a.gF=16;a.B1=17;a.w1=18;a.e2=19;a.z1=20;a.I1=27;a.hF=32;a.dF=37;a.iF=38;a.fF=39;a.cF=40;a.l1=49;a.m1=50;a.n1=51;a.o1=52;a.p1=53;a.q1=54;a.r1=55;a.s1=56;a.t1=57;a.Tt=65;a.x1=66;a.bF=67;a.Ut=68;a.F1=69;a.SO=70;a.K1=71;a.M1=72;a.N1=73;a.O1=74;a.TO=75;a.UO=76;a.P1=77;a.S1=78;a.d2=79;a.eF=80;a.g2=81;a.WO=82;a.Vt=83;a.YO=84;a.l2=85;a.ZO=86;a.Wt=87;a.m2=
88;a.n2=89;a.o2=90;a.T1=96;a.U1=97;a.V1=98;a.W1=99;a.X1=100;a.Y1=101;a.Z1=102;a.a2=103;a.b2=104;a.c2=105;a.Q1=106;a.u1=107;a.j2=109;a.D1=110;a.E1=111;a.h2=186;a.H1=187;a.A1=188;a.C1=189;a.f2=190;a.J1=191;a.L1=192;a.VO=219;a.y1=220;a.XO=221;a.i2=222;a.au=q.au;a.$t=q.$t;a.Zt=q.Zt;a.yz=q.yz;a.Yu=q.Yu;a.Zu=q.Zu;a.cr=q.cr;a.Oi=q.Oi;a.DA=q.DA;a.Gb=q.Gb;a.Ou=function(a,c,g){return q.Ou(a,c||"ANY",g||!1)};a.zH=q.zH;a.bk=function(a,c,g,D,l,r,p){return q.bk(a,c,g,D||"ANY",l||!1,r||!1,p||!1)};a.Tn=q.Tn;a.IA=
q.IA;a.Wl=q.Wl;a.JA=q.JA;a.KA=q.KA;a.fr=q.fr;a.QA=q.QA;a.OH=q.OH;a.Su=q.Su;a.FH=q.FH;a.PH=q.PH;a.CH=q.CH;a.FA=q.FA;a.DH=q.DH;a.GA=q.GA;a.EH=q.EH;a.NH=function(a,c){return q.NH(a,c||!1)};a.AL=q.AL;a.eg=q.eg;a.MH=q.MH;a.Qu=function(a,c){return q.Qu(a,c||!1)};a.CA=function(a,c){return q.CA(a,c||0)};a.Y8=function(a,c){q.JY(a,c)};a.v5=function(a){return a.value};a.rd=q.rd;a.ae=q.ae;a.K=function(a,c,g,D,l,r,p){l=l||q.Yu;q.K(a,c,g,D,l,r,void 0===p?null:p)};a.Sn=function(a,c,g,D,l){var r;D=q.Gb(D);q.K(a,
c,g,[D],q.Yu,l,void 0===r?null:r)};a.qS=function(a){return q.Pl(a,null)};a.Pl=q.Pl;a.he=q.he;a.reset=q.reset;a.w8=function(){c.P("controls.register_keyboard_events() deprecated")};a.x8=function(){c.P("controls.register_mouse_events() deprecated")};a.z8=function(){c.P("controls.register_wheel_events() deprecated")};a.y8=function(){c.P("controls.register_touch_events() deprecated")};a.v8=function(){c.P("controls.register_device_orientation() deprecated")};a.y$=function(){c.P("controls.unregister_keyboard_events() deprecated")};
a.z$=function(){c.P("controls.unregister_mouse_events() deprecated")};a.B$=function(){c.P("controls.unregister_wheel_events() deprecated")};a.A$=function(){c.P("controls.unregister_touch_events() deprecated")};a.x$=function(){c.P("controls.unregister_device_orientation() deprecated")};a.rx=q.rx};b4w.module.physics=function(a,g){function q(a,b,c,g){return t.eU(a,g[c[0]],g[c[1]],g[c[2]])}function c(a,b,c,g,f){b=Math.abs(a[2]-b[2]);return b<f&&D.DW(a,c,g)?b:Number.MAX_VALUE}g("__config");var b=g("__physics"),w=g("__print"),t=g("__util"),D=g("__navmesh");g("__vec3");new Float32Array(3);a.zy=0;a.UE=1;a.oO=2;a.yy=3;a.gI=function(a){b.oa(a)?b.gI(a):w.P("No physics for object "+a.name)};a.eB=function(a){b.oa(a)?b.eB(a):w.P("No physics for object "+a.name)};a.ZV=function(a){return b.oa(a)};a.QB=function(a){return b.QB(a)};
a.KJ=function(a){return b.KJ(a)};a.aM=function(a,c){b.oa(a)?b.aM(a,c):w.P("No physics for object "+a.name)};a.Us=function(a,c,g){b.oa(a)?b.Us(a,c,g):w.P("No physics for object "+a.name)};a.H=function(a){b.oa(a)?b.H(a):w.P("No physics for object "+a.name)};a.oG=function(a,c,g,m){b.oa(a)?b.oG(a,c,g,m):w.P("No physics for object "+a.name)};a.pG=function(a,c,g,m){b.oa(a)?b.pG(a,c,g,m):w.P("No physics for object "+a.name)};a.Qz=function(a,c,g,m){b.oa(a)?b.Qz(a,c,g,m,!1):w.P("No physics for object "+a.name)};
a.U2=function(a,c,g,m){b.oa(a)?b.Qz(a,c,g,m,!0):w.P("No physics for object "+a.name)};a.nG=function(a,c,g,m){b.oa(a)?b.nG(a,c,g,m):w.P("No physics for object "+a.name)};a.Cp=function(a,c){b.oa(a)?(b.ff(a)||b.gf(a)||w.error("Wrong object"),b.Cp(a,t.V(c,-1,1))):w.P("No physics for object "+a.name)};a.K$=function(a,c,g){if(b.oa(a)){b.ff(a)||b.gf(a)||w.error("Wrong object");c=t.V(c,0,1);var m=a.v.bo;-1==g||1==g?m=Math.max(-1,Math.min(m+g*c,1)):0==g&&0<=m?(m-=c,m=Math.max(0,m)):0==g&&0>m?(m+=c,m=Math.min(0,
m)):w.error("Wrong steering direction");b.Cp(a,t.V(m,-1,1))}else w.P("No physics for object "+a.name)};a.Bp=function(a,c){b.oa(a)?(b.ff(a)||b.gf(a)||w.error("Wrong object"),b.Bp(a,t.V(c,-1,1))):w.P("No physics for object "+a.name)};a.J$=function(a,c,g){if(b.oa(a)){b.ff(a)||b.gf(a)||w.error("Wrong object");c=t.V(c,0,1);var m=a.v.jp;-1==g||1==g?m=Math.max(-1,Math.min(m+g*c,1)):0==g&&0<=m?(m-=c,m=Math.max(0,m)):0==g&&0>m?(m+=c,m=Math.min(0,m)):w.error("Wrong steering direction");b.Bp(a,t.V(m,-1,1))}else w.P("No physics for object "+
a.name)};a.GE=function(a,c){b.oa(a)?(b.ff(a)||b.gf(a)||w.error("Wrong object"),b.GE(a,t.V(c,0,1))):w.P("No physics for object "+a.name)};a.I$=function(a,c){if(b.oa(a)){b.ff(a)||b.gf(a)||w.error("Wrong object");c=t.V(c,-1,1);var g=a.v.Fq;b.GE(a,t.V(g+g*c,0,1))}else w.P("No physics for object "+a.name)};a.ff=function(a){return b.ff(a)};a.gf=function(a){return b.gf(a)};a.J6=function(a){if(!b.oa(a))return w.P("No physics for object "+a.name),null;if(b.ff(a)||b.gf(a))return a.sf.name;w.error("Wrong object");
return null};a.L6=function(a){if(!b.oa(a))return w.P("No physics for object "+a.name),null;if(b.ff(a)||b.gf(a))return a.v.bo;w.error("Wrong object");return null};a.K6=function(a){if(!b.oa(a))return w.P("No physics for object "+a.name),null;if(b.ff(a)||b.gf(a))return a.v.jp;w.error("Wrong object")};a.I6=function(a){if(!b.oa(a))return w.P("No physics for object "+a.name),null;if(b.ff(a)||b.gf(a))return a.v.Fq;w.error("Wrong object")};a.zJ=function(a){if(!b.oa(a))return w.P("No physics for object "+
a.name),null;if(b.ff(a)||b.gf(a))return b.zJ(a);w.error("Wrong object")};a.og=function(a){return b.og(a)};a.Uk=function(a,c,g){b.oa(a)?b.Uk(a,c,g):w.P("No physics for object "+a.name)};a.mi=function(a,c){b.oa(a)?b.mi(a,c):w.P("No physics for object "+a.name)};a.RL=function(a,c){b.oa(a)?b.RL(a,c):w.P("No physics for object "+a.name)};a.QL=function(a,c){b.oa(a)?b.QL(a,c):w.P("No physics for object "+a.name)};a.NL=function(a,c){b.oa(a)?b.NL(a,c):w.P("No physics for object "+a.name)};a.Gu=function(a){b.oa(a)?
b.Gu(a):w.P("No physics for object "+a.name)};a.aH=function(a,c,g){b.oa(a)?b.aH(a,c,g):w.P("No physics for object "+a.name)};a.tj=function(a,c,g){b.oa(a)?b.tj(a,c,g):w.P("No physics for object "+a.name)};a.PL=function(a,c){b.oa(a)?b.PL(a,c):w.P("No physics for object "+a.name)};a.OL=function(a,c){b.oa(a)?b.OL(a,c):w.P("No physics for object "+a.name)};a.Nz=function(a,c,g,m){b.oa(a)?b.Nz(a,c||"ANY",g,m||!1):w.P("No physics for object "+a.name)};a.mD=function(a,c,g){b.oa(a)?b.mD(a,c||"ANY",g):w.P("No physics for object "+
a.name)};a.Pz=function(a,c){b.oa(a)?b.Pz(a,c):w.P("No physics for object "+a.name)};a.pA=function(a){b.oa(a)?b.pA(a):w.P("No physics for object "+a.name)};a.pu=function(a,c,g,m,f,n){a=a||null;if(null==a||b.oa(a))return b.pu(a,c,g,m||"ANY",f,n||!1,!1,!1,!1);w.P("No physics for object "+a.name)};a.L2=function(a,c,g,m,f,n,e,q,t){a=a||null;if(null==a||b.oa(a))return b.pu(a,c,g,m||"ANY",f,n||!1,e||!1,q||!1,t||!1);w.P("No physics for object "+a.name)};a.nD=function(a){b.dK(a)?b.nD(a):w.error("Wrong ray test ID")};
a.YG=function(a,c,g){b.dK(a)?b.YG(a,c,g):w.error("Wrong ray test ID")};a.kG=function(a,c,g,m,f,n,e,q,t,D){b.oa(c)&&b.oa(f)?b.kG(a,c,g,m,f,n,e,q,t,D):w.error("Wrong objects")};a.oH=function(a){b.oa(a)&&b.XV(a)?b.oH(a):w.error("Wrong object")};a.mL=function(a,c,g,m,f,n){b.oa(a)&&b.oa(m)?b.mL(a,c,g,m,f,n):w.error("Wrong objects")};a.HK=function(a,c,g){g||(g=q);if(b.oa(a)){var m=a.C.os;return m?D.HK(m,c,g):(w.error(a.name+" is not a navigation mesh object"),null)}w.P("No physics for object "+a.name)};
a.GK=function(a,g,p,m){if(b.oa(a)){var f=a.C.os;if(!f)return w.error(a.name+" is not a navigation mesh object"),null;m=m||{};a={};a.do_not_pull_string=Boolean(m.do_not_pull_string);a.distance_to_closest=m.distance_to_closest||q;a.distance_to_farthest=m.distance_to_farthest||c;a.island=m.island||0;a.allowed_distance=m.allowed_distance||Number.MAX_VALUE;a.return_normals=m.return_normals||!1;return D.GK(f,g,p,a)}w.P("No physics for object "+a.name)}};b4w.module.util=function(a,g){var q=g("__compat"),c=g("__obj_util"),b=g("__print"),w=g("__quat"),t=g("__util"),D=g("__vec3"),l=new Float32Array(6);a.Gg=new Float32Array([1,0,0]);a.Eh=new Float32Array([0,1,0]);a.nc=new Float32Array([0,0,1]);a.wy=new Float32Array([-1,0,0]);a.Re=new Float32Array([0,-1,0]);a.Mc=new Float32Array([0,0,-1]);a.JF=t.JF;a.QF=t.QF;a.RF=t.RF;a.LF=t.LF;a.NF=t.NF;a.TF=t.TF;a.KF=t.KF;a.PF=t.PF;a.Ez=t.Ez;a.MF=t.MF;a.OF=t.OF;a.SF=t.SF;a.Hf=function(a){return t.Hf(a||0)};a.assert=
t.assert;a.mK=t.mK;a.Ed=t.Ed;a.tC=function(a){return t.tC(a)};a.fk=function(a,b){b||(b=new Float32Array(4));return t.fk(a,b)};a.OC=function(a,b,c){c||(c=w.create());return t.OC(a,b,c)};a.qL=function(a,b,c){c||(c=D.create());return t.qL(a,b,c)};a.ax=function(a,b){b||(b=new Float32Array(3));return t.ax(a,b)};a.sign=t.sign;a.V=t.V;a.ec=t.ec;a.W6=function(a,b){return t.$w(a,t.Mc,t.nc,t.Eh,b)};a.jA=function(a,b){return t.jA(a,b)};a.$w=function(a,c,g,f,l){return 0!=D.dot(g,f)?(b.error("Wrong in-plane direction"),
null):t.$w(a,c,g,f,l)};a.MJ=t.MJ;a.Zb=t.Zb;a.Ix=t.Ix;a.wk=t.wk;a.AA=t.AA;a.pL=t.pL;a.Po=t.Po;a.SB=t.SB;a.nC=function(a,c,g,f,n){b.Sb("util.line_plane_intersect","math.line_plane_intersect");l[0]=g[0];l[1]=g[1];l[2]=g[2];l[3]=f[0];l[4]=f[1];l[5]=f[2];return t.nC(a,c,l,n)};a.be=function(a){b.Sb("util.is_mesh","objects.is_mesh");return c.be(a)};a.Am=function(a){b.Sb("util.is_armature","objects.is_armature");return c.Am(a)};a.Fi=t.Fi;a.Ng=t.Ng;a.fn=t.fn;a.lerp=t.lerp;a.Cb=t.Cb;a.re=t.re;a.bB=t.bB;a.Zr=
q.Zr;a.Hr=t.Hr};b4w.module.main=function(a,g){function q(){}function c(){}function b(){}function w(){window.performance||(K.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(K.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});ka.nM(0)}function t(a,b){for(var c=null,d=b?la:ua,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,v)}catch(g){}if(c)break}c&&A.$T(c);return c}function D(a,b,d){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();K.error("WebGL context lost");r()},!1);h.Tf(d);var f=h.Av();f&&K.log("%cRENDERER INFO:","color: #00a",d.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+d.getParameter(f.UNMASKED_RENDERER_WEBGL));G.Tf(d);k.Tf(d);x.Tf(d);X.Tf(d);C.Tf(d);O.Tf(d);I.vZ(a);O.fh(a,b);T.sM(a.width,a.height,1);P.fh();c=e();m()}function l(){q=function(){}}function r(){p()||(oa=performance.now()/1E3,P.pause(),ba.pause(),x.pause(),z.pause())}function p(){return S<oa}function m(){var a="HMD"===Z.stereo&&
J.EJ();a?a.requestAnimationFrame(m):ya(m);var b=performance.now()/1E3;ta||(ta=b);var d=b-ta;if(!(d<1/Z.max_fps)){for(var e=ka.lk(),f=0;f<ga.length;f++)ga[f](e,d);p()||(S>ta&&(d-=S-Math.max(oa,ta)),e+=d,ka.nM(e),C.update(),E.update(),I.update(),n(e,d),c(d));ta=b;a&&a.isPresenting&&a.submitFrame()}}function f(a,b,c){if(Y)if(Y.n_)Y.n_(a,b,c);else{c=atob(Y.toDataURL(b,c).split(",")[1]);for(var d=new Uint8Array(c.length),e=0;e<c.length;e++)d[e]=c.charCodeAt(e);a(new Blob([d],{type:b||"image/png"}))}}function n(a,
b){if(I.ih()&&(y.reset(),ca.update(b),B.update(a,b),d.update(a,b),P.update(a,b),b&&M.update(b),I.ih()&&(ba.update(a,b),I.ih()&&(J.update(a),H.update(a,b),I.ih()&&(z.update(!1),u.update(a,b),ha.update(),q(b,a),I.ih()))))){T.update(a,b);z.IN();var c=za.callback;c&&(za.nK&&URL.revokeObjectURL(za.Wz),f(function(a){za.Wz=URL.createObjectURL(a);c(za.Wz)},za.format,za.quality),za.callback=null,za.format="image/png",za.quality=1)}}function e(){var a=60,c=0,d=Z.qI,e=Z.OU;return function(f){f<1/Z.max_fps||
(a=Q.Zb(1/f,a,f,d),f=ba.AV(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var z=g("__anchors"),M=g("__animation"),E=g("__assets"),F=g("__config"),A=g("__compat"),O=g("__container"),H=g("__controls"),I=g("__data"),C=g("__debug"),h=g("__extensions"),k=g("__geometry"),J=g("__input"),y=g("__hud"),d=g("__nla"),B=g("__logic_nodes"),u=g("__objects"),ba=g("__physics"),K=g("__print"),G=g("__renderer"),T=g("__scenes"),P=g("__sfx"),X=g("__shaders"),x=g("__textures"),ka=g("__time"),ca=g("__transform"),Q=g("__util"),
W=g("__version"),ha=g("__particles"),v=F.context,Z=F.B,Y=null,V=null,ta=0,oa=0,S=0,ga=[],za={callback:null,format:"image/png",quality:1,Wz:"",nK:!1,SH:!1},ua=["webgl","experimental-webgl"],la=["webgl2","experimental-webgl2"],da=null,ya=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/Z.max_fps)}}();a.fh=function(a,b){F.hZ();K.qZ(Z.console_verbose);
var c=W.HE()+" "+W.type()+" ("+W.XA()+")";K.log("%cINIT ENGINE","color: #00a",c);K.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;w();Y=a;b?(y.fh(b),V=b):(F.B.show_hud_debug_info=!1,F.Y.yw=!1);A.eR();A.nA("Chrome")||A.nA("Firefox")||(Z.gc=!1);c=t(a,Z.gc);!c&&Z.gc&&(Z.gc=!1,c=t(a,!1));if(!c)return null;K.log("%cINIT WEBGL "+(Z.gc?"2":"1"),"color: #00a");da=c;D(Y,V,c);F.Ln();A.bM(c,!0);X.ZW();Z.no&&(a.style["touch-action"]="none");K.log("%cSET PRECISION:",
"color: #00a",Z.precision);return c};a.resize=function(a,b,c){K.Sb("main.resize","container.resize");O.resize(a,b,c)};a.VY=function(a){b=a};a.I3=function(){b=function(){}};a.y9=function(a){q=a};a.M3=function(){l()};a.V6=function(){K.Sb("main.global_timeline","time.get_timeline");return ka.lk()};a.pause=r;a.qj=function(){p()&&(S=performance.now()/1E3,P.qj(),ba.qj(),x.play(!0),z.qj())};a.$r=p;a.reset=function(){I.Xx(0);I.reset();h.reset();G.reset();k.reset();x.zY();X.reset();C.reset();O.reset();I.reset();
O.reset();ka.reset();P.reset();V=Y=null;S=oa=ta=0;b=function(){};c=function(){};q=function(){};ga.length=0;da=null};a.YR=function(a,b,c){za.SH=!0;za.nK=za.SH;za.callback=a;za.format=b||za.format;za.quality=c||za.quality};a.o5=function(){K.Sb("main.get_canvas_elem","container.get_canvas");return Y};a.$e=function(){return A.$e()};a.pq=function(a){for(var b=0;b<ga.length;b++)if(ga[b]==a)return;ga.push(a)};a.lY=function(a){for(var b=0;b<ga.length;b++)if(ga[b]==a){ga.splice(b,1);break}};a.Av=function(){var a=
h.Av();return a?{vendor:da.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:da.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.input=function(a,g){function q(a){var c=b.fa(b.yd);if(!c||!c.uh)return!1;if(e)return!0;var g=b.Zi(c,b.tO,f),k=b.Zi(c,b.uO,n);w.FD(a,g,k);if(g=b.um(c,E))k=p.A(),a=l.ja(a,k).da,w.BD(a,g);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.um(b.ul)!==b.Xp&&(a.distortion_coefs=[c.distortion_coefs[0],c.distortion_coefs[1]],a.chromatic_aberration_coefs=[c.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]],
c.Hp||(c.Rj&&c.ok&&c.Sj?a.base_line_factor=(c.Rj-c.Sj)/c.ok:c.Sj||(a.base_line_factor=c.Rj/c.ok)),c.aj&&c.wn&&!c.Hp&&(a.inter_lens_factor=c.aj/c.wn),z.enabled||(g=1+c.distortion_coefs[0]+c.distortion_coefs[1],p.FK(g,g)));p.ox(a);D.Pk(!0);b.ex(c);return e=!0}function c(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=g("__input"),w=g("__camera"),t=g("__config"),D=g("__container"),
l=g("__obj_util"),r=g("__print"),p=g("__scenes"),m=g("__vec4"),f=m.create(),n=m.create(),e=!1,z=t.kr,M=t.B;a.Jt=b.Jt;a.Kt=b.Kt;a.Vp=b.Vp;a.Lt=b.Lt;a.iz=b.iz;a.Xy=b.Xy;a.It=b.It;a.bz=b.bz;a.kz=b.kz;a.Wp=b.Wp;a.jz=b.jz;a.Ot=b.Ot;a.lz=b.lz;a.mz=b.mz;a.Yy=b.Yy;a.Zy=b.Zy;a.Mt=b.Mt;a.Nt=b.Nt;a.$y=b.$y;a.az=b.az;a.cz=b.cz;a.dz=b.dz;a.ez=b.ez;a.fz=b.fz;a.gz=b.gz;a.hz=b.hz;a.Rp=b.Rp;a.Sp=b.Sp;a.Tp=b.Tp;a.Up=b.Up;a.Ry=b.Ry;a.Sy=b.Sy;a.Ty=b.Ty;a.Uy=b.Uy;a.Vy=b.Vy;a.Wy=b.Wy;a.Py=b.Py;a.Qy=b.Qy;a.Rt=b.Rt;a.St=
b.St;a.ul=b.ul;a.uz=b.uz;a.YE=b.YE;a.XE=b.XE;a.Xp=b.Xp;var E=b.qz;a.qz=E;a.pz=b.pz;a.nz=b.nz;a.sz=b.sz;a.tz=b.tz;a.rz=b.rz;a.oz=b.oz;a.Ci=b.Ci;a.vl=b.vl;a.aq=b.aq;a.bq=b.bq;a.Zp=b.Zp;a.Yp=b.Yp;a.zl=b.zl;a.hq=b.hq;a.yl=b.yl;a.Qt=b.Qt;a.Bn=b.Bn;var F={};F[b.yd]=[b.Rt,b.St];F[b.$c]=[b.Ci];var A={};A[b.yd]=[b.ul];var O={};O[b.$c]=[b.Ci,b.vl,b.aq,b.bq];O[b.Mp]=[b.Zp,b.Yp];O[b.Ig]=[b.zl,b.hq,b.yl];O[b.Fh]=[b.Qt,b.Bn];var H={};H[b.yd]=[b.pz,b.qz,b.nz,b.sz,b.tz,b.rz,b.oz];a.Fh=b.Fh;a.yd=b.yd;a.$c=b.$c;a.Mp=
b.Mp;a.Ig=b.Ig;a.Du=b.Du;a.fa=b.fa;a.fE=function(a,c){a&&b.fE(a,c)};a.u8=function(){r.P("input.register_device() deprecated")};a.ex=function(a){a&&a.type==b.yd?b.ex(a):r.error("reset_device is undefined for device.")};a.Zi=function(a,c,e){if(a&&a.type in F&&0<=F[a.type].indexOf(c))return b.Zi(a,c,e);r.error("device hasn't param: ",c)};a.um=function(a,c){if(a&&a.type in A&&0<=A[a.type].indexOf(c))return b.um(a,c);r.error("device hasn't param: ",c)};a.zd=function(a,c,e){e=e||null;if(a&&a.type in O&&
0<=O[a.type].indexOf(c))return b.zd(a,c,e);r.error("device hasn't param: ",c)};a.Cd=function(a,c,e){e=e||null;if(a&&a.type in O&&0<=O[a.type].indexOf(c))return b.Cd(a,c,e);r.error("device hasn't param: ",c)};a.AD=function(a,c,e){if(a&&a.type in H&&0<=H[a.type].indexOf(c))return b.AD(a,c,e);r.error("device hasn't config: ",c)};a.wY=function(){if(p.Da()){var a=p.qm(p.A());if(a&&(q(a),a=b.fa(b.yd))){var c=a.Zf;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=D.Xh(),c.requestPresent([{source:a}]).then(function(){if(!M.is_mobile_device){var a=
c.getEyeParameters("left"),b=c.getEyeParameters("right");D.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){r.error("HMD fullscreen request failed.")})):r.error("HMD fullscreen request failed."))}}};a.nU=q;a.cU=function(){var a=b.fa(b.yd);if(e||a&&a.uh)p.ox({enable_hmd_stereo:!1}),a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]),p.FK(a,a),D.Pk(!0)};a.g9=function(a,e,f){c();switch(a){case 0:a=b.Dt;break;case 1:a=b.Gy;break;case 2:a=b.Hy;break;
case 3:a=b.Iy;break;default:a=b.Dt}a=b.fa(a);b.AD(a,e,f)};a.iJ=b.iJ;a.cJ=b.cJ;a.cH=c};b4w.module.transform=function(a,g){var q=g("__obj_util"),c=g("__physics"),b=g("__print"),w=g("__quat"),t=g("__transform"),D=g("__tsr"),l=g("__util"),r=D.create(),p=new Float32Array(3),m=new Float32Array(4);a.Hn=t.Hn;a.HF=t.HF;a.Vc=function(a,g,e,l){q.Ra(a)?(p[0]=g,p[1]=e,p[2]=l,t.Vc(a,p),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.wx=function(a,g,e,l){q.Ra(a)?(p[0]=g,p[1]=e,p[2]=l,t.wx(a,p),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.oM=function(a,
g){q.Ra(a)?(t.Vc(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.G9=function(a,g){q.Ra(a)?(t.wx(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.F9=function(a,g,e,m,r){q.Ra(a)?(p[0]=g,p[1]=e,p[2]=m,l.Wc(p,1,D.R(r.k.n),D.G(r.k.n),p),t.Vc(a,p),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.sd=function(a,b){b||(b=new Float32Array(3));t.sd(a,b);return b};a.xJ=function(a,b){b||(b=new Float32Array(3));t.xJ(a,b);return b};
a.ni=function(a,g,e,l,p){q.Ra(a)?(m[0]=g,m[1]=e,m[2]=l,m[3]=p,t.ni(a,m),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.tx=function(a,g,e,l,p){q.Ra(a)?(m[0]=g,m[1]=e,m[2]=l,m[3]=p,t.tx(a,m),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ux=function(a,g){q.Ra(a)?(t.ni(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.C9=function(a,g){q.Ra(a)?(t.tx(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Lf=
function(a,b){b||(b=new Float32Array(4));t.Lf(a,b);return b};a.mJ=function(a,b){b||(b=new Float32Array(4));t.mJ(a,b);return b};a.sx=function(a,g,e,l){q.Ra(a)?(p[0]=g,p[1]=e,p[2]=l,t.sx(a,p),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.kJ=function(a,b){b||(b=new Float32Array(3));t.kJ(a,b);return b};a.lJ=function(a,b){b||(b=new Float32Array(3));t.lJ(a,b);return b};a.KD=function(a,g,e,l){q.Ra(a)?(p[0]=g,p[1]=e,p[2]=l,t.KD(a,p),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.B9=function(a,g){q.Ra(a)?(t.sx(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.A9=function(a,g){q.Ra(a)?(t.KD(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Sf=function(a,c){q.Ra(a)?(t.Sf(a,c),t.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.LD=function(a,c){q.Ra(a)?(t.LD(a,c),t.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.$d=function(a){return t.$d(a)};a.oJ=function(a){return t.oJ(a)};
a.v4=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var g=0;g<a.Xe.length;g++)if(!q.Ra(a.Xe[g])){b.error('Wrong object: "'+a.Xe[g].name+'" is not dynamic.');return}t.Vc(a,[0,0,0]);t.ni(a,[0,0,0,1]);t.Sf(a,1);t.D(a);c.H(a)}};a.zv=function(a){return q.be(a)?t.zv(a):(b.error("Wrong object: "+a.name),0)};a.yv=function(a,c,e){if(!q.be(a))return b.error("Wrong object: "+a.name),null;e||(e=new Float32Array(3));return t.yv(a,c,e)};a.nh=function(a,g,e,l){q.Ra(a)?(t.nh(a,g,e,l),t.D(a),
c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.J8=function(a,g){if(q.Ra(a)){var e=w.setAxisAngle(l.Gg,g,m);t.vD(a,e);t.D(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.K8=function(a,g){if(q.Ra(a)){var e=w.setAxisAngle(l.Re,g,m);t.vD(a,e);t.D(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.L8=function(a,g){if(q.Ra(a)){var e=w.setAxisAngle(l.nc,g,m);t.vD(a,e);t.D(a);c.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.gJ=function(a){return t.gJ(a)};a.uj=function(a,g){q.Ra(a)?(t.uj(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.xx=function(a,g){q.Ra(a)?(t.xx(a,g),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Mr=function(a,b){b||(b=new Float32Array(8));t.Mr(a,b);return b};a.Nr=function(a,b){b||(b=new Float32Array(8));t.Nr(a,b);return b};a.distance=function(a,b){return t.distance(a,b)};a.l9=function(a,g){q.Ra(a)?(D.Wi(g,r),t.uj(a,r),t.D(a),c.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.m9=function(a,g){q.Ra(a)?(D.Wi(g,r),t.xx(a,r),t.D(a),c.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.X5=function(a,b){b||(b=new Float32Array(16));t.Mr(a,r);D.pN(r,b);return b};a.Y5=function(a,b){b||(b=new Float32Array(16));t.Nr(a,r);D.pN(r,b);return b}};b4w.module.constraints=function(a,g){var q=g("__camera"),c=g("__constraints"),b=g("__obj_util"),w=g("__physics"),t=g("__print"),D=g("__transform");a.hG=function(a,b,g){var m;m=m||1;b instanceof Array&&2==b.length?c.WQ(a,b[0],b[1],g,m):c.iG(a,b,g,void 0,m);D.D(a);w.H(a)};a.N2=function(a,b,g,m){c.UQ(a,b,g,m);D.D(a);w.H(a)};a.O2=function(a,b,g,m,f,n,e,z){q.kc(a)?(f=f||-Math.PI/2,n=n||Math.PI/2,e=e||Math.PI/2,z=z||-Math.PI/2,c.TQ(a,b,g,m,f,n,e,z),D.D(a),w.H(a)):t.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.M2=function(a,b,g,m){if(q.kc(a)){if(!m||0>m)m=.25;c.SQ(a,b,g,m);D.D(a);w.H(a)}else t.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.jG=function(a,b,g){c.YQ(a,b,g);D.D(a);w.H(a)};a.fG=function(a,b){c.MQ(a,b);D.D(a);w.H(a)};a.P2=function(a,b,g,m){c.ZQ(a,b,g,m);D.D(a);w.H(a)};a.Q2=function(a,b){3==b.length?c.bR(a,b):c.aR(a,b);D.D(a);w.H(a)};a.K2=function(a,b,g,m){3==b.length?c.PQ(a,b,g,m):c.OQ(a,b,g,m);D.D(a);w.H(a)};a.Oz=function(a,b,g){c.Oz(a,b,g);
D.D(a);w.H(a)};a.remove=function(a){a.pc&&c.remove(a)};a.hJ=function(a){t.Sb("constraints.get_parent","objects.get_parent");return b.hJ(a)}};b4w.module.hmd=function(a,g){function q(a,g){if(g){var q=D.ke();if(q){c.kc(q)||(n=c.Aa(q),e=c.Za(q),z=c.Fm(q),c.DU(q));var q=b.eg(),y=!1;b.K(null,"HMD_ROTATE_CAMERA",b.na,[q,g],null,function(d,e,g){if(0<g&&(g=D.ke())&&(!y&&w.nU(g)&&(m=l.Lf(g,m),y=!0),y&&c.kc(g)&&(d=b.ae(d,e,1))))if(1==a){d=t.multiply(C,d,I);var k=p.transformQuat(r.Re,d,M);c.MD(g,k);l.ux(g,d)}else if(2==a||3==a){e=l.Lf(g,O);e=t.invert(e,O);var n=t.multiply(m,e,O);e=c.RV(g,M);Math.abs(e[2])<Math.PI/4?k=p.cross(e,r.Re,E):Math.abs(e[1])<
Math.PI/4&&(k=p.cross(e,r.nc,E));p.normalize(k,k);var n=p.transformQuat(k,n,F),q=p.dot(e,n),n=p.scaleAndAdd(n,e,-q,F);p.normalize(n,n);e=p.cross(e,k,M);k=Math.acos(r.V(p.dot(k,n),0,1));e=r.sign(p.dot(n,e));f+=k*e;k=t.setAxisAngle(r.nc,-f,O);3!=a&&(e=r.$w(d,r.Mc,r.nc,r.Eh,H),e=t.invert(e,H),d=t.multiply(e,d,H));d=t.multiply(k,d,A);k=p.transformQuat(r.Re,d,M);c.MD(g,k);l.ux(g,d);t.copy(d,m)}})}}}var c=g("camera"),b=g("controls"),w=g("input"),t=g("quat"),D=g("scenes"),l=g("transform"),r=g("util"),p=
g("vec3"),m=t.create(),f=0,n=!1,e=!1,z=!1,M=p.create(),E=p.create(),F=p.create(),A=t.create(),O=t.create(),H=t.create(),I=t.create(),C=t.create();a.j1=0;a.sO=1;a.k1=2;a.i1=3;a.mU=function(a){var c=null;if(c=w.fa(w.yd))c=w.um(c,w.ul)==w.uz||w.um(c,w.ul)==w.Xp?b.GA():b.FA(),q(a,c)};a.iS=function(){return Boolean(w.Du(w.yd))};a.M5=function(){return null};a.reset=function(){var a=w.fa(w.yd);w.ex(a)};a.n4=function(){b.he(null,"HMD_ROTATE_CAMERA");w.cU();var a=D.ke();n?c.k_(a):e?c.SJ(a):z&&c.XZ(a);c.MD(a,
r.nc);var f=l.Lf(a,A);l.ux(a,f)};a.z9=function(a){t.copy(a,C)};a.s6=function(a){t.copy(C,a);return a}};b4w.module.mouse=function(a,g){function q(){1==k&&(k=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);f.he(z.ke(),"SMOOTH_PL")}function c(a){2==k&&(k=0);a.removeEventListener("mousedown",w,!1);a.removeEventListener("mouseup",t,!1);a.removeEventListener("mousemove",b,!1);f.he(z.ke(),"SMOOTH_DRAG")}function b(a){C()&&(H[0]+=2*(a.clientX-A),H[1]+=2*(a.clientY-O),A=a.clientX,O=a.clientY);a.preventDefault()}function w(a){A=
a.clientX;O=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function t(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function D(a,b,c,e){if(.01<Math.abs(H[0])||.01<Math.abs(H[1]))b=f.rd(a,b,0),a=M.Zb(H[0],0,b,.1*F),b=M.Zb(H[1],0,b,.1*F),H[0]-=a,H[1]-=b,e(4E-4*-a,4E-4*-b)}function l(a,b){var c=z.sm(),e=z.ke();p.gk(e,a,b);c&&(e=p.kk(e,I),n.tj(c,e[0],e[1]))}function r(a){a=m.Nq(a.clientX,a.clientY,I);(a=z.Lo(a[0],a[1]))?(z.SC(a)&&z.Wo(a,1),
z.SC(h)&&a!=h&&z.Wo(h,0)):z.SC(h)&&z.Wo(h,0);h=a}var p=g("camera"),m=g("container"),f=g("controls"),n=g("physics"),e=g("print"),z=g("scenes"),M=g("util"),E=g("main"),F=1,A=0,O=0,H=new Float32Array(2),I=new Float32Array(2),C=null,h=null,k=0;a.yY=function(a){var b,d,g,h,m;function n(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",g,!1);var e=z.ke();if(!f.Pl(e,"SMOOTH_PL")){var h=f.eg();f.K(e,"SMOOTH_PL",
f.na,[h],null,D,m)}b()}else a.removeEventListener("mousemove",g,!1),k=0,document.removeEventListener("pointerlockchange",n,!1),document.removeEventListener("webkitpointerlockchange",n,!1),document.removeEventListener("mozpointerlockchange",n,!1),d()}if(1!=k){k=1;b=b||function(){};d=d||function(){};m=m||l;h=h||function(){return!0};g=g||function(a){if(h()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):
"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;H[0]+=b;H[1]+=a}};document.addEventListener("pointerlockchange",n,!1);document.addEventListener("webkitpointerlockchange",n,!1);document.addEventListener("mozpointerlockchange",n,!1);var p=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof p?p.apply(a):e.error("Pointer lock is not available")}};a.K4=q;a.E3=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||
a.mozRequestPointerLock)?!0:!1};a.F8=function(a,b,c){2!=k&&(k=2,q(),C=b||function(){return!0},c=c||l,a.addEventListener("mousedown",w,!1),a.addEventListener("mouseup",t,!1),a=z.ke(),f.Pl(a,"SMOOTH_DRAG")||(b=f.eg(),f.K(a,"SMOOTH_DRAG",f.na,[b],null,D,c)))};a.J4=c;a.B4=function(){E.$e()||m.Xh().addEventListener("mousemove",r)};a.o4=function(){E.$e()||(m.Xh().removeEventListener("mousemove",r),h&&z.Wo(h,0))};a.t5=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in
c[0]?c[0].clientX:-1};a.u5=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.rx=function(a){F=a};a.q6=function(){return F}};b4w.module.screenshooter=function(a,g){var q=g("main");a.BZ=function(){var a,b;a=a||"image/png";q.YR(function(b){var g=window.document.createElement("a");document.body.appendChild(g);g.style.display="none";g.href=b;g.download="screenshot."+a.split("/")[1];g.click();document.body.removeChild(g)},a,b||1)}};b4w.module.animation=function(a,g){var q=g("__animation"),c=g("__armature"),b=g("__obj_util"),w=g("__print"),t=g("__tsr");a.nd=q.nd;a.BF=q.BF;a.CF=q.CF;a.DF=q.DF;a.EF=q.EF;a.FF=q.FF;a.GF=q.GF;a.bu=q.bu;a.xl=q.xl;a.sF=q.sF;a.wz=q.wz;a.xz=q.xz;a.vF=q.vF;a.uF=q.uF;a.tF=q.tF;a.rF=q.rF;a.py=q.py;a.qy=q.qy;a.ry=q.ry;var D=t.create();a.yc=function(a){return q.yc(a)};a.GI=function(a){return q.SK(a)?q.GI(a):[]};a.Jr=function(a){var b;if(!q.yc(a))return null;b=b||q.nd;return q.kV(a,b)};a.apply=function(a,b,
c){if(c>q.bu)w.error("Can't apply animation to slot "+c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||q.nd;if(q.yc(a)){var g=q.Cv(a,b);if(-1!=g&&g!=c){w.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+g+'").');return}}q.SN(a,b)?q.apply(a,null,b,c):w.error('No fcurves in action "'+b+'"')}};a.T2=function(a,b,c){if(c>q.bu)w.error("Can't apply animation to slot "+c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');
else{c=c||q.nd;var g=b[0];if(q.yc(a)){var f=q.Cv(a,g);if(-1!=f&&f!=c){w.error('Animation "'+g+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}q.SN(a,g)?q.apply(a,b.slice(1),g,c):w.error('No fcurves in action "'+g+'"')}};a.remove=function(a){q.remove(a)};a.wL=function(a,b){q.yc(a)&&(b=b||q.nd,q.wL(a,b))};a.qu=function(a){q.qu(a)};a.play=function(a,b,c){q.yc(a)?(c=c||q.nd,q.play(a,b,c),q.U_(a,0,c,!0)):w.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,
b){q.yc(a)&&(b=b||q.nd,q.stop(a,b))};a.Pf=function(a,b){if(!q.yc(a))return!1;b=b||q.nd;return q.Pf(a,b)};a.cn=function(a,b,c){q.yc(a)&&(c=c||q.nd,q.cn(a,b,c))};a.DD=function(a,b){q.yc(a)&&q.DD(a,b)};a.h9=function(a,b){if(q.yc(a)){b=b||q.nd;var c=q.xB(a,b),g=q.sv(a,b);q.cn(a,c+g-q.$O,b)}};a.mo=function(a,b){if(!q.yc(a))return 0;b=b||q.nd;return q.RI(a,b)};a.kM=function(a,b,c){q.yc(a)&&(c=c||q.nd,q.kM(a,b||1,c))};a.tJ=function(a,b){if(!q.yc(a))return 0;b=b||q.nd;return a.ia[b]?q.tJ(a,b):0};a.xB=function(a,
b){return q.yc(a)&&(b=b||q.nd,a.ia[b])?q.xB(a,b):-1};a.sv=function(a,b){return q.yc(a)&&(b=b||q.nd,a.ia[b])?q.sv(a,b):-1};a.bn=function(a,b,c){q.yc(a)&&(c=c||q.nd,q.bn(a,b,c))};a.KI=function(a,b){if(!q.yc(a))return null;b=b||q.nd;return q.KI(a,b)};a.lG=function(a,b,c,g){g=g||q.nd;q.yc(a)&&q.lG(a,b,c,g)};a.sI=function(a){return q.sI(a)};a.i5=function(a,g,p){w.Sb("get_bone_translation","armature.get_bone_tsr");if(!b.Am(a))return null;if(!c.eS(a,g))return w.error('There is no bone: "',g,'" in "',a.name,
'".'),null;p||(p=new Float32Array(3));c.uv(a,g,!1,D);p[0]=D[0];p[1]=D[1];p[2]=D[2];return p};a.F5=function(){w.P("get_first_armature_object() deprecated");return null};a.Cv=function(a,b){return q.yc(a)&&b?q.Cv(a,b):-1};a.HI=function(a,b){return q.yc(a)?q.HI(a,b):null};a.mG=function(a,b){return q.mG(a,b)};a.y6=function(a){return a.k.Mh};a.iM=function(a,c,g){b.Am(a)?(c=Math.min(Math.max(c,0),1),a.k.Mh!=c&&q.iM(a,c,g||0)):w.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.config=function(a,g){var q=g("__config"),c=g("__compat"),b=g("__debug"),w=g("__data"),t=g("__print");a.eq=q.eq;a.wl=q.wl;a.Dn=q.Dn;a.AF=q.AF;a.dq=q.dq;a.set=q.set;a.get=q.get;a.reset=q.reset;a.qD=q.qD;a.z6=q.tv;a.tv=q.tv;a.Ln=function(a){w.ih()?t.error("Cannot change quality profile after a scene is loaded."):(q.set("quality",a),b.wv()&&(q.Ln(),c.bM(b.wv(),!1)))}};b4w.module.npc_ai=function(a,g){function q(a,b){var c=b.destination,f=b.Sz,g=A;n.sd(b.collider,g);var m=0,q=g[2];c[2]=q;switch(b.type){case k:if(b.random&&b.Mk){c[0]=(12*Math.random()-6)*b.speed+f[0];c[1]=-(12*Math.random()-6)*b.speed+f[1];var r=C,f=O,t=b.speed,x=b.rot_speed;n.Lf(b.collider,r);e.transformQuat(M.Re,r,f);f[2]=0;e.normalize(f,f);r=.5*t/Math.sin(x/2);g=e.dist(c,g);g<2*r&&e.scaleAndAdd(c,f,2*r-g,c);b.Mk=!1}b.MB&&(m=b.MB-q,g=b.speed*a,m>g?m=g:m<-g&&(m=-g));b.Gj=m;break;case J:case y:b.Dp?
m=b.Dp:b.Gj&&(m=b.Gj,b.type==y&&(m*=a)),b.random&&b.Mk&&(b.type==y?(b.speed=Math.random()+.1,g=b.qX-b.xX):g=b.max_height-b.min_height,c[0]=10*Math.random()-5+f[0],c[1]=10*Math.random()-5+f[1],c[2]=q-(Math.random()*g-.5*g),b.Mk=!1)}m&&(c[2]=q+m);var c=F,g=A,r=O,m=h,x=b.rig,f=b.collider,q=b.destination,w=b.speed,z=b.actions,E=l.Jr(x);if(!l.Pf(x)||!z.Sr||-1==z.Sr.indexOf(E)){n.sd(f,c);var t=q[0]-c[0],W=q[1]-c[1],t=Math.sqrt(t*t+W*W);if(t>2*w*a)b.state=20,M.SB(q,c,r),z=b.rig,l.yc(z)&&(x=b.speed,w=l.mo(z),
z=l.sv(z),x*=z/24*(1-w/z),.9>t/x&&e.scaleAndAdd(q,r,x-t,q)),t=C,x=H,n.Lf(b.collider,t),e.transformQuat(M.Re,t,g),x[0]=g[0],x[1]=g[1],x[2]=0,e.normalize(x,x),w=e.dot(x,r),z=a/(Math.abs(Math.acos(w))/Math.PI)*b.rot_speed*b.wD,p.rotationTo(x,r,m),p.rotationTo(M.Re,x,t),1<=Math.abs(w)?p.copy(t,m):(p.multiply(m,t,m),p.slerp(t,m,Math.min(z,1),m)),r=a,b.type!=J&&(r=Math.max(r,1/60),t=I,x=C,p.setAxisAngle(M.Gg,-Math.asin(-g[2]),x),p.setAxisAngle(M.Gg,-Math.atan(b.Gj/(b.speed*r)),t),p.slerp(x,t,r,t),p.multiply(m,
t,m)),n.ux(f,m),g=O,f=H,M.ec(m,M.Re,g),e.scale(g,b.speed*a,f),e.add(f,c,f),f[2]=b.type!=k?(q[2]-c[2])*a*.1+c[2]:q[2],n.oM(b.collider,f);else if(b.type==k)z.move?E&&-1!=z.move.indexOf(E)&&l.Pf(x)?b.state=20:(b.state=10,b.Mk=!0):(b.state=10,b.Mk=!0);else if(b.type==y||b.type==J)b.Mk=!0;if(D(b)&&(c=b.rig,!l.Pf(c))){m=null;switch(b.state){case 10:m=b.actions;m=m.Sr?M.Po(m.Sr):null;break;case 20:m=l.Jr(b.rig),g=q=b.actions,g.ij&&-1==g.ij.indexOf(m)&&g.move&&-1!=g.move.indexOf(m)&&.33<Math.random()?(q=
b.actions,m=q.ij[q.move.indexOf(m)]):(g=b.actions,g.move&&(-1!=g.move.indexOf(m)||!g.ij&&!g.xk||!g.xk&&!m||g.ij&&-1!=g.ij.indexOf(m)||g.xk&&-1!=g.xk.indexOf(m))?(q=b.actions,q.ij?(g=q.ij.indexOf(m),-1!=g?(m=g+1,m=m<q.move.length?m:0,m=q.move[m]):m=-1!=q.move.indexOf(m)?m:M.Po(q.move)):m=M.Po(q.move)):(g=b.actions,m=g.xk&&-1==g.xk.indexOf(m)&&g.move&&-1==g.move.indexOf(m)?M.Po(q.xk):null))}m&&(l.apply(c,m),l.bn(c,l.qy),l.cn(c,0),l.play(c))}}}function c(a,b,c,e){if(e)if(1==c)switch(e.type){case J:a:{for(var f=
0;3>f;f++)if(c=r.ae(a,b,f).hit_fract){b=c;break a}b=void 0}f=100*b;e.Gj=f<e.min_height?10:f>e.max_height?-10:0;break;case k:a=r.ae(a,b,0);e.MB=a.hit_pos[2];break;case y:a=r.ae(a,b,0),"CLOSE_GROUND"==b?(e.Gj=100*a.hit_fract-1,e.Gj=.1>e.Gj?.05:0):"CLOSE_WATER"==b&&(e.Dp=100*f,e.Dp=e.Dp<e.xX?-.02:e.Dp>e.qX?.02:0)}else e.Gj=0}function b(){for(var a=0;a<E.length;a++){var b=E[a];w(b);t(b);l.Jr(b.rig)&&l.play(b.rig)}}function w(a){var b=e.create(),f=a.collider;switch(a.type){case J:var g=r.bk(f,b,[0,0,-100],
"TERRAIN",!0,!0),h=r.bk(f,b,[0,0,-100],"STONE",!0,!0),b=r.bk(f,b,[0,0,-100],"WATER",!0,!0),g=[g,h,b];r.K(f,"CLOSE_GROUND",r.na,g,function(a){return a[0]||a[1]||a[2]},c,a);break;case k:g=r.bk(f,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);g=[g];r.K(f,"CLOSE_GROUND",r.na,g,null,c,a);break;case y:g=r.bk(f,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=r.bk(f,b,[0,0,100],"WATER",!0,!0),g=[g],r.K(f,"CLOSE_WATER",r.na,[b],null,c,a),r.K(f,"CLOSE_GROUND",r.na,g,null,c,a)}}function t(a){function b(c,f,g){1==g?(e.copy(a.Sz,a.destination),
a.wD=4):a.wD=1}var c=a.collider;if(a.type==k){var f=r.Ou(c,"CONSTRUCTION",!1);r.K(c,"CONSTRUCTION_COLL",r.na,[f],null,b)}}function D(a){var b=a.rig;if(!l.Pf(b))return!0;b=l.Jr(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.Sr)return!1;if(-1==c.Sr.indexOf(b))break;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.xk&&-1!=c.xk.indexOf(b)||c.ij&&-1!=c.ij.indexOf(b))return!1;break;default:return!1}return!0}var l=g("animation"),r=g("controls"),p=g("quat"),m=g("scenes"),f=g("time"),n=
g("transform"),e=g("vec3"),z=g("print"),M=g("util"),E=[];new Float32Array(9);var F=new Float32Array(3),A=new Float32Array(3),O=new Float32Array(3),H=new Float32Array(3),I=new Float32Array(4),C=new Float32Array(4),h=new Float32Array(4),k=a.t2=10,J=a.r2=20,y=a.s2=30;a.DX=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:k,state:10,actions:{},Sz:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],lv:[],delay:[],random:!0,Mk:!0,MB:0,Gj:0,Dp:0,wD:1,speed:1,rot_speed:.1,
max_height:0,min_height:0};if("object"!=typeof a.obj)z.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)z.error("Can't create event track. Wrong rig object");else if("object"!=typeof a.collider)z.error("Can't create event track. Wrong collider object");else{b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;n.sd(a.collider,b.Sz);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==
typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.lv[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=l.Jr(b.rig),e;for(e in a)for(var f=a[e],g=0;g<f.length;g++)l.apply(b.rig,f[g]);c&&l.apply(b.rig,c);E.push(b)}};a.w4=function(){if(E.length){b();var a=r.eg();r.K(E[0].collider,
"ELAPSED",r.na,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=r.rd(a,b,0),b=0;b<E.length;b++){c=E[b];var d=a;if(m.Hm(c.obj))if(c.random)q(d,c);else{for(var e=f.lk(),g=0;g<c.path.length;g++)if(!c.ended[g]){c.lv[g]||(c.lv[g]=!0,c.destination[0]=c.path[g][0],c.destination[1]=c.path[g][1],c.destination[2]=c.path[g][2],c.start[g]=e+c.delay[g]);if(e<c.start[g])break;q(d,c);c.ended[g]=c.Mk;break}a:{for(d=0;d<c.path.length;d++)if(0==c.ended[d]){d=!1;break a}d=!0}if(d)for(d=0;d<c.path.length;d++)c.lv[d]=
!1,c.ended[d]=!1}}})}};a.j4=function(){if(!(0>=E.length))for(var a=0;a<E.length;a++){var b=E[a];r.qS(b.collider)&&r.he(b.collider);l.Pf(b.rig)&&l.stop(b.rig)}}};b4w.module.time=function(a,g){var q=g("__time");a.vx=q.vx;a.Qn=q.Qn;a.lk=q.lk;a.Oj=q.Oj;a.Pn=q.Pn};b4w.module.app=function(a,g){function q(){var a=y.$r();document.addEventListener("visibilitychange",function(){document.hidden?(a=y.$r(),y.pause()):a||y.qj()},!1)}function c(){var a=0,b=I.Fe(),c=y.$r(),d=!0;y.pq(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=y.$r()),y.pause(),d=!1):c||d||(y.qj(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);f||(B.error('Warning: canvas container "'+a+'" not found, appending to body'),
f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!y.fh(e,a))return c&&E("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
d),!1;a&&I.aw(a,"LAST");return!0}function w(a,b){a?(b&&(document.getElementById(b).style.display="block"),P=document.getElementById(a)):(P=document.createElement("div"),P.innerHTML=0,P.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",I.aw(P,"JUST_AFTER_CANVAS"))}function t(a,b){var c=String(a);b&&(c+="/"+String(b));P.innerHTML=c}function D(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function l(a,b,c){var d=Math.max(A.cW(a),1),e=ba.Lf(a,v);b=K.ec(e,b,W);b[2]=0;G.normalize(b,b);G.scale(b,d*c,b);c=ba.sd(a,ha);G.add(c,b,c);A.Vc(a,c)}function r(a,b){var c=A.QJ(a,Y);if(c.up!=c.down){var d=A.rm(a,Q)[1],c=(c.down-d)/(c.down-c.up),d=A.PJ(a,Y),c=Math.max(c,2/d.max);A.RJ(a,0,c*b)}}function p(a,b,c,d){ba.nh(a,5*b,5*c,5*d)}function m(a,b,c){var d=A.hE(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));ba.nh(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function f(a,b,c,d){for(var e=c*
b;0<a;--a)c+=e,d+=e,e=c*b;return d}function n(a,b,c,d,e){e?(e=A.f_(a,W),a=A.sd(a),a=G.dist(e,a)+d,d=0<b?f(b,-c,a,d):f(-b,c/(1-c),a,d)):d-=2*b*c;return d}function e(a,b,c,e,f){function g(a,b,c,d){if(1==c){A.Zh(a,Y);var e=O?.003*Y.trans:.003*Y.rot;c=C.rd(a,b,0);C.ae(a,b,0).gesture===C.au?(Ia+="X"==d?-c*e:0,kb+="Y"==d?-c*e:0):C.ae(a,b,0).gesture===C.Zt&&(a=O?.003*Y.rot:7.5E-4*Y.trans,eb+="X"==d?-c*a:0,ab+="Y"==d?-c*a:0)}}function h(a){A.Zh(a,Y);$a-=.05*Y.zoom}function k(a){A.Zh(a,Y);Ba-=.002*Y.trans}
function q(a){A.Zh(a,Y);$a+=.05*Y.zoom}function t(a){A.Zh(a,Y);Ba+=.002*Y.trans}function v(a,b,c,d){if(1==c){c=C.rd(a,b,1);A.Zh(a,Y);if(O)e=.003*Y.trans,f=7.5E-4*Y.rot;else var e=.003*Y.rot,f=7.5E-4*Y.trans;if(1===C.ae(a,b,0).which)Ka+="X"==d?-c*e:0,Sa+="Y"==d?-c*e:0;else if(2===C.ae(a,b,0).which||3===C.ae(a,b,0).which)pb+="X"==d?-c*f:0,Ta+="Y"==d?-c*f:0}}function w(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function y(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function B(a){return a[0]&&(a[1]||-.1>a[2])}
function D(a){return a[0]&&(a[1]||.1<a[2])}function E(a){return a[0]&&(a[1]||a[2]||a[3])}function I(a,b,c){if(1==c)switch(c=C.rd(a,b,0),A.Zh(a,Y),b){case "FORWARD":M?wa[0]=1:O?(b=A.rm(a,Q)[1],b=Math.abs(b)>=Math.PI/4?K.Eh:K.Mc,l(a,b,.5*Y.trans*c)):P?m(a,-Y.zoom,c):p(a,0,0,-Y.trans*c);break;case "BACKWARD":M?wa[0]=-1:O?(b=A.rm(a,Q)[1],b=Math.abs(b)>=Math.PI/4?K.Re:K.nc,l(a,b,.5*Y.trans*c)):P?m(a,Y.zoom,c):p(a,0,0,Y.trans*c);break;case "UP":O?r(a,30*-Y.zoom*c):M||p(a,0,Y.trans*c,0);break;case "DOWN":O?
r(a,30*Y.zoom*c):M||p(a,0,-Y.trans*c,0);break;case "LEFT":M?wa[1]=1:O?l(a,K.wy,.5*Y.trans*c):p(a,-Y.trans*c,0,0);break;case "RIGHT":M?wa[1]=-1:O?l(a,K.Gg,.5*Y.trans*c):p(a,Y.trans*c,0,0);break;case "ROT_LEFT":P?A.ft(a,.75*-Y.rot*c,0):A.gk(a,.75*Y.rot*c,0);break;case "ROT_RIGHT":P?A.ft(a,.75*Y.rot*c,0):A.gk(a,.75*-Y.rot*c,0);break;case "ROT_UP":P?A.ft(a,0,.75*-Y.rot*c):A.gk(a,0,.75*Y.rot*c);break;case "ROT_DOWN":P?A.ft(a,0,.75*Y.rot*c):A.gk(a,0,.75*-Y.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":M&&
(wa[0]=0);break;case "LEFT":case "RIGHT":M&&(wa[1]=0)}M&&(d.Uk(M,wa[0],wa[1]),a=A.kk(a,ca),d.tj(M,a[0],a[1]))}X=a;x=b;ka=c;var F=u.ke();z(F);var P=!1,M=null,O=!1;switch(A.tm(F)){case A.Kb:P=!a;break;case A.md:M=u.sm();break;case A.Jg:return;case A.ad:O=!0}var Y=A.Zh(F,Z);a=C.eg();if(d.QB(F)){var ma=C.Ou(F,null,!0);C.K(F,"CAMERA_COLLISION",C.yf,[ma],null,function(a,b){var c=C.ae(a,b,0).coll_dist;if(0>c){var d=C.ae(a,b,0).coll_norm,e=W;G.scale(d,-.25*c,e);c=ba.sd(a,ha);G.add(c,e,c);ba.oM(a,c)}})}if(M){var ma=
ba.sd(F),Ea=ba.Lf(F),Ea=K.jA(Ea);ma[2]-=.5;d.Us(M,ma,Ea);H.jG(F,M,[0,0,.5]);var wa=new Float32Array(2),Qa=!0;d.mi(M,d.yy);C.Sn(F,"TOGGLE_CHAR_MOVE_TYPE",C.Od,C.bF,function(){Qa=!Qa;d.mi(M,Qa?d.yy:d.zy)})}var Ja=J.cH(),ma=Ja.length?Ja[Ja.length-1]:0,Ma,R,aa,ja,Bb,Fa,Dc,Ra,fa,Da;b?Ma=R=aa=ja=Bb=Fa=b=ma=Dc=Ra=fa=Da=C.DA(0):(Ma=C.Gb(C.Wt),R=C.Gb(C.Vt),aa=C.Gb(C.Tt),ja=C.Gb(C.Ut),Bb=C.Gb(C.WO),Fa=C.Gb(C.SO),b=C.cr(J.Ot,ma),ma=C.cr(J.Wp,ma),Dc=C.Gb(C.iF),Ra=C.Gb(C.cF),fa=C.Gb(C.dF),Da=C.Gb(C.fF));var Ea=
C.Oi(J.Rp,Ja),ra=C.Oi(J.Sp,Ja),U=C.Oi(J.Tp,Ja),Ja=C.Oi(J.Up,Ja);O||(C.K(F,"FORWARD",C.na,[a,Ma,ra],B,I),C.K(F,"BACKWARD",C.na,[a,R,ra],D,I));P?(C.K(F,"ROT_UP",C.na,[a,Dc,Bb,Ja],w,I),C.K(F,"ROT_DOWN",C.na,[a,Ra,Fa,Ja],y,I),C.K(F,"ROT_LEFT",C.na,[a,fa,aa,U],w,I),C.K(F,"ROT_RIGHT",C.na,[a,Da,ja,U],y,I)):O?(C.K(F,"LEFT",C.na,[a,fa,aa,Ea],w,I),C.K(F,"RIGHT",C.na,[a,Da,ja,Ea],y,I),C.K(F,"FORWARD",C.na,[a,Dc,Ma,ra],w,I),C.K(F,"BACKWARD",C.na,[a,Ra,R,ra],y,I),C.K(F,"UP",C.na,[a,Fa,Ja],D,I),C.K(F,"DOWN",C.na,
[a,Bb,Ja],B,I)):(C.K(F,"UP",C.na,[a,Bb,b],E,I),C.K(F,"DOWN",C.na,[a,Fa,ma],E,I),C.K(F,"LEFT",C.na,[a,aa,Ea],B,I),C.K(F,"RIGHT",C.na,[a,ja,Ea],D,I),C.K(F,"ROT_UP",C.na,[a,Dc,Ja],B,I),C.K(F,"ROT_DOWN",C.na,[a,Ra,Ja],D,I),C.K(F,"ROT_LEFT",C.na,[a,fa,U],B,I),C.K(F,"ROT_RIGHT",C.na,[a,Da,U],D,I));if(!c){var Pa=0;c=C.IA(e);var sa=0,Ja=C.QA(e);C.K(F,"MOUSE_WHEEL",C.Lp,[c],null,function(a,b,c){1==c&&(b=C.rd(a,b,0),A.Zh(a,Y),P||O?Pa=n(a,b,Y.zoom,Pa,P):(Y.trans*=1+b*Y.zoom,A.pZ(a,Y)))});C.K(F,"TOUCH_ZOOM",
C.Lp,[Ja],null,function(a,b,c){1==c&&(c=C.rd(a,b,0),A.Zh(a,Y),C.ae(a,b,0)===C.$t&&(sa=n(a,c,.03*Y.zoom,sa,P)))});C.K(F,"ZOOM_INTERPOL",C.yf,[a],null,function(a,b){if(P||O)if(1E-5<Math.abs(Pa)||1E-5<Math.abs(sa)){var c=C.rd(a,b,0),d=K.Zb(Pa,0,c,.1*T);Pa-=d;c=K.Zb(sa,0,c,.15*T);sa-=c;O?r(a,-(d+c)):(d=A.hE(a)+d+c,d=Math.max(d,.001),A.h_(a,d))}else sa=Pa=0})}var Ka=0,Sa=0,pb=0,Ta=0,Ba=0,$a=0;P?(C.K(F,"GMPD_PAN_Y_POS",C.na,[b],null,q),C.K(F,"GMPD_PAN_Y_NEG",C.na,[ma],null,h),C.K(F,"GMPD_PAN_X_POS",C.na,
[Ea],function(a){return-.1>a[0]},k),C.K(F,"GMPD_PAN_X_NEG",C.na,[Ea],function(a){return.1<a[0]},t)):O&&(C.K(F,"GMPD_PAN_X_POS",C.na,[U],function(a){return-.1>a[0]},k),C.K(F,"GMPD_PAN_X_NEG",C.na,[U],function(a){return.1<a[0]},t));if(f){f=C.Wl("X",window);c=C.Wl("Y",window);b=C.Tn(e);var ma=C.Tn(window),Xa=!1,Ea=function(a){a[2]?Xa=!0:a[0]||(Xa=!1);return Xa&&a[0]};C.K(F,"MOUSE_X",C.yf,[ma,f,b],Ea,v,"X");C.K(F,"MOUSE_Y",C.yf,[ma,c,b],Ea,v,"Y");f=J.fa(J.$c,window);J.fE(f,!1)}else f=C.Wl("X",e),c=C.Wl("Y",
e),b=C.Tn(e),C.K(F,"MOUSE_X",C.yf,[b,f],null,v,"X"),C.K(F,"MOUSE_Y",C.yf,[b,c],null,v,"Y");var Ia=0,kb=0,eb=0,ab=0;f=C.fr("X",e);e=C.fr("Y",e);C.K(F,"TOUCH_X",C.yf,[f],null,g,"X");C.K(F,"TOUCH_Y",C.yf,[e],null,g,"Y");C.K(F,"ROT_TRANS_INTERPOL",C.yf,[a],null,function(a,b){if(1E-5<Math.abs(Ka)||1E-5<Math.abs(Sa)||1E-5<Math.abs(Ia)||1E-5<Math.abs(kb)||1E-5<Math.abs(pb)||1E-5<Math.abs(Ta)||1E-5<Math.abs(eb)||1E-5<Math.abs(ab)||1E-5<Math.abs(Ba)||1E-5<Math.abs($a)){var c=C.rd(a,b,0),e=K.Zb(Ka,0,c,.08*
T),f=K.Zb(Sa,0,c,.08*T);Ka-=e;Sa-=f;var g=K.Zb(Ia,0,c,.12*T),h=K.Zb(kb,0,c,.12*T);Ia-=g;kb-=h;var k=K.Zb(pb,0,c,.08*T),m=K.Zb(Ta,0,c,.08*T);pb-=k;Ta-=m;var n=K.Zb(eb,0,c,.12*T),p=K.Zb(ab,0,c,.12*T);eb-=n;ab-=p;var q=K.Zb(Ba,0,c,.08*T),c=K.Zb($a,0,c,.08*T);Ba-=q;$a-=c;P?(A.ft(a,e+g,f+h),f=A.hE(a),A.g_(a,f*(k+n+q),f*(m+p+c))):O?(e+g&&l(a,K.Gg,.2*(e+g)),f+h&&(m=A.rm(a,Q)[1],l(a,Math.abs(m)>Math.PI/4?K.Re:K.nc,.2*(f+h))),A.RJ(a,k+n+q,0)):(A.gk(a,.5*(e+g),.5*(f+h)),M&&(k=A.kk(a,ca),d.tj(M,k[0],k[1])))}});
C.Sn(F,"DEC_STEREO_DIST",C.Od,C.VO,function(a){var b=A.vJ(a);A.mM(a,.9*b)});C.Sn(F,"INC_STEREO_DIST",C.Od,C.XO,function(a){var b=A.vJ(a);A.mM(a,1.1*b)})}function z(a){var b=A.tm(a),c=C.CA(function(){var c=A.tm(a),d=c!=b;b=c;return d});C.K(a,"CHANGE_MOVE_STYLE",C.yf,[c],null,function(){M();e(X,x,ka)})}function M(){var a=u.ke();C.Pl(a,"TOGGLE_CHAR_MOVE_TYPE")&&u.sm()&&H.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)C.he(a,b[c])}function E(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function F(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&y.lY(f)}var g=performance.now();y.pq(f)}g("animation");var A=g("camera"),O=g("config"),H=g("constraints"),I=g("container"),C=g("controls"),h=g("data"),k=g("debug"),J=g("input"),y=g("main"),d=g("physics"),B=g("print"),u=g("scenes"),ba=g("transform"),K=g("util"),G=g("vec3"),T=1,P=null,X=!1,x=!1,ka=
!1,ca=new Float32Array(2),Q=new Float32Array(2),W=new Float32Array(3),ha=new Float32Array(3);new Float32Array(3);var v=new Float32Array(4),Z={},Y={};a.fh=function(a){function d(){var a=b(l,J,G,m),e=I.Xh();if(a){var h=I.Fe();I.Pk();A&&(w(n,r),y.VY(t));x&&(q(),c());p&&y.pq(function(){h.style.height=h.clientWidth/p+"px"});g&&y.pq(function(){I.Pk()});E&&y.pq(function(){I.sB()});v&&O.qD();F==O.dq?k.iN(function(a,b){0==a?(B.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),O.Ln(O.wl)):1.5>b?(B.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),O.Ln(O.eq)):(B.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),O.Ln(O.wl));f(e,!0)}):f(e,!0)}else f(e,!1)}function e(a){a.keyCode==C.eF&&(y.$r()?y.qj():y.pause())}function f(){}a=a||{};var g=!1,l=null,m=null,n=null,p=0,r=null,u=!0,v=!1,x=!0,G=!0,z=!1,A=!1,D=!1,E=!1,F=O.get("quality"),H;for(H in a)switch(H){case "canvas_container_id":l=a.canvas_container_id;break;case "callback":f=a.callback;break;case "autoresize":g=a.autoresize;break;case "show_hud_debug_info":D=a.show_hud_debug_info;
break;case "sfx_mix_mode":z=a.sfx_mix_mode;break;case "show_fps":A=a.show_fps;break;case "track_container_position":E=a.track_container_position;break;case "fps_wrapper_id":r=a.fps_wrapper_id;break;case "fps_elem_id":n=a.fps_elem_id;break;case "error_purge_elements":m=a.error_purge_elements;break;case "report_init_failure":G=a.report_init_failure;break;case "pause_invisible":x=a.pause_invisible;break;case "key_pause_enabled":u=a.key_pause_enabled;break;case "force_container_ratio":p=a.force_container_ratio;
break;case "min_capabilities":v=a.min_capabilities;break;case "quality":F=a.quality;break;default:O.set(H,a[H])}F!=O.dq&&O.set("quality",F);u&&document.addEventListener("keydown",e,!1);O.set("show_hud_debug_info",D);O.set("sfx_mix_mode",z);var J=D||z||null;"complete"==document.readyState?window.setTimeout(d,0):window.addEventListener("load",d,!1);window.addEventListener("unload",function(){h.ua()},!1)};a.Pk=function(){B.Sb("app.resize_to_container","container.resize_to_container");I.Pk()};a.q9=function(a,
b){var c=D(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.p9=function(a,b){var c=D(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.r9=function(a,b){var c=D(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.x4=e;a.k4=M;a.T8=function(a){B.Vh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=u.ke();A.HD(b,a)};a.C4=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,f){if(1==f)switch(f=C.rd(a,b,0),b){case "FORWARD":e?d.Cp(a,1):ba.nh(a,0,-1*f,0);break;case "BACKWARD":e?d.Cp(a,-1):ba.nh(a,0,1*f,0);break;case "LEFT":e?d.Bp(a,-1):ba.nh(a,1*f,0,0);break;case "RIGHT":e?d.Bp(a,1):ba.nh(a,-1*f,0,0)}else switch(b){case "FORWARD":case "BACKWARD":e&&d.Cp(a,0);break;case "LEFT":case "RIGHT":e&&d.Bp(a,0)}}var e=d.ff(a)||d.gf(a),f=C.eg(),g=C.Gb(C.Wt),h=C.Gb(C.Vt),k=C.Gb(C.Tt),l=C.Gb(C.Ut),m=C.Gb(C.iF),n=C.Gb(C.cF),p=C.Gb(C.dF),q=C.Gb(C.fF);C.K(a,
"FORWARD",C.na,[f,g,m],b,c);C.K(a,"BACKWARD",C.na,[f,h,n],b,c);C.K(a,"LEFT",C.na,[f,k,p],b,c);C.K(a,"RIGHT",C.na,[f,l,q],b,c)};a.p4=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)C.he(a,b[c])};a.y4=function(){B.P("app.enable_controls() deprecated")};a.l4=function(){B.P("app.disable_controls() deprecated")};a.z4=function(){C.Sn(null,"CAMERA_SHOT",C.Od,C.TO,function(){k.iX()});C.Sn(null,"LIGHT_SHOT",C.Od,C.UO,function(){k.lX()});C.Sn(null,"TELEMETRY",C.Od,C.YO,function(){k.$C()})};
a.E8=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",
d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():B.error("B4W App: request fullscreen method is not supported")};a.I4=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&B.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.x3=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.D8=E;a.G6=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=
e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.PT=function(a,b,c,d,e,f,g,h){function k(e){a&&(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;F(a,c,d,e,k)}};a.sR=function(a,b,c,d,e,f){function g(e){a&&
(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},F(a,c,d,e,g))};a.gY=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.gY(b)};"css"==c.type?a.PT(d,e,f,g,h,k,l,m):"attr"==c.type&&a.sR(d,e,f,g,h,m)}};a.U8=function(a){T=a};a.l5=function(){return T}};b4w.module.data=function(a,g){var q=g("__data"),c=g("__loader");g("__print");a.load=q.load;a.Xx=function(a){q.Xx(a|0)};a.SL=q.SL;a.ih=q.ih;a.A7=c.Bm;a.M7=q.load;a.ua=a.Xx;a.aG=q.aG;a.fL=q.fL;a.yN=q.yN};b4w.module.debug=function(a,g){function q(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;F.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.tB.ALL_OPS-a.tB.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.tB,e=c.B0,f=w(c.NT),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";F.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);F.groupCollapsed("directives");for(var g=c.hb.Si.slice().sort(),f=0;f<g.length;f++){var h=g[f];F.ce(h[0],h[1])}F.groupEnd();F.groupCollapsed("node elements");g=c.hb.ug;for(f=0;f<g.length;f++)F.ce(g[f]);F.groupEnd();F.groupCollapsed("vert source");F.ce(c.z0);F.groupEnd();F.groupCollapsed("vert translated source");F.ce(c.A0);F.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];F.groupCollapsed("vert ops stats");for(var k in e)-1==f.indexOf(k)&&F.ce(k,e[k]);
F.groupEnd();F.groupCollapsed("vert assembly");F.ce(c.y0);F.groupEnd();F.groupCollapsed("frag source");F.ce(c.WU);F.groupEnd();F.groupCollapsed("frag translated source");F.ce(c.XU);F.groupEnd();F.groupCollapsed("frag ops stats");for(k in d)-1==f.indexOf(k)&&F.ce(k,d[k]);F.groupEnd();F.groupCollapsed("frag assembly");F.ce(c.NU);F.groupEnd();F.groupEnd()}}function w(a){for(var b=[],c=O.Ir(),d=0;d<c.length;d++)for(var e=c[d],f=z.Ub(e,"MESH",z.oc),g=0;g<f.length;g++){var h=M.ja(f[g],e);if(h&&h.X.length)for(var h=
h.X,k=0;k<h.length;k++){var l=h[k];if(l.zb==a)for(var m=0;m<l.td.length;m++){var n=l.td[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function t(a,b){function c(){B.push(c);u=b;return a.apply(a,arguments)}return c}function D(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var l=g("__config"),r=g("__compat"),p=g("__controls"),m=g("__container"),
f=g("__debug"),n=g("__extensions"),e=g("__loader"),z=g("__objects"),M=g("__obj_util"),E=g("__physics"),F=g("__print"),A=g("__renderer"),O=g("__scenes"),H=g("__scenegraph"),I=g("__sfx"),C=g("__shaders"),h=g("__subscene"),k=g("__textures"),J=g("__util"),y=g("__vec3"),d=l.B,B=[],u="",ba=!0,K=new Float32Array(2);a.Gt=f.Gt;a.My=f.My;a.Ht=f.Ht;a.Ly=f.Ly;a.Ft=f.Ft;a.Ky=f.Ky;a.Jy=f.Jy;a.Pp=f.Pp;a.p8=function(){E.WT()};a.o8=function(a){F.log("O",E.JU(a));for(var b=E.iV().Ac.sa,c=0;c<b.length;c++){var d=b[c];
d.C.ea==a&&F.log("B",d)}};a.M$=function(){for(var a=O.A(),b=z.Ub(a,"MESH",z.oc),a=[O.La(a,h.Pb),O.La(a,h.Oc),O.La(a,h.je)],c=0;c<a.length;c++){var d=a[c],e=subs.Qa;if(e.length){F.group(d.type,"DYNAMIC");for(var f=0;f<b.length;f++){var g=b[f],k=g.k;if("DYNAMIC"==k.type)for(var l=!1,m=0;m<e.length;m++){for(var n=e[m].sa,p=0;p<n.length;p++){var q=n[p];if(q.dc&&q.kf==k){F.ce(g.name,g);l=!0;break}}if(l)break}}F.groupEnd();F.groupCollapsed(d.type,"STATIC");for(f=0;f<b.length;f++)if(g=b[f],k=g.k,"DYNAMIC"!=
k.type)for(l=!1,m=0;m<e.length;m++){n=e[m].sa;for(p=0;p<n.length;p++)if(q=n[p],q.dc&&q.kf==k){F.ce(g.name,g);l=!0;break}if(l)break}F.groupEnd()}}};a.i8=function(a){for(var b=O.A(),c=z.Ub(b,"MESH",z.oc),d=0;d<c.length;d++){var e=c[d];if(e.name==a){F.log("Object",e);for(var f=O.wB(b),g=0;g<f.length;g++){for(var h=f[g],k=[],l=h.Qa,m=0;m<l.length;m++)for(var n=l[m].sa,p=0;p<n.length;p++)n[p].kf==e.k&&k.push(n[p]);F.log("Subscene "+h.type,k)}}}};a.j8=function(){var a=O.A();console.log("Armatures: "+z.Ub(a,
"ARMATURE",z.oc).length);console.log("Cameras: "+z.Ub(a,"CAMERA",z.oc).length);console.log("Curves: "+z.Ub(a,"CURVE",z.oc).length);console.log("Empties: "+z.Ub(a,"EMPTY",z.oc).length);console.log("Lamps: "+z.Ub(a,"LAMP",z.oc).length);console.log("Meshes: "+z.Ub(a,"MESH",z.oc).length);console.log("Speakers: "+z.Ub(a,"SPEAKER",z.oc).length)};a.rs=function(){for(var a=0,b=O.A(),b=[O.La(b,h.Pb),O.La(b,h.Oc),O.La(b,h.je)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=
d[e].sa,g=0;g<f.length;g++){var k=f[g].za;k&&(a+=k.rs)}}return a};a.Pm=function(){for(var a=0,b=O.A(),b=[O.La(b,h.Pb),O.La(b,h.Oc),O.La(b,h.je)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].sa,g=0;g<f.length;g++){var k=f[g].za;k&&(a+=k.Pm)}}return a};a.b8=function(){for(var a=O.A(),b=O.$D(a,[h.Pb,h.Oc,h.je,h.Pd,h.Af]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Qa,f=0;f<e.length;f++)c+=e[f].sa.length;a=O.$D(a,[h.ld,h.Se]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Qa,
f=0;f<e.length;f++)c+=6*e[f].sa.length;return c};a.e8=function(){return J.Kr(C.QI())};a.g5=function(){for(var a=O.A(),b=O.wB(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=h.Gn&&d.type!=h.zf)for(var e=d.Qa,f=0;f<e.length;f++)for(var g=e[f].sa,k=0;k<g.length;k++){var l=g[k].za,m=g[k].kf;l&&(d.type!=h.xf&&d.type!=h.Kg||m.Lw||m.Kw)&&(a[l.id]=l)}}var c=b=0,n;for(n in a)d=a[n].Ca,d.Vn&&(c+=d.Vn/1048576),b+=d.Xn/1048576;return{vbo_memory:b,ibo_memory:c}};a.f8=function(){for(var a=[],b=0,c=O.A(),c=[O.La(c,
h.Pb),O.La(c,h.Oc),O.La(c,h.je)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=e[f].sa,k=0;k<g.length;k++){var l=g[k].za;if(l)for(var l=l.ya,m=0;m<l.length;m++){var n=l[m];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var p=n.rb;-1===a.indexOf(p)&&(a.push(p),n=n.width*n.height*4/1048576/n.$q,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.d8=function(){for(var a=[],b=0,c=O.A(),c=O.wB(c),d=0;d<c.length;d++){var e=c[d];if(e.type!=h.Gn){var f=e.p,g=[f.wc,
f.Ze];g.push.apply(g,e.ti);for(e=0;e<g.length;e++){var l=g[e];k.wo(l)&&-1==a.indexOf(l)&&(a.push(l),b+=f.width*f.height*k.PV(l))}}}return{number:a.length,memory:b/1024/1024}};a.iX=function(){var a=O.A();(a=O.La(a,h.Pb))&&O.wK(a.p,a,[1,1,0])};a.lX=function(){var a=O.A(),b=O.La(a,h.Pb),a=O.$D(a,[h.bd]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}O.wK(d.p,b,e)}};a.O8=function(){for(var a=O.Ir(),b=0;b<a.length;b++)F.log("\n"+
H.TT(O.DB(a[b])))};a.P8=function(){};a.O7=function(){F.log("\n"+e.UV())};a.S3=p.debug;a.h8=function(a,b){return y.dist(m_tsr.G(a.k.n),m_tsr.G(b.k.n))};a.EK=f.EK;a.jv=f.jv;a.jL=f.jL;a.$C=f.$C;a.S4=function(a,b){function c(){f.jv("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.c3=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,
0,-1]);if(!J.Wj(a,J.IF))throw"Wrong VEC3_IDENT";if(!J.Wj(b,J.En))throw"Wrong QUAT4_IDENT";if(!J.Wj(c,J.Gg))throw"Wrong AXIS_X";if(!J.Wj(d,J.Eh))throw"Wrong AXIS_Y";if(!J.Wj(e,J.nc))throw"Wrong AXIS_Z";if(!J.Wj(f,J.wy))throw"Wrong AXIS_MX";if(!J.Wj(g,J.Re))throw"Wrong AXIS_MY";if(!J.Wj(h,J.Mc))throw"Wrong AXIS_MZ";};a.Y7=function(){for(var a=I.NV(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==I.IB(c)&&I.qc(c,!0)}};a.dH=function(a){f.dH(a)};a.b9=function(a){var b=O.A();if(b=O.La(b,h.zf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case f.Gt:case f.My:case f.Ht:case f.Ly:case f.Ft:case f.Ky:case f.Jy:case f.Pp:O.QY(b,a.debug_view_mode);break;default:F.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&O.PY(b,a.debug_colors_seed);"number"==typeof a.sY&&O.kZ(b,a.sY);"object"==typeof a.wireframe_edge_color&&O.uZ(b,J.Hf(a.wireframe_edge_color))}else F.error("Debugging is not available on the scene.")};a.A5=function(){return F.tV()};a.T6=function(){return F.SV()};
a.pH=function(){return F.pH()};a.F2=function(a){var d=C.QI(),e=0,g;for(g in d)a&&-1===g.indexOf(a)||e++;var e="of "+e+" analyzing...",h={};for(g in d)if(!a||-1!==g.indexOf(a)){var k=d[g],l;var m=k.iy;l=k.pv;var p=n.qV();if(p){var t=p.getTranslatedShaderSource(m),p=p.getTranslatedShaderSource(l);if(r.$e())var t=t.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),u=c("/analyze_shader/vert_gles",t),w=c("/analyze_shader/frag_gles",p);else t=t.replace("#version","#version 400 //"),
p=p.replace("#version","#version 400 //"),u=c("/analyze_shader/vert",t),w=c("/analyze_shader/frag",p);var y=q(u),z=q(w);l={z0:f.wv().getShaderSource(m),A0:t,y0:u,B0:y,WU:f.wv().getShaderSource(l),XU:p,NU:w,tB:z}}else F.error("WEBGL_debug_shaders extension not found"),l=void 0;t=k.hb;m=t.Eg+" + "+t.bf;l.NT=k;l.hb=t;k=h[m]=h[m]||[];k.push(l);F.ce(e)}for(m in h)F.group("%c"+m,"color: #800"),k=h[m],b(k),F.groupEnd()};a.mI=f.mI;a.iN=function(b){if(C.iH())if(n.BB()){var c=d.gl_debug;d.gl_debug=!0;var e=
H.eT();O.zI(null,e);for(var g=H.ic(e,h.cq),k=g.p,e=0;5>e;e++)A.ao(g);d.gl_debug=c;window.setTimeout(function(){f.eY(g);var a=g.Ff;b(a,k.width*k.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.iN(b)},100)};a.QG=f.QG;a.AM=f.AM;a.iL=f.iL;a.Y9=function(a){B=[];ba=!0;a=g(a);for(var b in a)"function"===typeof a[b]&&(a[b]=t(a[b],b))};a.w3=function(){return ba};a.test=function(a,b){try{return b(),!0}catch(c){return ba=!1,console.error(a+" test was failed. ",c),!1}};
a.r8=function(a){var b=m.BJ(),c=m.AJ(),d=b/2,e=c/2;m.resize(b,c,!1);b=O.A().s.Wa;(c=H.KU(b))||J.q("Couldn't find onscreen subscene");b=c.p;d=m.Eu(d,e,K,c.p);d[1]=b.height-d[1];d=A.jD(b.df,d[0],d[1]);D(a,d,1)};a.F4=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+u;};a.G4=D;a.E4=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.D4=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
g(a);for(var b in a)-1==B.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.k8=function(a){if(!Boolean(a))throw"Wrong result. Function: "+u;}};b4w.module.preloader=function(a,g){var q=g("container"),c,b,w,t,D,l,r,p,m=null;a.Y3=function(a){var g="#000",e="#5276cf",l="#fff",m="#fff",p;for(p in a)switch(p){case "container_color":g=a.container_color;break;case "bar_color":e=a.bar_color;break;case "frame_color":l=a.frame_color;break;case "font_color":m=a.font_color}a=document.createElement("div");p=a.cloneNode();var r=a.cloneNode(),A=a.cloneNode(),D=q.Fe();r.appendChild(p);r.appendChild(A);a.appendChild(r);D.appendChild(a);a.style.cssText="background-color: "+
g+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+l+";";p.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+e+";height: 100%;";A.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+m+";";c=p;b=A;w=a;t="DEFAULT"};
a.b4=function(a){var g=null,e=null,l="#bf9221",p="#000",q;for(q in a)switch(q){case "canvas_container_id":g=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":p=a.bg_color;break;case "bar_color":l=a.bar_color}a=document.createElement("div");q=document.createElement("div");a.id="simple_preloader_container";var r=document.createElement("div"),A=document.createElement("div"),e=document.getElementById(e);m=document.getElementById(g);a.style.cssText=
"z-index: 4;background-color: "+p+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";q.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";r.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+l+";border-radius: 0px;";A.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
q.appendChild(r);q.appendChild(A);a.appendChild(q);document.body.appendChild(a);t="SIMPLE";w=a;c=r;b=A;D=e};a.Z3=function(a){var c=null,e=null,g="rgba(0,0,0,0)",p="",q="",r="rgba(0,0,0,0)",A;for(A in a)switch(A){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "frame_bg_color":g=a.frame_bg_color;break;case "bg_color":r=a.bg_color;break;case "frame_class":p=a.frame_class;break;case "anim_elem_class":q=a.anim_elem_class}a=
document.createElement("div");A=document.createElement("div");var O=document.createElement("div"),H=document.createElement("div"),e=document.getElementById(e);m=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+r+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";A.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+g+";";O.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";
H.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";O.className=q;A.appendChild(O);A.className=p;A.appendChild(H);a.appendChild(A);m.appendChild(a);t="ROTATION";w=a;l=O;b=H;D=e};a.W3=function(a){var g=a.preloader_width,g=g/(g-a.img_width),e=document.getElementById(a.preloader_bar_id),l=document.getElementById(a.fill_band_id),q=document.getElementById(a.preloader_caption_id),E=document.getElementById(a.preloader_container_id),
F=document.getElementById(a.background_container_id);m=document.getElementById(a.canvas_container_id);t="ADVANCED";c=e;r=l;p=g;b=q;w=E;D=F};a.E$=function(a){b.innerHTML=a+"%";"SIMPLE"==t?c.style.width=a+"%":"ADVANCED"==t?(c.style.width=a/p+"%",r.style.width=100-a+"%"):"ROTATION"==t?l.style.transform="rotate("+a+"deg)":"DEFAULT"==t&&(c.style.width=a+"%");100==a&&(w.parentNode.removeChild(w),D&&D.parentNode.removeChild(D))}};"object"==typeof module&&module.mB&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,g){g("__print");var q=g("__version");a.version=q.version;a.HE=q.HE;a.type=q.type;a.VH=q.VH;a.XA=q.XA};"object"==typeof module&&module.mB&&b4w.module.version(exports);if(b4w.module_check("game_options"))throw"Failed to register module: system";b4w.register("game_options",function(a){a.$G={nO:[0,-.2,.85],mO:[0,5,3]}});if(b4w.module_check("environment"))throw"Failed to register module: environment";b4w.register("environment",function(a,g){g("particles");g("scenes");var q=g("lights");a.hW=function(){q.OY()}});if(b4w.module_check("character"))throw"Failed to register module: character";
b4w.register("character",function(a,g){function q(){var a=D.Xh();a.addEventListener("mouseup",function(){l.yY(a)},!1);e.fG(F.iA,F.On[F.VA])}function c(){var a=w.Gb(w.ZO),b=w.Gb(w.eF),c=w.Gb(w.RO);w.eg();w.K(F.mf,"CHANGE_CAMERA",w.Od,[a,t.Vp],function(a){return a[0]||a[1]},function(a,b,c){1==c&&(a=F.VA+1,1<a&&(a=0),F.VA=a,z.Lf(F.mf,H),e.remove(F.iA),e.fG(F.iA,F.On[a]))});w.K(F.mf,"PAUSE",w.Od,[b,t.Mt],function(a){return a[0]||a[1]},function(a,b,c){1==c&&p.pause()});w.K(F.mf,"PAUSE",w.Od,[c,t.Nt,A[4]],
function(a){return(a[0]||a[1])&&a[2]},function(a,b,c){1==c&&(m.BZ(),console.log("Patata"))})}function b(){function a(b,c,d){if(1==d)switch(c){case "FORWARD":m=1;break;case "BACKWARD":m=-1;break;case "LEFT":l=1;break;case "RIGHT":l=-1;break;case "RUNNING":M.mi(b,M.UE)}else switch(c){case "FORWARD":case "BACKWARD":m=0;break;case "LEFT":case "RIGHT":l=0;break;case "RUNNING":M.mi(b,M.zy)}M.Uk(b,m,l)}var b=w.Gb(w.Tt),c=w.Gb(w.Vt),e=w.Gb(w.Ut),f=w.Gb(w.Wt),g=w.Gb(w.hF),d=w.Gb(w.gF),l=0,m=0;A=b=[f,c,b,e,
d];w.K(F.mf,"FORWARD",w.Hg,b,function(a){return a[0]},a);w.K(F.mf,"BACKWARD",w.Hg,b,function(a){return a[1]},a);w.K(F.mf,"LEFT",w.Hg,b,function(a){return a[2]},a);w.K(F.mf,"RIGHT",w.Hg,b,function(a){return a[3]},a);w.K(F.mf,"RUNNING",w.Hg,b,function(a){return(a[0]||a[1]||a[2]||a[3])&&a[4]},a);w.K(F.mf,"JUMP",w.Od,[g],null,function(a){M.Gu(a)})}g("fps");var w=g("controls"),t=g("input"),D=g("container"),l=g("mouse"),r=g("scenes"),p=g("main"),m=g("screenshooter"),f=g("game_options"),n=g("objects_manager"),
e=g("constraints"),z=g("transform"),M=g("physics"),E=g("animation");g("vec3");var F,A,O=new Float32Array(3);new Float32Array(3);var H=new Float32Array(4);a.q3=F;a.gW=function(){F={mf:r.Kf("GroupCharacterJim","Character"),rig:r.Kf("GroupCharacterJim","metarig"),yX:r.Kf("GroupCharacterJim","CharModel"),iA:r.ke(),VA:0,On:[r.Kf("GroupCharacterJim","EmptyHeadCam"),r.Kf("GroupCharacterJim","Empty3rdPersonCam")],type:"character"};O=f.$G.nO;e.remove(F.On[0]);e.hG(F.On[0],F.mf,O);O=f.$G.mO;e.remove(F.On[1]);
e.hG(F.On[1],F.mf,O);q();b();c();n.LM(F.mf,"EmptySpawner1");E.apply(F.rig,"GroupCharacterJim_proxyAction_B4W_BAKED");E.bn(F.rig,E.py);E.play(F.rig)}});if(b4w.module_check("npc_characters"))throw"Failed to register module: system";
b4w.register("npc_characters",function(a,g){g("config");var q=g("scenes"),c=g("npc_ai"),b=g("objects_manager"),w=g("animation"),t;a.a8=t;a.jW=function(a){switch(a.type){case "npc":"dino"==a.vb&&"TRex"==a.OZ&&(t={mf:q.Kf("GroupTRex","TRex"),rig:q.Kf("GroupTRex","ArmatureTRex"),yX:q.Kf("GroupTRex","TRex"),g8:a},w.apply(q.Kf("GroupTRex","ArmatureTRex"),"ArmatureTRex_proxyAction_B4W_BAKED"),a={path:[[-2265,-1140,88],[-2265,-1200,88]],delay:5,actions:{move:["ArmatureTRex_proxyAction_B4W_BAKED"]},obj:q.Kf("GroupTRex",
"TRex"),rig:q.Kf("GroupTRex","ArmatureTRex"),collider:q.Kf("GroupTRex","TRex"),speed:.1,rot_speed:1,random:!1,type:"NT_WALKING"},b.LM(q.Kf("GroupTRex","TRex"),"EmptySpawner2"),c.DX(a))}}});if(b4w.module_check("system"))throw"Failed to register module: system";b4w.register("system",function(a,g){var q=g("config");a.nW=function(){q.set("max_fps",45);q.set("max_fps_physics",500)}});if(b4w.module_check("objects_manager"))throw"Failed to register module: vehicles";
b4w.register("objects_manager",function(a,g){var q=g("scenes");g("main");g("screenshooter");g("game_options");g("constraints");var c=g("transform"),b=g("physics");g("animation");g("vec3");var w=g("npc_characters");new Float32Array(3);new Float32Array(3);var t=new Float32Array(4),D,l,r,p,m,f;a.H2=l;a.i4=r;a.items=p;a.O$=m;a.H8=f;a.kW=function(){l=[];r=[{id:[1,0],type:"npc",vb:"dino",OZ:"TRex"}];p=[];m=[];f=[];D=[l,r,p,m,f];for(var a=0;a<D.length;a++)for(var b=D[a],c=0;c<b.length;c++){var g=b[c];switch(g.type){case "npc":w.jW(g)}}};
a.LM=function(a,e){if(b.ZV(a)){var f=q.JV(e),g=c.sd(f);c.Lf(f,t);console.log("Spawner rotation: "+t);b.Us(a,g,t)}}});b4w.register("project_ow_app",function(a,g){function q(a,f){f?(a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},document.getElementById("preloader_cont").style.visibility="visible",D.load(e+"project_ow.json",b,c)):console.log("b4w init failure")}function c(a){var b=document.getElementById("prelod_dynamic_path"),c=b.nextElementSibling;b.style.width=a+"%";c.innerHTML=a+"%";100==a&&(document.getElementById("preloader_cont").style.visibility="hidden")}function b(a,b){b?(r.nW(),
m.hW(),p.gW(),f.kW()):console.log("b4w load failure")}var w=g("app"),t=g("config"),D=g("data");g("preloader");var l=g("version");g("npc_ai");g("scenes");var r=g("system"),p=g("character"),m=g("environment");g("animation");var f=g("objects_manager"),n="DEBUG"==l.type(),e=t.tv("project_ow");a.fh=function(){w.fh({canvas_container_id:"main_canvas_container",callback:q,show_fps:n,console_verbose:n,gl_debug:!0,autoresize:!0,key_pause_enabled:!0})}});b4w.require("project_ow_app").fh();
