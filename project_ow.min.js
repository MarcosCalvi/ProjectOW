var b4w="object"===typeof b4w?b4w:function(a){var l={};a.module=l;var n={};a.ua=function(a,b){var y=l[a];y&&(y.wn=null);n[b||"__b4w_default"]=null};a.register=function(a,b){l[a]||(l[a]=b)};a.require=function(a,b){if(!l[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";n[b]||(n[b]=function(a){return function(b){var e=l[b];if(!e)throw Error('Module "'+b+'" not found');e.wn||(e.wn={});e.wn[a]||(e.wn[a]={},e(e.wn[a],n[a]));return e.wn[a]}}(b));return n[b](a)};a.module_check=function(a){return l[a]?
!0:!1};a.get_namespace=function(a){for(var b in n)if(n[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.lights=function(a,l){function n(a){for(var e=h.A(),c=y.Ub(e,"LAMP",y.oc),n=0;n<c.length;n++){var r=c[n];if("SUN"==r.ub.type){var C=r;break}}if(!C)A.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){c=k.Cb(180-a.hor_position);a=k.Cb(90-a.vert_position);n=C.k;w.Ww(C,[a,0,c]);c=new Float32Array(3);k.lc(m.P(n.n),k.nc,c);n=f.length(m.G(n.n));f.copy(c,v);f.scale(v,n,v);w.Wc(C,v);w.D(C);c=C.ub;if(c.IH){var H=e.world.light_settings.environment_energy,
n=e.world.horizon_color,r=e.world.zenith_color,z=Math.cos(Math.abs(a));a=Math.max(Math.min(3*z,1),0)*c.zH;H*=Math.max(z,.1);b.Bs(c,a);h.Rw(e,H,n,r)}h.hp(C,e)}}function e(a){if(r.Zg(a))return a.ub.type;A.error("get_light_type(): Wrong object");return!1}var b=l("__lights"),y=l("__objects"),r=l("__obj_util"),A=l("__print"),h=l("__scenes"),w=l("__transform"),m=l("__tsr"),k=l("__util"),f=l("__vec3"),v=new Float32Array(3),c,C=60;a.b5=function(a){var b=h.A(),b=y.Ub(b,"LAMP",y.oc);if(!a)return b;for(var e=
[],c=0;c<b.length;c++){var f=b[c];f.ub.type===a&&e.push(f)}return e};a.J5=function(){for(var a=h.A(),a=y.Ub(a,"LAMP",y.oc),b=null,e=0;e<a.length;e++){var c=a[e];if("SUN"==c.ub.type){b=c;break}}return b?(b=b.ub.direction,a=k.oe(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=k.oe(Math.atan2(b[2],Math.sqrt(b[0]*b[0]+b[1]*b[1]))),e={},e.hor_position=a,e.vert_position=b,e):null};a.P8=n;a.iY=function(){for(var a=h.A(),a=y.Ub(a,"LAMP",y.oc),b=0;b<a.length;b++){var e=a[b];if("SUN"==e.ub.type){var c=e;break}}c?
(c={hor_position:135},c.vert_position=-Math.cos(.75*Math.PI)*C,n(c)):A.error("There is no sun on the scene")};a.i8=function(a){(c=a.getDate())?1582==c&&10==a.c7&&4<a.tT&&15>a.tT&&A.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):A.error("There is no year 0 in the Julian system!")};a.w8=function(a){C=Math.min(Math.max(a,0),90)};a.e5=function(a){if(r.Zg(a))var b=a.ub;else return A.error("get_light_params(): Wrong object"),null;if(a=e(a))switch(a){case "SPOT":var c=
{light_type:a,light_color:new Float32Array(3),light_energy:b.Df,light_spot_blend:b.Ls,light_spot_size:b.Wm,light_distance:b.distance};c.light_color.set(b.color);break;case "POINT":c={light_type:a,light_color:new Float32Array(3),light_energy:b.Df,light_distance:b.distance};c.light_color.set(b.color);break;default:c={light_type:a,light_color:new Float32Array(3),light_energy:b.Df},c.light_color.set(b.color)}return c?c:null};a.f5=e;a.r8=function(a,e){if(r.Zg(a)){var c=a.ub,f=h.A(),k=!1;"number"==typeof e.light_energy&&
b.Bs(c,e.light_energy);"object"==typeof e.light_color&&b.Vw(c,e.light_color);"number"==typeof e.light_spot_blend&&(b.wY(c,e.light_spot_blend),k=!0);"number"==typeof e.light_spot_size&&(b.xY(c,e.light_spot_size),k=!0);"number"==typeof e.light_distance&&(b.vY(c,e.light_distance),k=!0);h.hp(a,f);k&&h.UZ(f)}else A.error("set_light_params(): Wrong object")};a.d5=function(a){return r.Zg(a)?a.ub.Df:(A.error("get_light_energy(): Wrong object"),0)};a.Bs=function(a,e){if(r.Zg(a)){var c=h.A();b.Bs(a.ub,e);h.hp(a,
c)}else A.error("set_light_energy(): Wrong object")};a.c5=function(a,b){if(!r.Zg(a))return A.error("get_light_color(): Wrong object"),null;b=b||new Float32Array(3);b.set(a.ub.color);return b};a.Vw=function(a,e){if(r.Zg(a)){var c=h.A();b.Vw(a.ub,e);h.hp(a,c)}else A.error("set_light_color(): Wrong object")}};b4w.module.__lights=function(a,l){function n(a){y.scale(a.color,a.Df,a.Fq)}l("__print");var e=l("__tsr"),b=l("__util"),y=l("__vec3"),r=new Float32Array(3);new Float32Array(3);a.gW=function(a,h){var w=a.data,m=h.ub={name:"",type:w.type,LK:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Fq:new Float32Array(3),zH:0,jE:!1,Wm:0,Ls:0,xq:.1,wq:30,dI:!1,oK:!1,IH:!1,an:!0,cn:!0,Df:1,distance:25,c4:"INVERSE_SQUARE"};m.name=h.name;m.an=w.use_diffuse;m.cn=w.use_specular;var k=b.lc(e.P(h.k.n),
b.nc,r);y.normalize(k,k);m.direction.set(k);m.color[0]=w.color[0];m.color[1]=w.color[1];m.color[2]=w.color[2];m.Df=m.zH=w.energy;n(m);m.distance=w.distance;m.jE=w.use_sphere;m.xq=w.clip_start;m.wq=w.clip_end;if("POINT"===m.type||"SPOT"===m.type)m.distance=w.distance;"SPOT"===m.type?(m.Ls=w.spot_blend,m.Wm=w.spot_size):"POINT"===m.type&&(m.Wm=Math.PI/2);m.dI=w.b4w_generate_shadows;m.IH=w.b4w_dynamic_intensity};a.Vw=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];n(a)};a.wY=function(a,
b){a.Ls=b};a.vY=function(a,b){a.distance=b};a.xY=function(a,b){a.Wm=b};a.Bs=function(a,b){a.Df=b;n(a)};a.l_=function(a){var n=a.ub;if(n){b.lc(e.P(a.k.n),b.nc,n.direction);y.normalize(n.direction,n.direction);if("SUN"==n.type){a=Math.acos(y.dot(n.LK,b.iz));var r=Math.acos(y.dot(n.direction,b.iz));n.oK=Math.floor(a/.025)!=Math.floor(r/.025)?!0:!1}y.copy(n.direction,n.LK)}}};b4w.module.__print=function(a){function l(a,b){var e=[];-1<a[0].indexOf("%c")?e.push(a[0].replace("%c","%c"+b+": ")):e.push(b+": "+a[0]);for(var f=1;f<a.length;f++)e.push(a[f]);return e}function n(){r++;var a=l(arguments,"B4W ERROR");console.error.apply(console,a)}function e(a){a in h||(h[a]=a,n([a]))}function b(a,b){e(a+"() is deprecated, use "+b+"() instead.")}var y=!1,r=0,A=0,h={};a.MY=function(a){y=a};a.ae=function(){console.log.apply(console,arguments)};a.log=function(){if(y){var a=l(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=n;a.O=e;a.Sb=b;a.Oh=function(a,n){switch(1<n.length){case !0:e(a+"() is deprecated, use "+n.slice(0,-1).join("(), ")+"() or "+n[n.length-1]+"() instead.");break;case !1:b(a,n[0])}};a.UT=function(){e('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){A++;var a=l(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=l(arguments,"B4W INFO");console.info.apply(console,a)};a.XT=function(){r++;
var a=l(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.YT=function(){A++;var a=l(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){y&&console.time.apply(console,arguments)};a.timeEnd=function(){y&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.uV=function(){return A};a.WU=function(){return r};a.QG=function(){r=A=0}};b4w.module.print=b4w.module.__print;b4w.module.__tsr=function(a,l){function n(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function e(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function y(a,b,e,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=b;c[4]=e[0];c[5]=e[1];c[6]=e[2];c[7]=e[3];return c}function r(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function A(a,b,e){var c=b[0],f=b[1],n=b[2],k=b[3],d=b[4],p=b[5],v=b[6];
b=b[7];var h=a[0]*k,g=a[1]*k,m=a[2]*k;a=b*h+p*m-v*g;var k=b*g+v*h-d*m,t=b*m+d*g-p*h,h=-d*h-p*g-v*m;e[0]=a*b+h*-d+k*-v-t*-p;e[1]=k*b+h*-p+t*-d-a*-v;e[2]=t*b+h*-v+a*-p-k*-d;e[0]+=c;e[1]+=f;e[2]+=n;return e}var h=l("__mat4"),w=l("__quat"),m=l("__util"),k=l("__vec3"),f=Math.sin(-Math.PI/4),v=-f,c=new Float32Array(3),C=new Float32Array(4);new Float32Array(4);var O=new Float32Array(16);a.create=n;a.clone=function(a){var e=n();b(a,e);return e};a.l4=function(a,b,e,c,f,k,v,d){var p=n();p[0]=a;p[1]=b;p[2]=
e;p[3]=c;p[4]=f;p[5]=k;p[6]=v;p[7]=d;return p};a.Hl=e;a.j3=function(a){var c=e();b(a,c);return c};a.m4=function(a,b,c,f,n,k,v,d){var p=e();p[0]=a;p[1]=b;p[2]=c;p[3]=f;p[4]=n;p[5]=k;p[6]=v;p[7]=d;return p};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.hi=y;a.kf=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Mf=function(a,b){b[3]=a;return b};a.JY=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.Jk=function(a,b){b[4]=a[0];b[5]=a[1];
b[6]=a[2];b[7]=a[3];return b};a.G=function(a){return a.subarray(0,3)};a.hc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.Yd=function(a){return a[3]};a.sV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.P=function(a){return a.subarray(4,8)};a.Xd=r;a.invert=function(a,b){var e=1/a[3];if(!e)return null;var c=a[0],f=a[1],n=a[2];C[0]=a[4];C[1]=a[5];C[2]=a[6];C[3]=a[7];w.invert(C,C);var k=C[0],d=C[1],p=C[2],v=C[3],c=c*e,f=f*e,h=n*e,n=v*c+d*h-p*f,g=v*f+p*c-k*h,m=v*h+k*f-d*c,c=-k*c-d*f-
p*h;b[0]=-(n*v+c*-k+g*-p-m*-d);b[1]=-(g*v+c*-d+m*-k-n*-p);b[2]=-(m*v+c*-p+n*-d-g*-k);b[3]=e;b[4]=k;b[5]=d;b[6]=p;b[7]=v;return b};a.SM=function(a,b){var e=a[3];h.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var c=0;12>c;c++)b[c]*=e};a.Qi=function(a,b){var e=m.eK(a,c),f=m.dK(a),n=m.WB(a,C);y(e,f,n,b)};a.multiply=function(a,b,e){A(b,a,e);e[3]=a[3]*b[3];var c=a[4],f=a[5],n=a[6];a=a[7];var k=b[4],d=b[5],p=b[6];b=b[7];e[4]=c*b+a*k+f*p-n*d;e[5]=f*b+a*d+n*k-c*p;e[6]=n*b+a*p+c*d-f*k;e[7]=
a*b-c*k-f*d-n*p;return e};a.NZ=function(a,b,e){var c=b[3];b=h.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),O);for(var f=0;12>f;f++)b[f]*=c;h.multiply(b,a,e);return e};a.Xc=A;a.C9=function(a,b,e){var c=b[3],f=a[0]-b[0],n=a[1]-b[1],k=a[2]-b[2];a=b[4];var d=b[5],p=b[6];b=b[7];var v=a*a+d*d+p*p+b*b,v=v?1/v:0;a=-a*v;d=-d*v;p=-p*v;b*=v;var v=b*f+d*k-p*n,h=b*n+p*f-a*k,g=b*k+a*n-d*f,f=-a*f-d*n-p*k;e[0]=v*b+f*-a+h*-p-g*-d;e[1]=h*b+f*-d+g*-a-v*-p;e[2]=g*b+f*-p+v*-d-h*-a;e[0]/=c;e[1]/=c;e[2]/=c;return e};
a.dp=function(a,b,e,c){c||(c=0);var f=a.length,n=b[0],k=b[1],d=b[2],p=b[3],v=b[4],h=b[5],g=b[6];b=b[7];for(var m=0;m<f;m+=3){var t=a[m]*p,r=a[m+1]*p,G=a[m+2]*p,F=b*t+h*G-g*r,C=b*r+g*t-v*G,R=b*G+v*r-h*t,t=-v*t-h*r-g*G;e[c+m]=F*b+t*-v+C*-g-R*-h;e[c+m+1]=C*b+t*-h+R*-v-F*-g;e[c+m+2]=R*b+t*-g+F*-h-C*-v;e[c+m]+=n;e[c+m+1]+=k;e[c+m+2]+=d}};a.MZ=function(a,b,e){var c=0,c=0,f=a.length,n=b[3],k=b[4],d=b[5],p=b[6];b=b[7];for(var v=0;v<f;v+=3){var h=a[v]*n,g=a[v+1]*n,m=a[v+2]*n,t=b*h+d*m-p*g,r=b*g+p*h-k*m,G=
b*m+k*g-d*h,h=-k*h-d*g-p*m;e[c+v]=t*b+h*-k+r*-p-G*-d;e[c+v+1]=r*b+h*-d+G*-k-t*-p;e[c+v+2]=G*b+h*-p+t*-d-r*-k}};a.wd=function(a,b,e){var c=b[3],f=b[4],n=b[5],k=b[6];b=b[7];var d=a[0]*c,p=a[1]*c,v=a[2]*c;a=b*d+n*v-k*p;var c=b*p+k*d-f*v,h=b*v+f*p-n*d,d=-f*d-n*p-k*v;e[0]=a*b+d*-f+c*-k-h*-n;e[1]=c*b+d*-n+h*-f-a*-k;e[2]=h*b+d*-k+a*-n-c*-f};a.PZ=function(a,b,e,c){c||(c=0);var f=a.length,n=b[3],k=b[4],d=b[5],p=b[6];b=b[7];for(var v=0;v<f;v+=4){var h=a[v]*n,g=a[v+1]*n,m=a[v+2]*n,t=b*h+d*m-p*g,r=b*g+p*h-k*
m,G=b*m+k*g-d*h,h=-k*h-d*g-p*m;e[c+v]=t*b+h*-k+r*-p-G*-d;e[c+v+1]=r*b+h*-d+G*-k-t*-p;e[c+v+2]=G*b+h*-p+t*-d-r*-k;e[c+v+3]=a[v+3]}};a.OZ=function(a,b,e){b=r(b,C);w.multiply(b,a,e)};a.XM=function(a,b,e,c){c=c||0;b=r(b,C);m.WK(a,b,e,c)};a.translate=function(a,b,e){var c=a[3],f=a[4],k=a[5],n=a[6],d=a[7],p=b[0]*c,v=b[1]*c,h=b[2]*c;b=d*p+k*h-n*v;var c=d*v+n*p-f*h,g=d*h+f*v-k*p,p=-f*p-k*v-n*h;e[0]=a[0]+b*d+p*-f+c*-n-g*-k;e[1]=a[1]+c*d+p*-k+g*-f-b*-n;e[2]=a[2]+g*d+p*-n+b*-k-c*-f;e[3]=a[3];e[4]=a[4];e[5]=
a[5];e[6]=a[6];e[7]=a[7];return e};a.DB=function(a,b,e,c){k.lerp(a.subarray(0,3),b.subarray(0,3),e,c.subarray(0,3));var f=a[3];c[3]=f+e*(b[3]-f);w.slerp(a.subarray(4,8),b.subarray(4,8),e,c.subarray(4,8));return c};a.Y3=function(a,b,e,c){var f=a.subarray(0,3),k=b.subarray(0,3),n=c.subarray(0,3);n[0]=k[0]*(e+1)-f[0]*e;n[1]=k[1]*(e+1)-f[1]*e;n[2]=k[2]*(e+1)-f[2]*e;c[3]=b[3]*(e+1)-a[3]*e;a=a.subarray(4,8);b=b.subarray(4,8);f=c.subarray(4,8);f[0]=b[0]*(e+1)-a[0]*e;f[1]=b[1]*(e+1)-a[1]*e;f[2]=b[2]*(e+1)-
a[2]*e;f[3]=b[3]*(e+1)-a[3]*e;w.normalize(f,f);return c};a.OV=function(a,b,e,c,f){f[0]=a[0]+b*e[0];f[1]=a[1]+b*e[1];f[2]=a[2]+b*e[2];f[3]=a[3];e=c[0];var k=c[1];c=c[2];var n=a[4],d=a[5],p=a[6],v=a[7];f[4]=.5*(e*v+k*p-c*d);f[5]=.5*(k*v+c*n-e*p);f[6]=.5*(c*v+e*d-k*n);f[7]=.5*(-e*n-k*d-c*p);f[4]=a[4]+f[4]*b;f[5]=a[5]+f[5]*b;f[6]=a[6]+f[6]*b;f[7]=a[7]+f[7]*b;a=f[4];b=f[5];e=f[6];k=f[7];a=a*a+b*b+e*e+k*k;0<a&&(a=1/Math.sqrt(a),f[4]*=a,f[5]*=a,f[6]*=a,f[7]*=a)};a.A9=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];var e=a[4],c=a[5],k=a[6],n=a[7];b[4]=e*v+n*f;b[5]=c*v+k*f;b[6]=k*v-c*f;b[7]=n*v-e*f};a.z9=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__vec3=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array,n=Math.random;a.create=function(){var a=new l(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new l(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,n){var r=new l(3);r[0]=a;r[1]=b;r[2]=n;return r};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,n,r){r[0]=a;r[1]=b;r[2]=n;return r};a.add=function(a,b,n){n[0]=a[0]+b[0];n[1]=a[1]+b[1];n[2]=a[2]+b[2];
return n};a.subtract=function(a,b,n){n[0]=a[0]-b[0];n[1]=a[1]-b[1];n[2]=a[2]-b[2];return n};a.sub=a.subtract;a.multiply=function(a,b,n){n[0]=a[0]*b[0];n[1]=a[1]*b[1];n[2]=a[2]*b[2];return n};a.mul=a.multiply;a.divide=function(a,b,n){n[0]=a[0]/b[0];n[1]=a[1]/b[1];n[2]=a[2]/b[2];return n};a.div=a.divide;a.min=function(a,b,n){n[0]=Math.min(a[0],b[0]);n[1]=Math.min(a[1],b[1]);n[2]=Math.min(a[2],b[2]);return n};a.max=function(a,b,n){n[0]=Math.max(a[0],b[0]);n[1]=Math.max(a[1],b[1]);n[2]=Math.max(a[2],
b[2]);return n};a.scale=function(a,b,n){n[0]=a[0]*b;n[1]=a[1]*b;n[2]=a[2]*b;return n};a.scaleAndAdd=function(a,b,n,r){r[0]=a[0]+b[0]*n;r[1]=a[1]+b[1]*n;r[2]=a[2]+b[2]*n;return r};a.distance=function(a,b){var n=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2];return Math.sqrt(n*n+r*r+A*A)};a.dist=a.distance;a.squaredDistance=function(a,b){var n=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2];return n*n+r*r+A*A};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],n=a[1];a=a[2];return Math.sqrt(b*b+n*n+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],n=a[1];a=a[2];return b*b+n*n+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var n=a[0],r=a[1],A=a[2],n=n*n+r*r+A*A;0<n&&(n=1/Math.sqrt(n),b[0]=a[0]*n,b[1]=a[1]*n,b[2]=a[2]*n);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,n){var r=a[0],A=a[1];a=a[2];var h=b[0],w=b[1];b=b[2];
n[0]=A*b-a*w;n[1]=a*h-r*b;n[2]=r*w-A*h;return n};a.lerp=function(a,b,n,r){var A=a[0],h=a[1];a=a[2];r[0]=A+n*(b[0]-A);r[1]=h+n*(b[1]-h);r[2]=a+n*(b[2]-a);return r};a.t6=function(a,b,n,r,A,h){var w=A*A,m=w*(2*A-3)+1,k=w*(A-2)+A,f=w*(A-1);A=w*(3-2*A);h[0]=a[0]*m+b[0]*k+n[0]*f+r[0]*A;h[1]=a[1]*m+b[1]*k+n[1]*f+r[1]*A;h[2]=a[2]*m+b[2]*k+n[2]*f+r[2]*A;return h};a.eG=function(a,b,n,r,A,h){var w=1-A,m=w*w,k=A*A,f=m*w,m=3*A*m,w=3*k*w;A*=k;h[0]=a[0]*f+b[0]*m+n[0]*w+r[0]*A;h[1]=a[1]*f+b[1]*m+n[1]*w+r[1]*A;h[2]=
a[2]*f+b[2]*m+n[2]*w+r[2]*A;return h};a.random=function(a,b){a=a||1;var y=2*n()*Math.PI,r=2*n()-1,A=Math.sqrt(1-r*r)*a;b[0]=Math.cos(y)*A;b[1]=Math.sin(y)*A;b[2]=r*a;return b};a.transformMat4=function(a,b,n){var r=a[0],A=a[1];a=a[2];var h=b[3]*r+b[7]*A+b[11]*a+b[15],h=h||1;n[0]=(b[0]*r+b[4]*A+b[8]*a+b[12])/h;n[1]=(b[1]*r+b[5]*A+b[9]*a+b[13])/h;n[2]=(b[2]*r+b[6]*A+b[10]*a+b[14])/h;return n};a.transformMat3=function(a,b,n){var r=a[0],A=a[1];a=a[2];n[0]=r*b[0]+A*b[3]+a*b[6];n[1]=r*b[1]+A*b[4]+a*b[7];
n[2]=r*b[2]+A*b[5]+a*b[8];return n};a.transformQuat=function(a,b,n){var r=a[0],A=a[1],h=a[2];a=b[0];var w=b[1],m=b[2];b=b[3];var k=b*r+w*h-m*A,f=b*A+m*r-a*h,v=b*h+a*A-w*r,r=-a*r-w*A-m*h;n[0]=k*b+r*-a+f*-m-v*-w;n[1]=f*b+r*-w+v*-a-k*-m;n[2]=v*b+r*-m+k*-w-f*-a;return n};a.rotateX=function(a,b,n,r){var A=[],h=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];h[0]=A[0];h[1]=A[1]*Math.cos(n)-A[2]*Math.sin(n);h[2]=A[1]*Math.sin(n)+A[2]*Math.cos(n);r[0]=h[0]+b[0];r[1]=h[1]+b[1];r[2]=h[2]+b[2];return r};a.rotateY=
function(a,b,n,r){var A=[],h=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];h[0]=A[2]*Math.sin(n)+A[0]*Math.cos(n);h[1]=A[1];h[2]=A[2]*Math.cos(n)-A[0]*Math.sin(n);r[0]=h[0]+b[0];r[1]=h[1]+b[1];r[2]=h[2]+b[2];return r};a.rotateZ=function(a,b,n,r){var A=[],h=[];A[0]=a[0]-b[0];A[1]=a[1]-b[1];A[2]=a[2]-b[2];h[0]=A[0]*Math.cos(n)-A[1]*Math.sin(n);h[1]=A[0]*Math.sin(n)+A[1]*Math.cos(n);h[2]=A[2];r[0]=h[0]+b[0];r[1]=h[1]+b[1];r[2]=h[2]+b[2];return r};a.forEach=function(){var e=a.create();return function(a,
n,r,A,h,w){n||(n=3);r||(r=0);for(A=A?Math.min(A*n+r,a.length):a.length;r<A;r+=n)e[0]=a[r],e[1]=a[r+1],e[2]=a[r+2],h(e,w,e),a[r]=e[0],a[r+1]=e[1],a[r+2]=e[2];return a}}();a.Y1=function(e,b){var n=a.fromValues(e[0],e[1],e[2]),r=a.fromValues(b[0],b[1],b[2]);a.normalize(n,n);a.normalize(r,r);n=a.dot(n,r);return 1<n?0:Math.acos(n)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array,n=Math.random;a.create=function(){var a=new l(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new l(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,n,r){var A=new l(4);A[0]=a;A[1]=b;A[2]=n;A[3]=r;return A};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,n,r,A){A[0]=a;A[1]=b;A[2]=n;A[3]=r;return A};a.add=function(a,b,n){n[0]=
a[0]+b[0];n[1]=a[1]+b[1];n[2]=a[2]+b[2];n[3]=a[3]+b[3];return n};a.subtract=function(a,b,n){n[0]=a[0]-b[0];n[1]=a[1]-b[1];n[2]=a[2]-b[2];n[3]=a[3]-b[3];return n};a.sub=a.subtract;a.multiply=function(a,b,n){n[0]=a[0]*b[0];n[1]=a[1]*b[1];n[2]=a[2]*b[2];n[3]=a[3]*b[3];return n};a.mul=a.multiply;a.divide=function(a,b,n){n[0]=a[0]/b[0];n[1]=a[1]/b[1];n[2]=a[2]/b[2];n[3]=a[3]/b[3];return n};a.div=a.divide;a.min=function(a,b,n){n[0]=Math.min(a[0],b[0]);n[1]=Math.min(a[1],b[1]);n[2]=Math.min(a[2],b[2]);n[3]=
Math.min(a[3],b[3]);return n};a.max=function(a,b,n){n[0]=Math.max(a[0],b[0]);n[1]=Math.max(a[1],b[1]);n[2]=Math.max(a[2],b[2]);n[3]=Math.max(a[3],b[3]);return n};a.scale=function(a,b,n){n[0]=a[0]*b;n[1]=a[1]*b;n[2]=a[2]*b;n[3]=a[3]*b;return n};a.scaleAndAdd=function(a,b,n,r){r[0]=a[0]+b[0]*n;r[1]=a[1]+b[1]*n;r[2]=a[2]+b[2]*n;r[3]=a[3]+b[3]*n;return r};a.distance=function(a,b){var n=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(n*n+r*r+A*A+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,b){var n=b[0]-a[0],r=b[1]-a[1],A=b[2]-a[2],h=b[3]-a[3];return n*n+r*r+A*A+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],n=a[1],r=a[2];a=a[3];return Math.sqrt(b*b+n*n+r*r+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],n=a[1],r=a[2];a=a[3];return b*b+n*n+r*r+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var n=a[0],r=a[1],A=a[2],h=a[3],w=n*n+r*r+A*A+h*h;0<w&&(w=1/Math.sqrt(w),b[0]=n*w,b[1]=r*w,b[2]=A*w,b[3]=h*w);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,n,r){var A=a[0],h=a[1],w=a[2];a=a[3];r[0]=A+n*(b[0]-A);r[1]=h+n*(b[1]-h);r[2]=w+n*(b[2]-w);r[3]=a+n*(b[3]-a);return r};a.random=function(e,b){e=e||1;b[0]=n();b[1]=n();b[2]=n();b[3]=n();a.normalize(b,b);a.scale(b,e,b);return b};a.transformMat4=function(a,b,n){var r=a[0],A=a[1],h=
a[2];a=a[3];n[0]=b[0]*r+b[4]*A+b[8]*h+b[12]*a;n[1]=b[1]*r+b[5]*A+b[9]*h+b[13]*a;n[2]=b[2]*r+b[6]*A+b[10]*h+b[14]*a;n[3]=b[3]*r+b[7]*A+b[11]*h+b[15]*a;return n};a.transformQuat=function(a,b,n){var r=a[0],A=a[1],h=a[2],w=b[0],m=b[1],k=b[2];b=b[3];var f=b*r+m*h-k*A,v=b*A+k*r-w*h,c=b*h+w*A-m*r,r=-w*r-m*A-k*h;n[0]=f*b+r*-w+v*-k-c*-m;n[1]=v*b+r*-m+c*-w-f*-k;n[2]=c*b+r*-k+f*-m-v*-w;n[3]=a[3];return n};a.forEach=function(){var n=a.create();return function(a,y,r,A,h,w){y||(y=4);r||(r=0);for(A=A?Math.min(A*
y+r,a.length):a.length;r<A;r+=y)n[0]=a[r],n[1]=a[r+1],n[2]=a[r+2],n[3]=a[r+3],h(n,w,n),a[r]=n[0],a[r+1]=n[1],a[r+2]=n[2],a[r+3]=n[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,l){var n=l("__vec3"),e=l("__vec4"),b=l("__mat3"),y="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new y(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=n.create(),e=n.fromValues(1,0,0),h=n.fromValues(0,1,0);return function(w,m,k){var f=n.dot(w,m);if(-.9999999>f)return n.cross(e,w,b),1E-6>n.length(b)&&n.cross(h,w,b),n.normalize(b,b),a.setAxisAngle(b,Math.PI,k),k;if(.9999999<f)return k[0]=0,k[1]=0,k[2]=0,k[3]=1,k;n.cross(w,
m,b);k[0]=b[0];k[1]=b[1];k[2]=b[2];k[3]=1+f;return a.normalize(k,k)}}();a.setAxes=function(){var n=b.create();return function(b,e,w,m){n[0]=e[0];n[3]=e[1];n[6]=e[2];n[1]=w[0];n[4]=w[1];n[7]=w[2];n[2]=-b[0];n[5]=-b[1];n[8]=-b[2];return a.normalize(a.fromMat3(n,m),m)}}();a.clone=e.clone;a.fromValues=e.fromValues;a.copy=e.copy;a.set=e.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,n){b*=.5;var e=Math.sin(b);n[0]=e*a[0];n[1]=e*a[1];n[2]=e*a[2];n[3]=Math.cos(b);
return n};a.add=e.add;a.multiply=function(a,b,n){var e=a[0],m=a[1],k=a[2];a=a[3];var f=b[0],v=b[1],c=b[2];b=b[3];n[0]=e*b+a*f+m*c-k*v;n[1]=m*b+a*v+k*f-e*c;n[2]=k*b+a*c+e*v-m*f;n[3]=a*b-e*f-m*v-k*c;return n};a.mul=a.multiply;a.scale=e.scale;a.rotateX=function(a,b,n){b*=.5;var e=a[0],m=a[1],k=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);n[0]=e*b+a*f;n[1]=m*b+k*f;n[2]=k*b-m*f;n[3]=a*b-e*f;return n};a.rotateY=function(a,b,n){b*=.5;var e=a[0],m=a[1],k=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);n[0]=e*
b-k*f;n[1]=m*b+a*f;n[2]=k*b+e*f;n[3]=a*b-m*f;return n};a.rotateZ=function(a,b,n){b*=.5;var e=a[0],m=a[1],k=a[2];a=a[3];var f=Math.sin(b);b=Math.cos(b);n[0]=e*b+m*f;n[1]=m*b-e*f;n[2]=k*b+a*f;n[3]=a*b-k*f;return n};a.calculateW=function(a,b){var n=a[0],e=a[1],m=a[2];b[0]=n;b[1]=e;b[2]=m;b[3]=Math.sqrt(Math.abs(1-n*n-e*e-m*m));return b};a.dot=e.dot;a.lerp=e.lerp;a.slerp=function(a,b,n,e){var m=a[0],k=a[1],f=a[2];a=a[3];var v=b[0],c=b[1],C=b[2];b=b[3];var y,l,K;l=m*v+k*c+f*C+a*b;0>l&&(l=-l,v=-v,c=-c,
C=-C,b=-b);1E-6<1-l?(y=Math.acos(l),K=Math.sin(y),l=Math.sin((1-n)*y)/K,n=Math.sin(n*y)/K):l=1-n;e[0]=l*m+n*v;e[1]=l*k+n*c;e[2]=l*f+n*C;e[3]=l*a+n*b;return e};a.h9=function(){var b=a.create(),n=a.create();return function(e,w,m,k,f,v){a.slerp(e,k,f,b);a.slerp(w,m,f,n);a.slerp(b,n,2*f*(1-f),v);return v}}();a.invert=function(a,b){var n=a[0],e=a[1],m=a[2],k=a[3],f=n*n+e*e+m*m+k*k,f=f?1/f:0;b[0]=-n*f;b[1]=-e*f;b[2]=-m*f;b[3]=k*f;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=e.length;a.len=a.length;a.squaredLength=e.squaredLength;a.sqrLen=a.squaredLength;a.normalize=e.normalize;a.fromMat3=function(a,b){var n=a[0]+a[4]+a[8];if(0<n)n=Math.sqrt(n+1),b[3]=.5*n,n=.5/n,b[0]=(a[5]-a[7])*n,b[1]=(a[6]-a[2])*n,b[2]=(a[1]-a[3])*n;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var m=(e+1)%3,k=(e+2)%3,n=Math.sqrt(a[3*e+e]-a[3*m+m]-a[3*k+k]+1);b[e]=.5*n;n=.5/n;b[3]=(a[3*m+k]-a[3*k+m])*n;b[m]=(a[3*m+e]+a[3*e+m])*n;b[k]=(a[3*k+e]+a[3*e+k])*n}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new l(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[4];e[4]=a[5];e[5]=a[6];e[6]=a[8];e[7]=a[9];e[8]=a[10];return e};a.clone=function(a){var e=new l(9);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.copy=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=
a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,e){if(e===a){var b=a[1],y=a[2],r=a[5];e[1]=a[3];e[2]=a[6];e[3]=b;e[5]=a[7];e[6]=y;e[7]=r}else e[0]=a[0],e[1]=a[3],e[2]=a[6],e[3]=a[1],e[4]=a[4],e[5]=a[7],e[6]=a[2],e[7]=a[5],e[8]=a[8];return e};a.invert=function(a,e){var b=a[0],y=a[1],r=a[2],l=a[3],h=a[4],w=a[5],m=a[6],k=a[7],f=a[8],v=f*h-w*k,c=-f*l+w*m,C=
k*l-h*m,O=b*v+y*c+r*C;if(!O)return null;O=1/O;e[0]=v*O;e[1]=(-f*y+r*k)*O;e[2]=(w*y-r*h)*O;e[3]=c*O;e[4]=(f*b-r*m)*O;e[5]=(-w*b+r*l)*O;e[6]=C*O;e[7]=(-k*b+y*m)*O;e[8]=(h*b-y*l)*O;return e};a.adjoint=function(a,e){var b=a[0],y=a[1],r=a[2],l=a[3],h=a[4],w=a[5],m=a[6],k=a[7],f=a[8];e[0]=h*f-w*k;e[1]=r*k-y*f;e[2]=y*w-r*h;e[3]=w*m-l*f;e[4]=b*f-r*m;e[5]=r*l-b*w;e[6]=l*k-h*m;e[7]=y*m-b*k;e[8]=b*h-y*l;return e};a.determinant=function(a){var e=a[3],b=a[4],y=a[5],r=a[6],l=a[7],h=a[8];return a[0]*(h*b-y*l)+a[1]*
(-h*e+y*r)+a[2]*(l*e-b*r)};a.multiply=function(a,e,b){var y=a[0],r=a[1],l=a[2],h=a[3],w=a[4],m=a[5],k=a[6],f=a[7];a=a[8];var v=e[0],c=e[1],C=e[2],O=e[3],J=e[4],K=e[5],D=e[6],Q=e[7];e=e[8];b[0]=v*y+c*h+C*k;b[1]=v*r+c*w+C*f;b[2]=v*l+c*m+C*a;b[3]=O*y+J*h+K*k;b[4]=O*r+J*w+K*f;b[5]=O*l+J*m+K*a;b[6]=D*y+Q*h+e*k;b[7]=D*r+Q*w+e*f;b[8]=D*l+Q*m+e*a;return b};a.mul=a.multiply;a.translate=function(a,e,b){var y=a[0],r=a[1],l=a[2],h=a[3],w=a[4],m=a[5],k=a[6],f=a[7];a=a[8];var v=e[0];e=e[1];b[0]=y;b[1]=r;b[2]=l;
b[3]=h;b[4]=w;b[5]=m;b[6]=v*y+e*h+k;b[7]=v*r+e*w+f;b[8]=v*l+e*m+a;return b};a.rotate=function(a,e,b){var y=a[0],r=a[1],l=a[2],h=a[3],w=a[4],m=a[5],k=a[6],f=a[7];a=a[8];var v=Math.sin(e);e=Math.cos(e);b[0]=e*y+v*h;b[1]=e*r+v*w;b[2]=e*l+v*m;b[3]=e*h-v*y;b[4]=e*w-v*r;b[5]=e*m-v*l;b[6]=k;b[7]=f;b[8]=a;return b};a.scale=function(a,e,b){var y=e[0];e=e[1];b[0]=y*a[0];b[1]=y*a[1];b[2]=y*a[2];b[3]=e*a[3];b[4]=e*a[4];b[5]=e*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.xU=function(a,e){e[0]=1;e[1]=0;e[2]=
0;e[3]=0;e[4]=1;e[5]=0;e[6]=a[0];e[7]=a[1];e[8]=1;return e};a.vU=function(a,e){var b=Math.sin(a),y=Math.cos(a);e[0]=y;e[1]=b;e[2]=0;e[3]=-b;e[4]=y;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e};a.wU=function(a,e){e[0]=a[0];e[1]=0;e[2]=0;e[3]=0;e[4]=a[1];e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e};a.fromMat2d=function(a,e){e[0]=a[0];e[1]=a[1];e[2]=0;e[3]=a[2];e[4]=a[3];e[5]=0;e[6]=a[4];e[7]=a[5];e[8]=1;return e};a.fromQuat=function(a,e){var b=a[0],y=a[1],r=a[2],l=a[3],h=b+b,w=y+y,m=r+r,b=b*h,k=y*h,y=y*w,f=r*h,v=
r*w,r=r*m,h=l*h,w=l*w,l=l*m;e[0]=1-y-r;e[3]=k-l;e[6]=f+w;e[1]=k+l;e[4]=1-b-r;e[7]=v-h;e[2]=f-w;e[5]=v+h;e[8]=1-b-y;return e};a.normalFromMat4=function(a,e){var b=a[0],y=a[1],r=a[2],l=a[3],h=a[4],w=a[5],m=a[6],k=a[7],f=a[8],v=a[9],c=a[10],C=a[11],O=a[12],J=a[13],K=a[14],D=a[15],Q=b*w-y*h,L=b*m-r*h,H=b*k-l*h,z=y*m-r*w,d=y*k-l*w,p=r*k-l*m,M=f*J-v*O,x=f*K-c*O,f=f*D-C*O,g=v*K-c*J,v=v*D-C*J,c=c*D-C*K,C=Q*c-L*v+H*g+z*f-d*x+p*M;if(!C)return null;C=1/C;e[0]=(w*c-m*v+k*g)*C;e[1]=(m*f-h*c-k*x)*C;e[2]=(h*v-w*
f+k*M)*C;e[3]=(r*v-y*c-l*g)*C;e[4]=(b*c-r*f+l*x)*C;e[5]=(y*f-b*v-l*M)*C;e[6]=(J*p-K*d+D*z)*C;e[7]=(K*H-O*p-D*L)*C;e[8]=(O*d-J*H+D*Q)*C;return e};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.uU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var l="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new l(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var e=new l(16);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.copy=function(a,e){e[0]=a[0];
e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,e){if(e===a){var b=a[1],y=a[2],r=a[3],l=a[6],h=a[7],w=a[11];e[1]=a[4];e[2]=a[8];e[3]=a[12];e[4]=b;e[6]=a[9];e[7]=a[13];e[8]=y;e[9]=l;e[11]=a[14];e[12]=r;e[13]=
h;e[14]=w}else e[0]=a[0],e[1]=a[4],e[2]=a[8],e[3]=a[12],e[4]=a[1],e[5]=a[5],e[6]=a[9],e[7]=a[13],e[8]=a[2],e[9]=a[6],e[10]=a[10],e[11]=a[14],e[12]=a[3],e[13]=a[7],e[14]=a[11],e[15]=a[15];return e};a.invert=function(a,e){var b=a[0],y=a[1],r=a[2],l=a[3],h=a[4],w=a[5],m=a[6],k=a[7],f=a[8],v=a[9],c=a[10],C=a[11],O=a[12],J=a[13],K=a[14],D=a[15],Q=b*w-y*h,L=b*m-r*h,H=b*k-l*h,z=y*m-r*w,d=y*k-l*w,p=r*k-l*m,M=f*J-v*O,x=f*K-c*O,g=f*D-C*O,P=v*K-c*J,t=v*D-C*J,da=c*D-C*K,G=Q*da-L*t+H*P+z*g-d*x+p*M;if(!G)return null;
G=1/G;e[0]=(w*da-m*t+k*P)*G;e[1]=(r*t-y*da-l*P)*G;e[2]=(J*p-K*d+D*z)*G;e[3]=(c*d-v*p-C*z)*G;e[4]=(m*g-h*da-k*x)*G;e[5]=(b*da-r*g+l*x)*G;e[6]=(K*H-O*p-D*L)*G;e[7]=(f*p-c*H+C*L)*G;e[8]=(h*t-w*g+k*M)*G;e[9]=(y*g-b*t-l*M)*G;e[10]=(O*d-J*H+D*Q)*G;e[11]=(v*H-f*d-C*Q)*G;e[12]=(w*x-h*P-m*M)*G;e[13]=(b*P-y*x+r*M)*G;e[14]=(J*L-O*z-K*Q)*G;e[15]=(f*z-v*L+c*Q)*G;return e};a.adjoint=function(a,e){var b=a[0],y=a[1],r=a[2],l=a[3],h=a[4],w=a[5],m=a[6],k=a[7],f=a[8],v=a[9],c=a[10],C=a[11],O=a[12],J=a[13],K=a[14],D=
a[15];e[0]=w*(c*D-C*K)-v*(m*D-k*K)+J*(m*C-k*c);e[1]=-(y*(c*D-C*K)-v*(r*D-l*K)+J*(r*C-l*c));e[2]=y*(m*D-k*K)-w*(r*D-l*K)+J*(r*k-l*m);e[3]=-(y*(m*C-k*c)-w*(r*C-l*c)+v*(r*k-l*m));e[4]=-(h*(c*D-C*K)-f*(m*D-k*K)+O*(m*C-k*c));e[5]=b*(c*D-C*K)-f*(r*D-l*K)+O*(r*C-l*c);e[6]=-(b*(m*D-k*K)-h*(r*D-l*K)+O*(r*k-l*m));e[7]=b*(m*C-k*c)-h*(r*C-l*c)+f*(r*k-l*m);e[8]=h*(v*D-C*J)-f*(w*D-k*J)+O*(w*C-k*v);e[9]=-(b*(v*D-C*J)-f*(y*D-l*J)+O*(y*C-l*v));e[10]=b*(w*D-k*J)-h*(y*D-l*J)+O*(y*k-l*w);e[11]=-(b*(w*C-k*v)-h*(y*C-l*
v)+f*(y*k-l*w));e[12]=-(h*(v*K-c*J)-f*(w*K-m*J)+O*(w*c-m*v));e[13]=b*(v*K-c*J)-f*(y*K-r*J)+O*(y*c-r*v);e[14]=-(b*(w*K-m*J)-h*(y*K-r*J)+O*(y*m-r*w));e[15]=b*(w*c-m*v)-h*(y*c-r*v)+f*(y*m-r*w);return e};a.determinant=function(a){var e=a[0],b=a[1],y=a[2],r=a[3],l=a[4],h=a[5],w=a[6],m=a[7],k=a[8],f=a[9],v=a[10],c=a[11],C=a[12],O=a[13],J=a[14];a=a[15];return(e*h-b*l)*(v*a-c*J)-(e*w-y*l)*(f*a-c*O)+(e*m-r*l)*(f*J-v*O)+(b*w-y*h)*(k*a-c*C)-(b*m-r*h)*(k*J-v*C)+(y*m-r*w)*(k*O-f*C)};a.multiply=function(a,e,b){var y=
a[0],r=a[1],l=a[2],h=a[3],w=a[4],m=a[5],k=a[6],f=a[7],v=a[8],c=a[9],C=a[10],O=a[11],J=a[12],K=a[13],D=a[14];a=a[15];var Q=e[0],L=e[1],H=e[2],z=e[3];b[0]=Q*y+L*w+H*v+z*J;b[1]=Q*r+L*m+H*c+z*K;b[2]=Q*l+L*k+H*C+z*D;b[3]=Q*h+L*f+H*O+z*a;Q=e[4];L=e[5];H=e[6];z=e[7];b[4]=Q*y+L*w+H*v+z*J;b[5]=Q*r+L*m+H*c+z*K;b[6]=Q*l+L*k+H*C+z*D;b[7]=Q*h+L*f+H*O+z*a;Q=e[8];L=e[9];H=e[10];z=e[11];b[8]=Q*y+L*w+H*v+z*J;b[9]=Q*r+L*m+H*c+z*K;b[10]=Q*l+L*k+H*C+z*D;b[11]=Q*h+L*f+H*O+z*a;Q=e[12];L=e[13];H=e[14];z=e[15];b[12]=Q*y+
L*w+H*v+z*J;b[13]=Q*r+L*m+H*c+z*K;b[14]=Q*l+L*k+H*C+z*D;b[15]=Q*h+L*f+H*O+z*a;return b};a.mul=a.multiply;a.translate=function(a,e,b){var l=e[0],r=e[1];e=e[2];var A,h,w,m,k,f,v,c,C,O,J,K;a===b?(b[12]=a[0]*l+a[4]*r+a[8]*e+a[12],b[13]=a[1]*l+a[5]*r+a[9]*e+a[13],b[14]=a[2]*l+a[6]*r+a[10]*e+a[14],b[15]=a[3]*l+a[7]*r+a[11]*e+a[15]):(A=a[0],h=a[1],w=a[2],m=a[3],k=a[4],f=a[5],v=a[6],c=a[7],C=a[8],O=a[9],J=a[10],K=a[11],b[0]=A,b[1]=h,b[2]=w,b[3]=m,b[4]=k,b[5]=f,b[6]=v,b[7]=c,b[8]=C,b[9]=O,b[10]=J,b[11]=K,
b[12]=A*l+k*r+C*e+a[12],b[13]=h*l+f*r+O*e+a[13],b[14]=w*l+v*r+J*e+a[14],b[15]=m*l+c*r+K*e+a[15]);return b};a.scale=function(a,e,b){var l=e[0],r=e[1];e=e[2];b[0]=a[0]*l;b[1]=a[1]*l;b[2]=a[2]*l;b[3]=a[3]*l;b[4]=a[4]*r;b[5]=a[5]*r;b[6]=a[6]*r;b[7]=a[7]*r;b[8]=a[8]*e;b[9]=a[9]*e;b[10]=a[10]*e;b[11]=a[11]*e;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,e,b,l){var r=b[0],A=b[1];b=b[2];var h=Math.sqrt(r*r+A*A+b*b),w,m,k,f,v,c,C,O,J,K,D,Q,L,H,z,d,p,M,x,g;if(1E-7>Math.abs(h))return null;
h=1/h;r*=h;A*=h;b*=h;w=Math.sin(e);m=Math.cos(e);k=1-m;e=a[0];h=a[1];f=a[2];v=a[3];c=a[4];C=a[5];O=a[6];J=a[7];K=a[8];D=a[9];Q=a[10];L=a[11];H=r*r*k+m;z=A*r*k+b*w;d=b*r*k-A*w;p=r*A*k-b*w;M=A*A*k+m;x=b*A*k+r*w;g=r*b*k+A*w;r=A*b*k-r*w;A=b*b*k+m;l[0]=e*H+c*z+K*d;l[1]=h*H+C*z+D*d;l[2]=f*H+O*z+Q*d;l[3]=v*H+J*z+L*d;l[4]=e*p+c*M+K*x;l[5]=h*p+C*M+D*x;l[6]=f*p+O*M+Q*x;l[7]=v*p+J*M+L*x;l[8]=e*g+c*r+K*A;l[9]=h*g+C*r+D*A;l[10]=f*g+O*r+Q*A;l[11]=v*g+J*r+L*A;a!==l&&(l[12]=a[12],l[13]=a[13],l[14]=a[14],l[15]=a[15]);
return l};a.rotateX=function(a,e,b){var l=Math.sin(e);e=Math.cos(e);var r=a[4],A=a[5],h=a[6],w=a[7],m=a[8],k=a[9],f=a[10],v=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=r*e+m*l;b[5]=A*e+k*l;b[6]=h*e+f*l;b[7]=w*e+v*l;b[8]=m*e-r*l;b[9]=k*e-A*l;b[10]=f*e-h*l;b[11]=v*e-w*l;return b};a.rotateY=function(a,e,b){var l=Math.sin(e);e=Math.cos(e);var r=a[0],A=a[1],h=a[2],w=a[3],m=a[8],k=a[9],f=a[10],v=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=r*e-m*l;b[1]=A*e-k*l;b[2]=h*e-f*l;b[3]=w*e-v*l;b[8]=r*l+m*e;b[9]=A*l+k*e;b[10]=h*l+f*e;b[11]=w*l+v*e;return b};a.rotateZ=function(a,e,b){var l=Math.sin(e);e=Math.cos(e);var r=a[0],A=a[1],h=a[2],w=a[3],m=a[4],k=a[5],f=a[6],v=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=r*e+m*l;b[1]=A*e+k*l;b[2]=h*e+f*l;b[3]=w*e+v*l;b[4]=m*e-r*l;b[5]=k*e-A*l;b[6]=f*e-h*l;b[7]=v*e-w*l;return b};
a.xU=function(a,e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=a[0];e[13]=a[1];e[14]=a[2];e[15]=1;return e};a.wU=function(a,e){e[0]=a[0];e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a[1];e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=a[2];e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.vU=function(a,e,b){var l=e[0],r=e[1];e=e[2];var A=Math.sqrt(l*l+r*r+e*e),h;if(1E-7>Math.abs(A))return null;A=1/A;l*=A;r*=A;e*=A;A=Math.sin(a);a=Math.cos(a);h=1-a;b[0]=l*l*h+a;b[1]=r*l*h+e*
A;b[2]=e*l*h-r*A;b[3]=0;b[4]=l*r*h-e*A;b[5]=r*r*h+a;b[6]=e*r*h+l*A;b[7]=0;b[8]=l*e*h+r*A;b[9]=r*e*h-l*A;b[10]=e*e*h+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.i4=function(a,e){var b=Math.sin(a),l=Math.cos(a);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=l;e[6]=b;e[7]=0;e[8]=0;e[9]=-b;e[10]=l;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.j4=function(a,e){var b=Math.sin(a),l=Math.cos(a);e[0]=l;e[1]=0;e[2]=-b;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=b;e[9]=0;e[10]=l;e[11]=0;e[12]=0;e[13]=0;
e[14]=0;e[15]=1;return e};a.k4=function(a,e){var b=Math.sin(a),l=Math.cos(a);e[0]=l;e[1]=b;e[2]=0;e[3]=0;e[4]=-b;e[5]=l;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.fromRotationTranslation=function(a,e,b){var l=a[0],r=a[1],A=a[2],h=a[3],w=l+l,m=r+r,k=A+A;a=l*w;var f=l*m,l=l*k,v=r*m,r=r*k,A=A*k,w=h*w,m=h*m,h=h*k;b[0]=1-(v+A);b[1]=f+h;b[2]=l-m;b[3]=0;b[4]=f-h;b[5]=1-(a+A);b[6]=r+w;b[7]=0;b[8]=l+m;b[9]=r-w;b[10]=1-(a+v);b[11]=0;b[12]=e[0];b[13]=e[1];b[14]=e[2];
b[15]=1;return b};a.g4=function(a,e,b,l){var r=a[0],A=a[1],h=a[2],w=a[3],m=r+r,k=A+A,f=h+h;a=r*m;var v=r*k,r=r*f,c=A*k,A=A*f,h=h*f,m=w*m,k=w*k,w=w*f,f=b[0],C=b[1];b=b[2];l[0]=(1-(c+h))*f;l[1]=(v+w)*f;l[2]=(r-k)*f;l[3]=0;l[4]=(v-w)*C;l[5]=(1-(a+h))*C;l[6]=(A+m)*C;l[7]=0;l[8]=(r+k)*b;l[9]=(A-m)*b;l[10]=(1-(a+c))*b;l[11]=0;l[12]=e[0];l[13]=e[1];l[14]=e[2];l[15]=1;return l};a.h4=function(a,e,b,l,r){var A=a[0],h=a[1],w=a[2],m=a[3],k=A+A,f=h+h,v=w+w;a=A*k;var c=A*f,A=A*v,C=h*f,h=h*v,w=w*v,k=m*k,f=m*f,m=
m*v,v=b[0],O=b[1];b=b[2];var J=l[0],K=l[1];l=l[2];r[0]=(1-(C+w))*v;r[1]=(c+m)*v;r[2]=(A-f)*v;r[3]=0;r[4]=(c-m)*O;r[5]=(1-(a+w))*O;r[6]=(h+k)*O;r[7]=0;r[8]=(A+f)*b;r[9]=(h-k)*b;r[10]=(1-(a+C))*b;r[11]=0;r[12]=e[0]+J-(r[0]*J+r[4]*K+r[8]*l);r[13]=e[1]+K-(r[1]*J+r[5]*K+r[9]*l);r[14]=e[2]+l-(r[2]*J+r[6]*K+r[10]*l);r[15]=1;return r};a.fromQuat=function(a,e){var b=a[0],l=a[1],r=a[2],A=a[3],h=b+b,w=l+l,m=r+r,b=b*h,k=l*h,l=l*w,f=r*h,v=r*w,r=r*m,h=A*h,w=A*w,A=A*m;e[0]=1-l-r;e[1]=k+A;e[2]=f-w;e[3]=0;e[4]=k-
A;e[5]=1-b-r;e[6]=v+h;e[7]=0;e[8]=f+w;e[9]=v-h;e[10]=1-b-l;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};a.frustum=function(a,e,b,l,r,A,h){var w=1/(e-a),m=1/(l-b),k=1/(r-A);h[0]=2*r*w;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*r*m;h[6]=0;h[7]=0;h[8]=(e+a)*w;h[9]=(l+b)*m;h[10]=(A+r)*k;h[11]=-1;h[12]=0;h[13]=0;h[14]=A*r*2*k;h[15]=0;return h};a.perspective=function(a,e,b,l,r){a=1/Math.tan(a/2);var A=1/(b-l);r[0]=a/e;r[1]=0;r[2]=0;r[3]=0;r[4]=0;r[5]=a;r[6]=0;r[7]=0;r[8]=0;r[9]=0;r[10]=(l+b)*A;r[11]=-1;r[12]=
0;r[13]=0;r[14]=2*l*b*A;r[15]=0;return r};a.x7=function(a,e,b,l){var r=Math.tan(a.upDegrees*Math.PI/180),A=Math.tan(a.downDegrees*Math.PI/180),h=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var w=2/(h+a),m=2/(r+A);l[0]=w;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=m;l[6]=0;l[7]=0;l[8]=-((h-a)*w*.5);l[9]=(r-A)*m*.5;l[10]=b/(e-b);l[11]=-1;l[12]=0;l[13]=0;l[14]=b*e/(e-b);l[15]=0;return l};a.ortho=function(a,e,b,l,r,A,h){var w=1/(a-e),m=1/(b-l),k=1/(r-A);h[0]=-2*w;h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=-2*m;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*k;h[11]=0;h[12]=(a+e)*w;h[13]=(l+b)*m;h[14]=(A+r)*k;h[15]=1;return h};a.lookAt=function(n,e,b,l){var r,A,h,w,m,k,f,v,c=n[0],C=n[1];n=n[2];h=b[0];w=b[1];A=b[2];f=e[0];b=e[1];r=e[2];if(1E-7>Math.abs(c-f)&&1E-7>Math.abs(C-b)&&1E-7>Math.abs(n-r))return a.identity(l);e=c-f;b=C-b;f=n-r;v=1/Math.sqrt(e*e+b*b+f*f);e*=v;b*=v;f*=v;r=w*f-A*b;A=A*e-h*f;h=h*b-w*e;(v=Math.sqrt(r*r+A*A+h*h))?(v=1/v,r*=v,A*=v,h*=v):h=A=r=0;w=b*h-f*A;m=f*r-e*h;k=e*A-b*r;(v=Math.sqrt(w*
w+m*m+k*k))?(v=1/v,w*=v,m*=v,k*=v):k=m=w=0;l[0]=r;l[1]=w;l[2]=e;l[3]=0;l[4]=A;l[5]=m;l[6]=b;l[7]=0;l[8]=h;l[9]=k;l[10]=f;l[11]=0;l[12]=-(r*c+A*C+h*n);l[13]=-(w*c+m*C+k*n);l[14]=-(e*c+b*C+f*n);l[15]=1;return l};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.uU=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__util=function(a,l){function n(a){return 0<a?1:0>a?-1:0}function e(a,b,c){var g=a[0],d=a[1];a=a[2];var I=Math.cos(g/2),V=Math.cos(d/2),X=Math.cos(a/2),q=Math.sin(g/2),d=Math.sin(d/2),B=Math.sin(a/2);if(-1<U.indexOf(b))var f=Math.cos((g+a)/2),e=Math.sin((g+a)/2),t=Math.cos((g-a)/2),u=Math.sin((g-a)/2),p=Math.cos((a-g)/2),k=Math.sin((a-g)/2);switch(b){case ua:c[0]=V*e;c[1]=d*t;c[2]=d*u;c[3]=V*f;break;case ja:c[0]=d*u;c[1]=V*e;c[2]=d*t;c[3]=V*f;break;case xa:c[0]=d*t;c[1]=d*u;c[2]=V*e;c[3]=
V*f;break;case 3:c[0]=V*e;c[1]=d*k;c[2]=d*p;c[3]=V*f;break;case ka:c[0]=d*p;c[1]=V*e;c[2]=d*k;c[3]=V*f;break;case Pa:c[0]=d*k;c[1]=d*p;c[2]=V*e;c[3]=V*f;break;case 6:c[0]=q*V*X+I*d*B;c[1]=I*d*X-q*V*B;c[2]=I*V*B+q*d*X;c[3]=I*V*X-q*d*B;break;case 7:c[0]=I*V*B+q*d*X;c[1]=q*V*X+I*d*B;c[2]=I*d*X-q*V*B;c[3]=I*V*X-q*d*B;break;case 8:c[0]=I*d*X-q*V*B;c[1]=I*V*B+q*d*X;c[2]=q*V*X+I*d*B;c[3]=I*V*X-q*d*B;break;case 9:c[0]=q*V*X-I*d*B;c[1]=I*V*B-q*d*X;c[2]=I*d*X+q*V*B;c[3]=I*V*X+q*d*B;break;case 10:c[0]=I*d*X+
q*V*B;c[1]=q*V*X-I*d*B;c[2]=I*V*B-q*d*X;c[3]=I*V*X+q*d*B;break;case 11:c[0]=I*V*B-q*d*X,c[1]=I*d*X+q*V*B,c[2]=q*V*X-I*d*B,c[3]=I*V*X+q*d*B}return c}function b(a,b,c){var d=a[0],g=a[1],I=a[2];a=a[3];switch(b){case ua:c[0]=Math.atan2(d*g+I*a,g*a-d*I);c[1]=Math.acos(1-2*(g*g+I*I));c[2]=Math.atan2(d*g-I*a,d*I+g*a);break;case ja:c[0]=Math.atan2(d*a+g*I,I*a-d*g);c[1]=Math.acos(1-2*(d*d+I*I));c[2]=Math.atan2(g*I-d*a,d*g+I*a);break;case xa:c[0]=Math.atan2(d*I+g*a,d*a-g*I);c[1]=Math.acos(1-2*(d*d+g*g));c[2]=
Math.atan2(d*I-g*a,d*a+g*I);break;case 3:c[0]=Math.atan2(d*I-g*a,d*g+I*a);c[1]=Math.acos(1-2*(g*g+I*I));c[2]=Math.atan2(d*I+g*a,I*a-d*g);break;case ka:c[0]=Math.atan2(d*g-I*a,d*a+g*I);c[1]=Math.acos(1-2*(d*d+I*I));c[2]=Math.atan2(d*g+I*a,d*a-g*I);break;case Pa:c[0]=Math.atan2(g*I-d*a,d*I+g*a);c[1]=Math.acos(1-2*(d*d+g*g));c[2]=Math.atan2(d*a+g*I,g*a-d*I);break;case 6:c[0]=Math.atan2(2*(d*a-g*I),1-2*(d*d+g*g));c[1]=Math.asin(2*(d*I+g*a));c[2]=Math.atan2(2*(I*a-d*g),1-2*(g*g+I*I));break;case 7:b=d*
g+I*a;.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=2*Math.atan2(d,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=-2*Math.atan2(d,a)):(c[0]=Math.atan2(2*(g*a-d*I),1-2*(g*g+I*I)),c[1]=Math.asin(2*(d*g+I*a)),c[2]=Math.atan2(2*(d*a-g*I),1-2*(d*d+I*I)));break;case 8:c[0]=Math.atan2(2*(I*a-d*g),1-2*(d*d+I*I));c[1]=Math.asin(2*(d*a+g*I));c[2]=Math.atan2(2*(g*a-d*I),1-2*(d*d+g*g));break;case 9:c[0]=Math.atan2(2*(d*a+g*I),1-2*(d*d+I*I));c[1]=Math.asin(2*(I*a-d*g));c[2]=Math.atan2(2*(d*I+g*a),1-2*(g*g+I*I));break;case 10:c[0]=
Math.atan2(2*(d*I+g*a),1-2*(d*d+g*g));c[1]=Math.asin(2*(d*a-g*I));c[2]=Math.atan2(2*(d*g+I*a),1-2*(d*d+I*I));break;case 11:b=g*a-d*I,.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=-2*Math.atan2(I,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=2*Math.atan2(I,a)):(c[0]=Math.atan2(2*(d*g+I*a),1-2*(g*g+I*I)),c[1]=Math.asin(2*(g*a-d*I)),c[2]=Math.atan2(2*(d*a+g*I),1-2*(d*d+g*g)))}return c}function y(a,b,c){var d=b.length,g=R;g[0]=a[0];g[1]=a[1];g[2]=a[2];t.normalize(g,g);d?(a=T,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=
b[3],b=t.cross(a,g,ga),t.normalize(b,b),t.cross(g,b,a),d=ba,d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=g[0],d[4]=g[1],d[5]=g[2],d[6]=b[0],d[7]=b[1],d[8]=b[2],P.fromMat3(d,c),c[3]=0<c[3]?c[3]+3.1E-5:c[3]-3.1E-5,(0<c[3]&&0>a[3]||0>c[3]&&0<a[3])&&P.scale(c,-1,c),P.normalize(c,c)):P.rotationTo(ma,g,c);return c}function r(a,b){b||(b=new Float32Array(4));d.fromMat4(a,ba);var c=ba[0],g=ba[3],q=ba[6],I=ba[1],V=ba[4],X=ba[7],B=ba[2],f=ba[5],e=ba[8],c=Math.sqrt(c*c+g*g+q*q)||1,I=Math.sqrt(I*I+V*V+X*X)||1,B=Math.sqrt(B*
B+f*f+e*e)||1;ba[0]/=c;ba[3]/=c;ba[6]/=c;ba[1]/=I;ba[4]/=I;ba[7]/=I;ba[2]/=B;ba[5]/=B;ba[8]/=B;P.fromMat3(ba,b);P.normalize(b,b);return b}function A(a){var b=a[0],c=a[1],d=a[2],g=a[3],I=Math.sqrt(b*b+c*c+d*d),I=1/I;a[0]=b*I;a[1]=c*I;a[2]=d*I;a[3]=g*I}function h(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=h(a[d],c);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(d=
0;d<a.length;d++)c=w(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=h(a[d],c);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:c=w(0,c);break;default:J("Wrong object constructor")}else c=w(0,c);return c;case "number":return w(a,c);case "boolean":return w(a|0,c);case "string":return m(a,c);case "function":case "undefined":return w(0,c)}}function w(a,b){var c=b;Y[0]=a;c=(c<<5)-c+na[0];c&=c;c=(c<<5)-c+na[1];return c&c}function m(a,
b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function k(a){return(34*a+1)*a%289}function f(a){return a-Math.floor(a)}function v(a){return c((34*a+5)*a)}function c(a){return a-289*Math.floor(a/289)}function C(a){return a-7*Math.floor(a/7)}function O(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function J(a){a&&x.error.apply(x,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function K(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function D(a){return K(a,0,2*Math.PI)}function Q(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!L(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var g in a)if(!L(a[g],b[g]))return!1;for(g in b)if(!(g in a))return!1}return!0}return!(a||b)}function L(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return Q(a,b);default:return!0}}function H(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var g=a[d];""!=g&&"."!=g&&(".."!=g||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(g):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function z(){var a=[{}];a.length=0;return a}var d=l("__mat3"),p=l("__mat4"),M=l("__math"),x=l("__print"),g=l("__tsr"),P=l("__quat"),t=l("__vec3"),da=l("__vec4"),G=0,F={},U=[ua,ja,xa,ka,Pa],R=new Float32Array(3),Z=new Float32Array(3),u=new Float32Array(3),ga=new Float32Array(3),ca=new Float32Array(3),E=new Float32Array(3),aa=new Float32Array(3),ia=new Float32Array(3),q=new Float32Array(4),T=new Float32Array(4),ba=new Float32Array(9),
S=new Float32Array(16),sa=new Float32Array(16),oa=P.create(),Y=new Float64Array(1),na=new Uint32Array(Y.buffer),ya=new Float32Array([0,0,0]),wa=new Float32Array([0,0,0,1]),la=new Float32Array([0,0,0,1,0,0,0,1]),ha=new Float32Array([1,1,1]),ta=new Float32Array([1,0,0]),ma=new Float32Array([0,1,0]),N=new Float32Array([0,0,1]),ea=new Float32Array([-1,0,0]),B=new Float32Array([0,-1,0]),za=new Float32Array([0,0,-1]),ua=0,ja=1,xa=2,ka=4,Pa=5,Ea=Math.floor(44488.07041494893),Ca=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.lF=ya;a.sn=wa;a.O1=la;a.iz=ha;a.ti=ta;a.xh=ma;a.nc=N;a.Xx=ea;a.wh=B;a.Nc=za;a.mF=ua;a.tF=ja;a.uF=xa;a.oF=3;a.qF=ka;a.wF=Pa;a.nF=6;a.sF=7;a.jz=8;a.pF=9;a.rF=10;a.vF=11;a.bO=Ca;a.Yx=1;a.Op=2;a.Aj=4;a.FE=
4;a.Wh=function(a){return"undefined"!=typeof a};a.RJ=function(a,b,c){for(var d=[],g=c.length,I=0;I<g;I++){var V=c[I];V[a]==b&&d.push(V)}return d};a.Ef=function(a){return new Float32Array(a)};a.oU=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.SZ=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.NR=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.LQ=function(a,b){var c=
[],d={},g=b.length,I,V;for(I=0;I<g;I++)d[b[I]]=!0;g=a.length;for(I=0;I<g;I++)V=a[I],V in d&&c.push(V);return c};a.sign=n;a.T6=function(a,b,c){for(var d=c.length,g=0;g<d;g++)if(c[g][a]==b)return!0;return!1};a.Dd=function(a,b,c){for(var d=0;d<c.length;d++){var g=c[d];if(g[a]===b)return g}return null};a.Q6=function(a,b,c,d,g){for(var I=0;I<g.length;I++){var V=g[I];if(V[a]==b&&V[c]==d)return V}return null};a.hV=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.FQ=function(a,
b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.a3=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.JZ=function(a,b,c,d){d||(d=new Float32Array(16));p.identity(d);d[12]=a;d[13]=b;d[14]=c};var pa=1;a.DX=function(){pa=(69069*pa+5)%Math.pow(2,32);return Math.round(pa/65536)%32768/32767};a.oZ=function(a){pa=a};a.tg=function(a){var b=a[0]%Ea*48271-3399*Math.floor(a[0]/Ea);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.Ev=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.Wj=function(a,b){var c=R;c[0]=a[2];c[1]=a[1];c[2]=a[0];e(c,11,b);return b};a.rC=e;a.VK=b;a.VT=function(a){var b=d.create(),c=Math.cos(a[0]),g=Math.cos(a[1]),q=Math.cos(a[2]),I=Math.sin(a[0]),V=Math.sin(a[1]);a=Math.sin(a[2]);var X=c*q,B=c*a,f=I*q,e=I*a;b[0]=g*q;b[1]=g*a;b[2]=-V;b[3]=V*f-B;b[4]=V*e+X;b[5]=g*I;b[6]=V*X+e;b[7]=V*B-f;b[8]=g*c;return b};a.Fw=function(a,c){var d=b(a,11,R);c[0]=d[2];c[1]=d[1];c[2]=d[0];return c};a.lc=function(a,b,c){c||(c=
new Float32Array(3));t.transformQuat(b,a,c);return c};a.FA=function(a,b,c){c||(c=new Float32Array(4));a=t.normalize(a,R);var d=t.dot(b,a);a=t.cross(b,a,u);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.KZ=function(a,b,c,d){d||(d=new Float32Array(4));t.transformQuat(c,b,d);d[3]=-t.dot(a,d)};a.DT=function(a){var b=g.P(a.k.n),c=R;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;t.transformQuat(c,b,c);u[0]=0;u[1]=0;u[2]=-1;break;
case "MESH":c[0]=0;c[1]=0;c[2]=1;t.transformQuat(c,b,c);u[0]=0;u[1]=0;u[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,t.transformQuat(c,b,c),u[0]=0,u[1]=1,u[2]=0}c[1]=0;t.normalize(c,c);a=t.dot(c,u);return Math.acos(a)*(0<-c[0]*u[2]?-1:1)};a.iG=function(a,b,c,d){if(0!=c){d=d||[];for(var g=0;g<a.length;g++)d[g]=(1-c)*a[g]+c*b[g]}};a.TZ=function(){G++;return G.toString(10)};a.Ps=function(a){F[a]||(F[a]=0);var b=a+F[a];F[a]++;return b};a.Mg=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};
a.or=function(a,b,c){b=b||z();var d=b.length,g=a.length/3;c=c||new Float32Array(4*g);for(var I=0;I<g;++I){var V=R;V[0]=a[3*I];V[1]=a[3*I+1];V[2]=a[3*I+2];var X;d?(X=T,X[0]=b[4*I],X[1]=b[4*I+1],X[2]=b[4*I+2],X[3]=b[4*I+3]):X=b;y(V,X,c.subarray(4*I,4*(I+1)))}return c};a.$I=y;a.Ih=function(a){return JSON.parse(JSON.stringify(a))};a.S=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=
new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.S(b[d]);break;default:for(d in c=new c,b)c[d]=a.S(b[d])}return c};a.zq=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.WB=
r;a.eK=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.dK=function(a){q[0]=.577350269189626;q[1]=.577350269189626;q[2]=.577350269189626;q[3]=0;da.transformMat4(q,a,q);return da.length(q)};a.Pn=function(a,b){var c=b.left,d=b.right,g=b.top,I=b.bottom,V=b.near,X=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-a[4];d[2]=a[11]-a[8];d[3]=a[15]-a[12];g[0]=a[3]-a[1];g[1]=a[7]-a[5];g[2]=a[11]-a[9];g[3]=a[15]-a[13];I[0]=a[3]+
a[1];I[1]=a[7]+a[5];I[2]=a[11]+a[9];I[3]=a[15]+a[13];V[0]=a[3]+a[2];V[1]=a[7]+a[6];V[2]=a[11]+a[10];V[3]=a[15]+a[14];X[0]=a[3]-a[2];X[1]=a[7]-a[6];X[2]=a[11]-a[10];X[3]=a[15]-a[14];A(c);A(d);A(g);A(I);A(V);A(X)};a.jZ=function(a,b,c){return c<-M.sg(a,b.near)||c<-M.sg(a,b.left)||c<-M.sg(a,b.right)||c<-M.sg(a,b.top)||c<-M.sg(a,b.bottom)||c<-M.sg(a,b.far)?!0:!1};a.NT=function(a,b,c,d,g){var I=t.dot(c,b.far),V=t.dot(d,b.far),X=t.dot(g,b.far),I=Math.sqrt(I*I+V*V+X*X);if(I<-M.sg(a,b.near)||I<-M.sg(a,b.far))return!0;
I=t.dot(c,b.left);V=t.dot(d,b.left);X=t.dot(g,b.left);if(Math.sqrt(I*I+V*V+X*X)<-M.sg(a,b.left))return!0;I=t.dot(c,b.right);V=t.dot(d,b.right);X=t.dot(g,b.right);if(Math.sqrt(I*I+V*V+X*X)<-M.sg(a,b.right))return!0;I=t.dot(c,b.top);V=t.dot(d,b.top);X=t.dot(g,b.top);if(Math.sqrt(I*I+V*V+X*X)<-M.sg(a,b.top))return!0;I=t.dot(c,b.bottom);V=t.dot(d,b.bottom);X=t.dot(g,b.bottom);return Math.sqrt(I*I+V*V+X*X)<-M.sg(a,b.bottom)?!0:!1};a.xo=function(a,b,c,d){d||(d=0);for(var g=a.length,I=0;I<g;I+=3){var V=
a[I],X=a[I+1],q=a[I+2];c[d+I]=b[0]*V+b[4]*X+b[8]*q+b[12];c[d+I+1]=b[1]*V+b[5]*X+b[9]*q+b[13];c[d+I+2]=b[2]*V+b[6]*X+b[10]*q+b[14]}};a.S9=function(a,b,c,d){d||(d=0);for(var g=a.length,I=0;I<g;I+=3){var V=a[I],X=a[I+1],q=a[I+2];c[d+I]=b[0]*V+b[4]*X+b[8]*q;c[d+I+1]=b[1]*V+b[5]*X+b[9]*q;c[d+I+2]=b[2]*V+b[6]*X+b[10]*q}return c};a.WK=function(a,b,c,d){d=d||0;for(var g=a.length,I=0;I<g;I+=4){oa[0]=a[I];oa[1]=a[I+1];oa[2]=a[I+2];oa[3]=a[I+3];var V=0<oa[3];P.multiply(b,oa,oa);(V&&0>oa[3]||!V&&0<oa[3])&&da.scale(oa,
-1,oa);c[d+I]=oa[0];c[d+I+1]=oa[1];c[d+I+2]=oa[2];c[d+I+3]=oa[3]}};a.N_=function(a,b,c){c||(c=new Float32Array(3));q[0]=a[0];q[1]=a[1];q[2]=a[2];q[3]=0;da.transformMat4(q,b,q);c[0]=q[0];c[1]=q[1];c[2]=q[2]};a.f4=function(a,b){var c=a.length;c||J("flatten(): Wrong or empty array");var d=a[0].length;d||J("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var g=0;g<c;g++)for(var I=0;I<d;I++)b[g*d+I]=a[g][I];return b};a.O_=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],
a[c+1],a[c+2]]);b[c/3]=d}return b};a.bu=function(b,c,d,g){if(g<d)return d;var q=d+Math.floor((g-d)/2);return b[q]>c?a.bu(b,c,d,q-1):b[q]<c?a.bu(b,c,q+1,g):q};a.Mj=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.k3=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.W7=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.NZ=function(a,b,c,d,g){g||(g=new Float32Array(16));
b=p.fromRotationTranslation(c,d,S);p.multiply(b,a,g);return g};a.Xc=function(a,b,c,d,g){g||(g=new Float32Array(3));c=p.fromRotationTranslation(c,d,S);1!==b&&(d=p.identity(sa),b=t.set(b,b,b,R),p.scale(d,b,d),p.multiply(c,d,c));t.transformMat4(a,c,g);return g};a.D9=function(a,b,c,d,g){g||(g=new Float32Array(4));b=p.fromRotationTranslation(c,d,S);da.transformMat4(a,b,g);return g};a.F6=function(a,b,c,d,g){g||(g=new Float32Array(3));b=p.fromRotationTranslation(c,d,S);p.invert(b,b);t.transformMat4(a,b,
g);return g};a.B9=function(a,b,c){c||(c=new Float32Array(16));p.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.e7=function(b,c,d){a.eK(b,c);c[3]=a.dK(b);r(b,d)};a.s2=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.YX=function(a,b,c,d){d||(d=new Float32Array(3));var g=R;t.subtract(b,a,g);t.transformQuat(g,c,g);t.subtract(b,g,d)};a.DU=function(){var a=R;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),
g=new Float32Array(16),I=new Float32Array(16),V=new Float32Array(16);p.lookAt(a,[-1,0,0],[0,-1,0],b);p.scale(b,[-1,1,1],b);p.scale(b,[-1,1,-1],c);p.lookAt(a,[0,-1,0],[0,0,-1],d);p.scale(d,[1,1,-1],d);p.scale(d,[1,-1,-1],g);p.lookAt(a,[0,0,-1],[0,-1,0],I);p.scale(I,[-1,1,1],I);p.scale(I,[-1,1,-1],V);return[b,c,d,g,I,V]};a.HU=function(){var a=R;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),g=new Float32Array(16),I=new Float32Array(16),V=new Float32Array(16);
p.lookAt(a,[1,0,0],[0,-1,0],b);p.scale(b,[-1,1,-1],c);p.lookAt(a,[0,1,0],[0,0,1],d);p.scale(d,[1,-1,-1],g);p.lookAt(a,[0,0,1],[0,-1,0],I);p.scale(I,[-1,1,-1],V);return[b,c,d,g,I,V]};a.vR=function(a){return h(a,0)};a.pJ=h;a.s6=m;a.MW=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.UK=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),
b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.Cb=function(a){return a*Math.PI/180};a.oe=function(a){return 180*a/Math.PI};a.AD=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),g=.211324865405187*c+.211324865405187*d,b=a[0]-c+g;a=a[1]-d+g;var I=b>a?1:0,V=1-I,g=b+.211324865405187-I,X=a+.211324865405187-V,q=b+-.577350269189626,B=a+-.577350269189626,
c=c%289,d=d%289,e=k(k(d)+c),V=k(k(d+V)+c+I),t=k(k(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(g*g+X*X),0),I=Math.max(.5-(q*q+B*B),0),u=2*f(.024390243902439*e)-1,p=2*f(.024390243902439*V)-1,v=2*f(.024390243902439*t)-1,e=Math.abs(u)-.5,V=Math.abs(p)-.5,t=Math.abs(v)-.5,u=u-Math.floor(u+.5),p=p-Math.floor(p+.5),v=v-Math.floor(v+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(u*u+e*e)),d=d*d*d*d*(1.79284291400159-.85373472095314*(p*p+V*V)),I=I*I*I*I*(1.79284291400159-.85373472095314*(v*v+t*t));
return 130*(c*(u*b+e*a)+d*(p*g+V*X)+I*(v*q+t*B))};a.yG=function(a){var b=1/7,d=b/2,g=c(Math.floor(a[0])),q=c(Math.floor(a[1])),I=f(a[0]);a=f(a[1]);var V=I-.5,X=I-1.5,I=a-.5;a-=1.5;var B=v(g),e=v(g+1),t=B,g=e,B=v(B+q),e=v(e+q),t=v(t+q+1),g=v(g+q+1),q=V+.7*(C(B)*b+d),u=X+.7*(C(e)*b+d),V=V+.7*(C(t)*b+d),X=X+.7*(C(g)*b+d),B=I+.7*(C(Math.floor(B*b))*b+d),I=I+.7*(C(Math.floor(e*b))*b+d),t=a+.7*(C(Math.floor(t*b))*b+d),b=a+.7*(C(Math.floor(g*b))*b+d);return Math.min(q*q+B*B,u*u+I*I,V*V+t*t,X*X+b*b)};a.Ew=
function(a,b,c,d,g){g||(g=new Float32Array(4));a=t.transformQuat(b,a,R);b=c[0];var I=c[1];c=c[2];var V=ba;V[0]=I*I+c*c;V[1]=-I*b;V[2]=-c*b;V[3]=-b*I;V[4]=b*b+c*c;V[5]=-c*I;V[6]=-b*c;V[7]=-I*c;V[8]=b*b+I*I;t.transformMat3(a,V,a);t.normalize(a,a);P.rotationTo(d,a,g);return g};a.Nz=function(a,b){b||(b=new Float32Array(4));var c=q,d=T,c=P.setAxisAngle([0,0,1],Math.PI,P.create()),d=P.setAxisAngle([1,0,0],Math.PI/2,P.create());P.multiply(c,d,c);P.multiply(a,c,b);return b};a.ua=function(){G=0;F={}};a.U=
O;a.mc=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.jx=function(a,b,c,d,g){g||(g=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<g.length;d++)g[d]=(1-c)*a[d]+c*b[d];return g};a.mM=function(a,b,c,d,g){g||(g=new Float32Array(a.length));P.slerp(a,b,Math.exp(-c/d),g)};a.EB=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.jk=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};
a.eA=function(a,b){var c=d.fromQuat(a,ba),g=R;g[0]=c[6];g[1]=c[7];g[2]=c[8];g=t.cross(N,g,g);t.normalize(g,g);var q=c[4];!b&&0<q&&(g[0]*=-1,g[1]*=-1,g[2]*=-1);u[0]=c[0];u[1]=c[1];u[2]=c[2];t.normalize(u,u);c=T;P.rotationTo(u,g,c);P.multiply(c,a,a)};a.lI=function(a,b,c,d){c=c*b-.5;var g=d*b-.5;d=c-Math.floor(c);var I=g-Math.floor(g);c=Math.floor(c);var g=Math.floor(g),V=b-1,X=a[g*b+c],q=a[g*b+Math.min(c+1,V)],B=a[Math.min(g+1,V)*b+c];a=a[Math.min(g+1,V)*b+Math.min(c+1,V)];return(X*(1-d)+q*d)*(1-I)+
(B*(1-d)+a*d)*I};a.Nm=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.hL=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Co=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.YA=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.qr=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.XK=function(a){if(!a.length)return null;
var b=Math.floor(Math.random()*a.length);return a[b]};a.sJ=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=0;t.normalize(c,c)};a.LZ=function(a,b,c){var d=a[0],g=a[1];a=a[2];var I=b[0],V=b[1],X=b[2];b=b[3];var q=V*a-X*g,B=X*d-I*a,f=I*g-V*d,e=V*f-X*B,X=X*q-I*f,I=I*B-V*q;c[0]=d+2*q*b+2*e;c[1]=g+2*B*b+2*X;c[2]=a+2*f*b+2*I};a.assert=function(a){a||J("Assertion failed")};a.q=J;a.Fg=K;a.zi=D;a.gB=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.sZ=function(a,b){for(var c in a){var d=
!0,g=a[c],I=b[c];switch(typeof g){case "number":case "string":case "boolean":d=g==I;break;case "object":d=Q(g,I)}if(!d)return!1}return!0};a.JC=function(a,b){var c=a[0],d=a[2],g=a[3];b[0]=a[1];b[1]=d;b[2]=g;b[3]=c};a.$H=function(a){a+=1;132651<a&&x.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.QB=function(a,b,c,d){q.set(a);q[3]=b;a=T;R[0]=c[3];R[1]=c[4];R[2]=c[5];a.set(R);a[3]=0;a=da.dot(q,a);if(0==a)return null;
b=T;t.copy(c,R);b.set(R);b[3]=1;a=-da.dot(q,b)/a;d[0]=c[0]+a*c[3];d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.nV=function(a,b,c,d){var g=b[0]-a[0],I=c[0]-a[0],V=b[1]-a[1],X=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=V*a-b*X;d[1]=I*b-g*a;d[2]=g*X-V*I;return d};a.n3=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.aD=function(a,b,c){var d=R,g=t.dot(a,b);-.9999999>g?(t.cross(ta,a,d),1E-6>t.length(d)&&t.cross(ma,a,d),t.normalize(d,d),P.setAxisAngle(d,Math.PI,c)):(t.cross(a,b,d),c.set(d),c[3]=
1+g,P.normalize(c,c));return c};a.Bl=function(a,b,c){if(b==c)return c-a;a=D(a);b=D(b);c=D(c);b=2*Math.PI-b;c=D(c+b);a=D(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.Tm=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=O(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.MQ=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.w3=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.zN=function(a,b){for(var c=Math.max(a.length,
b.length),d=0;d<c;d++){var g=n((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(g)return g}return 0};a.bl=function(a){return a.join(".")};a.wM=function(a){return a.split(".").map(function(a){return a|0})};a.i9=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2);return b};a.V6=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.gj=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=H(b[1]),b.join("://")):H(a)};
a.uq=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.MT=function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.Sj=z;a.er=function(a){a=Math.round(32767.5*(a+1)-32768);return O(a?a:0,-32768,32767)};a.Y8=function(a){return O((a+32768)/32767.5-1,-1,1)};a.RZ=function(a){return O(Math.round(255*a),0,255)};a.G9=function(a){return O(a/255,0,1)};a.GT=function(a,b,c,d){var g=t.subtract(c,b,R),I=t.subtract(d,c,Z),V=t.subtract(b,d,
u);b=t.subtract(a,b,ga);c=t.subtract(a,c,ca);a=t.subtract(a,d,E);d=t.cross(g,I,aa);if(0<=t.dot(t.cross(d,g,ia),b)&&0<=t.dot(t.cross(d,I,ia),c)&&0<=t.dot(t.cross(d,V,ia),a))return V=t.length(d),I=t.dot(d,b),Math.abs(I/V);g=t.scale(g,O(t.dot(g,b)/t.length(g),0,1),ia);b=t.length(t.subtract(b,g,ia));I=t.scale(I,O(t.dot(I,c)/t.length(I),0,1),ia);I=t.length(t.subtract(c,I,ia));V=t.scale(V,O(t.dot(V,a)/t.length(V),0,1),ia);V=t.length(t.subtract(a,V,ia));return Math.min(Math.min(b,I),V)}};b4w.module.__math=function(a,l){function n(a,b){for(var f=a[1],e=1,k=2;k<a.length;k++)4!=k&&8!=k&&Math.abs(a[k])>Math.abs(f)&&(f=a[k],e=k);for(var m=Math.floor(e/3),e=e%3,f=.5*Math.atan(2*f/(a[3*m+m]-a[3*e+e])),k=0;k<b.length;k++)b[k]=0==k||4==k||8==k?1:0;b[e+3*m]=-Math.sin(f);b[m+3*e]=Math.sin(f);b[m+3*m]=Math.cos(f);b[e+3*e]=Math.cos(f);return b}function e(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var f=a.content[b];0<b;){var e=(b+1>>1)-1,k=a.content[e];if(a.Om(f)<a.Om(k))a.content[e]=
f,a.content[b]=k,b=e;else break}}function y(a,b){for(var f=a.content.length,e=a.content[b],k=a.Om(e);;){var m=b+1<<1,h=m-1,r=null;if(h<f){var n=a.Om(a.content[h]);n<k&&(r=h)}m<f&&a.Om(a.content[m])<(null===r?k:n)&&(r=m);if(null!==r)a.content[b]=a.content[r],a.content[r]=e,b=r;else break}}var r=l("__mat3"),A=l("__vec3"),h=new Float32Array(3),w=new Float32Array(9),m=new Float32Array(9),k=new Float32Array(9),f=new Float32Array(9);a.y5=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];
return b};a.z5=function(a,b){b=b||new Float32Array(3);return A.copy(a,b)};a.LL=function(a,b){A.copy(b,a)};a.lD=function(a,b){A.normalize(b,h);a[3]=h[0];a[4]=h[1];a[5]=h[2]};a.E2=function(a,b,f){f=f||new Float32Array(3);f[0]=a[0]+a[3]*b;f[1]=a[1]+a[4]*b;f[2]=a[2]+a[5]*b};a.wR=function(a,b){b[0]=0;b[1]=0;for(var f=b[2]=0;f<a.length;f+=3)b[0]+=a[f],b[1]+=a[f+1],b[2]+=a[f+2];return A.scale(b,3/a.length,b)};a.pR=function(a,b,f){for(var e=0;e<f.length;e++)f[e]=0;for(e=0;e<a.length;e+=3){var k=a[e]-b[0],
m=a[e+1]-b[1],h=a[e+2]-b[2];f[0]+=k*k;f[1]+=k*m;f[2]+=k*h;f[4]+=m*m;f[5]+=m*h;f[8]+=h*h}f[3]=f[1];f[6]=f[2];f[7]=f[5];for(e=0;e<f.length;e++)f[e]*=3/a.length;return f};a.kU=function(a,b){var h=r.copy(a,w);if(5E-4>e(h))return r.identity(b);var l=n(h,m),J=r.transpose(l,k);r.multiply(h,J,f);r.multiply(l,f,h);for(var K=r.copy(l,b),D=1;5E-4<=e(h)&&100>D;)l=n(h,m),J=r.transpose(l,k),r.multiply(h,J,f),r.multiply(l,f,h),r.multiply(l,K,K),D++;return K};a.sg=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+
b[3]};a.aR=function(a){return{content:[],Om:a}};a.gG=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.bR=function(a){var b=a.content[0],f=a.content.pop();0<a.content.length&&(a.content[0]=f,y(a,0));return b};a.C2=function(a,c){var f=a.content.indexOf(c),e=a.content.pop();f!==a.content.length-1&&(a.content[f]=e,a.Om(e)<a.Om(c)?b(f):y(f))};a.cR=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__objects=function(a,l){function n(a){var b=a.I;a=a.k;for(var c=0;c<b.length;c++){var d=b[c].yb;d.s.outline&&a.ih&&P.TX(d)}}function e(a){a.k.ih=0;a=S.indexOf(a);-1!=a&&S.splice(a,1)}function b(a){if(a.Qn)for(var b=a.I,c=0;c<b.length;c++)P.dN(b[c].yb,a)}function y(a,b){for(var c=a.I,d=b.I,g=0;g<c.length;g++){for(var q=!1,f=0;f<d.length;f++)if(c[g].yb==d[f].yb){q=!0;break}q||r(b,c[g].yb)&&z.Zp(b,c[g].yb)}}function r(a,b){return!b.yF&&"SPEAKER"==a.type||!b.dQ&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function A(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.lz||a.parent&&a.parent.lz)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,g=a.b4w_collision,q=a.b4w_vehicle,f=a.b4w_floating,e=a.b4w_character,t=d.AV(a),u=L.oG(a),k=0<a.data.b4w_shape_keys.length,B=a.b4w_dynamic_geometry;if(!(c=v.pG(a,b)||c||g||q||k||f||t||e||u||B))a:{c=a.data;for(g=0;g<c.materials.length;g++)if(q=c.materials[g],q.b4w_water||q.b4w_lens_flares||h(q.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
L.oG(a),g=a.b4w_do_not_batch,q=Boolean(a.b4w_anchor),v.pG(a,b)||c||g||q;default:return!0}}function h(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,g=c.convert_to,q=c.outputs[0];if(!(!q.is_linked||"WORLD"==d&&"CAMERA"==g||"CAMERA"==d&&"WORLD"==g||"OBJECT"==d&&"OBJECT"==g))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,q=c.outputs[0],q.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(q=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||q.is_linked||d.is_linked))return!0}return!1}function w(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.s.type==v.cz||c.s.type==v.bz&&"ARMATURE"==b.type||c.s.type==v.XO&&"LAMP"==b.type||c.s.type==v.WO&&"WORLD"==b.type)&&b.Ng.push(v.yJ(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Ng.push(v.yJ(null,d.action));"MESH"==b.type&&b.Ng.push.apply(b.Ng,v.PU(a))}function m(a,b,c){b=aa[b]||
[];for(var d=[],g=0;g<b.length;g++){var q=b[g];if(q.k.Ue==c||-1==c)for(var f=q.I,e=0;e<f.length;e++)f[e].yb==a&&d.push(q)}return d}function k(a,b,c,d,g){for(var q=null,f=0;f<b.length;f++){var e=b[f];if(!((c?e.Em:e.name)!=a||e.k.Ue!=d&&-1!=d||g&&!e.Kj||(q=e,z.Ri(q))))break}return q}function f(a){aa.ALL.push(a);aa[a.type]||(aa[a.type]=[]);aa[a.type].push(a);var b=a.k.Ed;if(null!=b)for(var c=0;c<ba.length;c++){var d=ba[c];d.k.Ed==b&&d.ss.push(a)}}var v=l("__animation"),c=l("__batch"),C=l("__boundings"),
O=l("__camera"),J=l("__config"),K=l("__constraints"),D=l("__geometry"),Q=l("__lights"),L=l("__nla"),H=l("__nodemat"),z=l("__obj_util"),d=l("__particles"),p=l("__physics"),M=l("__print"),x=l("__primitives"),g=l("__quat"),P=l("__scenes"),t=l("__sfx"),da=l("__transform"),G=l("__textures"),F=l("__tsr"),U=l("__util"),R=l("__vec3"),Z=l("__armature"),u=l("__anchors"),ga=l("__renderer"),ca=J.B,E=J.Vc,aa={ALL:[]},ia=new Float32Array(24),q=0,T=0,ba=[],S=[],sa=new Float32Array(3),oa=new Float32Array(4);a.ny=
0;a.my=1;a.Oc=2;a.oc=-1;a.update=function(a){for(var b=0;b<S.length;b++){var c=S[b],d=c,g=a,q=0,f=d.yK;0==f.qx&&(f.qx=g);g-=f.qx;if(f.PC&&g/f.Lf>=f.PC)e(d);else{g%=f.Lf;if(g<f.uC)switch(f=g/(f.uC/5),g=Math.floor(f),g){case 0:q=(f-g)/2;break;case 1:q=(f-g)/2+.5;break;case 2:q=1;break;case 3:q=1-(f-g)/2;break;case 4:q=.5-(f-g)/2}d.k.ih=q}c.k.ih&&n(c)}if(a=aa.ARMATURE)for(b=0;b<a.length;b++)c=a[b],c.mC&&(da.D(c),c.mC=!1)};a.KL=function(a,b){a.k.ih=b;n(a)};a.zn=function(a,b,c,d){var g=a.yK;g.qx=0;g.uC=
b;g.Lf=c;g.PC=d;-1==S.indexOf(a)&&S.push(a)};a.lu=e;a.Wk=function(a,b){b.wj=a.uuid;b.Kj=!0;w(a,b);a.lz=b.Sa=A(a,b);a.eQ=!0;b.af=a.b4w_vehicle;b.ig=a.b4w_character;b.rm=a.b4w_floating;b.bn=a.b4w_collision;b.bc=a.b4w_collision_id;b.su=a.b4w_correct_bounding_offset;var d=a.game;b.jh={es:d.physics_type,Xs:d.use_ghost,sN:d.use_sleep,Zh:d.mass,yN:d.velocity_min,xN:d.velocity_max,vH:d.damping,iL:d.rotation_damping,zW:d.lock_location_x,AW:d.lock_location_y,BW:d.lock_location_z,DW:d.lock_rotation_x,EW:d.lock_rotation_y,
FW:d.lock_rotation_z,Dq:d.collision_margin,Bq:d.collision_group,Eq:d.collision_mask,iE:d.use_collision_bounds,ou:d.collision_bounds_type,Ts:d.use_collision_compound};if(d=a.b4w_vehicle_settings)b.of={name:d.name,gf:d.part,yZ:d.suspension_rest_length,ID:d.suspension_compression,KD:d.suspension_stiffness,JD:d.suspension_damping,tE:d.wheel_friction,ZC:d.roll_influence,ZB:d.max_suspension_travel_cm,ir:d.force_max,oq:d.brake_max,Vo:d.steering_max,lo:d.max_speed_angle,Uq:d.delta_tach_angle,Ks:d.speed_ratio,
Ms:d.steering_ratio,Er:d.inverse_control,Vl:d.floating_factor,gn:d.water_lin_damp,hn:d.water_rot_damp,EM:d.synchronize_position};if(d=a.b4w_floating_settings)b.Rn={name:d.name,gf:d.part,Vl:d.floating_factor,gn:d.water_lin_damp,hn:d.water_rot_damp,EM:d.synchronize_position};if(d=a.b4w_character_settings)b.CG={X_:d.walk_speed,$X:d.run_speed,rZ:d.step_height,fW:d.jump_strength,Z_:d.waterline};for(d=0;d<a.constraints.length;d++){var g=a.constraints[d];"RIGID_BODY_JOINT"==g.type&&b.CC.push({target:g.target.pb,
mX:g.pivot_type,nX:g.pivot_x,oX:g.pivot_y,pX:g.pivot_z,Ga:g.axis_x,Ha:g.axis_y,Ia:g.axis_z,J_:g.use_limit_x,K_:g.use_limit_y,L_:g.use_limit_z,F_:g.use_angular_limit_x,G_:g.use_angular_limit_y,H_:g.use_angular_limit_z,pW:g.limit_max_x,qW:g.limit_max_y,rW:g.limit_max_z,sW:g.limit_min_x,tW:g.limit_min_y,uW:g.limit_min_z,jW:g.limit_angle_max_x,kW:g.limit_angle_max_y,lW:g.limit_angle_max_z,mW:g.limit_angle_min_x,nW:g.limit_angle_min_y,oW:g.limit_angle_min_z})}d=b.k=z.Nq("MESH"===b.type?b.Sa?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.pb,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.bs=a.parent_bone),a.pinverse_tsr&&(b.xw=F.create(),F.copy(a.pinverse_tsr,b.xw))):a.dg_parent&&(b.parent=a.dg_parent.pb,b.xk=!0);var g=a.location,e=a.scale[0];U.JC(a.rotation_quaternion,oa);da.Wc(b,g);da.gi(b,oa);da.Mf(b,e);b.Vs=a.b4w_use_default_animation;b.rl=v.rz(a.b4w_anim_behavior);a.b4w_object_tags&&(b.bw={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,I2:a.b4w_object_tags.category});
a.b4w_viewport_alignment&&(b.Jx={hQ:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":Z.Wk(a,b);g=d.Hg;e=v.sR(g);a.b4w_animation_mixing?(d.ne=new Float32Array(e.Eb),d.Ge=new Float32Array(e.Eb),d.se=new Float32Array(e.trans),d.Je=new Float32Array(e.trans)):(d.ne=e.Eb,d.Ge=e.Eb,d.se=e.trans,d.Je=e.trans);for(var u in g){var k=g[u];1==k.ju.length&&Z.b_(k,!0,e.trans,e.Eb)}d.ls=e;d.Ye=0;d.Ai=a.b4w_animation_mixing;break;case "MESH":d.Ln=a.b4w_do_not_render;
d.vl=c.YQ(a.data.b4w_boundings.bb);d.Dk=E.outlining_overview_mode||a.b4w_selectable;d.pw=a.b4w_selectable;d.Vc=E.outlining_overview_mode||a.b4w_outlining;d.ow=a.b4w_outlining;d.qw=E.outlining_overview_mode||a.b4w_outline_on_select;d.Gg=a.b4w_billboard;d.iq=a.b4w_pres_glob_orientation;d.kq="BASIC";d.jq="SPHERICAL"==a.b4w_billboard_geometry;u=d.ai;u.rk=a.b4w_outline_settings.outline_duration;u.tk=a.b4w_outline_settings.outline_period;u.uk=a.b4w_outline_settings.outline_relapses;d.Dk&&(d.Nj=U.$H(q),
q++);for(u=0;u<a.data.b4w_vertex_anim.length;u++)g=a.data.b4w_vertex_anim[u],b.Zc.push({name:g.name,va:g.frame_start,ab:g.frame_end,z2:g.averaging,A2:g.averaging_interval,iQ:g.allow_nla});b.k.Zc=b.Zc.length?!0:!1;"MESH"!=a.type&&U.q("Wrong object type: "+a.name);u=b.k;if(a.data.b4w_shape_keys.length)for(u.Le=!0,g=0;g<a.data.b4w_shape_keys.length;g++)e={},e.value=a.data.b4w_shape_keys[g].value,e.name=a.data.b4w_shape_keys[g].name,u.ii.push(e);else u.Le=!1;d.He=a.b4w_shadow_cast;d.fe=a.b4w_shadow_receive;
d.qe=a.b4w_shadow_cast_only&&d.He;d.ee=a.b4w_reflexible;d.Hd=a.b4w_reflexible_only&&d.ee;d.Gd=a.b4w_reflective;d.lh=a.b4w_reflection_type;if(!d.Gd)for(u=a.data.materials,g=0;g<u.length;g++)e=u[g],e.use_nodes&&-1!=e.node_tree.kz.indexOf("BSDF_GLOSSY")&&(d.Gd=!0,d.lh="CUBE");d.Kg=a.b4w_caustics;if(d.rf=a.b4w_wind_bending)d.kn=a.b4w_wind_bending_angle,u=c.$_(a.b4w_wind_bending_angle,d.vl,a.scale[0]),d.th=u,d.uh=a.b4w_wind_bending_freq,d.Pg=a.b4w_detail_bending_freq,d.Og=a.b4w_detail_bending_amp,d.Jg=
a.b4w_branch_bending_amp,d.Yi=a.b4w_main_bend_stiffness_col,u=a.b4w_detail_bend_colors,d.Ae.MB=u.leaves_stiffness_col,d.Ae.LB=u.leaves_phase_col,d.Ae.vC=u.overall_stiffness_col;d.Uh=a.b4w_hidden_on_load;d.ag=a.b4w_dynamic_geometry;"MESH"!==a.type&&U.q("Wrong object");u=a.data.materials[0];d.Yl=u.physics.friction;d.Rl=u.physics.elasticity;d.bh=0;d.ef=z.Ip;d.dh=a.b4w_lod_transition;d.ww=a.pass_index;break;case "LINE":d.R=C.Qd();d.ba=C.Lg();d.Ua=C.Qd();d.qb=C.Lg();break;case "CAMERA":O.zR(a,b);O.OQ(b);
break;case "LAMP":Q.gW(a,b);break;case "SPEAKER":b.X=t.JS();d=!1;for(u=0;u<b.I.length;u++)if(b.I[u].yb.Rc){d=!0;break}d&&t.Wk(a,b);break;case "EMPTY":u=C.Qd(),d.R=u,u=C.Kh(),d.wa=u,a.field&&(b.Qn={type:a.field.type,xM:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,Kn:a.b4w_anchor.detect_visibility,Uj:a.b4w_anchor.element_id,RW:a.b4w_anchor.max_width})}f(b)};a.B_=function(a,b){b.wj=a.uuid;b.Kj=!0;w(a,b);a.lz=b.Sa=A(a,b);a.eQ=!0;b.k=z.Nq(b.type);b.Vs=a.b4w_use_default_animation;
b.rl=v.rz(a.b4w_anim_behavior);f(b)};a.o_=function(a,b){var c=b.k;if(b.parent){!b.xk&&b.jh.Ts&&b.parent.jh.Ts&&(b.bn=!1);for(var d=!1,q=0;q<b.I.length;q++)if(b.I[q].yb.zc){d=!0;break}if(q=d)q=b.jh,q=b.af||b.rm||p.ig(b)||b.bn&&!q.Xs&&0<q.Zh&&("DYNAMIC"==q.es||"RIGID_BODY"==q.es);if(q)q=b.xk?F.copy(c.n,F.create()):c.n,F.multiply(b.parent.k.n,q,c.n),da.Wc(b,F.G(c.n)),da.Mf(b,F.Yd(c.n)),da.gi(b,F.P(c.n));else if(b.xk||!b.bs)if(q=F.copy(c.n,F.create()),b.Jx&&"CAMERA"==b.parent.type){q={distance:b.Jx.distance,
rotation:F.P(q)};switch(b.Jx.hQ){case "TOP_LEFT":q.top=0;q.left=0;break;case "TOP":q.top=0;q.left=.5;break;case "TOP_RIGHT":q.top=0;q.right=0;break;case "LEFT":q.top=.5;q.left=0;break;case "CENTER":q.top=.5;q.left=.5;break;case "RIGHT":q.top=.5;q.right=0;break;case "BOTTOM_LEFT":q.bottom=0;q.left=0;break;case "BOTTOM":q.bottom=0;q.left=.5;break;case "BOTTOM_RIGHT":q.bottom=0,q.right=0}K.tz(b,b.parent,q)}else K.mQ(b,b.parent,q);else q=F.copy(c.n,F.create()),K.nQ(b,b.parent,b.bs,q)}if("ARMATURE"==b.type)for(d=
a.pose.bones,q=0;q<d.length;q++){var e=d[q],u=e.constraints;if(u)for(var t=0;t<u.length;t++){var k=u[t];"COPY_TRANSFORMS"!=k.type||k.subtarget||k.mute||K.zQ(b,k.target.pb,e.name,U.lF,U.sn)}}if("MESH"==b.type)var E=v.oI(a);if(E){u=E.pb;q=u.k.ls;d=b.k;e=a.data;b.Xt=u;e=e.vertex_groups;if(e.length){var u=u.k.Hg,t=0,k={},B;for(B in u){var m=U.Dd("name",B,e);m&&(k[B]={BN:m.index,Jj:u[B].Jj,CA:t++})}d.Di=k;B=t;e=v.DI();d.eh=B;B>2*e?(d.hk=!1,M.error('too many bones for "'+a.name+'" / '+d.eh+" bones (max "+
e+" with blending, "+2*e+" without blending). Skinning will be disabled.")):d.hk=!0}B=v.bU(q.trans,q.Eb,c.Di);E.b4w_animation_mixing?(c.ne=new Float32Array(B.Eb),c.Ge=new Float32Array(B.Eb),c.se=new Float32Array(B.trans),c.Je=new Float32Array(B.trans)):(c.ne=B.Eb,c.Ge=B.Eb,c.se=B.trans,c.Je=B.trans);c.aq=new Float32Array(4);c.$p=g.create();c.ls=B;c.Ye=0}if(c.Gd)if(c=b.k,"CUBE"==c.lh)c.Rd=T++;else if("PLANE"==c.lh){a:{E=a.constraints;for(B=0;B<E.length;B++)if(q=E[B],"LOCKED_TRACK"==q.type&&"REFLECTION PLANE"==
q.name){if(q.target.pb){E=q.target.pb;break a}M.warn('Reflection plane target "'+q.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}E=null}E||(E=U.Ps("%reflection%"),E=z.Mq(E,"EMPTY"),B=z.Nq("EMPTY"),E.k=B,y(b,E),K.KF(E,b,[0,0,0],null,1),f(E));B=null;for(q=0;q<ba.length;q++)if(ba[q]==E){B=q;break}null==B&&(B=ba.length,ba.push(E));E.k.Ed=B;c.Ed=B;E.ss.push(b)}};a.j_=b;a.p3=y;a.JR=r;a.p_=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=
c.k.type&&"CAMERA"!=c.k.type||da.D(c);c.Vs&&v.wK(c)&&(v.Vt(c),c.ja.length&&v.play(c,null,v.kl))}};a.bv=function(a){return U.S(a.bw)};a.ua=function(){T=q=0;ba.length=0;S.length=0;aa={ALL:[]}};a.copy=function(a,b,d){var g=b,e=z.Ri(a);b=e?z.aI(e.name,b):b;if(k(b,aa.ALL,!1,-1)){for(var e=1,u;;){u="."+(3>String(e).length?("000"+String(e)).slice(-3):String(e));if(!k(b+u,aa.ALL,!1,-1))break;e++}M.error('Object "'+b+'" already exists. Name was replaced by "'+b+u+'".');g+=u;b+=u}g=z.Mq(b,a.type,g);g.Kj=a.Kj;
g.Sa=a.Sa;g.Gr=a.Gr;g.Vs=a.Vs;g.Ng=a.Ng;g.k=z.Wz(a.k);g.bw=z.ru(a.bw);y(a,g);g.Qt=z.cA(a.Qt);g.parent=z.cA(a.parent);g.xk=a.xk;g.bs=a.bs;g.Zc=z.cA(a.Zc);g.rl=a.rl;!a.C||a.af||a.ig||a.rm||(g.bn=a.bn,g.C=null);g.bc=a.bc;g.su=a.su;g.jh=z.ru(a.jh);b=[];for(e=0;e<a.I.length;e++){u=g.I[e];var t=a.I[e].W;if(d){for(var p=u.W,E=0;E<t.length;E++)if(!t[E].eg){var m=z.ru(t[E]);m.Ca=D.eS(t[E].Ca);p.push(m);b.push(t[E].Ca)}for(E=0;E<t.length;E++)if(t[E].eg){m=z.ru(t[E]);p.push(m);for(var B=0;B<b.length;B++)b[B]==
t[E].Ca&&(m.Ca=p[B].Ca)}for(E=0;E<p.length;E++)p[E].Ca&&D.eN(p[E].Ca),ca.oz&&ga.SQ(p[E]),p[E].pk=g.wj,c.XZ(p[E]);G.WY(p)}else u.W=t;for(E=0;E<u.W.length;E++)for(t=u.W[E].ya,p=0;p<t.length;p++)G.Cv(t[p])}d||(g.k.ip=!1);z.bD(g,!1);f(g);g.k.Hv=!0;g.k.Iv=d;g.k.Nj=U.$H(q);q++;return g};a.c_=function(a){for(var b=a.k,d=a.I[0].W,g,q,f,e,u,t,k,B,p,E,m,F,v=[],h=0;h<d.length;h++){var G=d[h];if("MAIN"==G.type){var S=D.xr("a_position"),S=D.hv(G.Ca.tc,S),P=G.Ca.kd.a_position.offset;g=e=S[P];q=u=S[P+1];f=t=S[P+
2]}}for(h=0;h<d.length;h++)if(G=d[h],G.Ca&&G.qb&&G.Ua){var S=D.xr("a_position"),S=D.hv(G.Ca.tc,S),P=G.Ca.kd.a_position.offset,T=G.Ca.kd.a_position.length+P;k=E=S[P];B=m=S[P+1];p=F=S[P+2];for(var R=P;R<T;R+=3){var P=S[R],U=S[R+1],r=S[R+2];k=Math.max(P,k);B=Math.max(U,B);p=Math.max(r,p);E=Math.min(P,E);m=Math.min(U,m);F=Math.min(r,F)}G.R.max_x=k.toFixed(3);G.R.max_y=B.toFixed(3);G.R.max_z=p.toFixed(3);G.R.min_x=E.toFixed(3);G.R.min_y=m.toFixed(3);G.R.min_z=F.toFixed(3);C.Al(G.R,b.n,G.Ua);C.NH(G.Ua,
ia);for(S=v.length=0;S<ia.length;S++)v.push(ia[S]);G.qb=C.tu(v,!0);G.ba=C.nR(G.qb,b.n);G.wa=C.Kq(G.ba);G.lb=C.Kq(G.qb);G.Sf=C.FB(G.ba,G.wa);"MAIN"==G.type&&(g=Math.max(k,g),q=Math.max(B,q),f=Math.max(p,f),e=Math.min(E,e),u=Math.min(m,u),t=Math.min(F,t))}v={max_x:parseFloat(g.toFixed(3)),max_y:parseFloat(q.toFixed(3)),max_z:parseFloat(f.toFixed(3)),min_x:parseFloat(e.toFixed(3)),min_y:parseFloat(u.toFixed(3)),min_z:parseFloat(t.toFixed(3))};E=g-e;B=q-u;k=f-t;e=.5*(g+e);p=.5*(q+u);m=.5*(f+t);var ga=
e,I=m;u=Math.max(E,Math.max(B,k))/2;t=Math.max(E,k)/2;var V=[e/(E?E:1),p/(B?B:1),m/(k?k:1)];F=.5;if(b.Gg)P=Math.max(Math.abs(v.max_x),Math.abs(v.min_x)),U=Math.max(Math.abs(v.max_y),Math.abs(v.min_y)),r=Math.max(Math.abs(v.max_z),Math.abs(v.min_z)),f=Math.sqrt(P*P+U*U+r*r),h=Math.sqrt(P*P+U*U),v.max_x=v.max_y=v.max_z=f,v.min_x=v.min_y=v.min_z=-f,t=h,u=f,P=new Float32Array([0,0,0]),g=new Float32Array([u,u,u]),f=new Float32Array([0,0,0]);else{for(h=0;h<d.length;h++)if(G=d[h],"MAIN"==G.type)for(S=D.xr("a_position"),
S=D.hv(G.Ca.tc,S),T=d[h].Ca.kd,P=T.a_position.offset,T=T.a_position.length+P,R=P;R<T;R+=3){var P=S[R],U=S[R+1],r=S[R+2],X=Math.sqrt((e-P)*(e-P)+(p-U)*(p-U)+(m-r)*(m-r));if(X>u){var G=e-u*(P-e)/X,n=p-u*(U-p)/X,X=m-u*(r-m)/X;e=(G+P)/2;p=(n+U)/2;m=(X+r)/2;u=Math.sqrt((e-P)*(e-P)+(p-U)*(p-U)+(m-r)*(m-r))}n=Math.sqrt((ga-P)*(ga-P)+(I-r)*(I-r));n>t&&(G=ga-t*(P-ga)/n,X=I-t*(r-I)/n,ga=(G+P)/2,I=(X+r)/2,t=Math.sqrt((ga-P)*(ga-P)+(I-r)*(I-r)));P/=E?E:1;U/=B?B:1;r/=k?k:1;X=Math.sqrt((V[0]-P)*(V[0]-P)+(V[1]-
U)*(V[1]-U)+(V[2]-r)*(V[2]-r));X>F&&(G=V[0]-F*(P-V[0])/X,n=V[1]-F*(U-V[1])/X,X=V[2]-F*(r-V[2])/X,V[0]=(G+P)/2,V[1]=(n+U)/2,V[2]=(X+r)/2,F=Math.sqrt((V[0]-P)*(V[0]-P)+(V[1]-U)*(V[1]-U)+(V[2]-r)*(V[2]-r)))}h=E?E*V[0]:g;q=B?B*V[1]:q;f=k?k*V[2]:f;g=F*E;S=F*B;T=F*k;P=new Float32Array([e,p,m]);g=new Float32Array([g,S,T]);f=new Float32Array([h,q,f]);t=parseFloat(t.toFixed(3))}b.R=v;c.yY(b,t,t,v);v=C.Hz(u,P);b.wa=v;v=C.hq([g[0],0,0],[0,g[1],0],[0,0,g[2]],f);b.ba=v;da.D(a);if(ca.debug_view)for(h=0;h<d.length;h++)if("DEBUG_VIEW"===
d[h].type&&d[h].Li){a=x.Xu(1,v.F);D.mL(a,[v.Ga[0],v.Ha[1],v.Ia[2]],v.F);D.px(a,1,!0);a.qa.a_polyindex=D.Pu(a);c.WZ(d[h],a);break}};a.Ub=m;a.TI=function(a,b,c){b=aa[b]||[];for(var d=[],g=0;g<b.length;g++){var q=b[g];if((q.k.Ue==c||-1==c)&&q.Kj)for(var f=q.I,e=0;e<f.length;e++)f[e].yb==a&&d.push(q)}return d};a.cm=function(a){var b=aa.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var g=b[d];g.k.Ue==a&&c.push(g)}return c};a.hm=function(a){var b=aa.MESH;if(b)for(var c=0;c<b.length;c++){var d=
b[c];if(p.ig(d))for(var g=d.I,q=0;q<g.length;q++)if(g[q].yb==a)return d}return null};a.eZ=function(a){var b=m(a,"LAMP",-1);if(b.length==a.s.m7){for(var c=[],d=0;d<b.length;d++){var g=b[d],g=z.ka(g,a);c[g.xm]=d}for(d=0;d<c.length-1;d++)for(g=d+1;g<c.length;g++){var q=b[c[d]].ub,f=b[c[g]].ub;if(f.an&&f.cn&&(!q.an||!q.cn)||!q.an&&(f.an||!q.cn&&f.cn))q=c[d],c[d]=c[g],c[g]=q}for(d=0;d<c.length;d++)g=b[c[d]],z.ka(g,a).xm=d,P.hp(b[c[d]],a)}};a.mw=function(a,b,c,d){for(var g=0;g<a.I.length;g++)for(var q=
a.I[g].W,f=0;f<q.length;f++){var e=q[f];e.Ca.Yf=b;e.Yf=b;e.zb.Yf=c;""!==e.nk&&(e=H.GI(e.nk))&&(e.NG=d)}};a.UI=function(){var a=[],b=aa.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.Dk&&d.Kj&&a.push(d)}return a};a.v5=function(){var a=[],b=aa.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.Vc&&d.Kj&&a.push(d)}return a};a.xc=function(b,c,d,g){var q=null,f=aa.ALL;switch(b){case a.ny:q=k(c,f,!0,d,g);break;case a.my:a:{for(b=0;b<f.length;b++)if(q=f[b],q.Em==d&&(q.k.Ue==g||-1==g)){var e=z.Ri(q);
if(e&&e.Em==c)break a}q=null}break;case a.Oc:a:{for(g=0;g<f.length;g++){b=f[g];for(var q=c.length-1,e=b,u=!0;0<=q&&u;)u=e&&e.Em==c[q]&&(e.k.Ue==d||-1==d),e&&(e=z.Ri(e)),q--;if(u&&!e){q=b;break a}}q=null}}return q};a.iv=function(a,b){return k("%meta_world%"+a,aa.WORLD,!0,b)};a.fs=function(b,c){var d=P.Rh();if(!d)return M.error("No active scene"),null;var g=u.kX(b,c);if(g)return g;g=P.lX(d,b,c);if(!g)return null;for(var d=m(d,"MESH",-1),q=0;q<d.length;q++){var f=d[q].k,e=f.Nj;if(e&&3>Math.abs(255*e[0]-
g[0])&&3>Math.abs(255*e[1]-g[1])&&3>Math.abs(255*e[2]-g[2]))return f.Vc&&f.qw&&(E.outlining_overview_mode?a.zn(d[q],E.rk,E.tk,E.uk):(g=f.ai,a.zn(d[q],g.rk,g.tk,g.uk))),d[q]}return null};a.VL=function(a,c){for(var d=m(a,"EMPTY",-1),g=0;g<d.length;g++){var q=d[g];if(q.Qn&&"WIND"===q.Qn.type){var f=q;break}}if(!f)return M.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=U.Cb(c.wind_dir),R.set(Math.sin(d),-Math.cos(d),0,sa),U.FA(sa,U.nc,oa),da.gi(f,oa));"number"==typeof c.wind_strength&&
(f.Qn.xM=c.wind_strength);b(f)};a.ts=function(a){K.LR(a)&&K.remove(a);var b=aa.ALL,c=aa[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.cX=f;a.dX=function(a){return aa[a.type]&&-1<aa[a.type].indexOf(a)}};b4w.module.__animation=function(a,l){function n(a,b){var c=a.ja[b];c&&c.VA&&c.dr&&(c.dr=!1,c.VA(a,b))}function e(a,b,c){c=a.ja[c];c.type=30;var d=b.va,g=b.ab-d+1;c.start=d;c.length=g;c.Bf=d;c.Bi=b.name;for(g=d=0;g<a.Zc.length;g++){var q=a.Zc[g];if(q==b)break;else d+=q.ab-q.va+1}c.tN=d}function b(a,b){a.type=50;a.Bi=b.name;a.start=b.va;a.length=b.ab-a.start;b.ze||(a.length+=b.OB)}function y(a){return a.replace(/_B4W_BAKED$/,"")}function r(a,b){return{po:a,action:b}}function A(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.s.type&&b.push(r(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var g=a[d];if(g.node_group){var q=g.node_group.node_tree;if(q){var f=c.slice();f.push(g.name);A(q,b,f)}}}}function h(a){return E.$d(a)&&a.k.Zc?!0:!1}function w(a,b,c){var d=a.ja;if(-1==c)for(c=0;8>c;c++){var g=d[c];g&&(g.Bf=b,k(a,0,c,!0))}else if(g=d[c])g.Bf=b,k(a,0,c,!0)}function m(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function k(a,b,c,d){D(a,b,c,d);n(a,c);a.k.Ai&&(H(a,b),L(a,
b))}function f(a,b,g,f){var e=g.frame_range;if(e[0]>e[1])return q.warn('Incompatible action "'+g.name+'" has been applied to object "'+a.name+'"'),!1;var B=g.s,u=a.ja[f];u.Bi=g.name;u.mz=e;u.DF=B.FK;u.BF=B.fG;u.Fi.set(B.Fi);u.start=e[0];u.length=e[1]-e[0];u.Bf=e[0];switch(B.type){case 10:if(E.pm(a)){u.type=10;var t=v(a,b,g);if(!t){for(var t=a.k.Hg,e=[],k=[],I=g.s.pC,V=0;V<I;V++){for(var X in t){var p=t[X],m=p.tx,F=g.s.Dz[X];F?ya.copy(F.subarray(8*V,8*V+8),m):ya.identity(m);p.ux=!1}p=z(t);e.push(p.trans);
k.push(p.Eb)}t={trans:e,Eb:k};c(a,b,g,t)}u.trans=t.trans;u.Eb=t.Eb;b=t;u=a.k;t=u.No;e=a.ja[f];X=e.yD;a:{k=u.bx;for(I=0;I<k.length;I+=2)if(g==k[I]){k=k[I+1];break a}k=null}if(k)e.yD=k;else{for(e=0;e<t.length;e++){k=t[e].Di;I=[];V=[];p=b.trans;m=b.Eb;for(F=0;F<p.length;F++){var h=d(p[F],m[F],k);I.push(h.trans);V.push(h.Eb)}X.push({trans:I,Eb:V})}u.bx.push(g,X)}u.Ai&&(g=u.fp,f>g[1]?(b=g[1],g[1]=f,g[0]=b):f>g[0]&&f<g[1]&&(g[0]=f),C(a))}break;case 40:E.Jr(a)&&(u.volume=B.rb.volume||null,u.pitch=B.rb.pitch||
null,u.type=40);break;case 70:E.Zg(a)&&(u.color=B.rb.color||null,u.Df=B.rb.energy||null,u.type=70);break;case 60:if("MESH"==a.type){u.type=60;X=v(a,b,g);if(!X){X=[];e=[];k=[];I=[];V=[];p=g.s;m=b?b[0]:null;for(t in p.rb){F=b;h=t.match(/"(.*?)"/)[1];if(F&&1<F.length){for(var G=F[1],P=2;P<F.length;P++)G=G+"%join%"+F[P];G+="%join%"+h}else G=h;F=G;for(h=0;h<a.I.length;h++)for(G=a.I[h].W,P=0;P<G.length;P++){var S=G[P];if(!m||-1!=S.sd.indexOf(m)){var ca=S.cj,T=J(t,F,p,e,X,S.dj),ca=J(t,F,p,I,k,ca);(T||ca)&&
V.push(S)}}}X={M_:X,values:e,VX:k,WX:I,jw:V};c(a,b,g,X)}u.dj=X.M_;u.qK=X.values;u.cj=X.VX;u.pK=X.WX;u.jw=X.jw}break;case 20:if(t=B.rb.tsr){u.type=20;X=v(a,b,g);if(!X){X=g.s.pC;e=[];k=[];for(I=0;I<X;I++)e.push(t.subarray(8*I,8*I+4)),k.push(t.subarray(8*I+4,8*I+8));X={trans:e,Eb:k};c(a,b,g,X)}u.trans=X.trans;u.Eb=X.Eb;aa.qC(a)&&aa.A_(a,u.trans[0],u.Eb[0])}else return q.warn('Incompatible action "'+g.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:E.IB(a)&&(u.Df=B.rb["light_settings.environment_energy"]||
null,u.ke=B.rb.horizon_color||null,u.te=B.rb.zenith_color||null,u.hr=B.rb["mist_settings.intensity"]||null,u.fog_depth=B.rb["mist_settings.depth"]||null,u.fog_start=B.rb["mist_settings.start"]||null,u.fog_height=B.rb["mist_settings.height"]||null,u.RH=B.rb.b4w_fog_color||null,u.type=80)}E.pm(a)&&10!=B.type&&O(a,f);return!0}function v(a,b,c){a=a.Qt;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}function c(a,b,c,d){a.Qt.push(c,b?b.join("%join%"):
null,d)}function C(a){var b=a.k.fp;if(-1!=b[0]&&-1!=b[1]){var c=a.ja;a=c[b[1]].Bf;var d=Math.floor(a),g=a-d,b=c[b[0]];a=b.Bf;d=Math.floor(a);b.Bf=d+g}}function O(a,b){var c=a.k.fp,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var g=a.ja;0<=d;d--){var q=g[d];if(q&&10==q.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function J(a,b,c,d,g,q){if(!q)return!1;for(var e=!1,f=0;f<q.length;f+=2)b==q[f]&&(g.push(q[f+1]),d.push(new Float32Array(c.rb[a])),e=!0);return e}function K(a){a=a.s;for(var b in a.rb)if(-1!=
b.indexOf("nodes"))return!0;return!1}function D(a,b,c,d){if((c=a.ja[c])&&null!=c.type&&(c.play||d)){var g=a.k,q=c.Bf,e=c.start,f=c.length,q=q+c.speed*b*Y.rd(),u=c.type,I=c.speed;if(0<=I&&q>=e+f||0>I&&q<e)switch(d||(c.dr=!0),c.behavior){case 10:q=0<=I?(q-e)%f+e:e+f-1E-6;break;case 20:q=0<=I?e:e+f-1E-6;c.play=!1;break;case 30:q=0<=I?e+f-1E-6:e,c.play=!1}c.Bf=q;switch(u){case 10:if(!g.Ai){d=Q(c);b=d[0];var V=d[1];d=d[2];g.ne=c.Eb[b];g.Ge=c.Eb[V];g.se=c.trans[b];g.Je=c.trans[V];g.Ye=d;d=g.No;c=c.yD;for(var X=
0;X<d.length;X++){var t=d[X],k=c[X];t.ne=k.Eb[b];t.Ge=k.Eb[V];t.se=k.trans[b];t.Je=k.trans[V];t.Ye=g.Ye}na.D(a)}break;case 20:d=Q(c);var g=N,V=d[0],X=d[1],t=d[2],k=c.trans,p=k[V][1],q=k[V][2],e=k[X][1],f=k[X][2];g[0]=(1-t)*k[V][0]+t*k[X][0];g[1]=(1-t)*p+t*e;g[2]=(1-t)*q+t*f;V=B;q=d[0];X=d[1];t=d[2];k=c.Eb;p=za;p[0]=k[q][0];p[1]=k[q][1];p[2]=k[q][2];p[3]=k[q][3];q=ua;q[0]=k[X][0];q[1]=k[X][1];q[2]=k[X][2];q[3]=k[X][3];T.slerp(p,q,t,V);X=d[2];t=c.trans;d=(1-X)*t[d[0]][3]+X*t[d[1]][3];a.parent&&a.xw&&
(X=ja,ya.hi(g,d,V,X),ya.multiply(a.xw,X,X),ya.hc(X,g),ya.Xd(X,V),d=ya.Yd(X));c.bE&&(X=ea,na.ie(a,X),wa.jx(g,X,b,c.bE,g));c.KC&&(X=za,na.Sh(a,X),wa.mM(V,X,b,c.KC,V));q=c.Fi;q[0]&&na.Yw(a,g);q[1]&&na.Xw(a,V);q[2]&&na.qD(a,d);na.D(a);ia.H(a);break;case 30:d=c.Bf-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.tN;ma[0]=a+c;ma[1]=b+c;ma[2]=d;d=ma;g.Cx=d[0];g.Dx=d[2];break;case 40:d=Q(c);b=d[0];g=d[1];d=d[2];c.volume&&sa.PY(a,(1-d)*c.volume[b]+
d*c.volume[g]);c.pitch&&sa.tX(a,(1-d)*c.pitch[b]+d*c.pitch[g]);break;case 50:b=10==c.behavior?(q-e)/Y.rd():q/Y.rd();aa.IY(a,c.Bi,b);break;case 60:d=Q(c);b=d[0];g=d[1];d=d[2];k=c.qK;p=c.dj;a=c.pK;V=c.cj;X=c.jw;for(c=0;c<p.length;c++)for(q=k[c],t=p[c],e=(1-d)*q[b]+d*q[g],q=0;q<X.length;q++)X[q].ej[t]=e;for(c=0;c<V.length;c++)for(k=a[c],t=V[c],k=la.lerp(k.subarray(3*b,3*b+3),k.subarray(3*g,3*g+3),d,N),q=0;q<X.length;q++)X[q].Ee[3*t]=k[0],X[q].Ee[3*t+1]=k[1],X[q].Ee[3*t+2]=k[2];break;case 70:d=Q(c);b=
d[0];g=d[1];d=d[2];q=c.Fi;(f=c.Df)&&q[0]&&ca.Bs(a.ub,(1-d)*f[b]+d*f[g]);(c=c.color)&&q[1]&&(N[0]=(1-d)*c[3*b]+d*c[3*g],N[1]=(1-d)*c[3*b+1]+d*c[3*g+1],N[2]=(1-d)*c[3*b+2]+d*c[3*g+2],ca.Vw(a.ub,N));e=a.I;for(c=0;c<e.length;c++)S.k_(a,e[c].yb);break;case 80:d=Q(c);b=d[0];g=d[1];d=d[2];q=c.Fi;e=a.I;I=S.La(e[0].yb,oa.Pb);f=c.Df;f=q[0]?(1-d)*f[b]+d*f[g]:I.Df;u=c.ke;q[1]?(N[0]=(1-d)*u[3*b]+d*u[3*g],N[1]=(1-d)*u[3*b+1]+d*u[3*g+1],N[2]=(1-d)*u[3*b+2]+d*u[3*g+2],u=N):u=I.ke;var E=c.te;q[2]?(ea[0]=(1-d)*E[3*
b]+d*E[3*g],ea[1]=(1-d)*E[3*b+1]+d*E[3*g+1],ea[2]=(1-d)*E[3*b+2]+d*E[3*g+2],I=ea):I=I.te;E=c.hr;q[3]&&(V=(1-d)*E[b]+d*E[g]);E=c.fog_depth;q[4]&&(X=(1-d)*E[b]+d*E[g]);E=c.fog_start;q[5]&&(t=(1-d)*E[b]+d*E[g]);E=c.fog_height;q[6]&&(k=(1-d)*E[b]+d*E[g]);c=c.RH;q[7]&&(B[0]=(1-d)*c[3*b]+d*c[3*g],B[1]=(1-d)*c[3*b+1]+d*c[3*g+1],B[2]=(1-d)*c[3*b+2]+d*c[3*g+2],p=B);for(c=0;c<e.length;c++)b=a.I[c].yb,(q[0]||q[1]||q[2])&&S.Rw(b,f,u,I),q[3]&&S.BL(b,V),q[4]&&S.zL(b,X),q[5]&&S.CL(b,t),q[6]&&S.AL(b,k),q[7]&&S.hD(b,
p);break;default:wa.q("Unknown animation type:"+u)}}}function Q(a){var b=a.mz[0],c=a.mz[1]-b,b=a.Bf-b;0>b&&(b=0);b>=c&&(b=c);b/=a.DF;c=Math.floor(b);a=a.BF[c]?b-c:0;b=Math.ceil(c+a);ma[0]=c;ma[1]=b;ma[2]=a;return ma}function L(a,b){var c=a.k,d=c.Fh,g=c.fp,q=g[0],g=g[1];if(-1!=g){if(-1!=q){var e=a.ja[q];if(e.play||0==b){var f=Q(e),t=f[0],I=f[1];c.Ye=f[2];var f=e.Eb[t],V=e.Eb[I],t=e.trans[t],I=e.trans[I]}else d=1}else d=1;g=a.ja[g];if(g.play||0==b){var q=Q(g),X=q[0],k=q[1];c.Ye=q[2]}else if(-1!=q&&
e.play)d=0;else return;q=g.Eb[X];e=g.Eb[k];X=g.trans[X];k=g.trans[k];if(1==d)c.ne.set(q),c.Ge.set(e),c.se.set(X),c.Je.set(k);else if(0==d)c.ne.set(f),c.Ge.set(V),c.se.set(t),c.Je.set(I);else{for(g=0;g<f.length;g+=4){for(var p=B,E=za,m=0;4>m;m++)p[m]=f[g+m],E[m]=q[g+m];T.slerp(p,E,d,p);for(m=0;4>m;m++)c.ne[g+m]=p[m];for(m=0;4>m;m++)p[m]=V[g+m],E[m]=e[g+m];T.slerp(p,E,d,p);for(m=0;4>m;m++)c.Ge[g+m]=p[m]}wa.iG(t,X,d,c.se);wa.iG(I,k,d,c.Je)}na.D(a);u.x_(a)}}function H(a,b){var c=a.k,d=c.Fh,g=c.Wp;if(0!=
g){var d=c.Vp-d,q=g*b;wa.sign(d)==wa.sign(g)&&Math.abs(q)<Math.abs(d)?c.Fh+=q:(c.Fh=c.Vp,c.Wp=0)}}function z(a){var b=[],c=[],d=new Float32Array(4),g=new Float32Array(4),q;for(q in a){var e=a[q],f=d,u=g,I=e.ju,V=I[I.length-1],X=V.dE;V.ux||ya.identity(X);for(V=I.length-1;0<=V;V--){var B=I[V],t=B.dE;if(B.ux)X=t;else{var k=B.Tk,p=B.tx;ya.invert(k,ja);ya.multiply(p,ja,ja);ya.multiply(k,ja,ja);ya.multiply(X,ja,t);X=t;B.ux=!0}}I=B.dE;f[0]=I[0];f[1]=I[1];f[2]=I[2];f[3]=I[3];u[0]=I[4];u[1]=I[5];u[2]=I[6];
u[3]=I[7];T.normalize(u,u);e=e.Jj;for(f=0;4>f;f++)u=4*e+f,b[u]=d[f],c[u]=g[f]}return{trans:b,Eb:c}}function d(a,b,c){var d=[],g=[];new Float32Array(4);new Float32Array(4);for(var q in c)for(var e=c[q],f=e.Jj,e=e.CA,u=0;4>u;u++){var I=4*e+u,V=4*f+u;d[I]=a[V];g[I]=b[V]}d=new Float32Array(d);g=new Float32Array(g);return{trans:d,Eb:g}}function p(a){var b=a.s,c;if(b.Dz)c=10;else if(b.rb)if("volume"in b.rb||"pitch"in b.rb)c=40;else if(K(a))c=60;else{var d;a:{if(a.s.rb){d=a.fcurves;for(var g in d)if("color"==
g&&!d[g][3]){d=!0;break a}if("energy"==g){d=!0;break a}}d=!1}if(d)c=70;else if(d=a.s.rb,"light_settings.environment_energy"in d||"horizon_color"in d||"zenith_color"in d||"mist_settings.intensity"in d||"mist_settings.depth"in d||"mist_settings.start"in d||"mist_settings.height"in d||"b4w_fog_color"in d)c=80;else{a:{if(a.s.rb)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function K(a){if(a=a.s.rb)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;
return!1}function M(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function x(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function g(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==
c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function P(a,b,c,d,g,q,e){var f=a+(b-a)/2,u=t(f,d,g,q,e)-c;return.02>Math.abs(u)?f:0<u?P(a,f,c,d,g,q,e):P(f,b,c,d,g,q,e)}function t(a,b,c,d,g){var q=1-a;return b*q*q*q+3*c*q*q*a+3*d*q*a*a+g*a*a*a}function da(a,b){var c={type:null,Bi:null,mz:null,DF:0,BF:null,Fi:new Int8Array(8),Eb:null,trans:null,yD:[],play:!1,behavior:20,Bf:0,start:0,length:0,bE:0,KC:0,dr:!1,tN:null,speed:1,volume:null,pitch:null,color:null,Df:null,te:null,ke:null,hr:null,fog_depth:null,fog_start:null,
fog_height:null,RH:null,qK:[],dj:[],pK:[],cj:[],jw:null};if(!a.ja.length)for(var d=0;8>d;d++)a.ja.push(null);a.ja[b]=c;-1==xa.indexOf(a)&&xa.push(a)}function G(a,b){na.D(a);ia.H(a);k(a,0,b,!0)}function F(a,c,d,g){g=g||0;if(E.$d(a)){var u=U(a,d);if(u)return da(a,g),e(a,u,g),G(a,g),!0;if((u=R(a,d))&&"EMITTER"==u.rw){da(a,g);c=u.name;d=g;for(var u=a.I,B=0;B<u.length;B++)for(var t=u[B].W,k=0;k<t.length;k++){var p=t[k].hb;p&&p.name==c&&b(a.ja[d],p)}G(a,g);return!0}}if(u=wa.Dd("name",d,ka)||wa.Dd("name",
d+"_B4W_BAKED",ka)){da(a,g);if(f(a,c,u,g))return G(a,g),!0;a.ja[g]=null}q.error('Unsupported object: "'+a.name+'" or animation name: "'+d+'"');return!1}function U(a,b){for(var c=0;c<a.Zc.length;c++){var d=a.Zc[c];if(d.name===b)return d}return null}function R(a,b){for(var c=a.I,d=0;d<c.length;d++)for(var g=c[d].W,q=0;q<g.length;q++){var e=g[q].hb;if(e&&e.name===b)return e}return null}function Z(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}
var u=l("__armature"),ga=l("__config"),ca=l("__lights"),E=l("__obj_util"),aa=l("__particles"),ia=l("__physics"),q=l("__print"),T=l("__quat"),ba=l("__reformer"),S=l("__scenes"),sa=l("__sfx"),oa=l("__subscene"),Y=l("__time"),na=l("__transform"),ya=l("__tsr"),wa=l("__util"),la=l("__vec3"),ha=ga.sl,ta=ga.Gi;a.CO=1E-6;a.WE=0;a.bz=10;a.cz=20;a.ZE=30;a.YE=40;a.XE=50;a.VE=60;a.XO=70;a.WO=80;a.od=0;a.eF=1;a.fF=2;a.gF=3;a.hF=4;a.iF=5;a.jF=6;a.Gt=7;a.kl=-1;a.Rx=10;a.uE=20;a.Sx=30;var ma=Array(3),N=new Float32Array(3),
ea=new Float32Array(3),B=new Float32Array(4),za=new Float32Array(4),ua=new Float32Array(4),ja=ya.create();new Float32Array(16);var xa=[],ka=[];a.DI=function(){return wa.trunc((ta.Tr-50)/4)};a.VH=function(a){return a/Y.rd()};a.update=function(a){for(var b=0;b<xa.length;b++){for(var c=xa[b],d=0;8>d;d++)D(c,a,d);c.k.Ai&&(H(c,a),L(c,a))}for(b=0;b<xa.length;b++)for(c=xa[b],d=0;8>d&&c.ja.length;d++)n(c,d)};a.MU=function(){return ka};a.iI=function(a){var b=[];if(h(a))for(var c=0;c<a.Zc.length;c++)b.push(a.Zc[c].name);
for(var d=[],c=0;c<ka.length;c++){var g=ka[c],q=g.s;20==q.type?d.push(g):60==g.s.type&&"MESH"==a.type?d.push(g):10==q.type&&"ARMATURE"==a.type?d.push(g):40==q.type&&"SPEAKER"==a.type?d.push(g):80==q.type&&"WORLD"==a.type&&d.push(g)}for(c=0;c<d.length;c++)b.push(y(d[c].name));if(aa.qC(a)&&aa.uK(a))for(a=a.I,c=0;c<a.length;c++)for(d=a[c].W,g=0;g<d.length;g++)(q=d[g].hb)&&b.push(q.name);return b};a.yM=y;a.jI=function(a,b){var c=a.ja[b];return c?c.type:0};a.Vt=function(a){for(var c=0,d=a.I,g=0;g<d.length;g++)for(var q=
d[g].W,u=0;u<q.length;u++){var B=q[u].hb;B&&"EMITTER"==B.rw&&!q[u].eg&&(da(a,c),b(a.ja[c],B),G(a,c),a.ja[c].behavior=B.ze?10:a.rl,c++)}d=a.Ng.slice();for(g=0;g<d.length;g++)u=d[g],q=u.po,u=u.action,da(a,c),f(a,q,u,c)?(G(a,c),a.ja[c].behavior=a.rl,c++):a.ja[c]=null;h(a)&&(da(a,c),e(a,a.Zc[0],c),G(a,c),a.ja[c].behavior=a.rl)};a.rz=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:wa.q("Wrong animation behavior")}};a.PU=function(a){var b=
[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],g=d.node_tree;g&&A(g,b,[d.name])}return b};a.yJ=r;a.play=function(a,b,c){m(a.ja,c,function(a){a.play=!0;a.VA=b?b:null;a.dr=!1});a.k.Ai&&C(a)};a.stop=function(a,b){m(a.ja,b,function(a){a.play=!1;a.VA=null;a.dr=!1})};a.fk=function(a,b){var c=a.ja;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.Go=w;a.gD=function(a,b){b=b||0;m(a.ja,b,function(c){w(a,c.start,b)})};a.sI=function(a,b){var c=a.ja[b];
return c&&c.Bf?c.Bf:0};a.TV=function(a,b){var c=a.ja[b];return c&&10==c.behavior};a.Fo=function(a,b,c){m(a.ja,c,function(a){a.behavior=b})};a.mI=function(a,b){var c=a.ja[b];return c&&c.behavior};a.NF=function(a,b,c,d){m(a.ja,d,function(a){a.bE=b||0;a.KC=c||0})};a.bL=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.ja[c]=null;else a.ja[b]=null;a.k.Ai&&O(a,b)};a.n_=k;a.wK=function(a){if("ARMATURE"==a.type||a.Xt||"WORLD"==a.type)return!0;for(var b=0;b<a.Ng.length;b++){var c=a.Ng[b].action.s.type;if(20==
c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return aa.qC(a)&&aa.uK(a)||"MESH"==a.type&&a.Zc.length?!0:!1};a.pG=function(a,b){if("ARMATURE"==b.type||Z(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.Ng.length;c++){var d=b.Ng[c].action.s.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return aa.iR(a)&&aa.hR(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.Dc=function(a){return Boolean(a.ja.length)};a.sR=z;a.bU=d;a.lQ=
function(a){function b(a,c){for(var d=0;d<c;d++){var I=a.subarray(8*d+4,8*d+8);T.normalize(I,I)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,I=b;else-1<a.indexOf("rotation_quaternion")?(d=4,I=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,I=0):(d=0,I=b);return d+I}function d(a,b,c,I,g){if(-1<c.search(q)){a=b;c=c.split('"')[1];var V=e}else 8==g?(c="tsr",V=e):V=1<g?new Float32Array(g):0;if(!a[c]){g=a;b=c;if("object"==typeof V&&V.length)for(var f=V.length,X=new Float32Array(I*f),u=0;u<I;u++)for(var B=
0;B<f;B++)X[u*f+B]=V[B];else if("number"==typeof V)for(X=new Float32Array(I),u=0;u<I;u++)X[u]=V;else wa.q("Wrong storage default value");g[b]=X}return a[c]}var q=new RegExp(/pose.bones\[\".+\"\]/g),e=ya.create(),f=a.s={type:0,pC:0,FK:0,rb:null,Dz:null,fG:null,Fi:new Int8Array(8)};f.FK=1/ha.Wl;var u=a.fcurves,B={},I={},V=0,X;for(X in u){var t=u[X],k;for(k in t){var E=t[k],m=E.zf;ba.ER(E,a);E=E.num_channels;V||(V=m.length);for(var E=d(B,I,X,V,E),F=E.length/V,v=c(X,k|0),h=0;h<V;h++)E[h*F+v]=m[h]}}if(wa.qr(B)){for(var G in B)"tsr"==
G&&b(B[G],V);f.rb=B}if(wa.qr(I)){for(var P in I)b(I[P],V);f.Dz=I}f.pC=V;f.fG=a.bQ;"tsr"in B&&M(u,f.Fi);("color"in B||"energy"in B)&&x(u,f.Fi);("light_settings.environment_energy"in B||"horizon_color"in B||"zenith_color"in B||"mist_settings.intensity"in B||"mist_settings.depth"in B||"mist_settings.start"in B||"mist_settings.height"in B||"b4w_fog_color"in B)&&g(u,f.Fi);p(a);ka.push(a)};a.OU=function(a,b){return(b-a)*ha.Wl+1};a.KQ=function(a,b,c,d,g,q){var e=new Float32Array(2),f=new Float32Array(2),
u=new Float32Array(2),I=new Float32Array(2),V=b[1],X=b[2],B=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var k=0,p=0,E=null;g<=q;g++)if(g<V)for(var m=0;m<ha.Wl;m++)c[k++]=X;else if(g>B)for(m=0;m<ha.Wl;m++)c[k++]=a;else{var F=b[p],h=3;0===F&&(h+=2);0===E&&(h+=2);var v=2===F?0:1;if(b[p+1]==b[p+h+1])E=F,p+=h;else{m=0;g==b[p+1]&&(v&&(d[k]=1),c[k]=b[p+2],k++,m++);if(g==B)for(;m<ha.Wl;m++)c[k++]=a;else for(e[0]=b[p+1],e[1]=b[p+2],0!==F?(f[0]=0,f[1]=0):0===E?(f[0]=b[p+5],f[1]=b[p+6]):(f[0]=b[p+
3],f[1]=b[p+4]),0!==F?(u[0]=0,u[1]=0):(u[0]=b[p+h+3],u[1]=b[p+h+4]),I[0]=b[p+h+1],I[1]=b[p+h+2];m<ha.Wl;m++){var G=g+m/ha.Wl;switch(F){case 0:var S=e,ca=f,T=u,R=I,r=[],U=[],x=void 0,ga=void 0,n=void 0,x=void 0;r[0]=S[0]-ca[0];r[1]=S[1]-ca[1];U[0]=R[0]-T[0];U[1]=R[1]-T[1];n=R[0]-S[0];x=Math.abs(r[0]);ga=Math.abs(U[0]);0!=x+ga&&x+ga>n&&(x=n/(x+ga),ca[0]=S[0]-x*r[0],ca[1]=S[1]-x*r[1],T[0]=R[0]-x*U[0],T[1]=R[1]-x*U[1]);v&&(d[k]=1);c[k]=t(P(0,1,G,e[0],f[0],u[0],I[0]),e[1],f[1],u[1],I[1]);k++;break;case 1:v&&
(d[k]=1);S=e[0];ca=e[1];T=(I[1]-ca)/(I[0]-S);c[k]=T*G+(ca-T*S);k++;break;case 2:v&&(d[k]=1);c[k]=b[p+2];k++;break;default:wa.q("Unknown keyframe interpolation mode: "+F)}}g+1==b[p+h+1]&&(E=F,p+=h)}}};a.apply=F;a.GQ=function(a,b,c,d){d=d||0;var g=wa.Dd("uuid",c,ka);if(g){da(a,d);if(f(a,b,g,d)){G(a,d);return}a.ja[d]=null}q.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.uN=function(a,b){var c=wa.Dd("name",b,ka)||wa.Dd("name",b+"_B4W_BAKED",ka);if(c){if(0==c.s.type)return!1}else if(!(R(a,
b)||E.$d(a)&&U(a,b)))return!1;return!0};a.gv=function(a,b){for(var c=a.ja,d=0;d<c.length;d++){var g=c[d];if(g&&y(g.Bi)==y(b))return d}return-1};a.NU=function(a,b){var c=a.ja[b];return c&&c.Bi?y(c.Bi):null};a.remove=function(a){a.ja.length=0;a=xa.indexOf(a);-1!=a&&xa.splice(a,1)};a.GX=function(a){for(var b=ka.length-1;0<=b;b--)ka[b].cQ==a&&ka.splice(b,1)};a.OF=function(a,b){if(!a.ja.length)return F(a,b,0)?0:-1;for(var c=0;c<a.ja.length;c++)if(!a.ja[c])return F(a,b,c)?c:-1};a.ML=function(a,b,c){a.k.Wp=
(b-a.k.Fh)/c;a.k.Vp=b};a.OL=function(a,b,c){m(a.ja,c,function(a){a.speed=b})};a.XI=function(a,b){return a.ja[b].speed};a.bB=function(a,b){return a.ja[b].start};a.aB=function(a,b){return a.ja[b].length};a.ua=function(){xa.length=0;ka.length=0};a.hU=function(a){var b=(a[0]||a[1]||a[2]).zf.length,c=B,d=N,g=Boolean(a[0]);g||(a[0]={zf:new Float32Array(b),num_channels:8});var q=Boolean(a[1]);q||(a[1]={zf:new Float32Array(b),num_channels:8});var f=Boolean(a[2]);f||(a[2]={zf:new Float32Array(b),num_channels:8});
a[3]={zf:new Float32Array(b),num_channels:8};for(var e=0;e<b;e++)d[0]=g?a[0].zf[e]:0,d[1]=q?a[1].zf[e]:0,d[2]=f?a[2].zf[e]:0,wa.Wj(d,c),a[0].zf[e]=c[3],a[1].zf[e]=c[0],a[2].zf[e]=c[1],a[3].zf[e]=c[2]};a.oI=Z;a.ZY=function(a,b){for(var c=7,d=0,g=0;g<ka.length;g++){var q=ka[g];if(q.name==b){d=q.s.type;break}}0==d&&(U(a,b)?d=30:(g=R(a,b))&&"EMITTER"==g.rw&&(d=50));for(g=0;8>g;g++)if(q=a.ja[g]){if(q.type==d)return g}else g<c&&(c=g);return c}};b4w.module.__armature=function(a,l){function n(a){a=a.k;for(var b=a.No,e=a.$v,f=0;f<b.length;f++){for(var k=b[f],m=e[f],h=0;h<m.length;h+=2)for(var v=m[h],r=m[h+1],n=0;4>n;n++)k.ne[v+n]=a.ne[r+n],k.Ge[v+n]=a.Ge[r+n],k.se[v+n]=a.se[r+n],k.Je[v+n]=a.Je[r+n];k.Ye=a.Ye}}function e(a,b,f,k){var h=a.$M,v=a.Tk,r=a.vx,n=a.DK;n?(n=n.vx,b?y.multiply(n,h,r):(b=m,y.invert(n,b),y.multiply(b,r,h))):b?y.copy(h,r):y.copy(r,h);h=w;y.invert(v,h);y.multiply(r,h,h);v=a.Jj;f[4*v]=h[0];f[4*v+1]=h[1];f[4*v+2]=h[2];f[4*
v+3]=h[3];k[4*v]=h[4];k[4*v+1]=h[5];k[4*v+2]=h[6];k[4*v+3]=h[7];a=a.DH;for(v=0;v<a.length;v++)r=a[v],r.pc||e(r,!0,f,k)}var b=l("__util"),y=l("__tsr"),r=l("__quat"),A=l("__mat4"),h=l("__vec3"),w=y.create(),m=y.create(),k=new Float32Array(4),f=new Float32Array(4),v=new Float32Array(4);a.Wk=function(a,f){for(var e=a.data.bones,k=a.pose.bones,m={},v=0;v<k.length;v++){var r=k[v],n=r.bone,l=n.name,z=m[l]={Jj:0,BN:-1,DK:null,DH:[],ju:[],pc:null,cE:y.create(),$M:y.create(),Tk:y.create(),vx:y.create(),tx:y.create(),
dE:y.create(),ux:!1,HM:new Float32Array(3)},l=new Float32Array(n.matrix_local),d=new Float32Array(16);A.invert(l,d);var r=new Float32Array(r.matrix_basis),p=z.HM;h.subtract(b.Ef(n.tail_local),b.Ef(n.head_local),p);b.N_(p,d,p);y.Qi(l,z.Tk);y.Qi(r,z.tx);y.copy(z.Tk,z.vx)}for(v=0;v<e.length;v++){l=e[v].name;r=b.Dd("name",l,k);z=m[l];n=r.parent_recursive;z.ju.push(z);for(d=0;d<n.length;d++)r=n[d],r=r.name,r=m[r],z.ju.push(r);n.length?(r=n[0],r=r.name,r=m[r],z.DK=r,y.invert(r.Tk,w),y.multiply(w,z.Tk,z.cE),
r.DH.push(z)):y.copy(z.Tk,z.cE);z.Jj=v;z.name=l;y.multiply(z.cE,z.tx,z.$M)}f.k.Hg=m};a.Zu=function(a,b,e,h){var n=a.k,l=n.Ye;b=n.Hg[b];var Q=b.Jj;a=b.Tk;var L=n.se,H=n.Je,z=n.ne,n=n.Ge,d=L[4*Q+1],p=L[4*Q+2],M=L[4*Q+3],x=H[4*Q+1],g=H[4*Q+2],P=H[4*Q+3];k[0]=(1-l)*L[4*Q]+l*H[4*Q];k[1]=(1-l)*d+l*x;k[2]=(1-l)*p+l*g;k[3]=(1-l)*M+l*P;f[0]=z[4*Q];f[1]=z[4*Q+1];f[2]=z[4*Q+2];f[3]=z[4*Q+3];v[0]=n[4*Q];v[1]=n[4*Q+1];v[2]=n[4*Q+2];v[3]=n[4*Q+3];r.slerp(f,v,l,f);l=w;y.JY(k,l);y.Jk(f,l);e?(e=m,y.translate(a,b.HM,
e),y.multiply(l,e,l)):y.multiply(l,a,l);y.copy(l,h)};a.gY=function(a,b,f){var k=a.k;b=k.Hg[b];var m=k.se,h=k.ne;y.copy(f,b.vx);e(b,!1,m,h);k.Ye=0;n(a)};a.x_=n;a.b_=e;a.GR=function(a,b){return b in a.k.Hg}};b4w.module.__config=function(a,l){function n(){return b4w.module_check(a.Fe.fu)}function e(){for(var e=a.Fe,n=null,h=document.getElementsByTagName("script"),l=0;l<h.length;l++){for(var m=h[l].src,k=0;k<e.MJ.length;k++)if(0<=m.indexOf(e.MJ[k])){n=m;break}if(null!==n)break}n||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),n=document.location.href);e=n.indexOf("?");0<=e&&(n=n.substring(0,e));return n.substring(0,n.lastIndexOf("/"))}var b=l("__print"),
y=l("__util");a.Np=1;a.jl=2;a.rn=3;a.dF=4;a.Mp=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.ZG=y.S(a.context);a.B={alpha_sort:!0,alpha_sort_threshold:.1,zm:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,TH:1,qU:5,background_color:[0,0,0,0],canvas_resolution_factor:1,bp:3,allow_cors:!1,SH:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,z3:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,
antialiasing:!0,smaa:!1,debug_view:!1,HN:!1,fr:!0,sw:!0,hd:!0,water_dynamic:!0,Kk:!0,ax:!0,lN:!0,precision:"highp",quality:a.jl,St:!0,$W:!1,tD:!1,GA:!1,AN:!1,is_mobile_device:!1,yB:!1,Vz:!1,c9:!1,zs:!1,allow_hidpi:!1,cM:!1,dC:!1,enable_selectable:!0,enable_outlining:!0,Ui:!0,Xn:!1,QH:!1,TB:[0,0],br:!1,SK:!0,cx:!1,url_params:null,ec:!0,Fc:4,Gq:!1,kL:!1,lL:!1,WC:!1,LG:!1,xJ:!1,media_auto_activation:!0,fK:4,Wv:!1,gl_debug:!1,FG:!1,GF:!1,oz:!1,Hq:"dds",X8:"16x",srgb_type:"SRGB_SIMPLE",qz:!1};a.AH=y.S(a.B);
a.sl={Uu:-1,WH:!1,Wl:1};a.controls={WW:1/120};a.Pd={path:"",jX:"B4W_ASSETS_PATH=assets/",BX:"B4W_PROJ_ASSETS_PATH=assets/",QW:15,prevent_caching:!0,cC:!1,BA:!1,Cw:!1};a.SF=y.S(a.Pd);a.Fe={shaders_path:"",VY:"../shaders/",aM:"include/",W8:"postprocessing/",fu:"built_in_data",MJ:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js project_ow.min.js".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.DV={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Vi:.064,Hj:.035,Ck:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],jn:.11,bk:.062,Ij:.004}};a.C={enabled:!0,max_fps:60,Ss:"",E_:"B4W_URANIUM_PATH=uranium.js",Jz:!1,ping:!1,at:!0};a.EK=y.S(a.C);a.Eo={zr:1024,zu:256,rH:32,sT:128,rT:256,GK:.25,rX:.5,qX:1};a.oL=y.S(a.Eo);a.X={rE:!0,cw:!1,WF:!1,MG:!1,FH:!1};a.ZL=y.S(a.X);a.Vc={outlining_overview_mode:!1,hj:[1,.4,.05],rk:.2,tk:3.8,uk:1};
a.Tq={enabled:!1,xZ:0,wZ:0,YY:"COLOR"};a.yH=y.S(a.Tq);a.Gi={PW:8,Yv:64,$B:8,Zv:8,aC:15,gK:0,Tr:128,Zi:1024,XB:4096,Ec:4096,bC:[4096,4096]};a.YG=y.S(a.Gi);a.An=function(){var b=a.B,e=a.C,h=a.Eo;switch(b.quality){case a.rn:b.shadows=!0;b.Kk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.fr=!0;b.sw=!0;b.hd=!0;h.zr=2048;h.zu=512;b.bp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.ax=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=
!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Ui=!0;b.Fc=16;b.srgb_type="SRGB_PROPER";e.max_fps=120;break;case a.jl:b.shadows=!0;b.Kk=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.fr=!0;b.sw=!0;b.hd=!0;h.zr=1024;h.zu=256;b.bp=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.ax=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.Ui=!0;b.srgb_type="SRGB_SIMPLE";
b.Fc=4;e.max_fps=60;break;case a.Np:b.shadows=!1;b.Kk=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.fr=!1;b.sw=!1;b.hd=!1;h.zr=512;h.zu=256;b.bp=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.ax=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.Ui=!1;b.srgb_type="SRGB_SIMPLE";b.Fc=1;e.max_fps=60;break;case a.Mp:y.q("Direct AUTO quality profile setting is forbidden")}};
a.set=function(e,n){switch(e){case "allow_cors":a.B.allow_cors=n;break;case "allow_hidpi":a.B.allow_hidpi=n;break;case "alpha":a.context.alpha=n;break;case "alpha_sort":a.B.alpha_sort=n;break;case "alpha_sort_threshold":a.B.alpha_sort_threshold=n;break;case "anaglyph_use":b.UT();a.B.stereo=n?"ANAGLYPH":a.B.stereo;break;case "animation_framerate":a.sl.Uu=n;break;case "anisotropic_filtering":a.B.anisotropic_filtering=n;break;case "antialiasing":a.B.antialiasing=n;break;case "assets_dir":case "assets_path":a.Pd.path=
n;break;case "assets_dds_available":a.Pd.BA=n;break;case "assets_pvr_available":a.Pd.Cw=n;break;case "assets_min50_available":a.Pd.cC=n;break;case "audio":a.X.rE=n;break;case "background_color":a.B.background_color=n;break;case "bloom":a.B.bloom=n;break;case "built_in_module_name":a.Fe.fu=n;break;case "canvas_resolution_factor":a.B.canvas_resolution_factor=n;break;case "console_verbose":a.B.console_verbose=n;break;case "compositing":a.B.compositing=n;break;case "dof":a.B.dof=n;break;case "do_not_load_resources":a.B.do_not_load_resources=
n;break;case "god_rays":a.B.god_rays=n;break;case "stereo":a.B.stereo=n;break;case "max_fps":a.B.max_fps=n;break;case "max_fps_physics":a.C.max_fps=n;break;case "media_auto_activation":a.B.media_auto_activation=n;break;case "motion_blur":a.B.motion_blur=n;break;case "physics_enabled":a.C.enabled=n;break;case "physics_uranium_path":a.C.Ss=n;break;case "physics_calc_fps":a.C.Jz=n;break;case "physics_use_workers":a.C.at=n;break;case "precision":a.B.precision=n;break;case "prevent_caching":a.Pd.prevent_caching=
n;break;case "quality":a.B.quality=n;break;case "reflections":a.B.reflections=n;break;case "refractions":a.B.refractions=n;break;case "sfx_mix_mode":a.X.cw=n;break;case "shaders_dir":case "shaders_path":a.Fe.shaders_path=n;break;case "shadows":a.B.shadows=n;break;case "show_hud_debug_info":a.B.show_hud_debug_info=n;break;case "smaa":a.B.smaa=n;break;case "smaa_search_texture_path":a.Fe.smaa_search_texture_path=n;break;case "smaa_area_texture_path":a.Fe.smaa_area_texture_path=n;break;case "ssao":a.B.ssao=
n;break;case "debug_view":a.B.debug_view=n;break;case "enable_selectable":a.B.enable_selectable=n;break;case "enable_outlining":a.B.enable_outlining=n;break;case "outlining_overview_mode":a.Vc.outlining_overview_mode=n;break;case "glow_materials":a.B.Ui=n;break;case "url_params":a.B.url_params=n;break;case "use_min50":a.B.use_min50=n;break;case "gl_debug":a.B.gl_debug=n;break;case "srgb_type":a.B.srgb_type=n;break;default:b.error("Unknown config property: "+e)}};a.get=function(e){switch(e){case "allow_cors":return a.B.allow_cors;
case "allow_hidpi":return a.B.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.B.alpha_sort;case "alpha_sort_threshold":return a.B.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.B.stereo;case "animation_framerate":return a.sl.Uu;case "anisotropic_filtering":return a.B.anisotropic_filtering;case "antialiasing":return a.B.antialiasing;case "assets_dir":case "assets_path":return a.Pd.path;case "assets_dds_available":return a.Pd.BA;case "assets_pvr_available":return a.Pd.Cw;
case "assets_min50_available":return a.Pd.cC;case "audio":return a.X.rE;case "background_color":return a.B.background_color;case "bloom":return a.B.bloom;case "built_in_module_name":return a.Fe.fu;case "canvas_resolution_factor":return a.B.canvas_resolution_factor;case "console_verbose":return a.B.console_verbose;case "compositing":return a.B.compositing;case "dof":return a.B.dof;case "do_not_load_resources":return a.B.do_not_load_resources;case "is_mobile_device":return a.B.is_mobile_device;case "god_rays":return a.B.god_rays;
case "stereo":return a.B.stereo;case "max_fps":return a.B.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.B.media_auto_activation;case "motion_blur":return a.B.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.Ss;case "physics_calc_fps":return a.C.Jz;case "physics_use_workers":return a.C.at;case "precision":return a.B.precision;case "prevent_caching":return a.Pd.prevent_caching;case "quality":return a.B.quality;case "reflections":return a.B.reflections;
case "refractions":return a.B.refractions;case "sfx_mix_mode":return a.X.cw;case "shaders_dir":case "shaders_path":return a.Fe.shaders_path;case "shadows":return a.B.shadows;case "show_hud_debug_info":return a.B.show_hud_debug_info;case "smaa":return a.B.smaa;case "smaa_search_texture_path":return a.Fe.smaa_search_texture_path;case "smaa_area_texture_path":return a.Fe.smaa_area_texture_path;case "ssao":return a.B.ssao;case "debug_view":return a.B.debug_view;case "enable_selectable":return a.B.enable_selectable;
case "enable_outlining":return a.B.enable_outlining;case "outlining_overview_mode":return a.Vc.outlining_overview_mode;case "glow_materials":return a.B.Ui;case "url_params":return a.B.url_params;case "use_min50":return a.B.use_min50;case "gl_debug":return a.B.gl_debug;case "srgb_type":return a.B.srgb_type;default:b.error("Unknown config property: "+e)}};a.reset=function(){for(var b in a.ZG)a.context[b]=a.ZG[b];for(b in a.AH)a.B[b]=a.AH[b];for(b in a.SF)a.Pd[b]=a.SF[b];for(b in a.EK)a.C[b]=a.EK[b];
for(b in a.oL)a.Eo[b]=a.oL[b];for(b in a.ZL)a.X[b]=a.ZL[b];for(b in a.yH)a.Tq[b]=a.yH[b]};a.UC=function(){for(var b in a.YG)a.Gi[b]=a.YG[b]};a.CJ=n;a.CY=function(){var b=a.Fe,l=a.C;n()||""!=b.shaders_path||(b.shaders_path=e()+"/"+b.VY);l.enabled&&""==l.Ss&&(l.Ss=e()+"/"+l.E_.replace("B4W_URANIUM_PATH=",""))};a.Yu=function(b){var n=a.Pd;if(n.path)return n.path;var h=n.jX,l="B4W_ASSETS_PATH=";b&&(h=n.BX,l="B4W_PROJ_ASSETS_PATH=",h=h.replace("__NAME__",b));h=h.replace(l,"");return h=h.replace("__JS__",
e())}};b4w.module.__obj_util=function(a,l){function n(a){a={type:a,Ue:0,n:h.Hl(),Qx:h.Hl(),pivot:new Float32Array(3),Vb:new Float32Array(3),ck:0,dk:0,Hv:!1,Iv:!1,Nj:null,ih:0,Rk:!1,pf:m.create(),use_panning:!1,vb:0,$k:1,Zk:1,al:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Cd:!1,dof_object:null,mb:null,la:null,tb:null,Cc:null,Bc:null,ce:null,Nh:!0,ai:{rk:1,tk:1,uk:0},Rd:-1,Ed:-1,rc:new Float32Array(4),Yl:0,Rl:0,co:!1,Rr:new Float32Array(3),
Sr:0,ef:-1,bh:0,dh:0,Ln:!1,He:!1,fe:!1,qe:!1,ee:!1,Hd:!1,Gd:!1,lh:"",rf:!1,ag:!1,hd:!1,Uh:!1,Dk:!1,pw:!1,Vc:!1,ow:!1,qw:!1,sm:!1,ho:!1,jr:!1,kn:0,th:0,uh:0,Pg:0,Og:0,Jg:0,Yi:"",Ae:{MB:"",LB:"",vC:""},wl:!1,sq:new Float32Array(3),Gg:!1,iq:!1,kq:"",jq:!1,Ye:0,Cx:0,Dx:0,eh:0,Xl:!1,Zc:!1,Le:!1,ii:[],hk:!1,Ai:!1,Fh:1,Wp:0,Vp:1,fp:new Int8Array([-1,-1]),No:[],$v:[],bx:[],ne:null,Ge:null,se:null,Je:null,Hg:null,Di:null,ls:null,aq:null,$p:null,vl:null,R:r.Qd(),Ua:r.Qd(),wa:r.Kh(),lb:r.Kh(),ba:r.Lg(),qb:r.Lg(),
zd:r.uu(),aG:r.uu(),gq:null,eq:null,fq:null,ip:!0,Sf:!1,ww:0};m.copy(w.nc,a.pf);return a}function e(a){if(!(a instanceof Object))return a;var b=null,f=null,k=null,m=null,h=null,n=null;a.ya&&(b=a.ya,a.ya=null);a.Ld&&(f=a.Ld,a.Ld=null);a.Ig&&(k=a.Ig,a.Ig=null);a.jb&&(m=a.jb,a.jb=null);a.zb&&(h=a.zb,a.zb=null);a.Me&&(n=a.Me,a.Me=null);var l;l=a.constructor;switch(l){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:l=
new l(a);break;case Array:l=new l(a.length);for(var r=0;r<a.length;r++)l[r]=e(a[r]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:l=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:l=null;break;case Function:l=a;break;default:for(r in l=new l,a)l[r]=e(a[r])}b&&(l.ya=b,a.ya=b);f&&(l.Ld=f,a.Ld=f);k&&(l.Ig=k,a.Ig=k);m&&(l.jb=m,a.jb=m);h&&(l.zb=h,a.zb=h);n&&(l.Me=w.Sj(),a.Me=n);return l}function b(a,b){for(var e=a.I,f=0;f<e.length;f++){var k=e[f];if(k.yb==b)return k}return null}
function y(a){return a.xk?a.parent:a.parent?y(a.parent):null}var r=l("__boundings"),A=l("__config"),h=l("__tsr"),w=l("__util"),m=l("__vec3"),k=l("__vec4"),f=A.B;new Float32Array(4);new Float32Array(4);new Float32Array(4);h.create();h.create();a.Ip=-1;a.Nq=n;a.Wz=function(a){var b=n(a.type);b.Ue=a.Ue;h.copy(a.n,b.n);h.copy(a.Qx,b.Qx);m.copy(a.pivot,b.pivot);m.copy(a.Vb,b.Vb);b.ck=a.ck;b.dk=a.dk;b.Hv=a.Hv;b.Iv=a.Iv;a.Nj&&(b.Nj=m.clone(a.Nj));b.ih=a.ih;b.Rk=a.Rk;m.copy(a.pf,b.pf);b.use_panning=a.use_panning;
b.vb=a.vb;b.$k=a.$k;b.Zk=a.Zk;b.al=a.al;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Cd=a.Cd;b.dof_object=a.dof_object;b.mb=w.S(a.mb);b.la=w.S(a.la);b.tb=w.S(a.tb);b.Cc=w.S(a.Cc);b.Bc=w.S(a.Bc);b.ce=a.ce;b.Nh=a.Nh;b.ai.rk=a.ai.rk;b.ai.tk=a.ai.tk;b.ai.uk=a.ai.uk;b.Rd=a.Rd;b.Ed=a.Ed;b.rc=a.rc;
b.Yl=a.Yl;b.Rl=a.Rl;b.co=a.co;m.copy(a.Rr,b.Rr);b.Sr=a.Sr;b.ef=a.ef;b.bh=a.bh;b.dh=a.dh;b.Ln=a.Ln;b.He=a.He;b.fe=a.fe;b.qe=a.qe;b.ee=a.ee;b.Hd=a.Hd;b.Gd=a.Gd;b.lh=a.lh;b.rf=a.rf;b.ag=a.ag;b.hd=a.hd;b.Uh=a.Uh;b.Dk=a.Dk;b.pw=a.pw;b.Vc=a.Vc;b.ow=a.ow;b.qw=a.qw;b.sm=a.sm;b.ho=a.ho;b.jr=a.jr;b.kn=a.kn;b.th=a.th;b.uh=a.uh;b.Pg=a.Pg;b.Og=a.Og;b.Jg=a.Jg;b.Yi=a.Yi;b.Ae=a.Ae;b.wl=a.wl;m.copy(a.sq,b.sq);b.Gg=a.Gg;b.iq=a.iq;b.kq=a.kq;b.jq=a.jq;b.Ye=a.Ye;b.Cx=a.Cx;b.Dx=a.Dx;b.eh=a.eh;b.Xl=a.Xl;b.Zc=a.Zc;b.Le=
a.Le;b.ii=w.S(a.ii);b.hk=a.hk;b.Ai=a.Ai;b.Fh=a.Fh;b.Wp=a.Wp;b.Vp=a.Vp;b.fp.set(a.fp);b.No=w.S(a.No);b.$v=w.S(a.$v);b.bx=w.S(a.bx);b.ne=w.S(a.ne);b.Ge=w.S(a.Ge);b.se=w.S(a.se);b.Je=w.S(a.Je);b.Hg=w.S(a.Hg);b.Di=w.S(a.Di);b.ls=w.S(a.ls);b.aq=w.S(a.aq);b.$p=w.S(a.$p);b.vl=w.S(a.vl);r.Dn(a.R,b.R);r.Dn(a.Ua,b.Ua);r.dA(a.wa,b.wa);r.dA(a.lb,b.lb);r.bA(a.ba,b.ba);r.bA(a.qb,b.qb);b.gq=w.S(a.gq);b.eq=w.S(a.eq);b.fq=w.S(a.fq);b.ip=a.ip;b.Sf=a.Sf;b.ww=a.ww;return b};a.Mq=function(a,b,e){e||(e=a);return{name:a,
wj:w.YA(),Em:e,type:b,Kj:!1,Sa:!1,Gr:!1,Vs:!1,k:null,pc:null,X:null,ub:null,Xt:null,anchor:null,Qn:null,bw:null,I:[],Zc:[],Te:w.Sj(),aA:w.Sj(),ja:[],ss:[],ng:[],Qt:[],oh:null,Pm:[],parent:null,xk:!1,bs:"",Jx:null,xw:null,bn:!1,bc:"",su:"AUTO",af:!1,ig:!1,rm:!1,nG:!1,C:null,v:null,cg:null,of:null,Rn:null,CG:null,CC:[],jh:{es:"NO_COLLISION",Xs:!1,sN:!1,Zh:0,yN:0,xN:0,vH:0,iL:0,zW:!1,AW:!1,BW:!1,DW:!1,EW:!1,FW:!1,Dq:0,Bq:0,Eq:0,iE:!1,ou:"BOX",Ts:!1},yK:{qx:0,uC:0,Lf:0,PC:0},rl:0,Ng:[],mC:!1,nK:!1,aw:[]}};
a.cA=function(a){return a instanceof Array?a.slice():a};a.o3=function(a){for(var b=[],f=0;f<a.length;f++){var k=a[f],m={},h;for(h in k)k[h]==k.Ua?m.Ua=e(k.Ua):k[h]==k.qb?m.qb=e(k.qb):m[h]=k[h];b.push(m)}return b};a.ru=e;a.Sa=function(a){return a.Sa};a.UV=function(a){return"MESH"==a.type&&a.Sa};a.Zp=function(a,b){a.I.push({yb:b,Gv:!1,W:[],bi:[],Ji:null,vD:[],xm:0,vK:!1,da:[],bM:[]})};a.Tt=function(a,c,e){b(a,c).W.push(e)};a.M7=function(a,b){for(var e=a.I,f=0;f<e.length;f++)if(e[f].yb==b){e.splice(f,
1);break}};a.ka=b;a.gN=function(a,b){for(var e=0;e<a.length;e++)k.copy(b,a[e].k.rc)};a.bD=function(a,b,e){for(var f=0;f<a.I.length;f++){var k=a.I[f];e&&k.yb!=e||(k.Gv=b)}};a.fv=function(a,b){for(var e=[],k=b?f.fK-1:f.fK,m=0;m<a.length;m++){var h=a[m];h.ub.dI&&e.length<k&&e.push(h)}return e.length?e:a[0]?[a[0]]:[]};a.VW=function(a,b){h.identity(b.n);b.Nj=null;a.k=b};a.HG=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var e=b.material-1,f=a.data.materials;if(0<=e&&e<f.length&&
("ADD"==f[e].game_settings.alpha_blend||"ALPHA"==f[e].game_settings.alpha_blend||"ALPHA_SORT"==f[e].game_settings.alpha_blend))return!0}return!1};a.QR=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var e=a[b].W,f=0;f<e.length;f++)for(var k=e[f].ib.Mi,m=0;m<k.length;m++){var h=k[m];if("USE_MODEL_TSR_INVERSE"==h[0]&&"1"==h[1])return!0}return!1};a.aI=function(a,b){return a+"*"+b};a.KI=function(a){return a.xk?null:a.parent};a.Ri=y;a.eB=function(a,b){for(var e=[],f=0;f<b.length;f++){var k=b[f];y(k)==
a&&e.push(k)}return e};a.jB=function(a){return a.k.Ue};a.$d=function(a){return"MESH"===a.type};a.pm=function(a){return"ARMATURE"===a.type};a.Jr=function(a){return"SPEAKER"===a.type};a.xa=function(a){return"CAMERA"===a.type};a.Zg=function(a){return"LAMP"===a.type};a.bo=function(a){return"EMPTY"===a.type};a.L6=function(a){return"LINE"===a.type};a.IB=function(a){return"WORLD"===a.type}};b4w.module.__boundings=function(a,l){function n(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function e(){return{F:new Float32Array(3),Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function y(a,b){for(var d=a[0],c=a[1],e=a[2],f=a[0],k=a[1],p=a[2],m=3;m<a.length;m+=3)var u=a[m],h=a[m+1],ca=a[m+2],d=Math.max(d,u),c=Math.max(c,h),e=Math.max(e,ca),
f=Math.min(f,u),k=Math.min(k,h),p=Math.min(p,ca);b.max_x=d;b.max_y=c;b.max_z=e;b.min_x=f;b.min_y=k;b.min_z=p;return b}function r(a,b){b||(b=new Float32Array(24));var d=a.max_x,c=a.max_y,e=a.max_z,f=a.min_x,k=a.min_y,p=a.min_z;b[0]=f;b[1]=k;b[2]=p;b[3]=d;b[4]=k;b[5]=p;b[6]=d;b[7]=c;b[8]=p;b[9]=f;b[10]=c;b[11]=p;b[12]=f;b[13]=k;b[14]=e;b[15]=d;b[16]=k;b[17]=e;b[18]=d;b[19]=c;b[20]=e;b[21]=f;b[22]=c;b[23]=e;return b}function A(){return{F:new Float32Array(3),Ya:0}}function h(a,b){b.F[0]=a.F[0];b.F[1]=
a.F[1];b.F[2]=a.F[2];b.Ya=a.Ya}function w(){return{Ga:new Float32Array(3),Ha:new Float32Array(3),Ia:new Float32Array(3),F:new Float32Array(3)}}function m(a,b){J.copy(a.Ga,b.Ga);J.copy(a.Ha,b.Ha);J.copy(a.Ia,b.Ia);J.copy(a.F,b.F);return b}function k(a){var b=w();m(a,b);return b}function f(a,b,d,c){return{Ga:new Float32Array(a),Ha:new Float32Array(b),Ia:new Float32Array(d),F:new Float32Array([c[0],c[1],c[2]])}}function v(a,b){var c=K.wR(a,d),c=b?K.pR(a,c,M):D.identity(M),c=K.kU(c,p);J.copy(a,L);J.transformMat3(L,
c,L);for(var e=L[0],k=e,m=L[1],h=m,n=L[2],l=n,u=0,ga=0,ca=0,E=0,v=0,r=0,q=3;q<a.length;q+=3)L[0]=a[q],L[1]=a[q+1],L[2]=a[q+2],J.transformMat3(L,c,L),u=L[0],ga=L[1],ca=L[2],u>e&&(e=u),u<k&&(k=u),ga>m&&(m=ga),ga<h&&(h=ga),ca>n&&(n=ca),ca<l&&(l=ca);m-=h;n-=l;e=Math.max(e-k,1E-9);m=Math.max(m,1E-9);n=Math.max(n,1E-9);k=D.identity(M);k[0]=0!=e?1/e:1E8;k[4]=0!=m?1/m:1E8;k[8]=0!=n?1/n:1E8;D.transpose(c,x);L[0]=a[0];L[1]=a[1];L[2]=a[2];J.transformMat3(L,c,L);J.transformMat3(L,k,L);J.transformMat3(L,x,L);
u=L[0];ga=L[0];ca=L[1];E=L[1];v=L[2];r=L[2];for(q=3;q<a.length;q+=3)L[0]=a[q],L[1]=a[q+1],L[2]=a[q+2],J.transformMat3(L,c,L),J.transformMat3(L,k,L),J.transformMat3(L,x,L),u=Math.max(u,L[0]),ga=Math.min(ga,L[0]),ca=Math.max(ca,L[1]),E=Math.min(E,L[1]),v=Math.max(v,L[2]),r=Math.min(r,L[2]);q=Math.sqrt((u-ga)*(u-ga)+(ca-E)*(ca-E)+(v-r)*(v-r))/2;q=Math.min(q,1);z[0]=(u+ga)/2;z[1]=(ca+E)/2;z[2]=(v+r)/2;u=z;k=D.identity(M);k[0]=e;k[4]=m;k[8]=n;J.transformMat3(u,c,u);J.transformMat3(u,k,u);J.transformMat3(u,
x,u);k=[c[0],c[3],c[6]];ga=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];J.scale(k,e*q,k);J.scale(ga,m*q,ga);J.scale(c,n*q,c);return f(k,ga,c,u)}function c(a,b,c){J.add(b,c,a.F);J.scale(a.F,.5,a.F);a.Ya=J.distance(a.F,b);return a}var C=l("__tsr"),O=l("__util"),J=l("__vec3"),K=l("__math"),D=l("__mat3"),Q=new Float32Array(24),L=new Float32Array(3),H=new Float32Array(3),z=new Float32Array(3),d=new Float32Array(3),p=new Float32Array(9),M=new Float32Array(9),x=new Float32Array(9);new Float32Array(9);a.Qd=n;a.uu=
e;a.Dn=b;a.B2=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.b0=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Cl=function(a){var c=n();b(a,c);return c};a.qR=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.OA=function(a,b){var c=a.max_y,d=a.max_z,e=a.min_x,f=a.min_y,k=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=
Math.min(b.min_x,e);a.min_y=Math.min(b.min_y,f);a.min_z=Math.min(b.min_z,k)};a.$F=y;a.Al=function(a,b,c){c||(c=n());a=r(a,Q);C.dp(a,b,a);return y(a,c)};a.NH=r;a.a9=function(a,b,c){c||(c=n());var d=b.min_x,e=b.max_x,f=b.min_y,k=b.max_y,p=b.min_z;b=b.max_z;if(d>=a.max_x||e<=a.min_x||f>=a.max_y||k<=a.min_y||p>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,e);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,
k);c.min_z=Math.max(a.min_z,p);c.max_z=Math.min(a.max_z,b);return c};a.o9=function(a,b,c){c||(c=n());var d=a.max_x-a.min_x,e=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*e;c.max_y=a.max_y+.5*(b-1)*e;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.mq=function(a,b,c){c||(c=A());C.Xc(a.F,b,c.F);b=C.Yd(b);c.Ya=a.Ya*(0>b?-b:b);return c};a.lq=function(a,b,c){c||(c=w());C.Xc(a.F,b,c.F);J.copy(a.Ga,c.Ga);J.copy(a.Ha,c.Ha);
J.copy(a.Ia,c.Ia);C.wd(c.Ga,b,c.Ga);C.wd(c.Ha,b,c.Ha);C.wd(c.Ia,b,c.Ia);return c};a.Ez=function(a,b,c){c||(c=e());C.Xc(a.F,b,c.F);J.copy(a.Ga,c.Ga);J.copy(a.Ha,c.Ha);J.copy(a.Ia,c.Ia);C.wd(c.Ga,b,c.Ga);C.wd(c.Ha,b,c.Ha);C.wd(c.Ia,b,c.Ia);return c};a.Hz=function(a,b){var c=A();J.copy(b,c.F);c.Ya=a;return c};a.XX=function(a,b,c,d,f){var k=e();J.copy(a,k.F);J.copy(b,k.Ga);J.copy(c,k.Ha);J.copy(d,k.Ia);J.scale(k.Ga,f[0],k.Ga);J.scale(k.Ha,f[1],k.Ha);J.scale(k.Ia,f[2],k.Ia);return k};a.Kh=A;a.dA=h;a.Lg=
w;a.bA=m;a.yq=k;a.Dl=function(a){var b=A();h(a,b);return b};a.hq=f;a.$Q=function(){var a;a||(a=A());J.set(0,0,0,a.F);a.Ya=1E12;return a};a.WT=function(a,b){var c=J.subtract(b.F,a.F,J.create());0==J.length(c)&&J.set(1,0,0,c);var d=J.normalize(c,J.create()),c=J.scale(d,a.Ya,J.create());J.add(c,a.F,c);var e=J.scale(d,-a.Ya,J.create());J.add(e,a.F,e);var f=J.scale(d,b.Ya,J.create());J.add(f,b.F,f);var k=J.scale(d,-b.Ya,J.create());J.add(k,b.F,k);c=[c,e,f,k];d=J.normalize(d,J.create());e=c[0];f=c[0];for(k=
1;k<c.length;k++){var p=J.dot(c[k],d);p<J.dot(e,d)&&(e=c[k]);p>J.dot(f,d)&&(f=c[k])}d=[e,f];c=d[0];d=d[1];a.F=J.scale(J.add(c,d,J.create()),.5,J.create());a.Ya=J.length(J.subtract(d,c,J.create()))/2};a.SA=function(a,b){J.add(a.F,a.Ha,L);J.add(L,a.Ga,L);J.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);J.add(a.F,a.Ha,L);J.add(L,a.Ga,L);J.subtract(L,a.Ia,L);b.push(L[0],L[1],L[2]);J.add(a.F,a.Ha,L);J.subtract(L,a.Ga,L);J.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);J.add(a.F,a.Ha,L);J.subtract(L,a.Ga,L);J.subtract(L,a.Ia,
L);b.push(L[0],L[1],L[2]);J.subtract(a.F,a.Ha,L);J.add(L,a.Ga,L);J.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);J.subtract(a.F,a.Ha,L);J.add(L,a.Ga,L);J.subtract(L,a.Ia,L);b.push(L[0],L[1],L[2]);J.subtract(a.F,a.Ha,L);J.subtract(L,a.Ga,L);J.add(L,a.Ia,L);b.push(L[0],L[1],L[2]);J.subtract(a.F,a.Ha,L);J.subtract(L,a.Ga,L);J.subtract(L,a.Ia,L);b.push(L[0],L[1],L[2])};a.tu=v;a.nS=function(a){var b=e();J.copy(a.Ga,b.Ga);J.copy(a.Ha,b.Ha);J.copy(a.Ia,b.Ia);J.copy(a.F,b.F);return b};a.Kq=function(a){var b=A(),c=
0,c=J.length(a.Ga),d=J.length(a.Ha),e=J.length(a.Ia),c=c>d?c:d;b.F=a.F;b.Ya=e>c?e:c;return b};a.nR=function(a,b){var c=k(a),e=C.hc(b,d);J.subtract(c.F,e,c.F);return c};a.FB=function(a,b){var c=J.length(a.Ga),d=J.length(a.Ha),e=J.length(a.Ia);return.75*b.Ya*b.Ya*b.Ya>c*d*e};a.bG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d-2*a);return{Ya:a,height:e,F:new Float32Array([0,0,(c+d)/2])}};a.dG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d);return{Ya:a,height:e,F:new Float32Array([0,0,
(c+d)/2])}};a.cG=function(a,b){var c=b.max_z,d=b.min_z,e=Math.max(0,c-d);return{Ya:a,height:e,F:new Float32Array([0,0,(c+d)/2])}};a.O2=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.EX=function(a){for(var b=0,c=0,d=0,e=0,f=0,k=0,p=0,m=0,u=0,h=0,n=0,E=0,l=0,x=0,q=0;q<a.submeshes.length;q++){var T=a.submeshes[q];if(T.position.length){b=e=T.position[0];c=f=T.position[1];d=k=T.position[2];break}}for(q=0;q<a.submeshes.length;q++){for(var T=
a.submeshes[q],r=T.position,p=h=T.position[0],m=n=T.position[1],u=E=T.position[2],S=0;S<r.length/3;S++)var M=r[3*S],w=r[3*S+1],z=r[3*S+2],b=Math.max(M,b),c=Math.max(w,c),d=Math.max(z,d),e=Math.min(M,e),f=Math.min(w,f),k=Math.min(z,k),p=Math.max(M,p),m=Math.max(w,m),u=Math.max(z,u),h=Math.min(M,h),n=Math.min(w,n),E=Math.min(z,E),l=Math.max(Math.sqrt(M*M+w*w+z*z),l),x=Math.max(Math.sqrt(M*M+w*w),x);r=T.boundings.bb;r.max_x=p;r.min_x=h;r.max_y=m;r.min_y=n;r.max_z=u;r.min_z=E;r=Q;r[0]=h;r[1]=n;r[2]=E;
r[3]=p;r[4]=n;r[5]=E;r[6]=p;r[7]=m;r[8]=E;r[9]=h;r[10]=m;r[11]=E;r[12]=h;r[13]=n;r[14]=u;r[15]=p;r[16]=n;r[17]=u;r[18]=p;r[19]=m;r[20]=u;r[21]=h;r[22]=m;r[23]=u;p=v(r,!1);T.boundings.be_cen=p.F;T.boundings.be_ax=[p.Ga[0],p.Ha[1],p.Ia[2]]}q=a.b4w_boundings.bb;q.max_x=b;q.min_x=e;q.max_y=c;q.min_y=f;q.max_z=d;q.min_z=k;q=a.b4w_boundings.bb_src;q.max_x=b;q.min_x=e;q.max_y=c;q.min_y=f;q.max_z=d;q.min_z=k;a.b4w_boundings.bs_rad=l;a.b4w_boundings.bc_rad=x;r=Q;r[0]=e;r[1]=f;r[2]=k;r[3]=b;r[4]=f;r[5]=k;r[6]=
b;r[7]=c;r[8]=k;r[9]=e;r[10]=c;r[11]=k;r[12]=e;r[13]=f;r[14]=d;r[15]=b;r[16]=f;r[17]=d;r[18]=b;r[19]=c;r[20]=d;r[21]=e;r[22]=c;r[23]=d;p=v(r,!1);a.b4w_boundings.be_cen=p.F;a.b4w_boundings.be_ax=[p.Ga[0],p.Ha[1],p.Ia[2]]};a.dV=function(a){var b=a.subarray(0,3),d=a.subarray(6,9),e=a.subarray(12,15),f=a.subarray(18,21);a=J.subtract(d,b,L);J.normalize(a,a);var k=O.nV(b,d,e,H),k=J.cross(k,a,k);J.normalize(k,k);var p=J.create(),m=J.create();J.subtract(d,b,z);m[0]=J.dot(z,a);m[1]=J.dot(z,k);d=J.create();
J.subtract(e,b,z);d[0]=J.dot(z,a);d[1]=J.dot(z,k);e=J.create();J.subtract(f,b,z);e[0]=J.dot(z,a);e[1]=J.dot(z,k);f=A();e=[p,m,d,e];p=c(f,e[0],e[1]);for(f=2;f<e.length;f++)if(J.distance(p.F,e[f])>p.Ya){for(var h=p,p=e,m=e[f],d=f-1,h=c(h,m,p[0]),u=1;u<=d;u++)if(J.distance(h.F,p[u])>h.Ya){for(var n=h,h=p,ca=m,E=p[u],l=u-1,n=c(n,ca,E),x=0;x<=l;x++)if(J.distance(n.F,h[x])>n.Ya){var q=ca,T=E,r=h[x],S=J.subtract(T,r,z),S=J.squaredLength(S),v=J.subtract(q,r,z),M=J.squaredLength(v),v=J.subtract(q,T,z),w=J.squaredLength(v),
v=S*(M+w-S),C=M*(w+S-M),S=w*(S+M-w),M=v+C+S;J.copy(q,n.F);J.scale(n.F,v/M,n.F);J.scaleAndAdd(n.F,T,C/M,n.F);J.scaleAndAdd(n.F,r,S/M,n.F);n.Ya=J.distance(n.F,q)}h=n}p=h}f=p;a=J.scale(a,f.F[0],z);J.scaleAndAdd(a,k,f.F[1],a);J.add(a,b,f.F);return f}};b4w.module.__particles=function(a,l){function n(){k.q("_rand() undefined")}function e(a,b,e,f,k,h){var d=a.Gu,p=a.Rg,n=a.time;a=a.MK;for(var l=0;l<d.length;l+=4){var g=d[l];if(n>a&&n>=g&&g>a||n<a&&(g>a||n>=g))for(g=0;8>g;g++)p[8*l+g]=f[g],C[g]=f[g];else for(g=0;8>g;g++)C[g]=p[8*l+g];g=O;g[0]=b[3*l];g[1]=b[3*l+1];g[2]=b[3*l+2];m.Xc(g,C,g);k[3*l]=g[0];k[3*l+1]=g[1];k[3*l+2]=g[2];var r=c;r[0]=e[4*l];r[1]=e[4*l+1];r[2]=e[4*l+2];r[3]=e[4*l+3];m.OZ(r,C,r);h[4*l]=r[0];h[4*l+1]=r[1];h[4*l+2]=r[2];h[4*l+3]=
r[3];for(g=1;4>g;g++)k[3*(l+g)]=k[3*l],k[3*(l+g)+1]=k[3*l+1],k[3*(l+g)+2]=k[3*l+2],h[4*(l+g)]=r[0],h[4*(l+g)+1]=r[1],h[4*(l+g)+2]=r[2],h[4*(l+g)+3]=r[3]}}function b(a){a?(k.oZ(a),n=function(){return k.DX()}):n=function(){return Math.random()}}var y=l("__config"),r=l("__batch"),A=l("__geometry"),h=l("__textures"),w=l("__time"),m=l("__tsr"),k=l("__util"),f=l("__vec3"),v=y.B,c=new Float32Array(4),C=new Float32Array(8),O=new Float32Array(3),J=[];a.update=function(){for(var a=0;a<J.length;a++)for(var b=
J[a],c=b.I,f=0;f<c.length;f++)for(var k=b,m=c[f].W,d=0;d<m.length;d++){var p=m[d],h=p.hb;h&&h.zx&&!p.eg&&(e(h,h.positions,h.KM,k.k.n,h.FC,h.PD),h.mK=!0)}};a.qC=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].W,e=0;e<c.length;e++)if(c[e].hb)return!0;return!1};a.uK=function(a){a=a.I;for(var b=0;b<a.length;b++)for(var c=a[b].W,e=0;e<c.length;e++){var f=c[e].hb;if(f&&"EMITTER"==f.rw)return!0}return!1};a.iR=function(a){return 0<a.particle_systems.length};a.hR=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.AV=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.LV=function(a,b,c){var e=a.hb={name:b.name,rw:b.settings.type,time:0,MK:-1,zx:!1,va:0,ab:0,QM:0,OB:0,WJ:0,ze:0,Zh:0,nC:0,kJ:0,Ul:0,Ff:0,IN:0,size:0,IF:0,HF:0,UG:0,TG:new Float32Array(16),mK:!1,positions:null,FC:null,KM:null,PD:null,Gu:null,DA:null,Rg:null,zK:null,OM:0,PM:0};e.va=b.settings.frame_start;
e.ab=b.settings.frame_end;e.QM=(e.ab-e.va)/w.rd();e.OB=b.settings.lifetime;e.WJ=e.OB/w.rd();e.ze=b.settings.b4w_cyclic?1:0;e.Zh=b.settings.mass;e.nC=b.settings.normal_factor;e.kJ=9.81*b.settings.effector_weights.gravity;e.Ul=b.settings.b4w_fade_in/w.rd();e.Ff=b.settings.b4w_fade_out/w.rd();e.IN=b.settings.effector_weights.wind;e.zx="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,m,d;a.Ar?(f=c.halo.size,m=c.halo.hardness,30>m?(m=.5,d=.9):40>m?(m=.1,d=1):50>m?(m=0,d=.8):(m=0,d=.5)):(f=b.settings.particle_size,
d=m=1);e.size=f;e.IF=m;e.HF=d;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(r.jf(a,"NODES",1),r.jf(a,"PARTICLE_BATCH",1),a.ak=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&v.St&&(b=b[0].texture,f=[],h.oR(b.color_ramp,h.cF,f),f=new Uint8Array(f.map(function(a){return k.U(255*a,0,255)})),f=h.aH(f,h.cF),r.Gj(a,f,"u_color_ramp_tex",b.name),r.jf(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,
0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)m=c[f/4],a[f]=m.position,a[f+1]=m.color[0],a[f+2]=m.color[1],a[f+3]=m.color[2];e.UG=c.length}e.TG.set(a)};a.EU=function(a,c,m,h){var l=a.hb,r=h.n;h=m.settings.count;var d=m.settings.frame_start/w.rd(),p=m.settings.frame_end/w.rd(),v=m.settings.lifetime/w.rd(),x=m.settings.lifetime_random,g=m.settings.emit_from,
P=m.settings.factor_random;if(m.settings.use_rotations)var t=m.settings.angular_velocity_mode,C=m.settings.angular_velocity_factor;else t="NONE",C=0;var G=m.settings.b4w_randomize_emission,F=m.settings.b4w_cyclic;l.OM=m.settings.billboard_tilt;l.PM=m.settings.billboard_tilt_random;b(m.seed);var U;c=A.OH(c,["a_position","a_tbn_quat"],null);switch(g){case "VERT":var R=c.aa[0].a_position;U=c.aa[0].a_tbn_quat;m=R.length/3;c=[];for(g=0;g<h;g++){var Z=Math.round((m-1)*n());c.push(Z);c.push(Z);c.push(Z);
c.push(Z)}m=[];for(g=0;g<c.length;g++)m.push(R[3*c[g]]),m.push(R[3*c[g]+1]),m.push(R[3*c[g]+2]);R=new Float32Array(m);m=[];for(g=0;g<c.length;g++)m.push(U[4*c[g]]),m.push(U[4*c[g]+1]),m.push(U[4*c[g]+2]),m.push(U[4*c[g]+3]);U=new Float32Array(m);break;case "FACE":R=[];U=[];g=[];k.Ev(0,g);m=A.ZA(c,h,!1,g);k.Ev(0,g);c=A.ZA(c,h,!0,g);for(g=0;g<m.length;g++)R.push(m[g][0],m[g][1],m[g][2]),R.push(m[g][0],m[g][1],m[g][2]),R.push(m[g][0],m[g][1],m[g][2]),R.push(m[g][0],m[g][1],m[g][2]),U.push(c[g][0],c[g][1],
c[g][2],c[g][3]),U.push(c[g][0],c[g][1],c[g][2],c[g][3]),U.push(c[g][0],c[g][1],c[g][2],c[g][3]),U.push(c[g][0],c[g][1],c[g][2],c[g][3]);R=new Float32Array(R);U=new Float32Array(U);break;case "VOLUME":k.q("Particle emission from volume is not supported");break;default:k.q("Wrong emit from option")}U=[R,U];R=U[0];U=U[1];l.positions=new Float32Array(R);l.KM=new Float32Array(U);l.FC=new Float32Array(R.length);l.PD=new Float32Array(U.length);c=[];p=(p-d)/h;for(m=0;m<h;m++)g=G?p*m+10*p*(.5-n()):p*m,F||
(g+=d),c.push(g),c.push(g),c.push(g),c.push(g);d=new Float32Array(c);l.Gu=new Float32Array(d);l.DA=new Float32Array(d);if(l.zx){l.Rg=new Float32Array(8*d.length);for(G=0;G<8*d.length;G++)for(F=0;8>F;F++)l.Rg[8*G+F]=r[F];e(l,R,U,r,R,U)}r=A.If("EMITTER_PARTICLES");G=k.Mg();G.a_position=R;G.a_tbn_quat=U;r.aa[0]=G;a.Mh=A.nt;a=[];for(G=0;G<h;G++)a.push(4*G,4*G+2,4*G+1,4*G,4*G+3,4*G+2);a=new Uint16Array(a);r.na=a;r.qa.a_p_bb_vertex=A.ZH(h);r.Ja=R.length/3;a=[];x*=v;for(G=0;G<h;G++)F=x*n(),a.push(v-F),a.push(v-
F),a.push(v-F),a.push(v-F);v=r.qa;x=[];for(G=0;G<h;G++)F=Math.random(),x.push(a[4*G],d[4*G],F),x.push(a[4*G+1],d[4*G+1],F),x.push(a[4*G+2],d[4*G+2],F),x.push(a[4*G+3],d[4*G+3],F);x=new Float32Array(x);v.a_p_data=x;v=r.qa;x=[];for(a=0;a<h;a++){d=[n()-.5,n()-.5,n()-.5];f.normalize(d,d);x.push(P*d[0]);x.push(P*d[1]);x.push(P*d[2]);switch(t){case "NONE":x.push(0);break;case "SPIN":case "VELOCITY":x.push(C);break;case "RAND":x.push(2*C*(n()-.5));break;default:k.q("Undefined velocity factor")}d=x.slice(-4);
for(G=0;12>G;G++)x.push(d[G%4])}h=new Float32Array(x);v.a_p_vels=h;l.zK=new Float32Array(r.qa.a_p_data);return r};a.IY=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,k=0;k<f.length;k++){var d=f[k].hb;d&&d.name==b&&!f[k].eg&&(d.MK=d.time,d.time=c)}};a.xX=function(a){for(var b=a.Ja,c=a.aa[0].a_position,e=[],f=[],k=0;k<b;k++)f.push(c[3*k]),e.push(c[3*k+1]),f.push(c[3*k+2]);e=new Float32Array(e);f=new Float32Array(f);a.qa.a_lf_dist=e;a.qa.a_lf_bb_vertex=f;return a};a.O8=function(a,
b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,k=0;k<f.length;k++){var d=f[k].hb;d&&d.name==b&&(d.size=c)}};a.y8=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,k=0;k<f.length;k++){var d=f[k].hb;d&&d.name==b&&(d.nC=c)}};a.k8=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,k=0;k<f.length;k++){var d=f[k],p=d.hb;if(p&&p.name==b){var m=p.Gu;if(1==c)var h=m;else if(0==c)for(var h=p.DA,g=0;g<h.length;g+=4)h[g]=1E4,h[g+1]=h[g],h[g+2]=h[g],h[g+3]=h[g];else for(var n=
4/c,h=p.DA,t=0,g=0;g<h.length;g+=4)g>=t?(h[g]=m[g],t+=n):h[g]=1E4,h[g+1]=h[g],h[g+2]=h[g],h[g+3]=h[g];d=d.Ca;if(d.kd.a_p_data){p=p.zK;for(g=0;g<p.length;g+=3)p[g+1]=h[Math.round(g/3)];A.e_(d,p)}}}};a.A_=function(a,b,c){a=a.I;for(var e=0;e<a.length;e++)for(var f=a[e].W,k=0;k<f.length;k++){var d=f[k].hb;if(d&&d.zx)for(var p=0;p<8*d.Gu.length;p++)d.Rg[8*p]=b[0],d.Rg[8*p+1]=b[1],d.Rg[8*p+2]=b[2],d.Rg[8*p+3]=b[3],d.Rg[8*p+4]=c[0],d.Rg[8*p+5]=c[1],d.Rg[8*p+6]=c[2],d.Rg[8*p+7]=c[3]}};a.s_=function(a,b,c){for(var e=
[],f=0;f<c;f++)e.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.qa.a_tbn_quat=new Float32Array(e);if(b.cs){e=[];for(f=0;f<c;f++)e.push(f,f,f,f);a.qa[b.cs.name]=new Float32Array(e)}};a.r_=function(a){-1==J.indexOf(a)&&J.push(a)};a.IX=function(a){a=J.indexOf(a);-1!=a&&J.splice(a,1)};a.ua=function(){J.length=0}};b4w.module.__batch=function(a,l){function n(a){a={type:a,Fb:"",id:0,Aq:-1,pk:"",Cu:-1,In:-1,Rq:0,Cf:0,Ml:[],ya:[],Ld:[],Ig:[],sd:[],Oj:[],xj:null,$c:{},zb:null,ib:{yg:null,Xe:null,Mi:[],og:[],status:ha.hz,rU:0,P_:0,VF:0,MM:0},nk:"",dq:[],Ca:null,Me:B.Sj(),Le:!1,Li:!1,Du:!1,Yr:0,Dm:0,Ov:0,Pv:0,hd:!1,lv:0,yr:0,je:new Float32Array(3),ye:new Float32Array(16),Eg:!1,Lb:!1,Va:!1,vh:!1,Zb:!1,Ke:!1,ag:!1,He:!1,qe:!1,fe:!1,ee:!1,Hd:!1,Gd:!1,Iu:!1,Mh:ea.on,sf:!1,eg:!1,Tj:!1,Kg:!1,ef:sa.Ip,bh:0,dh:0,Rd:-1,Ed:-1,
qv:!1,uv:0,rv:0,vv:0,wv:0,tv:new Float32Array(3),sv:new Float32Array(3),Ar:!1,Ej:0,Vj:0,Ol:1,zo:0,Qo:0,Is:1,so:0,Nl:0,pl:1,kw:0,Ur:0,pg:0,Iw:0,Td:new Float32Array(2),Nk:new Float32Array(3),li:new Float32Array(3),Um:new Float32Array(3),$f:new Float32Array(4),Pi:new Float32Array(4),wm:null,io:null,Nr:null,Mr:null,ak:!1,wireframe_edge_color:za.create(),yj:!1,water_dynamic:!1,ft:!1,Mx:!1,Nx:0,Ox:0,Lx:0,op:.1,Io:0,Ko:0,Sn:0,Tu:new Float32Array(2),Su:new Float32Array(2),gr:new Float32Array(2),Ho:new Float32Array(3),
Jo:new Float32Array(3),fj:null,zk:!1,hb:null,Rv:0,ql:null,cs:null,ej:[],dj:[],Ee:[],cj:[],R:null,Ua:null,wa:null,lb:null,qb:null,ba:null,Sf:!1,Yf:!0,zJ:0,qo:new Float32Array(3)};a.$f[3]=1;a.Va=!0;a.Rv=1;return a}function e(a){var b=n(a.type);b.Fb=a.Fb;b.id=a.id;b.Aq=a.Aq;b.pk=a.pk;b.Cu=a.Cu;b.In=a.In;b.Rq=a.Rq;b.Cf=a.Cf;b.Ml=[];b.ya=a.ya.slice();b.Ld=a.Ld.slice();b.Ig=a.Ig.slice();b.sd=a.sd.slice();b.Oj=a.Oj.slice();b.xj=B.S(a.xj);b.$c=B.S(a.$c);b.zb=a.zb;b.ib=B.S(a.ib);b.nk=a.nk;b.dq=wa.dS(a.dq);
b.Ca=a.Ca;b.Le=a.Le;b.Li=a.Li;b.Du=a.Du;b.Yr=a.Yr;b.Dm=a.Dm;b.Ov=a.Ov;b.Pv=a.Pv;b.lv=a.lv;b.yr=a.yr;b.je=a.je;b.ye=a.ye;b.Eg=a.Eg;b.Lb=a.Lb;b.Va=a.Va;b.vh=a.vh;b.Zb=a.Zb;b.Ke=a.Ke;b.ag=a.ag;b.He=a.He;b.qe=a.qe;b.fe=a.fe;b.ee=a.ee;b.Hd=a.Hd;b.Gd=a.Gd;b.hd=a.hd;b.Iu=a.Iu;b.Mh=a.Mh;b.sf=a.sf;b.eg=a.eg;b.Tj=a.Tj;b.Kg=a.Kg;b.ef=a.ef;b.bh=a.bh;b.dh=a.dh;b.Rd=a.Rd;b.Ed=a.Ed;b.qv=a.qv;b.uv=a.uv;b.rv=a.rv;b.vv=a.vv;b.wv=a.wv;za.copy(a.tv,b.tv);za.copy(a.sv,b.sv);b.Ar=a.Ar;b.Ej=a.Ej;b.Vj=a.Vj;b.Ol=a.Ol;b.zo=
a.zo;b.Qo=a.Qo;b.Is=a.Is;b.so=a.so;b.Nl=a.Nl;b.pl=a.pl;b.kw=a.kw;b.Ur=a.Ur;b.pg=a.pg;b.Iw=a.Iw;b.Td[0]=a.Td[0];b.Td[1]=a.Td[1];za.copy(a.Nk,b.Nk);za.copy(a.li,b.li);za.copy(a.Um,b.Um);ua.copy(a.$f,b.$f);ua.copy(a.Pi,b.Pi);b.wm=B.S(a.wm);a.io&&(b.io=new Float32Array(a.io),b.Nr=new Float32Array(a.Nr),b.Mr=new Float32Array(a.Mr));b.ak=a.ak;za.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.yj=a.yj;b.water_dynamic=a.water_dynamic;b.ft=a.ft;b.Mx=a.Mx;b.Nx=a.Nx;b.Ox=a.Ox;b.Lx=a.Lx;b.op=a.op;b.Io=
a.Io;b.Ko=a.Ko;b.Sn=a.Sn;b.Tu.set(a.Tu);b.Su.set(a.Su);b.gr.set(a.gr);za.copy(a.Ho,b.Ho);za.copy(a.Jo,b.Jo);b.fj=B.S(a.fj);b.zk=a.zk;b.hb=B.S(a.hb);b.Rv=a.Rv;a.ql&&(b.ql=new Float32Array(a.ql));b.cs=B.S(a.cs);b.ej=B.S(a.ej);b.dj=B.S(a.dj);b.Ee=B.S(a.Ee);b.cj=B.S(a.cj);b.R=E.Cl(a.R);b.Ua=E.Cl(a.Ua);b.ba=E.yq(a.ba);b.qb=E.yq(a.qb);b.wa=E.Dl(a.wa);b.lb=E.Dl(a.lb);b.Sf=a.Sf;b.Yf=a.Yf;b.qo=a.qo;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.Fb=a.Lb?a.vh?"XRAY":"BLEND":
"OPAQUE";break;case "SHADOW":a.Fb=a.qe?"CAST":"RECEIVE";break;case "COLOR_ID":a.Fb=a.vh?"COLOR_ID_XRAY":"COLOR_ID"}}function y(a,b,c){var d=[],g=h(c,b,!b.Ln,!1),e=a.data,q=e.materials,f=Array(q.length),k=Array(q.length),u=[],p=la.gc(c,ta.Pb),m=!1;p&&(m=p.Qr.length?!0:!1);for(var E=0;E<g.length;E++)for(var F=g[E],S=0;S<q.length;S++){var ca=q[S];if(!ea.oJ(e,S))if("PHYSICS"==F&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)u.push(ea.TA(e,S,[],b.Di,{},null));else if(!ca.b4w_lens_flares||m){var T=n(F);
"MAIN"==F?f[S]=T:"DEBUG_VIEW"==F&&(k[S]=T);T.Aq=a.b4w_cluster_data.cluster_id;if(t(T,ca)){"SHADOW"==F&&f[S]&&(T.Ke=f[S].Ke);T.Mh=b.Le||b.ag?ea.nt:ea.on;z(T,b);for(var l=T,G=a.particle_systems,r=0;r<G.length;r++){var R=G[r].settings.b4w_vcol_from_name,v=G[r].settings.b4w_vcol_to_name;""!==R&&""!==v&&(l.$c[R]={bm:!1,src:[{name:R,jg:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==T.type)T.pk=a.uuid;T.Tj=a.b4w_do_not_cull;"MAIN"==T.type&&(T.Kg=a.b4w_caustics);x(T,"DISABLE_FOG",("COLOR_ID"!=F&&"SHADOW"!=F&&a.b4w_disable_fogging)|
0);var ga=ea.TA(e,S,T.Oj,b.Di,T.$c,T.xj);!ca.use_tangent_shading||"a_shade_tangs"in ga.aa[0]||(x(T,"CALC_TBN",1),M(T,"a_tbn_quat"));ca.b4w_lens_flares&&(ga=oa.xX(ga));da(T);d.push({za:T,ff:b,au:b,Of:ga,kg:[ca.name],Id:[a]})}}}if(u.length){T=n("PHYSICS");T.Fb="NAVMESH";T.pk=a.uuid;for(var ga=ea.zM(u),U=[],E=0;E<q.length;E++)U.push(q[E].name);da(T);d.push({za:T,ff:b,au:b,Of:ga,kg:U,Id:[a]})}for(E=0;E<k.length;E++)k[E]&&(k[E].In=f[E].id,da(k[E]));var C=a.particle_systems;if(0<C.length&&d.length){for(var aa=
!1,Y=!1,E=0;E<C.length;E++){var Z=C[E],na=Z.settings;na.use_render_emitter&&(aa=!0);"HAIR"!=na.type||"OBJECT"!=na.render_type&&"GROUP"!=na.render_type&&Z.transforms.length||(Y=!0);if(aa&&Y)break}var H=d[0].za.$c,ba;if(Y){var ma;if(1<q.length){for(var D={},y=0;y<C.length;y++){var O=C[y].settings;if("HAIR"==O.type&&("OBJECT"==O.render_type||"GROUP"==O.render_type)){var J=O.b4w_vcol_from_name,ua=O.b4w_vcol_to_name;""!==J&&""!==ua&&(D[J]=B.S(H[J]))}}"a_bending_col_main"in H&&(D.a_bending_col_main=B.S(H.a_bending_col_main));
"a_bending_col_detail"in H&&(D.a_bending_col_detail=B.S(H.a_bending_col_detail));ma=ea.OH(e,[],D)}else ma=d[0].Of;ba=ma}else ba=null;for(var K=ba,A=a.pb,L=[],Q=a.particle_systems,wa=a.data,xa=0;xa<Q.length;xa++){var xb=Q[xa],Wa=xb.settings;if(Wa.count)if("EMITTER"==Wa.type){if("DYNAMIC"==b.type){var Fa=n("PARTICLES");Fa.wa=b.wa;Fa.R=b.R;Fa.ba=b.ba;Fa.lb=b.lb;Fa.Ua=b.Ua;Fa.qb=b.qb;var yb,Rc=wa.materials,Xb=xb.settings.material-1;Xb>=Rc.length&&(ia.warn('Wrong material used for rendering particle system "'+
xb.name+'"'),Xb=0);yb=Rc[Xb];"HALO"===xb.settings.render_type&&"HALO"===yb.type&&(Fa.Ar=!0);w(Fa,yb);var ka=Fa,Pa=a,Ea=xb.settings;switch(Ea.b4w_billboard_align){case "VIEW":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":x(ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:B.q("Wrong billboard align value")}x(ka,"BILLBOARD",0);var Ca=Ea.b4w_enable_soft_particles&&
sa.HG(Pa,Ea);x(ka,"SOFT_PARTICLES",0<Ea.b4w_particles_softness&&Ca&&ja.Hu?1:0);x(ka,"SOFT_STRENGTH",ha.N(Ea.b4w_particles_softness));ha.ia(ka.ib,"WORLD_SPACE","WORLD"==Ea.b4w_coordinate_system?1:0);Fa.ag=!0;Fa.Tj=a.b4w_do_not_cull;Fa.pk=A.name+"_"+Wa.uuid;oa.LV(Fa,xb,yb);var pa=oa.EU(Fa,wa,xb,A.k);oa.s_(pa,Fa,Wa.count);oa.r_(A);z(Fa,A.k);da(Fa);L.push({za:Fa,ff:b,au:b,Of:pa,kg:[yb.name],Id:[a]})}}else if("HAIR"==Wa.type){var Ba=B.Ev(xb.seed),va=ya.IG(ja.TB)&&!Wa.b4w_initial_rand_rotation&&!Wa.b4w_hair_billboard,
cb=4;va&&(cb=8);if(xb.transforms.length)var Ga=xb.transforms;else for(var Ma=ea.ZA(K,Wa.count,!1,Ba),Ga=new Float32Array(Ma.length*cb),ib=0;ib<Ma.length;ib++){var Ra=.75+.5*B.tg(Ba);Ga[ib*cb]=Ma[ib][0];Ga[ib*cb+1]=Ma[ib][1];Ga[ib*cb+2]=Ma[ib][2];Ga[ib*cb+3]=Ra;va&&(Ga[ib*cb+4]=1,Ga[ib*cb+5]=0,Ga[ib*cb+6]=0,Ga[ib*cb+7]=0)}var Cc=la.gc(c,ta.vi)?!0:!1;if("OBJECT"==Wa.render_type){var kc=[h(c,Wa.dupli_object.pb.k,!b.Ln,!0)],Qb=P(a,b,H,K,[Wa.dupli_object],kc,[Ga],Wa,xb,Cc,Ba,!1);L.push.apply(L,Qb)}else if("GROUP"==
Wa.render_type){for(var Pb=Wa.dupli_group.objects,kc=[],ib=0;ib<Pb.length;ib++){var lc=h(c,Pb[ib].pb.k,!b.Ln,!0);kc.push(lc)}for(var Gc=!1,Jb=[],ib=0;ib<Pb.length;ib++)Jb.push(Pb[ib].pb);if(Wa.use_whole_group){for(var mc,rb=Ga,db=Jb,ac=va,Yc=cb,Db={},Rb=new Float32Array([0,0,0,1]),gb=0;gb<rb.length;gb+=Yc)for(var ob=0;ob<db.length;ob++){var Hc=za.create();za.scale(N.G(db[ob].k.n),N.Yd(db[ob].k.n),Hc);var nc=za.clone([rb[gb],rb[gb+1],rb[gb+2]]);Db[ob]||(Db[ob]=new Float32Array(rb.length));ac&&(Db[ob][gb+
4]=Rb[0]=rb[gb+4],Db[ob][gb+5]=Rb[1]=rb[gb+5],Db[ob][gb+6]=Rb[2]=rb[gb+6],Db[ob][gb+7]=Rb[3]=rb[gb+7],B.JC(Rb,Rb),B.LZ(Hc,Rb,Hc));za.add(nc,Hc,nc);Db[ob][gb]=nc[0];Db[ob][gb+1]=nc[1];Db[ob][gb+2]=nc[2];Db[ob][gb+3]=rb[gb+3]}mc=Db;Gc=!0}else{var Ic;if(Wa.use_group_count){for(var Kb=Ga,oc=Jb,bc=Wa.dupli_weights,Za=Ba,cc=va,Lb=cb,tb={},pc=[],ub=0;ub<oc.length;ub++)for(var Mb=oc[ub],Sb=Mb.Em||Mb.name,vc=0;vc<bc.length;vc++){var Jc=bc[vc];Sb==Jc.name&&pc.push(Jc)}bc.length!=pc.length&&ia.error("dupli weights match failed");
for(ub=0;ub<Kb.length;ub+=Lb){for(var Ia,fc=pc,Eb=[0],Fb=0;Fb<fc.length;Fb++)Eb[Fb+1]=Eb[Fb]+fc[Fb].count;for(var Dc=Eb[Eb.length-1]*B.tg(Za),Tb=0,Fb=0;Fb<Eb.length;Fb++)if(Dc>=Eb[Fb]&&Dc<Eb[Fb+1]){Tb=Fb;break}Ia=Tb;tb[Ia]=tb[Ia]||[];tb[Ia].push(Kb[ub],Kb[ub+1],Kb[ub+2],Kb[ub+3]);cc&&tb[Ia].push(Kb[ub+4],Kb[ub+5],Kb[ub+6],Kb[ub+7])}for(Ia in tb)tb[Ia]=new Float32Array(tb[Ia]);Ic=tb}else{for(var jb=Ga,hb=Ba,Ja=va,Yb=cb,Gb=Jb.length,Na={},Oa=0;Oa<jb.length;Oa+=Yb){var mb=Math.floor(Gb*B.tg(hb));Na[mb]=
Na[mb]||[];Na[mb].push(jb[Oa],jb[Oa+1],jb[Oa+2],jb[Oa+3]);Ja&&Na[mb].push(jb[Oa+4],jb[Oa+5],jb[Oa+6],jb[Oa+7])}for(mb in Na)Na[mb]=new Float32Array(Na[mb]);Ic=Na}mc=Ic}Qb=P(a,b,H,K,Pb,kc,mc,Wa,xb,Cc,Ba,Gc);L.push.apply(L,Qb)}"INSTANCE"==Wa.b4w_wind_bend_inheritance&&A.k.rf&&ia.warn('Emitter object "'+A.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else B.q("Unknown particle settings type")}aa?
d.push.apply(d,L):d=L}return d}function r(a){for(var b=[],c=[],d={},g=0;g<a.length;g++){var e=a[g].za,q=null;if(e.id in d){var f=d[e.id],k=c[f].za;G(e,function(a){G(k,function(b){B.sZ(a,b)&&1!=a.zJ&&(q=c[f])})});if(!q){do e.id++;while(d[e.id])}}q||(q={za:e,xK:[],ZF:[],BM:[],Id:[],aL:[],kg:[]},d[e.id]=c.length,c.push(q));if(a[g].Of&&a[g].Of.Ja){q.xK.push(a[g].ff);q.ZF.push(a[g].au);q.BM.push(a[g].Of);for(var u=0;u<a[g].Id.length;u++)e=a[g].Id[u],-1==q.aL.indexOf(e.uuid)&&(q.Id.push(e),q.aL.push(e.uuid));
for(u=0;u<a[g].kg.length;u++)e=a[g].kg[u],-1==q.kg.indexOf(e)&&q.kg.push(e)}q.kg.sort()}for(g=0;g<c.length;g++){var e=c[g].za,p=c[g].xK,m=c[g].ZF,h=c[g].BM;a=sa.Wz(m[0]);if("STATIC"==a.type)for(u=0;u<p.length;u++){var t=p[u],F=m[u],d=h[u],S=N.identity(va);t.Gg&&!t.iq?(t=N.hc(t.n,Ea),N.kf(t,S)):N.copy(t.n,S);F.sm?d.Jf||(F.Gg?ea.uZ(d,S):ea.ox(d,S)):ea.ox(d,S);if(F.sm)x(e,"AU_QUALIFIER","GLSL_IN");else if(1<c[g].Id.length){t={};if(F.rf||F.Gg)t.au_center_pos=[S[0],S[1],S[2]];F.rf&&(t.au_wind_bending_amp=
[F.th],t.au_wind_bending_freq=[F.uh],t.au_detail_bending_amp=[F.Og],t.au_detail_bending_freq=[F.Pg],t.au_branch_bending_amp=[F.Jg]);ea.tZ(d,t);x(e,"AU_QUALIFIER","GLSL_IN")}else a.sq.set(S.subarray(0,3)),F.sq.set(S.subarray(0,3)),x(e,"AU_QUALIFIER","uniform")}if(0==h.length)d=ea.If(B.Ps("%empty"));else if(1==h.length)d=h[0];else{d=[];for(u=0;u<h.length;u++)ea.ZV(h[u])||d.push(u);if(d.length<h.length)for(u=0;u<d.length;u++)ea.px(h[d[u]]);d=ea.zM(h)}if(1<c[g].Id.length){h=[];for(u=0;u<c[g].Id.length;u++)E.SA(c[g].Id[u].pb.k.aG,
h);E.$F(h,a.Ua);E.Dn(a.Ua,a.R);a.qb=E.tu(B.Ef(h),!0);E.bA(a.qb,a.ba);a.lb=E.Kq(a.qb);E.dA(a.lb,a.wa)}a.Sf=E.FB(a.ba,a.wa);"STATIC"==a.type&&a.co&&(u=c[g].Id[0].b4w_cluster_data,u.cluster_center&&u.cluster_radius?(a.Rr.set(u.cluster_center),a.Sr=u.cluster_radius):(a.Rr.set(a.lb.F),a.Sr=a.lb.Ya));"PARTICLES"!=e.type&&(u=d.Pf,e.R=E.Cl(u.R),e.ba=E.yq(u.ba),e.wa=a.wa.Ya<u.wa.Ya?"STATIC"==a.type?E.Dl(a.lb):E.Dl(a.wa):E.Dl(u.wa),"STATIC"==a.type?(e.qb=e.ba,e.Ua=e.R,e.lb=e.wa):(u=a.n,e.qb=E.lq(e.ba,u),e.lb=
E.mq(e.wa,u),e.Ua=E.Al(e.R,u)),e.Sf=E.FB(e.ba,e.wa));b.push({za:e,k:a,Of:d,kg:c[g].kg,Id:c[g].Id})}return b}function A(a,b,c,d){a.gq=E.dG(b,d);a.eq=E.bG(c,d);a.fq=E.cG(b,d)}function h(a,b,c,d){var g=[];d||(b.Dk&&la.gc(a,ta.tf)||b.Vc&&la.gc(a,ta.Cg))&&g.push("COLOR_ID");c&&(g.push("MAIN"),g.push("NODES_GLOW"),la.gc(a,ta.wf)&&g.push("DEBUG_VIEW"),la.gc(a,ta.yf)&&g.push("SHADOW"),la.gc(a,ta.vi)&&g.push("GRASS_MAP"));g.push("PHYSICS");if(b.qe||b.Hd)for(a=null,b.qe&&(a=["MAIN","NODES_GLOW","COLOR_ID",
"PHYSICS","DEBUG_VIEW"]),b.Hd&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?B.LQ(a,b):b),b=a,a=0;a<b.length;a++)c=g.indexOf(b[a]),-1!==c&&g.splice(c,1);return g}function w(a,b){var d;switch(a.type){case "MAIN":if(b.b4w_do_not_render)d=!1;else{if(b.use_nodes&&"HALO"!=b.type)J(a,b,"MAIN");else{f(a,b);d=b.game_settings.alpha_blend;a.vh=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.pg=b.offset_z;a.li.set([1,1,1]);var g=b.texture_slots;ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],
b.alpha,a.$f);if(b.b4w_lens_flares){U(a,"lens_flares.glslv","lens_flares.glslf");M(a,"a_position");M(a,"a_texcoord");var e=ma.he(g[0]),u=g[0].texture;R(a,e,"u_sampler",u.name)}else{U(a,"main.glslv","main_stack.glslf");b.use_shadeless||(d=S.mA(b.uuid,b.name,{Ke:b.use_shadeless,Vq:b.diffuse_shader,Js:b.specular_shader,dn:b.use_tangent_shading}),a.ib.og=S.pu(d));var p=v("use_map_color_diffuse",g),h=v("use_map_color_spec",g),E=v("use_map_normal",g),t=v("use_map_mirror",g),F=v("use_stencil",g);d=p[0];
h=h[0];E=E[0];t=t[0];p=p[1];g=F[0]&&v("use_rgb_to_intensity",g)[0];if(d){u=d.texture;switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e=ma.he(d);R(a,e,"u_colormap0",u.name);a.Nl=d.diffuse_color_factor;a.pl=d.use_map_alpha?d.alpha_factor:0;a.li.set(d.scale)}F=d&&d==h;h&&(F||(u=h.texture,e=ma.he(h),R(a,e,"u_specmap0",u.name)),a.Qo=h.specular_color_factor);if(E&&(u=E.texture,M(a,"a_tbn_quat"),
e=ma.he(E),R(a,e,"u_normalmap0",u.name),a.kw=E.normal_factor,u.b4w_use_map_parallax&&ja.sw)){var e=ha.N(u.b4w_parallax_steps),n=ha.N(u.b4w_parallax_lod_dist);x(a,"PARALLAX",1);x(a,"PARALLAX_STEPS",e);x(a,"PARALLAX_LOD_DIST",n);a.so=u.b4w_parallax_scale}t&&(u=t.texture,e=ma.he(t),R(a,e,"u_mirrormap",u.name),a.Ur=t.mirror_factor);if(t=d&&p&&g?1:0)e=ma.he(p),u=p.texture,R(a,e,"u_colormap1",u.name),e=ma.he(g),u=g.texture,R(a,e,"u_stencil0",u.name);(u=d||h||E)&&a.li.set(u.scale);x(a,"TEXTURE_SPEC",void 0==
h?0:1);x(a,"ALPHA_AS_SPEC",F?1:0);x(a,"TEXTURE_STENCIL_ALPHA_MASK",t);M(a,"a_position");M(a,"a_tbn_quat");(d||h||E)&&M(a,"a_texcoord");if(b.b4w_water){a.yj=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.Lb?(ia.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.ft=!1):a.ft="REFLECT"!=a.Fb?b.b4w_water_shore_smoothing:!1;U(a,"water.glslv","water.glslf");t=S.mA(b.uuid,b.name,{Ke:!1,Vq:b.diffuse_shader,Js:b.specular_shader,dn:b.use_tangent_shading});
a.ib.og=S.pu(t);M(a,"a_position");ja.HN?(M(a,"a_polyindex"),a.Va=!0,za.set(0,0,0,a.wireframe_edge_color),q.nB()?x(a,"DEBUG_WIREFRAME",1):x(a,"DEBUG_WIREFRAME",2)):x(a,"DEBUG_WIREFRAME",0);F=b.texture_slots;t=v("use_map_normal",F);e=v("use_map_mirror",F)[0];t.length&&(n=ma.he(t[0]),u=t[0].texture,R(a,n,"u_normalmap0",u.name),a.op=b.b4w_water_norm_uv_velocity);x(a,"NUM_NORMALMAPS",t.length);a.fj=Array(t.length);for(u=0;u<t.length;u++)a.fj[u]=new Float32Array(2),a.fj[u].set([t[u].scale[0],t[u].scale[1]]);
e&&(n=ma.he(e),u=e.texture,R(a,n,"u_mirrormap",u.name),a.Ur=e.mirror_factor);e=null;if(ja.fr)for(u=0;u<F.length;u++){var T=F[u];if(!0===T.texture.b4w_water_foam){e=T;break}}e&&(x(a,"FOAM",1),n=ma.he(e),u=e.texture,R(a,n,"u_foam",u.name),a.Sn=b.b4w_foam_factor,a.Tu.set(u.b4w_foam_uv_freq),a.Su.set(u.b4w_foam_uv_magnitude),a.gr[0]=e.scale[0],a.gr[1]=e.scale[1]);for(u=0;u<F.length;u++)if(T=F[u],!0===T.texture.b4w_shore_dist_map){var ca=T;break}ca&&ja.St&&(F=ma.he(ca),u=ca.texture,R(a,F,"u_shore_dist_map",
u.name),x(a,"SHORE_PARAMS",1),ca=T.texture.b4w_shore_boundings,x(a,"MAX_SHORE_DIST",ha.N(T.texture.b4w_max_shore_dist)),x(a,"SHORE_MAP_SIZE_X",ha.N(ca[0]-ca[1])),x(a,"SHORE_MAP_SIZE_Y",ha.N(ca[2]-ca[3])),x(a,"SHORE_MAP_CENTER_X",ha.N((ca[0]+ca[1])/2)),x(a,"SHORE_MAP_CENTER_Y",ha.N((ca[2]+ca[3])/2)));b.b4w_generated_mesh?(x(a,"GENERATED_MESH",1),a.Mx=!0,a.Nx=b.b4w_water_num_cascads,a.Ox=b.b4w_water_subdivs,a.Lx=b.b4w_water_detailed_dist):(M(a,"a_tbn_quat"),(e||t.length)&&M(a,"a_texcoord"),x(a,"GENERATED_MESH",
0));if(b.b4w_water_dynamic){var T=ha.N(b.b4w_water_dst_noise_scale0),ca=ha.N(b.b4w_water_dst_noise_scale1),t=ha.N(b.b4w_water_dst_noise_freq0),F=ha.N(b.b4w_water_dst_noise_freq1),u=ha.N(b.b4w_water_dir_min_shore_fac),e=ha.N(b.b4w_water_dir_freq),n=ha.N(b.b4w_water_dir_noise_scale),l=ha.N(b.b4w_water_dir_noise_freq),G=ha.N(b.b4w_water_dir_min_noise_fac),r=ha.N(b.b4w_water_dst_min_fac),ga=ha.N(b.b4w_water_waves_hor_fac);x(a,"DST_NOISE_SCALE_0",T);x(a,"DST_NOISE_SCALE_1",ca);x(a,"DST_NOISE_FREQ_0",t);
x(a,"DST_NOISE_FREQ_1",F);x(a,"DIR_MIN_SHR_FAC",u);x(a,"DIR_FREQ",e);x(a,"DIR_NOISE_SCALE",n);x(a,"DIR_NOISE_FREQ",l);x(a,"DIR_MIN_NOISE_FAC",G);x(a,"DST_MIN_FAC",r);x(a,"WAVES_HOR_FAC",ga)}C(a,b);O(a,b);a.Ho.set(b.b4w_shallow_water_col);a.Jo.set(b.b4w_shore_water_col);a.Io=b.b4w_shallow_water_col_fac;a.Ko=b.b4w_shore_water_col_fac;x(a,"ABSORB",ha.N(b.b4w_water_absorb_factor));x(a,"SSS_STRENGTH",ha.N(b.b4w_water_sss_strength));x(a,"SSS_WIDTH",ha.N(b.b4w_water_sss_width))}"HALO"===b.type&&(U(a,"halo.glslv",
"halo.glslf"),m(a,b),a.Oj=["a_position"]);b.use_tangent_shading&&(x(a,"USE_TBN_SHADING",1),M(a,"a_shade_tangs"));x(a,"TEXCOORD",0);x(a,"NORMAL_TEXCOORD",0);d&&k(a,d,"TEXTURE_COLOR0_CO");p&&k(a,p,"TEXTURE_COLOR1_CO");g&&k(a,g,"TEXTURE_STENCIL_ALPHA_MASK_CO");h&&k(a,h,"TEXTURE_SPEC_CO");E&&k(a,E,"TEXTURE_NORM_CO");x(a,"SHADELESS",b.use_shadeless?1:0);a.Ke=b.use_shadeless}d=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===d?0:1);x(a,"ALPHA_CLIP","CLIP"===d?1:0);x(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);b.use_vertex_color_paint?(x(a,"VERTEX_COLOR",1),M(a,"a_color")):x(a,"VERTEX_COLOR",0);a.Ej=b.ambient;a.Ol=b.diffuse_intensity;a.Vj=b.emit;a.Um.set(b.specular_color);a.Is=b.specular_alpha;C(a,b);O(a,b);b.b4w_wettable?x(a,"WETTABLE",1):x(a,"WETTABLE",0);c(a,b);b.b4w_refractive&&!a.Lb?(ia.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.zk=!1):a.zk=b.b4w_refractive;a.Iw=b.b4w_refr_bump}d=!0}break;case "NODES_GLOW":d=J(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||
b.b4w_do_not_render||"HALO"===b.type)d=!1;else if(f(a,b),a.Lb)d=!1;else{h=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==h?J(a,b,"SHADOW"):U(a,"shadow.glslv","shadow.glslf");ua.set(0,0,0,b.alpha,a.$f);M(a,"a_position");M(a,"a_tbn_quat");x(a,"ALPHA","OPAQUE"===h?0:1);a.li.set([1,1,1]);if((d=v("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===h){switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.li.set(d.scale);
x(a,"TEXTURE_COLOR",1);M(a,"a_texcoord");h=ma.he(d);d=d.texture;"IMAGE"!=h.source&&"ENVIRONMENT_MAP"!=h.source&&"CANVAS"!=h.source&&"NONE"!=h.source||R(a,h,"u_colormap0",d.name)}else x(a,"TEXTURE_COLOR",0);d=!0}break;case "PHYSICS":b.b4w_collision?(a.Xs=b.b4w_use_ghost,a.bc=b.b4w_collision_id,a.Dq=b.b4w_collision_margin,a.Bq=b.b4w_collision_group,a.Eq=b.b4w_collision_mask,a.Yl=b.physics.friction,a.Rl=b.physics.elasticity,d=!0):b.b4w_water?(a.yj=!0,a.Y_=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,d=!0):d=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)d=!1;else{f(a,b);a.sf=!1;a.Va=!0;a.Lb=!1;h=b.game_settings.alpha_blend;a.vh=b.b4w_render_above_all&&"OPAQUE"!=h&&"CLIP"!=h;b.use_nodes&&"CLIP"==h?J(a,b,"COLOR_ID"):U(a,"color_id.glslv","color_id.glslf");ua.set(0,0,0,b.alpha,a.$f);M(a,"a_position");x(a,"ALPHA","OPAQUE"===h?0:1);a.li.set([1,1,1]);d=v("use_map_color_diffuse",b.texture_slots)[0];h="CLIP"===h?1:0;x(a,"ALPHA_CLIP",h);if(d&&h){switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.li.set(d.scale);x(a,"TEXTURE_COLOR",1);M(a,"a_texcoord");h=ma.he(d);d=d.texture;"IMAGE"!=h.source&&"ENVIRONMENT_MAP"!=h.source&&"CANVAS"!=h.source&&"NONE"!=h.source||R(a,h,"u_colormap0",d.name)}else x(a,"TEXTURE_COLOR",0);d=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?d=!1:(f(a,b),a.Lb=!1,a.sf=!1,a.Va=!0,U(a,"grass_map.glslv","grass_map.glslf"),M(a,"a_position"),d=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,h=b.b4w_dynamic_grass_color?
b.b4w_dynamic_grass_color:null,a.$c.a_grass_size={bm:!0,src:[]},d?(a.$c.a_grass_size.src.push({name:d,jg:4}),x(a,"DYNAMIC_GRASS_SIZE",1)):x(a,"DYNAMIC_GRASS_SIZE",0),a.$c.a_grass_color={bm:!0,src:[]},h?(a.$c.a_grass_color.src.push({name:h,jg:7}),x(a,"DYNAMIC_GRASS_COLOR",1)):x(a,"DYNAMIC_GRASS_COLOR",0),x(a,"GRASS_TEXTURE_SIZE",ha.N(ka.zr)),d=!0);break;case "DEBUG_VIEW":d=H(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)d=!1;else{d=b.texture_slots;if(a.Ar)U(a,"particle_system.glslv","particle_system_stack.glslf"),
x(a,"HALO_PARTICLES",1),m(a,b);else{h={Ke:!1,Vq:b.diffuse_shader,Js:b.specular_shader,dn:b.use_tangent_shading};if(b.use_nodes){U(a,"particle_system.glslv","particle_system.glslf");J(a,b,"PARTICLES");d=!0;break a}U(a,"particle_system.glslv","particle_system_stack.glslf");h=S.mA(b.uuid,b.name,h);a.ib.og=S.pu(h);if(d=v("use_map_color_diffuse",d)[0]){x(a,"TEXTURE_COLOR",1);switch(d.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MULTIPLY")}a.Nl=d.diffuse_color_factor;a.pl=d.use_map_alpha?d.alpha_factor:0;h=ma.he(d);R(a,h,"default"+String(a.ya.length),d.texture.name)}}ua.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.$f);a.Ej=b.ambient;a.Ol=b.diffuse_intensity;a.Vj=b.emit;a.Um.set(b.specular_color);a.Is=b.specular_alpha;M(a,"a_position");M(a,"a_tbn_quat");d=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===d?0:1);x(a,"ALPHA_CLIP","CLIP"===d?1:0);x(a,"PARTICLES_SHADELESS",b.use_shadeless?
1:0);C(a,b);O(a,b);f(a,b);d=b.game_settings.alpha_blend;a.vh=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.pg=b.offset_z;d=!0}break;default:B.q("Wrong batch type: "+a.type)}return d}function m(a,b){var c=b.halo;x(a,"NUM_RINGS",c.ring_count);x(a,"NUM_LINES",c.line_count);x(a,"NUM_STARS",c.star_tip_count);x(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.uv=c.size;a.rv=c.hardness/20;a.tv.set(c.b4w_halo_rings_color);a.sv.set(c.b4w_halo_lines_color);a.vv=1/b.b4w_halo_stars_blend_height;a.wv=b.b4w_halo_stars_min_height;
a.qv=!0}function k(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":x(a,c,"TEXTURE_COORDS_UV_ORCO");x(a,"TEXCOORD",1);break;case "NORMAL":x(a,c,"TEXTURE_COORDS_NORMAL");x(a,"NORMAL_TEXCOORD",1);break;default:x(a,c,"TEXTURE_COORDS_NONE")}}function f(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.Lb=!0;a.sf=!0;a.Va=!0;a.Eg=!1;break;case "ALPHA":a.Lb=!0;a.sf=!1;a.Va=!0;a.Eg=!1;break;case "CLIP":a.Lb=!1;a.sf=!1;a.Va=!0;a.Eg=!0;break;case "ADD":a.Lb=!0;a.sf=!1;a.Va=!1;a.Eg=
!1;break;case "OPAQUE":a.Lb=!1;a.sf=!1;a.Va=!0;a.Eg=!1;break;default:B.q("Unknown alpha blend mode: "+d)}a.Zb=c.use_backface_culling}function v(a,b){for(var c=[],d=b.length,g=0;g<d;g++){var e=b[g];1==e[a]&&e.texture&&e.texture.s&&c.push(e)}return c}function c(a,b){var c=b.raytrace_transparency;a.Pi[0]=c.fresnel;a.Pi[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.zo=c.reflect_factor;a.Pi[2]=c.fresnel;a.Pi[3]=1-c.fresnel_factor/5}function C(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=
b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:ia.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Nk[0]=b.specular_intensity;a.Nk[1]=c;a.Nk[2]=d}function O(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Td[0]=0;a.Td[1]=0;break;case "OREN_NAYAR":a.Td[0]=b.roughness;a.Td[1]=0;break;case "FRESNEL":a.Td[0]=
b.diffuse_fresnel;a.Td[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Td[0]=b.darkness;a.Td[1]=0;break;case "TOON":a.Td[0]=b.diffuse_toon_size;a.Td[1]=b.diffuse_toon_smooth;break;default:ia.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Td[0]=0,a.Td[1]=0}}function J(a,b,d){if(!b.use_nodes||b.b4w_do_not_render)return!1;var g;switch(d){case "MAIN":U(a,"main.glslv","main.glslf");g=!1;break;case "GLOW":U(a,"main.glslv","main.glslf");g=!0;break;case "SHADOW":U(a,
"shadow.glslv","shadow.glslf");g=!1;break;case "COLOR_ID":U(a,"color_id.glslv","color_id.glslf"),g=!1}var e=b.node_tree;d=S.hS(e,b.uuid,!1,b.name,d);if(!d.Xa)return ia.error('Failed to create node graph for material "'+b.name+'", disable nodes'),L(a,b),!0;a.nk=d.id;a.ak=!0;x(a,"NODES",1);x(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);M(a,"a_position");b.use_orco_tex_coord&&M(a,"a_orco_tex_coord");f(a,b);a.pg=b.offset_z;var u=b.game_settings.alpha_blend;g?(x(a,"ALPHA",1),x(a,"ALPHA_CLIP",
0)):(x(a,"ALPHA","OPAQUE"===u?0:1),x(a,"ALPHA_CLIP","CLIP"===u?1:0));a.vh=b.b4w_render_above_all&&"OPAQUE"!=u&&"CLIP"!=u;a.Vj=b.emit;a.Ej=b.ambient;c(a,b);b.b4w_wettable?x(a,"WETTABLE",1):x(a,"WETTABLE",0);var k=null,B=!1;T.pa(d.Xa,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var g=d.data.name,e=d.data.value;a.xj||(a.xj={});a.xj[e]=g;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":g=d.data.name;a.$c[g]={bm:!0,
src:[{name:d.data.value}]};e=0;if("GEOMETRY_VC"==d.type)e=7;else for(var f=0;f<d.gb.length;f++){var u="RGB".indexOf(d.gb[f].identifier);-1<u&&(e|=1<<2-u)}a.$c[g].src[0].jg=e;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":M(a,"a_tbn_quat");break;case "TEX_COORD_OB":x(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":x(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":d.data.value.dn&&(x(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&M(a,"a_shade_tangs"));
M(a,"a_tbn_quat");B=!0;break;case "BSDF_BEGIN":B=!0;M(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":g=d.data.name;e=d.data.Fz;f=d.data.value;R(a,f,g,e);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":x(a,"CALC_TBN_SPACE",1);M(a,"a_tbn_quat");d.data&&(g=d.data.name,e=d.data.Fz,f=d.data.value,R(a,f,g,e));break;case "NORMAL_MAP":M(a,"a_tbn_quat");switch(Number(d.Rb[0][1])){case S.LO:x(a,"CALC_TBN_SPACE",1);break;case S.KO:case S.JO:x(a,"USE_MODEL_TSR",1)}break;case "LAMP":d.data&&
(a.wm=d.data);break;case "B4W_REFRACTION":a.Lb?a.zk=!0:(a.zk=!1,ia.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));x(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":k||(k=d.data.kb);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.cs=d.data);break;case "VECT_TRANSFORM":switch(Number(d.Rb[1][1])){case S.aQ:x(a,"USE_MODEL_TSR_INVERSE",1);break;case S.$P:x(a,"USE_VIEW_TSR",1);break;case S.ZP:x(a,"USE_MODEL_TSR",1);break;case S.YP:x(a,"USE_MODEL_TSR",
1);x(a,"USE_VIEW_TSR",1);break;case S.XP:x(a,"USE_VIEW_TSR_INVERSE",1);break;case S.WP:x(a,"USE_MODEL_TSR_INVERSE",1),x(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":x(a,"USE_MODEL_TSR",1);a.qo[1]=b.pass_index;a.qo[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":x(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":x(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":M(a,"a_tbn_quat"),q.nB()?x(a,"USE_DERIVATIVES_EXT",1):ia.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});k&&R(a,k,"u_nodes_texture");B||(a.Ke=!0);g=a.ib.og=S.pu(d.Xa);K(e,a);e=a.dj;d=a.cj;for(u=0;u<g.length;u++){var p=g[u];switch(p.id){case "VALUE":var h=p.tw[0];if(h)for(var m=0;m<e.length;m+=2)if(e[m]==h){p.Rb.push(["VALUE_IND",e[m+1]]);break}break;case "RGB":if(h=p.tw[0])for(m=0;m<d.length;m+=2)if(d[m]==h){p.Rb.push(["RGB_IND",d[m+1]]);break}}}x(a,"NUM_VALUES",a.ej.length);x(a,"NUM_RGBS",a.Ee.length);return!0}function K(a,b){var c=[],d=[],g=[],e=[];D(a,"",c,d,g,e);b.ej=c;b.dj=
d;b.Ee=g;b.cj=e}function D(a,b,c,d,g,e){for(var q=0;q<a.nodes.length;q++){var f=a.nodes[q];if("VALUE"==f.type){var u=Q(b,f.name);c.push(f.outputs[0].default_value);d.push(u,d.length/2)}else"RGB"==f.type?(u=Q(b,f.name),f=f.outputs[0].default_value.slice(0,3),g.push(f[0],f[1],f[2]),e.push(u,e.length/2)):"GROUP"==f.type&&D(f.node_group.node_tree,Q(b,f.name),c,d,g,e)}}function Q(a,b){var c;return c=(a?a+"%join%":"")+b}function L(a,b){switch(a.type){case "SHADOW":U(a,"shadow.glslv","shadow.glslf");break;
case "COLOR_ID":U(a,"color_id.glslv","color_id.glslf");break;default:U(a,"main.glslv","main_stack.glslf")}x(a,"SHADELESS",1);M(a,"a_position");M(a,"a_tbn_quat");ua.set(1,0,1,1,a.$f);if(b){var c=b.game_settings.alpha_blend;x(a,"ALPHA","OPAQUE"===c?0:1);x(a,"ALPHA_CLIP","CLIP"===c?1:0);x(a,"VERTEX_COLOR",0);a.pg=b.offset_z;f(a,b)}return!0}function H(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;U(a,"debug_view.glslv","debug_view.glslf");M(a,"a_position");M(a,"a_tbn_quat");M(a,"a_polyindex");
a.Va=!0;za.set(0,0,0,a.wireframe_edge_color);return!0}function z(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.sm?x(a,"AU_QUALIFIER","GLSL_IN"):x(a,"AU_QUALIFIER","uniform"),x(a,"STATIC_BATCH",0)):(x(a,"AU_QUALIFIER","GLSL_IN"),x(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(q.nB()?x(a,"WIREFRAME_QUALITY",1):x(a,"WIREFRAME_QUALITY",0),a.Li?(x(a,"DEBUG_SPHERE",1),a.Du?x(a,"DEBUG_SPHERE_DYNAMIC",1):x(a,"DEBUG_SPHERE_DYNAMIC",0)):x(a,"DEBUG_SPHERE",0),x(a,"ALPHA",1));b.Le&&(a.Le=b.Le);b.rf?(""!==b.Yi?
(a.$c.a_bending_col_main={bm:!0,src:[{name:b.Yi,jg:4}]},M(a,"a_bending_col_main"),""!==b.Ae.MB&&""!==b.Ae.LB&&""!==b.Ae.vC?(a.$c.a_bending_col_detail={bm:!0,src:[{name:b.Ae.MB,jg:4},{name:b.Ae.LB,jg:2},{name:b.Ae.vC,jg:1}]},M(a,"a_bending_col_detail"),M(a,"a_tbn_quat"),x(a,"DETAIL_BEND",1)):x(a,"DETAIL_BEND",0),x(a,"MAIN_BEND_COL",1)):x(a,"MAIN_BEND_COL",0),b.wl?x(a,"BEND_CENTER_ONLY",1):x(a,"BEND_CENTER_ONLY",0),x(a,"WIND_BEND",1)):x(a,"WIND_BEND",0);x(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.iq|0);
b.Gg?x(a,"BILLBOARD",1):x(a,"BILLBOARD",0);b.Gg&&b.sm?x(a,"HAIR_BILLBOARD",1):x(a,"HAIR_BILLBOARD",0);b.jq?x(a,"BILLBOARD_SPHERICAL",1):x(a,"BILLBOARD_SPHERICAL",0);switch(b.kq){case "RANDOM":x(a,"BILLBOARD_RANDOM",1);x(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":x(a,"BILLBOARD_RANDOM",0);x(a,"BILLBOARD_JITTERED",1);break;default:x(a,"BILLBOARD_RANDOM",0),x(a,"BILLBOARD_JITTERED",0)}b.hd&&ja.St?x(a,"DYNAMIC_GRASS",1):x(a,"DYNAMIC_GRASS",0);a.hd=b.hd;"PARTICLES"!=a.type&&(a.ag=b.ag);a.He=b.He;
a.qe=b.qe;a.fe=b.fe&&!a.Ke&&!(a.Lb&&ja.GA);a.ee=b.ee;a.Hd=b.Hd;a.Gd=b.Gd;a.qo[0]=b.ww;a.ef=b.ef;a.bh=b.bh;a.dh=b.dh;a.Rd=b.Rd;a.Ed=b.Ed;b.hk?(M(a,"a_influence"),x(a,"SKINNED",1),ja.cx?(x(a,"DISABLE_TANGENT_SKINNING",1),x(a,"FRAMES_BLENDING",0)):(x(a,"DISABLE_TANGENT_SKINNING",0),b.Xl?x(a,"FRAMES_BLENDING",1):x(a,"FRAMES_BLENDING",0)),x(a,"MAX_BONES",b.eh)):(x(a,"SKINNED",0),x(a,"FRAMES_BLENDING",0),x(a,"DISABLE_TANGENT_SKINNING",0));b.Zc?(x(a,"VERTEX_ANIM",1),ja.AN?x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",
.5):x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):x(a,"VERTEX_ANIM",0);b.hk&&b.Zc&&B.q("Skinning and vertex animation are mutually exlusive")}}function d(a,b,c){if(b.length){for(var d=sa.fv(b,ja.ssao&&c.b4w_enable_ssao),g=a.ib,e=a.wm,f=0,q=0;q<a.ib.og.length;q++){var u=a.ib.og[q];if("LIGHTING_LAMP"==u.id){var k=b[f++%b.length],B=k.ub,m=sa.ka(k,c);if("SPOT"==B.type||"POINT"==B.type)var h=Math.cos(B.Wm/2);if("SPOT"==B.type)var E=B.Ls*(1-h);k=d.indexOf(k);u.Rb=[["LAMP_TYPE",B.type],["LAMP_IND",
m.xm],["LAMP_SPOT_SIZE",ha.N(h||.01)],["LAMP_SPOT_BLEND",ha.N(E||.01)],["LAMP_LIGHT_DIST",ha.N(B.distance)],["LAMP_USE_SPHERE",B.jE?1:0],["LAMP_SHADOW_MAP_IND",k]]}else if("LAMP"==u.id&&e)for(var m=u.Rb[0][1],t=0;t<b.length;t++)if(k=b[t],e[k.wj]==m){B=k.ub;if("SPOT"==B.type||"POINT"==B.type)h=Math.cos(B.Wm/2);"SPOT"==B.type&&(E=B.Ls*(1-h));u.Rb.push(["LAMP_TYPE",B.type],["LAMP_SPOT_SIZE",ha.N(h||.01)],["LAMP_SPOT_BLEND",ha.N(E||.01)],["LAMP_LIGHT_DIST",ha.N(B.distance)],["LAMP_USE_SPHERE",B.jE?1:
0])}}if(e){c=0;for(var F in e)c++;a.io=new Float32Array(3*c);a.Nr=new Float32Array(3*c);a.Mr=new Float32Array(3*c);ha.ia(g,"NUM_LAMP_LIGHTS",c);for(q=0;q<b.length;q++)p(a,b[q])}}}function p(a,b){if(b.wj in a.wm){var c=a.wm[b.wj];a.io.set(N.G(b.k.n),3*c);a.Nr.set(b.ub.direction,3*c);a.Mr.set(b.ub.Fq,3*c)}}function M(a,b){var c=a.Oj;-1==c.indexOf(b)&&c.push(b);a.Oj=c.sort()}function x(a,b,c){ha.ia(a.ib,b,c)}function g(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.Fb?a.Ca=ea.AM(b,ea.on,[]):(0<b.jb.length&&
ea.vZ(b,b.aa[0]),a.Of=b);else{var c=a.Mh;a.qv&&"PARTICLES"!=a.type&&(b=ea.aU(b));a.Mx&&(b=Y.BU(a.Nx,a.Ox,a.Lx));c=ea.AM(b,c,a.$c);a.Ca=c;a.ag||a.sf||a.Le||(c.le=null,c.tc.length=0);c=b.aa.length;a.Yr=b.Ja*c;var d;a:switch(a.Mh){case ea.on:case ea.wp:case ea.nt:d=!0;break a;default:d=!1}d?ea.YV(b)?a.Dm=b.na.length/3*c:a.Dm=b.Ja/3*c:a.Dm=0}}function P(a,b,c,d,g,e,q,f,u,k,p,m){var h=a.pb,E=[],F=f.b4w_dynamic_grass;if(!k&&F)return E;for(var S="INSTANCE"==f.b4w_wind_bend_inheritance,T="INSTANCE"==f.b4w_shadow_inheritance,
ca="INSTANCE"==f.b4w_reflection_inheritance,l=[],G=[],r=0;r<g.length;r++){var R=g[r].pb.k,v=sa.Wz(b);v.Gg=f.b4w_hair_billboard;v.kq=f.b4w_hair_billboard_type;v.jq="SPHERICAL"==f.b4w_hair_billboard_geometry;v.hd=F;v.sm=!0;S?(v.rf=R.rf,v.kn=R.kn,v.uh=R.uh,v.Pg=R.Pg,v.Yi=R.Yi,v.Og=R.Og,v.Jg=R.Jg,v.th=R.th,v.Ae=R.Ae,v.wl=!1):(v.rf=h.k.rf,v.kn=h.k.kn,v.uh=h.k.uh,v.Pg=h.k.Pg,v.Yi=h.k.Yi,v.Og=h.k.Og,v.Jg=h.k.Jg,v.th=h.k.th,v.Ae=h.k.Ae,v.wl=!0);T?(v.He=R.He,v.qe=R.qe,v.fe=R.fe):(v.He=h.k.He,v.qe=h.k.qe,v.fe=
h.k.fe);ca?(v.ee=R.ee,v.Hd=R.Hd,v.Gd=R.Gd,v.Rd=R.Rd,v.Ed=R.Ed,v.lh=R.lh):(v.ee=h.k.ee,v.Hd=h.k.Hd,v.Gd=h.k.Gd,v.Rd=h.k.Rd,v.Ed=h.k.Ed,v.lh=h.k.lh);l.push(v);var ga=q[r];ga||(ga=new Float32Array);m&&B.Ev(u.seed,p);var U=new Float32Array(3),w=new Float32Array([0,0,0,1]),M=[],P=ya.IG(ja.TB)&&!f.b4w_initial_rand_rotation&&!f.b4w_hair_billboard,ha=4;P&&(ha=8);for(var C=0;C<ga.length;C+=ha){U[0]=ga[C];U[1]=ga[C+1];U[2]=ga[C+2];var aa=ga[C+3]*N.Yd(R.n);if(f.b4w_initial_rand_rotation){switch(f.b4w_rotation_type){case "XYZ":var Y=
new Float32Array([B.tg(p),B.tg(p),B.tg(p)]);za.normalize(Y,Y);break;case "Z":Y=new Float32Array([0,0,1]);break;default:B.q("Unsupported random rotation type: "+f.b4w_rotation_type)}na.setAxisAngle(Y,f.b4w_rand_rotation_strength*(2*Math.PI*B.tg(p)-Math.PI),w)}else P&&(w.set(ga.subarray(C+4,C+8)),B.JC(w,w),f.use_whole_group||(f.use_rotation_dupli?na.multiply(w,N.P(R.n),w):na.multiply(w,Pa,w)));var Z=N.hi(U,aa,w,N.create());M.push(Z)}G.push(M)}for(var H={},ta=0,r=0;r<g.length;r++)for(var ba=g[r].data.materials,
C=0;C<ba.length;C++)ba[C].name in H?H[ba[C].name]++:(H[ba[C].name]=1,ta++);for(var ta=ta?ta:1,ma={},r=0;r<g.length;r++){var D=g[r],oa=e[r],v=l[r],y={};v.rf&&(y.au_wind_bending_amp=[v.th],y.au_wind_bending_freq=[v.uh],y.au_detail_bending_freq=[v.Pg],y.au_detail_bending_amp=[v.Og],y.au_branch_bending_amp=[v.Jg],v.th=0,v.uh=0,v.Pg=0,v.Og=0,v.Jg=0);M=G[r];if(M.length){for(var O=D.data,ba=O.materials,J=Array(ba.length),ua=Array(ba.length),C=0;C<ba.length;C++)if(!ea.oJ(O,C))for(var xb=0;xb<oa.length;xb++){var Wa=
oa[xb],Fa=n(Wa),K=ba[C];"MAIN"==Wa?J[C]=Fa:"DEBUG_VIEW"==Wa&&(ua[C]=Fa);Fa.Aq=a.b4w_cluster_data.cluster_id;if(t(Fa,K)){"SHADOW"==Wa&&J[C]&&(Fa.Ke=J[C].Ke);Fa.Mh=ea.on;z(Fa,v);Fa.pk=f.uuid;Fa.Tj=a.b4w_do_not_cull||f.b4w_dynamic_grass;"MAIN"==Fa.type&&(Fa.Kg=a.b4w_caustics);x(Fa,"DISABLE_FOG",("COLOR_ID"!=Wa&&"SHADOW"!=Wa&&a.b4w_disable_fogging)|0);"JITTERED"==f.b4w_hair_billboard_type&&(Fa.Ov=f.b4w_hair_billboard_jitter_amp,Fa.Pv=f.b4w_hair_billboard_jitter_freq);F&&(Fa.lv=f.b4w_dynamic_grass_scale_threshold);
S||(delete Fa.$c.a_bending_col_main,delete Fa.$c.a_bending_col_detail);var A=ea.TA(O,C,Fa.Oj,b.Di,Fa.$c,Fa.xj),L=h.k.n,Q=!0;if(1<H[K.name]){var wa=0,la;for(la in A.aa)wa++;Q=A.na.length*M.length*wa*H[K.name]>2E5*ta}var xa=ja.GF&&Q&&"PHYSICS"!=Fa.type;if(xa){Fa.zJ=f.use_whole_group?2:1;var ka=B.S(A);ea.qG(A,ka,M);ka.Jf={ep:M,mx:L,sM:"STATIC"==b.type,Ns:y,Jm:{},Ku:F};if(v.rf&&v.wl){var Ea=za.fromValues(0,0,0);N.Xc(Ea,h.k.n,Ea);for(var Ca=[],pa=0;pa<M.length;pa++)Ca.push(Ea[0],Ea[1],Ea[2]);ka.Jf.Jm.a_emitter_center=
{Jc:3,data:Ca}}ea.qG(A,A,M);"STATIC"==b.type&&ea.gR(ka.Pf,L)}else{var Ba=ka=ea.JW(A,y,M),Ga=M;Ba.qa.au_center_pos=new Float32Array(3*Ba.Ja);for(var va=Ga.length,Ma=Ba.Ja/va,Ra=0;Ra<va;Ra++)for(var kc=Ga[Ra],Qb=3*Ma*Ra,Pb=0;Pb<Ma;Pb++)Ba.qa.au_center_pos[Qb+3*Pb]=kc[0],Ba.qa.au_center_pos[Qb+3*Pb+1]=kc[1],Ba.qa.au_center_pos[Qb+3*Pb+2]=kc[2];ka=Ba;if(v.rf&&v.wl){var lc=ka,Gc=h.k.n;lc.qa.a_emitter_center=new Float32Array(3*lc.Ja);var Jb=za.fromValues(0,0,0);N.Xc(Jb,Gc,Jb);for(var mc=0;mc<lc.Ja;mc++)lc.qa.a_emitter_center[3*
mc]=Jb[0],lc.qa.a_emitter_center[3*mc+1]=Jb[1],lc.qa.a_emitter_center[3*mc+2]=Jb[2];ka=lc}}var rb=f.b4w_vcol_from_name,db=f.b4w_vcol_to_name,ac=Fa,Yc=c,Db=!S,Rb=O,gb=[];if(""!==rb&&""!==db){var ob,Hc=db,nc=ac.$c,Ic=[],Kb=void 0;for(Kb in nc)for(var oc=nc[Kb].src,bc=0,Za=0;Za<oc.length;Za++){var cc=oc[Za].jg;Hc==oc[Za].name&&Ic.push(Kb,cc,bc);bc+=B.Nm(cc)}ob=Ic;if(0<ob.length)for(var Lb=0;Lb<ob.length;Lb+=3)gb.push({cr:rb,Mu:7,uw:ob[Lb],vw:ob[Lb+1],Ju:ob[Lb+2]});else ea.yV(ac.Oj,"a_color")&&db==Rb.active_vcol_name&&
gb.push({cr:rb,Mu:7,uw:"a_color",vw:7,Ju:0})}Db&&("a_bending_col_main"in Yc&&gb.push({cr:"a_bending_col_main",Mu:4,uw:"a_bending_col_main",vw:4,Ju:0}),"a_bending_col_detail"in Yc&&gb.push({cr:"a_bending_col_detail",Mu:7,uw:"a_bending_col_detail",vw:7,Ju:0}));for(var tb=ka,pc=M,ub=d,Mb=gb,Sb=Fa.$c,vc=xa,Jc=!1,Ia=0;Ia<Mb.length;Ia++){var fc=Mb[Ia].cr,Eb=ub.qa[fc];if(Eb&&0<Eb.length){Jc=!0;break}}if(vc)var Fb=tb.Jf.Jm;if(Jc){var Dc,Tb=h.k.R,jb=ub.aa[0].a_position,hb=pc,Ja=ma,Yb=new Float32Array(3),Gb=
new Float32Array(3),Na=new Uint32Array(hb.length);if(!("verts_indices"in Ja)){Ja.Ei=new Float32Array(3);Ja.Ci=new Float32Array(3);Ja.nE=new Uint32Array(jb.length/3);Ja.Zr=new Uint32Array(jb.length/3);Ja.Ei[0]=(Tb.max_x-Tb.min_x)/20;Ja.Ei[1]=(Tb.max_y-Tb.min_y)/20;Ja.Ei[2]=(Tb.max_z-Tb.min_z)/20;Ja.Ci[0]=Tb.min_x;Ja.Ci[1]=Tb.min_y;Ja.Ci[2]=Tb.min_z;for(var Oa=0;Oa<jb.length/3;Oa++){var mb=B.trunc((jb[3*Oa]-Ja.Ci[0])/Ja.Ei[0]),Oc=B.trunc((jb[3*Oa+1]-Ja.Ci[1])/Ja.Ei[1]),Kc=B.trunc((jb[3*Oa+2]-Ja.Ci[2])/
Ja.Ei[2]),mb=B.U(mb,0,19),Oc=B.U(Oc,0,19),Kc=B.U(Kc,0,19);Ja.nE[Oa]=Oa;Ja.Zr[Oa]=Kc*Math.pow(20,2)+20*Oc+mb}ea.fZ(Ja.Zr,Ja.nE,ea.fz,!0);Ja.en=new Uint32Array(Math.pow(20,3));for(Oa=0;Oa<Ja.Zr.length;Oa++)Ja.en[Ja.Zr[Oa]]++;delete Ja.Zr;for(Oa=1;Oa<Ja.en.length;Oa++)Ja.en[Oa]+=Ja.en[Oa-1]}for(var vb=0;vb<hb.length;vb++){Yb[0]=hb[vb][0];Yb[1]=hb[vb][1];Yb[2]=hb[vb][2];for(var Ec=1E10,Ub=-1,dc=B.trunc((Yb[0]-Ja.Ci[0])/Ja.Ei[0]),fd=B.trunc((Yb[1]-Ja.Ci[1])/Ja.Ei[1]),Zc=B.trunc((Yb[2]-Ja.Ci[2])/Ja.Ei[2]),
dc=B.U(dc,0,19),fd=B.U(fd,0,19),Zc=B.U(Zc,0,19),Sc=Zc*Math.pow(20,2)+20*fd+dc,$c=Ja.en[Sc],zb=0==Sc?0:Ja.en[Sc-1];zb<$c;zb++){var Ab=Ja.nE[zb];Gb[0]=jb[3*Ab];Gb[1]=jb[3*Ab+1];Gb[2]=jb[3*Ab+2];za.sub(Gb,Yb,Gb);var wc=za.sqrLen(Gb);wc<=Ec&&(Ec=wc,Ub=Ab)}if(-1==Ub)for(zb=0;zb<jb.length/3;zb++)Gb[0]=jb[3*zb],Gb[1]=jb[3*zb+1],Gb[2]=jb[3*zb+2],za.sub(Gb,Yb,Gb),wc=za.sqrLen(Gb),wc<=Ec&&(Ec=wc,Ub=zb);Na[vb]=Ub}Dc=Na;for(var gd=tb.Ja/pc.length,Ia=0;Ia<Mb.length;Ia++){var Xa=Mb[Ia].uw,$a=Mb[Ia].vw,fc=Mb[Ia].cr,
Tc=Mb[Ia].Mu,Eb=ub.qa[fc];switch(Xa){case "a_bending_col_main":var gc=1;break;case "a_bending_col_detail":gc=3;break;case "a_color":gc=3;break;default:for(var Nb=gc=0;Nb<Sb[Xa].src.length;Nb++)gc+=B.Nm(Sb[Xa].src[Nb].jg)}if(Eb&&0<Eb.length){var xc=B.Nm(Tc),hd=B.Nm($a),Uc=Tc&$a,yc=B.hL(Uc);Uc!=$a&&ia.error("Wrong color extraction from "+fc+" to "+Xa+".");if(vc)for(Fb[Xa]={Jc:gc,data:[]},Nb=0;Nb<pc.length;Nb++)for(qc=Dc[Nb],Lc=qc*xc,Vb=0;Vb<yc.length;Vb++)yc[Vb]&&(Mc=B.Co(Tc,Vb),Fb[Xa].data.push(Eb[Lc+
Mc]));else{if("a_bending_col_main"==Xa||"a_bending_col_detail"==Xa)tb.qa[Xa]=new Float32Array(tb.Ja*hd);for(Nb=0;Nb<pc.length;Nb++){var qc=Dc[Nb],Lc=qc*xc,Vc=Nb*gd*gc;if(-1!=qc)for(var hc=0;hc<gd;hc++)for(var rc=hc*gc,Vb=0;Vb<yc.length;Vb++)if(yc[Vb]){var Mc=B.Co(Tc,Vb);tb.qa[Xa][Vc+rc+(Mb[Ia].Ju+B.Co($a,Vb))]=Eb[Lc+Mc]}}}}else tb.qa[Xa]=new Float32Array(0)}}ka=tb;x(Fa,"USE_INSTANCED_PARTCLS",ka.Jf?1:0);da(Fa);E.push({za:Fa,ff:b,au:v,Of:ka,kg:[K.name],Id:[a]})}}for(C=0;C<ua.length;C++)ua[C]&&(ua[C].In=
J[C].id,da(ua[C]))}}return E}function t(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=S.GG(b));return c=c&&w(a,b)}function da(a){G(a,function(a){a.id=0;a.id=B.vR(a)})}function G(a,b){for(var c=null,d=null,g=[],e=0;e<a.ya.length;e++){var f=a.ya[e],q=f.Xf;q&&(c||(c={}),c[e]=q,f.Xf=null);if(q=f.Ta)d||(d={}),d[e]=q,f.Ta=null;g.push(f.ok);f.ok=0}var f=a.R,q=a.ba,u=a.wa,k=a.Ua,B=a.qb,p=a.lb;a.R=null;a.ba=null;a.wa=null;a.Ua=null;a.qb=null;a.lb=null;var h=a.Me;a.Me=null;b(a);a.Me=h;a.R=f;a.ba=q;a.wa=u;a.Ua=k;a.qb=
B;a.lb=p;if(c)for(e in c)a.ya[e].Xf=c[e];if(d)for(e in d)a.ya[e].Ta=d[e];for(e=0;e<a.ya.length;e++)a.ya[e].ok=g[e]}function F(a,b,c,d){var e=n("DEBUG_VIEW");U(e,"debug_view.glslv","debug_view.glslf");e.Li=!0;e.Va=!0;e.pk=b;e.Du=c;z(e,a);da(e);if(d.Sf){c?(c=d.ba,N.kf(d.ba.F,va)):(c=d.qb,N.kf(c.F,va));var f=za.create();a=Y.Xu(1,f);b=za.fromValues(za.length(c.Ga),za.length(c.Ha),za.length(c.Ia));ea.mL(a,b,f);var f=za.normalize(c.Ga,Ea),q=za.normalize(c.Ha,Ca);c=za.normalize(c.Ia,pa);!b[0]&&b[1]&&b[2]?
za.cross(q,c,f):!b[1]&&b[0]&&b[2]?za.cross(c,f,q):!b[2]&&b[0]&&b[1]&&za.cross(f,q,c);b=B.MT(f,q,c,Ma);ba.invert(b,b);b=na.fromMat3(b,Ba);N.Jk(b,va);N.Mf(1,va);ea.ox(a,va)}else c?(b=d.wa,a=Y.Xu(b.Ya,b.F)):(b=d.lb,a=Y.Xu(b.Ya,za.create()),N.identity(va),N.kf(b.F,va),ea.ox(a,va));e.R=E.Cl(d.R);e.ba=E.yq(d.ba);e.wa=E.Dl(d.wa);e.Ua=E.Cl(d.Ua);e.qb=E.yq(d.qb);e.lb=E.Dl(d.lb);ea.px(a,1,!0);a.qa.a_polyindex=ea.Pu(a);g(e,a);return e}function U(a,b,c){a.ib.yg=b;a.ib.Xe=c;ha.mY(a.ib)}function R(a,b,c,d){d=d||
"";-1==a.Ld.indexOf(c)&&(a.ya.push(b),a.Ld.push(c),a.Ig.push(d),ma.Cv(b));a.zb&&wa.UF(a)}function Z(a){a.ib||B.q("No shaders info for batch "+a.name);a.zb=ha.QU(a.ib);var b=a.ib;if(b.status===ha.hz){var c=a.zb.attributes,d=a.Ca.kd,g;for(g in c)d[g]||B.q('missing data for "'+g+'" attribute')}b.status&ha.YN&&ia.error("Texture limit exceeded for shader - "+b.Xe+', materials: "'+a.sd.join(", ")+'". Maximum texture count: '+xa.$B+", actual texture count: "+b.MM);b.status&ha.XN&&ia.error("Fragment uniform limit exceeded for shader - "+
b.Xe+', materials: "'+a.sd.join(", ")+'". Maximum fragment uniform count: '+xa.Yv+", actual fragment uniform count: "+b.rU);b.status&ha.aO&&ia.error("Vertex uniform limit exceeded for shader - "+b.yg+', materials: "'+a.sd.join(", ")+'". Maximum vertex uniform count: '+xa.Tr+", actual vertex uniform count: "+b.P_);b.status&ha.$N&&ia.error("Vertex attribute limit exceeded for shader - "+b.yg+', materials: "'+a.sd.join(", ")+'". Maximum attribute count: '+xa.aC+", actual attribute count: "+b.VF);b.status&
ha.ZN&&("MAIN"!=a.type||a.ak||ia.error("Varying limit exceeded for shader - "+a.ib.Xe+', materials: "'+a.sd.join(", ")+'"'),"MAIN"==a.type&&a.ak||"NODES_GLOW"==a.type)&&(d=c=0,a.xj&&(c=B.qr(a.xj)),a.$c&&(d=B.qr(a.$c)),ia.error("Varying limit exceeded for node shader - "+a.ib.Xe+", uv: "+c+", vc: "+d+', materials: "'+a.sd.join(", ")+'"'));b.status&ha.SN&&ia.error("Shader compilation/linking error: "+b.yg+", "+b.Xe+', materials: "'+a.sd.join(", ")+'"');return a.ib.status===ha.hz?(wa.RQ(a.zb),wa.NQ(a),
wa.UF(a),!0):!1}function u(a,b,c){a=a.I[0].W;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].eg&&-1!=a[d].sd.indexOf(b))return a[d];return null}function ga(a,b,c){a=a.I[0].W;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].eg&&-1!=a[d].sd.indexOf(b))return a[d];return null}function ca(a,b){a.$f.set(b.$f);a.Ol=b.Ol;a.Um.set(b.Um);a.Qo=b.Qo;a.Nk.set(b.Nk);a.Vj=b.Vj;a.Ej=b.Ej;a.Nl=b.Nl;a.pl=b.pl;a.zo=b.zo;a.Pi.set(b.Pi);a.so=b.so;a.Ho.set(b.Ho);a.Io=b.Io;a.Jo.set(b.Jo);a.Ko=b.Ko;a.Sn=b.Sn;a.op=b.op}
var E=l("__boundings"),aa=l("__config"),ia=l("__print"),q=l("__extensions"),T=l("__graph"),ba=l("__mat3"),S=l("__nodemat"),sa=l("__obj_util"),oa=l("__particles"),Y=l("__primitives"),na=l("__quat"),ya=l("__reformer"),wa=l("__renderer"),la=l("__scenegraph"),ha=l("__shaders"),ta=l("__subscene"),ma=l("__textures"),N=l("__tsr"),ea=l("__geometry"),B=l("__util"),za=l("__vec3"),ua=l("__vec4"),ja=aa.B,xa=aa.Gi,ka=aa.Eo,Pa=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),Ea=new Float32Array(3),Ca=new Float32Array(3),
pa=new Float32Array(3),Ba=new Float32Array(4),va=N.create(),Ma=ba.create();a.f0=Ga;var Ga="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Ra={};a.WQ=function(a){return Ra[a]||null};a.XQ=function(a,b){Ra[a]=b};a.KU=function(a,c,e,f){var q;q=a.s.Xa;for(var u=[],k=0;k<c.length;k++){var p=c[k],h=p.pb,m=h.k;if(!h.Gr){var t=sa.Sa(h),h=h.k,S=p.data.b4w_boundings,n=S.bs_rad,T=S.bs_cen,ca=S.bc_rad,l=S.caxis_x,G=S.caxis_y,v=S.caxis_z,R=S.be_ax,ga=S.be_cen,U=S.rbb.rbb_c,x=
S.rbb.rbb_s,S=E.Cl(h.vl);h.Gg&&(n=Math.max(Math.abs(S.max_x),Math.abs(S.min_x)),T=Math.max(Math.abs(S.max_y),Math.abs(S.min_y)),x=Math.max(Math.abs(S.max_z),Math.abs(S.min_z)),x=Math.sqrt(n*n+T*T+x*x),ca=Math.sqrt(n*n+T*T),S.max_x=S.max_y=S.max_z=x,S.min_x=S.min_y=S.min_z=-x,n=x,T=[0,0,0],l=[1,0,0],G=[0,1,0],v=[0,0,1],R=[x,x,x],ga=[0,0,0],U=[0,0,0],x=[x,x,x]);E.Dn(S,h.R);E.Al(h.R,h.n,h.Ua);h.wa=E.Hz(n,B.Ef(T));E.mq(h.wa,h.n,h.lb);h.ba=t?E.hq(l,G,v,ga):E.hq([1,0,0],[0,1,0],[0,0,1],ga);za.scale(h.ba.Ga,
R[0],h.ba.Ga);za.scale(h.ba.Ha,R[1],h.ba.Ha);za.scale(h.ba.Ia,R[2],h.ba.Ia);E.lq(h.ba,h.n,h.qb);t?A(h,ca,ca,h.R):(h.zd=E.XX(U,l,G,v,x),E.Ez(h.zd,h.n,h.aG));u.push.apply(u,y(p,m,q))}}q=r(u);for(u=0;u<q.length;u++)if(k=q[u].za,k.sd=q[u].kg,g(k,q[u].Of),d(k,e,a),"STATIC"==q[u].k.type&&"COLOR_ID"!=k.type){if(p=B.Ps("%meta%"+k.type+"%"+k.sd.join("%")+"%"),t=sa.Mq(p,"MESH"),sa.VW(t,q[u].k),sa.Zp(t,a),sa.Tt(t,a,k),f.push(t),"MAIN"==k.type)for(m=0;m<q[u].Id.length;m++)p=q[u].Id[m].pb,p.aw.push(t)}else p=
q[u].Id[0].pb,sa.Tt(p,a,k);if(ja.debug_view){for(u=0;u<q.length;u++)if(e=q[u].k,"DYNAMIC"==e.type&&(p=q[u].Id[0].pb,k=q[u].za,"MAIN"==k.type)){m=sa.ka(p,a);t=m.W;h=!1;for(m=0;m<t.length;m++)t[m].Li&&(h=!0);h||(e=F(e,p.name,!0,k),sa.Tt(p,a,e))}for(u=0;u<f.length;u++)p=f[u],e=p.k,m=sa.ka(p,a),k=m.W[0],"MAIN"==k.type&&(e=F(e,p.name,!1,k),sa.Tt(p,a,e));for(u=0;u<q.length;u++)k=q[u].za,"DEBUG_VIEW"==k.type&&(k.Cu=u)}for(u=0;u<c.length;u++)for(m=sa.ka(c[u].pb,a),t=m.W,m=0;m<t.length;m++)b(t[m]);for(u=0;u<
f.length;u++)for(m=sa.ka(f[u],a),t=m.W,m=0;m<t.length;m++)b(t[m])};a.xQ=function(a,c,d){var f=a.s.qp,q=n("MAIN");U(q,"sky.glslv","sky.glslf");if(c.procedural_skydome)x(q,"PROCEDURAL_SKYDOME",1),q.Iu=!0;else{var u=f.Po,k=la.gc(a.s.Xa,ta.Dg).p.wc;R(q,k,"u_sky");u&&(x(q,"WO_SKYTEX",1),u.invert&&x(q,"MTEX_NEGATIVE",1),u.rN&&x(q,"MTEX_RGBTOINT",1),x(q,"BLENDTYPE",u.kG),u.mN&&x(q,"WOMAP_BLEND",1),u.nN&&x(q,"WOMAP_HORIZ",1),u.pN&&x(q,"WOMAP_ZENUP",1),u.oN&&x(q,"WOMAP_ZENDOWN",1));f.Ys&&x(q,"WO_SKYBLEND",
1);f.Zs&&x(q,"WO_SKYPAPER",1);f.$s&&x(q,"WO_SKYREAL",1)}c.ee&&(q.ee=!0,c.Hd&&(q.Hd=!0));q.pg=99999;M(q,"a_position");c=Y.GU();g(q,c);b(q);d=sa.ka(d,a);q.Tj=!0;q.ba=E.Lg();q.qb=E.Lg();q.R=E.Qd();q.Ua=E.Qd();q.wa=E.Kh();q.lb=E.Kh();da(q);d.W.push(q);la.gc(a.s.Xa,ta.wf)&&(a=e(q),a.type="DEBUG_VIEW",a.Fb="",H(a),x(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.qa.a_polyindex=ea.Pu(c),g(a,c),a.In=q.id,da(a),d.W.push(a))};a.jA=function(a,b,c){c=sa.ka(a,c).W;var d=[];la.gc(b,ta.cd);var g=la.gc(b,ta.Nd),q=la.gc(b,ta.md),
f=la.gc(b,ta.Cg);b=la.gc(b,ta.tf);for(var u=0;u<c.length;u++){var k=c[u],B=null;"SHADOW"==k.type&&"RECEIVE"==k.Fb&&k.He&&(B=e(k),B.Fb="CAST");"MAIN"!=k.type&&"PARTICLES"!=k.type||!g&&!q||!k.ee||(B=e(k),B.Fb="REFLECT",B.zk=!1,B.sf&&(B.sf=!1,B.Va=!1),B.hb=k.hb);"COLOR_ID"==k.type&&f&&a.k.Vc&&(b&&a.k.Dk?(B=e(k),B.Fb="OUTLINE"):k.Fb="OUTLINE");B&&(B.eg=!0,da(B),d.push(B))}c.push.apply(c,d)};a.yY=A;a.$_=function(a,b,c){b?b=c*(b.max_z-b.min_z):(b=1,B.q("No bounding box for mesh"));if(0==b)return 0;a=b*
Math.tan(B.Cb(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.YQ=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.ZZ=L;a.YZ=d;a.uY=p;a.TF=function(a,b){x(a,"CSM_SECTION1",0);x(a,"CSM_SECTION2",0);x(a,"CSM_SECTION3",0);x(a,"NUM_CAST_LAMPS",0);if(b){x(a,"NUM_CAST_LAMPS",b.ah.length);ja.Wv&&x(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)x(a,"CSM_SECTION"+String(c),1);x(a,"SHADOW_TEX_RES",ha.N(b.csm_resolution));x(a,"CSM_FADE_LAST_CASCADE",
b.fade_last_cascade?1:0);x(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else x(a,"SHADOW_TEX_RES",0),x(a,"CSM_FADE_LAST_CASCADE",0),x(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.jf=x;a.cB=function(a,b){return ha.VU(a.ib,b)};a.WZ=g;a.XZ=da;a.Wt=U;a.Gj=R;a.QX=function(a,b,c){c=a.Ld.indexOf(c);-1<c&&(a.ya[c]=b)};a.KS=function(a,b){var c=n("MAIN");c.Lb=!0;ua.set(b[0],b[1],b[2],.5,c.$f);c.Mh=ea.wp;g(c,a);U(c,"main.glslv","main_stack.glslf");x(c,"SHADELESS",1);Z(c);return c};a.Yc=Z;a.JU=function(a,
c){for(var d=0;d<c.length;d++){var e=c[d].pb,q=n("LINE");U(q,"line.glslv","line.glslf");q.Lb=!0;q.Tj=!0;var f=Y.IU();g(q,f);b(q);q.R=E.Qd();q.Ua=E.Qd();q.ba=E.Lg();q.qb=E.Lg();q.lb=E.Kh();q.wa=E.Kh();sa.Zp(e,a);sa.ka(e,a).W.push(q);Z(q)}};a.FR=function(a){return a.zb.ds.length?a.zb.AC.u_cube_fog?!0:!1:!1};a.tS=function(){var a=n("DEPTH_PACK");a.Zb=!0;a.Va=!1;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");Z(a);return a};a.qA=function(a){var b=n("POSTPROCESSING");
U(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":x(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":x(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":x(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":x(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":x(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":x(b,"POST_EFFECT",
"POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":x(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":x(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:B.q("Wrong postprocessing effect: "+a)}b.Zb=!0;b.Va=!1;a=Y.Tc();g(b,a);Z(b);return b};a.NS=function(a){var b=n("SSAO");b.Va=!1;b.Zb=!0;var c=Y.Tc();g(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");x(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.rM);x(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:
0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=ma.Kl(ma.Ah,!1);c.source="NODE_TEX";ma.Rs(c,a,0);R(b,c,"u_ssao_special_tex");Z(b);return b};a.OS=function(a){var b=n("SSAO_BLUR");b.Va=!1;b.Zb=!0;var c=Y.Tc();g(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");x(b,"SSAO_BLUR_DEPTH",
a.ssao_blur_depth?1:0);Z(b);return b};a.qS=function(a){var b=n("COC");b.Va=!1;b.Zb=!0;var c=Y.Tc();g(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");x(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":x(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":x(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":x(b,"COC_TYPE","COC_COMBINE")}Z(b);return b};a.uS=function(a){var b=n("DOF");b.Va=!1;b.Zb=!0;var c=Y.Tc();g(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.p.dof_bokeh?x(b,"DOF_TYPE","DOF_BOKEH"):(x(b,"DOF_TYPE","DOF_SIMPLE"),x(b,"DEPTH_RGBA",1));Z(b);return b};a.DS=function(){var a=n("OUTLINE");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");Z(a);return a};a.wS=function(){var a=n("GLOW_COMBINE");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");Z(a);return a};a.xS=function(a,b,c){var d=n("GOD_RAYS");d.Va=!1;d.Zb=!0;var e=Y.AU();g(d,
e);U(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");x(d,"DEPTH_RGBA",a?1:0);x(d,"WATER_EFFECTS",b?1:0);x(d,"STEPS_PER_PASS",ha.N(c,1));Z(d);return d};a.yS=function(){var a=n("GOD_RAYS_COM");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");x(a,"SAFARI_CANVAS_ALPHA_HACK",ja.kL?1:0);Z(a);return a};a.sS=function(a,b){var c=n("SKY");c.Va=!1;c.Zb=!0;var d=Y.CU();g(c,d);if(b.procedural_skydome)U(c,"skybox.glslv","proc_skybox.glslf"),
x(c,"WATER_EFFECTS",1);else{U(c,"skybox.glslv","tex_skybox.glslf");if(a){d=a.s.qp;if(d.ix){var e=d.ix.texture,q=ma.he(d.ix);R(c,q,"u_sky_texture",e.name)}d.Po&&x(c,"WO_SKYTEX",1)}b.gM&&x(c,"MTEX_NEGATIVE",1);b.lM&&x(c,"MTEX_RGBTOINT",1);x(c,"BLENDTYPE",b.fM);b.hM&&x(c,"WOMAP_BLEND",1);b.iM&&x(c,"WOMAP_HORIZ",1);b.kM&&x(c,"WOMAP_ZENUP",1);b.jM&&x(c,"WOMAP_ZENDOWN",1);b.Ys&&x(c,"WO_SKYBLEND",1);b.Zs&&x(c,"WO_SKYPAPER",1);b.$s&&x(c,"WO_SKYREAL",1)}c.ba=E.Lg();c.qb=E.Lg();c.R=E.Qd();c.Ua=E.Qd();c.wa=
E.Kh();c.lb=E.Kh();Z(c);return c};a.pQ=function(a,b){var c=la.gc(a.s.Xa,ta.Dg);c&&(c=c.Ra[0].sa[0].za,sa.ka(b,a).W.push(c))};a.lS=function(a){var b=n("ANTIALIASING");b.Va=!1;b.Zb=!0;var c=Y.Tc();g(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ja.SK?(x(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),x(b,"AA_QUALITY",a.XH)):x(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");Z(b);return b};a.LS=function(a){var b=n("SMAA"),c=Y.Tc();g(b,c);U(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");
x(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");x(b,"SMAA_PASS",a);x(b,"SMAA_PREDICATION",0);x(b,"SMAA_REPROJECTION",0);Z(b);b.Va=!1;b.Zb=!0;return b};a.rS=function(){var a=n("COMPOSITING");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");Z(a);return a};a.CS=function(){var a=n("MOTION_BLUR");a.Zb=!0;a.Va=!1;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");Z(a);return a};a.PS=function(a){var b=
n("STEREO");b.Zb=!0;b.Va=!1;var c=Y.Tc();g(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");x(b,"ANAGLYPH","ANAGLYPH"===a?1:0);Z(b);return b};a.zS=function(){var a=n("LUMINANCE");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");Z(a);return a};a.mS=function(){var a=n("LUMINANCE");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");Z(a);return a};
a.AS=function(){var a=n("LUMINANCE_X_BLUR");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");Z(a);return a};a.oS=function(){var a=n("POSTPROCESSING");a.Zb=!0;a.Va=!1;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");Z(a);return a};a.pS=function(){var a=n("BLOOM");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
Z(a);return a};a.mT=function(){var a=n("VELOCITY");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");Z(a);return a};a.kS=function(){var a=n("ANCHOR_VISIBILITY");a.Va=!0;a.Zb=!0;a.Mh=ea.wp;U(a,"anchors.glslv","anchors.glslf");var b=Y.cI(1);g(a,b);x(a,"ANCHOR_NUM",1);Z(a);a.ql=new Float32Array(3);return a};a.ES=function(){var a=n("PERFORMANCE");a.Va=!1;a.Zb=!0;var b=Y.Tc();g(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
Z(a);return a};a.VZ=function(a,b){var c=b.length/3;if(c!=a.ql.length/3){var d=Y.cI(c);g(a,d);x(a,"ANCHOR_NUM",c);Z(a)}a.ql=b};a.Q4=function(a){if(!a.I.length)return null;a=a.I[0];return a.W.length?a.W[0]:null};a.jU=u;a.e4=ga;a.t8=ca;a.N2=function(a,b){for(var c=a.I[0].W,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.OG=function(a){for(var b=a.ya,c=0;c<b.length;c++)ma.OC(b[c]);a.Ca.Yf&&ea.ZR(a.Ca);a.Yf&&a.Me.length&&wa.bS(a);a.zb.Yf&&ha.aS(a.zb);a.nk&&(b=S.GI(a.nk))&&b.NG&&S.$R(a.nk)};a.HV=
function(a,b,c,d){for(var g=["MAIN","SHADOW","COLOR_ID"],e=!1,q=0;q<g.length;q++){var f=g[q],k=u(a,b,f),B=u(c,d,f);if(k&&B){var e=!0,p=ga(c,d,f);"MAIN"==f&&(ca(B,k),p&&ca(p,k));for(f=0;f<B.Ld.length;f++){var h=B.Ld[f];if(-1!==Ga.indexOf(h)){var m=k.Ld.indexOf(h);-1!==m&&(m=k.ya[m],ma.OC(B.ya[f]),B.ya[f]=m,ma.Cv(m),p&&(h=p.Ld.indexOf(h),-1!==h&&(ma.OC(p.ya[h]),p.ya[h]=m,ma.Cv(m))))}}}}e||ia.error("Wrong objects for inheriting material!")};a.BY=function(a,b,c,d){for(var g=0;g<a.I.length;g++)for(var e=
a.I[g].W,q=0;q<e.length;q++){var f=e[q];-1!=f.sd.indexOf(b)&&f.ej&&(f.ej[c]=d)}};a.AY=function(a,b,c,d,g,e){for(var q=0;q<a.I.length;q++)for(var f=a.I[q].W,u=0;u<f.length;u++){var k=f[u];-1!=k.sd.indexOf(b)&&k.Ee&&(k.Ee[3*c]=d,k.Ee[3*c+1]=g,k.Ee[3*c+2]=e)}};a.l5=function(a,b){return a.ej[b]};a.k5=function(a,b,c){c[0]=a.Ee[3*b];c[1]=a.Ee[3*b+1];c[2]=a.Ee[3*b+2];return c};a.HI=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+="%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};
a.ua=function(){Ra={}}};b4w.module.__extensions=function(a,l){function n(a){if(a in h)return h[a];var b=A.getExtension(a)||null;h[a]=b;y.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function e(a){if(a in h)return h[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=A;break;case "EXT_disjoint_timer_query":(b=A.getExtension("EXT_disjoint_timer_query")||null)||(b=A.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}h[a]=b;y.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=l("__config"),y=l("__print"),r=b.B,A=null,h={};a.Nf=function(a){A=a};a.RI=function(){return n("WEBGL_compressed_texture_s3tc")||n("WEBKIT_WEBGL_compressed_texture_s3tc")||n("MOZ_WEBGL_compressed_texture_s3tc")};a.MI=function(){return n("WEBKIT_WEBGL_compressed_texture_pvrtc")||n("WEBGL_compressed_texture_pvrtc")};a.UU=function(){return r.ec?e("WEBGL_depth_texture"):n("WEBGL_depth_texture")||n("WEBKIT_WEBGL_depth_texture")||
n("MOZ_WEBGL_depth_texture")};a.kI=function(){return n("EXT_texture_filter_anisotropic")||n("WEBKIT_EXT_texture_filter_anisotropic")||n("MOZ_EXT_texture_filter_anisotropic")};a.TU=function(){return n("WEBGL_debug_shaders")};a.ev=function(){return n("WEBGL_debug_renderer_info")};a.uI=function(){return r.ec?e("OES_element_index_uint"):n("OES_element_index_uint")};a.nB=function(){return r.ec?e("OES_standard_derivatives"):n("OES_standard_derivatives")};a.fB=function(){var a=r.ec?e("EXT_disjoint_timer_query"):
n("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},fI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},gI:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},eI:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return A.createQuery()},beginQuery:function(b){A.beginQuery(a.TIME_ELAPSED_EXT,
b)},endQuery:function(){A.endQuery(a.TIME_ELAPSED_EXT)},fI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT_AVAILABLE)},gI:function(a){return A.getQueryParameter(a,A.QUERY_RESULT)},eI:function(){return a.GPU_DISJOINT_EXT}}};a.jV=function(){if(r.ec)return e("ANGLE_instanced_arrays");var a=n("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,e,f,h,c){a.drawElementsInstancedANGLE(b,e,f,h,c)},vertexAttribDivisor:function(b,e){a.vertexAttribDivisorANGLE(b,e)},drawArraysInstanced:function(b,
e,f,h){a.drawArraysInstancedANGLE(b,e,f,h)}}};a.oB=function(){if(r.ec)return e("OES_vertex_array_object");var a=n("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.ua=function(){h={}};a.reset=function(){A=null}};b4w.module.__graph=function(a,l){function n(a,b,c){c||(c=null);e(a,b)?P.q("Graph already has node with given ID"):a.M.push(b,c)}function e(a,b){for(var c=a.M,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,c,d){d||(d=null);e(a,b)&&e(a,c)?a.Pa.push(b,c,d):P.q("Wrong node IDs")}function y(a,b){e(a,b)||P.q("Node not found");for(var c=a.M,d=0;d<c.length;d+=2)c[d]==b&&(c.splice(d,2),d-=2)}function r(a,b,c,d){p(a,b,c)||P.q("Edge not found");a=a.Pa;for(var g=0,e=0;e<a.length;e+=3)if(a[e]==
b&&a[e+1]==c){if(-1==d)a.splice(e,3);else{if(d==g){a.splice(e,3);break}g++}e-=3}}function A(a){a=a.M;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function h(a,b){for(var c=a.M,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function w(a){var b=[],c={};m(a,c);for(var d=a.M,g=0;g<d.length;g+=2)0==H(a,d[g])&&k(a,d[g],c,b);return{M:b,Pa:a.Pa.slice(0)}}function m(a,b){for(var c=a.M,d=0;d<c.length;d+=2)b[c[d]]=!1}function k(a,b,c,d){if(!c[b]){c[b]=!0;for(var g=0;g<L(a,b);g++)k(a,
z(a,b,g),c,d);d.unshift(b,Q(a,b))}}function f(a,b,c,g){if(!c[b]){c[b]=!0;if(10==g||30==g)for(var e=0;e<L(a,b);e++){var k=z(a,b,e);f(a,k,c,g)}if(20==g||30==g)for(e=0;e<H(a,b);e++)k=d(a,b,e),f(a,k,c,g)}}function v(a){for(var b=a.Pa,c=0;c<b.length;c+=3){var d=b[c+1];e(a,b[c])&&e(a,d)||(b.splice(c,3),c-=3)}}function c(a){for(var b=[],c=a.M,d=0;d<c.length;d+=2){var g=c[d];L(a,g)||b.push(g)}return b}function C(a){var b=a.M;a=a.Pa;for(var c=[],d=[],g=[],e=0;e<b.length;e++)g[b[2*e]]=e,c.push(e,b[2*e+1]);
for(e=0;e<a.length;e+=3)d.push(g[a[e]],g[a[e+1]],a[e+2]);return{M:c,Pa:d}}function O(a,b,c){if(c.Jh==c.mk){for(var g=0,e=0;g<c.mk;g++)-1!=c.Hi[g]&&(a[e]=g,b[e]=c.Hi[g],e++);return!0}if(c.mk>c.oo||c.Pk>c.Qk||c.Zo>c.ap||c.Yo>c.$o)return!1;for(var e=g=-1,f=!1;!f&&J(c,t,g,e);)if(g=t[0],e=t[1],K(c,g,e)){var u;u=c;f={};f.mr=u.mr;f.nr=u.nr;f.oC=u.oC;f.Lu=u.Lu;f.mk=u.mk;f.oo=u.oo;f.qk=u.qk;f.Jh=f.nw=u.Jh;f.Yo=u.Yo;f.Zo=u.Zo;f.Pk=u.Pk;f.$o=u.$o;f.ap=u.ap;f.Qk=u.Qk;f.Up=-1;f.Hi=u.Hi;f.Gl=u.Gl;f.mm=u.mm;f.nm=
u.nm;f.Fm=u.Fm;f.Gm=u.Gm;f.$w=u.$w;u.$w[0]+=1;var f=u=f,k=g,p=e,h=f.mr,m=f.nr,n=f.mk,q=f.oo,T=f.Hi,l=f.Gl,S=f.mm,v=f.nm,r=f.Fm,x=f.Gm;D(k<n);D(p<q);D(f.Jh<n);D(f.Jh<q);n=++f.Jh;f.Up=k;S[k]||(S[k]=n,f.Yo++,r[k]&&f.Pk++);r[k]||(r[k]=n,f.Zo++,S[k]&&f.Pk++);v[p]||(v[p]=n,f.$o++,x[p]&&f.Qk++);x[p]||(x[p]=n,f.ap++,v[p]&&f.Qk++);T[k]=p;l[p]=k;for(T=0;T<H(h,k);T++)l=d(h,k,T),S[l]||(S[l]=n,f.Yo++,r[l]&&f.Pk++);for(T=0;T<L(h,k);T++)l=z(h,k,T),r[l]||(r[l]=n,f.Zo++,S[l]&&f.Pk++);for(T=0;T<H(m,p);T++)l=d(m,p,
T),v[l]||(v[l]=n,f.$o++,x[l]&&f.Qk++);for(T=0;T<L(m,p);T++)l=z(m,p,T),x[l]||(x[l]=n,f.ap++,v[l]&&f.Qk++);f=O(a,b,u);D(1>=u.Jh-u.nw);D(-1!=u.Up);l=u.mr;k=u.nr;p=u.Jh;h=u.Up;m=u.Hi;S=u.Gl;n=u.mm;v=u.nm;q=u.Fm;r=u.Gm;if(u.nw<p){n[h]==p&&(n[h]=0);for(x=0;x<H(l,h);x++)T=d(l,h,x),n[T]==p&&(n[T]=0);q[h]==p&&(q[h]=0);for(x=0;x<L(l,h);x++)T=z(l,h,x),q[T]==p&&(q[T]=0);l=m[h];v[l]==p&&(v[l]=0);for(x=0;x<H(k,l);x++)T=d(k,l,x),v[T]==p&&(v[T]=0);r[l]==p&&(r[l]=0);for(x=0;x<L(k,l);x++)T=z(k,l,x),r[T]==p&&(r[T]=
0);m[h]=-1;S[l]=-1;u.Jh=u.nw;u.Up=-1}}return f}function J(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var g=a.Pk,e=a.Qk,f=a.Zo,k=a.ap,p=a.Yo,h=a.$o,m=a.Jh,t=a.mk,q=a.oo,n=a.Hi,l=a.Gl,S=a.mm,v=a.nm,r=a.Fm,x=a.Gm;if(g>m&&e>m)for(;c<t&&(-1!=n[c]||0==r[c]||0==S[c]);)c++,d=0;else if(f>m&&k>m)for(;c<t&&(-1!=n[c]||0==r[c]);)c++,d=0;else if(p>m&&h>m)for(;c<t&&(-1!=n[c]||0==S[c]);)c++,d=0;else if(0==c&&0!=a.qk){for(S=0;S<t&&-1!=n[c=a.qk[S]];)S++;S==t&&(c=t)}else for(;c<t&&-1!=n[c];)c++,d=0;if(g>m&&e>m)for(;d<q&&(-1!=
l[d]||0==x[d]||0==v[d]);)d++;else if(f>m&&k>m)for(;d<q&&(-1!=l[d]||0==x[d]);)d++;else if(p>m&&h>m)for(;d<q&&(-1!=l[d]||0==v[d]);)d++;else for(;d<q&&-1!=l[d];)d++;return c<t&&d<q?(b[0]=c,b[1]=d,!0):!1}function K(a,b,c){var g=a.mr,e=a.nr,f=a.oo,u=a.Hi,k=a.Gl,h=a.mm,m=a.nm,t=a.Fm,n=a.Gm;D(b<a.mk);D(c<f);D(-1==u[b]);D(-1==k[c]);if(!(0,a.oC)(Q(g,b),Q(e,c)))return!1;for(var q=f=0,T=0,l=0,S=0,v=0,r=0;r<L(g,b);r++){var x=z(g,b,r);if(-1!=u[x]){var P=u[x];if(!p(e,c,P)||!M(a.Lu,g,b,x,e,c,P))return!1}else h[x]&&
T++,t[x]&&f++,h[x]||t[x]||S++}for(r=0;r<H(g,b);r++)if(x=d(g,b,r),-1!=u[x]){if(P=u[x],!p(e,P,c)||!M(a.Lu,g,x,b,e,P,c))return!1}else h[x]&&T++,t[x]&&f++,h[x]||t[x]||S++;for(r=0;r<L(e,c);r++)if(P=z(e,c,r),-1!=k[P]){if(x=k[P],!p(g,b,x))return!1}else m[P]&&l++,n[P]&&q++,m[P]||n[P]||v++;for(r=0;r<H(e,c);r++)if(P=d(e,c,r),-1!=k[P]){if(x=k[P],!p(g,x,b))return!1}else m[P]&&l++,n[P]&&q++,m[P]||n[P]||v++;return T<=l&&f<=q&&S<=v}function D(a){a||P.q("Assertion failed")}function Q(a,b){for(var c=a.M,d=0;d<c.length;d+=
2)if(c[d]==b)return c[d+1];return null}function L(a,b){for(var c=a.Pa,d=0,g=0;g<c.length;g+=3)c[g]==b&&d++;return d}function H(a,b){for(var c=a.Pa,d=0,g=0;g<c.length;g+=3)c[g+1]==b&&d++;return d}function z(a,b,c){a=a.Pa;for(var d=0,g=0;g<a.length;g+=3)if(a[g]==b){if(d==c)return a[g+1];d++}return-1}function d(a,b,c){a=a.Pa;for(var d=0,g=0;g<a.length;g+=3)if(a[g+1]==b){if(d==c)return a[g];d++}return-1}function p(a,b,c){a=a.Pa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function M(a,
b,c,d,e,f,k){for(var p=x(b,c,d),h=x(e,f,k),m=0;m<p;m++){for(var t=!1,n=0;n<h;n++)if(a(g(b,c,d,m),g(e,f,k,n))){t=!0;break}if(!t)return!1}return!0}function x(a,b,c){var d=0;a=a.Pa;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&d++;return d}function g(a,b,c,d){a=a.Pa;for(var g=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(g==d)return a[e+2];g++}return null}l("__print");var P=l("__util"),t=[-1,-1];a.az=-1;a.B0=10;a.lt=20;a.P1=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var g=
a[d];switch(g.length){case 2:b.push(g[0],g[1]);break;case 3:c.push(g[0],g[1],g[2]);break;default:P.q("Wrong graph constructor params")}}return{M:b,Pa:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.M.length),g=0;g<a.M.length;g+=2)d[g]=a.M[g],d[g+1]=b(a.M[g+1]);else d=P.S(a.M);if(c)for(b=Array(a.Pa.length),g=0;g<a.Pa.length;g+=3)b[g]=a.Pa[g],b[g+1]=a.Pa[g+1],b[g+2]=c(a.Pa[g+2]);else b=P.S(a.Pa);return a={M:d,Pa:b}};a.r3=function(a,b){for(var c=[],d=[],g=0;g<a.length;g++)c.push(a[g][0],a[g][1]);
for(g=0;g<b.length;g++)d.push(b[g][0],b[g][1],b[g][2]);return{M:c,Pa:d}};a.Fj=n;a.m6=e;a.ed=b;a.ug=y;a.Ak=r;a.Ao=function(a,b,c,d){p(a,b,c)||P.q("Edge not found");a=a.Pa;for(var g=0;g<a.length;g+=3)if(a[g]==b&&a[g+1]==c&&a[g+2][0]==d[0]&&a[g+2][1]==d[1]){a.splice(g,3);break}};a.J=function(a,b){if(-1==h(a,b)){var c=A(a);n(a,c,b);return c}P.q("Non-unique attribute")};a.PX=function(a,b,c,d,g){a=a.Pa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==d&&(a[e+2]=g)};a.CQ=function(a,c,d){var g;d=d||
[];g=g||[];for(var e={},f=0;f<a.M.length;f+=2){var k=a.M[f],p=a.M[f+1],h=A(c);n(c,h,p);e[k]=h}for(f=0;f<a.Pa.length;f+=3)p=e[a.Pa[f]],h=e[a.Pa[f+1]],k=a.Pa[f+2],b(c,p,h,k);for(f=0;f<d.length;f+=3)p=e[d[f]],a=d[f+1],k=d[f+2],b(c,p,a,k);for(f=0;f<g.length;f+=3)d=g[f],h=e[g[f+1]],k=g[f+2],b(c,d,h,k)};a.am=A;a.gh=h;a.r=function(a,c,d,g){c=h(a,c);d=h(a,d);-1!=c&&-1!=d?b(a,c,d,g):P.q("Attributes not found")};a.pa=function(a,b){for(var c=a.M,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.xg=function(a,b){for(var c=
a.Pa,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.ni=function(a,b,c){for(var d=a.Pa,g=0;g<d.length;g+=3)if(d[g+1]==b){var e=d[g];if(c(e,Q(a,e),d[g+2]))break}};a.Sk=function(a,b,c){for(var d=a.Pa,g=0;g<d.length;g+=3)if(d[g]==b){var e=d[g+1];if(c(e,Q(a,e),d[g+2]))break}};a.UD=w;a.IZ=function(a){a=w(a).M;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.G6=function(){};a.nx=function(a,b,c){e(a,b)||P.q("No such node");var d={};m(a,d);f(a,b,d,c);b=[];for(var g in d)d[g]&&(g=Number(g),b.push(g,
Q(a,g)));a={M:b,Pa:a.Pa.slice(0)};v(a);return a};a.Tz=v;a.oV=function(a){for(var b=[],c=a.M,d=0;d<c.length;d+=2){var g=c[d];H(a,g)||b.push(g)}return b};a.sr=c;a.match=function(a,b,c,d){var g={};g.mr=C(a);g.nr=C(b);g.oC=c||function(a,b){return a==b};g.Lu=d||function(a,b){return a==b};d=a.M.length/2;var e=b.M.length/2;g.mk=d;g.oo=e;g.qk=0;g.Jh=g.nw=0;g.Pk=g.Yo=g.Zo=0;g.Qk=g.$o=g.ap=0;g.Up=-1;g.Hi=Array(d);g.Gl=Array(e);g.mm=Array(d);g.nm=Array(e);g.Fm=Array(d);g.Gm=Array(e);g.$w=[1];for(c=0;c<d;c++)g.Hi[c]=
-1,g.mm[c]=0,g.Fm[c]=0;for(c=0;c<e;c++)g.Gl[c]=-1,g.nm[c]=0,g.Gm[c]=0;e=Array(d);d=Array(d);if(O(e,d,g)){for(c=0;c<e.length;c++)e[c]=a.M[2*e[c]],d[c]=b.M[2*d[c]];return[e,d]}return null};a.kV=function(a,b){for(var c=a.M,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Wa=Q;a.rg=L;a.$n=H;a.Wg=z;a.Si=d;a.I4=x;a.Wd=g;a.replace=function(a,b,c){for(var d=a.Pa,g=A(a),e=0;e<b.length;e++){var f=b[e];y(a,f);for(var k=0;k<d.length;k+=3)d[k]==f&&(d[k]=g),d[k+1]==f&&(d[k+1]=g),d[k]==d[k+1]&&(d.splice(k,
3),k-=3)}n(a,g,c)};a.FX=function(a,b,c,d,g){p(a,b,c)||P.q("Edge not found");a=a.Pa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=d,a[e+1]=g)};a.TT=function(a,b){function d(a,b){if(-1!=p.indexOf(a)){var c=p.slice(p.indexOf(a));if(-1!=e[c[c.length-1]].indexOf(c[0])){h.push([a,c[c.length-1]]);return}}p.push(a);for(c=0;c<b.length;c++)b[c]in e&&d(b[c],e[b[c]])}b||(b=c(a)[0]);var g=a.Pa;if(g.length&&-1!=g.indexOf(b)){for(var e={},f=0,k=0;k<g.length;k+=3)g[k+1]in e?e[g[k+1]].push(g[k]):e[g[k+1]]=
[g[k]],f++;var p=[],h=[];d(b,e[b]);for(k=0;k<h.length;k++)for(var m=f=0;m<g.length;m+=3)h[k][1]==g[m+1]&&h[k][0]==g[m]&&r(a,g[m],g[m+1],f),f++}};a.vT=function(a,b,c){var d=a.M;a=a.Pa;var g;g="digraph debug {\n    node [shape=box];\n";for(var e=0;e<d.length;e+=2){var f=d[e],k=d[e+1],k=b?b(f,k):String(f);g+="    ";g+=String(f)+' [label="'+k.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<a.length;e+=3)b=a[e],d=a[e+1],k=a[e+2],g+="    ",g+=String(b)+" -> "+String(d),c&&(g+=' [label="'+c(b,d,k)+'"]'),g+=";\n";
return g+="}"}};b4w.module.__nodemat=function(a,l){function n(a,b,d,g,f){var q=Pa.A(),q=h(b,f,q.uuid);if(q in va)return va[q];var u={Xa:null,id:q,NG:!0};d||(Ga={},Ra=0);if("SHADOW"!=f&&"COLOR_ID"!=f){b=B.create();for(var p=a.nodes,t=0;t<p.length;t++)if(null==da(b,p[t],0,g,f))return va[q]=null,u;if(d&&-1==P(a,b,"GROUP_OUTPUT","group"))return u;t=Y(b);p=d?a.links:a.links.slice();if(!na(b,p,t))return u;if(d)return u.Xa=b,u;for(t=0;t<p.length;t++){d=p[t];for(var E=C(d.from_node,b),S=C(d.to_node,b),T=0;T<E.length;T++)for(var l=
0;l<S.length;l++){var I=E[T],ca=S[l],x=B.Wa(b,I),F=B.Wa(b,ca);if(!sa(b,I,ca,x,F,d))return va[q]=null,u}}c(b);"GLOW"==f?t=P(a,b,"B4W_GLOW_OUTPUT","material",!0):(t=P(a,b,"OUTPUT","material",!1,!0),-1==t&&(t=P(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==t&&(b=m(),t=0);O(b);a=B.nx(b,t,B.lt);e(a,g);r(a,g);k(a);K(a);M(a);v(a,g,f);ma(a)}else g=n(a,b,d,g,"MAIN"),g=B.clone(g.Xa,function(a){var b=Ea.zq(a);b.L=Ea.S(a.L);b.gb=Ea.S(a.gb);return b}),t=P(a,g,"OUTPUT","material",!1,!0),-1==t&&(t=P(a,g,"OUTPUT_MATERIAL",
"material",!1,!0)),w(g,t),a=B.nx(g,t,B.lt),k(a);u.Xa=a;return va[q]=u}function e(a,c){var d=[];B.pa(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({Xr:a,node:b})});for(var g=0;g<d.length;++g){var e=d[g].Xr,f=d[g].node,q=B.am(a);B.Fj(a,q,f.data.NW);var k=B.am(a);B.Fj(a,k,f.data.OW);B.ed(a,q,k,[4,2]);for(var u={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},p=B.$n(a,e),h=[],m=[],t=[],E={},n=0;n<p;n++){var S=B.Si(a,e,
n);S in E||(E[S]=0);var T=B.Wd(a,S,e,E[S]++);h.push([S,e,T]);var l=u[T[1]];if(l)switch(l[0]){case "MATERIAL_END":m.push([S,k,[T[0],l[1]]]);break;case "LIGHTING_APPLY":t.push([S,[T[0],l[1]]])}else m.push([S,q,T])}b(a,f.data.value,q,k,t,c);for(n=0;n<h.length;n++)B.Ao(a,h[n][0],h[n][1],h[n][2]);for(n=0;n<m.length;n++)B.ed(a,m[n][0],m[n][1],m[n][2]);f=B.rg(a,e);q=[];u=[];p={};for(n=0;n<f;n++)h=B.Wg(a,e,n),h in p||(p[h]=0),T=B.Wd(a,e,h,p[h]++),q.push([e,h,T]),u.push([k,h,T]);for(n=0;n<q.length;n++)B.Ao(a,
q[n][0],q[n][1],q[n][2]);for(n=0;n<u.length;n++)B.ed(a,u[n][0],u[n][1],u[n][2]);B.ug(a,e)}}function b(a,b,c,d,g,e){var f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},q=da(a,f,0,e,null),k=q;y(a,c,q,"E");y(a,c,q,"A");y(a,c,q,"D");q=Pa.A();q=ja.Ub(q,"LAMP",ja.oc);if(!b.Ke)for(var u,p,h,m=0;m<q.length;m++){h=q[m].ub;f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};u=da(a,f,0,e,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};p=da(a,f,0,e,null);y(a,k,p,"color");y(a,k,p,"specular");y(a,u,p,"ldir");
y(a,c,p,"normal");y(a,c,p,"D");y(a,c,p,"S");y(a,u,p,"lcolorint");y(a,c,u,"shadow_factor");k="SPECULAR_"+b.Js;f={name:k,type:k,use_tangent_shading:b.dn};k=da(a,f,0,e,null);y(a,u,k,"ldir");y(a,u,k,"lfac");y(a,c,k,"normal");y(a,k,p,"sfactor");y(a,u,k,"norm_fac");y(a,c,k,"sp_params");k="HEMI"==h.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Vq;f={name:k,type:k,use_tangent_shading:b.dn};h=da(a,f,0,e,null);y(a,u,h,"ldir");y(a,u,h,"lfac");y(a,c,h,"normal");y(a,u,h,"norm_fac");y(a,h,p,"lfactor");"DIFFUSE_LAMBERT"!=
k&&y(a,c,h,"dif_params");for(u=0;u<g.length;u++)B.ed(a,g[u][0],p,g[u][1]);k=p}y(a,k,d,"color");y(a,k,d,"specular")}function y(a,b,c,d){for(var g=B.Wa(a,b),e=B.Wa(a,c),f,q=0;q<e.L.length;q++)if(d==e.L[q].identifier){f=q;break}if(void 0!==f){for(var k,q=0;q<g.gb.length;q++)if(d==g.gb[q].identifier){k=q;break}void 0!==k&&B.ed(a,b,c,[k,f])}}function r(a,b){var c=[];B.pa(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({Xr:a,node:b})});for(var d=0;d<c.length;++d){var g=c[d].Xr,e=c[d].node,f=B.am(a);B.Fj(a,
f,e.data.jR);var q=B.am(a);B.Fj(a,q,e.data.kR);B.ed(a,f,q,[4,2]);for(var k=B.$n(a,g),u=[],p=[],h={},m=0;m<k;m++){var t=B.Si(a,g,m),E=B.Wa(a,t);t in h||(h[t]=0);var n=B.Wd(a,t,g,h[t]++);u.push([t,g,n]);p.push([t,f,n]);if("BSDF_GLOSSY"==E.type||"BSDF_DIFFUSE"==E.type||"MIX_SHADER"==E.type||"EMISSION"==E.type){p.push([t,f,[1,1]]);p.push([t,f,[2,2]]);p.push([t,f,[3,3]]);p.push([t,f,[4,4]]);p.push([t,f,[5,5]]);p.push([t,f,[6,6]]);p.push([t,f,[7,7]]);p.push([t,f,[8,8]]);var S=[];B.pa(a,function(a,b){"MIX_SHADER"==
b.type&&S.push({Xr:a,node:b})});for(n=0;n<S.length;++n)for(var t=S[n].Xr,E=B.$n(a,t),T=0;T<E;T++){var l=B.Si(a,t,T),I=B.Wa(a,l),r=B.Wd(a,l,t,0);0==r[1]||"BSDF_GLOSSY"!=I.type&&"BSDF_DIFFUSE"!=I.type&&"MIX_SHADER"!=I.type&&"EMISSION"!=I.type||(I=1==r[1]?3:11,p.push([l,t,[1,I]]),p.push([l,t,[2,I+1]]),p.push([l,t,[3,I+2]]),p.push([l,t,[4,I+3]]),p.push([l,t,[5,I+4]]),p.push([l,t,[6,I+5]]),p.push([l,t,[7,I+6]]),p.push([l,t,[8,I+7]]))}}}A(a,e.data.value,f,q,b);for(m=0;m<u.length;m++)B.Ao(a,u[m][0],u[m][1],
u[m][2]);for(m=0;m<p.length;m++)B.ed(a,p[m][0],p[m][1],p[m][2]);e=B.rg(a,g);f=[];k=[];u={};for(m=0;m<e;m++)p=B.Wg(a,g,m),p in u||(u[p]=0),n=B.Wd(a,g,p,u[p]++),f.push([g,p,n]),k.push([q,p,n]);for(m=0;m<f.length;m++)B.Ao(a,f[m][0],f[m][1],f[m][2]);for(m=0;m<k.length;m++)B.ed(a,k[m][0],k[m][1],k[m][2]);B.ug(a,g)}}function A(a,b,c,d,g){var e=[],f={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},q=da(a,f,0,g,null),k=q;y(a,c,q,"E");y(a,c,q,"A");y(a,c,q,"D");for(var q=Pa.A(),q=ja.Ub(q,"LAMP",ja.oc),u,p,
h=0;h<q.length;h++){f={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};u=da(a,f,0,g,null);f={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};p=da(a,f,0,g,null);y(a,k,p,"color");y(a,k,p,"specular");y(a,u,p,"ldir");y(a,c,p,"normal");y(a,c,p,"D");y(a,c,p,"S");y(a,u,p,"lcolorint");y(a,c,u,"shadow_factor");k=b.lR;f={name:k,type:k};k=da(a,f,0,g,null);y(a,u,k,"ldir");y(a,u,k,"lfac");y(a,c,k,"normal");y(a,u,k,"norm_fac");y(a,c,k,"bsdf_params");y(a,k,p,"lfactor");y(a,k,p,"sfactor");for(k=0;k<e.length;k++)B.ed(a,e[k][0],
p,e[k][1]);k=p}y(a,c,d,"s_color");y(a,c,d,"metalness");y(a,c,d,"e_color");y(a,c,d,"emission");y(a,k,d,"color");y(a,k,d,"specular")}function h(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function w(a,b){B.xg(a,function(c,d,g){var e=B.Wa(a,d);d==b&&"Color"==e.L[g[1]].identifier&&B.Ao(a,c,d,g)})}function m(){var a=B.create(),b={data:null,Rb:[],rb:[],L:[{Ea:new Float32Array([0,0,0]),identifier:"Color",eb:!1,name:"Color"},{Ea:1,identifier:"Alpha",
eb:!1,name:"Alpha"}],gb:[],type:"OUTPUT",qi:[]};B.Fj(a,0,b);return a}function k(a){B.pa(a,function(b,c){for(var d=c.L,g=c.gb,e=0;e<d.length;e++)f(a,d[e],b,e,1);for(e=0;e<g.length;e++)f(a,g[e],b,e,0)})}function f(a,b,c,d,g){if(b.eb){var e=!0;B.xg(a,function(a,b,f){if(!g&&a==c&&f[0]==d||g&&b==c&&f[1]==d)e=!1});e&&(b.eb=!1)}}function v(a,b,c){var d=[];B.xg(a,function(g,e,f){var q=B.Wa(a,g),k=B.Wa(a,e),q=Ea.jk(q.gb[f[0]].Ea),k=Ea.jk(k.L[f[1]].Ea);if(q!=k){var u,p={default_value:[0,0,0],identifier:"Vector",
is_linked:!0,name:"Vector"},h={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};q&&!k?u=t("vector_to_scalar","B4W_VECTOSCAL",[p],[h]):!q&&k&&(u=t("scalar_to_vector","B4W_SCALTOVEC",[h],[p]));da(a,u,0,b,c);d.push([g,e,a.M[a.M.length-2],f])}});for(var g=0;g<d.length;++g)B.Ao(a,d[g][0],d[g][1],d[g][3]),B.ed(a,d[g][0],d[g][2],[d[g][3][0],0]),B.ed(a,d[g][2],d[g][1],[0,d[g][3][1]])}function c(a){var b=[];B.pa(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":B.xg(a,function(g,e,f){var q=
B.Wa(a,e);g==c&&"MATERIAL_EXT"==q.type&&"Translucency"==d.gb[f[0]].name&&b.push(g,e,[f[0]+1,f[1]+1])})}});for(var c=0;c<b.length;c+=3)B.ed(a,b[c],b[c+1],b[c+2])}function C(a,b){var c=[];B.pa(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;Ea.q("Node not found")}function O(a){var b=[];B.pa(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],g=b[c+1];if("B4W_PARALLAX"==g.type)J(a,d,g);else if("REROUTE"==g.type){for(var e=
B.Si(a,d,0),f=B.rg(a,d),q=[],k=[],u=[],p=0;p<f;p++){var h=B.Wg(a,d,p),m=k.indexOf(h),t=0<=m?u[t]:0,E=B.Wd(a,d,h,t);if(E){var E=E[1],n=g.L[0].Ea,E=B.Wa(a,h).L[E];switch(typeof n){case "number":if("object"==typeof E.Ea)for(var S=E.Ea,E=0;E<S.length;E++)S[E]=n;else"number"==typeof E.Ea&&(E.Ea=n);break;case "object":if("object"==typeof E.Ea)for(S=E.Ea,E=0;E<S.length;E++)S[E]=n[E];else"number"==typeof E.Ea&&(E.Ea=.35*n[0]+.45*n[1]+.2*n[2])}}n=g.gb;for(E=0;E<n.length;E++)n[E].Ea=g.L[0].Ea;-1!=m?u[m]+=1:
(k.push(h),u.push(1),q.push(d,h))}if(-1!=e)for(g=B.Wd(a,e,d,0)[0],p=0;p<k.length;p++)for(E=0;E<u[p];E++)f=B.Wd(a,d,k[p],E)[1],B.ed(a,e,k[p],[g,f]);for(p=0;p<q.length;p+=2)B.Ak(a,q[p],q[p+1],-1)}}}function J(a,b,c){var d;a:{d=a.Pa;for(var g=0;g<d.length;g+=3)if(d[g+1]==b&&1==d[g+2][1]){d=d[g];break a}d=-1}-1!=d&&(g=B.Wa(a,d),c.data=g.data,B.Ak(a,d,b,-1),0==B.rg(a,d)&&(b=B.Si(a,d,0),-1!=b&&B.Ak(a,b,d,-1),B.ug(a,d)));c.L.splice(1,1)}function K(a){Q(a);z(a);D(a)}function D(a){var b=[],c="",d="",g={};
B.pa(a,function(a,e){if("GEOMETRY_UV"==e.type||"UVMAP"==e.type||"TEX_COORD_UV"==e.type){b.push(a,e);var f=e.data.value;c?c==f||d||(d=f,g[d]=0):(c=f,g[c]=0);g[f]++}});for(var e in g)if(2>g[e]){for(var f=0;f<b.length;f+=2)b[f+1].data.value==e&&b.splice(f,2);delete g[e];c==e&&(c=d,d="");d==e&&(d="")}if(!(3>b.length)){var f={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},q={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};e=t("merged_uv","UV_MERGED",
[],[f,q]);e.uv_layer=c;da(a,e,0,"",void 0);var k=a.M[a.M.length-2];e=a.M[a.M.length-1];if(d){q=t("merged_uv","UV_MERGED",[],[f,q]);q.uv_layer=d;da(a,q,0,"",void 0);var u=a.M[a.M.length-2],q=a.M[a.M.length-1]}else q=null;for(var h=-1,m=null,f=0;f<b.length;f+=2){var E=b[f],n=b[f+1];p(n,b[1])?(h=k,m=e):q&&(h=u,m=q);for(var S=[],l=B.rg(a,E),T={},I=0;I<l;I++){var r=B.Wg(a,E,I);r in T||(T[r]=0);var v=B.Wd(a,E,r,T[r]++);S.push(E,r,v);v=v.splice(0,v.length);switch(n.type){case "GEOMETRY_UV":v[0]=0;m.gb[0].eb=
!0;break;case "UVMAP":case "TEX_COORD_UV":v[0]=1,m.gb[1].eb=!0}B.ed(a,h,r,v)}for(var I=0;I<S.length;I+=3)B.Ak(a,S[I],S[I+1],0);B.ug(a,E)}}}function Q(a){var b=[];B.pa(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],g=0;g<b.length;g+=2){for(var e=b[g],f=b[g+1],q=!0,k=0;k<c.length;k++){var u=c[k];if(d(f,
u.Af)){q=[];k=B.rg(a,e);for(m=0;m<k;m++){var p=B.Wg(a,e,m),h=B.Wd(a,e,p,0);q.push(e,p,h);B.ed(a,u.id,p,h)}for(var m=0;m<q.length;m+=3)B.Ak(a,q[m],q[m+1],0);B.ug(a,e);q=!1;break}}q&&(u={id:e,Af:f},c.push(u))}}function L(a){for(var b={},c=0;c<a.M.length;c+=2){var d=a.M[c];b[d]={bq:{},EJ:!1}}for(c=0;c<a.Pa.length;c+=3)b[a.Pa[c+1]].bq[a.Pa[c]]=!0;for(d in b)H(d,b);for(d in b)b[d]=Object.keys(b[d].bq).map(function(a){return parseInt(a)});return b}function H(a,b){var c=b[a];if(!c.EJ){var d=Ea.S(c),g;for(g in c.bq){H(g,
b);var c=b[g],e;for(e in c.bq)d.bq[e]=!0}d.EJ=!0;b[a]=d}}function z(a){var b=[];B.pa(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=L(a),g=[],e=0;e<b.length;e+=2){for(var f=b[e],q=b[e+1],k=!0,u=0;u<g.length;u++){var p=g[u];if(!(3<=p.mo.length||!d(q,p.Af)||-1<c[f].indexOf(p.id)||-1<c[p.id].indexOf(f))){for(var h=!1,m=0;m<p.mo.length;m++){var t=p.mo[m].id;if(-1<c[f].indexOf(t)||-1<c[t].indexOf(f)){h=!0;break}}if(!h){for(var u=[],t=B.$n(a,f),E=
{},m=0;m<t;m++)h=B.Si(a,f,m),h in E||(E[h]=0),k=B.Wd(a,h,f,E[h]++),u.push(h,f,k);for(var t=[],E=B.rg(a,f),n={},m=0;m<E;m++)h=B.Wg(a,f,m),h in n||(n[h]=0),k=B.Wd(a,f,h,n[h]++),t.push(f,h,k);k=u.concat(t);for(m=0;m<k.length;m+=3)B.Ak(a,k[m],k[m+1],0);B.ug(a,f);m={id:f,Af:q,KT:u,LT:t};p.mo.push(m);k=!1;break}}}k&&(p={id:f,Af:q,mo:[]},g.push(p))}for(e=0;e<g.length;e++){p=g[e];c=p.mo.length;for(u=0;u<c;u++){q=p.mo[u];m=q.Af;f=q.KT;q=q.LT;p.Af.L[u+1].eb=m.L[0].eb;p.Af.L[u+1].Ea=m.L[0].Ea;p.Af.gb[2*(u+1)].eb=
m.gb[0].eb;p.Af.gb[2*(u+1)].Ea=m.gb[0].Ea;p.Af.gb[2*(u+1)+1].eb=m.gb[1].eb;p.Af.gb[2*(u+1)+1].Ea=m.gb[1].Ea;for(m=0;m<f.length;m+=3)h=f[m],k=f[m+2],k[1]+=u+1,B.ed(a,h,p.id,k);for(m=0;m<q.length;m+=3)h=q[m+1],k=q[m+2],k[0]+=2*(u+1),B.ed(a,p.id,h,k);p.Af.Rb.push(["USE_uv"+(u+2),1])}B.ug(a,p.id);B.Fj(a,p.id,p.Af)}}}function d(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.Gz==b.data.value.Gz&&a.data.value.Zn==b.data.value.Zn;default:return!1}}function p(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function M(a){var b=[],c=[];B.pa(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});x(a,b);g(a,c)}function x(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],g=b[c+1],e=!1,f=[],q=[],k=[[],
[],[]],u=B.rg(a,d),p=0;p<u;p++){var h=B.Wg(a,d,p);if("SEPRGB"!=B.Wa(a,h).type){e=!1;break}f.push(d,h);for(var m={},t=B.rg(a,h),e=0;e<t;e++){var E=B.Wg(a,h,e);E in m||(m[E]=0);var n=B.Wd(a,h,E,m[E]++);f.push(h,E);k[n[0]].push(d,E,n)}q.push(h);e=!0}if(e){for(p=d=u=0;p<k.length;p++)k[p].length&&(u++,d|=1<<2-p);if(u){g.type+=u;g.gb=[];for(p=0;p<k.length;p++)if(k[p].length)for(g.gb.push({Ea:0,identifier:"RGB"[p],eb:!0,name:"RGB"[p]}),e=0;e<k[p].length;e+=3)k[p][e+2][0]=Ea.Co(d,p);for(p=0;p<f.length;p+=
2)B.Ak(a,f[p],f[p+1],0);for(p=0;p<q.length;p++)B.ug(a,q[p]);for(p=0;p<k.length;p++)for(e=0;e<k[p].length;e+=3)B.ed(a,k[p][e],k[p][e+1],k[p][e+2])}}}}function g(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],g=!0,e=[],f=B.rg(a,d),q=0;q<f;q++){var k=B.Wg(a,d,q);if("B4W_REFLECT"==B.Wa(a,k).type){var u=B.Wd(a,d,k,0),p=B.Wd(a,d,k,1);u&&1==u[1]||p&&1==p[1]?g=!1:e.push(d,k)}else g=!1}for(q=0;q<e.length;q+=2)f=a,u=e[q],k=e[q+1],p=B.Wa(f,k),p.type+="_WORLD",B.Ak(f,u,k,0),p.L.splice(0,1),u=B.Si(f,k,0),u!=
B.az&&(B.Wd(f,u,k,0)[1]=0);g&&B.ug(a,d)}}function P(a,b,c,d,g,e){a=a.nodes;for(var f=null,q=0;q<a.length;q++){var k=a[q];g?"GROUP"==k.type&&k.node_tree_name==c&&(f=k):k.type==c&&(f=k)}return f?C(f,b)[0]:(e||xa.error('No "'+c+'" node in node '+d),-1)}function t(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function da(a,b,c,d,g){var e=b.name,f=b.type,k=[],p=[],h=[],m=[],t=null,n=[];switch(f){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":p=
T(b);h=ba(b);xa.warn(f+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":p=T(b);h=ba(b);break;case "MIX_SHADER":p.push(E(b,"Fac"));var l=E(b,"Shader"),h=l.eb;p.push(l);(l=E(b,"Shader_001"))||(l=E(b,"Shader.001"));var I=l.eb;p.push(l);p.push(q("d_color1","d_color1",[0,0,0],h));p.push(q("d_roughness1","d_roughness1",0,h));p.push(q("s_color1","s_color1",[0,0,0],h));p.push(q("s_roughness1","s_roughness1",0,h));p.push(q("metalness1","metalness1",0,h));p.push(q("normal1","normal1",
[0,0,0],h));p.push(q("e_color1","e_color1",[0,0,0],h));p.push(q("emission1","emission1",0,h));p.push(q("d_color2","d_color2",[0,0,0],I));p.push(q("d_roughness2","d_roughness2",0,I));p.push(q("s_color2","s_color2",[0,0,0],I));p.push(q("s_roughness2","s_roughness2",0,I));p.push(q("metalness2","metalness2",0,I));p.push(q("normal2","normal2",[0,0,0],I));p.push(q("e_color2","e_color2",[0,0,0],I));p.push(q("emission2","emission2",0,I));h=aa(b,"Shader");l=h.eb;h=[h,q("d_color","d_color",[0,0,0],l),q("d_roughness",
"d_roughness",0,l),q("s_color","s_color",[0,0,0],l),q("s_roughness","s_roughness",0,l),q("metalness","metalness",0,l),q("normal","normal",[0,0,0],l),q("e_color","e_color",[0,0,0],l),q("emission","emission",0,l)];break;case "OBJECT_INFO":var p=T(b),h=[],l=aa(b,"Location"),I=aa(b,"Object Index"),r=aa(b,"Material Index"),v=aa(b,"Random");h.push(l);h.push(I);h.push(r);h.push(v);n.push(["USE_LOCATION_OUT",l.eb|0]);n.push(["USE_OBJ_IND_OUT",I.eb|0]);n.push(["USE_MAT_IND_OUT",r.eb|0]);n.push(["USE_RANDOM_OUT",
v.eb|0]);break;case "UVMAP":(l=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(t=R("param_"+f+"_a"),I=R("param_"+f+"_v"),k.push(S(t)),k.push(S(I)),m.push(S(I)),t={name:t,value:l});h=ba(b);break;case "UV_MERGED":t=R("param_UV_MERGED_a");I=R("param_UV_MERGED_v");k.push(S(t));k.push(S(I));h.push(aa(b,"UV_geom"));h.push(aa(b,"UV_cycles"));m.push(S(I));t={name:t,value:b.uv_layer};break;case "CAMERA":p=[];h=ba(b);break;case "COMBRGB":case "COMBHSV":p=T(b);h=ba(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==
f?(N(b,0,0)&&n.push(["READ_R",1]),N(b,1,0)&&n.push(["READ_G",1]),N(b,2,0)&&n.push(["READ_B",1]),N(b,3,0)&&n.push(["READ_A",1])):(N(b,0,-1)&&n.push(["READ_R",1]),N(b,1,-1)&&n.push(["READ_G",1]),N(b,2,-1)&&n.push(["READ_B",1]));p=T(b);h=ba(b);t={value:b};break;case "PARTICLE_INFO":p=T(b);h=ba(b);for(l=0;l<b.outputs.length;l++){I=b.outputs[l];r=I.identifier;v=S("v_param_PART_INFO_"+r.replace(" ",""));if(I.is_linked)switch(r){case "Size":n.push(["PART_INFO_SIZE",ka.N(1)]);break;case "Age":n.push(["PART_INFO_AGE",
ka.N(1)]);break;case "Lifetime":n.push(["PART_INFO_LT",ka.N(1)]);break;case "Location":n.push(["PART_INFO_LOC",ka.N(1)]);break;case "Index":var x=S("a_param_PART_INFO_"+I.identifier.replace(" ","")),t=x;n.push(["PART_INFO_IND",ka.N(1)]);break;case "Velocity":n.push(["PART_INFO_VEL",ka.N(1)]);break;case "Angular Velocity":n.push(["PART_INFO_A_VEL",ka.N(1)])}"Age"!=r&&"Lifetime"!=r&&"Size"!=r&&(k.push(v),m.push(v))}x&&k.push(x);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!Z(b))return!0;f=u(b,c);if(!f)return xa.error("Geometry output is not supported"),
null;switch(f){case "GEOMETRY_UV":(l=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(t=R("param_GEOMETRY_UV_a"),I=R("param_GEOMETRY_UV_v"),k.push(S(t)),k.push(S(I)),m.push(S(I)),t={name:t,value:l});h.push(aa(b,"UV"));break;case "GEOMETRY_VC":(l=b.color_layer)||(f="EMPTY_VC");"EMPTY_VC"!=f&&(t=R("param_GEOMETRY_VC_a"),I=R("param_GEOMETRY_VC_v"),k.push(S(t)),k.push(S(I)),m.push(S(I)),t={name:t,value:l});h.push(aa(b,"Vertex Color"));break;case "GEOMETRY_NO":h.push(aa(b,"Normal"));break;case "GEOMETRY_TRN":f=
"GEOMETRY_NO";h.push(aa(b,"True Normal"));xa.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":h.push(aa(b,"Front/Back"));break;case "GEOMETRY_VW":h.push(aa(b,"View"));break;case "GEOMETRY_GL":h.push(aa(b,"Global")||aa(b,"Position"));break;case "GEOMETRY_LO":h.push(aa(b,"Local"));break;case "GEOMETRY_OR":l=R("param_GEOMETRY_OR_v");k.push(S(l));h.push(aa(b,"Orco"));m.push(S(l));break;case "GEOMETRY_IN":h.push(aa(b,"Incoming"));break;case "GEOMETRY_BF":h.push(aa(b,
"Backfacing"))}break;case "TEX_COORD":if(!Z(b))return!0;f=ga(b,c);switch(f){case "TEX_COORD_UV":(l=b.uv_layer)||(f="EMPTY_UV");"EMPTY_UV"!=f&&(t=R("param_TEX_COORD_UV_a"),I=R("param_TEX_COORD_UV_v"),k.push(S(t)),k.push(S(I)),m.push(S(I)),t={name:t,value:b.uv_layer});h.push(aa(b,"UV"));break;case "TEX_COORD_NO":h.push(aa(b,"Normal"));break;case "TEX_COORD_GE":l=R("param_TEX_COORD_GE_v");k.push(S(l));h.push(aa(b,"Generated"));m.push(S(l));break;case "TEX_COORD_OB":h.push(aa(b,"Object"));break;case "TEX_COORD_CA":h.push(aa(b,
"Camera"));break;case "TEX_COORD_WI":h.push(aa(b,"Window"));break;case "TEX_COORD_RE":h.push(aa(b,"Reflection"))}break;case "GROUP":l=b.node_tree_name;switch(l){case "B4W_LINEAR_TO_SRGB":if(!G(b,[1],[1])){t=F(b,d,g);break}f="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!G(b,[1],[1])){t=F(b,d,g);break}f="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!G(b,[1],[1])){t=F(b,d,g);break}f="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!G(b,[1,1],[1])){t=F(b,d,g);break}f=
"B4W_REFLECT";break;case "B4W_REFRACTION":if(!G(b,[1,0],[1])){t=F(b,d,g);break}f="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!G(b,[1,1,0,0,0],[1])){t=F(b,d,g);break}I=R("param_B4W_PARALLAX_texture");m.push(S(I));f="B4W_PARALLAX";break;case "B4W_CLAMP":if(!G(b,[1],[1])){t=F(b,d,g);break}f="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!G(b,[0,0,0,0,0],[0])){t=F(b,d,g);break}f="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!G(b,[],[0])){t=F(b,d,g);break}f="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!G(b,
[0,0,0],[0])){t=F(b,d,g);break}f="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":f="B4W_GLOW_OUTPUT";break;default:t=F(b,d,g)}p=T(b);h=ba(b);"B4W_TRANSLUCENCY"==l&&(l=q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),l.eb=h[0].eb,h.push(l));break;case "LAMP":t=b.lamp;if(!t)return xa.error("There is no lamp in node: "+b.name),null;h.push(aa(b,"Color"));h.push(aa(b,"Light Vector"));h.push(aa(b,"Distance"));h.push(aa(b,"Visibility Factor"));t.uuid in Ga?n.push(["LAMP_INDEX",String(Ga[t.uuid])]):(Ga[t.uuid]=
Ra,n.push(["LAMP_INDEX",String(Ra++)]));t=Ga;break;case "LIGHTING_AMBIENT":p=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0)];h=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":h=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("dif_params","dif_params",[0,0],!0),q("sp_params","sp_params",[0,0],!0),q("shadow_factor","shadow_factor",0,!0),q("translucency_color",
"translucency_color",0,!0),q("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":p=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":p=[q("shadow_factor","shadow_factor",0,!0)];h=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("lcolorint","lcolorint",[0,0,0],!0),q("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":p=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac",
"norm_fac",0,!0)];h=[q("lfactor","lfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":p=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("dif_params","dif_params",[0,0],!0)];h=[q("lfactor","lfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":p=
[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("sp_params","sp_params",[0,0],!0)];h=[q("sfactor","sfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":p=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("sp_params","sp_params",[0,0],!0)];h=[q("sfactor","sfactor",0,!0)];n.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":p=[q("ldir","ldir",[0,0,0],!0),q("lfac","lfac",[0,0],!0),q("normal","normal",[0,0,0],!0),q("norm_fac","norm_fac",0,!0),q("bsdf_params","bsdf_params",[0,0,0,0],!0)];h=[q("lfactor","lfactor",0,!0),q("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":p=[q("color","color",[0,0,0,0],!0),q("specular","specular",[0,0,0],!0),q("lfactor","lfactor",0,!0),q("sfactor","sfactor",0,!0),q("ldir","ldir",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("translucency_params",
"translucency_params",[0,0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("lcolorint","lcolorint",[0,0,0],!0),q("translucency_color","translucency_color",0,!0)];h=[q("color","color",[0,0,0,0],!0),q("specular","specular",[0,0,0],!0)];break;case "NORMAL":p=T(b);h=ba(b);l=aa(b,"Normal");m.push(S(R("param_NORMAL_Normal"),l.Ea,3));break;case "MAPPING":l=b.vector_type;f="MAPPING";p.push(E(b,"Vector"));h.push(aa(b,"Vector"));var I=Ea.Ef(b.rotation),r=Ea.Ef(b.scale),v=Ea.Ef(b.translation),x=za.create(),
P=Ea.VT(I);"TEXTURE"==l&&(r[0]=r[0]||1,r[1]=r[1]||1,r[2]=r[2]||1);var M=new Float32Array([r[0],0,0,0,r[1],0,0,0,r[2]]);za.multiply(P,M,x);x=Ea.MW(x,ua.create());switch(l){case "POINT":x[12]=v[0];x[13]=v[1];x[14]=v[2];break;case "TEXTURE":x[12]=v[0];x[13]=v[1];x[14]=v[2];x=ua.invert(x,x);break;case "NORMAL":ua.invert(x,x),ua.transpose(x,x)}switch(l){case "NORMAL":n.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":n.push(["MAPPING_TRS_MATRIX_DEF",1]);n.push(["MAPPING_TRS_MATRIX",ka.N(x,16)]);break;case "POINT":0!==
Ca.length(I)?(n.push(["MAPPING_TRS_MATRIX_DEF",1]),n.push(["MAPPING_TRS_MATRIX",ka.N(x,16)])):(0!==Ca.length(r)&&(n.push(["MAPPING_SCALE_DEF",1]),n.push(["MAPPING_SCALE",ka.N(r,3)])),0!==Ca.length(v)&&(n.push(["MAPPING_TRANS_DEF",1]),n.push(["MAPPING_TRANS",ka.N(v,3)])));break;case "VECTOR":0!==Ca.length(I)?(n.push(["MAPPING_TRS_MATRIX_DEF",1]),n.push(["MAPPING_TRS_MATRIX",ka.N(x,16)])):0!==Ca.length(r)&&(n.push(["MAPPING_SCALE_DEF",1]),n.push(["MAPPING_SCALE",ka.N(r,3)]))}b.use_min&&(n.push(["MAPPING_MIN_CLIP_DEF",
1]),n.push(["MAPPING_MIN_CLIP",ka.N(b.min,3)]));b.use_max&&(n.push(["MAPPING_MAX_CLIP_DEF",1]),n.push(["MAPPING_MAX_CLIP",ka.N(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":t=[];l=[];I=[];r=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("dif_params","dif_params",[0,0],!0),q("sp_params","sp_params",[0,0],!0),q("shadow_factor","shadow_factor",0,!0)];v=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0),
q("normal","normal",[0,0,0],!0)];x=[aa(b,"Color"),aa(b,"Alpha"),aa(b,"Normal")];P=[];M=E(b,"Color");M.Ea.splice(3);I.push(M);p.push(M);M=E(b,"Spec");M.Ea.splice(3);I.push(M);p.push(M);(M=E(b,"DiffuseIntensity"))||(M=E(b,"Refl"));M.Ea=b.diffuse_intensity;I.push(M);p.push(M);var C=E(b,"Normal");C.Ea.splice(3);I.push(C);p.push(C);"MATERIAL_EXT"==f?((M=E(b,"Emit"))||(M=q("Emit","Emit",0)),I.push(M),p.push(M),(M=E(b,"Translucency"))?(M.Ea=0,M.name="Translucency",M.identifier="Translucency"):M=q("Translucency",
"Translucency",0),p.push(M),(M=E(b,"Translucency"))?(M.Ea=[0,0,0,0],M.name="TranslucencyParams",M.identifier="TranslucencyParams"):M=q("TranslucencyParams","TranslucencyParams",[0,0,0,0]),p.push(M),h=E(b,"Reflectivity"),M=E(b,"Ray Mirror"),h?(M=h,h="Reflectivity"):M?h="Ray Mirror":(M=h,h="Reflectivity"),M||(M=q(h,h,0)),p.push(M),v.push(M),(M=E(b,"SpecTra"))||(M=q("SpecTra","SpecTra",0)),p.push(M),v.push(M),(M=E(b,"Alpha"))||(M=q("Alpha","Alpha",b.alpha)),p.push(M),v.push(M),x.push(aa(b,"Diffuse")),
x.push(aa(b,"Spec")),t.push(["MATERIAL_EXT",1]),l.push(["MATERIAL_EXT",1])):(I.push(q("emit_intensity","emit_intensity",0)),v.push(q("reflect_factor","reflect_factor",0)),v.push(q("specular_alpha","specular_alpha",0)),v.push(q("alpha_in","alpha_in",0)),x.push(q("diffuse_out","diffuse_out",0)),x.push(q("spec_out","spec_out",0)),t.push(["MATERIAL_EXT",0]),l.push(["MATERIAL_EXT",0]));P.push(S(R("param_MATERIAL_alpha"),b.alpha));P.push(S(R("param_MATERIAL_spec_alpha"),b.specular_alpha));h=x;t.push(["USE_MATERIAL_NORMAL",
C.eb|0]);b.use_diffuse&&(t.push(["USE_MATERIAL_DIFFUSE",1]),l.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&l.push(["USE_MATERIAL_SPECULAR",1]);var M=[],ha=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":C=b.specular_hardness;break;case "WARDISO":C=b.specular_slope;break;case "TOON":C=b.specular_toon_size;ha=b.specular_toon_smooth;break;case "BLINN":C=b.specular_ior;ha=b.specular_hardness;break;default:xa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),C=b.specular_hardness}var w,z;switch(b.diffuse_shader){case "LAMBERT":z=w=0;break;case "OREN_NAYAR":w=b.roughness;z=0;break;case "FRESNEL":w=b.diffuse_fresnel;z=b.diffuse_fresnel_factor;break;case "MINNAERT":w=b.darkness;z=0;break;case "TOON":w=b.diffuse_toon_size;z=b.diffuse_toon_smooth;break;default:xa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),z=w=0}M.push(S(R("param_MATERIAL_diffuse"),[w,z],2));M.push(S(R("param_MATERIAL_spec"),[b.specular_intensity,
C,ha],3));t.push(["SHADELESS_MAT",b.use_shadeless?1:0]);C={name:b.name,value:{Js:b.specular_shader,Vq:b.diffuse_shader,Ke:b.use_shadeless,dn:b.use_tangent_shading}};t={name:b.name,value:{Js:b.specular_shader,Vq:b.diffuse_shader,Ke:b.use_shadeless,dn:b.use_tangent_shading},NW:{name:"material_begin",type:"MATERIAL_BEGIN",L:I,gb:r,rb:M,data:C,Rb:t,qi:[]},OW:{name:"material_end",type:"MATERIAL_END",L:v,gb:x,rb:P,data:C,Rb:l,qi:[]}};break;case "BSDF_DIFFUSE":p=T(b);n.push(["USE_NORMAL_IN",p[2].eb|0]);
h=aa(b,"BSDF");l=h.eb;h=[h,q("d_color","d_color",[0,0,0],l),q("d_roughness","d_roughness",0,l),q("s_color","s_color",[0,0,0],l),q("s_roughness","s_roughness",0,l),q("metalness","metalness",0,l),q("normal","normal",[0,0,0],l),q("e_color","e_color",[0,0,0],l),q("emisson","emisson",0,l)];break;case "BSDF_GLOSSY":p=T(b);n.push(["USE_NORMAL_IN",p[2].eb|0]);h=aa(b,"BSDF");l=h.eb;h=[h,q("d_color","d_color",[0,0,0],l),q("d_roughness","d_roughness",0,l),q("s_color","s_color",[0,0,0],l),q("s_roughness","s_roughness",
0,l),q("metalness","metalness",1,l),q("normal","normal",[0,0,0],l),q("e_color","e_color",[0,0,0],l),q("emisson","emisson",0,l)];break;case "EMISSION":p=T(b);h=aa(b,"Emission");l=h.eb;h=[h,q("d_color","d_color",[0,0,0],l),q("d_roughness","d_roughness",0,l),q("s_color","s_color",[0,0,0],l),q("s_roughness","s_roughness",0,l),q("metalness","metalness",1,l),q("normal","normal",[0,0,0],l),q("e_color","e_color",[0,0,0],l),q("emisson","emisson",1,l)];break;case "MATH":switch(b.operation){case "ADD":f="MATH_ADD";
break;case "SUBTRACT":f="MATH_SUBTRACT";break;case "MULTIPLY":f="MATH_MULTIPLY";break;case "DIVIDE":f="MATH_DIVIDE";break;case "SINE":f="MATH_SINE";break;case "COSINE":f="MATH_COSINE";break;case "TANGENT":f="MATH_TANGENT";break;case "ARCSINE":f="MATH_ARCSINE";break;case "ARCCOSINE":f="MATH_ARCCOSINE";break;case "ARCTANGENT":f="MATH_ARCTANGENT";break;case "POWER":f="MATH_POWER";break;case "LOGARITHM":f="MATH_LOGARITHM";break;case "MINIMUM":f="MATH_MINIMUM";break;case "MAXIMUM":f="MATH_MAXIMUM";break;
case "ROUND":f="MATH_ROUND";break;case "LESS_THAN":f="MATH_LESS_THAN";break;case "GREATER_THAN":f="MATH_GREATER_THAN";break;case "MODULO":f="MATH_MODULO";break;case "ABSOLUTE":f="MATH_ABSOLUTE";break;default:return xa.error("Unsupported MATH operation: "+b.operation),null}n.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);p=T(b);h=ba(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":f="MIX_RGB_MIX";break;case "ADD":f="MIX_RGB_ADD";break;case "MULTIPLY":f="MIX_RGB_MULTIPLY";break;case "SUBTRACT":f=
"MIX_RGB_SUBTRACT";break;case "SCREEN":f="MIX_RGB_SCREEN";break;case "DIVIDE":f="MIX_RGB_DIVIDE";break;case "DIFFERENCE":f="MIX_RGB_DIFFERENCE";break;case "DARKEN":f="MIX_RGB_DARKEN";break;case "LIGHTEN":f="MIX_RGB_LIGHTEN";break;case "OVERLAY":f="MIX_RGB_OVERLAY";break;case "DODGE":f="MIX_RGB_DODGE";break;case "BURN":f="MIX_RGB_BURN";break;case "HUE":f="MIX_RGB_HUE";break;case "SATURATION":f="MIX_RGB_SATURATION";break;case "VALUE":f="MIX_RGB_VALUE";break;case "COLOR":f="MIX_RGB_COLOR";break;case "SOFT_LIGHT":f=
"MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":f="MIX_RGB_LINEAR_LIGHT";break;default:return xa.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}n.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);p=T(b);h=ba(b);break;case "OUTPUT":p=T(b);h=[];break;case "OUTPUT_MATERIAL":T(b);p=E(b,"Surface");h=p.eb;t=[p,q("d_color","d_color",[0,0,0],h),q("d_roughness","d_roughness",0,h),q("s_color","s_color",[0,0,0],h),q("s_roughness","s_roughness",0,h),q("metalness","metalness",0,h),q("normal","normal",
[0,0,0],h),q("e_color","e_color",[0,0,0],h),q("emission","emission",0,h)];l=[q("E","E",[0,0,0],!0),q("A","A",[0,0,0],!0),q("D","D",[0,0,0],!0),q("S","S",[0,0,0],!0),q("normal","normal",[0,0,0],!0),q("bsdf_params","bsdf_params",[0,0,0,0],!0),q("shadow_factor","shadow_factor",0,!0),q("s_color","s_color",[0,0,0],!0),q("metalness","metalness",0,!0),q("e_color","e_color",[0,0,0],!0),q("emission","emission",0,!0)];I=[q("color","color",[0,0,0],!0),q("specular","specular",[0,0,0],!0),q("normal","normal",
[0,0,0],!0),q("s_color","s_color",[0,0,0],!0),q("metalness","metalness",0,!0),q("e_color","e_color",[0,0,0],!0),q("emission","emission",0,!0)];r=[];p=t;h=r;t={name:b.name,value:{lR:"BSDF_COMPUTE"},jR:{name:"bsdf_begin",type:"BSDF_BEGIN",L:t,gb:l,rb:[],data:null,Rb:[],qi:[]},kR:{name:"bsdf_end",type:"BSDF_END",L:I,gb:r,rb:[],data:null,Rb:[],qi:[]}};break;case "RGB":l=b.name;l={name:"-1",value:l};m.push(l);h.push(aa(b,"Color"));break;case "SEPRGB":case "SEPHSV":p=T(b);h=ba(b);break;case "TEX_ENVIRONMENT":(l=
b.image)?(f="TEXTURE_ENVIRONMENT","NONE"==b.color_space?n.push(["NON_COLOR",1]):n.push(["NON_COLOR",0]),p.push(E(b,"Vector")),h.push(aa(b,"Color")),I=R("param_TEXTURE_texture"),m.push(S(I)),t=pa.bH(128),t.source="ENVIRONMENT_MAP",pa.JF(t,l),t={name:I,value:t}):f="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(l=b.image){f="TEXTURE_COLOR";"NONE"==b.color_space?n.push(["NON_COLOR",1]):n.push(["NON_COLOR",0]);n.push(["CONVERT_UV",0]);for(I=0;4>I;++I)I?(M=q("Vector"+I,"Vector"+I,[0,0,0],!1),r=q("Color"+I,"Color"+
I,[0,0,0],!1),v=q("Alpha"+I,"Alpha"+I,0,!1)):(M=E(b,"Vector"),r=aa(b,"Color"),v=aa(b,"Alpha")),p.push(M),h.push(r),h.push(v);I=R("param_TEXTURE_texture");m.push(S(I));t=pa.Kl(pa.Ah,!1);t.repeat="REPEAT"==b.extension;t.source="IMAGE";pa.JF(t,l);t={Fz:b.name,name:I,value:t}}else f="TEXTURE_EMPTY";break;case "TEXTURE":f=ca(b);if("TEXTURE_EMPTY"==f)h.push(aa(b,"Color")),h.push(aa(b,"Normal")),h.push(aa(b,"Value"));else if("TEXTURE_ENVIRONMENT"==f)p.push(E(b,"Vector")),h.push(aa(b,"Color")),h.push(aa(b,
"Value"));else{if("TEXTURE_NORMAL"==f&&"ENVIRONMENT_MAP"==b.texture.type)return xa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==f&&(l=!1,(I=b.texture.image)&&"Non-Color"==I.colorspace_settings_name&&(l=!0),n.push(["NON_COLOR",Number(l)]),n.push(["CONVERT_UV",1]));for(I=0;4>I;++I)l="TEXTURE_COLOR"==f?"Color":"Normal",I?(M=q("Vector"+I,"Vector"+I,[0,0,0],!1),r=q(l+I,l+I,[0,0,0],!1),v=q("Value"+I,"Value"+I,0,!1)):(M=E(b,"Vector"),r=aa(b,l),v=aa(b,"Value")),p.push(M),
h.push(r),h.push(v)}"TEXTURE_EMPTY"!=f&&(I=R("param_TEXTURE_texture"),m.push(S(I)),t=b.texture.s,t={Fz:b.texture.name,name:I,value:t});break;case "VALTORGB":p=T(b);h=ba(b);t={value:b};l=b.color_ramp.interpolation;"CONSTANT"!=l&&"LINEAR"!=l&&xa.warn("Color Ramp node is not fully supported.");break;case "VALUE":f="VALUE";l=b.name;l={name:"-1",value:l};m.push(l);h.push(aa(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":f="VECT_MATH_ADD";break;case "SUBTRACT":f="VECT_MATH_SUBTRACT";
break;case "AVERAGE":f="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":f="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":f="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":f="VECT_MATH_NORMALIZE";break;default:return xa.error("Unsupported VECT_MATH operation: "+b.operation),null}p=T(b);h=ba(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":n.push(["VECTOR_TYPE",ka.N(0)]);break;case "VECTOR":n.push(["VECTOR_TYPE",ka.N(1)]);break;case "NORMAL":n.push(["VECTOR_TYPE",ka.N(2)]);break;default:return xa.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}p=b.convert_from;h=b.convert_to;l=0;if("WORLD"==p)if("WORLD"==h)l=0;else if("OBJECT"==h)l=1;else if("CAMERA"==h)l=2;else return xa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==p)if("WORLD"==h)l=3;else if("OBJECT"==h)l=4;else if("CAMERA"==h)l=5;else return xa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==p)if("WORLD"==h)l=6;else if("OBJECT"==h)l=7;else if("CAMERA"==h)l=8;else return xa.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return xa.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;n.push(["CONVERT_TYPE",ka.N(l)]);p=T(b);h=ba(b);break;case "NORMAL_MAP":l=0;switch(b.space){case "TANGENT":l=0;break;case "OBJECT":l=1;break;case "WORLD":l=2;break;case "BLENDER_OBJECT":l=3;break;case "BLENDER_WORLD":l=4;break;default:return xa.error("Unsupported NORMAL_MAP space: "+b.space),null}n.push(["SPACE",ka.N(l)]);p.push(E(b,"Strength"));p.push(E(b,"Color"));h.push(aa(b,"Normal"));break;
case "FRESNEL":C=E(b,"Normal");p.push(E(b,"IOR"));p.push(C);h.push(aa(b,"Fac"));n.push(["USE_FRESNEL_NORMAL",C.eb|0]);break;case "LAYER_WEIGHT":C=E(b,"Normal");p.push(E(b,"Blend"));p.push(C);h=ba(b);n.push(["USE_NORMAL_IN",C.eb|0]);break;case "BUMP":C=E(b,"Normal"),n.push(["INVERT",b.invert?1:0]),n.push(["USE_NORMAL_IN",C.eb|0]),T(b),ba(b);default:p=T(b),h=ba(b)}f={name:e,type:f,qi:k,L:p,gb:h,rb:m,data:t,Rb:n};e=B.am(a);B.Fj(a,B.am(a),f);if(!(f="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{f=b.outputs;for(m=k=0;m<f.length;m++)if(f[m].is_linked&&k++>c){f=!0;break a}f=!1}f=!f}return f||null!=da(a,b,++c,d,g)?e:null}function G(a,b,c){for(var d=a.inputs,g=a.outputs,e=a.node_tree_name,f=0;f<b.length;f++){var q=d[f],k=b[f];if(!q||q.default_value instanceof Array!=k)return xa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',e,'".Processing as general node group.'),!1}for(f=0;f<c.length;f++)if(b=g[f],d=c[f],!b||b.default_value instanceof Array!=d)return xa.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',e,'".Processing as general node group.'),!1;return!0}function F(a,b,c){var d=a.node_group.node_tree,g={},e;for(e in d)if("links"==e||"nodes"==e){g[e]=[];for(var f=0;f<d[e].length;f++){g[e][f]={};for(var q in d[e][f])if("links"==e){g[e][f][q]={};for(var k in d[e][f][q])g[e][f][q][k]=U(d[e][f][q][k])}else g[e][f][q]=U(d[e][f][q])}}else g[e]=U(d[e]);d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)e=t("Group input","GROUP_INPUT",[],a.inputs),f=t("Group output",
"GROUP_OUTPUT",a.outputs,[]),q=null,q="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(I.quality==ea.Np||I.SH)?{from_node:e,from_socket:e.outputs[1],to_node:f,to_socket:f.inputs[0]}:{from_node:e,from_socket:e.outputs[0],to_node:f,to_socket:f.inputs[0]},g.nodes=[e,f],g.links=[q];d=a.name;e=g.nodes;f=g.links;for(q=0;q<e.length;q++)e[q].name=oa(e[q].type,d,e[q].name);for(q=0;q<f.length;q++)f[q].from_node.name=oa(f[q].from_node.type,d,f[q].from_node.name),f[q].to_node.name=oa(f[q].to_node.type,d,f[q].to_node.name);
return{aX:n(g,a.node_group.uuid,!0,b,c).Xa,bX:g.links}}function U(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ea.zq(a):a}function R(a){Ba[a]||(Ba[a]=0);var b=a+"_"+Ba[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ba[a]++;return b}function Z(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function u(a,b){for(var c=a.outputs,d=0,g=0;g<c.length;g++){var e=c[g];if(e.is_linked&&!(d++<b))switch(e.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ga(a,b){for(var c=a.outputs,d=0,g=0;g<c.length;g++){var e=c[g];if(e.is_linked&&!(d++<b))switch(e.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function ca(a){if(!a.texture||!a.texture.s)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,g=!1,e=0;e<b.length;e++){var f=b[e];if(f.is_linked)switch(f.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":g=!0;break;default:Ea.q("Unknown texture output")}}if(c)return d&&
xa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(g)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function E(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var g=c[d];if(g.identifier==b)return ia(g)}return null}function aa(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var g=c[d];if(g.identifier==b)return ia(g)}return null}function ia(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=Ea.jk(a)?a.slice(0):a;return{name:b,identifier:c,eb:d,Ea:a}}function q(a,b,c,d){return{name:a,identifier:b,eb:d,Ea:c}}function T(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ia(a.inputs[c]);d.Ea.length&&d.Ea.splice(3);b.push(d)}return b}function ba(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ia(a.outputs[c]);b.push(d)}return b}function S(a,b,c){b=null===b||void 0===b?null:ka.N(b,c);return{name:a,value:b}}function sa(a,b,c,d,g,e){var f=
[],q=e.from_socket.identifier;e=e.to_socket.identifier;var k=d.gb;for(d=0;d<k.length;d++)if(k[d].identifier==q){f.push(d);break}g=g.L;for(d=0;d<g.length;d++)if(g[d].identifier==e){f.push(d);break}2==f.length&&B.ed(a,b,c,f);return!0}function oa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function Y(a){var b=[];B.pa(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function na(a,b,c){for(var d=0;d<c.length;d++){var g=c[d].data.aX,e=c[d].data.bX;if(!g)return!1;
B.pa(g,function(b,c){B.Fj(a,B.am(a),c)});for(g=0;g<e.length;g++)b.push(e[g]);ta(c[d],b,a)}return!0}function ya(a,b,c,d,g,e){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||g.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||e.push(c)}}function wa(a,b,c){for(var d=[],g=0;g<c.length;g++){for(var e=c[g],f=null,q=0;q<b.length;q++)if(e.from_socket.identifier==b[q].to_socket.identifier){f=b[q];break}f?(e.from_node=f.from_node,e.from_socket=f.from_socket):
d.push(e)}for(g=0;g<b.length;g++)a.splice(a.indexOf(b[g]),1);return d}function la(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function ha(a,b,c,d){for(var g=0;g<d.length;g++){for(var e=d[g],f,q=0;q<c.L.length;q++)if(e.from_socket.identifier==c.L[q].identifier){f=c.L[q].Ea;break}for(var q=e,k=b,p=f,u=C(q.to_node,k),h=0;h<u.length;h++)for(var m=B.Wa(k,u[h]),t=0;t<m.L.length;t++){var E=m.L[t];if(E.identifier==q.to_socket.identifier){m=E.Ea instanceof
Object?0:1;if((p instanceof Object?0:1)==m)E.Ea=p;else switch(m){case 0:E=E.Ea;E[0]=E[1]=E[2]=p;break;case 1:E.Ea=(p[0]+p[1]+p[2])/3}break}}e=a.indexOf(e);-1!=e&&a.splice(e,1)}}function ta(a,b,c){for(var d=a.name,g=[],e=[],f=[],q=[],k=0;k<b.length;k++){var p=b[k];ya(p.from_node,d,p,g,f,q);ya(p.to_node,d,p,e,f,q)}e=wa(b,e,f);g=wa(b,q,g);la(b,e);ha(b,c,a,e);if(g.length){var u;B.pa(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(u=b)});ha(b,c,u,g)}}function ma(a){var b=[],c=[];B.pa(a,
function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,g=a=null,e=b.length+c.length;if(b.length){a=pa.ZT(b,pa.RN);for(var f=0;f<b.length;f++)b[f].Rb.push(["NODE_TEX_ROW",ka.N((d+.5)/e)]),d++}if(c.length)for(g=pa.cU(c,pa.BE),f=0;f<c.length;f++)c[f].Rb.push(["NODE_TEX_ROW",ka.N((d+.5)/e)]),d++;f=null;a&&g?(f=new Uint8Array(a.length+g.length),f.set(a),f.set(g,a.length)):f=a?a:g;a=f?pa.aH(f,pa.BE):null;for(f=0;f<b.length;f++)b[f].data.kb=a;
for(f=0;f<c.length;f++)c[f].data.kb=a}function N(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ea=l("__config");l("__debug");var B=l("__graph"),za=l("__mat3"),ua=l("__mat4"),ja=l("__objects"),xa=l("__print"),ka=l("__shaders"),Pa=l("__scenes"),Ea=l("__util"),Ca=l("__vec3"),pa=l("__textures"),Ba={},va={},Ma={},Ga={},Ra=0;new Float32Array(4);var I=ea.B;a.V1=0;a.aQ=1;a.$P=2;a.ZP=3;a.U1=4;a.YP=5;a.XP=6;a.WP=7;a.T1=8;a.LO=0;
a.KO=1;a.L1=2;a.JO=3;a.K1=4;a.GI=function(a){return va[a]};a.$R=function(a){delete va[a]};a.hS=n;a.mA=function(a,c,d){var g=Pa.A();a=h(a,"MAIN",g.uuid);if(a in Ma)return Ma[a];var g=B.create(),e={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},f=da(g,e,0,c,null),e={name:"LIGHTING_END",type:"LIGHTING_END"},e=da(g,e,0,c,null);b(g,d,f,e,[[f,[8,10]],[f,[9,6]]],c);k(g);return Ma[a]=g};a.pu=function(a){var b=[],c={};Ba={};var d=B.UD(a);B.pa(d,function(a,d){var g;g=[];for(var e=[],f=[],q=[],k=[],p=[],u=0;u<
d.L.length;u++){var h=d.L[u];if(h.eb)g.push(null),e.push(null);else{g.push(R("in_"+d.type+"_"+h.identifier.replace(/\./g,"")));var m=ka.N(h.Ea,0);I.tD&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==h.identifier||"Color2"==h.identifier||"Fac"==h.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==h.identifier||"Value_001"==h.identifier||"Value.001"==h.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==h.identifier||"Vector.001"==h.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||
0<=d.type.indexOf("MATERIAL_BEGIN"))&&(h=m,h=h.replace(/(,)/g,"$1 "),h=h.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),h=h.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),m=h=h.replace(/\s+/g,""));e.push(m)}}for(u=0;u<d.gb.length;u++)h=d.gb[u],h.eb?f.push(null):f.push(R("out_"+d.type+"_"+h.identifier.replace(/\./g,"")));for(u=0;u<d.rb.length;u++)h=d.rb[u],q.push(h.name),k.push(h.value);for(u=0;u<d.qi.length;u++)p.push(d.qi[u].name);g={id:d.type,L:g,zB:e,gb:f,rb:q,tw:k,qi:p,Rb:JSON.parse(JSON.stringify(d.Rb))};
b.push(g);c[a]=g});B.xg(d,function(a,b,g){var e=B.Wa(d,a);B.Wa(d,b);var f=e.gb[g[0]];a=c[a].gb;b=c[b].L;e=a[g[0]]||R("out_"+e.type+"_"+f.identifier.replace(/\./g,""));a[g[0]]=e;b[g[1]]=e});return b};a.GG=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.ua=function(){for(var a in va)delete va[a];for(a in Ma)delete Ma[a];for(var b in Ga)delete Ga[b];Ra=0}};b4w.module.__debug=function(a,l){function n(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function e(){var a=k.fB();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function b(){var b=x;return b&&b.debug_view_mode==a.yp}function y(a,b,c){var d=k.fB(),g=0;if(d)for(c&&d.endQuery(),c=0;c<a.length;c++){var e=a[c],f=d.fI(e),p=H.getParameter(d.eI());f&&!p&&(g=d.gI(e)/1E6,b&&(g=D.mc(g,b,1,10)),a.splice(c,1),c--)}else g=performance.now()-
a.pop(),b&&(g=D.mc(g,b,1,10));return g}function r(a,b){A(a)||D.q("Structure assertion failed: invalid first object value");A(b)||D.q("Structure assertion failed: invalid second object value");h(a,b)||D.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||D.EB(a)||a instanceof Array)){for(var c in a)A(a[c])||D.q("Structure assertion failed: invalid value for key in the first object: "+c),c in b||D.q("Structure assertion failed: missing key in the first object: "+
c);for(c in b)A(b[c])||D.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||D.q("Structure assertion failed: missing key in the second object: "+c),h(a[c],b[c])||D.q("Structure assertion failed: incompatible types for key "+c)}}function A(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function h(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;
c=D.EB(a);d=D.EB(b);if(c&&!d||!c&&d)return!1}return!0}var w=l("__compat"),m=l("__config"),k=l("__extensions"),f=l("__graph"),v=l("__objects"),c=l("__print"),C=l("__scenes"),O=l("__subscene"),J=l("__textures"),K=l("__time"),D=l("__util"),Q=m.B,L={},H=null,z={},d=[],p=-1,M=-1,x=null,g=null,P=!1,t={};a.pt=0;a.ly=1;a.qt=2;a.ky=3;a.ot=4;a.jy=5;a.iy=6;a.yp=7;a.Nf=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;
for(c in b){var d=b[c];d in a&&(L[a[d]]=d)}H=a};a.lY=function(a){x=a};a.G4=function(){return x};a.iU=function(a,b,c,d,g){t[a]||(t[a]={UY:b,Re:{}});c in t[a].Re||(t[a].Re[c]=d);g&&(t[a].Re[c]=0)};a.rG=function(){var a=0,b;for(b in t)for(var c in t[b].Re)a+=t[b].Re[c];return a};a.dM=function(){var a={},b;for(b in t)for(var d in t[b].Re){var g=t[b].Re[d];if(g){var e=t[b].UY;e in a||(a[e]={VD:0,Re:{}});d in a[e].Re||(a[e].Re[d]=0);a[e].Re[d]+=g;a[e].VD+=g}}for(e in a){c.groupCollapsed(e,a[e].VD);for(d in a[e].Re)c.ae(d,
a[e].Re[d]);c.groupEnd()}};a.NK=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),d=0,g=0,e=v.Ub(C.Rh(),"MESH",v.oc),f=0;f<e.length;f++)for(var k=0;k<e[f].I.length;k++)for(var p=0;p<e[f].I[k].W.length;p++){var h=D.Ih(e[f].I[k].W[p]),m=h.ib.yg+"/"+h.ib.Xe;h["shaders_info.directives"]=h.ib.Mi;h["shaders_info.node_elements"]=h.ib.og;delete h.ib;for(var t=0;t<b.length;t++)delete h[b[t]];
if(e[f].Sa)g++;else{d++;h.type in a||(a[h.type]={});m in a[h.type]||(a[h.type][m]={});for(var q in h)q in a[h.type][m]||(a[h.type][m][q]=[]),t=JSON.stringify(h[q]),-1==a[h.type][m][q].indexOf(t)&&a[h.type][m][q].push(t)}}c.group("Batches statistics:");c.ae("STATIC/DYNAMIC count:",d+"/"+g);c.group("STATIC batches diversity:");for(var n in a)for(m in a[n]){b=[];for(q in a[n][m])1<a[n][m][q].length&&b.push([q,a[n][m][q]]);b.sort(function(a,b){return b[1].length!=a[1].length?b[1].length-a[1].length:a<
b?-1:b<a?1:0});if(b.length){c.groupCollapsed(n+" "+m);for(f=0;f<b.length;f++)c.ae(b[f][1].length,b[f][0],b[f][1]);c.groupEnd()}}c.groupEnd();c.groupEnd()};a.Rz=function(a){if(Q.gl_debug){var b=H.getError();b!=H.NO_ERROR&&(b in L?D.q("GL Error: "+b+", gl."+L[b]+" ("+a+")"):D.q("Unknown GL error: "+b+" ("+a+")"))}};a.HR=function(){if(Q.gl_debug||Q.FG)switch(H.checkFramebufferStatus(H.FRAMEBUFFER)){case H.FRAMEBUFFER_COMPLETE:break;case H.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case H.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case H.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case H.FRAMEBUFFER_UNSUPPORTED:c.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case H.C0:c.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:c.error("FRAMEBUFFER CHECK FAILED")}};a.MR=function(){if(-1!=
p)return p;H.bindFramebuffer(H.FRAMEBUFFER,H.createFramebuffer());var a=J.Kl(J.nl,!1);J.resize(a,1,1);H.framebufferTexture2D(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,a.nb,a.sb,0);H.checkFramebufferStatus(H.FRAMEBUFFER)!=H.FRAMEBUFFER_COMPLETE?(p=!0,c.warn("depth-only issue was found")):p=!1;H.bindFramebuffer(H.FRAMEBUFFER,null);return p};a.RR=function(){if(1==Q.Fc)return!1;if(-1!=M)return M;H.bindRenderbuffer(H.RENDERBUFFER,H.createRenderbuffer());H.renderbufferStorageMultisample(H.RENDERBUFFER,Q.Fc,H.RGBA8,
1,1);var a=H.getRenderbufferParameter(H.RENDERBUFFER,H.RENDERBUFFER_SAMPLES);a!=Q.Fc?(M=!0,c.warn("multisample issue was found: requested "+Q.Fc+", got "+a),H.getError()==H.INVALID_OPERATION&&c.warn("the error from multisample issue detected, ignoring")):M=!1;H.bindRenderbuffer(H.RENDERBUFFER,null);return M};a.OR=function(){return w.Sz("Firefox")&&H.getError()==H.OUT_OF_MEMORY?(c.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.dL=function(a,b,d){Q.gl_debug&&(d=n(d),c.error("shader compilation failed:\n"+
d+"\n"+H.getShaderInfoLog(a)+" ("+b+")"))};a.RX=function(a,b,d,g){Q.gl_debug&&(d=n(d),g=n(g),c.error("shader linking failed:\n"+d+"\n\n\n"+g+"\n"+H.getProgramInfoLog(a)+" ("+b+")"))};a.SC=function(a){if(Q.show_hud_debug_info||a.type==O.Lp)a.JA||a.Ml.push(e())};a.MX=function(a){"MAIN"==a.type&&b()&&a.Ml.push(e())};a.TC=function(a){if((Q.show_hud_debug_info||a.type==O.Lp)&&!a.JA){var b=y(a.Ml,a.Cf,!0);b&&(a.Cf=b)}};a.NX=function(a){if("MAIN"==a.type&&b()){var c=y(a.Ml,a.Cf,!0);c&&(a.Cf=c)}};a.GJ=b;
a.AX=function(a){var b=y(a.Ml,a.Cf,!1);b&&(a.Cf=b)};a.V3=function(a){z[a]=a in z?z[a]+1:1};a.update=function(){for(var a in z)c.log(a,z[a]),z[a]=0};a.Qu=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(D.jk(c))for(var g=0;g<c.length;g++)a.push(c[g]);else a.push(arguments[b])}d.push(a)};a.iK=function(){for(var a=1,b=0;b<d.length;b++){var c=d[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],D.jk(a))for(var g=0;g<a.length;g++)c.push(a[g]);
else c.push(arguments[b]);d.push(c)};var da=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.OK=function(a){a||(a=1);for(var b=0,g={},e=Math.max(0,performance.now()-1E3*a),f=0;f<d.length;f++){var k=d[f];a=k[0];if(!(a<e)){var p=String(k[1]);g[p]||(g[p]=da[b++%da.length]);a=["%c"+(a/1E3).toFixed(6),g[p],p];for(p=2;p<k.length;p++)a.push(k[p]);c.log.apply(this,a)}}d.splice(0)};a.DC=function(a){a||(a=1);for(var b={},g=Math.max(0,performance.now()-1E3*a),e=0;e<d.length;e++){var f=
d[e];a=f[0];if(!(a<g))for(var k=2;k<f.length;k++){var p=String(f[1]);3<f.length&&(p+="_"+String(k-2));b[p]||(b[p]=p+"\n");b[p]+=String(a)+" "+f[k]+"\n"}}a="";for(p in b)a+=b[p]+"\n\n";c.log(a);d.splice(0)};a.P2=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&
b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.EG=function(a){if(D.jk(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.t2=function(a,b){a.constructor!=b&&D.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.w2=r;a.x2=function(a){P?r(a,g):P=!0;g=null!=a&&"object"==typeof a?D.zq(a):a};a.PH=function(a,
b,c,d,g){(a=a||null)||D.q("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&D.q("Max percentage must be less than 100");0>c&&D.q("Min percentage must be greater than 0");c>d&&D.q("Max percentage must be greater than min percentage");var e=K.xn(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(K.ku(e),g&&g())})};a.k7=function(a){return f.vT(a,function(a,b){var c=b.type+"("+b.name+")",d=b.L,c=c+"\n\nINPUTS:";if(d.length)for(var g=0;g<d.length;g++)c+="\n"+d[g].identifier+": ",c=d[g].eb?
c+"linked":c+d[g].Ea;else c+="\n---";d=b.gb;c+="\n\nOUTPUTS:";if(d.length)for(g=0;g<d.length;g++)c+="\n"+d[g].identifier+": ",c=d[g].eb?c+("linked(default "+d[g].Ea+")"):c+"not used";else c+="\n---";g="";switch(b.type){case "GEOMETRY_UV":g="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":g="\ntexture: "+b.data.value.name+"\n("+b.data.value.Yn+")"}""==g&&(g="\n---");return c=c+"\n\nDATA:"+g},function(b,c,d){b=f.Wa(a,b);c=f.Wa(a,c);return b.gb[d[0]].identifier+"\n==>\n"+
c.L[d[1]].identifier})};a.av=function(){return H};a.ua=function(){x=null;t={}};a.reset=function(){H=null}};b4w.module.__compat=function(a,l){function n(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function e(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var y=l("__config"),r=l("__debug"),A=l("__extensions"),
h=l("__print"),w=l("__renderer"),m="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.UE=256;var k=y.sl,f=y.B,v=y.Tq,c=y.context,C=y.Gi,O=y.X,J=y.C,K=y.Pd;a.BT=function(a){a.getError()==a.INVALID_ENUM&&h.warn("Possible Tegra invalid enum issue detected, ignoring")};a.GL=function(l,Q){function L(a){Q&&h.warn(a)}C.PW=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
C.Yv=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS);C.$B=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS);C.Zv=l.getParameter(l.MAX_VARYING_VECTORS);C.aC=l.getParameter(l.MAX_VERTEX_ATTRIBS);C.gK=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS);C.Tr=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS);C.Zi=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE);C.XB=l.getParameter(l.MAX_RENDERBUFFER_SIZE);C.Ec=l.getParameter(l.MAX_TEXTURE_SIZE);C.bC=l.getParameter(l.MAX_VIEWPORT_DIMS);f.ec&&!v.enabled&&(f.Gq=!0);f.ec?(f.Fc=
Math.min(f.Fc,l.getParameter(l.MAX_SAMPLES)),n("Firefox")&&(L("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),f.FG=!0),n("Windows")&&n("Chrome")&&(L("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),f.Fc=1)):f.Fc=1;n("Firefox")&&"NONE"!==f.stereo&&(L("Firefox and Stereo rendering detected, disable texture reusage"),f.QH=!0);if(f.ec&&r.RR()||n("Firefox"))L("Firefox detected, disabling multisample"),f.Fc=1;w.oY();var H=Boolean(A.UU());
n("Firefox/28.0")&&(n("Linux")||n("Macintosh"))&&(L("Firefox 28 detected, applying depth hack"),H=!1);n("Windows Phone")||(n("iPad")||n("iPhone")?(L("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),c.alpha||(f.background_color[3]=1),f.lL=!0,f.AN=!0,f.smaa=!1,f.ssao=!1,f.precision="highp",f.yB=!0,Boolean(A.MI())&&K.Cw&&(f.Hq="pvr")):n("Mac OS X")&&n("Safari")&&
!n("Chrome")&&(L("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),f.kL=!0,O.WF=!0,O.MG=!0));n("Windows")&&(n("Chrome/40")||n("Firefox/33")||n("Firefox/34")||n("Firefox/35")||n("Firefox/36"))&&(L("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),f.Vz=!0);n("Chrome")&&!e()&&y.CJ()&&(L('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
f.LG=!0);n("Mac OS X")&&(f.Wv=!0,L("OS X detected, applying shadows hack."));e()&&(L("Mobile detected, applying various hacks for video textures."),f.is_mobile_device=!0,n("iPad")||n("iPhone")||n("Windows Phone")||(L("Mobile (not iOS) detected, disable playback rate for video textures."),O.FH=!0));(n("Firefox/35.0")||n("Firefox/36.0"))&&n("Windows")&&(L("Windows/Firefox 35/36 detected, applying shadows slink hack"),f.cM=!0);if(n("iPhone")||b()||n("Edge"))L("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
f.zs=!0;10>C.Zv&&(L("Not enough varyings, disable shadows on blend objects"),f.GA=!0);n("Windows Phone")&&(L("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),f.debug_view=!1,f.precision="highp",f.Ui=!1,f.ssao=!1,f.smaa=!1,f.shadows=!1,f.reflections=!1,f.refractions=!1,f.SK=!1);if(n("UCBrowser")||n("Chrome")&&n("Nexus")&&f.is_mobile_device)L("Mobile Nexus Chrome or UCBrowser detected, disable workers."),J.at=!1;var z=A.ev();if(z){var d=
l.getParameter(z.UNMASKED_VENDOR_WEBGL),z=l.getParameter(z.UNMASKED_RENDERER_WEBGL),p=/\b4\d{2}\b/;-1<d.indexOf("ARM")&&p.test(z)&&(L("ARM Mali-400 series detected, applying depth and frames blending hacks"),H=!1,k.WH=!0);-1<d.indexOf("ARM")&&-1<z.indexOf("Mali-T604")&&(L('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),f.precision="highp",f.shadows=!1);-1<d.indexOf("ARM")&&-1<z.indexOf("Mali-T760")&&(L('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),f.precision=
"highp",f.ssao=!1,f.cx=!0,f.ec&&(f.Fc=1,L("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<d.indexOf("Qualcomm")&&-1<z.indexOf("Adreno")&&(L("Qualcomm Adreno detected, applying shader constants hack."),f.tD=!0,-1<z.indexOf("305")&&(L('Qualcomm Adreno305 detected, set "highp" precision.'),f.precision="highp"),-1<z.indexOf("330")&&(L('Qualcomm Adreno330 detected, set "highp" precision.'),f.precision="highp"),-1<z.indexOf("420")&&(L("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),
C.Ec=4096,C.Zi=4096));-1<d.indexOf("NVIDIA")&&-1<z.indexOf("Tegra 3")&&(L("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),f.SH=!0);n("Windows")&&n("Chrome")&&!n("Edge")&&(z.match(/NVIDIA GeForce 8..0/)||z.match(/NVIDIA GeForce 9..0/)||z.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(L("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),C.Zi=a.UE,f.WC=!0);-1<z.indexOf("AMD")&&n("Windows")&&n("Chrome")&&
(f.qz=!0);-1<z.indexOf("PowerVR")&&(L("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),f.WC=!0,f.cx=!0,f.shadows=!1);d="";for(p=0;p<m.length;p++)if(-1<z.indexOf(m[p])){d=m[p];break}d&&(L("Architecture "+d+" detected. Blending between frames and shadows on blend objects will be disabled."),f.cx=!0,f.GA=!0)}0==C.gK&&(L("Vertex textures are not allowed. Disabling vertex textures"),f.St=!1);H||(f.fr=!1,f.hd=!1,f.water_dynamic=
!1,f.Kk=!1,f.ax=!1,f.smaa=!1);f.lN=Boolean(A.RI())||"pvr"==f.Hq;f.Hu=H;if(l.getShaderPrecisionFormat)var M=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT);l.getShaderPrecisionFormat&&0!==M.precision||(f.precision="mediump");if(b()&&n("Touch")||n("Edge"))L("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),f.Xn=!0;if(b()||n("Edge"))f.xJ=!0;e()&&n("Firefox")&&(h.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),
f.dC=!0,C.Ec=4096,C.Zi=4096);n("Edge")&&(L("Microsoft Edge detected, set up new minimal texture size."),f.br=!0)};a.Sz=n;a.Zf=e;a.HQ=function(){n("Firefox/35.0")&&n("Windows")&&(h.warn("Windows/Firefox 35 detected, forcing context's alpha"),y.context.alpha=!0)};a.Hr=b};b4w.module.__renderer=function(a,l){function n(a){for(var g=a.p,e=a.Ra,k=null,h=O.hc(g.n,da),E=0;E<e.length;E++){var n=e[E];if(n.cc){var l=n.zb,n=n.sa;if(l.di!=k){p.useProgram(l.di);for(var k=a,q=g,T=l,v=T.YM,S=v.length;S--;){var x=v[S];x.Un(p,x.df,k,q)}if(T.Wr&&!T.iw)for(T.zC.length||r(T),T=T.zC,S=T.length;S--;)x=T[S],x.Un(p,x.df,k,q);k=l.di}for(q=0;q<n.length;q++)if(v=n[q],v.cc){T=v.ff;S=v.za;m.MX(S);m.GJ()&&"DEBUG_VIEW"==S.type&&(S.Rq=J.mc(A.WQ(S.In),S.Rq,1,15));if(U.alpha_sort&&S.sf){var x=T,
v=v.Dv,M=h,P=S.Ca,C=D.dist(M,v.NN),w=U.alpha_sort_threshold*Math.min(v.ZQ,1);if(C>w||x.jr)f.d_(P,v,x.n,M),D.copy(M,v.NN),x.jr=!1}x=a;v=S;M=l;w=M.ZM;for(P=w.length;P--;)C=w[P],C.Un(p,C.df,T,v);if(M.Wr&&!M.iw){M.ds.length||r(M);w=M.ds;for(P=w.length;P--;)C=w[P],C.Un(p,C.df,T,v);M.Wr=!1}p.depthMask(v.Va);v.Zb?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE);P=v.ya;C=p;for(w=0;w<P.length;w++){var z=P[w];C.activeTexture(C.TEXTURE0+w);C.bindTexture(z.nb,z.sb)}if(x.type==c.Dg){T=x;M=M.Zm;P=T.p.wc.sb;C=T.Ll;
for(w=0;6>w;w++)if(z=b(w),U.Vz?(p.bindTexture(p.TEXTURE_CUBE_MAP,P),p.texImage2D(z,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,d)):(p.uniformMatrix4fv(M.u_cube_view_matrix,!1,C[w]),p.uniform4fv(M.u_sky_tex_fac,T.hx),p.uniform3fv(M.u_sky_tex_color,T.fx),p.uniform1f(M.u_sky_tex_dvar,T.gx),p.uniform3fv(M.u_horizon_color,T.ke),p.uniform3fv(M.u_zenith_color,T.te),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,z,P,0),t(v,0)),T.gw&&3!=w){var z=T,H=w,ha=F;U.Vz?ha.set(d):(p.readPixels(191,191,1,1,p.RGBA,
p.UNSIGNED_BYTE,ha),255!=ha[0]&&255!=ha[1]&&255!=ha[2]||p.readPixels(191,220,1,1,p.RGBA,p.UNSIGNED_BYTE,ha));var ta=ha[0],G=ha[1],ha=ha[2],ta=ta/255,G=G/255,ha=ha/255;2===H?(z.ye[3]=ta,z.ye[7]=G,z.ye[11]=ha):2>H?(z.ye[4*H]=ta,z.ye[4*H+1]=G,z.ye[4*H+2]=ha):(z.ye[4*(H-2)]=ta,z.ye[4*(H-2)+1]=G,z.ye[4*(H-2)+2]=ha)}x.Sq+=6}else t(v,T.Cx),x.Sq++;m.NX(S);m.GJ()&&"MAIN"==S.type&&A.XQ(S.id,S.Cf)}}}}function e(a){if(a){var b=(a.wb?p.COLOR_BUFFER_BIT:0)|(a.Bb?p.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case c.ge:a=
z;break;case c.cd:a=Q;break;case c.yf:a=L;break;case c.tf:case c.ui:case c.ln:a=H;break;case c.Cg:case c.Pp:case c.Ht:a=z;break;default:a=U.background_color}}else b=p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT,a=U.background_color;p.colorMask(!0,!0,!0,!0);p.depthMask(!0);p.clearColor(a[0],a[1],a[2],a[3]);p.clear(b)}function b(a){switch(a){case 0:return p.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return p.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return p.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return p.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return p.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return p.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function y(a){var b=k.oB(),c=a.dq,d=a.Ca,g=d.kd;a.Me.length=0;var e=1,f;for(f in g)e=Math.max(e,g[f].frames);for(g=0;g<e;g++){f=b.createVertexArray();P(f);d.hg&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,d.hg);for(var h=0;h<d.Md.length;h++){p.bindBuffer(p.ARRAY_BUFFER,d.Md[h].Yk);for(var q=0;q<c.length;q++){var m=c[q];m.wN==d.Md[h].type&&(p.enableVertexAttribArray(m.df),p.vertexAttribPointer(m.df,m.Jc,m.jv,m.jv==p.FLOAT?
!1:!0,m.Xm,m.YF+m.UH*g),x(m.df,m.Zq))}}P(null);a.Me.push(f)}}function r(a){var b=a.Zm,c=a.ZM,d=a.ds,g=a.YM,e=a.zC;c.length=0;d.length=0;g.length=0;e.length=0;for(var f in b){var k=!1,q=null,p=null;switch(f){case "u_proj_matrix":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.xb)};k=!0;break;case "u_view_refl_matrix":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Hx)};k=!0;break;case "u_view_tsr":case "u_view_tsr_frag":q=function(a,b,c,d){d.rc?a.uniformMatrix3fv(b,!1,d.qs):a.uniformMatrix3fv(b,!1,d.qf)};
k=!0;break;case "u_view_tsr_inverse":q=function(a,b,c,d){d.rc?a.uniformMatrix3fv(b,!1,d.Hw):a.uniformMatrix3fv(b,!1,d.Ix)};k=!0;break;case "u_shadow_cast_billboard_view_tsr":q=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.Es)};k=!0;break;case "u_view_proj_prev":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.GC)};k=!0;break;case "u_view_proj_matrix":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ld)};k=!0;break;case "u_view_proj_inverse":q=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Gx)};k=!0;break;case "u_sky_vp_inverse":q=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.vg)};k=!0;break;case "u_camera_eye":case "u_camera_eye_frag":q=function(a,b,c,d){a.uniform3fv(b,O.hc(d.n,da))};k=!0;break;case "u_camera_quat":q=function(a,b,c,d){a.uniform4fv(b,O.Xd(d.n,G))};k=!0;break;case "u_view_max_depth":q=function(a,b,c,d){a.uniform1f(b,d.far)};k=!0;break;case "u_camera_range":q=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":q=function(a,b,c,d){a.uniform4fv(b,d.yu)};break;case "u_height":q=function(a,
b,c,d){a.uniform1f(b,d.height)};k=!0;break;case "u_pcf_blur_radii":q=function(a,b,c,d){a.uniform4fv(b,d.vo)};break;case "u_dof_dist":q=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};k=!0;break;case "u_dof_front_start":q=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};k=!0;break;case "u_dof_front_end":q=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};k=!0;break;case "u_dof_rear_start":q=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};k=!0;break;case "u_dof_rear_end":q=
function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};k=!0;break;case "u_dof_bokeh_intensity":q=function(a,b,c,d){a.uniform1f(b,d.dof_bokeh_intensity)};k=!0;break;case "u_camera_direction":q=function(a,b,c,d){a.uniform3fv(b,d.direction)};k=!0;break;case "u_cam_water_depth":q=function(a,b,c){a.uniform1f(b,c.Oz)};k=!0;break;case "u_waves_height":q=function(a,b,c){a.uniform1f(b,c.pE)};break;case "u_waves_length":q=function(a,b,c){a.uniform1f(b,c.qE)};break;case "u_fog_color_density":q=function(a,b,c){a.uniform4fv(b,
c.Be)};break;case "u_fog_params":q=function(a,b,c){a.uniform4fv(b,c.dg)};break;case "u_underwater_fog_color_density":q=function(a,b,c){a.uniform4fv(b,c.ri)};break;case "u_bloom_key":q=function(a,b,c){a.uniform1f(b,c.du)};break;case "u_bloom_edge_lum":q=function(a,b,c){a.uniform1f(b,c.cu)};break;case "u_time":q=function(a,b,c){a.uniform1f(b,c.time)};k=!0;break;case "u_wind":q=function(a,b,c){a.uniform3fv(b,c.zj)};k=!0;break;case "u_sky_tex_dvar":q=function(a,b,c){a.uniform1f(b,c.gx)};break;case "u_sky_tex_fac":q=
function(a,b,c){a.uniform4fv(b,c.hx)};break;case "u_sky_tex_color":q=function(a,b,c){a.uniform3fv(b,c.fx)};break;case "u_horizon_color":q=function(a,b,c){a.uniform3fv(b,c.ke)};break;case "u_zenith_color":q=function(a,b,c){a.uniform3fv(b,c.te)};break;case "u_environment_energy":q=function(a,b,c){a.uniform1f(b,c.Sg)};break;case "u_sky_color":q=function(a,b,c){a.uniform3fv(b,c.Oo)};break;case "u_rayleigh_brightness":q=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":q=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":q=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":q=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":q=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":q=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":q=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":q=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":q=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":q=function(a,b,c){a.uniform4fv(b,c.Qr)};break;case "u_light_directions":q=function(a,b,c){a.uniform3fv(b,c.PB)};break;case "u_light_color_intensities":q=function(a,b,c){a.uniform4fv(b,c.Pr)};break;case "u_sun_quaternion":q=function(a,b,c){a.uniform4fv(b,c.DM)};break;case "u_sun_intensity":q=function(a,b,c){a.uniform3fv(b,c.CM)};
break;case "u_sun_direction":q=function(a,b,c){a.uniform3fv(b,c.HD)};break;case "u_debug_view_mode":q=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":q=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":q=function(a,b,c){a.uniform1f(b,c.xH)};break;case "u_subpixel_jitter":q=function(a,b,c){a.uniform2fv(b,c.cW)};k=!0;break;case "u_subsample_indices":q=function(a,b,c){a.uniform4fv(b,c.dW)};k=!0;break;case "u_radial_blur_step":q=
function(a,b,c){a.uniform1f(b,c.Gw)};break;case "u_god_rays_intensity":q=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":q=function(a,b,c){a.uniform1f(b,c.To)};break;case "u_ssao_blur_discard_value":q=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};k=!0;break;case "u_ssao_influence":q=function(a,b,c){a.uniform1f(b,c.So)};break;case "u_ssao_dist_factor":q=function(a,b,c){a.uniform1f(b,c.Ro)};break;case "u_texel_size":q=function(a,b,c){a.uniform2fv(b,
c.RD)};k=!0;break;case "u_normal_offset":q=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":q=function(a,b,c){a.uniform4fv(b,c.Bx)};k=!0;break;case "u_v_light_r":q=function(a,b,c){a.uniform4fv(b,c.Ax)};k=!0;break;case "u_v_light_tsr":q=function(a,b,c){a.uniformMatrix3fv(b,!1,c.kE)};k=!0;break;case "u_p_light_matrix0":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Hm[0])};k=!0;break;case "u_p_light_matrix1":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Hm[1])};k=!0;
break;case "u_p_light_matrix2":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Hm[2])};k=!0;break;case "u_p_light_matrix3":q=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Hm[3])};k=!0;break;case "u_outline_color":q=function(a,b,c){a.uniform3fv(b,c.hj)};break;case "u_draw_outline":q=function(a,b,c){a.uniform1f(b,c.LA)};k=!0;break;case "u_glow_mask_small_coeff":q=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};k=!0;break;case "u_glow_mask_large_coeff":q=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
k=!0;break;case "u_brightness":q=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":q=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":q=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":q=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":q=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":q=function(a,b,c){a.uniform4fv(b,c.Pl)};break;case "u_chromatic_aberration_coefs":q=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":q=function(a,b,c){a.uniform1f(b,c.hK)};k=!0;break;case "u_motion_blur_decay_threshold":q=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};k=!0;break;case "u_model_tsr":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};k=!0;break;case "u_model_tsr_inverse":p=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Qx)};k=!0;break;case "u_transb":p=function(a,b,c){a.uniform4fv(b,c.se)};k=!0;break;case "u_transa":p=function(a,b,c){a.uniform4fv(b,
c.Je)};k=!0;break;case "u_arm_rel_trans":p=function(a,b,c){a.uniform4fv(b,c.aq)};k=!0;break;case "u_arm_rel_quat":p=function(a,b,c){a.uniform4fv(b,c.$p)};k=!0;break;case "u_quat":p=function(a,b,c){a.uniform4fv(b,O.Xd(c.n,G))};k=!0;break;case "u_quatsb":p=function(a,b,c){a.uniform4fv(b,c.ne)};k=!0;break;case "u_quatsa":p=function(a,b,c){a.uniform4fv(b,c.Ge)};k=!0;break;case "u_frame_factor":p=function(a,b,c){a.uniform1f(b,c.Ye)};k=!0;break;case "au_center_pos":p=function(a,b,c){a.uniform3fv(b,c.sq)};
k=!0;break;case "au_wind_bending_amp":p=function(a,b,c){a.uniform1f(b,c.th)};k=!0;break;case "au_wind_bending_freq":p=function(a,b,c){a.uniform1f(b,c.uh)};k=!0;break;case "au_detail_bending_freq":p=function(a,b,c){a.uniform1f(b,c.Pg)};k=!0;break;case "au_detail_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Og)};k=!0;break;case "au_branch_bending_amp":p=function(a,b,c){a.uniform1f(b,c.Jg)};k=!0;break;case "u_node_values":p=function(a,b,c,d){a.uniform1fv(b,d.ej)};k=!0;break;case "u_node_rgbs":p=function(a,
b,c,d){a.uniform3fv(b,d.Ee)};k=!0;break;case "u_diffuse_color":p=function(a,b,c,d){a.uniform4fv(b,d.$f)};k=!0;break;case "u_diffuse_intensity":p=function(a,b,c,d){a.uniform1f(b,d.Ol)};k=!0;break;case "u_diffuse_params":p=function(a,b,c,d){a.uniform2fv(b,d.Td)};k=!0;break;case "u_emit":p=function(a,b,c,d){a.uniform1f(b,d.Vj)};k=!0;break;case "u_ambient":p=function(a,b,c,d){a.uniform1f(b,d.Ej)};k=!0;break;case "u_specular_color":p=function(a,b,c,d){a.uniform3fv(b,d.Um)};k=!0;break;case "u_specular_alpha":p=
function(a,b,c,d){a.uniform1f(b,d.Is)};k=!0;break;case "u_specular_params":p=function(a,b,c,d){a.uniform3fv(b,d.Nk)};k=!0;break;case "u_reflect_factor":p=function(a,b,c,d){a.uniform1f(b,d.zo)};k=!0;break;case "u_mirror_factor":p=function(a,b,c,d){a.uniform1f(b,d.Ur)};k=!0;break;case "u_grass_map_dim":p=function(a,b,c,d){a.uniform3fv(b,d.je)};k=!0;break;case "u_grass_size":p=function(a,b,c,d){a.uniform1f(b,d.yr)};k=!0;break;case "u_scale_threshold":p=function(a,b,c,d){a.uniform1f(b,d.lv)};k=!0;break;
case "u_cube_fog":p=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ye)};break;case "u_jitter_amp":p=function(a,b,c,d){a.uniform1f(b,d.Ov)};k=!0;break;case "u_jitter_freq":p=function(a,b,c,d){a.uniform1f(b,d.Pv)};k=!0;break;case "u_wireframe_edge_color":p=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":p=function(a,b,c,d){a.uniform1f(b,d.Aq)};k=!0;break;case "u_batch_debug_id_color":p=function(a,b,c,d){a.uniform1f(b,d.Cu)};k=!0;break;case "u_batch_debug_main_render_time":p=
function(a,b,c,d){a.uniform1f(b,d.Rq)};k=!0;break;case "u_refr_bump":p=function(a,b,c,d){a.uniform1f(b,d.Iw)};k=!0;break;case "u_line_width":p=function(a,b,c,d){a.uniform1f(b,d.Rv)};k=!0;break;case "u_lamp_light_positions":p=function(a,b,c,d){a.uniform3fv(b,d.io)};break;case "u_lamp_light_directions":p=function(a,b,c,d){a.uniform3fv(b,d.Nr)};break;case "u_lamp_light_color_intensities":p=function(a,b,c,d){a.uniform3fv(b,d.Mr)};break;case "u_halo_size":p=function(a,b,c,d){a.uniform1f(b,d.uv)};k=!0;
break;case "u_halo_hardness":p=function(a,b,c,d){a.uniform1f(b,d.rv)};k=!0;break;case "u_halo_rings_color":p=function(a,b,c,d){a.uniform3fv(b,d.tv)};k=!0;break;case "u_halo_lines_color":p=function(a,b,c,d){a.uniform3fv(b,d.sv)};k=!0;break;case "u_halo_stars_blend":p=function(a,b,c,d){a.uniform1f(b,d.vv)};k=!0;break;case "u_halo_stars_height":p=function(a,b,c,d){a.uniform1f(b,d.wv)};k=!0;break;case "u_fresnel_params":p=function(a,b,c,d){a.uniform4fv(b,d.Pi)};k=!0;break;case "u_texture_scale":p=function(a,
b,c,d){a.uniform3fv(b,d.li)};k=!0;break;case "u_parallax_scale":p=function(a,b,c,d){a.uniform1f(b,d.so)};k=!0;break;case "u_color_id":p=function(a,b,c){a.uniform3fv(b,c.Nj)};k=!0;break;case "u_line_points":p=function(a,b,c,d){a.uniform3fv(b,d.W6)};k=!0;break;case "u_diffuse_color_factor":p=function(a,b,c,d){a.uniform1f(b,d.Nl)};k=!0;break;case "u_alpha_factor":p=function(a,b,c,d){a.uniform1f(b,d.pl)};k=!0;break;case "u_specular_color_factor":p=function(a,b,c,d){a.uniform1f(b,d.Qo)};k=!0;break;case "u_normal_factor":p=
function(a,b,c,d){a.uniform1f(b,d.kw)};k=!0;break;case "u_normalmap0_scale":p=function(a,b,c,d){a.uniform2fv(b,d.fj[0])};k=!0;break;case "u_normalmap1_scale":p=function(a,b,c,d){a.uniform2fv(b,d.fj[1])};k=!0;break;case "u_normalmap2_scale":p=function(a,b,c,d){a.uniform2fv(b,d.fj[2])};k=!0;break;case "u_normalmap3_scale":p=function(a,b,c,d){a.uniform2fv(b,d.fj[3])};k=!0;break;case "u_foam_factor":p=function(a,b,c,d){a.uniform1f(b,d.Sn)};k=!0;break;case "u_foam_uv_freq":p=function(a,b,c,d){a.uniform2fv(b,
d.Tu)};k=!0;break;case "u_foam_mag":p=function(a,b,c,d){a.uniform2fv(b,d.Su)};k=!0;break;case "u_foam_scale":p=function(a,b,c,d){a.uniform2fv(b,d.gr)};k=!0;break;case "u_water_norm_uv_velocity":p=function(a,b,c,d){a.uniform1f(b,d.op)};k=!0;break;case "u_shallow_water_col":p=function(a,b,c,d){a.uniform3fv(b,d.Ho)};k=!0;break;case "u_shore_water_col":p=function(a,b,c,d){a.uniform3fv(b,d.Jo)};k=!0;break;case "u_water_shallow_col_fac":p=function(a,b,c,d){a.uniform1f(b,d.Io)};k=!0;break;case "u_water_shore_col_fac":p=
function(a,b,c,d){a.uniform1f(b,d.Ko)};k=!0;break;case "u_p_length":p=function(a,b,c,d){a.uniform1f(b,d.hb.QM)};k=!0;break;case "u_p_cyclic":p=function(a,b,c,d){a.uniform1i(b,d.hb.ze)};k=!0;break;case "u_p_max_lifetime":p=function(a,b,c,d){a.uniform1f(b,d.hb.WJ)};k=!0;break;case "u_p_fade_in":p=function(a,b,c,d){a.uniform1f(b,d.hb.Ul)};k=!0;break;case "u_p_fade_out":p=function(a,b,c,d){a.uniform1f(b,d.hb.Ff)};k=!0;break;case "u_p_size":p=function(a,b,c,d){a.uniform1f(b,d.hb.size)};k=!0;break;case "u_p_alpha_start":p=
function(a,b,c,d){a.uniform1f(b,d.hb.IF)};k=!0;break;case "u_p_alpha_end":p=function(a,b,c,d){a.uniform1f(b,d.hb.HF)};k=!0;break;case "u_p_nfactor":p=function(a,b,c,d){a.uniform1f(b,d.hb.nC)};k=!0;break;case "u_p_gravity":p=function(a,b,c,d){a.uniform1f(b,d.hb.kJ)};k=!0;break;case "u_p_mass":p=function(a,b,c,d){a.uniform1f(b,d.hb.Zh)};k=!0;break;case "u_p_color_ramp":p=function(a,b,c,d){a.uniform4fv(b,d.hb.TG)};k=!0;break;case "u_p_wind_fac":p=function(a,b,c,d){a.uniform1f(b,d.hb.IN)};k=!0;break;
case "u_p_time":p=function(a,b,c,d){a.uniform1f(b,d.hb.time)};k=!0;break;case "u_p_tilt":p=function(a,b,c,d){a.uniform1f(b,d.hb.OM)};k=!0;break;case "u_p_tilt_rand":p=function(a,b,c,d){a.uniform1f(b,d.hb.PM)};k=!0;break;case "u_position":p=function(a,b,c,d){a.uniform3fv(b,d.ql)};k=!0;break;case "u_va_frame_factor":p=function(a,b,c){a.uniform1f(b,c.Dx)};k=!0;break;case "u_refl_plane":p=function(a,b,c){a.uniform4fv(b,c.rc)};k=!0;break;case "u_outline_intensity":p=function(a,b,c){a.uniform1f(b,c.ih)};
k=!0;break;case "u_obj_info":p=function(a,b,c,d){a.uniform3fv(b,d.qo)},k=!0}p&&(p={name:f,Un:p,df:b[f]},k?c.push(p):d.push(p));q&&(p={name:f,Un:q,df:b[f]},k?g.push(p):e.push(p))}if(d.length||e.length){a=a.AC;for(var h in a)delete a[h];for(h=0;h<d.length;h++)p=d[h],a[p.name]=p;for(h=0;h<e.length;h++)p=e[h],a[p.name]=p}else a.iw=!0}var A=l("__batch"),h=l("__camera"),w=l("__config"),m=l("__debug"),k=l("__extensions"),f=l("__geometry"),v=l("__quat"),c=l("__subscene"),C=l("__textures"),O=l("__tsr"),J=
l("__util"),K=l("__version"),f=l("__geometry"),D=l("__vec3"),Q=[1,1,1,1],L=[1,1,1,1],H=[0,0,0,1],z=[0,0,0,0],d=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var p=null,M=null,x=null,g=null,P=null,t=null,da=new Float32Array(3),G=v.create(),F=new Uint8Array(4),U=w.B;a.Nf=function(a){var b=U.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);
a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);p=a};a.Nn=function(a){if(a.cc)if(a.type==c.tn){m.SC(a);var d=a.p;p.bindFramebuffer(p.READ_FRAMEBUFFER,d.kr);p.bindFramebuffer(p.DRAW_FRAMEBUFFER,d.Ze);var g=0;d.wc&&(g|=p.COLOR_BUFFER_BIT);d.Ve&&(g|=p.DEPTH_BUFFER_BIT);p.blitFramebuffer(0,0,d.width,d.height,0,0,d.width,d.height,g,p.NEAREST);m.TC(a);m.Rz("draw resolve")}else if(a.type==c.by)m.SC(a),d=a.p,p.bindFramebuffer(p.FRAMEBUFFER,
d.kr),p.bindTexture(p.TEXTURE_2D,d.wc.sb),p.copyTexSubImage2D(p.TEXTURE_2D,0,0,0,0,0,d.width,d.height,0),m.TC(a),m.Rz("draw copy");else{m.SC(a);d=a.p;p.bindFramebuffer(p.FRAMEBUFFER,d.Ze);a.wz&&(g=d.wc,p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,g.nb,g.sb,0));p.viewport(0,0,d.width,d.height);a.type!=c.md&&a.type!=c.Oe&&e(a);a.Lb?p.enable(p.BLEND):p.disable(p.BLEND);a.Sd?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST);switch(a.type){case c.cd:p.enable(p.POLYGON_OFFSET_FILL);p.polygonOffset(a.self_shadow_polygon_offset,
a.self_shadow_polygon_offset);p.cullFace(p.BACK);break;case c.Nd:case c.xf:p.disable(p.POLYGON_OFFSET_FILL);p.cullFace(p.FRONT);break;case c.wf:p.enable(p.POLYGON_OFFSET_FILL);p.polygonOffset(-4,-4);p.cullFace(p.BACK);break;case c.ge:if(1<U.Fc||U.lL){p.enable(p.POLYGON_OFFSET_FILL);p.polygonOffset(-2,-2);break}default:p.disable(p.POLYGON_OFFSET_FILL),p.cullFace(p.BACK)}if(a.type==c.md||a.type==c.Oe)for(var d=a.p,g=d.wc.sb,f=0;6>f;f++){var k=b(f);d.Ob=a.Ll[f];O.Qi(d.Ob,d.qf);h.Kz(d);p.framebufferTexture2D(p.FRAMEBUFFER,
p.COLOR_ATTACHMENT0,k,g,0);e(a);for(var k=a.Ra,t=0;t<k.length;t++)for(var l=0;l<k[t].sa.length;l++){var v=k[t].sa[l];v.cc=v.KA[f]}n(a)}else n(a);m.TC(a);m.Rz("draw subscene: "+c.GD(a))}};a.clear=function(a){p.bindFramebuffer(p.FRAMEBUFFER,a.p.Ze);e(a)};a.NQ=function(a){var b=a.dq;b.length=0;var c=a.Ca,d=c.kd,g=a.zb.attributes,e;for(e in g){var k=d[e],p=f.xr(e),q=f.gV(e),h=f.bJ(e);b.push({wN:p,jv:q,df:g[e],YF:k.offset*h,UH:1<k.frames?k.length*h:0,Jc:k.Jc,Xm:k.Xm*h,Zq:k.Zq})}if("DEBUG"==K.type())for(e in d)p=
f.xr(e),b=f.cY(c.Md,p),b=c.Md[b],k=a.ib.yg+" | "+a.ib.Xe,p=d[e].length*d[e].frames*f.bJ(e),m.iU(b.wT,k,e,p,e in g);U.oz&&y(a)};a.SQ=y;a.bS=function(a){for(var b=k.oB(),c=0;c<a.Me.length;c++)b.deleteVertexArray(a.Me[c]);a.Me.length=0};a.dS=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.RQ=r;a.UF=function(a){var b=a.zb,c=a.ya;a=a.Ld;p.useProgram(b.di);for(var d=0;d<c.length;d++)p.uniform1i(b.Zm[a[d]],d)};a.NC=function(a,b,c,d,g,e){d||(d=1);g||(g=1);e||(e=new Uint8Array(4*d*g));
e.length!=4*d*g&&J.q("read_pixels(): Wrong storage");p.bindFramebuffer(p.FRAMEBUFFER,a);p.readPixels(b,c,d,g,p.RGBA,p.UNSIGNED_BYTE,e);p.bindFramebuffer(p.FRAMEBUFFER,null);return e};a.$Z=function(a){var b=a.zb;b.iw||(p.useProgram(b.di),b.ds.length||r(b),b=b.AC.u_cube_fog,b.Un(p,b.df,null,a))};a.LX=function(a,b){var c=p.createFramebuffer();p.bindFramebuffer(p.FRAMEBUFFER,c);if(C.eo(a)){var d=a.Ne;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.RENDERBUFFER,d)}else if(C.fo(a)){var g=
a,d=g.sb,g=g.nb==p.TEXTURE_CUBE_MAP?p.TEXTURE_CUBE_MAP_NEGATIVE_Z:g.nb;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,g,d,0)}C.eo(b)?(d=b.Ne,p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,d)):C.fo(b)&&(g=b,d=g.sb,g=g.nb,p.framebufferTexture2D(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,g,d,0));m.HR();p.bindFramebuffer(p.FRAMEBUFFER,null);return c};a.KX=function(a,b,c,d,g){null==a?(p.bindFramebuffer(p.FRAMEBUFFER,a),p.viewport(0,0,d,g),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT)):
(C.eo(b)?p.deleteRenderbuffer(b.Ne):C.fo(b)&&p.deleteTexture(b.sb),C.eo(c)?p.deleteRenderbuffer(c.Ne):C.fo(c)&&p.deleteTexture(c.sb),p.deleteFramebuffer(a))};a.C6=function(){};a.IT=function(a,b,c,d,g,e){a=a.sb;p.viewport(0,0,c,c);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,b,a,0);b=A.qA("FLIP_CUBEMAP_COORDS");a=b.zb;p.activeTexture(p.TEXTURE0);p.bindTexture(p.TEXTURE_2D,g);var f=g=0;c!=d&&(g=1/(6*d),f=1/(4*d));p.uniform1i(a.Zm.u_tex_number,e);p.uniform2fv(a.Zm.u_delta,[g,f]);p.useProgram(a.di);
t(b,0);p.bindTexture(p.TEXTURE_2D,null)};a.JT=function(a,b,c,d,g){p.bindFramebuffer(p.FRAMEBUFFER,d);d=a.sb;a=a.nb;p.bindTexture(a,d);p.viewport(0,0,b,c);p.texImage2D(a,0,p.RGBA,b,c,0,p.RGBA,p.UNSIGNED_BYTE,null);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,a,d,0);b=A.qA("NONE");c=b.zb;p.activeTexture(p.TEXTURE0);p.bindTexture(a,g);p.useProgram(c.di);t(b,0);p.bindFramebuffer(p.FRAMEBUFFER,null);p.bindTexture(a,null)};a.ua=function(){};a.oY=function(){var a=k.jV(),b=k.oB();U.GF=a?!0:!1;
U.oz=b?!0:!1;a?(M=function(b,c,d,g){a.drawElementsInstanced(p.TRIANGLES,b,c,d,g)},x=function(b,c){a.vertexAttribDivisor(b,c)},g=function(b,c,d){a.drawArraysInstanced(p.TRIANGLES,b,c,d)}):(M=function(a,b,c){p.drawElements(p.TRIANGLES,a,b,c)},x=function(){},g=function(a,b){p.drawArrays(p.TRIANGLES,a,b)});b?(P=function(a){b.bindVertexArray(a)},t=function(a,b){var c=a.Ca;P(a.Me[b]);c.hg?M(c.count,c.km,0,c.om):g(0,c.count,c.om);P(null)}):t=function(a,b){for(var c=a.Ca,d=a.dq,e=0;e<c.Md.length;e++){p.bindBuffer(p.ARRAY_BUFFER,
c.Md[e].Yk);for(var f=0;f<d.length;f++){var k=d[f];k.wN==c.Md[e].type&&(p.enableVertexAttribArray(k.df),p.vertexAttribPointer(k.df,k.Jc,k.jv,k.jv==p.FLOAT?!1:!0,k.Xm,k.YF+k.UH*b),x(k.df,k.Zq))}}c.hg?(p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,c.hg),M(c.count,c.km,0,c.om)):g(0,c.count,c.om);for(e=0;e<d.length;e++)k=d[e],p.disableVertexAttribArray(k.df)}};a.reset=function(){P=g=x=M=p=null}};b4w.module.__camera=function(a,l){function n(a,b,c,d,g){ma.Wc(a,b);c&&D(a,b,c);H(a,d);z(a,g)}function e(a,b,c,d,e,f,k,q){var p=a.k;ma.Wc(a,b);p.pivot.set(c);D(a,b,c);H(a,d);z(a,e);x(a,f);g(a,k);p.use_panning=q}function b(a,b,c,g,e,f,k,q){var p=a.k;ma.Wc(a,b);p.Vb.set(c);D(a,b,c);M(a,g);d(a,e);P(a,f);t(a,k);p.Nh=q}function y(a,b,c){var d=a.k,g=N.G(d.n),e=N.P(d.n),d=Ba;d.set(ea.nc);d[3]=0;a=v(a,ja)[1];e=ea.lc(e,ea.Nc,ka);na.LL(Ra,g);na.lD(Ra,e);if(!ea.QB(d,-b,Ra,c)||Math.abs(a)<ua)wa.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),
c[0]=g[0],c[1]=0,c[2]=g[2];return c}function r(b){for(var c=b.k,d=0;d<b.I.length;d++){var g=b.I[d].da[0];if(g.type==a.we)switch(c.vb){case a.Kb:var e=N.G(c.n);c.ck=B.dist(e,c.pivot);c.dk=g.top;break;case a.bd:e=N.G(c.n),c.ck=B.dist(e,c.Vb),c.dk=g.top}}}function A(a){a={type:a,name:"",eM:1,width:0,height:0,Ze:null,kr:null,wc:null,Ve:null,Ab:0,Vd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,jd:za.create(),n:new Float32Array(9),Ob:new Float32Array(16),Hx:new Float32Array(16),xb:new Float32Array(16),
ld:new Float32Array(16),Gx:new Float32Array(16),GC:new Float32Array(16),vg:new Float32Array(16),direction:new Float32Array(3),qf:N.Hl(),Ix:N.Hl(),qs:N.Hl(),Hw:N.Hl(),Es:N.Hl(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,GH:!1,Cd:!1,dof_on:!1,Uv:new Float32Array(3),Ph:w(),Ok:0,mf:0,rc:null,Lh:null,Pq:null,yu:new Float32Array(4),vo:new Float32Array(4)};a.jd[0]=a.jd[2]=45;a.jd[1]=a.jd[3]=55;return a}function h(a,b){var c=
A(a.type);c.name=a.name;c.eM=a.eM;c.width=a.width;c.height=a.height;b||(c.Ze=a.Ze,c.kr=a.kr,c.wc=a.wc,c.Ve=a.Ve);c.Ab=a.Ab;c.Vd=a.Vd;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;za.copy(a.jd,c.jd);N.copy(a.n,c.n);Y.copy(a.Ob,c.Ob);Y.copy(a.xb,c.xb);Y.copy(a.ld,c.ld);Y.copy(a.Gx,c.Gx);Y.copy(a.GC,c.GC);Y.copy(a.vg,c.vg);N.copy(a.qf,c.qf);N.copy(a.Ix,c.Ix);N.copy(a.qs,c.qs);N.copy(a.Hw,c.Hw);N.copy(a.Es,c.Es);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;
c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.GH=a.GH;c.Cd=a.Cd;c.dof_on=a.dof_on;B.copy(a.Uv,c.Uv);var d=a.Ph,g=c.Ph;za.copy(d.left,g.left);za.copy(d.right,g.right);za.copy(d.top,g.top);za.copy(d.bottom,g.bottom);za.copy(d.near,g.near);za.copy(d.far,g.far);c.Ok=a.Ok;c.mf=a.mf;a.rc&&(c.rc=za.clone(a.rc));if(a.Lh){d=a.Lh.length;c.Lh=Array(d);for(g=0;g<d;g++)c.Lh[g]=
B.clone(a.Lh[g]);c.Pq=new Float32Array(a.Pq)}za.copy(a.yu,c.yu);za.copy(a.vo,c.vo);return c}function w(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function m(b){switch(b){case "STATIC":return a.Bg;case "TARGET":return a.Kb;case "EYE":return a.nd;case "HOVER":return a.bd;default:ea.q("Unknown move style")}}function k(b){var c=A(b);if(b==
a.pd)return c;switch(b){case a.Od:C(c,40,.1,1E3);break;case a.we:C(c,2.5,.1,1E3);break;case a.Ch:break;case a.Bh:break;case a.yi:break;case a.Qc:case a.dd:case a.Pe:case a.Qe:ea.q("Stereo camera may only be created from perspective one");break;default:ea.q("Unknown camera type")}return c}function f(b,c,d){b.type!=a.Qc&&b.type!=a.dd&&b.type!=a.Pe&&b.type!=a.Qe&&ea.q("set_stereo_params(): wrong camera type");if(b.type==a.Qc||b.type==a.dd)b.Ok=c;b.mf=d;ga(b,b.Ab);if(ha.Da()&&(c=ha.A(),b=c.s.ud))for(c=
ya.ka(ha.dm(c),c).da,d=0;d<c.length;d++)ia(c[d],b)}function v(a,b){return c(N.P(a.k.n),b)}function c(a,b){var c=ea.lc(a,ea.nc,ka),d=ea.lc(a,ea.wh,Pa),g=-Math.asin(c[2]/B.length(c)),c=Math.abs(g)>Math.PI/4?B.scale(d,-ea.sign(g),Ea):B.scale(c,-ea.sign(d[2]),Ea),e=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(g=ea.sign(g)*Math.PI-g);d=e;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=g;return b}function C(b,c,d,g,e){switch(b.type){case a.Od:case a.Qc:case a.dd:b.Vd=c;b.Ab=1;break;case a.we:b.top=
c;b.Ab=1;break;case a.Ch:b.Vd=c;b.Ab=e/c;break;case a.Bh:b.top=c;b.Ab=e/c;break;case a.Pe:case a.Qe:break;default:wa.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=g}function O(b,c){var d=N.hc(c.k.n,ka),g=N.Xd(c.k.n,Ca),e=Y.fromRotationTranslation(g,d,Ma);Y.invert(e,b.Ob);if(ha.Da())var e=ha.A(),f=ha.La(e,ta.xi);if(b.type==a.Qc||f&&f.enable_hmd_stereo&&b.type==a.Pe)b.Ob[12]+=b.mf/2;else if(b.type==a.dd||f&&f.enable_hmd_stereo&&b.type==a.Qe)b.Ob[12]-=b.mf/2;if(b.rc){N.Qi(b.Ob,
b.qs);N.invert(b.qs,b.Hw);var e=b.rc[0],f=b.rc[1],k=b.rc[2],q=b.rc[3],p=b.Hx;p[0]=1-2*e*e;p[1]=-2*e*f;p[2]=-2*e*k;p[3]=0;p[4]=-2*e*f;p[5]=1-2*f*f;p[6]=-2*f*k;p[7]=0;p[8]=-2*e*k;p[9]=-2*f*k;p[10]=1-2*k*k;p[11]=0;p[12]=-2*e*q;p[13]=-2*f*q;p[14]=-2*k*q;p[15]=1;Y.multiply(b.Ob,b.Hx,b.Ob);ga(b,b.Ab,!0);e=Ba;f=Ma;Y.invert(b.Ob,f);Y.transpose(f,f);za.transformMat4(b.rc,f,e);f=va;f[0]=(ea.sign(e[0])+b.xb[8])/b.xb[0];f[1]=(ea.sign(e[1])+b.xb[9])/b.xb[5];f[2]=-1;f[3]=(1+b.xb[10])/b.xb[14];za.scale(e,2/(e[0]*
f[0]+e[1]*f[1]+e[2]*f[2]+e[3]*f[3]),e);b.xb[2]=e[0];b.xb[6]=e[1];b.xb[10]=e[2]+1;b.xb[14]=e[3];B.transformMat4(d,b.Hx,d)}N.Qi(b.Ob,b.qf);N.invert(b.qf,b.Ix);E(b);ca(b);N.hi(d,1,g,b.n)}function J(b,c,d,g){Y.lookAt(c,d,g,b.Ob);d=ha.A();d=ha.La(d,ta.xi);ha.Da()&&(d=ha.A(),d=ha.La(d,ta.xi));if(b.type==a.Qc||d&&d.enable_hmd_stereo&&b.type==a.Pe)b.Ob[12]+=b.mf/2;else if(b.type==a.dd||d&&d.enable_hmd_stereo&&b.type==a.Qe)b.Ob[12]-=b.mf/2;N.Qi(b.Ob,b.qf);E(b);ca(b);N.kf(c,b.n)}function K(a,b,c){c=B.subtract(c,
b,ka);B.length(c)&&(B.normalize(c,c),c=ea.aD(ea.Nc,c,Ca),ma.gi(a,c));ma.Wc(a,b)}function D(a,b,c){var d=a.k,g=0>ea.lc(N.P(a.k.n),ea.xh,ka)[2];K(a,b,c);g?(b=B.copy(d.pf,ka),B.negate(b,b),sa.Qj(a,b,!0)):sa.Qj(a,d.pf,!0)}function Q(a,b){for(var c=a.k,d=b.da,g=N.Xd(c.n,Ca),g=ea.lc(g,ea.Nc,ka),e=N.hc(c.n,Pa),f=b.bM,k=0;k<f.length;k++){var q=f[k];B.copy(g,q.direction);N.hc(c.n,q.Uv)}for(k=0;k<d.length;k++)q=d[k],O(q,a),B.copy(g,q.direction),ea.Pn(q.ld,q.Ph),q.dof_object&&q.dof_on&&(c=ma.ie(q.dof_object,
Ea),c=B.dist(e,c),q.dof_distance=c)}function L(b){var c=b.k;c.vb==a.Kb&&(c.Rk=0>ea.lc(N.P(b.k.n),ea.xh,ka)[2])}function H(b,c){var d=b.k;if(c){d.mb=d.mb||{};d.mb.left=c.left;d.mb.right=c.right;d.mb.jo=c.left;d.mb.Do=c.right;d.mb.camera_space=Boolean(c.camera_space);var g=b.k;!(d=g.mb)||g.vb!=a.nd&&g.vb!=a.Kb||(g=v(b,ja),d.camera_space?(d.left+=g[0],d.right+=g[0]):(d.jo-=g[0],d.Do-=g[0]),d.left=ea.zi(d.left),d.right=ea.zi(d.right),d.jo=ea.zi(d.jo),d.Do=ea.zi(d.Do))}else d.mb=null}function z(a,b){var c=
a.k;b?(c.la=c.la||{},c.la.down=b.down,c.la.up=b.up,c.la.Mn=b.down,c.la.gp=b.up,c.la.camera_space=Boolean(b.camera_space),p(a)):c.la=null}function d(a,b){var c=a.k;if(!b){var d=v(a,ja);b={down:d[1],up:d[1]}}c.la=c.la||{};c.la.down=b.down;c.la.up=b.up;p(a);c.tb&&c.la&&u(a)}function p(b){var c=b.k,d=c.la;if(d)switch(c.vb){case a.nd:case a.Kb:b=v(b,ja);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.gp-=b[1],d.Mn-=b[1]);d.up=ea.Fg(d.up,-Math.PI,Math.PI);d.down=ea.Fg(d.down,-Math.PI,Math.PI);d.gp=ea.Fg(d.gp,
-Math.PI,Math.PI);d.Mn=ea.Fg(d.Mn,-Math.PI,Math.PI);break;case a.bd:d.up=ea.Fg(d.up,-Math.PI,Math.PI),d.down=ea.Fg(d.down,-Math.PI,Math.PI),d.up=ea.U(d.up,-Math.PI/2,0),d.down=ea.U(d.down,-Math.PI/2,0)}}function M(a,b){var c=a.k;if(!b){var d=ma.ro(a,c.Vb);b={min:d,max:d}}c.tb=c.tb||{};c.tb.min=b.min;c.tb.max=b.max;c.tb&&c.la&&u(a)}function x(a,b){var c=a.k;b?(c.tb=c.tb||{},c.tb.min=b.min,c.tb.max=b.max):c.tb=null}function g(a,b){var c=a.k;b?(c.ce=c.ce||{},c.ce.min_z=b.min_z,c.ce.max_z=b.max_z):c.ce=
null}function P(a,b){var c=a.k;b?(c.Bc=c.Bc||{},c.Bc.min=b.min,c.Bc.max=b.max):c.Bc=null}function t(a,b){var c=a.k;b?(c.Cc=c.Cc||{},c.Cc.min=b.min,c.Cc.max=b.max):c.Cc=null}function da(b){var c=b.k;if(ya.xa(b))for(var d=b.I,g=0;g<d.length;g++){var e=d[g].da;if(e[0].type===a.we){switch(c.vb){case a.Kb:var f=N.G(c.n),f=B.dist(f,c.pivot),f=f/c.ck*c.dk;break;case a.bd:f=N.G(c.n);f=B.distance(f,c.Vb);f=f/c.ck*c.dk;break;default:f=e[0].top}for(var k=0;k<e.length;k++){var q=e[k];q.top=f;ga(q,q.Ab)}Q(b,d[g])}}}
function G(b){var c=b.k,d=c.vb;if(d===a.Kb||d===a.nd){if(c.mb){var g=c.mb.left,e=c.mb.right,f=v(b,ja);(f=d==a.Kb?ea.Bl(f[0],g,e):ea.Bl(f[0],e,g))&&(d==a.Kb?U(b,f,0):F(b,f,0))}c.la&&(g=c.la.down,e=c.la.up,f=v(b,ja),(f=d==a.Kb?ea.Bl(f[1],e,g):ea.Bl(f[1],g,e))&&(d==a.Kb?U(b,0,f):F(b,0,f)));if(d===a.Kb&&c.tb){var f=b.k,g=N.G(f.n),e=B.subtract(g,f.pivot,ka),k=B.length(e);k>f.tb.max?(B.scale(e,f.tb.max/k,e),B.add(f.pivot,e,g)):k<f.tb.min&&(k=ea.lc(N.P(f.n),ea.Nc,Pa),B.scale(k,100*f.tb.min,k),B.add(e,k,
e),B.scale(e,-f.tb.min/B.length(e),e),B.add(f.pivot,e,g))}}d===a.Kb&&c.ce&&(c=b.k,f=c.pivot[2],g=ea.U(c.pivot[2],c.ce.min_z,c.ce.max_z),g!=f&&(f=B.set(0,0,g-f,ka),B.add(c.pivot,f,c.pivot),c=N.G(c.n),B.add(c,f,c)));d===a.bd&&(d=b.k,d.Bc&&(f=ea.U(d.Vb[0],d.Bc.min,d.Bc.max)-d.Vb[0],d.Vb[0]+=f,c=N.G(d.n),c[0]+=f),d.Cc&&(f=ea.U(d.Vb[1],d.Cc.min,d.Cc.max)-d.Vb[1],d.Vb[1]+=f,c=N.G(d.n),c[1]+=f),d=b.k,c=v(b,ja)[1],(d=ea.Bl(c,d.la.up,d.la.down))&&R(b,0,d))}function F(a,b,c,d,g){var e=a.k,f=b,k=c;if(d||g)a=
v(a,xa),d&&(f=b-a[0]),g&&(k=c-a[1]);if(f||k)b=la.identity(Ca),f&&(f=la.setAxisAngle(e.pf,f,pa),la.multiply(b,f,b)),e=N.P(e.n),k&&(f=ea.lc(e,ea.ti,ka),k=la.setAxisAngle(f,k,pa),la.normalize(k,k),la.multiply(b,k,b)),la.multiply(b,e,e)}function U(a,b,c,d,g){var e=a.k,f=b,k=c;if(d||g){var q=v(a,xa);d&&(f=b-q[0]);g&&(k=c-q[1])}Z(a,a.k.pivot,f,k);a=v(a,xa);a=ea.Fg(a[1],-Math.PI,Math.PI);e.Rk=Math.abs(a)>Math.PI/2}function R(a,b,c,d,g){var e=a.k,f=b,k=c;if(d||g){var q=v(a,xa);d&&(f=b-q[0]);g&&(k=c-q[1])}e.Nh||
(f=0);Z(a,e.Vb,f,k);k&&u(a)}function Z(a,b,c,d){var g=a.k;if(c||d){a=la.identity(Ca);c&&(c=la.setAxisAngle(ea.nc,c,pa),la.multiply(a,c,a));c=N.P(g.n);if(d){var e=ea.lc(c,ea.ti,ka);d=la.setAxisAngle(e,d,pa);la.normalize(d,d);la.multiply(a,d,a)}d=N.G(g.n);ea.YX(d,b,a,d);la.multiply(a,c,c)}}function u(a){var b=a.k,c=v(a,ja)[1],d=a.k;a=d.la;d=d.tb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=N.G(b.n);d=ea.lc(N.P(b.n),ea.Nc,ka);B.normalize(d,d);B.scale(d,c,d);
B.subtract(b.Vb,d,a)}function ga(b,c,d){switch(b.type){case a.Od:c||ea.q("No aspect ratio"),b.Ab=c;case a.Ch:Y.perspective(ea.Cb(b.Vd),b.Ab,b.near,b.far,b.xb);break;case a.we:c||ea.q("No aspect ratio"),b.Ab=c;case a.Bh:c=b.top*b.Ab;Y.ortho(-c,c,-b.top,b.top,b.near,b.far,b.xb);break;case a.yi:Y.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb);break;case a.Qc:case a.dd:c||ea.q("No aspect ratio");b.Ab=c;var g=Math.tan(b.Vd*Math.PI/360);c=b.near*g;var e=b.Ab*b.Ok*g;b.type==a.Qc?(g=e-b.mf/2,e+=b.mf/
2):(g=e+b.mf/2,e-=b.mf/2);g=-(b.near/b.Ok*g);e*=b.near/b.Ok;Y.frustum(g,e,-c,c,b.near,b.far,b.xb);b.left=g;b.right=e;break;case a.Pe:case a.Qe:if(ha.Da())if(g=ha.A(),(g=ha.La(g,ta.xi))&&g.enable_hmd_stereo){c=Math.tan(ea.Cb(b.jd[0]));var g=Math.tan(ea.Cb(b.jd[1])),e=Math.tan(ea.Cb(b.jd[2])),f=Math.tan(ea.Cb(b.jd[3]));b.top=b.near*c;b.right=b.near*g;b.bottom=-b.near*e;b.left=-b.near*f;Y.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.xb)}else c||(c=b.Ab),Y.perspective(ea.Cb(b.Vd),c,b.near,b.far,
b.xb);break;case a.pd:return;default:ea.q("Wrong camera type: "+b.type)}d||(E(b),ca(b))}function ca(a){Y.copy(a.Ob,a.vg);a.vg[12]=0;a.vg[13]=0;a.vg[14]=0;a.vg[15]=1;Y.multiply(a.xb,a.vg,a.vg);Y.invert(a.vg,a.vg)}function E(a){Y.copy(a.Ob,a.ld);Y.multiply(a.xb,a.ld,a.ld);Y.invert(a.ld,a.Gx)}function aa(b,c,d,g,e){g||(g=new Float32Array(24));c||(c=b.near);d||(d=b.far);var f,k,q,p,h,u,m,B;switch(b.type){case a.pd:ea.q("Extraction from NONE camera is not possible");break;case a.Od:case a.Ch:f=c*Math.tan(b.Vd*
Math.PI/360);p=-f;k=f*b.Ab;q=-k;h=d/c*f;B=-h;u=h*b.Ab;m=-u;break;case a.we:case a.Bh:q=b.top*b.Ab;f=h=b.top;k=u=q;p=B=-b.top;q=m=-q;break;case a.yi:f=h=b.top;k=u=b.right;p=B=b.bottom;q=m=b.left;break;case a.Qc:case a.dd:h=c/b.near;f=c*Math.tan(b.Vd*Math.PI/360);p=-f;k=b.right*h;q=b.left*h;m=d/c;h=f*m;B=-h;u=k*m;m*=q;break;case a.Pe:case a.Qe:h=c/b.near;f=b.top*h;p=b.bottom*h;k=b.right*h;q=b.left*h;m=d/c;h=f*m;B=p*m;u=k*m;m*=q;break;default:ea.q("Wrong camera type: "+b.type)}g[0]=q;g[1]=p;g[2]=-c;
g[3]=k;g[4]=p;g[5]=-c;g[6]=k;g[7]=f;g[8]=-c;g[9]=q;g[10]=f;g[11]=-c;g[12]=m;g[13]=B;g[14]=-d;g[15]=m;g[16]=h;g[17]=-d;g[18]=u;g[19]=h;g[20]=-d;g[21]=u;g[22]=B;g[23]=-d;e&&(c=Ma,Y.invert(b.Ob,c),ea.xo(g,c,g,0));return g}function ia(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Lh){var d=b.csm_num;a.Lh=Array(d);for(var g=0;g<d;g++)a.Lh[g]=new Float32Array(3);a.Pq=new Float32Array(d)}for(d=0;d<c;d++){var g=0==d?a.near:q(b,a,d-1),e=q(b,a,d),g=aa(a,g,e,Ga),g=S.dV(g);a.Lh[d].set(g.F);a.Pq[d]=g.Ya;a.yu[d]=
B.length(g.F);a.vo[d]=T(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.vo[0]=b.first_cascade_blur_radius}function q(a,b,c){var d=a.csm_num,g=ea.U(a.csm_first_cascade_border,b.near,b.far);a=ea.U(a.csm_last_cascade_border,b.near,b.far);return ea.U(T(g,a,d,c),b.near,b.far)}function T(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function ba(a,b){b||(b=new Float32Array(3));B.copy(N.G(a.k.n),b);return b}var S=l("__boundings");
l("__config");var sa=l("__constraints"),oa=l("__container"),Y=l("__mat4"),na=l("__math"),ya=l("__obj_util"),wa=l("__print"),la=l("__quat"),ha=l("__scenes"),ta=l("__subscene"),ma=l("__transform"),N=l("__tsr"),ea=l("__util"),B=l("__vec3"),za=l("__vec4");a.pd=10;a.Od=20;a.we=30;a.Ch=40;a.Bh=50;a.yi=60;a.Qc=70;a.dd=80;a.Pe=90;a.Qe=100;a.Bg=0;a.Kb=2;a.nd=3;a.bd=4;var ua=ea.Cb(.5),ja=new Float32Array(2),xa=new Float32Array(2),ka=new Float32Array(3),Pa=new Float32Array(3),Ea=new Float32Array(3),Ca=new Float32Array(4),
pa=new Float32Array(4),Ba=new Float32Array(4),va=new Float32Array(4),Ma=new Float32Array(16),Ga=new Float32Array(24),Ra=new Float32Array(6);a.zR=function(c,d){var g=d.k,f=c.data;switch(f.type){case "PERSP":var q=k(a.Od);if(f.angle_y)var p=ea.oe(f.angle_y);C(q,p,f.clip_start,f.clip_end);break;case "ORTHO":q=k(a.we),C(q,f.ortho_scale/2,f.clip_start,f.clip_end)}q.name=d.name;p=d.I;p[0].da.push(q);for(var u=1;u<p.length;u++){var B=h(q,!1);p[u].da.push(B)}g.vb=m(f.b4w_move_style);g.dof_distance=f.dof_distance;
q=f.dof_object;g.dof_object=q?q.pb:null;g.dof_front_start=f.b4w_dof_front_start;g.dof_front_end=f.b4w_dof_front_end;g.dof_rear_start=f.b4w_dof_rear_start;g.dof_rear_end=f.b4w_dof_rear_end;g.dof_power=f.b4w_dof_power;g.dof_bokeh=f.b4w_dof_bokeh;g.dof_bokeh_intensity=f.b4w_dof_bokeh_intensity;g.Cd=f.b4w_dof_foreground_blur;g.$k=f.b4w_trans_velocity;g.Zk=f.b4w_rot_velocity;g.al=f.b4w_zoom_velocity;q=d.k.vb;p=c.data;u=null;q!=a.Kb&&q!=a.nd||!p.b4w_use_horizontal_clamping||(u={left:p.b4w_rotation_left_limit,
right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},q==a.nd&&(u.left*=-1,u.right*=-1));q=u;p=d.k.vb;u=c.data;B=null;p!=a.Kb&&p!=a.nd||!u.b4w_use_vertical_clamping?p==a.bd&&u.b4w_use_zooming&&(u.b4w_hover_angle_min<=u.b4w_hover_angle_max?(B={down:u.b4w_hover_angle_min,up:u.b4w_hover_angle_max},B.down*=-1,B.up*=-1):wa.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(B={down:u.b4w_rotation_down_limit,up:u.b4w_rotation_up_limit,camera_space:"LOCAL"==
u.b4w_vertical_clamping_type},p==a.Kb&&(B.down*=-1,B.up*=-1));var p=B,u=d.k.vb,B=c.data,t=null;u==a.Kb&&B.b4w_use_target_distance_limits&&B.b4w_distance_min<=B.b4w_distance_max?t={min:B.b4w_distance_min,max:B.b4w_distance_max}:u===a.bd&&B.b4w_use_zooming&&(B.b4w_distance_min<=B.b4w_distance_max?t={min:B.b4w_distance_min,max:B.b4w_distance_max}:wa.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));u=t;B=c.data;t=null;d.k.vb==a.bd&&B.b4w_use_horizontal_clamping&&B.b4w_horizontal_translation_min<=
B.b4w_horizontal_translation_max&&(t={min:B.b4w_horizontal_translation_min,max:B.b4w_horizontal_translation_max});var B=t,t=c.data,l=null;d.k.vb==a.bd&&t.b4w_use_vertical_clamping&&t.b4w_vertical_translation_min<=t.b4w_vertical_translation_max&&(l={min:t.b4w_vertical_translation_min,max:t.b4w_vertical_translation_max});var t=l,l=c.data,E=null;d.k.vb==a.Kb&&l.b4w_use_pivot_limits&&(E={min_z:l.b4w_pivot_z_min,max_z:l.b4w_pivot_z_max});l=E;switch(g.vb){case a.nd:g=N.G(d.k.n);n(d,g,null,q,p);break;case a.Kb:g=
N.G(d.k.n);e(d,g,f.b4w_target,q,p,u,l,f.b4w_use_panning);break;case a.bd:g=N.G(d.k.n),q=y(d,c.data.b4w_hover_zero_level,Pa),b(d,g,q,u,p,B,t,f.b4w_enable_hover_hor_rotation)}G(d);r(d)};a.SY=n;a.YL=e;a.XL=b;a.ao=r;a.Hc=h;a.vS=w;a.h7=m;a.gd=k;a.M2=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.wc);case "DEPTH":return Boolean(a.Ve);case "SCREEN":return!Boolean(a.wc)&&!Boolean(a.Ve);default:ea.q("Wrong attachment type: "+b)}};a.Qw=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.wc=
c;break;case "DEPTH":a.Ve=c;break;case "SCREEN":a.wc=null;a.Ve=null;break;default:ea.q("Wrong attachment type: "+b)}};a.s4=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.wc;case "DEPTH":return a.Ve;case "SCREEN":return null;default:ea.q("Wrong attachment type: "+b)}};a.Xv=function(b,c){(b.type!=a.Od||c!=a.Qc&&c!=a.dd&&c!=a.Pe&&c!=a.Qe)&&ea.q("make_stereo(): wrong camera type");b.type=c;f(b,6,.065)};a.GY=f;a.em=v;a.dB=c;a.fm=function(a,b){v(a,b);b[0]=ea.zi(b[0]+Math.PI);b[1]*=-1;return b};
a.Sw=C;a.sY=function(b,c,d,g,e,f,k){switch(b.type){case a.yi:b.left=c;b.right=d;b.bottom=g;b.top=e;b.near=f;b.far=k;break;default:wa.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.im=function(a){return a.k.vb};a.OY=O;a.U8=J;a.sD=function(a,b,c){var d=ka;d[0]=0;d[1]=0;d[2]=-1;B.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var g=Pa;g[0]=0;g[1]=1;g[2]=0;B.transformQuat(g,c,g);J(a,b,d,g)};a.jD=K;a.zY=D;a.h_=Q;a.g_=function(b){var c=b.k;G(b);da(b);switch(c.vb){case a.Kb:var d=
N.G(c.n);sa.ZX(d,N.P(c.n),c.pivot);for(var g=0;g<b.I.length;g++)for(var e=b.I[g].da,k=0;k<e.length;k++){var q=e[k];q.type!=a.Qc&&q.type!=a.dd||f(q,B.dist(d,c.pivot),q.mf)}sa.Qj(b,c.pf);break;case a.nd:b.pc||sa.Qj(b,c.pf)}L(b)};a.fE=L;a.HL=H;a.TL=z;a.zv=d;a.yv=M;a.nY=x;a.DY=g;a.tY=P;a.NY=t;a.q_=da;a.us=F;a.Kw=U;a.vs=R;a.I6=function(b){switch(b.type){case a.Od:case a.we:case a.Qc:case a.dd:return!0;default:return!1}};a.hI=function(b){switch(b.type){case a.Od:case a.Ch:case a.Qc:case a.dd:return ea.Cb(b.Vd);
default:return wa.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.Ik=ga;a.hY=function(b,c,d,g,e){var f=1/Math.max(e,g);switch(b.type){case a.Od:case a.Ch:e/=2;g/=2;d=-(d-e)/e*Math.tan(ea.Cb(b.Vd)/2);c=(c-g)/g*Math.tan(ea.Cb(b.Vd)/2)*b.Ab;g=b.near*(d+f);e=b.near*(c+f);d=b.near*(d-f);c=b.near*(c-f);Y.frustum(c,e,d,g,b.near,b.far,b.xb);break;case a.we:case a.Bh:b.right=b.top*b.Ab;d=-d/e;c/=g;g=b.top+(d+f)*(b.top+b.top);e=-b.right+(c+f)*(b.right+b.right);d=b.top+(d-f)*(b.top+b.top);
c=-b.right+(c-f)*(b.right+b.right);Y.ortho(c,e,d,g,b.near,b.far,b.xb);break;case a.yi:d=-d/e,c/=g,g=b.top+(d+f)*(b.top-b.bottom),e=b.left+(c+f)*(b.right-b.left),d=b.top+(d-f)*(b.top-b.bottom),c=b.left+(c-f)*(b.right-b.left),Y.ortho(c,e,d,g,b.near,b.far,b.xb)}Y.copy(b.Ob,b.ld);Y.multiply(b.xb,b.ld,b.ld);ea.Pn(b.ld,b.Ph)};a.Kz=ca;a.sG=E;a.$T=aa;a.OQ=function(a){a=a.k;var b=S.Qd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.R=b;var c=S.Hz(1,ea.Ef([0,0,0]));a.wa=c;a.eq=S.bG(1,b);
a.gq=S.dG(1,b);a.fq=S.cG(1,b)};a.um=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.Bg};a.Aa=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.Kb};a.ic=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.nd};a.$a=function(b){return ya.xa(b)&&b.k&&b.k.vb==a.bd};a.Lv=function(b){return ya.xa(b)&&b.k&&b.I[0].da[0].type==a.we};a.eE=ia;a.pT=q;a.HC=function(b,c,d){b=b.I[0].da[0];switch(b.type){case a.Od:case a.Ch:case a.we:case a.Bh:case a.Qc:case a.dd:case a.Pe:case a.Qe:var g=Ba;g.set(c);g[3]=1;za.transformMat4(g,b.ld,
g);c=-g[1]/g[3];d[0]=(g[0]/g[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;oa.S_(d[0],d[1],d,b);2<d.length&&(d[2]=(g[2]/Math.abs(g[3])+1)/2);return d;default:return wa.error("Non-compatible camera"),d}};a.XU=function(a){return a.I[0].da[0]};a.Wn=function(b,c){switch(b.type){case a.Od:case a.Ch:case a.Qc:case a.dd:var d=Math.tan(ea.Cb(b.Vd)/2);switch(c){case "LEFT":return-d*b.Ab;case "RIGHT":return d*b.Ab;case "TOP":return d;case "BOTTOM":return-d}break;case a.we:case a.Bh:switch(c){case "LEFT":return-b.top*
b.Ab;case "RIGHT":return b.top*b.Ab;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.yi:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Pe:case a.Qe:switch(c){case "LEFT":return-Math.tan(ea.Cb(Math.min(b.jd[1],b.jd[3])));case "RIGHT":return Math.tan(ea.Cb(Math.min(b.jd[1],b.jd[3])));case "TOP":return Math.tan(ea.Cb(Math.min(b.jd[0],b.jd[2])));case "BOTTOM":return-Math.tan(ea.Cb(Math.min(b.jd[0],b.jd[2])))}break;
default:ea.q("Unknown camera type")}};a.$V=function(b){switch(b.type){case a.we:case a.Bh:case a.yi:return!0;default:return!1}};a.bV=function(b,c){switch(b.type){case a.Od:case a.Ch:case a.Qc:case a.dd:var d=ea.Cb(b.Vd);return c?d*b.Ab:d;default:return 0}};a.Cs=function(a,b,c){a=a.k;N.kf(b,a.n);B.copy(c,a.pivot)};a.Uw=function(a,b){var c=a.k,d=B.subtract(b,c.Vb,ka),d=B.add(d,N.G(c.n),d);ma.Wc(a,d);B.copy(b,c.Vb)};a.HY=function(a,b){var c=a.k,d=B.subtract(b,c.pivot,ka),d=B.add(d,N.G(c.n),d);ma.Wc(a,
d);B.copy(b,c.pivot)};a.wI=ba;a.kD=function(c,d){c.k.vb=d;c.k.mb=null;c.k.la=null;c.k.tb=null;c.k.Bc=null;c.k.Cc=null;r(c);switch(d){case a.bd:var g=N.G(c.k.n),e=y(c,0,Pa);b(c,g,e,null,null,null,null,c.k.Nh);break;case a.Kb:g=ba(c,ka),e=ea.lc(N.P(c.k.n),ea.Nc,Pa),e=B.scaleAndAdd(g,e,10,e),B.copy(e,c.k.pivot)}};a.gt=function(a){a=a.k;a.vb=0;B.set(0,0,0,a.pivot);B.set(0,0,0,a.Vb);a.Rk=!1;a.use_panning=!1;a.mb=null;a.la=null;a.tb=null;a.Bc=null;a.Cc=null;a.ce=null;a.Nh=!0};a.eD=function(a,b){for(var c=
0;c<a.length;c++){var d=a[c];70!=d.type&&80!=d.type&&90!=d.type&&100!=d.type||f(d,d.Ok,b)}};a.iD=function(a,b,c){var d=ha.A();a=ya.ka(a,d).da;for(d=0;d<a.length;d++){var g=a[d];if(90==g.type||100==g.type)90==g.type&&za.copy(b,g.jd),100==g.type&&za.copy(c,g.jd),g.rc||ga(g),E(g),ca(g)}}};b4w.module.__constraints=function(a,l){function n(a){var b={};b.type=a;return b}function e(a,c){a.pc&&a.pc.Fa&&b(a.pc.Fa,a);if(c.Fa){var d=c.Fa;-1==d.Te.indexOf(a)?d.Te.push(a):C.q("Descendant object override is forbidden")}a.pc=c}function b(a,b){var c=a.Te.indexOf(b);-1!=c?a.Te.splice(c,1):C.q("No descendant object")}function y(a,b,e){switch(b.type){case 1:var f=c.P(a.k.n),n=b.Fa.k.n;e=c.P(b.Fa.k.n);b.pe?(v.copy(b.pe,f),v.multiply(e,f,f)):v.copy(e,f);var l=c.Xc(b.offset,n,D);c.kf(l,a.k.n);c.Mf(b.ws*
c.Yd(b.Fa.k.n),a.k.n);break;case 9:l=c.G(a.k.n);f=c.P(a.k.n);n=b.Fa.k.n;e=c.P(b.Fa.k.n);v.multiply(v.invert(b.Im,b.Im),f,f);v.multiply(e,f,f);c.Xc(b.offset,n,l);v.copy(e,b.Im);break;case 10:l=c.G(a.k.n);f=c.P(a.k.n);n=b.Fa.k.n;e=c.P(b.Fa.k.n);v.multiply(v.invert(b.Im,b.Im),f,f);v.multiply(e,f,f);c.Xc(b.offset,n,l);v.copy(e,b.Im);l=c.P(a.k.n);f=v.multiply(c.P(b.Fa.k.n),b.pe,z);f=m.dB(f,J);l=m.dB(l,K);m.us(a,C.Bl(l[0],f[0]+b.XR,f[0]+b.WR),C.Bl(l[1],f[1]+b.VR,f[1]+b.YR));break;case 13:var l=c.G(a.k.n),
f=c.P(a.k.n),n=b.Fa.k.n,r=c.G(n),H=b.bZ,y=D,u=z;c.Xc(b.offset,n,y);C.jx(y,l,e,H,l);n=D;O.sub(r,l,n);O.normalize(n,n);var ga=f,l=d,r=l.subarray(0,3),y=l.subarray(3,6),ca=l.subarray(6,9);O.copy(n,ca);O.negate(ca,ca);O.normalize(ca,ca);Boolean(.999999<Math.abs(O.dot(n,C.nc)))?(n=k.fromQuat(v.normalize(ga,u),p),O.copy(n.subarray(0,3),r)):O.cross(C.nc,ca,r);O.normalize(r,r);O.cross(ca,r,y);O.normalize(y,y);v.fromMat3(l,u);v.normalize(u,u);C.mM(u,f,e,.16*H,f);break;case 2:f=c.P(a.k.n);e=M;w.Zu(b.Fa,b.zl,
!0,e);c.multiply(b.Fa.k.n,e,e);f[0]=e[4];f[1]=e[5];f[2]=e[6];f[3]=e[7];b.pe&&(v.copy(b.pe,f),v.multiply(f,b.pe,f));c.Mf(b.ws*e[3],a.k.n);l=c.G(a.k.n);c.Xc(b.offset,e,l);break;case 3:l=c.G(a.k.n);f=c.P(a.k.n);e=c.G(b.Fa.k.n);A(l,f,e);break;case 4:l=c.G(a.k.n);f=c.P(a.k.n);e=b.target;A(l,f,e);break;case 5:l=c.G(a.k.n);f=c.P(a.k.n);e=c.G(b.Fa.k.n);A(l,f,e);f=O.dist(l,e);if(f=f>b.Qg?f-b.Qg:f<b.Wq?f-b.Wq:0)O.sub(e,l,D),O.normalize(D,D),O.scale(D,f,D),O.add(l,D,l);break;case 6:l=c.G(a.k.n);f=c.P(a.k.n);
e=b.target;A(l,f,e);f=O.dist(l,e);if(f=f>b.Qg?f-b.Qg:f<b.Wq?f-b.Wq:0)O.sub(e,l,D),O.normalize(D,D),O.scale(D,f,D),O.add(l,D,l);break;case 7:n=b.Fa.k.n;l=c.G(a.k.n);c.Xc(b.offset,n,l);break;case 8:r=c.G(b.Fa.k.n);l=c.G(a.k.n);O.add(r,b.offset,l);break;case 14:f=c.P(a.k.n);n=b.Fa.k.n;e=c.P(b.Fa.k.n);b.pe?(v.copy(b.pe,f),v.multiply(e,f,f)):v.copy(e,f);l=c.G(a.k.n);c.Xc(b.offset,n,l);break;case 11:c.multiply(b.Fa.k.n,b.wx,a.k.n);break;case 12:l=b.wx;e=M;w.Zu(b.Fa,b.zl,!0,e);c.multiply(b.Fa.k.n,e,e);c.multiply(e,
l,a.k.n);break;case 15:f=b.Fa,e=m.XU(f),l=c.G(a.k.n),n=m.Wn(e,"LEFT"),r=m.Wn(e,"RIGHT"),H=m.Wn(e,"TOP"),u=m.Wn(e,"BOTTOM"),y="heights"==b.hor_units?H-u:r-n,b.VJ?(n=m.Wn(e,"LEFT"),l[0]=n+y*b.NB):(r=m.Wn(e,"RIGHT"),l[0]=r-y*b.NB),n="heights"==b.vert_units?H-u:r-n,l[1]=b.TM?H-n*b.TD:u+n*b.TD,m.$V(e)?l[2]=-b.distance:(l[2]=-1,O.normalize(l,l),O.scale(l,b.distance/Math.abs(l[2]),l)),c.wd(l,f.k.n,l),O.add(c.G(f.k.n),l,l),l=c.P(a.k.n),f=c.P(f.k.n),b.pe?(v.copy(b.pe,l),v.multiply(f,l,l)):v.copy(f,l)}"CAMERA"==
a.k.type&&(l=a.k.pf,10==b.type&&(e=c.P(b.Fa.k.n),l=O.transformQuat(l,e,x)),m.fE(a),h(a,l))}function r(a,b){switch(b.type){case 1:var d=b.target.k.n,f=M;c.invert(a.k.n,f);c.multiply(f,d,f);w.gY(a,b.zl,f)}a.mC=!0}function A(a,b,c){var d=D;C.lc(b,C.Nc,d);O.normalize(d,d);var f=Q;O.subtract(c,a,f);O.normalize(f,f);a=C.aD(d,f,H);v.multiply(a,b,b);v.normalize(b,b)}function h(a,b,d){var f=a.k,e=c.P(f.n),k=C.lc(e,C.nc,D);O.normalize(k,k);if(.999999<Math.abs(O.dot(b,k)))k=v.identity(z);else{var p=O.cross(b,
k,Q);O.normalize(p,p);f.vb==m.Kb?f.Rk&&O.negate(p,p):(f=C.lc(e,C.wh,L),0<O.dot(f,b)&&O.negate(p,p));f=C.lc(e,C.ti,L);O.normalize(f,f);var h=C.U(O.dot(f,p),-1,1),k=-.999999>=h?v.setAxisAngle(k,Math.acos(h),z):v.rotationTo(f,p,z);v.normalize(k,k)}v.multiply(k,e,e);d&&(d=C.lc(e,C.xh,D),0>O.dot(b,d)&&v.rotateZ(e,Math.PI,e));m.fE(a)}var w=l("__armature"),m=l("__camera"),k=l("__mat3"),f=l("__print"),v=l("__quat"),c=l("__tsr"),C=l("__util"),O=l("__vec3");a.q0=1;a.p0=2;a.u0=3;a.v0=4;a.k0=5;a.l0=6;a.r0=7;
a.j0=8;a.o0=9;a.n0=10;a.h0=11;a.i0=12;a.m0=13;a.s0=14;a.t0=15;a.g0=1;var J=new Float32Array(2),K=new Float32Array(2),D=new Float32Array(3),Q=new Float32Array(3),L=new Float32Array(3),H=new Float32Array(4),z=new Float32Array(4),d=new Float32Array(9),p=new Float32Array(9),M=c.create(),x=new Float32Array(3);a.KF=function(a,b,c,d,f){var k=n(1);k.Fa=b;k.offset=new Float32Array(c);k.pe=d?new Float32Array(d):null;k.ws=f;e(a,k);y(a,k,0)};a.yQ=function(a,b,c,d,f,k){var p=n(2);p.Fa=b;p.zl=c;p.offset=new Float32Array(d);
p.pe=f?new Float32Array(f):null;p.ws=k;e(a,p);y(a,p,0)};a.wQ=function(a,b,d,f){var k=n(9),p=c.P(a.k.n),h=c.P(b.k.n);k.Fa=b;k.offset=new Float32Array(d);k.Im=new Float32Array(h);f&&(v.copy(f,p),v.multiply(h,p,p));e(a,k);y(a,k,0)};a.vQ=function(a,b,d,f,k,p,h,m){var l=n(10),u=c.P(a.k.n),r=c.P(b.k.n);l.Fa=b;l.offset=new Float32Array(d);l.Im=new Float32Array(r);l.WR=C.zi(k);l.XR=C.zi(p);l.YR=C.Fg(h,-Math.PI,Math.PI);l.VR=C.Fg(m,-Math.PI,Math.PI);f?(l.pe=new Float32Array(f),v.copy(f,u),v.multiply(r,u,u)):
l.pe=v.create();e(a,l);y(a,l,0)};a.uQ=function(a,b,c,d){var f=n(13);f.Fa=b;f.offset=new Float32Array(c);f.bZ=d;e(a,f);y(a,f,0)};a.BQ=function(a,b,c,d){var f=n(14);f.Fa=b;f.offset=new Float32Array(c);f.ws=1;f.pe=d?new Float32Array(d):null;e(a,f);y(a,f,0)};a.L7=b;a.DQ=function(a,b){var c=n(3);c.Fa=b;e(a,c);y(a,c,0)};a.EQ=function(a,b){var c=n(4);c.target=new Float32Array(b);e(a,c);y(a,c,0)};a.qQ=function(a,b,c,d){var f=n(5);f.Fa=b;f.Wq=c;f.Qg=d;e(a,f);y(a,f,0)};a.rQ=function(a,b,c,d){var f=n(6);f.target=
new Float32Array(b);f.Wq=c;f.Qg=d;e(a,f);y(a,f,0)};a.AQ=function(a,b,c){var d=n(7);d.Fa=b;d.offset=new Float32Array(c);e(a,d);y(a,d,0)};a.oQ=function(a,b,c){var d=n(8);d.Fa=b;d.offset=new Float32Array(c);e(a,d);y(a,d,0)};a.mQ=function(a,b,c){var d=n(11);d.Fa=b;d.wx=new Float32Array(c);e(a,d);y(a,d,0)};a.nQ=function(a,b,c,d){var f=n(12);f.Fa=b;f.zl=c;f.wx=new Float32Array(d);e(a,f);y(a,f,0)};a.tz=function(a,b,c){var d=n(15);d.Fa=b;if(C.Wh(c.left))d.VJ=!0,d.NB=c.left;else if(C.Wh(c.right))d.VJ=!1,d.NB=
c.right;else{f.error("append_stiff_viewport: Wrong positioning params");return}if(C.Wh(c.top))d.TM=!0,d.TD=c.top;else if(C.Wh(c.bottom))d.TM=!1,d.TD=c.bottom;else{f.error("append_stiff_viewport: Wrong positioning params");return}C.Wh(c.distance)?(d.distance=c.distance,d.pe=C.Wh(c.rotation)?new Float32Array(c.rotation):null,d.hor_units=C.Wh(c.hor_units)?c.hor_units:"widths",d.vert_units=C.Wh(c.vert_units)?c.vert_units:"heights",e(a,d),y(a,d,0)):f.error("append_stiff_viewport: Wrong positioning params")};
a.i_=function(a,b){a.pc&&y(a,a.pc,b)};a.zQ=function(a,b,c,d,f){var e=n(1);e.zl=c;e.target=b;e.offset=new Float32Array(d);e.pe=f?new Float32Array(f):null;e.ws=1;b=e.target;c=e.zl;d=a.k.Hg[c];f=b.aA;for(var k=0;k<f;k++){var p=f[k];if(p[0]==a&&p[1]==c){f.splice(k,1);break}}b.aA.push([a,c]);d.pc=e;r(a,e)};a.a_=function(a,b){var c=a.k.Hg[b];c.pc&&r(a,c.pc)};a.ZX=A;a.Qj=h;a.LR=function(a){return a.pc?!0:!1};a.remove=function(a){a.pc.Fa&&b(a.pc.Fa,a);a.pc=null};a.N5=function(a){return a.pc?a.pc.type:null};
a.gg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?!1:!0};a.$u=function(a){if((a=a.pc)&&11==a.type)return a.Fa.k.n;if(a&&12==a.type){var b=M;w.Zu(a.Fa,a.zl,!0,b);c.multiply(a.Fa.k.n,b,b);return b}return null};a.fg=function(a){a=a.pc;return!a||11!=a.type&&12!=a.type?null:a.wx}};b4w.module.__container=function(a,l){var n,e,b,y,r;function A(a,b){n=a;e=b}function h(){var a=d.getBoundingClientRect();A(a.left,a.top)}function w(){return L.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function m(b,f,e){if(!b||!f){b=a.ey;f=a.dy;var h=M;h.style.width=a.ey+"px";h.style.height=a.dy+"px"}var h=d,m=p;!1!==e&&(h.style.width=b+"px",h.style.height=f+"px",m&&(m.style.width=b+"px",m.style.height=f+"px"));m&&(m.width=b,m.height=f,c.Qs());e=Math.floor(b*L.canvas_resolution_factor);f=Math.floor(f*
L.canvas_resolution_factor);w()&&(e*=window.devicePixelRatio,f*=window.devicePixelRatio);if(m=J.Rh())m=m.s,e=Math.floor(e*m.Bo),f=Math.floor(f*m.Bo);h.width=e;h.height=f;var m=Math.min(z.drawingBufferWidth,H.XB,H.bC[0]),l=Math.min(z.drawingBufferHeight,H.XB,H.bC[1]);if(e>m||f>l)O.warn("Canvas size exceeds platform limits, downscaling"),m=Math.min(m/e,l/f),e*=m,f*=m,h.width=e,h.height=f;J.WL(e,f,e/b);J.Da()&&D.D(J.A().Cj);v.m_(h.width,h.height);v.$g()&&(k.update(),J.update(K.ur(),0),k.kN())}var k=
l("__anchors"),f=l("__config"),v=l("__data"),c=l("__hud"),C=l("__input"),O=l("__print"),J=l("__scenes"),K=l("__time"),D=l("__transform"),Q=l("__util"),L=f.B,H=f.Gi,z=null,d=null,p=null,M=null,x=!1;y=b=0;r=1;n=e=0;a.ey=320;a.dy=240;a.Nf=function(a){z=a};a.gm=function(){return d};a.qI=function(){return p};a.Ce=function(){return M};a.Xg=function(a,b){a&&a.parentNode?(d=a,p=b,M=a.parentNode):Q.q("canvas container is not available")};a.Fv=function(a,b){b=b||"LAST";switch(b){case "FIRST":M.insertBefore(a,
M.firstElementChild);break;case "JUST_BEFORE_CANVAS":M.insertBefore(a,d);break;case "JUST_AFTER_CANVAS":d.nextElementSibling?M.insertBefore(a,d.nextElementSibling):M.appendChild(a,d);break;case "LAST":M.appendChild(a,d);break;default:O.error(b+" invalid stack order")}};a.eJ=function(){return b};a.dJ=function(){return y};a.rL=A;a.bN=h;a.TY=function(a,c,d){b=a;y=c;r=d;h()};a.WA=function(){x=!0};a.nu=function(a,b,c){c||(c=new Float32Array(2));var d=c;x&&(h(),x=!1);d[0]=a-n;a=c;x&&(h(),x=!1);a[1]=b-e;
return c};a.iu=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*r;d[1]=c*r;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.S_=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/r;d[1]=c/r;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.DJ=function(b){return b&&b.parentNode?b.parentNode==M?!0:a.DJ(b.parentNode):!1};a.XV=w;a.nU=function(a){var b=document.getElementsByTagName("script");a=Q.gj(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=m;a.Bk=function(a){var b=M,c=d,f=b.clientWidth,
b=b.clientHeight;if(a||f!=c.clientWidth||b!=c.clientHeight)(a="HMD"===L.stereo&&C.hJ())&&a.isPresenting||m(f,b,!0)};a.reset=function(){M=p=d=z=null}};b4w.module.__anchors=function(a,l){function n(){t=!0;C.Ce().addEventListener("mouseup",function(){function a(){return"visible"==c.style.visibility&&!p&&!m}if(!da&&!g){var b=P;if(b)if("visible"==b.lastElementChild.style.visibility)e(),P=null;else if(1==b.style.opacity){var c=b.lastElementChild,b=b.firstElementChild,d=c.firstElementChild,f=d.innerHTML;c.style.visibility="visible";var k=Math.min(parseInt(c.style.width)||200,A(f)-24),q=h(f,k),p=!0,m=!0;b.style.display="none";da=!0;H.xn(0,k,200,function(b){b==
k&&(p=!1,m||(da=!1),a&&(d.style.visibility="visible"));c.style.width=b+"px"});H.xn(0,q,200,function(b){b==q&&(m=!1,p||(da=!1),a&&(d.style.visibility="visible"));c.style.height=b+"px"})}}})}function e(){var a=P.lastElementChild;P.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function y(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}
function r(a,c,d){var f=document.createElement("div"),k=document.createElement("span");d&&(f.style.width=d+"px");y(f);b(k);k.innerHTML=a;f.style.visibility="hidden";k.style.visibility="hidden";f.appendChild(k);c.appendChild(f);c.addEventListener("mousedown",function(){da||c==P||1!=c.style.opacity||g||(P&&"visible"==P.lastElementChild.style.visibility&&e(),P=c)})}function A(a){var c=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);y(c);c.appendChild(d);document.body.appendChild(c);
a=c.offsetWidth+1;document.body.removeChild(c);return a}function h(a,c){var d=document.createElement("div"),f=document.createElement("span");f.innerHTML=a;b(f);y(d);d.style.width=c+"px";d.style.display="inline-block";d.appendChild(f);document.body.appendChild(d);f=d.offsetHeight-16;document.body.removeChild(d);return f}function w(){for(var a=0,b=0;b<x.length;b++)x[b].Kn&&a++;G=new Float32Array(3*a)}function m(a,b){return b.depth-a.depth}function k(a,b,c){a=a.element;M.xJ&&(b=Math.floor(b),c=Math.floor(c));
"transform"in a.style?a.style.transform="translate3d("+b+"px, "+c+"px, 0px)":"webkitTransform"in a.style?a.style.webkitTransform="translate3d("+b+"px, "+c+"px, 0px)":(a.style.left=b+"px",a.style.top=c+"px")}var f=l("__batch"),v=l("__camera"),c=l("__config"),C=l("__container"),O=l("__objects"),J=l("__obj_util"),K=l("__print"),D=l("__renderer"),Q=l("__scenes"),L=l("__subscene"),H=l("__time"),z=l("__transform"),d=l("__tsr"),p=l("__vec3"),M=c.B,x=[],g=!1,P=null,t=!1,da=!1,G=new Float32Array(0),F=new Uint8Array(16),
U=new Float32Array(2),R=new Float32Array(3),Z=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<x.length;c++)if(x[c].ea==a){c=!0;break a}c=!1}if(!c){c=a.anchor.Kn&&Boolean(Q.La(Q.Rh(),L.ln));c={type:a.anchor.type,ea:a,x:0,y:0,depth:0,tl:"out",Kn:c,element:null,no:null,kQ:a.anchor.RW,Uj:a.anchor.Uj};switch(c.type){case "ANNOTATION":var d=c.ea;a=C.Ce();var f=O.bv(d),d=d.name,g=document.createElement("div"),e=g.cloneNode(),k=document.createElement("span"),p="";g.style.cssText+="position:           absolute;transform-style:    preserve-3d;";
e.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";g.style.visibility="hidden";f&&(p=f.description||p,d=f.title||d);k.innerHTML=d;k.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(k);k.style.whiteSpace="nowrap";e.appendChild(k);g.appendChild(e);p&&r(p,g,c.kQ);a.appendChild(g);c.element=g;break;case "ELEMENT":if(c.element=document.getElementById(a.anchor.Uj),c.element)for(f=0;f<x.length;f++)"ELEMENT"==x[f].type&&x[f].Uj==a.anchor.Uj&&(K.warn("Anchor with the id '"+a.anchor.Uj+"' already exists, making the new anchor generic."),c.type="GENERIC");else K.warn("Anchor HTML element with the id '"+a.anchor.Uj+"' was not found, making it generic."),c.type="GENERIC"}x.push(c);w();
t||n()}};a.remove=function(a){for(var b=0;b<x.length;b++){var c=x[b];if(c.ea==a){"ANNOTATION"==c.type&&(a=c,C.Ce().removeChild(a.element));x.splice(b,1);w();break}}};a.update=function(a){for(var b=0,c=x.length;c--;){var g=x[c];g.Kn&&G.set(d.G(g.ea.k.n),3*b++);var e,p=g,q=R;e=Q.dm(Q.Rh());e=q=v.HC(e,d.G(p.ea.k.n),q);p=e[0];q=e[1];e=e[2];if(a||p!=g.x||q!=g.y||e!=g.depth){switch(g.type){case "ANNOTATION":var h=p,l=q;k(g,h,l);break;case "ELEMENT":l=g.element.getBoundingClientRect(),h=p-l.width/2,l=q-
l.height/2,k(g,h,l)}g.x=p;g.y=q;g.depth=e;g.no&&g.no(p,q,g.tl,g.ea,g.element)}}x.sort(m);for(c=0;c<x.length;c++)g=x[c],"GENERIC"!=g.type&&(g.element.style.zIndex=P==g.element?x.length:c);0<b&&(a=Q.La(Q.Rh(),L.ln),b=a.Ra[0].sa[0],f.VZ(b.za,G),L.Sc(a,b))};a.kN=function(){for(var a=C.Ce(),b=x.length;b--;){var c=x[b],d=c.ea,f=d.k,g=c.x,k=c.y,h=c.depth,m=Q.dm(Q.Rh()),l=z.ie(d,R),m=z.ie(m,Z),l=p.dist(l,m);(h=0>g||0>k||0>h||1<h||Q.GB(d)||g>=a.clientWidth||k>=a.clientHeight)||(h=f.ef,h=!(l<f.bh?0:h==J.Ip||
l<h));f=h?"out":"visible";c.Kn&&"out"!=f&&(f=c,h=Q.La(Q.Rh(),L.ln).p,l=C.iu(f.x,f.y,U,h),D.NC(h.Ze,l[0],h.height-l[1],2,2,F),f=1020==F[5]+F[6]+F[9]+F[10]?"visible":"out"==f.tl||0==F[5]+F[6]+F[9]+F[10]?"covered":f.tl);if(f!=c.tl){switch(c.type){case "ANNOTATION":case "ELEMENT":var n=c.element;if(!n)break;"out"==f?(n.style.visibility="hidden",n.children.length&&(n.children[0].style.visibility="hidden")):"visible"==f?(n.style.visibility="visible",n.children.length&&(n.children[0].style.visibility="visible"),
n.style.opacity=1):(n.style.visibility="visible",n.style.opacity=.1,n.children.length&&(n.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<n.children.length&&"visible"==n.lastElementChild.style.visibility&&(e(),n==P&&(P=null)))}c.tl=f;c.no&&c.no(g,k,c.tl,d,n)}}};a.y2=function(a,b){for(var c=0;c<x.length;c++)x[c].ea==a&&(x[c].no=b)};a.A3=function(a){for(var b=0;b<x.length;b++)x[b].ea==a&&(x[b].no=null)};a.ua=function(){for(var a=0;a<x.length;a++){var b=x[a];"ANNOTATION"==b.type&&C.Ce().removeChild(b.element)}x.length=
0};a.PV=function(a){for(var b=0;b<x.length;b++)if(x[b].ea==a)return!0;return!1};a.J4=function(a){for(var b=0;b<x.length;b++)if(x[b].ea==a)return x[b].Uj;return!1};a.pause=function(){g=!0};a.jj=function(){g=!1};a.kX=function(a,b){for(var c=-1,d=0;d<x.length;d++){var f;if(f="visible"==x[d].tl){var g=x[d];if(g.element){f=Math.round(g.element.offsetWidth)||0;var e=Math.round(g.element.offsetHeight)||0}else e=f=0;var k=g.x,g=g.y;f=a>=k&&a<=k+f&&b<g&&b>=g-e?!0:!1}if(f)if(0>c)var p=x[d].depth,c=d;else x[d].depth<
p&&(c=d,p=x[d].depth)}return 0>c?null:x[c].ea}};b4w.module.__scenes=function(a,l){function n(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.Vf||!c.Vf.length)return c}return null}function e(){wb||La.q("No active scene available");return wb}function b(a,b,c){if(!Aa.Hu||!y(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>ab.Ec?(d.csm_resolution=ab.Ec,Ha.error("Shadow map texture has unsupported size. Changed to "+ab.Ec+".")):d.csm_resolution=c.csm_resolution;Aa.fR=c.blur_samples;d.aZ=c.soft_shadows;a=I.fv(b,Aa.ssao&&a.b4w_enable_ssao);
d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.ah=[];d.qM=[];d.xq=[];d.wq=[];for(b=0;b<a.length;b++)d.ah.push(a[b].ub.type),d.qM.push(a[b].ub.Wm),d.xq.push(a[b].ub.xq),d.wq.push(a[b].ub.wq),"SPOT"!=d.ah[b]&&"POINT"!=d.ah[b]||!d.enable_csm||(Ha.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=
c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,
d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function y(a,b,c){if(0!=b.length&&Aa.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,f=!1;a=Aa.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var g=c[b];g.b4w_shadow_cast&&(d=!0);g.b4w_shadow_receive&&(f=!0);if((a||d)&&f)return!0}return!1}function r(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].ub.type)return!0;return!1}function A(a){if(!Aa.Kk)return!1;a=sa(a);
for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function h(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(I.HG(a[b],c[d].settings))return!0;return!1}function w(a){for(var b=sa(a),c=[],d=0;d<b.length;d++){var f=b[d];if(f.b4w_water){for(var g={},e=0;e<a.length;e++)for(var k=a[e],q=k.data.materials,p=0;p<q.length;p++)q[p]==f&&(g.el=k.location[2]);g.Be=f.b4w_water_fog_color.slice(0);g.Be.push(f.b4w_water_fog_density);
f.b4w_water_dynamic?(g.ar=!0,g.waves_height=f.b4w_waves_height,g.waves_length=f.b4w_waves_length,g.dst_noise_scale0=f.b4w_water_dst_noise_scale0,g.dst_noise_scale1=f.b4w_water_dst_noise_scale1,g.dst_noise_freq0=f.b4w_water_dst_noise_freq0,g.dst_noise_freq1=f.b4w_water_dst_noise_freq1,g.dir_min_shore_fac=f.b4w_water_dir_min_shore_fac,g.dir_freq=f.b4w_water_dir_freq,g.dir_noise_scale=f.b4w_water_dir_noise_scale,g.dir_noise_freq=f.b4w_water_dir_noise_freq,g.dir_min_noise_fac=f.b4w_water_dir_min_noise_fac,
g.dst_min_fac=f.b4w_water_dst_min_fac,g.waves_hor_fac=f.b4w_water_waves_hor_fac):(g.ar=!1,g.waves_height=0,g.waves_length=0);g.Kg=f.b4w_water_enable_caust;g.BR=f.b4w_water_caust_scale;g.AR=f.b4w_water_caust_brightness;g.CR=new Float32Array([.3,.7]);g.Lk=null;f=f.texture_slots;for(e=0;e<f.length;e++)k=f[e].texture,!0===k.b4w_shore_dist_map&&"FILE"==k.image.source&&(g.Lk=k.image,g.xD=k.image.size[0],g.YB=k.b4w_max_shore_dist,k=k.b4w_shore_boundings,g.Lo=[(k[0]+k[1])/2,(k[2]+k[3])/2],g.Mo=[k[0]-k[1],
k[2]-k[3]]);c.push(g)}}if(0<c.length){g=c[0];if(!g.ar)for(d=0;d<c.length;d++)c[d].ar&&(g=c[d]);return g}return null}function m(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var f=a[d];"GROUP"==f.type&&f.node_group&&b(f.node_group.node_tree);"GROUP"==f.type&&"B4W_REFRACTION"==f.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=sa(a);for(var d=0;d<a.length;d++){var f=a[d];f.b4w_refractive&&(c.refractions=!0);f.node_tree&&b(f.node_tree)}return c}function k(a,b,c){if(Aa.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var d=0,f=!1,g=0;g<b.length;g++){var e=b[g];e.k.Gd&&"CUBE"==e.k.lh&&d++;if(e.ss.length){for(var k=null,q=0;q<a.length;q++)if(a[q]==e){k=q;break}null==k&&a.push(e)}}for(g=0;g<c.length;g++){a:if(b=c[g],b.b4w_reflexible){b=b.data.materials;for(e=0;e<b.length;e++)if(k=b[e].game_settings.alpha_blend,"OPAQUE"!=k&&"CLIP"!=k){b=!0;break a}b=!1}else b=void 0;b&&(f=!0)}return{$K:a,sK:d,Ji:[],xA:[],bi:[],yw:[],mJ:f}}function f(a,b){var c=a.b4w_sky_settings,d={};d.cL=c.render_sky||c.procedural_skydome;
d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.Oo=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.ee=c.reflexible;d.Hd=c.reflexible_only;
!b&&c.procedural_skydome&&Ha.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function v(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.CV=a.hemisphere;b.eR=a.blur_depth;b.mG=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.aY=a.samples;return b}function c(a){if(!(Aa.bloom&&a.b4w_enable_bloom&&a.s.rj))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function C(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function O(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function J(a){var b={};a=a.b4w_god_rays_settings;b.AB=a.intensity;b.ko=a.max_ray_length;b.Xo=a.steps_per_pass;return b}function K(a){var b={};b.hj=a.b4w_outline_color;b.$r=a.b4w_outline_factor;return b}
function D(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function Q(a,b){var c=a.light_settings,d={};d.Sg=c.environment_energy;d.Ws=c.use_environment_light;d.NA=c.environment_color;d.ke=a.horizon_color.slice(0);d.te=a.zenith_color.slice(0);d.Zs=a.use_sky_paper;d.Ys=a.use_sky_blend;d.$s=a.use_sky_real;d.ix=null;
d.Po=null;d.Ou=null;c=!0;if(d.Ws&&"SKY_TEXTURE"==d.NA&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var f=null,g=0;g<a.texture_slots.length;g++)if(a.texture_slots[g].texture.b4w_use_as_environment_lighting&&!a.texture_slots[g].texture.b4w_use_as_skydome){f=a.texture_slots[g];break}f?d.Ou=f:c=!1}for(g=0;g<a.texture_slots.length;g++)if(a.texture_slots[g].texture.b4w_use_as_skydome){c=!0;f=a.texture_slots[g];d.ix=f;g=Math.min(ab.Zi,Qa.tR(f.texture.image.size[0]/3));d.Po={FZ:g,jG:f.blend_factor,
rJ:f.horizon_factor,MN:f.zenith_up_factor,LN:f.zenith_down_factor,color:f.color,Ea:f.default_value,invert:f.invert,rN:f.use_rgb_to_intensity,kG:f.blend_type,mN:f.use_map_blend,nN:f.use_map_horizon,pN:f.use_map_zenith_up,oN:f.use_map_zenith_down};break}d.Ws=d.Ws?c:!1;return d}function L(a){var b=a.fog_settings,c={};c.I_=b.use_fog;c.AB=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.gU=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Be=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.dg=new Float32Array([c.AB,c.depth,c.start,c.height]);return c}function H(a,b){if(!Aa.hd)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,d=!1,f=0;f<b.length;f++){for(var g=b[f],e=g.data.materials,k=0;k<e.length;k++)e[k].b4w_terrain&&(c=!0);g=g.particle_systems;for(k=0;k<g.length;k++)e=g[k].settings,"HAIR"==e.type&&e.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function z(a,b){if(Ya.outlining_overview_mode)return!0;if(Aa.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].pb.k.Dk)return!0;return!1}else return!1}function d(a,b){if(Ya.outlining_overview_mode)return!0;if(Aa.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].pb.k.Vc)return!0;return!1}else return!1}function p(a,b){if(Aa.Ui)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,
f=0;f<d.length;f++)if(Ga.GG(d[f]))return!0;return!1}else return!1}function M(a,b){if(Aa.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function x(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var f=c[d],g=f.game_settings.alpha_blend;if(f.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g)return!0}return!1}function g(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].pb;if(d.anchor&&d.anchor.Kn)return!0}return!1}}function P(a,b,c){var d=pa.gh(a,b);pa.ni(a,d,function(a,b,d){if(d.Gc){switch(d.from){case "COLOR":case "CUBEMAP":var f=b.p.wc;break;case "DEPTH":f=b.p.Ve;break;case "SCREEN":f=null;break;case W.md:return;default:La.q("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:f||La.q("Connection of SCREEN is forbidden"),f.Ne&&La.q("Batch texture can't use renderbuffer"),qa.KG(c.zb,d.to)&&ja.Gj(c,f,d.to)}}});for(a=0;a<b.Za.length;a++){var d=b.Za[a],f=b.mi[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:f.Ne&&La.q("Batch texture can't use renderbuffer"),qa.KG(c.zb,d.to)&&ja.Gj(c,f,d.to)}}}function t(a){if(a&&a.s&&a.s.Xa){var b=fa.gc(a.s.Xa,W.Dg);b&&S(a,b)}}function da(a,
b,c,d,f,g){for(var e=b.k,k=I.ka(b,f).W,q=0;q<k.length;q++){var p=k[q];if(!(p.qe||p.Hd||"MAIN"!=p.type&&"NODES_GLOW"!=p.type&&"PARTICLES"!=p.type&&"LINE"!=p.type)&&("OPAQUE"==p.Fb&&"OPAQUE"==d||"BLEND"==p.Fb&&"BLEND"==d||"XRAY"==p.Fb&&"XRAY"==d||"NODES_GLOW"==p.type&&"GLOW"==d)){if(!g&&(G(p,a,b,c,d,f),!ja.Yc(p)))if("DEBUG"===Ua.type())ja.Wt(p,"error.glslv","error.glslf"),ja.Yc(p);else continue;var h=W.Vh(p,e);W.Sc(a,h);P(c,a,p);F(p)}}}function G(a,b,c,d,f,g){var e=c.k,k=g.s,q=I.ka(c,g),p="NO_SHADOWS";
c=Y(g,[W.cd]);if(c.length&&a.fe){switch(f){case "OPAQUE":p="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":p="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":p="NO_SHADOWS";break;case "SHADOW":p="SHADOW_MASK_GENERATION";break;default:La.q("Wrong subscene type")}for(var h=0;h<c.length;h++)ja.TF(a,g.s.ud)}h="NO_SOFT_SHADOWS";if(k.ud&&k.ud.aZ)switch(Aa.fR){case "16x":h="POISSON_X_16";break;case "8x":h="POISSON_X_8";break;case "4x":h="POISSON_X_4"}c=a.ib;qa.ia(c,"SHADOW_USAGE",
p);qa.ia(c,"POISSON_DISK_NUM",h);a.hd&&(h=fa.gc(d,W.vi))&&U(a,h,e);h=b.p;h.type==ka.we||h.type==ka.Bh||h.type==ka.yi?qa.ia(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):qa.ia(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=f||a.ak){f=b.lw;qa.ia(c,"NUM_LIGHTS",f);qa.ia(c,"NUM_LFACTORS",0==f%2?f/2:Math.floor(f/2)+1);qa.ia(c,"REFLECTION_PASS","REFL_PASS_NONE");qa.ia(c,"SSAO_ONLY",0);if(f=k.Mc)qa.ia(c,"WATER_EFFECTS",1),qa.ia(c,"WAVES_HEIGHT",qa.N(f.waves_height)),qa.ia(c,"WAVES_LENGTH",qa.N(f.waves_length)),
qa.ia(c,"WATER_LEVEL",qa.N(f.el));if(b.Kg&&a.Kg){qa.ia(c,"CAUSTICS",1);if(h=k.ud){e=h.ah;for(h=p=0;h<e.length;h++)"SUN"==e[h]&&(p=h);qa.ia(c,"SUN_NUM",p)}qa.ia(c,"CAUST_SCALE",qa.N(b.wG));qa.ia(c,"CAUST_SPEED",qa.N(b.xG,2));qa.ia(c,"CAUST_BRIGHT",qa.N(b.vG))}b=q.Ji;q=q.bi;if(-1!==a.Ld.indexOf("u_mirrormap"))qa.ia(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Gd&&b)b=b.p.wc,ja.Gj(a,b,"u_cube_reflection"),qa.ia(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Gd&&q)for(h=0;h<q.length;h++)b=q[h].p.wc,ja.Gj(a,
b,"u_plane_reflection"),qa.ia(c,"REFLECTION_TYPE","REFL_PLANE");else qa.ia(c,"REFLECTION_TYPE","REFL_NONE");(q=fa.gc(d,W.Dg))?a.Iu?(b=q.p.wc,ja.Gj(a,b,"u_sky")):q.procedural_skydome&&(a.ye=q.ye,qa.ia(c,"PROCEDURAL_FOG",1)):qa.ia(c,"PROCEDURAL_FOG",0);b=k.qp;b.Ws&&(qa.ia(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.NA?(b.Ou?(q=b.Ou.texture,b=Qa.he(b.Ou),ja.Gj(a,b,"u_sky_texture",q.name)):q&&(b=q.p.wc,ja.Gj(a,b,"u_sky_texture")),qa.ia(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.NA&&qa.ia(c,"SKY_COLOR",1));
b=k.KN;b.I_&&(qa.ia(c,"USE_FOG",1),qa.ia(c,"FOG_TYPE",b.gU));a.zk&&a.Lb?(Aa.Hu&&qa.ia(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.ak||"NODES_GLOW"==a.type?(qa.ia(c,"REFRACTIVE",1),k.refractions?qa.ia(c,"USE_REFRACTION",1):qa.ia(c,"USE_REFRACTION",0)):k.refractions?qa.ia(c,"REFRACTIVE",1):qa.ia(c,"REFRACTIVE",0),(k.cK.refractions||k.refractions)&&qa.ia(c,"HAS_REFRACT_TEXTURE",1)):(qa.ia(c,"REFRACTIVE",0),qa.ia(c,"USE_REFRACTION",0),qa.ia(c,"USE_REFRACTION_CORRECTION",0));a.yj&&(Aa.Kk&&a.ft&&
fa.gc(d,W.CE)?qa.ia(c,"SHORE_SMOOTHING",1):qa.ia(c,"SHORE_SMOOTHING",0),a.water_dynamic&&f&&f.waves_height?qa.ia(c,"DYNAMIC",1):qa.ia(c,"DYNAMIC",0));"PARTICLES"==a.type&&(qa.ia(c,"SIZE_RAMP_LENGTH",a.hb.b9),qa.ia(c,"COLOR_RAMP_LENGTH",a.hb.UG));if(!a.eg)for(a=a.ya,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(k=0;k<Va.length;k++)for(c=Va[k],q=Va[k].Vf,f=0;f<q.length;f++)q[f]==b&&pa.r(Ob,c,g,null)}}function F(a){8<a.ya.length&&Ha.warn(a.type,"too many textures used - "+a.ya.length+' (max 8), materials "'+
a.sd.join(", ")+'"')}function U(a,b,c){a.je=b.je;var d=b.je[0],f=b.je[1],g=b.je[2];c=c.R;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);g=0==g?c:Math.max(g,c);b.je[2]=g;b=b.p;ka.Sw(b,g/2,-f,-d,g/2);ka.Ik(b);d=a.yr||0;d=0==d?c:Math.max(d,c);a.yr=d}function R(a,b,c,d,f,g){for(var e=b.k,k=I.ka(b,f).W,q=0;q<k.length;q++){var p=k[q];if(("MAIN"==p.type||"PARTICLES"==p.type||"LINE"==p.type)&&"REFLECT"==p.Fb&&p.Lb==d){if(a.type==W.Nd||a.type==W.xf){var h;a:{var m=f.s.ei.bi;for(h=0;h<m.length;h++)for(var u=0;u<
m[h].length;u++)if(m[h][u]==a)break a;m=f.s.ei.yw;for(h=0;h<m.length;h++)for(u=0;u<m[h].length;u++)if(m[h][u]==a)break a;h=null}if(h==e.Ed)continue}else if(h=ua(f,a),h==e.Rd)continue;if(!g&&(G(p,a,b,c,"REFLECT",f),h=p.ib,qa.ia(h,"WATER_EFFECTS",0),a.type==W.Nd||a.type==W.xf?qa.ia(h,"REFLECTION_PASS","REFL_PASS_PLANE"):qa.ia(h,"REFLECTION_PASS","REFL_PASS_CUBE"),qa.ia(h,"TEXTURE_NORM",0),!ja.Yc(p)))if("DEBUG"===Ua.type())ja.Wt(p,"error.glslv","error.glslf"),ja.Yc(p);else continue;p=W.Vh(p,e);W.Sc(a,
p)}}}function Z(a){ba(a);var b=na(a,W.Pb),c=!0,d=a.s.ud;pa.pa(a.s.Xa,function(f,g){g.type===W.cd&&(ga(g,a,b.p,d,c),c=!1)})}function u(a){pa.pa(a.s.Xa,function(a,b){b.type===W.qn&&(b.LA=1)})}function ga(a,b,c,d,f){if(0!=a.Ra.length){var g=a.p,e=ra.hc(c.n,qb);ra.kf(e,g.n);ra.copy(c.qf,g.Es);if("SUN"===d.ah[a.ph]||"HEMI"===d.ah[a.ph]){e=tc;xa.b0(e);for(var k=0;k<a.Ra.length;k++)for(var q=a.Ra[k].sa,p=0;p<q.length;p++){var h=q[p].ff;0==k&&0==p?xa.Dn(h.Ua,e):xa.OA(e,h.Ua)}e=xa.NH(e,Nc);La.xo(e,g.Ob,e);
if(d.enable_csm){b=Ta.copy(c.Lh[a.wA],qb);d=Ma.invert(c.Ob,jc);La.xo(b,d,b);La.xo(b,g.Ob,b);a=c.Pq[a.wA];if(f)for(Ib=0,ec=-Infinity,f=2;f<e.length;f+=3)Ib=Math.min(Ib,e[f]),ec=Math.max(ec,e[f]);f=tc;f.max_x=b[0]+a;f.max_y=b[1]+a;f.max_z=ec;f.min_x=b[0]-a;f.min_y=b[1]-a;f.min_z=Ib}else{c=f=tc;d=Wc;d.set(e);e=ic/9;k=Ma.identity(jc);Ma.rotate(k,e,La.Nc,k);p=q=-1;for(h=0;10>h;h++){var m=xa.$F(d,Qc),u=(m.max_x-m.min_x)*(m.max_y-m.min_y);if(-1==q||u<q)q=u,p=h,xa.Dn(m,c);La.xo(d,k,d)}c=p*e;0<c&&(e=Ma.identity(jc),
Ma.rotate(e,c,La.Nc,e),Ma.multiply(e,g.Ob,g.Ob),ra.Qi(g.Ob,g.qf));c=f.max_x-f.min_x;e=f.max_y-f.min_y;c&&e&&(d=Math.abs(c-e)/2,2<c/e?(f.max_y+=d,f.min_y-=d):2<e/c&&(f.max_x+=d,f.min_x-=d));f.max_x+=.005;f.max_y+=.005;f.max_z+=.005;f.min_x-=.005;f.min_y-=.005;f.min_z-=.005;ca(a,b.s.Xa)}ka.sY(g,f.min_x,f.max_x,f.min_y,f.max_y,-f.max_z,-f.min_z);ka.Ik(g);La.Pn(g.ld,g.Ph)}else"SPOT"!==d.ah[a.ph]&&"POINT"!==d.ah[a.ph]||ka.Ik(g,g.Ab)}}function ca(a,b){for(var c=a.p,d=fa.mV(b,a),f=0;f<d.length;f++){var g=
d[f];if(g.type==W.Pb||g.type==W.yf||g.type==W.Pc||g.type==W.Uf)if(Aa.Wv)g.kE.set(c.qf,9*a.ph);else{var e=ra.G(c.qf),k=ra.P(c.qf);pb.set(e[0],e[1],e[2],ra.Yd(c.qf),fb);g.Bx.set(fb,4*a.ph);g.Ax.set(k,4*a.ph)}}}function E(a,b,c,d,f){for(var g=b.k,e=I.ka(b,d).W,k=0;k<e.length;k++){var q=e[k];if("COLOR_ID"==q.type&&(a.type==W.tf&&"COLOR_ID"==q.Fb||a.type==W.ui&&"COLOR_ID_XRAY"==q.Fb)){if(!f&&(G(q,a,b,c,"COLOR_ID",d),ja.jf(q,"USE_OUTLINE",0),!ja.Yc(q)))continue;q=W.Vh(q,g);W.Sc(a,q)}}}function aa(a,b,c,
d,f){if(!d&&(f.hd&&(d=fa.gc(c,W.vi))&&U(f,d,b),!ja.Yc(f)))if("DEBUG"===Ua.type())ja.Wt(f,"error.glslv","error.glslf"),ja.Yc(f);else return;b=W.Vh(f,b);W.Sc(a,b);P(c,a,f);F(f)}function ia(a,b){q(a,b);for(var c=0;c<a.Te.length;c++)a.Te[c].parent==a&&ia(a.Te[c],b)}function q(a,b){a.k.Uh=b;if(I.Zg(a))for(var c=0;c<a.I.length;c++)for(var d=a.I[c],f=Y(d.yb,eb),g=0;g<f.length;g++){var e=f[g],k=a.k,q=a.ub,p=d.xm,h=q.an&&!k.Uh?1:0;e.Qr[4*p+3]=h;h=q.cn&&!k.Uh?1:0;e.Pr[4*p+3]=h;e.Ba=!0}}function T(a,b){for(var c=
Y(b,eb),d=a.ub,f=a.k,g=I.ka(a,b),e=ra.G(f.n),f=ra.P(f.n),k=0;k<c.length;k++){var q=c[k],p=q,h=a.k,m=a.ub,u=g.xm,B=ra.G(a.k.n),l=m.Fq;p.PB.set(m.direction,3*u);fb[0]=B[0];fb[1]=B[1];fb[2]=B[2];fb[3]=m.an&&!h.Uh?1:0;p.Qr.set(fb,4*u);fb[0]=l[0];fb[1]=l[1];fb[2]=l[2];fb[3]=m.cn&&!h.Uh?1:0;p.Pr.set(fb,4*u);p.Ba=!0;switch(d.type){case "SUN":q.DM.set(f);q.CM=d.Fq;q.type===W.Dg?(q.gw=d.oK,Ta.copy(d.direction,q.HD),S(b,q)):Ta.copy(d.direction,q.HD);break;case "HEMI":case "POINT":case "SPOT":break;default:Ha.error("Unknown light type: "+
d.type+'".')}q=q.Ra;for(p=0;p<q.length;p++)for(h=q[p].sa,m=0;m<h.length;m++)u=h[m].za,u.wm&&ja.uY(u,a)}c=na(b,W.Pb).p;g=g.vD;d=b.s.ud;for(k=0;k<g.length;k++)q=g[k],ka.sD(q.p,e,f),ga(q,b,c,d,!0),ca(q,b.s.Xa)}function ba(a){var b=Ra.Ub(a,"LAMP",Ra.oc),b=I.fv(b,Aa.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],f=d.k,g=ra.hc(f.n,qb),f=ra.Xd(f.n,Bb),e=0;e<d.I.length;e++){var k=d.I[e],q=k.vD;if(k.yb==a)for(k=0;k<q.length;k++)ka.sD(q[k].p,g,f)}}function S(a,b){X.Aw(b);Sa.Nn(b);
if(b.gw)for(var c=Y(a,bb),d=0;d<c.length;d++)for(var f=c[d].Ra,g=0;g<f.length;g++)for(var e=f[g].sa,k=0;k<e.length;k++){var q=e[k];q.cc&&(q=q.za,ja.FR(q)&&Sa.$Z(q))}}function sa(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,f=0;f<d.materials.length;f++){var g=d.materials[f];-1==b.indexOf(g)&&b.push(g)}return b}function oa(a,b,c){for(var d=a.s,f=I.ka(a.Cj,a).da,g=0;g<f.length;g++){var e=f[g];ka.Ik(e,b/c);d.ud&&ka.eE(e,d.ud)}d.ud&&(d.hw=!0,na(a,W.yf).Ba=!0,na(a,W.Pc).Ba=!0);var k=d.Xa;fa.QZ(k,
function(d,f,g){if(d.Qs){var e=d.Rm*b,q=d.Sm*c;if(f)for(f=0;f<g.Za.length;f++)g.Za[f]==d&&Qa.resize(d.kb,e,q);else switch(Qa.fo(d.kb)&&Qa.resize(d.kb,e,q),d=g.p,d.width=e,d.height=q,g.type){case W.xp:ya(a,{dof_power:g.p.dof_power});break;case W.zp:la(a,{small_glow_mask_width:g.small_glow_mask_width,large_glow_mask_width:g.large_glow_mask_width});break;case W.rp:wa(a,{bloom_blur:g.Bn});break;case W.qn:g=fa.Db(k,g,W.fc);e=fa.Db(k,g,W.fc);q=fa.Db(k,e,W.fc);d=fa.Db(k,q,W.fc);fa.Jd(g,1/b,1/c);fa.Jd(e,
1/b,1/c);fa.Jd(q,1/b,1/c);fa.Jd(d,1/b,1/c);break;default:fa.Jd(g,1/b,1/c)}}})}function Y(a,b){for(var c=[],d=0;d<b.length;d++){var f=b[d];pa.pa(a.s.Xa,function(a,b){b.type==f&&c.push(b)})}return c}function na(a,b){return fa.gc(a.s.Xa,b)}function ya(a,b){var c=na(a,W.xp);if(!c)return Ha.error("DOF is not enabled on the scene. Check camera settings"),0;var d=c.p.dof_bokeh,f=d?Y(a,[W.$x]):[],g=a.s.Xa;if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,d))for(var e=0;e<f.length;e++)f[e].p.dof_on=b.dof_on;
if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,d))for(e=0;e<f.length;e++)f[e].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,d))for(e=0;e<f.length;e++)f[e].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,d))for(e=0;e<f.length;e++)f[e].p.dof_front_end=b.dof_front_end;if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,d))for(e=0;e<f.length;e++)f[e].p.dof_rear_start=
b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,d))for(e=0;e<f.length;e++)f[e].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.dof_bokeh_intensity&&(c.p.dof_bokeh_intensity=b.dof_bokeh_intensity,d&&(f=fa.iB(g,c,W.fc),f[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity,f[1].p.dof_bokeh_intensity=b.dof_bokeh_intensity,f[0]=fa.Db(g,f[0],W.fc),f[0].p.dof_bokeh_intensity=b.dof_bokeh_intensity));if("number"==typeof b.dof_power)if(d){d=b.dof_power;c.p.dof_power=d;var d=
d/2,e=c.p.width,k=c.p.height,q=[1/e,0],p=[1/e*.5,1/k*.866],h=[-1/e*.5,1/k*.866],f=fa.iB(g,c,W.fc);fa.Lc(f[0],d);fa.Jd(f[0],h[0],h[1]);fa.Lc(f[1],d);fa.Jd(f[1],p[0],p[1]);f[0]=fa.Db(g,f[0],W.fc);fa.Lc(f[0],d);fa.Jd(f[0],q[0],q[1]);c.p.Cd&&(f[0]=fa.Db(g,f[0],W.$x),f[0]=fa.Db(g,f[0],W.fc),fa.Jd(f[0],1/e,1/k),f[0]=fa.Db(g,f[0],W.fc),fa.Jd(f[0],1/e,1/k))}else c.p.dof_power=b.dof_power,f=fa.Db(g,c,W.fc),g=fa.Db(g,f,W.fc),fa.Lc(f,c.p.dof_power),fa.Jd(f,1/c.p.width,1/c.p.height),fa.Lc(g,c.p.dof_power),fa.Jd(g,
1/c.p.width,1/c.p.height)}function wa(a,b){var c=na(a,W.Bt),d=na(a,W.rp);if(!c||!d)return Ha.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.du=b.key,c.Ba=!0);"number"==typeof b.edge_lum&&(c.cu=b.edge_lum,c.Ba=!0);if("number"==typeof b.blur){var f=a.s.Xa,c=fa.Db(f,d,W.sp),f=fa.Db(f,c,W.sp);d.Bn=b.blur;fa.Lc(c,b.blur);fa.Jd(c,1/d.p.width,1/d.p.height);fa.Lc(f,b.blur);fa.Jd(f,1/d.p.width,1/d.p.height)}}function la(a,b){var c=na(a,W.zp);if(!c)return Ha.error("Glow is not enabled on the scene"),
null;for(var d=a.s.Xa,f=fa.iV(d,c),g=0;g<f.length;++g){var e=f[g];if(e.type==W.fc&&"GLOW_MASK_LARGE"==e.Fb)var k=e;if(e.type==W.fc&&"GLOW_MASK_SMALL"==e.Fb)var q=e}f=fa.Db(d,k,W.fc);d=fa.Db(d,q,W.fc);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.Ba=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.Ba=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,fa.Lc(q,b.small_glow_mask_width),
fa.Jd(q,1/c.p.width,1/c.p.height),q.Ba=!0,fa.Lc(d,b.small_glow_mask_width),fa.Jd(d,1/c.p.width,1/c.p.height),d.Ba=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,fa.Lc(k,b.large_glow_mask_width),fa.Jd(k,1/c.p.width,1/c.p.height),k.Ba=!0,fa.Lc(f,b.large_glow_mask_width),fa.Jd(f,1/c.p.width,1/c.p.height),f.Ba=!0)}function ha(a,b,c){var d=a.s,f=d.Mc;if(!f.ar)return f.el;var g=f.waves_height,e=f.waves_length,k=f.el,q=Ta.length(d.zj)||1;a=na(a,W.Pb).time;
a*=q;var p=Wb;p[0]=20/e*(b-.25*a);p[1]=20/e*(c-.25*a);q=La.yG(p);p[0]=17/e*(c+.1*a);p[1]=17/e*(b+.1*a);var p=La.yG(p),q=q+p-1,h=f.dst_noise_scale0,p=f.dst_noise_scale1,m=f.dst_noise_freq0,u=f.dst_noise_freq1,B=Wb;B[0]=h*(b+m*a);B[1]=h*(c+m*a);h=La.AD(B);B[0]=p*(c-u*a);B[1]=p*(b-u*a);p=La.AD(B);p*=g*h;if(f.Lk)if(u=(b-f.Lo[0])/f.Mo[0],B=(f.Lo[1]+c)/f.Mo[1],u+=.5,B+=.5,1<u||0>u||1<B||0>B)f=p;else{var d=La.lI(d.wD,f.xD,u,B),B=f.dir_freq,l=f.dir_noise_scale,n=f.dir_noise_freq,h=f.dir_min_noise_fac,u=f.dst_min_fac,
m=e/f.YB/Math.PI;c=[l/e*(b+n*a),l/e*(c+n*a)];b=Math.sqrt(d);f=g*Math.max(d,f.dir_min_shore_fac)*Math.sin(b/m+B*a)*Math.max(La.AD(c),h);g=Math.max(b,u);f=f*(1-g)+p*g;q*=d}else f=p;return k+(f+.05*q)}function ta(a,b){a.Fr&&a.type==W.fc&&b.cc!=a.cc&&(a.cc=b.cc);b.cc||a.type!=W.qn||(a.LA=0)}function ma(a,b,c,d){var f=pa.Wa(a,b);ka.Qw(f.p,c,d);f.wz=!0;pa.Sk(a,b,function(b,f,g){g.Gc&&g.from==c&&fa.TR(g)&&N(a,b,g.to,d)});pa.ni(a,b,function(b,f,g){g.Gc&&g.from==c&&g.from==g.to&&ma(a,b,c,d)})}function N(a,
b,c,d){a=pa.Wa(a,b).Ra;for(b=0;b<a.length;b++)for(var f=a[b].sa,g=0;g<f.length;g++)ja.QX(f[g].za,d,c)}function ea(a){var b=na(a,W.vi);if(b){var c=b.p,d=a.Cj.k;a=ra.hc(d.n,qb);var f=nd;f[0]=0;f[1]=0;f[2]=-b.je[2]/2;b=ra.Xd(d.n,Bb);Ta.transformQuat(f,b,f);f[0]+=a[0];f[1]+=a[1];f[2]=0;Ac.identity(b);ka.sD(c,f,b)}}function B(a,b){pa.pa(a,function(c,d){if(d.type==W.zh){d.Za[0]&&d.mi[0]||La.q("Wrong MOTION_BLUR subscene");var f=d.Za[0],g=d.mi[0];d.mi[0]=d.p.wc;pa.Sk(a,c,function(b,c,d){d.Gc&&N(a,b,d.to,
g)});ma(a,c,f.from,g);N(a,c,f.to,d.mi[0]);d.hK=Math.exp(-b/d.mb_factor)}})}function za(a){return a.s.zj}function ua(a,b){if(!a.s.ei)return null;for(var c=a.s.ei.Ji,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.s.ei.xA;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var ja=l("__batch"),xa=l("__boundings"),ka=l("__camera"),Pa=l("__config"),Ea=l("__container"),Ca=l("__debug"),pa=l("__graph"),Ba=l("__hud"),va=l("__input"),Ma=l("__mat4"),Ga=l("__nodemat"),Ra=l("__objects"),I=l("__obj_util"),V=l("__physics"),
X=l("__prerender"),Cb=l("__primitives"),Ha=l("__print"),Ac=l("__quat"),Sa=l("__renderer"),fa=l("__scenegraph"),Da=l("__sfx"),qa=l("__shaders"),W=l("__subscene"),Qa=l("__textures"),ra=l("__tsr"),La=l("__util"),Ta=l("__vec3"),pb=l("__vec4"),Ua=l("__version"),Aa=Pa.B,ab=Pa.Gi,Ya=Pa.Vc,Ka=Pa.Eo,kb=[W.vi,W.cd,W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.xf,W.Oe,W.tf,W.ui,W.yf,W.Cg,W.wf];a.M1=kb;var eb=[W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.Bj,W.xt,W.Dg,W.xf,W.Oe,W.Bt,W.yf,W.cd,W.tf,W.ui,W.Cg],bb=[W.Pb,W.Jt,W.Pc,W.Uf,W.ge,
W.Nd,W.md,W.xf,W.Oe],sb=[W.cd,W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.xf,W.Oe,W.tf,W.ui,W.yf,W.Bj,W.Cg,W.wf],lb=[W.Pb,W.Pc,W.Uf,W.ge,W.Nd,W.md,W.xf,W.Oe],nb=null,wb=null,Va=[],Ob=null,ic=Math.PI/2,Wb=new Float32Array(2),qb=new Float32Array(3),nd=new Float32Array(3),Bb=new Float32Array(4),fb=new Float32Array(4),jc=new Float32Array(16),Nc=new Float32Array(24),Wc=new Float32Array(24),tc=xa.Qd(),Qc=xa.Qd(),Ib=0,ec=-Infinity;a.t3=function(){return{}};a.Pw=function(a){wb=a;Da.fY(a)};a.zX=function(a,b){var c=a.s,
d=fa.IS(c.Xa);if(a==b){oa(a,Ea.eJ(),Ea.dJ());for(var f=0;f<d.length;f++)a.s.Mm.push(d[f])}else for(f=a.Vf[0],oa(a,f.nj,f.nj),f=0;f<d.length;f++)b.s.Mm.push(d[f]);d=Y(a,sb);for(f=0;f<d.length;f++)d[f].zj.set(c.zj);for(f=0;f<c.Mm.length;f++)c.Mm[f].type==W.cd&&Sa.Nn(c.Mm[f])};a.Rh=function(){nb||(nb=n(Va));return nb};a.Ru=n;a.A=e;a.Da=function(){return wb?!0:!1};a.dm=function(a){return a.Cj};a.pr=function(){return Va};a.kB=function(){if(1==Va.length)return Va;for(var a=0;a<Va.length;a++){var b=Va[a].s.Xa;
pa.pa(b,function(b,c){for(var d=c.Ra,f=0;f<d.length;f++)for(var g=d[f].sa,e=0;e<g.length;e++){for(var k=g[e],q=k.za.ya,p=null,h=0;h<q.length;h++)if("SCENE"==q[h].source&&q[h].Hs==Va[a].name&&c.type!=W.by){Ha.error('Texture-scene loop detected. A scene is rendered to texture "'+q[h].name+'" yet this texture belongs to the same scene.');pa.gh(Ob,Va[a]);p=k.za;break}p&&(p.ya=[],p.Ld=[],ja.ZZ(p,null),ja.Yc(p),W.Sc(c,k))}})}for(var c=[],a=0;a<Va.length;a++)if(b=Va[a],!b.Vf.length){b=pa.gh(Ob,b);pa.TT(Ob,
b);b=pa.nx(Ob,b,pa.lt);b=pa.UD(b);pa.pa(b,function(a,b){c.push(b)});break}return c};a.sQ=function(a,e,q,u,B){a.Vf=a.Vf||[];a.ra=null;var l=a.s,n=I.ka(a.Cj,a),t=a.Cj.k;l.np=[];var E=a.world;l.hW=q.length;l.rj=r(q);l.ex=f(E,l.rj);l.qp=Q(E,l.ex);l.KN=L(E);if(E=!a.Vf.length)a:{if("HMD"==Aa.stereo){if(n.da[0].type!=ka.Od){Ha.warn("Head-mounted display stereo is disabled for the non-perspective camera");Aa.stereo="NONE";E=!1;break a}if(!va.hu(va.xd)){Ha.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Aa.stereo="NONE";E=!1;break a}}E="HMD"==Aa.stereo}l.xv=E;if(E=!a.Vf.length)n.da[0].type!=ka.Od&&"ANAGLYPH"==Aa.stereo?(Ha.warn("Anaglyph stereo is disabled for the non-perspective camera"),Aa.stereo="NONE",E=!1):E="ANAGLYPH"==Aa.stereo;l.anaglyph_use=E;l.jQ=!l.xv&&!l.anaglyph_use&&g(a,B);l.ei=k(a,e,u);l.dR=c(a);l.SW=C(a);l.DR=O(a);l.vV=J(a);l.fX=K(a);l.$j=D(a);l.dof=Aa.dof&&(0<t.dof_distance||t.dof_object);l.motion_blur=Aa.motion_blur&&a.b4w_enable_motion_blur;l.compositing=Aa.compositing&&a.b4w_enable_color_correction;
l.antialiasing=Aa.antialiasing&&1==Aa.Fc&&"NONE"!=a.b4w_antialiasing_quality;l.ssao=Aa.ssao&&a.b4w_enable_ssao;l.god_rays=Aa.god_rays&&a.b4w_enable_god_rays&&l.rj;l.zT=Aa.Hu;l.kv=a.b4w_glow_settings.render_glow_over_blend;l.pZ=v(a);B=m(u);l.cK=B;l.refractions=M(a,B);l.ud=b(a,q,u);l.Mc=w(u);l.vh=x(u);l.$Y=h(u);l.Kk=A(u);l.hd=H(a,u);l.gS=z(a,u);l.outline=d(a,u);l.Ui=p(a,u);switch(a.b4w_reflection_quality){case "LOW":l.Ki=Ka.rH;l.kh=Ka.GK;break;case "MEDIUM":l.Ki=Ka.sT;l.kh=Ka.rX;break;case "HIGH":l.Ki=
Ka.rT;l.kh=Ka.qX;break;default:l.Ki=Ka.rH,l.kh=Ka.GK}Ea.XV()?(Ha.log("%cENABLE HIDPI MODE","color: #00a"),l.zF="AA_QUALITY_LOW",l.Bo=1,Aa.Fc=1):1<Aa.Fc?(Ha.log("%cENABLE MSAA RENDERING: "+Aa.Fc+"x","color: #00a"),l.Bo=1):(l.zF="AA_QUALITY_"+a.b4w_antialiasing_quality,l.Bo="MEDIUM"===a.b4w_antialiasing_quality&&Aa.quality===Pa.rn||"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Pa.jl?1.33:"HIGH"===a.b4w_antialiasing_quality&&Aa.quality===Pa.rn||"NONE"===a.b4w_antialiasing_quality&&Aa.quality===Pa.rn?
2:1);q=a.Vf.sort(function(a,b){return b.nj-a.nj});l.Xa=fa.HS(l,n,t,q);l.Mm=[];l.hw=!1;l.kC=!1;l.lC=!1;l.zj=new Float32Array(3);Va.push(a);Ob||(Ob=pa.create());pa.J(Ob,a);for(l=0;l<e.length;l++)I.bD(e[l],!0,a);a=Ea.Ce();Ea.resize(a.clientWidth,a.clientHeight,!0)};a.tQ=function(a,b,c){for(var d=0;d<b.length;d++){var f=b[d].s;f&&f.tm&&(f.et=c,a.s.np.push(b[d]))}};a.hB=function(a){return a.s.Xa};a.bI=function(a,b){pa.pa(b,function(c,d){var f=null;switch(d.type){case W.fc:f=ja.qA(d.zw);break;case W.Jt:f=
ja.NS(d);break;case W.gz:f=ja.OS(d);break;case W.CE:f=ja.tS();break;case W.Bj:fa.Db(b,d,W.tn)||fa.Db(b,d,W.wf)||fa.Db(b,d,W.Pc)||fa.Db(b,d,W.Bj);f=ja.xS(d.AK,d.yj,d.Xo);break;case W.xt:fa.Db(b,d,W.tn)||fa.Db(b,d,W.wf)||fa.Db(b,d,W.Pc);fa.Db(b,d,W.Bj);f=ja.yS();break;case W.zh:f=ja.CS();break;case W.$x:f=ja.qS(d.RG);break;case W.xp:var f=ja.uS(d),g=d.p.dof_power;if(d.p.dof_bokeh){var g=g/2,e=fa.iB(b,d,W.fc);fa.Lc(e[0],g);fa.Lc(e[1],g);e[0]=fa.Db(b,e[0],W.fc);fa.Lc(e[0],g)}else{var e=fa.Db(b,d,W.fc),
k=fa.Db(b,e,W.fc);fa.Lc(e,g);fa.Lc(k,g)}break;case W.qn:var f=ja.DS(),g=fa.Db(b,d,W.fc),e=fa.Db(b,g,W.fc),k=fa.Db(b,e,W.fc),q=fa.Db(b,k,W.fc);fa.Lc(e,d.Bz);fa.Lc(g,d.Bz);fa.Lc(q,d.RA*d.$r);fa.Lc(k,d.RA*d.$r);break;case W.zp:f=ja.wS();break;case W.ay:f=ja.rS();break;case W.vE:f=ja.lS(d);break;case W.ez:case W.Ht:case W.Pp:case W.It:f=ja.LS(d.type);break;case W.xi:f=ja.PS(d.Fb);break;case W.Dg:f=ja.sS(a,d);break;case W.LUMINANCE:f=ja.zS();break;case W.ON:f=ja.mS();break;case W.Bt:f=ja.AS();break;case W.sp:f=
ja.oS();break;case W.rp:f=fa.Db(b,d,W.sp);g=fa.Db(b,f,W.sp);fa.Lc(f,d.Bn);fa.Lc(g,d.Bn);f=ja.pS();break;case W.VP:f=ja.mT();break;case W.ln:f=ja.kS();break;case W.Lp:f=ja.ES()}f&&(g=W.Vh(f,I.Nq("NONE")),W.Sc(d,g),P(b,d,f),F(f))})};a.yn=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var d=a.s.Xa,f=b.k;!fa.gc(d,W.cd)&&f.fe&&(f.fe=!1);f=Y(a,kb);c&&b.bn&&V.yn(b,a);for(var g=0;g<f.length;g++){var e=f[g],k=b,q=d,p=a,h=c;switch(e.type){case W.Pb:da(e,k,q,"OPAQUE",p,h);break;case W.Pc:da(e,
k,q,"BLEND",p,h);break;case W.Uf:da(e,k,q,"XRAY",p,h);break;case W.ge:da(e,k,q,"GLOW",p,h);break;case W.Nd:case W.md:R(e,k,q,!1,p,h);break;case W.xf:case W.Oe:R(e,k,q,!0,p,h);break;case W.yf:for(var m=I.ka(k,p).W,u=0;u<m.length;u++){var B=m[u];if("SHADOW"==B.type&&"RECEIVE"==B.Fb&&B.fe){if(!h&&(G(B,e,k,q,"SHADOW",p),!ja.Yc(B)))continue;var l=W.Vh(B,k.k);W.Sc(e,l);P(q,e,B);F(B)}}break;case W.cd:m=!1;u=k.k;k=I.ka(k,p).W;B=fa.gc(q,W.vi);for(l=0;l<k.length;l++){var n=k[l];if("SHADOW"==n.type&&"CAST"==
n.Fb){m=!0;if(!h){var t=e.lw;ja.jf(n,"NUM_LIGHTS",t);ja.jf(n,"NUM_LFACTORS",0==t%2?t/2:Math.floor(t/2)+1);qa.ia(n.ib,"SHADOW_USAGE","SHADOW_CASTING");n.hd&&B&&U(n,B,u);ja.jf(n,"SHADOW_TEX_RES",qa.N(p.s.ud.csm_resolution));if(!ja.Yc(n))continue}n=W.Vh(n,u);W.Sc(e,n)}}m&&(k=p.s.ud,h=fa.gc(q,W.Pb),ga(e,p,h.p,k,!0));break;case W.tf:E(e,k,q,p,h);break;case W.ui:E(e,k,q,p,h);break;case W.Cg:m=k.k;u=I.ka(k,p).W;for(B=0;B<u.length;B++)if(l=u[B],"COLOR_ID"==l.type&&"OUTLINE"==l.Fb){if(!h&&(G(l,e,k,q,"COLOR_ID",
p),ja.jf(l,"USE_OUTLINE",1),!ja.Yc(l)))continue;l=W.Vh(l,m);W.Sc(e,l)}break;case W.vi:q=k.k;k=I.ka(k,p).W;for(p=0;p<k.length;p++)if(m=k[p],"GRASS_MAP"==m.type){if(!h&&!ja.Yc(m))if("DEBUG"===Ua.type())ja.Wt(m,"error.glslv","error.glslf"),ja.Yc(m);else continue;m=W.Vh(m,q);W.Sc(e,m);m=e.p;n=q.Ua;u=e.je[0];B=e.je[1];l=e.je[2];0==u&&0==B?(u=n.min_z,B=n.max_z):(u=Math.min(u,n.min_z),B=Math.max(B,n.max_z));n=1E-4*(B-u);u-=n;B+=n;e.je[0]=u;e.je[1]=B;ka.Sw(m,l/2,-B,-u,l/2);ka.Ik(m)}break;case W.wf:for(m=
k.k,k=I.ka(k,p).W,p=0;p<k.length;p++)u=k[p],"DEBUG_VIEW"==u.type&&aa(e,m,q,h,u)}}break;case "LAMP":T(b,a),Ra.eZ(a)}I.bD(b,!0,a)};a.gE=t;a.cD=function(a){a.s.hw=!0};a.w_=function(a,b){pa.pa(b,function(b,c){if(c.type===W.cd){var d=ra.hc(a.n,qb);ra.kf(d,c.p.n);ra.copy(a.qf,c.p.Es)}})};a.R9=ca;a.SU=function(a,b){for(var c=a.s.ud,d=new Float32Array(c.csm_num),f=0;f<c.csm_num;f++)d[f]=ka.pT(c,b,f);return d};a.b2=aa;a.AG=ia;a.tq=q;a.GB=function(a){return a.k.Uh};a.JX=function(a){for(var b=0;b<a.I.length;b++)for(var c=
Y(a.I[b].yb,kb),b=0;b<c.length;b++)for(var d=c[b].Ra,f=0;f<d.length;f++)for(var g=d[f].sa,e=g.length-1;0<=e;e--){var k=g[e];k.ff==a.k&&(k.za&&ja.OG(k.za),g.splice(e,1))}};a.k_=function(a,b){for(var c=a.ub,d=I.ka(a,b).xm,f=Y(b,eb),g=0;g<f.length;g++){var e=f[g];e.Pr.set(c.Fq,4*d);e.Ba=!0}};a.hp=T;a.y_=function(a){a=a.I;for(var b=0;b<a.length;b++)t(a[b].yb)};a.ua=function(){for(var a=0;a<Va.length;a++){var b=Va[a];pa.pa(b.s.Xa,function(a,b){if(b.type!=W.un){var c=b.p;Sa.KX(c.Ze,c.wc,c.Ve,c.width,c.height);
for(var c=b.Ra,d=0;d<c.length;d++)for(var f=c[d].sa,g=0;g<f.length;g++){var e=f[g].za;e&&ja.OG(e)}}});b.s.Xa=[];b.s.Mm=[]}wb=nb=null;Va.length=0;Ob=null};a.aK=function(a,b,c){a=ka.$T(a,a.near,a.far,null,!0);var d=Cb.FU(a);a=I.Nq("DYNAMIC");a.Ua=a.R={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.lb=a.wa=xa.$Q();var f=a.lb.Ya;a.qb=a.ba=xa.hq([f,0,0],[0,f,0],[0,0,f],a.lb.F);a.ip=!1;c=ja.KS(d,c);c=W.Vh(c,a);W.Sc(b,c)};a.C5=function(a){return[a.frame_start,a.frame_end]};a.WL=
function(a,b,c){Ea.TY(a,b,c);wb&&oa(wb,a,b)};a.V8=oa;a.FD=Y;a.La=na;a.vI=function(a){a=na(a,W.Pb);var b=a.ke,c=a.te,d=[],f=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];f[0]=c[0];f[1]=c[1];f[2]=c[2];return[a.Sg,d,f]};a.Rw=function(a,b,c,d){a=Y(a,eb);for(var f=0;f<a.length;f++){var g=a[f];g.ke.set(c);g.te.set(d);g.Sg=b;g.Ba=!0}};a.WI=function(a){if(a=na(a,W.Dg)){var b={};b.color=Array(3);Ta.copy(a.Oo,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.NL=function(a,b){var c=na(a,W.Dg);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.Oo.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.Ba=!0,c.gw=!0,S(a,c))};a.$U=function(a){return Y(a,bb)[0].dg[0]};a.YU=function(a){return Y(a,bb)[0].dg[1]};a.aV=function(a){return Y(a,bb)[0].dg[2]};
a.ZU=function(a){return Y(a,bb)[0].dg[3]};a.BL=function(a,b){for(var c=Y(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[0]=b;f.Ba=!0}};a.zL=function(a,b){for(var c=Y(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[1]=b;f.Ba=!0}};a.CL=function(a,b){for(var c=Y(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[2]=b;f.Ba=!0}};a.AL=function(a,b){for(var c=Y(a,bb),d=0;d<c.length;d++){var f=c[d];f.dg[3]=b;f.Ba=!0}};a.yI=function(a,b){var c=b||[],d=Y(a,bb)[0].Be;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.hD=function(a,
b){for(var c=Y(a,bb),d=0;d<c.length;d++){var f=c[d];f.Be.set(b);f.Ba=!0}};a.YI=function(a){var b=na(a,W.Jt);a=na(a,W.gz);if(!b)return null;var c=b.Ra[0].sa[0].za,d={};d.ssao_quality=ja.cB(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.mG=a.ssao_blur_discard_value;d.radius_increase=b.To;d.influence=b.So;d.dist_factor=b.Ro;d.ssao_only=b.ssao_only;d.ssao_white=ja.cB(c,"SSAO_WHITE")[1];return d};a.PL=function(a,b){var c=na(a,W.Jt),d=na(a,W.gz);if(!c)return Ha.error("SSAO is not enabled on the scene"),
0;var f=c.Ra[0].sa[0],g=f.za;"string"==typeof b.ssao_quality&&(ja.jf(g,"SSAO_QUALITY",b.ssao_quality),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_hemisphere&&(ja.jf(g,"SSAO_HEMISPHERE",b.ssao_hemisphere),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_blur_depth&&(ja.jf(g,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_white&&(ja.jf(g,"SSAO_WHITE",b.ssao_white),ja.Yc(g),W.Sc(c,f));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);
"number"==typeof b.To&&(c.To=b.To);"number"==typeof b.So&&(c.So=b.So);"number"==typeof b.Ro&&(c.Ro=b.Ro);if("number"==typeof b.ssao_only){c=na(a,W.Pb);c.ssao_only=b.ssao_only;for(var f=c.Ra,e=0;e<f.length;e++)for(var k=f[e].sa,q=0;q<k.length;q++)g=k[q].za,ja.jf(g,"SSAO_ONLY",b.ssao_only),ja.Yc(g),W.Sc(c,k[q])}c.Ba=!0;d.Ba=!0};a.tI=function(a){a=na(a,W.xp);if(!a)return null;var b={};b.dof_on=a.p.dof_on;b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;
b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.dof_bokeh=a.p.dof_bokeh;b.dof_bokeh_intensity=a.p.dof_bokeh_intensity;b.dof_object=a.p.dof_object;return b};a.yL=ya;a.BI=function(a){var b=Y(a,[W.Bj]);a=na(a,W.xt);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].ko;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ja.cB(b[0].Ra[0].sa[0].za,"STEPS_PER_PASS")[1];return c};a.EL=function(a,b){var c=Y(a,[W.Bj]),d=na(a,W.xt);if(!c||!d)return Ha.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var f=b.god_rays_max_ray_length,g=0;g<c.length;g++)c[g].ko=f,c[g].Gw=f/c[g].Xo/(g+1),c[g].Ba=!0;if("number"==typeof b.god_rays_steps)for(var e=qa.N(b.god_rays_steps,1),f=c[0].ko,g=0;g<c.length;g++){c[g].Xo=e;c[g].Gw=f/e/(g+1);c[g].Ba=!0;var k=c[g].Ra[0].sa[0],q=k.za;ja.jf(q,"STEPS_PER_PASS",e);ja.Yc(q);W.Sc(c[g],k)}d.Ba=!0};a.nI=function(a){var b=na(a,W.Bt);a=na(a,
W.rp);if(!b||!a)return null;var c={};c.key=b.du;c.edge_lum=b.cu;c.blur=a.Bn;return c};a.qL=wa;a.AI=function(a){a=na(a,W.zp);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.DL=la;a.jJ=function(a){var b=za(a);a=Ta.length(b);if(0==a)return null;var b=La.oe(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};
a.bY=function(a){a.s.kC=!0};a.gJ=ha;a.fJ=function(a,b){var c=a.s.Mc,d=na(a,W.Pb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.ri&&(b.water_fog_density=d.ri[3],c=b.water_fog_color=[],c[0]=d.ri[0],c[1]=d.ri[1],c[2]=d.ri[2]))};a.UL=function(a,b){var c=a.s.Mc;if(!c)return Ha.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);
"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);
"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.ar=b.water_dynamic);for(var d=Y(a,lb),f=0;f<d.length;f++){var g=d[f];"number"==typeof b.water_fog_density&&c.Be&&(g.ri[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Be&&g.ri.set(b.water_fog_color);"number"==typeof b.waves_height&&(g.pE=b.waves_height);"number"==typeof b.waves_length&&(g.qE=b.waves_length);g.Ba=!0}};a.VI=
function(a,b,c){var d=a.s.Mc;if(!d.Lk)return 100;var f=d.YB;a=d.el;var g=(b[0]-d.Lo[0])/d.Mo[0],e=(d.Lo[1]+b[1])/d.Mo[1],g=g+.5,e=e+.5;if(1<g||0>g||1<e||0>e)b=1;else return d=f*La.lI(wb.s.wD,d.xD,g,e),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,b){for(var c=e().Cj.k,d=0;d<Va.length;d++){var f=Va[d],g=f.s.Xa,k=f.s;if(k.Mc)var q=ra.G(c.n),p=q[2]-ha(f,q[0],q[1]);for(q=0;q<k.np.length;q++){var h=k.np[q].s,m=h.Ta,l=h.td;if(!(f.b4w_use_nla&&h.Xk||!m&&!l)&&Qa.FN(h)){var n=Qa.CN(h),t=Qa.EN(h);
m&&Aa.is_mobile_device&&(t-=5);var E=Qa.R_(h);n>=E&&h.vj||n<t?(Qa.gL(h),l&&(h.Fk=Qa.Ow(h,a))):n>=E&&!h.vj?Qa.yC(h):Qa.GN(h)&&(m?Qa.jN(h):(m=Qa.Ow(h,a),m!=h.Fk&&(Qa.iN(h),h.lj++),h.Fk=m))}}pa.pa(g,function(b,c){-1<sb.indexOf(c.type)&&(c.time=a);k.Mc&&(c.Oz=p)})}for(d=0;d<Va.length;d++)if(f=Va[d],k=f.s,g=k.Xa,c=k.Mm,c.length)for(k.hw&&(Z(f),k.hw=!1),k.kC&&(ea(f),k.kC=!1),k.lC&&(u(f),k.lC=!1),k.motion_blur&&B(g,b),f=fa.gc(g,W.Cg),q=0;q<c.length;q++)g=c[q],X.Aw(g),f&&ta(g,f),Sa.Nn(g);Aa.show_hud_debug_info&&
Ba.XY(Va,b)};a.TX=function(a){a.s.lC=!0};a.$A=function(a){var b=[];pa.pa(a.s.Xa,function(a,c){b.push(c)});return b};a.pI=function(){var a=na(wb,W.Pc),b=wb;return a||b.s.Mc?a.Oz:null};a.hN=function(a){pa.pa(a.s.Xa,function(a,b){b.Ba=!0})};a.kY=function(a,b){a.debug_view_mode=b;a.cc=b!=Ca.pt;a.Lb=b==Ca.qt;a.Ba=!0;for(var c=e(),d=0;d<lb.length;d++){var f=na(c,lb[d]);f&&(f.JA=b==Ca.yp)}};a.jY=function(a,b){a.debug_colors_seed=b;a.Ba=!0};a.FY=function(a,b){a.xH=b;a.Ba=!0};a.QY=function(a,b){for(var c=
a.Ra,d=0;d<c.length;d++)for(var f=c[d].sa,g=0;g<f.length;g++){var e=f[g].za;Ta.copy(b,e.wireframe_edge_color);e.Ba=!0}};a.dN=function(a,b){var c=b.Qn,d=a.s.zj;if(c&&"WIND"==c.type&&d){Ta.transformQuat(La.nc,ra.P(b.k.n),d);Ta.normalize(d,d);Ta.scale(d,c.xM,d);for(var c=Y(a,sb),f=0;f<c.length;f++)c[f].zj.set(d);return!0}return!1};a.lX=function(a,b,c){var d=na(a,W.tf);if(d){var f=Ea.gm();ka.hY(d.p,b,c,f.clientWidth,f.clientHeight);X.Aw(d);d.cc&&Sa.Nn(d);if(a=na(a,W.ui))Ma.copy(d.p.xb,a.p.xb),Ma.copy(d.p.ld,
a.p.ld),La.Pn(a.p.ld,a.p.Ph),X.Aw(a),a.cc&&Sa.Nn(a);if(d.cc||a&&a.cc)return Sa.NC(a?a.p.Ze:d.p.Ze,0,0)}else Ha.error("Object Selection is not available on the scene");return null};a.JL=function(a){var b=e();if(b=na(b,W.qn))b.hj.set(a),b.Ba=!0};a.d6=za;a.bv=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.cN=function(a,b){var c=qb;Ta.negate(b,c);for(var d=0;6>d;d++){var f=a.Ll[d],g=a.Qq[d],e=a.p;Ma.translate(La.bO[d],
c,f);Ma.multiply(e.xb,f,e.ld);La.Pn(e.ld,g)}};a.fN=function(a,b,c){La.KZ(b,c,La.nc,a.p.rc)};a.QQ=function(a,b,c){var d=a.s.ud,f=a.s.ei;c=I.fv(c,Aa.ssao&&a.b4w_enable_ssao);if(f)for(var g=0;g<b.length;g++){var e=b[g],k=I.ka(e,a);if(-1!=e.k.Ed){var q=f.bi,p=f.yw,e=e.k.Ed;p.length?k.bi=p[e]:q.length&&(k.bi=q[e])}else-1!=e.k.Rd&&(q=f.Ji,p=f.xA,e=e.k.Rd,p.length?k.Ji=p[e]:q.length&&(k.Ji=q[e]))}for(g=0;g<c.length;g++)if(k=I.ka(c[g],a),d)for(b=Y(a,[W.cd]),f=0;f<b.length;f++)g==b[f].ph&&k.vD.push(b[f])};
a.bK=function(a,b){return a.timeline_markers[b]};a.Tw=function(a){var b=e();if(b=na(b,W.xi))a.distortion_coefs&&(b.Pl[0]=a.distortion_coefs[0],b.Pl[1]=a.distortion_coefs[1],b.Ba=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.Ba=!0),a.base_line_factor&&(b.Pl[2]=
a.base_line_factor,b.Ba=!0),a.inter_lens_factor&&(b.Pl[3]=a.inter_lens_factor,b.Ba=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.Ba=!0)};a.jK=function(b,c){for(var d=Va,f=0;f<d.length;f++)fa.YW(a.hB(d[f]),b,c)};a.UZ=function(a){for(var b=Ra.Ub(a,"LAMP",Ra.oc),c=Y(a,kb),d=0;d<c.length;d++)for(var f=c[d],g=f.Ra,e=0;e<g.length;e++)for(var k=g[e].sa,q=0;q<k.length;q++){var p=k[q],h=p.za;"MAIN"==h.type&&(ja.YZ(h,b,a),ja.Yc(h),W.Sc(f,p))}};a.D7=function(a){for(var b=0;b<Va.length;b++)pa.pa(Va[b].s.Xa,
function(b,c){for(var d=c.Ra,f=0;f<d.length;f++)for(var g=d[f].sa,e=0;e<g.length;e++){var k=g[e];k.za==a&&W.Sc(c,k)}})}};b4w.module.__hud=function(a,l){function n(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function e(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.s){var c=0,f=0,e=0;h.pa(a.s.Xa,function(a,k){if(k.type!=w.un){for(var h=Math.round(k.p.width)+"x"+Math.round(k.p.height),m=0,l=0;l<k.Ra.length;l++)m+=k.Ra[l].sa.length;l=k.Sq;if(k.type==w.md||k.type==w.Oe)m*=6;var n=k.cc,r=n?k.Cf:0;k.Ud||(k.Cf=0);var d=
n?" (\u2713)":" (\u2715)",p=w.GD(k);b(d,p,k.lw,h,l,"of",m,"  ",r.toFixed(3));k.Sq=0;n&&(c+=m,f+=l,e+=r)}});return[c,f,e]}b("No INFO")}function b(){for(var a=80+20*f[0],b=arguments[0],e=1;e<arguments.length;e++){for(var h="",l=0;l<m[e]-String(arguments[e]).length;l++)h+=" ";b+=h+arguments[e]}f[0]++;k.fillText(b,30,a)}function y(a,b,f){b*=a.uc;f.x=a.x+b;f.y=a.y;f.uc=a.uc-2*b;f.Ib=a.Ib}function r(a){return a.x+a.uc/2}function A(a){var b=k,f={x:0,y:0,uc:0,Ib:0},e=b.canvas.width,b=b.canvas.height;f.x=
0;f.y=0;f.uc=e;f.Ib=b;y(f,.01,f);e=.02*f.Ib;f.x=f.x;f.y+=e;f.uc=f.uc;f.Ib-=2*e;e=f.uc/8;f.x+=e*a;f.y=f.y;f.uc=e;f.Ib=f.Ib;y(f,.02,f);return f}var h=l("__graph");l("__print");var w=l("__subscene"),m=[5,30,4,10,5,3,5],k=null,f=[0,0];a.Xg=function(a){a=a.getContext("2d");n(a);return k=a};a.Qs=function(){k&&n(k)};a.reset=function(){var a=k;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),f[0]=0,f[1]=0)};a.XY=function(a,c){var h=
k;if(h){h.textAlign="left";h.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/c).toFixed(2));f[0]++;for(var m=h=0,l=0,n=0;n<a.length;n++){var r=e(a[n]),h=h+r[0],m=m+r[1],l=l+r[2];f[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",m,"of",h,"  ",l.toFixed(3))}};a.print=function(){var a=k;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.C7=function(a,b,f,e,h,m,l){var n=k;if(n){b=A(b);var w=b.Ib/5;b.x=b.x;b.y+=4*w;b.uc=
b.uc;b.Ib=w;n.textAlign="center";n.fillStyle="#00FF00";k.fillText(a,r(b),b.y-10);n.strokeStyle="#00FF00";n.lineWidth=.5;n.beginPath();n.moveTo(b.x,b.y);n.lineTo(b.x+b.uc,b.y);n.lineTo(b.x+b.uc,b.y+b.Ib);n.lineTo(b.x,b.y+b.Ib);n.closePath();n.stroke();if(!m&&!l)for(m=1E6,l=-1E6,a=0;a<f.length;a++)m=Math.min(m,f[a]),l=Math.max(l,f[a]);n.textAlign="right";k.fillText(String(m),b.x-10,b.y+b.Ib);k.fillText(String(l),b.x-10,b.y);n.textAlign="center";k.fillText(String(e),b.x,b.y+b.Ib+15);k.fillText(String(h),
b.x+b.uc,b.y+b.Ib+15);n.strokeStyle="#FF0000";n.lineWidth=1.5;n.beginPath();e=b.uc/(f.length-1);l=b.Ib/(l-m);for(a=0;a<f.length;a++)h=b.x+e*a,w=b.y+b.Ib-(f[a]-m)*l,0==a?n.moveTo(h,w):n.lineTo(h,w);n.stroke()}};a.I3=function(a,b,f,e,h,m,l){var n=k;if(n)for(n.textAlign="center",n.fillStyle="#00FF00",n.font="bold 12px Courier",f=A(f),k.fillText(b?"["+a+"]":a,r(f),f.y),0<=m&&k.fillText(m?"[M]":"[ ]",r(f)-15,f.y+30),0<=l&&k.fillText(l?"[S]":"[ ]",r(f)+15,f.y+30),a={x:0,y:0,uc:0,Ib:0},b=0;b<e.length;b++){m=
e[b];var w="VOLUME"==m[0];if(w){l=f.y+350;var H=f.uc,z=a;z.x=f.x;z.y=l;z.uc=H;z.Ib=250}else{l=f.y+50+50*b;var H=f.uc,z=f.Ib,d=a;d.x=f.x;d.y=l;d.uc=H;d.Ib=z}l=n;var H=a,d=b==h,p=m[0],z=m[1],M=m[2],x=m[3],g=(x-M)/m[4],g=1>g?Math.floor(1/g-1E-5).toFixed(0).length:0;m=m[5]?Math.log(z/M)/Math.log(x/M):(z-M)/(x-M);l.textAlign="center";d?l.fillText("["+p+"]",r(H),H.y):l.fillText(p,r(H),H.y);l.strokeStyle="#00FF00";l.lineWidth=w?3:1;w?(l.textAlign="right",l.fillText(x.toFixed(g),r(H)-10,H.y+15),l.textAlign=
"right",l.fillText(M.toFixed(g),r(H)-10,H.y+H.Ib-15)):(l.textAlign="right",l.fillText(M.toFixed(g),H.x+28,H.y+15),l.textAlign="left",l.fillText(x.toFixed(g),H.x+H.uc-28,H.y+15));l.beginPath();if(w){var P=H.y+15+(H.Ib-30)*(1-m);l.moveTo(r(H),H.y+15);l.lineTo(r(H),H.y+H.Ib-15);l.moveTo(r(H)-5,H.y+15);l.lineTo(r(H)+5,H.y+15);l.moveTo(r(H)-5,H.y+H.Ib-15);l.lineTo(r(H)+5,H.y+H.Ib-15);l.moveTo(r(H)-5,P);l.lineTo(r(H)+5,P)}else{var t=H.x+30+(H.uc-60)*m;l.moveTo(H.x+30,H.y+15);l.lineTo(H.x+H.uc-30,H.y+15);
l.moveTo(H.x+30,H.y+15-5);l.lineTo(H.x+30,H.y+15+5);l.moveTo(H.x+H.uc-30,H.y+15-5);l.lineTo(H.x+H.uc-30,H.y+15+5);l.moveTo(t,H.y+15-5);l.lineTo(t,H.y+15+5)}l.stroke();"EQ_Q"==p?(m=Math.log(1+1/(2*z*z)+Math.sqrt((2+1/(z*z))*(2+1/(z*z))/4-1))/Math.log(2),w?(l.textAlign="left",l.fillText(z.toFixed(g),r(H)+10,P),l.textAlign="left",l.fillText("("+m.toFixed(g+1)+")",r(H)+10,P+10)):(l.textAlign="right",l.fillText(z.toFixed(g),t,H.y+30),l.textAlign="left",l.fillText("("+m.toFixed(g+1)+")",t,H.y+30))):w?(l.textAlign=
"left",l.fillText(z.toFixed(g),r(H)+10,P)):(l.textAlign="center",l.fillText(z.toFixed(g),t,H.y+30))}}};b4w.module.__subscene=function(a,l){function n(a,b){a.lw=b;a.PB=new Float32Array(3*b);a.Qr=new Float32Array(4*b);a.Pr=new Float32Array(4*b)}function e(a){a={type:a,Fb:"",Lb:!1,AK:!1,wz:!1,gw:!1,Sq:0,Cf:0,Ml:[],debug_view_mode:0,debug_colors_seed:0,xH:1,JA:!1,time:0,p:null,Ll:null,Qq:[],Ra:[],Za:[],mi:[],zj:new Float32Array(3),je:new Float32Array(3),Be:new Float32Array(4),dg:new Float32Array(4),ye:new Float32Array(16),gx:0,Sg:0,lw:0,PB:null,Qr:null,Pr:null,U6:null,ke:new Float32Array(3),te:new Float32Array(3),
hx:new Float32Array(4),CM:new Float32Array(3),HD:new Float32Array([0,0,1]),DM:new Float32Array(4),fx:new Float32Array(3),$r:0,LA:0,Fr:!1,hj:new Float32Array(3),yj:!1,Oz:0,ri:null,pE:0,qE:0,el:0,Mc:null,Kg:!1,wG:0,xG:new Float32Array(2),vG:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Oo:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,To:0,So:0,Ro:0,rM:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,ko:0,Gw:0,Xo:0,wA:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Bx:null,Ax:null,kE:null,Hm:null,yc:!1,XH:"",du:0,Bn:0,cu:0,Bz:0,RA:0,mb_decay_threshold:0,mb_factor:0,hK:0,zw:"",RG:"",cW:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,RD:new Float32Array(2),Gb:new Float32Array(2),
Pl:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,ph:0,jC:!0,gM:!1,lM:!1,hM:!1,iM:!1,kM:!1,jM:!1,fM:"",Ys:!1,Zs:!1,$s:!1,cc:!0,Ud:!0,wb:!0,Bb:!0,Sd:!0,Ba:!0,wg:1};a.Gb[0]=1;a.Gb[1]=1;a.Pl[2]=.5;a.Pl[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function y(a,f){return-b(a.Eg,f.Eg)||b(a.pg,f.pg)||b(a.zb.uD,f.zb.uD)}var r=l("__camera"),A=l("__config"),h=l("__util"),w=l("__boundings"),m=A.Vc;a.Pb=0;a.Pc=1;a.Uf=2;a.Nd=3;a.md=4;a.xf=5;a.Oe=6;a.ge=7;a.cd=
8;a.yf=9;a.vi=10;a.fc=11;a.sp=12;a.zp=13;a.tn=14;a.tf=15;a.ui=16;a.wf=17;a.ln=18;a.CE=19;a.Jt=20;a.gz=21;a.vE=22;a.Pp=23;a.Ht=24;a.ez=25;a.It=26;a.ay=27;a.zh=28;a.$x=29;a.xp=30;a.Cg=31;a.qn=32;a.Bj=33;a.xt=34;a.Dg=35;a.by=36;a.xi=37;a.LUMINANCE=38;a.ON=39;a.Bt=40;a.rp=41;a.VP=42;a.un=43;a.Lp=44;a.fT=function(a,b,m,c){var l=e(8);l.wA=a;l.self_shadow_polygon_offset=m.self_shadow_polygon_offset;l.ph=b;switch(m.ah[b]){case "SPOT":case "POINT":l.p=r.gd(r.Od);a=h.oe(m.qM[b]);r.Sw(l.p,a,m.xq[b],m.wq[b]);
break;default:l.p=r.gd(r.yi)}n(l,c);return l};a.fS=function(a){var b=a.p;a.p=null;var e=h.S(a);a.p=b;e.p=r.Hc(b,!0);return e};a.ZS=function(){var a=e(10);a.p=r.gd(r.Bh);return a};a.Ad=function(a){var b=e(11);b.wb=!1;b.Bb=!1;b.Sd=!1;b.yc=!0;b.p=r.gd(r.pd);b.zw=a;switch(a){case "NONE":b.Gb[0]=1;b.Gb[1]=1;break;case "GRAYSCALE":b.Gb[0]=1;b.Gb[1]=1;break;case "X_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_BLUR":b.Gb[0]=0;b.Gb[1]=1;break;case "X_GLOW_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_GLOW_BLUR":b.Gb[0]=
0;b.Gb[1]=1;break;case "X_DOF_BLUR":b.Gb[0]=1;b.Gb[1]=1;break;case "Y_DOF_BLUR":b.Gb[0]=1;b.Gb[1]=1;break;case "X_ALPHA_BLUR":b.Gb[0]=1;b.Gb[1]=0;b.wg=3;break;case "Y_ALPHA_BLUR":b.Gb[0]=0;b.Gb[1]=1;b.wg=3;break;case "X_EXTEND":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_EXTEND":b.Gb[0]=0;b.Gb[1]=1;break;default:h.q("Wrong postprocessing effect: "+a)}return b};a.iH=function(a){var b=e(12);b.wb=!1;b.Bb=!1;b.Sd=!1;b.p=r.gd(r.pd);b.zw=a;b.yc=!0;switch(a){case "X_BLUR":b.Gb[0]=1;b.Gb[1]=0;break;case "Y_BLUR":b.Gb[0]=
0;b.Gb[1]=1;break;default:h.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.XS=function(a,b){var h=e(13);h.wb=!1;h.Bb=!1;h.Sd=!1;h.small_glow_mask_coeff=b.$j.small_glow_mask_coeff;h.large_glow_mask_coeff=b.$j.large_glow_mask_coeff;h.small_glow_mask_width=b.$j.small_glow_mask_width;h.large_glow_mask_width=b.$j.large_glow_mask_width;h.p=a;h.yc=!0;return h};a.Jl=function(a,b,m,c,l,r,w,y,D){var A=e(a);0==a?(A.wb=!0,A.Bb=m,A.Lb=!1):1==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):2==a?(A.wb=!1,A.Bb=!0,A.Lb=
!0):3==a||4==a?(A.wb=!0,A.Bb=!0,A.Lb=!1):5==a||6==a?(A.wb=!1,A.Bb=!1,A.Lb=!0):7==a?(A.wb=!0,A.Bb=!1,A.Lb=!0):h.q("wrong main subscene type");A.Lb&&y&&(A.self_shadow_normal_offset=y.self_shadow_normal_offset);A.p=b;if(a=w.Po)A.hx.set([a.jG,a.rJ,a.MN,a.LN]),A.fx.set(a.color),A.gx=a.Ea;A.ke.set(w.ke);A.te.set(w.te);A.Sg=w.Sg;A.Be=r.Be;A.dg=r.dg;c&&(A.Mc=c,c.Be&&(A.ri=new Float32Array(c.Be)),A.pE=c.waves_height,A.qE=c.waves_length,A.el=c.el,c.Kg&&D&&(A.Kg=!0,A.wG=c.BR,A.vG=c.AR,A.xG.set(c.CR)));n(A,l);
return A};a.wu=function(){var a=e(14);a.yc=!0;a.p=r.gd(r.pd);return a};a.jH=function(a,b,h){var c=e(15);b&&(c.type=16,c.wb=!1,c.Bb=!0);c.Ud=!1;c.p=a;n(c,h);return c};a.VS=function(a){var b=e(17);b.cc=!1;b.wb=!1;b.Bb=!1;b.p=a;return b};a.RS=function(a){var b=e(18);b.wb=!0;b.Bb=!1;b.p=a;return b};a.gT=function(a,b){var h=e(9);h.p=a;n(h,b);return h};a.WS=function(a){var b=e(19);b.wb=!1;b.Bb=!1;b.p=a;b.yc=!0;return b};a.iT=function(a,b,h){var c=e(20);c.wb=!1;c.Bb=!1;c.Sd=!1;c.p=a;c.Be=b.Be;c.ri=new Float32Array(b.Be);
c.To=h.radius_increase;c.ssao_hemisphere=h.CV;c.So=h.influence;c.Ro=h.dist_factor;c.rM=h.aY;c.yc=!0;return c};a.jT=function(a,b){var h=e(21);h.wb=!1;h.Bb=!1;h.Sd=!1;h.p=a;h.ssao_blur_depth=b.eR;h.ssao_blur_discard_value=b.mG;h.yc=!0;return h};a.QS=function(a){var b=e(22);b.wb=!1;b.Bb=!1;b.Sd=!1;b.wg=1/a.Bo;b.XH=a.zF;b.p=r.gd(r.pd);b.yc=!0;return b};a.uA=function(a,b){var h=e(a);h.wb=23==a||24==a?!0:!1;h.Bb=!1;h.Sd=!1;h.wg=1/b.Bo;h.p=r.gd(r.pd);23==a&&(h.dW=new Float32Array(4));h.yc=!0;return h};a.US=
function(a,b,h,c){var m=e(27);m.wb=!1;m.Bb=!1;m.Sd=!1;m.p=r.gd(r.pd);m.brightness=a;m.contrast=b;m.exposure=h;m.saturation=c;m.yc=!0;return m};a.bT=function(a,b){var h=e(28);h.wb=!1;h.Bb=!1;h.Sd=!1;h.p=r.gd(r.pd);h.wz=!0;h.mb_decay_threshold=a;h.mb_factor=b;h.yc=!0;return h};a.rA=function(a,b){var h=e(29);h.wb=!1;h.Bb=!1;h.Sd=!1;h.p=a;h.wg=h.p.dof_power;h.RG=b;h.yc=!0;return h};a.kH=function(a){var b=e(30);b.wb=!1;b.Bb=!1;b.Sd=!1;b.p=a;b.wg=b.p.dof_power;b.yc=!0;return b};a.dT=function(a,b){var h=
e(31);h.Sd=!1;h.p=a;n(h,b);return h};a.cT=function(a){var b=e(32);m.outlining_overview_mode?b.hj.set(m.hj):b.hj.set(a.hj);b.$r=a.$r;b.RA=5;b.Bz=3;b.Sd=!1;b.p=r.gd(r.pd);b.yc=!0;return b};a.tA=function(a,b,h,c,m,l,r){var w=e(33);w.wb=!1;w.Bb=!1;w.Sd=!1;w.ke=new Float32Array([1,1,1]);w.te=new Float32Array([1,1,1]);w.Sg=1;w.AK=c;w.yj=b;w.Gw=m;w.ko=h;w.Xo=r;w.p=a;n(w,l);return w};a.YS=function(a,b){var h=e(34);h.wb=!1;h.Bb=!1;h.Sd=!1;h.p=r.gd(r.pd);h.god_rays_intensity=a;n(h,b);h.yc=!0;return h};a.hT=
function(a,b,m,c){var l=e(35);l.Ud=!1;l.wb=!1;l.Bb=!1;l.Sd=!1;var w=r.gd(r.pd);w.width=c;w.height=c;l.p=w;l.Ll=h.DU();n(l,b);l.ke=new Float32Array([1,1,1]);l.te=new Float32Array([1,1,1]);l.Sg=1;l.Oo.set(m.Oo);l.procedural_skydome=m.procedural_skydome;l.use_as_environment_lighting=m.use_as_environment_lighting;l.rayleigh_brightness=m.rayleigh_brightness;l.mie_brightness=m.mie_brightness;l.spot_brightness=m.spot_brightness;l.scatter_strength=m.scatter_strength;l.rayleigh_strength=m.rayleigh_strength;
l.mie_strength=m.mie_strength;l.rayleigh_collection_power=m.rayleigh_collection_power;l.mie_collection_power=m.mie_collection_power;l.mie_distribution=m.mie_distribution;if(a){l.ke.set(a.ke);l.te.set(a.te);l.Sg=a.Sg;if(b=a.Po)l.hx.set([b.jG,b.rJ,b.MN,b.LN]),l.fx.set(b.color),l.gx=b.Ea,l.gM=b.invert,l.lM=b.rN,l.hM=b.mN,l.iM=b.nN,l.kM=b.pN,l.jM=b.oN,l.fM=b.kG;l.Ys=a.Ys;l.Zs=a.Zs;l.$s=a.$s}return l};a.sA=function(){var a=e(36);a.wb=!1;a.Bb=!1;a.p=r.gd(r.pd);a.yc=!0;return a};a.kT=function(a){var b=e(37);
b.wb=!1;b.Bb=!1;b.Fb=a?"HMD":"ANAGLYPH";b.p=r.gd(r.pd);b.yc=!0;return b};a.$S=function(){var a=e(38);a.wb=!1;a.Bb=!1;a.p=r.gd(r.pd);a.yc=!0;return a};a.SS=function(){var a=e(39);a.wb=!1;a.Bb=!1;a.p=r.gd(r.pd);a.yc=!0;return a};a.aT=function(a,b,h,c){var m=e(40);m.wb=!1;m.Bb=!1;m.du=a;m.cu=b;m.p=c;n(m,h);m.yc=!0;return m};a.TS=function(a){var b=e(41);b.wb=!1;b.Bb=!1;b.p=r.gd(r.pd);b.Bn=a;b.yc=!0;return b};a.v3=function(a){var b=e(42);b.wb=!1;b.Bb=!1;b.p=a;b.yc=!0;return b};a.lH=function(){var a=e(43);
a.Ud=!1;return a};a.eT=function(){var a=e(44);a.yc=!0;return a};a.GD=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.zw.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";
case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";
case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Sc=function(a,b){for(var e=b.za,c=e.zb,h=0;h<a.Ra.length;h++){var m=a.Ra[h].sa,l=m.indexOf(b);
-1!=l&&(m.splice(l,1),m.length||a.Ra.splice(h,1))}h=a.Lb?e.pg:0;a:{m=a.Ra;for(l=0;l<m.length;l++){var n=m[l];if(n.zb==c&&h==n.pg){m=n;break a}}m=null}m?m.sa.push(b):(a.Ra.push({zb:c,sa:[b],Eg:e.Eg,pg:h,cc:!0}),a.jC=!0)};a.Vh=function(a,b){var e={cc:!0,KA:[!0,!0,!0,!0,!0,!0],ff:b,za:a,Dv:null};if(a.sf&&a.Ca.le){var c=a.Ca.le;e.Dv={TW:new Float32Array(c.length),UW:new Float32Array(c.length),FT:new Float32Array(c.length/3),NN:new Float32Array(3),ZQ:w.qR(a.R)}}return e};a.dZ=function(a){a.Ra.sort(y);
a.jC=!1}};b4w.module.__input=function(a,l){function n(a){var b=U.Zf();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function e(a,b){if(!n(a))return null;var c={type:a,mh:!1,qg:[],hh:[],$i:[],be:[],aj:[],bj:[],Lr:[],OJ:[],Wi:[],uj:[],tj:[],sj:[],element:b,ci:!0,Xb:[],fw:new Float32Array(2),XW:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),pp:null,si:null,Tf:null,orientation:ga.create(),position:E.create(),
Ni:new Float32Array(4),Oi:new Float32Array(4),Vi:0,Hj:0,Ck:0,jn:0,bk:0,Ij:0,Zl:[],Zj:[0,0,0,0,0,0,0,0,0,0,0,0],YH:[0,0,0,0,0,0,0,0,0,0,0,0],Wu:[]};c.Ni[0]=c.Ni[1]=c.Ni[2]=c.Ni[3]=45;c.Oi[0]=c.Oi[1]=c.Oi[2]=c.Oi[3]=45;30==a||40==a||50==a?(c.mh=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.ci=!1)):10==a?c.mh=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ia.is_mobile_device?r(c,q.webvr):(y(c),c.mh=!0));return c}function b(b,c){10==b||20==b?c=window:c||
(c=40==b?document:R.Ce());for(var d=0;d<la.length;d++)if(la[d].type==b&&la[d].element==c)return la[d];d=e(b,c);60!=b&&70!=b&&80!=b&&90!=b||d.Wu.push(a.wy,a.rt,a.Dy,a.Ky,a.Ly,a.My,a.wt,a.Ep,a.Ny,a.Oy,a.xy,a.yy,a.st,a.tt,a.ut,a.vt,a.zy,a.Ay,a.By,a.Cy,a.Ey,a.Fy,a.Gy,a.Hy,a.Iy,a.Jy,a.Ap,a.Bp,a.Cp,a.Dp,a.qy,a.ry,a.sy,a.ty,a.uy,a.vy,a.oy,a.py);d&&la.push(d);return d}function y(a){var b=q.nonwebvr;a.jn=b.jn;a.bk=b.bk;a.Ij=b.Ij;r(a,b);a.Vi=b.Vi;a.Hj=b.Hj;a.Ck=b.Ck;h(a)}function r(a,b){a.distortion_coefs[0]=
b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function A(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function h(a){var b=a.Hj-a.Ij,c=a.bk-b,d=a.Vi/2,f=(a.jn-a.Vi)/2,b=ca.oe(Math.atan(b/a.Ck)),c=ca.oe(Math.atan(c/a.Ck)),d=ca.oe(Math.atan(d/
a.Ck)),f=ca.oe(Math.atan(f/a.Ck));c&&(a.Ni[0]=a.Oi[0]=Math.min(c,60));d&&(a.Ni[1]=a.Oi[3]=Math.min(d,60));b&&(a.Ni[2]=a.Oi[2]=Math.min(b,60));f&&(a.Ni[3]=a.Oi[1]=Math.min(f,60))}function w(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.pp=d;a.si=c}function m(a,b,c){switch(a.type){case 20:var d=
a.Tf||a.pp;d?(b=d.getEyeParameters(b),b=b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,d=A(a,Math.tan(ca.Cb(b.downDegrees))),ca.oe(Math.atan(d)),d=A(a,Math.tan(ca.Cb(b.upDegrees))),ca.oe(Math.atan(d)),d=A(a,Math.tan(ca.Cb(b.leftDegrees))),ca.oe(Math.atan(d)),a=A(a,Math.tan(ca.Cb(b.rightDegrees))),ca.oe(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Ni:a.Oi,aa.copy(b,c));break;default:u.error("fov is undefined for device: ",a.type)}return c}
function k(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ia.is_mobile_device?1:0:2;case 23:var c=a.Tf||a.pp;if(c){var d=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.Tf?c.offset[0]-d.offset[0]:c.eyeTranslation.x-d.eyeTranslation.x}return a.Vi}}function f(a,b){if(a.Tf){var c=a.Tf,d=c.capabilities,c=c.getPose();d.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],a.orientation[3]=
c.orientation[3]);d.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-sa&&(sa=b,navigator.getVRDisplays?a.Tf||navigator.getVRDisplays().then(function(b){0<b.length&&(a.Tf=b[0],a.mh=!0)},function(){u.O("WebVR displays are not found.");a.mh=!1}):navigator.getVRDevices?a.pp||oa||navigator.getVRDevices().then(function(b){w(a,b);b.length&&(a.mh=!0);oa=!0},function(){u.O("WebVR devices are not found.");a.mh=!1;oa=!0}):ia.is_mobile_device||
u.O("HMD isn't supported."))}function v(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.Zl[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.Zj[c]=a.axes[c]}}function c(a){for(var b=0;b<a.Zl;b++)a.Zl[b]=0;for(b=0;b<a.Zj.length;b++)a.YH[b]=a.Zj[b],a.Zj[b]=0}function C(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function O(a){return null===a}function J(a,b,c,f){switch(b){case 120:c&&C(a.qg,c);if(f||a.hh.every(O)&&a.qg.every(O))a.qg.length=0,a.hh.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("deviceorientation",D,!1));break;case 130:c&&C(a.hh,c);if(f||a.hh.every(O)&&a.qg.every(O))a.qg.length=0,a.hh.length=0,b=a.Xb.indexOf(131),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("deviceorientation",D,!1));break;case 40:c&&C(a.$i,c);if(f||a.$i.every(O))a.$i.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousedown",z,!1));break;case 30:c&&C(a.be,c);if(f||a.be.every(O))a.be.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("mousemove",L,!1));break;case 31:c&&C(a.be,c);if(f||a.be.every(O))a.be.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mousemove",H,!1));break;case 50:c&&C(a.aj,c);if(f||a.aj.every(O)){a.aj.length=0;b=a.Xb.indexOf(b);0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("mouseout",d,!1),a.element.removeEventListener("mouseup",p,!1));break}break;case 60:c&&C(a.bj,c);if(f||a.bj.every(O))a.bj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,
1),a.element.removeEventListener("wheel",M,!1));break;case 80:c&&C(a.Lr,c);if(f||a.Lr.every(O))a.Lr.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keydown",x,!1));break;case 70:c&&C(a.Wi,c);if(f||a.Wi.every(O))a.Wi.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("keyup",g,!1));break;case 90:c&&C(a.uj,c);if(f||a.uj.every(O))a.uj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchstart",P,!1));break;
case 100:c&&C(a.tj,c);if(f||a.tj.every(O))a.tj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchmove",t,!1));break;case 110:if(c&&C(a.sj,c),f||a.sj.every(O))a.sj.length=0,b=a.Xb.indexOf(b),0<=b&&(a.Xb.splice(b,1),a.element.removeEventListener("touchend",da,!1))}}function K(a,b){ca.rC(a,ca.jz,b);var c="orientation"in window?ca.Cb(window.orientation):"orientation"in window.screen?ca.Cb(window.screen.orientation.angle):0,c=ga.setAxisAngle(ca.Nc,c,ba);ga.multiply(b,
c,b);return b}function D(a){var c=S;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=ca.Cb(a.alpha),c[1]=ca.Cb(a.beta),c[2]=ca.Cb(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.hh.length;d++){var f=a.hh[d];f&&(E.copy(c,na),f(na))}if(a.qg.length)for(c=K(c,T),d=0;d<a.qg.length;d++)if(f=a.qg[d])ga.copy(c,ya),f(ya);for(d=0;d<a.qg.length;d++)a.qg[d]||a.qg.splice(d,1);for(d=0;d<a.hh.length;d++)a.hh[d]||a.hh.splice(d,1)}function Q(a,b){switch(a.type){case 30:a.fw[0]=b.clientX,a.fw[1]=
b.clientY,a.XW=b.which}}function L(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);Q(c,a);for(var d=0;d<c.be.length;d++){var f=c.be[d];f&&(Y[0]=a.clientX,Y[1]=a.clientY,f(Y))}c.ci&&a.preventDefault();for(d=0;d<c.be.length;d++)c.be[d]||c.be.splice(d,1)}}function H(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);Q(c,a);for(var d=0;d<c.be.length;d++){var f=
c.be[d];if(f){if("number"==typeof a.movementX)var g=a.movementX,e=a.movementY;else"number"==typeof a.webkitMovementX?(g=a.webkitMovementX,e=a.webkitMovementY):"number"==typeof a.mozMovementX?(g=a.mozMovementX,e=a.mozMovementY):e=g=0;Y[0]=g;Y[1]=e;f(Y)}}c.ci&&a.preventDefault();for(d=0;d<c.be.length;d++)c.be[d]||c.be.splice(d,1)}}function z(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);Q(c,a);for(var d=0;d<c.$i.length;d++){var f=
c.$i[d];f&&f(a.which)}c.ci&&a.preventDefault();for(d=0;d<c.$i.length;d++)c.$i[d]||c.$i.splice(d,1)}}function d(a){!R.DJ(a.relatedTarget)&&a.which&&p(a)}function p(a){if(!wa||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);Q(c,a);for(var d=0;d<c.aj.length;d++){var f=c.aj[d];f&&f(a.which)}c.ci&&a.preventDefault();for(d=0;d<c.aj.length;d++)c.aj[d]||c.aj.splice(d,1)}}function M(a){for(var c=b(30,a.currentTarget),d=0;d<c.bj.length;d++){var f=
c.bj[d];f&&f(-a.deltaY)}c.ci&&a.preventDefault();for(d=0;d<c.bj.length;d++)c.bj[d]||c.bj.splice(d,1)}function x(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.OJ:c.Lr,f=0;f<d.length;f++){var g=d[f];g?g(a.keyCode):d.splice(f--,1)}c.ci&&a.preventDefault()}function g(a){for(var c=b(40,a.currentTarget),d=0;d<c.Wi.length;d++){var f=c.Wi[d];f&&f(a.keyCode)}c.ci&&a.preventDefault();for(d=0;d<c.Wi.length;d++)c.Wi[d]||c.Wi.splice(d,1)}function P(a){for(var c=b(50,a.currentTarget),d=
0;d<c.uj.length;d++){var f=c.uj[d];f&&f(a.targetTouches)}for(d=0;d<c.uj.length;d++)c.uj[d]||c.uj.splice(d,1)}function t(a){for(var c=b(50,a.currentTarget),d=0;d<c.tj.length;d++){var f=c.tj[d];f&&f(a.targetTouches)}c.ci&&a.preventDefault();for(d=0;d<c.tj.length;d++)c.tj[d]||c.tj.splice(d,1)}function da(a){for(var c=b(50,a.currentTarget),d=0;d<c.sj.length;d++){var f=c.sj[d];f&&f(a.targetTouches)}for(d=0;d<c.sj.length;d++)c.sj[d]||c.sj.splice(d,1)}function G(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function F(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}var U=l("__compat"),R=l("__container"),Z=l("__config"),u=l("__print"),ga=l("__quat"),ca=l("__util"),E=l("__vec3"),aa=l("__vec4"),ia=Z.B,q=Z.DV;a.yh=10;a.xd=20;a.ad=30;a.vp=40;a.Ag=50;a.mt=60;a.fy=70;a.gy=80;a.hy=90;a.Wy=0;a.EE=1;a.DE=2;a.Fp=3;a.hl=0;a.zt=10;a.At=20;a.VN=21;a.WN=22;a.Sy=23;a.Ry=24;a.Py=25;a.Uy=26;a.Vy=27;a.Ty=
28;a.Qy=29;a.wi=30;a.NE=31;a.il=40;a.Jp=50;a.Kp=60;a.Hp=70;a.Gp=80;a.HE=81;a.ml=90;a.Qp=100;a.ll=110;a.yt=120;a.pn=130;a.wy=300;a.rt=301;a.Dy=302;a.Ky=303;a.Ly=304;a.My=305;a.wt=306;a.Ep=307;a.Ny=308;a.Oy=309;a.xy=310;a.yy=311;a.st=312;a.tt=313;a.ut=314;a.vt=315;a.zy=316;a.Ay=317;a.By=318;a.Cy=319;a.Ey=320;a.Fy=321;a.Gy=322;a.Hy=323;a.Iy=324;a.Jy=325;a.Ap=326;a.Bp=327;a.Cp=328;a.Dp=329;a.qy=330;a.ry=331;a.sy=332;a.ty=333;a.uy=334;a.vy=335;a.oy=336;a.py=337;var T=ga.create(),ba=ga.create(),S=E.create(),
sa=-Infinity,oa=!1,Y=new Float32Array(2);E.create();var na=E.create(),ya=ga.create(),wa="ontouchstart"in document.documentElement,la=[];a.hu=n;a.ga=b;a.LD=function(a,b){a.ci=b};a.Jw=function(a){switch(a.type){case 20:if(a.mh)if(a.Tf)a.Tf.resetPose();else if(a.si)for(var b=0;b<a.si.length;b++)a.si[b].resetSensor();break;default:u.error("reset_device() is undefined for device: ",a.type)}};a.Ti=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:E.copy(ca.sn,c);if(a.Tf)c[0]=a.orientation[0],c[1]=
a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.si)for(b=0;b<a.si.length;b++){var d=a.si[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,c[2]=d.orientation.z,c[3]=d.orientation.w)}ga.normalize(c,c);a=ga.setAxisAngle(ca.ti,Math.PI/2,ba);ga.multiply(a,c,c);break a;default:u.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:E.copy(ca.iz,c);if(a.Tf)c[0]=
a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.si)for(b=0;b<a.si.length;b++)d=a.si[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);break a;default:u.error("position is undefined for device: ",a.type)}return c;case 21:return m(a,"left",c);case 22:return m(a,"right",c);case 30:case 31:return c[0]=a.fw[0],c[1]=a.fw[1],c}};a.jm=k;a.dD=function(a,b,c){switch(a.type){case 20:if(3===k(a,0))break;
switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Vi=c;h(a);break;case 25:a.Hj=c;h(a);break;case 26:a.Ck=c;h(a);break;case 27:a.jn=c;h(a);break;case 28:a.bk=c;h(a);break;case 29:a.Ij=c,h(a)}break;case 60:case 70:case 80:case 90:a.Wu[b]=c}};a.fV=function(a,b){var c=b-300;return c<a.Zl.length?a.Zl[a.Wu[c]-300]:!1};a.eV=function(a,b){return b-326<a.Zj.length?a.Zj[a.Wu[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],d=0;d<la.length;d++){var g=la[d];switch(g.type){case 60:c(g);v(b[0],g);break;case 70:c(g);v(b[1],g);break;case 80:c(g);v(b[2],g);break;case 90:c(g);v(b[3],g);break;case 20:f(g,a)}}};a.yd=function(a,b,c){switch(b){case 120:a.qg.push(c);b=131;break;case 130:a.hh.push(c);b=131;break;case 40:a.$i.push(c);break;case 30:case 31:a.be.push(c);break;case 50:a.aj.push(c);break;case 60:a.bj.push(c);break;case 80:a.Lr.push(c);break;case 81:a.OJ.push(c);b=80;break;case 70:a.Wi.push(c);
break;case 90:a.uj.push(c);break;case 100:a.tj.push(c);break;case 110:a.sj.push(c)}if(-1==a.Xb.indexOf(b)&&(a.Xb.push(b),a.mh))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",z,!1);break;case 30:a.element.addEventListener("mousemove",L,!1);break;case 31:a.element.addEventListener("mousemove",H,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",d,!1),a.element.addEventListener("mouseup",
p,!1));break;case 60:a.element.addEventListener("wheel",M,!1);break;case 80:a.element.addEventListener("keydown",x,!1);break;case 70:a.element.addEventListener("keyup",g,!1);break;case 90:a.element.addEventListener("touchstart",P,!1);break;case 100:a.element.addEventListener("touchmove",t,!1);break;case 110:a.element.addEventListener("touchend",da,!1);break;case 131:a.element.addEventListener("deviceorientation",D,!1)}};a.Bd=function(a,b,c){J(a,b,c,!1)};a.xV=K;a.ua=function(){for(var a=0;a<la.length;a++)for(var b=
la[a],c=0;c<b.Xb.length;c++)J(b,b.Xb[c],null,!0);la.length=0};a.LI=function(a){a=b(G(a));for(var c=0;c<a.Zl.length;c++)if(a.Zl[c])return c+300;return-1};a.EI=function(a){a=b(G(a));for(var c=0;c<a.Zj.length;c++)if(a.YH[c]-a.Zj[c])return c+326;return-1};a.xI=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.hJ=function(){var a=b(20);return a&&a.Tf};a.gQ=function(a){a.element.addEventListener("mousedown",
function(){a.value||F(a)},!1)}};b4w.module.__physics=function(a,l){function n(a,b){for(var c=a.Te,d=0;d<c.length;d++)c[d].jh.Ts&&b.push(c[d]),n(c[d],b)}function e(a,b,c){for(var d=a.zc.sa,f=0;f<d.length;f++)for(var g=d[f].C,e=0;e<g.Se.length;e++){var k=g.Se[e];"ANY"!=k.bc&&c!=k.bc||Q(k,a,b)}}function b(a,b,c){if(F.Gv(a))switch(b){case F.kO:var d=y(a);d.zc.JN=!0;F.ha(a,F.wP,Date.now()-performance.now(),ba.max_fps,ba.Jz?S.TH:0);break;case F.lO:R.ae("URANIUM:",c.slice(1));break;case F.gO:R.error(c);break;case F.hO:G.Qu.apply(this,
c.slice(1));break;case F.qO:var f=r(c.fa);if(f){a=c.trans;d=c.quat;b=c.Xh;var g=c.Eh,f=f.C;f.Au=c.time;E.hi(a,1,d,f.Bu);ia.copy(b,f.Xh);ia.copy(g,f.Eh)}break;case F.nO:(a=r(c.Qz))&&E.hi(c.trans,1,c.quat,a.v.ms[c.IC]);break;case F.iO:if(d=r(c[1]))a=c[4],d=d.cg.eu[c[2]],ca.Wc(d,c[3]),ca.gi(d,a),ca.D(d);break;case F.rO:if(f=r(c[1]))f.v.speed=c[2];break;case F.cO:d=y(a);A(d,c.xl,c.yl,c.result,null,null,0);break;case F.eO:d=y(a);A(d,c.xl,c.yl,c.result,c.Fl,c.coll_norm,c.coll_dist);break;case F.dO:if(f=
r(c[1]))a=f.C,a.El&&a.El(c[2]);break;case F.GE:case F.oO:d=y(a);if(a=d.zc.yk[c.id])if(d=r(c.Cn),b==F.GE)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var g=c.hit_time,f=c.hit_pos,e=a.callback;f?e(a.id,b,d,g,f,c.hit_norm):e(a.id,b,d,g)}break;case F.pO:z(id);break;case F.mO:a=Y.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case F.jO:oa=c[1];break;
case F.fO:a=Y.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:R.error("Wrong message: "+b)}}function y(a){for(var b=0;b<Y.length;b++)if(Y[b]==a)return na[b]}function r(a){return ya[a]||null}function A(a,b,c,d,f,g,e){a=a.zc.sa;for(var k=0;k<a.length;k++)for(var q=a[k].C,p=0;p<q.Se.length;p++){for(var m=q.Se[p],u=m.wk,l=!1,n=0;n<u.length;n++){var t=u[n];if(t[0]===b&&t[1]===c){m.as[n]=d;l=!0;break}}l&&(u=h(m),f&&m.Cz!=b&&(l=f,n=g,t=e,l[0]+=n[0]*t,l[1]+=n[1]*t,l[2]+=n[2]*
t,n[0]*=-1,n[1]*=-1,n[2]*=-1),m.callback(u,u?m.Cz==b?r(c):r(b):null,f,g,e))}}function h(a){a=a.as;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function w(){ha.body++;return ha.body}function m(a){var b=la.indexOf(a);return-1==b?(la.push(a),la.length-1):b}function k(a,b){return{fa:a,type:b,Zh:0,Jv:!1,Mk:!0,af:!1,ig:!1,VV:!1,qu:null,bc:"",Cq:0,l3:{},Se:[],El:null,Au:0,Bu:new Float32Array([0,0,0,1,0,0,0,1]),Xh:new Float32Array(3),Eh:new Float32Array(3),gu:new Float32Array(3),pq:new Float32Array(4),
Vr:null}}function f(a,b){switch(a){case "BOX":var c=b.R;break;case "CYLINDER":c=b.gq;break;case "CONE":c=b.fq;break;case "SPHERE":c=b.wa;break;case "CAPSULE":c=b.eq}return c}function v(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.F&&
(b.center=a.F);"number"===typeof a.Ya&&(b.radius=a.Ya);"number"===typeof a.height&&(b.height=a.height);return b}function c(a,b,c,d,f){var g=E.G(a.k.n),e=E.invert(b.k.n,N),k=new Float32Array(3);E.Xc(g,e,k);switch(b.v.type){case 10:b=b.of;a=a.k.R;F.ha(f,F.$O,c,k,b.yZ,b.ZC,(a.max_z-a.min_z)/2,d);break;case 20:F.ha(f,F.ZO,c,k,a.p9)}}function C(a){return a.C&&a.C.qu}function O(a,b,c,d,f,g,e,k,q,p){var h;ha.pc++;h=ha.pc.toString(16);var m=b.C.fa;F.ha(J(m),F.gP,h,a,k,m,c,d,f.C.fa,g,e,q,p);b.C.qu=h}function J(a){for(var b=
0;b<na.length;b++)for(var c=na[b].zc.sa,d=0;d<c.length;d++)if(c[d].C.fa==a)return Y[b];return null}function K(a){var b=a.C;if(b=b?0===b.Zh?!0:!0===b.Jv?!0:!1===b.Mk?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=E.hc(a.k.n,ta),c=E.Xd(a.k.n,ma),b=b[0]!=a.C.gu[0]||b[1]!=a.C.gu[1]||b[2]!=a.C.gu[2]||c[0]!=a.C.pq[0]||c[1]!=a.C.pq[1]||c[2]!=a.C.pq[2]||c[3]!=a.C.pq[3];if(b){var b=a.C,d=a.k,c=F.FI(F.Ct);c.fa=b.fa;var f=E.hc(d.n,c.trans),d=E.Xd(d.n,c.quat);ia.copy(f,b.gu);Z.copy(d,b.pq);"DYNAMIC"==
b.type&&Z.identity(c.quat);F.ha(J(b.fa),F.Ct)}a=a.Te;for(b=0;b<a.length;b++)K(a[b])}function D(a,b,c,d,f){f=f||new Float32Array(3);a=E.P(a.k.n);f[0]=b;f[1]=c;f[2]=d;ia.transformQuat(f,a,f)}function Q(a,b,c){var d=a.wk,f=a.as,g=a.Cz,e=[],k=a.bc;e||aa.q("At least one destination required");for(var q=0;q<b.zc.sa.length;q++){var p=b.zc.sa[q];if("ANY"==k||p.C.bc==k&&"NAVMESH"!=p.C.type)p=p.C.fa,e&&-1==e.indexOf(p)&&e.push(p)}for(b=0;b<e.length;b++)k=e[b],g<k&&!L(d,g,k)?(d.push([g,k]),f.push(!1)):g>k&&
!L(d,k,g)&&(d.push([k,g]),f.push(!1));F.ha(c,F.YO,g);F.ha(c,F.fP,d,a.Hh)}function L(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function H(a){a.C&&a.C.El&&(a=a.C,F.ha(J(a.fa),F.sP,a.fa),a.El=null)}function z(a){var b=p(a),c=d(a).zc;c.yk[a]&&(delete c.yk[a],c.MC.splice(c.MC.indexOf,1),F.ha(b,F.BP,a))}function d(a){for(var b=0;b<na.length;b++){var c=na[b];if(c.zc.yk[a])return c}return null}function p(a){for(var b=0;b<na.length;b++)if(na[b].zc.yk[a])return Y[b];return null}
function M(a,b,c){if(b.Wo){a=a.C.fa;var d=b.On*b.ir,f=b.nq*b.oq,g=-b.Uo*b.Vo*2*Math.PI/b.Ms;b.Er&&(g*=-1);switch(b.type){case 10:F.ha(c,F.OP,a,d,f,g);break;case 20:F.ha(c,F.NP,a,d,f,g)}}}function x(a){return a.af&&"CHASSIS"==a.of.gf}function g(a){return a.af&&"HULL"==a.of.gf}function P(a){return"NAVMESH"==a.jh.es}function t(a){return a.rm&&"MAIN_BODY"==a.Rn.gf}var da=l("__config"),G=l("__debug"),F=l("__ipc"),U=l("__obj_util"),R=l("__print"),Z=l("__quat"),u=l("__scenes"),ga=l("__subscene"),ca=l("__transform"),
E=l("__tsr"),aa=l("__util"),ia=l("__vec3"),q=l("__version"),T=l("__navmesh"),ba=da.C,S=da.B,sa=da.Pd,oa=0,Y=[],na=[],ya={},wa=[],la=["ANY"],ha={body:0,pc:0,YK:0},ta=new Float32Array(3);new Float32Array(4);var ma=new Float32Array(4);new Float32Array(16);var N=E.create(),ea=E.create();a.MV=function(a){a.zc={JN:!1,sa:[],yk:{},MC:[]};var c=ba.Ss;sa.prevent_caching&&(c+=q.timestamp());R.log("%cLOAD PHYSICS","color: #0a0",ba.at?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+ba.max_fps);
R.log("%cPHYSICS PATH","color: #0a0",c);var d=F.nT(c,!ba.at);F.TQ(d,b);Y.push(d);na.push(a);ba.ping&&setInterval(function(){F.ha(d,F.yP,performance.now())},1E3)};a.UR=function(a){return a.zc?a.zc.JN:!0};a.ua=function(){for(var a=0;a<Y.length;a++)F.terminate(Y[a]);Y.length=0;na.length=0;ya={};wa.length=0;la.length=0;for(var b in ha)ha[b]=0};a.yn=function(a,b){a.k||aa.q("No object render: "+a.name);var d;a:{for(var q=0;q<na.length;q++)if(na[q]==b){d=Y[q];break a}d=void 0}var p=[];a.jh.Ts&&n(a,p);var h=
b.zc.sa;if(x(a)||g(a)||a.ig||t(a)||a.bn){var u=P(a),l;if(u){var r=a,ca=w(),z=k(ca,"NAVMESH"),S=U.ka(r,b).W;z.Vr=null;for(var H=0;H<S.length;H++){var ga=S[H];if("PHYSICS"==ga.type){z.Vr=T.ZW(ga.Ca);break}}l=z}else{var ia=a,y=d,G=ia.k,ba=ia.jh,D=ba.es,A=w();if("CAMERA"==ia.type)var J=ba.iE?ba.ou:"BOX",L=f(J,G),ha=G.Yl,ta=G.Rl,ha=.5,ta=0;else if("EMPTY"==ia.type)J="EMPTY",L=null,ta=ha=0;else{var J=ba.iE?ba.ou:"BOX",L=f(J,G),la=E.Yd(G.n);if(1!=la){var K=L;switch(J){case "BOX":K.min_x*=la;K.max_x*=la;
K.min_y*=la;K.max_y*=la;K.min_z*=la;K.max_z*=la;break;case "CYLINDER":case "CONE":case "CAPSULE":K.height*=la;K.Ya*=la;break;case "SPHERE":K.Ya*=la}}ha=G.Yl;ta=G.Rl}var Q=E.G(G.n),sa=E.P(G.n),oa=ba.Xs,da=ba.sN,pb=ba.Zh,Ua=ba.yN,Aa=ba.xN,ab=ba.vH,Ya=ba.iL,Ka=ia.bc,kb=m(Ka),eb=ba.Dq,bb=ba.Bq,sb=ba.Eq,lb=G.wa.Ya,nb=v(L),wb=ia.su,Va;var Ob=J;if(p.length){var ic=[],Wb={};Wb.quat=new Float32Array([0,0,0,1]);Wb.trans=new Float32Array(3);Wb.worker_bounding=nb;Wb.bounding_type=Ob;ic.push(Wb);var qb=E.invert(G.n,
N),nd=ma;Z.invert(E.P(G.n),nd);for(var Bb=0;Bb<p.length;Bb++){var fb={},jc=p[Bb],Nc=jc.jh.ou,Wc=new Float32Array(4),tc=new Float32Array(3),Qc=E.P(jc.k.n);E.Xc(E.G(jc.k.n),qb,tc);Z.multiply(nd,Qc,Wc);fb.trans=tc;fb.quat=Wc;fb.bounding_type=Nc;fb.worker_bounding=v(f(Nc,jc.k));ic.push(fb)}Va=ic}else Va=[];F.ha(y,F.cP,A,Q,sa,D,oa,da,pb,Ua,Aa,ab,Ya,kb,eb,bb,sb,J,nb,lb,ha,ta,Va,wb);ya[A]=ia;wa.push(ia);var Ib=k(A,"BOUNDING");Ib.type=D;Ib.Zh=pb;Ib.Jv=oa;Ib.bc=Ka;Ib.Cq=kb;l=Ib}var ec=l;a.C=ec;var xb={za:null,
C:ec};u||(h.push(xb),e(b,d,ec.bc))}else for(var Wa=U.ka(a,b).W,Fa=0;Fa<Wa.length;Fa++){var yb=Wa[Fa],Rc;if(Rc="PHYSICS"==yb.type){var Xb;a:{for(var Bc=b.zc.sa,dd=0;dd<Bc.length;dd++){var uc=Bc[dd].za;if(uc&&uc.id==yb.id){Xb=!0;break a}}Xb=!1}Rc=!Xb}if(Rc)if(yb.Of.Ja)if(yb.yj&&b.s.Mc){var Zb=yb,Xc=b,ed=d,$b=Xc.s.Mc;F.ha(ed,F.lP,$b.el);if(Zb.Y_){var cb={};cb.dst_noise_scale0=Zb.dst_noise_scale0;cb.dst_noise_scale1=Zb.dst_noise_scale1;cb.dst_noise_freq0=Zb.dst_noise_freq0;cb.dst_noise_freq1=Zb.dst_noise_freq1;
cb.dir_min_shore_fac=Zb.dir_min_shore_fac;cb.dir_freq=Zb.dir_freq;cb.dir_noise_scale=Zb.dir_noise_scale;cb.dir_noise_freq=Zb.dir_noise_freq;cb.dir_min_noise_fac=Zb.dir_min_noise_fac;cb.dst_min_fac=Zb.dst_min_fac;cb.waves_hor_fac=Zb.waves_hor_fac;var vd=$b.waves_height,Fc=$b.waves_length;$b.Lk?F.ha(ed,F.$E,cb,$b.Mo[0],$b.Mo[1],$b.Lo[0],$b.Lo[1],$b.YB,vd,Fc,$b.xD,Xc.s.wD):F.ha(ed,F.$E,cb,0,0,0,0,0,vd,Fc,0,null)}}else{var ib;if(yb.Xs){var od=a,Cc=yb,kc=d,Qb=w(),Pb=Cc.Of,lc=Pb.aa[0].a_position,Gc=Pb.na||
null,Jb=Cc.bc,mc=m(Jb);F.ha(kc,F.iP,Qb,lc,Gc,E.G(od.k.n),mc,Cc.Dq,Cc.Bq,Cc.Eq);var rb=k(Qb,"STATIC_MESH");rb.Jv=!0;rb.bc=Jb;rb.Cq=mc;ib=rb}else{var db=a,ac=yb,Yc=d,Db=w(),Rb=ac.Of,gb=Rb.aa[0].a_position,ob=Rb.na||null,Hc=E.G(db.k.n),nc=ac.Yl,Ic=ac.Rl,Kb=ac.bc,oc=m(Kb);F.ha(Yc,F.kP,Db,gb,ob,Hc,nc,Ic,oc,ac.Dq,ac.Bq,ac.Eq);var bc=k(Db,"STATIC_MESH");bc.bc=Kb;bc.Cq=oc;ib=bc}ec=ib;a.C=ec;xb={za:yb,C:ec};h.push(xb);e(b,d,ec.bc)}else R.error("Object "+a.name+" has collision material with no assigned vertices")}if(x(a)||
g(a)){var Za=a,cc=d,Lb=Za.C.fa;x(Za)?(Za.v.type=10,F.ha(cc,F.dP,Lb,Za.v.ID,Za.v.KD,Za.v.JD,Za.v.tE,Za.v.ZB)):g(Za)&&(Za.v.type=20,F.ha(cc,F.bP,Lb,Za.v.Vl,Za.v.gn,Za.v.hn));if(Za.v.Lm){var tb=Za.v.Lm;switch(Za.v.type){case 10:c(tb[0],Za,Lb,!0,cc);c(tb[1],Za,Lb,!0,cc);c(tb[2],Za,Lb,!1,cc);c(tb[3],Za,Lb,!1,cc);break;case 20:for(var pc=0;pc<tb.length;pc++)c(tb[pc],Za,Lb,!1,cc)}}M(a,a.v,d)}else if(a.ig){var ub=d,Mb=a.k,Sb=a.C,vc=Mb.R.max_z-Mb.R.min_z,Jc=Sb.fa,Ia=a.CG,fc=Ia.X_,Eb=Ia.$X,Fb=Ia.rZ,Dc=Ia.fW,
Tb=Ia.Z_,jb=aa.DT(a);F.ha(ub,F.eP,Jc,jb,vc,fc,Eb,Fb,Dc,Tb);Sb.ig=!0}else if(t(a)){var hb=a,Ja=d,Yb=hb.C.fa;F.ha(Ja,F.hP,Yb,hb.cg.Vl,hb.cg.gn,hb.cg.hn);if(hb.cg.eu)for(var Gb=hb.cg.eu,Na=0;Na<Gb.length;Na++){var Oa=Gb[Na],mb=E.G(Oa.k.n),Oc=E.invert(hb.k.n,N),Kc=new Float32Array(3);E.Xc(mb,Oc,Kc);F.ha(Ja,F.aP,Yb,Kc,Oa.nG)}hb.C.VV=!0}for(Fa=0;Fa<wa.length;Fa++)if(a=wa[Fa],a.C){var vb=a;if(!C(vb))for(var Ec=0;Ec<vb.CC.length;Ec++){var Ub=vb.CC[Ec],dc=Ub.target,fd=Ub.mX;if(dc.C){var Zc=new Float32Array([Ub.nX,
Ub.oX,Ub.pX]),Sc,$c=new Float32Array([Ub.Ga,Ub.Ha,Ub.Ia]);Sc=aa.Wj($c,new Float32Array(4));var zb=E.identity(N),zb=E.kf(Zc,zb),zb=E.Jk(Sc,zb),Ab=E.multiply(vb.k.n,zb,N),wc=E.invert(dc.k.n,ea),gd=E.multiply(wc,Ab,wc),Xa=Ub,$a={};$a.use_limit_x=Xa.J_;$a.use_limit_y=Xa.K_;$a.use_limit_z=Xa.L_;$a.use_angular_limit_x=Xa.F_;$a.use_angular_limit_y=Xa.G_;$a.use_angular_limit_z=Xa.H_;$a.limit_max_x=Xa.pW;$a.limit_min_x=Xa.sW;$a.limit_max_y=Xa.qW;$a.limit_min_y=Xa.tW;$a.limit_max_z=Xa.rW;$a.limit_min_z=Xa.uW;
$a.limit_angle_max_x=Xa.jW;$a.limit_angle_min_x=Xa.mW;$a.limit_angle_max_y=Xa.kW;$a.limit_angle_min_y=Xa.nW;$a.limit_angle_max_z=Xa.lW;$a.limit_angle_min_z=Xa.oW;O(fd,vb,Zc,Sc,dc,E.G(gd),E.P(gd),$a,null,null)}}}};a.lU=r;a.update=function(a,b){for(var c=0;c<Y.length;c++){var d=Y[c],f=a;d&&F.HJ(d)&&F.ha(d,F.PP,f,b);for(var g=0;g<wa.length;g++){var e=wa[g],k=e.C;if(k.Mk&&k.Au){var q=F.HJ(d)?f-k.Au:performance.now()/1E3-k.Au,q=Math.min(q,10/ba.max_fps),q=q-1/ba.max_fps;S.$W&&(q=0);var p=N;E.OV(k.Bu,q,
k.Xh,k.Eh,N);ca.mj(e,p);ca.D(e);K(e);if(e.v)for(var k=e,q=k.v.Lm,p=k.k.n,h=N,m=0;m<q.length;m++){var l=q[m];E.multiply(p,k.v.ms[m],h);ca.mj(l,h);ca.D(l)}e.v&&e.v.Wo&&(h=e,q=h.v,k=q.Wo)&&(m=h.v.tM,E.multiply(h.k.n,h.v.uM,k.k.n),p=ta,E.wd(m,h.k.n,p),h=ma,Z.setAxisAngle(p,-q.Uo*q.Vo*2*Math.PI,h),q=E.P(k.k.n),Z.multiply(h,q,q),ca.D(k));e.v&&e.v.BD&&(h=e,q=h.v,k=q.BD)&&(m=h.v.oM,E.multiply(h.k.n,h.v.pM,k.k.n),p=ta,E.wd(m,h.k.n,p),h=ma,m=Math.abs(q.speed)*q.Ks,m>q.lo&&(m=q.lo),Z.setAxisAngle(p,-m,h),q=
E.P(k.k.n),Z.multiply(h,q,q),Z.normalize(q,q),ca.D(k));e.v&&e.v.MD&&(p=e,k=p.v,e=k.MD)&&(h=p.v.FM,E.multiply(p.k.n,p.v.GM,e.k.n),q=ta,E.wd(h,p.k.n,q),p=ma,Z.setAxisAngle(q,-Math.abs(k.On)*k.Uq,p),k=E.P(e.k.n),Z.multiply(p,k,k),Z.normalize(k,k),ca.D(e))}}F.wX(d);d=na[c];(f=d.s.Mc)&&0<f.waves_height&&(d=u.La(d,ga.Pb),f=ia.length(d.zj)||1,F.ha(Y[c],F.MP,d.time*f))}};a.LU=function(){return na[0]};a.pause=function(){for(var a=0;a<Y.length;a++)F.ha(Y[a],F.xP)};a.jj=function(){for(var a=0;a<Y.length;a++)F.ha(Y[a],
F.CP)};a.JH=function(a){(a=a.C)||aa.q("No object physics");if(!a.Mk){var b=a.fa,c=J(b);a.Mk=!0;F.ha(c,F.vP,b)}};a.IA=function(a){(a=a.C)||aa.q("No object physics");if(a.Mk){var b=a.fa,c=J(b);a.Mk=!1;F.ha(c,F.uP,b)}};a.Lw=function(a){return Boolean(a.zc)};a.oa=function(a){return Boolean(a.C)};a.nJ=function(a){return(a=a.C)&&a.Mk&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Zh&&0==a.Jv?!0:!1};a.tB=function(a){return(a=a.C)&&a.Mk?!0:!1};a.FL=function(a,b){var c=a.C.fa;F.ha(J(c),F.LP,c,b)};a.zV=C;
a.MF=O;a.PG=function(a){a=a.C;F.ha(J(body_a),F.AP,a.qu);a.qu=null};a.RK=function(b,c,d,f,g,e){c=E.hi(c,1,d,N);g=E.hi(g,1,e,ea);E.invert(c,c);E.multiply(g,c,c);ca.vr(f,g);E.multiply(g,c,c);ca.mj(b,c);ca.D(b);a.Ds(b,E.G(b.k.n),E.P(b.k.n))};a.Ds=function(a,b,c){var d=a.C,f=F.FI(F.Ct),g=E.hc(a.k.n,f.trans);a=E.Xd(a.k.n,f.quat);E.hi(g,1,a,d.Bu);f.fa=d.fa;ia.copy(b,f.trans);Z.copy(c,f.quat);F.ha(J(d.fa),F.Ct)};a.H=K;a.QF=function(a,b,c,d){var f=ta;D(a,b,c,d,f);a=a.C.fa;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);
var g=Math.abs(f[0]),e=Math.abs(f[1]),k=Math.abs(f[2]);f[0]=g?f[0]/g*Math.max(g,b):0;f[1]=e?f[1]/e*Math.max(e,c):0;f[2]=k?f[2]/k*Math.max(k,d):0;F.ha(J(a),F.bF,a,f[0],f[1],f[2])};a.RF=function(a,b,c,d){a=a.C.fa;F.ha(J(a),F.bF,a,b,c,d)};a.vz=function(a,b,c,d,f){var g=ta;f?(g[0]=b,g[1]=c,g[2]=d):D(a,b,c,d,g);a=a.C.fa;F.ha(J(a),F.mP,a,g[0],g[1],g[2])};a.PF=function(a,b,c,d){var f=ta;D(a,b,c,d,f);a=a.C.fa;F.ha(J(a),F.oP,a,f[0],f[1],f[2])};a.Qm=function(a,b,c){a=a.C.fa;F.ha(J(a),F.FP,a,b,c)};a.Gk=function(a,
b){var c=a.C.fa;F.ha(J(c),F.GP,c,b)};a.wL=function(a,b){var c=a.C.fa;F.ha(J(c),F.KP,c,b)};a.vL=function(a,b){var c=a.C.fa;F.ha(J(c),F.IP,c,b)};a.sL=function(a,b){var c=a.C.fa;F.ha(J(c),F.DP,c,b)};a.Pz=function(a){a=a.C.fa;F.ha(J(a),F.qP,a)};a.BG=function(a,b,c){a=a.C.fa;F.ha(J(a),F.rP,a,b,c)};a.Hk=function(a,b,c){a=a.C.fa;F.ha(J(a),F.HP,a,b,c)};a.tL=function(a,b){var c=a.C.fa;F.ha(J(c),F.EP,c,b)};a.uL=function(a,b){var c=a.C.fa;F.ha(J(c),F.JP,c,b)};a.sz=function(a,b,c,d){var f=a.C;if(!f.Vr){for(var g=
f.fa,e=0;e<f.Se.length;e++)if(a=f.Se[e],a.bc==b&&a.callback==c)return;a={Cz:g,Hh:d||!1,bc:b,callback:c,wk:[],as:[]};f.Se.push(a);b=J(g);Q(a,y(b),b)}};a.QC=function(a,b,c){a=a.C;for(var d=J(a.fa),f=y(d),g=0;g<a.Se.length;g++){var e=a.Se[g];if(e.bc==b&&e.callback==c){if(h(e)){var k=ia.set(0,0,0,ta);e.callback(!1,null,k,k,0)}a.Se.splice(g,1);g--;for(var k=d,e=e.wk,q=f.zc.sa,p=0;p<q.length;p++)for(var m=q[p].C,u=0;u<m.Se.length;u++)for(var l=m.Se[u],n=0;n<l.wk.length;n++)for(var t=l.wk[n],E=0;E<e.length;E++){var r=
e[E];t[0]==r[0]&&t[1]==r[1]&&(e.splice(E,1),E--)}e.length&&F.ha(k,F.aF,e)}}};a.uz=function(a,b){a.C&&a.C.El&&H(a);var c=a.C;F.ha(J(c.fa),F.nP,c.fa);c.El=b};a.Uz=H;a.Ut=function(a,b,c,d,f,g,e,k,q){var p;ha.YK++;p=ha.YK;a={id:p,fa:a?a.C.fa:0,from:new Float32Array(b),to:new Float32Array(c),bc:d,Cq:m(d),XF:g,mR:e,Hh:k,Av:q,callback:f};b=J(a.fa)||Y[0];c=y(b).zc;p=a.id;c.yk[p]=a;c.MC.push(a);F.ha(b,F.jP,a.id,a.fa,a.from,a.to,a.Cq,a.XF,a.mR,a.Hh,a.Av);return p};a.RC=z;a.zG=function(a,b,c){var f=p(a),g=d(a).zc.yk[a];
g&&!g.XF&&(g.from.set(b),g.to.set(c),F.ha(f,F.pP,a,b,c))};a.IJ=function(a){return d(a).zc.yk[a]?!0:!1};a.lp=function(a,b){var c=a.v;c.On=b;M(a,c,J(a.C.fa))};a.kp=function(a,b){var c=a.v;c.Uo=b;M(a,c,J(a.C.fa))};a.lE=function(a,b){var c=a.v;c.nq=b;M(a,c,J(a.C.fa))};a.bf=x;a.cf=g;a.P6=P;a.SV=function(a){if(!a.af)return!1;a=a.of.gf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.RV=function(a){return a.af?"BOB"==a.of.gf?!0:!1:!1};a.WV=function(a){return a.rm?
"BOB"==a.Rn.gf?!0:!1:!1};a.KJ=function(a){return a.af&&"STEERING_WHEEL"==a.of.gf?!0:!1};a.JJ=function(a){return a.af&&"SPEEDOMETER"==a.of.gf?!0:!1};a.LJ=function(a){return a.af&&"TACHOMETER"==a.of.gf?!0:!1};a.cJ=function(a){return a.v.speed};a.a0=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.ig=function(a){return a.ig};a.J6=t;a.cV=function(){return oa};a.xT=function(){for(var a=0;a<Y.length;a++)F.ha(Y[a],
F.tP)};a.ts=function(a){if("BOUNDING"==a.C.type){var b=wa.indexOf(a);-1==b&&R.error("Object "+a.name+" doesn't have bounding physics");delete ya[c];wa.splice(b,1)}for(var c=a.C.fa,b=J(c),d=y(b),f=c,g=d.zc.sa,e=[],k=0;k<g.length;k++)for(var q=g[k].C,p=0;p<q.Se.length;p++)for(var m=q.Se[p],u=0;u<m.wk.length;u++){var l=m.wk[u],n=m.as[u];if(l[0]==f||l[1]==f)m.wk.splice(u,1),m.as.splice(u,1),u--,n&&!h(m)&&(n=ia.set(0,0,0,ta),m.callback(!1,null,n,n,0)),e.push(l)}e.length&&F.ha(b,F.aF,e);a.C&&a.C.El&&H(a);
a=d.zc.sa;for(d=0;d<a.length;d++)a[d].C.fa==c&&(a.splice(d,1),d--);F.ha(b,F.zP,c)}};b4w.module.__ipc=function(a,l){function n(a,b,c){for(var e=0;e<v.length;e+=2)v[e+1]==a&&(f[e+Number(!b)]=c)}function e(a){for(var b=0;b<a.length;b++){var c=a[b],f=0,e;for(e in c){var k=c[e];switch(k.constructor){case Float32Array:f+=k.length;break;case Number:f+=1}}--f;c.len=f}}var b=!0;a.kO=0;var y=a.cO=1,r=a.eO=2;a.dO=3;a.gO=4;a.hO=5;a.iO=6;a.lO=7;var A=a.nO=8,h=a.GE=9,w=a.oO=10;a.pO=11;var m=a.qO=12;a.rO=13;a.mO=14;a.jO=15;a.fO=16;a.wP=100;a.YO=101;a.ZO=102;a.$O=103;a.aP=104;a.cP=105;a.bP=106;
a.dP=107;a.eP=108;a.fP=109;a.gP=110;a.hP=111;a.iP=112;a.kP=113;a.lP=114;a.zP=115;a.mP=116;a.nP=117;a.oP=118;a.qP=119;a.rP=120;a.sP=121;a.uP=122;a.vP=123;a.xP=124;a.jP=125;a.BP=126;a.pP=127;a.aF=128;a.AP=129;a.CP=130;a.DP=131;a.EP=132;a.FP=133;a.GP=134;a.HP=135;a.IP=136;a.JP=137;a.KP=138;a.LP=139;a.bF=140;var k=a.Ct=141;a.MP=142;a.$E=143;a.NP=144;a.OP=145;a.yP=146;a.tP=147;a.PP=148;var f=b4w.worker_listeners,v=b4w.worker_namespaces,c={Kf:m,fa:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Xh:new Float32Array(3),Eh:new Float32Array(3),len:0},C={Kf:A,Qz:0,IC:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},O={Kf:h,id:0,Cn:0,hit_fract:0,hit_time:0,len:0},J={Kf:w,id:0,Cn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},K={Kf:y,xl:0,yl:0,result:0,len:0},D={Kf:r,xl:0,yl:0,result:0,Fl:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},Q={Kf:k,fa:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},L=[c,C,O,J,K,D,
Q];a.nT=function(a,c){var d={Kv:a?!0:!1,fl:null,Gh:[],bg:""};if(c)if(d.fl={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");n(d.bg,d.Kv,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");n(d.bg,d.Kv,null)},postMessage:function(a){var b;a:{for(b=0;b<v.length;b+=2)if(v[b+1]==d.bg){b=f[b+Number(!!d.Kv)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<v.length;a+=2)if(v[a+1]==d.bg){f.splice(a,2);v.splice(a,2);break}}},d.Kv){var e=
l("__util"),k=l("__container"),h=b4w.get_namespace(l),e=e.Ps(h+"_worker");v.push(h);v.push(e);f.push(null);f.push(null);d.bg=e;(k=k.nU(a))?b?k.addEventListener("load",function(){b4w.require("__bindings",d.bg)},!1):(b4w.ua("__bindings",d.bg),b4w.ua("__ipc",d.bg),b4w.require("__bindings",d.bg)):(k=document.createElement("script"),k.src=a,k.defer="defer",k.async="async",k.addEventListener("load",function(){b=!1;b4w.require("__bindings",d.bg)},!1),document.head.appendChild(k))}else d.bg=b4w.get_namespace(l);
else d.fl=a?new Worker(a):self;return d};a.TQ=function(a,b){function d(f){if(f.constructor==ArrayBuffer)f=new Float32Array(f);else if(f[0].constructor==ArrayBuffer){for(var e=0;e<f.length;e++)d(f[e]);return}e=f[0]|0;switch(e){case m:var l=c;l.fa=f[1]|0;l.time=f[2];l.trans[0]=f[3];l.trans[1]=f[4];l.trans[2]=f[5];l.quat[0]=f[6];l.quat[1]=f[7];l.quat[2]=f[8];l.quat[3]=f[9];l.Xh[0]=f[10];l.Xh[1]=f[11];l.Xh[2]=f[12];l.Eh[0]=f[13];l.Eh[1]=f[14];l.Eh[2]=f[15];break;case A:l=C;l.Qz=f[1]|0;l.IC=f[2]|0;l.trans[0]=
f[3];l.trans[1]=f[4];l.trans[2]=f[5];l.quat[0]=f[6];l.quat[1]=f[7];l.quat[2]=f[8];l.quat[3]=f[9];break;case h:l=O;l.id=f[1]|0;l.Cn=f[2]|0;l.hit_fract=f[3];l.hit_time=f[4];break;case w:l=J;l.id=f[1]|0;l.Cn=f[2]|0;l.hit_fract=f[3];l.hit_time=f[4];l.hit_pos[0]=f[5];l.hit_pos[1]=f[6];l.hit_pos[2]=f[7];l.hit_norm[0]=f[8];l.hit_norm[1]=f[9];l.hit_norm[2]=f[10];break;case y:l=K;l.xl=f[1]|0;l.yl=f[2]|0;l.result=!!f[3];break;case r:l=D;l.xl=f[1]|0;l.yl=f[2]|0;l.result=!!f[3];l.Fl[0]=f[4];l.Fl[1]=f[5];l.Fl[2]=
f[6];l.coll_norm[0]=f[7];l.coll_norm[1]=f[8];l.coll_norm[2]=f[9];l.coll_dist=f[10];break;case k:l=Q;l.fa=f[1]|0;l.trans[0]=f[2];l.trans[1]=f[3];l.trans[2]=f[4];l.quat[0]=f[5];l.quat[1]=f[6];l.quat[2]=f[7];l.quat[3]=f[8];break;default:l=f}b(a,e,l)}e(L);a.fl.addEventListener("message",function(a){d(a.data)},!1)};a.ua=function(){};a.ha=function(a,b){if(a)switch(b){case m:var d=c,f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.fa;f[2]=d.time;f[3]=d.trans[0];f[4]=d.trans[1];f[5]=d.trans[2];f[6]=d.quat[0];f[7]=
d.quat[1];f[8]=d.quat[2];f[9]=d.quat[3];f[10]=d.Xh[0];f[11]=d.Xh[1];f[12]=d.Xh[2];f[13]=d.Eh[0];f[14]=d.Eh[1];f[15]=d.Eh[2];a.Gh.push(f.buffer);break;case A:d=C;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.Qz;f[2]=d.IC;f[3]=d.trans[0];f[4]=d.trans[1];f[5]=d.trans[2];f[6]=d.quat[0];f[7]=d.quat[1];f[8]=d.quat[2];f[9]=d.quat[3];a.Gh.push(f.buffer);break;case h:d=O;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.id;f[2]=d.Cn;f[3]=d.hit_fract;f[4]=d.hit_time;a.Gh.push(f.buffer);break;case w:d=J;f=new Float32Array(d.len);
f[0]=d.Kf;f[1]=d.id;f[2]=d.Cn;f[3]=d.hit_fract;f[4]=d.hit_time;f[5]=d.hit_pos[0];f[6]=d.hit_pos[1];f[7]=d.hit_pos[2];f[8]=d.hit_norm[0];f[9]=d.hit_norm[1];f[10]=d.hit_norm[2];a.Gh.push(f.buffer);break;case y:d=K;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.xl;f[2]=d.yl;f[3]=d.result;a.Gh.push(f.buffer);break;case r:d=D;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.xl;f[2]=d.yl;f[3]=d.result;f[4]=d.Fl[0];f[5]=d.Fl[1];f[6]=d.Fl[2];f[7]=d.coll_norm[0];f[8]=d.coll_norm[1];f[9]=d.coll_norm[2];f[10]=d.coll_dist;
a.Gh.push(f.buffer);break;case k:d=Q;f=new Float32Array(d.len);f[0]=d.Kf;f[1]=d.fa;f[2]=d.trans[0];f[3]=d.trans[1];f[4]=d.trans[2];f[5]=d.quat[0];f[6]=d.quat[1];f[7]=d.quat[2];f[8]=d.quat[3];a.Gh.push(f.buffer);break;default:f=[];for(d=1;d<arguments.length;d++)f.push(arguments[d]);a.fl.postMessage(f)}};a.wX=function(a){a&&a.Gh.length&&(a.fl.postMessage(a.Gh),a.Gh.length=0)};a.FI=function(a){switch(a){case m:return c;case A:return C;case h:return O;case w:return J;case y:return K;case r:return D;case k:return Q;
default:return null}};a.terminate=function(a){a.fl.terminate();a.fl=null};a.Gv=function(a){return!!a.fl};a.HJ=function(a){return!!a.bg}};b4w.module.__transform=function(a,l){function n(a,b){f.gg(a)?K.kf(b,f.fg(a)):K.kf(b,a.k.n)}function e(a,b){var c=a.k;if(f.gg(a)){K.Jk(b,c.n);var e=f.$u(a),e=K.invert(e,d);K.multiply(e,c.n,f.fg(a))}else K.Jk(b,c.n)}function b(a,b){f.gg(a)?K.Jk(b,f.fg(a)):K.Jk(b,a.k.n)}function y(a,b){K.Xd(a.k.n,b);return b}function r(a,b){f.gg(a)?K.Xd(f.fg(a),b):K.Xd(a.k.n,b);return b}function A(a,b){f.gg(a)?K.copy(b,f.fg(a)):K.copy(b,a.k.n)}function h(a,b){f.gg(a)?K.copy(f.fg(a),b):K.copy(a.k.n,b);return b}function w(a){var b=
a.k,e=a.I,h=a.type;"CAMERA"==h&&k.fE(a);f.i_(a,M);"CAMERA"==h&&k.g_(a);var p=K.hc(b.n,L),l=K.Xd(b.n,z);m.Al(b.R,b.n,b.Ua);m.mq(b.wa,b.n,b.lb);if(b.ip)for(var n=0;n<e.length;n++)for(var r=e[n].W,H=0;H<r.length;H++){var u=r[H];m.Al(u.R,b.n,u.Ua);m.mq(u.wa,b.n,u.lb);u.Sf&&m.lq(u.ba,b.n,u.qb)}else b.Sf&&m.lq(b.ba,b.n,b.qb);switch(h){case "MESH":a.nK&&K.invert(a.k.n,a.k.Qx);if(r=a.Xt)K.invert(r.k.n,d),K.multiply(d,b.n,d),K.sV(d,b.aq),K.Xd(d,b.$p);b.jr=!0;break;case "CAMERA":for(n=0;n<e.length;n++)k.h_(a,
e[n]);break;case "SPEAKER":J.hZ(a,M,x);break;case "LAMP":v.l_(a)}for(n=0;n<e.length;n++)if(H=e[n],H.Gv){r=H.yb;u=r.s;switch(h){case "MESH":b.He&&O.cD(r);u=H.Ji;null!=b.Rd&&u&&O.cN(u,p);break;case "EMPTY":c.j_(a);break;case "CAMERA":O.bY(r);if(u.ud){u.ud.enable_csm&&O.cD(r);var ga=C.ka(a,r).da[0];O.w_(ga,u.Xa)}O.A()==r&&O.dm(r)==a&&J.wW(r,p,l,M,x);break;case "LAMP":O.hp(a,r)}u=H.bi;ga=a.ss;if(ga.length)for(H=0;H<u.length;H++){var ca=u[H].p;O.fN(u[H],p,l);C.gN(ga,ca.rc);k.OY(ca,O.dm(r));D.Pn(ca.ld,
ca.Ph)}}b=a.Te;for(n=0;n<b.length;n++)w(b[n]);a=a.aA;for(n=0;n<a.length;n++)b=a[n],r=b[0],f.a_(r,b[1])}var m=l("__boundings"),k=l("__camera"),f=l("__constraints"),v=l("__lights"),c=l("__objects"),C=l("__obj_util"),O=l("__scenes"),J=l("__sfx"),K=l("__tsr"),D=l("__util"),Q=l("__vec3"),L=new Float32Array(3),H=new Float32Array(3),z=new Float32Array(4);new Float32Array(9);var d=K.create(),p=K.create(),M=0,x=0;a.kF=0;a.vn=1;a.update=function(a){M=a;x++};a.Wc=function(a,b){var c=a.k;if(f.gg(a)){K.kf(b,c.n);
var e=f.$u(a),e=K.invert(e,d);K.multiply(e,c.n,f.fg(a))}else K.kf(b,c.n)};a.Yw=n;a.ie=function(a,b){K.hc(a.k.n,b);return b};a.aJ=function(a,b){f.gg(a)?K.hc(f.fg(a),b):K.hc(a.k.n,b);return b};a.gi=e;a.Xw=b;a.Sh=y;a.QI=r;a.Ww=function(a,b){var c=D.Wj(b,z);e(a,c)};a.oD=function(a,c){var d=D.Wj(c,z);b(a,d)};a.NI=function(a,b){y(a,z);return b=D.Fw(euler,b)};a.OI=function(a,b){r(a,z);return b=D.Fw(euler,b)};a.Mf=function(a,b){var c=a.k;if(f.gg(a)){var c=f.fg(a),d=K.Yd(f.$u(a));K.Mf(b/d,c)}else K.Mf(b,c.n)};
a.qD=function(a,b){var c=a.k;f.gg(a)?K.Mf(b,f.fg(a)):K.Mf(b,c.n)};a.Yd=function(a){return K.Yd(a.k.n)};a.SI=function(a){return f.gg(a)?K.Yd(f.fg(a)):K.Yd(a.k.n)};a.mj=function(a,b){K.copy(b,a.k.n);if(f.gg(a)){var c=f.$u(a),c=K.invert(c,d);K.multiply(c,a.k.n,f.fg(a))}};a.Zw=A;a.vr=function(a,b){return K.copy(a.k.n,b)};a.wr=h;a.dv=function(a){var b=a.k;a=b.vl;var c=K.Yd(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.cv=function(a,b,c){b?(a=
a.k,Q.copy(a.lb.F,c)):(a=a.k,b=a.vl,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,K.Xc(c,a.n,c));return c};a.fh=function(a,b,c,f){var e=h(a,d),k=L;k[0]=b;k[1]=c;k[2]=f;K.Xc(k,e,k);n(a,k)};a.$C=function(a,b){var c=h(a,d),f=K.Jk(b,K.identity(p));K.multiply(c,f,f);A(a,f)};a.D=w;a.distance=function(a,b){var c=K.hc(a.k.n,L),d=K.hc(b.k.n,H);return Q.dist(c,d)};a.ro=function(a,b){var c=K.hc(a.k.n,L);return Q.dist(c,b)};a.II=function(a){return{max_x:a.k.Ua.max_x,min_x:a.k.Ua.min_x,
max_y:a.k.Ua.max_y,min_y:a.k.Ua.min_y,max_z:a.k.Ua.max_z,min_z:a.k.Ua.min_z}}};b4w.module.__sfx=function(a,l){function n(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return D.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;D.warn("deprecated WebAudio implementation");return null}D.warn("WebAudio is not supported");return null}function e(a,c,d){var f=a.X;if("NONE"!=f.behavior){var e=f.loop,g=f.pitch;if(f.src&&(e||0<=d)){f.xz=Math.floor(5E4*Math.random());var k=G.currentTime+c,k=
Math.max(0,k);f.lf=k;f.state=20;var p=F.Rc;"POSITIONAL"==f.behavior&&"none"==p.Yq&&(f.behavior="BACKGROUND_SOUND");b(a,F.Rc);if("POSITIONAL"==f.behavior||"BACKGROUND_SOUND"==f.behavior){c=G.createBufferSource();c.buffer=f.src;c.playbackRate.value=g;if(e){f.dc&&f.dc.disconnect();f.Kd&&f.Kd.disconnect();c.loop=!0;c.loopStart=f.$J;if(c.loopEnd=f.Vv)d=G.createBufferSource(),d.buffer=f.src,d.playbackRate.value=g,f.Kd=d,d.connect(f.Fd);c.start(k);f.duration=0}else e=c.buffer?c.buffer.duration:0,d>e?(e=
k+d+f.Ff,c.loop=!0,c.start(k),c.stop(e),f.duration=d):(c.loop=!1,c.start(k),f.duration=e);c.connect(f.Fd);f.dc=c;r(f);A(f);h(f)}else"BACKGROUND_MUSIC"==f.behavior&&(L.mu(f.yz),L.mu(f.zz),d=function(){var b=a.X,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.dc=b.dc||G.createMediaElementSource(c),b.dc.connect(b.Fd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():f.yz=L.SL(d,1E3*c),f.duration=e?0:J(a));w(f,k)}}}function b(a,b){var c=a.X;if(!c.Fd){var f=H.G(a.k.n),e=H.P(a.k.n);if(M.cw){var g=
G.createBiquadFilter();g.type="peaking"}else g=null;var k=G.createGain();switch(c.behavior){case "POSITIONAL":var h=G.createPanner();"string"!=typeof h.panningModel?(h.panningModel=h.EQUALPOWER,h.distanceModel=h.INVERSE_DISTANCE):(h.panningModel="equalpower",h.distanceModel=b.Yq);h.setPosition(f[0],f[1],f[2]);d.copy(f,c.KB);f=x;z.lc(e,z.Nc,f);h.setOrientation(f[0],f[1],f[2]);h.refDistance=c.Xq;h.maxDistance=c.Qg;h.rolloffFactor=c.cq;h.coneInnerAngle=c.VG;h.coneOuterAngle=c.WG;h.coneOuterGain=c.XG;
var p=G.createGain();p.gain.value=O(c);g?(h.connect(g),g.connect(p)):h.connect(p);p.connect(k);c.Fd=h;if(c.fn){var m=G.createGain();k.connect(m);m.connect(b.Fd)}else m=null,k.connect(b.Fd);break;case "BACKGROUND_SOUND":h=null;p=G.createGain();p.gain.value=O(c);g?(c.Fd=g,g.connect(p)):c.Fd=p;p.connect(k);c.fn?(m=G.createGain(),k.connect(m),m.connect(b.Fd)):(m=null,k.connect(b.Fd));break;case "BACKGROUND_MUSIC":m=h=null,p=G.createGain(),p.gain.value=O(c),g?(c.Fd=g,g.connect(p)):c.Fd=p,p.connect(k),
k.connect(b.Fd)}c.wC=h;c.Ug=g;c.Vn=p;c.Xj=k;c.LC=m}}function y(a){var b=a.X,c=b.duration,b=b.BH+b.CH*Math.random();e(a,b,c)}function r(a){var b=a.Kd||a.dc;z.Wh(b.onended)&&(b.onended=function(){a.state=50})}function A(a){a.fn&&a.LC.gain.cancelScheduledValues(a.lf);a.wo&&(a.dc.playbackRate.cancelScheduledValues(a.lf),a.Kd&&a.Kd.playbackRate.cancelScheduledValues(a.lf));a.dt=a.lf}function h(a){if(a.fn||a.wo){var b=a.LC,c=a.dc,d=c.buffer?c.buffer.duration:0;if(d){var f=a.lf;R[0]=a.xz;for(var e=0;5>e;){var g=
a.pitch+a.wo*z.tg(R);if(f>=a.dt){if(a.fn){var k=1-z.U(a.fn,0,1)*Math.random();b.gain.setValueAtTime(k,f)}a.wo&&(c.playbackRate.setValueAtTime(g,f),a.Kd&&a.Kd.playbackRate.setValueAtTime(g,f));e++}f+=d/g}a.dt=f-.001}}}function w(a,b){if(a.Ul||a.Ff){var c=a.Xj;c.gain.cancelScheduledValues(b);a.Ul?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Ul)):c.gain.setValueAtTime(1,b);a.Ff&&!a.loop&&(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Ff))}}
function m(a){"SPEAKER"!=a.type&&z.q("Wrong object type");var b=a.X;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Xj,d=G.currentTime;b.Ff&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Ff));"BACKGROUND_MUSIC"==b.behavior?b.src&&(L.mu(b.yz),L.mu(b.zz),b.zz=L.SL(function(){var b=a.X.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Ff)):(c=b.dc,b.duration<c.buffer.duration?b.Ff&&20==b.state?c.stop(d+b.Ff):20==b.state&&(c.stop(0),c.disconnect()):
c.disconnect(),b.lf=0,b.xC=0,b.Iz=0);b.state=30}}function k(a){a=a.X;if(20==a.state){var b=G.currentTime;a.xC=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.Iz=b>a.lf?f(a,b):0,a.dc.onended=function(){},a.dc.stop(0),a.dc.disconnect(),A(a));a.state=40}}function f(a,b){R[0]=a.xz;for(var c=a.dc.buffer.duration,d=a.lf,f;d<b;)f=a.pitch+a.wo*z.tg(R),d+=c/f;return(c/f-(d-b))*f}function v(a){var b=a.X;if(40==b.state){var c=G.currentTime;b.lf+=c-b.xC;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();
else{a=a.X;var d=G.createBufferSource();d.loop=a.dc.loop;d.loopStart=a.dc.loopStart;d.loopEnd=a.dc.loopEnd;d.buffer=a.dc.buffer;d.playbackRate.value=a.dc.playbackRate.value;d.connect(a.Fd);a.dc=d;a.Kd&&(d=G.createBufferSource(),d.loop=a.Kd.loop,d.buffer=a.Kd.buffer,d.playbackRate.value=a.Kd.playbackRate.value,d.connect(a.Fd),a.Kd=d);b.dt=c;c=b.dc;r(b);c.start(b.lf,b.Iz);h(b)}w(b,b.lf);b.state=20}}function c(a,b,c){var f=1,f=b.HT;if(0<f){var e=b.iZ;if(0!=d.dot(a.Ex,a.Ex)||0!=d.dot(b.ym,b.ym)){var g=
d.subtract(a.KB,b.Yh,x),k=d.length(g);b=d.dot(g,b.ym)/k;g=d.dot(g,a.Ex)/k;g=-g;k=e/f;b=Math.min(-b,k);g=Math.min(g,k);f=(e-f*b)/(e-f*g);isFinite(f)||(f=0);f=Math.min(f,16);f=Math.max(f,.125);f=z.mc(f,a.TJ,c,.3);a.dc.playbackRate.value=f;a.TJ=f}}}function C(a){a=a.X;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function O(a){return a.muted?0:a.volume}function J(a){a=a.X;return(a=a.src)?a.duration:0}var K=l("__config"),D=l("__print"),Q=l("__quat"),L=l("__time"),H=l("__tsr"),z=l("__util"),
d=l("__vec3"),p=K.B,M=K.X,x=new Float32Array(3),g=new Float32Array(3);new Float32Array(3);var P=Q.create(),t=[],da=[],G=null,F=null,U=[],R=[1],Z=null;a.zE=10;a.Tx=20;a.yE=30;a.JS=function(){return{wj:-1,Tg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,cq:1,Xq:1,Qg:1E4,VG:360,WG:360,XG:1,autoplay:!1,ze:!1,loop:!1,$J:0,Vv:0,BH:0,CH:0,fn:0,wo:0,Ul:0,Ff:0,lf:0,xC:0,Iz:0,duration:0,dt:0,xz:1,src:null,state:10,KB:new Float32Array(3),Ex:new Float32Array(3),Nu:!1,TJ:1,yz:-1,zz:-1,Ql:0,Fd:null,dc:null,Kd:null,
wC:null,Ug:null,Vn:null,Xj:null,LC:null,Vk:0}};a.Xg=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(t.push("ogg"),t.push("ogv"),t.push("oga")),""!=a.canPlayType("audio/mpeg")&&t.push("mp3"),""!=a.canPlayType("audio/mp4")&&(t.push("mp4"),t.push("m4v"),t.push("m4a")),""!=a.canPlayType("audio/webm")&&t.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(da.push("ogv"),da.push("ogg"),da.push("oga")),""!=b.canPlayType("video/mp4")&&
(da.push("m4v"),da.push("mp4")),""!=b.canPlayType("video/webm")&&da.push("webm"),""!=b.canPlayType("video/mpeg")&&da.push("mp3"))};a.UQ=function(a){M.rE&&!G&&(G=n())&&D.log("%cINIT WEBAUDIO: "+G.sampleRate+"Hz","color: #00a");if(G){var b={Yh:new Float32Array(3),ym:new Float32Array(3),Vk:0},c=G.createGain(),d=G.createGain();b.Vn=c;b.Xj=d;c.connect(d);d.connect(G.destination);if(a.b4w_enable_dynamic_compressor){var d=G.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;d.threshold.value=
f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.Jq=d;b.Fd=d}else b.Jq=null,b.Fd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Yq="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Yq="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Yq="exponential";break;case "NONE":b.Yq="none";break;default:z.q("Wrong audio distance model")}b.HT=a.audio_doppler_factor;b.iZ=a.audio_doppler_speed;b.muted=!1;
b.volume=a.audio_volume;c.gain.value=O(b);b.Ql=0}else b=null;a.Rc=b};a.fY=function(a){F=a};a.AT=function(a){a||(a="ogg");return-1<t.indexOf(a)?a:-1<t.indexOf("m4a")?"m4a":-1<t.indexOf("oga")?"oga":""};a.CT=function(a){a||(a="webm");return-1<da.indexOf(a)?a:-1<da.indexOf("m4v")?"m4v":-1<da.indexOf("webm")?"webm":""};a.Wk=function(a,b){var c=a.data,d=b.X;d.wj=a.data.sound.uuid;d.Tg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=G?c.b4w_behavior:"NONE";
break;case "BACKGROUND_MUSIC":var f;G?(window.MediaElementAudioSourceNode?f=!0:(D.warn("MediaElementAudioSourceNode not found"),f=!1),f=f&&!p.LG?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):f="NONE";d.behavior=f;break;default:z.q("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Nu=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.cq=c.attenuation;d.Xq=c.distance_reference;d.Qg=c.distance_max||1E4;d.VG=c.cone_angle_inner;d.WG=c.cone_angle_outer;d.XG=c.cone_volume_outer;d.autoplay=
c.b4w_auto_play;d.ze=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.$J=c.b4w_loop_start;d.Vv=c.b4w_loop_end;d.BH=c.b4w_delay;d.CH=c.b4w_delay_random;d.fn=c.b4w_volume_random;d.wo=c.b4w_pitch_random;d.Ul=c.b4w_fade_in;d.Ff=c.b4w_fade_out;U.push(b)};a.nM=function(b){"SPEAKER"!=b.type&&z.q("Wrong object type");switch(b.X.behavior){case "POSITIONAL":return a.Tx;case "BACKGROUND_SOUND":return a.Tx;case "BACKGROUND_MUSIC":return a.yE;case "NONE":return a.zE;default:z.q("Wrong speaker behavior")}};a.z_=function(a,
b){var c=a.X;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:z.q("Wrong speaker behavior")}};a.IK=function(){var a=G.createBufferSource();a.buffer=G.createBuffer(1,22050,22050);a.connect(G.destination);a.start(0)};a.yT=function(a,b,c){G?G.decodeAudioData(a,b,c):c()};a.gZ=function(a){m(a);a.X=null;U.splice(U.indexOf(a),1)};a.ua=function(){for(var a=0;a<U.length;a++){var b=U[a].X;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():
(b.dc&&b.dc.disconnect(),b.Kd&&b.Kd.disconnect())}F&&F.Rc&&(a=F.Rc,a.Yh[0]=0,a.Yh[1]=0,a.Yh[2]=0,a.ym[0]=0,a.ym[1]=0,a.ym[2]=0);F=null;U.splice(0);Z=null};a.update=function(a){if(G&&0!=U.length){for(var b=0;b<U.length;b++){var c=U[b],d=c.X,f=d.dc,e=G.currentTime;!d.loop&&20==d.state&&d.duration&&d.lf+d.duration<e&&("BACKGROUND_MUSIC"==d.behavior||f&&!z.Wh(f.onended))&&(d.state=50);d.ze&&50==d.state&&y(c);20==d.state&&3>d.dt-e&&h(d)}Z&&Z.oj.length&&(-1==Z.Gc||a>Z.FF+Z.HH[Z.Gc])&&(b=Z,-1<b.Gc&&m(b.oj[b.Gc]),
-1==b.Gc&&b.random?c=Math.round(Math.random()*(b.oj.length-1)):b.random?(c=1+Math.round(Math.random()*(b.oj.length-2)),c=(b.Gc+c)%b.oj.length):c=(b.Gc+1)%b.oj.length,y(b.oj[c]),b.Gc=c,b.FF=a)}};a.play=e;a.HK=y;a.stop=m;a.aW=function(a){return 20==a.X.state};a.d9=k;a.e9=v;a.b7=function(a,b){var c=a.X,d=c.Kd;if(C(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var f=G.currentTime+b;c.dc.stop(f);d.start(f,c.Vv)}};a.tX=function(a,b){var c=a.X;c.pitch=b;!C(a)||"POSITIONAL"!=c.behavior&&
"BACKGROUND_SOUND"!=c.behavior||(c.dc.playbackRate.value=b,c.Kd&&(c.Kd.playbackRate.value=b),A(c),h(c))};a.x5=function(a){return a.X.pitch};a.ze=function(a,b){a.X.ze=Boolean(b)};a.QV=function(a){return a.X.autoplay};a.TV=function(a){return a.X.ze};a.wW=function(a,b,f,e,k){if(a=a.Rc){var h=x;h[0]=0;h[1]=0;h[2]=-1;d.transformQuat(h,f,h);g[0]=0;g[1]=1;g[2]=0;d.transformQuat(g,f,g);f=G.listener;f.setPosition(b[0],b[1],b[2]);f.setOrientation(h[0],h[1],h[2],g[0],g[1],g[2]);if(e&&a.Vk!=k){if(a.RB)a.RB=!1,
d.copy(b,a.Yh);else for(f=a.ym,f[0]=(b[0]-a.Yh[0])/e,f[1]=(b[1]-a.Yh[1])/e,f[2]=(b[2]-a.Yh[2])/e,d.copy(b,a.Yh),b=0;b<U.length;b++)f=U[b],h=f.X,C(f)&&"POSITIONAL"==h.behavior&&h.Nu&&c(h,a,e);a.Vk=k}else d.copy(b,a.Yh)}};a.RB=function(){var a=F.Rc;a&&(a.RB=!0)};a.hZ=function(a,b,f){var e=a.X;if(C(a)&&"POSITIONAL"==e.behavior){var k=H.hc(a.k.n,x);a=H.Xd(a.k.n,P);var h=e.wC;h.setPosition(k[0],k[1],k[2]);z.lc(a,z.Nc,g);h.setOrientation(g[0],g[1],g[2]);e.Nu&&(a=e.KB,b&&e.Vk!=f?(e.Xm?(d.copy(k,a),e.Xm=
!1):(h=e.Ex,h[0]=(k[0]-a[0])/b,h[1]=(k[1]-a[1])/b,h[2]=(k[2]-a[2])/b,d.copy(k,a),c(e,F.Rc,b)),e.Vk=f):d.copy(k,a))}};a.f9=function(a){var b=a.X;C(a)&&"POSITIONAL"==b.behavior&&b.Nu&&(b.Xm=!0)};a.mB=function(a){return a.X.behavior};a.L2=function(){for(var a=0;a<U.length;a++)if(C(U[a]))return!0;return!1};a.s8=function(a){var b=F.Rc;b&&(b.volume=a,G&&(b.Vn.gain.value=O(b)))};a.g5=function(){var a=F.Rc;return a?a.volume:0};a.PY=function(a,b){var c=a.X;c.volume=b;C(a)&&(c.Vn.gain.value=O(c))};a.b6=function(a){return a.X.volume};
a.qc=function(a,b){a.X.muted=Boolean(b);C(a)&&(a.X.Vn.gain.value=O(a.X))};a.O6=function(a){return a.X.muted};a.i7=function(a){var b=F.Rc;b&&(b.muted=Boolean(a),G&&(b.Vn.gain.value=O(b)))};a.N6=function(){var a=F.Rc;return a?a.muted:!1};a.pV=function(){return U};a.pause=function(){for(var a=0;a<U.length;a++)k(U[a])};a.jj=function(){for(var a=0;a<U.length;a++)v(U[a])};a.f8=function(a,b){if(a.Rc&&a.Rc.Jq){var c=a.Rc.Jq;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=
b.attack;c.release.value=b.release}};a.C4=function(a){if(!a.Rc||!a.Rc.Jq)return null;a=a.Rc.Jq;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.J3=function(a,b,c){if(C(a)){a=a.X;var d=a.Xj,f=G.currentTime;d.gain.setValueAtTime(d.gain.value,f);d.gain.linearRampToValueAtTime(b,f+c);a.Ql=c}};a.H9=function(a){if(C(a)){a=a.X;var b=a.Xj,c=G.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Ql);
a.Ql=0}};a.K3=function(a,b){if(G){var c=F.Rc,d=c.Xj,f=G.currentTime;d.gain.setValueAtTime(d.gain.value,f);d.gain.linearRampToValueAtTime(a,f+b);c.Ql=b}};a.I9=function(){if(G){var a=F.Rc,b=a.Xj,c=G.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Ql);a.Ql=0}};a.q2=function(a,b,c){Z={Gc:-1,FF:0,random:c,oj:[],HH:[]};for(c=0;c<a.length;c++){var d=a[c],f=J(d);0==f?D.warn("Ignoring speaker with zero duration: "+d.name):(m(d),d.X.ze=!1,Z.oj.push(d),Z.HH.push(f+b))}};
a.H4=J;a.g3=function(){if(Z)for(var a=Z.oj,b=0;b<a.length;b++)m(a[b]);Z=null};a.A5=function(a){return(a=a.X)&&"POSITIONAL"==a.behavior?{dist_ref:a.Xq,dist_max:a.Qg,attenuation:a.cq}:null};a.G8=function(a,b){var c=a.X;if(c&&"POSITIONAL"==c.behavior){c.Xq=b.dist_ref;c.Qg=b.dist_max;c.cq=b.attenuation;var d=c.wC;d&&(d.refDistance=c.Xq,d.maxDistance=c.Qg,d.rolloffFactor=c.cq)}};a.l8=function(a,b){var c=a.X;c&&c.Ug&&(c.Ug.frequency.value=b.freq,c.Ug.Q.value=b.Q,c.Ug.gain.value=b.gain)};a.N4=function(a){return(a=
a.X)&&a.Ug?{freq:a.Ug.frequency.value,Q:a.Ug.Q.value,gain:a.Ug.gain.value}:null};a.M4=function(a,b,c,d){a=a.X;if(!a||!a.Ug)return null;a.Ug.getFrequencyResponse(b,c,d)};a.reset=function(){t.length=0;da.length=0;G=null}};b4w.module.__time=function(a,l){function n(){return-1!==e.sl.Uu?e.sl.Uu:m}var e=l("__config");l("__print");var b=0,y=0,r=[],A=0,h=0,w=[],m=-1;a.RL=function(a){b=a;y=performance.now();for(a=0;a<r.length;a++){var f=r[a];b>f.PA&&(r.splice(a,1),a--,f.callback())}for(a=0;a<w.length;a++){var f=w[a],e=1-(f.PA-b)/f.duration,e=Math.min(e,1);f.callback(f.from+e*(f.to-f.from));1==e&&(w.splice(a,1),a--)}};a.ur=function(){return b};a.SL=function(a,f){var e;A++;e=A;r.push({id:e,callback:a,PA:b+(performance.now()-
y+f)/1E3});return e};a.mu=function(a){for(var b=0;b<r.length;b++)if(r[b].id==a){r.splice(b,1);break}};a.ku=function(a){for(var b=w.length;b--;)if(w[b].id==a){w.splice(b,1);break}};a.xn=function(a,f,e,c){e/=1E3;var m;h++;m=h;w.push({id:m,callback:c,from:a,to:f,PA:b+e,duration:e});c(a);return m};a.reset=function(){y=b=0;r.length=0;h=A=w.length=0};a.rd=n;a.rY=function(a){m=a};a.rr=function(a){return a*n()}};"object"==typeof module&&module.QA&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function l(){var a=n,e=a.getDate(),e=10>e?"0"+String(e):String(e),l=a.getMonth()+1,l=10>l?"0"+String(l):String(l),A=String(a.getFullYear()),h=a.getHours(),h=10>h?"0"+String(h):String(h),w=a.getMinutes(),w=10>w?"0"+String(w):String(w),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return e+"."+l+"."+A+" "+h+":"+w+":"+a}var n=new Date(2017,5,10,20,19,29),e=[16,12,1];a.version=function(){return e};a.mE=function(){for(var a="",l=0;l<e.length;l++)a=1==l?a+(10>e[l]?"0"+
e[l]:e[l]):a+e[l],l!=e.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.wH=function(){return n};a.AA=l;a.timestamp=function(){var a=l(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.QA&&b4w.module.__version(exports);b4w.module.__navmesh=function(a,l){function n(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var f=a.cl,e=c.cl,g=[],k=0;k<f.length;k++)0<=b(e,f[k])&&g.push(f[k]);if(2>g.length)return[];0<=b(g,f[0])&&0<=b(g,f[f.length-1])&&d(f);0<=b(g,e[0])&&0<=b(g,e[e.length-1])&&d(e);g=[];for(k=0;k<f.length;k++)0<=b(e,f[k])&&g.push(f[k]);return g}function e(a){function b(a){for(var c=a.mg,d=0;d<c.length;d++){var f=c[d];void 0==f.island&&(f.island=a.island,b(f))}}a=a.uX;for(var c=[],d=0,f=0;f<a.length;f++){var e=
a[f];void 0==e.island&&(e.island=d++,b(e));c[e.island]||(c[e.island]=[]);c[e.island].push(a[f])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function y(a){function b(a,c){for(var d=0;d<a.length;d++)if(c===a[d])return d}for(var c={},d=a.mp,f=0;f<d.length;f++)d[f][0]=parseFloat(d[f][0].toFixed(2)),d[f][1]=parseFloat(d[f][1].toFixed(2)),d[f][2]=parseFloat(d[f][2].toFixed(2));c.mp=a.mp;a=e(a);c.JB=[];for(f=0;f<a.length;f++){for(var d=
[],g=a[f],k=0;k<g.length;k++){for(var h=[],p=g[k],q=0;q<p.mg.length;q++)h.push(b(g,p.mg[q]));for(var m=[],q=0;q<p.mg.length;q++)m.push(n(p,p.mg[q]));p.fd[0]=parseFloat(p.fd[0].toFixed(2));p.fd[1]=parseFloat(p.fd[1].toFixed(2));p.fd[2]=parseFloat(p.fd[2].toFixed(2));d.push({id:b(g,p),mg:h,cl:p.cl,fd:p.fd,Uc:p.Uc,vX:m,UA:0,lr:0,Ib:0,jS:1,oE:!1,closed:!1,parent:null})}c.JB.push(d)}return c}function r(a,b,c,d,f){function e(a,b){D.subtract(a,b,L);return D.dot(L,L)}function g(a,b){for(var c=[],d=0;d<b.mg.length;d++)c.push(a[b.mg[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.UA=0;c.lr=0;c.Ib=0;c.jS=1;c.oE=!1;c.closed=!1;c.parent=null}})(a);var k=O.aR(function(a){return a.UA});for(O.gG(k,b);0<k.content.length;){var h=O.bR(k);if(h===c){a=h;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}h.closed=!0;for(var q=g(a,h),p=0,m=q.length;p<m;p++){var l=q[p];if(!l.closed){var n=h.lr+D.dist(l.fd,h.fd),t=l.oE;if(!t||n<l.lr)l.oE=!0,l.parent=h,l.Ib=l.Ib||e(l.fd,f)+e(l.fd,d),l.lr=n,l.UA=l.lr+l.Ib,t?O.cR(k,
l):O.gG(k,l)}}}return[]}function A(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function h(a,b,c,d){b=D.subtract(b,a,L);a=D.subtract(c,a,H);a=D.cross(b,a,L);return K.sign(D.dot(d,a))}function w(a,b){D.subtract(a,b,L);return 1E-5>D.dot(L,L)}function m(a,b,c){var d=D.subtract(b.right,b.left,L),f=c.Uc,e=b.Uc;c=Math.acos(D.dot(f,e));f=K.sign(D.dot(d,D.cross(f,e,H)));c*=-f;f=J.identity(g);J.translate(f,b.left,f);J.rotate(f,c,d,f);J.translate(f,D.scale(b.left,-1,H),f);J.multiply(a,f,a)}function k(a,b,c,
f,e,g,k,h,l){for(var q=J.identity(M),n=e;n<c;n++)if(a[n].FJ&&(n>e||!n)){var t,r=b,x=f;t=a[n].left;var w=a[n].right,v=g,C=q,H=D.create(),F=D.transformMat4(t,C,z);F[3]=1;C=D.transformMat4(w,C,L);C=D.subtract(C,F,d);r=D.subtract(x,r,L);v=D.cross(v,r,p);.01>Math.abs(D.dot(v,C))?x=.5:(D.normalize(v,v),v[3]=-D.dot(v,x),x=-Q.dot(v,F)/Q.dot(v,C));w=D.subtract(w,t,L);t=D.scaleAndAdd(t,w,x,H);A(k,t);h&&A(l,a[n].Uc);n&&m(q,a[n],a[n-1])}}function f(a,b){function c(b,d){v=M=r=d;p=g=e=b;D.copy(b,l);D.copy(b,q);
D.copy(a[r].Uc,n)}var d=[],f=[],e,g,p,l,q,n,r=0,M=0,v=0;e=a[0].right;g=a[0].left;p=a[0].right;l=D.copy(g,P);q=D.copy(p,t);n=D.copy(a[0].Uc,F);A(d,e);b&&A(f,a[0].Uc);for(var z=J.identity(x),C=1;C<a.length;C++){var H=a[C].left,y=a[C].right,O=D.transformMat4(H,z,da),L=D.transformMat4(y,z,G);a[C].FJ&&m(z,a[C],a[C-1]);if(0>=h(e,q,L,n)){var ha=w(e,p);if(ha||0<h(e,l,L,n))p=y,D.copy(L,q),v=C;else{(H=w(l,e))||k(a,l,M,e,r,n,d,b,f);z=J.identity(z);c(g,M);C=r;H||(A(d,e),b&&A(f,a[C].Uc));continue}}0<=h(e,l,O,
n)&&((ha=w(e,g))||0>h(e,q,O,n)?(g=H,D.copy(O,l),M=C):((H=w(q,e))||k(a,q,v,e,r,n,d,b,f),z=J.identity(z),c(p,v),C=r,H||(A(d,e),b&&A(f,a[C].Uc))))}z=a.length-1;C=a[z].left;(H=w(e,C))||k(a,l,z,e,r,n,d,b,f);H&&r||A(d,C);return b?(A(f,a[z].Uc),{positions:new Float32Array(d),normals:new Float32Array(f)}):{positions:new Float32Array(d),normals:null}}function v(a,b,c,d,f){for(var e=null,g=Number.MAX_VALUE,k=0;k<a.length;k++){var h=a[k],q=f(c,h.fd,h.cl,b,g);q<g&&(e=h,g=q)}return 0<d&&g>d?null:e}function c(a,
b,c,d,f){a.push({left:b,right:c,FJ:d,Uc:f})}var C=l("__geometry"),O=l("__math"),J=l("__mat4"),K=l("__util"),D=l("__vec3"),Q=l("__vec4"),L=D.create(),H=D.create(),z=Q.create(),d=Q.create(),p=Q.create(),M=J.create(),x=J.create(),g=J.create(),P=D.create(),t=D.create(),da=D.create(),G=D.create(),F=D.create();a.ZW=function(a){var b=C.hv(a.tc,C.UP),c=a.le;a=[];for(var d=0;d<c.length;d+=3)a.push({na:new Uint32Array([c[d],c[d+1],c[d+2]]),fd:new Float32Array(3),Uc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var f=new Float32Array(3);f[0]=b[d];f[1]=b[d+1];f[2]=b[d+2];c.push(f)}for(b=0;b<a.length;b++)d=a[b],D.add(c[d.na[0]],c[d.na[1]],L),D.add(L,c[d.na[2]],L),D.scale(L,1/3,d.fd);for(b=0;b<a.length;b++){var d=a[b],f=D.subtract(c[d.na[1]],c[d.na[0]],L),e=D.subtract(c[d.na[2]],c[d.na[0]],H),f=D.cross(f,e,L);D.normalize(f,f);D.copy(f,d.Uc)}for(var g={},b=[],d=[],k,h,q=Math.pow(10,4),f=0,e=c.length;f<e;f++)k=c[f],h=Math.round(k[0]*q)+"_"+Math.round(k[1]*q)+"_"+Math.round(k[2]*q),void 0===g[h]?(g[h]=f,b.push(k),
d[f]=b.length-1):d[f]=d[g[h]];g=[];f=0;for(e=a.length;f<e;f++)for(k=a[f],k.na[0]=d[k.na[0]],k.na[1]=d[k.na[1]],k.na[2]=d[k.na[2]],k=[k.na[0],k.na[1],k.na[2]],h=0;3>h;h++)if(k[h]==k[(h+1)%3]){g.push(f);break}for(f=g.length-1;0<=f;f--)a.splice(g[f],1);c.length=0;for(f in b)c.push(b[f]);d=[];for(b=f=0;b<a.length;b++)e=a[b],d.push({id:f++,cl:e.na,fd:e.fd,Uc:e.Uc,mg:[]});a={uX:d,mp:c};c={};for(b=0;b<d.length;b++)for(f=0;3>f;f++)e=d[b].cl[f],g=d[b].cl[(f+1)%3],e=e>g?g+"-"+e:e+"-"+g,e in c||(c[e]=[]),c[e].push(d[b]);
d=Object.keys(c);b=0;for(g=d.length;b<g;b++)for(e=d[b],f=0;f<c[e].length;f++)for(k=f+1;k<c[e].length;k++)c[e][f].mg.push(c[e][k]),c[e][k].mg.push(c[e][f]);return y(a)};a.lK=function(a,b,c){for(var d=null,f=Number.MAX_VALUE,e=a.JB,g=0;g<e.length;g++)for(var k=0;k<e[g].length;k++){var h=e[g][k];D.subtract(h.fd,b,L);h=c(b,h.fd,h.cl,a.mp,f);h<f&&(d=g,f=h)}return d};a.bW=function(a,b,c){for(var d=[],f=0;f<b.length;f++)d.push(c[b[f]]);b=!1;c=-1;for(var f=d.length,e=f-1;++c<f;e=c)(d[c][1]<=a[1]&&a[1]<d[e][1]||
d[e][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[e][0]-d[c][0])*(a[1]-d[c][1])/(d[e][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.kK=function(a,b,d,e){var g;g=a.JB[e.island];var k=a.mp,h=v(g,k,b,e.allowed_distance,e.distance_to_closest);g=h?(k=v(g,k,d,e.allowed_distance,e.distance_to_farthest))?r(g,h,k,b,d):null:null;if(g&&g.length)if(e.do_not_pull_string)if(d=g,e.return_normals){b=new Float32Array(3*d.length);for(g=0;g<d.length;g++)b.set(d[g].fd,3*g);d={positions:b,normals:null}}else{b=new Float32Array(3*
d.length);a=new Float32Array(3*d.length);for(g=0;g<d.length;g++)b.set(d[g].fd,3*g),a.set(d[g].Uc,3*g);d={positions:b,normals:a}}else{a=a.mp;e=e.return_normals;h=[];c(h,b,b,!1,g[0]&&g[0].Uc||K.nc);for(b=0;b<g.length;b++){var p=g[b];if(k=g[b+1]){var m=.999>Math.abs(D.dot(p.Uc,k.Uc));a:{for(var q=0;q<p.mg.length;q++)if(p.mg[q]===k.id){p=p.vX[q];break a}p=void 0}c(h,a[p[0]],a[p[1]],m,k.Uc)}}c(h,d,d,!1,h[h.length-1].Uc);d=f(h,e)}else d=null;return d}};b4w.module.__geometry=function(a,l){function n(){return{length:0,frames:1,Jc:0,Xm:0,offset:0,Zq:0}}function e(a,b){for(var c=b.a_tbn_quat,d=b.a_position,f=c.length,e=d.length,g=1;g<a.jb.length;g++)for(var k=a.jb[g].Gf,q=a.jb[g].Cr,k=k.a_position,h=0;h<e;h++)d[h]+=q*k[h];d=S;for(g=0;g<f;g+=4){e=c.subarray(g,g+4);d.set(aa.sn);for(h=1;h<a.jb.length;h++)k=a.jb[h].Gf,q=a.jb[h].Cr,q=ca.slerp(aa.sn,k.a_tbn_quat,q,sa),ca.normalize(q,q),ca.multiply(q,d,d);ca.multiply(d,e,e)}}function b(a){return 65536<a.Ja?
u.uI()?!1:!0:!1}function y(a){return 0<a.na.length?!0:!1}function r(a,b,c){if(!y(a))return a;c||ga.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ja*(b||1)+", will use drawArrays","color: #aa0");b=a.na;c=a.Ja;var d=a.qa,f=a.aa,e;for(e in d){var g=d[e],k=Q(g,c);d[e]=A(b,g,k)}for(d=0;d<f.length;d++){var q=f[d];for(e in q)g=q[e],k=Q(g,c),q[e]=A(b,g,k)}for(d=0;d<a.jb.length;d++){e=a.jb[d].Gf;for(var h in e)g=e[h],k=Q(g,c),e[h]=A(b,g,k)}a.Ja=b.length;a.na=new Uint16Array(0);return a}
function A(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),f=0;f<a.length;f++)for(var e=a[f],g=0;g<c;g++)d[c*f+g]=b[c*e+g];return d}function h(){return{le:null,tc:g(),km:0,count:0,kd:{},$m:0,Hn:0,Jn:0,Md:[],hg:null,jb:null,om:1,Yf:!0}}function w(a,b){var c=a.kd[b];if(c){var d=U(b);return G(a.tc,d).subarray(c.offset,c.offset+c.length)}aa.q("extract_array() failed; invalid name: "+b)}function m(b,c){var d;switch(c){case a.on:case a.wp:d=Y.STATIC_DRAW;break;case a.nt:d=
Y.DYNAMIC_DRAW;break;default:aa.q("Wrong draw_mode")}b.$m=d}function k(a,b,c){function d(a,b){f[a]||(f[a]=0);f[a]+=b}var f={},e;for(e in a[0]){var g=a[0][e],k=U(e);d(k,g.length*a.length)}for(e in b)g=b[e],k=U(e),d(k,g.length);if(c){a=c.ep.length;k=U("a_part_ts");d(k,4*a);k=U("a_part_r");d(k,4*a);b=c.Jm;for(e in b)k=U(e),d(k,b[e].Jc*a);c=c.Ns;for(e in c)k=U(e),d(k,a)}return f}function f(a){a.le?(a.hg||(a.hg=Y.createBuffer()),Y.bindBuffer(Y.ELEMENT_ARRAY_BUFFER,a.hg),Y.bufferData(Y.ELEMENT_ARRAY_BUFFER,
a.le,a.$m),a.Hn=a.le.byteLength):a.Hn=0;for(var b=a.Jn=0;b<a.tc.length;b++){var c=a.tc[b].type,d=t(a.Md,c);-1==d&&(a.Md.push({Yk:null,type:c,wT:aa.TZ()}),d=a.Md.length-1);c=a.Md[d];c.Yk||(c.Yk=Y.createBuffer());Y.bindBuffer(Y.ARRAY_BUFFER,c.Yk);Y.bufferData(Y.ARRAY_BUFFER,a.tc[b].pi,a.$m);a.Jn+=a.tc[b].pi.byteLength}}function v(a,b){a.R=Z.Al(a.R,b);a.ba=Z.lq(a.ba,b);a.wa=Z.mq(a.wa,b);a.zd=Z.Ez(a.zd,b)}function c(a){for(var b=a[0],c=a[0],d=x("JOIN_"+a.length+"_SUBMESHES"),f=0,e=0;e<a.length;e++)f+=
a[e].na.length;d.na=new Uint32Array(f);var g=f=0;if(0<a[0].jb.length)for(var k=0;k<a[0].jb.length;k++){for(e=0;e<a.length;e++)f+=a[e].jb[k].Gf.a_position.length,g+=a[e].jb[k].Gf.a_tbn_quat.length;e={a_position:new Float32Array(f),a_tbn_quat:new Float32Array(g)};d.jb.push({Cr:a[0].jb[k].Cr,Gf:e})}for(e=f=0;e<a.length;e++)f+=a[e].Ja;d.Ja=f;for(var q in c.qa){for(e=f=0;e<a.length;e++)f+=a[e].qa[q].length;d.qa[q]=new Float32Array(f)}for(q in c.aa[0]){for(e=f=0;e<a.length;e++)f+=a[e].aa[0][q].length;for(e=
0;e<c.aa.length;e++)d.aa[e]=d.aa[e]||{},d.aa[e][q]=new Float32Array(f)}e=d.Pf;e.R=Z.Cl(b.Pf.R);g=f=0;k=[];for(c=0;c<a.length;c++){var h=a[c],p=h.na,m=h.Ja,l=h.qa;q=h.Pf.wa;Z.OA(e.R,h.Pf.R);Z.WT(e.wa,q);Z.SA(h.Pf.zd,k);for(q=0;q<p.length;q++)d.na[f+q]=p[q]+g;var f=f+p.length,n;for(n in l){var p=l[n],t=g*Q(p,m);d.qa[n].set(p,t)}for(q=0;q<h.aa.length;q++){var l=h.aa[q],u=d.aa[q];for(n in l)p=l[n],t=g*Q(p,m),u[n].set(p,t)}g+=m}e.ba=Z.tu(aa.Ef(k),!0);if(0<d.jb.length)for(c=0;c<d.jb.length;c++)for(n=d.jb[c].Gf,
q=f=e=0;q<a.length;q++)g=a[q].jb[c].Gf,n.a_position.set(g.a_position,e),n.a_tbn_quat.set(g.a_tbn_quat,f),e+=g.a_position.length,f+=g.a_tbn_quat.length;a[0].Jf&&(d.Jf={ep:b.Jf.ep,mx:b.Jf.mx,sM:!0,Ns:b.Jf.Ns,Jm:b.Jf.Jm,Ku:b.Jf.Ku});return d}function C(a,b,c){b=b.Pf;for(var d=Z.Qd(),f=Z.uu(),e=[],g=0;g<c.length;g++)Z.Al(a.Pf.R,c[g],d),Z.OA(b.R,d),Z.Ez(a.Pf.zd,c[g],f),Z.SA(f,e);b.ba=Z.tu(aa.Ef(e),!0);b.zd=Z.nS(b.ba);b.wa=Z.Kq(b.ba)}function O(a,b,c,f,e,g){var k=a.submeshes[b],q=k.base_length,h=x("SUBMESH_"+
a.name+"_"+a.materials[b].name);h.Ja=q;var p=!1;if(K(c,"a_texcoord")){var m=null,l=a.materials[b];b=a.submeshes[b];if(l.texture_slots.length)switch(l=l.texture_slots[0],l.texture_coords){case "UV":l=a.uv_textures.indexOf(l.uv_layer);0==l?m=new Float32Array(b.texcoord):1==l&&(m=new Float32Array(b.texcoord2));break;case "ORCO":for(var n=a.b4w_boundings.bb_src,m=new Float32Array(2*b.base_length),l=(n.max_x+n.min_x)/2,t=(n.max_y+n.min_y)/2,u=n.max_x-n.min_x,n=n.max_y-n.min_y,M=0,E=0;E<b.position.length;E+=
3)m[M++]=(b.position[E]-l)/u+.5,m[M++]=(b.position[E+1]-t)/n+.5}null===m&&(m=new Float32Array(2*b.base_length));b=m}else b=new Float32Array(0);if(K(c,"a_orco_tex_coord")){m=a.b4w_boundings.bb_src;l=new Float32Array(3*k.base_length);t=m.max_x-m.min_x;u=m.max_y-m.min_y;n=m.max_z-m.min_z;for(E=M=0;E<k.position.length;E+=3)0==t?l[M++]=.5:l[M++]=aa.U(parseFloat(((k.position[E]-m.min_x)/t).toFixed(5)),0,1),0==u?l[M++]=.5:l[M++]=aa.U(parseFloat(((k.position[E+1]-m.min_y)/u).toFixed(5)),0,1),0==n?l[M++]=
.5:l[M++]=aa.U(parseFloat(((k.position[E+2]-m.min_z)/n).toFixed(5)),0,1);m=l}else m=new Float32Array(0);l=k.group;if(K(c,"a_influence")&&f){t=new Float32Array(4*q);u=l.length/q;n=new Float32Array(u);for(M=0;M<u;M++){n[M]=-1;for(var v in f)if(E=f[v],E.BN===M){n[M]=E.CA;break}}var w=3<u?u:4;f=new Float32Array(w);v=new Uint32Array(w);for(var M=new Float32Array(4),E=new Float32Array(w),w=new Uint32Array(w),T=new Float32Array(4),z=0;z<q;z++)f.set(E),v.set(w),M.set(T),t.set(D(l,u,z,q,n,f,v,M),4*z)}else t=
new Float32Array(0);f=t;e=e?aa.S(e):{};e.a_color={bm:!0};e.a_color.src=K(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,jg:7}]:[];h.qa.a_texcoord=b;h.qa.a_influence=f;h.qa.a_orco_tex_coord=m;f=h.qa;v=k.vertex_colors;b=k.color;m=a.name;l=[];for(t=0;t<v.length;t++)l.push(v[t].name);for(var C in e)if(t=e[C].src,t.length){for(n=u=0;n<t.length;n++)u+=aa.Nm(t[n].jg);f[C]=new Float32Array(u*q);for(n=M=0;n<t.length;n++){var S=t[n].name,E=t[n].jg,w=aa.hL(E),H=l.indexOf(S);-1==H&&aa.q('vertex color "'+
S+'" for mesh "'+m+'" not found.');T=v[H].mask;z=aa.Nm(T);(E&T)!==E&&ga.error("Wrong color extraction from "+S+" to "+C+".");for(var F=S=0;F<H;F++)S+=aa.Nm(v[F].mask);H=S*q;for(S=0;S<q;S++)for(F=0;3>F;F++)w[F]&&(f[C][S*u+(M+aa.Co(E,F))]=b[H+S*z+aa.Co(T,F)]);M+=z}}else f[C]=new Float32Array(0);C=a.uv_textures;e=k.texcoord;f=k.texcoord2;v=h.qa;if(g)for(var P in g){b=C.indexOf(P);if(0==b)var ca=new Float32Array(e);else 1==b&&(ca=new Float32Array(f));v[g[P]]=ca}h.na=new Uint32Array(k.indices);P=k.position.length/
q/3;ca=K(c,"a_tbn_quat")&&k.tbn_quat.length?!0:!1;C=K(c,"a_shade_tangs")&&k.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(p=!0);for(e=0;e<P;e++){g=J(k,q,ca,C,e);if(p)if(f={},f.name=a.b4w_shape_keys[e].name,h.jb.push(f),0!=e){f.Gf=g;f.Cr=a.b4w_shape_keys[e].value;continue}else f.Gf=J(k,q,ca,C,e),f.Cr=1;h.aa.push(g)}if(1<P&&!p){a=h.aa[0];g={};for(var G in a)g[G]=new Float32Array(a[G]);h.aa.push(g)}K(c,"a_polyindex")&&(r(h,1,!0),h.qa.a_polyindex=d(h));k=k.boundings;c=h.Pf;c.R=Z.Qd();c.R.max_x=
k.bb.max_x;c.R.max_y=k.bb.max_y;c.R.max_z=k.bb.max_z;c.R.min_x=k.bb.min_x;c.R.min_y=k.bb.min_y;c.R.min_z=k.bb.min_z;G=k.rbb;a=k.caxis_x;q=k.caxis_y;p=k.caxis_z;g=k.be_ax;c.ba=Z.hq(a,q,p,k.be_cen);ia.scale(c.ba.Ga,g[0],c.ba.Ga);ia.scale(c.ba.Ha,g[1],c.ba.Ha);ia.scale(c.ba.Ia,g[2],c.ba.Ia);c.wa=Z.Kq(c.ba);ia.copy(G.rbb_c,c.zd.F);ia.copy(a,c.zd.Ga);ia.copy(q,c.zd.Ha);ia.copy(p,c.zd.Ia);k=G.rbb_s;ia.scale(c.zd.Ga,k[0],c.zd.Ga);ia.scale(c.zd.Ha,k[1],c.zd.Ha);ia.scale(c.zd.Ia,k[2],c.zd.Ia);return h}function J(a,
b,c,d,f){var e={},g=new Float32Array(3*b),k=new Float32Array(c?4*b:0),q=f*b*3;g.set(a.position.subarray(q,q+3*b),0);c&&(q=f*b*4,k.set(a.tbn_quat.subarray(q,q+4*b),0));d&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),e.a_shade_tangs=c);e.a_position=g;e.a_tbn_quat=k;return e}function K(a,b){return-1<a.indexOf(b)?!0:!1}function D(b,c,d,f,e,g,k,q){for(var h=!0,p=0;p<c;p++){var m=b[p*f+d];if(-1!==m){var l=e[p];-1!==l&&(g[p]=m,k[p]=l,h=!1)}}if(h)return q;L(g,k,a.fz,!1);for(p=b=0;4>p;p++)b+=
g[p];if(.01>b)return q;for(p=0;4>p;p++)g[p]/=b;if(.01>Math.abs(g[0]-1))q[0]=k[0]+1;else for(p=0;4>p;p++)q[p]=k[p]+g[p];return q}function Q(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&aa.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function L(b,c,d,f){for(var e=b.length,g=e,k=!1,q=f?-1:1;1<g||k;){1<g&&(g=Math.floor(g/1.247330950103979));for(var k=!1,h=0;g+h<e;h++)if(d==a.fz?0>q*(b[h]-b[h+g]):b[h]<b[h+g]&&f)k=b[h],b[h]=b[h+g],b[h+
g]=k,k=c[h],c[h]=c[h+g],c[h+g]=k,k=!0}}function H(a,b,c){var d=[],f=[];ia.subtract(b,a,d);ia.subtract(c,a,f);ia.normalize(d,d);ia.normalize(f,f);a=aa.U(ia.dot(d,f),-1,1);return Math.acos(a)}function z(a,b,c){if(y(b)){b=b.na;for(var d=b.length/3,f=0;f<d;f++){var e=new Float32Array(9),g=b[3*f];e[0]=a[3*g];e[1]=a[3*g+1];e[2]=a[3*g+2];g=b[3*f+1];e[3]=a[3*g];e[4]=a[3*g+1];e[5]=a[3*g+2];g=b[3*f+2];e[6]=a[3*g];e[7]=a[3*g+1];e[8]=a[3*g+2];c[f]=e}}else for(f=0;f<a.length;f++)e=new Float32Array(9),e[0]=a[9*
f],e[1]=a[9*f+1],e[2]=a[9*f+2],e[3]=a[9*f+3],e[4]=a[9*f+4],e[5]=a[9*f+5],e[6]=a[9*f+6],e[7]=a[9*f+7],e[8]=a[9*f+8],c[f]=e;return c}function d(a){for(var b=new Float32Array(a.Ja),c=0;c<a.Ja;c++)b[c]=c%3/2;return b}function p(a,b,c){var d=ia.dist(a,b);a=ia.dist(a,c);b=ia.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function M(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function x(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)};return{name:a,Ja:0,na:null,aa:[],qa:b,jb:[],Pf:{R:Z.Qd(),ba:Z.Lg(),wa:Z.Kh(),zd:Z.uu()},Jf:null}}function g(a){var b=[],c;for(c in a)b.push(P(c,a[c]));return b}function P(a,b){return{pi:new (F(a))(b),type:a}}function t(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function da(a,b){var c=t(a,b);return-1==c?null:a[c].Yk}function G(a,b){var c=t(a,b);return-1==c?null:a[c].pi}function F(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;
case "unsigned_byte":return Uint8Array;default:return Float32Array}}function U(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function R(a,
b,c,d){var f=U(b);b=t(a,f);switch(f){case "float":a[b].pi.set(c,d);break;case "short":for(f=0;f<c.length;f++)a[b].pi[d+f]=aa.er(c[f]);break;case "unsigned_byte":for(f=0;f<c.length;f++)a[b].pi[d+f]=aa.RZ(c[f])}}var Z=l("__boundings"),u=l("__extensions"),ga=l("__print"),ca=l("__quat"),E=l("__tsr"),aa=l("__util"),ia=l("__vec3");new Float32Array(2);var q=new Float32Array(3),T=new Float32Array(3),ba=new Float32Array(3),S=new Float32Array(4),sa=new Float32Array(4),oa=new Float32Array(8);a.wp=10;a.nt=20;
a.fz=0;a.N1=1;a.on=a.wp;var Y=null;a.UP="float";a.Q1="short";a.S1="unsigned_byte";a.Nf=function(a){Y=a};a.AM=function(a,c,d){b(a)&&r(a);var q=a.na,p=a.Ja,l=a.aa,t={},u;for(u in a.qa)u in d&&!d[u].bm||(t[u]=a.qa[u]);d=h();0<a.jb.length&&e(a,l[0]);u=a.Jf;if(q.length){var M=q.length;if(65536>=p)var q=new Uint16Array(q),B=Y.UNSIGNED_SHORT;else q=new Uint32Array(q),B=Y.UNSIGNED_INT}else M=p,q=null;for(var x=k(l,t,u),x=g(x),v={},w=0;w<x.length;w++)v[x[w].type]=0;var T={},z;for(z in t){var C=t[z],S=C.length;
if(S){var H=U(z),w=T[z]=n();w.length=S;w.Jc=Q(C,p);w.offset=v[H];R(x,z,C,v[H]);v[H]+=S}}t=l.length;for(z in l[0])if(C=l[0][z],H=U(z),S=C.length,C=Q(C,p),S)for(w=T[z]=n(),w.length=S,w.frames=t,w.Jc=C,w.offset=v[H],1<t&&(w=T[z+"_next"]=n(),w.length=S,w.frames=t,w.Jc=C,w.offset=v[H]+S),w=0;w<t;w++)C=l[w][z],H=U(z),R(x,z,C,v[H]),v[H]+=S;if(u){l=u.ep;z=u.mx;t=u.Jm;S=u.Ns;l=u.ep;z=u.mx;var t=u.Jm,S=u.Ns,H=u.sM,p={a_part_ts:{data:[],Jc:4},a_part_r:{data:[],Jc:4}},F;for(F in t)p[F]={data:[],Jc:t[F].Jc};for(F in S)p[F]=
{data:[],Jc:1};for(C=0;C<l.length;C++){w=l[C];H&&z&&!u.Ku&&(w=E.multiply(z,l[C],oa));!H&&u.Ku&&ia.subtract(l[C],z,l[C]);p.a_part_ts.data.push(w[0],w[1],w[2],w[3]);p.a_part_r.data.push(w[4],w[5],w[6],w[7]);for(F in t)for(var w=t[F].Jc,P=0;P<w;P++)p[F].data.push(t[F].data[C*w+P]);for(F in S)p[F].data.push(S[F][0])}for(F in p)l=U(F),R(x,F,p[F].data,v[l]),z=n(),z.Jc=p[F].Jc,z.offset=v[l],z.Zq=1,z.length=p[F].data.length,T[F]=z,v[l]+=z.length;d.om=u.ep.length}d.count=M;d.le=q;d.tc=x;d.km=B;d.kd=T;m(d,
c);f(d);d.jb=a.jb;return d};a.vZ=e;a.ZV=b;a.YV=y;a.px=r;a.f_=function(a,b,c){m(a,b);a.count=c.length;a.le=c;a.km=c instanceof Uint16Array?Y.UNSIGNED_SHORT:Y.UNSIGNED_INT};a.e_=function(a,b){var c=a.kd,d=c.a_p_data,e=U("a_p_data");if(d)3!=d.Jc&&aa.q('invalid num_comp for "a_p_data"'),R(a.tc,"a_p_data",b,d.offset);else{d=t(a.tc,e);-1==d&&(a.tc.push(P(e,0)),d=a.tc.length-1);var e=a.tc[d].pi,g=new e.constructor(e.length+b.length);g.set(e);a.tc[d].pi=g;R(a.tc,"a_p_data",b,e.length);c=c.a_p_data=n();c.Jc=
3;c.offset=e.length;c.length=b.length}f(a)};a.X3=w;a.d7=function(a){a.$m=Y.STATIC_DRAW};a.KW=function(a){a.$m=Y.DYNAMIC_DRAW};a.eN=f;a.ZR=function(a){a.hg&&Y.deleteBuffer(a.hg);for(var b=0;b<a.Md.length;b++)a.Md[b].Yk&&Y.deleteBuffer(a.Md[b].Yk);a.Md.length=0};a.oJ=function(a,b){return a.submeshes[b].base_length?!1:!0};a.ox=function(a,b){for(var c=0;c<a.aa.length;c++){var d=a.aa[c].a_position;E.dp(d,b,d,0);d=a.aa[c].a_tbn_quat;0<d.length&&E.XM(d,b,d,0);(d=a.aa[c].a_shade_tangs)&&0<d.length&&E.MZ(d,
b,d)}(c=a.qa.au_center_pos)&&c.length&&E.dp(c,b,c,0);v(a.Pf,b)};a.uZ=function(a,b){var c=a.qa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);E.dp(d,b,d,0);for(var f=0;f<a.aa.length;f++)for(var e=0;e<d.length;e++)a.aa[f].a_position[e]+=d[e]-c[e];c.set(d)}else aa.q('Attribute "au_center_pos" is missing in particle submesh');v(a.Pf,b)};a.gR=v;a.tZ=function(a,b){var c=a.Ja,d;for(d in b){var f=b[d].length;a.qa[d]=new Float32Array(f*c);for(var e=0;e<c;e++)for(var g=0;g<f;g++)a.qa[d][e*f+g]=b[d][g]}};
a.zM=c;a.JW=function(a,b,c){if(!a.Ja)return x("EMPTY");var d=c.length;65536<a.Ja*d&&!u.uI()&&r(a,d);var f=a.na,e=a.Ja,g=a.qa,k=a.aa,q;for(q in b){var h=b[q].length,p=h*e;g[q]=new Float32Array(p);for(var m=0;m<e;m++)for(p=0;p<h;p++)g[q][m*h+p]=b[q][p]}b=x("CLONE_"+d+"_SUBMESHES");b.Ja=e*d;b.na=new Uint32Array(f.length*d);for(m=0;m<d;m++)for(h=f.length*m,q=e*m,p=0;p<f.length;p++)b.na[h+p]=f[p]+q;for(var l in g)for(f=g[l],p=f.length*d,h=Q(f,e),b.qa[l]=new Float32Array(p),m=0;m<d;m++)q=e*h*m,b.qa[l].set(f,
q);for(l in k[0])for(m=0;m<k.length;m++)for(f=k[m][l],p=f.length*d,h=Q(f,e),b.aa[m]=b.aa[m]||{},b.aa[m][l]=new Float32Array(p),p=0;p<d;p++)switch(g=c[p],q=e*h*p,l){case "a_position":E.dp(f,g,b.aa[m][l],q);break;case "a_tbn_quat":E.XM(f,g,b.aa[m][l],q);break;case "a_shade_tangs":E.PZ(f,g,b.aa[m][l],q);break;default:aa.q("Wrong attribute name: "+l)}C(a,b,c);return b};a.qG=C;a.TA=O;a.aU=function(a){var b=a.Ja,c=a.aa[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.na.length);for(var f=new Float32Array(4*
b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var g=Math.random();f[4*e]=g;f[4*e+1]=g;f[4*e+2]=g;f[4*e+3]=g}c=x("HALO");c.aa[0]={};c.Ja=4*b;c.aa[0].a_position=d;c.qa.a_halo_bb_vertex=M(b);c.qa.a_random_vals=f;c.na=a;return c};a.yV=
K;a.OH=function(a,b,d){for(var f=[],e=0;e<a.submeshes.length;e++){var g=O(a,e,b,null,d,null);g.Ja&&f.push(g)}return 0==f.length?x("EMPTY"):1==f.length?f[0]:c(f)};a.d_=function(a,b,c,d){var f=a.le,e=w(a,"a_position"),g=b.TW,k=b.UW;b=b.FT;for(var q=f,h=q.length/3,p=0;p<h;p++){var m=q[3*p],l=q[3*p+1],n=q[3*p+2],t=e[3*m+1],u=e[3*m+2],r=e[3*l+1],M=e[3*l+2],x=e[3*n+1],v=e[3*n+2];g[3*p]=(e[3*m]+e[3*l]+e[3*n])/3;g[3*p+1]=(t+r+x)/3;g[3*p+2]=(u+M+v)/3}E.dp(g,c,k);c=k.length/3;for(e=0;e<c;e++)g=k[3*e]-d[0],
q=k[3*e+1]-d[1],h=k[3*e+2]-d[2],b[e]=g*g+q*q+h*h;d=f;f=b.length;if(!(2>f))for(k=f,e=!1;1<k||e;)for(1<k&&(k=Math.floor(k/1.247330950103979)),e=!1,c=0;k+c<f;c++)0>b[c]-b[c+k]&&(e=b[c],b[c]=b[c+k],b[c+k]=e,e=d,g=c,q=c+k,h=e[3*g],p=e[3*g+1],m=e[3*g+2],e[3*g]=e[3*q],e[3*g+1]=e[3*q+1],e[3*g+2]=e[3*q+2],e[3*q]=h,e[3*q+1]=p,e[3*q+2]=m,e=!0);f=d;Y.bindBuffer(Y.ELEMENT_ARRAY_BUFFER,a.hg);Y.bufferData(Y.ELEMENT_ARRAY_BUFFER,f,Y.DYNAMIC_DRAW)};a.fZ=L;a.rR=function(a,b,c){for(var d=b.length/3,f=a.length/3,e=[],
g=Array(3),k=Array(3),q=Array(3),h=0;h<f;h++){for(var p=a[3*h],m=a[3*h+1],l=a[3*h+2],n=0;3>n;n++)g[n]=b[3*p+n],k[n]=b[3*m+n],q[n]=b[3*l+n];if(c)var n=H(g,k,q),t=H(k,q,g),u=Math.PI-n-t;else u=t=n=1;var r=e,M;M=g;var E=q,x=[],w=[],v=[];ia.subtract(k,M,x);ia.subtract(E,M,w);ia.cross(x,w,v);ia.normalize(v,v);M=v;for(E=0;3>E;E++)x=3*m+E,w=3*l+E,r[3*p+E]=n*M[E],r[x]=t*M[E],r[w]=u*M[E]}if(c)for(var T in c)for(h=c[T],a=0;3>a;a++){b=3*h[0]+a;for(f=1;f<h.length;f++)g=3*h[f]+a,e[b]+=e[g];for(f=1;f<h.length;f++)g=
3*h[f]+a,e[g]=e[b]}for(h=0;h<d;h++){c=h;T=e;a=new Float32Array(3);for(b=0;3>b;b++)f=3*c+b,a[b]=T[f];ia.normalize(a,a);for(b=0;3>b;b++)f=3*c+b,T[f]=a[b]}return e};a.uR=function(a,b,c){for(var d={},f=b.length/3,e=0;e<f;e++){var g=String(b[3*e])+String(b[3*e+1])+String(b[3*e+2]);d[g]=[]}f=a.length;for(e=0;e<f;e++)b=a[e],g=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),g in d&&d[g].push(b);return d};a.ZA=function(a,b,c,d){var f;f=null;f=[];f=z(a.aa[0].a_position,a,f);if(c){var e;e=null;e=[];for(var g=
a.aa[0].a_tbn_quat,k=g.length/4,h=new Float32Array(3*k),m=0;m<k;m++){var l=S;l[0]=g[4*m];l[1]=g[4*m+1];l[2]=g[4*m+2];l[3]=g[4*m+3];l=ia.transformQuat(aa.xh,l,q);h[3*m]=l[0];h[3*m+1]=l[1];h[3*m+2]=l[2]}e=z(h,a,e)}k=f.length;h=new Float32Array(k);for(a=0;a<k;a++)m=f[a],q.set(m.subarray(0,3)),T.set(m.subarray(3,6)),ba.set(m.subarray(6)),h[a]=Math.sqrt(p(q,T,ba));g=new Float32Array(k);g[0]=h[0];for(a=1;a<k;a++)g[a]=g[a-1]+h[a];k=g[h.length-1];h=[];for(a=0;a<b;a++){var m=k*aa.tg(d),m=aa.bu(g,m,0,g.length-
1),n=m=c?e[m]:f[m],t=d;(m=q)||(m=new Float32Array(3));var l=n[0],u=n[1],r=n[2],M=n[3],E=n[4],x=n[5],w=n[6],v=n[7],C=n[8],n=aa.tg(t),t=aa.tg(t);1<n+t&&(n=1-n,t=1-t);var H=1-n-t,u=H*u+n*E+t*v,r=H*r+n*x+t*C;m[0]=H*l+n*M+t*w;m[1]=u;m[2]=r;c?(h[a]=new Float32Array(4),ia.normalize(m,m),m=ca.rotationTo(aa.xh,m,S),h[a][0]=m[0],h[a][1]=m[1],h[a][2]=m[2],h[a][3]=m[3]):(h[a]=new Float32Array(3),h[a][0]=m[0],h[a][1]=m[1],h[a][2]=m[2])}return h};a.Pu=d;a.F9=p;a.ZH=M;a.mL=function(a,b,c){a=a.aa[0].a_position;for(var d=
0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.JQ=function(a,b,c){var d=a.I[0].W;a=a.k.ii;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=c);for(f=0;f<d.length;f++)if(!d[f].eg&&d[f].Le&&!d[f].Li){b=d[f].Ca;var e=U("a_position");c=da(b.Md,e);e=G(b.tc,e);Y.bindBuffer(Y.ARRAY_BUFFER,c);var g=b.kd.a_position;c=d[f];var k=a;if(g){for(var q=g.offset,g=g.length+q,h=c.Ca.jb[0].Gf.a_position,p=q;p<g;p++)e[p]=h[p-q];for(p=1;p<c.Ca.jb.length;p++){var h=
c.Ca.jb[p].Gf.a_position,m=k[p].value;if(m)for(var l=q;l<g;l++)e[l]+=m*h[l-q]}Y.bufferSubData(Y.ARRAY_BUFFER,aa.Aj*q,e.subarray(q))}e=U("a_tbn_quat");c=da(b.Md,e);e=G(b.tc,e);Y.bindBuffer(Y.ARRAY_BUFFER,c);q=b.kd.a_tbn_quat;b=d[f];c=e;e=a;if(q){k=q.offset;q=q.length+k;g=b.Ca.jb[0].Gf.a_tbn_quat;p=S;for(h=k;h<q;h+=4){p[0]=0;p[1]=0;p[2]=0;for(m=p[3]=1;m<b.Ca.jb.length;m++){var l=b.Ca.jb[m].Gf.a_tbn_quat,n=e[m].value;if(n){var t=sa;t[0]=l[h-k];t[1]=l[h+1-k];t[2]=l[h+2-k];t[3]=l[h+3-k];l=ca.slerp(aa.sn,
t,n,sa);ca.multiply(l,p,p)}}m=sa;m[0]=g[h-k];m[1]=g[h-k+1];m[2]=g[h-k+2];m[3]=g[h-k+3];l=0<m[3];ca.multiply(p,m,m);(0<m[3]&&!l||0>m[3]&&l)&&ca.scale(m,-1,m);c[h]=aa.er(m[0]);c[h+1]=aa.er(m[1]);c[h+2]=aa.er(m[2]);c[h+3]=aa.er(m[3])}Y.bufferSubData(Y.ARRAY_BUFFER,aa.Aj*k,c.subarray(k))}}};a.SR=function(a){return a.k.Le};a.G5=function(a){var b=[];if(a.k)for(var c=1;c<a.k.ii.length;c++)b.push(a.k.ii[c].name);return b};a.F5=function(a,b){if(a.k)for(var c=1;c<a.k.ii.length;c++)if(b==a.k.ii[c].name)return a.k.ii[c].value;
return 0};a.BV=function(a,b){var c=a.k.ii;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.h6=function(a){return a&&a.k&&a.k.ag?!0:!1};a.H3=function(b,c,d){var e=b.Ca;if(e){for(var k=d?c.length/3/2:c.length/3-1,q=new Float32Array(12*k),h=new Float32Array(12*k),p=new Uint16Array(6*k),m=0;m<k;m++){if(d)var l=6*m,n=6*m+3;else l=3*m,n=3*(m+1);var t=c[l],u=c[l+1],l=c[l+2],r=c[n],M=c[n+1],n=c[n+2],E=r-t,x=M-u,w=n-l;q[12*m]=t;q[12*m+1]=u;q[12*m+2]=l;h[12*m]=E;h[12*m+1]=x;h[12*m+2]=w;
q[12*m+3]=r;q[12*m+4]=M;q[12*m+5]=n;h[12*m+3]=-E;h[12*m+4]=-x;h[12*m+5]=-w;q[12*m+6]=t;q[12*m+7]=u;q[12*m+8]=l;h[12*m+6]=-E;h[12*m+7]=-x;h[12*m+8]=-w;q[12*m+9]=r;q[12*m+10]=M;q[12*m+11]=n;h[12*m+9]=E;h[12*m+10]=x;h[12*m+11]=w;p[6*m]=4*m;p[6*m+1]=4*m+1;p[6*m+2]=4*m+2;p[6*m+3]=4*m;p[6*m+4]=4*m+3;p[6*m+5]=4*m+1}d=0;for(var v in e.kd)c=e.kd[v],d+=q.length/3*c.Jc;c={};c["float"]=d;d=e.tc=g(c);a.f_(e,b.Mh,p);b=0;for(v in e.kd)switch(c=e.kd[v],v){case "a_position":R(d,v,q,b);c.offset=b;c.length=q.length;
b+=c.length;break;case "a_direction":R(d,v,h,b);c.offset=b;c.length=h.length;b+=c.length;break;default:c.offset=b,c.length=q.length/3*c.Jc,p=new Float32Array(c.length),R(d,v,p,b),b+=c.length}f(e)}};a.eS=function(a){var b=h();if(a.le)switch(a.km){case Y.UNSIGNED_SHORT:b.le=new Uint16Array(a.le);break;case Y.UNSIGNED_INT:b.le=new Uint32Array(a.le)}else b.le=null;for(var c=a.tc,d=[],f=0;f<c.length;f++){var e=c[f].pi,g=c[f].type;d.push({pi:new e.constructor(e),type:g})}b.tc=d;b.km=a.km;b.count=a.count;
b.kd=aa.S(a.kd);b.$m=a.$m;b.Hn=a.Hn;b.Jn=a.Jn;b.hg=null;b.Dv=aa.S(a.Dv);b.jb=aa.S(a.jb);b.om=a.om;b.Yf=a.Yf;return b};a.If=x;a.reset=function(){Y=null};a.D6=g;a.cY=t;a.Q5=da;a.hv=G;a.D4=F;a.xr=U;a.bJ=function(a){switch(U(a)){case "float":return aa.Aj;case "short":return aa.Op;case "unsigned_byte":return aa.Yx;default:return aa.Aj}};a.gV=function(a){switch(U(a)){case "float":return Y.FLOAT;case "short":return Y.SHORT;case "unsigned_byte":return Y.UNSIGNED_BYTE;default:return Y.FLOAT}};a.vN=R};b4w.module.__prerender=function(a,l){function n(a,f){var e=a.ff;e.ho=!1;if(e.Uh)return!1;var l=f.p,n=f.type==h.cd?l.Uv:w.hc(l.n,v);if("STATIC"==e.type&&e.co)var y=e.Rr,A=e.Sr;else y=e.lb.F,A=e.lb.Ya;var L=e.bh,H=e.ef,n=k.dist(y,n);if(!(n<L?0:H==r.Ip||n<H+e.dh*A))return!1;e.ho=!0;H=a.za;if(f.type==h.wf)return f.debug_view_mode==b.ot?H.Li:!H.Li;if(f.type==h.Cg&&0==e.ih)return!1;e.ip?(A=H.lb,L=H.qb,e=H.Sf):(A=e.lb,L=e.qb,e=e.Sf);if(H=!H.Tj)l=l.Ph,H=A.F,m.jZ(H,l,A.Ya)?H=!0:e?(H=L.F,H=m.NT(H,l,L.Ga,L.Ha,
L.Ia)):H=!1;return H?!1:!0}function e(a){var b=a.hb;if(b&&b.mK){a=a.Ca;y.KW(a);var f=a.kd,e=f.a_position.offset;y.vN(a.tc,"a_position",b.FC,e);e=f.a_tbn_quat.offset;y.vN(a.tc,"a_tbn_quat",b.PD,e);y.eN(a)}}l("__config");var b=l("__debug"),y=l("__geometry"),r=l("__obj_util"),A=l("__renderer"),h=l("__subscene"),w=l("__tsr"),m=l("__util"),k=l("__vec3"),f=[h.Pb,h.Pc,h.Nd,h.md,h.xf,h.Oe,h.ge,h.Uf,h.cd,h.yf,h.Cg,h.wf,h.tf,h.ui],v=new Float32Array(3);a.Aw=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,
k=a.type==h.md||a.type==h.Oe,m=a.Ra,l=0;l<m.length;l++){for(var r=m[l],w=r.sa,v=!1,H=0;H<w.length;H++){var z=w[H],d=z.za;if(k)for(var p=0;6>p;p++)a.p.Ph=a.Qq[p],z.KA[p]=n(z,a),z.KA[p]&&(v=b=!0,e(d));else z.cc=n(z,a),z.cc&&(v=b=!0,e(d));a.Ba&&(d.zb.Wr=!0)}r.cc=v}a.Ba=!1;switch(a.type){case h.wf:break;default:a.type==h.Pb||a.type==h.yf||a.type==h.ge||a.type==h.Nd||a.type==h.md||b?a.cc=!0:(a.cc&&A.clear(a),a.cc=!1)}}else if(a.Ba){m=a.Ra;for(l=0;l<m.length;l++)for(w=m[l].sa,H=0;H<w.length;H++)z=w[H],
d=z.za,d.zb.Wr=!0;a.Ba=!1}a.jC&&h.dZ(a)}};b4w.module.__primitives=function(a,l){function n(a,b,f,e){for(var c=[],l=[],n=[],r=[],w=2*f/(a-1),y=2*e/(b-1),Q=0;Q<a;Q++)for(var L=-f+Q*w,H=0;H<b;H++)if(l.push(L,-e+H*y,0),r.push(0,0,0,1),n.push(Q/(a-1),H/(b-1)),Q&&H){var z=Q*b+H,d=z-1,p=(Q-1)*b+H,M=p-1;c.push(z,d,p);c.push(d,M,p)}a=h.Mg();a.a_position=new Float32Array(l);a.a_tbn_quat=new Float32Array(r);r=A.If("GRID_PLANE");r.aa[0]=a;r.qa.a_texcoord=new Float32Array(n);r.na=new Uint32Array(c);r.Ja=l.length/3;return r}function e(a){var b=a.length;
b%4&&h.q("Wrong array");for(var f=[],e=[],c=0;c<b;c+=4){var l=a[c+1],n=a[c+2],r=a[c+3];y(a[c],e);y(l,e);y(n,e);y(r,e);f.push(c,c+1,c+2);f.push(c,c+2,c+3)}a=h.Mg();a.a_position=new Float32Array(e);b=A.If("FROM_QUADS");b.aa[0]=a;b.na=new Uint32Array(f);b.Ja=e.length/3;return b}function b(a,b){var f=3*b;return[a[f],a[f+1],a[f+2]]}function y(a,b){b.push(a[0],a[1],a[2])}var r=l("__config"),A=l("__geometry");l("__print");var h=l("__util"),w=r.B;a.IU=function(){var a=A.If("LINE"),b=h.Mg();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.na=new Uint32Array(1);a.Ja=1;return a};a.q4=function(a,b){var f=n(2,2,a,b);f.name="PLANE";return f};a.p4=n;a.BU=function(a,b,f){function e(a,b){return 1==a%2&&(0==b||b==r-1)||1==b%2&&(0==a||a==n-1)?!0:!1}var c=f/=Math.pow(2,a-1),l=f,n=b+1,r=b+1;b=[];f=[];for(var y=[],D=0,Q=0,L=-1,H=[],z=0;z<a;z++){for(var d=2*c/(n-1),p=2*l/(r-1),M=[],x=[],g=0,P=0;P<n;P++){for(var t=-c+P*d,da=[],G=0;G<r;G++){var F=-l+G*p;if(t>-D&&t<D&&F>-Q&&F<Q)da.push(-1),g++;else{for(var U=
null,R=0;R<H.length;R+=3)if(t==H[R]&&F==H[R+1]){U=H[R+2];break}R=null!==U?U:L+1;e(P,G)?(da.push(-2),g++):(null==U&&(0==G||G==r-1||0==P||P==n-1?(U=z==a-1?d:2*d,M.push(t,F,R)):U=d,f.push(t,F,U),y.push(.707,0,0,.707),L++),da.push(R));if(P&&G)if(1==P)if(e(P-1,G)){if(1<G){var F=R-1,U=x[P-1][G+1],Z=U-1;b.push(Z,F,R)}else U=x[P-1][G+1],Z=U-1;b.push(U,Z,R)}else e(P,G)||(F=R-1,U=x[P-1][G],b.push(U,F,R));else if(P==n-1){if(!e(P,G))if(G==r-1)F=R-1,U=x[P-1][G-1],Z=x[P-2][G],b.push(U,F,R),b.push(Z,U,R);else{var F=
R-1,U=x[P-1][G],Z=U-1,u=U+1;b.push(Z,F,R);b.push(U,Z,R);b.push(u,U,R);2==G&&(u=x[P-2][G-2],b.push(Z,u,F))}}else 1==G?e(P,G-1)?(F=x[P-1][G],U=x[P-1][G-1],b.push(F,U,R)):(F=da[G-1],U=x[P-1][G],Z=x[P-2][G-1],b.push(U,F,R),b.push(U,Z,F)):G==r-1?e(P,G)||(F=da[G-1],U=x[P-1][G-1],Z=x[P-2][G],b.push(U,F,R),b.push(Z,U,R)):-1!=x[P-1][G]&&-1!=x[P-1][G-1]&&-1!=da[G-1]?(F=da[G-1],U=x[P-1][G],Z=x[P-1][G-1],b.push(U,F,R),b.push(U,Z,F),G==r-2&&e(P,G+1)&&(u=x[P-1][G+1],b.push(u,U,R))):G==r-2&&e(P,G+1)&&(U=x[P-1][G],
u=x[P-1][G+1],b.push(u,U,R))}}x.push(da)}H=M;D=c;Q=l;c*=2;l*=2}if(2E4>D)for(a=-(2*D)/(n-1),f.push(-2E4,-2E4,a),f.push(-2E4,2E4,a),f.push(-D,-Q,a),f.push(-D,Q,a),f.push(2E4,-2E4,a),f.push(2E4,2E4,a),f.push(D,-Q,a),f.push(D,Q,a),R=L+1,b.push(R+1,R+2,R+3,R+1,R+0,R+2,R+2,R+4,R+6,R+2,R+0,R+4,R+1,R+7,R+5,R+1,R+3,R+7,R+7,R+4,R+5,R+6,R+4,R+7),P=0;8>P;P++)y.push(.707,0,0,.707);a=h.Mg();a.a_position=new Float32Array(f);a.a_tbn_quat=new Float32Array(y);c=A.If("MULTIGRID_PLANE");c.aa[0]=a;c.na=new Uint32Array(b);
c.Ja=f.length/3;w.HN&&(A.px(c,1,!0),a.a_polyindex=A.Pu(c));return c};a.o4=function(a){var b=a.length;b%3&&h.q("Wrong array");for(var f=[],e=[],c=0;c<b;c+=3){var l=a[c+1],n=a[c+2];y(a[c],e);y(l,e);y(n,e);f.push(c,c+1,c+2)}a=h.Mg();a.a_position=new Float32Array(e);b=A.If("FROM_TRIANGLES");b.aa[0]=a;b.na=new Uint32Array(f);b.Ja=e.length/3;return b};a.n4=e;a.FU=function(a){a=h.O_(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=e(b);a.name="FRUSTUM";return a};a.Tc=function(){var a=A.If("FULLSCREEN_TRI"),b=h.Mg();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.na=new Uint32Array([0,1,2]);a.Ja=3;return a};a.GU=function(){var a=A.If("FULLSCREEN_QUAD"),b=h.Mg();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,1,2,3]);a.Ja=4;return a};a.AU=function(){var a=A.If("BILLBOARD"),b=h.Mg();b.a_bb_vertex=A.ZH(1);a.aa[0]=b;a.na=
new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.CU=function(){var a=A.If("CUBEMAP_BOARD"),b=h.Mg();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.na=new Uint32Array([0,2,1,0,3,2]);a.Ja=4;return a};a.Xu=function(a,e){var f=A.If("UV_SPHERE"),l,c,n=[],r=[],w=[];for(c=0;8>=c;c++)for(l=0;16>=l;l++){var K=l/16,D=c/8;r.push(-a*Math.cos(2*K*Math.PI)*Math.sin(D*Math.PI)+e[0],a*Math.cos(D*Math.PI)+e[1],a*Math.sin(2*K*Math.PI)*Math.sin(D*Math.PI)+e[2])}for(c=K=0;8>c;c++)for(l=0;16>l;l++){var D=
b(r,17*c+l+1),Q=b(r,17*c+l),L=b(r,17*(c+1)+l),H=b(r,17*(c+1)+l+1);Math.abs(D[1])==a+e[1]?(y(D,n),y(L,n),y(H,n),w.push(K,K+1,K+2),K+=3):Math.abs(L[1])==a+e[1]?(y(D,n),y(Q,n),y(L,n),w.push(K,K+1,K+2),K+=3):(y(D,n),y(Q,n),y(L,n),y(H,n),w.push(K,K+1,K+2),w.push(K,K+2,K+3),K+=4)}l={};l.a_position=n;r=A.uR(w,r,n);r=A.rR(w,n,r);l.a_tbn_quat=h.or(r);f.aa[0]=l;f.na=w;f.Ja=n.length/3;return f};a.cI=function(a){var b=A.If("INDEX"),f=h.Mg();f.a_index=new Float32Array(3*a);for(var e=new Uint16Array(3*a),c=0;c<
3*a;c++)f.a_index[c]=c,e[c]=c;b.aa[0]=f;b.na=e;b.Ja=3*a;return b}};b4w.module.__scenegraph=function(a,l){function n(a,b){var c=[];t.xg(a,function(b,d,f){-1<c.indexOf(f)?t.PX(a,b,d,f,Q(f)):c.push(f)});t.pa(a,function(a,d){for(var f=0;f<d.Za.length;f++){var e=d.Za[f];b||d.type!=G.Nd&&d.type!=G.md&&d.type!=G.Uf||(e.nf=!0);-1<c.indexOf(e)?d.Za[f]=Q(e):c.push(e)}})}function e(a,c){t.pa(a,function(b,d){d.type==G.vE&&t.ni(a,b,function(a,b){if(b.type==G.zh)for(var c=0;c<b.Za.length;c++){var d=b.Za[c];d.Na=F.K;d.Ma=F.K}});c||t.ni(a,b,function(a,b,c){"DEPTH"==c.from&&(c.nf=
!0)})});t.pa(a,function(c){var d={};b(a,c,d);for(var f in d){c=d[f];for(var e=c[0],g=0;g<c.length;g++)if(c[g].Na==F.K){e=c[g];break}for(var k=c[0],g=0;g<c.length;g++)if(c[g].Ma==F.K){k=c[g];break}for(var h=c[0],g=0;g<c.length;g++)if(!c[g].nf){h=c[g];break}for(g=0;g<c.length;g++)c[g].Na=e.Na,c[g].Ma=k.Ma,c[g].nf=h.nf}})}function b(a,c,d){t.ni(a,c,function(c,f,e){e.Gc&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),b(a,c,d))});t.Sk(a,c,function(a,b,c){c.Gc&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=t.Wa(a,c);if(c.type==G.zh)for(var f=0;f<c.Za.length;f++){var e=c.Za[f];d[e.from].push(e)}}function y(a){var b=[G.zh,G.ez,G.It,G.Nd,G.md,G.Lp],c=t.UD(a),d=[];t.pa(c,function(a,f){for(var e=0;e<f.Za.length;e++){var g=f.Za[e];-1<b.indexOf(f.type)&&(g.xx=!0);var k=m(d,g,r(g));g.kb=k;f.mi[e]=k}for(e=0;e<f.mi.length;e++)k=f.mi[e],w(d,k);t.Sk(c,a,function(e,g,k){-1<b.indexOf(f.type)&&(k.xx=!0);k.kb||((e=A(c,a,k.from))&&k.Gc&&!k.kb?h(d,e):e=m(d,
k,r(k)),k.kb=e)});t.ni(c,a,function(a,b,c){w(d,c.kb)});t.Sk(c,a,function(a,b,c){c.kb&&"NONE"==c.to&&w(d,c.kb)})})}function r(a){a=U.Ih(a);delete a.to;delete a.Gc;delete a.kb;return JSON.stringify(a)}function A(a,b,c){var d=null;t.ni(a,b,function(a,b,f){if(f.Gc&&f.from==f.to&&f.from==c&&f.kb)return d=f.kb,!0});t.Sk(a,b,function(a,b,f){if(f.Gc&&f.from==c&&f.kb)return d=f.kb,!0});return d}function h(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.QD===b&&d.rs++}}function w(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.QD===b&&d.rs&&d.rs--}}function m(a,b,c){if(b.uo)return h(a,b.uo.kb),b.uo.kb;if(b.xx)return k(b);for(var d=null,f=0;f<a.length;f++){var e=a[f];if(e.id==c&&0===e.rs){d=e;break}}if(d&&!Z.QH)return d.rs++,d.QD;b=k(b);a.push({id:c,rs:1,QD:b});return b}function k(a){var b=a.Rm*a.size,c=a.Sm*a.size;switch(a.from){case "COLOR":if(a.nf){var d=F.Kl(a.lk?F.Nt:F.Mt,a.Us);F.resize(d,b,c)}else d=F.Kl(F.Ah,a.Us),F.resize(d,b,c),F.fD(d,a.Na,a.Ma);return d;case "DEPTH":return a.nf?(d=F.Kl(a.lk?F.Lt:F.Kt,a.Us),
F.resize(d,b,c)):(d=F.Kl(F.nl,a.Us),F.resize(d,b,c),F.fD(d,a.Na,a.Ma)),d;case "CUBEMAP":return d=F.bH(b);case "SCREEN":case "NONE":return null;default:U.q("Wrong slink param: "+a.from)}}function f(a,b){var c=!1;t.xg(a,function(d,f,e){if(e&&(d=t.Wa(a,d),f=t.Wa(a,f),b(e,!1,d,f)))return c=!0});c||t.pa(a,function(a,c){for(var d=0;d<c.Za.length;d++)if(b(c.Za[d],!0,c,null))return!0})}function v(a){t.pa(a,function(b,c){if(c.type!=G.un){var d=c.p;t.Sk(a,b,function(a,b,c){c.Gc&&c.kb&&(x.Qw(d,c.from,c.kb),
c.from==c.to&&b.p&&x.Qw(b.p,c.from,c.kb))});for(var f=0;f<c.Za.length;f++){var e=c.Za[f];e.Gc&&e.from==e.to&&x.Qw(d,e.from,c.mi[f])}!d.wc&&!d.Ve||d.Ze||(d.Ze=da.LX(d.wc,d.Ve))}});t.pa(a,function(b,c){if(c.type==G.tn||c.type==G.by){var d=z(a,c);c.p.kr=d[0].p.Ze}})}function c(a){var b=null,c=0;t.pa(a,function(a,d){if(d.type==R.xZ){if(c==R.wZ)return b=d,!0;c++}});return b}function C(a,b){var c=t.gh(a,b),d=G.Ad("NONE"),f=t.J(a,d),e=t.sr(a)[0];t.xg(a,function(b,c){c==e&&t.FX(a,b,e,b,f)});var g=O(b,a);
t.xg(a,function(f,e,k){if(f==c){if(g){f=G.wu();t.J(a,f);e=D("COLOR","RESOLVE",1,1,1,!0);e.lk=!0;e.nf=!0;var q=D("DEPTH","RESOLVE",1,1,1,!0);q.lk=!0;q.nf=!0;t.r(a,b,f,e);t.r(a,b,f,q);b=f}t.r(a,b,d,D(R.YY,"u_color",k.size,k.Rm,k.Sm,k.Qs));return!0}});t.ed(a,f,e,D("SCREEN","NONE",.5,.5,.5,!0))}function O(a,b){var c=!1,d=t.gh(b,a);t.rg(b,d)&&(c=t.Wg(b,d,0),d=t.Wd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=t.Wa(b,c),c=O(d,b)):c="RESOLVE"==d.to);return c}function J(a,b,c,
d){var f=c.da,e=b.xv,g=b.ei.bi,k=b.ei.yw,h=t.nx(a,t.kV(a,d),t.lt),p=[],l=[],m=[],h=t.clone(h,function(b){var d;if(-1<ga.indexOf(b.type))l.push(b),d=b;else{d=G.fS(b);if(d.type==G.Nd)for(var h=0;h<g.length;h++)if(g[h][0]==b){g[h]=[b,d];d.p.rc=b.p.rc;c.da.push(d.p);break}if(b.type==G.xf)for(h=0;h<g.length;h++){if(k[h][0]==b){k[h]=[b,d];d.p=g[h][1].p;break}}else-1<f.indexOf(b.p)&&(e?(x.Xv(b.p,x.Pe),x.Xv(d.p,x.Qe)):(x.Xv(b.p,x.Qc),x.Xv(d.p,x.dd)),f.push(d.p));var n=t.gh(a,b);t.ni(a,n,function(a,b,c){-1<
ga.indexOf(b.type)&&p.push([b,d,c])});if(b.type!==G.zh)for(h=0;h<b.Za.length;h++)d.Za[h].uo=b.Za[h];b=!0;for(h=0;h<t.$n(a,n);h++){var u=t.Si(a,n,h),u=t.Wa(a,u);-1==ga.indexOf(u.type)&&(b=!1)}b&&m.push(d)}return d},function(a){var b=Q(a,!0);b.uo=a;return b});t.xg(h,function(a,b,c){t.Wa(h,a).type===G.zh&&(c.uo=null)});for(var n=0;n<l.length;n++)t.ug(h,t.gh(h,l[n]));t.Tz(h);b=G.kT(e);var n=t.J(a,b),u=G.sA();t.J(a,u);var r=D("COLOR","COPY",1,1,1,!0);t.r(a,d,u,r);var w=D("COLOR","u_sampler_left",1,1,1,
!0);w.xx=!0;w.Na=F.K;w.Ma=F.K;t.r(a,u,b,w);d.yc||(d=G.sA(),t.J(h,d),w=D("COLOR","COPY",1,1,1,!0),w.uo=r,r=t.sr(h)[0],r=t.Wa(h,r),t.r(h,r,d,w));d=D("COLOR","u_sampler_right",1,1,1,!0);d.Na=F.K;d.Ma=F.K;t.CQ(h,a,[t.sr(h)[0],n,d]);for(n=0;n<p.length;n++)t.r(a,p[n][0],p[n][1],p[n][2]);d=D("SCREEN","NONE",0,0,0,!1);for(n=0;n<m.length;n++)t.r(a,u,m[n],d);e&&K(a,.5,1);return b}function K(a,b,c){var d=[];t.pa(a,function(b,c){if(-1==ga.indexOf(c.type)&&c.Za.length&&L(a,c,G.xi))for(var f=0;f<c.Za.length;f++){var e=
c.Za[f];-1==d.indexOf(e)&&d.push(e)}});t.xg(a,function(b,c,f){b=t.Wa(a,b);c=t.Wa(a,c);-1==ga.indexOf(b.type)&&L(a,c,G.xi)&&-1==d.indexOf(f)&&d.push(f)});for(var f=0;f<d.length;f++)d[f].Rm*=b,d[f].Sm*=c}function D(a,b,c,d,f,e){return{from:a,to:b,size:c,Rm:d,Sm:f,Qs:e,Gc:!0,kb:null,lk:!1,nf:!1,Na:F.ve,Ma:F.ve,xx:!1,Us:!1}}function Q(a,b){if(b){var c=a.kb;a.kb=null}a.kb&&U.q("Failed to clone slink with attached texture");var d=U.Ih(a);b&&(a.kb=c,d.kb=c);return d}function L(a,b,c){if(b.type==c)return!0;
b=d(a,b);for(var f=0;f<b.length;f++)if(L(a,b[f],c))return!0;return!1}function H(a,b,c){if(b.type==c)return!0;b=z(a,b);for(var d=0;d<b.length;d++)if(H(a,b[d],c))return!0;return!1}function z(a,b){var c=t.gh(a,b);c==t.az&&U.q("Subscene not in graph");for(var d=[],f=t.$n(a,c),e=0;e<f;e++){var g=t.Si(a,c,e);g!=c&&d.push(t.Wa(a,g))}return d}function d(a,b){var c=t.gh(a,b);c==t.az&&U.q("Subscene not in graph");for(var d=[],f=t.rg(a,c),e=0;e<f;e++){var g=t.Wg(a,c,e);g!=c&&d.push(t.Wa(a,g))}return d}function p(a){var b=
[],c=[];f(a,function(a){a.kb&&-1==b.indexOf(a.kb)&&(b.push(a.kb),c.push(a.kb,b.length-1))});return c}function M(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.Qs){var d=a.Rm,f=a.Sm;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(f)!=f&&(f=f.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==f?"":f)+"S")}else d=a.Rm,f=a.Sm,c+=a.size*d+"x"+a.size*f;if("SCREEN"!=a.from){c+=" ";if(a.nf)c+="RR";else{var d=a.Na,f=a.Ma,e="";d==F.K?e+="L":d==F.ve&&(e+="N");f==F.K?e+="L":f==F.ve&&(e+="N");c+=e}for(d=
0;d<b.length;d+=2)b[d]==a.kb&&(c+=" "+b[d+1])}return c+")\\n"}var x=l("__camera"),g=l("__config"),P=l("__debug"),t=l("__graph"),da=l("__renderer"),G=l("__subscene"),F=l("__textures"),U=l("__util"),R=g.Tq,Z=g.B,u=g.Eo,ga=[G.vi,G.cd,G.md,G.Oe];a.TR=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.QZ=f;a.HS=function(a,b,f,g){function k(c){var d=x.Hc(Sa,!0);b.da.push(d);d=G.Jl(c,d,!1,L,
O,Ea,Pa,Ca,a.rj);t.J(h,d);c==G.Uf?(t.r(h,p[0],d,D("COLOR","COLOR",1,1,1,!0)),d.Za.push(D("DEPTH","DEPTH",1,1,1,!0))):(c=X&&p[0].type==G.tn?Bb:p[0],t.r(h,c,d,Ha),t.r(h,c,d,Cb));Ka&&(t.r(h,Ka,d,kb),t.r(h,Ka,d,eb));for(c=0;c<m.length;c++)t.r(h,m[c],d,r[c]);Wa&&t.r(h,Wa,d,Fa);if(w.length){var f=w.length;for(c=0;c<f;c++)t.r(h,w[c],d,M[c])}if(H.length)for(c=0;c<H.length;c++)t.r(h,H[c],d,A[c]);Ib&&t.r(h,Ib,d,ec);return d}var h=t.create(),p=[],l=[],m=[],r=[],w=[],M=[],H=[],A=[],O=a.hW,L=a.Mc,K=a.Kk,ga=a.$Y,
N=a.ssao,da=a.god_rays,B=a.ei,za=a.cK,ua=a.dR,ja=a.motion_blur,xa=a.compositing,ka=a.antialiasing,Pa=a.qp,Ea=a.KN,Ca=a.ud,pa=a.SW,Ba=a.DR,va=a.vV,Ma=a.fX,Ga=a.dof,Ra=a.zT,I=a.refractions,V=Boolean(g.length),X=1<Z.Fc,Cb=D("COLOR","COLOR",1,1,1,!0),Ha=D("DEPTH","DEPTH",1,1,1,!0);if(X){Q(Ha);var Ac=Q(Ha);Cb.lk=!0;Cb.nf=!0;Ha.lk=!0;Ha.nf=!0}var Sa=b.da[0];if(Ca){x.eE(Sa,Ca);for(var fa=0;fa<Ca.ah.length;fa++)for(var Da=Ca.csm_num,qa=0;qa<Da;qa++){var W=G.fT(qa,fa,Ca,O);t.J(h,W);m.push(W);var Qa=Ca.csm_resolution,
ra=W.p;b.bM.push(ra);ra.width=Qa;ra.height=Qa;W.wb=!1;var La=D("DEPTH","u_shadow_map"+(0<fa?fa:qa),Qa,1,1,!1);Z.Gq&&(La.Na=F.K,La.Ma=F.K,La.Us=!0);r.push(La);(P.MR()||Z.cM)&&W.Za.push(D("COLOR","COLOR",Qa,1,1,!1))}}if(B&&B.sK&&!V)for(qa=0;qa<B.sK;qa++){ra=x.gd(x.Od);ra.width=a.Ki;ra.height=a.Ki;x.Sw(ra,90,.1,100);x.Ik(ra,ra.Ab);var Ta=G.Jl(G.md,ra,!1,L,O,Ea,Pa,null,a.rj);Ta.Ll=U.HU();for(fa=0;6>fa;fa++)Ta.Qq.push(x.vS());t.J(h,Ta);var pb=D("CUBEMAP","u_cube_reflection",a.Ki,1,1,!1);pb.Na=F.K;pb.Ma=
F.K;A.push(pb);if(B.mJ){var Ua=G.Jl(G.Oe,ra,!1,L,O,Ea,Pa,null,a.rj);Ua.Ll=Ta.Ll;Ua.Qq=Ta.Qq;t.J(h,Ua);var Aa=D("DEPTH","DEPTH",a.Ki,1,1,!1),ab=D("COLOR","COLOR",a.Ki,1,1,!1);t.r(h,Ta,Ua,Aa);t.r(h,Ta,Ua,ab);H.push(Ua);B.xA.push(Ua)}else{var Ya=D("DEPTH","DEPTH",a.Ki,1,1,!1);Ta.Za.push(Ya);H.push(Ta)}B.Ji.push(Ta)}if(B&&0<B.$K.length&&!V)for(fa=0;fa<B.$K.length;fa++)ra=x.Hc(Sa,!0),ra.rc=new Float32Array(4),b.da.push(ra),Ta=G.Jl(G.Nd,ra,!1,L,O,Ea,Pa,null,a.rj),t.J(h,Ta),pb=D("COLOR","u_plane_reflection",
1,a.kh,a.kh,!0),pb.Na=F.K,pb.Ma=F.K,M.push(pb),B.mJ?(Ua=G.Jl(G.xf,ra,!1,L,O,Ea,Pa,null,a.rj),t.J(h,Ua),Aa=D("DEPTH","DEPTH",1,a.kh,a.kh,!0),ab=D("COLOR","COLOR",1,a.kh,a.kh,!0),ab.Na=F.ve,ab.Ma=F.ve,t.r(h,Ta,Ua,Aa),t.r(h,Ta,Ua,ab),B.yw.push([Ua]),w.push(Ua)):(Ya=D("DEPTH","DEPTH",1,a.kh,a.kh,!0),Ta.Za.push(Ya),w.push(Ta)),B.bi.push([Ta]);if(a.hd){var Ka=G.ZS();t.J(h,Ka);Qa=u.zr;Ka.p.width=Qa;Ka.p.height=Qa;var kb=D("DEPTH","u_grass_map_depth",Qa,1,1,!1);Z.ec||(kb.Na=F.K,kb.Ma=F.K);var eb=D("COLOR",
"u_grass_map_color",Qa,1,1,!1);eb.Na=F.K;eb.Ma=F.K}else eb=kb=Ka=null;if(Ra&&Ca){var bb=x.Hc(Sa,!0);b.da.push(bb);var sb=G.gT(bb,O);t.J(h,sb);sb.self_shadow_normal_offset=Ca.self_shadow_normal_offset;for(qa=0;qa<m.length;qa++)W=m[qa],t.r(h,W,sb,r[qa]);var lb=D("COLOR","u_color",1,1,1,!0),nb=D("DEPTH","u_depth",1,1,1,!0);if(N){var wb=x.Hc(Sa,!0);b.da.push(wb);var Va=a.pZ,Ob=G.iT(wb,Ea,Va);t.J(h,Ob);var ic=D("COLOR","u_ssao_mask",1,1,1,!0);t.r(h,sb,Ob,lb);t.r(h,sb,Ob,nb);var Wb=x.Hc(Sa,!0);b.da.push(Wb);
var qb=G.jT(Wb,Va);t.J(h,qb);var nd=D("COLOR","u_shadow_mask",1,1,1,!0);t.r(h,Ob,qb,ic);t.r(h,sb,qb,nb)}X?sb.Za.push(D("DEPTH","DEPTH",1,1,1,!0)):sb.Za.push(Ha);Ka&&(t.r(h,Ka,sb,kb),t.r(h,Ka,sb,eb))}else sb=null;var Bb=G.Jl(G.Pb,Sa,!0,L,O,Ea,Pa,null,a.rj);t.J(h,Bb);if(X){var fb=G.wu();t.J(h,fb);l.push(fb);var jc=D("COLOR","RESOLVE",1,1,1,!0);jc.lk=!0;jc.nf=!0;var Nc=D("DEPTH","RESOLVE",1,1,1,!0);Nc.lk=!0;Nc.nf=!0;t.r(h,Bb,fb,jc);t.r(h,Bb,fb,Nc)}else l.push(Bb);sb&&(ic?t.r(h,qb,Bb,nd):Ca?t.r(h,sb,
Bb,D("COLOR","u_shadow_mask",1,1,1,!0)):U.q("Internal error"));Ka&&(t.r(h,Ka,Bb,kb),t.r(h,Ka,Bb,eb));if(w.length)for(var Wc=w.length,fa=0;fa<Wc;fa++)t.r(h,w[fa],Bb,M[fa]);if(H.length)for(fa=0;fa<H.length;fa++)t.r(h,H[fa],Bb,A[fa]);p=l;l=[];if(!V&&a.gS){ra=x.Hc(Sa,!0);ra.width=1;ra.height=1;b.da.push(ra);var tc=G.jH(ra,!1,O);t.J(h,tc);if(a.vh){ra=x.Hc(Sa,!0);ra.width=1;ra.height=1;b.da.push(ra);var Qc=G.jH(ra,!0,O);t.J(h,Qc);t.r(h,tc,Qc,D("COLOR","COLOR",1,1,1,!1));t.r(h,tc,Qc,D("DEPTH","DEPTH",1,
1,1,!1))}}else tc=null;if(!za.refractions&&!I||V)Ib=null;else{if(X)Ib=fb;else{var Ib=G.sA();t.J(h,Ib);t.r(h,p[0],Ib,D("COLOR","COPY",1,1,1,!0))}var ec=D("COLOR","u_refractmap",1,1,1,!0)}if(Ra&&(I||K||ga)){var xb=x.Hc(Sa,!0);b.da.push(xb);var Wa=G.WS(xb);t.J(h,Wa);t.r(h,X?fb:Bb,Wa,D("DEPTH","u_depth",1,1,1,!0));var Fa=D("COLOR","u_scene_depth",1,1,1,!0);Fa.Na=F.ve;Fa.Ma=F.ve}else Wa=null;if(a.kv){var yb=k(G.Pc);l.push(yb);p=l;l=[]}if(a.Ui){var Rc=x.Hc(Sa,!0);b.da.push(Rc);var Xb=G.Jl(G.ge,Rc,!1,L,
O,Ea,Pa);t.J(h,Xb);Wa&&t.r(h,Wa,Xb,Fa);Ib&&t.r(h,Ib,Xb,ec);Ka&&(t.r(h,Ka,Xb,kb),t.r(h,Ka,Xb,eb));if(w.length)for(Wc=w.length,fa=0;fa<Wc;fa++)t.r(h,w[fa],Xb,M[fa]);if(H.length)for(fa=0;fa<H.length;fa++)t.r(h,H[fa],Xb,A[fa]);t.r(h,X?fb:Bb,Xb,X?Ac:Ha);var Bc=G.Ad("X_GLOW_BLUR");Bc.Fb="GLOW_MASK_SMALL";Bc.wg=a.$j.small_glow_mask_width;var dd=D("COLOR","u_color",1,1,1,!0);dd.Na=F.K;dd.Ma=F.K;t.J(h,Bc);t.r(h,Xb,Bc,dd);var uc=G.Ad("Y_GLOW_BLUR");uc.Fb="GLOW_MASK_SMALL";uc.wg=a.$j.small_glow_mask_width;var Zb=
D("COLOR","u_color",1,.5,.5,!0);Zb.Na=F.K;Zb.Ma=F.K;t.J(h,uc);t.r(h,Bc,uc,Zb);var Xc=G.Ad("X_GLOW_BLUR");Xc.Fb="GLOW_MASK_LARGE";Xc.wg=a.$j.large_glow_mask_width;var ed=D("COLOR","u_color",1,.5,.5,!0);ed.Na=F.K;ed.Ma=F.K;t.J(h,Xc);t.r(h,uc,Xc,ed);var $b=G.Ad("Y_GLOW_BLUR");$b.Fb="GLOW_MASK_LARGE";$b.wg=a.$j.large_glow_mask_width;var cb=D("COLOR","u_color",1,.25,.25,!0);cb.Na=F.K;cb.Ma=F.K;t.J(h,$b);t.r(h,Xc,$b,cb);var vd=x.Hc(Sa,!0);b.da.push(vd);var Fc=G.XS(vd,a);t.J(h,Fc);var ib=D("COLOR","u_src_color",
1,1,1,!0);if(a.kv)if(X){var od=G.wu();t.J(h,od);t.r(h,yb,od,jc);t.r(h,yb,od,Nc);t.r(h,od,Fc,ib)}else t.r(h,yb,Fc,ib);else t.r(h,X?fb:Bb,Fc,ib);t.r(h,a.kv?yb:Bb,Fc,Ha);var Cc=D("COLOR","u_glow_mask_small",1,.5,.5,!0);Cc.Na=F.K;Cc.Ma=F.K;t.r(h,uc,Fc,Cc);var kc=D("COLOR","u_glow_mask_large",1,.25,.25,!0);kc.Na=F.K;kc.Ma=F.K;t.r(h,$b,Fc,kc);p=[Fc];l=[]}a.kv||(yb=k(G.Pc),l.push(yb),p=l,l=[]);if(Z.debug_view){ra=x.Hc(Sa,!0);b.da.push(ra);var Qb=G.VS(ra);l.push(Qb);t.J(h,Qb);t.r(h,p[0],Qb,Cb);t.r(h,p[0],
Qb,Ha);Ka&&(t.r(h,Ka,Qb,kb),t.r(h,Ka,Qb,eb));P.lY(Qb);p=l;l=[]}if(X){var Pb=G.wu();t.J(h,Pb);l.push(Pb);t.r(h,p[0],Pb,jc);t.r(h,p[0],Pb,Nc);p=l;l=[]}var lc=p.slice(0);if(!V&&a.jQ){ra=x.Hc(Sa,!0);b.da.push(ra);var Gc=G.RS(ra);t.J(h,Gc);t.r(h,p[0],Gc,X?Ac:Ha)}if(da&&Ra&&!V){var Jb=va.ko,mc=va.AB,rb=va.Xo,db=p[0],ac=L?!0:!1,Yc=D("DEPTH","u_input",1,1,1,!0),Db=D("COLOR","u_input",1,.25,.25,!0);Db.Na=F.K;Db.Ma=F.K;var Rb=Jb/rb,gb=x.Hc(Sa,!0);b.da.push(gb);var ob=G.tA(gb,ac,Jb,!0,Rb,O,rb);t.J(h,ob);t.r(h,
db,ob,Yc);var Rb=Jb/rb*.5,Hc=x.Hc(Sa,!0);b.da.push(Hc);var nc=G.tA(Hc,ac,Jb,!1,Rb,O,rb);t.J(h,nc);t.r(h,ob,nc,Db);var Rb=Jb/rb*.25,Ic=x.Hc(Sa,!0);b.da.push(Ic);var Kb=G.tA(Ic,ac,Jb,!1,Rb,O,rb);t.J(h,Kb);t.r(h,nc,Kb,Db);var oc=G.YS(mc,O);l.push(oc);t.J(h,oc);t.r(h,db,oc,D("COLOR","u_main",1,1,1,!0));t.r(h,Kb,oc,D("COLOR","u_god_rays",1,1,1,!0));p=l;l=[]}if(ua&&!V){var db=p[0],bc=G.$S();t.J(h,bc);t.r(h,db,bc,D("COLOR","u_input",1,1,1,!0));var Za=G.SS();t.J(h,Za);Za.p.width=Z.br?2:1;Za.p.height=Z.br?
2:1;var cc=D("COLOR","u_input",1,.25,.25,!0);cc.Na=F.K;cc.Ma=F.K;var Lb=D("COLOR","u_luminance",1,.25,.25,!0);Lb.Na=F.K;Lb.Ma=F.K;t.r(h,bc,Za,cc);var tb=ua.key,pc=ua.edge_lum,ub=x.Hc(Sa,!0);b.da.push(ub);var Mb=G.aT(tb,pc,O,ub);t.J(h,Mb);t.r(h,db,Mb,D("COLOR","u_main",1,1,1,!0));t.r(h,bc,Mb,Lb);t.r(h,Za,Mb,D("COLOR","u_average_lum",1,1,1,!1));var Sb=D("COLOR","u_color",1,.25,.25,!0);Sb.Na=F.K;Sb.Ma=F.K;Bc=G.iH("X_BLUR");t.J(h,Bc);t.r(h,Mb,Bc,Sb);uc=G.iH("Y_BLUR");t.J(h,uc);t.r(h,Bc,uc,Sb);var vc=
G.TS(ua.blur);t.J(h,vc);var Jc=D("COLOR","u_bloom",1,.25,.25,!0);Jc.Na=F.K;Jc.Ma=F.K;t.r(h,uc,vc,Jc);t.r(h,db,vc,D("COLOR","u_main",1,1,1,!0));l.push(vc);p=l;l=[]}if(Ga&&Ra&&!V){var db=p[0],Ia=x.Hc(Sa,!0);b.da.push(Ia);if(f.dof_bokeh){var fc=D("COLOR","u_color",1,1,1,!0);fc.Na=F.K;fc.Ma=F.K;var Eb=D("DEPTH","u_depth",1,1,1,!0),Fb=D("COLOR","u_color",1,.5,.5,!0);Fb.Na=F.ve;Fb.Ma=F.ve;Sb=D("COLOR","u_color",1,.5,.5,!0);Sb.Na=F.ve;Sb.Ma=F.ve;var Dc=D("COLOR","u_blurred1",1,.5,.5,!0);Dc.Na=F.K;Dc.Ma=
F.K;var Tb=D("COLOR","u_blurred2",1,.5,.5,!0);Tb.Na=F.K;Tb.Ma=F.K;var jb=lc[0];if(f.Cd){var hb=x.Hc(Sa,!0);b.da.push(hb);var Ja=G.rA(hb,"COC_FOREGROUND");hb.dof_distance=f.dof_distance;hb.dof_object=f.dof_object;hb.dof_front_start=f.dof_front_start;hb.dof_front_end=f.dof_front_end;hb.dof_rear_start=f.dof_rear_start;hb.dof_rear_end=f.dof_rear_end;hb.dof_power=f.dof_power;hb.dof_bokeh=f.dof_bokeh;hb.dof_bokeh_intensity=f.dof_bokeh_intensity;hb.Cd=f.Cd;hb.dof_on=!0;t.J(h,Ja);t.r(h,db,Ja,fc);t.r(h,jb,
Ja,Eb);var Yb=G.Ad("X_ALPHA_BLUR");t.J(h,Yb);t.r(h,Ja,Yb,Fb);var Gb=G.Ad("Y_ALPHA_BLUR");t.J(h,Gb);t.r(h,Yb,Gb,Sb);var Na=x.Hc(Sa,!0),Oa=G.rA(Na,"COC_COMBINE");b.da.push(Na);Na.dof_distance=f.dof_distance;Na.dof_object=f.dof_object;Na.dof_front_start=f.dof_front_start;Na.dof_front_end=f.dof_front_end;Na.dof_rear_start=f.dof_rear_start;Na.dof_rear_end=f.dof_rear_end;Na.dof_power=f.dof_power;Na.dof_bokeh=f.dof_bokeh;Na.dof_bokeh_intensity=f.dof_bokeh_intensity;Na.Cd=f.Cd;Na.dof_on=!0;t.J(h,Oa);t.r(h,
db,Oa,fc);t.r(h,jb,Oa,Eb);t.r(h,Gb,Oa,D("COLOR","u_coc_fg",1,.5,.5,!0))}else Na=x.Hc(Sa,!0),b.da.push(Na),Oa=G.rA(Na,"COC_ALL"),Na.dof_distance=f.dof_distance,Na.dof_object=f.dof_object,Na.dof_front_start=f.dof_front_start,Na.dof_front_end=f.dof_front_end,Na.dof_rear_start=f.dof_rear_start,Na.dof_rear_end=f.dof_rear_end,Na.dof_power=f.dof_power,Na.dof_bokeh=f.dof_bokeh,Na.dof_bokeh_intensity=f.dof_bokeh_intensity,Na.Cd=f.Cd,Na.dof_on=!0,t.J(h,Oa),t.r(h,db,Oa,fc),t.r(h,jb,Oa,Eb);var mb=G.Ad("X_DOF_BLUR");
mb.p.dof_bokeh_intensity=f.dof_bokeh_intensity;t.J(h,mb);t.r(h,Oa,mb,Fb);var Oc=G.Ad("Y_DOF_BLUR");Oc.p.dof_bokeh_intensity=f.dof_bokeh_intensity;t.J(h,Oc);t.r(h,mb,Oc,Sb);var Kc=G.Ad("Y_DOF_BLUR");Kc.p.dof_bokeh_intensity=f.dof_bokeh_intensity;t.J(h,Kc);t.r(h,mb,Kc,Sb);var vb=G.kH(Ia);Ia.dof_distance=f.dof_distance;Ia.dof_object=f.dof_object;Ia.dof_front_start=f.dof_front_start;Ia.dof_front_end=f.dof_front_end;Ia.dof_rear_start=f.dof_rear_start;Ia.dof_rear_end=f.dof_rear_end;Ia.dof_power=f.dof_power;
Ia.dof_bokeh=f.dof_bokeh;Ia.dof_bokeh_intensity=f.dof_bokeh_intensity;Ia.Cd=f.Cd;Ia.dof_on=!0;l.push(vb);t.J(h,vb);t.r(h,db,vb,D("COLOR","u_sharp",1,1,1,!0));t.r(h,Oc,vb,Dc);t.r(h,Kc,vb,Tb)}else{var Ec=D("COLOR","u_color",1,1,1,!0);Ec.Na=F.K;Ec.Ma=F.K;var Ub=D("COLOR","u_color",1,1,1,!0);Ub.Na=F.K;Ub.Ma=F.K;mb=G.Ad("X_BLUR");t.J(h,mb);t.r(h,db,mb,Ec);var dc=G.Ad("Y_BLUR");t.J(h,dc);t.r(h,mb,dc,Ub);var fd=lc[0],vb=G.kH(Ia);Ia.dof_distance=f.dof_distance;Ia.dof_object=f.dof_object;Ia.dof_front_start=
f.dof_front_start;Ia.dof_front_end=f.dof_front_end;Ia.dof_rear_start=f.dof_rear_start;Ia.dof_rear_end=f.dof_rear_end;Ia.dof_power=f.dof_power;Ia.dof_bokeh=f.dof_bokeh;Ia.dof_bokeh_intensity=f.dof_bokeh_intensity;Ia.Cd=f.Cd;Ia.dof_on=!0;l.push(vb);t.J(h,vb);t.r(h,db,vb,D("COLOR","u_sharp",1,1,1,!0));t.r(h,dc,vb,D("COLOR","u_blurred",1,1,1,!0));t.r(h,fd,vb,D("DEPTH","u_depth",1,1,1,!0))}p=l;l=[]}if(a.vh){var Zc=k(G.Uf);l.push(Zc);p=l;l=[]}if(ja&&!V){var Sc=p[0],$c=G.bT(pa.mb_decay_threshold,pa.mb_factor);
l.push($c);t.J(h,$c);t.r(h,Sc,$c,D("COLOR","u_mb_tex_curr",1,1,1,!0));$c.Za.push(D("COLOR","u_mb_tex_accum",1,1,1,!0));p=l;l=[]}if(!V&&a.outline){var db=p[0],zb=x.Hc(Sa,!0);b.da.push(zb);var Ab=G.dT(zb,O);t.J(h,Ab);var wc=G.Ad("X_EXTEND"),gd=D("COLOR","u_color",1,1,1,!0),Xa=D("COLOR","u_outline_mask",1,1,1,!0);wc.Fr=!0;t.J(h,wc);t.r(h,Ab,wc,gd);var $a=D("COLOR","u_color",1,.5,.5,!0);$a.Na=F.K;$a.Ma=F.K;var Tc=G.Ad("Y_EXTEND");Tc.Fr=!0;t.J(h,Tc);t.r(h,wc,Tc,$a);mb=G.Ad("X_BLUR");mb.Fr=!0;t.J(h,mb);
t.r(h,Tc,mb,$a);var gc=D("COLOR","u_color",1,.25,.25,!0);gc.Na=F.K;gc.Ma=F.K;var Nb=D("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Nb.Na=F.K;Nb.Ma=F.K;dc=G.Ad("Y_BLUR");dc.Fr=!0;t.J(h,dc);t.r(h,mb,dc,gc);var xc=G.cT(Ma);t.J(h,xc);t.r(h,db,xc,D("COLOR","u_outline_src",1,1,1,!0));t.r(h,Ab,xc,Xa);t.r(h,dc,xc,Nb);l.push(xc);p=l;l=[]}n(h,Ra);if((a.anaglyph_use||a.xv)&&!V){var hd=J(h,a,b,p[0]);l.push(hd);p=l;l=[]}if(xa&&!V){var db=p[0],Uc=G.US(Ba.brightness,Ba.contrast,Ba.exposure,Ba.saturation);t.J(h,
Uc);t.r(h,db,Uc,D("COLOR","u_color",1,1,1,!0));l.push(Uc);p=l;l=[]}if(ka){db=p[0];if(Z.smaa){var yc=D("COLOR","u_color",1,1,1,!0);yc.Na=F.K;yc.Ma=F.K;var qc=G.uA(G.Ht,a);t.J(h,qc);t.r(h,db,qc,yc);var Lc=G.uA(G.Pp,a);t.J(h,Lc);t.r(h,qc,Lc,yc);var Vc=D("COLOR","u_search_tex",1,1,1,!1),hc=D("COLOR","u_area_tex",1,1,1,!1);Vc.Na=F.K;Vc.Ma=F.K;hc.Na=F.K;hc.Ma=F.K;Lc.Za.push(Vc);Lc.Za.push(hc);var rc=G.uA(G.It,a);t.J(h,rc);t.r(h,db,rc,yc);var Vb=D("COLOR","u_blend",1,1,1,!0);Vb.Na=F.K;Vb.Ma=F.K;t.r(h,Lc,
rc,Vb);l.push(rc)}else{var Mc=G.QS(a);t.J(h,Mc);var jd=D("COLOR","u_color",1,1,1,!0);jd.Na=F.K;jd.Ma=F.K;t.r(h,db,Mc,jd);l.push(Mc)}p=l;l=[]}var zc=t.gh(h,p[0]);if(p[0].type==G.zh||p[0].type==G.tn)var pd=!0;else pd=!1,t.ni(h,zc,function(a,b,c){if(c.from==c.to)return pd=!0});if(pd){var kd=G.Ad("NONE");t.J(h,kd);t.r(h,p[0],kd,D("COLOR","u_color",1,1,1,!0));l.push(kd);p=l;l=[]}l.push(p[0]);tc&&(Qc?l.push(Qc):l.push(tc));Gc&&l.push(Gc);Qa=u.zu;if(a.ex.cL){var ld=a.ex,wd=a.qp,qd=wd.Po,Qa=qd?qd.FZ:Qa,ad=
G.hT(wd,O,ld,Qa);t.J(h,ad);l.push(ad)}var sc=G.lH();t.J(h,sc);for(qa=0;qa<l.length;qa++){var bd=l[qa];switch(bd.type){case G.tf:case G.ui:t.r(h,bd,sc,D("COLOR","NONE",1,1,1,!1));t.r(h,bd,sc,D("DEPTH","NONE",1,1,1,!1));break;case G.Dg:t.r(h,bd,sc,D("CUBEMAP","u_sky",Qa,1,1,!1));break;case G.ln:t.r(h,bd,sc,D("COLOR","NONE",1,1,1,!0));break;default:if(V){var rd=g[0],cd=D("COLOR","OFFSCREEN",1,1,1,!0);cd.kb=rd;t.r(h,l[qa],sc,cd);for(fa=1;fa<g.length;fa++){var sd=g[fa],Hb=G.Ad("NONE");t.J(h,Hb);t.r(h,
l[qa],Hb,D("COLOR","SCALE",1,1,1,!0));var xd=sd.nj/rd.nj,cd=D("COLOR","OFFSCREEN",1,xd,xd,!0);cd.kb=sd;t.r(h,Hb,sc,cd)}}else t.r(h,l[qa],sc,D("SCREEN","NONE",1,1,1,!0))}}fb&&!d(h,fb).length&&(t.ug(h,t.gh(h,fb)),t.Tz(h));n(h,Ra);e(h,Ra);if(R.enabled){var Pc=c(h);Pc&&C(h,Pc)}y(h);v(h);Ca&&t.pa(h,function(a,b){if(b.type==G.yf||b.type==G.Pc||b.type==G.Uf){for(var c=0,d=z(h,b),f=0,e=0;e<d.length;e++){var g=d[e];g.type==G.cd&&(f++,b.Hm=b.Hm||[],b.Hm[0<g.ph?g.ph:c]=g.p.xb,c++)}b.Bx&&b.Ax||(Z.Wv?b.kE=new Float32Array(9*
f):(b.Bx=new Float32Array(4*f),b.Ax=new Float32Array(4*f)))}});return h};a.YW=K;a.Jd=function(a,b,c){var d=a.wg;a.RD[0]=b*a.Gb[0]*d;a.RD[1]=c*a.Gb[1]*d};a.Lc=function(a,b){a.wg=b};a.FS=function(){var a=t.create(),b=G.eT(),c=x.gd(x.pd);c.width=512;c.height=512;b.p=c;t.J(a,b);b.Za.push(D("COLOR","u_color",512,1,1,!1));c=G.lH();t.J(a,c);t.r(a,b,c,D("COLOR","NONE",512,1,1,!1));y(a);v(a);return a};a.mU=function(a){var b=null;t.pa(a,function(a,c){return c.p&&null===c.p.Ze?(b=c,!0):!1});return b};a.Db=function(a,
b,c){a=z(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.iB=function(a,b,c){a=z(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.l6=L;a.o6=H;a.iV=z;a.mV=d;a.gc=function(a,b){var c=null;t.pa(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.uT=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=p(a);t.pa(a,function(a,d){var f=
b+="    ",e=G.GD(d);if(d.p){for(var e=e+"\\n",g=0;g<c.length;g+=2){var h=d.p.wc;c[g]==h&&(e=F.eo(h)?e+("CR"+c[g+1]+" "):e+("C"+c[g+1]+" "))}for(g=0;g<c.length;g+=2)h=d.p.Ve,c[g]==h&&(e=F.eo(h)?e+("DR"+c[g+1]):e+("D"+c[g+1]))}d.Za.length&&(e+="\\n-----\\n");for(g=0;g<d.Za.length;g++)e+=M(d.Za[g],c);g=d.type==G.un?"dotted":d.Ud?"solid":"dashed";b=f+(String(a)+' [label="'+e+'" color="black" style="'+(g+",bold")+'"];\n')});t.xg(a,function(a,d,f){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+M(f,
c)+'" style="'+(f.Gc?"solid":"dotted")+'"];\n'});return b+="}"};a.IS=function(a){a=t.IZ(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.Ud&&b.push(d)}return b}};b4w.module.__textures=function(a,l){function n(){return{type:0,source:"",Hs:"",width:0,height:0,Iq:1,anisotropic_filtering:"",nj:1024,Sl:!1,Xf:null,nb:0,sb:null,Ne:null,tm:!1,et:-1,Ta:null,Fx:"",kk:0,Vg:0,va:0,Tb:0,Yj:0,lg:!1,nh:1,td:null,ys:0,xs:0,lj:-1,As:!1,Fk:-1,bt:!1,hE:!1,vj:!1,Xk:!1,repeat:!0,Br:"",Yn:"",Zn:"",wB:"",vB:"",Bv:!1,lm:"",Gz:"",ok:0}}function e(a,b,c){a.Zn=b.uuid;a.Yn=b.filepath;a.wB=b.source;a.vB=b.name;a.Br=ia.gj(c+b.filepath);if(a.Bv=b.Dh)a.lm=b.Tp;ha.push(a)}function b(a,b,
c){var d=-1<b.indexOf(".dds"),f=-1<b.indexOf(".pvr");a.Bv=d||f;a.lm=d?"dds":f?"pvr":"";a.Yn=b;a.Br=c}function y(b,c){var d=n();d.type=b;d.source="NONE";if(b==a.Mt||b==a.Kt||b==a.Nt||b==a.Lt)d.Ne=N.createRenderbuffer();else{var f=N.TEXTURE_2D,e=N.createTexture();N.bindTexture(f,e);N.texParameteri(f,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(f,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(f,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(f,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);var g=O(d),h=J(d),
k=K(d),q=b==a.nl?null:new Uint8Array([204,204,204,255]);N.texImage2D(f,0,h,1,1,0,g,k,q);oa.Gq&&c&&N.texParameterf(f,N.TEXTURE_COMPARE_MODE,N.COMPARE_REF_TO_TEXTURE);N.bindTexture(f,null);d.nb=f;d.sb=e}return d}function r(a){"CANVAS"!=a.source&&ia.q("Wrong texture");var b=a.nb;N.bindTexture(b,a.sb);var c=O(a),d=J(a),f=K(a),e=a.Xf.canvas;N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);N.texImage2D(b,0,d,c,f,e);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);a.Sl&&N.generateMipmap(b);N.bindTexture(b,null);a.width=e.width;
a.height=e.height}function A(a){var b=a.nb;N.bindTexture(b,a.sb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ta.length?a.lg?m(a,a.Ta,a.width*a.nh,a.height*a.nh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.Ta):N.texImage2D(b,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,a.Ta);N.bindTexture(b,null)}function h(a){var b=a.nb;N.bindTexture(b,a.sb);N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.lg?m(a,a.td[a.lj],a.width*a.nh,a.height*a.nh,!1):N.texImage2D(b,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,a.td[a.lj]);N.bindTexture(b,
null)}function w(){ya||(ya=document.createElement("canvas"));return ya}function m(a,b,c,d,e){e||(f(N.TEXTURE_2D),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b));N.bindTexture(N.TEXTURE_2D,null);q.JT(a,c,d,la,wa)}function k(a,b,c,d){for(var f=0;6>f;f++){var e=d[f],g=w();g.width=c;g.height=c;var h=g.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(h.translate(0,c),h.scale(1,-1)):(h.translate(c,0),h.scale(-1,1));h.drawImage(a,e[1]*b,e[2]*b,b,b,0,0,c,c);N.texImage2D(N["TEXTURE_CUBE_MAP_"+
e[0]],0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,g)}}function f(a){la||(la=N.createFramebuffer());N.bindTexture(a,null);wa||(wa=N.createTexture());N.bindTexture(a,wa);N.texParameteri(a,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);N.texParameteri(a,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(a,N.TEXTURE_MIN_FILTER,N.LINEAR)}function v(a,b,d){var e=a.source,g=a.sb,h=a.nb,p=a.lm,l=a.Yn,n=1,t=1;N.bindTexture(h,g);a.repeat?(N.texParameteri(h,N.TEXTURE_WRAP_S,N.REPEAT),
N.texParameteri(h,N.TEXTURE_WRAP_T,N.REPEAT)):(N.texParameteri(h,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(h,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE));if(4==b.length){var r=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==e)if(r)N.texImage2D(h,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(p){t=u.iJ(b,p);r=ia.uq(t.width)||ia.uq(t.height);if(t.width>Y.Ec||t.height>Y.Ec){E.error('Image "'+l+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+
Y.Ec+"x"+Y.Ec+".");return}n=t.width;t=t.height;if(r||"pvr"==p)a.lg=!0,f(h),n=C(n*a.nh),t=C(t*a.nh);"dds"==p?u.C_(N,ca.RI(),b,!0):"pvr"==p&&u.D_(N,ca.MI(),b);a.lg&&(m(a,null,n,t,!0),N.bindTexture(h,g),N.generateMipmap(h));a.width=n;a.height=t;a.Iq=u.RU(b,p)}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0);a.tm?oa.zs?(n=b[0].width,t=b[0].height):(n=b.videoWidth,t=b.videoHeight):(n=b.width,t=b.height);a.width=n;a.height=t;if(n>Y.Ec||n>Y.Ec)E.warn('Image "'+l+'" has unsupported size: '+n+"x"+t+". Max available: "+
Y.Ec+"x"+Y.Ec+". Reduced image size will be used."),a.nh=Math.min(Y.Ec/n,Y.Ec/t),a.lg=!0;a.tm&&(d in ma||(ma[d]={}),ma[d][a.Fx]=a,oa.zs?(a.td=b,a.ys=b.length,a.Vg=a.xs*a.kk/b.length,b=b[0]):(a.Ta=b,a.Ta.loop=a.vj,a.Vg=b.duration?a.kk/b.duration:aa.rd(),na.FH||(b.playbackRate=aa.rd()/a.Vg,na.MG&&2<b.playbackRate&&(b.playbackRate=2)),c(a)));n=C(a.width*a.nh);t=C(a.height*a.nh);a.lg?(l=w(),g=l.getContext("2d"),l.width=n,l.height=t,g.drawImage(b,0,0,a.width,a.height,0,0,n,t),N.texImage2D(h,0,N.RGBA,N.RGBA,
N.UNSIGNED_BYTE,l)):oa.ec||!ia.uq(a.width)&&!ia.uq(a.height)?N.texImage2D(h,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,b):(m(a,b,n,t,!1),a.lg=!0);g=a.sb;a.tm||(N.bindTexture(h,g),N.generateMipmap(h),N.bindTexture(h,null));a.width=n;a.height=t}else if("ENVIRONMENT_MAP"==e)if(n=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],r){for(l=0;6>l;l++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+n[l][0]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,b);a.width=3;a.height=
2}else{N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){E.error('Cubemap Image "'+l+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}t=b.width/3;t>Y.Zi?(E.warn('Cubemap Image "'+l+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*Y.Zi+"x"+2*Y.Zi+". Reduced image size will be used."),l=C(Y.Zi/t*t),a.lg=!0):(l=C(t),!oa.ec&&(3*l>Y.Ec||2*l>Y.Ec)&&(a.lg=!0));if(a.lg||oa.WC)k(b,t,l,n);else{p=
b;g=l;f(N.TEXTURE_2D);N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,p);N.bindTexture(N.TEXTURE_2D,null);for(p=0;6>p;p++)N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,N.RGBA,g,g,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(a.nb,null);N.bindFramebuffer(N.FRAMEBUFFER,la);for(p=0;6>p;p++)q.IT(a,N.TEXTURE_CUBE_MAP_POSITIVE_X+p,g,t,wa,p);N.bindFramebuffer(N.FRAMEBUFFER,null);N.bindTexture(a.nb,a.sb);N.texParameteri(a.nb,N.TEXTURE_MIN_FILTER,ea[oa.bp]);N.texParameteri(a.nb,N.TEXTURE_MAG_FILTER,
N.LINEAR)}ga.OR()&&(E.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),k(b,t,R.UE,n));a.width=3*l;a.height=2*l;N.generateMipmap(h)}else"NODE_TEX"==e&&(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),N.texImage2D(h,0,N.RGBA,b.width,b.height,0,N.RGBA,N.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);N.bindTexture(h,null)}function c(a){a.Ta.u7=function(){A(a)}}function C(a){return ia.uq(a)?ia.U(Math.pow(2,parseInt(a).toString(2).length),2,Y.Ec):a}function O(b){var c;
switch(b.type){case a.Ah:c=N.RGBA;break;case a.Ot:c=N.RGB;break;case a.Rp:c=N.RGBA;break;case a.Sp:c=N.RGB;break;case a.nl:c=N.DEPTH_COMPONENT;break;default:ia.q("Wrong texture type")}return c}function J(b){var c;switch(b.type){case a.Ah:c=oa.ec?N.RGBA8:N.RGBA;break;case a.Ot:c=oa.ec?N.RGB8:N.RGB;break;case a.Rp:c=oa.ec?N.RGBA8:N.RGBA;break;case a.Sp:c=oa.ec?N.RGB8:N.RGB;break;case a.nl:c=oa.ec?oa.qz?N.DEPTH_COMPONENT16:N.DEPTH_COMPONENT24:N.DEPTH_COMPONENT;break;default:ia.q("Wrong texture type")}return c}
function K(b){var c;switch(b.type){case a.Ah:c=N.UNSIGNED_BYTE;break;case a.Ot:c=N.UNSIGNED_BYTE;break;case a.Rp:c=N.FLOAT;break;case a.Sp:c=N.FLOAT;break;case a.nl:c=oa.qz?N.UNSIGNED_SHORT:N.UNSIGNED_INT;break;default:ia.q("Wrong texture type")}return c}function D(a){return a&&a.Ne?!0:!1}function Q(a){a.Ta?a.Ta.play():a.td&&(a.As=!0);a.bt=!1}function L(a){a.Ta?a.Ta.pause():a.td&&(a.As=!1);a.bt=!0}function H(a){a.Ta?a.Ta.currentTime=a.Tb/a.Vg:a.td&&(a.lj=d(a,a.Tb),h(a))}function z(a){return a.Ta?
!a.Ta.paused:a.td?a.As:!1}function d(a,b){return Math.round(b*a.ys/a.kk)}function p(a,b){if(T.Sa(a))return M(a,b);for(var c=a.aw,d=0;d<c.length;d++){var f=M(c[d],b);if(f)return f}return null}function M(a,b){var c=a.I;if(c.length)for(var c=c[0].W,d=0;d<c.length;d++){var f=c[d];if("MAIN"==f.type||"SKY"==f.type)for(var e=0;e<f.ya.length;e++)if(f.Ig[e]==b)return f.ya[e]}return null}function x(a,b,c){a=a.I;if(a.length){a=a[0].W;for(var d=0;d<a.length;d++){var f=a[d];if("MAIN"==f.type)for(var e=0;e<f.ya.length;e++)f.Ig[e]==
b&&(G(f.ya[e]),f.ya[e]=c,F(c))}}}function g(a,b){var c=a.I;if(c.length)for(var c=c[0].W,d=0;d<c.length;d++){var f=c[d];if("MAIN"==f.type)for(var e=0;e<f.ya.length;e++){var g=f.ya[e],h=f.Ig[e];-1==b.indexOf(h)&&"NODE_TEX"!=g.source&&b.push(h)}}}function P(a,b,c){var d=a.elements;a=a.interpolation;for(var f=0;f<b;f++){var e=f/(b-1),g=t(d,e,!0),h=da(d,e,!0);if(g&&h)if("CONSTANT"==a)c.push.apply(c,g.color);else{var k=c,q=g,p=h;q==p?k.push.apply(k,q.color):(k.push(ba.Sv(p.color[0],p.position,q.color[0],
q.position,e)),k.push(ba.Sv(p.color[1],p.position,q.color[1],q.position,e)),k.push(ba.Sv(p.color[2],p.position,q.color[2],q.position,e)),k.push(ba.Sv(p.color[3],p.position,q.color[3],q.position,e)))}h&&!g&&c.push.apply(c,h.color);g&&!h&&c.push.apply(c,g.color)}}function t(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?b-a[f].position:b-a[f][1][0];0<=e&&(d?e<=(c?b-d.position:b-a[f][1][0])&&(d=a[f]):d=a[f])}return d}function da(a,b,c){for(var d=null,f=0;f<a.length;f++){var e=c?a[f].position-b:a[f][1][0]-
b;0<=e&&(d?e<=(c?d.position-b:d[1][0]-b)&&(d=a[f]):d=a[f])}return d}function G(a){0<a.ok&&--a.ok;0>=a.ok&&(a.sb&&N.deleteTexture(a.sb),a=ha.indexOf(a),-1!=a&&ha.splice(a,1))}function F(a){a.ok+=1}function U(a,b){for(var c=0;c<ha.length;c++){var d=ha[c];if(d.Br==a&&d.type==b.type&&d.repeat==b.repeat&&d.anisotropic_filtering==b.anisotropic_filtering&&d.Xk==b.Xk)return d}return null}var R=l("__compat"),Z=l("__config"),u=l("__texcomp"),ga=l("__debug"),ca=l("__extensions"),E=l("__print"),aa=l("__time"),
ia=l("__util"),q=l("__renderer"),T=l("__obj_util"),ba=l("__curve"),S=l("__vec3"),sa=l("__scenes"),oa=Z.B,Y=Z.Gi,na=Z.X,ya=null,wa=null,la=null;a.ve=0;a.K=0;a.TP=0;a.RP=0;a.SP=0;a.QP=0;a.Ah=10;a.Ot=20;a.Rp=30;a.Sp=40;a.nl=50;a.Mt=60;a.Kt=70;a.Nt=80;a.Lt=90;a.BE=128;a.RN=128;a.cF=128;var ha=[],ta={},ma={},N=null,ea;a.Nf=function(b){ea=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.ve=b.NEAREST;a.K=b.LINEAR;a.TP=b.NEAREST_MIPMAP_NEAREST;a.RP=b.LINEAR_MIPMAP_NEAREST;
a.SP=b.NEAREST_MIPMAP_LINEAR;a.QP=b.LINEAR_MIPMAP_LINEAR;N=b};a.x4=function(a,b){return b in ta&&a in ta[b]?ta[b][a].Xf:null};a.O9=function(a,b){return b in ta&&a in ta[b]?(r(ta[b][a]),!0):!1};a.JF=e;a.Kl=y;a.bH=function(b){var c=N.createTexture(),d=N.TEXTURE_CUBE_MAP;N.bindTexture(d,c);N.texParameteri(d,N.TEXTURE_MAG_FILTER,N.LINEAR);N.texParameteri(d,N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(d,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE);N.texParameteri(d,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
e=0;6>e;e++)N.texImage2D(N[f[e]],0,N.RGBA,b,b,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(d,null);d=n();d.type=a.Ah;d.source="NONE";d.width=3*b;d.height=2*b;d.Iq=1;d.sb=c;d.nb=N.TEXTURE_CUBE_MAP;return d};a.fD=function(a,b,c){if(!D(a)){var d=a.nb;N.bindTexture(d,a.sb);b&&N.texParameteri(d,N.TEXTURE_MIN_FILTER,b);c&&N.texParameteri(d,N.TEXTURE_MAG_FILTER,c);N.bindTexture(d,null)}};a.O4=function(b){if(D(b))return{min:a.ve,HW:a.ve};var c=b.nb;N.bindTexture(c,b.sb);b=N.getTexParameter(c,N.TEXTURE_MIN_FILTER);
var d=N.getTexParameter(c,N.TEXTURE_MAG_FILTER);N.bindTexture(c,null);return{min:b,HW:d}};a.resize=function(b,c,d){c=Math.max(c,oa.br?2:1);d=Math.max(d,oa.br?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.Mt:N.bindRenderbuffer(N.RENDERBUFFER,b.Ne);N.renderbufferStorage(N.RENDERBUFFER,N.RGB565,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.Kt:N.bindRenderbuffer(N.RENDERBUFFER,b.Ne);N.renderbufferStorage(N.RENDERBUFFER,N.DEPTH_COMPONENT16,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);
break;case a.Nt:N.bindRenderbuffer(N.RENDERBUFFER,b.Ne);N.renderbufferStorageMultisample(N.RENDERBUFFER,oa.Fc,N.RGBA8,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);break;case a.Lt:N.bindRenderbuffer(N.RENDERBUFFER,b.Ne);N.renderbufferStorageMultisample(N.RENDERBUFFER,oa.Fc,N.DEPTH_COMPONENT24,c,d);N.bindRenderbuffer(N.RENDERBUFFER,null);break;default:var f=b.nb;N.bindTexture(f,b.sb);var e=O(b),g=J(b),h=K(b);N.texImage2D(f,0,g,c,d,0,e,h,null);N.bindTexture(f,null)}c>Y.Ec||d>Y.Ec?ia.q('Slink texture "'+
b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+Y.Ec+"x"+Y.Ec+"."):(b.width=c,b.height=d)}};a.lT=function(b,c,d,f,g){var h=b.type,k=b.image,q=n();q.Gz=b.uuid;q.type=a.Ah;q.width=1;q.height=1;var p=b.b4w_anisotropic_filtering;"DEFAULT"===p&&(p=c);"OFF"!==p&&oa.anisotropic_filtering&&ca.kI()&&(p=parseFloat(p.split("x")[0]),q.anisotropic_filtering=p);if("REPEAT"!=b.extension||b.b4w_shore_dist_map)q.repeat=!1;if(k&&("IMAGE"==h&&"MOVIE"==k.source&&(q.tm=!0,q.Fx=b.name,q.va=b.frame_start,
q.Tb=b.frame_offset,q.Yj=b.frame_duration,q.hE=b.use_auto_refresh,q.vj=b.use_cyclic,q.kk=b.movie_length,q.Xk=b.b4w_nla_video,0!=q.Tb&&E.warn('Frame offset for texture "'+b.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')),c=ia.gj(g+k.filepath),c=U(c,q))){b.s=c;return}c=new Uint8Array([204,204,204,255]);switch(h){case "IMAGE":var p=N.createTexture(),l=N.TEXTURE_2D;N.bindTexture(l,p);N.texImage2D(l,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,c);break;case "NONE":p=N.createTexture();
l=N.TEXTURE_2D;N.bindTexture(l,p);if("NONE"==b.b4w_source_type)return;if("SCENE"==b.b4w_source_type)if(b.b4w_source_id&&(d=ia.Dd("name",b.b4w_source_id,d)))q.nj=b.b4w_source_size,d.Vf=d.Vf||[],d.Vf.push(q),F(q),N.texImage2D(l,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,c);else return;break;case "ENVIRONMENT_MAP":p=N.createTexture();l=N.TEXTURE_CUBE_MAP;N.bindTexture(l,p);d="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var m=0;6>m;m++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+
d[m]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,c);break;case "BLEND":return;default:E.error('texture "'+b.name+'" has unsupported type "'+h+'"');return}q.sb=p;q.nb=l;q.anisotropic_filtering&&N.texParameterf(q.nb,ca.kI().TEXTURE_MAX_ANISOTROPY_EXT,q.anisotropic_filtering);"NONE"==h&&(!b.b4w_enable_canvas_mipmapping||"CANVAS"!=b.b4w_source_type)||"IMAGE"==h&&"MOVIE"==k.source?N.texParameteri(l,N.TEXTURE_MIN_FILTER,N.LINEAR):N.texParameteri(l,N.TEXTURE_MIN_FILTER,ea[oa.bp]);N.texParameteri(l,N.TEXTURE_MAG_FILTER,
N.LINEAR);"CANVAS"==b.b4w_source_type&&"NONE"==h?(h=b.b4w_source_id,d=b.b4w_source_size,q.Sl=b.b4w_enable_canvas_mipmapping,q.Hs=h,q.source="CANVAS",c=document.createElement("canvas"),c.width=d,c.height=d,q.Xf=c.getContext("2d"),f in ta||(ta[f]={}),ta[f][h]=q,r(q)):"SCENE"==b.b4w_source_type&&"NONE"==h?(q.Hs=b.b4w_source_id,q.source="SCENE"):(q.source=h,N.generateMipmap(l),N.bindTexture(l,null));k&&e(q,k,g);b.s=q};a.jN=A;a.iN=h;a.Rs=v;a.tR=C;a.fo=function(a){return a&&(a.sb||a.Ne)?!0:!1};a.eo=D;a.H6=
function(b){return b.type==a.Rp||b.type==a.Sp?!0:!1};a.rV=function(b){var c=0;switch(b.type){case a.Ah:case a.Ot:c=4;break;case a.Rp:case a.Sp:c=16;break;case a.nl:c=3;break;case a.Mt:case a.Kt:c=2;break;case a.Nt:c=4*oa.Fc;break;case a.Lt:c=3*oa.Fc}return c};a.ua=function(){if(!oa.zs)for(var a in ma)for(var b in ma[a])ma[a][b].Ta.pause(),ma[a][b].Ta.src="",ma[a][b].Ta.load();ha.length=0;ta={};ma={}};a.pause=function(){for(var a in ma)for(var b in ma[a]){var c=ma[a][b];z(c)&&L(c)}};a.reset=function(){for(var a in ma)for(var b in ma[a])H(ma[a][b])};
a.play=function(a){for(var b in ma)for(var c in ma[b]){var d=ma[b][c];a&&!d.bt||Q(d)}};a.Y5=function(a,b){return b in ma&&a in ma[b]?ma[b][a]:null};a.W9=function(a){return a.Xk};a.JK=Q;a.yC=L;a.gL=H;a.qY=function(a,b){if(void 0 in ma&&a in ma[void 0]){var c=ma[void 0][a];c.Ta?c.Ta.currentTime=b/c.Vg:c.td&&(c.lj=b,h(c))}};a.FN=z;a.GN=function(a){return a.Ta||a.td?a.Ta?2<=a.Ta.readyState:!0:0};a.CN=function(a){return a.Ta||a.td?a.Ta?Math.round(a.Ta.currentTime*a.Vg):a.lj:0};a.EN=function(a){return a.Ta||
a.td?a.Ta?a.Tb:d(a,a.Tb):0};a.R_=function(a){if(!a.Ta&&!a.td)return 0;var b=Math.min(a.Yj,a.kk-a.Tb);return a.Ta?a.Tb+b:d(a,a.Tb+b)};a.Ow=function(a,b){return Math.round(b*a.xs*(aa.rd()/a.Vg))};a.DN=function(a){return Math.min(a.Yj,a.kk-a.Tb)};a.Q_=d;a.y4=function(a,b){var c=p(a,b);return c&&"CANVAS"==c.source?c.Xf:null};a.P9=function(a,b){var c=p(a,b);return c&&"CANVAS"==c.source?(r(c),!0):!1};a.L5=p;a.M5=function(a){var b=[];if(T.Sa(a))g(a,b);else{a=a.aw;for(var c=0;c<a.length;c++)g(a[c],b)}return b};
a.WY=function(a){for(var b={},c=0;c<a.length;c++){for(var d=a[c].ya,f=a[c].Ld,e=[],g=[],h=0;h<d.length;h++){var k=d[h],q=f[h];if("CANVAS"==k.source)if(q in b)k=b[q];else{var p=d[h],k=n();k.source="CANVAS";k.width=p.width;k.height=p.height;k.Sl=p.Sl;k.type=p.type;p=document.createElement("canvas");p.width=k.width;p.height=k.height;k.Xf=p.getContext("2d");k.nb=N.TEXTURE_2D;k.sb=N.createTexture();N.bindTexture(N.TEXTURE_2D,k.sb);k.Sl?N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,ea[oa.bp]):N.texParameteri(N.TEXTURE_2D,
N.TEXTURE_MIN_FILTER,N.LINEAR);N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR);N.bindTexture(N.TEXTURE_2D,null);p=k;p.Xf.drawImage(d[h].Xf.canvas,0,0);r(p);b[q]=k}e.push(k);g.push(q)}a[c].ya=e}};a.ZT=function(a,b){for(var c=[],d=0;d<a.length;d++)P(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return ia.U(255*a,0,255)}))};a.oR=P;a.cU=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),f=[],e=0;e<a.length;e++){for(var g=a[e].data.value,h=[],k=g.curve_mapping.curves_data,
q=g.curve_mapping.curve_extend,p=g.curve_mapping.curves_handle_types,g=0;g<k.length;g++){for(var l=q[g],m=k[g],n=[],u=p[g],r=0;r<m.length;r++)n.push([new Float32Array(3),new Float32Array(m[r].concat(0)),new Float32Array(3)]);ba.Lz(n[0],null,n[1],u[0],u[0]);for(r=1;r<n.length-1;r++)ba.Lz(n[r],n[r-1],n[r+1],u[r],u[r]);ba.Lz(n[n.length-1],n[n.length-2],null,u[n.length-1],u[n.length-1]);if(2<n.length){if("AUTO"==u[0]){S.subtract(n[0][2],n[0][1],c);r=S.length(c);S.copy(n[1][0],d);d[0]<n[0][1][0]&&(d[0]=
n[0][1][0]);S.subtract(d,n[0][1],d);var w=S.length(d);1E-8<w&&(S.scale(d,r/w,d),S.add(n[0][1],d,n[0][2]),S.subtract(n[0][1],d,n[0][0]))}m=n.length-1;"AUTO"==u[0]&&(S.subtract(n[m][0],n[m][1],c),r=S.length(c),S.copy(n[m-1][2],d),d[0]>n[m][1][0]&&(d[0]=n[m][1][0]),S.subtract(d,n[m][1],d),w=S.length(d),1E-8<w&&(S.scale(d,r/w,d),S.add(n[m][1],d,n[m][0]),S.subtract(n[m][1],d,n[m][2])))}for(m=0;m<n.length-1;m++)ba.iS(n[m][1],n[m][2],n[m+1][0],n[m+1][1]);m=[];3>=k.length?(r=Math.round(-b/2),u=Math.round(b/
2)):(r=0,u=b);for(;r<u;r++){var w=r/(u-1),M=t(n,w,!1),x=da(n,w,!1);M&&x?m.push(ba.eG(w,M[1],M[2],x[0],x[1],.001)):x&&!M?"EXTRAPOLATED"==l?(w=x[1][0]==x[2][0]?x[1][1]:ba.XJ(w,x[1],x[2]),m.push(w)):m.push(x[1][1]):M&&!x&&("EXTRAPOLATED"==l?(w=M[0][0]==M[1][0]?M[1][1]:ba.XJ(w,M[0],M[1]),m.push(w)):m.push(M[1][1]))}h.push(m)}f.push(h)}c=[];for(r=0;r<f.length;r++)for(h=f[r],g=0;g<h[0].length;g++)3>=h.length?(d=ia.U(127.5*(h[0][g]+1),0,255),e=ia.U(127.5*(h[1][g]+1),0,255),k=ia.U(127.5*(h[2][g]+1),0,255),
m=255):(d=ia.U(255*h[0][g],0,255),e=ia.U(255*h[1][g],0,255),k=ia.U(255*h[2][g],0,255),m=ia.U(255*h[3][g],0,255)),c.push(d,e,k,m);return new Uint8Array(c)};a.aH=function(b,c){var d=y(a.Ah,!1);d.source="NODE_TEX";d.repeat=!1;v(d,{width:c,height:b.length/(4*c),data:b});return d};a.J2=function(a,c,d,f,e){var g=ia.gj(e);if("WORLD"!=a.type){var h=U(g,c);if(!h){h=n();h.type=c.type;h.source=c.source;h.Hs=c.Hs;h.width=c.width;h.height=c.height;h.Iq=c.Iq;h.nj=c.nj;h.Sl=c.Sl;h.Xf=c.Xf;h.nb=c.nb;h.sb=c.sb;h.Ne=
c.Ne;h.tm=c.tm;h.et=c.et;h.Ta=c.Ta;h.Fx=c.Fx;h.kk=c.kk;h.Vg=c.Vg;h.va=c.va;h.Tb=c.Tb;h.Yj=c.Yj;h.lg=c.lg;h.nh=c.nh;h.td=c.td;h.ys=c.ys;h.xs=c.xs;h.lj=c.lj;h.As=c.As;h.Fk=c.Fk;h.bt=c.bt;h.hE=c.hE;h.vj=c.vj;h.Xk=c.Xk;h.repeat=c.repeat;h.Yn=c.Yn;h.Br=c.Br;h.Zn=c.Zn;h.wB=c.wB;h.vB=c.vB;h.Bv=c.Bv;h.lm=c.lm;var k=h;N.bindTexture(c.nb,c.sb);var q=N.getTexParameter(c.nb,N.TEXTURE_MAG_FILTER),p=N.getTexParameter(c.nb,N.TEXTURE_MIN_FILTER),l=N.getTexParameter(c.nb,N.TEXTURE_WRAP_S);c=N.getTexParameter(c.nb,
N.TEXTURE_WRAP_T);k.sb=N.createTexture();N.bindTexture(k.nb,k.sb);N.texParameteri(k.nb,N.TEXTURE_MAG_FILTER,q);N.texParameteri(k.nb,N.TEXTURE_MIN_FILTER,p);N.texParameteri(k.nb,N.TEXTURE_WRAP_S,l);N.texParameteri(k.nb,N.TEXTURE_WRAP_T,c);N.bindTexture(k.nb,null);b(h,e,g);ha.push(h);v(h,f,0)}f=h;if(T.Sa(a))x(a,d,f);else for(a=a.aw,e=0;e<a.length;e++)x(a[e],d,f)}else h=c,b(h,e),v(h,f,0),sa.y_(a)};a.OC=G;a.Cv=F;a.he=function(a){return a.texture.s};a.UX=function(){N=null};a.CI=function(){return ha}};b4w.module.__texcomp=function(a,l){function n(a,b,e,c){var l=new Int32Array(e,0,31),n,A,K,D,Q,L;if(542327876!=l[0])return r.error("Invalid magic number in DDS header"),0;if(!l[20]&4)return r.error("Unsupported format, must contain a FourCC code"),0;n=l[21];switch(n){case h:A=8;K=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case w:A=16;K=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case m:A=16;K=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return r.error("Unsupported FourCC code:",y(n)),null}L=
1;l[2]&131072&&!1!==c&&(L=Math.max(1,l[7]));D=l[4];Q=l[3];l=l[1]+4;if(b)for(n=0;n<L;++n)c=Math.max(4,D)/4*Math.max(4,Q)/4*A,b=new Uint8Array(e,l,c),a.compressedTexImage2D(a.TEXTURE_2D,n,K,D,Q,0,b),l+=c,D=Math.max(.5*D,1),Q=Math.max(.5*Q,1);else if(n==h){Math.max(4,D);Math.max(4,Q);e=b=new Uint16Array(e);A=l/2;K=D;var H=Q,l=new Uint16Array(4);b=new Uint16Array(K*H);for(var z=0,d=0,p=d=z=n=0,M=0,x=0,g=0,P=K/4,H=H/4,t=0;t<H;t++)for(var da=0;da<P;da++)n=A+4*(t*P+da),l[0]=e[n],l[1]=e[n+1],z=l[0]&31,d=
l[0]&2016,p=l[0]&63488,M=l[1]&31,x=l[1]&2016,g=l[1]&63488,l[2]=5*z+3*M>>3|5*d+3*x>>3&2016|5*p+3*g>>3&63488,l[3]=5*M+3*z>>3|5*x+3*d>>3&2016|5*g+3*p>>3&63488,z=e[n+2],d=4*t*K+4*da,b[d]=l[z&3],b[d+1]=l[z>>2&3],b[d+2]=l[z>>4&3],b[d+3]=l[z>>6&3],d+=K,b[d]=l[z>>8&3],b[d+1]=l[z>>10&3],b[d+2]=l[z>>12&3],b[d+3]=l[z>>14],z=e[n+3],d+=K,b[d]=l[z&3],b[d+1]=l[z>>2&3],b[d+2]=l[z>>4&3],b[d+3]=l[z>>6&3],d+=K,b[d]=l[z>>8&3],b[d+1]=l[z>>10&3],b[d+2]=l[z>>12&3],b[d+3]=l[z>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,D,Q,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);c&&a.generateMipmap(a.TEXTURE_2D)}else return r.error("No manual decoder for",y(n),"and no native support"),0;return L}function e(a,b,e,c,h){var l=new XMLHttpRequest;l.open("GET",e,!0);l.responseType="arraybuffer";l.onload=function(){if(200==l.status){a.bindTexture(a.TEXTURE_2D,c);var e=n(a,b,l.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<e?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}h&&h(c)};l.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function y(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var r=l("__print"),A=l("__util"),h=b("DXT1"),w=b("DXT3"),m=b("DXT5");a.C_=n;a.D_=function(a,b,e){var c=new Uint32Array(e,0,13);if(55727696==c[0]){var h=c[7],l=c[6],m=c[11],n=52+c[12];switch(c[2]){case 0:var r=2,w=1;break;case 1:r=2;w=3;break;case 2:r=4;w=0;break;case 3:r=4;w=2;break;default:A.q("Unsupported PVR V3 format.")}}else if(559044176==
c[11]){h=c[2];l=c[1];m=c[3];n=c[0];m++;var y=c[4]&255,c=0<c[10];25==y?(r=4,w=c?2:0):24==y?(r=2,w=c?3:1):A.q("Unsupported PVR V2 format.")}else A.q("Unsupported PVR version.");y=2==r?8:4;c=4;switch(w){case 0:var H=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:H=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:H=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:H=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=y*c*r/8;for(r=0;r<m;r++){var w=Math.max(h>>r,1),z=Math.max(l>>r,1),d=w/y,p=z/c;2>d&&(d=2);2>p&&(p=2);d=
d*p*b;p=new Uint8Array(e,n,d);a.compressedTexImage2D(a.TEXTURE_2D,r,H,w,z,0,p);n+=d}};a.iJ=function(a,b){switch(b){case "dds":var e=new Int32Array(a,0,31);return{width:e[4],height:e[3]};case "pvr":e=new Uint32Array(a,0,13);if(55727696==e[0])var c=e[7],e=e[6];else c=e[2],e=e[1];return{width:c,height:e}}};a.RU=function(a,b){var e=1;if("dds"==b){var c=new Int32Array(a,0,31),l=c[21];switch(l){case h:e=6;break;case w:case m:e=4;break;default:r.error("Unsupported FourCC code:",y(l))}}else if("pvr"==b)if(c=
new Uint32Array(a,0,13),55727696==c[0])switch(c[2]){case 0:e=12;break;case 1:e=16;break;case 2:e=6;break;case 3:e=8}else l=c[4]&255,c=0<c[10],25==l?e=c?8:6:24==l&&(e=c?16:12);return e};a.Y6=function(a,b,h,c){var l=a.createTexture();e(a,b,h,l,c);return l}};b4w.module.__curve=function(a,l){function n(a,b,e,f,h){var c=f.length;h||(h=new Float32Array(c));for(var l=c+a,n=new Float32Array(l),r=1;r<=l-1;r++)n[r-1]=b>=e[r-1]&&b<e[r+1-1]?1:0;for(var y=2;y<=a;y++)for(r=1;r<=l-y;r++)n[r-1]=(0!=n[r-1]?(b-e[r-1])*n[r-1]/(e[r+y-1-1]-e[r-1]):0)+(0!=n[r+1-1]?(e[r+y-1]-b)*n[r+1-1]/(e[r+y-1]-e[r+1-1]):0);b==e[l-1]&&(n[c-1]=1);a=0;for(r=1;r<=c;r++)a+=n[r-1]*f[r-1];for(r=1;r<=c;r++)h[r-1]=0!=a?n[r-1]*f[r-1]/a:0;return h}function e(a){a=a.Qv;return a[a.length-1]}function b(a){a=
a.sH;return a[a.length-1]}function y(a,b,e,f,h,c,l,n){var A=a+(b-a)/2,K=r(A,f,h,c,l)-e;n=n?n:.01;return Math.abs(K)<n?A:0<K?y(a,A,e,f,h,c,l,n):y(A,b,e,f,h,c,l,n)}function r(a,b,e,f,h){var c=1-a;return b*c*c*c+3*e*c*c*a+3*f*c*a*a+h*a*a*a}l("__print");var A=l("__util"),h=l("__vec3");a.MS=function(a){var b={},e=a.data;a=e.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var f=a.order_u;b.qk=f;a=a.points;var h=a.length/5,c=[],l=h+f,h=h+2;c[0]=0;for(var r=2;r<=l;r++)c[r-1]=r>f&&r<h?c[r-
2]+1:c[r-2];b.Qv=c;"2D"==e.dimensions?b.ek=!1:"3D"==e.dimensions?b.ek=!0:A.q("Wrong curve dimensions");f=[];c=[];for(e=0;e<a.length;e+=5)f.push(a[e]),f.push(a[e+1]),f.push(a[e+2]),b.ek&&f.push(a[e+3]),c.push(a[e+4]);b.fA=f;b.sE=c;a=[];for(var e=b.fA,f=b.ek?4:3,c=b.sE,l=b.Qv,h=b.qk,r=e.length/f,y=r+h,K=0,D=l[y-1]/999,Q=0;1E3>Q;Q++){5E-6>l[y-1]-K&&(K=l[y-1]);for(var L=n(h,K,l,c),H=0;H<f;H++)for(var z=a[f*Q+H]=0;z<r;z++)a[f*Q+H]+=L[z]*e[f*z+H];K+=D}f=b.ek?4:3;c=new Float32Array(1E3);c[0]=0;for(e=1;1E3>
e;e+=1)l=a[(e-1)*f],h=a[(e-1)*f+1],r=a[(e-1)*f+2],y=a[e*f],K=a[e*f+1],D=a[e*f+2],c[e]=c[e-1]+Math.sqrt((y-l)*(y-l)+(K-h)*(K-h)+(D-r)*(D-r));b.sH=c;return b};a.nZ=function(a,b,h){h||(h=[]);var f=b,l=Math.max(f,0);b=l=Math.min(f,e(a));var f=a.fA,l=a.ek?4:3,c=a.sE,r=a.Qv,y=a.qk;a=f.length/l;var A=a+y;5E-6>r[A-1]-b&&(b=r[A-1]);A=new Float32Array(a);n(y,b,r,c,A);for(b=0;b<l;b++)for(c=h[b]=0;c<a;c++)h[b]+=A[c]*f[l*c+b]};a.kZ=function(a,b,e){e||(e=[]);var f=a.fA,h=a.ek?4:3,c=a.sE,l=a.Qv,n=a.qk;a=f.length/
h;var r=a+n;5E-6>l[r-1]-b&&(b=l[r-1]);var r=new Float32Array(a),y=b;b=r;var A=c.length;b||(b=new Float32Array(A));var Q=new Float32Array(A),L=new Float32Array(A),H=Q,z=L;H||(H=new Float32Array(A));z||(z=new Float32Array(A));for(var d=A+n,p=new Float32Array(d),M=new Float32Array(d),x=1;x<=d-1;x++)p[x-1]=y>=l[x-1]&&y<l[x+1-1]?1:0;y==l[d-1]&&(p[A-1]=1);for(var g=2;g<=n;g++)for(x=1;x<=d-g;x++){var P=0!=p[x-1]?p[x-1]/(l[x+g-1-1]-l[x-1]):0,t=0!=p[x+1-1]?-p[x+1-1]/(l[x+g-1]-l[x+1-1]):0,da=0!=M[x-1]?(y-l[x-
1])*M[x-1]/(l[x+g-1-1]-l[x-1]):0,G=0!=M[x+1-1]?(l[x+g-1]-y)*M[x+1-1]/(l[x+g-1]-l[x+1-1]):0;p[x-1]=(0!=p[x-1]?(y-l[x-1])*p[x-1]/(l[x+g-1-1]-l[x-1]):0)+(0!=p[x+1-1]?(l[x+g-1]-y)*p[x+1-1]/(l[x+g-1]-l[x+1-1]):0);M[x-1]=P+t+da+G}for(x=1;x<=A;x++)H[x-1]=p[x-1],z[x-1]=M[x-1];l=0;for(n=1;n<=A;n++)l+=Q[n-1]*c[n-1];y=0;for(n=1;n<=A;n++)y+=L[n-1]*c[n-1];for(n=1;n<=A;n++)b[n-1]=0!=l?L[n-1]*c[n-1]/l+Q[n-1]*c[n-1]*y/(l*l):0;for(c=0;c<h;c++)for(l=e[c]=0;l<a;l++)e[c]+=r[l]*f[h*l+c]};a.g9=e;a.mZ=b;a.lZ=function(a,
h){if(0>=h)return 0;var k=e(a);if(h>=b(a))return k;var f=a.sH,l=A.bu(f,h,0,f.length-1);return k*(l+(h-f[l])/(f[l+1]-f[l]))/1E3};a.Sv=function(a,b,e,f,h){return e+(h-f)*(a-e)/(b-f)};a.XJ=function(a,b,e){var f=b[0];b=b[1];e=(e[1]-b)/(e[0]-f);return e*a+(b-e*f)};a.eG=function(a,b,e,f,h,c){return r(y(0,1,a,b[0],e[0],f[0],h[0],c),b[1],e[1],f[1],h[1])};a.Lz=function(a,b,e,f,l){var c=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(3),D=new Float32Array(3);
h.copy(a[1],n);null==b?(h.copy(e[1],r),c[0]=2*n[0]-r[0],c[1]=2*n[1]-r[1]):h.copy(b[1],c);null==e?(h.copy(b[1],c),r[0]=2*n[0]-c[0],r[1]=2*n[1]-c[1]):h.copy(e[1],r);h.subtract(n,c,y);h.subtract(r,n,A);b=h.length(y);e=h.length(A);0==b&&(b=1);0==e&&(e=1);if("AUTO"==f||"AUTO"==l)D[0]=A[0]/e+y[0]/b,D[1]=A[1]/e+y[1]/b,c=2.5614*h.length(D),0!=c&&("AUTO"==f&&h.scaleAndAdd(n,D,-(b/c),a[0]),"AUTO"==l&&h.scaleAndAdd(n,D,e/c,a[2]));"VECTOR"==f&&h.scaleAndAdd(n,y,-1/3,a[0]);"VECTOR"==l&&h.scaleAndAdd(n,A,1/3,a[2])};
a.iS=function(a,b,e,f){var h=[],c=[],l,n,r;h[0]=a[0]-b[0];h[1]=a[1]-b[1];c[0]=f[0]-e[0];c[1]=f[1]-e[1];r=f[0]-a[0];l=Math.abs(h[0]);n=Math.abs(c[0]);0!=l+n&&l+n>r&&(l=r/(l+n),b[0]=a[0]-l*h[0],b[1]=a[1]-l*h[1],e[0]=f[0]-l*c[0],e[1]=f[1]-l*c[1])}};b4w.module.__shaders=function(a,l){function n(a,b,c){var d=a.Mi;"string"==typeof c?(a=e(a,c))&&(c=a[1]):c=String(c);for(a=0;a<d.length;a++)if(d[a][0]==b){d[a][1]=c;break}}function e(a,b){for(var c=a.Mi,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var d=a+b;if(!(d in U)){var f=c(t.shaders_path,a),e=c(t.shaders_path,b),f=O(f),e=O(e),g;for(g in e)f[g]=e[g];e=[];for(g in f)e.push([g,f[g]]);U[d]=e}return U[d]}function y(a,b){return a+b}function r(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(y,0)}function A(a,b){var c=v(a.type),d=v(b.type),f=a.ul,e=b.ul;return c>d?-1:c<d?1:f>e?-1:f<e?1:0}function h(a){if(g.ec){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ga}else b=ca;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],ul:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return m(a,aa,P.Zv)}function w(a,b,c){a=a.split(";").map(function(a){return(a=a.match(u))&&{type:a[2],ul:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return m(a,b,c)}function m(a,b,c){function d(){for(var c=0;l<a.length;){var e=a[l];if(3!=v(e.type))break;c+=f(e.type)*e.ul;l++}q=p+c;if(q>ba)return!1;k(b,p,c,0,3);return!0}function e(){for(var c=ba-q,d=c,g=c;l<a.length;){var h=a[l];if(2!=v(h.type))break;h=f(h.type)*h.ul;if(h<=d)d-=h;else if(h<=g)g-=h;else return!1;l++}g=c-g;k(b,q,c-d,0,2);k(b,ba-g,g,2,2);return!0}function g(){for(;l<a.length;){for(var d=a[l],d=f(d.type)*d.ul,e=-1,h=c+1,q=-1,p=0;4>p;p++){var m=E;
m[0]=0;m[1]=1;var n;n=b;for(var t=p,r=d,u=m;T<n.length&&15===n[T];)T++;for(;0<ba&&15===n[ba];)ba--;if(ba-T<r)n=!1;else{for(var t=1<<t,M=0,x=-1,w=n.length+1,z=!1,v=T;v<=ba;v++)v<ba&&!(n[v]&t)?z||(M=v,z=!0):(z&&(z=v-M,z>=r&&z<w&&(w=z,x=M)),z=!1);0>x?n=!1:(u[0]=x,u[1]=w,n=!0)}n&&m[1]<h&&(q=m[0],h=m[1],e=p)}if(0>e)return!1;k(b,q,d,e,1);l++}return!0}if(!a.length)return!0;for(var h=0;h<c;h++)b[h]=0;ba=c;a.sort(A);var q=0,p=0,l=0;return function(){for(;l<a.length;){var c=a[l];if(4!=v(c.type))break;p+=f(c.type)*
c.ul;l++}if(p>ba)return!1;T=p;k(b,0,p,0,4);return!0}()&&d()&&e()&&g()}function k(a,b,c,d,f){for(var e=0,g=0;g<f;g++)e|=1<<d+g;for(g=0;g<c;g++)a[b+g]|=e}function f(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function v(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}
function c(a,b){var c=a+b;if(G[c])return G[c];if(F){var d=F[b];if(!d)return null;d=l("__gpp_parser").w7.parse(d)}else if(d=l("shader_texts")[b],!d)return null;return G[c]=d}function C(a,b){for(var c={},d=b.Mi||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.og.length;f++)c["USE_NODE_"+b.og[f].id]=["1"];g.ec?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=g.Gq?["sampler2DShadow"]:["sampler2D"];for(var e in c)c[e][0].constructor!=String&&M.warn("Warning! The value of a directive '"+e+"' is not of type string.");return c}
function O(a){function b(a){"var"==a.a?f[a.c]=a.b.join(""):"include"==a.a&&(a=c(t.shaders_path,t.aM+a.o),d(a,b))}function d(a,b,c){if(a instanceof Array)for(var f=0;f<a.length;f++)d(a[f],b,c);else if(a instanceof Object&&a){b&&b(a);for(f in a)d(a[f],b,c);c&&c(a)}}var f={};d(a,b);return f}function J(a,b,d){function f(b){b=b.d;for(var d=0;d<b.length;d++){var g=b[d];switch(g.a){case "cond":a:for(var g=g.d,l=0;l<g.length;l++){var z=g[l];switch(z.a){case "if":case "elif":if(e(z.g)){f(z.h);break a}break;
case "else":f(z.h);break a;case "ifdef":z.c in r&&f(z.h);break;case "ifndef":z.c in r||f(z.h)}}break;case "include":g=g.o;l=c(t.shaders_path,t.aM+g);w.push("include/"+g);f(l);w.pop();break;case "var":break;case "define":r[g.c]=g.b;break;case "error":x.q("Shader error: #error "+g.b.join(" "));break;case "line":break;case "pragma":n.push("#pragma "+g.c+" "+g.b.join(" "));break;case "undef":delete r[g.c];break;case "warning":M.warn("Shader warning: #warning "+g.b.join(" "));break;case "extension":g=
p(g.b,r,u,!1);n.push("#extension "+g.join(" "));break;case "version":g=p(g.b,r,u,!1),n.push("#version "+g.join(" "));case "#":break;case "node":v[g.c]=g;break;case "nodes_global":g=m;for(l=0;l<g.length;l++){var z=g[l],F=v[z.id];if(F)for(var C=0,S=0;S<F.l.length;S++){var T=F.l[S];if("node_param"==T.a){var A;if("PARTICLE_INFO"==z.id&&T.e)if(1==r.PARTICLE_BATCH)switch(A=!1,C){case 0:A=H(z.Rb,"PART_INFO_IND")||H(z.Rb,"PART_INFO_AGE")||H(z.Rb,"PART_INFO_LT")||H(z.Rb,"PART_INFO_SIZE");break;case 1:A=H(z.Rb,
"PART_INFO_LOC");break;case 2:A=H(z.Rb,"PART_INFO_VEL");break;case 3:A=H(z.Rb,"PART_INFO_A_VEL");break;case 4:A=H(z.Rb,"PART_INFO_IND")}else A=!1;else A=!0;A&&(T=T.f.join(" ")+" ","vert"==a?T+=z.qi[C]:"frag"==a&&(T+=z.rb[C],null!==z.tw[C]&&(T+="="+z.tw[C])),T+=";",q(k(T)));C++}}}break;case "nodes_main":g=m;for(l=0;l<g.length;l++)if(z=g[l],F=v[z.id]){C={};G=y=P=0;S=F;T=z;A=S;for(var D={},L=0;L<A.m.length;L++){var U=A.m[L];D[U.c]=[U.b.join("")]}A=D;for(D=0;D<T.Rb.length;D++)L=T.Rb[D][0],L in A&&(A[L]=
[T.Rb[D][1]]);for(D=L=0;D<S.l.length;D++)U=S.l[D],"node_out"==U.a&&(A["USE_OUT_"+U.c]=[-1<E.indexOf(T.gb[L])|0],L++);S=A;T=z;A=F.l;D=C;L=S;for(U=0;U<A.length;U++){var R=A[U];switch(R.a){case "node_in":var ba=T.L[P];if(null!==T.zB[P]){if(("MATERIAL_BEGIN"==T.id&&3===P||!L.MATERIAL_EXT&&("MATERIAL_BEGIN"==T.id&&4===P||"MATERIAL_END"==T.id&&3===P||"MATERIAL_END"==T.id&&4===P||"MATERIAL_END"==T.id&&5===P)||"TEXTURE_COLOR"==T.id||"TEXTURE_NORMAL"==T.id)&&R.e){D[R.c]=T.zB[P];P++;continue}var J=R.f.join(" ")+
" ",J=J+(ba+"="+T.zB[P]+";");q(k(J))}D[R.c]=ba;P++;break;case "node_out":ba=T.gb[y];if(!R.e||-1<E.indexOf(ba))J=R.f.join(" ")+" ",J+=ba+";",q(k(J)),D[R.c]=ba;y++;break;case "node_param":"vert"==a?ba=T.qi[G]:"frag"==a&&(ba=T.rb[G]),D[R.c]=ba,G++}}n.push("{");h(z,F.j,C,S);n.push("}")}break;case "txt":q(g.b);break;default:x.q("Unknown element type: "+g.a)}}}function e(a,b){var c;c=p(a,r,u,!0,b);for(var d=[],f=0;f<c.length;f++)if(c[f]instanceof Object)switch(c[f].a){case "conditional_expr":var g=d.pop(),
h=d.pop();d.pop()?d.push(h):d.push(g);break;case "logical_or_expr":for(var h=d.pop(),k=0;k<c[f].i-1;k++)g=d.pop(),h=h||g;d.push(h);break;case "logical_and_expr":h=d.pop();for(k=0;k<c[f].i-1;k++)g=d.pop(),h=h&&g;d.push(h);break;case "logical_bitor_expr":h=d.pop();for(k=0;k<c[f].i-1;k++)h|=d.pop();d.push(h);break;case "logical_bitxor_expr":h=d.pop();for(k=0;k<c[f].i-1;k++)h^=d.pop();d.push(h);break;case "logical_bitand_expr":h=d.pop();for(k=0;k<c[f].i-1;k++)h&=d.pop();d.push(h);break;case "equal_expr":g=
d.pop();h=d.pop();d.push(h==g);break;case "non_equal_expr":g=d.pop();h=d.pop();d.push(h!=g);break;case "le_expr":g=d.pop();h=d.pop();d.push(h<=g);break;case "ge_expr":g=d.pop();h=d.pop();d.push(h>=g);break;case "l_expr":g=d.pop();h=d.pop();d.push(h<g);break;case "g_expr":g=d.pop();h=d.pop();d.push(h>g);break;case "left_shift_expr":h=d.pop();g=d.pop();d.push(h<<g);break;case "right_shift_expr":h=d.pop();g=d.pop();d.push(h>>g);break;case "add_expr":h=d.pop();g=d.pop();d.push(h+g);break;case "sub_expr":h=
d.pop();g=d.pop();d.push(h-g);break;case "mul_expr":h=d.pop();g=d.pop();d.push(h*g);break;case "div_expr":h=d.pop();g=d.pop();d.push(h/g);break;case "mod_expr":h=d.pop();g=d.pop();d.push(h%g);break;case "pre_inc_expr":case "post_inc_expr":g=d.pop();d.push(++g);break;case "pre_dec_expr":case "post_dec_expr":g=d.pop();d.push(--g);break;case "positive_expr":g=d.pop();d.push(+g);break;case "negative_expr":g=d.pop();d.push(-g);break;case "one_compl_expr":g=d.pop();d.push(~g);break;case "logic_negative_expr":g=
d.pop();d.push(!g);break;default:x.q("Unknown operation type: "+c[f].a)}else g=c[f],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(g)?(d.push(0),0!=g.indexOf("USE_NODE_")&&(h=w[w.length-1],h in z||(z[h]=[]),-1==z[h].indexOf(g)&&(z[h].push(g),M.error("Undefined directive '"+g+"' in shader '"+h+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[f]));1==d.length?c=d[0]:(x.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function h(a,b,c,d){for(var f=0;f<b.length;f++){var g=
b[f];switch(g.a){case "node_cond":a:for(var k=a,g=g.d,p=c,l=d,m=0;m<g.length;m++){var n=g[m];switch(n.a){case "node_if":case "node_elif":if(e(n.g,l)){h(k,n.j,p,l);break a}break;case "node_else":h(k,n.j,p,l);break a;case "node_ifdef":(n.c in r||n.c in l)&&h(k,n.j,p,l);break;case "node_ifndef":n.c in r||n.c in l||h(k,n.j,p,l)}}break;case "txt":k=[];for(p=0;p<g.b.length;p++)l=g.b[p],l in c?k.push(c[l]):k.push(l);q(k,d)}}}function k(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function q(b,c){var d=
b;g.ec||"frag"!=a||(d=d.join(" "),T&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),T=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),T=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=p(b,r,u,!1,c),n.push(d.join(" ")))}function p(a,b,c,d,f){var e=[];l(a,b,c,d,e,f);return e}function l(a,b,c,d,f,e){for(var g=0;g<a.length;g++){var h=a[g];if(e&&h in e)h=e[h];else if(h in b)h=b[h];else{f.push(h);continue}0==
h.length&&d?f.push(0):l(h,b,c,d,f,e)}}var m=d.og,n=[],r=C(a,d),u={},w=[d[a]],z={},v={},E=[],F;for(F in m)for(var S in m[F].L)E.push(m[F].L[S]);var T=!1;f(b);var P=0,y=0,G=0;return n.join("\n")}function K(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function D(a){sa.deleteProgram(a.di);sa.deleteShader(a.Kx);sa.deleteShader(a.Vu);delete da[a.uD]}function Q(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return L(a);case 2:return"vec2("+L(a[0])+","+L(a[1])+")";case 3:return"vec3("+
L(a[0])+","+L(a[1])+","+L(a[2])+")";case 4:return"vec4("+L(a[0])+","+L(a[1])+","+L(a[2])+","+L(a[3])+")";case 9:return"mat3("+L(a[0])+","+L(a[1])+","+L(a[2])+","+L(a[3])+","+L(a[4])+","+L(a[5])+","+L(a[6])+","+L(a[7])+","+L(a[8])+")";case 16:return"mat4("+L(a[0])+","+L(a[1])+","+L(a[2])+","+L(a[3])+","+L(a[4])+","+L(a[5])+","+L(a[6])+","+L(a[7])+","+L(a[8])+","+L(a[9])+","+L(a[10])+","+L(a[11])+","+L(a[12])+","+L(a[13])+","+L(a[14])+","+L(a[15])+")";default:x.q("Wrong glsl value dimension")}}function L(a){return a%
1?String(a):String(a)+".0"}function H(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var z=l("__assets"),d=l("__config"),p=l("__debug"),M=l("__print"),x=l("__util"),g=d.B,P=d.Gi,t=d.Fe,da={},G={},F=null,U={},R="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.hz=0;a.YN=1;a.XN=2;a.aO=4;a.$N=8;a.ZN=16;a.SN=32;var Z=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,u=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ga=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,ca=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
E=new Int16Array(2),aa=null,ia=null,q=null,T=0,ba=0,S=[],sa=null,oa=!1;a.Nf=function(a){sa=a};a.ia=n;a.VU=e;a.mY=function(a){a.Mi=x.Ih(b(a.yg,a.Xe));n(a,"PRECISION",d.B.precision);"highp"==d.B.precision?n(a,"EPSILON",Q(1E-6)):n(a,"EPSILON",Q(1E-4));n(a,"CONSTANTS_HACK",g.tD|0);n(a,"SRGB",g.srgb_type);n(a,"COMPARED_MODE",g.Gq|0)};a.a6=function(a){return a.yg};a.S4=function(a){return a.Xe};a.QU=function(a){var b=JSON.stringify(a.yg)+JSON.stringify(a.Xe)+JSON.stringify(a.Mi)+JSON.stringify(a.og),d=da[b];
if(d)return d;var f=a.Xe,e=c(t.shaders_path,a.yg),f=c(t.shaders_path,f);if(!e||!f)return null;var e=J("vert",e,a),f=J("frag",f,a),d=0,k=r(f,Z);a.MM=k;k>P.$B&&(d|=1);aa||(aa=new Uint32Array(P.Zv));ia||(ia=new Uint32Array(P.Yv));q||(q=new Uint32Array(P.Tr));w(f,ia,P.Yv)||(d|=2);w(e,q,P.Tr)||(d|=4);k=g.ec?(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.VF=k;k>P.aC&&(d|=8);h(f)||(d|=16);a.status=d;if(0===
a.status){var d=sa,l=K(d,e,d.VERTEX_SHADER),m=K(d,f,d.FRAGMENT_SHADER),k=d.createProgram();d.attachShader(k,l);d.attachShader(k,m);d.linkProgram(k);for(var l={Kx:l,Vu:m,di:k,attributes:{},Zm:{},ds:x.Sj(),zC:x.Sj(),AC:{},Wr:!0,iw:!1,ZM:x.Sj(),YM:x.Sj(),ib:x.Ih(a),uD:b,Yf:!0},n=d.getProgramParameter(k,d.ACTIVE_ATTRIBUTES),m=0;m<n;m++){var u=d.getActiveAttrib(k,m).name;l.attributes[u]=d.getAttribLocation(k,u)}n=d.getProgramParameter(k,d.ACTIVE_UNIFORMS);for(m=0;m<n;m++)u=d.getActiveUniform(k,m).name.split("[0]").join(""),
l.Zm[u]=d.getUniformLocation(k,u);da[b]=d=l;k=!sa.getShaderParameter(d.Vu,sa.COMPILE_STATUS);l=!sa.getShaderParameter(d.Kx,sa.COMPILE_STATUS);m=!sa.getProgramParameter(d.di,sa.LINK_STATUS);k?p.dL(d.Vu,b,f):l?p.dL(d.Kx,b,e):m&&p.RX(d.di,b,e,f);if(k||l||m)a.status|=32,d=null}else d=null;return d};a.xW=function(){oa=!1;if(b4w.module_check("shader_texts"))oa=!0;else{for(var a=[],b=z.Wx,c=0;c<R.length;c++){var d=x.gj(t.shaders_path+R[c]);a.push({id:R[c],type:b,url:d})}b=function(a,b){F||(F={});F[b]=a};
a.length?z.Ud(a,b,function(){oa=!0}):M.error("Shaders have not been found.")}};a.JG=function(){return oa};a.x3=function(){return S};a.rI=function(){return da};a.ua=function(){for(var a in da)D(da[a]);for(var b in G)delete G[b];for(var c in S)delete S[c];q=ia=aa=null;U={}};a.aS=D;a.y3=function(a){var b=a.Mi;M.log("Shader: "+a.yg+" "+a.Xe+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)M.log("  "+b[a][0],b[a][1])};a.N=Q;a.KG=function(a,b){return b in a.Zm?!0:!1};a.reset=function(){sa=
null}};b4w.module.__assets=function(a,l){function n(){return C.CJ()?l(C.Fe.fu).data:null}function e(){var a={Pt:null,fQ:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),f=0;f<c;f++)d[f]=b.charCodeAt(f);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Pt=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=n();b&&a.Pt in b&&(a.status=200,b[a.Pt]&&(a.response=a.fQ(b[a.Pt])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var f=b[d];20===f.state&&c++;if(c>=H.QW)break;if(10===f.state)switch(f.state=20,c++,f.type){case a.ht:y(f,"arraybuffer");break;case a.mn:y(f,"json");break;case a.Wx:y(f,"text");break;case a.Ux:r(f);break;case a.it:A(f);break;case a.Vx:h(f);break;case a.kt:w(f);break;
case a.jt:m(f);break;default:D.q("Wrong asset type: "+f.type)}}}function y(b,c){var d=b.url.split("?t=")[0];if(d in M)"json"==c?b.$b(D.S(M[d]),b.id,b.type,b.url,b.Jb):b.$b(M[d],b.id,b.type,b.url,b.Jb);else{var f=n(),g=f&&b.url in f?new e:new XMLHttpRequest,f=null;if("GET"==b.fi)g.open("GET",b.url,!0);else if("POST"==b.fi)switch(g.open("POST",b.url,!0),b.yo){case a.xE:f="text/plain";break;case a.wE:f="application/json"}if(b.vk)for(var h in b.vk)"Content-Type"==h?f=b.vk[h]:g.setRequestHeader(h,b.vk[h]);
f&&g.setRequestHeader("Content-Type",f);"text"==c?(g.overrideMimeType("text/plain"),g.responseType="text"):"json"==c?(g.overrideMimeType("application/json"),g.responseType="text"):g.responseType=c;g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState){if(200==g.status||0==g.status){var a=g.response;if(a){if("json"==c&&"string"==typeof a)try{a=JSON.parse(a,b.eW)}catch(f){J.error(f+" (parsing JSON "+b.url+")");b.$b(null,b.id,b.type,b.url,b.Jb);return}b.Yg&&(M[d]="json"==c?D.S(a):a);b.$b(a,
b.id,b.type,b.url,b.Jb)}else J.error("empty responce when trying to get "+b.url),b.$b(null,b.id,b.type,b.url,b.Jb)}else J.error(g.status+" when trying to get "+b.url),b.$b(null,b.id,b.type,b.url,b.Jb);b.state=30}};g.addEventListener("progress",function(a){a.lengthComputable&&b.QK(a.loaded/a.total)},!1);g.send(b.Km)}}function r(a){var b=a.url.split("?t=")[0];if(b in P)a.$b(P[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for audio buffer");var c=(b=n())&&a.url in
b?new e:new XMLHttpRequest;c.open("GET",a.url,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(40!=a.state&&4==c.readyState)if(200==c.status||0==c.status){var b=c.response;b?K.yT(b,function(b){a.$b(b,a.id,a.type,a.url,a.Jb);a.state=30;a.Yg&&(P[a.url.split("?t=")[0]]=b)},function(){a.$b(null,a.id,a.type,a.url,a.Jb);J.error("failed to decode "+a.url);a.state=30}):(a.$b(null,a.id,a.type,a.url,a.Jb),J.error("empty responce when trying to get "+a.url),a.state=30)}else a.$b(null,a.id,
a.type,a.url,a.Jb),J.error(c.status+" when trying to get "+a.url),a.state=30};c.send(a.Km)}}function A(a){var b=a.url.split("?t=")[0];if(b in x)a.$b(x[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for image element");var c=document.createElement("img");L.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.$b(c,a.id,a.type,a.url,a.Jb),a.state=30,a.Yg&&(x[a.url.split("?t=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(a.$b(null,
a.id,a.type,a.url,a.Jb),J.error("could not load image: "+a.url),a.state=30)},!1);if((b=n())&&a.url in b)if(b[a.url]){var d=f(a.url);c.src="data:"+d+";base64,"+b[a.url]}else O.Hr()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function h(a){var b=a.url.split("?t=")[0];if(b in g)a.$b(g[b],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for audio element");var c=document.createElement("audio");
L.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.$b(c,a.id,a.type,a.url,a.Jb),a.state=30,a.Yg&&(g[a.url.split("?t=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.$b(null,a.id,a.type,a.url,a.Jb),J.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.$b(null,a.id,a.type,a.url,a.Jb),J.error("could not load sound: "+a.url),a.state=30)},!1);if((b=n())&&a.url in b)if(b[a.url]){var d=
v(a.url);c.src="data:"+d+";base64,"+b[a.url];40!=a.state&&(a.$b(c,a.id,a.type,a.url,a.Jb),a.state=30)}else O.Hr()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,L.is_mobile_device&&c.load();L.dC&&(c.autoplay=!0,c.pause());setTimeout(function(){c.cZ=1},5E3)}}function w(a){function b(){40!=a.state&&(a.$b(null,a.id,a.type,a.url),J.error("could not load video: "+a.url,a.Jb),a.state=30)}var d=a.url.split("?t=")[0];
if(d in x)a.$b(x[d],a.id,a.type,a.url,a.Jb),a.state=30;else{"GET"!=a.fi&&D.q("Unsupported request type for video element");var f=document.createElement("video");f.muted=!0;L.allow_cors&&(f.crossOrigin="Anonymous");f.addEventListener("loadeddata",function(){f.removeEventListener("error",b,!1);40!=a.state&&(a.$b(f,a.id,a.type,a.url,a.Jb),a.state=30,a.Yg&&(x[a.url.split("?t=")[0]]=f))},!1);f.addEventListener("error",b,!1);if((d=n())&&a.url in d)if(d[a.url]){var e=c(a.url);f.src="data:"+e+";base64,"+
d[a.url];40!=a.state&&f.addEventListener("loadeddata",function(){a.$b(f,a.id,a.type,a.url,a.Jb);a.state=30},!1)}else O.Hr()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),f.dispatchEvent(d);else f.src=a.url,L.is_mobile_device&&f.load();L.dC&&(f.autoplay=!0,f.pause());setTimeout(function(){f.cZ=1},1E4)}}function m(b){function c(a){b.$b(a,b.id,b.type,b.url,b.Jb);b.state=30;b.Yg&&(x[b.url.split("?t=")[0]]=a)}var d=b.url.split("?t=")[0];if(d in
x)b.$b(x[d],b.id,b.type,b.url,b.Jb),b.state=30;else{"GET"!=b.fi&&D.q("Unsupported request type for seq video element");var f=(d=n())&&b.url in d?new e:new XMLHttpRequest;if(null==b.yo&&null==b.Km)f.open("GET",b.url,!0);else switch(f.open("POST",b.url,!0),b.yo){case a.xE:f.setRequestHeader("Content-type","text/plain");break;case a.wE:f.setRequestHeader("Content-type","application/json")}f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=b.state&&4==f.readyState)if(200==f.status||0==
f.status){var a=f.response;a?k(a,c):(b.$b(null,b.id,b.type,b.url,b.Jb),J.error("empty responce when trying to get "+b.url),b.state=30)}else b.$b(null,b.id,b.type,b.url,b.Jb),J.error(f.status+" when trying to get "+b.url),b.state=30};f.addEventListener("progress",function(a){a.lengthComputable&&b.QK(a.loaded/a.total)},!1);f.send(b.Km)}}function k(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),f=c[3],e={images:[],lG:[],Vg:c[4]},g=20,h=0;h<f;h++){var k=c[g/4],p=new Blob([d.subarray(g+4,g+4+k)],
{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(p);e.images.push(l);e.lG.push(p);g+=k+8-k%4}l.onload=function(){for(var a=0;a<e.images.length;a++)window.URL.revokeObjectURL(e.images[a].src);delete e.lG;b(e)}}function f(a){var b="image";switch(D.gB(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function v(a){var b="audio";switch(D.gB(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+=
"/mp4";break;case "webm":b+="/webm"}return b}function c(a){var b="video";switch(D.gB(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var C=l("__config"),O=l("__compat"),J=l("__print"),K=l("__sfx"),D=l("__util"),Q=l("__version"),L=C.B,H=C.Pd;a.ht=10;a.mn=20;a.Wx=30;a.Ux=40;a.it=50;a.Vx=60;a.kt=70;a.jt=80;a.wE=a.mn;a.xE=a.Wx;var z=[],d=0,p={},M={},x={},g={},P={};a.Vm=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));
return b};a.K5=function(a){if(p[a])return p[a];var b=H.prevent_caching?a+Q.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return p[a]=b;D.q("Error XHR: responce is empty, GET "+a)}else D.q("Error XHR: "+c.status+", GET "+a)};a.ua=function(){for(var a=0;a<z.length;a++)z[a].state=40;z=[];d=0;p={}};a.Ud=function(a,c,f,e,g){for(var h=0;h<a.length;h++){var k=a[h],k={id:k.id,type:k.type,url:k.url,
Yg:k.Yg,fi:k.fi?k.fi:"GET",yo:k.yo?k.yo:null,vk:k.vk?k.vk:null,Km:k.Km?k.Km:null,Jb:k.Jb?k.Jb:null,state:10,$b:c||function(){},BK:f||function(){},QK:e||function(){},eW:g||null,CK:d};if(H.prevent_caching){var p=n();p&&k.url in p||(k.url+=Q.timestamp())}z.push(k)}b(z);d++};a.update=function(){b(z);for(var a=z,c=0,d=!0,f=0;f<a.length;f++){var e=a[f];e.CK===a[c].CK?30!==e.state&&(d=!1):(d&&(a[f-1].BK(),d=f-c,a.splice(c,d),f-=d),c=f,d=30===a[f].state?!0:!1);f===a.length-1&&d&&(a[f].BK(),a.splice(c))}};
a.PR=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.cS=function(){M={};x={};g={};P={}}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",
g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",
d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",
b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",
g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES",
"USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","j",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",
d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},
{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ; aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , vec3 ( 0.0 ) , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["j","=","P",";"]}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",d:[{a:"version",
b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",
c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , W , vec3 ( 0.0 ) , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 2.0 ; jf /= cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + ac ; vec2 jk = ji + ac ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + ac ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji = ji * cM + ac ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] ; jn ( bE , ac , cM , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aG <= 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aG <= 0.00031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",d:[{a:"if",g:["GLSL3"],h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",
d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",
d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nP",f:["vec3"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1},{a:"node_out",c:"nR",f:["vec3"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!0},{a:"node_out",c:"nT",f:["vec3"],e:!0},{a:"node_out",c:"nU",f:["vec2"],e:!0},{a:"node_out",c:"nV",f:["vec2"],e:!0},{a:"node_out",c:"nW",f:["vec4"],e:!0},{a:"node_out",c:"nX",f:["float"],e:!0},{a:"node_out",c:"nY",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nS"],j:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nT"],j:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nV"],j:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nU"],j:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nW"],j:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nX"],j:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nY"],j:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},
{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"qc",f:["vec4"],e:!1},{a:"node_in",c:"qd",f:["vec3"],e:!1}],j:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - 1.0 + da * da ; float qU ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - 1.0 ) / ( da * ( g - da ) + 1.0 ) ; qU = 0.5 * cg * cg * ( 1.0 + oN * oN ) ; } else { qU = 1.0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1},{a:"node_param",c:"qW",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1},{a:"node_param",c:"qX",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1},{a:"node_param",c:"qY",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1},{a:"node_param",c:"qZ",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1},{a:"node_param",c:"q_",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rP",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR = rn . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:["rS","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rT",f:["vec3"],e:!1}],j:[{a:"txt",b:["rT","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",
f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",
b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",
b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",
f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],
e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",
c:"sZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"D = qK ( sT . rgb , sW , nI , sV , sX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"D = sT . rgb ;".split(" ")}]}]},{a:"txt",b:"D += sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",
c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ; uf ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],
l:[{a:"node_in",c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},
{a:"node_out",c:"uv",f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],
e:!1},{a:"node_in",c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_in",c:"vh",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",
c:"vj",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float aC = vh ; float fX = vg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["aC","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","P","=","vj",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",b:"vec3 vl = dFdx ( nG ) ; vec3 vm = dFdy ( nG ) ; vec3 vn = cross ( vm , P ) ; vec3 vo = cross ( P , vl ) ; float db = dot ( vl , vn ) ; float vp = abs ( db ) ; vec3 vq = dFdx ( vi ) * vn + dFdy ( vi ) * vo ; fX = max ( fX , 0.0 ) ; vk = normalize ( vp * P - aC * sign ( db ) * vq ) ; vk = normalize ( fX * vk + ( 1.0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vk","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec4"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt = rm * vt ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE",
"NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = 2.0 * vs . xyz - _1_0 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",
c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE",
"VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE",
"VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",
b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",
f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],
e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},
{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],
e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],
e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],
e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",
c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],
e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1},{a:"node_param",c:"rd",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1},{a:"node_param",c:"re",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",
b:"xH = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xJ","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL . xy = rn . xy ; xL . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM . xy = l . xy / l . z ; xM . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1},{a:"node_param",c:"rf",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",
c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1}],j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",
f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],
j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"x_ = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"ya = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"yb = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"yc = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],
e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_in",c:"yh",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bW = normalize ( yh ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yi"],j:[{a:"txt",b:"float qT = max ( _1_0 - yg , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yi = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["yi","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_yj"],j:[{a:"txt",b:"yj = abs ( dot ( yk , bW ) ) ; float dI = yg ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yj = pow ( yj , dI ) ; } yj = _1_0 - yj ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:["yj","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1},{a:"node_out",c:"yv",
f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yv = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",
f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],
e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",
f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],
e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],
e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"Bx",f:["vec3"],e:!1},{a:"node_in",c:"By",f:["vec3"],e:!1},{a:"node_in",c:"Bz",f:["float"],e:!1}],j:[{a:"txt",b:["D","=","Bx",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],
e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!1},{a:"node_param",c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = ch ( BH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",
f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cq ( BT , nI , BP , BQ , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],
e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],
e:!1},{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 CH = vec3 ( CE . x , CE . y , CE . z ) ; vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CH ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],
e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CI . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CJ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CK . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",
b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , CL . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",
f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],
j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",
c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],
j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",
b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],
e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ; Dy /= Dz ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Dy = normalize ( Dy ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],
e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"DE",f:["float"],e:!1},{a:"node_in",c:"DF",f:["vec3"],e:!1},{a:"node_out",c:"DG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bW = normalize ( DF ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 yk = normalize ( nI ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","yk","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( DE , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"DG = qV ( yk , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"DL = reflect ( - nI . xyz , DK ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:"DV = qO ( DT , DU ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",
c:"DY",f:["float"],e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",
f:["float"],e:!1}],j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"re",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rd",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"rf",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qW",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"En",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["En","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"Eo",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["Eo","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"Ep",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["Ep","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"Eq",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["Eq","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 Er = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * Er ; return iS ; } float cv ( const in vec4 Es ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( Es , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 Er = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * Er . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 Et ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( Et . rg , eG ) ; gJ . g = dot ( Et . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void Ex ( inout vec3 aG , float Eu , vec4 js , vec4 jt ) { float Ev = jt . x - js . x ; float Ew = ( Eu - js . x ) / Ev ; aG = mix ( aG , jt . yzw , clamp ( Ew , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 EA ( float t , float Ey , vec4 Ez [ COLOR_RAMP_LENGTH ] ) { float Eu = t / Ey ; vec3 aG = Ez [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 0 ] , Ez [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 1 ] , Ez [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ex ( aG , Eu , Ez [ 2 ] , Ez [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float EG ( float t , float Ey , float EB , float EC ) { float ED = max ( 0.01 , min ( Ey , EB ) ) ; float EE = max ( 0.01 , min ( Ey , EC ) ) ; float EF = Ey - EE ; float J = clamp ( t / ED , 0.0 , 1.0 ) - step ( EF , t ) * ( t - EF ) / EE ; return J ; } cD cE ( ) { cD sp ; float t ; float Ey = a_p_data [ 0 ] ; float EH = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - EH ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - EH ; } if ( t < 0.0 || t >= Ey ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Ey ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 EI = u_p_nfactor * qS ; EI += a_p_vels . xyz ; EI . z -= u_p_gravity * t / 2.0 ; float EJ = max ( u_p_mass , EPSILON ) ; EI += ( u_p_wind_fac * u_wind / EJ ) * t / 2.0 ; sp . cU = t ; sp . cS = EI ; sp . cT = bz * a_p_vels . w ; sp . N = eD + EI * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aG = EA ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = EG ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!0},{a:"node_out",c:"rs",f:["float"],e:!0},{a:"node_out",c:"rt",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rq"],j:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rs"],j:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rt"],j:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"ru",f:["float"],
e:!1},{a:"node_in",c:"rv",f:["float"],e:!1},{a:"node_in",c:"rw",f:["float"],e:!1},{a:"node_out",c:"rx",f:["vec3"],e:!1}],j:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"ry",f:["float"],e:!1},{a:"node_in",c:"rz",f:["float"],e:!1},{a:"node_in",c:"rA",f:["float"],e:!1},{a:"node_out",c:"rB",f:["vec3"],e:!1}],j:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"rC",f:["vec3"],e:!1}],j:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rG",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"rH",f:["float"],e:!1}],j:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rI",f:["float"],e:!1},{a:"node_out",c:"rJ",f:["float"],e:!1}],j:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rK",f:["float"],e:!1},{a:"node_out",c:"rL",f:["float"],e:!1},{a:"node_out",c:"rM",f:["float"],e:!1}],
j:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rN",f:["vec3"],e:!1}],j:[{a:"txt",b:"rN = rl . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rO = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"rQ = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rR",f:["vec3"],e:!1}],j:[{a:"txt",b:"rR [ 0 ] = rn [ 0 ] ; rR [ 1 ] = rn [ 1 ] ; rR [ 2 ] = rn [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rS",f:["vec3"],e:!1}],j:[{a:"txt",b:"rS = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rU",f:["vec3"],e:!1},{a:"node_out",c:"rV",f:["vec3"],e:!1},{a:"node_out",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1},{a:"node_out",c:"rY",f:["vec3"],e:!1},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!1}],j:[{a:"txt",b:"rU = vec3 ( _0_0 ) ; rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = _0_0 ; sa = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"sb",f:["float"],e:!1},{a:"node_in",c:"sc",f:["float"],e:!1},{a:"node_in",c:"sd",f:["float"],e:!1},{a:"node_in",c:"se",f:["float"],e:!1},{a:"node_in",c:"sf",f:["vec3"],e:!1},{a:"node_out",c:"sg",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jz = jy ( sf ) ; jz [ 0 ] += ( sb - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sc , sd ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sg = mix ( sf , jA ( jz ) , se ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"sh",f:["float"],e:!1},{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_out",c:"sj",f:["vec3"],e:!1}],j:[{a:"txt",b:"sj = mix ( si , vec3 ( _1_0 ) - si , sh ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"sk",f:["vec3"],e:!0},{a:"node_out",c:"sl",f:["vec3"],e:!1},{a:"node_out",c:"sm",f:["float"],e:!1},{a:"node_out",c:"sn",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sk"],j:[{a:"txt",b:"sk = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 so = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sr = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"sl = - h + sr ; sm = length ( sl ) ; sl = normalize ( sl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:"sn = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sm * sm ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float ol = dot ( sl , so ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sn *= ol ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sn *= max ( LAMP_LIGHT_DIST - sm , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sl"],j:[{a:"txt",b:["sl","=","so",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sm"],j:[{a:"txt",b:"sm = length ( sr - h ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sn"],j:[{a:"txt",b:["sn","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"su",f:["vec3"],e:!1},{a:"node_out",
c:"sv",f:["vec3"],e:!0},{a:"node_out",c:"sw",f:["float"],e:!0},{a:"node_param",c:"rc",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sv"],j:[{a:"txt",b:["sv","=","rc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sw"],j:[{a:"txt",b:"sw = - dot ( su , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec3"],e:!1}],j:[{a:"txt",b:"sy = - T ( u_view_tsr_frag , sx ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"sz",f:["vec3"],e:!1},{a:"node_in",c:"sA",f:["vec3"],e:!1},{a:"node_in",c:"sB",f:["float"],e:!1},{a:"node_in",c:"sC",f:["vec3"],e:!1},{a:"node_in",c:"sD",f:["float"],e:!1},{a:"node_in",c:"sE",f:["float"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["vec3"],e:!1},{a:"node_in",c:"sH",f:["float"],e:!1},{a:"node_out",c:"sI",f:["vec3"],e:!1},{a:"node_out",c:"sJ",f:["vec3"],e:!1},{a:"node_out",c:"sK",f:["vec3"],e:!1},{a:"node_out",c:"sL",f:["vec3"],e:!1},{a:"node_out",
c:"sM",f:["vec3"],e:!1},{a:"node_out",c:"sN",f:["vec4"],e:!1},{a:"node_out",c:"sO",f:["vec4"],e:!1},{a:"node_out",c:"sP",f:["vec3"],e:!1},{a:"node_out",c:"sQ",f:["float"],e:!1},{a:"node_out",c:"sR",f:["vec3"],e:!1},{a:"node_out",c:"sS",f:["float"],e:!1}],j:[{a:"txt",b:"sK = sA ; sL = sC ; sM = sF ; sP = sC ; sQ = sE ; sR = sG ; sS = sH ; sI = ro * sK ; sJ = rp * u_environment_energy * ce ( sM ) ; sO = ch ( sK ) ; G = sO ; sN [ 0 ] = sB ; sN [ 1 ] = sD ; sN [ 2 ] = sE ;".split(" ")}]},{a:"node",c:"BSDF_END",
m:[],l:[{a:"node_in",c:"sT",f:["vec4"],e:!1},{a:"node_in",c:"sU",f:["vec3"],e:!1},{a:"node_in",c:"sV",f:["vec3"],e:!1},{a:"node_in",c:"sW",f:["vec3"],e:!1},{a:"node_in",c:"sX",f:["float"],e:!1},{a:"node_in",c:"sY",f:["vec3"],e:!1},{a:"node_in",c:"sZ",f:["float"],e:!1}],j:[{a:"txt",b:"D = sT . rgb + sU ; D = mix ( D , sY , sZ ) ; sV ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"s_",f:["vec3"],e:!1},{a:"node_in",c:"ta",f:["vec2"],e:!1},
{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["vec4"],e:!1},{a:"node_out",c:"te",f:["float"],e:!1},{a:"node_out",c:"tf",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qS = tb ; float tg = clamp ( td [ 0 ] , _0_0 , _1_0 ) ; float th = clamp ( td [ 1 ] , _0_0 , _1_0 ) ; float qJ = td [ 2 ] ; vec3 pg = normalize ( nI + s_ ) ; float ot = ( _1_0 - tc ) * dot ( qS , s_ ) + tc ; float ti = ( _1_0 - tc ) * max ( dot ( s_ , pg ) , _0_0 ) + tc ; float tj = ( _1_0 - tc ) * max ( dot ( tb , pg ) , _0_0 ) + tc ; te = _0_0 ; if ( ta . r != _0_0 ) { if ( tg > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tg * tg ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = s_ - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) te = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; te = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else te = ot ; te = max ( te , _0_0 ) ; } float J = th ; float tk = J * J ; float tl = ( tj * tk - tj ) * tj + _1_0 ; float cd = tk / ( M_PI * tl * tl ) ; float tm ; float tn ; float to = pow ( _1_0 - ti , 5.0 ) ; tm = _1_0 ; tn = to ; float jx = J / 2.0 ; float tr = jx * jx ; float tu = _1_0 - tr ; float tv = _1_0 / ( ti * ti * tu + tr ) ; tm *= tv ; tn *= tv ; float tw = mix ( 0.04 , _1_0 , qJ ) ; float tx = mix ( tn , tm , tw ) ; tf = max ( ot * cd * tx , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"ty",f:["vec3"],e:!1},{a:"node_in",c:"tz",f:["float"],e:!1},{a:"node_in",c:"tA",f:["float"],e:!1},{a:"node_in",c:"tB",f:["float"],e:!1},{a:"node_in",c:"tC",f:["vec3"],e:!1},{a:"node_in",c:"tD",f:["vec3"],e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1}],j:[{a:"txt",b:"tE = ty ; tz ; tA ; tB ; tC ; tD ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tF",f:["vec3"],e:!1},{a:"node_in",c:"tG",f:["float"],
e:!1},{a:"node_in",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["vec3"],e:!1},{a:"node_out",c:"tJ",f:["vec3"],e:!1},{a:"node_out",c:"tK",f:["float"],e:!1},{a:"node_out",c:"tL",f:["vec3"],e:!1},{a:"node_out",c:"tM",f:["float"],e:!1},{a:"node_out",c:"tN",f:["float"],e:!1},{a:"node_out",c:"tO",f:["vec3"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1},{a:"node_out",c:"tQ",f:["float"],e:!1}],j:[{a:"txt",b:"tJ = tF ; tK = tG ; tN = _0_0 ; tQ = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],
j:[{a:"txt",b:["tO","=","tH",";"]}]},{a:"node_else",j:[{a:"txt",b:["tO","=","nH",";"]}]}]},{a:"txt",b:"tI ; tL ; tM ; tP ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tR",f:["vec3"],e:!1},{a:"node_in",c:"tS",f:["float"],e:!1},{a:"node_in",c:"tT",f:["float"],e:!1},{a:"node_in",c:"tU",f:["vec3"],e:!1},{a:"node_out",c:"tV",f:["vec3"],e:!1}],j:[{a:"txt",b:"tV = tR ; tS ; tT ; tU ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",
c:"tW",f:["vec3"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1},{a:"node_out",c:"t_",f:["vec3"],e:!1},{a:"node_out",c:"ua",f:["float"],e:!1},{a:"node_out",c:"ub",f:["vec3"],e:!1},{a:"node_out",c:"uc",f:["float"],e:!1},{a:"node_out",c:"ud",f:["float"],e:!1},{a:"node_out",c:"ue",f:["vec3"],e:!1},{a:"node_out",c:"uf",f:["vec3"],e:!1},{a:"node_out",c:"ug",f:["float"],e:!1}],j:[{a:"txt",b:"ub = tW ; uc = tX ; ud = _1_0 ; ug = _0_0 ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["ue","=","tY",";"]}]},{a:"node_else",j:[{a:"txt",b:["ue","=","nH",";"]}]}]},{a:"txt",b:"tZ ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"uh",f:["vec3"],e:!1},{a:"node_in",c:"ui",f:["float"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["float"],e:!1},{a:"node_out",c:"ul",f:["vec3"],e:!1}],j:[{a:"txt",b:"ul = uh ; ui ; uj ; uk ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",
c:"um",f:["vec3"],e:!1},{a:"node_out",c:"un",f:["vec3"],e:!1}],j:[{a:"txt",b:["un","=","um",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"uo",f:["vec3"],e:!1},{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_out",c:"uq",f:["vec3"],e:!1}],j:[{a:"txt",b:"uq = uo ; up ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"ur",f:["vec3"],e:!1},{a:"node_in",c:"us",f:["float"],e:!1},{a:"node_in",c:"ut",f:["float"],e:!1},{a:"node_in",c:"uu",f:["vec3"],e:!1},{a:"node_out",c:"uv",
f:["vec3"],e:!1}],j:[{a:"txt",b:"uv [ 0 ] = uv [ 1 ] = uv [ 2 ] = _0_0 ; ur ; us ; ut ; uu ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"uw",f:["vec3"],e:!1},{a:"node_in",c:"ux",f:["float"],e:!1},{a:"node_in",c:"uy",f:["float"],e:!1},{a:"node_in",c:"uz",f:["vec3"],e:!1},{a:"node_out",c:"uA",f:["vec3"],e:!1}],j:[{a:"txt",b:"uA = uw ; ux ; uy ; uz ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"uB",f:["vec3"],e:!1},{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["vec3"],e:!1},{a:"node_out",c:"uE",f:["vec3"],e:!1}],j:[{a:"txt",b:"uE = uB ; uC ; uD ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_in",c:"uG",f:["float"],e:!1},{a:"node_in",c:"uH",f:["vec3"],e:!1},{a:"node_in",c:"uI",f:["float"],e:!1},{a:"node_in",c:"uJ",f:["float"],e:!1},{a:"node_in",c:"uK",f:["vec3"],e:!1},{a:"node_out",c:"uL",f:["vec3"],e:!1}],j:[{a:"txt",b:"uL [ 0 ] = uL [ 1 ] = uL [ 2 ] = _0_0 ; uF ; uH ; uI ; uJ ; uK ; uG ;".split(" ")}]},
{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"uM",f:["vec3"],e:!1},{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_out",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1},{a:"node_out",c:"uQ",f:["float"],e:!1},{a:"node_out",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["float"],e:!1},{a:"node_out",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1},{a:"node_out",c:"uV",f:["vec3"],e:!1},{a:"node_out",c:"uW",f:["float"],e:!1}],j:[{a:"txt",b:"uV = uN * uM ; uT = _0_0 ; uW = _1_0 ; uU = nH ; uO ; uP ; uQ ; uR ; uS ;".split(" ")}]},
{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["vec3"],e:!1}],j:[{a:"txt",b:"uY [ 0 ] = uY [ 1 ] = uY [ 2 ] = _0_0 ; uX ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"uZ [ 0 ] = uZ [ 1 ] = uZ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"u_",f:["vec3"],e:!1},{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_out",c:"vb",f:["vec3"],e:!1}],j:[{a:"txt",b:"vb [ 0 ] = vb [ 1 ] = vb [ 2 ] = _0_0 ; u_ ; va ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"vc",f:["vec3"],e:!1},{a:"node_in",c:"vd",f:["float"],e:!1},{a:"node_in",c:"ve",f:["float"],e:!1},{a:"node_out",c:"vf",f:["vec3"],e:!1}],j:[{a:"txt",b:"vf [ 0 ] = vf [ 1 ] = vf [ 2 ] = _0_0 ; vc ; vd ; ve ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"EO",f:["float"],e:!1},{a:"node_in",c:"EP",f:["float"],e:!1},{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"EQ",f:["vec3"],e:!1},{a:"node_out",c:"vk",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vk = EQ ; EO ; EP ; vi ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["vec3"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","vu","=","nH",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vt = rm * ( vs . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ; vt = T ( u_model_tsr , vt ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vt = vs . xyz - _0_5 ; vt . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"vt = normalize ( mix ( vu , vt , vr ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",
c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_out",c:"vw",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["vw","=","vv",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],
j:[{a:"txt",b:"vw = ad ( u_model_tsr , vv ) ; vw = ad ( u_view_tsr_frag , vw ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = ad ( u_view_tsr_inverse , vv ) ; vw = ad ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_frag , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_model_tsr , vv ) ; vw = T ( u_view_tsr_frag , vw ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = T ( u_view_tsr_inverse , vv ) ; vw = T ( u_model_tsr_inverse , vw ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vw = normalize ( vw ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],
l:[{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_out",c:"vy",f:["vec3"],e:!1}],j:[{a:"txt",b:"vy [ 0 ] = vy [ 1 ] = vy [ 2 ] = _0_0 ; vx ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vz ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"vB",f:["vec3"],e:!1},{a:"node_out",c:"vC",f:["float"],e:!1},{a:"node_out",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",
f:["float"],e:!1}],j:[{a:"txt",b:"vC = vB [ 0 ] ; vD = vB [ 1 ] ; vE = vB [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"vF",f:["float"],e:!1},{a:"node_in",c:"vG",f:["float"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_out",c:"vI",f:["vec3"],e:!1}],j:[{a:"txt",b:"vI [ 0 ] = vF ; vI [ 1 ] = vG ; vI [ 2 ] = vH ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"vJ",f:["vec3"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],
e:!1},{a:"node_out",c:"vM",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vK - vL * _0_5 ; vM = max ( ( _1_0 + vL ) * vJ + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vN",f:["float"],e:!1},{a:"node_in",c:"vO",f:["float"],e:!1},{a:"node_out",c:"vP",f:["float"],e:!1},{a:"node_out",c:"vQ",f:["float"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vP = vQ = vR = _0_0 ; vN ; vO ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"ER",f:["vec3"],
e:!1},{a:"node_out",c:"ES",f:["vec3"],e:!1},{a:"node_out",c:"ET",f:["float"],e:!1}],j:[{a:"txt",b:"ES [ 0 ] = ES [ 1 ] = ES [ 2 ] = _0_0 ; ET = _1_0 ; ER ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"EU",f:["vec3"],e:!1},{a:"node_out",c:"EV",f:["vec3"],e:!1}],j:[{a:"txt",b:"EV [ 0 ] = EV [ 1 ] = EV [ 2 ] = _0_0 ; EU ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_out",c:"vT",f:["vec3"],e:!1}],j:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vS ;".split(" ")}]},
{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vU",f:["vec3"],e:!1},{a:"node_in",c:"vV",f:["float"],e:!1},{a:"node_in",c:"vW",f:["float"],e:!1},{a:"node_in",c:"vX",f:["float"],e:!1},{a:"node_out",c:"vY",f:["vec3"],e:!1},{a:"node_out",c:"vZ",f:["float"],e:!1}],j:[{a:"txt",b:"vY [ 0 ] = vY [ 1 ] = vY [ 2 ] = _0_0 ; vZ = _1_0 ; vU ; vV ; vW ; vX ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"v_",f:["vec3"],e:!1},{a:"node_in",c:"wa",f:["float"],e:!1},{a:"node_in",c:"wb",f:["float"],
e:!1},{a:"node_in",c:"wc",f:["float"],e:!1},{a:"node_in",c:"wd",f:["float"],e:!1},{a:"node_out",c:"we",f:["vec3"],e:!1},{a:"node_out",c:"wf",f:["float"],e:!1}],j:[{a:"txt",b:"we [ 0 ] = we [ 1 ] = we [ 2 ] = _0_0 ; wf = _1_0 ; v_ ; wa ; wb ; wc ; wd ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"wg",f:["vec3"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_out",c:"wi",f:["vec3"],e:!1},{a:"node_out",c:"wj",f:["float"],e:!1}],j:[{a:"txt",b:"wi [ 0 ] = wi [ 1 ] = wi [ 2 ] = _0_0 ; wj = _1_0 ; wg ; wh ;".split(" ")}]},
{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"wk",f:["vec3"],e:!1},{a:"node_in",c:"wl",f:["float"],e:!1},{a:"node_in",c:"wm",f:["float"],e:!1},{a:"node_in",c:"wn",f:["float"],e:!1},{a:"node_in",c:"wo",f:["float"],e:!1},{a:"node_in",c:"wp",f:["float"],e:!1},{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_out",c:"wr",f:["vec3"],e:!1},{a:"node_out",c:"ws",f:["float"],e:!1}],j:[{a:"txt",b:"wr [ 0 ] = wr [ 1 ] = wr [ 2 ] = _0_0 ; ws = _1_0 ; wk ; wl ; wm ; wn ; wo ; wp ; wq ;".split(" ")}]},{a:"node",
c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_out",c:"wu",f:["vec3"],e:!1},{a:"node_out",c:"wv",f:["float"],e:!1}],j:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wv = _1_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"wA",f:["vec3"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["float"],e:!1},{a:"node_out",c:"wD",f:["vec3"],e:!1},{a:"node_out",c:"wE",f:["float"],e:!1}],j:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["vec3"],e:!1},{a:"node_in",c:"wH",f:["vec3"],e:!1},{a:"node_in",c:"wI",f:["float"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["float"],e:!1}],j:[{a:"txt",b:"wJ [ 0 ] = wJ [ 1 ] = wJ [ 2 ] = _0_0 ; wK = _1_0 ; wF ; wG ; wH ; wI ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wL",f:["vec3"],e:!1},{a:"node_in",c:"wM",f:["vec3"],e:!1},{a:"node_in",c:"wN",f:["vec3"],e:!1},
{a:"node_in",c:"wO",f:["vec3"],e:!1},{a:"node_in",c:"wP",f:["float"],e:!1},{a:"node_in",c:"wQ",f:["float"],e:!1},{a:"node_in",c:"wR",f:["float"],e:!1},{a:"node_in",c:"wS",f:["float"],e:!1},{a:"node_in",c:"wT",f:["float"],e:!1},{a:"node_out",c:"wU",f:["vec3"],e:!1},{a:"node_out",c:"wV",f:["float"],e:!1}],j:[{a:"txt",b:"wU [ 0 ] = wU [ 1 ] = wU [ 2 ] = _0_0 ; wV = _1_0 ; wL ; wM ; wN ; wO ; wP ; wQ ; wR ; wS ; wT ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wW",f:["vec3"],e:!1},
{a:"node_in",c:"wX",f:["vec3"],e:!1},{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY = clamp ( wW + wX , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wZ",f:["float"],e:!1},{a:"node_in",c:"w_",f:["vec3"],e:!1},{a:"node_in",c:"xa",f:["vec3"],e:!1},{a:"node_in",c:"xb",f:["vec3"],e:!1},{a:"node_in",c:"xc",f:["float"],e:!1},{a:"node_in",c:"xd",f:["vec3"],e:!1},{a:"node_in",c:"xe",f:["float"],e:!1},{a:"node_in",c:"xf",f:["float"],e:!1},{a:"node_in",
c:"xg",f:["vec3"],e:!1},{a:"node_in",c:"xh",f:["vec3"],e:!1},{a:"node_in",c:"xi",f:["float"],e:!1},{a:"node_in",c:"xj",f:["vec3"],e:!1},{a:"node_in",c:"xk",f:["float"],e:!1},{a:"node_in",c:"xl",f:["vec3"],e:!1},{a:"node_in",c:"xm",f:["float"],e:!1},{a:"node_in",c:"xn",f:["float"],e:!1},{a:"node_in",c:"xo",f:["vec3"],e:!1},{a:"node_in",c:"xp",f:["vec3"],e:!1},{a:"node_in",c:"xq",f:["float"],e:!1},{a:"node_out",c:"xr",f:["vec3"],e:!1},{a:"node_out",c:"xs",f:["vec3"],e:!1},{a:"node_out",c:"xt",f:["float"],
e:!1},{a:"node_out",c:"xu",f:["vec3"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1},{a:"node_out",c:"xA",f:["float"],e:!1},{a:"node_out",c:"xB",f:["vec3"],e:!1},{a:"node_out",c:"xC",f:["vec3"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( wZ , _0_0 , _1_0 ) ; xs = mix ( xb , xj , xE ) ; xt = mix ( xc , xk , xE ) ; if ( xf > _0_0 ) { if ( xn > _0_0 ) { xu = mix ( xd , xl , xE ) ; xv = mix ( xe , xm , xE ) ; } else { xu = xd ; xv = xe ; } } else { xu = xl ; xv = xm ; } if ( xi > _0_0 ) { if ( xq > _0_0 ) { xC = mix ( xh , xp , xE ) ; } else { xC = xh ; } } else { xC = xp ; } xA = mix ( xf , xn , xE ) ; xB = mix ( xg , xo , xE ) ; xD = mix ( xi , xq , xE ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"xF",f:["vec3"],e:!1},{a:"node_out",c:"xG",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xF"],j:[{a:"txt",b:"xF = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xG"],j:[{a:"txt",b:"xG = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"xH",f:["vec3"],e:!1}],j:[{a:"txt",b:"xH = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"xI",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xI","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"xJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xJ = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"xK",f:["vec3"],e:!1}],j:[{a:"txt",b:"xK [ 0 ] = xK [ 1 ] = xK [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1}],j:[{a:"txt",b:"xL [ 0 ] = rn [ 0 ] ; xL [ 1 ] = rn [ 1 ] ; xL [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
m:[],l:[{a:"node_out",c:"xM",f:["vec3"],e:!1}],j:[{a:"txt",b:"xM [ 0 ] = xM [ 1 ] = xM [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"xN",f:["vec3"],e:!1}],j:[{a:"txt",b:"xN [ 0 ] = xN [ 1 ] = xN [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"xO",f:["vec3"],e:!1}],j:[{a:"txt",b:"xO = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xP",f:["float"],e:!1},{a:"node_out",c:"xQ",f:["float"],e:!1},{a:"node_out",
c:"xR",f:["float"],e:!1},{a:"node_out",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["float"],e:!1},{a:"node_out",c:"xU",f:["vec3"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_param",c:"EK",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xP"],j:[{a:"txt",b:"xP = EK [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xQ"],j:[{a:"txt",b:"xQ = EK [ 1 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xR"],j:[{a:"txt",b:"xR = EK [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xS"],j:[{a:"txt",b:["xS","=","EL",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xT"],j:[{a:"txt",b:"xT = EK [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xU"],j:[{a:"txt",b:["xU","=","EM",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xV"],
j:[{a:"txt",b:["xV","=","EN",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xP = _0_0 ; xQ = _0_0 ; xR = _0_0 ; xS = vec3 ( _0_0 ) ; xT = _0_0 ; xU = xS ; xV = xS ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xW",f:["float"],e:!1},{a:"node_out",c:"xX",f:["float"],e:!1},{a:"node_out",c:"xY",f:["float"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"xW = _0_0 ; xX = _0_0 ; xY = _0_0 ; xZ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",
c:"x_",f:["vec3"],e:!1},{a:"node_out",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1},{a:"node_out",c:"yc",f:["float"],e:!1}],j:[{a:"txt",b:"ya = _0_0 ; yb = _0_0 ; yc = _0_0 ; x_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:["ye","=","yd",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"yf",f:["vec3"],e:!1}],j:[{a:"txt",b:"yf = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"EW",f:["float"],e:!1},{a:"node_in",c:"EX",f:["vec3"],e:!1},{a:"node_out",c:"yi",f:["float"],e:!1},{a:"node_out",c:"yj",f:["float"],e:!1}],j:[{a:"txt",b:"yi = yj = _0_0 ; EX ; EW ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"yl",f:["float"],e:!1},{a:"node_out",c:"ym",f:["float"],e:!1},{a:"node_out",c:"yn",f:["float"],e:!1},{a:"node_out",c:"yo",f:["float"],e:!1},{a:"node_out",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1},
{a:"node_out",c:"yr",f:["float"],e:!1},{a:"node_out",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1},{a:"node_out",c:"yu",f:["float"],e:!1}],j:[{a:"txt",b:"yl = ym = yn = _0_0 ; yo = yp = yq = _0_0 ; yr = yr = yt = yu = _0_0 ; ys = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"yA",f:["vec3"],e:!1},{a:"node_out",c:"yB",f:["vec3"],e:!1},{a:"node_out",c:"yC",f:["float"],e:!1}],j:[{a:"txt",b:"yA = yB = vec3 ( _0_0 ) ; yC = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yD",f:["float"],e:!1},{a:"node_in",c:"yE",f:["vec3"],e:!1},{a:"node_out",c:"yF",f:["vec3"],e:!1}],j:[{a:"txt",b:["yF","=","yE",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yF . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yF . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yF . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * yE . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"yF = mix ( yE , yF , yD ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",
b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yG",f:["float"],e:!1},{a:"node_in",c:"yH",f:["vec3"],e:!1},{a:"node_out",c:"yI",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yH . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = yH . r ; float g = yH . g ; float b = yH . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"yI . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"yI . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"yI . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"yI . b = b ;".split(" ")}]}]},{a:"txt",b:"yI = mix ( yH , yI , yG ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"yJ",f:["float"],e:!1},{a:"node_out",c:"yK",f:["vec3"],e:!1},{a:"node_out",c:"yL",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( u_nodes_texture , vec2 ( yJ , NODE_TEX_ROW ) ) ; yK = yM . rgb ; yL = yM . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"yN",f:["vec3"],e:!1},{a:"node_out",c:"yO",f:["vec3"],e:!1}],j:[{a:"txt",b:["yO","=","yN",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"yO = yO * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"yO = yO + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"yO = ( MAPPING_TRS_MATRIX * vec4 ( yO , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"yO = max ( yO , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"yO = min ( yO , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"yO = normalize ( yO ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"yP",f:["float"],e:!1},{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_out",c:"yR",f:["float"],e:!1}],j:[{a:"txt",b:"yR = yP + yQ ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yR = clamp ( yR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yS",f:["float"],e:!1},{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_out",c:"yU",f:["float"],e:!1}],j:[{a:"txt",b:"yU = yS - yT ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yU = clamp ( yU , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yV",f:["float"],e:!1},{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_out",c:"yX",f:["float"],e:!1}],j:[{a:"txt",b:"yX = yV * yW ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yX = clamp ( yX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yY",f:["float"],e:!1},{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_out",c:"y_",f:["float"],e:!1}],j:[{a:"txt",b:"y_ = ( yZ != _0_0 ) ? yY / yZ : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"y_ = clamp ( y_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"za",f:["float"],e:!1},{a:"node_in",c:"zb",f:["float"],e:!1},
{a:"node_out",c:"zc",f:["float"],e:!1}],j:[{a:"txt",b:"zc = sin ( za ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zc = clamp ( zc , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zb",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zd",f:["float"],e:!1},{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_out",c:"zf",f:["float"],e:!1}],j:[{a:"txt",b:"zf = cos ( zd ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zf = clamp ( zf , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ze",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zg",f:["float"],e:!1},{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_out",c:"zi",f:["float"],e:!1}],j:[{a:"txt",b:"zi = tan ( zg ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zi = clamp ( zi , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zh",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zj",f:["float"],e:!1},{a:"node_in",c:"zk",f:["float"],e:!1},{a:"node_out",c:"zl",f:["float"],e:!1}],j:[{a:"txt",b:"zl = ( zj <= _1_0 && zj >= - _1_0 ) ? asin ( zj ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zl = clamp ( zl , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zk",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zm",f:["float"],e:!1},{a:"node_in",
c:"zn",f:["float"],e:!1},{a:"node_out",c:"zo",f:["float"],e:!1}],j:[{a:"txt",b:"zo = ( zm <= _1_0 && zm >= - _1_0 ) ? acos ( zm ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zn",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["float"],e:!1},{a:"node_out",c:"zr",f:["float"],e:!1}],j:[{a:"txt",
b:"zr = atan ( zp ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zr = clamp ( zr , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zq",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zs",f:["float"],e:!1},{a:"node_in",c:"zt",f:["float"],e:!1},{a:"node_out",c:"zu",f:["float"],e:!1}],j:[{a:"txt",b:"if ( zs < _0_0 && zt != floor ( zt ) ) zu = _0_0 ; else if ( zt == _0_0 ) zu = _1_0 ; else if ( zs < _0_0 ) zu = mix ( _1_0 , - _1_0 , sign ( mod ( - zt , 2.0 ) ) ) * pow ( - zs , zt ) ; else if ( zs == _0_0 ) zu = _0_0 ; else zu = pow ( zs , zt ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zu = clamp ( zu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zv",f:["float"],e:!1},{a:"node_in",c:"zA",f:["float"],e:!1},{a:"node_out",c:"zB",f:["float"],e:!1}],j:[{a:"txt",b:"zB = ( zv > _0_0 && zA > _0_0 ) ? log2 ( zv ) / log2 ( zA ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zB = clamp ( zB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zC",f:["float"],e:!1},{a:"node_in",c:"zD",f:["float"],e:!1},{a:"node_out",c:"zE",f:["float"],e:!1}],j:[{a:"txt",b:"zE = min ( zC , zD ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zF",f:["float"],e:!1},{a:"node_in",c:"zG",f:["float"],
e:!1},{a:"node_out",c:"zH",f:["float"],e:!1}],j:[{a:"txt",b:"zH = max ( zF , zG ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zH = clamp ( zH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zI",f:["float"],e:!1},{a:"node_in",c:"zJ",f:["float"],e:!1},{a:"node_out",c:"zK",f:["float"],e:!1}],j:[{a:"txt",b:"zK = floor ( zI + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zK = clamp ( zK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zL",f:["float"],e:!1},{a:"node_in",c:"zM",f:["float"],e:!1},{a:"node_out",c:"zN",f:["float"],e:!1}],j:[{a:"txt",b:"zN = ( zL < zM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",c:"zP",f:["float"],e:!1},{a:"node_out",c:"zQ",f:["float"],e:!1}],j:[{a:"txt",b:"zQ = ( zO > zP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zQ = clamp ( zQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zR",f:["float"],e:!1},{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_out",c:"zT",
f:["float"],e:!1}],j:[{a:"txt",b:"zT = abs ( zS ) > 0.000001 ? mod ( zR , zS ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zT = clamp ( zT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zU",f:["float"],e:!1},{a:"node_in",c:"zV",f:["float"],e:!1},{a:"node_out",c:"zW",f:["float"],e:!1}],j:[{a:"txt",b:"zW = abs ( zU ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zW = clamp ( zW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zV",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zX",f:["float"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_in",c:"zZ",f:["vec3"],e:!1},{a:"node_out",c:"z_",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( zX , _0_0 , _1_0 ) ; z_ = mix ( zY , zZ , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Aa , _0_0 , _1_0 ) ; Ad = mix ( Ab , Ab + Ac , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ae",f:["float"],e:!1},{a:"node_in",c:"Af",f:["vec3"],e:!1},{a:"node_in",c:"Ag",f:["vec3"],e:!1},{a:"node_out",c:"Ah",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ae , _0_0 , _1_0 ) ; Ah = mix ( Af , Af * Ag , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ah = clamp ( Ah , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Ai",f:["float"],e:!1},{a:"node_in",c:"Aj",f:["vec3"],e:!1},{a:"node_in",c:"Ak",f:["vec3"],e:!1},{a:"node_out",c:"Al",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ai , _0_0 , _1_0 ) ; Al = mix ( Aj , Aj - Ak , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Am",f:["float"],e:!1},{a:"node_in",c:"An",
f:["vec3"],e:!1},{a:"node_in",c:"Ao",f:["vec3"],e:!1},{a:"node_out",c:"Ap",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Am , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Ap = vec3 ( _1_0 ) - ( vec3 ( Aq ) + xE * ( vec3 ( _1_0 ) - Ao ) ) * ( vec3 ( _1_0 ) - An ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ar",
f:["float"],e:!1},{a:"node_in",c:"As",f:["vec3"],e:!1},{a:"node_in",c:"At",f:["vec3"],e:!1},{a:"node_out",c:"Au",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ar , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; At += step ( At , vec3 ( _0_0 ) ) ; Au = Aq * As + xE * As / At ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"Av",f:["float"],e:!1},{a:"node_in",c:"Aw",f:["vec3"],e:!1},{a:"node_in",c:"Ax",f:["vec3"],e:!1},{a:"node_out",c:"Ay",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Av , _0_0 , _1_0 ) ; Ay = mix ( Aw , abs ( Aw - Ax ) , xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Az",f:["float"],e:!1},{a:"node_in",
c:"AA",f:["vec3"],e:!1},{a:"node_in",c:"AB",f:["vec3"],e:!1},{a:"node_out",c:"AC",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Az , _0_0 , _1_0 ) ; AC = min ( AA . rgb , AB . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AC = clamp ( AC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AD",f:["float"],e:!1},{a:"node_in",c:"AE",f:["vec3"],e:!1},{a:"node_in",
c:"AF",f:["vec3"],e:!1},{a:"node_out",c:"AG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AD , _0_0 , _1_0 ) ; AG = max ( AE . rgb , AF . rgb * xE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AG = clamp ( AG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AH",f:["float"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_in",c:"AJ",f:["vec3"],e:!1},{a:"node_out",
c:"AK",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AH , _0_0 , _1_0 ) ; vec3 AL = vec3 ( _1_0 - xE ) ; AK = mix ( AI * ( AL + 2.0 * xE * AJ ) , vec3 ( _1_0 ) - ( AL + 2.0 * xE * ( vec3 ( _1_0 ) - AJ ) ) * ( vec3 ( _1_0 ) - AI ) , step ( _0_5 , AI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AM",f:["float"],
e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["vec3"],e:!1},{a:"node_out",c:"AP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AM , _0_0 , _1_0 ) ; vec3 AQ = vec3 ( _1_0 ) - xE * AO ; vec3 AR = clamp ( AN / AQ , _0_0 , _1_0 ) ; AP = mix ( mix ( AR , vec3 ( _1_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) , AN , step ( AN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AS",f:["float"],e:!1},{a:"node_in",c:"AT",f:["vec3"],e:!1},{a:"node_in",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AS , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - xE ) ; vec3 AQ = jH + xE * AU ; vec3 AR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - AT ) / AQ , _0_0 , _1_0 ) ; AV = mix ( AR , vec3 ( _0_0 ) , step ( AQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AV = clamp ( AV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AW",f:["float"],e:!1},{a:"node_in",c:"AX",f:["vec3"],e:!1},{a:"node_in",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( AW , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; AZ = AX ; A_ = jy ( AY ) ; if ( A_ . y != _0_0 ) { jz = jy ( AZ ) ; jz . x = A_ . x ; AQ = jA ( jz ) ; AZ = mix ( AZ , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AZ = clamp ( AZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ba",f:["float"],e:!1},{a:"node_in",c:"Bb",f:["vec3"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_out",c:"Bd",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Ba , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; Bd = Bb ; vec3 jz , A_ ; jz = jy ( Bd ) ; if ( jz . y != _0_0 ) { A_ = jy ( Bc ) ; jz . y = Aq * jz . y + xE * A_ . y ; Bd = jA ( jz ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Be",f:["float"],e:!1},{a:"node_in",c:"Bf",f:["vec3"],e:!1},{a:"node_in",c:"Bg",f:["vec3"],e:!1},{a:"node_out",c:"Bh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Be , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 jz , A_ ; jz = jy ( Bf ) ; A_ = jy ( Bg ) ; jz . z = Aq * jz . z + xE * A_ . z ; Bh = jA ( jz ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bi",f:["float"],e:!1},{a:"node_in",c:"Bj",f:["vec3"],e:!1},{a:"node_in",c:"Bk",f:["vec3"],e:!1},{a:"node_out",c:"Bl",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bi , _0_0 , _1_0 ) ; vec3 jz , A_ , AQ ; Bl = Bj ; A_ = jy ( Bk ) ; if ( A_ . y != _0_0 ) { jz = jy ( Bl ) ; jz . x = A_ . x ; jz . y = A_ . y ; AQ = jA ( jz ) ; Bl = mix ( Bl , AQ , xE ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Bm",f:["float"],e:!1},{a:"node_in",c:"Bn",f:["vec3"],e:!1},{a:"node_in",c:"Bo",f:["vec3"],e:!1},{a:"node_out",c:"Bp",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Bm , _0_0 , _1_0 ) ; float Aq = _1_0 - xE ; vec3 Bq = Bo + Bn - Bo * Bn ; Bp = Bn * ( vec3 ( Aq ) + vec3 ( xE ) * ( ( vec3 ( _1_0 ) - Bn ) * Bo + Bq ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Br",f:["float"],e:!1},{a:"node_in",c:"Bs",f:["vec3"],e:!1},{a:"node_in",c:"Bt",f:["vec3"],e:!1},{a:"node_out",c:"Bu",f:["vec3"],e:!1}],j:[{a:"txt",b:"float xE = clamp ( Br , _0_0 , _1_0 ) ; Bu = Bs + xE * ( 2.0 * Bt - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"Bv",f:["vec3"],e:!1},{a:"node_in",c:"Bw",f:["float"],e:!1}],j:[{a:"txt",b:"D = Bv ; H = Bw ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_in",
c:"BB",f:["vec3"],e:!1},{a:"node_in",c:"BC",f:["float"],e:!1},{a:"node_in",c:"BD",f:["vec3"],e:!0},{a:"node_in",c:"BE",f:["float"],e:!0},{a:"node_out",c:"BF",f:["vec3"],e:!1},{a:"node_out",c:"BG",f:["vec3"],e:!1},{a:"node_out",c:"BH",f:["vec3"],e:!1},{a:"node_out",c:"BI",f:["vec3"],e:!1},{a:"node_out",c:"BJ",f:["vec3"],e:!1},{a:"node_out",c:"BK",f:["vec2"],e:!1},{a:"node_out",c:"BL",f:["vec2"],e:!1},{a:"node_out",c:"BM",f:["vec4"],e:!1},{a:"node_param",c:"rh",f:["const","vec2"],e:!0},{a:"node_param",
c:"ri",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"BH = clamp ( BA , _0_0 , _1_0 ) ; BI = ri [ 0 ] * clamp ( BB , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"BJ = normalize ( BD ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["BJ","=","nH",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"BF = BE * BH ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"BF = ro * BH ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["BH","*=","BC",";"]}]}]},{a:"txt",b:"BG = rp * u_environment_energy * ce ( BJ ) ; BM = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"BK = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; BL = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","BM",";"]}]},{a:"node_else",j:[{a:"txt",b:"BF = vec3 ( _0_0 ) ; BG = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"BN",f:["vec4"],e:!1},{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_in",c:"BP",f:["vec3"],e:!1},{a:"node_in",c:"BQ",f:["float"],e:!0},{a:"node_in",c:"BR",f:["float"],e:!0},{a:"node_in",c:"BS",f:["float"],e:!0},{a:"node_out",c:"BT",f:["vec3"],e:!0},{a:"node_out",c:"BU",f:["float"],e:!0},{a:"node_out",c:"BV",f:["vec3"],
e:!0},{a:"node_out",c:"BW",f:["vec3"],e:!0},{a:"node_out",c:"BX",f:["vec3"],e:!0},{a:"node_param",c:"rj",f:["float"],e:!1},{a:"node_param",c:"rk",f:["float"],e:!1}],j:[{a:"txt",b:["BQ",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"BT = BN . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"BT = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["BT","+=","BO",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:["BV","=","BP",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BW"],j:[{a:"txt",b:"BW = BN . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BX"],j:[{a:"txt",b:["BX","=","BO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( BS , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * BR ; BU = clamp ( BS * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( BO . r , BO . g ) , BO . b ) * rk ; BU = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["E","=","BO",";"]}]},{a:"node_else",j:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","BP",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nZ",f:["vec3"],e:!1},{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec3"],e:!1},{a:"node_out",c:"ob",f:["vec4"],e:!1},{a:"node_out",c:"oc",f:["vec3"],e:!1}],j:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"od",f:["vec4"],e:!1},{a:"node_out",c:"oe",f:["vec3"],e:!1},{a:"node_out",c:"of",f:["vec2"],e:!1},{a:"node_out",c:"og",f:["vec3"],e:!1},{a:"node_out",c:"oh",f:["float"],e:!1}],j:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ou",f:["vec3"],e:!1},{a:"node_in",c:"ov",f:["vec2"],e:!1},{a:"node_in",c:"ow",f:["vec3"],
e:!1},{a:"node_in",c:"ox",f:["float"],e:!1},{a:"node_out",c:"oy",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"oz",f:["vec3"],e:!1},{a:"node_in",c:"oA",f:["vec2"],e:!1},{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["float"],e:!1},{a:"node_in",c:"oD",f:["vec2"],e:!1},{a:"node_out",c:"oE",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oU",f:["vec3"],e:!1},{a:"node_in",c:"oV",f:["vec2"],e:!1},{a:"node_in",c:"oW",f:["vec3"],e:!1},
{a:"node_in",c:"oX",f:["float"],e:!1},{a:"node_in",c:"oY",f:["vec2"],e:!1},{a:"node_out",c:"oZ",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"ph",f:["vec3"],e:!1},{a:"node_in",c:"pi",f:["vec2"],e:!1},{a:"node_in",c:"pj",f:["vec3"],e:!1},{a:"node_in",c:"pk",f:["float"],e:!1},{a:"node_in",c:"pl",f:["vec2"],e:!1},{a:"node_out",c:"pm",f:["float"],e:!1}],j:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pn",f:["vec3"],e:!1},{a:"node_in",c:"po",f:["vec2"],e:!1},{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["float"],e:!1},{a:"node_in",c:"pv",f:["vec2"],e:!1},{a:"node_out",c:"pw",f:["float"],e:!1}],j:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pz",f:["vec3"],e:!1},{a:"node_in",c:"pA",f:["vec2"],e:!1},{a:"node_in",c:"pB",f:["vec3"],e:!1},{a:"node_in",c:"pC",f:["float"],e:!1},{a:"node_in",c:"pD",f:["vec2"],e:!1},{a:"node_out",c:"pE",f:["float"],
e:!1}],j:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pG",f:["vec3"],e:!1},{a:"node_in",c:"pH",f:["vec2"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["float"],e:!1},{a:"node_in",c:"pK",f:["vec2"],e:!1},{a:"node_out",c:"pL",f:["float"],e:!1}],j:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < 1.0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( 1.0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1},{a:"node_in",c:"pS",f:["float"],e:!1},{a:"node_in",c:"pT",f:["float"],e:!1},{a:"node_in",c:"pU",f:["vec3"],e:!1},{a:"node_in",c:"pV",f:["vec3"],e:!1},{a:"node_in",c:"pW",f:["vec4"],e:!1},{a:"node_in",c:"pX",f:["vec3"],e:!1},{a:"node_in",c:"pY",f:["vec3"],e:!1},{a:"node_in",c:"pZ",f:["vec3"],e:!1},{a:"node_in",c:"p_",f:["float"],e:!1},{a:"node_out",c:"qa",f:["vec4"],e:!1},{a:"node_out",c:"qb",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float BY = pW . x ; float BZ = pW . y ; float B_ = pW . z ; float Ca = pW . w ; float Cb = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Cc = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Cd = pow ( Cc , BZ ) ; qa = pQ + p_ * vec4 ( pZ * Cb * pow ( pX , vec3 ( BY ) ) , _1_0 ) ; qa += B_ * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Ca ) * p_ * vec4 ( pZ * Cb * vec3 ( Cd ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Ce",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ce = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Cf",f:["vec3"],e:!1},{a:"node_out",c:"Cg",f:["float"],e:!1}],j:[{a:"txt",b:"Cg = dot ( Cf , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Ch",
f:["vec3"],e:!1},{a:"node_out",c:"Ci",f:["float"],e:!0},{a:"node_out",c:"Cj",f:["float"],e:!0},{a:"node_out",c:"Ck",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ci"],j:[{a:"txt",b:"Ci = Ch . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cj"],j:[{a:"txt",b:"Cj = Ch . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ck"],j:[{a:"txt",b:"Ck = Ch . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"Cl",f:["vec3"],e:!1},{a:"node_out",
c:"Cm",f:["float"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 Cp = jy ( Cl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = Cp . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = Cp . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = Cp . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"Cq",f:["float"],e:!1},
{a:"node_in",c:"Cr",f:["float"],e:!1},{a:"node_in",c:"Cs",f:["float"],e:!1},{a:"node_out",c:"Ct",f:["float"],e:!1}],j:[{a:"txt",b:"Ct = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Cq - Cs ) * Cr ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"Cu",f:["vec3"],e:!1},{a:"node_in",c:"Cv",f:["float"],e:!1},{a:"node_out",c:"Cw",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cw = Cu ; if ( Cw . x > _0_0 ) Cw . x = pow ( Cu . x , Cv ) ; if ( Cw . y > _0_0 ) Cw . y = pow ( Cu . y , Cv ) ; if ( Cw . z > _0_0 ) Cw . z = pow ( Cu . z , Cv ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["vec3"],e:!1}],j:[{a:"txt",b:"Cy = max ( vec3 ( _0_0 ) , Cx ) ; Cy = pow ( Cy , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_out",c:"CA",f:["vec3"],e:!1}],j:[{a:"txt",b:"CA = max ( vec3 ( _0_0 ) , Cz ) ; CA = pow ( CA , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"CB",f:["vec3"],
e:!1},{a:"node_out",c:"CC",f:["vec3"],e:!1},{a:"node_out",c:"CD",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CB"],j:[{a:"txt",b:"CB [ 2 ] = CB [ 1 ] = CB [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC [ 2 ] = CC [ 1 ] = CC [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CD"],j:[{a:"txt",b:["CD","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",
c:"CF",f:["vec3"],e:!0},{a:"node_out",c:"CG",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , CE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = yM . xyz ; bY ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = yM . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CI",f:["vec3"],e:!0},{a:"node_in",c:"CJ",f:["vec3"],e:!0},{a:"node_in",c:"CK",f:["vec3"],e:!0},{a:"node_in",c:"CL",f:["vec3"],e:!0},{a:"node_out",c:"CM",f:["vec3"],e:!0},{a:"node_out",c:"CN",f:["float"],e:!0},{a:"node_out",c:"CO",f:["vec3"],e:!0},{a:"node_out",c:"CP",f:["float"],e:!0},{a:"node_out",c:"CQ",f:["vec3"],e:!0},{a:"node_out",c:"CR",f:["float"],
e:!0},{a:"node_out",c:"CS",f:["vec3"],e:!0},{a:"node_out",c:"CT",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CI ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CM"],j:[{a:"txt",b:"CM = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CM",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_CN"],j:[{a:"txt",b:"CN = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CJ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CO",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CP"],j:[{a:"txt",b:"CP = yM . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CK ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CQ"],j:[{a:"txt",b:"CQ = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CQ",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CR"],j:[{a:"txt",b:"CR = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"yM = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( CL ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = yM . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bY","(","CS",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CT"],j:[{a:"txt",b:"CT = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"CU",f:["vec3"],e:!0},{a:"node_in",c:"CV",f:["vec3"],e:!0},{a:"node_in",c:"CW",f:["vec3"],e:!0},{a:"node_in",c:"CX",f:["vec3"],e:!0},{a:"node_out",c:"CY",f:["vec3"],e:!0},{a:"node_out",c:"CZ",f:["float"],e:!0},{a:"node_out",c:"C_",f:["vec3"],e:!0},{a:"node_out",c:"Da",f:["float"],e:!0},{a:"node_out",c:"Db",f:["vec3"],e:!0},{a:"node_out",c:"Dc",f:["float"],e:!0},{a:"node_out",c:"Dd",f:["vec3"],e:!0},{a:"node_out",c:"De",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CU ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CY"],j:[{a:"txt",b:"CY = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CZ"],j:[{a:"txt",b:"CZ = yM . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CV ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_C_"],j:[{a:"txt",b:"C_ = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Da"],j:[{a:"txt",b:"Da = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CW ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Db"],j:[{a:"txt",b:"Db = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Dc"],j:[{a:"txt",b:"Dc = yM . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"yM = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( CX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dd"],j:[{a:"txt",b:"Dd = normalize ( rm * ( yM . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_De"],j:[{a:"txt",b:"De = yM . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Df",f:["float"],e:!1}],j:[{a:"txt",b:"Df = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Dg",f:["vec3"],e:!1},{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_out",c:"Di",f:["vec3"],e:!1},{a:"node_out",c:"Dj",f:["float"],e:!0}],j:[{a:"txt",b:"Di = Dg + Dh ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dj"],j:[{a:"txt",b:"Dj = ( abs ( Di [ 0 ] ) + abs ( Di [ 1 ] ) + abs ( Di [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Dk",f:["vec3"],e:!1},{a:"node_in",c:"Dl",f:["vec3"],e:!1},{a:"node_out",c:"Dm",f:["vec3"],e:!1},{a:"node_out",c:"Dn",f:["float"],e:!0}],j:[{a:"txt",b:"Dm = Dk - Dl ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dn"],j:[{a:"txt",b:"Dn = ( abs ( Dm [ 0 ] ) + abs ( Dm [ 1 ] ) + abs ( Dm [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"Do",f:["vec3"],e:!1},{a:"node_in",c:"Dp",f:["vec3"],e:!1},
{a:"node_out",c:"Dq",f:["vec3"],e:!1},{a:"node_out",c:"Dr",f:["float"],e:!0}],j:[{a:"txt",b:"Dq = Do + Dp ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dr"],j:[{a:"txt",b:"Dr = length ( Dq ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = normalize ( Dq ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"Ds",f:["vec3"],e:!1},{a:"node_in",c:"Dt",f:["vec3"],e:!1},{a:"node_out",c:"Du",f:["vec3"],e:!1},{a:"node_out",c:"Dv",
f:["float"],e:!0}],j:[{a:"txt",b:"Du = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dv"],j:[{a:"txt",b:"Dv = dot ( Ds , Dt ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["vec3"],e:!1},{a:"node_out",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!0}],j:[{a:"txt",b:"Dy = cross ( Dw , Dx ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dz"],j:[{a:"txt",b:"Dz = length ( Dy ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"DA",f:["vec3"],e:!1},{a:"node_in",c:"DB",f:["vec3"],e:!1},{a:"node_out",c:"DC",f:["vec3"],e:!1},{a:"node_out",c:"DD",f:["float"],e:!0}],j:[{a:"txt",b:"DC = normalize ( DA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_DD"],j:[{a:"txt",b:"DD = length ( DA ) ;".split(" ")}]}]},{a:"txt",b:["DB",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"DH",f:["vec3"],e:!1},{a:"node_in",c:"DI",f:["vec3"],e:!1},{a:"node_out",c:"DJ",
f:["vec3"],e:!1}],j:[{a:"txt",b:"DJ = reflect ( T ( u_view_tsr_inverse , DH ) , DI ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"DK",f:["vec3"],e:!1},{a:"node_out",c:"DL",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 EY = - nI . xyz ; DL = reflect ( EY , DK ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"DM",f:["vec3"],e:!1},{a:"node_in",c:"DN",f:["float"],e:!1},{a:"node_in",c:"DO",f:["const","float"],e:!1},{a:"node_in",c:"DP",f:["const","float"],e:!1},{a:"node_out",
c:"DQ",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < DP ) { vec2 bE = qQ ( DM ) ; float bI = clamp ( _0_5 * ( DP - bp ) , _0_0 , _1_0 ) ; float hk = DN * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / DO ; vec2 bM = bK . xy * hk / ( DO * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = 1.0 ; bQ <= DO ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; DQ = qP ( bE ) ; } else DQ = DM ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"DR",f:["vec3"],e:!1},{a:"node_out",c:"DS",f:["vec3"],e:!1}],j:[{a:"txt",b:"DS = clamp ( DR , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"DT",f:["vec3"],e:!1},{a:"node_in",c:"DU",f:["float"],e:!1},{a:"node_out",c:"DV",f:["vec3"],e:!1}],j:[{a:"txt",b:["DV","=","DT",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"DW",f:["float"],e:!1},{a:"node_in",c:"DX",f:["float"],e:!1},{a:"node_in",c:"DY",f:["float"],
e:!1},{a:"node_in",c:"DZ",f:["float"],e:!1},{a:"node_in",c:"D_",f:["float"],e:!1},{a:"node_out",c:"Ea",f:["float"],e:!0},{a:"node_out",c:"Eb",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ea"],j:[{a:"txt",b:["Ea","=","DW",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Eb"],j:[{a:"txt",b:"Eb = vec4 ( DX , DY , DZ , D_ ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Ec",f:["float"],e:!1}],j:[{a:"txt",b:["Ec","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"Ee",f:["float"],e:!1},{a:"node_in",c:"Ef",f:["float"],e:!1},{a:"node_out",c:"Eg",f:["float"],e:!1}],j:[{a:"txt",b:"Eg = smoothstep ( Ee , Ef , Ed ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Eh",f:["vec3"],e:!1},{a:"node_in",c:"Ei",f:["float"],e:!1}],j:[{a:"txt",b:"D = Eh ; H = Ei ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Ej",f:["vec3"],e:!1},{a:"node_out",c:"Ek",f:["float"],e:!1}],
j:[{a:"txt",b:"Ek = ( Ej . r + Ej . g + Ej . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"El",f:["float"],e:!1},{a:"node_out",c:"Em",f:["vec3"],e:!1}],j:[{a:"txt",b:"Em [ 0 ] = El ; Em [ 1 ] = El ; Em [ 2 ] = El ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["A","=","Fd",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"EK",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"EL",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EM",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"EN",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"EK [ 3 ] = Fc ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"EK [ 1 ] = Fb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"EK [ 2 ] = Fe ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["EL","=","EZ",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"EK [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["EM","=","E_",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["EN","=","Fa",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 EZ , in vec3 E_ , in vec3 Fa , in float Fb , in float Fc , in vec2 Fd , in float Fe ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["A","=","Fd",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Ff ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Ff ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Ff ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Fg ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Fh ( vec4 x ) { return Ff ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 Fi ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 df = Fp * Fp + Fq * Fq ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 Fi , float Fr ) { vec2 Fj = Ff ( floor ( Fi ) ) ; vec2 Fk = fract ( Fi ) ; vec4 Fl = Fk . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 Fm = Fk . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Fh ( Fj . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Fh ( p + Fj . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 Fn = Fg ( p ) * K + K2 ; vec4 Fo = Fg ( floor ( p * K ) ) * K + K2 ; vec4 Fp = Fl + JITTER * Fn ; vec4 Fq = Fm + JITTER * Fo ; vec4 Fs = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Ft = Fp * Fp + Fq * Fq ; Fp += Fr ; Fq += Fr ; vec4 Fu = Fp * Fp + Fq * Fq ; Fs . xy = min ( Fs . xy , Fs . zw ) ; Fs . x = min ( Fs . x , Fs . y ) ; Ft . xy = min ( Ft . xy , Ft . zw ) ; Ft . x = min ( Ft . x , Ft . y ) ; Fu . xy = min ( Fu . xy , Fu . zw ) ; Fu . x = min ( Fu . x , Fu . y ) ; return vec3 ( Fs . x , Ft . x , Fu . x ) ; } vec3 Fv ( vec3 x ) { return Ff ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Fw = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Fw . yy ) ) ; vec2 Fx = ki - bQ + dot ( bQ , Fw . xx ) ; vec2 Fy ; Fy = ( Fx . x > Fx . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Fz = Fx . xyxy + Fw . xxzz ; Fz . xy -= Fy ; bQ = Ff ( bQ ) ; vec3 p = Fv ( Fv ( bQ . y + vec3 ( _0_0 , Fy . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Fy . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Fx , Fx ) , dot ( Fz . xy , Fz . xy ) , dot ( Fz . zw , Fz . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Fw . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 Fn = floor ( x + 0.5 ) ; vec3 FA = x - Fn ; ap *= 1.79284291400159 - 0.85373472095314 * ( FA * FA + bO * bO ) ; vec3 g ; g . x = FA . x * Fx . x + bO . x * Fx . y ; g . yz = FA . yz * Fz . xz + bO . yz * Fz . yw ; return 130.0 * dot ( ap , g ) ; } vec2 FD ( vec2 fm ) { float Fs = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float Ft = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float FB = fract ( sin ( Fs ) * 43758.5453 ) * 2.0 - _1_0 ; float FC = fract ( sin ( Ft ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( FB , FC ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 FE = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( FE ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 FF ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + FF ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 FG ) { return ( bE + 0.5 ) * FG . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float FH = 0.1 ; const float FI = 0.1 ; const float FJ = - 0.01 ; const float FK = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 FL = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 FM = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 FN = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 FO = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 FP = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 FQ = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 FR = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 FS = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 FM = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 FN = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 FO = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 FP = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 FQ = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 FR = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 FS = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 FL = vec2 ( - 0.51808083 , 0.0 ) ; vec2 FM = vec2 ( 0.5741194 , 0.0 ) ; vec2 FN = vec2 ( - 0.68048857 , 0.0 ) ; vec2 FO = vec2 ( 0.82934988 , 0.0 ) ; vec2 FP = vec2 ( 0.70009436 , 0.0 ) ; vec2 FQ = vec2 ( - 0.78790467 , 0.0 ) ; vec2 FR = vec2 ( - 0.58619489 , 0.0 ) ; vec2 FS = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool FU ( vec2 hZ , float FT ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + FT ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - FT ) ) ) ; } float Ga ( float FV , float FW , mat2 FX , vec3 FY , float FZ , PRECISION GLSL_SMPLR2D_SHDW F_ ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hZ , eY ; eY . x = FV ; eY . y = FW ; eY = FX * eY ; hZ = FY . xy + eY * FZ / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hZ = FY . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! FU ( hZ , FJ ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( F_ , vec3 ( hZ , FY . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( FY . z , GLSL_TEXTURE ( F_ , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Gf ( vec3 FY , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ ) { float Gb = 0.0 ; FY . z = clamp ( FY . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( FY . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gb += Ga ( FL [ bQ ] , FP [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FN [ bQ ] , FR [ bQ ] , FX , FY , FZ , F_ ) ; Gb += Ga ( FO [ bQ ] , FS [ bQ ] , FX , FY , FZ , F_ ) ; } return clamp ( Gb / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , FY , FZ , F_ ) ;".split(" ")}]}}]},{a:"txt",b:"} float Go ( vec3 Gg , PRECISION GLSL_SMPLR2D_SHDW Gh , vec3 Gi , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float aB ) { float Gm , Gn ; Gg . z = clamp ( Gg . z , 0.0 , 1.0 ) ; Gi . z = clamp ( Gi . z , 0.0 , 1.0 ) ; Gm = 0.0 ; Gn = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Gc = FD ( Gg . xy ) . x * M_PI ; float Gd = cos ( Gc ) ; float Ge = sin ( Gc ) ; mat2 FX = mat2 ( Gd , Ge , - Ge , Gd ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gm += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gg , Gk , Gh ) ; Gm += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gg , Gk , Gh ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { Gn += Ga ( FL [ bQ ] , FP [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FM [ bQ ] , FQ [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FN [ bQ ] , FR [ bQ ] , FX , Gi , Gl , Gj ) ; Gn += Ga ( FO [ bQ ] , FS [ bQ ] , FX , Gi , Gl , Gj ) ; } Gm = mix ( Gm , Gn , aB ) ; Gm /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Gm += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gg , Gk , Gh ) ; Gn += Ga ( 0.0 , 0.0 , mat2 ( 0.0 ) , Gi , Gl , Gj ) ; Gm = mix ( Gm , Gn , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( Gm , 0.0 , 1.0 ) ; } float Gp ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float Gr ( float tv , float Gq ) { if ( Gq >= 0.0 && Gq <= FI ) tv = ( tv - 1.0 ) / FI * Gq + 1.0 ; return tv ; } float Gw ( vec3 Gs , vec3 Gt , PRECISION GLSL_SMPLR2D_SHDW Gh , PRECISION GLSL_SMPLR2D_SHDW Gj , float Gk , float Gl , float Gu , float fN ) { float tv ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float Gq = Gp ( Gs . xy ) ; if ( - fN > Gu && Gq >= 0.0 && Gq <= FH && FU ( Gt . xy , 0.0 ) ) { float Gv = 1.0 - Gq / FH ; tv = Go ( Gs , Gh , Gt , Gj , Gk , Gl , Gv ) ; } else".split(" ")}]}}]},{a:"txt",b:"tv = Gf ( Gs , Gh , Gk ) ; return tv ; } float Gy ( vec3 Gx , PRECISION GLSL_SMPLR2D_SHDW F_ , float FZ , float Gu , float fN ) { float tv = Gf ( Gx , F_ , FZ ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fN > Gu ) { float Gq = Gp ( Gx . xy ) ; tv = Gr ( tv , Gq ) ; }".split(" ")}]}}]},{a:"txt",b:"return tv ; } vec4 dD ( float fN ) { float tv = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","Gz","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 Gz = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Gg = n . xyz / n . w ; if ( n . w < 0.0 ) Gg . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Gi = o . xyz / o . w ; if ( o . w < 0.0 ) Gi . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GA = u . xyz / u . w ; if ( u . w < 0.0 ) GA . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 GB = v . xyz / v . w ; if ( v . w < 0.0 ) GB . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , 0.0 ) ) { tv = Gw ( Gg , Gi , u_shadow_map0 , u_shadow_map1 , Gz [ 0 ] , Gz [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( FU ( Gg . xy , FK ) ) { tv = Gy ( Gg , u_shadow_map0 , Gz [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( Gi . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( Gi , GA , u_shadow_map1 , u_shadow_map2 , Gz [ 1 ] , Gz [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( Gi , u_shadow_map1 , Gz [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( FU ( GA . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"tv = Gw ( GA , GB , u_shadow_map2 , u_shadow_map3 , Gz [ 2 ] , Gz [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"tv = Gy ( GA , u_shadow_map2 , Gz [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( FU ( GB . xy , 0.0 ) ) tv = Gy ( GB , u_shadow_map3 , Gz [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GC = Gf ( Gi , u_shadow_map1 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GC","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GD = Gf ( GA , u_shadow_map2 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GD","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float GE = Gf ( GB , u_shadow_map3 , Gz [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","GE","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tv , GC , GD , GE ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cd *= Gb . a ;".split(" ")}]}}]},{a:"txt",b:["return","Gb",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Gb = dD ( i . z ) ; return Gb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 GI ( mat4 GF , vec4 GG , mat4 GH ) { vec2 dF = ( GF * GH [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 FY = GF * GG ; FY . xy += dF ; FY . xyz = 0.5 * ( FY . xyz + FY . w ) ; return FY ; } void bD ( vec3 eD , vec3 GJ ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 GH = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; n = GI ( u_p_light_matrix0 , GK , GH ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"GH = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GH = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"GK = GH * vec4 ( eD + u_normal_offset * GJ , 1.0 ) ; v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"o = GI ( u_p_light_matrix1 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"u = GI ( u_p_light_matrix2 , GK , GH ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"v = GI ( u_p_light_matrix3 , GK , GH ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 GS ( in vec4 gI , in vec4 GL , in float GM ) { float GN = gI [ 0 ] * GL [ 0 ] + gI [ 1 ] * GL [ 1 ] + gI [ 2 ] * GL [ 2 ] + gI [ 3 ] * GL [ 3 ] ; if ( GN < 0.0 ) { GL *= - 1.0 ; GN = - GN ; } if ( abs ( GN ) >= 1.0 ) return gI ; float GO = acos ( GN ) ; float GP = sqrt ( 1.0 - GN * GN ) ; if ( abs ( GP ) < 0.001 ) return vec4 ( gI * 0.5 + GL * 0.5 ) ; float GQ = sin ( ( 1.0 - GM ) * GO ) / GP ; float GR = sin ( GM * GO ) / GP ; return gI * GQ + GL * GR ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GU , in vec4 GV , in vec4 GW , in float GX ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec4 GZ = mix ( GV , GW , GX ) ; vec3 G_ = O ( gI , GY ) ; vec3 Ha = G_ * GZ . w + GZ . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hb = O ( GT , GY ) ; vec3 Hc = O ( GU , GY ) ; vec3 Hd = Hb * GV . w + GV . xyz ; vec3 He = Hc * GW . w + GW . xyz ; vec3 Ha = mix ( Hd , He , GX ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT , in vec4 GU , in float GX ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gI = GS ( GT , GU , GX ) ; vec3 Hi = O ( gI , Hh ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hj = O ( GT , Hh ) ; vec3 Hk = O ( GU , Hh ) ; vec3 Hi = mix ( Hj , Hk , GX ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hf ( in vec3 N , in vec4 GT , in vec4 GV ) { vec3 GY = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 G_ = O ( GT , GY ) ; vec3 Ha = G_ * GV . w + GV . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , Ha ) ; } vec3 Hl ( in vec3 Hg , in vec4 GT ) { vec3 Hh = qn ( u_arm_rel_trans , u_arm_rel_quat , Hg ) ; vec3 Hi = O ( GT , Hh ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , Hi ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","Hm","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hn = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Ho = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 Hp = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 Hq = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int Hr = int ( Hq [ bQ ] ) ; float Hs = fract ( Hq [ bQ ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] , u_quatsa [ Hr ] , Hm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_transb [ Hr ] ) ; Hp += Hs * Hl ( P , u_quatsb [ Hr ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hn += Hs * Hl ( Q , u_quatsb [ Hr ] ) ; Ho += Hs * Hl ( R , u_quatsb [ Hr ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int Hr = int ( Hq [ 0 ] ) ; float Hs = fract ( Hq [ 0 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 1 ] ) ; Hs = fract ( Hq [ 1 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 2 ] ) ; Hs = fract ( Hq [ 2 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ; Hr = int ( Hq [ 3 ] ) ; Hs = fract ( Hq [ 3 ] ) ; iU += Hs * Hf ( N , u_quatsb [ Hr ] , u_quatsa [ Hr ] , u_transb [ Hr ] , u_transa [ Hr ] , Hm ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = Hp ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hn ; R = Ho ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int Ht = int ( a_influence [ 0 ] - 1.0 ) ; if ( Ht > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_quatsa [ Ht ] , u_transb [ Ht ] , u_transa [ Ht ] , Hm ) ; Q = Hl ( Q , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; R = Hl ( R , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ; P = Hl ( P , u_quatsb [ Ht ] , u_quatsa [ Ht ] , Hm ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Hf ( N , u_quatsb [ Ht ] , u_transb [ Ht ] ) ; P = Hl ( P , u_quatsb [ Ht ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Q = Hl ( Q , u_quatsb [ Ht ] ) ; R = Hl ( R , u_quatsb [ Ht ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 Hu ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Hv ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Hw = 1.0 ; Hw = dM . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"Hw = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = 1.0 - Hw ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hw = dM . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dJ = Hu ( dM . rgb , dJ , Hw , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","Hx","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"Hx = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Hx != 0.0 ) dK = Hu ( dM . rgb , dK , Hw , Hx ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"Hw = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Hv ( u_sky_tex_dvar , dI , Hw , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aX ( vec3 Hy , mat3 M ) { vec4 Hz = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 HA = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Hz = qe ( HA , Hz ) ; Hz = kj ( Hz ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 HC ( vec3 kV , vec3 Hy ) { vec3 HB = kV - Hy ; HB . z = 0.0 ; HB = normalize ( HB ) ; vec4 Hz = qj ( HB , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Hy ; aY = cK ( Hz , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ai ( in vec3 HD , float HE , float HF , float HG , vec3 aQ , mat3 S ) { float HH = fract ( length ( aQ ) / 0.17 ) ; float HI = HG + HH / 10.0 ; float HJ = HH ; if ( HG != 0.0 ) HJ /= HG ; HD *= 1.0 + 0.5 * sin ( HE ) ; float HK = length ( HD ) * HF * sin ( 2.0 * 3.14 * HE * HI + HJ ) ; vec4 HL = cI ( TOWARD_VECTOR , HK ) ; vec4 HM = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; HM = qe ( HM , HL ) ; S = cK ( HM , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float HH = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float HN = 2.0 * M_PI * HH ; vec4 HO = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float HP = asin ( 2.0 * ( HO . x * HO . y - HO . z * HO . w ) ) ; float gZ = HP - HN ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float HQ = HN ; if ( gZ <= MAX_BILLBOARD_ANGLE ) HQ += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) HQ += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) HQ += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else HQ += gZ - 2.0 * M_PI ; vec4 HR = cI ( UP_VECTOR , HQ ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( HR , lj ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 lj = HC ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 HS , in vec3 HT , in vec3 HU , in vec3 HV , in vec3 HW , in mat3 S ) { eD = ad ( S , eD ) ; HS = ad ( S , HS ) ; HT = T ( S , HT ) ; HU = T ( S , HU ) ; HV = T ( S , HV ) ; HW = T ( S , HW ) ; return lk ( aj ( eD , HS , HT , HU , HV , HW , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Ii ( inout vec3 bd , in vec3 HX , in float HY , in float HZ , in float eK , in vec3 HD , in float H_ , in mat4 by ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( Ib ) ; float Ic = HZ * ( 1.0 + 0.1 * fract ( dg ) ) ; float Id = HY * H_ * ( 1.0 + sin ( 2.0 * 3.14 * eK * Ic + dg ) ) ; float Ie = ( Ia . z - Ib . z ) * abs ( Id ) ; Ie += 1.0 ; Ie *= Ie ; Ie = Ie * Ie - Ie ; vec3 If = Ia ; If . xy += HD . xy * Ie * sign ( Id ) ; vec3 Ig = If - Ib ; if ( all ( equal ( Ig , vec3 ( 0.0 ) ) ) ) bd = HX ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Ig = ( by * vec4 ( Ig , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Ih = length ( Ia - Ib ) ; bd = HX + normalize ( Ig ) * Ih ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Ij ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Ik ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 Il ( vec4 x ) { return Ij ( Ik ( x ) ) ; } void Ix ( inout vec3 bd , in float eK , in vec3 P , in vec3 HD , in vec3 HX , in float Im , in float In , in float Io , in vec3 Ip , in mat4 by ) { float Iq ; float Ir ; float Is ; vec2 It ; vec4 Iu ; vec2 Iv ; vec3 Iw ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 Ib = ( by * vec4 ( HX , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Ia = bd ; vec3 Ib = HX ;".split(" ")}]}}]},{a:"txt",b:"Iq = dot ( Ib , vec3 ( 1.0 ) ) ; Ir = Iq + Ip . g ; Is = dot ( Ia , vec3 ( Ip . g ) ) ; It = ( eK + vec2 ( Is , Ir ) ) ; Iu = ( ( fract ( ( It . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( HD ) * Im ; Iu = Il ( Iu ) ; Iv = Iu . xz + Iu . yw ; Iv . y = 0.5 - Iv . y ; Iw = Iv . xxy * Ip . rrb * vec3 ( In * P . x , In * P . y , Io ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Iw = ( by * vec4 ( Iw , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Iw",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Iy = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = ac ; vec3 IA = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"IA = ( by * vec4 ( IA , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Iz = N ; vec3 IA = ac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"Ix ( Iz , u_time , P , Iy , IA , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Ii ( Iz , IA , au_wind_bending_amp , au_wind_bending_freq , u_time , Iy , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"N += Iz - ac ; ac = Iz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"N = Iz ; ac = IA ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.__data=function(a,l){function n(a,b){Ua[b.id]=null;Aa[b.id]=null}function e(a,b,c,d){a instanceof ArrayBuffer&&(a=N.iJ(a,d));d=a.width;a=a.height;va.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(ab)&&c&&va.warn("image",b,"is not from app root.")}function b(a,b,c,d,f,e){(d=b.Tg)||Da.q("Nothing requested");la.Ud([{id:d,type:la.mn,url:d,Yg:b.gk}],function(d,e,g,h){if(d){va.log("%cLOAD METADATA","color: #616",h);e=Da.wM(d.b4w_format_version);
switch(Da.zN(e,ra.zm)){case -1:e[0]<ra.zm[0]?Da.q("JSON version is too old relative to B4W engine: "+Da.bl(e)+", required: "+Da.bl(ra.zm)+". Reexport scene with the latest B4W addon to fix it."):va.warn("JSON version is a bit old relative to B4W engine: "+Da.bl(e)+", required: "+Da.bl(ra.zm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:e[0]>ra.zm[0]?Da.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
va.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ra.TB=e;for(var k in d)a[k]=d[k];b.Mb&&(Ya=I.Ru(a.scenes));(d=a.binaries[0].binfile)?b.hG=d:(ua.dx(b,"load_binaries"),ua.dx(b,"prepare_bindata"));ra.is_mobile_device||ua.dx(b,"mobile_media_start");ra.antialiasing&&ra.smaa||ua.dx(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Mb&&"PRIMARY"==k.type||
"ALL"==k.type)&&va.XT(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Mb&&"PRIMARY"==k.type||"ALL"==k.type)&&va.YT(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.gk&&D(a);f(b,c)}else ua.AF(b)},null,function(a){e(b,c,a)})}function y(a,b,c,d,f,e){(d=oa(b.Tg)+b.hG)||Da.q("Binary data is missing");la.Ud([{id:d,
type:la.ht,url:d,Yg:b.gk}],function(d,e,g,k){d?(va.log("%cLOAD BINARY","color: #616",k),a.bin_data=d,d=h(d),e=Da.wM(a.b4w_format_version),d[0]!=e[0]&&Da.q("BIN version does not match to JSON version: "+Da.bl(d)+", required: "+Da.bl(ra.zm)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=e[1]&&va.warn("BIN version does not match to JSON version: "+ +Da.bl(d)+", required: "+Da.bl(ra.zm)+". Some compatibility issues can occur. Reexport scene to fix it."),f(b,c)):ua.AF(b)},null,function(a){e(b,
c,a)})}function r(a,b,c,d,f){X.JG()&&f(b,c)}function A(a,b,c,d,f){d=a.bin_data;var e=a.binaries[0],g=a.objects,k=a.meshes;a=a.actions;var q=Da.NR();h(d);for(var p=["indices"],l=["position","texcoord","texcoord2","shade_tangs"],m=["normal","tangent"],n=["group"],r=["color"],u=0;u<k.length;u++)for(var t=k[u].submeshes,M=0;M<t.length;M++){for(var x in t[M]){var z=t[M][x][1];if(-1!=p.indexOf(x)){var v=t[M][x][0]*Da.FE+e["int"]+12,E=t[M],H=x,T=d;if(q)var C=new Uint32Array(T,v,z);else for(var C=new Uint32Array(z),
T=new DataView(T),S=0;S<z;S++)C[S]=T.getUint32(v+S*Da.FE,!0);E[H]=C}else if(-1!=l.indexOf(x))v=t[M][x][0]*Da.Aj+e["float"]+12,t[M][x]=w(d,v,z,q);else if(-1!=m.indexOf(x)){v=t[M][x][0]*Da.Op+e["short"]+12;E=t[M];H=x;T=d;C=new Float32Array(z);T=new DataView(T);for(S=0;S<z;S++)C[S]=T.getInt16(v+S*Da.Op,!0)/32767;E[H]=C}else if(-1!=n.indexOf(x)){v=t[M][x][0]*Da.Op+e.ushort+12;E=t[M];H=x;T=d;C=new Float32Array(z);T=new DataView(T);for(S=0;S<z;S++)C[S]=T.getUint16(v+S*Da.Op,!0)/65535;E[H]=C}else if(-1!=
r.indexOf(x)){v=t[M][x][0]*Da.Yx+e.uchar+12;E=t[M];H=x;T=d;C=new Float32Array(z);T=new DataView(T);for(S=0;S<z;S++)C[S]=T.getUint8(v+S*Da.Yx,!0)/255;E[H]=C}}z=t[M];if(k[u].b4w_shape_keys.length)for(v=z.base_length,E=z.normal.length/v/3,z.tbn_quat=Da.or(z.normal.subarray(0,3*v),z.tangent.subarray(0,4*v),new Float32Array(z.normal.length/3*4)),H=1;H<E;H++)for(T=H*v,C=0;C<v;C++){var F=z.normal.subarray(3*C,3*(C+1)),S=qa.add(z.normal.subarray(3*(T+C),3*(T+C+1)),F,kb);if(z.tangent.length){var P=z.tangent.subarray(4*
C,4*(C+1)),y=W.add(z.tangent.subarray(4*(T+C),4*(T+C+1)),P,eb),F=Da.$I(F,P,bb),S=Da.$I(S,y,sb);Ma.invert(F,bb);S=Ma.multiply(S,F,bb)}else S=Ma.rotationTo(F,S,bb);z.tbn_quat.set(S,4*(T+C))}else z.tbn_quat=Da.or(z.normal,z.tangent)}for(x=0;x<g.length;x++)for(k=g[x].particle_systems,p=0;p<k.length;p++)l=k[p],l.transforms=w(d,l.transforms[0]*Da.Aj+e["float"]+12,l.transforms[1],q);for(g=0;g<a.length;g++){x=a[g];k=x.fcurves;p=x.frame_range;m=p[0];n=p[1];r=wa.OU(m,n);p=null;0>r&&(r=0);var t=u=!1,A;for(A in k)u|=
-1<A.indexOf("rotation_euler"),t|=-1<A.indexOf("rotation_quaternion");l=[];for(A in k)if(u&&t&&-1<A.indexOf("rotation_euler"))delete k[A];else{var M=k[A],B;for(B in M)z=M[B],v=w(d,e["float"]+z.bin_data_pos[0]*Da.Aj+12,z.bin_data_pos[1],q),E=new Float32Array(r),null===p&&(p=new Int8Array(r)),wa.KQ(z,v,E,p,m,n),z.zf=E;-1<A.indexOf("rotation_euler")&&(wa.hU(k[A]),l.push(A))}for(m=0;m<l.length;m++)n=l[m],r=n.replace("euler","quaternion"),k[r]=k[n],delete k[n];x.bQ=p}f(b,c)}function h(a){new Uint8Array(a,
0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function w(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var f=0;f<c;f++)d[f]=a.getFloat32(b+f*Da.Aj,!0)}return d}function m(a,b,c,e,g){var h=a.cameras,k=a.groups,q=a.materials,l=a.meshes,m=a.node_groups,n=a.objects,r=a.particles,u=a.scenes,t=a.speakers,M=a.lamps,x=a.textures,w=a.worlds;m||(va.warn('"node_groups" datablock undefined. reexport main scene.'),m=a.node_groups=[]);
for(var z="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),E={},H=0;H<z.length;H++)for(var T=a[z[H]],S=0;S<T.length;S++){var F=T[S];E[F.uuid]=F}for(var P=0;P<u.length;P++){for(var y=u[P],A=y.objects,B=0;B<A.length;B++)p(A,B,E);y.camera&&p(y,"camera",E);y.world&&p(y,"world",E)}for(P=0;P<k.length;P++)for(var G=k[P].objects,B=0;B<G.length;B++)p(G,B,E);for(P=0;P<n.length;P++){var L=n[P];L.dupli_group&&
p(L,"dupli_group",E);L.parent&&p(L,"parent",E);L.dg_parent&&p(L,"dg_parent",E);if(L.animation_data){var ba=L.animation_data;ba.action&&p(ba,"action",E);if(ba.nla_tracks)for(B=0;B<ba.nla_tracks.length;B++)for(var N=ba.nla_tracks[B],J=0;J<N.strips.length;J++)N.strips[J].action&&p(N.strips[J],"action",E)}switch(L.type){case "MESH":L.data||Da.q("mesh not found for object "+L.name);p(L,"data",E);for(var U=!1,K=L.modifiers,B=0;B<K.length;B++){var Q=K[B];"ARMATURE"==Q.type?(U&&va.warn('Object "'+L.name+
'" has more than one armature modifiers. Only the first one will be used.'),U=!0,p(Q,"object",E)):"CURVE"==Q.type&&p(Q,"object",E)}var Y=L.particle_systems;if(Y)for(B=0;B<Y.length;B++)p(Y[B],"settings",E);break;case "ARMATURE":p(L,"data",E);for(var ca=L.pose.bones,ia=L.data.bones,B=0;B<ca.length;B++){var ga=ca[B];ga.bone=ia[ga.bone];var aa=ga.constraints;if(aa)for(J=0;J<aa.length;J++){var sa=aa[J];sa.target&&p(sa,"target",E)}for(var Z=ga.parent_recursive,J=0;J<Z.length;J++)Z[J]=ca[Z[J]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":p(L,
"data",E)}if(aa=L.constraints)for(B=0;B<aa.length;B++)sa=aa[B],sa.target&&p(sa,"target",E);var da=L.lod_levels;if(da)for(B=0;B<da.length;B++){var W=da[B];W.object&&p(W,"object",E)}}for(P=0;P<l.length;P++)for(var na=l[P].materials,B=0;B<na.length;B++)p(na,B,E);for(P=0;P<q.length;P++){for(var ha=q[P],ea=ha.texture_slots,B=0;B<ea.length;B++)p(ea[B],"texture",E);var X=ha.node_tree;X&&d(X,E)}for(P=0;P<m.length;P++)(X=m[P].node_tree)&&d(X,E);for(P=0;P<x.length;P++){var la=x[P],ma=la.type;"IMAGE"!=ma&&"ENVIRONMENT_MAP"!=
ma||p(la,"image",E)}for(P=0;P<h.length;P++){var ya=h[P];ya.dof_object&&p(ya,"dof_object",E)}for(P=0;P<t.length;P++){var fa=t[P];fa.sound&&p(fa,"sound",E);if(fa.animation_data&&(ba=fa.animation_data,ba.action&&p(ba,"action",E),ba.nla_tracks))for(B=0;B<ba.nla_tracks.length;B++)for(N=ba.nla_tracks[B],J=0;J<N.strips.length;J++)N.strips[J].action&&p(N.strips[J],"action",E)}for(P=0;P<r.length;P++){for(var ta=r[P],ea=ta.texture_slots,B=0;B<ea.length;B++)p(ea[B],"texture",E);ta.dupli_group&&p(ta,"dupli_group",
E);ta.dupli_object&&p(ta,"dupli_object",E)}for(P=0;P<M.length;P++){var ja=M[P];if(ja.animation_data&&(ba=ja.animation_data,ba.action&&p(ba,"action",E),ba.nla_tracks))for(B=0;B<ba.nla_tracks.length;B++)for(N=ba.nla_tracks[B],J=0;J<N.strips.length;J++)N.strips[J].action&&p(N.strips[J],"action",E)}for(P=0;P<w.length;P++){var sb=w[P];if(ea=sb.texture_slots)for(B=0;B<ea.length;B++)p(ea[B],"texture",E);if(sb.animation_data&&(ba=sb.animation_data,ba.action&&p(ba,"action",E),ba.nla_tracks))for(B=0;B<ba.nla_tracks.length;B++)for(N=
ba.nla_tracks[B],J=0;J<N.strips.length;J++)N.strips[J].action&&p(N.strips[J],"action",E)}Ga.IR(a);D(a);for(var ka=oa(b.Tg),xa=a.textures,za=b.Mb?a.scenes[0].b4w_anisotropic_filtering:Ya.b4w_anisotropic_filtering,pa=0;pa<xa.length;pa++)b.Mb||"SCENE"!=xa[pa].b4w_source_type||(xa[pa].b4w_source_id=""),Ha.lT(xa[pa],za,a.scenes,b.id,ka);for(var nb={},ua=a.objects,qa=0;qa<ua.length;qa++){var ra=ua[qa];if("MESH"===ra.type&&!ra.particle_systems.length)for(var Ea=ra.data,Pa=Ea.name,lb=Ea.submeshes,Va=Ea.materials,
Ma=0;Ma<lb.length;Ma++)0!==lb[Ma].base_length||nb[Pa]||(Va[Ma]&&va.warn('material "'+Va[Ma].name+'" is not assigned to any face (object "'+ra.name+'").'),nb[Pa]=!0)}for(var Ja=a.meshes,Ka=0;Ka<Ja.length;Ka++){var wb=Ja[Ka];wb.materials.length||wb.uv_textures.length&&va.warn('mesh "'+wb.name+'" has a UV map but has no exported material.')}a.materials.push(Ga.BS());for(var Na=a.meshes,Oa=Da.Dd("name","DEFAULT",a.materials),La=0;La<Na.length;La++){var Qa=Na[La];0==Qa.materials.length&&Qa.materials.push(Oa)}for(var Ra=
a.actions,Sa=b.id,Ua=0;Ua<Ra.length;Ua++){var bb=Ra[Ua];bb.cQ=Sa;wa.lQ(bb)}for(var qb=a.scenes,ab=0;ab<qb.length;ab++){for(var kb=qb[ab],eb=[],pb=[],zb=qb[ab].objects,Ab=0;Ab<zb.length;Ab++){var Wb=zb[Ab];R(zb,Wb,null,eb,pb);var Cb=Wb.dupli_group;if(Cb)for(var Xa=Cb.objects,$a=0;$a<Xa.length;$a++)R(Xa,Xa[$a],Wb,eb,pb)}for(Ab=0;Ab<pb.length;Ab++)for(var ic=pb[Ab],gc=[kb],Nb=0;Nb<gc.length;Nb++){for(var xc=gc[Nb].objects,hd=0;hd<xc.length;hd++){var Uc=xc[hd].dupli_group;if(Uc){var yc=Uc.objects,qc=
yc.indexOf(ic);-1<qc&&yc.splice(qc,1)}}var qc=xc.indexOf(ic);-1<qc&&xc.splice(qc,1)}for(Ab=0;Ab<eb.length;Ab++)Da.FQ(eb[Ab][0],eb[Ab][1])}!b.Mb&&1<a.scenes.length&&(a.scenes=[I.Ru(a.scenes)],va.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Lc=b.Mb?Ya:I.Ru(a.scenes);Ac.rY(Ya.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Ya),1),a.scenes.unshift(Ya));for(var Vc=0;Vc<a.scenes.length;Vc++){var hc=a.scenes[Vc];hc.s={};hc.yF=hc==Lc;hc.dQ=b.Mb;Ta.enabled&&
hc.b4w_enable_physics&&(b.Mb||!Ba.Lw(Ya)&&hc==I.Ru(a))&&Ba.MV(hc)}for(var rc=0;rc<a.scenes.length;rc++){for(var Vb=a.scenes[rc],Mc=v(Vb),jd=0;jd<Mc.length;jd++){var zc=Mc[jd];Ca.JR(zc,Vb,a)&&(zc.qd||(zc.qd=[]),zc.qd.push(b.Mb?Vb:Ya))}for(var pd=Mc,kd=0;kd<pd.length;kd++){var ld=pd[kd];if(ld.qd&&"WORLD"!=ld.type)for(var wd=ld.particle_systems,qd=0;qd<wd.length;qd++){var ad=wd[qd].settings;if("HAIR"==ad.type)if("OBJECT"==ad.render_type){var sc=ad.dupli_object;sc.qd||(sc.qd=ld.qd.slice())}else if("GROUP"==
ad.render_type)for(var bd=ad.dupli_group,rd=0;rd<bd.objects.length;rd++)sc=bd.objects[rd],sc.qd||(sc.qd=ld.qd.slice())}}}for(var cd=a.scenes,sd=[],Hb=0;Hb<cd.length;Hb++)C(cd[Hb].objects,0,b.Mb,sd);Aa[b.id]=[];for(Hb=0;Hb<sd.length;Hb++)for(var xd=sd[Hb],Pc=0;Pc<xd.length;Pc++)for(var Jd=xd[Pc],zd=0;zd<Jd.length;zd++)Aa[b.id].push(Jd[zd]);for(var Ad=a.particles,Hb=0;Hb<Ad.length;Hb++){var td=Ad[Hb].dupli_object;td&&(td.xF=!0,Aa[b.id].push(td));var Kd=Ad[Hb].dupli_group;if(Kd)for(var Ld=Kd.objects,
Pc=0;Pc<Ld.length;Pc++)td=Ld[Pc],td.xF=!0,Aa[b.id].push(td)}for(var Bd=Aa[b.id],Hb=Bd.length-1;0<=Hb;Hb--)Bd[Hb].qd||Bd.splice(Hb,1);for(var Md=Aa[b.id],rc=0;rc<Md.length;rc++)if(zc=Md[rc],!b.Mb&&zc.parent&&-1<Ob.indexOf(zc.parent.type)&&(zc.parent=""),"MESH"==zc.type){var Cd=Ga.IQ(zc);Cd&&(a.meshes.push(Cd),zc.data=Cd)}for(var Dd=0;Dd<a.scenes.length;Dd++){var Nd=a.scenes[Dd],Ed=Nd.world;Ed.qd||(Ed.qd=[]);Ed.qd.push(b.Mb?Nd:Ya)}for(var Od=a.node_groups,Pd=a.materials,md=0;md<Od.length;md++){var ud=
Od[md].node_tree;if(ud){var yd=[];f(ud,yd,!0);ud.kz=yd}}for(md=0;md<Pd.length;md++)if(ud=Pd[md].node_tree)yd=[],f(ud,yd,!1),ud.kz=yd;for(var Fd=0;Fd<a.scenes.length;Fd++){var Gd=a.scenes[Fd];if(Gd.b4w_use_logic_editor){var Qd=v(Gd);Ga.PQ(Qd,Gd)}}for(var Hd=0;Hd<a.scenes.length;Hd++){var Rd=a.scenes[Hd],Id=b.Mb?Rd:Ya;Boolean(O(b.id,Id,"SPEAKER").length)&&!Id.Rc&&V.UQ(Id)}g(b,c)}function k(a,b){for(var c=oa(b.Tg),d=[],f=[],e=0;e<a.speakers.length;e++){var g=a.speakers[e],h=g.sound.uuid;if(-1==f.indexOf(h)){f.push(h);
switch(g.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var k=la.Ux;break;case "BACKGROUND_MUSIC":k=la.Vx}g=Da.gj(c+g.sound.filepath);la.Vm(g);da(d,h,k,g,b.gk)}}d.length&&la.Ud(d,function(){},function(){})}function f(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],g=e.type;if("GROUP"==g&&e.node_group){if(e=e.node_group.node_tree)if(c)f(e,b,!0);else for(e=e.kz,g=0;g<e.length;g++){var h=e[g];-1==b.indexOf(h)&&b.push(h)}}else-1!=Wb.indexOf(g)&&-1==b.indexOf(g)&&b.push(g)}}function v(a){var b=
[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);c(a.objects,"ALL",b);return b}function c(a,b,d){for(var f=0;f<a.length;f++){var e=a[f];"ALL"!=b&&b!=e.type||d.push(e);(e=e.dupli_group)&&c(e.objects,b,d)}}function C(a,b,c,d){d[b]=d[b]||[];for(var f=d[b],e=0;e<a.length;e++){var g=a[e],h=na(g);f[h]=f[h]||[];(c||-1==Ob.indexOf(g.type))&&-1==f[h].indexOf(g)&&f[h].push(g);(g=g.dupli_group)&&C(g.objects,b+1,c,d)}}function O(a,b,c){var d=[];a=Aa[a];for(var f=0;f<a.length;f++){var e=a[f];if(e.type==
c||"ALL"==c)for(var g=0;g<e.qd.length;g++)b==e.qd[g]&&d.push(e)}return d}function J(a,b,c,d,f){var e=Aa[b.id],g=a.worlds;d=b.id;for(var h=0;h<e.length;h++){for(var k=e[h],q=pa.Mq(k.name,k.type,k.origin_name),p=0;p<k.qd.length;p++)pa.Zp(q,k.qd[p]);k.pb=q;Ca.Wk(k,q);q.k.Ue=d;q.Gr=k.xF||!1}for(d=0;d<g.length;d++){h=g[d];k="%meta_world%"+h.name;k=pa.Mq(k,"WORLD",k);for(q=0;q<h.qd.length;q++)pa.Zp(k,h.qd[q]);h.pb=k;Ca.B_(h,k)}d=Ca.cm(b.id);for(h=0;h<e.length;h++)k=e[h],q=k.pb,xa.Wk(k,q);for(h=0;h<g.length;h++)k=
g[h],xa.Wk(k,k.pb);if(b.Mb)for(g=b.id,h=0;h<a.scenes.length;h++)for(var k=a.scenes[h],q=0,p=Ca.Ub(k,"LAMP",g),l=0;l<p.length;l++)pa.ka(p[l],k).xm=q++;for(h=0;h<e.length;h++)k=e[h],q=k.pb,q.Gr||(Ca.o_(k,q),Sa.D(q));for(a=0;a<e.length;a++)if(g=e[a],h=g.pb,pa.$d(h)||pa.bo(h))if(k=g.lod_levels.length)for(q=h,h.k.co=!0,p=0;p<k;p++)if(l=g.lod_levels[p].object){l=l.pb;l.k.co=!0;l.k.dh=h.k.dh;q.k.ef=g.lod_levels[p].distance;l.k.bh=g.lod_levels[p].distance;if(g.lod_levels[p+1])l.k.ef=g.lod_levels[p+1].distance;
else{l.k.ef=pa.Ip;break}q=l}else{q.k.ef=g.lod_levels[p].distance;break}for(e=0;e<d.length;e++)if(a=d[e],"MESH"==a.type&&(g=a.Xt)){var g=g.k,h=a.k.Di,k=[],m;for(m in h)q=h[m],k.push(4*q.CA,4*q.Jj);g.$v.push(k);g.No.push(a.k)}e=m=-1;a=wa.DI();for(g=0;g<d.length;g++)h=d[g],k=h.k,pa.$d(h)&&k.hk&&(h=k.eh,h>m&&(m=h),a>=h&&h>e&&(e=h));for(g=0;g<d.length;g++)h=d[g],k=h.k,pa.$d(h)&&k.hk&&(k.Xl=!0,m<a?k.eh=m:k.eh<=a?k.eh=e:(va.warn('too many bones for "'+h.name+'" / '+k.eh+" bones (max "+a+" with blending, "+
2*a+" without blending). Blending between frames will be disabled."),k.eh=m,k.Xl=!1),k.Xl=k.Xl&&!Qa.WH);for(m=0;m<d.length;m++)if(e=d[m],e.af)if(a=e.of,"CHASSIS"==a.gf){e.v={};e.v.ir=a.ir;e.v.oq=a.oq;e.v.ID=a.ID;e.v.KD=a.KD;e.v.JD=a.JD;e.v.tE=a.tE;e.v.ZC=a.ZC;e.v.ZB=a.ZB;e.v.On=0;e.v.nq=1;e.v.Uo=0;e.v.speed=0;e.v.Lm=[];e.v.ms=[];e.v.Wo=null;h=(g=pa.Ri(e))?pa.eB(g,d):d;for(g=0;g<h.length;g++)k=h[g],k.af&&(q=k.of,Ba.SV(k)&&a.name==q.name?(q=Ba.a0(k.of.gf),e.v.Lm[q]=k,e.v.ms[q]=new Float32Array(8)):
Ba.KJ(k)&&a.name==q.name?(e.v.Wo=k,e.v.Vo=q.Vo,e.v.Ms=q.Ms,e.v.Er=q.Er,q=fa.invert(e.k.n,fa.create()),k=fa.multiply(q,k.k.n,q),e.v.uM=k,q=new Float32Array([1,0,0]),fa.wd(q,k,q),e.v.tM=q):Ba.JJ(k)&&a.name==q.name?(e.v.BD=k,e.v.Ks=q.Ks,e.v.lo=q.lo,q=fa.invert(e.k.n,fa.create()),k=fa.multiply(q,k.k.n,q),e.v.pM=k,q=new Float32Array([1,0,0]),fa.wd(q,k,q),e.v.oM=q):Ba.LJ(k)&&a.name==q.name&&(e.v.MD=k,e.v.Uq=q.Uq,q=fa.invert(e.k.n,fa.create()),k=fa.multiply(q,k.k.n,q),e.v.GM=k,q=new Float32Array([1,0,0]),
fa.wd(q,k,q),e.v.FM=q));4!=e.v.Lm.length&&Da.q("Not enough wheels for chassis "+e.name)}else if("HULL"==a.gf)for(e.v={},e.v.Lm=[],e.v.ms=[],e.v.ir=a.ir,e.v.oq=a.oq,e.v.Vl=a.Vl,e.v.gn=a.gn,e.v.hn=a.hn,e.v.On=0,e.v.nq=1,e.v.Uo=0,e.v.speed=0,e.v.Wo=null,h=(g=pa.Ri(e))?pa.eB(g,d):d,g=0;g<h.length;g++)k=h[g],k.af&&(q=k.of,Ba.RV(k)&&a.name==q.name?(e.v.Lm.push(k),e.v.ms.push(new Float32Array(8))):Ba.KJ(k)&&a.name==q.name?(e.v.Wo=k,e.v.Vo=q.Vo,e.v.Ms=q.Ms,e.v.Er=q.Er,q=fa.invert(e.k.n,fa.create()),k=fa.multiply(q,
k.k.n,q),e.v.uM=k,q=new Float32Array([1,0,0]),fa.wd(q,k,q),e.v.tM=q):Ba.JJ(k)&&a.name==q.name?(e.v.BD=k,e.v.Ks=q.Ks,e.v.lo=q.lo,q=fa.invert(e.k.n,fa.create()),k=fa.multiply(q,k.k.n,q),e.v.pM=k,q=new Float32Array([1,0,0]),fa.wd(q,k,q),e.v.oM=q):Ba.LJ(k)&&a.name==q.name&&(e.v.MD=k,e.v.Uq=q.Uq,q=fa.invert(e.k.n,fa.create()),k=fa.multiply(q,k.k.n,q),e.v.GM=k,q=new Float32Array([1,0,0]),fa.wd(q,k,q),e.v.FM=q));for(m=0;m<d.length;m++)if(e=d[m],e.rm&&(a=e.Rn,"MAIN_BODY"==a.gf))for(e.cg={},e.cg.Vl=a.Vl,e.cg.gn=
a.gn,e.cg.hn=a.hn,e.cg.eu=[],g=(g=pa.Ri(e))?pa.eB(g,d):d,h=0;h<g.length;h++)k=g[h],k.rm&&(q=k.Rn,Ba.WV(k)&&a.name==q.name&&(e.cg.eu.push(k),k.nG=k.Rn.EM));f(b,c)}function K(a,b,c,d,f){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];e.Cj=e.camera.pb}for(d=0;d<a.scenes.length;d++){var e=b.Mb?a.scenes[d]:Ya,g=b.Mb?Ca.Ub(e,"LAMP",b.id):Ca.Ub(e,"LAMP",0),h=Ca.Ub(e,"ALL",b.id),k=O(b.id,e,"MESH"),q=O(b.id,e,"EMPTY");O(b.id,e,"WORLD");b.Mb&&I.sQ(e,h,g,k,q);for(var h=!1,p=0;p<q.length;p++)for(var l=q[p].pb,
m=l.I,n=0;n<m.length;n++){var r=m[n].yb,u=I.dN(r,l);e.name==r.name&&(h=h||u)}b.Mb&&e.s.Mc&&!h&&va.warn('Scene "'+e.name+'" has water but has no wind. Using default settings.');q=[];I.Pw(e);ha.KU(e,k,g,q);p=O(b.id,e,"LINE");ha.JU(e,p);l=I.hB(e);if(b.Mb){h=e.s.ex;p=e.world;if(h.cL||h.procedural_skydome)m=p.pb,ha.xQ(e,h,m),ha.jA(m,l,e);I.bI(e,l);(h=e.s.qp)&&h.Ws&&ha.pQ(e,p.pb)}for(p=0;p<k.length;p++)ha.jA(k[p].pb,l,e);for(p=0;p<q.length;p++)ha.jA(q[p],l,e),Ca.cX(q[p]);h=Ca.Ub(e,"ALL",b.id);I.QQ(e,h,
g);for(p=0;p<h.length;p++)l=h[p],l.k.Le&&Ca.c_(l),pa.QR(l)&&(l.nK=!0)}I.tQ(Ya,a.textures,b.id);b.Mb&&Ya.s.np.length&&(b.uB=!0);f(b,c)}function D(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c],f=Boolean("FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==ra.Hq);d.Dh=f;d.Tp=f?"dds":""}if((La.BA||La.Cw)&&ra.lN)for(a=0;a<b.length;a++){for(var d=b[a],e=d.texture_slots,c=0;c<e.length;c++){var f=e[c],g=f.texture;if("IMAGE"==g.type||"ENVIRONMENT_MAP"==g.type){var h=g.image;h&&
!h.Dh&&(f=!g.b4w_disable_compression&&!f.use_map_normal&&"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&"MOVIE"!=h.source,Q(h,f))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){e=d[c];f=!1;if("TEXTURE"==e.type){if((g=e.texture)&&(h=g.image)&&!h.Dh&&(f=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{f=e.outputs;for(e=0;e<f.length;e++)if(g=f[e],g.is_linked&&"Normal"==g.identifier){f=!0;break a}f=!1}f=!f}}else"TEX_IMAGE"==e.type?(h=e.image)&&!h.Dh&&(f="MOVIE"!=
h.source):"TEX_ENVIRONMENT"==e.type&&(f=!1);h&&!h.Dh&&Q(h,f)}}}function Q(a,b){-1<a.filepath.indexOf(".dds")?(a.Dh=!0,a.Tp="dds"):(a.Dh=b)?(a.Tp=ra.Hq,a.filepath="dds"==ra.Hq?a.filepath+".dds":la.Vm(a.filepath)[0]+".pvr"):a.Tp=""}function L(a,b,c,d,f){d=a.groups;for(var e=a.objects,g={},h={},k={},q={},p=0;p<d.length;p++){var l=d[p];g[l.uuid]=l;k[l.uuid]=l}for(p=0;p<e.length;p++)l=e[p],h[l.uuid]=l,q[l.uuid]=l;a=a.scenes;for(p=0;p<a.length;p++)H(a[p].objects,null,q,k,null);for(var m in k)m in g||d.push(k[m]);
for(m in q)m in h||e.push(q[m]);f(b,c)}function H(a,b,c,d,f){for(var e=[],g=0;g<a.length;g++){var h=a[g],k=c[h.uuid];if(h=k.proxy){b&&-1==e.indexOf(h.uuid)&&e.push(h.uuid);for(var q=c[h.uuid],p=q.constraints,h=0;h<p.length;h++){var l=Da.Ih(p[h]);l.name+="_CLONE";k.constraints.push(l)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(q.animation_data=Da.Ih(k.animation_data)),q.b4w_use_default_animation=k.b4w_use_default_animation,q.b4w_auto_skel_anim=k.b4w_auto_skel_anim,
q.b4w_anim_behavior=k.b4w_anim_behavior,q.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=0;g<e.length;g++)k=Da.hV(a,e[g]),-1<k&&a.splice(k,1);e={};if(b)for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],p=Da.Ih(k),q="origin_name"in k?k.origin_name:k.name,p.name=pa.aI(b.name,q),p.origin_name=q,p.dg_parent={uuid:b.uuid},z(p),c[p.uuid]=p,e[h.uuid]=p.uuid,h.uuid=p.uuid,f&&f[k.uuid]&&(p.b4w_cluster_data=f[k.uuid]);for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],k.dupli_group&&(h=k.dupli_group,f=d[h.uuid],p=Da.Ih(f),
p.name=Da.Ps(f.name+"_CLONE"),p.uuid=ja.qJ("Group"+p.name),d[p.uuid]=p,h.uuid=p.uuid,H(p.objects,k,c,d,k.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){h=a[g];k=c[h.uuid];k.parent&&k.parent.uuid in e?k.parent.uuid=e[k.parent.uuid]:k.parent&&(va.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);p=k.constraints;for(h=0;h<p.length;h++)b=p[h],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);if(b=k.pose)for(d=b.bones,h=0;h<d.length;h++)if(f=
d[h].constraints)for(p=0;p<f.length;p++)b=f[p],b.target&&b.target.uuid in e&&(b.target.uuid=e[b.target.uuid]);b=k.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in e&&(d.object.uuid=e[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(h=0;h<k.length;h++)b=k[h],b.object&&b.object.uuid in e&&(b.object.uuid=e[b.object.uuid])}for(var m in e)Ka[m]=e[m]}function z(a){a.uuid=ja.qJ("Object"+a.name)}function d(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var f=c[d];"TEXTURE"==f.type&&f.texture&&
p(f,"texture",b);"LAMP"==f.type&&f.lamp&&(f.lamp.uuid in Ka&&(f.lamp.uuid=Ka[f.lamp.uuid]),b[f.lamp.uuid]||(f.lamp=null));"GROUP"==f.type&&f.node_group&&p(f,"node_group",b);"TEX_IMAGE"!=f.type&&"TEX_ENVIRONMENT"!=f.type||!f.image||p(f,"image",b)}f=a.links;for(d=0;d<f.length;d++){var e=f[d];M(e,"from_node",c);M(e,"to_node",c);x(e,"from_socket",e.from_node.outputs);x(e,"to_socket",e.to_node.inputs)}if(c=a.animation_data)if(c.action&&p(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(f=
c.nla_tracks[d],e=0;e<f.strips.length;e++)f.strips[e].action&&p(f.strips[e],"action",b)}function p(a,b,c){(c=c[a[b].uuid])||va.error("Dangling link found:",b,a);a[b]=c}function M(a,b,c){c=Da.Dd("name",a[b].name,c);a[b]=c}function x(a,b,c){c=Da.Dd("identifier",a[b].identifier,c);a[b]=c}function g(a,b,c,d,f,g){var h=[],k={};d=a.images;for(var q=Ha.CI(),p=oa(b.Tg),l=0;l<d.length;l++){var m=d[l],n=m.uuid;if(n){var r=Da.gj(p+m.filepath),u=m.source;if("FILE"===u){var u=m.Dh?la.ht:la.it,t=la.Vm(r),M=t[1].toLowerCase();
if(!la.PR(M)){va.error("image ",m," has unsupported format.");continue}La.cC&&ra.use_min50&&("dds"==t[1]?(r=la.Vm(t[0]),r=r[0]+".min50."+r[1]+".dds"):r=t[0]+".min50."+t[1])}else if("MOVIE"===u)if(ra.zs)t=la.Vm(r),r=t[0]+".altconv.seq",u=la.jt;else{t=la.Vm(r);M=t[1].toLowerCase();u=V.CT(M);if(""==u){va.error("failed to load video file (unsupported format)",r);continue}r=u!=M?t[0]+".altconv."+u:t[0]+"."+t[1];u=la.kt}else{va.error('Image "'+m.name+'" has unsupported format "'+u+'".');continue}if(!b.gk)for((n in
k)||(k[n]=[]),t=0;t<q.length;t++)M=q[t],M.Zn==n&&M.lm==m.Tp&&k[n].push(M);k[n].length&&h.push({id:n,type:u,url:r,Yg:b.gk})}}if(h.length){var x=0;la.Ud(h,function(d,f,q,p){if(d){var l=q;if(!b.gk){f=k[f];for(l=0;l<f.length;l++){var m=f[l];if(q==la.jt)m.xs=d.Vg,Ha.Rs(m,d.images,b.id);else if(Ha.Rs(m,d,b.id),"ENVIRONMENT_MAP"==m.source)for(m=0;m<a.scenes.length;m++)I.gE(a.scenes[m])}l=f[0].lm}q==la.kt||q==la.jt?(q==la.kt?(q=d.videoWidth,d=d.videoHeight):(q=d.images[0].width,d=d.images[0].height),va.log("%cLOAD VIDEO "+
q+"x"+d,"color: #"+(2048<q||2048<d?"a00":1024<q||1024<d?"aa0":"0a0"),p),-1==p.indexOf(ab)&&va.warn("video",p,"is not from app root.")):e(d,p,!0,l)}p=++x/h.length;g(b,c,p)},function(){va.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})}else f(b,c)}function P(a,b,c,d,f){a=I.kB();for(d=0;d<a.length;d++){var e=a[d];if(e.b4w_use_nla){var g=e.b4w_nla_cyclic;e.b4w_use_logic_editor&&(g=!1);xa.u_(e,g,b.id)}}f(b,c)}function t(a,b,c,d,f,e){a=oa(b.Tg);var g=[],h={};d=Ca.cm(b.id);for(var k=0;k<d.length;k++){var q=
d[k];if(pa.Jr(q)&&V.nM(q)!=V.zE){var p=q.X.wj;"BACKGROUND_MUSIC"==V.mB(q)?(p=Da.YA(),b.sB=!0):"NONE"!=V.mB(q)&&ra.yB&&(b.xB=!0);if(!(p in h)){h[p]=[];var l=Da.gj(a+q.X.Tg);switch(V.nM(q)){case V.Tx:var m=la.Ux;break;case V.yE:m=la.Vx}da(g,p,m,l,b.gk)}h[p].push(q)}}if(g.length){var n=0;la.Ud(g,function(a,d,f,k){if(a)for(va.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(ab)&&va.warn("sound",k,"is not from app root."),d=h[d],f=0;f<d.length;f++)V.z_(d[f],a);a=++n/g.length;e(b,c,a)},function(){va.log("%cLOADED ALL SOUNDS",
"color: #0aa");f(b,c)})}else f(b,c)}function da(a,b,c,d,f){var e=la.Vm(d),g=e[1].toLowerCase(),h=V.AT(g);""!=h?(d=h!=g?e[0]+".altconv."+h:e[0]+"."+e[1],a.push({id:b,type:c,url:d,Yg:f})):va.error("failed to load audio file (unsupported format)",d)}function G(a,b,c){a=Ca.Ub(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];pa.Jr(d)&&(V.QV(d)||c)&&V.HK(d)}}function F(a,b){for(var c=a.s.np,d=0;d<c.length;d++){var f=c[d].s;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=f.et||(Ha.gL(f),Ha.JK(f))}}
function U(a,b,c,d,f){xa.start();va.log("%cSTART NLA","color: #0a0");f(b,c)}function R(a,b,c,d,f){if(b.lod_levels&&b.lod_levels.length)for(var e=b.lod_levels.length,g=0;g<e;g++){var h=b.lod_levels[g],k=h.object;if(k){var q=Da.zq(k);q.name=b.name+"_LOD_"+String(g+1);q.b4w_cluster_data=b.b4w_cluster_data;z(q);q.lod_levels=[];c&&(q.dg_parent=c);d.push([a,q]);f.push(k);h.object=q}}}function Z(a,b,c,d,f){d=!0;for(var e=0;e<a.scenes.length;e++)if(!Ba.UR(a.scenes[e])){d=!1;break}d&&(f(b,c),va.log("%cPHYSICS READY",
"color: #0a0"))}function u(a,b,c,d,f){for(d=0;d<a.scenes.length;d++){var e=a.scenes[d];if(b.Mb)var g=Ba.Lw(e);else g=Ba.Lw(Ya)||Ba.Lw(e),e=Ya;if(Ta.enabled&&g)for(g=0;g<ic.length;g++)for(var h=Ca.Ub(e,ic[g],b.id),k=0;k<h.length;k++){var q=h[k];q.k.Ue==b.id&&(Ba.yn(q,e),b.YJ&&Ba.oa(q)&&Ba.IA(q))}}f(b,c)}function ga(a,b,c,d,f){var g={};d=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var q=h[k];if(q.s.Mc){var p=q.s.Mc.Lk;if(p&&"FILE"===p.source){var q=p.uuid,l=Da.gj(oa(b.Tg)+p.filepath);d.push({id:q,
type:p.Dh?la.ht:la.it,url:l});g[q]=p}}}d.length?la.Ud(d,function(a,c,d,f){if(a){e(a,f,!0);d=[];f=Ha.CI();for(var k=0;k<f.length;k++){var q=f[k];q.uri===c&&d.push(q)}for(c=0;c<d.length;c++)Ha.Rs(d[c],a,b.id);for(c=0;c<h.length;c++)if(d=h[c],d.s.Mc&&(f=d.s.Mc.Lk,f===p)){var q=a,l=document.createElement("canvas");f=p.size[0];k=p.size[1];l.width=f;l.height=k;l=l.getContext("2d");l.drawImage(q,0,0);q=l.getImageData(0,0,f,k).data;l=new Float32Array(4);l[0]=1/16581375;l[1]=1/65025;l[2]=1/255;l[3]=1;f*=k;
for(var k=new Float32Array(f),m=0;m<f;m++)k[m]=l[1]*q[4*m+2]+l[2]*q[4*m+3];d.s.wD=k}}else for(a=g[c],c=0;c<h.length;c++)d=h[c],f=d.s.Mc.Lk,f===a&&(d.s.Mc.Lk=null,va.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,c)}):f(b,c)}function ca(a,b,c,d,f){d=a.scenes[0];a=[];for(var g=[Cb.Ht,Cb.Pp,Cb.It,Cb.ez],h=0;h<g.length;h++){var k=I.La(d,g[h]);k&&a.push(k)}if(a.length){d=[];h=la.it;d.push({id:"SEARCH_TEXTURE",type:h,Tg:ta.Fe.smaa_search_texture_path});d.push({id:"AREA_TEXTURE",
type:h,url:ta.Fe.smaa_area_texture_path});for(h=0;h<a.length;h++)if(g=a[h],g.type==Cb.Pp){a=g.Za;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var q=g.kb;else if("u_area_tex"==g.to)var p=g.kb;break}d.length?la.Ud(d,function(a,c,d,f){a&&(e(a,f,!1),c="SEARCH_TEXTURE"==c?q:p,c.source="IMAGE",Ha.Rs(c,a,b.id),Ha.fD(c,Ha.K,Ha.K))},function(){f(b,c)}):f(b,c)}else f(b,c)}function E(a,b,c,d){for(c=0;c<a.scenes.length;c++){var f=a.scenes[c];b.Mb||(f=Ya);for(var e=Ca.Ub(f,"LAMP",b.id),g=0;g<e.length;g++){var h=
e[g];h.k.Ue==b.id&&d.nz.push({yb:f,ea:h})}e=Ca.Ub(f,"ALL",b.id);for(g=0;g<e.length;g++)h=e[g],"LAMP"!=h.type&&h.k.Ue==b.id&&(b.YJ&&pa.$d(h)&&I.tq(h,!0),d.nz.push({yb:f,ea:h}))}}function aa(a,b,c,d,f,e){var g=d.nz;f=d.tK;if(g.length){a=g[f].ea;var h=g[f].yb;f=pa.ka(a,h);I.yn(h,a,!1);!a.anchor||h.s.xv||h.s.anaglyph_use||ya.append(a);d=++d.tK/g.length;g=f.Ji;if(-1!=a.k.Rd&&g){var k=qa.copy(a.k.lb.F,kb);I.cN(g,k)}g=a.ss;if(g.length&&h.s.ei)for(h=fa.G(a.k.n),a=fa.P(a.k.n),f=f.bi,k=0;k<f.length;k++)I.fN(f[k],
h,a),pa.gN(g,f[k].p.rc)}else d=1;e(b,c,d)}function ia(a,b,c,d,f){if(b.Mb){d=I.Rh();I.gE(d);var e=I.kB();for(a=0;a<e.length;a++){var g=e[a];I.gE(g);I.zX(g,d)}I.Pw(d)}else I.hN(Ya);d=Ca.cm(b.id);Ca.p_(d);for(e=0;e<d.length;e++)for(g=d[e],a=0;a<g.I.length;a++)for(var h=g.I[a].W,k=0;k<h.length;k++)null==h[k].zb&&h.splice(k--,1);f(b,c)}function q(a,b,c,d,f){if(b.Mb)for(a=I.kB(),d=0;d<a.length;d++){var e=a[d];e.b4w_use_logic_editor&&ka.KV(e,b.id)}f(b,c)}function T(a,b,c,d,f){if(b.Mb)for(d=0;d<a.scenes.length;d++)F(a.scenes[d],
b.id),G(a.scenes[d],b.id,!1);else F(Ya,b.id),G(Ya,b.id,!1);f(b,c)}function ba(a,b,c,d,f){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ra.media_auto_activation&&(b.uB||b.sB||b.xB)?lb||S(a,f,b,c):f(b,c)}function S(a,b,c,d){var f=qb.parentElement;wb=f.style.zIndex;f.style.zIndex="999";lb=document.createElement("div");lb.style.position="relative";lb.style.height="88px";lb.style.width="88px";var e=Math.round(qb.offsetWidth/2-44);lb.style.top=Math.round(qb.offsetHeight/2-44).toString()+"px";lb.style.left=
e.toString()+"px";lb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
lb.style.backgroundSize="88px";nb=document.createElement("div");nb.style.position="relative";nb.style.height=qb.offsetHeight.toString()+"px";nb.style.width=qb.offsetWidth.toString()+"px";nb.style.background="rgba(0, 0, 0, 0.5)";nb.style.zIndex="999";f.appendChild(nb);nb.appendChild(lb);lb.addEventListener("click",function(){c.uB&&(Ha.play(),Ha.pause(),Ha.reset());if(c.sB){if(c.Mb)for(var f=0;f<a.scenes.length;f++)G(a.scenes[f],c.id,!0);else G(Ya,c.id,!0);V.pause()}c.xB&&V.IK();sa();b(c,d)},!1)}function sa(){if(lb){var a=
qb.parentElement;a.style.zIndex=wb;nb.removeChild(lb);a.removeChild(nb);lb=nb=null;wb=0}}function oa(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function Y(a){wa.Dc(a)&&wa.remove(a);Pa.IX(a);Ca.lu(a);ma.vq(a)&&ma.hf(a);Ba.oa(a)&&Ba.ts(a);I.JX(a);pa.Jr(a)&&V.gZ(a);ya.PV(a)&&ya.remove(a)}function na(a){var b=wa.oI(a);return(a=b&&b.parent==a?null:a.parent||b)?1+na(a):0}var ya=l("__anchors"),wa=l("__animation"),la=l("__assets"),ha=l("__batch"),ta=l("__config"),ma=l("__controls"),N=l("__texcomp"),
ea=l("__debug"),B=l("__extensions"),za=l("__input"),ua=l("__loader"),ja=l("__md5"),xa=l("__nla"),ka=l("__logic_nodes"),Pa=l("__particles"),Ea=l("__nodemat"),Ca=l("__objects"),pa=l("__obj_util"),Ba=l("__physics"),va=l("__print"),Ma=l("__quat"),Ga=l("__reformer"),Ra=l("__renderer"),I=l("__scenes"),V=l("__sfx"),X=l("__shaders"),Cb=l("__subscene"),Ha=l("__textures"),Ac=l("__time"),Sa=l("__transform"),fa=l("__tsr"),Da=l("__util"),qa=l("__vec3"),W=l("__vec4"),Qa=ta.sl,ra=ta.B,La=ta.Pd,Ta=ta.C,pb=ta.X,Ua=
null,Aa=null,ab="",Ya=null,Ka={},kb=new Float32Array(3),eb=new Float32Array(4),bb=new Float32Array(4),sb=new Float32Array(4),lb=null,nb=null,wb=0,Va=!1,Ob=["LAMP","CAMERA"],ic=["MESH","CAMERA","EMPTY"],Wb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],qb=null;a.$g=function(a){return ua.$g(a)};a.update=function(){ua.v_(Ua)};a.RY=function(a){qb=a};a.m_=function(a,b){if(lb){nb.style.height=b.toString()+"px";nb.style.width=a.toString()+"px";var c=Math.round(a/2-44);lb.style.top=Math.round(b/2-44).toString()+"px";
lb.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,e){var h={load_main:{Nb:ua.zg,Qb:!1,L:[],Wb:!1,Yb:500,kc:!1,ac:b},duplicate_objects:{Nb:ua.ue,Qb:!1,L:["load_main"],Wb:!1,Yb:50,kc:!1,ac:L},load_binaries:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:y},wait_for_shaders:{Nb:ua.ue,Qb:!1,L:[],Wb:!1,Yb:50,kc:!0,Lj:r},prepare_bindata:{Nb:ua.ue,Qb:!1,L:["duplicate_objects","load_binaries"],Wb:!1,Yb:100,kc:!1,ac:A},prepare_bpy_data:{Nb:ua.ue,Qb:!1,L:["duplicate_objects","prepare_bindata"],
Wb:!1,Yb:100,kc:!1,ac:m},process_objects:{Nb:ua.ue,Qb:!1,L:["prepare_bpy_data"],Wb:!1,Yb:150,kc:!1,ac:J},process_scenes:{Nb:ua.ue,Qb:!1,L:["process_objects","wait_for_shaders"],Wb:!1,Yb:300,kc:!1,ac:K},load_smaa_textures:{Nb:ua.zg,Qb:!1,L:["process_scenes"],Wb:!1,Yb:30,kc:!0,ac:ca},load_shoremap:{Nb:ua.zg,Qb:!1,L:["process_scenes"],Wb:!1,Yb:30,kc:!0,ac:ga},load_images:{Nb:ua.zg,Qb:!0,L:["process_scenes"],Wb:!0,Yb:500,kc:!1,ac:g},update_scenes_nla:{Nb:ua.ue,Qb:!1,L:["process_scenes","load_images"],
Wb:!1,Yb:50,kc:!1,ac:P},wait_physics_workers:{Nb:ua.ue,Qb:!1,L:["load_shoremap"],Wb:!1,Yb:20,kc:!1,Lj:Z},add_physics_objects:{Nb:ua.ue,Qb:!1,L:["wait_physics_workers"],Wb:!1,Yb:50,kc:!1,ac:u},add_objects:{Nb:ua.ue,Qb:!1,L:["add_physics_objects"],Wb:!1,Yb:600,kc:!1,ac:E,Lj:aa,qq:ia,rq:{nz:[],tK:0}},init_logic_nodes:{Nb:ua.ue,Qb:!1,L:["update_scenes_nla","add_objects"],Wb:!1,Yb:50,kc:!1,ac:q},load_speakers:{Nb:ua.zg,Qb:!0,L:["add_objects"],Wb:!0,Yb:100,kc:!1,ac:t},mobile_media_start:{Nb:ua.ue,Qb:!1,
L:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Wb:!0,Yb:5,kc:!1,ac:ba,Lj:ba},synchronize_media:{Nb:ua.ue,Qb:!0,L:["mobile_media_start"],Wb:!0,Yb:50,kc:!1,ac:T},start_nla:{Nb:ua.ue,Qb:!0,L:["mobile_media_start"],Wb:!1,Yb:5,kc:!0,ac:U}},k=ua.lB();k||(k=ua.hH(),Ua={},Aa={},Ka={});Ua[k.qh.length]={};return ua.mH(h,a,c,d,n,f||pb.WF,ra.do_not_load_resources,e,!1)};a.yx=function(a){var b=ua.lB();if(!b||!b.qh.length||a&&!ua.GZ(b.qh[a]))va.error("Unable to unload data!");else{if(0==
a)va.log("%cUNLOAD ALL","color: #00a"),ya.ua(),wa.ua(),V.ua(),ha.ua(),I.ua(),ua.ua(),ma.ua(),Ba.ua(),Ca.ua(),Da.ua(),Ra.ua(),Ea.ua(),X.ua(),B.ua(),la.ua(),Ha.ua(),ka.ua(),Pa.ua(),za.ua(),ea.ua(),Aa=null,Ka={},Ua=Ya=null,Va=!1;else{va.log("%cUNLOAD DATA "+a,"color: #00a");wa.GX(a);for(var b=Ca.cm(Ca.oc),c=0;c<b.length;c++){var d=b[c];pa.jB(d)!=a&&Ca.mw(d,!1,!1,!1)}b=Ca.cm(a);for(c=b.length-1;0<=c;c--)d=b[c],Y(d),Ca.ts(d);b=Ca.cm(Ca.oc);for(c=0;c<b.length;c++)Ca.mw(b[c],!0,!0,!0)}xa.ua(a);sa()}};a.yX=
Y;a.xL=function(a){ab=a};a.EF=function(){Va||ra.media_auto_activation||(Ha.play(),Ha.pause(),Ha.reset(),G(Ya,Ca.oc,!0),V.pause(),ra.yB&&V.IK(),Va=!0)};a.reset=function(){qb=null};a.KK=function(a,c,d){var f={load_main:{Nb:ua.zg,Qb:!1,L:[],Wb:!1,Yb:500,kc:!1,ac:b},load_binaries:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:y},load_images:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:g},preload_sounds:{Nb:ua.zg,Qb:!1,L:["load_main"],Wb:!1,Yb:500,kc:!1,ac:k}},e=ua.lB();e||(e=ua.hH(),Ua=
{},Aa={},Ka={});Ua[e.qh.length]={};return ua.mH(f,a,c,d,n,!1,ra.do_not_load_resources,!1,!0)};a.aN=function(){la.cS()}};b4w.module.__controls=function(a,l){function n(a,b){b||(b=v.Ce());return{type:a,value:0,Z:null,element:b,Ka:!1,key:0,bc:"",Hh:!1,Zz:null,Yz:function(){},Xz:null,SG:function(){},ji:null,from:new Float32Array(3),to:new Float32Array(3),BJ:!1,Av:!1,ps:0,ZK:function(){},axis:"",Rf:0,cp:new Float32Array(3),Dw:new Float32Array(4),threshold:0,TK:new Float32Array(4),Zt:0,Yt:0,jL:0,$t:0,Lf:0,repeat:!1,KH:!1,$l:0,callback:function(){}}}function e(a){function b(){return{Pj:new Float32Array(2),vm:!0,ea:null,identifier:-1,
Mv:!0}}a||(a=v.Ce());for(var f=0;f<P.length;f++){var e=P[f];if(a==e.element)return e}e={element:a,Kr:!0,De:0,Nv:!0,dw:0,ew:0,Am:0,Bm:0,hs:0,ks:0,rh:new Float32Array(2),re:new Float32Array(2),sh:new Float32Array(2),Ie:new Float32Array(2),sx:0,aE:0,UM:0,We:new Uint8Array(256),Px:0,pB:null,$h:b(),Ym:Array(10),HB:!1,lJ:K.create(),pv:0,ov:0,nv:0,rB:0,qB:0,mv:Infinity,tC:null,sC:null,iC:null,eC:null,gC:null,ZD:null,YD:null,hC:null,fC:null,EC:null,S6:null,$D:null,XD:null,WD:null,ij:{}};for(f=0;10>f;++f)e.Ym[f]=
b();e.tC=function(a){e.HB||(c.xV(a,e.lJ),e.HB=!0)};e.sC=function(a){a=H.copy(a,G);e.nv=a[0];e.ov=a[1];e.pv=a[2];Infinity==e.mv&&(e.mv=a[0],e.qB=a[1],e.rB=a[2])};e.iC=function(a){e.Px+=a*z.WW};e.eC=function(a){var b=c.ga(c.ad,e.element),b=c.Ti(b,c.wi,t);e.dw=b[0];e.ew=b[1];e.Am=b[0];e.Bm=b[1];if(3==e.De||0==e.De)e.De=1;e.which=a};e.gC=function(){var a=c.ga(c.ad,e.element),a=c.Ti(a,c.wi,t),a=v.nu(a[0],a[1],t);e.$h.vm=!1;e.$h.Pj[0]=a[0];e.$h.Pj[1]=a[1]};e.ZD=function(a){for(var b=0;b<a.length;++b){for(var c=
a[b],d=null,f=null,g=0;g<e.Ym.length;g++){var h=e.Ym[g];if(h.identifier==c.identifier){h.Mv&&(f=h);break}else!d&&h.Mv&&(d=h,d.identifier=c.identifier)}if(c=f||d)d=v.nu(a[b].clientX,a[b].clientY,t),c.vm=!1,c.Mv=!1,c.Pj[0]=d[0],c.Pj[1]=d[1]}};e.YD=function(a){for(var b=0;b<e.Ym.length;++b){for(var c=e.Ym[b],d=!1,f=0;f<a.length;++f)if(a[f].identifier==c.identifier){d=!0;break}d||(c.vm=!0,c.Mv=!0,c.ea=null)}};e.hC=function(a){var b=c.ga(c.ad,e.element),b=c.Ti(b,c.wi,t);e.dw=b[0];e.ew=b[1];e.Am=b[0];e.Bm=
b[1];0<e.De&&(e.De=3);e.which=a};e.fC=function(a){if(!d.Xn||e.De)e.Am=a[0],e.Bm=a[1]};e.EC=function(a){if(!d.Xn||e.De)e.hs+=a[0],e.ks+=a[1]};e.NJ=function(a){2!=e.We[a]&&(e.We[a]=1,e.Kr=!1)};e.PJ=function(){for(var a=0;a<e.We.length;a++)0!=e.We[a]&&(e.We[a]=3,e.Kr=!1)};e.QJ=function(a){e.Kr=!1;e.We[a]=3};e.$D=function(a){e.Nv=!1;if(1==a.length)e.rh[0]=a[0].clientX,e.rh[1]=-1,e.sh[0]=a[0].clientY,e.sh[1]=-1;else if(1<a.length){e.sx=e.aE=m(a);e.rh[0]=a[0].clientX;e.rh[1]=a[1].clientX;e.sh[0]=a[0].clientY;
e.sh[1]=a[1].clientY;var b=a[0];a=a[1];e.UM=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}e.re.set(e.rh);e.Ie.set(e.sh)};e.XD=function(a){1===a.length?(e.re[0]=a[0].clientX,e.re[1]=-1,e.Ie[0]=a[0].clientY,e.Ie[1]=-1):1<a.length&&(e.re[0]=a[0].clientX,e.re[1]=a[1].clientX,e.Ie[0]=a[0].clientY,e.Ie[1]=a[1].clientY,e.sx=m(a))};e.WD=function(a){0==a.length&&(e.Nv=!0)};P.push(e);return e}function b(a,b){if(b in a.ij&&0<a.ij[b])a.ij[b]+=1;else switch(a.ij[b]=1,b){case "orientation_quat":var d=c.ga(c.yh);
d&&c.yd(d,c.pn,a.tC);break;case "orientation_angles":(d=c.ga(c.yh))&&c.yd(d,c.pn,a.sC);break;case "mouse_wheel":(d=c.ga(c.ad,a.element))&&c.yd(d,c.Kp,a.iC);break;case "mouse_down_which":(d=c.ga(c.ad,a.element))&&c.yd(d,c.il,a.eC);break;case "mouse_select":(d=c.ga(c.ad,a.element))&&c.yd(d,c.il,a.gC);break;case "touch_select":if(d=c.ga(c.Ag,a.element))c.yd(d,c.ml,a.ZD),c.yd(d,c.ll,a.YD);break;case "mouse_up_which":(d=c.ga(c.ad,a.element))&&c.yd(d,c.Jp,a.hC);break;case "mouse_location":(d=c.ga(c.ad,
a.element))&&c.yd(d,c.wi,a.fC);break;case "mouse_pointerlock":(d=c.ga(c.ad,a.element))&&c.yd(d,c.NE,a.EC);break;case "keyboard_downed_keys":if(d=c.ga(c.vp,a.element))c.yd(d,c.Gp,a.NJ),c.yd(d,c.HE,a.PJ),c.yd(d,c.Hp,a.QJ);break;case "touch_start":(d=c.ga(c.Ag,a.element))&&c.yd(d,c.ml,a.$D);break;case "touch_move":(d=c.ga(c.Ag,a.element))&&c.yd(d,c.Qp,a.XD);break;case "touch_end":(d=c.ga(c.Ag,a.element))&&c.yd(d,c.ll,a.WD)}}function y(a,b){if(!(!b in a.ij)&&0<a.ij[b]&&(--a.ij[b],!a.ij[b]))switch(b){case "orientation_quat":var d=
c.ga(c.yh);d&&c.Bd(d,c.yt,a.tC);break;case "orientation_angles":(d=c.ga(c.yh))&&c.Bd(d,c.pn,a.sC);break;case "mouse_wheel":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.Kp,a.iC);break;case "mouse_down_which":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.il,a.eC);break;case "mouse_select":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.il,a.gC);break;case "touch_select":if(d=c.ga(c.Ag,a.element))c.Bd(d,c.ml,a.ZD),c.Bd(d,c.ll,a.YD);break;case "mouse_up_which":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.Jp,a.hC);break;case "mouse_location":(d=
c.ga(c.ad,a.element))&&c.Bd(d,c.wi,a.fC);break;case "mouse_pointerlock":(d=c.ga(c.ad,a.element))&&c.Bd(d,c.NE,a.EC);break;case "keyboard_downed_keys":if(d=c.ga(c.vp,a.element))c.Bd(d,c.Gp,a.NJ),c.Bd(d,c.HE,a.PJ),c.Bd(d,c.Hp,a.QJ);break;case "touch_start":(d=c.ga(c.Ag,a.element))&&c.Bd(d,c.ml,a.$D);break;case "touch_move":(d=c.ga(c.Ag,a.element))&&c.Bd(d,c.Qp,a.XD);break;case "touch_end":(d=c.ga(c.Ag,a.element))&&c.Bd(d,c.ll,a.WD)}}function r(a,b){a.value=Number(b)}function A(a){for(var b=a.Ek,c=a.eY,
d=0;d<b.length;d++)c[d]=b[d].value;return a.GW(c)}function h(a,b){a=a||M;var c=a.oh;if(c){var d=a.Pm;if(b){var f=c[b];if(f){for(var e=f.Ek,k=0;k<e.length;k++){var l=e[k],m;m=x.indexOf(l);m=-1<m?g[m]:[];1==m.length?(w(l),l=x.indexOf(l),-1<l?(x.splice(l,1),g.splice(l,1)):L.q("Sensors cache is corrupted")):1<m.length&&m.splice(m.indexOf(f),1)}delete c[b];k=d.indexOf(f);-1<k?d.splice(k,1):L.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=p.indexOf(a),-1<c?p.splice(c,1):O.error("Wrong object"))}}else{d=
[];for(b in c)d.push(b);for(k=0;k<d.length;k++)h(a,d[k])}U=!0}}function w(a){switch(a.type){case 90:J.QC(a.Zz,a.bc,a.Yz);a.Ka=!0;break;case 100:J.Uz(a.Xz);a.Ka=!0;break;case 110:J.RC(a.ps);a.Ka=!0;break;case 140:a.Ka=!0;break;case 20:var b=e(a.element);y(b,"keyboard_downed_keys");a.Ka=!0;break;case 30:b=e(a.element);y(b,"mouse_wheel");a.Ka=!0;break;case 40:b=e(a.element);y(b,"mouse_down_which");y(b,"mouse_up_which");y(b,"mouse_location");a.Ka=!0;break;case 260:b=e(a.element);y(b,"mouse_pointerlock");
a.Ka=!0;break;case 50:b=e(a.element);y(b,"mouse_down_which");y(b,"mouse_up_which");a.Ka=!0;break;case 60:b=e(a.element);y(b,"touch_start");y(b,"touch_move");y(b,"touch_end");a.Ka=!0;break;case 70:b=e(a.element);y(b,"touch_start");y(b,"touch_move");a.Ka=!0;break;case 75:b=e(a.element);y(b,"touch_start");y(b,"touch_move");a.Ka=!0;break;case 80:b=e(a.element);y(b,"touch_start");y(b,"touch_end");a.Ka=!0;break;case 170:b=e(a.element);y(b,"mouse_select");y(b,"touch_select");y(b,"touch_start");y(b,"touch_end");
y(b,"mouse_down_which");y(b,"mouse_up_which");a.Ka=!0;break;case 180:case 190:b=e(a.element);y(b,"orientation_angles");a.Ka=!0;break;case 200:b=e(a.element);y(b,"orientation_quat");a.Ka=!0;break;case 210:case 220:a.Ka=!0}}function m(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function k(a){return 0==a?c.ga(c.mt):1==a?c.ga(c.fy):2==a?c.ga(c.gy):c.ga(c.hy)}var f=l("__config"),v=l("__container"),c=l("__input"),C=l("__objects"),O=l("__print"),J=l("__physics"),
K=l("__quat"),D=l("__time"),Q=l("__tsr"),L=l("__util"),H=l("__vec3"),z=f.controls,d=f.B,p=[],M={},x=[],g=[],P=[],t=new Float32Array(2),da=new Float32Array(2),G=H.create(),F=K.create(),U=!1,R=0;a.uf=10;a.Qa=20;a.nn=30;a.vf=40;a.tp=50;a.cy=60;a.Ft=0;a.Et=1;a.Dt=2;a.dz=3;var Z=1;a.update=function(b,f){for(var g=0;g<P.length;g++){var h=P[g];h.$h.vm||(h.$h.ea=C.fs(h.$h.Pj[0],h.$h.Pj[1]),h.$h.vm=!0,h.pB=h.$h.ea);for(var l=0;10>l;++l){var m=h.Ym[l];m.vm||(m.ea=C.fs(m.Pj[0],m.Pj[1]),m.vm=!0,h.pB=m.ea)}}for(g=
0;g<x.length;g++)if(h=x[g],m=b,l=f)switch(h.type){case 120:var q=h.ji,n=Q.hc(q.k.n,G),q=Q.Xd(q.k.n,F),w=H.dist(h.cp,n),z=h.TK;K.invert(h.Dw,z);K.multiply(q,z,z);K.normalize(z,z);z=Math.abs(2*Math.acos(z[3]));w/=l;h.Zt=L.mc(w,h.Zt,l,.3);h.Z[0]=w;w=z/l;h.Yt=L.mc(w,h.Yt,l,.3);h.Z[1]=w;h.Zt>=h.threshold||h.Yt>=h.jL?r(h,1):r(h,0);H.copy(n,h.cp);K.copy(q,h.Dw);h.Rf=m;break;case 130:q=h.ji;n=Q.hc(q.k.n,G);q=Math.abs(n[1]-h.cp[1])/l;h.$t=L.mc(q,h.$t,l,.3);h.Z=q;h.$t>=h.threshold?r(h,1):r(h,0);H.copy(n,h.cp);
h.Rf=m;break;case 140:!h.Ka&&0<=h.Lf&&m-h.Rf>=h.Lf&&(r(h,1),h.repeat?h.Rf=m:h.Lf=-h.Lf);break;case 150:h.Rf||(h.Rf=m);r(h,m-h.Rf);h.Rf=m;break;case 160:r(h,m);break;case 180:m=e(h.element);h.Z[0]=m.pv-m.rB;h.Z[1]=m.ov-m.qB;h.Z[2]=m.nv-m.mv;break;case 190:m=e(h.element);h.Z[0]=m.pv;h.Z[1]=m.ov;h.Z[2]=m.nv;break;case 200:m=e(h.element);K.copy(m.lJ,h.Z);break;case 210:l=c.ga(c.xd);c.Ti(l,c.zt,h.Z);break;case 220:l=c.ga(c.xd);c.Ti(l,c.At,h.Z);break;case 240:l=k(h.$l);h.value=c.fV(l,h.key);break;case 250:l=
k(h.$l);h.value=c.eV(l,h.key);break;case 230:r(h,h.callback());break;case 30:m=e(h.element);r(h,m.Px);break;case 40:m=e(h.element);if(!d.Xn||1==m.De||2==m.De)switch(n=m.Am-m.dw,q=m.Bm-m.ew,h.Z.coords[0]=m.Am,h.Z.coords[1]=m.Bm,h.axis){case "X":r(h,n);break;case "Y":r(h,q);break;case "XY":l=Math.sqrt(n*n+q*q),r(h,l)}break;case 260:m=e(h.element);d.Xn||(n=m.hs,q=m.ks,w=L.mc(n,0,l,.1*Z),l=L.mc(q,0,l,.1*Z),.01<Math.abs(n)||.01<Math.abs(q)?(m.hs-=w,m.ks-=l,h.Z.coords[0]=w,h.Z.coords[1]=l):(h.Z.coords[0]=
0,h.Z.coords[1]=0),r(h,Math.sqrt(n*n+q*q)));break;case 50:m=e(h.element);r(h,0<m.De|0);h.Z.which=m.which;h.Z.coords[0]=m.Am;h.Z.coords[1]=m.Bm;break;case 170:m=e(h.element);r(h,0);if(h.KH)m.pB==h.ji&&r(h,1);else if(m.De&&m.$h.ea==h.ji)r(h,1);else if(!m.Nv)for(l=0;10>l;++l)if(m.Ym[l].ea==h.ji){r(h,1);break}break;case 20:m=e(h.element);h.Z=m.We[h.key];1==h.Z||m.We[0]&&16==h.key?r(h,1):h.Z||r(h,0);break;case 60:m=e(h.element);if(-1==m.re[1]&&-1==m.Ie[1]){n=m.re[0]-m.rh[0];q=m.Ie[0]-m.sh[0];l=Math.sqrt(n*
n+q*q);if(-1!=m.rh[1]&&-1!=m.sh[1]){var w=m.re[0]-m.rh[1],z=m.Ie[0]-m.sh[1],v=Math.sqrt(w*w+z*z);v<l&&(n=w,q=z,l=v)}h.Z.gesture=a.Ft}else l=t,l[0]=(m.re[0]+m.re[1])/2,l[1]=(m.Ie[0]+m.Ie[1])/2,q=da,q[0]=(m.rh[0]+m.rh[1])/2,q[1]=(m.sh[0]+m.sh[1])/2,n=l[0]-q[0],q=l[1]-q[1],l=Math.sqrt(n*n+q*q),h.Z.gesture=a.Dt;h.Z.coords[0]=m.re[0];h.Z.coords[1]=m.Ie[0];switch(h.axis){case "X":r(h,n);break;case "Y":r(h,q);break;case "XY":r(h,l)}break;case 70:m=e(h.element);l=m.sx-m.aE;h.Z=a.Et;r(h,l);break;case 75:m=
e(h.element);-1!=m.re[1]&&(l=Math.atan2(m.Ie[0]-m.Ie[1],m.re[0]-m.re[1]),h.Z=a.dz,r(h,l-m.UM));break;case 80:m=e(h.element),h.Z.coords[0]=m.re[0],h.Z.coords[1]=m.Ie[0],m.Nv?r(h,0):r(h,1)}for(g=0;g<p.length;g++)for(m=p[g],h=m.Pm,l=0;l<h.length;l++)if(n=h[l],n.Vk!=R){n.Vk=R;z=n;q=0;switch(z.type){case a.uf:q=(w=A(z))?1:0;break;case a.Qa:q=z.Xi;(w=A(z))?(q=1,z.Xi=1):1==q?(q=-1,z.Xi=-1):q=0;break;case a.nn:q=z.Xi;(w=A(z))&&-1==q?(q=1,z.Xi=1):w||1!=q?q=0:(q=-1,z.Xi=-1);break;case a.vf:q=z.Xi;(w=A(z))&&
-1==q?(q=1,z.Xi=1):w||1!=q?q=0:(q=0,z.Xi=-1);break;case a.tp:w=A(z);z.UJ!=w?(q=1,z.UJ=w):q=0;break;case a.cy:w=z.Ek;z=z.iW;for(v=0;v<w.length;v++){var y=w[v].value;q||y==z[v]||(q=1);z[v]=y}break;default:L.q("Wrong sensor manifold type: "+z.type)}if(q&&(w=m==M?null:m,U=!1,n.callback(w,n.id,q,n.xR),U)){g=-1;break}}for(g=0;g<p.length;g++)for(m=p[g],h=m.Pm,l=0;l<h.length;l++)for(n=h[l],m=n.Ek,n=0;n<m.length;n++)switch(q=m[n],q.type){case 30:r(q,0);break;case 40:r(q,0);break;case 60:r(q,0);break;case 70:r(q,
0);break;case 75:r(q,0);break;case 80:r(q,0);break;case 140:r(q,0)}for(g=0;g<P.length;g++){h=P[g];if(!h.Kr){for(l=0;l<h.We.length;l++)1==h.We[l]?h.We[l]=2:3==h.We[l]&&(h.We[l]=0);h.Kr=!0}1==h.De?h.De=2:3==h.De&&(h.De=0);h.Px=0;h.dw=h.Am;h.ew=h.Bm;h.We[0]=0;h.rh.set(h.re);h.sh.set(h.Ie);h.aE=h.sx;h.rB=h.pv;h.qB=h.ov;h.mv=h.nv;h.HB=!1}R++};a.iA=function(a){var b=n(10);r(b,a);return b};a.Ic=function(a){var b=n(20,document);b.key=a;b.Ka=!0;return b};a.Lq=function(a,b){var d=n(240,document);b=b||c.xI();
d.$l=b;d.key=a;d.Ka=!0;return d};a.Ii=function(a,b){var d=n(250,document);b=void 0==b?c.xI():b;d.$l=b;d.key=a;d.Ka=!0;return d};a.hA=function(a,b,c){if(!a||!J.oa(a))return O.error("Wrong collision object"),null;var d=n(90);d.Zz=a;d.bc=b;d.Hh=c;d.Z={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.Yz=function(a,b,c,f,e){r(d,a);a=d.Z;a.coll_obj=b;d.Hh&&(a.coll_pos.set(c),a.coll_norm.set(f),a.coll_dist=e)};d.Ka=!0;return d};a.$G=function(a){if(!a||
!a.C)return O.error("Wrong collision impulse object"),null;var b=n(100);b.Xz=a;b.SG=function(a){r(b,a)};b.Ka=!0;return b};a.gH=function(a,b,c,d,f,e,g){var h=n(110);h.ji=a;h.from=b;h.to=c;h.bc=d;h.BJ=f;h.Hh=e;h.Av=g;h.Z={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),ps:0};h.ZK=function(a,b,c,d,f,e){h.BJ?r(h,-1==b?0:1):r(h,b);h.Z.hit_fract=b;h.Z.obj_hit=c;h.Z.hit_time=d;h.Hh&&(h.Z.hit_pos.set(f),h.Z.hit_norm.set(e))};h.Ka=!0;return h};a.Fn=function(a){a=
n(50,a);a.Ka=!0;a.Z={coords:new Float32Array(2),which:null};return a};a.nA=function(a){a=n(30,a);a.Ka=!0;return a};a.Il=function(a,b){var c=n(40,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2)};c.Ka=!0;return c};a.Oq=function(a,b){var c=n(60,b);c.axis=a||"XY";c.Z={coords:new Float32Array(2),gesture:0};c.Ka=!0;return c};a.vA=function(a){a=n(70,a);a.Z=0;a.Ka=!0;return a};a.pH=function(a){a=n(75,a);a.Z=0;a.Ka=!0;return a};a.xu=function(a){a=n(80,a);a.Z={coords:new Float32Array(2)};a.Ka=!0;return a};
a.fH=function(a,b,c){if(!a)return O.error("Wrong collision object"),null;var d=n(120);d.ji=a;var f=Q.G(a.k.n);a=Q.P(a.k.n);d.TK=new Float32Array(4);d.cp=new Float32Array(f);d.Dw=new Float32Array(a);d.Zt=0;d.Yt=0;d.threshold=b||.1;d.jL=c||.1;d.Rf=0;d.Z=new Float32Array([0,0]);return d};a.qH=function(a,b){if(!a)return O.error("Wrong collision object"),null;var c=n(130);c.ji=a;var d=Q.P(a.k.n);c.cp=new Float32Array(Q.G(a.k.n));c.Dw=new Float32Array(d);c.$t=0;c.threshold=b||1;c.Rf=0;c.Z=0;return c};a.oH=
function(a,b){var c=n(140);c.Lf=a;c.repeat=b;c.Ka=!0;return c};a.fL=function(a,b,c,d){a=a||M;a=a.oh;if(!a||!a[b])return O.error("reset_timer_sensor(): wrong object"),null;b=a[b].Ek[c];if(!b)return O.error("reset_timer_sensor(): sensor not found"),null;b.Rf=D.ur();b.Lf=d};a.Rj=function(){var a=n(150);a.Rf=0;return a};a.dH=function(){var a=n(180,window);a.Z=new Float32Array(3);c.ga(c.yh)?r(a,1):r(a,0);a.Ka=!0;return a};a.cH=function(){var a=n(190,window);a.Z=new Float32Array(3);c.ga(c.yh)?r(a,1):r(a,
0);a.Ka=!0;return a};a.kA=function(){var a=n(200,window);a.Z=K.create();c.ga(c.yh)?r(a,1):r(a,0);a.Ka=!0;return a};a.lA=function(){var a=n(210,window);a.Z=K.create();c.ga(c.xd)?r(a,1):r(a,0);a.Ka=!0;return a};a.eH=function(){var a=n(220,window);a.Z=H.create();c.ga(c.xd)?r(a,1):r(a,0);a.Ka=!0;return a};a.nH=function(){return n(160)};a.vu=function(a,b){var c=n(170);c.ji=a;c.KH=b;c.Ka=!0;return c};a.gA=function(a,b){var c=n(230);c.callback=a;r(c,b);return c};a.oA=function(a){a=n(260,a);a.Z={coords:new Float32Array(2)};
a.Ka=!0;return a};a.pA=function(a){a=n(270,a);a.Ka=!0;return a};a.dY=r;a.Zd=function(a,b,c){a=a||M;a=a.oh;if(!a||!a[b])return O.error("get_sensor_value(): wrong object"),null;b=a[b].Ek[c];return b?b.value:(O.error("get_sensor_value(): sensor not found"),null)};a.$e=function(a,b,c){a=a||M;a=a.oh;if(!a||!a[b])return O.error("get_sensor_payload(): wrong object"),null;b=a[b].Ek[c];return b?b.Z:(O.error("get_sensor_payload(): sensor not found"),null)};a.ua=function(){p=[];M={};for(var a=0;a<x.length;a++)w(x[a]);
x.length=0;g.length=0};a.vq=function(a,b){a=a||M;if(!a.oh)return!1;if(b&&a.oh[b])return!0;if(!b)for(var c in a.oh)return!0;return!1};a.Y=function(a,d,f,k,l,m,q){a=a||M;a.Pm=a.Pm||[];a.oh=a.oh||{};var n=a.oh,r=a.Pm;n[d]&&h(a,d);f={id:d,type:f,Ek:k.slice(0),GW:l,eY:Array(k.length),callback:m,xR:q,Xi:-1,UJ:0,iW:Array(k.length),Vk:-1};n[d]=f;r.push(f);-1==p.indexOf(a)&&p.push(a);k=f.Ek;for(a=0;a<k.length;a++){n=d=k[a];if(n.Ka){switch(n.type){case 90:J.sz(n.Zz,n.bc,n.Yz,n.Hh);break;case 100:J.uz(n.Xz,
n.SG);break;case 110:n.ps=J.Ut(n.ji,n.from,n.to,n.bc,n.ZK,!1,!1,n.Hh,n.Av);n.Z.ps=n.ps;break;case 140:n.Rf=D.ur();0>n.Lf&&(n.Lf=-n.Lf);break;case 20:r=e(n.element);b(r,"keyboard_downed_keys");break;case 30:r=e(n.element);b(r,"mouse_wheel");break;case 40:r=e(n.element);b(r,"mouse_down_which");b(r,"mouse_up_which");b(r,"mouse_location");break;case 260:r=e(n.element);b(r,"mouse_pointerlock");break;case 270:c.gQ(n);break;case 50:r=e(n.element);b(r,"mouse_down_which");b(r,"mouse_up_which");break;case 60:r=
e(n.element);b(r,"touch_start");b(r,"touch_move");b(r,"touch_end");break;case 70:r=e(n.element);b(r,"touch_start");b(r,"touch_move");break;case 75:r=e(n.element);b(r,"touch_start");b(r,"touch_move");break;case 80:r=e(n.element);b(r,"touch_start");b(r,"touch_end");break;case 170:r=e(n.element);b(r,"mouse_select");b(r,"touch_select");b(r,"touch_start");b(r,"touch_end");b(r,"mouse_down_which");b(r,"mouse_up_which");break;case 180:case 190:r=e(n.element);b(r,"orientation_angles");break;case 200:r=e(n.element);
b(r,"orientation_quat");break;case 240:0==n.$l?c.ga(c.mt):1==n.$l?c.ga(c.fy):2==n.$l?c.ga(c.gy):c.ga(c.hy)}n.Ka=!1}n=x.indexOf(d);-1==n?(x.push(d),g.push([f])):g[n].push(f)}U=!0};a.Eu=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.Fu=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.hf=h;a.reset=function(){for(var a=0;a<p.length;a++){var b=p[a],c=b.oh,b=b.Pm,d;for(d in c)delete c[d];b.length=0}for(a=0;a<x.length;a++)w(x[a]);p.length=
0;x.length=0;g.length=0};a.debug=function(){O.log(String(p.length)+" objects with manifolds",p);O.log(String(x.length)+" sensors",x);for(var a=[],b=[],c=0;c<x.length;c++){var d=x[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}O.log(String(a.length)+" collision sensors",a);O.log(String(b.length)+" ray sensors",b)};a.mD=function(a){Z=a}};b4w.module.__loader=function(a,l){function n(b,c,h,k){var d=D,p=O.create(),l;for(l in c){var m=e(c[l]);(k&&m.Wb||!b&&m.kc)&&f(m);O.J(p,m)}for(l in c)for(m=c[l],m.name=l,b=0;b<m.L.length;b++)O.r(p,c[m.L[b]],m,null);c=e({name:"out",Nb:a.TN,ac:function(a,b,c,f,e){b.Mb&&(d.DD=!0);C(b)||(b.status=2);b.ZJ(b.id,!0);e(b,c);J.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Yb:5});if(h)h=O.sr(p);else{l=O.clone(p);do{h=O.sr(l);m=[];for(b=0;b<h.length;b++){k=h[b];var g=O.Wa(l,k);g.Qb&&m.push(k)}for(b=
0;b<m.length;b++)O.ug(l,m[b]);m.length&&O.Tz(l)}while(m.length)}O.J(p,c);for(b=0;b<h.length;b++)k=h[b],g=O.Wa(p,k),c.L.push(g.name),O.r(p,g,c,null);return p}function e(a){a.Qb=a.Qb||!1;a.Nb||0===a.Nb||(a.Nb=a.ue);a.L=a.L||[];a.qm=a.qm||!1;a.zD=a.zD||!1;a.Yb=a.Yb||0;a.Wb=a.Wb||!1;a.kc=a.kc||!1;a.status=0;a.a7=0;a.SB=0;a.rq=a.rq||null;return a}function b(a,b){for(var c=[],f=[],d=0;d<b.length;d++){var e=b[d];O.Wa(a.ki,e).qm&&(O.Sk(a.ki,e,function(d){var f=!0;O.ni(a.ki,d,function(a,b){if(!b.qm)return f=
!1,1});f&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),f.push(d))}for(d=f.length-1;0<=d;d--)b.splice(f[d],1);return c}function y(a){function c(b,d){var f=O.Wa(a.ki,b),e=O.Wa(a.ki,d),h=e.Nb-f.Nb;0==h&&(h=f.Qb-e.Qb);return h}var f=[],e=a.pj,d=!1;do{var h=b(a,e);f.push.apply(f,e);0<h.length&&(d=!0);e=h}while(0<h.length);d&&f.sort(c);a.pj=f;return a.pj.length}function r(a,b,c){if(b.zD)return b.qm=!0,h(a,b),!1;if(!b.ac&&!b.Lj&&!b.qq)return h(a,b),!1;if(0==b.status&&(b.status++,b.ac))return b.ac(c,a,
b,b.rq,h,w),!0;if(1==b.status){if(b.Lj)return b.Lj(c,a,b,b.rq,h,w),!0;b.status++}return 2==b.status&&(b.status++,b.qq)?(b.qq(c,a,b,b.rq,h,w),!0):!1}function A(a){if(0==a.lx)return 100;var b=0;O.pa(a.ki,function(c,f){a.do_not_load_resources&&f.Wb||(b+=f.SB*f.Yb)});return K.trunc(100*b/a.lx)}function h(a,b){b.qm=!0;b.status=3;m(a,b,1)}function w(a,b,c){1>c?m(a,b,c):b.status++}function m(a,b,c){var f=D;if(b.ac||b.Lj||b.qq)if(b.SB=c,b=A(a),a.uH!=b||1==c)a.CD(b,performance.now()-a.RM),a.uH=b,f.UB=!0}function k(a,
b){var c=null;O.pa(a.ki,function(a,d){if(d.name==b)return c=d,1});return c}function f(a){a.zD=!0;a.SB=1}function v(a){a.CD=null;a.$z=null;a.ki=null;a.pj=null}function c(){return 0==D.Rt}function C(a){return a&&(3==a.status||4==a.status)}var O=l("__graph"),J=l("__print"),K=l("__util");a.ue=0;a.zg=1;a.TN=2;var D=null;a.lB=function(){return D};a.hH=function(){var a={qh:[],zA:0,Rt:0,DD:!1,UB:!1};return D=a};a.mH=function(a,b,c,f,d,e,h,k,g){var l=D,m=l.qh.length,r={id:m,Mb:0==m,status:0,Tg:b,hG:"",ZJ:c||
function(){},YJ:k||!1,Y9:e,RM:0,uH:0,lx:0,VC:!1,CD:f||function(){},$z:d||function(){},ki:null,pj:null,uB:!1,sB:!1,xB:!1,gk:g};a=n(r.Mb,a,e,h);r.ki=a;b=[];c=O.oV(a);for(f=0;f<c.length;f++)b.push(c[f]);r.pj=b;O.pa(a,function(a,b){!(b.ac||b.Lj||b.qq)||r.do_not_load_resources&&b.Wb||(r.lx+=b.Yb)});l.qh.push(r);l.Rt++;return r.id};a.v_=function(b){var f=D;if(f&&!c())if(f.UB)f.UB=!1;else{var e=performance.now();do{var h=f.qh[f.zA],d=b[h.id];if(!C(h))if(0==h.status&&(h.status=1,h.RM=performance.now(),h.CD(0,
0)),y(h)){var k=h,l=k.pj.length;do{var m=O.Wa(k.ki,k.pj[0]),g=r(k,m,d);m.Nb==a.zg&&(k.VC=!0);m=k.pj.shift();k.pj.push(m);l--}while(!g&&0!=l)}else k=f,l=h,l.$z(d,l),l.status=3,k.Rt--,v(l);f.DD&&(f.zA=(f.zA+1)%f.qh.length);if(h.VC){h.VC=!1;break}}while(16>performance.now()-e)}};a.AF=function(a){var b=D;a.$z(null,a);a.status=3;b.Rt--;v(a);a.status=4;a.Mb&&(b.DD=!0);a.ZJ(a.id,!1)};a.j9=w;a.dx=function(a,b){var c=k(a,b);null!==c&&f(c)};a.qm=c;a.GZ=C;a.$g=function(a){var b=D;if(!b)return!1;a|=0;return b.qh[a]&&
(3==b.qh[a].status||2==b.qh[a].status)};a.wV=function(){J.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.ua=function(){D=null}};b4w.module.__md5=function(a){function l(a,h){var l=a[0],m=a[1],k=a[2],f=a[3],l=e(l,m,k,f,h[0],7,-680876936),f=e(f,l,m,k,h[1],12,-389564586),k=e(k,f,l,m,h[2],17,606105819),m=e(m,k,f,l,h[3],22,-1044525330),l=e(l,m,k,f,h[4],7,-176418897),f=e(f,l,m,k,h[5],12,1200080426),k=e(k,f,l,m,h[6],17,-1473231341),m=e(m,k,f,l,h[7],22,-45705983),l=e(l,m,k,f,h[8],7,1770035416),f=e(f,l,m,k,h[9],12,-1958414417),k=e(k,f,l,m,h[10],17,-42063),m=e(m,k,f,l,h[11],22,-1990404162),l=e(l,m,k,f,h[12],7,1804603682),f=e(f,l,m,k,
h[13],12,-40341101),k=e(k,f,l,m,h[14],17,-1502002290),m=e(m,k,f,l,h[15],22,1236535329),l=b(l,m,k,f,h[1],5,-165796510),f=b(f,l,m,k,h[6],9,-1069501632),k=b(k,f,l,m,h[11],14,643717713),m=b(m,k,f,l,h[0],20,-373897302),l=b(l,m,k,f,h[5],5,-701558691),f=b(f,l,m,k,h[10],9,38016083),k=b(k,f,l,m,h[15],14,-660478335),m=b(m,k,f,l,h[4],20,-405537848),l=b(l,m,k,f,h[9],5,568446438),f=b(f,l,m,k,h[14],9,-1019803690),k=b(k,f,l,m,h[3],14,-187363961),m=b(m,k,f,l,h[8],20,1163531501),l=b(l,m,k,f,h[13],5,-1444681467),f=
b(f,l,m,k,h[2],9,-51403784),k=b(k,f,l,m,h[7],14,1735328473),m=b(m,k,f,l,h[12],20,-1926607734),l=n(m^k^f,l,m,h[5],4,-378558),f=n(l^m^k,f,l,h[8],11,-2022574463),k=n(f^l^m,k,f,h[11],16,1839030562),m=n(k^f^l,m,k,h[14],23,-35309556),l=n(m^k^f,l,m,h[1],4,-1530992060),f=n(l^m^k,f,l,h[4],11,1272893353),k=n(f^l^m,k,f,h[7],16,-155497632),m=n(k^f^l,m,k,h[10],23,-1094730640),l=n(m^k^f,l,m,h[13],4,681279174),f=n(l^m^k,f,l,h[0],11,-358537222),k=n(f^l^m,k,f,h[3],16,-722521979),m=n(k^f^l,m,k,h[6],23,76029189),l=
n(m^k^f,l,m,h[9],4,-640364487),f=n(l^m^k,f,l,h[12],11,-421815835),k=n(f^l^m,k,f,h[15],16,530742520),m=n(k^f^l,m,k,h[2],23,-995338651),l=y(l,m,k,f,h[0],6,-198630844),f=y(f,l,m,k,h[7],10,1126891415),k=y(k,f,l,m,h[14],15,-1416354905),m=y(m,k,f,l,h[5],21,-57434055),l=y(l,m,k,f,h[12],6,1700485571),f=y(f,l,m,k,h[3],10,-1894986606),k=y(k,f,l,m,h[10],15,-1051523),m=y(m,k,f,l,h[1],21,-2054922799),l=y(l,m,k,f,h[8],6,1873313359),f=y(f,l,m,k,h[15],10,-30611744),k=y(k,f,l,m,h[6],15,-1560198380),m=y(m,k,f,l,h[13],
21,1309151649),l=y(l,m,k,f,h[4],6,-145523070),f=y(f,l,m,k,h[11],10,-1120210379),k=y(k,f,l,m,h[2],15,718787259),m=y(m,k,f,l,h[9],21,-343485551);a[0]=l+a[0]&4294967295;a[1]=m+a[1]&4294967295;a[2]=k+a[2]&4294967295;a[3]=f+a[3]&4294967295}function n(a,b,e,l,k,f){b=(b+a&4294967295)+(l+f&4294967295)&4294967295;return(b<<k|b>>>32-k)+e&4294967295}function e(a,b,e,l,k,f,r){return n(b&e|~b&l,a,b,k,f,r)}function b(a,b,e,l,k,f,r){return n(b&l|e&~l,a,b,k,f,r)}function y(a,b,e,l,k,f,r){return n(e^(b|~l),a,b,k,
f,r)}var r="0123456789abcdef".split("");a.qJ=function(a){var b=a,e=b.length;a=[1732584193,-271733879,-1732584194,271733878];var m;for(m=64;m<=b.length;m+=64){for(var k=b.substring(m-64,m),f=[],n=void 0,n=0;64>n;n+=4)f[n>>2]=k.charCodeAt(n)+(k.charCodeAt(n+1)<<8)+(k.charCodeAt(n+2)<<16)+(k.charCodeAt(n+3)<<24);l(a,f)}b=b.substring(m-64);k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(m=0;m<b.length;m++)k[m>>2]|=b.charCodeAt(m)<<(m%4<<3);k[m>>2]|=128<<(m%4<<3);if(55<m)for(l(a,k),m=0;16>m;m++)k[m]=0;k[14]=8*
e;l(a,k);for(b=0;b<a.length;b++){e=a[b];m="";for(k=0;4>k;k++)m+=r[e>>8*k+4&15]+r[e>>8*k&15];a[b]=m}return a.join("")}};b4w.module.__nla=function(a,l){function n(){return{type:"CLIP",va:0,ab:0,kj:!1,paused:!1,Wf:"",Xp:"",Ac:0,po:null,Dj:0,ol:0,MH:0,LH:0,qN:!1,scale:1,repeat:1,CF:0}}function e(a,b,c){if(a.animation_data){var f=a.animation_data.nla_tracks;if(f)for(var h=0;h<f.length;h++)f[h].po=c,b.push(f[h])}a=a.nodes;for(h=0;h<a.length;h++)if(f=a[h],f.node_group){var k=f.node_group.node_tree;if(k){var g=c.slice();g.push(f.name);e(k,b,g)}}}function b(a,b){var c=Math.round(a)-b.va;b.vj&&(c%=b.Yj,0>c&&(c+=b.Yj));return b.Tb+
c}function y(a,b){var c=(b-L)*K.rd()+a.Tb;c>a.va?(c-=a.va,a.ze&&(c%=a.ab-a.va+1),c+=a.va):c=a.va;return c}function r(a,b){a=D.U(a,b.va,b.ab);var c=a==b.ab?b.CF:b.Dj+(a-b.va)/b.scale%(b.ol-b.Dj);b.qN&&(c=b.ol-c+b.Dj);return c}function A(a,b){for(var c=[],f=0;f<a.length;f++){var e=a[f],h=e.strips;if(h)for(var g=0;g<h.length;g++){var k=h[g],l=n();l.type=k.type;l.va=k.frame_start;l.ab=k.frame_end;l.Ac=b;l.Dj=k.action_frame_start;l.ol=k.action_frame_end;l.qN=k.use_reverse;l.scale=k.scale;l.repeat=k.repeat;
k.action&&(l.Wf=k.action.name,l.Xp=k.action.uuid,l.po=e.po);c.push(l)}}return c}function h(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function w(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],f=c.node_tree;if(c=c.use_nodes&&f)a:{if(f.animation_data&&(c=f.animation_data.nla_tracks)&&c.length){c=!0;break a}f=f.nodes;for(c=0;c<f.length;c++);c=!1}if(c)return!0}return!1}
function m(a,b){var c=C.A();if(c.ra){var f=y(c.ra,b);c.ra.Tb-=f-a;c.ra.Tn=!0}}var k=l("__animation");l("__config");var f=l("__objects"),v=l("__obj_util"),c=l("__print"),C=l("__scenes"),O=l("__sfx"),J=l("__textures"),K=l("__time"),D=l("__util"),Q=[],L=-1;a.Wk=function(a,b){var c,f=null;for(c=b.I.length-1;0<=c;c--){var l=b.I[c];if(l.yb.b4w_use_nla&&(f=l,l.yb.yF))break}if(c=f){c.vK=!0;var m=0;if((f=a.animation_data)&&f.nla_tracks.length){var g=f.nla_tracks;if(v.pm(b)||v.xa(b)||v.$d(b)||v.bo(b)||v.Zg(b)||
v.Jr(b)||v.IB(b))g=A(g,m),g.length&&(b.ng=b.ng.concat(g),m++)}h(a)&&(g=a.data.animation_data.nla_tracks,g=A(g,m),g.length&&(b.ng=b.ng.concat(g),m++));if(v.$d(b))for(l=a.data.materials,f=0;f<l.length;f++){var r=l[f];if(r.use_nodes&&r.node_tree&&(g=[],e(r.node_tree,g,[r.name]),g=A(g,m),g.length)){for(var r=m,t=g,w=k.MU(),C=[],F=0,y=0;y<t.length;y++){var J=t[y];""!=J.Xp?J=D.Dd("uuid",J.Xp,w):(J=J.Wf,J=D.Dd("name",J,w)||D.Dd("name",J+"_B4W_BAKED",w));if(J){var J=J.fcurves,L=[],u;for(u in J)L.push(u);
C.push(L)}}for(y=0;y<C.length;y++){w=!1;for(J=0;J<y;J++)if(D.MQ(C[y],C[J])){t[y].Ac=t[J].Ac;w=!0;break}w||(t[y].Ac=m+F++)}m=r+F;b.ng=b.ng.concat(g)}}if(!v.IB(b)){for(f=0;f<a.particle_systems.length;f++)l=a.particle_systems[f],u=l.settings,"EMITTER"==u.type&&u.b4w_allow_nla&&(u=n(),u.type="CLIP",u.va=c.yb.frame_start,u.ab=c.yb.frame_end+1,u.Wf=l.name,u.Ac=m,u.Dj=u.va,u.ol=u.ab,b.ng.push(u),m++);c=m+1;for(f=0;f<b.Zc.length;f++)l=b.Zc[f],l.iQ&&(m=c,u=n(),u.type="CLIP",u.va=l.va,u.ab=l.ab,u.Wf=l.name,
u.Ac=m,u.Dj=u.va,u.ol=u.ab,b.ng.push(u))}}};a.u_=function(a,b,d){a.ra||(a.ra={va:a.frame_start,ab:a.frame_end,Tb:0,Or:-1,ns:a.frame_end,os:a.frame_start,jp:null,ze:b,fb:[],ya:[],nL:a.name,ik:!1,Tn:!1,XC:!0},Q.push(a.ra));b=a.ra;for(var e=f.TI(a,"ALL",d),h=0;h<e.length;h++){var k=e[h];if(k.ng.length){b.fb[d]||(b.fb[d]=[]);for(var g=0;g<k.I.length;g++){var l=k.I[g];l.yb==a&&l.vK&&b.fb[d].push(k)}for(var g=k.ng,l=b,m=k.name,r=0;r<g.length;r++){var w=g[r];l.va>w.ab||l.ab<w.va?(c.warn("NLA: Strip is out of scene range: "+
(m+" ["+w.va+":"+w.ab+"]")),g.splice(r,1),r--):w.Wf||"CLIP"!=w.type||(c.warn('NLA: no action in strip for object "'+m+'".'),g.splice(r,1),r--)}k=k.ng;g=b;for(l=0;l<k.length;l++){for(var m=k[l],r=g.va,w=g.ab+1,v=0;v<k.length;v++){var C=k[v];m.Ac==C.Ac&&(C.ab<=m.va&&(r=m.va),C.va>=m.ab&&(w=Math.min(w,C.va)))}m.MH=r;m.LH=w;m.CF=0===m.repeat%1?m.ol:m.Dj+m.repeat%1*(m.ol-m.Dj)}}}a=a.s.np;for(h=0;h<a.length;h++)e=a[h].s,e.Xk&&(e.Ta||e.td)&&e.et==d&&(k=n(),k.type="VIDEO",e.vj?(k.va=0,k.ab=b.ab):(k.va=D.U(e.va,
0,b.ab),k.ab=D.U(e.va+e.Yj,0,b.ab)),k.Wf=a[h].name,b.ya.push(e))};a.start=function(){L=0};a.qV=function(){return L};a.U4=function(a){return a.ra?a.ra.Tb:null};a.o8=function(a,b){return a.ra?(a.ra.Tb=b,!0):!1};a.update=function(a,c){if(!(0>L)){0==L&&(L=a);for(var d=0;d<Q.length;d++){var f=Q[d];f.ik&&(f.Tb-=K.rd()*c);var e=y(f,a);if((!f.ik||f.Tn)&&e>=f.ns)if(f.ze){var e=f,h=a;e.jp&&e.jp();m(e.os,h);e.XC=!0;e=y(e,h)}else{var h=f,g=e;h.ik=!0;h.Tb-=g-h.ns;h.jp&&h.jp()}if(!f.ik||f.Tn){for(var h=f,g=e,l=
0;l<h.fb.length;l++){var n=h.fb[l];if(n)for(var w=0;w<n.length;w++){for(var v=n[w],C=v.ng,A=0;A<C.length;A++){var R=C[A];"SOUND"==R.type&&g<h.Or-1E-6&&(R.kj=!1)}for(A=0;A<C.length;A++)switch(R=C[A],R.type){case "CLIP":if(R.MH<=g&&g<R.LH&&!R.kj){var l=v,Z=R,u=Z.po;""!=Z.Xp?k.GQ(l,u,Z.Xp,Z.Ac):k.apply(l,u,Z.Wf,Z.Ac);k.Fo(l,k.Sx,Z.Ac);u=r(Z.va,Z);k.Go(l,u,Z.Ac);for(l=0;l<C.length;l++)C[l]!=R&&C[l].Ac==R.Ac&&(C[l].kj=!1);R.kj=!0}R.kj&&(Z=v,u=r(g,R),1E-6<Math.abs(u-k.sI(Z,R.Ac))&&k.Go(Z,u,R.Ac));break;
case "SOUND":if((g<h.Or-1E-6||h.Or<R.va)&&R.va<=g&&g<R.ab&&!R.kj){var Z=v,ga=R,u=(ga.va-g)/K.rd(),ga=(ga.ab-ga.va)/K.rd();O.play(Z,u,ga);R.kj=!0}h.Or<R.ab&&R.ab<=g&&R.kj&&(R.kj=!1)}}}h=a;g=f;n=e;for(w=0;w<g.ya.length;w++)if(v=g.ya[w],v.Ta||v.td){C=J.CN(v);A=v;R=D.U(b(n,A),A.Tb,A.Tb+J.DN(A)-1);A.td&&(R=J.Q_(A,R),R==A.ys&&R--);A=R;R=J.EN(v);Z=l=!1;if(g.Tn||g.XC)Z=!0;g.ik||(u=b(n,v),u=v.Tb<=u&&u<=v.Tb+J.DN(v),ga=J.FN(v),v.vj&&A==R&&(Z=!0),ga||C==A||(Z=!0),u&&!ga?J.JK(v):u&&ga?l=!0:!u&&ga&&(v.Ta&&C<A?
l=!0:J.yC(v)));Z?(J.qY(v,A),v.td&&(v.Fk=J.Ow(v,h))):l&&J.GN(v)&&(v.Ta?J.jN(v):(C=J.Ow(v,h),C!=v.Fk&&(v.lj=A,J.iN(v)),v.Fk=C))}f.Or=e}f.Tn=!1;f.XC=!1}}};a.ua=function(a){if(0==a)Q.length=0,L=-1;else for(var b=0;b<Q.length;b++)Q[b].fb[a]=null};a.oG=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||h(a)||w(a)?!0:!1};a.Go=m;a.rr=function(a){var b=C.A();return b.ra?y(b.ra,a):-1};a.vM=function(){var a=C.A();if(a.ra){a.ra.ik=!0;for(var a=a.ra.ya,b=0;b<a.length;b++)J.yC(a[b])}};a.sX=function(){var a=
C.A();a.ra&&(a.ra.ik=!1,a.ra.jp=null)};a.V4=function(){var a=C.A();return a.ra?a.ra.va:-1};a.zI=function(){var a=C.A();return a.ra?a.ra.ab:-1};a.fk=function(){var a=C.A();return a.ra?!a.ra.ik:!1};a.U2=function(){var a=C.A();return a.ra?a.b4w_use_nla:!1};a.T2=function(){var a=C.A();return a.ra?0<a.b4w_logic_nodes.length:!1};a.H8=function(a,b){var c=C.A();if(c.ra)c.ra.os=a,c.ra.ns=b;else return!1};a.nD=function(a){var b=C.A();b.ra&&(b.ra.ns=a)};a.EY=function(a){var b=C.A();b.ra&&(b.ra.os=a)};a.P7=function(){var a=
C.A();if(a.ra)a=a.ra,a.os=a.va,a.ns=a.ab;else return!1};a.h8=function(a){var b=C.A();if(b.ra)b.ra.ze=a;else return!1};a.b3=function(){var a=C.A();a.ra&&(a.ra.jp=null)};a.IL=function(a){var b=C.A().ra;b&&(b.Tb=-(a-L)*K.rd()+b.os,b.Tn=!0)};a.zI=function(){var a=C.A().ra;return a?a.ab:null}};b4w.module.__logic_nodes=function(a,l){function n(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];if(-2==c.state){for(var e=0;e<c.Nw;e++)if(L.Zd(a,b,e))for(var g=0;g<c.Mw.length;g++)if(c.Mw[g]==e){f.Cm==c.NM?(O.fk(f.ra)&&(c.state=-1),d.Qf.Hf||(c.state=1,c.Fs=c.Tv[g])):(c.state=1,c.Fs=c.Tv[g]);return}c.state=0}}}function e(){return function(a,b,c,d){c=d[0];var f=d[1];d=d[2];for(var e=0;e<c.Nw;e++)if(L.Zd(a,b,e)&&e==c.pL){if(O.fk(f.ra)&&f.Cm==c.NM)c.state=-1;else if(!d.Qf.Hf||c.T.no_wait)c.state=
1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Oa:a.slot_idx_order,Fs:a.slot_idx_jump,va:a.frame_range[0],ab:a.frame_range[1],tU:a.frame_range_mask?a.frame_range_mask[0]:!0,sU:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,Nw:-1,pL:-1,gX:a.param_name,eX:a.operation,qc:a.mute,$q:a.object,ea:null,jc:null,vc:null,fb:{},Wf:a.anim_name,Ac:v.kl,iX:a.parse_json_vars,hX:a.parse_json_paths,Kc:a.objects_paths,rK:a.nodes_paths,Hb:a.floats,T:a.bools,V:a.variables,qj:a.strings,
VB:a.materials_names,$L:a.shader_nd_type,xe:a.common_usage_names,ST:a.encode_json_vars,RT:a.encode_json_paths,NM:b,PK:E[a.type]?E[a.type]:h,Bw:!1,rx:0,Mw:null,vW:a.links,Tv:[]}}function y(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function r(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function A(a,b,c){switch(b.state){case 2:c.ma=a.Oa}}function h(a,b,c){switch(b.state){case 1:K.error("Unknown node type: "+a.type);break;case 2:c.ma=a.Oa}}function w(a){return J.xc(J.Oc,a.$q||[],0)}function m(a,c){var d=a.b4w_logic_nodes,
f=c.me;c.state=1;for(var e=0;e<d.length;e++){var g={M:[],Qf:{yb:a,ma:0,Hf:!1,SD:e,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};f.push(g);for(var h=f[f.length-1],k=d[e],l=0;l<k.length;l++){var p=b(k[l],h);h.M.push(p)}for(k=0;k<h.M.length;k++)p=h.M[k],p.qc||p.PK(p,c,g.Qf,0,0)}var d=a.timeline_markers,m;for(m in d)c.Gs.push(d[m]);c.Gs.sort(function(a,b){return a-b});c.state=2;aa.push(c)}function k(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):0;case 1:return String(a);default:return null}}
function f(a){switch(typeof a){case "string":return k(a,1);case "number":return k(a,0);default:return k(a,1)}}var v=l("__animation"),c=l("__assets"),C=l("__camera"),O=l("__nla"),J=l("__objects"),K=l("__print"),D=l("__scenes"),Q=l("__config"),L=l("__controls"),H=l("__batch"),z=l("__geometry"),d=l("__mat3"),p=l("__mat4"),M=l("__physics"),x=l("__quat"),g=l("__sfx"),P=l("__time"),t=l("__transform"),da=l("__tsr"),G=l("__util"),F=l("__vec3"),U=new Float32Array(4);new Float32Array(4);var R=new Float32Array(3),
Z=new Float32Array(3),u=new Float32Array(2),ga=new Float32Array(9),ca=new Float32Array(16);a.UO=0;a.VO=1;a.OO=0;a.NO=1;a.PO=2;a.QO=3;a.MO=4;a.PE=0;a.RE=1;a.QE=2;a.SE=3;a.TE=4;a.OE=5;a.TO=0;a.SO=1;a.RO=2;a.FO=0;a.GO=1;a.DO=2;a.EO=3;a.HO=0;a.IO=1;var E={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.ma=a.Oa}},HIDE:function(a,b,c){switch(b.state){case 1:a.ea=w(a);a.ea||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:D.tq(a.ea,!0),c.ma=a.Oa}},SHOW:function(a,
b,c){switch(b.state){case 1:a.ea=w(a);a.ea||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:D.tq(a.ea,!1),c.ma=a.Oa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.V.vd;b=b.u;var f=c.u,e;a:{e=a.gX;var g=a.Hb.ptp,h=a.T.hsh,l=Q.get("url_params");if(l&&e in l)e=Number(l[e]);else{if(h=h?location.hash:location.search)for(h=h.slice(1).split("&"),l=0;l<h.length;l++){var p=h[l].split("=");if(1<p.length&&p[0]==e){e=k(p[1],g);break a}}e=0}}r(d,b,f,e);c.ma=a.Oa}},
SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.me[c.SD];var d=J.UI();a.Mw=[];a.Tv=[];for(var f in a.Kc){var e=J.xc(J.Oc,a.Kc[f],0),g=d.indexOf(e);if(-1==g){K.error("logic script error: non-selectable object:",a.Kc[f][a.Kc[f].length-1]);break a}a.Mw.push(g);a.Tv.push(a.vW[f])}a.state=-1;a.Nw=d.length;f=[];for(g=0;g<d.length;g++)f.push(L.vu(d[g],!1));L.Y(e,"LOGIC_NODES_SWITCH_SELECT_"+a.label,L.vf,f,L.Fu,n(),[a,b,c])}break;case 2:if(-1==a.state){b=b.me[c.SD].M;for(e=0;e<b.length;e++)d=
b[e],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.ma=a.state?a.Fs:a.Oa,a.state=-1}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.me[c.SD];var d=w(a),f=J.UI(),g=f.indexOf(d);if(-1==g)K.error("logic script error: non-selectable object:",a.$q[a.$q.length-1]);else{a.state=-1;a.Nw=f.length;a.pL=g;for(var g=[],h=0;h<f.length;h++)g.push(L.vu(f[h],!1));L.Y(d,"LOGIC_NODES_SELECT_"+a.label,L.vf,g,L.Fu,e(),[a,b,c])}break;case 2:if(0==a.state||1==a.state){c.ma=a.state?a.Fs:
a.Oa;a.state=-1;break}a.T.not_wait&&(c.ma=a.Oa)}},PLAY:function(a,b,c,d){switch(b.state){case 1:O.vM();a.state=-1;a.T.not_wait||(a.T.not_wait=!1);break;case 2:switch(a.state){case -1:if(O.fk(b.ra))if(b.yA==b.Cm&&c.Hf)break;else{var f=b.Cm;if(f){f.Qf.ma=f.M[f.Qf.ma].Oa;f.M[f.Qf.ma].state=-1;for(var f=b.Cm.M,e=0;e<f.length;e++){var g=f[e];"PLAY"==g.type&&(g.state=-1)}}}c.Hf=!a.T.not_wait;b.Cm=b.yA;a.state=0;a.tU&&(O.EY(a.va),O.IL(d));if(a.sU)O.nD(a.ab);else{d=O.rr(d);var f=-1,h;for(h in b.Gs)if(d<b.Gs[h]){f=
h;break}0<=f?O.nD(b.Gs[f]):O.nD(O.zI())}O.sX();a.T.not_wait&&(c.ma=a.Oa,a.state=-1,c.Hf=!1);break;case 0:O.fk()||(c.ma=a.Oa,a.state=-1,c.Hf=!1);break;case 1:c.ma=a.Oa;a.state=-1;b.Cm=null;c.Hf=!1;break;default:G.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.T.url?k(y(a.V.url,b.u,c.u),1):a.qj.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.V.v1[1]?a.Hb.inp1:k(y(a.V.v1,b.u,c.u),0),f=-1==a.V.v2[1]?a.Hb.inp2:
k(y(a.V.v2,b.u,c.u),0),e=0;switch(a.eX){case "ADD":e=d+f;break;case "MUL":e=d*f;break;case "SUB":e=d-f;break;case "DIV":0==f&&G.q("Division by zero in Logic script");e=d/f;break;case "RAND":e=Math.random()*(f-d)+d}r(a.V.vd,b.u,c.u,e);c.ma=a.Oa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.T.str?1:0,f=a.T.str?a.qj:a.Hb,e=-1==a.V.v1[1]?f.inp1:k(y(a.V.v1,b.u,c.u),d);b=-1==a.V.v2[1]?f.inp2:k(y(a.V.v2,b.u,c.u),d);d=!1;switch(a.xe.condition){case 5:e==b&&(d=!0);break;case 4:e!=b&&(d=!0);break;
case 3:e<b&&(d=!0);break;case 2:e>b&&(d=!0);break;case 1:e<=b&&(d=!0);break;case 0:e>=b&&(d=!0)}c.ma=d?a.Fs:a.Oa}},REGSTORE:function(a,b,c){switch(b.state){case 2:r([a.T.gl||a.V.vd[0],a.V.vd[1]],b.u,c.u,(1==a.xe.variable_type?a.qj:a.Hb).inp1),c.ma=a.Oa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.ea=a.T.env?J.iv(a.$q[0],0):w(a);a.ea||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:switch(0!=a.state||v.fk(a.ea,a.Ac)||(a.state=1),a.state){case -1:for(var d in b.me){var f=
b.me[d].Qf.ma;-1!=f&&(f=b.me[d].M[f],"PLAY_ANIM"==f.type&&f!=a&&0==f.state&&f.ea==a.ea&&(f.state=1))}b=a.xe.param_anim_behavior;if(""==a.Wf)v.Vt(a.ea),v.Fo(a.ea,b,v.kl);else{a:{d=a.ea;for(var f=a.Wf,e=-1,g=0;8>g;g++){var h=d.ja[g];if(h&&h.Bi&&v.yM(h.Bi)==v.yM(f))if(-1!=e)e=g;else{d=-1;break a}}d=e}-1==d?(a.Ac=v.ZY(a.ea,a.Wf),v.apply(a.ea,null,a.Wf,a.Ac)):a.Ac=d;v.Fo(a.ea,b,a.Ac)}a.T.not_wait||(c.Hf=!0);v.play(a.ea,null,a.Ac);a.state=0;a.T.not_wait&&(c.ma=a.Oa,a.state=-1);break;case 0:break;case 1:a.T.not_wait||
(c.Hf=!1);c.ma=a.Oa;a.state=-1;break;default:G.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:A,SEND_REQ:function(a,b,d){function f(a,c,e,g,h){a=JSON.stringify(a);r(h[0].V.dst,b.u,d.u,a);h[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.T.url?k(y(a.V.url,b.u,d.u),1):a.qj.url,g={};a.T.ct&&(g["Content-Type"]=a.qj.ct);"GET"==a.xe.request_type?c.Ud([{id:e,type:c.mn,url:e,vk:g,Jb:[a,d.u]}],f,null,null,null):"POST"==a.xe.request_type&&c.Ud([{id:e,type:c.mn,url:e,vk:g,
fi:"POST",yo:c.mn,Km:k(y(a.V.dst1,b.u,d.u),1),Jb:[a,d.u]}],f,null,null,null);break;case 1:a.state=-1,d.ma=a.Oa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.fb["id"+b]=J.xc(J.Oc,a.Kc["id"+b],0),a.fb["id"+b]||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:H.HV(a.fb.id0,a.VB.id0,a.fb.id1,a.VB.id1),c.ma=a.Oa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Kc.id0&&(a.fb.id0=J.xc(J.Oc,a.Kc.id0,0),a.Kc.id0||(K.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0),a.rK.id0.unshift(a.VB.id0));break;case 2:var d=a.fb.id0,f=a.rK.id0,e=f[0],g=H.jU(d,e,"MAIN");c.ma=a.Oa;if(null===g){K.error('Material "'+e+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.$L){var h=H.HI(g.cj,f);H.AY(d,e,h,a.T.id0?k(y(a.V.id0,b.u,c.u),0):a.Hb.id0,a.T.id1?k(y(a.V.id1,b.u,c.u),0):a.Hb.id1,a.T.id2?k(y(a.V.id2,b.u,c.u),0):a.Hb.id2)}"ShaderNodeValue"==a.$L&&(h=H.HI(g.dj,f),H.BY(d,e,h,a.T.id0?k(y(a.V.id0,b.u,c.u),0):a.Hb.id0))}},DELAY:function(a,
b,c,d,f){switch(b.state){case 2:-1==a.state?(a.state=0,a.rx=0,c.Hf=!0):0==a.state&&(a.rx+=f,(a.T.dl?k(y(a.V.dl,b.u,c.u),0):a.Hb.dl)<a.rx&&(a.state=-1,c.ma=a.Oa,c.Hf=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.fb.id0=J.xc(J.Oc,a.Kc.id0,0);b||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);c=a.xe.sk;z.SR(b)?z.BV(b,c)||(K.error("Wrong key name:",c),a.qc=!0):(K.error("No shape keys in object:",b.name),a.qc=!0);break;case 2:z.JQ(a.fb.id0,a.xe.sk,a.T.skv?k(y(a.V.skv,
b.u,c.u),0):a.Hb.skv),c.ma=a.Oa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.fb.id0=J.xc(J.Oc,a.Kc.id0,0);d||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);d&&d.k&&d.k.Vc||(K.error("Can't evaluate 'Outline' logic node: wrong object"),a.qc=!0);break;case 2:d=a.fb.id0;switch(a.xe.outline_operation){case "PLAY":b=d.k.ai;J.zn(d,b.rk,b.tk,b.uk);break;case "STOP":J.lu(d);break;case "INTENSITY":d.k.ih=a.T["in"]?k(y(a.V["in"],b.u,c.u),0):a.Hb["in"]}c.ma=a.Oa}},MOVE_CAMERA:function(a,
b,c){function f(a,b,c,d){switch(C.im(a)){case C.Kb:C.Cs(a,b,c);break;case C.nd:case C.Bg:t.mj(a,d);break;case C.bd:F.sub(c,b,R),F.normalize(R,R),C.Uw(a,c),c=b=0,Z[0]=R[0],Z[1]=0,Z[2]=R[2],b=F.dot(Z,R),c=Math.acos(b/(F.length(Z)*F.length(R))),b=R[2]?Math.atan(R[0]/R[2]):0<R[0]?0:Math.PI,0<R[2]&&0<R[0]?u[1]=-(Math.PI+u[1]):0<R[2]&&0>R[0]?u[1]=-(Math.PI+u[1]):0>R[2]&&0>R[0]?(u[0]+=Math.PI,b=-(Math.PI-b)):0>R[2]&&0<R[0]&&(u[0]+=Math.PI,b-=Math.PI),C.vs(a,b+Math.PI,-c,!0,!0)}t.D(a);M.H(a)}function e(a,
b,c,f){p.lookAt(b,c,G.nc,ca);p.invert(ca,ca);d.fromMat4(ca,ga);x.fromMat3(ga,U);x.normalize(U,U);da.hi(b,da.Yd(a.k.n),U,f)}switch(b.state){case 1:c=null;c=a.fb.ca=J.xc(J.Oc,a.Kc.id0,0);c||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.fb.tr=J.xc(J.Oc,a.Kc.id1,0);a.fb.tr||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.fb.ta=J.xc(J.Oc,a.Kc.id2,0);a.fb.ta||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.vc=
{WM:new Float32Array(3),VM:new Float32Array(3),CB:new Float32Array(3),OD:new Float32Array(3),IM:new Float32Array(3),BB:new Float32Array(3),Uk:new Float32Array(8),oi:new Float32Array(8),Dr:new Float32Array(8)};break;case 2:var g=a.fb.ca,h=da.G(a.fb.tr.k.n),l=da.G(a.fb.ta.k.n);switch(a.state){case -1:b=a.T.dur?k(y(a.V.dur,b.u,c.u),0):a.Hb.dur;if(0==b){e(g,h,l,a.vc.oi);f(g,h,l,a.vc.oi);c.ma=a.Oa;break}F.copy(da.G(g.k.n),a.vc.WM);var m=C.im(g);m==C.bd?F.copy(g.k.Vb,a.vc.OD):m==C.Bg||m==C.nd?(da.copy(g.k.n,
a.vc.Uk),e(g,h,l,a.vc.oi)):F.copy(g.k.pivot,a.vc.OD);F.copy(h,a.vc.VM);F.copy(l,a.vc.IM);a.state=0;var n=P.xn(0,1,1E3*b,function(b){D.Da()&&(m==C.Bg||m==C.nd?da.DB(a.vc.Uk,a.vc.oi,G.Tm(b),a.vc.Dr):(a.vc.BB=F.lerp(a.vc.OD,a.vc.IM,G.Tm(b),a.vc.BB),a.vc.CB=F.lerp(a.vc.WM,a.vc.VM,G.Tm(b),a.vc.CB)),f(g,a.vc.CB,a.vc.BB,a.vc.Dr),1==b&&(a.state=1))});break;case 1:P.ku(n),a.state=-1,c.ma=a.Oa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d=null,d=a.fb.ca=J.xc(J.Oc,a.Kc.id0,0);d||(K.error("Logic script error: object not found. Node: ",
a.name),a.qc=!0);b=d.k;a.yR={Rk:b.Rk,use_panning:b.use_panning,mb:b.mb,la:b.la,tb:b.tb,Bc:b.Bc,Cc:b.Cc,ce:b.ce,Nh:b.Nh};break;case 2:var d=a.fb.ca,f=d.k,e=a.yR;C.gt(d);switch(a.xe.camera_move_style){case 0:f.vb=C.Bg;break;case 2:f.vb=C.nd;var g=da.G(f.n);C.SY(d,g,null,e.mb,e.la);break;case 3:f.vb=C.bd;var g=da.G(f.n),h=R;a.T.pvo?(h=J.xc(J.Oc,a.Kc.id1,0),h=da.G(h.k.n)):(h[0]=a.T.pvx?k(y(a.V.pvx,b.u,c.u),0):a.Hb.pvx,h[1]=a.T.pvy?k(y(a.V.pvy,b.u,c.u),0):a.Hb.pvy,h[2]=a.T.pvz?k(y(a.V.pvz,b.u,c.u),0):
a.Hb.pvz);C.XL(d,g,h,e.tb,e.la,e.Bc,e.Cc,e.Nh);break;case 1:f.vb=C.Kb,g=da.G(f.n),h=R,a.T.pvo?(h=J.xc(J.Oc,a.Kc.id1,0),h=da.G(h.k.n)):(h[0]=a.T.pvx?k(y(a.V.pvx,b.u,c.u),0):a.Hb.pvx,h[1]=a.T.pvy?k(y(a.V.pvy,b.u,c.u),0):a.Hb.pvy,h[2]=a.T.pvz?k(y(a.V.pvz,b.u,c.u),0):a.Hb.pvz),C.YL(d,g,h,e.mb,e.la,e.G3,e.ce,e.use_panning)}Z[0]=a.T.vtr?k(y(a.V.vtr,b.u,c.u),0):a.Hb.vtr;Z[1]=a.T.vro?k(y(a.V.vro,b.u,c.u),0):a.Hb.vro;Z[2]=a.T.vzo?k(y(a.V.vzo,b.u,c.u),0):a.Hb.vzo;Z[0]=G.U(Z[0],0,Infinity);Z[1]=G.U(Z[1],0,Infinity);
Z[2]=G.U(Z[2],0,.99);f.$k=Z[0];f.Zk=Z[1];f.al=Z[2];t.D(d);M.H(d);C.ao(d);c.ma=a.Oa}},MOVE_TO:function(a,b,c){function d(a,b){t.mj(a,b);t.D(a);M.H(a)}switch(b.state){case 1:a.fb.ob=J.xc(J.Oc,a.Kc.id0,0);a.fb.ob||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.fb.de=J.xc(J.Oc,a.Kc.id1,0);a.fb.de||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.jc={EH:new Float32Array(8),EA:new Float32Array(8),AJ:new Float32Array(8)};break;case 2:var f=
a.fb.ob;da.copy(a.fb.ob.k.n,a.jc.EH);da.copy(a.fb.de.k.n,a.jc.EA);switch(a.state){case -1:b=a.T.dur?k(y(a.V.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(f,a.jc.EA);c.ma=a.Oa;break}a.state=0;var e=P.xn(0,1,1E3*b,function(b){D.Da()&&(a.jc.E6=da.DB(a.jc.EH,a.jc.EA,G.Tm(b),a.jc.AJ),d(f,a.jc.AJ),1==b&&(a.state=1))});break;case 1:P.ku(e),a.state=-1,c.ma=a.Oa}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?t.mj(a,b):t.Zw(a,b);t.D(a);M.H(a)}switch(b.state){case 1:a.fb.ob=J.xc(J.Oc,a.Kc.id0,0);a.fb.ob||
(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);a.state=-1;a.jc={kx:0,Uk:new Float32Array(8),oi:new Float32Array(8),Dr:new Float32Array(8)};break;case 2:var f=a.fb.ob;switch(a.state){case -1:Z[0]=a.T.trx?k(y(a.V.trx,b.u,c.u),0):a.Hb.trx;Z[1]=a.T["try"]?k(y(a.V["try"],b.u,c.u),0):a.Hb["try"];Z[2]=a.T.trz?k(y(a.V.trz,b.u,c.u),0):a.Hb.trz;R[0]=a.T.rox?k(y(a.V.rox,b.u,c.u),0)*Math.PI/180:a.Hb.rox;R[1]=a.T.roy?k(y(a.V.roy,b.u,c.u),0)*Math.PI/180:a.Hb.roy;R[2]=a.T.roz?k(y(a.V.roz,
b.u,c.u),0)*Math.PI/180:a.Hb.roz;var e=a.T.sc?y(a.V.sc,b.u,c.u):a.Hb.sc;G.Wj(R,U);da.hi(Z,e,U,a.jc.oi);a.jc.kx=a.xe.space_type;switch(a.jc.kx){case 0:t.vr(f,a.jc.Uk);break;case 1:t.wr(f,a.jc.Uk);break;case 2:t.wr(f,a.jc.Uk),da.multiply(a.jc.Uk,a.jc.oi,a.jc.oi)}b=a.T.dur?k(y(a.V.dur,b.u,c.u),0):a.Hb.dur;if(0==b){d(f,a.jc.oi,a.jc.kx);c.ma=a.Oa;break}a.state=0;e=P.xn(0,1,1E3*b,function(b){D.Da()&&(da.DB(a.jc.Uk,a.jc.oi,G.Tm(b),a.jc.Dr),d(f,a.jc.Dr,a.jc.kx),1==b&&(a.state=1))});break;case 1:P.ku(e),a.state=
-1,c.ma=a.Oa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.ea=J.xc(J.Oc,a.Kc.id0,0);a.ea||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);void 0==a.T.not_wait&&(a.T.not_wait=!0);break;case 2:switch(g.aW(a.ea)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.me){var f=b.me[d].Qf.ma;-1!=f&&(f=b.me[d].M[f],"SPEAKER_PLAY"==f.type&&f!=a&&0==f.state&&f.ea==a.ea&&(f.state=1))}a.T.not_wait||(c.Hf=!0);g.HK(a.ea);a.state=0;break;case 0:a.T.not_wait&&(c.ma=a.Oa,a.state=
-1);break;case 1:a.T.not_wait||(c.Hf=!1);c.ma=a.Oa;a.state=-1;break;default:G.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.ea=J.xc(J.Oc,a.Kc.id0,0);a.ea||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:g.stop(a.ea),c.ma=a.Oa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.ea=a.T.env?J.iv(a.$q[0],0):w(a);a.ea||(K.error("Logic script error: object not found. Node: ",a.name),a.qc=!0);break;case 2:v.stop(a.ea,
v.kl),a.T.rst&&v.gD(a.ea,v.kl),c.ma=a.Oa}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.T.rst&&O.IL(d),O.vM(),c.ma=a.Oa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},f;for(f in a.V)d[a.V[f][1]]=y(a.V[f],b.u,c.u);K.log(a.xe.msg,JSON.stringify(d));c.ma=a.Oa}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.T.id0?k(y(a.V.id0,b.u,c.u),1):a.qj.id0,f=a.T.id1?k(y(a.V.id1,b.u,c.u),1):a.qj.id1,e=0;switch(a.xe.string_operation){case 0:e=d+f;break;case 1:e=d.indexOf(f);break;
case 2:e=d.replace(f,a.T.id2?k(y(a.V.id2,b.u,c.u),1):a.qj.id2);break;case 3:var g=a.V,e=d.substring(0,d.indexOf(f));r(g.dst1,b.u,c.u,d.substring(d.indexOf(f)+1,d.length));""==y(g.dst,b.u,c.u)&&(e=y(g.dst1,b.u,c.u),r(g.dst1,b.u,c.u,""));break;case 4:switch(a.xe.condition){case 5:e=d==f?1:0;break;case 4:e=d!=f?1:0;break;case 3:e=d<f?1:0;break;case 2:e=d>f?1:0;break;case 1:e=d<=f?1:0;break;case 0:e=d>=f?1:0}}r(a.V.dst,b.u,c.u,e);c.ma=a.Oa}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=a.T.nla?
k(O.rr(d),0):k(P.rr(d),0),r(a.V.vd,b.u,c.u,d),c.ma=a.Oa}},JSON:function(a,b,c){function d(a,b,c,e){for(var g=0;g<b.length;g++){for(var h=b[g].split("."),k=a,l=c[g],p=0;p<h.length&&(k=k[h[p]],void 0!==k&&null!==k);p++);k=f(k);e[l]=k}}function e(a,b,c,d){d||(d={});for(var g=0;g<b.length;g++){var h=b[g].split("."),k=d,l=c[g];if(!(!l in a)){for(var p=0;p<h.length-1;p++)void 0===k[h[p]]&&(k[h[p]]=isNaN(h[p+1])?{}:[]),k=k[h[p]];k[h[h.length-1]]=f(a[l])}}}switch(b.state){case 2:switch(a.xe.json_operation){case "PARSE":try{var g=
JSON.parse(k(y(a.V.jsn,b.u,c.u),1));d(g,a.hX,a.iX,c.u)}catch(h){K.error("logic script error: non valid JSON string")}break;case "ENCODE":g={},e(c.u,a.RT,a.ST,g),g=k(JSON.stringify(g),1),r(a.V.jsn,b.u,c.u,g)}c.ma=a.Oa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.T.cb?k(y(a.V.cb,b.u,c.u),1):a.qj.cb,e=[],g=0,h="id"+g,l=a.xe.js_cb_params;h in l;)h=0==l[h]?J.xc(J.Oc,a.Kc[h],0):y(a.V[h],b.u,c.u),e.push(h),g++,h="id"+g;l=[];g=0;for(h="out"+g;h in a.V;)h=y(a.V[h],b.u,c.u),l.push(h),g++,
h="out"+g;g=1;if(d in ia){if(g=!ia[d](e,l))for(d=0;d<l.length;d++)h="out"+d,h in a.V&&r(a.V[h],b.u,c.u,f(l[d]))}else K.error("logic script error: no custom callback with id "+d);g&&(c.ma=a.Oa)}},EMPTY:A},aa=[],ia={};a.KV=function(a,b){var c={Ue:b,nL:a.name,state:0,Cm:null,yb:a,yA:null,me:[],Gs:[],u:{}};a.W1=c;m(a,c)};a.update=function(a,b){var c=O.qV();if(!(0>=c))for(var d=0;d<aa.length;d++)for(var f=d,e=a,g=b,h=c,k=aa[f],l=0;l<aa[f].me.length;l++){k.yA=aa[f].me[l];var p=aa[f].me[l],m=k,n=e,r=g,t=
h,u=p.M;if(u.length){for(var M=0;M<u.length;M++)u[M].Bw=!1;for(M=0;M<u.length;M++){if(0<=p.Qf.ma)var x=u[p.Qf.ma];else break;if(x.Bw)break;if(x.qc)if("ENTRYPOINT"==x.type)break;else p.Qf.ma=x.Oa,x.Bw=!0;else x.PK(x,m,p.Qf,n,r,t),x.Bw=!0}}}};a.a2=function(a,b){ia[a]=b};a.K7=function(a){delete ia[a]};a.V7=function(a,b){for(var c=0;c<aa.length;c++)if(aa[c].nL==a){for(var c=aa[c],d=0;d<c.me.length;d++){var f=c.me[d].M[0];if(f.name==b){f.T.js&&(f.qc=!1);c.me[d].Qf.ma=0;break}}break}};a.ua=function(){aa.length=
0;ia={}}};b4w.module.__reformer=function(a,l){function n(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function e(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],f=0;f<d.strips.length;f++){var e=d.strips[f];"action"in e||(e.action=null,b("strip",e,"action"));"action_frame_start"in e||(e.action_frame_start=0,b("strip",e,"action_frame_start"));"action_frame_end"in e||(e.action_frame_end=e.frame_end-e.frame_start,b("strip",e,"action_frame_end"));"repeat"in e||(e.repeat=1,b("strip",e,"repeat"));
"use_reverse"in e||(e.use_reverse=!1,b("strip",e,"use_reverse"));"scale"in e||(e.scale=1,b("strip",e,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={ED:[],eL:"undefined",type:a});D[c].ED.push(b.name)}function y(a,b,c){c=c+">>"+a;c in D||(D[c]={ED:[],eL:"deprecated",type:a});D[c].ED.push(b.name)}function r(a){k.warn(a)}function A(a,b){b||(b=a.name+"_COPY");var c=a.materials,f=a.submeshes;a.materials=null;a.submeshes=null;var e=v.Ih(a);a.materials=c;a.submeshes=f;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<f.length;c++){var h=v.zq(f[c]);e.submeshes.push(h)}return e}var h=l("__boundings"),w=l("__curve"),m=l("__mat4"),k=l("__print"),f=l("__quat"),v=l("__util"),c=l("__vec3"),C=l("__mat3"),O=l("__logic_nodes"),J=l("__animation"),K=[5,4],D={},Q=C.create(),L=f.create();a.IG=function(a){return-1!=v.zN(a,K)};a.IR=function(a){D={};var c=a.worlds;if(0==c.length){k.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var d={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};c.push(d)}for(var c=a.worlds,f=0;f<c.length;f++){d=c[f];"use_sky_blend"in d||(b("world",d,"use_sky_blend"),d.use_sky_blend=!1);"use_sky_paper"in d||(b("world",d,"use_sky_paper"),
d.use_sky_paper=!1);"use_sky_real"in d||(b("world",d,"use_sky_real"),d.use_sky_real=!1);"b4w_sky_settings"in d&&"rayleigh_brightness"in d.b4w_sky_settings||(b("world",d,"rayleigh_brightness"),d.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
d||(b("world",d,"fog_settings"),d.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in d&&(d.fog_settings.use_custom_color=!0,d.fog_settings.color=d.b4w_fog_color),"b4w_fog_density"in d&&0<d.b4w_fog_density&&(d.fog_settings.depth=1/d.b4w_fog_density));"render_sky"in d.b4w_sky_settings||(b("world",d,"render_sky"),d.b4w_sky_settings.render_sky=!1);for(var h=d.texture_slots,l=0;l<h.length;l++){var g=h[l];"blend_type"in
g||(g.blend_type="MIX",b("world_texture_slot",g,"blend_type"));"use_map_blend"in g||(g.use_map_blend=!1,b("world_texture_slot",g,"use_map_blend"));"use_map_horizon"in g||(g.use_map_horizon=!0,b("world_texture_slot",g,"use_map_horizon"));"use_map_zenith_up"in g||(g.use_map_zenith_up=!1,b("world_texture_slot",g,"use_map_zenith_up"));"use_rgb_to_intensity"in g||(g.use_rgb_to_intensity=!1,b("world_texture_slot",g,"use_rgb_to_intensity"));"invert"in g||(g.invert=!1,b("world_texture_slot",g,"invert"));
"color"in g||(g.color=[1,0,1],b("world_texture_slot",g,"color"));"blend_factor"in g||(g.blend_factor=0,b("world_texture_slot",g,"blend_factor"));"horizon_factor"in g||(g.horizon_factor=1,b("world_texture_slot",g,"horizon_factor"));"zenith_up_factor"in g||(g.zenith_up_factor=0,b("world_texture_slot",g,"zenith_up_factor"));"zenith_down_factor"in g||(g.zenith_down_factor=0,b("world_texture_slot",g,"zenith_down_factor"));"default_value"in g||(g.default_value=1,b("world_texture_slot",g,"default_value"))}"b4w_use_default_animation"in
d||(b("world",d,"b4w_use_default_animation"),d.b4w_use_default_animation=!1);"b4w_anim_behavior"in d||(b("world",d,"b4w_anim_behavior"),d.b4w_anim_behavior="CYCLIC")}l=a.scenes;for(f=0;f<l.length;f++)h=l[f],g=h.world,"timeline_markers"in h||(h.timeline_markers=null,b("scene",h,"timeline_markers")),"b4w_reflection_quality"in h||(h.b4w_reflection_quality="MEDIUM",b("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,b("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,b("scene",h,
"fps")),"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,b("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],b("scene",h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(y("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in h||(h.b4w_enable_bloom=!1,b("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,b("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=!1,b("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",b("scene",h,"b4w_antialiasing_quality")),
"b4w_tags"in h||(h.b4w_tags={title:"",description:""},b("scene",h,"b4w_tags")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection="AUTO",b("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",b("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in h||(h.b4w_enable_glow_materials="AUTO",b("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility="AUTO",b("scene",h,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],b("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor="b4w_glow_factor"in h?h.b4w_glow_factor:1,b("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(b("scene",h,"b4w_shadow_settings"),c=g.b4w_shadow_settings,h.b4w_shadow_settings=c?c:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),c=h.b4w_shadow_settings,"csm_resolution"in c||(b("scene",h,"b4w_shadow_settings.csm_resolution"),c.csm_resolution=2048),"blur_samples"in c||(b("scene",h,"b4w_shadow_settings.blur_samples"),c.blur_samples="16x"),"soft_shadows"in c||(b("scene",h,"b4w_shadow_settings.soft_shadows"),c.soft_shadows=!0),"self_shadow_polygon_offset"in c||(b("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),c.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in c||(b("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),c.self_shadow_normal_offset=.01),"b4w_enable_csm"in c||(b("scene",h,"b4w_shadow_settings.b4w_enable_csm"),c.b4w_enable_csm=!1),"csm_num"in c||(b("scene",h,"b4w_shadow_settings.csm_num"),c.csm_num=1),"csm_first_cascade_border"in c||(b("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),c.csm_first_cascade_border=10),"first_cascade_blur_radius"in c||(b("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),
c.first_cascade_blur_radius=3),"csm_last_cascade_border"in c||(b("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),c.csm_last_cascade_border=100),"last_cascade_blur_radius"in c||(b("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),c.last_cascade_blur_radius=1.5),"fade_last_cascade"in c||(b("scene",h,"b4w_shadow_settings.fade_last_cascade"),c.fade_last_cascade=!0),"blend_between_cascades"in c||(b("scene",h,"b4w_shadow_settings.blend_between_cascades"),c.blend_between_cascades=!0),"b4w_ssao_settings"in
h||(b("scene",h,"b4w_ssao_settings"),c=g.b4w_ssao_settings,h.b4w_ssao_settings=c?c:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),c=h.b4w_ssao_settings,"dist_factor"in c||(b("scene",h,"b4w_ssao_settings.dist_factor"),c.dist_factor=0),"samples"in c||(b("scene",h,"b4w_ssao_settings.samples"),c.samples=16),"hemisphere"in c||(b("scene",h,"b4w_ssao_settings.hemisphere"),c.hemisphere=!1),"blur_depth"in c||(b("scene",h,"b4w_ssao_settings.blur_depth"),c.blur_depth=!1),"blur_discard_value"in
c||(b("scene",h,"b4w_ssao_settings.blur_discard_value"),c.blur_discard_value=1),"b4w_bloom_settings"in h||(b("scene",h,"b4w_bloom_settings"),c=g.b4w_bloom_settings,h.b4w_bloom_settings=c?c:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=.2),"blur"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in h||(b("scene",h,"b4w_motion_blur_settings"),c=g.b4w_motion_blur_settings,h.b4w_motion_blur_settings=c?c:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in h||(b("scene",h,"b4w_color_correction_settings"),c=g.b4w_color_correction_settings,h.b4w_color_correction_settings=c?c:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in h||(b("scene",h,"b4w_god_rays_settings"),c=g.b4w_god_rays_settings,h.b4w_god_rays_settings=c?c:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(b("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in h||(b("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},c=h.b4w_glow_settings,"b4w_render_glow_over_blend"in g&&(c.render_glow_over_blend=g.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in g&&(c.small_glow_mask_coeff=g.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in g&&(c.large_glow_mask_coeff=g.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
g&&(c.small_glow_mask_width=g.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in g&&(c.large_glow_mask_width=g.b4w_large_glow_mask_width)),g=h.b4w_render_shadows,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(h.b4w_render_shadows=g?"ON":"OFF"),g=h.b4w_render_reflections,"OFF"!=g&&"ON"!=g&&(h.b4w_render_reflections=g?"ON":"OFF"),g=h.b4w_render_refractions,"AUTO"!=g&&"OFF"!=g&&"ON"!=g&&(h.b4w_render_refractions=g?"ON":"OFF"),"b4w_render_dynamic_grass"in h||(b("scene",h,"b4w_render_dynamic_grass"),h.b4w_render_dynamic_grass=
"AUTO"),h.b4w_nla_script&&y("scene",h,"b4w_nla_script"),"audio_distance_model"in h||(b("scene",h,"audio_distance_model"),h.audio_distance_model="INVERSE_CLAMPED");h=a.meshes;for(f=0;f<h.length;f++){g=h[f];g.b4w_boundings||(b("mesh",g,"b4w_boundings"),g.b4w_boundings={},c=g.b4w_boundings,c.bb=g.b4w_bounding_box?g.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},c.bb_src=g.b4w_bounding_box_source?g.b4w_bounding_box_source:g.b4w_bounding_box,c.bs_cen=g.b4w_bounding_sphere_center?g.b4w_bounding_sphere_center:
[0,0,0],c.bc_cen=g.b4w_bounding_cylinder_center?g.b4w_bounding_cylinder_center:[0,0,0],c.be_cen=g.b4w_bounding_ellipsoid_center?g.b4w_bounding_ellipsoid_center:[0,0,0],g.b4w_bounding_ellipsoid_axes?c.be_ax=g.b4w_bounding_ellipsoid_axes:(l=c.bb,c.be_ax=[(l.max_x-l.min_x)/2,(l.max_y-l.min_y)/2,(l.max_z-l.min_z)/2]),g.b4w_rotated_bounding_box?c.rbb=g.b4w_rotated_bounding_box:(l=c.bb,c.rbb={rbb_c:[(l.max_x+l.min_x)/2,(l.max_y+l.min_y)/2,(l.max_z+l.min_z)/2],rbb_s:[1,1,1]}),c.caxis_x=g.b4w_cov_axis_x?
g.b4w_cov_axis_x:[1,0,0],c.caxis_y=g.b4w_cov_axis_y?g.b4w_cov_axis_y:[0,1,0],c.caxis_z=g.b4w_cov_axis_z?g.b4w_cov_axis_z:[0,0,1]);g.uv_textures||(b("mesh",g,"uv_textures"),g.uv_textures=[]);"b4w_shape_keys"in g||(g.b4w_shape_keys=[],b("mesh",g,"b4w_shape_keys"));c=!0;for(d=0;d<g.submeshes.length;d++){var m=g.submeshes[d];"boundings"in m||(c=!1,m.boundings={be_ax:g.b4w_bounding_ellipsoid_axes,be_cen:g.b4w_bounding_ellipsoid_center,bb:{max_x:g.b4w_bounding_box.max_x,max_y:g.b4w_bounding_box.max_y,max_z:g.b4w_bounding_box.max_z,
min_x:g.b4w_bounding_box.min_x,min_y:g.b4w_bounding_box.min_y,min_z:g.b4w_bounding_box.min_z}});"be_ax"in m.boundings||(m.boundings.be_ax=g.b4w_bounding_ellipsoid_axes);"be_cen"in m.boundings||(m.boundings.be_cen=g.b4w_bounding_ellipsoid_center);"bb"in m.boundings||(m.boundings.bb=g.b4w_bounding_box);"rbb"in m.boundings||(l=g.b4w_bounding_box,m.boundings.rbb={rbb_c:[(l.max_x+l.min_x)/2,(l.max_y+l.min_y)/2,(l.max_z+l.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in m.boundings||(m.boundings.caxis_x=[1,0,0]);
"caxis_y"in m.boundings||(m.boundings.caxis_y=[0,1,0]);"caxis_z"in m.boundings||(m.boundings.caxis_z=[0,0,1])}c||b("mesh",g,"submesh_bd");l=g;c=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];d=null;for(m=0;m<c.length;m++)l[c[m]]&&(d?(l[c[m]]=!1,k.warn('WARNING property "'+c[m]+'" of object "'+l.name+'" has been set to "false". Foreground property "'+d+'" already exists.')):d=c[m]);for(l=0;l<g.b4w_vertex_anim.length;l++)c=g.b4w_vertex_anim[l],
"allow_nla"in c||(b('mesh["b4w_vertex_anim"]',g,"allow_nla"),c.allow_nla=!0)}l=a.cameras;for(f=0;f<l.length;f++)h=l[f],h.type||(h.type="PERSP",b("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,y("camera",h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,b("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,b("camera",h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=1,b("camera",h,"b4w_rot_velocity")),
"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,b("camera",h,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in h||(h.b4w_use_target_distance_limits=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_target_distance_limits")),"b4w_use_zooming"in h||(h.b4w_use_zooming=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_zooming")),"b4w_distance_min"in h||(h.b4w_distance_min=1,b("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,b("camera",h,"b4w_distance_max")),
"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=-100,b("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,b("camera",h,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,b("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,b("camera",h,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
h||(h.b4w_use_horizontal_clamping=!1,b("camera",h,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,b("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=Math.PI,b("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",b("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=!1,b("camera",h,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=-Math.PI/2,b("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,b("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in h||(h.b4w_vertical_clamping_type="LOCAL",b("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,b("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=Math.PI/6,b("camera",h,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in h||(h.b4w_enable_hover_hor_rotation=!0,b("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,b("camera",h,"b4w_use_panning")),"b4w_use_pivot_limits"in h||(h.b4w_use_pivot_limits=!1,h.b4w_pivot_z_min=0,h.b4w_pivot_z_max=10,b("camera",h,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in h||(h.b4w_dof_bokeh=!1,b("camera",h,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in h||(h.b4w_dof_bokeh_intensity=.3,b("camera",h,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in h||(h.b4w_dof_foreground_blur=!1,b("camera",h,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in h||(h.b4w_dof_front_start=0,b("camera",h,"b4w_dof_front_start")),"b4w_dof_front_end"in h||(h.b4w_dof_front_end=h.b4w_dof_front,b("camera",h,"b4w_dof_front_end")),"b4w_dof_rear_start"in h||(h.b4w_dof_rear_start=0,b("camera",h,"b4w_dof_rear_start")),"b4w_dof_rear_end"in h||(h.b4w_dof_rear_end=h.b4w_dof_rear,b("camera",h,"b4w_dof_rear_end"));l=a.lamps;for(f=0;f<l.length;f++)h=
l[f],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,b("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,b("lamp",h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,b("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,b("lamp",h,"use_specular")),"clip_start"in h||(h.clip_start=.1,b("lamp",h,"clip_start")),"clip_end"in h||(h.clip_end=30,b("lamp",h,"clip_end")),"POINT"!=h.type&&"SPOT"!=h.type||"use_sphere"in h||(h.use_sphere=
!1,b("lamp",h,"use_sphere"));l=a.speakers;for(f=0;f<l.length;f++)h=l[f],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in h||(h.b4w_auto_play=!1,b("speaker",h,"b4w_auto_play")),"b4w_enable_doppler"in h||(h.b4w_enable_doppler=!1,b("speaker",h,"b4w_enable_doppler")),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),
"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_start"in h||(h.b4w_loop_start=0,b("speaker",h,"b4w_loop_start")),"b4w_loop_end"in h||(h.b4w_loop_end=0,b("speaker",h,"b4w_loop_end")),h.animation_data&&e(h.animation_data);l=a.textures;for(f=0;f<l.length;f++)h=l[f],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering="OFF",b("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,b("texture",h,
"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],b("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=[1,1],b("texture",h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,b("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,b("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in h||(h.b4w_shore_dist_map=!1,b("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in
h||(h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=100,b("texture",h,"b4w_max_shore_dist")),"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,b("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",b("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",b("texture",h,"b4w_source_id")),"b4w_source_size"in h||(h.b4w_source_size=1024,b("texture",h,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,b("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in h||(h.b4w_nla_video=!1,b("texture",h,"b4w_nla_video"));l=a.images;for(f=0;f<l.length;f++)h=l[f],"colorspace_settings_name"in h||(h.colorspace_settings_name="sRGB",b("image",h,"colorspace_settings_name"));c=a.materials;for(f=0;f<c.length;f++){d=c[f];"ALPHA_ANTIALIASING"==d.game_settings.alpha_blend&&(d.game_settings.alpha_blend="CLIP");"use_tangent_shading"in d||(d.use_tangent_shading=
!1,b("material",d,"use_tangent_shading"));"b4w_node_mat_type"in d&&y("material",d,"b4w_node_mat_type");"b4w_skydome"in d&&y("material",d,"b4w_skydome");"b4w_procedural_skydome"in d&&y("material",d,"b4w_procedural_skydome");"b4w_lens_flares"in d||(d.b4w_lens_flares=!1,b("material",d,"b4w_lens_flares"));"LENS_FLARES"===d.name&&(d.b4w_lens_flares||k.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),d.b4w_lens_flares=!0);d.b4w_water&&("b4w_water_shore_smoothing"in
d||(d.b4w_water_shore_smoothing=!1,b("material",d,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in d||(d.b4w_water_dynamic=!1,b("material",d,"b4w_water_dynamic")),"b4w_waves_height"in d||(d.b4w_waves_height=1,b("material",d,"b4w_waves_height")),"b4w_waves_length"in d||(d.b4w_waves_length=1,b("material",d,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in d||(d.b4w_water_dst_noise_scale0=.05,b("material",d,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in d||(d.b4w_water_dst_noise_scale1=
.03,b("material",d,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in d||(d.b4w_water_dst_noise_freq0=1.3,b("material",d,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in d||(d.b4w_water_dst_noise_freq1=1,b("material",d,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in d||(d.b4w_water_dir_min_shore_fac=.4,b("material",d,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in d||(d.b4w_water_dir_freq=.5,b("material",d,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
d||(d.b4w_water_dir_noise_scale=.05,b("material",d,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in d||(d.b4w_water_dir_noise_freq=.07,b("material",d,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in d||(d.b4w_water_dir_min_noise_fac=.5,b("material",d,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in d||(d.b4w_water_dst_min_fac=.2,b("material",d,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in d||(d.b4w_water_waves_hor_fac=5,b("material",d,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in d||(d.b4w_water_absorb_factor=6,b("material",d,"b4w_water_absorb_factor")),"b4w_water_fog_color"in d||(d.b4w_water_fog_color=[.5,.7,.7],b("material",d,"b4w_water_fog_color")),"b4w_foam_factor"in d||(d.b4w_foam_factor=5,b("material",d,"b4w_foam_factor")),"b4w_generated_mesh"in d||(d.b4w_generated_mesh=!1,b("material",d,"b4w_generated_mesh")),"b4w_water_num_cascads"in d||(d.b4w_water_num_cascads=5,b("material",d,"b4w_water_num_cascads")),"b4w_water_subdivs"in d||(d.b4w_water_subdivs=
64,b("material",d,"b4w_water_subdivs")),"b4w_water_detailed_dist"in d||(d.b4w_water_detailed_dist=1E3,b("material",d,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in d||(d.b4w_water_enable_caust=!1,b("material",d,"b4w_water_enable_caust")),"b4w_water_caust_scale"in d||(d.b4w_water_caust_scale=.25,b("material",d,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in d||(d.b4w_water_caust_brightness=.5,b("material",d,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in d||(d.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in d||(d.b4w_dynamic_grass_color="");"diffuse_intensity"in d||(d.diffuse_intensity=1,b("material",d,"diffuse_intensity"));"b4w_use_ghost"in d||(d.b4w_use_ghost=!1);"b4w_collision_margin"in d||(d.b4w_collision_margin=.04,b("material",d,"b4w_collision_margin"));"b4w_collision_group"in d||(d.b4w_collision_group=128,b("material",d,"b4w_collision_group"));"b4w_collision_mask"in d||(d.b4w_collision_mask=127,b("material",d,"b4w_collision_mask"));"b4w_do_not_render"in d||(d.b4w_do_not_render=
!1,b("material",d,"b4w_do_not_render"));"HALO"!=d.type||"b4w_halo_sky_stars"in d||(d.b4w_halo_sky_stars=!1,b("material",d,"b4w_halo_sky_stars"));"HALO"!=d.type||"b4w_halo_stars_blend_height"in d||(d.b4w_halo_stars_blend_height=10,b("material",d,"b4w_halo_stars_blend_height"));"HALO"!=d.type||"b4w_halo_stars_min_height"in d||(d.b4w_halo_stars_min_height=0,b("material",d,"b4w_halo_stars_min_height"));"specular_shader"in d||(d.specular_shader="COOKTORR",b("material",d,"specular_shader"));"diffuse_shader"in
d||(d.diffuse_shader="LAMBERT",b("material",d,"diffuse_shader"));"roughness"in d||(d.roughness=.5,b("material",d,"roughness"));"diffuse_fresnel"in d||(d.diffuse_fresnel=.1,b("material",d,"diffuse_fresnel"));"diffuse_fresnel_factor"in d||(d.diffuse_fresnel_factor=.5,b("material",d,"diffuse_fresnel_factor"));"specular_slope"in d||(d.specular_slope=.2,b("material",d,"specular_slope"));"specular_toon_size"in d||(d.specular_toon_size=.5,b("material",d,"specular_toon_size"));"specular_toon_smooth"in d||
(d.specular_toon_smooth=.1,b("material",d,"specular_toon_smooth"));"specular_alpha"in d||(d.specular_alpha=1,b("material",d,"specular_alpha"));"b4w_wettable"in d||(d.b4w_wettable=!1,b("material",d,"b4w_wettable"));"b4w_refractive"in d||(d.b4w_refractive=!1,b("material",d,"b4w_refractive"));"b4w_refr_bump"in d||(d.b4w_refr_bump=0,b("material",d,"b4w_refr_bump"));"b4w_shallow_water_col"in d||(d.b4w_shallow_water_col=[0,.8,.3],b("material",d,"b4w_shallow_water_col"));"b4w_shore_water_col"in d||(d.b4w_shore_water_col=
[0,.9,.2],b("material",d,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in d||(d.b4w_shallow_water_col_fac=1,b("material",d,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in d||(d.b4w_shore_water_col_fac=.5,b("material",d,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in d||(d.b4w_water_sss_strength=5.9,b("material",d,"b4w_water_sss_strength"));"b4w_water_sss_width"in d||(d.b4w_water_sss_width=.45,b("material",d,"b4w_water_sss_width"));"b4w_render_above_all"in d||(d.b4w_render_above_all=
!1,b("material",d,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in d||(d.b4w_water_norm_uv_velocity=.05,b("material",d,"b4w_water_norm_uv_velocity"));"specular_ior"in d||(d.specular_ior=1,b("material",d,"specular_ior"));"darkness"in d||(d.darkness=0,b("material",d,"darkness"));"diffuse_toon_size"in d||(d.diffuse_toon_size=0,b("material",d,"diffuse_toon_size"));"diffuse_toon_smooth"in d||(d.diffuse_toon_smooth=0,b("material",d,"diffuse_toon_smooth"));"pass_index"in d||(d.pass_index=0,b("material",
d,"pass_index"));h=d.texture_slots;for(l=0;l<h.length;l++)g=h[l],"blend_type"in g||(g.blend_type="MIX",b("texture_slot",g,"blend_type"));if(d.node_tree){h=d.node_tree.nodes;for(l=0;l<h.length;l++)n(h[l]);d.node_tree.animation_data&&e(d.node_tree.animation_data)}}g=a.node_groups;for(f=0;f<g.length;f++)for(h=g[f].node_tree.nodes,l=0;l<h.length;l++)n(h[l]);h=a.objects;for(f=0;f<h.length;f++){g=h[f];switch(g.type){case "MESH":"b4w_dynamic_geometry"in g||(g.b4w_dynamic_geometry=!1);"b4w_reflexible"in g||
(g.b4w_reflexible=!1);"b4w_reflexible_only"in g||(g.b4w_reflexible_only=!1);"b4w_reflective"in g||(g.b4w_reflective=!1);"b4w_reflection_type"in g||(g.b4w_reflection_type="PLANE",b("object",g,"b4w_reflection_type"));"b4w_wind_bending"in g||(g.b4w_wind_bending=!1,b("object",g,"b4w_wind_bending"));"b4w_wind_bending_angle"in g||(g.b4w_wind_bending_angle=10,g.b4w_wind_bending_freq=.25,b("object",g,"wind bending params"));"b4w_detail_bending_amp"in g||(g.b4w_detail_bending_amp=.1,g.b4w_branch_bending_amp=
.3,b("object",g,"detail bending params"));"b4w_detail_bending_freq"in g||(g.b4w_detail_bending_freq=1,b("object",g,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in g||(g.b4w_main_bend_stiffness_col="",b("object",g,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in g||(g.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",g,"b4w_detail_bend_colors"));"b4w_caustics"in g||(g.b4w_caustics=!1);"vertex_groups"in g&&g.vertex_groups.length&&
g.data&&0==g.data.vertex_groups.length&&(g.data.vertex_groups=g.vertex_groups,delete g.vertex_groups,b("object",g,"vertex_groups"));"b4w_vertex_anim"in g&&g.b4w_vertex_anim.length&&g.data&&0==g.data.b4w_vertex_anim.length&&(g.data.b4w_vertex_anim=g.b4w_vertex_anim,delete g.b4w_vertex_anim,b("object",g,"b4w_vertex_anim"));"b4w_do_not_render"in g||(g.b4w_do_not_render=!1);"b4w_hidden_on_load"in g||(g.b4w_hidden_on_load=!1);"use_ghost"in g.game||(g.game.use_ghost=!1);"use_sleep"in g.game||(g.game.use_sleep=
!1);"velocity_min"in g.game||(g.game.velocity_min=0);"velocity_max"in g.game||(g.game.velocity_max=0);"collision_group"in g.game||(g.game.collision_group=1);"collision_mask"in g.game||(g.game.collision_mask=255);l=g;c=l.game;d=c.collision_bounds_type;c.use_collision_bounds&&"BOX"!=d&&"CYLINDER"!=d&&"CONE"!=d&&"SPHERE"!=d&&"CAPSULE"!=d&&"EMPTY"!=d&&(k.error("Wrong collision bounds type "+d+". Disable physics for object "+l.name),l.b4w_collision=!1,l.b4w_floating=!1,l.b4w_vehicle=!1,l.b4w_character=
!1);"b4w_vehicle_settings"in g?g.b4w_vehicle_settings&&("steering_ratio"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_ratio=10),"steering_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.steering_max=1),"inverse_control"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.inverse_control=!1),"force_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.force_max=1500),"brake_max"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.brake_max=100),"speed_ratio"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"floating_factor"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in g.b4w_vehicle_settings||
(g.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in g.b4w_vehicle_settings||(g.b4w_vehicle_settings.water_rot_damp=.9)):(g.b4w_vehicle_settings=null,b("object",g,"b4w_vehicle_settings"));"b4w_floating_settings"in g?g.b4w_floating_settings&&("floating_factor"in g.b4w_floating_settings||(g.b4w_floating_settings.floating_factor=3),"water_lin_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in g.b4w_floating_settings||(g.b4w_floating_settings.water_rot_damp=
.8)):(g.b4w_floating_settings=null,b("object",g,"b4w_floating_settings"));"b4w_character_settings"in g?g.b4w_character_settings&&("walk_speed"in g.b4w_character_settings||(g.b4w_character_settings.walk_speed=4),"run_speed"in g.b4w_character_settings||(g.b4w_character_settings.run_speed=8),"step_height"in g.b4w_character_settings||(g.b4w_character_settings.step_height=.25),"jump_strength"in g.b4w_character_settings||(g.b4w_character_settings.jump_strength=5),"waterline"in g.b4w_character_settings||
(g.b4w_character_settings.waterline=0)):(g.b4w_character_settings=null,b("object",g,"b4w_character_settings"));"b4w_selectable"in g||(g.b4w_selectable=!1,b("object",g,"b4w_selectable"));"b4w_outlining"in g||(g.b4w_outlining=!1,b("object",g,"b4w_outlining"));"b4w_outline_on_select"in g||(g.b4w_outline_on_select=!1,b("object",g,"b4w_outline_on_select"));"b4w_billboard"in g||(g.b4w_billboard=!1,b("object",g,"b4w_billboard"));"b4w_billboard_geometry"in g||(g.b4w_billboard_geometry="SPHERICAL",b("object",
g,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in g||(g.b4w_pres_glob_orientation=!1,b("object",g,"b4w_pres_glob_orientation"));"b4w_outline_settings"in g||("b4w_glow_settings"in g?g.b4w_outline_settings=g.b4w_glow_settings:(g.b4w_outline_settings={},g.b4w_outline_settings.outline_duration=1,g.b4w_outline_settings.outline_period=1,g.b4w_outline_settings.outline_relapses=0),b("object",g,"b4w_outline_settings"));"b4w_lod_transition"in g||(g.b4w_lod_transition=.01,b("object",g,"b4w_lod_transition"));
"lod_levels"in g||(g.lod_levels=[],b("object",g,"lod_levels"));"b4w_animation_mixing"in g||(g.b4w_animation_mixing=!1,b("object",g,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in g||(g.b4w_anchor=null,b("object",g,"b4w_anchor")),!g.b4w_anchor||"max_width"in g.b4w_anchor||(g.b4w_anchor.max_width=250)}"collision_margin"in g.game||(g.game.collision_margin=.04,b("object",g,"collision_margin"));"b4w_anim_behavior"in g||(g.b4w_anim_behavior=g.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
g,"b4w_anim_behavior"));if(!("rotation_quaternion"in g)){l=[0,0,0,1];v.Wj(g.rotation_euler,l);var c=l,d=l[0],m=l[1],t=l[2];c[0]=l[3];c[1]=d;c[2]=m;c[3]=t;g.rotation_quaternion=l;b("object",g,"rotation_quaternion")}"webgl_do_not_batch"in g&&(g.b4w_do_not_batch=g.webgl_do_not_batch)&&y("object",g,"webgl_do_not_batch");"b4w_shadow_cast_only"in g||(g.b4w_shadow_cast_only=!1,b("object",g,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in g||(g.b4w_correct_bounding_offset="AUTO",b("object",g,"b4w_correct_bounding_offset"));
c=g.particle_systems;for(l=0;l<c.length;l++)d=c[l],m=d.settings,"use_rotation_dupli"in m||(m.use_rotation_dupli=!1,b("particle_settings",m,"use_rotation_dupli")),"use_whole_group"in m||(m.use_whole_group=!1,b("particle_settings",m,"use_whole_group")),d.transforms||(d.transforms=new Float32Array,b("particle_system",d,"transforms")),"b4w_billboard_align"in m||(m.b4w_billboard_align="VIEW",b("particle_settings",m,"b4w_billboard_align")),"b4w_dynamic_grass"in m||(m.b4w_dynamic_grass=!1,b("object",m,"b4w_dynamic_grass")),
"b4w_dynamic_grass_scale_threshold"in m||(m.b4w_dynamic_grass_scale_threshold=.01,b("object",m,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in m||(m.b4w_initial_rand_rotation=!1,b("particle_settings",m,"b4w_initial_rand_rotation")),"b4w_rotation_type"in m||(m.b4w_rotation_type="Z",b("particle_settings",m,"b4w_rotation_type")),"b4w_rand_rotation_strength"in m||(m.b4w_rand_rotation_strength=1,b("particle_settings",m,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in m||(m.b4w_hair_billboard=
!1,b("particle_settings",m,"b4w_hair_billboard")),"b4w_hair_billboard_type"in m||(m.b4w_hair_billboard_type="BASIC",b("particle_settings",m,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in m||(m.b4w_hair_billboard_jitter_amp=0,b("particle_settings",m,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in m||(m.b4w_hair_billboard_jitter_freq=0,b("particle_settings",m,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in m||(m.b4w_hair_billboard_geometry="SPHERICAL",
b("particle_settings",m,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in m||(m.b4w_wind_bend_inheritance="PARENT",b("particle_settings",m,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in m||(m.b4w_shadow_inheritance="PARENT",b("particle_settings",m,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in m||(m.b4w_reflection_inheritance="PARENT",b("particle_settings",m,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in m||(m.b4w_vcol_from_name="",b("particle_settings",m,"b4w_vcol_from_name")),
"b4w_vcol_to_name"in m||(m.b4w_vcol_to_name="",b("particle_settings",m,"b4w_vcol_to_name")),"b4w_coordinate_system"in m||(m.b4w_coordinate_system="LOCAL",b("particle_settings",m,"b4w_coordinate_system")),"b4w_allow_nla"in m||(m.b4w_allow_nla=!0,b("particle_settings",m,"b4w_allow_nla")),"b4w_enable_soft_particles"in m||(m.b4w_enable_soft_particles=!1,b("particle_settings",m,"b4w_enable_soft_particles")),"b4w_particles_softness"in m||(m.b4w_particles_softness=1,b("particle_settings",m,"b4w_particles_softness")),
"billboard_tilt"in m||(m.billboard_tilt=0,b("particle_settings",m,"billboard_tilt")),"billboard_tilt_random"in m||(m.billboard_tilt_random=0,b("particle_settings",m,"billboard_tilt_random")),"use_rotations"in m||(m.use_rotations=!1,b("particle_settings",m,"use_rotations"));"constraints"in g||(g.constraints=[],b("object",g,"constraints"));c=g.modifiers;for(l=0;l<c.length;l++){a:{d=c[l];switch(d.type){case "ARRAY":if(!("fit_type"in d)){k.error("WARNING Incomplete modifier "+String(d.type)+' for "'+
g.name+'", reexport "'+a.b4w_filepath_blend+'" scene');d=!1;break a}}d=!0}d||(c.splice(l,1),l--)}"animation_data"in g||(g.animation_data={action:null,nla_tracks:[]},b("object",g,"animation_data"));g.animation_data&&("action"in g.animation_data||(g.animation_data.action=null,r("no action in animation data "+g.name)),"nla_tracks"in g.animation_data||(g.animation_data.nla_tracks=[],r("no NLA in animation data "+g.name)),e(g.animation_data));"b4w_collision_id"in g||(g.b4w_collision_id="",b("object",g,
"b4w_collision_id"));"b4w_viewport_alignment"in g||(g.b4w_viewport_alignment=null,b("object",g,"b4w_viewport_alignment"));"pinverse_tsr"in g||(g.pinverse_tsr=null,b("object",g,"pinverse_tsr"));"b4w_cluster_data"in g||(g.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",g,"b4w_cluster_data"));"pass_index"in g||(g.pass_index=0,b("object",g,"pass_index"));(0>g.scale[0]||0>g.scale[1]||0>g.scale[2])&&r('negative scale for object "'+g.name+'", can lead to some errors');l=
g.scale;0==l[0]&&0==l[1]&&0==l[2]?l=!0:(c=Math.abs((l[1]-l[2])/l[1]),l=.005>Math.abs((l[0]-l[1])/l[0])&&.005>c);l||r("non-uniform scale for object "+g.name)}for(var w in D)f=D[w],l=w.match(/.*?(?=>>|$)/i)[0],k.warn('Property "'+String(l)+'" is '+f.eL+' for "'+f.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.ER=function(a,b){"num_channels"in a||(a.num_channels=1,r('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.IQ=function(a){var b;a:{b=
a.modifiers;for(var d=0;d<b.length;d++){var e=b[d].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;b=A(a.data,a.data.name+"_MOD");a=a.modifiers;for(d=0;d<a.length;d++){var k=a[d];switch(k.type){case "ARRAY":for(var e=b,l=k,g=0,n=0,r=0,y=new Float32Array(16),k=[],D=1;D<l.count;D++){l.use_constant_offset&&(g+=l.constant_offset_displace[0],n+=l.constant_offset_displace[1],r+=l.constant_offset_displace[2]);if(l.use_relative_offset)var F=e.b4w_bounding_box,g=g+(F.max_x-F.min_x)*l.relative_offset_displace[0],
n=n+(F.max_y-F.min_y)*l.relative_offset_displace[1],r=r+(F.max_z-F.min_z)*l.relative_offset_displace[2];v.JZ(g,n,r,y);for(var J=F=A(e),R=y,K=C.fromMat4(R,Q),K=f.fromMat3(K,L),u=0;u<J.submeshes.length;u++){var O=J.submeshes[u];v.xo(O.position,R,O.position,0);v.WK(O.tbn_quat,K,O.tbn_quat,0)}k.push(F)}for(D=0;D<k.length;D++)for(l=e,g=k[D],n=0;n<l.submeshes.length;n++){r=l.submeshes[n];y=g.submeshes[n];F=r.base_length;J=r.indices.length;r.base_length+=y.base_length;for(var ca in r)if("base_length"!=ca&&
"boundings"!=ca)if("indices"==ca)for(r[ca]=v.SZ(r[ca],y[ca]),R=J;R<r.indices.length;R++)r.indices[R]+=F;else"vertex_colors"!=ca&&(r[ca]=v.oU(r[ca],y[ca]))}break;case "CURVE":for(e=b,D=w.MS(k.object),l=new Float32Array(16),n=D.ek?4:3,g=new Float32Array(n),n=new Float32Array(n),r=new Float32Array(3),y=new Float32Array(4),F=new Float32Array(4),J=new Float32Array(3),R=new Float32Array(3),K=new Float32Array(3),new Float32Array(4),new Float32Array(4),u=0;u<e.submeshes.length;u++){var E=e.submeshes[u],O=
E.position,E=E.tbn_quat,aa;a:{aa=k.deform_axis;switch(aa){case "POS_X":case "NEG_X":aa=0;break a;case "POS_Y":case "NEG_Y":aa=1;break a;case "POS_Z":case "NEG_Z":aa=2;break a;default:v.q("Wrong deform axis value "+aa)}aa=void 0}J[0]=0;J[1]=0;J[2]=0;J[aa]=1;for(var ia=w.mZ(D),q=0;q<O.length/3;q++){K[0]=O[3*q];K[1]=O[3*q+1];K[2]=O[3*q+2];var T=K[aa],ba=w.lZ(D,T);w.nZ(D,ba,g);r[0]=g[0];r[1]=g[1];r[2]=g[2];w.kZ(D,ba,n);R[0]=n[0];R[1]=0;R[2]=n[2];c.normalize(R,R);f.rotationTo(J,R,y);0>T?(g[0]=R[0],g[1]=
R[1],g[2]=R[2],c.scale(g,T,g),c.add(r,g,r)):T>ia&&(g[0]=R[0],g[1]=R[1],g[2]=R[2],c.scale(g,T-ia,g),c.add(r,g,r));m.fromRotationTranslation(y,r,l);D.ek&&(f.setAxisAngle(J,g[3],F),c.transformQuat(K,F,K));K[aa]=0;c.transformMat4(K,l,K);O[3*q]=K[0];O[3*q+1]=K[1];O[3*q+2]=K[2];E.length&&(L[0]=E[4*q],L[1]=E[4*q+1],L[2]=E[4*q+2],L[3]=E[4*q+3],f.multiply(L,y,L),E[4*q]=L[0],E[4*q+1]=L[1],E[4*q+2]=L[2],E[4*q+3]=L[3])}}}h.EX(b)}return b};a.BS=function(){return{name:"DEFAULT",uuid:v.YA(),use_nodes:!1,diffuse_shader:"LAMBERT",
diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,
.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,
1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.PQ=function(a,b){function c(b,d){for(var f in b){var e=b[f],g=e[0];if(1<e.length)for(var h=1;h<e.length;h++)g+="*"+e[h];for(h=0;h<a.length;h++)if(e=a[h],e.name==g)for(var k in d)e[k]=d[k]}}for(var f=b.b4w_logic_nodes,e=0;e<f.length;e++)for(var h=f[e],g=0;g<h.length;g++){var k=h[g],l={register1:"variable1",register2:"variable2",registerd:"variabled"},m;for(m in l)m in
k&&(k[l[m]]=k[m]);for(var n in k.variables)"boolean"!=typeof k.variables[n][0]&&(k.variables[n]=[!1,k.variables[n]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(k.type)&&("variable1"in k&&(k.variables.v1=[!1,k.variable1]),"variable2"in k&&(k.variables.v2=[!1,k.variable2]),"variabled"in k&&(k.variables.vd=[!1,k.variabled]));switch(k.type){case "SELECT":for(var w=0;w<a.length;w++)l=a[w],l.name==k.object&&(l.b4w_selectable=!0);k.bools||(k.bools={});k.bools.not_wait||(k.bools.not_wait=!1);r('Logic nodes type "SELECT" is deprecated');
break;case "SWITCH_SELECT":c(k.objects_paths,{b4w_selectable:!0});if(k.links instanceof Array){r('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var l={},v=0;for(w in k.objects_paths)l[w]=k.links[v],v++;k.links=l}break;case "SELECT_PLAY":r('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');k.mute=!0;break;case "SELECT_PLAY_ANIM":r('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');
break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(k.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(k.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(k.objects_paths,{b4w_do_not_batch:!0});switch(k.common_usage_names.space_type){case "WORLD":k.common_usage_names.space_type=O.TO;break;case "PARENT":k.common_usage_names.space_type=O.SO;break;case "LOCAL":k.common_usage_names.space_type=O.RO}break;case "OUTLINE":c(k.objects_paths,
{b4w_outlining:!0});break;case "CONDJUMP":k.condition&&(k.common_usage_names.condition=k.condition);if("cnd"in k.floats)k.common_usage_names.condition=k.floats.cnd;else switch(k.common_usage_names.condition){case "GEQUAL":k.common_usage_names.condition=O.PE;break;case "LEQUAL":k.common_usage_names.condition=O.RE;break;case "GREATER":k.common_usage_names.condition=O.QE;break;case "LESS":k.common_usage_names.condition=O.SE;break;case "NOTEQUAL":k.common_usage_names.condition=O.TE;break;case "EQUAL":k.common_usage_names.condition=
O.OE}void 0!=k.number1&&(k.input1=k.number1);void 0!=k.number2&&(k.input2=k.number2);k.bools||(k.bools={});void 0===k.bools.str&&(k.bools.str=!1,k.floats.inp1=k.input1,k.floats.inp2=k.input2);break;case "SEND_REQ":k.bools||(k.bools={});k.strings||(k.strings={});void 0===k.bools.ct&&(k.bools.ct=!1);void 0!=k.url&&(k.bools.url=!1,k.strings.url=k.url);break;case "MATH":void 0!=k.number1&&(k.input1=k.number1);void 0!=k.number2&&(k.input2=k.number2);void 0!=k.input1&&(k.floats.inp1=k.input1);void 0!=k.input2&&
(k.floats.inp2=k.input2);break;case "REGSTORE":k.floats||(k.floats={});k.strings||(k.strings={});void 0!=k.number1&&(k.input1=k.number1);if(void 0!=k.input1)switch(typeof k.input1){case "number":k.floats.inp1=k.input1;k.common_usage_names.variable_type="NUMBER";break;default:k.strings.inp1=k.input1,k.common_usage_names.variable_type="STRING"}switch(k.common_usage_names.variable_type){case "NUMBER":k.common_usage_names.variable_type=O.UO;break;case "STRING":k.common_usage_names.variable_type=O.VO}break;
case "PAGEPARAM":k.bools||(k.bools={});void 0===k.bools.hsh&&(k.bools.hsh=!1);k.floats||(k.floats={});void 0===k.floats.ptp&&(k.floats.ptp=0);break;case "PLAY_ANIM":c(k.objects_paths,{b4w_do_not_batch:!0});k.bools||(k.bools={});void 0===k.bools.env&&(k.bools.env=!1);(l=k.common_usage_names.param_anim_behavior)||(l="FINISH_STOP");k.common_usage_names.param_anim_behavior=J.rz(l);break;case "STOP_ANIM":k.bools||(k.bools={});void 0===k.bools.env&&(k.bools.env=!1);break;case "STRING":switch(k.common_usage_names.string_operation){case "JOIN":k.common_usage_names.string_operation=
O.OO;break;case "FIND":k.common_usage_names.string_operation=O.NO;break;case "REPLACE":k.common_usage_names.string_operation=O.PO;break;case "SPLIT":k.common_usage_names.string_operation=O.QO;break;case "COMPARE":k.common_usage_names.string_operation=O.MO}if("cnd"in k.floats)k.common_usage_names.condition=k.floats.cnd;else switch(k.common_usage_names.condition){case "GEQUAL":k.common_usage_names.condition=O.PE;break;case "LEQUAL":k.common_usage_names.condition=O.RE;break;case "GREATER":k.common_usage_names.condition=
O.QE;break;case "LESS":k.common_usage_names.condition=O.SE;break;case "NOTEQUAL":k.common_usage_names.condition=O.TE;break;case "EQUAL":k.common_usage_names.condition=O.OE}break;case "REDIRECT":void 0!=k.url&&(k.bools.url=!1,k.strings.url=k.url);break;case "SET_CAMERA_MOVE_STYLE":switch(k.common_usage_names.camera_move_style){case "STATIC":k.common_usage_names.camera_move_style=O.FO;break;case "TARGET":k.common_usage_names.camera_move_style=O.GO;break;case "EYE":k.common_usage_names.camera_move_style=
O.DO;break;case "HOVER":k.common_usage_names.camera_move_style=O.EO}break;case "ENTRYPOINT":k.bools||(k.bools={});void 0===k.bools.js&&(k.bools.js=!1);k.bools.js&&(k.mute=!0);break;case "JS_CALLBACK":for(m in k=k.common_usage_names.js_cb_params,k)switch(k[m]){case "OBJECT":k[m]=O.HO;break;case "VARIABLE":k[m]=O.IO}}}}};b4w.module.fps=function(a,l){function n(a,b,c){var d=Q.Qh();J.Tl(d,b,c);a&&(b=J.fm(d,ca),D.Hk(a,b[0],b[1]))}function e(a,b,c,d){if(.01<Math.abs(G[0])||.01<Math.abs(G[1]))c=K.Zd(a,b,0),b=L.mc(G[0],0,c,.2*F),c=L.mc(G[1],0,c,.2*F),G[0]-=b,G[1]-=c,d(a,-b*U,-c*U)}function b(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function y(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function r(a,b){if(y(a)&&!H.Zf()){var c=K.oA(a),f=u?u:K.pA(a);u=f;K.Y(b,"FPS_PLOCK",K.Qa,[c,f],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=K.$e(a,b,0),n(a,-b.coords[0]*U,-b.coords[1]*U))});K.Y(null,"FPS_ACTIVATE_PLOCK",K.nn,[f],function(a){return a[0]},function(b,c,d){0<d?ga.MA&&ga.MA(a):ga.HA&&ga.HA(a)})}else{if(H.Zf())var c=
K.Oq("XY",a),f=K.xu(a),h=4;else{var c=K.Il("XY",a),f=K.Fn(a),h=2,g=Q.Qh(),k=K.Rj(),l=K.Ii(d.Cp),p=K.Ii(d.Dp);K.Y(b,"FPS_CAM_ROT",K.Qa,[k,l,p],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=K.Zd(a,b,0);c=K.Zd(a,b,1);var f=K.Zd(a,b,2);b=2.5*d;f=.05>Math.abs(f)?0:f;d=J.em(g,ca);f=d[1]-f*b;c=-(.05>Math.abs(c)?0:c)*b;f=L.U(f,t,da);J.Tl(g,c,f,!1,!0);D.Hk(a,d[0]+c+Math.PI,0)}})}var m=0,r=0;K.Y(null,"FPS_DRAG_PRESS",K.vf,[f],function(a){return a[0]},function(a,b,c){1==
c&&(a=K.$e(a,b,0).coords,m=a[0],r=a[1])});K.Y(null,"FPS_DRAG_MOVE",K.Qa,[c,f],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=K.$e(a,b,0).coords,G[0]+=(a[0]-m)*h,G[1]+=(a[1]-r)*h,m=a[0],r=a[1])});c=K.Rj();K.Y(b,"FPS_SMOOTH_DRAG",K.Qa,[c],null,e,n)}}function A(a){g.PT(g.UN);a.addEventListener("mousedown",function(){d.SX()},!1)}function h(a){var b=K.Rj(),c=Q.Qh();K.Y(a,"FPS_CHARECTER_VR_ROT",K.Qa,[b],null,function(a){var b=J.fm(c,ca)[0];D.Hk(a,b,0)})}function w(){var a=g.KR()&&!H.Zf(),b=d.ga(d.xd);
b&&(a=a&&d.jm(b,d.hl)==d.Fp);return a}function m(a,f,e){function h(a){a=0<a?1:a;m=-(0>a?-1:a);a=n+r;var b=p+m;D.Qm(f,a,b);e&&e(a,b);k(a,b)}function g(a){a=0<a?1:a;r=-(0>a?-1:a);a=n+r;var b=p+m;D.Qm(f,a,b);e&&e(a,b);k(a,b)}function k(a,b){var d=l.Gn.id;a||b?0==d&&c(l,1):c(l,0)}H.Zf()&&b(a.parentElement?a.parentElement:a);var l=C(f),p=0,m=0,n=0,r=0;a=[K.$y,d.st];var t=[K.Zy,d.tt];H.Zf()&&(a.push("B4W_DEFAULT_BTN_1"),t.push("B4W_DEFAULT_BTN_2"));O(1,a,function(a){n=a;a=n+r;var b=p+m;D.Qm(f,a,b);e&&e(a,
b);k(a,b)});O(1,t,g);O(1,[K.Yy,d.vt],h);O(1,[K.Xy,d.ut],function(a){p=a;a=n+r;var b=p+m;D.Qm(f,a,b);e&&e(a,b);k(a,b)});O(1,[K.AO,d.rt],function(a){0<a&&D.Pz(f)});O(3,[d.Ap],h);O(3,[d.Bp],g);O(1,[K.zO,d.Ep],function(a){n+r+p+m?0<a?c(l,2):c(l,1):c(l,0)});O(1,[K.IE],function(a){0<a&&(a=Z.Gn.id,1==a||0==a?c(l,3):c(l,1))})}function k(a,b,c,d){a.M.push({id:b,pz:c,uG:d,tG:null,Mz:null})}function f(a){for(var b=[],c=0;c<a.M;c++){var d=a.M[c].id;if(0<=b.indexOf(d))return;b.push(d)}for(c=0;c<a.M;c++)for(var d=
a.M[c],f=0;f<d.pz.length;f++)if(0>b.indexOf(d.pz[f]))return}function v(a,b){for(var c=null,d=0;d<a.M.length;d++)if(a.M[d].id==b){c=a.M[d];break}return c}function c(a,b){if(!a.yW){var c=a.Gn,d=c.id;if(0<=c.pz.indexOf(b)){var f=!0;c.tG&&(f=c.tG(d,b));f&&(a.Gn=v(a,b),c.uG&&c.uG(d,b),c.Mz&&c.Mz(d,b))}}}function C(a){function b(c,d){switch(d){case 0:case 1:D.Gk(a,D.AE);break;case 2:D.Gk(a,D.QN);break;case 3:D.Gk(a,D.Zx);break;case 4:D.Gk(a,D.PN)}}var c=Z={M:[],Gn:null,yW:!1};k(c,0,[1,3,4],b);k(c,1,[2,
3,4,0],b);k(c,2,[1,3,4,0],b);k(c,3,[1],b);k(c,4,[1,2,0],b);f(c);c.Gn=v(c,0);return Z}function O(a,b,c){function f(){}function e(){return!1}for(var h=[],g=d.DG(),k=0;k<b.length;k++)if("number"==typeof b[k])if(300>b[k])h.push(K.Ic(b[k]));else if(326>b[k])for(var l=0;l<g.length;l++)h.push(K.Lq(b[k],g[l]));else h.push(K.Ii(b[k]));else"string"==typeof b[k]&&((l=document.getElementById(b[k]))?h.push(K.xu(l)):P.error("Couldn't find element with "+b[k]+" ID."));b=K.vf;switch(a){case 1:b=K.nn;e=function(a){for(var b=
0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0<d?c(1):c(0)};break;case 2:b=K.nn;e=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0>d?c(1):c(0)};break;case 3:b=K.Qa,e=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},f=function(a,b,d,f){if(0<d)for(d=0;d<f;d++){var e=K.Zd(a,b,d);if(.05<Math.abs(e)){c(e);break}}else c(0)}}K.Y(null,"FPS_USER_CONTROL_ACTION_"+R.toString(),b,h,e,f,h.length);R++}var J=l("camera"),K=l("controls"),
D=l("physics"),Q=l("scenes"),L=l("util"),H=l("main"),z=l("container"),d=l("input"),p=l("transform"),M=l("constraints"),x=l("vec3"),g=l("hmd"),P=l("__print"),t=(-Math.PI+.1)/2,da=(Math.PI-.1)/2,G=new Float32Array(2),F=1,U=4E-4,R=0,Z=null,u=null,ga={MA:null,HA:null},ca=new Float32Array(2),E=new Float32Array(3),aa=new Float32Array(3);new Float32Array(3);a.z0=0;a.A0=1;a.y0=2;a.x0=3;a.w0=4;a.d0=1;a.e0=2;a.c0=3;a.D2=O;a.OT=function(a,b){var c=null;a=a||Q.hm();c=c||z.gm();if(a){b=b||null;var d=a,f=Q.Qh(),
e=p.ie(f,E),g=p.ie(d,aa);x.subtract(e,g,e);M.LF(f,d,e);f=J.fm(f,ca);D.Hk(d,f[0],f[1]);d=c;f=a;w()?(A(d),h(f)):r(d,f);m(c,a,b)}};a.D3=function(a,b){a=a||Q.hm();b=b||z.Ce();if(a){for(var c=0;c<R;c++)K.hf(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;y(b)&&!H.Zf()&&(K.hf(c,"FPS_PLOCK"),K.hf(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!y(b)||H.Zf())K.hf(c,"FPS_CAM_ROT"),K.hf(c,"FPS_DRAG_PRESS"),K.hf(c,"FPS_DRAG_MOVE"),K.hf(c,"FPS_SMOOTH_DRAG");c=a;w()&&K.hf(c,"FPS_CHARECTER_VR_ROT");c=b;if(H.Zf()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),
f=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);f&&c.removeChild(f)}}};a.d8=function(a,b){v(Z,a).Mz=b};a.a8=function(a){K.mD(a);F=a};a.Z7=function(a){U=a/2E5};a.F8=function(a){ga.MA=a};a.E8=function(a){ga.HA=a};a.A4=function(){return Z.Gn.id}};b4w.module.camera=function(a,l){function n(a,b){m.Sb("camera.set_pivot","camera.target_set_trans_pivot");e.Aa(a)?(C.copy(b,a.k.pivot),f.D(a),w.H(a)):m.error("set_pivot(): Wrong object or camera move style")}var e=l("__camera");l("__config");var b=l("__constraints"),y=l("__container"),r=l("__mat4"),A=l("__math"),h=l("__obj_util"),w=l("__physics"),m=l("__print"),k=l("__scenes"),f=l("__transform"),v=l("__tsr"),c=l("__util"),C=l("__vec3"),O=l("__vec4"),J=l("__quat"),K=new Float32Array(2),D=new Float32Array(3),
Q=new Float32Array(3);new Float32Array(4);var L=J.create();new Float32Array(9);var H={},z={};a.Bg=e.Bg;a.Kb=e.Kb;a.nd=e.nd;a.bd=e.bd;a.qZ=function(a){h.xa(a)?(e.gt(a),a.k.vb=e.Bg,f.D(a),w.H(a),e.ao(a)):m.error("static_setup(): Wrong camera object")};a.m9=function(a,b,c){e.um(a)?(b=b||v.G(a.k.n),c?e.jD(a,b,c):f.Wc(a,b),f.D(a),w.H(a)):m.error("static_set_look_at(): Wrong camera object or camera move style")};a.n9=function(a,b){e.um(a)?(f.gi(a,b),f.D(a),w.H(a)):m.error("static_set_rotation(): Wrong camera object or camera move style")};
a.l9=function(a,b){if(!e.um(a))return m.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return f.Sh(a,b)};a.fU=function(a){h.xa(a)?(e.gt(a),a.k.vb=e.nd,f.D(a),w.H(a),e.ao(a)):m.error("eye_setup(): Wrong camera object")};a.b4=function(a,c,h){e.ic(a)?(c=c||v.G(a.k.n),h?e.zY(a,c,h):f.Wc(a,c),b.Qj(a,a.k.pf,!0),f.D(a),w.H(a)):m.error("eye_set_look_at(): Wrong camera object or camera move style")};a.Tl=function(a,b,c,h,g){e.ic(a)?(e.us(a,b,c,h||!1,
g||!1),f.D(a),w.H(a)):m.error("eye_rotate(): Wrong camera object or camera move style")};a.eU=function(a,b){e.ic(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(e.TL(a,b),f.D(a),w.H(a)):m.error("eye_set_vertical_limits(): Incorrect limits object."):m.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.a4=function(a,b,c){if(!e.ic(a))return m.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.la?(b=b||{},c?(b.down=a.la.Mn,
b.up=a.la.gp):(b.down=a.la.down,b.up=a.la.up),b.camera_space=c||!1,b):null};a.dU=function(a,b){e.ic(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(e.HL(a,b),f.D(a),w.H(a)):m.error("eye_set_horizontal_limits(): Incorrect limits object."):m.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.Z3=function(a,b,c){if(!e.ic(a))return m.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.mb?(b=b||{},c?(b.left=a.mb.jo,
b.right=a.mb.Do):(b.left=a.mb.left,b.right=a.mb.right),b.camera_space=c||!1,b):null};a.EZ=function(a){if(h.xa(a))if(!(void 0).horiz_rot_lim||"number"==typeof(void 0).horiz_rot_lim.left&&"number"==typeof(void 0).horiz_rot_lim.right)if(!(void 0).vert_rot_lim||"number"==typeof(void 0).vert_rot_lim.down&&"number"==typeof(void 0).vert_rot_lim.up){if((void 0).dist_lim){if("number"!=typeof(void 0).dist_lim.min||"number"!=typeof(void 0).dist_lim.max||(void 0).dist_lim.min>(void 0).dist_lim.max){m.error("target_setup(): Wrong distance limits object");
return}(void 0).dist_lim.min=Math.max((void 0).dist_lim.min,0);(void 0).dist_lim.max=Math.max((void 0).dist_lim.max,0)}(void 0).gs&&("number"!=typeof(void 0).gs.min_y||"number"!=typeof(void 0).gs.max_y||(void 0).gs.min_y>(void 0).gs.max_y)?m.error("target_setup(): Wrong pivot limits object"):(e.gt(a),a.k.vb=e.Kb,e.YL(a,(void 0).pos||v.G(a.k.n),(void 0).pivot,(void 0).horiz_rot_lim,(void 0).vert_rot_lim,(void 0).dist_lim,(void 0).gs,(void 0).use_panning||!1),f.D(a),w.H(a),e.ao(a))}else m.error("target_setup(): Wrong vertical limits object");
else m.error("target_setup(): Wrong horizontal limits object");else m.error("target_setup(): Wrong camera object")};a.Os=function(a,b,c){var h,g;e.Aa(a)?(e.Kw(a,b,c,h||!1,g||!1),f.D(a),w.H(a)):m.error("target_rotate(): Wrong camera object or camera move style")};a.w9=function(a,b,c){e.Aa(a)?(b=b||v.G(a.k.n),c=c||a.k.pivot,e.Cs(a,b,c),f.D(a),w.H(a)):m.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.v9=function(a,b){e.Aa(a)?(e.HY(a,b),f.D(a),w.H(a)):m.error("target_set_pivot_translation(): Wrong camera object or camera move style")};
a.BZ=function(a,b){if(e.Aa(a)){var c=f.ro(a,a.k.pivot),h=Math.max(0,b);f.fh(a,0,0,h-c);f.D(a);w.H(a)}else m.error("target_set_distance(): Wrong camera object or camera move style")};a.ND=function(a){return e.Aa(a)?f.ro(a,a.k.pivot):(m.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.y9=function(a,b){if(e.Aa(a)){var c=f.cv(b,!1,D),l=f.dv(b),g=k.A(),g=h.ka(a,g).da[0],g=e.hI(g)/2,l=l/Math.sin(g),g=f.ro(a,c);e.Cs(a,v.G(a.k.n),c);f.D(a);f.fh(a,0,0,l-g);f.D(a);w.H(a)}else m.error("target_zoom_object(): Wrong camera object or camera move style")};
a.zZ=function(a,b){if(!e.Aa(a))return m.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);C.copy(a.k.pivot,b);return b};a.JM=function(a,b){if(e.Aa(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){m.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}e.nY(a,b);f.D(a);w.H(a)}else m.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.q9=
function(a,b){if(!e.Aa(a))return m.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.tb?(b=b||{},b.min=c.tb.min,b.max=c.tb.max,b):null};a.DZ=function(a,b){e.Aa(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(e.TL(a,b),f.D(a),w.H(a)):m.error("target_set_vertical_limits(): Wrong limits object"):m.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.t9=function(a,b,c){if(!e.Aa(a))return m.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.la?(b=b||{},c?(b.down=a.la.Mn,b.up=a.la.gp):(b.down=a.la.down,b.up=a.la.up),b.camera_space=c||!1,b):null};a.CZ=function(a,b){e.Aa(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(e.HL(a,b),f.D(a),w.H(a)):m.error("target_set_horizontal_limits(): Wrong limits object"):m.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.r9=function(a,b,c){if(!e.Aa(a))return m.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.mb?(b=b||{},c?(b.left=a.mb.jo,b.right=a.mb.Do):(b.left=a.mb.left,b.right=a.mb.right),b.camera_space=c||!1,b):null};a.u9=function(a,b){e.Aa(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?m.error("target_set_pivot_limits(): Wrong limits object"):(e.DY(a,b),f.D(a),w.H(a)):m.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.s9=function(a,b){if(!e.Aa(a))return m.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.ce?(b=b||{},b.min_z=c.ce.min_z,b.max_z=c.ce.max_z,b):null};a.AZ=function(a,b,c){if(e.Aa(a)){var h=a.k;h.use_panning&&(D[0]=b,D[1]=-c,D[2]=0,v.wd(D,h.n,D),C.add(h.pivot,D,h.pivot),b=v.G(h.n),C.add(b,D,b),f.D(a),w.H(a))}else m.error("target_pan_pivot(): wrong object")};a.x9=function(a,b){if(!e.Aa(a))return m.error("target_switch_panning(): Wrong camera object or camera move style"),null;a.k.use_panning=b};a.A6=function(b,h){a.wJ(b,{pos:h.pos,pivot:h.pivot});var k="undefined"==
typeof h.dist_interval?0:Math.max(h.dist_interval,0),l="undefined"==typeof h.angle_interval?0:Math.max(h.angle_interval,0),g="undefined"==typeof h.t?.5:c.U(h.t,0,1),m=a.tJ(b,H);m.min=Math.max(m.min-g*k,0);m.max+=(1-g)*k;k=a.uJ(b,z);k.down=c.U(k.down+g*l,-Math.PI/2,0);k.up=c.U(k.up-(1-g)*l,-Math.PI/2,0);e.yv(b,m);e.zv(b,k);f.D(b);w.H(b);e.ao(b)};a.wJ=function(a,b){if(h.xa(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){m.error("hover_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<b.hover_angle_lim.up)?m.error("hover_setup(): Wrong hover angle limits object"):b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max)?m.error("hover_setup(): Wrong horizontal translation limits object"):
b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max)?m.error("hover_setup(): Wrong vertical translation limits object"):(e.gt(a),a.k.vb=e.bd,e.XL(a,b.pos||v.G(a.k.n),b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1),f.D(a),w.H(a),e.ao(a))}else m.error("hover_setup(): Wrong camera object")};a.vJ=function(a,b,c){var h,g;e.$a(a)?(e.vs(a,b,c,h||!1,g||!1),f.D(a),w.H(a)):
m.error("hover_rotate(): Wrong camera object or camera move style")};a.z6=function(a,b){e.$a(a)?(e.Uw(a,b),f.D(a),w.H(a)):m.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.x6=function(a,b){if(!e.$a(a))return m.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);C.copy(a.k.Vb,b);return b};a.EV=function(a){return e.$a(a)?f.ro(a,a.k.Vb):(m.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.zv=
function(a,b){e.$a(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?m.error("hover_set_vertical_limits(): Wrong limits object"):(e.zv(a,b),f.D(a),w.H(a)):m.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.uJ=function(a,b){if(!e.$a(a))return m.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var c=a.k;b=b||{};b.down=c.la.down;b.up=c.la.up;return b};a.yv=function(a,b){e.$a(a)?"number"!=typeof b.min||"number"!=typeof b.max||
b.min>b.max?m.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),e.yv(a,b),f.D(a),w.H(a)):m.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.tJ=function(a,b){if(!e.$a(a))return m.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var c=a.k;b=b||{};b.min=c.tb.min;b.max=c.tb.max;return b};a.GV=function(a,b){e.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?
m.error("hover_set_vert_trans_limits(): Wrong limits object"):(e.NY(a,b),f.D(a),w.H(a)):m.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.y6=function(a,b){if(!e.$a(a))return m.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.Cc?(b=b||{},b.min=c.Cc.min,b.max=c.Cc.max,b):null};a.FV=function(a,b){e.$a(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?m.error("hover_set_horiz_trans_limits(): Wrong limits object"):
(e.tY(a,b),f.D(a),w.H(a)):m.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.w6=function(a,b){if(!e.$a(a))return m.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var c=a.k;return c.Bc?(b=b||{},b.min=c.Bc.min,b.max=c.Bc.max,b):null};a.B6=function(a,b){if(!e.$a(a))return m.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Nh=b};a.um=e.um;a.Aa=e.Aa;a.ic=e.ic;a.$a=e.$a;a.kD=function(a,b){if(!h.xa(a))return m.error("set_move_style(): Wrong camera object"),
!1;if(b!=e.Bg&&b!=e.nd&&b!=e.Kb&&b!=e.bd)return m.error("set_move_style(): Wrong move style"),!1;e.kD(a,b);f.D(a);w.H(a);return!0};a.im=function(a){return h.xa(a)?e.im(a):(m.error("get_move_style(): Wrong camera object"),null)};a.Wc=function(a,b){if(h.xa(a)){var c=a.k;if(e.Aa(a)){var k=v.G(c.n),k=C.subtract(b,k,D);C.add(k,c.pivot,c.pivot)}else e.$a(a)&&(k=v.G(c.n),k=C.subtract(b,k,D),C.add(k,c.Vb,c.Vb));f.Wc(a,b);f.D(a);w.H(a)}else m.error("set_translation(): Wrong camera object")};a.ie=function(a,
b){if(!h.xa(a))return m.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return f.ie(a,b)};a.Q7=function(a,b,c,k,g){h.xa(a)?(k=k||!1,g=g||!1,e.Aa(a)?e.Kw(a,b,c,k,g):e.ic(a)?e.us(a,b,c,k,g):e.$a(a)?e.vs(a,b,c,k,g):e.um(a)?m.warn("rotate_camera(): not supported for STATIC cameras"):m.error("rotate_camera(): Wrong camera move style"),f.D(a),w.H(a)):m.error("rotate_camera(): Wrong camera object")};a.LY=function(a,b){if(h.xa(a)){var f=a.k;"number"==typeof b.trans&&(f.$k=c.U(b.trans,
0,Infinity));"number"==typeof b.rot&&(f.Zk=c.U(b.rot,0,Infinity));"number"==typeof b.zoom&&(f.al=c.U(b.zoom,0,.99))}else m.error("set_velocities(): Wrong camera object")};a.Th=function(a,b){if(!h.xa(a))return m.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.$k;b.rot=c.Zk;b.zoom=c.al;return b};a.M6=function(a){return h.xa(a)?0<=c.lc(v.P(a.k.n),c.Nc,D)[1]:(m.error("is_look_up(): Wrong camera object"),!1)};a.em=function(a,b){if(!h.xa(a))return m.error("get_camera_angles(): Wrong camera object"),
null;b=b||new Float32Array(2);e.em(a,b);return b};a.fm=function(a,b){if(!h.xa(a))return m.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);e.fm(a,b);return b};a.v4=function(a,b){b=b||new Float32Array(2);var f=C.normalize(a,D),f=c.aD(c.Nc,f,L);c.eA(f,!0);e.dB(f,b);return b};a.QL=function(a,b){if(h.xa(a))for(var c=k.A(),c=h.ka(a,c).da,f=0;f<c.length;f++){var g=c[f];g.type!=e.Qc&&g.type!=e.dd&&g.type!=e.Pe&&g.type!=e.Qe||e.GY(g,b,g.mf)}else m.error("set_stereo_distance(): Wrong camera object")};
a.ZI=function(a){if(!h.xa(a))return m.error("get_stereo_distance(): Wrong camera object"),0;var b=k.A();a=h.ka(a,b).da;for(b=0;b<a.length;b++){var c=a[b];if(c.type==e.Qc||c.type==e.dd)return c.Ok}return 0};a.eD=function(a,b){if(h.xa(a)){var c=k.A(),c=h.ka(a,c).da;e.eD(c,b)}else m.error("set_eye_distance(): Wrong camera object")};a.L4=function(a){if(!h.xa(a))return m.error("get_eye_distance(): Wrong camera object"),0;var b=k.A();a=h.ka(a,b).da;for(b=0;b<a.length;b++){var c=a[b];if(c.type==e.Qc||c.type==
e.dd||c.type==e.Pe||c.type==e.Qe)return c.mf}return 0};a.rD=function(a,b){h.xa(a)?(C.copy(b,a.k.pf),f.D(a),w.H(a)):m.error("set_vertical_axis(): Wrong camera object")};a.tV=function(a,b){if(h.xa(a))return b||(b=C.create()),C.copy(a.k.pf,b),b;m.error("get_vertical_axis(): Wrong camera object")};a.E9=function(a,b,c,f){if(h.xa(a)){var g=k.A();a=h.ka(a,g).da;for(g=0;g<a.length;g++){var l=a[g];l.rc||e.Ik(l,l.Ab);var n=D;n[0]=-b;n[1]=-c;n[2]=0;r.translate(l.xb,n,l.xb);r.rotateZ(l.xb,f,l.xb);e.sG(l);e.Kz(l)}}else m.error("translate_view(): Wrong camera object")};
a.Z5=function(a,b){if(!h.xa(a))return m.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);c.lc(v.P(a.k.n),c.Nc,b);return b};a.bV=function(a){if(!h.xa(a))return m.error("get_fov(): Wrong camera object"),0;var b=k.A();a=h.ka(a,b).da;return c.Cb(a[0].Vd)};a.n8=function(a,b){if(h.xa(a))for(var f=k.A(),f=h.ka(a,f).da,l=0;l<f.length;l++){var g=f[l];g.Vd=c.oe(b);g.rc||e.Ik(g,g.Ab);e.sG(g);e.Kz(g)}else m.error("set_fov(): Wrong camera object")};a.iD=function(a,b,c){var f;if(!(f=
h.xa(a)))a:{if(h.xa(a)){f=k.A();f=h.ka(a,f).da;for(var g=0;g<f.length;g++){var l=f[g];if(l.type==e.Pe||l.type==e.Qe){f=!0;break a}}}else m.error("is_hmd_camera(): Wrong camera object");f=!1}f?b&&c&&e.iD(a,b,c):m.error("set_hmd_fov(): Wrong camera object")};a.Qj=function(a,c,e){h.xa(a)?(c=c||a.k.pf,b.Qj(a,c,e||!1),f.D(a),w.H(a)):m.error("correct_up(): Wrong camera object")};a.C8=function(a,b){if(h.xa(a)&&e.Lv(a)){var c=a.k;if(e.Aa(a)){var f=v.G(c.n),f=C.dist(f,c.pivot);c.dk=b/2*c.ck/f}else e.$a(a)?
(f=v.G(c.n),f=C.distance(f,c.Vb),c.dk=b/2*c.ck/f):(c=k.A(),h.ka(a,c).da[0].top=b/2);e.q_(a)}else m.error("set_ortho_scale(): Wrong camera object")};a.s5=function(a){if(!h.xa(a)||!e.Lv(a))return m.error("get_ortho_scale(): Wrong camera object"),0;var b=k.A();return 2*h.ka(a,b).da[0].top};a.Lv=function(a){return h.xa(a)?e.Lv(a):(m.error("is_ortho_camera(): Wrong camera object"),!1)};a.F2=function(a,b,l,n){if(!h.xa(a))return m.error("calc_ray(): Wrong camera object"),null;var g=k.A(),r=h.ka(a,g).da[0];
n&&3==n.length?m.O('dest parameter in the function "calc_ray" should be type of parametric line.'):n=n||new Float32Array(6);switch(r.type){case e.Od:case e.Ch:case e.Qc:case e.dd:var t=Math.tan(r.Vd*Math.PI/360),w=t*r.Ab,g=D;b=y.iu(b,l,K,r);g[0]=(2*b[0]/r.width-1)*w;g[1]=(1-2*b[1]/r.height)*t;g[2]=-1;v.wd(g,a.k.n,g);C.normalize(g,g);3==n.length?C.copy(g,n):(a=f.ie(a,Q),A.LL(n,a),A.lD(n,g));return n;case e.we:return g=D,b=y.iu(b,l,K,r),g[0]=(2*b[0]/r.width-1)*r.top*r.Ab,g[1]=(1-2*b[1]/r.height)*r.top,
g[2]=0,v.Xc(g,a.k.n,g),C.copy(g,n),C.transformQuat(c.Nc,v.P(a.k.n),g),A.lD(n,g),n;default:return m.error("calc_ray(): Non-compatible camera"),n}};a.HC=function(a,b,c){if(!h.xa(a))return m.error("project_point(): Wrong camera object"),null;c=c||new Float32Array(2);return e.HC(a,b,c)};a.g6=function(a){return(e.Aa(a)||e.$a(a))&&null!==a.k.tb};a.q6=function(a){return(e.ic(a)||e.Aa(a)||e.$a(a))&&null!==a.k.la};a.p6=function(a){m.Sb("has_vertical_limits","has_vertical_rot_limits");return e.Aa(a)||e.ic(a)?
null!==a.k.la:(m.error("has_vertical_limits(): Wrong camera object"),!1)};a.j6=function(a){return(e.Aa(a)||e.ic(a))&&null!==a.k.mb};a.i6=function(a){m.Sb("has_horizontal_limits","has_horizontal_rot_limits");return e.Aa(a)||e.ic(a)?null!==a.k.mb:(m.error("has_horizontal_limits(): Wrong camera object"),!1)};a.r6=function(a){return e.$a(a)&&null!==a.k.Cc};a.k6=function(a){return e.$a(a)&&null!==a.k.Bc};a.g7=function(a,b,c){m.Sb("move_pivot","target_pan_pivot");if(e.Aa(a)){var h=a.k;if(h.use_panning){var g=
v.G(h.n),k=C.subtract(g,h.pivot,Q);D[0]=b;D[1]=0;D[2]=c;C.scale(D,C.len(k),D);v.wd(D,h.n,D);C.add(h.pivot,D,h.pivot);C.add(g,D,g);f.D(a);w.H(a)}}else m.error("move_pivot(): wrong object")};a.T8=function(a,b){m.Sb("set_velocity_params","set_velocities");if(h.xa(a)){var f=a.k;f.$k=c.U(b[0],0,Infinity);f.Zk=c.U(b[1],0,Infinity);f.al=c.U(b[2],0,.99)}else m.error("set_velocity_params(): Wrong camera object")};a.W5=function(a,b){m.Sb("get_velocity_params","get_velocities");if(!h.xa(a))return m.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var c=a.k;b[0]=c.$k;b[1]=c.Zk;b[2]=c.al;return b};a.e3=function(a){m.O('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');h.xa(a)?e.Aa(a)||e.ic(a)?a.k.mb=null:e.$a(a)&&(a.k.Bc=null):m.error("clear_horizontal_limits(): Wrong camera object")};a.i3=function(a){m.O('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');
h.xa(a)?e.Aa(a)||e.ic(a)?a.k.la=null:e.$a(a)&&(a.k.Cc=null):m.error("clear_vertical_limits(): Wrong camera object")};a.f3=function(){m.O("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.jD=function(a,c,h,k){m.Oh("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);k=k||a.k.pf;e.jD(a,c,h);b.Qj(a,k,!0);f.D(a);w.H(a)};a.us=function(a,b,c,h,g){m.Oh("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);e.ic(a)?(e.us(a,
b,c,h,g),f.D(a),w.H(a)):m.error("rotate_eye_camera(): wrong object")};a.Kw=function(a,b,c,h,g){m.Oh("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);e.Aa(a)?(e.Kw(a,b,c,h,g),f.D(a),w.H(a)):m.error("rotate_target_camera(): wrong object")};a.Cs=function(a,b,c){m.Sb("camera.set_trans_pivot","camera.target_set_trans_pivot");e.Aa(a)?(e.Cs(a,b,c),f.D(a),w.H(a)):m.error("set_trans_pivot(): Wrong object or camera move style")};a.Z9=function(a,b){m.Sb("camera.zoom_object","camera.target_zoom_object");
if(e.Aa(a)){f.cv(b,!1,D);n(a,D);f.D(a);var c=f.dv(b),l=k.A(),l=h.ka(a,l).da[0],l=e.hI(l)/2,c=c/Math.sin(l),l=f.ro(a,D);f.fh(a,0,0,c-l);f.D(a);w.H(a)}else m.error("zoom_object(): wrong object")};a.D8=n;a.vs=function(a,b,c,h,g){m.Sb("camera.rotate_hover_camera","camera.hover_rotate");e.$a(a)?(e.vs(a,b,c,h,g),f.D(a),w.H(a)):m.error("rotate_hover_camera(): wrong object")};a.a5=function(a,b){m.Sb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!e.$a(a))return m.error("get_hover_cam_pivot(): wrong object"),
null;b||(b=new Float32Array(3));C.copy(a.k.Vb,b);return b};a.wI=function(a,b){m.Sb("camera.get_eye","camera.get_translation");return h.xa(a)?e.wI(a,b):(m.error("get_eye(): Wrong object"),null)};a.w5=function(a,b){m.Sb("camera.get_pivot","camera.target_get_pivot");if(!e.Aa(a))return m.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));C.copy(a.k.pivot,b);return b};a.v6=function(a,b){m.Sb("camera.hover_cam_set_translation","camera.set_translation");if(e.$a(a)){var c=
a.k,h=C.subtract(b,v.G(c.n),D);C.add(h,c.Vb,c.Vb);f.Wc(a,b);f.D(a);w.H(a)}else m.error("hover_cam_set_translation(): wrong object")};a.Uw=function(a,b){m.Sb("camera.set_hover_pivot","camera.hover_set_pivot_translation");e.$a(a)?(e.Uw(a,b),f.D(a),w.H(a)):m.error("set_hover_pivot(): Wrong object or camera move style")};a.Z4=function(a,b){m.Sb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!e.$a(a))return m.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);
b[0]=a.k.la.down;b[1]=a.k.la.up;return b};a.u4=function(a,b){m.Oh("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!e.$a(a)&&!e.Aa(a))return m.error("get_cam_dist_limits(): wrong object"),null;if(a.k.tb)b=b||new Float32Array(2),b[0]=a.k.tb.max,b[1]=a.k.tb.min;else return null;return b};a.r2=function(b,c,h,k){m.Oh("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);
if(e.Aa(b)){var g=H;g.down=c;g.up=h;g.camera_space=k==f.vn;a.DZ(b,g)}else e.ic(b)?(g=H,g.down=c,g.up=h,g.camera_space=k==f.vn,a.eU(b,g)):e.$a(b)?(g=H,g.min=c,g.max=h,a.GV(b,g)):m.error("apply_vertical_limits(): wrong object")};a.o2=function(b,c,f){m.Sb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");H.down=c;H.up=f;a.zv(b,H)};a.k2=function(b,c,f){m.Oh("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(e.Aa(b)){var h=H;
h.min=c;h.max=f;a.JM(b,h)}else e.$a(b)?(h=H,h.min=c,h.max=f,a.yv(b,h)):m.error("apply_distance_limits(): wrong object")};a.c3=function(b){m.Sb("camera.clear_distance_limits","camera.target_set_distance_limits");a.JM(b,null)};a.X5=function(a,b){m.Oh("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!e.Aa(a)&&!e.ic(a)&&!e.$a(a))return m.error("get_vertical_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);
if(e.ic(a)||e.Aa(a)){if(c.la)return b[0]=c.la.down,b[1]=c.la.up,b}else if(e.$a(a)&&c.Cc)return b[0]=c.Cc.min,b[1]=c.Cc.max,b;return null};a.n2=function(b,c,h,k){m.Oh("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(e.Aa(b)){var g=H;g.left=c;g.right=h;g.camera_space=k==f.vn;a.CZ(b,g)}else e.ic(b)?(g=H,g.left=c,g.right=h,g.camera_space=k==f.vn,a.dU(b,g)):e.$a(b)?(g=H,g.min=c,g.max=h,a.FV(b,g)):m.error("apply_horizontal_limits(): wrong object")};
a.Y4=function(a,b){m.Oh("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!e.Aa(a)&&!e.ic(a)&&!e.$a(a))return m.error("get_horizontal_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);if(e.ic(a)||e.Aa(a)){if(c.mb)return b[0]=c.mb.left,b[1]=c.mb.right,b}else if(e.$a(a)&&c.Bc)return b[0]=c.Bc.min,b[1]=c.Bc.max,b;return null};a.W4=function(a,b){if(!h.xa(a))return m.error("get_frustum_planes(): Wrong camera object"),
null;var c=k.A(),c=h.ka(a,c).da[0].Ph;O.copy(c.left,b.left);O.copy(c.right,b.right);O.copy(c.top,b.top);O.copy(c.bottom,b.bottom);O.copy(c.near,b.near);O.copy(c.far,b.far);return b}};b4w.module.controls=function(a,l){var n=l("__controls"),e=l("__print");a.uf=n.uf;a.Qa=n.Qa;a.nn=n.nn;a.vf=n.vf;a.tp=n.tp;a.cy=n.cy;a.S0=8;a.E1=9;a.a1=13;a.zO=16;a.W0=17;a.Q0=18;a.y1=19;a.U0=20;a.c1=27;a.AO=32;a.KE=37;a.ME=38;a.LE=39;a.JE=40;a.G0=49;a.H0=50;a.I0=51;a.J0=52;a.K0=53;a.L0=54;a.M0=55;a.N0=56;a.O0=57;a.Xy=65;a.R0=66;a.IE=67;a.Yy=68;a.$0=69;a.sO=70;a.e1=71;a.g1=72;a.h1=73;a.i1=74;a.tO=75;a.uO=76;a.j1=77;a.l1=78;a.x1=79;a.wO=80;a.A1=81;a.xO=82;a.Zy=83;a.BO=84;a.F1=85;a.G1=86;a.$y=87;a.H1=
88;a.I1=89;a.J1=90;a.m1=96;a.n1=97;a.o1=98;a.p1=99;a.q1=100;a.r1=101;a.s1=102;a.t1=103;a.u1=104;a.w1=105;a.k1=106;a.P0=107;a.D1=109;a.Y0=110;a.Z0=111;a.B1=186;a.b1=187;a.V0=188;a.X0=189;a.z1=190;a.d1=191;a.f1=192;a.vO=219;a.T0=220;a.yO=221;a.C1=222;a.Ft=n.Ft;a.Et=n.Et;a.Dt=n.Dt;a.dz=n.dz;a.Eu=n.Eu;a.Fu=n.Fu;a.Lq=n.Lq;a.Ii=n.Ii;a.iA=n.iA;a.Ic=n.Ic;a.hA=function(a,e,l){return n.hA(a,e||"ANY",l||!1)};a.$G=n.$G;a.gH=function(a,e,l,A,h,w,m){return n.gH(a,e,l,A||"ANY",h||!1,w||!1,m||!1)};a.Fn=n.Fn;a.nA=
n.nA;a.Il=n.Il;a.oA=n.oA;a.pA=n.pA;a.Oq=n.Oq;a.vA=n.vA;a.pH=n.pH;a.xu=n.xu;a.fH=n.fH;a.qH=n.qH;a.cH=n.cH;a.kA=n.kA;a.dH=n.dH;a.lA=n.lA;a.eH=n.eH;a.oH=function(a,e){return n.oH(a,e||!1)};a.fL=n.fL;a.Rj=n.Rj;a.nH=n.nH;a.vu=function(a,e){return n.vu(a,e||!1)};a.gA=function(a,e){return n.gA(a,e||0)};a.g8=function(a,e){n.dY(a,e)};a.F4=function(a){return a.value};a.Zd=n.Zd;a.$e=n.$e;a.Y=function(a,e,l,A,h,w,m){h=h||n.Eu;n.Y(a,e,l,A,h,w,void 0===m?null:m)};a.En=function(a,e,l,A,h){var w;A=n.Ic(A);n.Y(a,
e,l,[A],n.Eu,h,void 0===w?null:w)};a.Z2=function(a){return n.vq(a,null)};a.vq=n.vq;a.hf=n.hf;a.reset=n.reset;a.G7=function(){e.O("controls.register_keyboard_events() deprecated")};a.H7=function(){e.O("controls.register_mouse_events() deprecated")};a.J7=function(){e.O("controls.register_wheel_events() deprecated")};a.I7=function(){e.O("controls.register_touch_events() deprecated")};a.F7=function(){e.O("controls.register_device_orientation() deprecated")};a.K9=function(){e.O("controls.unregister_keyboard_events() deprecated")};
a.L9=function(){e.O("controls.unregister_mouse_events() deprecated")};a.N9=function(){e.O("controls.unregister_wheel_events() deprecated")};a.M9=function(){e.O("controls.unregister_touch_events() deprecated")};a.J9=function(){e.O("controls.unregister_device_orientation() deprecated")};a.mD=n.mD};b4w.module.physics=function(a,l){function n(a,b,e,k){return r.GT(a,k[e[0]],k[e[1]],k[e[2]])}function e(a,b,e,k,f){b=Math.abs(a[2]-b[2]);return b<f&&A.bW(a,e,k)?b:Number.MAX_VALUE}l("__config");var b=l("__physics"),y=l("__print"),r=l("__util"),A=l("__navmesh");l("__vec3");new Float32Array(3);a.AE=0;a.QN=1;a.PN=2;a.Zx=3;a.JH=function(a){b.oa(a)?b.JH(a):y.O("No physics for object "+a.name)};a.IA=function(a){b.oa(a)?b.IA(a):y.O("No physics for object "+a.name)};a.n6=function(a){return b.oa(a)};a.tB=function(a){return b.tB(a)};
a.nJ=function(a){return b.nJ(a)};a.FL=function(a,e){b.oa(a)?b.FL(a,e):y.O("No physics for object "+a.name)};a.Ds=function(a,e,l){b.oa(a)?b.Ds(a,e,l):y.O("No physics for object "+a.name)};a.H=function(a){b.oa(a)?b.H(a):y.O("No physics for object "+a.name)};a.QF=function(a,e,l,k){b.oa(a)?b.QF(a,e,l,k):y.O("No physics for object "+a.name)};a.RF=function(a,e,l,k){b.oa(a)?b.RF(a,e,l,k):y.O("No physics for object "+a.name)};a.vz=function(a,e,l,k){b.oa(a)?b.vz(a,e,l,k,!1):y.O("No physics for object "+a.name)};
a.m2=function(a,e,l,k){b.oa(a)?b.vz(a,e,l,k,!0):y.O("No physics for object "+a.name)};a.PF=function(a,e,l,k){b.oa(a)?b.PF(a,e,l,k):y.O("No physics for object "+a.name)};a.lp=function(a,e){b.oa(a)?(b.bf(a)||b.cf(a)||y.error("Wrong object"),b.lp(a,r.U(e,-1,1))):y.O("No physics for object "+a.name)};a.V9=function(a,e,l){if(b.oa(a)){b.bf(a)||b.cf(a)||y.error("Wrong object");e=r.U(e,0,1);var k=a.v.On;-1==l||1==l?k=Math.max(-1,Math.min(k+l*e,1)):0==l&&0<=k?(k-=e,k=Math.max(0,k)):0==l&&0>k?(k+=e,k=Math.min(0,
k)):y.error("Wrong steering direction");b.lp(a,r.U(k,-1,1))}else y.O("No physics for object "+a.name)};a.kp=function(a,e){b.oa(a)?(b.bf(a)||b.cf(a)||y.error("Wrong object"),b.kp(a,r.U(e,-1,1))):y.O("No physics for object "+a.name)};a.U9=function(a,e,l){if(b.oa(a)){b.bf(a)||b.cf(a)||y.error("Wrong object");e=r.U(e,0,1);var k=a.v.Uo;-1==l||1==l?k=Math.max(-1,Math.min(k+l*e,1)):0==l&&0<=k?(k-=e,k=Math.max(0,k)):0==l&&0>k?(k+=e,k=Math.min(0,k)):y.error("Wrong steering direction");b.kp(a,r.U(k,-1,1))}else y.O("No physics for object "+
a.name)};a.lE=function(a,e){b.oa(a)?(b.bf(a)||b.cf(a)||y.error("Wrong object"),b.lE(a,r.U(e,0,1))):y.O("No physics for object "+a.name)};a.T9=function(a,e){if(b.oa(a)){b.bf(a)||b.cf(a)||y.error("Wrong object");e=r.U(e,-1,1);var l=a.v.nq;b.lE(a,r.U(l+l*e,0,1))}else y.O("No physics for object "+a.name)};a.bf=function(a){return b.bf(a)};a.cf=function(a){return b.cf(a)};a.T5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.of.name;y.error("Wrong object");
return null};a.V5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.v.On;y.error("Wrong object");return null};a.U5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.v.Uo;y.error("Wrong object")};a.S5=function(a){if(!b.oa(a))return y.O("No physics for object "+a.name),null;if(b.bf(a)||b.cf(a))return a.v.nq;y.error("Wrong object")};a.cJ=function(a){if(!b.oa(a))return y.O("No physics for object "+
a.name),null;if(b.bf(a)||b.cf(a))return b.cJ(a);y.error("Wrong object")};a.ig=function(a){return b.ig(a)};a.Qm=function(a,e,l){b.oa(a)?b.Qm(a,e,l):y.O("No physics for object "+a.name)};a.Gk=function(a,e){b.oa(a)?b.Gk(a,e):y.O("No physics for object "+a.name)};a.wL=function(a,e){b.oa(a)?b.wL(a,e):y.O("No physics for object "+a.name)};a.vL=function(a,e){b.oa(a)?b.vL(a,e):y.O("No physics for object "+a.name)};a.sL=function(a,e){b.oa(a)?b.sL(a,e):y.O("No physics for object "+a.name)};a.Pz=function(a){b.oa(a)?
b.Pz(a):y.O("No physics for object "+a.name)};a.BG=function(a,e,l){b.oa(a)?b.BG(a,e,l):y.O("No physics for object "+a.name)};a.Hk=function(a,e,l){b.oa(a)?b.Hk(a,e,l):y.O("No physics for object "+a.name)};a.uL=function(a,e){b.oa(a)?b.uL(a,e):y.O("No physics for object "+a.name)};a.tL=function(a,e){b.oa(a)?b.tL(a,e):y.O("No physics for object "+a.name)};a.sz=function(a,e,l,k){b.oa(a)?b.sz(a,e||"ANY",l,k||!1):y.O("No physics for object "+a.name)};a.QC=function(a,e,l){b.oa(a)?b.QC(a,e||"ANY",l):y.O("No physics for object "+
a.name)};a.uz=function(a,e){b.oa(a)?b.uz(a,e):y.O("No physics for object "+a.name)};a.Uz=function(a){b.oa(a)?b.Uz(a):y.O("No physics for object "+a.name)};a.Ut=function(a,e,l,k,f,n){a=a||null;if(null==a||b.oa(a))return b.Ut(a,e,l,k||"ANY",f,n||!1,!1,!1,!1);y.O("No physics for object "+a.name)};a.d2=function(a,e,l,k,f,n,c,r,A){a=a||null;if(null==a||b.oa(a))return b.Ut(a,e,l,k||"ANY",f,n||!1,c||!1,r||!1,A||!1);y.O("No physics for object "+a.name)};a.RC=function(a){b.IJ(a)?b.RC(a):y.error("Wrong ray test ID")};
a.zG=function(a,e,l){b.IJ(a)?b.zG(a,e,l):y.error("Wrong ray test ID")};a.MF=function(a,e,l,k,f,n,c,r,A,J){b.oa(e)&&b.oa(f)?b.MF(a,e,l,k,f,n,c,r,A,J):y.error("Wrong objects")};a.PG=function(a){b.oa(a)&&b.zV(a)?b.PG(a):y.error("Wrong object")};a.RK=function(a,e,l,k,f,n){b.oa(a)&&b.oa(k)?b.RK(a,e,l,k,f,n):y.error("Wrong objects")};a.lK=function(a,e,l){l||(l=n);if(b.oa(a)){var k=a.C.Vr;return k?A.lK(k,e,l):(y.error(a.name+" is not a navigation mesh object"),null)}y.O("No physics for object "+a.name)};
a.kK=function(a,l,m,k){if(b.oa(a)){var f=a.C.Vr;if(!f)return y.error(a.name+" is not a navigation mesh object"),null;k=k||{};a={};a.do_not_pull_string=Boolean(k.do_not_pull_string);a.distance_to_closest=k.distance_to_closest||n;a.distance_to_farthest=k.distance_to_farthest||e;a.island=k.island||0;a.allowed_distance=k.allowed_distance||Number.MAX_VALUE;a.return_normals=k.return_normals||!1;return A.kK(f,l,m,a)}y.O("No physics for object "+a.name)}};b4w.module.scenes=function(a,l){function n(){var a=y.gm();return h.fs(a.clientWidth/2,a.clientHeight/2)}var e=l("__batch"),b=l("__camera"),y=l("__container"),r=l("__data"),A=l("__graph"),h=l("__objects"),w=l("__obj_util"),m=l("__print"),k=l("__scenes"),f=l("__subscene"),v=l("__util");a.oc=h.oc;a.Pw=function(a){var b=k.pr();k.Pw(v.Dd("name",a,b))};a.A=function(){return k.Da()?k.A().name:""};a.D5=function(){for(var a=k.pr(),b=[],f=0;f<a.length;f++)b.push(a[f].name);return b};a.Qh=function(){if(k.Da())return k.dm(k.A());
m.error("No active scene");return!1};a.lV=function(){var a=h.xc(h.ny,"EmptySpawner1",0,!0);if(a)return a;m.error("get object EmptySpawner1: not found")};a.JI=function(a){var b=h.xc(h.my,"petigor",a,0);if(b)return b;m.error("get object "+a+": not found")};a.m5=function(a,b){var f=h.xc(h.Oc,a,b|0);if(f)return f;m.error("get object "+a+": not found")};a.iv=function(a,b){var f=h.iv(a,b|0);if(f)return f;m.error("get object "+a+": not found")};a.jB=function(a){return w.jB(a)};a.fs=function(a,b){var e=k.Rh();
return e?(e=k.La(e,f.xi))&&e.enable_hmd_stereo?(m.O("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),n()):h.fs(a,b):(m.error("No active scene"),null)};a.A7=n;a.v7=function(a){return a&&a.k&&a.k.Vc};a.KL=function(a,b){a&&a.k&&a.k.Vc?h.KL(a,b):m.error("set_outline_intensity(): wrong object")};a.u5=function(a){if(a&&a.k&&a.k.Vc)return a.k.ih;m.error("get_outline_intensity(): wrong object")};a.zn=function(a,b,f,e){a&&a.k&&a.k.Vc?h.zn(a,b,f,e):m.error("apply_outline_anim(): wrong object")};
a.p2=function(a){if(a&&a.k&&a.k.Vc){var b=a.k.ai;h.zn(a,b.rk,b.tk,b.uk)}else m.error("apply_outline_anim_def(): wrong object")};a.lu=function(a){a&&a.k&&a.k.Vc?h.lu(a):m.error("clear_outline_anim(): wrong object")};a.JL=k.JL;a.t5=function(a){var b=k.A();if(b=k.La(b,f.qn))return a=a||new Float32Array(3),a.set(b.hj),a};a.Tw=function(a){k.Da()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),k.Tw(a)):m.error("No active scene")};a.E5=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A(),b=k.La(a,f.cd);if(!b)return null;var e=a.s.ud,h=k.La(a,f.Pb),l=k.La(a,f.yf),n={};n.csm_resolution=e.csm_resolution;n.self_shadow_polygon_offset=b.self_shadow_polygon_offset;
l&&(n.self_shadow_normal_offset=l.self_shadow_normal_offset);n.enable_csm=e.enable_csm;n.csm_num=e.csm_num;n.csm_first_cascade_border=e.csm_first_cascade_border;n.first_cascade_blur_radius=e.first_cascade_blur_radius;n.csm_last_cascade_border=e.csm_last_cascade_border;n.last_cascade_blur_radius=e.last_cascade_blur_radius;n.fade_last_cascade=e.fade_last_cascade;n.blend_between_cascades=e.blend_between_cascades;e.enable_csm?(n.csm_borders=k.SU(a,h.p),n.blur_radii=new Float32Array(e.csm_num),n.blur_radii.set(h.p.vo.subarray(0,
e.csm_num))):(n.csm_borders=null,n.blur_radii=null);return n};a.N8=function(a){if(k.Da()){var h=k.A();"number"==typeof a.self_shadow_polygon_offset&&A.pa(h.s.Xa,function(b,e){e.type==f.cd&&(e.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var l=k.La(h,f.yf);l&&("number"==typeof a.self_shadow_normal_offset&&(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius));var n=k.La(h,f.Pc);n&&("number"==typeof a.self_shadow_normal_offset&&
(n.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(n.pcf_blur_radius=a.pcf_blur_radius),n.Ba=!0);n=h.s.ud;"number"==typeof a.csm_first_cascade_border&&(n.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(n.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(n.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(n.last_cascade_blur_radius=
a.last_cascade_blur_radius);if(l){for(var r=l.Ra,v=0;v<r.length;v++)for(var y=r[v].sa,L=0;L<y.length;L++){var H=y[L];if(H.ff.fe){var z=H.za;e.TF(z,n);e.Yc(z);f.Sc(l,H)}}l.Ba=!0}l=w.ka(h.Cj,h).da;for(v=0;v<l.length;v++)b.eE(l[v],n);k.cD(h)}else m.error("No active scene")};a.vI=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.vI(a)};a.Rw=function(a,b,e){if(k.Da()){var h=k.A(),l=k.La(h,f.Pb);k.Rw(h,a||0==a?parseFloat(a):l.Sg,b||0==b?b:l.ke,e||0==e?e:l.te)}else m.error("No active scene")};
a.yI=function(a){if(!k.Da())return m.error("No active scene"),!1;var b=k.A();return k.yI(b,a)};a.hD=function(a){if(k.Da()){var b=k.A();k.hD(b,a)}else m.error("No active scene")};a.T4=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A(),b={};b.hr=k.$U(a);b.fog_depth=k.YU(a);b.fog_start=k.aV(a);b.fog_height=k.ZU(a);return b};a.m8=function(a){if(k.Da()){var b=k.A();"number"==typeof a.hr&&k.BL(b,a.hr);"number"==typeof a.fog_depth&&k.zL(b,a.fog_depth);"number"==typeof a.fog_start&&k.CL(b,
a.fog_start);"number"==typeof a.fog_height&&k.AL(b,a.fog_height)}else m.error("No active scene")};a.YI=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.YI(a)};a.PL=function(a){if(k.Da()){var b=k.A();k.PL(b,a)}else m.error("No active scene")};a.B4=function(){if(!k.Da())return m.error("No active scene"),null;var a=k.A(),a=k.La(a,f.ay);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.e8=
function(a){if(k.Da()){var b=k.A();if(b=k.La(b,f.ay))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.Ba=!0}else m.error("No active scene")};a.WI=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.WI(a)};a.NL=function(a){if(k.Da()){var b=k.A();k.NL(b,a)}else m.error("No active scene")};a.tI=function(){if(!k.Da())return m.error("No active scene"),
!1;var a=k.A();return k.La(a,f.xp)?k.tI(a):null};a.yL=function(a){if(k.Da()){var b=k.A();k.yL(b,a)}else m.error("No active scene")};a.BI=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.La(a,f.Bj)?k.BI(a):null};a.EL=function(a){if(k.Da()){var b=k.A();k.EL(b,a)}else m.error("No active scene")};a.nI=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.La(a,f.rp)?k.nI(a):null};a.qL=function(a){if(k.Da()){var b=k.A();k.qL(b,a)}else m.error("No active scene")};
a.AI=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.La(a,f.zp)?k.AI(a):null};a.DL=function(a){if(k.Da()){var b=k.A();k.DL(b,a)}else m.error("No active scene")};a.jJ=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.jJ(a)};a.VL=function(a){if(k.Da()){var b=k.A();h.VL(b,a)}else m.error("No active scene")};a.gJ=function(a,b){if(!k.Da())return m.error("No active scene"),0;var f=k.A();return f.s.Mc?k.gJ(f,a,b):(m.error("No water parameters on the active scene"),
0)};a.UL=function(a){if(k.Da()){var b=k.A();k.UL(b,a)}else m.error("No active scene")};a.fJ=function(a){if(k.Da()){var b=k.A();k.fJ(b,a)}else m.error("No active scene")};a.Q9=function(){if(k.Da()){var a=k.A();k.hN(a)}else m.error("No active scene")};a.u6=function(a,b){b=b||!1;!w.$d(a)&&!w.bo(a)||w.Sa(a)?b?k.tq(a,!0):k.AG(a,!0):m.error("show/hide is only supported for dynamic objects.")};a.Z8=function(a,b){b=b||!1;!w.$d(a)&&!w.bo(a)||w.Sa(a)?b?k.tq(a,!1):k.AG(a,!1):m.error("show/hide is only supported for dynamic objects.")};
a.GB=function(a){if(w.UV(a)||w.bo(a)||w.Zg(a))return k.GB(a);m.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.ho=function(a){return a.k.ho};a.V2=function(a){m.Sb("scenes.check_object","scenes.check_object_by_name");return k.Da()?h.dX(a,k.A()):(m.error("No active scene"),!1)};a.Y2=function(a,b){return h.xc(h.ny,a,b|0,!0)?!0:!1};a.W2=function(a,b,f){return h.xc(h.my,a,b,f|0)?!0:!1};a.X2=function(a,b){return h.xc(h.Oc,a,b|0)?!0:!1};a.cm=function(a,b){var f=k.A();
a||(a="ALL");b||0===b||(b=h.oc);return h.TI(f,a,b)};a.p5=function(a){return a?a.Em:(m.error("Wrong object name"),"")};a.q5=function(a){if(!a)return m.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Em),a=w.Ri(a);return b.reverse()};a.r5=function(a){return a&&a.type?a.type:(m.error("Wrong object"),"UNDEFINED")};a.o5=function(a){m.Sb("scenes.get_object_dg_parent","objects.get_dg_parent");return w.Ri(a)};a.n5=function(a){return a.Te.slice(0)};a.hm=function(){return h.hm(k.A())};a.VI=function(a,
b){b||0===b||(b=1);if(!k.Da())return m.error("No active scene"),!1;var f=k.A();return k.VI(f,a,b)};a.pI=function(){return k.pI()};a.O5=function(a){return w.$d(a)?a.k.type:null};a.bv=function(){if(!k.Da())return m.error("No active scene"),!1;var a=k.A();return k.bv(a)};a.yn=function(a,b){if(a.k.Hv){if(b)var f=k.pr(),f=v.Dd("name",b,f);else f=k.A();k.yn(f,a,!0)}else m.error('object "'+a.name+'" has been created not by coping.')};a.ts=function(a){(w.$d(a)||w.bo(a))&&w.Sa(a)?(h.mw(a,a.k.Iv,!1,!1),r.yX(a),
h.mw(a,!0,!0,!0),h.ts(a)):m.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.bK=function(a){var b=k.A();if(b.timeline_markers&&a in b.timeline_markers)return k.bK(b,a);m.error('"'+a+'" marker not found.');return 0};a.j5=function(){var a=k.A();return(a=k.La(a,f.zh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.x8=function(a){var b=k.A();(b=k.La(b,f.zh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),
"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):m.error("The motion blur subscene doesn't exist.")};a.G2=function(){var a=k.A();return Boolean(k.La(a,f.tf))}};b4w.module.container=function(a,l){var n=l("__container"),e=l("__print");a.gm=n.gm;a.qI=n.qI;a.Ce=n.Ce;a.Fv=function(a,l){2!=arguments.length?e.error("insert_to_container(): two arguments required"):a&&l&&n.Fv(a,l)};a.rL=n.rL;a.bN=n.bN;a.nu=n.nu;a.WA=n.WA;a.resize=function(a,l,r){a&&l||e.warn("Wrong canvas container dimensions: "+a+"x"+l+". Zero dimensions aren't allowed. Resized to: "+n.ey+"x"+n.dy+".");n.resize(a,l,r)};a.Bk=function(a){n.Bk(a||!1)}};b4w.module.util=function(a,l){var n=l("__compat"),e=l("__obj_util"),b=l("__print"),y=l("__quat"),r=l("__util"),A=l("__vec3"),h=new Float32Array(6);a.ti=new Float32Array([1,0,0]);a.xh=new Float32Array([0,1,0]);a.nc=new Float32Array([0,0,1]);a.Xx=new Float32Array([-1,0,0]);a.wh=new Float32Array([0,-1,0]);a.Nc=new Float32Array([0,0,-1]);a.mF=r.mF;a.tF=r.tF;a.uF=r.uF;a.oF=r.oF;a.qF=r.qF;a.wF=r.wF;a.nF=r.nF;a.sF=r.sF;a.jz=r.jz;a.pF=r.pF;a.rF=r.rF;a.vF=r.vF;a.Ef=function(a){return r.Ef(a||0)};a.assert=
r.assert;a.RJ=r.RJ;a.Dd=r.Dd;a.WB=function(a){return r.WB(a)};a.Wj=function(a,b){b||(b=new Float32Array(4));return r.Wj(a,b)};a.rC=function(a,b,e){e||(e=y.create());return r.rC(a,b,e)};a.VK=function(a,b,e){e||(e=A.create());return r.VK(a,b,e)};a.Fw=function(a,b){b||(b=new Float32Array(3));return r.Fw(a,b)};a.sign=r.sign;a.U=r.U;a.lc=r.lc;a.f6=function(a,b){return r.Ew(a,r.Nc,r.nc,r.xh,b)};a.Nz=function(a,b){return r.Nz(a,b)};a.Ew=function(a,e,h,f,l){return 0!=A.dot(h,f)?(b.error("Wrong in-plane direction"),
null):r.Ew(a,e,h,f,l)};a.pJ=r.pJ;a.mc=r.mc;a.jx=r.jx;a.jk=r.jk;a.eA=r.eA;a.UK=r.UK;a.XK=r.XK;a.sJ=r.sJ;a.QB=function(a,e,k,f,l){b.Sb("util.line_plane_intersect","math.line_plane_intersect");h[0]=k[0];h[1]=k[1];h[2]=k[2];h[3]=f[0];h[4]=f[1];h[5]=f[2];return r.QB(a,e,h,l)};a.$d=function(a){b.Sb("util.is_mesh","objects.is_mesh");return e.$d(a)};a.pm=function(a){b.Sb("util.is_armature","objects.is_armature");return e.pm(a)};a.zi=r.zi;a.Fg=r.Fg;a.Tm=r.Tm;a.lerp=r.lerp;a.Cb=r.Cb;a.oe=r.oe;a.FA=r.FA;a.Hr=
n.Hr;a.or=r.or};b4w.module.main=function(a,l){function n(){}function e(){}function b(){}function y(){window.performance||(G.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(G.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});ga.RL(0)}function r(a,b){for(var c=null,d=b?la:wa,f=0;f<d.length;f++){var e=d[f];try{c=a.getContext(e,q)}catch(g){}if(c)break}c&&D.BT(c);return c}function A(a,b,f){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();G.error("WebGL context lost");w()},!1);d.Nf(f);var g=d.ev();g&&G.log("%cRENDERER INFO:","color: #00a",f.getParameter(g.UNMASKED_VENDOR_WEBGL)+", "+f.getParameter(g.UNMASKED_RENDERER_WEBGL));F.Nf(f);p.Nf(f);u.Nf(f);Z.Nf(f);z.Nf(f);Q.Nf(f);H.RY(a);Q.Xg(a,b);U.WL(a.width,a.height,1);R.Xg();e=c();k()}function h(){n=function(){}}function w(){m()||(oa=performance.now()/1E3,R.pause(),da.pause(),u.pause(),C.pause())}function m(){return Y<oa}function k(){var a="HMD"===T.stereo&&
M.hJ();a?a.requestAnimationFrame(k):ta(k);var b=performance.now()/1E3;sa||(sa=b);var c=b-sa;if(!(c<1/T.max_fps)){for(var d=ga.ur(),f=0;f<na.length;f++)na[f](d,c);m()||(Y>sa&&(c-=Y-Math.max(oa,sa)),d+=c,ga.RL(d),z.update(),J.update(),H.update(),v(d,c),e(c));sa=b;a&&a.isPresenting&&a.submitFrame()}}function f(a,b,c){if(ba)if(ba.HZ)ba.HZ(a,b,c);else{c=atob(ba.toDataURL(b,c).split(",")[1]);for(var d=new Uint8Array(c.length),f=0;f<c.length;f++)d[f]=c.charCodeAt(f);a(new Blob([d],{type:b||"image/png"}))}}
function v(a,b){if(H.$g()&&(x.reset(),ca.update(b),P.update(a,b),g.update(a,b),R.update(a,b),b&&O.update(b),H.$g()&&(da.update(a,b),H.$g()&&(M.update(a),L.update(a,b),H.$g()&&(C.update(!1),t.update(a,b),ia.update(),n(b,a),H.$g()))))){U.update(a,b);C.kN();var c=ya.callback;c&&(ya.SJ&&URL.revokeObjectURL(ya.Az),f(function(a){ya.Az=URL.createObjectURL(a);c(ya.Az)},ya.format,ya.quality),ya.callback=null,ya.format="image/png",ya.quality=1)}}function c(){var a=60,c=0,d=T.TH,f=T.qU;return function(e){e<
1/T.max_fps||(a=E.mc(1/e,a,e,d),e=da.cV(),c=(c+1)%f,0==c&&b(Math.round(a),e))}}var C=l("__anchors"),O=l("__animation"),J=l("__assets"),K=l("__config"),D=l("__compat"),Q=l("__container"),L=l("__controls"),H=l("__data"),z=l("__debug"),d=l("__extensions"),p=l("__geometry"),M=l("__input"),x=l("__hud"),g=l("__nla"),P=l("__logic_nodes"),t=l("__objects"),da=l("__physics"),G=l("__print"),F=l("__renderer"),U=l("__scenes"),R=l("__sfx"),Z=l("__shaders"),u=l("__textures"),ga=l("__time"),ca=l("__transform"),E=
l("__util"),aa=l("__version"),ia=l("__particles"),q=K.context,T=K.B,ba=null,S=null,sa=0,oa=0,Y=0,na=[],ya={callback:null,format:"image/png",quality:1,Az:"",SJ:!1,tH:!1},wa=["webgl","experimental-webgl"],la=["webgl2","experimental-webgl2"],ha=null,ta=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/T.max_fps)}}();a.Xg=function(a,
b){K.CY();G.MY(T.console_verbose);var c=aa.mE()+" "+aa.type()+" ("+aa.AA()+")";G.log("%cINIT ENGINE","color: #00a",c);G.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;y();ba=a;b?(x.Xg(b),S=b):(K.B.show_hud_debug_info=!1,K.X.cw=!1);D.HQ();D.Sz("Chrome")||D.Sz("Firefox")||(T.ec=!1);c=r(a,T.ec);!c&&T.ec&&(T.ec=!1,c=r(a,!1));if(!c)return null;G.log("%cINIT WEBGL "+(T.ec?"2":"1"),"color: #00a");ha=c;A(ba,S,c);K.An();D.GL(c,!0);Z.xW();T.Xn&&(a.style["touch-action"]=
"none");G.log("%cSET PRECISION:","color: #00a",T.precision);return c};a.resize=function(a,b,c){G.Sb("main.resize","container.resize");Q.resize(a,b,c)};a.pY=function(a){b=a};a.d3=function(){b=function(){}};a.I8=function(a){n=a};a.h3=function(){h()};a.e6=function(){G.Sb("main.global_timeline","time.get_timeline");return ga.ur()};a.pause=w;a.jj=function(){m()&&(Y=performance.now()/1E3,R.jj(),da.jj(),u.play(!0),C.jj())};a.Ir=m;a.reset=function(){H.yx(0);H.reset();d.reset();F.reset();p.reset();u.UX();
Z.reset();z.reset();Q.reset();H.reset();Q.reset();ga.reset();R.reset();S=ba=null;Y=oa=sa=0;b=function(){};e=function(){};n=function(){};na.length=0;ha=null};a.H2=function(a,b,c,d){ya.tH="undefined"===typeof d?d:!0;ya.SJ=ya.tH;ya.callback=a;ya.format=b||ya.format;ya.quality=c||ya.quality};a.z4=function(){G.Sb("main.get_canvas_elem","container.get_canvas");return ba};a.Zf=function(){return D.Zf()};a.Yp=function(a){for(var b=0;b<na.length;b++)if(na[b]==a)return;na.push(a)};a.HX=function(a){for(var b=
0;b<na.length;b++)if(na[b]==a){na.splice(b,1);break}};a.ev=function(){var a=d.ev();return a?{vendor:ha.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:ha.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.input=function(a,l){function n(a){var e=b.ga(b.xd);if(!e||!e.mh)return!1;if(c)return!0;var d=b.Ti(e,b.VN,f),k=b.Ti(e,b.WN,v);y.iD(a,d,k);if(d=b.jm(e,J))k=m.A(),a=h.ka(a,k).da,y.eD(a,d);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.jm(b.hl)!==b.Fp&&(a.distortion_coefs=[e.distortion_coefs[0],e.distortion_coefs[1]],a.chromatic_aberration_coefs=[e.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]],
e.pp||(e.Hj&&e.bk&&e.Ij?a.base_line_factor=(e.Hj-e.Ij)/e.bk:e.Ij||(a.base_line_factor=e.Hj/e.bk)),e.Vi&&e.jn&&!e.pp&&(a.inter_lens_factor=e.Vi/e.jn),C.enabled||(d=1+e.distortion_coefs[0]+e.distortion_coefs[1],m.jK(d,d)));m.Tw(a);A.Bk(!0);b.Jw(e);return c=!0}function e(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=l("__input"),y=l("__camera"),r=l("__config"),A=l("__container"),
h=l("__obj_util"),w=l("__print"),m=l("__scenes"),k=l("__vec4"),f=k.create(),v=k.create(),c=!1,C=r.Tq,O=r.B;a.st=b.st;a.tt=b.tt;a.vt=b.vt;a.ut=b.ut;a.Ky=b.Ky;a.wy=b.wy;a.rt=b.rt;a.Dy=b.Dy;a.My=b.My;a.Ep=b.Ep;a.Ly=b.Ly;a.wt=b.wt;a.Ny=b.Ny;a.Oy=b.Oy;a.xy=b.xy;a.yy=b.yy;a.zy=b.zy;a.Ay=b.Ay;a.By=b.By;a.Cy=b.Cy;a.Ey=b.Ey;a.Fy=b.Fy;a.Gy=b.Gy;a.Hy=b.Hy;a.Iy=b.Iy;a.Jy=b.Jy;a.Ap=b.Ap;a.Bp=b.Bp;a.Cp=b.Cp;a.Dp=b.Dp;a.qy=b.qy;a.ry=b.ry;a.sy=b.sy;a.ty=b.ty;a.uy=b.uy;a.vy=b.vy;a.oy=b.oy;a.py=b.py;a.zt=b.zt;a.At=
b.At;a.hl=b.hl;a.Wy=b.Wy;a.EE=b.EE;a.DE=b.DE;a.Fp=b.Fp;var J=b.Sy;a.Sy=J;a.Ry=b.Ry;a.Py=b.Py;a.Uy=b.Uy;a.Vy=b.Vy;a.Ty=b.Ty;a.Qy=b.Qy;a.wi=b.wi;a.il=b.il;a.Jp=b.Jp;a.Kp=b.Kp;a.Hp=b.Hp;a.Gp=b.Gp;a.ml=b.ml;a.Qp=b.Qp;a.ll=b.ll;a.yt=b.yt;a.pn=b.pn;var K={};K[b.xd]=[b.zt,b.At];K[b.ad]=[b.wi];var D={};D[b.xd]=[b.hl];var Q={};Q[b.ad]=[b.wi,b.il,b.Jp,b.Kp];Q[b.vp]=[b.Hp,b.Gp];Q[b.Ag]=[b.ml,b.Qp,b.ll];Q[b.yh]=[b.yt,b.pn];var L={};L[b.xd]=[b.Ry,b.Sy,b.Py,b.Uy,b.Vy,b.Ty,b.Qy];a.yh=b.yh;a.xd=b.xd;a.ad=b.ad;a.vp=
b.vp;a.Ag=b.Ag;a.hu=b.hu;a.ga=b.ga;a.LD=function(a,c){a&&b.LD(a,c)};a.E7=function(){w.O("input.register_device() deprecated")};a.Jw=function(a){a&&a.type==b.xd?b.Jw(a):w.error("reset_device is undefined for device.")};a.Ti=function(a,c,d){if(a&&a.type in K&&0<=K[a.type].indexOf(c))return b.Ti(a,c,d);w.error("device hasn't param: ",c)};a.jm=function(a,c){if(a&&a.type in D&&0<=D[a.type].indexOf(c))return b.jm(a,c);w.error("device hasn't param: ",c)};a.yd=function(a,c,d){d=d||null;if(a&&a.type in Q&&
0<=Q[a.type].indexOf(c))return b.yd(a,c,d);w.error("device hasn't param: ",c)};a.Bd=function(a,c,d){d=d||null;if(a&&a.type in Q&&0<=Q[a.type].indexOf(c))return b.Bd(a,c,d);w.error("device hasn't param: ",c)};a.dD=function(a,c,d){if(a&&a.type in L&&0<=L[a.type].indexOf(c))return b.dD(a,c,d);w.error("device hasn't config: ",c)};a.SX=function(){if(m.Da()){var a=m.dm(m.A());if(a&&(n(a),a=b.ga(b.xd))){var c=a.Tf;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=A.gm(),c.requestPresent([{source:a}]).then(function(){if(!O.is_mobile_device){var a=
c.getEyeParameters("left"),b=c.getEyeParameters("right");A.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,b.renderHeight),!1)}},function(){w.error("HMD fullscreen request failed.")})):w.error("HMD fullscreen request failed."))}}};a.QT=n;a.ET=function(){var a=b.ga(b.xd);if(c||a&&a.mh)m.Tw({enable_hmd_stereo:!1}),a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]),m.jK(a,a),A.Bk(!0)};a.p8=function(a,c,d){e();switch(a){case 0:a=b.mt;break;case 1:a=b.fy;break;case 2:a=b.gy;break;
case 3:a=b.hy;break;default:a=b.mt}a=b.ga(a);b.dD(a,c,d)};a.LI=b.LI;a.EI=b.EI;a.DG=e};b4w.module.transform=function(a,l){var n=l("__obj_util"),e=l("__physics"),b=l("__print"),y=l("__quat"),r=l("__transform"),A=l("__tsr"),h=l("__util"),w=A.create(),m=new Float32Array(3),k=new Float32Array(4);a.vn=r.vn;a.kF=r.kF;a.Wc=function(a,h,c,k){n.Sa(a)?(m[0]=h,m[1]=c,m[2]=k,r.Wc(a,m),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yw=function(a,h,c,k){n.Sa(a)?(m[0]=h,m[1]=c,m[2]=k,r.Yw(a,m),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.KY=function(a,
h){n.Sa(a)?(r.Wc(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.S8=function(a,h){n.Sa(a)?(r.Yw(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Q8=function(a,k,c,l,w){n.Sa(a)?(m[0]=k,m[1]=c,m[2]=l,h.Xc(m,1,A.P(w.k.n),A.G(w.k.n),m),r.Wc(a,m),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.ie=function(a,b){b||(b=new Float32Array(3));r.ie(a,b);return b};a.aJ=function(a,b){b||(b=new Float32Array(3));r.aJ(a,b);return b};
a.gi=function(a,h,c,l,m){n.Sa(a)?(k[0]=h,k[1]=c,k[2]=l,k[3]=m,r.gi(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Xw=function(a,h,c,l,m){n.Sa(a)?(k[0]=h,k[1]=c,k[2]=l,k[3]=m,r.Xw(a,k),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.pD=function(a,h){n.Sa(a)?(r.gi(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.M8=function(a,h){n.Sa(a)?(r.Xw(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Sh=
function(a,b){b||(b=new Float32Array(4));r.Sh(a,b);return b};a.QI=function(a,b){b||(b=new Float32Array(4));r.QI(a,b);return b};a.Ww=function(a,h,c,k){n.Sa(a)?(m[0]=h,m[1]=c,m[2]=k,r.Ww(a,m),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.NI=function(a,b){b||(b=new Float32Array(3));r.NI(a,b);return b};a.OI=function(a,b){b||(b=new Float32Array(3));r.OI(a,b);return b};a.oD=function(a,h,c,k){n.Sa(a)?(m[0]=h,m[1]=c,m[2]=k,r.oD(a,m),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.L8=function(a,h){n.Sa(a)?(r.Ww(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.K8=function(a,h){n.Sa(a)?(r.oD(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Mf=function(a,e){n.Sa(a)?(r.Mf(a,e),r.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.qD=function(a,e){n.Sa(a)?(r.qD(a,e),r.D(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Yd=function(a){return r.Yd(a)};a.SI=function(a){return r.SI(a)};
a.L3=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var h=0;h<a.Te.length;h++)if(!n.Sa(a.Te[h])){b.error('Wrong object: "'+a.Te[h].name+'" is not dynamic.');return}r.Wc(a,[0,0,0]);r.gi(a,[0,0,0,1]);r.Mf(a,1);r.D(a);e.H(a)}};a.dv=function(a){return n.$d(a)?r.dv(a):(b.error("Wrong object: "+a.name),0)};a.cv=function(a,e,c){if(!n.$d(a))return b.error("Wrong object: "+a.name),null;c||(c=new Float32Array(3));return r.cv(a,e,c)};a.fh=function(a,h,c,k){n.Sa(a)?(r.fh(a,h,c,k),r.D(a),
e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.S7=function(a,l){if(n.Sa(a)){var c=y.setAxisAngle(h.ti,l,k);r.$C(a,c);r.D(a);e.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.T7=function(a,l){if(n.Sa(a)){var c=y.setAxisAngle(h.wh,l,k);r.$C(a,c);r.D(a);e.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.U7=function(a,l){if(n.Sa(a)){var c=y.setAxisAngle(h.nc,l,k);r.$C(a,c);r.D(a);e.H(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.II=function(a){return r.II(a)};a.mj=function(a,h){n.Sa(a)?(r.mj(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.Zw=function(a,h){n.Sa(a)?(r.Zw(a,h),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.vr=function(a,b){b||(b=new Float32Array(8));r.vr(a,b);return b};a.wr=function(a,b){b||(b=new Float32Array(8));r.wr(a,b);return b};a.distance=function(a,b){return r.distance(a,b)};a.u8=function(a,h){n.Sa(a)?(A.Qi(h,w),r.mj(a,w),r.D(a),e.H(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.v8=function(a,h){n.Sa(a)?(A.Qi(h,w),r.Zw(a,w),r.D(a),e.H(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.h5=function(a,b){b||(b=new Float32Array(16));r.vr(a,w);A.SM(w,b);return b};a.i5=function(a,b){b||(b=new Float32Array(16));r.wr(a,w);A.SM(w,b);return b}};b4w.module.constraints=function(a,l){var n=l("__camera"),e=l("__constraints"),b=l("__obj_util"),y=l("__physics"),r=l("__print"),A=l("__transform");a.h2=function(a,b,l,k,f){f=f||1;b instanceof Array&&2==b.length?e.yQ(a,b[0],b[1],l,k,f):e.KF(a,b,l,k,f);A.D(a);y.H(a)};a.f2=function(a,b,l,k){e.wQ(a,b,l,k);A.D(a);y.H(a)};a.g2=function(a,b,l,k,f,v,c,C){n.ic(a)?(f=f||-Math.PI/2,v=v||Math.PI/2,c=c||Math.PI/2,C=C||-Math.PI/2,e.vQ(a,b,l,k,f,v,c,C),A.D(a),y.H(a)):r.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};
a.e2=function(a,b,l,k){if(n.ic(a)){if(!k||0>k)k=.25;e.uQ(a,b,l,k);A.D(a);y.H(a)}else r.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.LF=function(a,b,l){e.AQ(a,b,l);A.D(a);y.H(a)};a.Z1=function(a,b,l){e.oQ(a,b,l);A.D(a);y.H(a)};a.i2=function(a,b,l,k){e.BQ(a,b,l,k);A.D(a);y.H(a)};a.j2=function(a,b){3==b.length?e.EQ(a,b):e.DQ(a,b);A.D(a);y.H(a)};a.c2=function(a,b,l,k){3==b.length?e.rQ(a,b,l,k):e.qQ(a,b,l,k);A.D(a);y.H(a)};a.tz=function(a,b,l){e.tz(a,
b,l);A.D(a);y.H(a)};a.remove=function(a){a.pc&&e.remove(a)};a.KI=function(a){r.Sb("constraints.get_parent","objects.get_parent");return b.KI(a)}};b4w.module.hmd=function(a,l){function n(a,l){if(l){var n=A.Qh();if(n){e.ic(n)||(v=e.Aa(n),c=e.$a(n),C=e.um(n),e.fU(n));var n=b.Rj(),x=!1;b.Y(null,"HMD_ROTATE_CAMERA",b.Qa,[n,l],null,function(c,l,n){if(0<n&&(n=A.Qh())&&(!x&&y.QT(n)&&(k=h.Sh(n,k),x=!0),x&&e.ic(n)&&(c=b.$e(c,l,1))))if(1==a){c=r.multiply(z,c,H);var p=m.transformQuat(w.wh,c,O);e.rD(n,p);h.pD(n,c)}else if(2==a||3==a){l=h.Sh(n,Q);l=r.invert(l,Q);var v=r.multiply(k,l,Q);l=e.tV(n,O);Math.abs(l[2])<Math.PI/4?p=m.cross(l,w.wh,J):Math.abs(l[1])<
Math.PI/4&&(p=m.cross(l,w.nc,J));m.normalize(p,p);var v=m.transformQuat(p,v,K),F=m.dot(l,v),v=m.scaleAndAdd(v,l,-F,K);m.normalize(v,v);l=m.cross(l,p,O);p=Math.acos(w.U(m.dot(p,v),0,1));l=w.sign(m.dot(v,l));f+=p*l;p=r.setAxisAngle(w.nc,-f,Q);3!=a&&(l=w.Ew(c,w.Nc,w.nc,w.xh,L),l=r.invert(l,L),c=r.multiply(l,c,L));c=r.multiply(p,c,D);p=m.transformQuat(w.wh,c,O);e.rD(n,p);h.pD(n,c);r.copy(c,k)}})}}}var e=l("camera"),b=l("controls"),y=l("input"),r=l("quat"),A=l("scenes"),h=l("transform"),w=l("util"),m=
l("vec3"),k=r.create(),f=0,v=!1,c=!1,C=!1,O=m.create(),J=m.create(),K=m.create(),D=r.create(),Q=r.create(),L=r.create(),H=r.create(),z=r.create();a.E0=0;a.UN=1;a.F0=2;a.D0=3;a.PT=function(a){var c=null;if(c=y.ga(y.xd))c=y.jm(c,y.hl)==y.Wy||y.jm(c,y.hl)==y.Fp?b.lA():b.kA(),n(a,c)};a.KR=function(){return Boolean(y.hu(y.xd))};a.X4=function(){return null};a.reset=function(){var a=y.ga(y.xd);y.Jw(a)};a.E3=function(){b.hf(null,"HMD_ROTATE_CAMERA");y.ET();var a=A.Qh();v?e.EZ(a):c?e.wJ(a):C&&e.qZ(a);e.rD(a,
w.nc);var f=h.Sh(a,D);h.pD(a,f)};a.J8=function(a){r.copy(a,z)};a.B5=function(a){r.copy(z,a);return a}};b4w.module.animation=function(a,l){var n=l("__animation"),e=l("__armature"),b=l("__obj_util"),y=l("__print"),r=l("__tsr");a.od=n.od;a.eF=n.eF;a.fF=n.fF;a.gF=n.gF;a.hF=n.hF;a.iF=n.iF;a.jF=n.jF;a.Gt=n.Gt;a.kl=n.kl;a.WE=n.WE;a.bz=n.bz;a.cz=n.cz;a.ZE=n.ZE;a.YE=n.YE;a.XE=n.XE;a.VE=n.VE;a.Rx=n.Rx;a.uE=n.uE;a.Sx=n.Sx;var A=r.create();a.Dc=function(a){return n.Dc(a)};a.iI=function(a){return n.wK(a)?n.iI(a):[]};a.E4=function(a,b){if(!n.Dc(a))return null;b=b||n.od;return n.NU(a,b)};a.apply=function(a,b,e){if(e>
n.Gt)y.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=e||n.od;if(n.Dc(a)){var k=n.gv(a,b);if(-1!=k&&k!=e){y.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+k+'").');return}}n.uN(a,b)?n.apply(a,null,b,e):y.error('No fcurves in action "'+b+'"')}};a.l2=function(a,b,e){if(e>n.Gt)y.error("Can't apply animation to slot "+e+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{e=
e||n.od;var k=b[0];if(n.Dc(a)){var f=n.gv(a,k);if(-1!=f&&f!=e){y.error('Animation "'+k+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}n.uN(a,k)?n.apply(a,b.slice(1),k,e):y.error('No fcurves in action "'+k+'"')}};a.remove=function(a){n.remove(a)};a.bL=function(a,b){n.Dc(a)&&(b=b||n.od,n.bL(a,b))};a.Vt=function(a){n.Vt(a)};a.play=function(a,b,e){n.Dc(a)?(e=e||n.od,n.play(a,b,e),n.n_(a,0,e,!0)):y.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){n.Dc(a)&&
(b=b||n.od,n.stop(a,b))};a.fk=function(a,b){if(!n.Dc(a))return!1;b=b||n.od;return n.fk(a,b)};a.Go=function(a,b,e){n.Dc(a)&&(e=e||n.od,n.Go(a,b,e))};a.gD=function(a,b){n.Dc(a)&&n.gD(a,b)};a.q8=function(a,b){if(n.Dc(a)){b=b||n.od;var e=n.bB(a,b),k=n.aB(a,b);n.Go(a,e+k-n.CO,b)}};a.rr=function(a,b){if(!n.Dc(a))return 0;b=b||n.od;return n.sI(a,b)};a.OL=function(a,b,e){n.Dc(a)&&(e=e||n.od,n.OL(a,b||1,e))};a.XI=function(a,b){if(!n.Dc(a))return 0;b=b||n.od;return a.ja[b]?n.XI(a,b):0};a.bB=function(a,b){return n.Dc(a)&&
(b=b||n.od,a.ja[b])?n.bB(a,b):-1};a.aB=function(a,b){return n.Dc(a)&&(b=b||n.od,a.ja[b])?n.aB(a,b):-1};a.Fo=function(a,b,e){n.Dc(a)&&(e=e||n.od,n.Fo(a,b,e))};a.mI=function(a,b){if(!n.Dc(a))return null;b=b||n.od;return n.mI(a,b)};a.NF=function(a,b,e,k){k=k||n.od;n.Dc(a)&&n.NF(a,b,e,k)};a.VH=function(a){return n.VH(a)};a.t4=function(a,l,m){y.Sb("get_bone_translation","armature.get_bone_tsr");if(!b.pm(a))return null;if(!e.GR(a,l))return y.error('There is no bone: "',l,'" in "',a.name,'".'),null;m||(m=
new Float32Array(3));e.Zu(a,l,!1,A);m[0]=A[0];m[1]=A[1];m[2]=A[2];return m};a.P4=function(){y.O("get_first_armature_object() deprecated");return null};a.gv=function(a,b){return n.Dc(a)&&b?n.gv(a,b):-1};a.jI=function(a,b){return n.Dc(a)?n.jI(a,b):null};a.OF=function(a,b){return n.OF(a,b)};a.H5=function(a){return a.k.Fh};a.ML=function(a,e,l){b.pm(a)?(e=Math.min(Math.max(e,0),1),a.k.Fh!=e&&n.ML(a,e,l||0)):y.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.config=function(a,l){var n=l("__config"),e=l("__compat"),b=l("__debug"),y=l("__data"),r=l("__print");a.Np=n.Np;a.jl=n.jl;a.rn=n.rn;a.dF=n.dF;a.Mp=n.Mp;a.set=n.set;a.get=n.get;a.reset=n.reset;a.UC=n.UC;a.I5=n.Yu;a.Yu=n.Yu;a.An=function(a){y.$g()?r.error("Cannot change quality profile after a scene is loaded."):(n.set("quality",a),b.av()&&(n.An(),e.GL(b.av(),!1)))}};b4w.module.app=function(a,l){function n(){var a=x.Ir();document.addEventListener("visibilitychange",function(){document.hidden?(a=x.Ir(),x.pause()):a||x.jj()},!1)}function e(){var a=0,b=H.Ce(),c=x.Ir(),d=!0;x.Yp(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=x.Ir()),x.pause(),d=!1):c||d||(x.jj(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);f||(P.error('Warning: canvas container "'+a+'" not found, appending to body'),
f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!x.Xg(e,a))return c&&J("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",
d),!1;a&&H.Fv(a,"LAST");return!0}function y(a,b){a?(b&&(document.getElementById(b).style.display="block"),R=document.getElementById(a)):(R=document.createElement("div"),R.innerHTML=0,R.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",H.Fv(R,"JUST_AFTER_CANVAS"))}function r(a,b){var c=String(a);b&&(c+="/"+String(b));R.innerHTML=c}function A(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,
a);return b}function h(a,b,c){var d=Math.max(D.EV(a),1),e=da.Sh(a,q);b=G.lc(e,b,aa);b[2]=0;F.normalize(b,b);F.scale(b,d*c,b);c=da.ie(a,ia);F.add(c,b,c);D.Wc(a,c)}function w(a,b){var c=D.uJ(a,ba);if(c.up!=c.down){var d=D.em(a,E)[1],c=(c.down-d)/(c.down-c.up),d=D.tJ(a,ba),c=Math.max(c,2/d.max);D.vJ(a,0,c*b)}}function m(a,b,c,d){da.fh(a,5*b,5*c,5*d)}function k(a,b,c){var d=D.ND(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));da.fh(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function f(a,b,c,d){for(var e=
c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function v(a,b,c,d,e){e?(e=D.zZ(a,aa),a=D.ie(a),a=F.dist(e,a)+d,d=0<b?f(b,-c,a,d):f(-b,c/(1-c),a,d)):d-=2*b*c;return d}function c(a,b,c,d,e){function f(a,b,c,d){if(1==c){D.Th(a,Q);var e=P?.003*Q.trans:.003*Q.rot;c=z.Zd(a,b,0);z.$e(a,b,0).gesture===z.Ft?(Ka+="X"==d?-c*e:0,kb+="Y"==d?-c*e:0):z.$e(a,b,0).gesture===z.Dt&&(a=P?.003*Q.rot:7.5E-4*Q.trans,eb+="X"==d?-c*a:0,bb+="Y"==d?-c*a:0)}}function l(a){D.Th(a,Q);ab-=.05*Q.zoom}function n(a){D.Th(a,Q);Aa-=.002*Q.trans}
function p(a){D.Th(a,Q);ab+=.05*Q.zoom}function q(a){D.Th(a,Q);Aa+=.002*Q.trans}function r(a,b,c,d){if(1==c){c=z.Zd(a,b,1);D.Th(a,Q);if(P)e=.003*Q.trans,f=7.5E-4*Q.rot;else var e=.003*Q.rot,f=7.5E-4*Q.trans;if(1===z.$e(a,b,0).which)La+="X"==d?-c*e:0,Ta+="Y"==d?-c*e:0;else if(2===z.$e(a,b,0).which||3===z.$e(a,b,0).which)pb+="X"==d?-c*f:0,Ua+="Y"==d?-c*f:0}}function x(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function y(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function B(a){return a[0]&&(a[1]||-.1>a[2])}
function A(a){return a[0]&&(a[1]||.1<a[2])}function J(a){return a[0]&&(a[1]||a[2]||a[3])}function K(a,b,c){if(1==c)switch(c=z.Zd(a,b,0),D.Th(a,Q),b){case "FORWARD":O?va[0]=1:P?(b=D.em(a,E)[1],b=Math.abs(b)>=Math.PI/4?G.xh:G.Nc,h(a,b,.5*Q.trans*c)):R?k(a,-Q.zoom,c):m(a,0,0,-Q.trans*c);break;case "BACKWARD":O?va[0]=-1:P?(b=D.em(a,E)[1],b=Math.abs(b)>=Math.PI/4?G.wh:G.nc,h(a,b,.5*Q.trans*c)):R?k(a,Q.zoom,c):m(a,0,0,Q.trans*c);break;case "UP":P?w(a,30*-Q.zoom*c):O||m(a,0,Q.trans*c,0);break;case "DOWN":P?
w(a,30*Q.zoom*c):O||m(a,0,-Q.trans*c,0);break;case "LEFT":O?va[1]=1:P?h(a,G.Xx,.5*Q.trans*c):m(a,-Q.trans*c,0,0);break;case "RIGHT":O?va[1]=-1:P?h(a,G.ti,.5*Q.trans*c):m(a,Q.trans*c,0,0);break;case "ROT_LEFT":R?D.Os(a,.75*-Q.rot*c,0):D.Tl(a,.75*Q.rot*c,0);break;case "ROT_RIGHT":R?D.Os(a,.75*Q.rot*c,0):D.Tl(a,.75*-Q.rot*c,0);break;case "ROT_UP":R?D.Os(a,0,.75*-Q.rot*c):D.Tl(a,0,.75*Q.rot*c);break;case "ROT_DOWN":R?D.Os(a,0,.75*Q.rot*c):D.Tl(a,0,.75*-Q.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":O&&
(va[0]=0);break;case "LEFT":case "RIGHT":O&&(va[1]=0)}O&&(g.Qm(O,va[0],va[1]),a=D.fm(a,ca),g.Hk(O,a[0],a[1]))}Z=a;u=b;ga=c;var H=t.Qh();C(H);var R=!1,O=null,P=!1;switch(D.im(H)){case D.Kb:R=!a;break;case D.nd:O=t.hm();break;case D.Bg:return;case D.bd:P=!0}var Q=D.Th(H,T);a=z.Rj();if(g.tB(H)){var ba=z.hA(H,null,!0);z.Y(H,"CAMERA_COLLISION",z.uf,[ba],null,function(a,b){var c=z.$e(a,b,0).coll_dist;if(0>c){var d=z.$e(a,b,0).coll_norm,e=aa;F.scale(d,-.25*c,e);c=da.ie(a,ia);F.add(c,e,c);da.KY(a,c)}})}if(O){var ba=
da.ie(H),Ba=da.Sh(H),Ba=G.Nz(Ba);ba[2]-=.5;g.Ds(O,ba,Ba);L.LF(H,O,[0,0,.5]);var va=new Float32Array(2),Ma=!0;g.Gk(O,g.Zx);z.En(H,"TOGGLE_CHAR_MOVE_TYPE",z.vf,z.IE,function(){Ma=!Ma;g.Gk(O,Ma?g.Zx:g.AE)})}var Ga=M.DG(),ba=Ga.length?Ga[Ga.length-1]:0,Ra,I,V,X,Cb,Ha,Ac,Sa,fa,Da;b?Ra=I=V=X=Cb=Ha=b=ba=Ac=Sa=fa=Da=z.iA(0):(Ra=z.Ic(z.$y),I=z.Ic(z.Zy),V=z.Ic(z.Xy),X=z.Ic(z.Yy),Cb=z.Ic(z.xO),Ha=z.Ic(z.sO),b=z.Lq(M.wt,ba),ba=z.Lq(M.Ep,ba),Ac=z.Ic(z.ME),Sa=z.Ic(z.JE),fa=z.Ic(z.KE),Da=z.Ic(z.LE));var Ba=z.Ii(M.Ap,
Ga),qa=z.Ii(M.Bp,Ga),W=z.Ii(M.Cp,Ga),Ga=z.Ii(M.Dp,Ga);P||(z.Y(H,"FORWARD",z.Qa,[a,Ra,qa],B,K),z.Y(H,"BACKWARD",z.Qa,[a,I,qa],A,K));R?(z.Y(H,"ROT_UP",z.Qa,[a,Ac,Cb,Ga],x,K),z.Y(H,"ROT_DOWN",z.Qa,[a,Sa,Ha,Ga],y,K),z.Y(H,"ROT_LEFT",z.Qa,[a,fa,V,W],x,K),z.Y(H,"ROT_RIGHT",z.Qa,[a,Da,X,W],y,K)):P?(z.Y(H,"LEFT",z.Qa,[a,fa,V,Ba],x,K),z.Y(H,"RIGHT",z.Qa,[a,Da,X,Ba],y,K),z.Y(H,"FORWARD",z.Qa,[a,Ac,Ra,qa],x,K),z.Y(H,"BACKWARD",z.Qa,[a,Sa,I,qa],y,K),z.Y(H,"UP",z.Qa,[a,Ha,Ga],A,K),z.Y(H,"DOWN",z.Qa,[a,Cb,Ga],
B,K)):(z.Y(H,"UP",z.Qa,[a,Cb,b],J,K),z.Y(H,"DOWN",z.Qa,[a,Ha,ba],J,K),z.Y(H,"LEFT",z.Qa,[a,V,Ba],B,K),z.Y(H,"RIGHT",z.Qa,[a,X,Ba],A,K),z.Y(H,"ROT_UP",z.Qa,[a,Ac,Ga],B,K),z.Y(H,"ROT_DOWN",z.Qa,[a,Sa,Ga],A,K),z.Y(H,"ROT_LEFT",z.Qa,[a,fa,W],B,K),z.Y(H,"ROT_RIGHT",z.Qa,[a,Da,W],A,K));if(!c){var Qa=0;c=z.nA(d);var ra=0,Ga=z.vA(d);z.Y(H,"MOUSE_WHEEL",z.tp,[c],null,function(a,b,c){1==c&&(b=z.Zd(a,b,0),D.Th(a,Q),R||P?Qa=v(a,b,Q.zoom,Qa,R):(Q.trans*=1+b*Q.zoom,D.LY(a,Q)))});z.Y(H,"TOUCH_ZOOM",z.tp,[Ga],null,
function(a,b,c){1==c&&(c=z.Zd(a,b,0),D.Th(a,Q),z.$e(a,b,0)===z.Et&&(ra=v(a,c,.03*Q.zoom,ra,R)))});z.Y(H,"ZOOM_INTERPOL",z.uf,[a],null,function(a,b){if(R||P)if(1E-5<Math.abs(Qa)||1E-5<Math.abs(ra)){var c=z.Zd(a,b,0),d=G.mc(Qa,0,c,.1*U);Qa-=d;c=G.mc(ra,0,c,.15*U);ra-=c;P?w(a,-(d+c)):(d=D.ND(a)+d+c,d=Math.max(d,.001),D.BZ(a,d))}else ra=Qa=0})}var La=0,Ta=0,pb=0,Ua=0,Aa=0,ab=0;R?(z.Y(H,"GMPD_PAN_Y_POS",z.Qa,[b],null,p),z.Y(H,"GMPD_PAN_Y_NEG",z.Qa,[ba],null,l),z.Y(H,"GMPD_PAN_X_POS",z.Qa,[Ba],function(a){return-.1>
a[0]},n),z.Y(H,"GMPD_PAN_X_NEG",z.Qa,[Ba],function(a){return.1<a[0]},q)):P&&(z.Y(H,"GMPD_PAN_X_POS",z.Qa,[W],function(a){return-.1>a[0]},n),z.Y(H,"GMPD_PAN_X_NEG",z.Qa,[W],function(a){return.1<a[0]},q));if(e){e=z.Il("X",window);c=z.Il("Y",window);b=z.Fn(d);var ba=z.Fn(window),Ya=!1,Ba=function(a){a[2]?Ya=!0:a[0]||(Ya=!1);return Ya&&a[0]};z.Y(H,"MOUSE_X",z.uf,[ba,e,b],Ba,r,"X");z.Y(H,"MOUSE_Y",z.uf,[ba,c,b],Ba,r,"Y");e=M.ga(M.ad,window);M.LD(e,!1)}else e=z.Il("X",d),c=z.Il("Y",d),b=z.Fn(d),z.Y(H,"MOUSE_X",
z.uf,[b,e],null,r,"X"),z.Y(H,"MOUSE_Y",z.uf,[b,c],null,r,"Y");var Ka=0,kb=0,eb=0,bb=0;e=z.Oq("X",d);d=z.Oq("Y",d);z.Y(H,"TOUCH_X",z.uf,[e],null,f,"X");z.Y(H,"TOUCH_Y",z.uf,[d],null,f,"Y");z.Y(H,"ROT_TRANS_INTERPOL",z.uf,[a],null,function(a,b){if(1E-5<Math.abs(La)||1E-5<Math.abs(Ta)||1E-5<Math.abs(Ka)||1E-5<Math.abs(kb)||1E-5<Math.abs(pb)||1E-5<Math.abs(Ua)||1E-5<Math.abs(eb)||1E-5<Math.abs(bb)||1E-5<Math.abs(Aa)||1E-5<Math.abs(ab)){var c=z.Zd(a,b,0),d=G.mc(La,0,c,.08*U),e=G.mc(Ta,0,c,.08*U);La-=d;
Ta-=e;var f=G.mc(Ka,0,c,.12*U),k=G.mc(kb,0,c,.12*U);Ka-=f;kb-=k;var l=G.mc(pb,0,c,.08*U),m=G.mc(Ua,0,c,.08*U);pb-=l;Ua-=m;var n=G.mc(eb,0,c,.12*U),p=G.mc(bb,0,c,.12*U);eb-=n;bb-=p;var q=G.mc(Aa,0,c,.08*U),c=G.mc(ab,0,c,.08*U);Aa-=q;ab-=c;R?(D.Os(a,d+f,e+k),e=D.ND(a),D.AZ(a,e*(l+n+q),e*(m+p+c))):P?(d+f&&h(a,G.ti,.2*(d+f)),e+k&&(m=D.em(a,E)[1],h(a,Math.abs(m)>Math.PI/4?G.wh:G.nc,.2*(e+k))),D.vJ(a,l+n+q,0)):(D.Tl(a,.5*(d+f),.5*(e+k)),O&&(l=D.fm(a,ca),g.Hk(O,l[0],l[1])))}});z.En(H,"DEC_STEREO_DIST",z.vf,
z.vO,function(a){var b=D.ZI(a);D.QL(a,.9*b)});z.En(H,"INC_STEREO_DIST",z.vf,z.yO,function(a){var b=D.ZI(a);D.QL(a,1.1*b)})}function C(a){var b=D.im(a),d=z.gA(function(){var c=D.im(a),d=c!=b;b=c;return d});z.Y(a,"CHANGE_MOVE_STYLE",z.uf,[d],null,function(){O();c(Z,u,ga)})}function O(){var a=t.Qh();z.vq(a,"TOGGLE_CHAR_MOVE_TYPE")&&t.hm()&&L.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)z.hf(a,b[c])}function J(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+
c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function K(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&x.HX(f)}var g=performance.now();x.Yp(f)}l("animation");var D=l("camera"),Q=l("config"),L=l("constraints"),H=l("container"),z=l("controls"),d=l("data"),p=l("debug"),M=l("input"),x=l("main"),g=l("physics"),P=l("print"),t=l("scenes"),da=l("transform"),G=l("util"),F=l("vec3"),U=1,R=null,Z=!1,u=!1,ga=
!1,ca=new Float32Array(2),E=new Float32Array(2),aa=new Float32Array(3),ia=new Float32Array(3);new Float32Array(3);var q=new Float32Array(4),T={},ba={};a.Xg=function(a){function c(){var a=b(k,K,F,l),d=H.gm();if(a){var f=H.Ce();H.Bk();C&&(y(m,u),x.pY(r));w&&(n(),e());q&&x.Yp(function(){f.style.height=f.clientWidth/q+"px"});h&&x.Yp(function(){H.Bk()});D&&x.Yp(function(){H.WA()});v&&Q.UC();J==Q.Mp?p.LM(function(a,b){0==a?(P.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),Q.An(Q.jl)):1.5>b?(P.log("QUALITY TEST RESULT: LOW ("+
b.toFixed(1)+" GB/s)"),Q.An(Q.Np)):(P.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),Q.An(Q.jl));g(d,!0)}):g(d,!0)}else g(d,!1)}function f(a){a.keyCode==z.wO&&(x.Ir()?x.jj():x.pause())}function g(){}a=a||{};var h=!1,k=null,l=null,m=null,q=0,u=null,t=!0,v=!1,w=!0,F=!0,A=!1,C=!1,E=!1,D=!1,J=Q.get("quality"),G;for(G in a)switch(G){case "canvas_container_id":k=a.canvas_container_id;break;case "callback":g=a.callback;break;case "autoresize":h=a.autoresize;break;case "show_hud_debug_info":E=a.show_hud_debug_info;
break;case "sfx_mix_mode":A=a.sfx_mix_mode;break;case "show_fps":C=a.show_fps;break;case "track_container_position":D=a.track_container_position;break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":m=a.fps_elem_id;break;case "error_purge_elements":l=a.error_purge_elements;break;case "report_init_failure":F=a.report_init_failure;break;case "pause_invisible":w=a.pause_invisible;break;case "key_pause_enabled":t=a.key_pause_enabled;break;case "force_container_ratio":q=a.force_container_ratio;
break;case "min_capabilities":v=a.min_capabilities;break;case "quality":J=a.quality;break;default:Q.set(G,a[G])}J!=Q.Mp&&Q.set("quality",J);t&&document.addEventListener("keydown",f,!1);Q.set("show_hud_debug_info",E);Q.set("sfx_mix_mode",A);var K=E||A||null;"complete"==document.readyState?window.setTimeout(c,0):window.addEventListener("load",c,!1);window.addEventListener("unload",function(){d.ua()},!1)};a.Bk=function(){P.Sb("app.resize_to_container","container.resize_to_container");H.Bk()};a.A8=function(a,
b){var c=A(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.z8=function(a,b){var c=A(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.B8=function(a,b){var c=A(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.M3=c;a.B3=O;a.b8=function(a){P.Oh("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=t.Qh();D.kD(b,a)};a.P3=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=z.Zd(a,b,0),b){case "FORWARD":d?g.lp(a,1):da.fh(a,0,-1*e,0);break;case "BACKWARD":d?g.lp(a,-1):da.fh(a,0,1*e,0);break;case "LEFT":d?g.kp(a,-1):da.fh(a,1*e,0,0);break;case "RIGHT":d?g.kp(a,1):da.fh(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&g.lp(a,0);break;case "LEFT":case "RIGHT":d&&g.kp(a,0)}}var d=g.bf(a)||g.cf(a),e=z.Rj(),f=z.Ic(z.$y),h=z.Ic(z.Zy),k=z.Ic(z.Xy),l=z.Ic(z.Yy),m=z.Ic(z.ME),n=z.Ic(z.JE),p=z.Ic(z.KE),q=z.Ic(z.LE);z.Y(a,
"FORWARD",z.Qa,[e,f,m],b,c);z.Y(a,"BACKWARD",z.Qa,[e,h,n],b,c);z.Y(a,"LEFT",z.Qa,[e,k,p],b,c);z.Y(a,"RIGHT",z.Qa,[e,l,q],b,c)};a.F3=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)z.hf(a,b[c])};a.N3=function(){P.O("app.enable_controls() deprecated")};a.C3=function(){P.O("app.disable_controls() deprecated")};a.O3=function(){z.En(null,"CAMERA_SHOT",z.vf,z.tO,function(){p.IW()});z.En(null,"LIGHT_SHOT",z.vf,z.uO,function(){p.LW()});z.En(null,"TELEMETRY",z.vf,z.BO,function(){p.DC()})};
a.O7=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",
d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():P.error("B4W App: request fullscreen method is not supported")};a.W3=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;
"function"!=typeof a&&P.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.S2=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.N7=J;a.P5=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=
e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.qT=function(a,b,c,d,e,f,g,h){function k(e){a&&(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;K(a,c,d,e,k)}};a.VQ=function(a,b,c,d,e,f){function g(e){a&&
(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},K(a,c,d,e,g))};a.CX=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.CX(b)};"css"==c.type?a.qT(d,e,f,g,h,k,l,m):"attr"==c.type&&a.VQ(d,e,f,g,h,m)}};a.c8=function(a){U=a};a.w4=function(){return U}};b4w.module.data=function(a,l){var n=l("__data"),e=l("__loader");l("__print");a.load=n.load;a.yx=function(a){n.yx(a|0)};a.xL=n.xL;a.$g=n.$g;a.K6=e.qm;a.X6=n.load;a.ua=a.yx;a.EF=n.EF;a.KK=n.KK;a.aN=n.aN};b4w.module.debug=function(a,l){function n(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function e(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;K.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.XA.ALL_OPS-a.XA.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.XA,e=c.W_,f=y(c.oT),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";K.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);K.groupCollapsed("directives");for(var g=c.ib.Mi.slice().sort(),f=0;f<g.length;f++){var h=g[f];K.ae(h[0],h[1])}K.groupEnd();K.groupCollapsed("node elements");g=c.ib.og;for(f=0;f<g.length;f++)K.ae(g[f]);K.groupEnd();K.groupCollapsed("vert source");K.ae(c.U_);K.groupEnd();K.groupCollapsed("vert translated source");K.ae(c.V_);K.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];K.groupCollapsed("vert ops stats");for(var k in e)-1==f.indexOf(k)&&K.ae(k,e[k]);
K.groupEnd();K.groupCollapsed("vert assembly");K.ae(c.T_);K.groupEnd();K.groupCollapsed("frag source");K.ae(c.yU);K.groupEnd();K.groupCollapsed("frag translated source");K.ae(c.zU);K.groupEnd();K.groupCollapsed("frag ops stats");for(k in d)-1==f.indexOf(k)&&K.ae(k,d[k]);K.groupEnd();K.groupCollapsed("frag assembly");K.ae(c.pU);K.groupEnd();K.groupEnd()}}function y(a){for(var b=[],c=Q.pr(),d=0;d<c.length;d++)for(var e=c[d],f=C.Ub(e,"MESH",C.oc),g=0;g<f.length;g++){var h=O.ka(f[g],e);if(h&&h.W.length)for(var h=
h.W,k=0;k<h.length;k++){var l=h[k];if(l.zb==a)for(var m=0;m<l.sd.length;m++){var n=l.sd[m];-1==b.indexOf(n)&&b.push(n)}}}return b}function r(a,b){function c(){P.push(c);t=b;return a.apply(a,arguments)}return c}function A(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var h=l("__config"),w=l("__compat"),m=l("__controls"),k=l("__container"),
f=l("__debug"),v=l("__extensions"),c=l("__loader"),C=l("__objects"),O=l("__obj_util"),J=l("__physics"),K=l("__print"),D=l("__renderer"),Q=l("__scenes"),L=l("__scenegraph"),H=l("__sfx"),z=l("__shaders"),d=l("__subscene"),p=l("__textures"),M=l("__util"),x=l("__vec3"),g=h.B,P=[],t="",da=!0,G=new Float32Array(2);a.pt=f.pt;a.ly=f.ly;a.qt=f.qt;a.ky=f.ky;a.ot=f.ot;a.jy=f.jy;a.iy=f.iy;a.yp=f.yp;a.z7=function(){J.xT()};a.y7=function(a){K.log("O",J.lU(a));for(var b=J.LU().zc.sa,c=0;c<b.length;c++){var d=b[c];
d.C.fa==a&&K.log("B",d)}};a.X9=function(){for(var a=Q.A(),b=C.Ub(a,"MESH",C.oc),a=[Q.La(a,d.Pb),Q.La(a,d.Pc),Q.La(a,d.ge)],c=0;c<a.length;c++){var e=a[c],f=subs.Ra;if(f.length){K.group(e.type,"DYNAMIC");for(var g=0;g<b.length;g++){var h=b[g],k=h.k;if("DYNAMIC"==k.type)for(var l=!1,m=0;m<f.length;m++){for(var n=f[m].sa,p=0;p<n.length;p++){var r=n[p];if(r.cc&&r.ff==k){K.ae(h.name,h);l=!0;break}}if(l)break}}K.groupEnd();K.groupCollapsed(e.type,"STATIC");for(g=0;g<b.length;g++)if(h=b[g],k=h.k,"DYNAMIC"!=
k.type)for(l=!1,m=0;m<f.length;m++){n=f[m].sa;for(p=0;p<n.length;p++)if(r=n[p],r.cc&&r.ff==k){K.ae(h.name,h);l=!0;break}if(l)break}K.groupEnd()}}};a.r7=function(a){for(var b=Q.A(),c=C.Ub(b,"MESH",C.oc),d=0;d<c.length;d++){var e=c[d];if(e.name==a){K.log("Object",e);for(var f=Q.$A(b),g=0;g<f.length;g++){for(var h=f[g],k=[],l=h.Ra,m=0;m<l.length;m++)for(var n=l[m].sa,p=0;p<n.length;p++)n[p].ff==e.k&&k.push(n[p]);K.log("Subscene "+h.type,k)}}}};a.s7=function(){var a=Q.A();console.log("Armatures: "+C.Ub(a,
"ARMATURE",C.oc).length);console.log("Cameras: "+C.Ub(a,"CAMERA",C.oc).length);console.log("Curves: "+C.Ub(a,"CURVE",C.oc).length);console.log("Empties: "+C.Ub(a,"EMPTY",C.oc).length);console.log("Lamps: "+C.Ub(a,"LAMP",C.oc).length);console.log("Meshes: "+C.Ub(a,"MESH",C.oc).length);console.log("Speakers: "+C.Ub(a,"SPEAKER",C.oc).length)};a.Yr=function(){for(var a=0,b=Q.A(),b=[Q.La(b,d.Pb),Q.La(b,d.Pc),Q.La(b,d.ge)],c=0;c<b.length;c++){var e=b[c];if(e)for(var e=e.Ra,f=0;f<e.length;f++)for(var g=
e[f].sa,h=0;h<g.length;h++){var k=g[h].za;k&&(a+=k.Yr)}}return a};a.Dm=function(){for(var a=0,b=Q.A(),b=[Q.La(b,d.Pb),Q.La(b,d.Pc),Q.La(b,d.ge)],c=0;c<b.length;c++){var e=b[c];if(e)for(var e=e.Ra,f=0;f<e.length;f++)for(var g=e[f].sa,h=0;h<g.length;h++){var k=g[h].za;k&&(a+=k.Dm)}}return a};a.l7=function(){for(var a=Q.A(),b=Q.FD(a,[d.Pb,d.Pc,d.ge,d.Nd,d.xf]),c=0,e=0;e<b.length;e++)for(var f=b[e],f=f.Ra,g=0;g<f.length;g++)c+=f[g].sa.length;a=Q.FD(a,[d.md,d.Oe]);for(e=0;e<a.length;e++)for(f=a[e],f=f.Ra,
g=0;g<f.length;g++)c+=6*f[g].sa.length;return c};a.o7=function(){return M.qr(z.rI())};a.r4=function(){for(var a=Q.A(),b=Q.$A(a),a={},c=0;c<b.length;c++){var e=b[c];if(e.type!=d.un&&e.type!=d.wf)for(var f=e.Ra,g=0;g<f.length;g++)for(var h=f[g].sa,k=0;k<h.length;k++){var l=h[k].za,m=h[k].ff;l&&(e.type!=d.tf&&e.type!=d.Cg||m.pw||m.ow)&&(a[l.id]=l)}}var c=b=0,n;for(n in a)e=a[n].Ca,e.Hn&&(c+=e.Hn/1048576),b+=e.Jn/1048576;return{vbo_memory:b,ibo_memory:c}};a.p7=function(){for(var a=[],b=0,c=Q.A(),c=[Q.La(c,
d.Pb),Q.La(c,d.Pc),Q.La(c,d.ge)],e=0;e<c.length;e++){var f=c[e];if(f)for(var f=f.Ra,g=0;g<f.length;g++)for(var h=f[g].sa,k=0;k<h.length;k++){var l=h[k].za;if(l)for(var l=l.ya,m=0;m<l.length;m++){var n=l[m];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var p=n.sb;-1===a.indexOf(p)&&(a.push(p),n=n.width*n.height*4/1048576/n.Iq,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.n7=function(){for(var a=[],b=0,c=Q.A(),c=Q.$A(c),e=0;e<c.length;e++){var f=c[e];if(f.type!=d.un){var g=f.p,h=[g.wc,
g.Ve];h.push.apply(h,f.mi);for(f=0;f<h.length;f++){var k=h[f];p.fo(k)&&-1==a.indexOf(k)&&(a.push(k),b+=g.width*g.height*p.rV(k))}}}return{number:a.length,memory:b/1024/1024}};a.IW=function(){var a=Q.A();(a=Q.La(a,d.Pb))&&Q.aK(a.p,a,[1,1,0])};a.LW=function(){var a=Q.A(),b=Q.La(a,d.Pb),a=Q.FD(a,[d.cd]);if(b)for(var c=0;c<a.length;c++){var e=a[c],f;switch(c){case 0:f=[1,0,0];break;case 1:f=[0,1,0];break;case 2:f=[0,0,1];break;default:f=[1,0,1]}Q.aK(e.p,b,f)}};a.X7=function(){for(var a=Q.pr(),b=0;b<a.length;b++)K.log("\n"+
L.uT(Q.hB(a[b])))};a.Y7=function(){};a.Z6=function(){K.log("\n"+c.wV())};a.m3=m.debug;a.q7=function(a,b){return x.dist(m_tsr.G(a.k.n),m_tsr.G(b.k.n))};a.iK=f.iK;a.Qu=f.Qu;a.OK=f.OK;a.DC=f.DC;a.d4=function(a,b){function c(){f.Qu("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.u2=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,-1,0]),h=new Float32Array([0,
0,-1]);if(!M.Mj(a,M.lF))throw"Wrong VEC3_IDENT";if(!M.Mj(b,M.sn))throw"Wrong QUAT4_IDENT";if(!M.Mj(c,M.ti))throw"Wrong AXIS_X";if(!M.Mj(d,M.xh))throw"Wrong AXIS_Y";if(!M.Mj(e,M.nc))throw"Wrong AXIS_Z";if(!M.Mj(f,M.Xx))throw"Wrong AXIS_MX";if(!M.Mj(g,M.wh))throw"Wrong AXIS_MY";if(!M.Mj(h,M.Nc))throw"Wrong AXIS_MZ";};a.j7=function(){for(var a=H.pV(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==H.mB(c)&&H.qc(c,!0)}};a.EG=function(a){f.EG(a)};a.j8=function(a){var b=Q.A();if(b=Q.La(b,d.wf)){if("number"==
typeof a.debug_view_mode)switch(a.debug_view_mode){case f.pt:case f.ly:case f.qt:case f.ky:case f.ot:case f.jy:case f.iy:case f.yp:Q.kY(b,a.debug_view_mode);break;default:K.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&Q.jY(b,a.debug_colors_seed);"number"==typeof a.OX&&Q.FY(b,a.OX);"object"==typeof a.wireframe_edge_color&&Q.QY(b,M.Ef(a.wireframe_edge_color))}else K.error("Debugging is not available on the scene.")};a.K4=function(){return K.WU()};a.c6=function(){return K.uV()};
a.QG=function(){return K.QG()};a.X1=function(a){var c=z.rI(),d=0,g;for(g in c)a&&-1===g.indexOf(a)||d++;var d="of "+d+" analyzing...",h={};for(g in c)if(!a||-1!==g.indexOf(a)){var k=c[g],l;var m=k.Kx;l=k.Vu;var p=v.TU();if(p){var r=p.getTranslatedShaderSource(m),p=p.getTranslatedShaderSource(l);if(w.Zf())var r=r.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),q=e("/analyze_shader/vert_gles",r),t=e("/analyze_shader/frag_gles",p);else r=r.replace("#version","#version 400 //"),
p=p.replace("#version","#version 400 //"),q=e("/analyze_shader/vert",r),t=e("/analyze_shader/frag",p);var x=n(q),y=n(t);l={U_:f.av().getShaderSource(m),V_:r,T_:q,W_:x,yU:f.av().getShaderSource(l),zU:p,pU:t,XA:y}}else K.error("WEBGL_debug_shaders extension not found"),l=void 0;r=k.ib;m=r.yg+" + "+r.Xe;l.oT=k;l.ib=r;k=h[m]=h[m]||[];k.push(l);K.ae(d)}for(m in h)K.group("%c"+m,"color: #800"),k=h[m],b(k),K.groupEnd()};a.PH=f.PH;a.LM=function(b){if(z.JG())if(v.fB()){var c=g.gl_debug;g.gl_debug=!0;var e=
L.FS();Q.bI(null,e);for(var h=L.gc(e,d.Lp),k=h.p,e=0;5>e;e++)D.Nn(h);g.gl_debug=c;window.setTimeout(function(){f.AX(h);var a=h.Cf;b(a,k.width*k.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.LM(b)},100)};a.rG=f.rG;a.dM=f.dM;a.NK=f.NK;a.k9=function(a){P=[];da=!0;a=l(a);for(var b in a)"function"===typeof a[b]&&(a[b]=r(a[b],b))};a.Q2=function(){return da};a.test=function(a,b){try{return b(),!0}catch(c){return da=!1,console.error(a+" test was failed. ",c),!1}};
a.B7=function(a){var b=k.eJ(),c=k.dJ(),d=b/2,e=c/2;k.resize(b,c,!1);b=Q.A().s.Xa;(c=L.mU(b))||M.q("Couldn't find onscreen subscene");b=c.p;d=k.iu(d,e,G,c.p);d[1]=b.height-d[1];d=D.NC(b.Ze,d[0],d[1]);A(a,d,1)};a.T3=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+t;};a.U3=A;a.S3=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.Q3=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=
l(a);for(var b in a)-1==P.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.t7=function(a){if(!Boolean(a))throw"Wrong result. Function: "+t;}};b4w.module.preloader=function(a,l){var n=l("container"),e,b,y,r,A,h,w,m,k=null;a.GS=function(){var a="#000",h="#5276cf",c="#fff",k="#fff",l;for(l in void 0)switch(l){case "container_color":a=(void 0).container_color;break;case "bar_color":h=(void 0).bar_color;break;case "frame_color":c=(void 0).frame_color;break;case "font_color":k=(void 0).font_color}l=document.createElement("div");var m=l.cloneNode(),w=l.cloneNode(),A=l.cloneNode(),Q=n.Ce();w.appendChild(m);w.appendChild(A);l.appendChild(w);Q.appendChild(l);
l.style.cssText="background-color: "+a+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";w.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+c+";";m.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+h+";height: 100%;";A.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
k+";";e=m;b=A;y=l;r="DEFAULT"};a.u3=function(a){var h=null,c=null,l="#bf9221",m="#000",n;for(n in a)switch(n){case "canvas_container_id":h=a.canvas_container_id;break;case "background_container_id":c=a.background_container_id;break;case "bg_color":m=a.bg_color;break;case "bar_color":l=a.bar_color}a=document.createElement("div");n=document.createElement("div");a.id="simple_preloader_container";var w=document.createElement("div"),D=document.createElement("div"),c=document.getElementById(c);k=document.getElementById(h);
a.style.cssText="z-index: 4;background-color: "+m+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";n.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";w.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+l+";border-radius: 0px;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
n.appendChild(w);n.appendChild(D);a.appendChild(n);document.body.appendChild(a);r="SIMPLE";y=a;e=w;b=D;A=c};a.s3=function(a){var e=null,c=null,l="rgba(0,0,0,0)",m="",n="",w="rgba(0,0,0,0)",D;for(D in a)switch(D){case "canvas_container_id":e=a.canvas_container_id;break;case "background_container_id":c=a.background_container_id;break;case "frame_bg_color":l=a.frame_bg_color;break;case "bg_color":w=a.bg_color;break;case "frame_class":m=a.frame_class;break;case "anim_elem_class":n=a.anim_elem_class}a=
document.createElement("div");D=document.createElement("div");var Q=document.createElement("div"),L=document.createElement("div"),c=document.getElementById(c);k=document.getElementById(e);a.style.cssText="z-index: 4;background-color: "+w+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";D.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+l+";";Q.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";
L.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";Q.className=n;D.appendChild(Q);D.className=m;D.appendChild(L);a.appendChild(D);k.appendChild(a);r="ROTATION";y=a;h=Q;b=L;A=c};a.q3=function(a){var h=a.preloader_width,h=h/(h-a.img_width),c=document.getElementById(a.preloader_bar_id),l=document.getElementById(a.fill_band_id),n=document.getElementById(a.preloader_caption_id),J=document.getElementById(a.preloader_container_id),
K=document.getElementById(a.background_container_id);k=document.getElementById(a.canvas_container_id);r="ADVANCED";e=c;w=l;m=h;b=n;y=J;A=K};a.t_=function(a){b.innerHTML=a+"%";"SIMPLE"==r?e.style.width=a+"%":"ADVANCED"==r?(e.style.width=a/m+"%",w.style.width=100-a+"%"):"ROTATION"==r?h.style.transform="rotate("+a+"deg)":"DEFAULT"==r&&(e.style.width=a+"%");100==a&&(y.parentNode.removeChild(y),A&&A.parentNode.removeChild(A))}};"object"==typeof module&&module.QA&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,l){l("__print");var n=l("__version");a.version=n.version;a.mE=n.mE;a.type=n.type;a.wH=n.wH;a.AA=n.AA};"object"==typeof module&&module.QA&&b4w.module.version(exports);if(b4w.module_check("environment"))throw"Failed to register module: environment";b4w.register("environment",function(a,l){var n=l("lights");a.JV=function(){n.iY()}});if(b4w.module_check("character"))throw"Failed to register module: character";
b4w.register("character",function(a,l){function n(){console.log("Phys_body_position: "+h.BC.C.Bu)}var e=l("fps"),b=l("scenes");l("constraints");var y=l("transform"),r=l("physics"),A=l("animation");new Float32Array(3);var h,w=new Float32Array(4);a.IV=function(){h={K2:[0,-3,-.85],BC:b.hm(),YC:b.JI("petigor_armature"),f7:b.JI("petigor_model")};e.OT(h.BC,n);A.apply(h.YC,"petigor_run");A.Fo(h.YC,A.Rx);A.play(h.YC);var a=b.lV(),k=y.ie(a);y.Sh(a,w);console.log("Spawner rotation: "+w);r.Ds(h.BC,k,w)}});if(b4w.module_check("system"))throw"Failed to register module: system";b4w.register("system",function(a,l){var n=l("config");a.NV=function(){n.set("max_fps",45);n.set("max_fps_physics",500)}});b4w.register("project_ow_app",function(a,l){function n(a,f){f?(h.GS(),a.oncontextmenu=function(a){a.preventDefault();a.stopPropagation();return!1},A.load(c+"project_ow.json",b,e)):console.log("b4w init failure")}function e(a){h.t_(a)}function b(a,b){b?(m.NV(),f.JV(),k.IV()):console.log("b4w load failure")}var y=l("app"),r=l("config"),A=l("data"),h=l("preloader"),w=l("version"),m=l("system"),k=l("character"),f=l("environment"),v="DEBUG"==w.type(),c=r.Yu("project_ow");a.Xg=function(){y.Xg({canvas_container_id:"main_canvas_container",
callback:n,show_fps:v,console_verbose:v,autoresize:!0,key_pause_enabled:!0})}});b4w.require("project_ow_app").Xg();
